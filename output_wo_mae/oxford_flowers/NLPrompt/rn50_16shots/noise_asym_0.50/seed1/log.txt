***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1213, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 198
clean true:193
clean false:5
clean_rate:0.9747474747474747
noisy true:182
noisy false:1252
after delete: len(clean_dataset) 198
after delete: len(noisy_dataset) 1434
epoch [1/200] batch [5/6] time 0.335 (0.359) data 0.259 (0.263) loss_x loss_x 2.3574 (2.7113) acc_x 59.3750 (38.7500) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1200
confident_label rate tensor(0.1311, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 214
clean true:208
clean false:6
clean_rate:0.9719626168224299
noisy true:224
noisy false:1194
after delete: len(clean_dataset) 214
after delete: len(noisy_dataset) 1418
epoch [2/200] batch [5/6] time 0.328 (0.331) data 0.251 (0.254) loss_x loss_x 1.3701 (1.3853) acc_x 65.6250 (66.2500) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 760
confident_label rate tensor(0.2727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 445
clean true:443
clean false:2
clean_rate:0.9955056179775281
noisy true:429
noisy false:758
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1187
epoch [3/200] batch [5/13] time 0.292 (0.328) data 0.214 (0.251) loss_x loss_x 0.9966 (0.8684) acc_x 75.0000 (80.0000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/13] time 0.288 (0.308) data 0.211 (0.231) loss_x loss_x 1.3936 (0.8911) acc_x 71.8750 (79.6875) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 741
confident_label rate tensor(0.2714, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 443
clean true:440
clean false:3
clean_rate:0.9932279909706546
noisy true:451
noisy false:738
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1189
epoch [4/200] batch [5/13] time 0.348 (0.334) data 0.271 (0.257) loss_x loss_x 0.7158 (0.9604) acc_x 90.6250 (76.8750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/13] time 0.341 (0.338) data 0.264 (0.261) loss_x loss_x 1.3252 (0.9424) acc_x 59.3750 (76.2500) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 447
clean true:439
clean false:8
clean_rate:0.9821029082774049
noisy true:430
noisy false:755
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1185
epoch [5/200] batch [5/13] time 0.349 (0.351) data 0.271 (0.274) loss_x loss_x 0.8887 (0.7402) acc_x 75.0000 (81.2500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/13] time 0.349 (0.346) data 0.272 (0.269) loss_x loss_x 0.5269 (0.7908) acc_x 90.6250 (80.3125) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 738
confident_label rate tensor(0.2721, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 444
clean true:440
clean false:4
clean_rate:0.990990990990991
noisy true:454
noisy false:734
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1188
epoch [6/200] batch [5/13] time 0.337 (0.342) data 0.260 (0.264) loss_x loss_x 0.8408 (0.7373) acc_x 71.8750 (80.6250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/13] time 0.336 (0.340) data 0.259 (0.263) loss_x loss_x 1.0469 (0.8010) acc_x 81.2500 (80.6250) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 710
confident_label rate tensor(0.2862, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 467
clean true:464
clean false:3
clean_rate:0.9935760171306209
noisy true:458
noisy false:707
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1165
epoch [7/200] batch [5/14] time 0.289 (0.302) data 0.211 (0.224) loss_x loss_x 0.4036 (0.6583) acc_x 93.7500 (83.1250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/14] time 0.300 (0.299) data 0.222 (0.221) loss_x loss_x 0.5825 (0.7998) acc_x 81.2500 (81.2500) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 689
confident_label rate tensor(0.2953, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 482
clean true:473
clean false:9
clean_rate:0.9813278008298755
noisy true:470
noisy false:680
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1150
epoch [8/200] batch [5/15] time 0.349 (0.329) data 0.272 (0.252) loss_x loss_x 0.7710 (0.7404) acc_x 75.0000 (79.3750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/15] time 0.340 (0.337) data 0.263 (0.260) loss_x loss_x 1.0371 (0.8200) acc_x 68.7500 (77.8125) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/15] time 0.339 (0.341) data 0.262 (0.263) loss_x loss_x 0.9028 (0.8148) acc_x 71.8750 (78.9583) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 702
confident_label rate tensor(0.2947, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 481
clean true:475
clean false:6
clean_rate:0.9875259875259875
noisy true:455
noisy false:696
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1151
epoch [9/200] batch [5/15] time 0.347 (0.341) data 0.270 (0.263) loss_x loss_x 0.8311 (0.7778) acc_x 84.3750 (83.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/15] time 0.319 (0.338) data 0.240 (0.261) loss_x loss_x 0.5049 (0.6873) acc_x 87.5000 (83.7500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/15] time 0.311 (0.327) data 0.233 (0.249) loss_x loss_x 0.5635 (0.6903) acc_x 84.3750 (84.3750) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 683
confident_label rate tensor(0.2984, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 487
clean true:479
clean false:8
clean_rate:0.9835728952772074
noisy true:470
noisy false:675
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1145
epoch [10/200] batch [5/15] time 0.349 (0.344) data 0.272 (0.267) loss_x loss_x 0.7334 (0.7549) acc_x 81.2500 (81.8750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/15] time 0.291 (0.331) data 0.213 (0.254) loss_x loss_x 0.7520 (0.7916) acc_x 81.2500 (80.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/15] time 0.326 (0.326) data 0.248 (0.249) loss_x loss_x 0.4419 (0.7216) acc_x 90.6250 (82.5000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 678
confident_label rate tensor(0.3076, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 502
clean true:488
clean false:14
clean_rate:0.9721115537848606
noisy true:466
noisy false:664
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1130
epoch [11/200] batch [5/15] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.7671 (0.7826) acc_x 75.0000 (79.3750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/15] time 0.332 (0.341) data 0.255 (0.264) loss_x loss_x 0.7661 (0.8079) acc_x 81.2500 (79.3750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/15] time 0.343 (0.342) data 0.265 (0.265) loss_x loss_x 0.5181 (0.7552) acc_x 90.6250 (81.2500) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 686
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 463
clean true:457
clean false:6
clean_rate:0.9870410367170627
noisy true:489
noisy false:680
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 1169
epoch [12/200] batch [5/14] time 0.343 (0.334) data 0.265 (0.257) loss_x loss_x 0.6035 (0.7549) acc_x 90.6250 (81.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/14] time 0.340 (0.338) data 0.263 (0.261) loss_x loss_x 0.6826 (0.6777) acc_x 90.6250 (84.0625) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 668
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 497
clean true:490
clean false:7
clean_rate:0.9859154929577465
noisy true:474
noisy false:661
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1135
epoch [13/200] batch [5/15] time 0.338 (0.340) data 0.261 (0.262) loss_x loss_x 0.7476 (0.6961) acc_x 81.2500 (84.3750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/15] time 0.346 (0.340) data 0.269 (0.262) loss_x loss_x 1.0625 (0.7368) acc_x 71.8750 (80.9375) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/15] time 0.338 (0.341) data 0.261 (0.264) loss_x loss_x 0.8394 (0.7887) acc_x 75.0000 (79.7917) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 662
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 504
clean true:498
clean false:6
clean_rate:0.9880952380952381
noisy true:472
noisy false:656
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1128
epoch [14/200] batch [5/15] time 0.339 (0.338) data 0.262 (0.261) loss_x loss_x 0.7007 (0.6394) acc_x 84.3750 (85.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/15] time 0.343 (0.340) data 0.266 (0.263) loss_x loss_x 0.4697 (0.6007) acc_x 93.7500 (88.4375) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/15] time 0.346 (0.339) data 0.269 (0.262) loss_x loss_x 0.4878 (0.6513) acc_x 84.3750 (86.0417) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 658
confident_label rate tensor(0.3033, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 495
clean true:487
clean false:8
clean_rate:0.9838383838383838
noisy true:487
noisy false:650
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1137
epoch [15/200] batch [5/15] time 0.336 (0.340) data 0.258 (0.263) loss_x loss_x 1.2520 (0.7792) acc_x 78.1250 (81.8750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/15] time 0.336 (0.338) data 0.258 (0.260) loss_x loss_x 0.5405 (0.6820) acc_x 87.5000 (85.0000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/15] time 0.345 (0.338) data 0.268 (0.261) loss_x loss_x 0.7422 (0.7187) acc_x 84.3750 (84.5833) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 633
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 515
clean true:509
clean false:6
clean_rate:0.9883495145631068
noisy true:490
noisy false:627
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1117
epoch [16/200] batch [5/16] time 0.300 (0.300) data 0.224 (0.222) loss_x loss_x 0.6094 (0.6441) acc_x 84.3750 (86.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/16] time 0.340 (0.319) data 0.263 (0.241) loss_x loss_x 0.4983 (0.5856) acc_x 84.3750 (87.1875) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/16] time 0.345 (0.326) data 0.268 (0.249) loss_x loss_x 0.3726 (0.5951) acc_x 90.6250 (86.6667) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 631
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 516
clean true:506
clean false:10
clean_rate:0.9806201550387597
noisy true:495
noisy false:621
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1116
epoch [17/200] batch [5/16] time 0.332 (0.346) data 0.255 (0.269) loss_x loss_x 1.0791 (0.8226) acc_x 81.2500 (83.1250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/16] time 0.327 (0.344) data 0.250 (0.267) loss_x loss_x 0.6406 (0.7019) acc_x 87.5000 (85.6250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/16] time 0.297 (0.337) data 0.219 (0.260) loss_x loss_x 0.3379 (0.6597) acc_x 93.7500 (85.6250) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 605
confident_label rate tensor(0.3284, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 536
clean true:526
clean false:10
clean_rate:0.9813432835820896
noisy true:501
noisy false:595
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 1096
epoch [18/200] batch [5/16] time 0.296 (0.300) data 0.218 (0.222) loss_x loss_x 0.8145 (0.7102) acc_x 81.2500 (84.3750) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/16] time 0.350 (0.322) data 0.273 (0.244) loss_x loss_x 0.6069 (0.5913) acc_x 84.3750 (86.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/16] time 0.318 (0.325) data 0.240 (0.247) loss_x loss_x 0.4812 (0.6221) acc_x 87.5000 (85.4167) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 600
confident_label rate tensor(0.3382, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 552
clean true:539
clean false:13
clean_rate:0.9764492753623188
noisy true:493
noisy false:587
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1080
epoch [19/200] batch [5/17] time 0.349 (0.342) data 0.271 (0.265) loss_x loss_x 0.7856 (0.6677) acc_x 78.1250 (84.3750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/17] time 0.338 (0.339) data 0.261 (0.262) loss_x loss_x 0.6055 (0.6512) acc_x 87.5000 (84.3750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/17] time 0.337 (0.336) data 0.259 (0.258) loss_x loss_x 0.6445 (0.6746) acc_x 81.2500 (84.1667) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 604
confident_label rate tensor(0.3290, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 537
clean true:526
clean false:11
clean_rate:0.9795158286778398
noisy true:502
noisy false:593
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1095
epoch [20/200] batch [5/16] time 0.329 (0.344) data 0.251 (0.267) loss_x loss_x 0.2925 (0.5621) acc_x 93.7500 (83.1250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/16] time 0.337 (0.342) data 0.260 (0.265) loss_x loss_x 0.5288 (0.5778) acc_x 90.6250 (85.3125) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/16] time 0.344 (0.345) data 0.266 (0.268) loss_x loss_x 0.6611 (0.5933) acc_x 87.5000 (85.0000) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 590
confident_label rate tensor(0.3382, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 552
clean true:538
clean false:14
clean_rate:0.9746376811594203
noisy true:504
noisy false:576
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1080
epoch [21/200] batch [5/17] time 0.340 (0.345) data 0.263 (0.267) loss_x loss_x 0.6445 (0.6934) acc_x 71.8750 (81.2500) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/17] time 0.365 (0.344) data 0.288 (0.267) loss_x loss_x 0.5703 (0.6437) acc_x 87.5000 (83.1250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/17] time 0.300 (0.334) data 0.222 (0.257) loss_x loss_x 0.5083 (0.6488) acc_x 84.3750 (83.3333) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 583
confident_label rate tensor(0.3413, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 557
clean true:542
clean false:15
clean_rate:0.9730700179533214
noisy true:507
noisy false:568
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1075
epoch [22/200] batch [5/17] time 0.346 (0.347) data 0.268 (0.270) loss_x loss_x 0.5005 (0.6423) acc_x 90.6250 (82.5000) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/17] time 0.356 (0.350) data 0.279 (0.272) loss_x loss_x 0.6646 (0.6301) acc_x 84.3750 (83.1250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/17] time 0.294 (0.345) data 0.216 (0.268) loss_x loss_x 0.3635 (0.6214) acc_x 90.6250 (83.1250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 554
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:559
clean false:17
clean_rate:0.9704861111111112
noisy true:519
noisy false:537
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [23/200] batch [5/18] time 0.343 (0.343) data 0.266 (0.266) loss_x loss_x 0.8525 (0.7397) acc_x 75.0000 (79.3750) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/18] time 0.339 (0.343) data 0.262 (0.265) loss_x loss_x 0.9111 (0.6589) acc_x 78.1250 (84.0625) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/18] time 0.346 (0.333) data 0.268 (0.255) loss_x loss_x 0.3972 (0.6331) acc_x 87.5000 (83.7500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.3438, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 561
clean true:545
clean false:16
clean_rate:0.9714795008912656
noisy true:513
noisy false:558
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1071
epoch [24/200] batch [5/17] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.5366 (0.4937) acc_x 90.6250 (89.3750) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/17] time 0.337 (0.341) data 0.260 (0.264) loss_x loss_x 0.5850 (0.5640) acc_x 84.3750 (87.1875) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/17] time 0.340 (0.342) data 0.263 (0.264) loss_x loss_x 0.4250 (0.5756) acc_x 90.6250 (86.8750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 554
confident_label rate tensor(0.3480, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 568
clean true:552
clean false:16
clean_rate:0.971830985915493
noisy true:526
noisy false:538
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1064
epoch [25/200] batch [5/17] time 0.339 (0.317) data 0.262 (0.240) loss_x loss_x 0.6191 (0.5666) acc_x 84.3750 (86.2500) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/17] time 0.329 (0.324) data 0.252 (0.247) loss_x loss_x 0.6875 (0.5676) acc_x 81.2500 (85.3125) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/17] time 0.340 (0.328) data 0.263 (0.251) loss_x loss_x 0.5181 (0.5665) acc_x 84.3750 (85.4167) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 559
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:557
clean false:14
clean_rate:0.9754816112084063
noisy true:516
noisy false:545
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [26/200] batch [5/17] time 0.324 (0.316) data 0.246 (0.239) loss_x loss_x 0.9414 (0.5803) acc_x 81.2500 (89.3750) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/17] time 0.334 (0.331) data 0.257 (0.254) loss_x loss_x 0.5869 (0.6072) acc_x 93.7500 (88.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/17] time 0.340 (0.338) data 0.263 (0.260) loss_x loss_x 0.9604 (0.6117) acc_x 71.8750 (87.9167) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.3554, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 580
clean true:563
clean false:17
clean_rate:0.9706896551724138
noisy true:513
noisy false:539
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1052
epoch [27/200] batch [5/18] time 0.347 (0.358) data 0.269 (0.281) loss_x loss_x 0.4238 (0.5946) acc_x 90.6250 (85.0000) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/18] time 0.340 (0.344) data 0.263 (0.267) loss_x loss_x 0.6313 (0.5676) acc_x 87.5000 (85.3125) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/18] time 0.343 (0.344) data 0.265 (0.267) loss_x loss_x 0.5371 (0.5480) acc_x 90.6250 (86.4583) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 536
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:565
clean false:12
clean_rate:0.9792027729636048
noisy true:531
noisy false:524
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [28/200] batch [5/18] time 0.354 (0.353) data 0.277 (0.275) loss_x loss_x 0.4036 (0.5240) acc_x 90.6250 (86.8750) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/18] time 0.345 (0.344) data 0.268 (0.267) loss_x loss_x 0.4253 (0.5446) acc_x 90.6250 (85.9375) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/18] time 0.308 (0.336) data 0.230 (0.258) loss_x loss_x 0.7681 (0.5506) acc_x 81.2500 (86.2500) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 538
confident_label rate tensor(0.3560, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 581
clean true:566
clean false:15
clean_rate:0.9741824440619621
noisy true:528
noisy false:523
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1051
epoch [29/200] batch [5/18] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.3169 (0.4507) acc_x 96.8750 (91.8750) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/18] time 0.348 (0.348) data 0.271 (0.270) loss_x loss_x 0.4543 (0.5948) acc_x 90.6250 (88.4375) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/18] time 0.346 (0.348) data 0.268 (0.271) loss_x loss_x 0.4724 (0.6044) acc_x 90.6250 (86.2500) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 537
confident_label rate tensor(0.3591, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 586
clean true:567
clean false:19
clean_rate:0.9675767918088737
noisy true:528
noisy false:518
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1046
epoch [30/200] batch [5/18] time 0.314 (0.315) data 0.235 (0.237) loss_x loss_x 0.6494 (0.5010) acc_x 87.5000 (90.0000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/18] time 0.351 (0.328) data 0.273 (0.250) loss_x loss_x 0.3325 (0.5172) acc_x 93.7500 (89.0625) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/18] time 0.358 (0.336) data 0.280 (0.258) loss_x loss_x 0.2198 (0.5239) acc_x 100.0000 (89.1667) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 506
confident_label rate tensor(0.3634, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 593
clean true:577
clean false:16
clean_rate:0.9730185497470489
noisy true:549
noisy false:490
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1039
epoch [31/200] batch [5/18] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.7925 (0.6591) acc_x 75.0000 (83.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/18] time 0.311 (0.324) data 0.233 (0.246) loss_x loss_x 0.4050 (0.6132) acc_x 93.7500 (84.3750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/18] time 0.351 (0.326) data 0.274 (0.248) loss_x loss_x 0.4111 (0.5358) acc_x 90.6250 (86.2500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 525
confident_label rate tensor(0.3578, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 584
clean true:566
clean false:18
clean_rate:0.9691780821917808
noisy true:541
noisy false:507
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1048
epoch [32/200] batch [5/18] time 0.332 (0.344) data 0.254 (0.267) loss_x loss_x 0.9824 (0.6662) acc_x 81.2500 (86.2500) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/18] time 0.285 (0.335) data 0.207 (0.257) loss_x loss_x 0.4827 (0.5924) acc_x 84.3750 (84.6875) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/18] time 0.294 (0.323) data 0.217 (0.246) loss_x loss_x 0.7505 (0.5681) acc_x 84.3750 (85.6250) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 515
confident_label rate tensor(0.3627, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 592
clean true:577
clean false:15
clean_rate:0.9746621621621622
noisy true:540
noisy false:500
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1040
epoch [33/200] batch [5/18] time 0.335 (0.345) data 0.258 (0.267) loss_x loss_x 0.6875 (0.5867) acc_x 84.3750 (85.0000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/18] time 0.338 (0.349) data 0.261 (0.271) loss_x loss_x 0.5801 (0.5821) acc_x 84.3750 (85.6250) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/18] time 0.313 (0.338) data 0.236 (0.261) loss_x loss_x 0.4202 (0.5319) acc_x 90.6250 (86.6667) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 493
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 607
clean true:593
clean false:14
clean_rate:0.9769357495881383
noisy true:546
noisy false:479
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1025
epoch [34/200] batch [5/18] time 0.333 (0.342) data 0.256 (0.264) loss_x loss_x 0.4961 (0.5940) acc_x 84.3750 (81.8750) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/18] time 0.344 (0.339) data 0.267 (0.262) loss_x loss_x 0.4094 (0.5224) acc_x 87.5000 (85.9375) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/18] time 0.330 (0.340) data 0.252 (0.262) loss_x loss_x 0.8550 (0.5427) acc_x 81.2500 (86.2500) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 498
confident_label rate tensor(0.3701, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 604
clean true:588
clean false:16
clean_rate:0.9735099337748344
noisy true:546
noisy false:482
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1028
epoch [35/200] batch [5/18] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.4509 (0.5831) acc_x 93.7500 (83.1250) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/18] time 0.350 (0.342) data 0.273 (0.265) loss_x loss_x 0.3140 (0.5327) acc_x 96.8750 (86.5625) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/18] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.5776 (0.5277) acc_x 84.3750 (87.2917) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 504
confident_label rate tensor(0.3689, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 602
clean true:585
clean false:17
clean_rate:0.9717607973421927
noisy true:543
noisy false:487
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1030
epoch [36/200] batch [5/18] time 0.353 (0.343) data 0.276 (0.266) loss_x loss_x 0.6069 (0.5160) acc_x 90.6250 (88.7500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/18] time 0.350 (0.345) data 0.272 (0.268) loss_x loss_x 0.4773 (0.4241) acc_x 90.6250 (90.9375) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/18] time 0.347 (0.345) data 0.270 (0.268) loss_x loss_x 0.5220 (0.4579) acc_x 87.5000 (88.9583) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 494
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 611
clean true:596
clean false:15
clean_rate:0.9754500818330606
noisy true:542
noisy false:479
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1021
epoch [37/200] batch [5/19] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.5806 (0.6419) acc_x 81.2500 (82.5000) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/19] time 0.335 (0.346) data 0.258 (0.269) loss_x loss_x 0.5205 (0.5880) acc_x 87.5000 (86.2500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/19] time 0.330 (0.345) data 0.252 (0.267) loss_x loss_x 0.4634 (0.5647) acc_x 87.5000 (86.8750) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:601
clean false:14
clean_rate:0.9772357723577236
noisy true:559
noisy false:458
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [38/200] batch [5/19] time 0.349 (0.350) data 0.272 (0.273) loss_x loss_x 0.3948 (0.4333) acc_x 87.5000 (88.1250) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/19] time 0.331 (0.344) data 0.254 (0.266) loss_x loss_x 0.8550 (0.5937) acc_x 78.1250 (85.0000) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/19] time 0.332 (0.342) data 0.255 (0.265) loss_x loss_x 0.5190 (0.6096) acc_x 90.6250 (84.5833) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 460
confident_label rate tensor(0.3805, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 621
clean true:607
clean false:14
clean_rate:0.9774557165861514
noisy true:565
noisy false:446
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 1011
epoch [39/200] batch [5/19] time 0.289 (0.304) data 0.211 (0.226) loss_x loss_x 0.4485 (0.6605) acc_x 87.5000 (85.6250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/19] time 0.355 (0.325) data 0.278 (0.247) loss_x loss_x 0.5571 (0.5450) acc_x 84.3750 (88.4375) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/19] time 0.334 (0.330) data 0.257 (0.253) loss_x loss_x 0.3145 (0.5183) acc_x 87.5000 (87.9167) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.3897, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 636
clean true:621
clean false:15
clean_rate:0.9764150943396226
noisy true:549
noisy false:447
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 996
epoch [40/200] batch [5/19] time 0.297 (0.336) data 0.219 (0.259) loss_x loss_x 0.2922 (0.4774) acc_x 93.7500 (88.7500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/19] time 0.299 (0.319) data 0.221 (0.241) loss_x loss_x 0.4578 (0.4811) acc_x 90.6250 (89.3750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/19] time 0.332 (0.326) data 0.255 (0.249) loss_x loss_x 0.4536 (0.4646) acc_x 87.5000 (89.5833) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 458
confident_label rate tensor(0.3848, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 628
clean true:612
clean false:16
clean_rate:0.9745222929936306
noisy true:562
noisy false:442
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 1004
epoch [41/200] batch [5/19] time 0.346 (0.351) data 0.269 (0.274) loss_x loss_x 0.3333 (0.5408) acc_x 93.7500 (87.5000) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/19] time 0.356 (0.347) data 0.279 (0.270) loss_x loss_x 0.4287 (0.5072) acc_x 84.3750 (88.7500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/19] time 0.303 (0.342) data 0.225 (0.265) loss_x loss_x 0.7393 (0.5359) acc_x 87.5000 (88.1250) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.3848, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 628
clean true:604
clean false:24
clean_rate:0.9617834394904459
noisy true:556
noisy false:448
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 1004
epoch [42/200] batch [5/19] time 0.348 (0.355) data 0.271 (0.278) loss_x loss_x 0.4104 (0.5928) acc_x 90.6250 (87.5000) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/19] time 0.332 (0.344) data 0.255 (0.266) loss_x loss_x 0.2413 (0.4697) acc_x 90.6250 (90.0000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/19] time 0.340 (0.341) data 0.261 (0.264) loss_x loss_x 0.5293 (0.4885) acc_x 93.7500 (89.5833) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 447
confident_label rate tensor(0.3909, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 638
clean true:619
clean false:19
clean_rate:0.9702194357366771
noisy true:566
noisy false:428
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 994
epoch [43/200] batch [5/19] time 0.347 (0.352) data 0.270 (0.274) loss_x loss_x 0.7593 (0.5108) acc_x 84.3750 (87.5000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/19] time 0.333 (0.345) data 0.256 (0.268) loss_x loss_x 0.6567 (0.5129) acc_x 84.3750 (87.1875) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/19] time 0.327 (0.344) data 0.250 (0.267) loss_x loss_x 0.8447 (0.4996) acc_x 81.2500 (87.9167) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.3940, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 643
clean true:626
clean false:17
clean_rate:0.973561430793157
noisy true:572
noisy false:417
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 989
epoch [44/200] batch [5/20] time 0.355 (0.351) data 0.278 (0.274) loss_x loss_x 0.4456 (0.4668) acc_x 90.6250 (88.7500) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/20] time 0.356 (0.350) data 0.279 (0.272) loss_x loss_x 0.3586 (0.5518) acc_x 90.6250 (87.8125) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/20] time 0.337 (0.347) data 0.260 (0.270) loss_x loss_x 0.6841 (0.5452) acc_x 90.6250 (88.3333) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/20] time 0.361 (0.346) data 0.284 (0.269) loss_x loss_x 0.5654 (0.5345) acc_x 87.5000 (88.2812) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 422
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 650
clean true:630
clean false:20
clean_rate:0.9692307692307692
noisy true:580
noisy false:402
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 982
epoch [45/200] batch [5/20] time 0.334 (0.342) data 0.256 (0.264) loss_x loss_x 0.5146 (0.4759) acc_x 78.1250 (86.8750) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/20] time 0.332 (0.323) data 0.254 (0.246) loss_x loss_x 0.4714 (0.4953) acc_x 84.3750 (86.5625) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/20] time 0.337 (0.327) data 0.260 (0.249) loss_x loss_x 0.5703 (0.5127) acc_x 87.5000 (86.4583) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/20] time 0.353 (0.332) data 0.275 (0.255) loss_x loss_x 0.5918 (0.4998) acc_x 87.5000 (86.8750) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.3940, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 643
clean true:624
clean false:19
clean_rate:0.9704510108864697
noisy true:574
noisy false:415
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 989
epoch [46/200] batch [5/20] time 0.365 (0.353) data 0.287 (0.275) loss_x loss_x 0.5303 (0.4872) acc_x 90.6250 (86.8750) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/20] time 0.346 (0.349) data 0.269 (0.272) loss_x loss_x 0.4883 (0.4964) acc_x 84.3750 (86.8750) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/20] time 0.295 (0.335) data 0.217 (0.257) loss_x loss_x 0.6680 (0.5160) acc_x 87.5000 (87.5000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/20] time 0.345 (0.334) data 0.268 (0.257) loss_x loss_x 0.5562 (0.4912) acc_x 81.2500 (87.9688) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 445
confident_label rate tensor(0.3915, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 639
clean true:623
clean false:16
clean_rate:0.974960876369327
noisy true:564
noisy false:429
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 993
epoch [47/200] batch [5/19] time 0.348 (0.350) data 0.270 (0.272) loss_x loss_x 0.4199 (0.5519) acc_x 93.7500 (88.7500) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/19] time 0.352 (0.346) data 0.276 (0.269) loss_x loss_x 0.4382 (0.5240) acc_x 90.6250 (88.4375) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/19] time 0.304 (0.342) data 0.227 (0.265) loss_x loss_x 0.3628 (0.5031) acc_x 90.6250 (88.3333) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 433
confident_label rate tensor(0.3934, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 642
clean true:624
clean false:18
clean_rate:0.9719626168224299
noisy true:575
noisy false:415
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 990
epoch [48/200] batch [5/20] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.4402 (0.4453) acc_x 90.6250 (90.6250) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/20] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.4775 (0.4726) acc_x 81.2500 (89.6875) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/20] time 0.326 (0.339) data 0.248 (0.262) loss_x loss_x 1.0117 (0.5152) acc_x 78.1250 (87.7083) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/20] time 0.345 (0.340) data 0.267 (0.263) loss_x loss_x 0.4646 (0.5094) acc_x 87.5000 (87.1875) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 427
confident_label rate tensor(0.3940, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 643
clean true:624
clean false:19
clean_rate:0.9704510108864697
noisy true:581
noisy false:408
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 989
epoch [49/200] batch [5/20] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.8521 (0.5767) acc_x 75.0000 (85.6250) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/20] time 0.353 (0.349) data 0.274 (0.271) loss_x loss_x 0.5293 (0.5377) acc_x 84.3750 (87.1875) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/20] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.3291 (0.5193) acc_x 90.6250 (88.5417) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/20] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.4180 (0.5470) acc_x 84.3750 (86.8750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 431
confident_label rate tensor(0.3915, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 639
clean true:624
clean false:15
clean_rate:0.9765258215962441
noisy true:577
noisy false:416
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 993
epoch [50/200] batch [5/19] time 0.345 (0.352) data 0.268 (0.275) loss_x loss_x 0.6162 (0.3800) acc_x 87.5000 (92.5000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/19] time 0.328 (0.346) data 0.251 (0.269) loss_x loss_x 0.3127 (0.4259) acc_x 90.6250 (91.5625) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/19] time 0.331 (0.345) data 0.254 (0.268) loss_x loss_x 0.7769 (0.4654) acc_x 87.5000 (90.8333) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 426
confident_label rate tensor(0.4032, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 658
clean true:642
clean false:16
clean_rate:0.9756838905775076
noisy true:564
noisy false:410
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 974
epoch [51/200] batch [5/20] time 0.341 (0.349) data 0.264 (0.272) loss_x loss_x 0.5703 (0.4871) acc_x 87.5000 (88.1250) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/20] time 0.342 (0.345) data 0.264 (0.268) loss_x loss_x 0.4250 (0.4221) acc_x 90.6250 (90.6250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/20] time 0.359 (0.347) data 0.282 (0.269) loss_x loss_x 0.5923 (0.4692) acc_x 87.5000 (88.5417) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/20] time 0.352 (0.346) data 0.275 (0.268) loss_x loss_x 0.4043 (0.4727) acc_x 87.5000 (88.4375) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 437
confident_label rate tensor(0.3971, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 648
clean true:630
clean false:18
clean_rate:0.9722222222222222
noisy true:565
noisy false:419
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 984
epoch [52/200] batch [5/20] time 0.336 (0.347) data 0.258 (0.269) loss_x loss_x 0.5386 (0.5473) acc_x 87.5000 (87.5000) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/20] time 0.343 (0.345) data 0.266 (0.267) loss_x loss_x 0.4971 (0.5666) acc_x 90.6250 (87.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/20] time 0.325 (0.343) data 0.248 (0.266) loss_x loss_x 0.6895 (0.5416) acc_x 87.5000 (88.3333) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/20] time 0.337 (0.341) data 0.259 (0.263) loss_x loss_x 0.8721 (0.5454) acc_x 81.2500 (87.1875) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 443
confident_label rate tensor(0.3958, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 646
clean true:633
clean false:13
clean_rate:0.9798761609907121
noisy true:556
noisy false:430
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 986
epoch [53/200] batch [5/20] time 0.356 (0.339) data 0.279 (0.261) loss_x loss_x 0.4421 (0.4941) acc_x 90.6250 (88.7500) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/20] time 0.334 (0.327) data 0.257 (0.248) loss_x loss_x 0.5547 (0.4863) acc_x 84.3750 (89.0625) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/20] time 0.341 (0.331) data 0.263 (0.253) loss_x loss_x 0.2871 (0.5160) acc_x 93.7500 (87.0833) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/20] time 0.348 (0.334) data 0.271 (0.256) loss_x loss_x 0.4338 (0.4999) acc_x 96.8750 (88.1250) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.3977, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 649
clean true:631
clean false:18
clean_rate:0.9722650231124808
noisy true:580
noisy false:403
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 983
epoch [54/200] batch [5/20] time 0.338 (0.331) data 0.260 (0.253) loss_x loss_x 0.6895 (0.3982) acc_x 84.3750 (91.2500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/20] time 0.330 (0.335) data 0.252 (0.258) loss_x loss_x 0.4380 (0.4775) acc_x 93.7500 (89.6875) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/20] time 0.304 (0.326) data 0.226 (0.249) loss_x loss_x 0.3132 (0.4491) acc_x 96.8750 (90.2083) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/20] time 0.336 (0.324) data 0.259 (0.246) loss_x loss_x 0.3364 (0.4466) acc_x 90.6250 (90.0000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 380
confident_label rate tensor(0.4197, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 685
clean true:666
clean false:19
clean_rate:0.9722627737226277
noisy true:586
noisy false:361
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 947
epoch [55/200] batch [5/21] time 0.342 (0.351) data 0.265 (0.273) loss_x loss_x 0.3982 (0.4889) acc_x 90.6250 (88.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/21] time 0.339 (0.349) data 0.262 (0.271) loss_x loss_x 0.1602 (0.4561) acc_x 96.8750 (89.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/21] time 0.347 (0.347) data 0.268 (0.270) loss_x loss_x 0.8506 (0.4728) acc_x 87.5000 (90.0000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/21] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.2000 (0.4704) acc_x 96.8750 (90.1562) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 666
clean true:650
clean false:16
clean_rate:0.975975975975976
noisy true:566
noisy false:400
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 966
epoch [56/200] batch [5/20] time 0.349 (0.349) data 0.271 (0.271) loss_x loss_x 0.4587 (0.3992) acc_x 93.7500 (91.2500) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/20] time 0.344 (0.349) data 0.266 (0.272) loss_x loss_x 0.7769 (0.5200) acc_x 78.1250 (88.1250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/20] time 0.346 (0.349) data 0.269 (0.272) loss_x loss_x 0.3333 (0.4626) acc_x 93.7500 (89.7917) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/20] time 0.341 (0.347) data 0.264 (0.269) loss_x loss_x 0.5815 (0.4562) acc_x 84.3750 (90.1562) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 664
clean true:647
clean false:17
clean_rate:0.9743975903614458
noisy true:587
noisy false:381
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 968
epoch [57/200] batch [5/20] time 0.337 (0.340) data 0.260 (0.262) loss_x loss_x 0.4172 (0.4908) acc_x 90.6250 (88.1250) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/20] time 0.294 (0.326) data 0.216 (0.249) loss_x loss_x 0.4214 (0.5108) acc_x 93.7500 (88.4375) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/20] time 0.337 (0.326) data 0.260 (0.248) loss_x loss_x 0.4387 (0.4944) acc_x 93.7500 (88.9583) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/20] time 0.341 (0.330) data 0.264 (0.253) loss_x loss_x 0.3284 (0.4946) acc_x 90.6250 (88.5938) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 663
clean true:647
clean false:16
clean_rate:0.975867269984917
noisy true:593
noisy false:376
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 969
epoch [58/200] batch [5/20] time 0.342 (0.343) data 0.265 (0.266) loss_x loss_x 0.4299 (0.3797) acc_x 87.5000 (91.8750) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/20] time 0.348 (0.339) data 0.270 (0.262) loss_x loss_x 0.1974 (0.3866) acc_x 96.8750 (91.8750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/20] time 0.298 (0.332) data 0.221 (0.255) loss_x loss_x 0.5894 (0.4016) acc_x 84.3750 (91.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/20] time 0.292 (0.327) data 0.215 (0.250) loss_x loss_x 0.7358 (0.4426) acc_x 84.3750 (90.1562) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 388
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 667
clean true:649
clean false:18
clean_rate:0.9730134932533733
noisy true:595
noisy false:370
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 965
epoch [59/200] batch [5/20] time 0.349 (0.347) data 0.272 (0.270) loss_x loss_x 0.6235 (0.5236) acc_x 84.3750 (89.3750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/20] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.4656 (0.5183) acc_x 93.7500 (89.3750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/20] time 0.364 (0.351) data 0.287 (0.274) loss_x loss_x 0.5024 (0.5117) acc_x 87.5000 (88.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/20] time 0.349 (0.350) data 0.272 (0.273) loss_x loss_x 0.8306 (0.5224) acc_x 78.1250 (87.3438) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 667
clean true:652
clean false:15
clean_rate:0.9775112443778111
noisy true:576
noisy false:389
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 965
epoch [60/200] batch [5/20] time 0.348 (0.355) data 0.270 (0.276) loss_x loss_x 0.4941 (0.3615) acc_x 87.5000 (91.8750) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/20] time 0.312 (0.369) data 0.233 (0.290) loss_x loss_x 0.6191 (0.4109) acc_x 78.1250 (90.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/20] time 0.382 (0.363) data 0.302 (0.285) loss_x loss_x 0.2417 (0.4120) acc_x 96.8750 (90.2083) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/20] time 0.370 (0.367) data 0.292 (0.288) loss_x loss_x 0.5435 (0.4331) acc_x 84.3750 (89.6875) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.4118, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 672
clean true:653
clean false:19
clean_rate:0.9717261904761905
noisy true:581
noisy false:379
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 960
epoch [61/200] batch [5/21] time 0.342 (0.350) data 0.264 (0.272) loss_x loss_x 0.6328 (0.5027) acc_x 81.2500 (87.5000) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/21] time 0.357 (0.350) data 0.279 (0.272) loss_x loss_x 0.3904 (0.4734) acc_x 90.6250 (89.0625) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/21] time 0.352 (0.350) data 0.274 (0.272) loss_x loss_x 0.7891 (0.4779) acc_x 78.1250 (88.5417) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/21] time 0.342 (0.348) data 0.265 (0.270) loss_x loss_x 0.4280 (0.4812) acc_x 90.6250 (88.5938) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:651
clean false:14
clean_rate:0.9789473684210527
noisy true:594
noisy false:373
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [62/200] batch [5/20] time 0.347 (0.362) data 0.270 (0.285) loss_x loss_x 0.2544 (0.2959) acc_x 93.7500 (96.8750) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/20] time 0.336 (0.354) data 0.259 (0.276) loss_x loss_x 0.5337 (0.3471) acc_x 90.6250 (94.3750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/20] time 0.366 (0.352) data 0.287 (0.274) loss_x loss_x 0.3850 (0.3895) acc_x 90.6250 (92.7083) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/20] time 0.320 (0.347) data 0.242 (0.269) loss_x loss_x 0.3965 (0.4051) acc_x 90.6250 (91.5625) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 381
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 667
clean true:655
clean false:12
clean_rate:0.9820089955022488
noisy true:596
noisy false:369
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 965
epoch [63/200] batch [5/20] time 0.358 (0.358) data 0.280 (0.280) loss_x loss_x 0.2864 (0.3301) acc_x 96.8750 (95.0000) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/20] time 0.346 (0.352) data 0.268 (0.274) loss_x loss_x 0.2939 (0.3743) acc_x 96.8750 (93.1250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/20] time 0.344 (0.349) data 0.265 (0.271) loss_x loss_x 0.1796 (0.3586) acc_x 100.0000 (93.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/20] time 0.294 (0.339) data 0.217 (0.261) loss_x loss_x 0.5581 (0.4026) acc_x 87.5000 (91.5625) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 365
confident_label rate tensor(0.4203, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 686
clean true:671
clean false:15
clean_rate:0.978134110787172
noisy true:596
noisy false:350
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 946
epoch [64/200] batch [5/21] time 0.338 (0.348) data 0.260 (0.271) loss_x loss_x 0.3110 (0.4762) acc_x 96.8750 (90.0000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/21] time 0.345 (0.347) data 0.267 (0.270) loss_x loss_x 0.5654 (0.4387) acc_x 90.6250 (91.8750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/21] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.2642 (0.4238) acc_x 93.7500 (91.4583) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/21] time 0.299 (0.338) data 0.221 (0.260) loss_x loss_x 0.3799 (0.4179) acc_x 90.6250 (91.5625) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.4246, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 693
clean true:679
clean false:14
clean_rate:0.9797979797979798
noisy true:596
noisy false:343
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 939
epoch [65/200] batch [5/21] time 0.345 (0.353) data 0.267 (0.275) loss_x loss_x 0.4270 (0.3506) acc_x 93.7500 (93.1250) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/21] time 0.338 (0.351) data 0.260 (0.273) loss_x loss_x 0.6489 (0.4120) acc_x 81.2500 (90.0000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/21] time 0.300 (0.345) data 0.223 (0.268) loss_x loss_x 0.2620 (0.4090) acc_x 96.8750 (91.0417) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/21] time 0.326 (0.340) data 0.248 (0.262) loss_x loss_x 0.6138 (0.4157) acc_x 84.3750 (90.9375) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.4185, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 683
clean true:670
clean false:13
clean_rate:0.9809663250366032
noisy true:605
noisy false:344
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 949
epoch [66/200] batch [5/21] time 0.344 (0.347) data 0.268 (0.270) loss_x loss_x 0.2773 (0.3541) acc_x 90.6250 (91.2500) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/21] time 0.292 (0.336) data 0.215 (0.259) loss_x loss_x 0.3066 (0.3300) acc_x 90.6250 (93.4375) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/21] time 0.346 (0.338) data 0.268 (0.261) loss_x loss_x 0.6143 (0.3806) acc_x 81.2500 (90.2083) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/21] time 0.363 (0.339) data 0.284 (0.262) loss_x loss_x 0.3777 (0.3878) acc_x 87.5000 (90.1562) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.4203, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 686
clean true:671
clean false:15
clean_rate:0.978134110787172
noisy true:606
noisy false:340
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 946
epoch [67/200] batch [5/21] time 0.378 (0.360) data 0.299 (0.281) loss_x loss_x 0.3328 (0.3269) acc_x 90.6250 (91.2500) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/21] time 0.344 (0.353) data 0.265 (0.274) loss_x loss_x 0.4468 (0.3475) acc_x 90.6250 (91.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/21] time 0.352 (0.343) data 0.273 (0.264) loss_x loss_x 0.6240 (0.4120) acc_x 84.3750 (91.0417) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/21] time 0.341 (0.345) data 0.263 (0.266) loss_x loss_x 0.5581 (0.4154) acc_x 81.2500 (90.9375) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 350
confident_label rate tensor(0.4216, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 688
clean true:674
clean false:14
clean_rate:0.9796511627906976
noisy true:608
noisy false:336
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 944
epoch [68/200] batch [5/21] time 0.346 (0.318) data 0.268 (0.240) loss_x loss_x 0.2690 (0.3653) acc_x 93.7500 (91.8750) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/21] time 0.348 (0.334) data 0.269 (0.257) loss_x loss_x 0.7358 (0.3999) acc_x 84.3750 (90.9375) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/21] time 0.338 (0.339) data 0.261 (0.261) loss_x loss_x 1.0654 (0.4374) acc_x 75.0000 (89.7917) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/21] time 0.305 (0.336) data 0.228 (0.258) loss_x loss_x 0.4949 (0.4365) acc_x 84.3750 (89.6875) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.4203, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 686
clean true:671
clean false:15
clean_rate:0.978134110787172
noisy true:601
noisy false:345
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 946
epoch [69/200] batch [5/21] time 0.338 (0.348) data 0.260 (0.270) loss_x loss_x 0.5400 (0.4786) acc_x 81.2500 (85.0000) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/21] time 0.338 (0.345) data 0.261 (0.267) loss_x loss_x 0.4385 (0.4420) acc_x 87.5000 (88.4375) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/21] time 0.332 (0.345) data 0.253 (0.267) loss_x loss_x 0.5635 (0.4298) acc_x 84.3750 (88.7500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/21] time 0.342 (0.344) data 0.265 (0.267) loss_x loss_x 0.2988 (0.4348) acc_x 96.8750 (89.8438) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 701
clean true:687
clean false:14
clean_rate:0.9800285306704708
noisy true:604
noisy false:327
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 931
epoch [70/200] batch [5/21] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.3596 (0.2787) acc_x 96.8750 (94.3750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/21] time 0.349 (0.349) data 0.271 (0.272) loss_x loss_x 0.6416 (0.4293) acc_x 84.3750 (90.3125) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/21] time 0.335 (0.348) data 0.258 (0.270) loss_x loss_x 0.2264 (0.3758) acc_x 96.8750 (91.6667) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/21] time 0.348 (0.346) data 0.270 (0.269) loss_x loss_x 0.3789 (0.3767) acc_x 87.5000 (91.8750) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.4203, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 686
clean true:673
clean false:13
clean_rate:0.9810495626822158
noisy true:604
noisy false:342
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 946
epoch [71/200] batch [5/21] time 0.361 (0.353) data 0.283 (0.275) loss_x loss_x 0.3560 (0.4473) acc_x 90.6250 (88.7500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/21] time 0.355 (0.348) data 0.277 (0.271) loss_x loss_x 0.3577 (0.4571) acc_x 93.7500 (89.0625) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/21] time 0.334 (0.346) data 0.257 (0.269) loss_x loss_x 0.5352 (0.4626) acc_x 84.3750 (88.9583) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/21] time 0.331 (0.346) data 0.254 (0.268) loss_x loss_x 0.5742 (0.4581) acc_x 84.3750 (89.2188) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 708
clean true:692
clean false:16
clean_rate:0.9774011299435028
noisy true:617
noisy false:307
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 924
epoch [72/200] batch [5/22] time 0.345 (0.344) data 0.268 (0.267) loss_x loss_x 0.2465 (0.4425) acc_x 96.8750 (90.0000) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/22] time 0.334 (0.340) data 0.257 (0.263) loss_x loss_x 0.2725 (0.3896) acc_x 93.7500 (90.6250) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/22] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.7002 (0.3808) acc_x 87.5000 (90.8333) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/22] time 0.334 (0.342) data 0.257 (0.264) loss_x loss_x 0.6216 (0.4091) acc_x 84.3750 (90.6250) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 334
confident_label rate tensor(0.4271, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 697
clean true:682
clean false:15
clean_rate:0.9784791965566715
noisy true:616
noisy false:319
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 935
epoch [73/200] batch [5/21] time 0.336 (0.346) data 0.258 (0.268) loss_x loss_x 0.6235 (0.4873) acc_x 81.2500 (86.8750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/21] time 0.324 (0.341) data 0.246 (0.264) loss_x loss_x 0.1925 (0.4211) acc_x 100.0000 (90.6250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/21] time 0.378 (0.347) data 0.301 (0.269) loss_x loss_x 0.5381 (0.4264) acc_x 90.6250 (90.4167) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/21] time 0.339 (0.345) data 0.262 (0.267) loss_x loss_x 0.3801 (0.4282) acc_x 90.6250 (90.3125) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 336
confident_label rate tensor(0.4277, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 698
clean true:683
clean false:15
clean_rate:0.9785100286532952
noisy true:613
noisy false:321
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 934
epoch [74/200] batch [5/21] time 0.362 (0.343) data 0.285 (0.265) loss_x loss_x 0.2827 (0.4319) acc_x 96.8750 (91.8750) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/21] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.5107 (0.4760) acc_x 87.5000 (90.9375) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/21] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.6133 (0.4744) acc_x 87.5000 (91.0417) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/21] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.5713 (0.4566) acc_x 84.3750 (91.2500) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.4252, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 694
clean true:679
clean false:15
clean_rate:0.978386167146974
noisy true:616
noisy false:322
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 938
epoch [75/200] batch [5/21] time 0.330 (0.342) data 0.253 (0.265) loss_x loss_x 0.4727 (0.4232) acc_x 90.6250 (90.0000) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/21] time 0.293 (0.336) data 0.215 (0.259) loss_x loss_x 0.7910 (0.4989) acc_x 90.6250 (89.6875) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/21] time 0.334 (0.338) data 0.257 (0.260) loss_x loss_x 0.3787 (0.4575) acc_x 93.7500 (90.2083) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/21] time 0.351 (0.340) data 0.274 (0.263) loss_x loss_x 0.2927 (0.4585) acc_x 96.8750 (90.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.4265, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 696
clean true:685
clean false:11
clean_rate:0.9841954022988506
noisy true:605
noisy false:331
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 936
epoch [76/200] batch [5/21] time 0.341 (0.354) data 0.264 (0.277) loss_x loss_x 0.3091 (0.3856) acc_x 93.7500 (90.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/21] time 0.345 (0.349) data 0.267 (0.272) loss_x loss_x 0.2209 (0.3546) acc_x 93.7500 (91.5625) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/21] time 0.338 (0.345) data 0.260 (0.268) loss_x loss_x 0.5181 (0.3844) acc_x 90.6250 (91.4583) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/21] time 0.349 (0.346) data 0.271 (0.269) loss_x loss_x 0.3701 (0.4137) acc_x 93.7500 (90.4688) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.4259, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 695
clean true:682
clean false:13
clean_rate:0.981294964028777
noisy true:612
noisy false:325
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 937
epoch [77/200] batch [5/21] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.4470 (0.4453) acc_x 90.6250 (90.6250) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/21] time 0.335 (0.345) data 0.258 (0.267) loss_x loss_x 0.3335 (0.3854) acc_x 93.7500 (91.5625) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/21] time 0.302 (0.334) data 0.224 (0.257) loss_x loss_x 0.5127 (0.4203) acc_x 87.5000 (90.4167) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/21] time 0.323 (0.328) data 0.246 (0.251) loss_x loss_x 0.5176 (0.4132) acc_x 87.5000 (90.7812) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.4326, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 706
clean true:693
clean false:13
clean_rate:0.9815864022662889
noisy true:614
noisy false:312
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 926
epoch [78/200] batch [5/22] time 0.328 (0.341) data 0.250 (0.263) loss_x loss_x 0.3379 (0.4000) acc_x 90.6250 (88.1250) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/22] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.5713 (0.4012) acc_x 90.6250 (90.3125) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/22] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.2476 (0.3749) acc_x 93.7500 (91.4583) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/22] time 0.351 (0.340) data 0.273 (0.262) loss_x loss_x 0.4534 (0.3866) acc_x 93.7500 (91.5625) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 312
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:700
clean false:13
clean_rate:0.9817671809256662
noisy true:620
noisy false:299
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [79/200] batch [5/22] time 0.345 (0.342) data 0.267 (0.265) loss_x loss_x 0.5850 (0.4003) acc_x 84.3750 (89.3750) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/22] time 0.320 (0.336) data 0.243 (0.259) loss_x loss_x 0.4526 (0.4542) acc_x 84.3750 (88.7500) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/22] time 0.351 (0.338) data 0.273 (0.261) loss_x loss_x 0.6851 (0.4481) acc_x 84.3750 (90.2083) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/22] time 0.311 (0.337) data 0.234 (0.260) loss_x loss_x 0.4326 (0.4417) acc_x 90.6250 (90.0000) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 715
clean true:699
clean false:16
clean_rate:0.9776223776223776
noisy true:643
noisy false:274
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 917
epoch [80/200] batch [5/22] time 0.357 (0.352) data 0.280 (0.275) loss_x loss_x 0.3601 (0.4196) acc_x 93.7500 (91.2500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/22] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.5210 (0.4026) acc_x 93.7500 (91.8750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/22] time 0.321 (0.341) data 0.243 (0.264) loss_x loss_x 0.7358 (0.4287) acc_x 75.0000 (90.8333) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/22] time 0.336 (0.336) data 0.259 (0.259) loss_x loss_x 0.2295 (0.4290) acc_x 93.7500 (90.0000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 334
confident_label rate tensor(0.4314, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 704
clean true:690
clean false:14
clean_rate:0.9801136363636364
noisy true:608
noisy false:320
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 928
epoch [81/200] batch [5/22] time 0.352 (0.363) data 0.275 (0.285) loss_x loss_x 0.3459 (0.3619) acc_x 87.5000 (89.3750) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [10/22] time 0.319 (0.351) data 0.241 (0.274) loss_x loss_x 0.2686 (0.3275) acc_x 90.6250 (90.9375) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/22] time 0.340 (0.347) data 0.262 (0.270) loss_x loss_x 0.2939 (0.3518) acc_x 93.7500 (91.0417) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/22] time 0.331 (0.347) data 0.253 (0.269) loss_x loss_x 0.4680 (0.3733) acc_x 84.3750 (90.6250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 324
confident_label rate tensor(0.4326, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 706
clean true:692
clean false:14
clean_rate:0.9801699716713881
noisy true:616
noisy false:310
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 926
epoch [82/200] batch [5/22] time 0.333 (0.333) data 0.256 (0.256) loss_x loss_x 0.6089 (0.4209) acc_x 81.2500 (90.0000) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/22] time 0.352 (0.333) data 0.275 (0.255) loss_x loss_x 0.2244 (0.3926) acc_x 93.7500 (90.9375) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/22] time 0.344 (0.336) data 0.267 (0.258) loss_x loss_x 0.3738 (0.3786) acc_x 93.7500 (90.8333) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/22] time 0.327 (0.338) data 0.249 (0.261) loss_x loss_x 0.5010 (0.3926) acc_x 87.5000 (90.7812) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 285
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:714
clean false:12
clean_rate:0.9834710743801653
noisy true:633
noisy false:273
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [83/200] batch [5/22] time 0.323 (0.321) data 0.246 (0.243) loss_x loss_x 0.6099 (0.5253) acc_x 84.3750 (83.1250) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/22] time 0.383 (0.333) data 0.305 (0.255) loss_x loss_x 0.3689 (0.4490) acc_x 93.7500 (87.1875) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/22] time 0.363 (0.340) data 0.284 (0.262) loss_x loss_x 0.5811 (0.4370) acc_x 90.6250 (88.5417) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/22] time 0.393 (0.347) data 0.315 (0.268) loss_x loss_x 0.4111 (0.4408) acc_x 93.7500 (88.9062) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 317
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 710
clean true:694
clean false:16
clean_rate:0.9774647887323944
noisy true:621
noisy false:301
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 922
epoch [84/200] batch [5/22] time 0.340 (0.318) data 0.262 (0.240) loss_x loss_x 0.3176 (0.3923) acc_x 96.8750 (90.0000) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/22] time 0.356 (0.332) data 0.278 (0.254) loss_x loss_x 0.3459 (0.3913) acc_x 90.6250 (90.6250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/22] time 0.347 (0.336) data 0.270 (0.259) loss_x loss_x 0.2004 (0.4191) acc_x 96.8750 (89.5833) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/22] time 0.347 (0.340) data 0.270 (0.262) loss_x loss_x 0.5513 (0.4100) acc_x 81.2500 (90.0000) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 718
clean true:703
clean false:15
clean_rate:0.979108635097493
noisy true:636
noisy false:278
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 914
epoch [85/200] batch [5/22] time 0.297 (0.333) data 0.219 (0.256) loss_x loss_x 0.2910 (0.3031) acc_x 96.8750 (95.0000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/22] time 0.306 (0.330) data 0.227 (0.252) loss_x loss_x 0.2397 (0.3694) acc_x 100.0000 (91.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/22] time 0.337 (0.333) data 0.260 (0.255) loss_x loss_x 0.2190 (0.3509) acc_x 96.8750 (92.0833) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/22] time 0.342 (0.331) data 0.265 (0.253) loss_x loss_x 0.3845 (0.3635) acc_x 96.8750 (91.8750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 314
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 714
clean true:696
clean false:18
clean_rate:0.9747899159663865
noisy true:622
noisy false:296
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 918
epoch [86/200] batch [5/22] time 0.338 (0.356) data 0.260 (0.278) loss_x loss_x 0.5718 (0.3972) acc_x 87.5000 (91.8750) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [10/22] time 0.353 (0.351) data 0.274 (0.272) loss_x loss_x 0.7095 (0.4192) acc_x 81.2500 (90.6250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/22] time 0.338 (0.352) data 0.260 (0.273) loss_x loss_x 0.3508 (0.4474) acc_x 87.5000 (89.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/22] time 0.366 (0.353) data 0.288 (0.274) loss_x loss_x 0.1899 (0.4112) acc_x 96.8750 (90.1562) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 307
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 727
clean true:710
clean false:17
clean_rate:0.9766162310866575
noisy true:615
noisy false:290
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 905
epoch [87/200] batch [5/22] time 0.340 (0.345) data 0.262 (0.268) loss_x loss_x 0.2788 (0.4332) acc_x 93.7500 (86.8750) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/22] time 0.347 (0.348) data 0.270 (0.270) loss_x loss_x 0.5327 (0.4127) acc_x 87.5000 (89.3750) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/22] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.3472 (0.4041) acc_x 90.6250 (90.0000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/22] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.4668 (0.3988) acc_x 87.5000 (90.3125) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:712
clean false:14
clean_rate:0.9807162534435262
noisy true:633
noisy false:273
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [88/200] batch [5/22] time 0.340 (0.347) data 0.263 (0.269) loss_x loss_x 0.5522 (0.3766) acc_x 84.3750 (90.6250) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/22] time 0.295 (0.340) data 0.216 (0.262) loss_x loss_x 0.3865 (0.3802) acc_x 87.5000 (90.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/22] time 0.358 (0.340) data 0.281 (0.262) loss_x loss_x 0.2478 (0.3632) acc_x 93.7500 (90.8333) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/22] time 0.342 (0.342) data 0.265 (0.264) loss_x loss_x 0.3733 (0.3820) acc_x 90.6250 (90.9375) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 307
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:701
clean false:19
clean_rate:0.9736111111111111
noisy true:624
noisy false:288
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [89/200] batch [5/22] time 0.351 (0.357) data 0.273 (0.279) loss_x loss_x 0.3494 (0.3805) acc_x 87.5000 (88.7500) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [10/22] time 0.318 (0.335) data 0.239 (0.258) loss_x loss_x 0.3125 (0.3539) acc_x 96.8750 (90.6250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/22] time 0.328 (0.332) data 0.250 (0.254) loss_x loss_x 0.3113 (0.3605) acc_x 90.6250 (91.0417) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/22] time 0.339 (0.334) data 0.261 (0.256) loss_x loss_x 0.1765 (0.3620) acc_x 100.0000 (91.7188) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 300
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:707
clean false:13
clean_rate:0.9819444444444444
noisy true:625
noisy false:287
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [90/200] batch [5/22] time 0.296 (0.341) data 0.218 (0.263) loss_x loss_x 0.1372 (0.3709) acc_x 100.0000 (93.1250) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/22] time 0.345 (0.339) data 0.268 (0.261) loss_x loss_x 0.3472 (0.3415) acc_x 96.8750 (93.1250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/22] time 0.345 (0.339) data 0.268 (0.261) loss_x loss_x 0.2479 (0.3602) acc_x 96.8750 (92.5000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/22] time 0.349 (0.341) data 0.272 (0.263) loss_x loss_x 0.2273 (0.3690) acc_x 96.8750 (92.3438) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 305
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 709
clean true:697
clean false:12
clean_rate:0.9830747531734838
noisy true:630
noisy false:293
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 923
epoch [91/200] batch [5/22] time 0.334 (0.337) data 0.257 (0.260) loss_x loss_x 0.3643 (0.3393) acc_x 90.6250 (93.7500) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/22] time 0.335 (0.325) data 0.257 (0.248) loss_x loss_x 0.4666 (0.3311) acc_x 87.5000 (93.4375) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/22] time 0.337 (0.332) data 0.259 (0.255) loss_x loss_x 0.2949 (0.3235) acc_x 96.8750 (93.9583) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/22] time 0.344 (0.332) data 0.267 (0.255) loss_x loss_x 0.3044 (0.3447) acc_x 90.6250 (92.5000) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 719
clean true:704
clean false:15
clean_rate:0.9791376912378303
noisy true:636
noisy false:277
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 913
epoch [92/200] batch [5/22] time 0.341 (0.341) data 0.264 (0.263) loss_x loss_x 0.3972 (0.4027) acc_x 90.6250 (90.6250) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/22] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.4072 (0.3686) acc_x 84.3750 (91.5625) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/22] time 0.328 (0.342) data 0.251 (0.265) loss_x loss_x 0.2649 (0.3490) acc_x 90.6250 (92.0833) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/22] time 0.355 (0.338) data 0.278 (0.261) loss_x loss_x 0.4492 (0.3727) acc_x 90.6250 (92.0312) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.4320, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 705
clean true:692
clean false:13
clean_rate:0.9815602836879432
noisy true:639
noisy false:288
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 927
epoch [93/200] batch [5/22] time 0.342 (0.350) data 0.265 (0.273) loss_x loss_x 0.1991 (0.3590) acc_x 100.0000 (90.6250) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/22] time 0.340 (0.348) data 0.263 (0.270) loss_x loss_x 0.5815 (0.3924) acc_x 84.3750 (89.0625) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/22] time 0.344 (0.346) data 0.267 (0.268) loss_x loss_x 0.4602 (0.3777) acc_x 96.8750 (90.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/22] time 0.297 (0.335) data 0.219 (0.258) loss_x loss_x 0.3530 (0.3669) acc_x 93.7500 (90.9375) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 313
confident_label rate tensor(0.4326, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 706
clean true:693
clean false:13
clean_rate:0.9815864022662889
noisy true:626
noisy false:300
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 926
epoch [94/200] batch [5/22] time 0.353 (0.356) data 0.275 (0.278) loss_x loss_x 0.2216 (0.3431) acc_x 93.7500 (90.6250) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [10/22] time 0.336 (0.351) data 0.259 (0.273) loss_x loss_x 0.6392 (0.4558) acc_x 81.2500 (88.1250) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/22] time 0.350 (0.343) data 0.273 (0.265) loss_x loss_x 0.4309 (0.4201) acc_x 90.6250 (89.1667) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/22] time 0.300 (0.341) data 0.222 (0.263) loss_x loss_x 0.6216 (0.4191) acc_x 84.3750 (89.2188) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:697
clean false:16
clean_rate:0.9775596072931276
noisy true:620
noisy false:299
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [95/200] batch [5/22] time 0.347 (0.348) data 0.270 (0.271) loss_x loss_x 0.1273 (0.3132) acc_x 100.0000 (93.7500) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/22] time 0.343 (0.348) data 0.266 (0.271) loss_x loss_x 0.5405 (0.3718) acc_x 81.2500 (91.2500) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/22] time 0.369 (0.351) data 0.290 (0.273) loss_x loss_x 0.4675 (0.3773) acc_x 87.5000 (91.2500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/22] time 0.358 (0.348) data 0.280 (0.271) loss_x loss_x 0.7524 (0.4417) acc_x 75.0000 (89.3750) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 710
clean true:699
clean false:11
clean_rate:0.9845070422535211
noisy true:634
noisy false:288
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 922
epoch [96/200] batch [5/22] time 0.360 (0.354) data 0.282 (0.277) loss_x loss_x 0.4707 (0.3770) acc_x 87.5000 (92.5000) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [10/22] time 0.331 (0.351) data 0.254 (0.273) loss_x loss_x 0.5415 (0.3734) acc_x 87.5000 (92.8125) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/22] time 0.345 (0.349) data 0.267 (0.271) loss_x loss_x 0.2440 (0.3640) acc_x 96.8750 (92.0833) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/22] time 0.306 (0.342) data 0.228 (0.264) loss_x loss_x 0.3896 (0.3692) acc_x 87.5000 (92.0312) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 288
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:713
clean false:11
clean_rate:0.9848066298342542
noisy true:631
noisy false:277
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [97/200] batch [5/22] time 0.343 (0.356) data 0.265 (0.278) loss_x loss_x 0.2957 (0.3723) acc_x 96.8750 (90.6250) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [10/22] time 0.323 (0.351) data 0.245 (0.273) loss_x loss_x 0.8467 (0.3598) acc_x 90.6250 (92.8125) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/22] time 0.346 (0.350) data 0.269 (0.273) loss_x loss_x 0.3245 (0.3548) acc_x 90.6250 (92.5000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/22] time 0.304 (0.344) data 0.227 (0.266) loss_x loss_x 0.3843 (0.3404) acc_x 87.5000 (92.6562) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:709
clean false:15
clean_rate:0.9792817679558011
noisy true:628
noisy false:280
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [98/200] batch [5/22] time 0.344 (0.353) data 0.266 (0.275) loss_x loss_x 0.4192 (0.4132) acc_x 87.5000 (90.0000) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/22] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.1783 (0.4308) acc_x 93.7500 (89.0625) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/22] time 0.360 (0.348) data 0.282 (0.270) loss_x loss_x 0.1656 (0.4156) acc_x 96.8750 (89.5833) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/22] time 0.370 (0.350) data 0.293 (0.272) loss_x loss_x 0.4592 (0.4309) acc_x 84.3750 (89.2188) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:711
clean false:13
clean_rate:0.9820441988950276
noisy true:622
noisy false:286
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [99/200] batch [5/22] time 0.364 (0.366) data 0.286 (0.289) loss_x loss_x 0.2052 (0.4409) acc_x 93.7500 (90.6250) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [10/22] time 0.295 (0.345) data 0.218 (0.268) loss_x loss_x 0.5645 (0.4099) acc_x 78.1250 (90.6250) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/22] time 0.302 (0.341) data 0.224 (0.263) loss_x loss_x 0.2014 (0.3793) acc_x 96.8750 (90.6250) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/22] time 0.297 (0.334) data 0.219 (0.256) loss_x loss_x 0.6929 (0.4214) acc_x 78.1250 (89.3750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 727
clean true:712
clean false:15
clean_rate:0.9793672627235214
noisy true:637
noisy false:268
all clean rate:  [0.9747474747474747, 0.9719626168224299, 0.9955056179775281, 0.9932279909706546, 0.9821029082774049, 0.990990990990991, 0.9935760171306209, 0.9813278008298755, 0.9875259875259875, 0.9835728952772074, 0.9721115537848606, 0.9870410367170627, 0.9859154929577465, 0.9880952380952381, 0.9838383838383838, 0.9883495145631068, 0.9806201550387597, 0.9813432835820896, 0.9764492753623188, 0.9795158286778398, 0.9746376811594203, 0.9730700179533214, 0.9704861111111112, 0.9714795008912656, 0.971830985915493, 0.9754816112084063, 0.9706896551724138, 0.9792027729636048, 0.9741824440619621, 0.9675767918088737, 0.9730185497470489, 0.9691780821917808, 0.9746621621621622, 0.9769357495881383, 0.9735099337748344, 0.9717607973421927, 0.9754500818330606, 0.9772357723577236, 0.9774557165861514, 0.9764150943396226, 0.9745222929936306, 0.9617834394904459, 0.9702194357366771, 0.973561430793157, 0.9692307692307692, 0.9704510108864697, 0.974960876369327, 0.9719626168224299, 0.9704510108864697, 0.9765258215962441, 0.9756838905775076, 0.9722222222222222, 0.9798761609907121, 0.9722650231124808, 0.9722627737226277, 0.975975975975976, 0.9743975903614458, 0.975867269984917, 0.9730134932533733, 0.9775112443778111, 0.9717261904761905, 0.9789473684210527, 0.9820089955022488, 0.978134110787172, 0.9797979797979798, 0.9809663250366032, 0.978134110787172, 0.9796511627906976, 0.978134110787172, 0.9800285306704708, 0.9810495626822158, 0.9774011299435028, 0.9784791965566715, 0.9785100286532952, 0.978386167146974, 0.9841954022988506, 0.981294964028777, 0.9815864022662889, 0.9817671809256662, 0.9776223776223776, 0.9801136363636364, 0.9801699716713881, 0.9834710743801653, 0.9774647887323944, 0.979108635097493, 0.9747899159663865, 0.9766162310866575, 0.9807162534435262, 0.9736111111111111, 0.9819444444444444, 0.9830747531734838, 0.9791376912378303, 0.9815602836879432, 0.9815864022662889, 0.9775596072931276, 0.9845070422535211, 0.9848066298342542, 0.9792817679558011, 0.9820441988950276, 0.9793672627235214]
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 905
epoch [100/200] batch [5/22] time 0.310 (0.336) data 0.232 (0.259) loss_x loss_x 0.5850 (0.5373) acc_x 87.5000 (90.0000) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/22] time 0.342 (0.334) data 0.265 (0.257) loss_x loss_x 0.1525 (0.4323) acc_x 100.0000 (91.5625) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/22] time 0.318 (0.338) data 0.240 (0.261) loss_x loss_x 0.2280 (0.3804) acc_x 90.6250 (92.0833) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/22] time 0.341 (0.330) data 0.262 (0.253) loss_x loss_x 0.6182 (0.3935) acc_x 81.2500 (91.4062) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:708
clean false:16
clean_rate:0.9779005524861878
noisy true:623
noisy false:285
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [101/200] batch [5/22] time 0.342 (0.345) data 0.264 (0.267) loss_x loss_x 0.1571 (0.3280) acc_x 100.0000 (94.3750) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/22] time 0.341 (0.343) data 0.263 (0.266) loss_x loss_x 0.3347 (0.3271) acc_x 93.7500 (92.8125) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/22] time 0.346 (0.341) data 0.268 (0.264) loss_x loss_x 0.4436 (0.4033) acc_x 87.5000 (91.2500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/22] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.3535 (0.4129) acc_x 93.7500 (90.7812) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 303
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:713
clean false:16
clean_rate:0.9780521262002744
noisy true:616
noisy false:287
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [102/200] batch [5/22] time 0.349 (0.351) data 0.271 (0.273) loss_x loss_x 0.3687 (0.3166) acc_x 90.6250 (93.1250) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/22] time 0.315 (0.341) data 0.238 (0.263) loss_x loss_x 0.6733 (0.3564) acc_x 81.2500 (91.2500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/22] time 0.350 (0.341) data 0.271 (0.263) loss_x loss_x 0.2729 (0.3783) acc_x 90.6250 (91.0417) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/22] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.3101 (0.3743) acc_x 93.7500 (91.4062) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:696
clean false:16
clean_rate:0.9775280898876404
noisy true:649
noisy false:271
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [103/200] batch [5/22] time 0.332 (0.332) data 0.255 (0.255) loss_x loss_x 0.2194 (0.2044) acc_x 100.0000 (96.8750) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/22] time 0.345 (0.336) data 0.268 (0.258) loss_x loss_x 0.4363 (0.3596) acc_x 87.5000 (91.8750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/22] time 0.341 (0.338) data 0.265 (0.260) loss_x loss_x 0.2925 (0.3559) acc_x 93.7500 (91.8750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/22] time 0.341 (0.335) data 0.264 (0.258) loss_x loss_x 0.5991 (0.3785) acc_x 84.3750 (91.4062) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4485, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 732
clean true:716
clean false:16
clean_rate:0.9781420765027322
noisy true:640
noisy false:260
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 900
epoch [104/200] batch [5/22] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.5093 (0.4546) acc_x 87.5000 (88.1250) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/22] time 0.344 (0.350) data 0.266 (0.272) loss_x loss_x 0.3613 (0.3637) acc_x 93.7500 (90.9375) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/22] time 0.345 (0.349) data 0.268 (0.272) loss_x loss_x 0.8691 (0.4035) acc_x 81.2500 (91.2500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/22] time 0.349 (0.348) data 0.271 (0.270) loss_x loss_x 0.4338 (0.4216) acc_x 90.6250 (90.7812) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:708
clean false:16
clean_rate:0.9779005524861878
noisy true:631
noisy false:277
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [105/200] batch [5/22] time 0.347 (0.351) data 0.268 (0.273) loss_x loss_x 0.4270 (0.3655) acc_x 87.5000 (89.3750) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/22] time 0.334 (0.344) data 0.257 (0.267) loss_x loss_x 0.5850 (0.3995) acc_x 87.5000 (90.3125) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/22] time 0.329 (0.341) data 0.252 (0.263) loss_x loss_x 0.4492 (0.3978) acc_x 87.5000 (90.6250) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/22] time 0.348 (0.343) data 0.270 (0.266) loss_x loss_x 0.1722 (0.3731) acc_x 96.8750 (91.0938) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 278
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 727
clean true:712
clean false:15
clean_rate:0.9793672627235214
noisy true:642
noisy false:263
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 905
epoch [106/200] batch [5/22] time 0.338 (0.347) data 0.260 (0.269) loss_x loss_x 0.3840 (0.3766) acc_x 87.5000 (90.6250) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/22] time 0.375 (0.351) data 0.297 (0.274) loss_x loss_x 0.7485 (0.4007) acc_x 87.5000 (90.9375) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/22] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.4399 (0.4001) acc_x 93.7500 (91.0417) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/22] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 0.1903 (0.3974) acc_x 96.8750 (91.5625) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 278
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:722
clean false:13
clean_rate:0.9823129251700681
noisy true:632
noisy false:265
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [107/200] batch [5/22] time 0.332 (0.309) data 0.254 (0.231) loss_x loss_x 0.3762 (0.4080) acc_x 96.8750 (90.0000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/22] time 0.347 (0.330) data 0.271 (0.252) loss_x loss_x 0.4431 (0.3668) acc_x 90.6250 (91.2500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/22] time 0.333 (0.332) data 0.256 (0.255) loss_x loss_x 0.2908 (0.3662) acc_x 93.7500 (91.4583) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/22] time 0.350 (0.335) data 0.272 (0.257) loss_x loss_x 0.1791 (0.3886) acc_x 100.0000 (90.9375) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 721
clean true:707
clean false:14
clean_rate:0.9805825242718447
noisy true:626
noisy false:285
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 911
epoch [108/200] batch [5/22] time 0.333 (0.344) data 0.255 (0.267) loss_x loss_x 0.4307 (0.3388) acc_x 87.5000 (93.7500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/22] time 0.304 (0.328) data 0.226 (0.250) loss_x loss_x 0.1216 (0.3379) acc_x 100.0000 (92.5000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/22] time 0.338 (0.331) data 0.261 (0.253) loss_x loss_x 0.3044 (0.3591) acc_x 93.7500 (92.0833) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/22] time 0.345 (0.336) data 0.267 (0.258) loss_x loss_x 0.2487 (0.3395) acc_x 93.7500 (92.6562) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 719
clean true:705
clean false:14
clean_rate:0.980528511821975
noisy true:635
noisy false:278
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 913
epoch [109/200] batch [5/22] time 0.339 (0.349) data 0.262 (0.272) loss_x loss_x 0.4353 (0.3563) acc_x 90.6250 (91.2500) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/22] time 0.343 (0.339) data 0.266 (0.262) loss_x loss_x 0.2930 (0.3474) acc_x 93.7500 (92.8125) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/22] time 0.322 (0.339) data 0.244 (0.261) loss_x loss_x 0.4497 (0.3670) acc_x 84.3750 (91.4583) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/22] time 0.350 (0.341) data 0.272 (0.264) loss_x loss_x 0.2051 (0.3497) acc_x 96.8750 (92.0312) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:710
clean false:16
clean_rate:0.977961432506887
noisy true:647
noisy false:259
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [110/200] batch [5/22] time 0.336 (0.349) data 0.258 (0.271) loss_x loss_x 0.1959 (0.3073) acc_x 96.8750 (93.7500) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/22] time 0.337 (0.346) data 0.260 (0.268) loss_x loss_x 0.1383 (0.2725) acc_x 100.0000 (94.6875) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/22] time 0.319 (0.341) data 0.240 (0.264) loss_x loss_x 0.2068 (0.2674) acc_x 100.0000 (95.2083) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/22] time 0.345 (0.340) data 0.267 (0.262) loss_x loss_x 0.0965 (0.2740) acc_x 100.0000 (94.5312) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 291
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:720
clean false:18
clean_rate:0.975609756097561
noisy true:621
noisy false:273
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [111/200] batch [5/23] time 0.344 (0.350) data 0.267 (0.272) loss_x loss_x 0.2268 (0.3947) acc_x 90.6250 (89.3750) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [10/23] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.1494 (0.3302) acc_x 96.8750 (92.1875) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/23] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.2725 (0.3325) acc_x 96.8750 (92.2917) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/23] time 0.335 (0.341) data 0.258 (0.264) loss_x loss_x 0.4983 (0.3350) acc_x 90.6250 (92.8125) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 280
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:721
clean false:18
clean_rate:0.9756427604871448
noisy true:631
noisy false:262
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [112/200] batch [5/23] time 0.350 (0.347) data 0.271 (0.270) loss_x loss_x 0.6040 (0.4095) acc_x 87.5000 (90.6250) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [10/23] time 0.302 (0.337) data 0.225 (0.259) loss_x loss_x 0.3281 (0.4024) acc_x 93.7500 (91.2500) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/23] time 0.343 (0.335) data 0.266 (0.258) loss_x loss_x 0.1608 (0.3584) acc_x 100.0000 (92.7083) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/23] time 0.356 (0.341) data 0.278 (0.264) loss_x loss_x 0.3755 (0.3500) acc_x 90.6250 (92.9688) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:712
clean false:17
clean_rate:0.9766803840877915
noisy true:633
noisy false:270
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [113/200] batch [5/22] time 0.329 (0.337) data 0.251 (0.260) loss_x loss_x 0.3547 (0.3997) acc_x 90.6250 (90.0000) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/22] time 0.322 (0.336) data 0.244 (0.259) loss_x loss_x 0.3074 (0.3906) acc_x 93.7500 (90.6250) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/22] time 0.297 (0.331) data 0.219 (0.254) loss_x loss_x 0.3726 (0.4133) acc_x 93.7500 (89.3750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/22] time 0.333 (0.331) data 0.256 (0.254) loss_x loss_x 0.4312 (0.4064) acc_x 87.5000 (90.3125) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 281
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:718
clean false:17
clean_rate:0.9768707482993197
noisy true:633
noisy false:264
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [114/200] batch [5/22] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.4368 (0.2979) acc_x 93.7500 (95.0000) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/22] time 0.343 (0.345) data 0.266 (0.267) loss_x loss_x 0.1711 (0.2903) acc_x 96.8750 (94.3750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/22] time 0.292 (0.342) data 0.214 (0.264) loss_x loss_x 0.2632 (0.2890) acc_x 93.7500 (93.5417) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/22] time 0.308 (0.332) data 0.230 (0.254) loss_x loss_x 0.4331 (0.2900) acc_x 96.8750 (94.0625) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.4491, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 733
clean true:715
clean false:18
clean_rate:0.975443383356071
noisy true:642
noisy false:257
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 899
epoch [115/200] batch [5/22] time 0.343 (0.330) data 0.265 (0.253) loss_x loss_x 0.3083 (0.3062) acc_x 93.7500 (93.7500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/22] time 0.335 (0.338) data 0.258 (0.260) loss_x loss_x 0.7935 (0.3497) acc_x 87.5000 (94.0625) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/22] time 0.347 (0.339) data 0.269 (0.262) loss_x loss_x 0.4255 (0.3568) acc_x 87.5000 (92.7083) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/22] time 0.347 (0.340) data 0.270 (0.263) loss_x loss_x 0.1771 (0.3440) acc_x 96.8750 (92.6562) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:721
clean false:16
clean_rate:0.9782903663500678
noisy true:649
noisy false:246
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [116/200] batch [5/23] time 0.323 (0.341) data 0.244 (0.264) loss_x loss_x 0.5771 (0.3675) acc_x 81.2500 (91.8750) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [10/23] time 0.298 (0.337) data 0.220 (0.259) loss_x loss_x 0.2156 (0.3511) acc_x 93.7500 (92.1875) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/23] time 0.306 (0.328) data 0.228 (0.250) loss_x loss_x 0.3091 (0.3472) acc_x 93.7500 (92.2917) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/23] time 0.347 (0.328) data 0.269 (0.251) loss_x loss_x 0.2000 (0.3629) acc_x 100.0000 (92.1875) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 280
confident_label rate tensor(0.4498, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 734
clean true:719
clean false:15
clean_rate:0.9795640326975477
noisy true:633
noisy false:265
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 898
epoch [117/200] batch [5/22] time 0.339 (0.349) data 0.260 (0.270) loss_x loss_x 0.3062 (0.4023) acc_x 93.7500 (90.0000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/22] time 0.335 (0.347) data 0.257 (0.268) loss_x loss_x 0.2233 (0.3356) acc_x 96.8750 (92.5000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/22] time 0.345 (0.349) data 0.267 (0.270) loss_x loss_x 0.2588 (0.3344) acc_x 93.7500 (92.9167) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/22] time 0.306 (0.342) data 0.228 (0.264) loss_x loss_x 0.2289 (0.3254) acc_x 93.7500 (92.6562) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.4491, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 733
clean true:716
clean false:17
clean_rate:0.9768076398362893
noisy true:639
noisy false:260
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 899
epoch [118/200] batch [5/22] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.0972 (0.2207) acc_x 100.0000 (97.5000) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/22] time 0.341 (0.340) data 0.263 (0.262) loss_x loss_x 0.2345 (0.2943) acc_x 96.8750 (94.0625) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/22] time 0.342 (0.343) data 0.265 (0.265) loss_x loss_x 0.2146 (0.2966) acc_x 96.8750 (93.5417) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/22] time 0.335 (0.339) data 0.256 (0.261) loss_x loss_x 0.2690 (0.3223) acc_x 96.8750 (93.1250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:727
clean false:16
clean_rate:0.9784656796769852
noisy true:636
noisy false:253
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [119/200] batch [5/23] time 0.333 (0.358) data 0.256 (0.280) loss_x loss_x 0.5337 (0.3540) acc_x 90.6250 (91.2500) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [10/23] time 0.342 (0.353) data 0.265 (0.275) loss_x loss_x 0.8223 (0.3603) acc_x 71.8750 (90.3125) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/23] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.6641 (0.3661) acc_x 87.5000 (91.0417) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/23] time 0.353 (0.350) data 0.275 (0.272) loss_x loss_x 0.4089 (0.3783) acc_x 90.6250 (91.0938) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:719
clean false:20
clean_rate:0.972936400541272
noisy true:643
noisy false:250
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [120/200] batch [5/23] time 0.337 (0.339) data 0.260 (0.262) loss_x loss_x 0.6353 (0.4549) acc_x 87.5000 (88.1250) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [10/23] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.3311 (0.3832) acc_x 96.8750 (91.5625) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/23] time 0.345 (0.341) data 0.268 (0.264) loss_x loss_x 0.1892 (0.3716) acc_x 96.8750 (91.4583) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/23] time 0.328 (0.340) data 0.251 (0.263) loss_x loss_x 0.6885 (0.3718) acc_x 87.5000 (91.7188) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:725
clean false:19
clean_rate:0.9744623655913979
noisy true:632
noisy false:256
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [121/200] batch [5/23] time 0.336 (0.347) data 0.258 (0.269) loss_x loss_x 0.4902 (0.3583) acc_x 93.7500 (93.1250) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [10/23] time 0.348 (0.350) data 0.271 (0.273) loss_x loss_x 0.3845 (0.3342) acc_x 87.5000 (93.4375) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/23] time 0.335 (0.346) data 0.258 (0.269) loss_x loss_x 0.2788 (0.3365) acc_x 90.6250 (92.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/23] time 0.346 (0.344) data 0.269 (0.267) loss_x loss_x 0.1488 (0.3503) acc_x 96.8750 (91.8750) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.4498, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 734
clean true:719
clean false:15
clean_rate:0.9795640326975477
noisy true:649
noisy false:249
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 898
epoch [122/200] batch [5/22] time 0.351 (0.361) data 0.274 (0.283) loss_x loss_x 0.2734 (0.2898) acc_x 96.8750 (93.7500) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [10/22] time 0.334 (0.353) data 0.257 (0.275) loss_x loss_x 0.1943 (0.3019) acc_x 93.7500 (93.4375) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/22] time 0.343 (0.352) data 0.266 (0.275) loss_x loss_x 0.2878 (0.2959) acc_x 96.8750 (93.5417) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/22] time 0.355 (0.350) data 0.274 (0.273) loss_x loss_x 0.1711 (0.3113) acc_x 100.0000 (93.7500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:713
clean false:16
clean_rate:0.9780521262002744
noisy true:636
noisy false:267
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [123/200] batch [5/22] time 0.348 (0.349) data 0.270 (0.272) loss_x loss_x 0.2041 (0.3315) acc_x 96.8750 (92.5000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/22] time 0.334 (0.347) data 0.256 (0.269) loss_x loss_x 0.1812 (0.3679) acc_x 96.8750 (90.9375) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/22] time 0.347 (0.345) data 0.269 (0.268) loss_x loss_x 0.2649 (0.3608) acc_x 93.7500 (91.2500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/22] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.2233 (0.3604) acc_x 93.7500 (91.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:725
clean false:16
clean_rate:0.9784075573549258
noisy true:654
noisy false:237
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [124/200] batch [5/23] time 0.335 (0.349) data 0.258 (0.272) loss_x loss_x 0.4143 (0.3896) acc_x 87.5000 (91.2500) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [10/23] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.2072 (0.3556) acc_x 93.7500 (92.8125) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/23] time 0.337 (0.345) data 0.260 (0.268) loss_x loss_x 0.3708 (0.3722) acc_x 87.5000 (91.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/23] time 0.353 (0.345) data 0.275 (0.267) loss_x loss_x 0.3018 (0.3688) acc_x 87.5000 (91.7188) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4473, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 730
clean true:714
clean false:16
clean_rate:0.9780821917808219
noisy true:657
noisy false:245
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 902
epoch [125/200] batch [5/22] time 0.348 (0.352) data 0.271 (0.274) loss_x loss_x 0.4048 (0.3768) acc_x 90.6250 (92.5000) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/22] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.4695 (0.3665) acc_x 84.3750 (91.8750) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/22] time 0.348 (0.346) data 0.271 (0.269) loss_x loss_x 0.2747 (0.3395) acc_x 84.3750 (92.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/22] time 0.350 (0.346) data 0.273 (0.269) loss_x loss_x 0.2036 (0.3272) acc_x 93.7500 (92.8125) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 294
confident_label rate tensor(0.4357, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 711
clean true:696
clean false:15
clean_rate:0.9789029535864979
noisy true:642
noisy false:279
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 921
epoch [126/200] batch [5/22] time 0.327 (0.311) data 0.250 (0.234) loss_x loss_x 0.2472 (0.2882) acc_x 96.8750 (93.7500) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/22] time 0.339 (0.327) data 0.261 (0.250) loss_x loss_x 0.4780 (0.3253) acc_x 84.3750 (92.8125) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/22] time 0.340 (0.332) data 0.262 (0.254) loss_x loss_x 0.3525 (0.3059) acc_x 93.7500 (93.5417) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/22] time 0.347 (0.333) data 0.269 (0.256) loss_x loss_x 0.3347 (0.3199) acc_x 93.7500 (93.2812) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:720
clean false:18
clean_rate:0.975609756097561
noisy true:636
noisy false:258
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [127/200] batch [5/23] time 0.341 (0.341) data 0.263 (0.263) loss_x loss_x 0.2542 (0.3425) acc_x 96.8750 (91.8750) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [10/23] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.4089 (0.4102) acc_x 90.6250 (90.0000) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/23] time 0.304 (0.334) data 0.227 (0.256) loss_x loss_x 0.3406 (0.4037) acc_x 90.6250 (89.7917) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/23] time 0.347 (0.331) data 0.269 (0.253) loss_x loss_x 0.1934 (0.3870) acc_x 96.8750 (90.4688) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 281
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:720
clean false:18
clean_rate:0.975609756097561
noisy true:631
noisy false:263
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [128/200] batch [5/23] time 0.343 (0.341) data 0.265 (0.264) loss_x loss_x 0.5962 (0.3621) acc_x 84.3750 (92.5000) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [10/23] time 0.318 (0.336) data 0.241 (0.259) loss_x loss_x 0.4456 (0.3646) acc_x 93.7500 (92.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/23] time 0.346 (0.337) data 0.269 (0.259) loss_x loss_x 0.4165 (0.3566) acc_x 90.6250 (92.2917) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/23] time 0.359 (0.337) data 0.282 (0.260) loss_x loss_x 0.5234 (0.3736) acc_x 87.5000 (91.7188) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 289
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:726
clean false:14
clean_rate:0.981081081081081
noisy true:617
noisy false:275
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [129/200] batch [5/23] time 0.330 (0.349) data 0.252 (0.272) loss_x loss_x 0.3259 (0.2928) acc_x 96.8750 (93.1250) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [10/23] time 0.356 (0.342) data 0.279 (0.265) loss_x loss_x 0.2827 (0.2949) acc_x 93.7500 (92.8125) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/23] time 0.333 (0.342) data 0.255 (0.264) loss_x loss_x 0.3635 (0.3076) acc_x 96.8750 (93.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/23] time 0.354 (0.342) data 0.277 (0.264) loss_x loss_x 0.2830 (0.3309) acc_x 93.7500 (92.1875) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:724
clean false:21
clean_rate:0.9718120805369127
noisy true:641
noisy false:246
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [130/200] batch [5/23] time 0.333 (0.339) data 0.255 (0.261) loss_x loss_x 0.2695 (0.3483) acc_x 96.8750 (93.7500) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [10/23] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.4890 (0.3561) acc_x 90.6250 (92.1875) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/23] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.1327 (0.3274) acc_x 96.8750 (93.1250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/23] time 0.350 (0.341) data 0.273 (0.263) loss_x loss_x 0.1951 (0.2901) acc_x 93.7500 (93.9062) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:736
clean false:15
clean_rate:0.9800266311584553
noisy true:640
noisy false:241
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [131/200] batch [5/23] time 0.342 (0.353) data 0.265 (0.275) loss_x loss_x 0.5635 (0.3993) acc_x 87.5000 (90.6250) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [10/23] time 0.329 (0.346) data 0.251 (0.268) loss_x loss_x 0.4141 (0.4168) acc_x 87.5000 (88.7500) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/23] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.5713 (0.4128) acc_x 84.3750 (89.1667) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/23] time 0.343 (0.345) data 0.266 (0.267) loss_x loss_x 0.2003 (0.3616) acc_x 96.8750 (90.9375) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 280
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:719
clean false:18
clean_rate:0.9755766621438263
noisy true:633
noisy false:262
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [132/200] batch [5/23] time 0.346 (0.332) data 0.268 (0.254) loss_x loss_x 0.3403 (0.3404) acc_x 87.5000 (90.6250) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/23] time 0.298 (0.332) data 0.221 (0.254) loss_x loss_x 0.3682 (0.3256) acc_x 84.3750 (91.2500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/23] time 0.351 (0.337) data 0.274 (0.260) loss_x loss_x 0.1802 (0.3104) acc_x 96.8750 (91.8750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/23] time 0.344 (0.338) data 0.266 (0.260) loss_x loss_x 0.2439 (0.3120) acc_x 90.6250 (92.0312) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:723
clean false:17
clean_rate:0.977027027027027
noisy true:632
noisy false:260
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [133/200] batch [5/23] time 0.361 (0.345) data 0.283 (0.267) loss_x loss_x 0.4915 (0.3613) acc_x 87.5000 (90.6250) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [10/23] time 0.340 (0.346) data 0.262 (0.268) loss_x loss_x 0.6797 (0.3610) acc_x 84.3750 (91.2500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/23] time 0.339 (0.344) data 0.261 (0.266) loss_x loss_x 0.2316 (0.3382) acc_x 93.7500 (92.0833) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/23] time 0.341 (0.340) data 0.264 (0.263) loss_x loss_x 0.1871 (0.3378) acc_x 96.8750 (92.3438) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 279
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:735
clean false:17
clean_rate:0.9773936170212766
noisy true:618
noisy false:262
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [134/200] batch [5/23] time 0.357 (0.334) data 0.279 (0.256) loss_x loss_x 0.1855 (0.3330) acc_x 96.8750 (90.0000) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [10/23] time 0.342 (0.338) data 0.264 (0.261) loss_x loss_x 0.4851 (0.3630) acc_x 87.5000 (90.6250) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/23] time 0.352 (0.340) data 0.274 (0.263) loss_x loss_x 0.1533 (0.3254) acc_x 100.0000 (92.5000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/23] time 0.352 (0.343) data 0.274 (0.265) loss_x loss_x 0.2135 (0.3201) acc_x 93.7500 (92.8125) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4491, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 733
clean true:718
clean false:15
clean_rate:0.9795361527967258
noisy true:648
noisy false:251
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 899
epoch [135/200] batch [5/22] time 0.339 (0.345) data 0.261 (0.268) loss_x loss_x 0.4688 (0.3881) acc_x 84.3750 (89.3750) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/22] time 0.306 (0.334) data 0.228 (0.256) loss_x loss_x 0.1833 (0.3240) acc_x 93.7500 (92.1875) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/22] time 0.344 (0.331) data 0.266 (0.254) loss_x loss_x 0.3364 (0.2924) acc_x 96.8750 (93.5417) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/22] time 0.352 (0.335) data 0.274 (0.257) loss_x loss_x 0.2529 (0.2947) acc_x 96.8750 (93.5938) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:730
clean false:16
clean_rate:0.9785522788203753
noisy true:638
noisy false:248
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [136/200] batch [5/23] time 0.347 (0.347) data 0.270 (0.270) loss_x loss_x 0.2201 (0.3329) acc_x 96.8750 (94.3750) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [10/23] time 0.357 (0.345) data 0.279 (0.268) loss_x loss_x 0.4099 (0.3710) acc_x 93.7500 (92.1875) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/23] time 0.338 (0.344) data 0.261 (0.266) loss_x loss_x 0.4067 (0.3826) acc_x 90.6250 (90.8333) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/23] time 0.294 (0.334) data 0.216 (0.256) loss_x loss_x 0.5234 (0.3689) acc_x 90.6250 (91.4062) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:723
clean false:17
clean_rate:0.977027027027027
noisy true:640
noisy false:252
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [137/200] batch [5/23] time 0.355 (0.348) data 0.278 (0.270) loss_x loss_x 0.4302 (0.3517) acc_x 90.6250 (90.6250) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [10/23] time 0.353 (0.345) data 0.276 (0.268) loss_x loss_x 0.2573 (0.3674) acc_x 100.0000 (91.5625) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/23] time 0.350 (0.344) data 0.273 (0.267) loss_x loss_x 0.2032 (0.3702) acc_x 96.8750 (91.0417) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/23] time 0.350 (0.343) data 0.272 (0.265) loss_x loss_x 0.4463 (0.3662) acc_x 87.5000 (91.5625) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:724
clean false:17
clean_rate:0.9770580296896086
noisy true:641
noisy false:250
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [138/200] batch [5/23] time 0.337 (0.349) data 0.260 (0.272) loss_x loss_x 0.1315 (0.2135) acc_x 100.0000 (95.6250) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [10/23] time 0.335 (0.346) data 0.258 (0.269) loss_x loss_x 0.4731 (0.2733) acc_x 90.6250 (94.0625) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/23] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.2389 (0.2929) acc_x 96.8750 (93.5417) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/23] time 0.344 (0.351) data 0.267 (0.273) loss_x loss_x 0.1794 (0.3260) acc_x 100.0000 (92.8125) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:731
clean false:17
clean_rate:0.9772727272727273
noisy true:619
noisy false:265
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [139/200] batch [5/23] time 0.336 (0.337) data 0.259 (0.260) loss_x loss_x 0.3462 (0.2417) acc_x 90.6250 (95.0000) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [10/23] time 0.327 (0.341) data 0.250 (0.263) loss_x loss_x 0.3279 (0.2948) acc_x 93.7500 (94.3750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/23] time 0.339 (0.340) data 0.261 (0.263) loss_x loss_x 0.2874 (0.3496) acc_x 90.6250 (92.5000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/23] time 0.354 (0.340) data 0.277 (0.263) loss_x loss_x 0.3118 (0.3551) acc_x 93.7500 (92.5000) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4491, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 733
clean true:717
clean false:16
clean_rate:0.9781718963165075
noisy true:639
noisy false:260
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 899
epoch [140/200] batch [5/22] time 0.288 (0.313) data 0.210 (0.235) loss_x loss_x 0.2089 (0.2777) acc_x 96.8750 (93.7500) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/22] time 0.331 (0.308) data 0.254 (0.231) loss_x loss_x 0.1792 (0.3236) acc_x 96.8750 (92.5000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/22] time 0.342 (0.318) data 0.264 (0.241) loss_x loss_x 0.3787 (0.3486) acc_x 90.6250 (91.6667) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/22] time 0.346 (0.324) data 0.268 (0.246) loss_x loss_x 0.2334 (0.3470) acc_x 96.8750 (91.4062) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:735
clean false:15
clean_rate:0.98
noisy true:650
noisy false:232
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [141/200] batch [5/23] time 0.359 (0.353) data 0.281 (0.275) loss_x loss_x 0.0925 (0.2931) acc_x 100.0000 (94.3750) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [10/23] time 0.339 (0.349) data 0.262 (0.271) loss_x loss_x 0.1940 (0.2819) acc_x 96.8750 (94.3750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/23] time 0.297 (0.336) data 0.218 (0.258) loss_x loss_x 0.2371 (0.2849) acc_x 93.7500 (94.3750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/23] time 0.342 (0.336) data 0.265 (0.258) loss_x loss_x 0.3804 (0.3079) acc_x 93.7500 (94.2188) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:721
clean false:16
clean_rate:0.9782903663500678
noisy true:648
noisy false:247
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [142/200] batch [5/23] time 0.332 (0.341) data 0.255 (0.264) loss_x loss_x 0.7285 (0.4224) acc_x 87.5000 (93.1250) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [10/23] time 0.348 (0.342) data 0.271 (0.265) loss_x loss_x 0.6294 (0.4132) acc_x 81.2500 (90.9375) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/23] time 0.327 (0.340) data 0.249 (0.263) loss_x loss_x 0.2546 (0.3776) acc_x 93.7500 (91.4583) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/23] time 0.359 (0.339) data 0.282 (0.262) loss_x loss_x 0.2201 (0.3695) acc_x 96.8750 (92.0312) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 279
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:724
clean false:20
clean_rate:0.9731182795698925
noisy true:629
noisy false:259
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [143/200] batch [5/23] time 0.351 (0.347) data 0.274 (0.269) loss_x loss_x 0.2175 (0.3590) acc_x 93.7500 (91.8750) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [10/23] time 0.301 (0.337) data 0.223 (0.259) loss_x loss_x 0.2688 (0.3770) acc_x 96.8750 (91.5625) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/23] time 0.367 (0.335) data 0.289 (0.257) loss_x loss_x 0.2678 (0.3699) acc_x 90.6250 (91.0417) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/23] time 0.336 (0.335) data 0.258 (0.258) loss_x loss_x 0.6445 (0.3805) acc_x 81.2500 (90.7812) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:730
clean false:16
clean_rate:0.9785522788203753
noisy true:643
noisy false:243
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [144/200] batch [5/23] time 0.347 (0.324) data 0.270 (0.246) loss_x loss_x 0.2228 (0.3335) acc_x 96.8750 (93.7500) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/23] time 0.330 (0.331) data 0.253 (0.253) loss_x loss_x 0.4602 (0.3447) acc_x 90.6250 (93.1250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/23] time 0.335 (0.331) data 0.258 (0.254) loss_x loss_x 0.3811 (0.3783) acc_x 90.6250 (92.5000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/23] time 0.333 (0.333) data 0.255 (0.256) loss_x loss_x 0.3652 (0.3631) acc_x 84.3750 (92.1875) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:735
clean false:16
clean_rate:0.9786950732356857
noisy true:638
noisy false:243
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [145/200] batch [5/23] time 0.301 (0.313) data 0.223 (0.234) loss_x loss_x 0.4900 (0.2800) acc_x 90.6250 (96.2500) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/23] time 0.323 (0.326) data 0.246 (0.248) loss_x loss_x 0.1743 (0.3369) acc_x 100.0000 (95.9375) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/23] time 0.339 (0.329) data 0.262 (0.252) loss_x loss_x 0.2974 (0.3467) acc_x 90.6250 (94.5833) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/23] time 0.333 (0.331) data 0.256 (0.253) loss_x loss_x 0.1829 (0.3248) acc_x 100.0000 (94.8438) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:723
clean false:16
clean_rate:0.9783491204330176
noisy true:648
noisy false:245
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [146/200] batch [5/23] time 0.351 (0.333) data 0.274 (0.255) loss_x loss_x 0.3037 (0.3453) acc_x 96.8750 (90.6250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/23] time 0.339 (0.337) data 0.261 (0.259) loss_x loss_x 0.2380 (0.3380) acc_x 96.8750 (92.5000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/23] time 0.333 (0.337) data 0.256 (0.259) loss_x loss_x 0.3384 (0.3314) acc_x 90.6250 (91.8750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/23] time 0.354 (0.340) data 0.277 (0.262) loss_x loss_x 0.3782 (0.3363) acc_x 90.6250 (92.0312) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:731
clean false:17
clean_rate:0.9772727272727273
noisy true:648
noisy false:236
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [147/200] batch [5/23] time 0.310 (0.328) data 0.232 (0.250) loss_x loss_x 0.7881 (0.3940) acc_x 87.5000 (93.1250) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/23] time 0.339 (0.328) data 0.262 (0.250) loss_x loss_x 0.2446 (0.3489) acc_x 93.7500 (93.4375) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/23] time 0.326 (0.329) data 0.249 (0.251) loss_x loss_x 0.3835 (0.3701) acc_x 87.5000 (92.7083) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/23] time 0.334 (0.332) data 0.257 (0.255) loss_x loss_x 0.5645 (0.3734) acc_x 87.5000 (92.5000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:735
clean false:17
clean_rate:0.9773936170212766
noisy true:644
noisy false:236
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [148/200] batch [5/23] time 0.338 (0.347) data 0.260 (0.269) loss_x loss_x 0.1320 (0.2696) acc_x 100.0000 (92.5000) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [10/23] time 0.346 (0.341) data 0.269 (0.264) loss_x loss_x 0.2981 (0.2891) acc_x 96.8750 (93.7500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/23] time 0.344 (0.339) data 0.267 (0.262) loss_x loss_x 0.2588 (0.2704) acc_x 93.7500 (93.9583) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/23] time 0.338 (0.340) data 0.261 (0.263) loss_x loss_x 0.3721 (0.2782) acc_x 90.6250 (93.9062) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:733
clean false:16
clean_rate:0.9786381842456608
noisy true:640
noisy false:243
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [149/200] batch [5/23] time 0.346 (0.339) data 0.268 (0.261) loss_x loss_x 0.1350 (0.2814) acc_x 96.8750 (93.1250) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [10/23] time 0.332 (0.335) data 0.254 (0.257) loss_x loss_x 0.3560 (0.2772) acc_x 90.6250 (94.6875) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/23] time 0.339 (0.337) data 0.259 (0.259) loss_x loss_x 0.3701 (0.3055) acc_x 93.7500 (94.1667) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/23] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.4165 (0.3347) acc_x 87.5000 (92.5000) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:727
clean false:16
clean_rate:0.9784656796769852
noisy true:645
noisy false:244
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [150/200] batch [5/23] time 0.323 (0.331) data 0.245 (0.253) loss_x loss_x 0.2524 (0.2812) acc_x 93.7500 (93.7500) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/23] time 0.346 (0.337) data 0.268 (0.260) loss_x loss_x 0.1399 (0.2932) acc_x 93.7500 (93.4375) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/23] time 0.321 (0.338) data 0.244 (0.260) loss_x loss_x 0.4182 (0.3049) acc_x 90.6250 (93.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/23] time 0.325 (0.335) data 0.248 (0.257) loss_x loss_x 0.5830 (0.3330) acc_x 84.3750 (92.5000) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 248
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:733
clean false:13
clean_rate:0.982573726541555
noisy true:651
noisy false:235
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [151/200] batch [5/23] time 0.348 (0.348) data 0.271 (0.270) loss_x loss_x 0.2976 (0.3210) acc_x 93.7500 (91.8750) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [10/23] time 0.301 (0.339) data 0.223 (0.261) loss_x loss_x 0.2815 (0.2847) acc_x 93.7500 (93.7500) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/23] time 0.303 (0.325) data 0.225 (0.247) loss_x loss_x 0.2004 (0.3075) acc_x 96.8750 (93.5417) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/23] time 0.343 (0.331) data 0.266 (0.253) loss_x loss_x 0.2222 (0.3049) acc_x 96.8750 (93.7500) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:725
clean false:18
clean_rate:0.9757738896366084
noisy true:640
noisy false:249
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [152/200] batch [5/23] time 0.354 (0.347) data 0.276 (0.270) loss_x loss_x 0.3933 (0.4232) acc_x 87.5000 (90.0000) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [10/23] time 0.339 (0.344) data 0.262 (0.266) loss_x loss_x 0.4507 (0.3805) acc_x 90.6250 (90.9375) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/23] time 0.296 (0.332) data 0.219 (0.254) loss_x loss_x 0.3369 (0.3604) acc_x 93.7500 (91.8750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/23] time 0.329 (0.326) data 0.251 (0.248) loss_x loss_x 0.2183 (0.3518) acc_x 93.7500 (91.5625) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:725
clean false:16
clean_rate:0.9784075573549258
noisy true:638
noisy false:253
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [153/200] batch [5/23] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.2224 (0.3862) acc_x 96.8750 (92.5000) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [10/23] time 0.328 (0.350) data 0.251 (0.273) loss_x loss_x 0.4536 (0.3722) acc_x 87.5000 (91.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/23] time 0.349 (0.346) data 0.272 (0.269) loss_x loss_x 0.2534 (0.3432) acc_x 93.7500 (92.9167) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/23] time 0.338 (0.344) data 0.260 (0.267) loss_x loss_x 0.1581 (0.3174) acc_x 100.0000 (93.9062) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:734
clean false:17
clean_rate:0.9773635153129161
noisy true:645
noisy false:236
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [154/200] batch [5/23] time 0.350 (0.336) data 0.273 (0.258) loss_x loss_x 0.1832 (0.4313) acc_x 96.8750 (88.7500) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [10/23] time 0.346 (0.341) data 0.269 (0.263) loss_x loss_x 0.8301 (0.4261) acc_x 87.5000 (90.3125) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/23] time 0.344 (0.340) data 0.267 (0.263) loss_x loss_x 0.4197 (0.3980) acc_x 96.8750 (91.0417) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/23] time 0.295 (0.336) data 0.219 (0.258) loss_x loss_x 0.2284 (0.3709) acc_x 96.8750 (91.2500) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:737
clean false:17
clean_rate:0.9774535809018567
noisy true:646
noisy false:232
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [155/200] batch [5/23] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.3218 (0.2978) acc_x 93.7500 (94.3750) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [10/23] time 0.339 (0.342) data 0.262 (0.264) loss_x loss_x 0.3823 (0.3271) acc_x 90.6250 (93.4375) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/23] time 0.354 (0.342) data 0.276 (0.264) loss_x loss_x 0.2046 (0.3538) acc_x 93.7500 (93.1250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/23] time 0.340 (0.342) data 0.262 (0.265) loss_x loss_x 0.2788 (0.3270) acc_x 96.8750 (93.9062) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:738
clean false:16
clean_rate:0.9787798408488063
noisy true:644
noisy false:234
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [156/200] batch [5/23] time 0.332 (0.339) data 0.255 (0.261) loss_x loss_x 0.1228 (0.3360) acc_x 100.0000 (91.2500) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [10/23] time 0.308 (0.326) data 0.229 (0.248) loss_x loss_x 0.5449 (0.3704) acc_x 87.5000 (90.3125) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/23] time 0.338 (0.332) data 0.261 (0.254) loss_x loss_x 0.3191 (0.3490) acc_x 90.6250 (90.8333) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/23] time 0.341 (0.334) data 0.263 (0.257) loss_x loss_x 0.2568 (0.3750) acc_x 93.7500 (90.3125) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:739
clean false:12
clean_rate:0.9840213049267643
noisy true:632
noisy false:249
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [157/200] batch [5/23] time 0.318 (0.319) data 0.239 (0.240) loss_x loss_x 0.1971 (0.3277) acc_x 93.7500 (92.5000) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/23] time 0.350 (0.327) data 0.271 (0.249) loss_x loss_x 0.2676 (0.3010) acc_x 96.8750 (92.8125) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/23] time 0.349 (0.332) data 0.271 (0.254) loss_x loss_x 0.3218 (0.2947) acc_x 90.6250 (93.3333) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/23] time 0.337 (0.334) data 0.260 (0.256) loss_x loss_x 0.2639 (0.2949) acc_x 90.6250 (92.9688) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:725
clean false:14
clean_rate:0.9810554803788903
noisy true:653
noisy false:240
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [158/200] batch [5/23] time 0.302 (0.314) data 0.225 (0.237) loss_x loss_x 0.3789 (0.3404) acc_x 90.6250 (93.7500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/23] time 0.301 (0.316) data 0.223 (0.238) loss_x loss_x 0.1697 (0.2991) acc_x 100.0000 (93.4375) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/23] time 0.338 (0.316) data 0.261 (0.239) loss_x loss_x 0.1539 (0.2733) acc_x 96.8750 (94.5833) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/23] time 0.338 (0.322) data 0.260 (0.245) loss_x loss_x 0.2219 (0.2784) acc_x 93.7500 (94.5312) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:727
clean false:18
clean_rate:0.9758389261744966
noisy true:629
noisy false:258
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [159/200] batch [5/23] time 0.351 (0.332) data 0.273 (0.255) loss_x loss_x 0.3821 (0.2946) acc_x 90.6250 (95.0000) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/23] time 0.337 (0.336) data 0.260 (0.258) loss_x loss_x 0.3596 (0.2911) acc_x 87.5000 (94.0625) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/23] time 0.348 (0.335) data 0.270 (0.257) loss_x loss_x 0.1760 (0.3150) acc_x 96.8750 (93.9583) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/23] time 0.341 (0.331) data 0.264 (0.253) loss_x loss_x 0.2083 (0.3192) acc_x 96.8750 (92.9688) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 272
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:724
clean false:16
clean_rate:0.9783783783783784
noisy true:636
noisy false:256
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [160/200] batch [5/23] time 0.323 (0.339) data 0.245 (0.262) loss_x loss_x 0.5215 (0.3145) acc_x 90.6250 (93.1250) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [10/23] time 0.330 (0.339) data 0.252 (0.261) loss_x loss_x 0.1566 (0.3091) acc_x 100.0000 (93.7500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/23] time 0.334 (0.337) data 0.256 (0.260) loss_x loss_x 0.3115 (0.3067) acc_x 93.7500 (94.1667) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/23] time 0.297 (0.331) data 0.219 (0.253) loss_x loss_x 0.1914 (0.3338) acc_x 96.8750 (93.5938) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:736
clean false:14
clean_rate:0.9813333333333333
noisy true:643
noisy false:239
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [161/200] batch [5/23] time 0.343 (0.332) data 0.266 (0.255) loss_x loss_x 0.3840 (0.2006) acc_x 93.7500 (97.5000) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/23] time 0.358 (0.338) data 0.280 (0.261) loss_x loss_x 0.3140 (0.3183) acc_x 96.8750 (94.6875) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/23] time 0.348 (0.341) data 0.270 (0.264) loss_x loss_x 0.1556 (0.3032) acc_x 93.7500 (94.1667) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/23] time 0.355 (0.345) data 0.277 (0.267) loss_x loss_x 0.4160 (0.3104) acc_x 87.5000 (93.2812) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:735
clean false:17
clean_rate:0.9773936170212766
noisy true:634
noisy false:246
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [162/200] batch [5/23] time 0.343 (0.324) data 0.264 (0.245) loss_x loss_x 0.1770 (0.2996) acc_x 96.8750 (94.3750) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/23] time 0.344 (0.338) data 0.267 (0.260) loss_x loss_x 0.3860 (0.2968) acc_x 90.6250 (94.3750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/23] time 0.328 (0.339) data 0.251 (0.260) loss_x loss_x 0.5078 (0.3205) acc_x 84.3750 (93.5417) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/23] time 0.341 (0.339) data 0.263 (0.262) loss_x loss_x 0.2722 (0.3361) acc_x 90.6250 (93.1250) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:728
clean false:13
clean_rate:0.9824561403508771
noisy true:652
noisy false:239
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [163/200] batch [5/23] time 0.354 (0.350) data 0.276 (0.272) loss_x loss_x 0.2891 (0.2510) acc_x 93.7500 (93.7500) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [10/23] time 0.335 (0.348) data 0.258 (0.270) loss_x loss_x 0.1577 (0.2490) acc_x 96.8750 (95.0000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/23] time 0.316 (0.337) data 0.237 (0.260) loss_x loss_x 0.2319 (0.2810) acc_x 93.7500 (94.1667) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/23] time 0.351 (0.337) data 0.273 (0.260) loss_x loss_x 0.2876 (0.2832) acc_x 93.7500 (93.9062) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:734
clean false:17
clean_rate:0.9773635153129161
noisy true:637
noisy false:244
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [164/200] batch [5/23] time 0.340 (0.339) data 0.263 (0.262) loss_x loss_x 1.0107 (0.5316) acc_x 81.2500 (90.0000) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [10/23] time 0.332 (0.338) data 0.255 (0.261) loss_x loss_x 0.3704 (0.3883) acc_x 93.7500 (93.1250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/23] time 0.342 (0.339) data 0.264 (0.262) loss_x loss_x 0.3557 (0.3752) acc_x 90.6250 (92.7083) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/23] time 0.294 (0.336) data 0.217 (0.259) loss_x loss_x 0.1803 (0.3487) acc_x 96.8750 (92.9688) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:729
clean false:18
clean_rate:0.9759036144578314
noisy true:634
noisy false:251
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [165/200] batch [5/23] time 0.342 (0.345) data 0.265 (0.268) loss_x loss_x 0.5522 (0.3841) acc_x 84.3750 (89.3750) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [10/23] time 0.354 (0.344) data 0.276 (0.266) loss_x loss_x 0.3340 (0.3611) acc_x 90.6250 (90.3125) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/23] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.2700 (0.3432) acc_x 93.7500 (91.0417) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/23] time 0.357 (0.346) data 0.279 (0.268) loss_x loss_x 0.3079 (0.3288) acc_x 90.6250 (91.4062) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 278
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:722
clean false:16
clean_rate:0.978319783197832
noisy true:632
noisy false:262
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [166/200] batch [5/23] time 0.322 (0.341) data 0.244 (0.263) loss_x loss_x 0.4685 (0.3367) acc_x 87.5000 (93.7500) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [10/23] time 0.342 (0.344) data 0.264 (0.267) loss_x loss_x 0.1954 (0.2804) acc_x 96.8750 (94.6875) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/23] time 0.334 (0.342) data 0.257 (0.265) loss_x loss_x 0.1209 (0.3197) acc_x 100.0000 (93.5417) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/23] time 0.334 (0.341) data 0.257 (0.263) loss_x loss_x 0.3596 (0.3074) acc_x 87.5000 (93.2812) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 240
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:736
clean false:18
clean_rate:0.9761273209549072
noisy true:656
noisy false:222
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [167/200] batch [5/23] time 0.362 (0.354) data 0.284 (0.277) loss_x loss_x 0.2898 (0.3083) acc_x 96.8750 (95.6250) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [10/23] time 0.359 (0.355) data 0.280 (0.278) loss_x loss_x 0.3247 (0.3157) acc_x 93.7500 (93.4375) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/23] time 0.349 (0.351) data 0.271 (0.273) loss_x loss_x 0.2795 (0.2916) acc_x 93.7500 (94.1667) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/23] time 0.341 (0.349) data 0.264 (0.272) loss_x loss_x 0.2644 (0.2988) acc_x 96.8750 (94.2188) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 272
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:722
clean false:18
clean_rate:0.9756756756756757
noisy true:638
noisy false:254
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [168/200] batch [5/23] time 0.322 (0.324) data 0.245 (0.245) loss_x loss_x 0.4358 (0.2871) acc_x 87.5000 (93.7500) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/23] time 0.322 (0.331) data 0.245 (0.253) loss_x loss_x 0.2213 (0.3293) acc_x 93.7500 (92.8125) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/23] time 0.357 (0.335) data 0.279 (0.258) loss_x loss_x 0.1969 (0.3442) acc_x 96.8750 (92.7083) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/23] time 0.304 (0.331) data 0.226 (0.253) loss_x loss_x 0.1655 (0.3173) acc_x 96.8750 (93.4375) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:732
clean false:22
clean_rate:0.9708222811671088
noisy true:635
noisy false:243
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [169/200] batch [5/23] time 0.342 (0.344) data 0.264 (0.265) loss_x loss_x 0.2656 (0.3616) acc_x 96.8750 (93.1250) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/23] time 0.327 (0.334) data 0.249 (0.256) loss_x loss_x 0.2598 (0.2945) acc_x 96.8750 (95.0000) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/23] time 0.292 (0.329) data 0.214 (0.251) loss_x loss_x 0.3823 (0.3026) acc_x 84.3750 (93.7500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/23] time 0.332 (0.330) data 0.254 (0.252) loss_x loss_x 0.3379 (0.3054) acc_x 87.5000 (93.2812) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:731
clean false:17
clean_rate:0.9772727272727273
noisy true:631
noisy false:253
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [170/200] batch [5/23] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.3625 (0.3117) acc_x 90.6250 (92.5000) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/23] time 0.296 (0.339) data 0.218 (0.262) loss_x loss_x 0.3840 (0.3139) acc_x 90.6250 (93.4375) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/23] time 0.297 (0.323) data 0.219 (0.246) loss_x loss_x 0.0958 (0.3101) acc_x 100.0000 (93.7500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/23] time 0.350 (0.326) data 0.273 (0.248) loss_x loss_x 0.3074 (0.3099) acc_x 87.5000 (93.2812) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:741
clean false:17
clean_rate:0.9775725593667546
noisy true:633
noisy false:241
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [171/200] batch [5/23] time 0.339 (0.337) data 0.261 (0.260) loss_x loss_x 0.2974 (0.3147) acc_x 93.7500 (93.7500) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/23] time 0.346 (0.341) data 0.268 (0.264) loss_x loss_x 0.1678 (0.2968) acc_x 96.8750 (94.3750) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/23] time 0.305 (0.337) data 0.227 (0.260) loss_x loss_x 0.3691 (0.2912) acc_x 90.6250 (94.7917) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/23] time 0.340 (0.335) data 0.262 (0.257) loss_x loss_x 0.3464 (0.2967) acc_x 90.6250 (93.9062) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:729
clean false:18
clean_rate:0.9759036144578314
noisy true:643
noisy false:242
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [172/200] batch [5/23] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.3384 (0.2969) acc_x 90.6250 (93.7500) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [10/23] time 0.340 (0.347) data 0.263 (0.269) loss_x loss_x 0.3511 (0.3256) acc_x 90.6250 (92.5000) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/23] time 0.326 (0.341) data 0.249 (0.263) loss_x loss_x 0.4285 (0.3244) acc_x 87.5000 (92.2917) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/23] time 0.334 (0.335) data 0.257 (0.257) loss_x loss_x 0.3333 (0.3098) acc_x 90.6250 (92.9688) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:736
clean false:16
clean_rate:0.9787234042553191
noisy true:641
noisy false:239
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [173/200] batch [5/23] time 0.363 (0.349) data 0.285 (0.272) loss_x loss_x 0.1626 (0.3333) acc_x 93.7500 (91.2500) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [10/23] time 0.343 (0.348) data 0.266 (0.270) loss_x loss_x 0.2773 (0.3615) acc_x 93.7500 (90.9375) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/23] time 0.341 (0.347) data 0.264 (0.270) loss_x loss_x 0.2390 (0.3405) acc_x 96.8750 (91.8750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/23] time 0.355 (0.345) data 0.277 (0.267) loss_x loss_x 0.3721 (0.3613) acc_x 93.7500 (90.9375) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:725
clean false:17
clean_rate:0.977088948787062
noisy true:649
noisy false:241
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [174/200] batch [5/23] time 0.335 (0.346) data 0.257 (0.268) loss_x loss_x 0.2834 (0.2445) acc_x 90.6250 (93.7500) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/23] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.1096 (0.2682) acc_x 100.0000 (93.1250) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/23] time 0.342 (0.343) data 0.265 (0.266) loss_x loss_x 0.4878 (0.2790) acc_x 84.3750 (93.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/23] time 0.349 (0.346) data 0.271 (0.269) loss_x loss_x 0.2798 (0.2995) acc_x 93.7500 (92.5000) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:738
clean false:18
clean_rate:0.9761904761904762
noisy true:638
noisy false:238
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [175/200] batch [5/23] time 0.336 (0.332) data 0.259 (0.255) loss_x loss_x 0.4280 (0.3796) acc_x 90.6250 (90.0000) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/23] time 0.295 (0.322) data 0.217 (0.245) loss_x loss_x 0.5977 (0.3810) acc_x 81.2500 (90.0000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/23] time 0.336 (0.328) data 0.259 (0.251) loss_x loss_x 0.2479 (0.3506) acc_x 93.7500 (91.4583) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/23] time 0.351 (0.331) data 0.273 (0.254) loss_x loss_x 0.4832 (0.3440) acc_x 87.5000 (92.0312) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:729
clean false:16
clean_rate:0.978523489932886
noisy true:633
noisy false:254
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [176/200] batch [5/23] time 0.330 (0.330) data 0.252 (0.252) loss_x loss_x 0.3350 (0.3373) acc_x 93.7500 (91.2500) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/23] time 0.338 (0.335) data 0.261 (0.258) loss_x loss_x 0.3521 (0.3164) acc_x 87.5000 (92.1875) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/23] time 0.333 (0.335) data 0.256 (0.258) loss_x loss_x 0.2374 (0.3007) acc_x 93.7500 (92.9167) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/23] time 0.335 (0.332) data 0.258 (0.255) loss_x loss_x 0.1556 (0.2730) acc_x 96.8750 (93.9062) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:726
clean false:15
clean_rate:0.979757085020243
noisy true:641
noisy false:250
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [177/200] batch [5/23] time 0.353 (0.333) data 0.276 (0.255) loss_x loss_x 0.2490 (0.2450) acc_x 93.7500 (95.6250) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/23] time 0.333 (0.335) data 0.255 (0.258) loss_x loss_x 0.4177 (0.3317) acc_x 93.7500 (92.5000) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/23] time 0.307 (0.332) data 0.228 (0.254) loss_x loss_x 0.1392 (0.3249) acc_x 96.8750 (92.5000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/23] time 0.344 (0.333) data 0.267 (0.255) loss_x loss_x 0.2279 (0.3009) acc_x 93.7500 (93.4375) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4651, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 759
clean true:742
clean false:17
clean_rate:0.9776021080368906
noisy true:640
noisy false:233
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 873
epoch [178/200] batch [5/23] time 0.308 (0.316) data 0.230 (0.239) loss_x loss_x 0.1821 (0.3090) acc_x 93.7500 (92.5000) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/23] time 0.299 (0.314) data 0.222 (0.237) loss_x loss_x 0.4497 (0.3163) acc_x 90.6250 (92.8125) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/23] time 0.298 (0.308) data 0.220 (0.230) loss_x loss_x 0.1284 (0.2913) acc_x 100.0000 (93.9583) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/23] time 0.296 (0.303) data 0.218 (0.226) loss_x loss_x 0.1096 (0.2715) acc_x 96.8750 (94.2188) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:723
clean false:15
clean_rate:0.9796747967479674
noisy true:644
noisy false:250
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [179/200] batch [5/23] time 0.300 (0.313) data 0.223 (0.236) loss_x loss_x 0.4546 (0.3506) acc_x 87.5000 (91.8750) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/23] time 0.295 (0.307) data 0.218 (0.229) loss_x loss_x 0.2216 (0.3203) acc_x 93.7500 (93.7500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/23] time 0.331 (0.311) data 0.253 (0.233) loss_x loss_x 0.3625 (0.3234) acc_x 93.7500 (93.3333) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/23] time 0.292 (0.309) data 0.214 (0.232) loss_x loss_x 0.3286 (0.2995) acc_x 90.6250 (94.2188) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:740
clean false:16
clean_rate:0.9788359788359788
noisy true:648
noisy false:228
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [180/200] batch [5/23] time 0.345 (0.336) data 0.267 (0.259) loss_x loss_x 0.2598 (0.4034) acc_x 93.7500 (90.0000) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/23] time 0.348 (0.340) data 0.271 (0.263) loss_x loss_x 0.2120 (0.3292) acc_x 96.8750 (92.1875) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/23] time 0.341 (0.340) data 0.264 (0.263) loss_x loss_x 0.4270 (0.3462) acc_x 90.6250 (91.6667) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/23] time 0.339 (0.338) data 0.261 (0.261) loss_x loss_x 0.5073 (0.3302) acc_x 84.3750 (91.8750) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 248
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:736
clean false:17
clean_rate:0.9774236387782205
noisy true:648
noisy false:231
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [181/200] batch [5/23] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.2581 (0.3971) acc_x 96.8750 (90.6250) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [10/23] time 0.303 (0.328) data 0.227 (0.250) loss_x loss_x 0.0527 (0.3304) acc_x 100.0000 (92.5000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/23] time 0.301 (0.323) data 0.223 (0.245) loss_x loss_x 0.4548 (0.3122) acc_x 90.6250 (92.7083) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/23] time 0.306 (0.318) data 0.228 (0.240) loss_x loss_x 0.2094 (0.2963) acc_x 96.8750 (93.7500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:738
clean false:15
clean_rate:0.9800796812749004
noisy true:642
noisy false:237
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [182/200] batch [5/23] time 0.291 (0.300) data 0.213 (0.223) loss_x loss_x 0.2693 (0.3937) acc_x 96.8750 (91.2500) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/23] time 0.298 (0.300) data 0.220 (0.223) loss_x loss_x 0.5181 (0.3302) acc_x 87.5000 (92.8125) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/23] time 0.300 (0.301) data 0.222 (0.223) loss_x loss_x 0.2617 (0.3045) acc_x 93.7500 (92.9167) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/23] time 0.316 (0.301) data 0.238 (0.224) loss_x loss_x 0.2383 (0.2799) acc_x 96.8750 (93.5938) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:729
clean false:14
clean_rate:0.9811574697173621
noisy true:645
noisy false:244
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [183/200] batch [5/23] time 0.301 (0.308) data 0.223 (0.230) loss_x loss_x 0.4448 (0.2853) acc_x 90.6250 (93.7500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/23] time 0.308 (0.309) data 0.230 (0.231) loss_x loss_x 0.3904 (0.2668) acc_x 93.7500 (95.0000) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/23] time 0.310 (0.306) data 0.233 (0.228) loss_x loss_x 0.2825 (0.2528) acc_x 93.7500 (95.2083) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/23] time 0.345 (0.311) data 0.267 (0.233) loss_x loss_x 0.3567 (0.2652) acc_x 90.6250 (95.3125) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 285
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:721
clean false:15
clean_rate:0.9796195652173914
noisy true:626
noisy false:270
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [184/200] batch [5/23] time 0.342 (0.308) data 0.264 (0.230) loss_x loss_x 0.3352 (0.2881) acc_x 90.6250 (93.1250) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/23] time 0.301 (0.308) data 0.222 (0.230) loss_x loss_x 0.1273 (0.2935) acc_x 100.0000 (93.4375) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/23] time 0.299 (0.310) data 0.221 (0.232) loss_x loss_x 0.3442 (0.2822) acc_x 90.6250 (93.9583) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/23] time 0.298 (0.307) data 0.220 (0.229) loss_x loss_x 0.2549 (0.2759) acc_x 93.7500 (93.7500) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:731
clean false:17
clean_rate:0.9772727272727273
noisy true:639
noisy false:245
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [185/200] batch [5/23] time 0.335 (0.304) data 0.258 (0.226) loss_x loss_x 0.2671 (0.2932) acc_x 96.8750 (93.7500) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/23] time 0.310 (0.305) data 0.233 (0.228) loss_x loss_x 0.1840 (0.2677) acc_x 100.0000 (95.3125) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/23] time 0.293 (0.302) data 0.216 (0.225) loss_x loss_x 0.4448 (0.2772) acc_x 90.6250 (94.7917) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/23] time 0.300 (0.302) data 0.222 (0.224) loss_x loss_x 0.3157 (0.2823) acc_x 93.7500 (94.6875) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 248
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:728
clean false:16
clean_rate:0.978494623655914
noisy true:656
noisy false:232
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [186/200] batch [5/23] time 0.335 (0.323) data 0.258 (0.246) loss_x loss_x 0.8901 (0.4890) acc_x 87.5000 (90.0000) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/23] time 0.328 (0.323) data 0.251 (0.245) loss_x loss_x 0.3140 (0.4110) acc_x 90.6250 (91.2500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/23] time 0.309 (0.317) data 0.232 (0.239) loss_x loss_x 0.1089 (0.3663) acc_x 100.0000 (91.8750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/23] time 0.299 (0.319) data 0.222 (0.242) loss_x loss_x 0.1713 (0.3652) acc_x 96.8750 (92.3438) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.4657, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 760
clean true:743
clean false:17
clean_rate:0.9776315789473684
noisy true:643
noisy false:229
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 872
epoch [187/200] batch [5/23] time 0.299 (0.301) data 0.221 (0.224) loss_x loss_x 0.2395 (0.2297) acc_x 96.8750 (95.6250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/23] time 0.303 (0.299) data 0.225 (0.221) loss_x loss_x 0.2423 (0.2671) acc_x 96.8750 (94.6875) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/23] time 0.323 (0.300) data 0.245 (0.222) loss_x loss_x 0.1504 (0.2522) acc_x 96.8750 (94.5833) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/23] time 0.305 (0.301) data 0.227 (0.224) loss_x loss_x 0.4541 (0.2574) acc_x 96.8750 (94.8438) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:737
clean false:17
clean_rate:0.9774535809018567
noisy true:632
noisy false:246
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [188/200] batch [5/23] time 0.309 (0.300) data 0.232 (0.222) loss_x loss_x 0.1744 (0.2740) acc_x 93.7500 (94.3750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/23] time 0.296 (0.300) data 0.218 (0.222) loss_x loss_x 0.4475 (0.3036) acc_x 87.5000 (93.4375) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/23] time 0.295 (0.300) data 0.217 (0.222) loss_x loss_x 0.3943 (0.3293) acc_x 90.6250 (92.7083) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/23] time 0.303 (0.303) data 0.224 (0.225) loss_x loss_x 0.2786 (0.3424) acc_x 96.8750 (92.6562) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:734
clean false:16
clean_rate:0.9786666666666667
noisy true:635
noisy false:247
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [189/200] batch [5/23] time 0.294 (0.319) data 0.217 (0.241) loss_x loss_x 0.1940 (0.2926) acc_x 96.8750 (93.7500) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/23] time 0.299 (0.307) data 0.223 (0.230) loss_x loss_x 0.1656 (0.2628) acc_x 96.8750 (94.3750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/23] time 0.282 (0.300) data 0.204 (0.223) loss_x loss_x 0.3135 (0.2748) acc_x 93.7500 (93.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/23] time 0.302 (0.299) data 0.224 (0.222) loss_x loss_x 0.2646 (0.2777) acc_x 93.7500 (93.4375) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:732
clean false:17
clean_rate:0.9773030707610146
noisy true:657
noisy false:226
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [190/200] batch [5/23] time 0.282 (0.291) data 0.204 (0.214) loss_x loss_x 0.2749 (0.3870) acc_x 90.6250 (92.5000) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/23] time 0.294 (0.293) data 0.216 (0.215) loss_x loss_x 0.1969 (0.2921) acc_x 96.8750 (94.0625) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/23] time 0.297 (0.294) data 0.219 (0.216) loss_x loss_x 0.2710 (0.2763) acc_x 90.6250 (93.9583) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/23] time 0.298 (0.293) data 0.220 (0.216) loss_x loss_x 0.1798 (0.2615) acc_x 96.8750 (94.2188) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:718
clean false:18
clean_rate:0.9755434782608695
noisy true:653
noisy false:243
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [191/200] batch [5/23] time 0.297 (0.302) data 0.219 (0.224) loss_x loss_x 0.3462 (0.2772) acc_x 87.5000 (92.5000) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/23] time 0.296 (0.299) data 0.218 (0.221) loss_x loss_x 0.2512 (0.2671) acc_x 93.7500 (94.0625) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/23] time 0.280 (0.295) data 0.202 (0.217) loss_x loss_x 0.2280 (0.2841) acc_x 100.0000 (94.3750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/23] time 0.297 (0.295) data 0.220 (0.217) loss_x loss_x 0.3447 (0.2820) acc_x 87.5000 (94.0625) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:737
clean false:16
clean_rate:0.9787516600265604
noisy true:652
noisy false:227
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [192/200] batch [5/23] time 0.289 (0.305) data 0.211 (0.227) loss_x loss_x 0.2303 (0.2496) acc_x 96.8750 (95.6250) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/23] time 0.295 (0.302) data 0.217 (0.224) loss_x loss_x 0.1851 (0.2579) acc_x 96.8750 (95.0000) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/23] time 0.296 (0.300) data 0.218 (0.223) loss_x loss_x 0.5161 (0.2762) acc_x 90.6250 (94.1667) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/23] time 0.295 (0.299) data 0.217 (0.222) loss_x loss_x 0.2008 (0.2798) acc_x 93.7500 (93.5938) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:729
clean false:17
clean_rate:0.9772117962466488
noisy true:640
noisy false:246
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [193/200] batch [5/23] time 0.300 (0.302) data 0.221 (0.224) loss_x loss_x 0.2966 (0.2456) acc_x 93.7500 (93.7500) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [10/23] time 0.288 (0.298) data 0.211 (0.220) loss_x loss_x 0.3096 (0.2583) acc_x 90.6250 (94.0625) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/23] time 0.297 (0.300) data 0.218 (0.223) loss_x loss_x 0.0722 (0.2610) acc_x 100.0000 (93.5417) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/23] time 0.298 (0.301) data 0.220 (0.224) loss_x loss_x 0.5562 (0.2744) acc_x 84.3750 (93.2812) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.4479, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 731
clean true:716
clean false:15
clean_rate:0.9794801641586868
noisy true:648
noisy false:253
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 901
epoch [194/200] batch [5/22] time 0.298 (0.298) data 0.220 (0.220) loss_x loss_x 0.1292 (0.3026) acc_x 100.0000 (93.1250) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/22] time 0.299 (0.302) data 0.222 (0.224) loss_x loss_x 0.1904 (0.2762) acc_x 96.8750 (93.7500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/22] time 0.290 (0.300) data 0.213 (0.222) loss_x loss_x 0.4250 (0.2746) acc_x 84.3750 (93.5417) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/22] time 0.293 (0.298) data 0.214 (0.220) loss_x loss_x 0.4492 (0.2909) acc_x 81.2500 (92.6562) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.4657, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 760
clean true:744
clean false:16
clean_rate:0.9789473684210527
noisy true:645
noisy false:227
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 872
epoch [195/200] batch [5/23] time 0.297 (0.305) data 0.219 (0.227) loss_x loss_x 0.1664 (0.2861) acc_x 96.8750 (91.8750) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/23] time 0.297 (0.302) data 0.220 (0.224) loss_x loss_x 0.2656 (0.2965) acc_x 96.8750 (92.5000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/23] time 0.302 (0.301) data 0.225 (0.223) loss_x loss_x 0.1929 (0.2646) acc_x 96.8750 (94.1667) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/23] time 0.307 (0.300) data 0.229 (0.223) loss_x loss_x 0.4309 (0.3037) acc_x 93.7500 (93.1250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:733
clean false:21
clean_rate:0.9721485411140584
noisy true:639
noisy false:239
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [196/200] batch [5/23] time 0.293 (0.302) data 0.215 (0.224) loss_x loss_x 0.3433 (0.3090) acc_x 93.7500 (92.5000) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/23] time 0.293 (0.300) data 0.215 (0.222) loss_x loss_x 0.3503 (0.3038) acc_x 93.7500 (93.7500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/23] time 0.299 (0.299) data 0.221 (0.221) loss_x loss_x 0.1371 (0.3048) acc_x 100.0000 (94.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/23] time 0.291 (0.298) data 0.214 (0.220) loss_x loss_x 0.3015 (0.3209) acc_x 93.7500 (93.9062) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 240
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:739
clean false:18
clean_rate:0.9762219286657859
noisy true:653
noisy false:222
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [197/200] batch [5/23] time 0.295 (0.299) data 0.218 (0.221) loss_x loss_x 0.2678 (0.2801) acc_x 93.7500 (93.7500) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/23] time 0.291 (0.297) data 0.214 (0.219) loss_x loss_x 0.3865 (0.3108) acc_x 90.6250 (92.8125) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/23] time 0.287 (0.295) data 0.209 (0.218) loss_x loss_x 0.4968 (0.3626) acc_x 84.3750 (90.8333) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/23] time 0.305 (0.296) data 0.227 (0.218) loss_x loss_x 0.2319 (0.3442) acc_x 96.8750 (91.8750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:733
clean false:18
clean_rate:0.9760319573901465
noisy true:630
noisy false:251
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [198/200] batch [5/23] time 0.297 (0.296) data 0.219 (0.218) loss_x loss_x 0.2534 (0.3057) acc_x 96.8750 (94.3750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/23] time 0.302 (0.297) data 0.224 (0.220) loss_x loss_x 0.1844 (0.2608) acc_x 100.0000 (95.3125) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/23] time 0.300 (0.299) data 0.223 (0.222) loss_x loss_x 0.2908 (0.2655) acc_x 93.7500 (95.4167) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/23] time 0.299 (0.301) data 0.221 (0.223) loss_x loss_x 0.3120 (0.2779) acc_x 93.7500 (95.1562) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:725
clean false:17
clean_rate:0.977088948787062
noisy true:638
noisy false:252
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [199/200] batch [5/23] time 0.286 (0.295) data 0.208 (0.217) loss_x loss_x 0.4968 (0.2739) acc_x 84.3750 (93.7500) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [10/23] time 0.302 (0.295) data 0.225 (0.218) loss_x loss_x 0.0714 (0.2393) acc_x 100.0000 (95.0000) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/23] time 0.293 (0.295) data 0.216 (0.218) loss_x loss_x 0.3198 (0.2465) acc_x 90.6250 (94.1667) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/23] time 0.298 (0.296) data 0.220 (0.218) loss_x loss_x 0.2502 (0.2614) acc_x 96.8750 (93.5938) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:728
clean false:17
clean_rate:0.9771812080536912
noisy true:635
noisy false:252
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [200/200] batch [5/23] time 0.300 (0.299) data 0.222 (0.221) loss_x loss_x 0.4370 (0.2948) acc_x 90.6250 (93.7500) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/23] time 0.288 (0.296) data 0.210 (0.218) loss_x loss_x 0.2432 (0.2854) acc_x 96.8750 (93.7500) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/23] time 0.292 (0.295) data 0.214 (0.217) loss_x loss_x 0.1864 (0.2810) acc_x 93.7500 (93.5417) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/23] time 0.285 (0.293) data 0.207 (0.215) loss_x loss_x 0.4114 (0.3167) acc_x 90.6250 (93.2812) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,154
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 86.7%
Elapsed: 1:25:52
