***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1452, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 237
clean true:231
clean false:6
clean_rate:0.9746835443037974
noisy true:144
noisy false:1251
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 1395
epoch [1/200] batch [5/7] time 0.319 (0.360) data 0.241 (0.260) loss_x loss_x 2.8086 (2.7461) acc_x 28.1250 (35.0000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1193
confident_label rate tensor(0.1703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 278
clean true:276
clean false:2
clean_rate:0.9928057553956835
noisy true:163
noisy false:1191
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 1354
epoch [2/200] batch [5/8] time 0.360 (0.396) data 0.283 (0.296) loss_x loss_x 1.1553 (1.3826) acc_x 75.0000 (63.1250) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 765
confident_label rate tensor(0.3290, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 537
clean true:534
clean false:3
clean_rate:0.994413407821229
noisy true:333
noisy false:762
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1095
epoch [3/200] batch [5/16] time 0.369 (0.366) data 0.291 (0.266) loss_x loss_x 0.7495 (0.9042) acc_x 81.2500 (80.0000) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/16] time 0.366 (0.360) data 0.288 (0.271) loss_x loss_x 0.9771 (0.9141) acc_x 75.0000 (77.5000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/16] time 0.348 (0.355) data 0.271 (0.270) loss_x loss_x 0.9336 (0.8770) acc_x 84.3750 (78.1250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 749
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:566
clean false:4
clean_rate:0.9929824561403509
noisy true:317
noisy false:745
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [4/200] batch [5/17] time 0.305 (0.369) data 0.226 (0.269) loss_x loss_x 0.6128 (0.6712) acc_x 84.3750 (83.1250) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/17] time 0.341 (0.344) data 0.263 (0.255) loss_x loss_x 0.9341 (0.8581) acc_x 71.8750 (76.8750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/17] time 0.353 (0.347) data 0.276 (0.262) loss_x loss_x 0.7979 (0.8481) acc_x 78.1250 (77.9167) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 706
confident_label rate tensor(0.3640, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 594
clean true:593
clean false:1
clean_rate:0.9983164983164983
noisy true:333
noisy false:705
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1038
epoch [5/200] batch [5/18] time 0.384 (0.369) data 0.307 (0.292) loss_x loss_x 0.7036 (0.8115) acc_x 78.1250 (76.8750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/18] time 0.309 (0.346) data 0.232 (0.268) loss_x loss_x 0.5435 (0.7085) acc_x 84.3750 (81.2500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/18] time 0.340 (0.349) data 0.262 (0.264) loss_x loss_x 0.7476 (0.7486) acc_x 84.3750 (82.0833) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 717
confident_label rate tensor(0.3591, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 586
clean true:584
clean false:2
clean_rate:0.9965870307167235
noisy true:331
noisy false:715
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1046
epoch [6/200] batch [5/18] time 0.359 (0.337) data 0.282 (0.259) loss_x loss_x 0.9009 (0.7890) acc_x 78.1250 (81.2500) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/18] time 0.373 (0.351) data 0.295 (0.273) loss_x loss_x 0.7690 (0.7547) acc_x 78.1250 (81.5625) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/18] time 0.355 (0.356) data 0.276 (0.278) loss_x loss_x 1.0488 (0.7761) acc_x 78.1250 (81.0417) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 683
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:598
clean false:1
clean_rate:0.998330550918197
noisy true:351
noisy false:682
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [7/200] batch [5/18] time 0.377 (0.369) data 0.299 (0.292) loss_x loss_x 1.0000 (0.7555) acc_x 78.1250 (81.8750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/18] time 0.348 (0.356) data 0.271 (0.279) loss_x loss_x 0.7695 (0.7175) acc_x 87.5000 (83.1250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/18] time 0.296 (0.343) data 0.218 (0.265) loss_x loss_x 1.1074 (0.7168) acc_x 81.2500 (82.9167) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 684
confident_label rate tensor(0.3566, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 582
clean true:582
clean false:0
clean_rate:1.0
noisy true:366
noisy false:684
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1050
epoch [8/200] batch [5/18] time 0.367 (0.367) data 0.289 (0.275) loss_x loss_x 0.4756 (0.5266) acc_x 87.5000 (87.5000) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/18] time 0.353 (0.359) data 0.276 (0.274) loss_x loss_x 0.8350 (0.5845) acc_x 78.1250 (86.5625) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/18] time 0.379 (0.370) data 0.302 (0.280) loss_x loss_x 0.6372 (0.6258) acc_x 75.0000 (84.5833) lr 1.9956e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 671
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 605
clean true:604
clean false:1
clean_rate:0.9983471074380166
noisy true:357
noisy false:670
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1027
epoch [9/200] batch [5/18] time 0.311 (0.371) data 0.232 (0.293) loss_x loss_x 0.5508 (0.5132) acc_x 81.2500 (85.6250) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/18] time 0.355 (0.340) data 0.277 (0.262) loss_x loss_x 0.7124 (0.5865) acc_x 81.2500 (84.0625) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/18] time 0.343 (0.334) data 0.265 (0.256) loss_x loss_x 0.2976 (0.5786) acc_x 96.8750 (83.7500) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 665
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 613
clean true:611
clean false:2
clean_rate:0.9967373572593801
noisy true:356
noisy false:663
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1019
epoch [10/200] batch [5/19] time 0.342 (0.335) data 0.265 (0.257) loss_x loss_x 0.4358 (0.6773) acc_x 90.6250 (81.8750) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/19] time 0.344 (0.338) data 0.267 (0.260) loss_x loss_x 0.5508 (0.6707) acc_x 84.3750 (82.1875) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/19] time 0.302 (0.326) data 0.225 (0.249) loss_x loss_x 0.6665 (0.6774) acc_x 87.5000 (82.9167) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 662
confident_label rate tensor(0.3805, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 621
clean true:617
clean false:4
clean_rate:0.9935587761674718
noisy true:353
noisy false:658
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 1011
epoch [11/200] batch [5/19] time 0.305 (0.335) data 0.227 (0.258) loss_x loss_x 0.7290 (0.5727) acc_x 84.3750 (87.5000) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/19] time 0.367 (0.336) data 0.290 (0.258) loss_x loss_x 0.7988 (0.5790) acc_x 87.5000 (87.8125) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/19] time 0.363 (0.350) data 0.285 (0.268) loss_x loss_x 0.6582 (0.6397) acc_x 87.5000 (85.6250) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 633
confident_label rate tensor(0.3958, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 646
clean true:641
clean false:5
clean_rate:0.9922600619195047
noisy true:358
noisy false:628
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 986
epoch [12/200] batch [5/20] time 0.376 (0.398) data 0.299 (0.298) loss_x loss_x 0.6064 (0.6364) acc_x 84.3750 (83.7500) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/20] time 0.302 (0.373) data 0.225 (0.284) loss_x loss_x 0.6421 (0.6341) acc_x 81.2500 (84.6875) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/20] time 0.326 (0.351) data 0.240 (0.265) loss_x loss_x 0.7915 (0.6956) acc_x 71.8750 (81.6667) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/20] time 0.394 (0.356) data 0.316 (0.273) loss_x loss_x 0.7212 (0.7295) acc_x 84.3750 (81.0938) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 623
confident_label rate tensor(0.3897, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 636
clean true:635
clean false:1
clean_rate:0.9984276729559748
noisy true:374
noisy false:622
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 996
epoch [13/200] batch [5/19] time 0.373 (0.378) data 0.296 (0.300) loss_x loss_x 0.2776 (0.5229) acc_x 93.7500 (86.2500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [10/19] time 0.349 (0.368) data 0.271 (0.287) loss_x loss_x 0.7036 (0.5943) acc_x 81.2500 (82.8125) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/19] time 0.326 (0.360) data 0.249 (0.280) loss_x loss_x 0.4331 (0.5873) acc_x 96.8750 (84.7917) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 612
confident_label rate tensor(0.3915, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 639
clean true:638
clean false:1
clean_rate:0.9984350547730829
noisy true:382
noisy false:611
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 993
epoch [14/200] batch [5/19] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.7280 (0.7257) acc_x 87.5000 (83.7500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/19] time 0.357 (0.362) data 0.279 (0.273) loss_x loss_x 0.3337 (0.6702) acc_x 93.7500 (84.3750) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/19] time 0.397 (0.365) data 0.320 (0.280) loss_x loss_x 0.6904 (0.6652) acc_x 87.5000 (85.0000) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 601
confident_label rate tensor(0.4026, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 657
clean true:653
clean false:4
clean_rate:0.9939117199391172
noisy true:378
noisy false:597
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 975
epoch [15/200] batch [5/20] time 0.332 (0.377) data 0.255 (0.277) loss_x loss_x 0.9150 (0.5357) acc_x 68.7500 (85.6250) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/20] time 0.344 (0.367) data 0.265 (0.279) loss_x loss_x 0.6597 (0.6535) acc_x 81.2500 (83.1250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/20] time 0.429 (0.367) data 0.352 (0.281) loss_x loss_x 0.6909 (0.6607) acc_x 75.0000 (83.3333) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/20] time 0.366 (0.368) data 0.289 (0.284) loss_x loss_x 0.5889 (0.6273) acc_x 87.5000 (84.2188) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 603
confident_label rate tensor(0.4001, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 653
clean true:649
clean false:4
clean_rate:0.9938744257274119
noisy true:380
noisy false:599
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 979
epoch [16/200] batch [5/20] time 0.371 (0.340) data 0.269 (0.240) loss_x loss_x 0.5200 (0.6689) acc_x 90.6250 (84.3750) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/20] time 0.377 (0.356) data 0.298 (0.267) loss_x loss_x 0.3315 (0.5980) acc_x 93.7500 (85.0000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/20] time 0.365 (0.356) data 0.286 (0.271) loss_x loss_x 0.4165 (0.5976) acc_x 87.5000 (84.3750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/20] time 0.351 (0.358) data 0.273 (0.273) loss_x loss_x 0.6870 (0.5891) acc_x 84.3750 (84.8438) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:663
clean false:2
clean_rate:0.9969924812030075
noisy true:400
noisy false:567
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [17/200] batch [5/20] time 0.402 (0.390) data 0.325 (0.313) loss_x loss_x 0.6250 (0.5686) acc_x 87.5000 (88.7500) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/20] time 0.309 (0.347) data 0.230 (0.270) loss_x loss_x 0.6538 (0.5963) acc_x 84.3750 (87.5000) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/20] time 0.395 (0.345) data 0.317 (0.262) loss_x loss_x 0.6943 (0.6512) acc_x 71.8750 (85.0000) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/20] time 0.340 (0.353) data 0.263 (0.272) loss_x loss_x 0.5649 (0.6477) acc_x 81.2500 (84.0625) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.4099, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 669
clean true:667
clean false:2
clean_rate:0.9970104633781763
noisy true:391
noisy false:572
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 963
epoch [18/200] batch [5/20] time 0.416 (0.366) data 0.339 (0.274) loss_x loss_x 0.3337 (0.4849) acc_x 87.5000 (86.8750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/20] time 0.376 (0.375) data 0.299 (0.290) loss_x loss_x 0.3591 (0.5058) acc_x 87.5000 (87.1875) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/20] time 0.308 (0.359) data 0.230 (0.277) loss_x loss_x 1.2617 (0.5381) acc_x 78.1250 (87.5000) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/20] time 0.301 (0.345) data 0.222 (0.263) loss_x loss_x 0.9336 (0.5489) acc_x 78.1250 (87.1875) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.4007, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 654
clean true:653
clean false:1
clean_rate:0.9984709480122325
noisy true:404
noisy false:574
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 978
epoch [19/200] batch [5/20] time 0.303 (0.320) data 0.226 (0.242) loss_x loss_x 0.7007 (0.5104) acc_x 81.2500 (86.2500) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/20] time 0.423 (0.327) data 0.287 (0.244) loss_x loss_x 0.4355 (0.5348) acc_x 87.5000 (86.8750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/20] time 0.357 (0.340) data 0.279 (0.259) loss_x loss_x 0.5356 (0.5822) acc_x 90.6250 (86.4583) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/20] time 0.396 (0.348) data 0.319 (0.268) loss_x loss_x 0.4595 (0.5587) acc_x 87.5000 (87.1875) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 553
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 689
clean true:688
clean false:1
clean_rate:0.9985486211901307
noisy true:391
noisy false:552
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 943
epoch [20/200] batch [5/21] time 0.372 (0.392) data 0.295 (0.293) loss_x loss_x 0.6416 (0.5110) acc_x 84.3750 (87.5000) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/21] time 0.292 (0.354) data 0.215 (0.266) loss_x loss_x 0.4089 (0.5147) acc_x 90.6250 (88.4375) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/21] time 0.293 (0.337) data 0.215 (0.251) loss_x loss_x 0.8945 (0.5713) acc_x 81.2500 (86.8750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/21] time 0.400 (0.334) data 0.322 (0.251) loss_x loss_x 0.7251 (0.6297) acc_x 78.1250 (85.6250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 540
confident_label rate tensor(0.4228, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 690
clean true:689
clean false:1
clean_rate:0.9985507246376811
noisy true:403
noisy false:539
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 942
epoch [21/200] batch [5/21] time 0.368 (0.361) data 0.290 (0.283) loss_x loss_x 0.4453 (0.5368) acc_x 87.5000 (88.7500) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/21] time 0.368 (0.372) data 0.291 (0.291) loss_x loss_x 0.4077 (0.5640) acc_x 96.8750 (88.4375) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/21] time 0.306 (0.367) data 0.228 (0.287) loss_x loss_x 0.4333 (0.5604) acc_x 87.5000 (87.5000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/21] time 0.303 (0.353) data 0.225 (0.274) loss_x loss_x 0.3772 (0.5529) acc_x 93.7500 (87.0312) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 502
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:711
clean false:2
clean_rate:0.9971949509116409
noisy true:419
noisy false:500
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [22/200] batch [5/22] time 0.362 (0.364) data 0.284 (0.286) loss_x loss_x 0.4941 (0.6704) acc_x 87.5000 (81.8750) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [10/22] time 0.355 (0.378) data 0.278 (0.289) loss_x loss_x 0.5107 (0.6743) acc_x 90.6250 (84.0625) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/22] time 0.383 (0.371) data 0.304 (0.285) loss_x loss_x 0.5630 (0.6458) acc_x 90.6250 (84.5833) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/22] time 0.362 (0.374) data 0.284 (0.289) loss_x loss_x 0.6396 (0.6354) acc_x 87.5000 (84.3750) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.4228, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 690
clean true:687
clean false:3
clean_rate:0.9956521739130435
noisy true:396
noisy false:546
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 942
epoch [23/200] batch [5/21] time 0.333 (0.358) data 0.256 (0.280) loss_x loss_x 0.5859 (0.5279) acc_x 87.5000 (86.8750) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/21] time 0.396 (0.356) data 0.296 (0.276) loss_x loss_x 0.7798 (0.6115) acc_x 78.1250 (84.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/21] time 0.377 (0.364) data 0.300 (0.285) loss_x loss_x 0.8999 (0.6578) acc_x 90.6250 (84.7917) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/21] time 0.370 (0.361) data 0.292 (0.282) loss_x loss_x 0.3342 (0.6488) acc_x 90.6250 (84.8438) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 523
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 702
clean true:699
clean false:3
clean_rate:0.9957264957264957
noisy true:410
noisy false:520
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 930
epoch [24/200] batch [5/21] time 0.367 (0.373) data 0.290 (0.295) loss_x loss_x 0.4766 (0.4646) acc_x 90.6250 (88.7500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/21] time 0.348 (0.364) data 0.271 (0.286) loss_x loss_x 0.4924 (0.4805) acc_x 90.6250 (89.6875) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/21] time 0.303 (0.358) data 0.225 (0.280) loss_x loss_x 0.8750 (0.5473) acc_x 78.1250 (88.3333) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/21] time 0.356 (0.355) data 0.279 (0.277) loss_x loss_x 0.4922 (0.5529) acc_x 90.6250 (87.9688) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 524
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 714
clean true:710
clean false:4
clean_rate:0.9943977591036415
noisy true:398
noisy false:520
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 918
epoch [25/200] batch [5/22] time 0.424 (0.387) data 0.252 (0.291) loss_x loss_x 0.4866 (0.4808) acc_x 90.6250 (89.3750) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/22] time 0.346 (0.376) data 0.269 (0.289) loss_x loss_x 0.3706 (0.4652) acc_x 96.8750 (88.7500) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/22] time 0.346 (0.368) data 0.268 (0.284) loss_x loss_x 0.6436 (0.5167) acc_x 90.6250 (87.9167) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/22] time 0.352 (0.365) data 0.274 (0.283) loss_x loss_x 0.6948 (0.5596) acc_x 81.2500 (87.3438) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 500
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:721
clean false:3
clean_rate:0.9958563535911602
noisy true:411
noisy false:497
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [26/200] batch [5/22] time 0.341 (0.359) data 0.263 (0.281) loss_x loss_x 0.8779 (0.5170) acc_x 84.3750 (88.1250) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/22] time 0.386 (0.378) data 0.309 (0.290) loss_x loss_x 0.3933 (0.5522) acc_x 90.6250 (86.8750) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/22] time 0.348 (0.373) data 0.270 (0.288) loss_x loss_x 0.3540 (0.5791) acc_x 96.8750 (86.2500) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/22] time 0.365 (0.370) data 0.288 (0.287) loss_x loss_x 0.4385 (0.5558) acc_x 87.5000 (87.3438) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 514
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:712
clean false:1
clean_rate:0.9985974754558204
noisy true:406
noisy false:513
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [27/200] batch [5/22] time 0.309 (0.347) data 0.231 (0.247) loss_x loss_x 0.3718 (0.4137) acc_x 93.7500 (91.2500) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/22] time 0.371 (0.347) data 0.293 (0.258) loss_x loss_x 0.6875 (0.4805) acc_x 81.2500 (89.0625) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/22] time 0.356 (0.356) data 0.279 (0.271) loss_x loss_x 0.5757 (0.5076) acc_x 84.3750 (87.9167) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/22] time 0.379 (0.357) data 0.301 (0.274) loss_x loss_x 0.2583 (0.5372) acc_x 96.8750 (87.0312) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:747
clean false:4
clean_rate:0.9946737683089214
noisy true:413
noisy false:468
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [28/200] batch [5/23] time 0.302 (0.351) data 0.224 (0.274) loss_x loss_x 0.5928 (0.5654) acc_x 87.5000 (86.2500) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [10/23] time 0.339 (0.346) data 0.261 (0.261) loss_x loss_x 0.4844 (0.5974) acc_x 87.5000 (84.0625) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/23] time 0.312 (0.338) data 0.234 (0.256) loss_x loss_x 0.8130 (0.6057) acc_x 81.2500 (84.3750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/23] time 0.361 (0.340) data 0.284 (0.259) loss_x loss_x 0.2145 (0.5965) acc_x 96.8750 (84.2188) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 486
confident_label rate tensor(0.4461, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 728
clean true:726
clean false:2
clean_rate:0.9972527472527473
noisy true:420
noisy false:484
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 904
epoch [29/200] batch [5/22] time 0.318 (0.382) data 0.240 (0.304) loss_x loss_x 0.5708 (0.5781) acc_x 90.6250 (87.5000) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/22] time 0.371 (0.374) data 0.294 (0.296) loss_x loss_x 1.0430 (0.5729) acc_x 84.3750 (88.1250) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/22] time 0.331 (0.373) data 0.253 (0.289) loss_x loss_x 0.3135 (0.5432) acc_x 87.5000 (87.9167) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/22] time 0.360 (0.369) data 0.282 (0.286) loss_x loss_x 0.8794 (0.5719) acc_x 84.3750 (87.0312) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 473
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:737
clean false:0
clean_rate:1.0
noisy true:422
noisy false:473
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [30/200] batch [5/23] time 0.291 (0.308) data 0.213 (0.230) loss_x loss_x 0.5786 (0.3854) acc_x 81.2500 (91.2500) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/23] time 0.372 (0.347) data 0.293 (0.258) loss_x loss_x 0.6758 (0.4781) acc_x 87.5000 (89.3750) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/23] time 0.387 (0.351) data 0.309 (0.265) loss_x loss_x 1.0225 (0.5483) acc_x 71.8750 (87.9167) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/23] time 0.344 (0.351) data 0.266 (0.267) loss_x loss_x 0.3271 (0.5552) acc_x 90.6250 (87.3438) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 478
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:739
clean false:3
clean_rate:0.9959568733153639
noisy true:415
noisy false:475
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [31/200] batch [5/23] time 0.298 (0.339) data 0.221 (0.261) loss_x loss_x 0.4817 (0.4382) acc_x 87.5000 (89.3750) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/23] time 0.298 (0.320) data 0.221 (0.242) loss_x loss_x 0.5713 (0.5062) acc_x 90.6250 (89.3750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/23] time 0.312 (0.315) data 0.235 (0.237) loss_x loss_x 0.4268 (0.5223) acc_x 96.8750 (88.1250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/23] time 0.306 (0.311) data 0.229 (0.234) loss_x loss_x 0.3906 (0.5714) acc_x 90.6250 (86.7188) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 485
confident_label rate tensor(0.4473, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 730
clean true:729
clean false:1
clean_rate:0.9986301369863013
noisy true:418
noisy false:484
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 902
epoch [32/200] batch [5/22] time 0.363 (0.376) data 0.286 (0.298) loss_x loss_x 0.6616 (0.4747) acc_x 78.1250 (87.5000) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/22] time 0.358 (0.377) data 0.281 (0.293) loss_x loss_x 0.4797 (0.5273) acc_x 93.7500 (87.5000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/22] time 0.346 (0.368) data 0.269 (0.287) loss_x loss_x 0.6768 (0.5412) acc_x 90.6250 (87.9167) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/22] time 0.352 (0.362) data 0.275 (0.280) loss_x loss_x 0.5767 (0.5055) acc_x 75.0000 (87.9688) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 465
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:751
clean false:3
clean_rate:0.9960212201591512
noisy true:416
noisy false:462
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [33/200] batch [5/23] time 0.308 (0.323) data 0.230 (0.245) loss_x loss_x 0.7305 (0.6054) acc_x 81.2500 (86.8750) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/23] time 0.357 (0.345) data 0.280 (0.268) loss_x loss_x 0.3635 (0.5727) acc_x 96.8750 (88.4375) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/23] time 0.353 (0.351) data 0.275 (0.273) loss_x loss_x 0.6729 (0.5123) acc_x 84.3750 (89.1667) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/23] time 0.382 (0.360) data 0.304 (0.277) loss_x loss_x 0.6846 (0.5276) acc_x 87.5000 (89.2188) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:745
clean false:2
clean_rate:0.9973226238286479
noisy true:425
noisy false:460
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [34/200] batch [5/23] time 0.346 (0.391) data 0.269 (0.292) loss_x loss_x 0.6699 (0.6999) acc_x 81.2500 (80.6250) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [10/23] time 0.292 (0.362) data 0.215 (0.274) loss_x loss_x 0.7549 (0.6203) acc_x 75.0000 (83.4375) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/23] time 0.347 (0.346) data 0.268 (0.261) loss_x loss_x 0.5654 (0.6261) acc_x 84.3750 (83.7500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/23] time 0.357 (0.356) data 0.277 (0.269) loss_x loss_x 0.5630 (0.6021) acc_x 81.2500 (83.9062) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 426
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 764
clean true:760
clean false:4
clean_rate:0.9947643979057592
noisy true:446
noisy false:422
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 868
epoch [35/200] batch [5/23] time 0.353 (0.363) data 0.275 (0.285) loss_x loss_x 0.5435 (0.5948) acc_x 87.5000 (85.0000) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/23] time 0.352 (0.358) data 0.274 (0.280) loss_x loss_x 0.5220 (0.6142) acc_x 84.3750 (84.3750) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/23] time 0.319 (0.358) data 0.241 (0.278) loss_x loss_x 0.4902 (0.6012) acc_x 87.5000 (85.2083) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/23] time 0.304 (0.352) data 0.227 (0.273) loss_x loss_x 0.7153 (0.5781) acc_x 81.2500 (85.1562) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 445
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 765
clean true:760
clean false:5
clean_rate:0.9934640522875817
noisy true:427
noisy false:440
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 867
epoch [36/200] batch [5/23] time 0.325 (0.340) data 0.248 (0.262) loss_x loss_x 0.6758 (0.5609) acc_x 81.2500 (84.3750) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [10/23] time 0.356 (0.342) data 0.278 (0.265) loss_x loss_x 0.4316 (0.5427) acc_x 87.5000 (86.2500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/23] time 0.357 (0.349) data 0.280 (0.271) loss_x loss_x 0.7764 (0.5289) acc_x 68.7500 (86.0417) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/23] time 0.355 (0.356) data 0.278 (0.275) loss_x loss_x 0.9546 (0.5592) acc_x 78.1250 (85.1562) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 427
confident_label rate tensor(0.4779, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 780
clean true:777
clean false:3
clean_rate:0.9961538461538462
noisy true:428
noisy false:424
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 852
epoch [37/200] batch [5/24] time 0.312 (0.311) data 0.235 (0.233) loss_x loss_x 0.6230 (0.4610) acc_x 90.6250 (88.7500) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/24] time 0.328 (0.324) data 0.250 (0.246) loss_x loss_x 0.5762 (0.5303) acc_x 78.1250 (87.1875) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/24] time 0.386 (0.333) data 0.289 (0.253) loss_x loss_x 0.7959 (0.5311) acc_x 78.1250 (86.6667) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/24] time 0.363 (0.342) data 0.285 (0.263) loss_x loss_x 0.6255 (0.5197) acc_x 84.3750 (87.1875) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 437
confident_label rate tensor(0.4706, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 768
clean true:764
clean false:4
clean_rate:0.9947916666666666
noisy true:431
noisy false:433
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 864
epoch [38/200] batch [5/24] time 0.309 (0.332) data 0.231 (0.254) loss_x loss_x 0.4917 (0.4987) acc_x 87.5000 (88.1250) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [10/24] time 0.299 (0.325) data 0.221 (0.247) loss_x loss_x 0.3611 (0.4464) acc_x 90.6250 (90.3125) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/24] time 0.351 (0.331) data 0.274 (0.246) loss_x loss_x 0.5991 (0.4858) acc_x 87.5000 (90.4167) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/24] time 0.351 (0.338) data 0.274 (0.254) loss_x loss_x 0.3594 (0.5310) acc_x 90.6250 (87.9688) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 412
confident_label rate tensor(0.4804, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 784
clean true:781
clean false:3
clean_rate:0.9961734693877551
noisy true:439
noisy false:409
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 848
epoch [39/200] batch [5/24] time 0.361 (0.372) data 0.284 (0.281) loss_x loss_x 0.4578 (0.4917) acc_x 90.6250 (88.7500) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [10/24] time 0.313 (0.361) data 0.235 (0.277) loss_x loss_x 0.6973 (0.4906) acc_x 78.1250 (86.5625) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [15/24] time 0.328 (0.353) data 0.250 (0.271) loss_x loss_x 0.4827 (0.5025) acc_x 90.6250 (86.8750) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/24] time 0.319 (0.352) data 0.241 (0.268) loss_x loss_x 0.5483 (0.5031) acc_x 81.2500 (86.7188) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 425
confident_label rate tensor(0.4755, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 776
clean true:773
clean false:3
clean_rate:0.9961340206185567
noisy true:434
noisy false:422
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 856
epoch [40/200] batch [5/24] time 0.375 (0.385) data 0.298 (0.294) loss_x loss_x 0.5464 (0.4506) acc_x 78.1250 (86.8750) lr 1.8271e-03 eta 0:00:07
epoch [40/200] batch [10/24] time 0.364 (0.377) data 0.287 (0.293) loss_x loss_x 0.4783 (0.5128) acc_x 90.6250 (85.6250) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [15/24] time 0.355 (0.373) data 0.278 (0.290) loss_x loss_x 0.6074 (0.5506) acc_x 87.5000 (85.4167) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/24] time 0.427 (0.366) data 0.238 (0.279) loss_x loss_x 0.6406 (0.5589) acc_x 87.5000 (85.6250) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.4730, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 772
clean true:770
clean false:2
clean_rate:0.9974093264248705
noisy true:434
noisy false:426
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 860
epoch [41/200] batch [5/24] time 0.330 (0.323) data 0.253 (0.245) loss_x loss_x 0.5083 (0.3980) acc_x 84.3750 (90.6250) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/24] time 0.481 (0.350) data 0.294 (0.261) loss_x loss_x 0.7998 (0.4781) acc_x 84.3750 (88.7500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/24] time 0.377 (0.359) data 0.300 (0.273) loss_x loss_x 0.5151 (0.4856) acc_x 87.5000 (88.7500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/24] time 0.359 (0.359) data 0.281 (0.276) loss_x loss_x 0.4646 (0.4851) acc_x 87.5000 (88.7500) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 396
confident_label rate tensor(0.4890, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 798
clean true:796
clean false:2
clean_rate:0.9974937343358395
noisy true:440
noisy false:394
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 834
epoch [42/200] batch [5/24] time 0.292 (0.315) data 0.215 (0.238) loss_x loss_x 0.5532 (0.4863) acc_x 93.7500 (88.1250) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/24] time 0.308 (0.318) data 0.231 (0.231) loss_x loss_x 0.4563 (0.5033) acc_x 90.6250 (89.0625) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/24] time 0.336 (0.325) data 0.259 (0.242) loss_x loss_x 0.7041 (0.4913) acc_x 87.5000 (89.1667) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/24] time 0.358 (0.333) data 0.280 (0.251) loss_x loss_x 0.4497 (0.5045) acc_x 87.5000 (88.2812) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 394
confident_label rate tensor(0.4835, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 789
clean true:786
clean false:3
clean_rate:0.9961977186311787
noisy true:452
noisy false:391
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 843
epoch [43/200] batch [5/24] time 0.364 (0.375) data 0.286 (0.297) loss_x loss_x 0.5596 (0.5589) acc_x 87.5000 (86.8750) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [10/24] time 0.300 (0.350) data 0.222 (0.272) loss_x loss_x 0.4712 (0.5859) acc_x 81.2500 (85.9375) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/24] time 0.310 (0.342) data 0.233 (0.256) loss_x loss_x 0.3003 (0.5677) acc_x 93.7500 (87.2917) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/24] time 0.296 (0.333) data 0.219 (0.250) loss_x loss_x 0.3083 (0.5394) acc_x 96.8750 (87.9688) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.4884, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 797
clean true:796
clean false:1
clean_rate:0.998745294855709
noisy true:449
noisy false:386
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 835
epoch [44/200] batch [5/24] time 0.334 (0.361) data 0.257 (0.279) loss_x loss_x 0.3716 (0.4560) acc_x 90.6250 (88.7500) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [10/24] time 0.386 (0.370) data 0.309 (0.290) loss_x loss_x 0.6401 (0.4825) acc_x 90.6250 (89.0625) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [15/24] time 0.312 (0.365) data 0.234 (0.286) loss_x loss_x 0.6484 (0.5008) acc_x 84.3750 (88.7500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/24] time 0.320 (0.357) data 0.242 (0.273) loss_x loss_x 0.4885 (0.4721) acc_x 87.5000 (89.0625) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 378
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 803
clean true:800
clean false:3
clean_rate:0.9962640099626401
noisy true:454
noisy false:375
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 829
epoch [45/200] batch [5/25] time 0.359 (0.386) data 0.281 (0.308) loss_x loss_x 0.2859 (0.5250) acc_x 96.8750 (86.8750) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [10/25] time 0.347 (0.380) data 0.268 (0.302) loss_x loss_x 0.5420 (0.5588) acc_x 87.5000 (86.8750) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [15/25] time 0.368 (0.381) data 0.291 (0.297) loss_x loss_x 0.4121 (0.5500) acc_x 93.7500 (86.6667) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/25] time 0.408 (0.375) data 0.330 (0.293) loss_x loss_x 0.5767 (0.5779) acc_x 78.1250 (85.4688) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/25] time 0.295 (0.362) data 0.218 (0.281) loss_x loss_x 0.5596 (0.5608) acc_x 87.5000 (85.6250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 372
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 804
clean true:801
clean false:3
clean_rate:0.996268656716418
noisy true:459
noisy false:369
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 828
epoch [46/200] batch [5/25] time 0.372 (0.359) data 0.294 (0.281) loss_x loss_x 0.3542 (0.5010) acc_x 84.3750 (87.5000) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [10/25] time 0.416 (0.372) data 0.338 (0.294) loss_x loss_x 0.5771 (0.5052) acc_x 81.2500 (86.5625) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [15/25] time 0.347 (0.368) data 0.270 (0.290) loss_x loss_x 0.4402 (0.5305) acc_x 93.7500 (87.0833) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/25] time 0.363 (0.375) data 0.285 (0.295) loss_x loss_x 0.4331 (0.5121) acc_x 93.7500 (87.8125) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/25] time 0.470 (0.376) data 0.285 (0.292) loss_x loss_x 0.5493 (0.5073) acc_x 87.5000 (88.2500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.4810, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 785
clean true:783
clean false:2
clean_rate:0.9974522292993631
noisy true:451
noisy false:396
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 847
epoch [47/200] batch [5/24] time 0.380 (0.380) data 0.302 (0.303) loss_x loss_x 0.4009 (0.5908) acc_x 93.7500 (83.1250) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [10/24] time 0.340 (0.378) data 0.262 (0.291) loss_x loss_x 0.4514 (0.4885) acc_x 84.3750 (86.5625) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [15/24] time 0.356 (0.375) data 0.279 (0.291) loss_x loss_x 0.5835 (0.5094) acc_x 81.2500 (86.4583) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/24] time 0.348 (0.364) data 0.271 (0.282) loss_x loss_x 0.6401 (0.4933) acc_x 87.5000 (87.5000) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.4933, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 805
clean true:802
clean false:3
clean_rate:0.9962732919254659
noisy true:430
noisy false:397
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 827
epoch [48/200] batch [5/25] time 0.342 (0.381) data 0.264 (0.301) loss_x loss_x 0.5278 (0.5858) acc_x 84.3750 (86.2500) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [10/25] time 0.365 (0.369) data 0.287 (0.290) loss_x loss_x 0.5186 (0.5607) acc_x 90.6250 (87.5000) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [15/25] time 0.326 (0.361) data 0.249 (0.282) loss_x loss_x 0.7686 (0.5758) acc_x 87.5000 (86.6667) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/25] time 0.353 (0.351) data 0.274 (0.271) loss_x loss_x 0.7153 (0.5412) acc_x 78.1250 (87.3438) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/25] time 0.383 (0.354) data 0.306 (0.275) loss_x loss_x 0.3494 (0.5587) acc_x 93.7500 (87.0000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 389
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 777
clean true:774
clean false:3
clean_rate:0.9961389961389961
noisy true:469
noisy false:386
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 855
epoch [49/200] batch [5/24] time 0.301 (0.331) data 0.223 (0.252) loss_x loss_x 0.8403 (0.5528) acc_x 84.3750 (86.8750) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/24] time 0.346 (0.348) data 0.268 (0.266) loss_x loss_x 0.3003 (0.4610) acc_x 96.8750 (90.0000) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/24] time 0.371 (0.347) data 0.281 (0.266) loss_x loss_x 0.4207 (0.4951) acc_x 93.7500 (89.1667) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/24] time 0.342 (0.346) data 0.264 (0.266) loss_x loss_x 0.2688 (0.5040) acc_x 96.8750 (88.7500) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.4786, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 781
clean true:781
clean false:0
clean_rate:1.0
noisy true:444
noisy false:407
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 851
epoch [50/200] batch [5/24] time 0.368 (0.375) data 0.290 (0.297) loss_x loss_x 1.0078 (0.5541) acc_x 84.3750 (85.6250) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [10/24] time 0.356 (0.369) data 0.278 (0.291) loss_x loss_x 0.4250 (0.5655) acc_x 87.5000 (85.3125) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [15/24] time 0.323 (0.354) data 0.245 (0.274) loss_x loss_x 0.2866 (0.5091) acc_x 93.7500 (86.6667) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/24] time 0.359 (0.355) data 0.281 (0.276) loss_x loss_x 0.2913 (0.4619) acc_x 93.7500 (88.1250) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 380
confident_label rate tensor(0.4877, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 796
clean true:795
clean false:1
clean_rate:0.9987437185929648
noisy true:457
noisy false:379
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 836
epoch [51/200] batch [5/24] time 0.362 (0.360) data 0.284 (0.282) loss_x loss_x 0.3142 (0.4605) acc_x 93.7500 (87.5000) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [10/24] time 0.333 (0.358) data 0.256 (0.280) loss_x loss_x 0.8198 (0.5409) acc_x 87.5000 (87.1875) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [15/24] time 0.363 (0.359) data 0.286 (0.278) loss_x loss_x 0.4419 (0.4642) acc_x 87.5000 (89.1667) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/24] time 0.312 (0.354) data 0.234 (0.273) loss_x loss_x 0.1766 (0.4608) acc_x 96.8750 (89.6875) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 821
clean true:819
clean false:2
clean_rate:0.997563946406821
noisy true:458
noisy false:353
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 811
epoch [52/200] batch [5/25] time 0.305 (0.329) data 0.228 (0.252) loss_x loss_x 0.4543 (0.5175) acc_x 87.5000 (88.1250) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [10/25] time 0.356 (0.331) data 0.278 (0.247) loss_x loss_x 0.4155 (0.5451) acc_x 90.6250 (87.8125) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/25] time 0.353 (0.339) data 0.276 (0.258) loss_x loss_x 0.3357 (0.5010) acc_x 96.8750 (89.1667) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/25] time 0.344 (0.343) data 0.267 (0.263) loss_x loss_x 0.2913 (0.4976) acc_x 93.7500 (89.0625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/25] time 0.303 (0.336) data 0.225 (0.257) loss_x loss_x 0.4497 (0.4923) acc_x 93.7500 (89.1250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 366
confident_label rate tensor(0.5018, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 819
clean true:814
clean false:5
clean_rate:0.9938949938949939
noisy true:452
noisy false:361
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 813
epoch [53/200] batch [5/25] time 0.345 (0.342) data 0.268 (0.265) loss_x loss_x 0.5400 (0.3877) acc_x 84.3750 (90.0000) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [10/25] time 0.373 (0.362) data 0.295 (0.277) loss_x loss_x 0.3372 (0.4515) acc_x 93.7500 (87.5000) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [15/25] time 0.299 (0.353) data 0.221 (0.265) loss_x loss_x 0.5410 (0.4520) acc_x 90.6250 (88.7500) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/25] time 0.391 (0.349) data 0.312 (0.264) loss_x loss_x 0.3828 (0.4855) acc_x 87.5000 (87.6562) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/25] time 0.339 (0.350) data 0.261 (0.266) loss_x loss_x 0.4355 (0.5034) acc_x 90.6250 (87.3750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.4982, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 813
clean true:811
clean false:2
clean_rate:0.997539975399754
noisy true:475
noisy false:344
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 819
epoch [54/200] batch [5/25] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.5522 (0.5527) acc_x 87.5000 (83.1250) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [10/25] time 0.461 (0.358) data 0.274 (0.269) loss_x loss_x 0.4539 (0.4645) acc_x 84.3750 (86.5625) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [15/25] time 0.348 (0.359) data 0.270 (0.274) loss_x loss_x 0.6147 (0.5050) acc_x 87.5000 (86.4583) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/25] time 0.345 (0.354) data 0.266 (0.271) loss_x loss_x 0.3677 (0.4984) acc_x 90.6250 (86.7188) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/25] time 0.328 (0.357) data 0.251 (0.272) loss_x loss_x 0.7925 (0.5215) acc_x 78.1250 (87.1250) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 366
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 814
clean true:810
clean false:4
clean_rate:0.995085995085995
noisy true:456
noisy false:362
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 818
epoch [55/200] batch [5/25] time 0.315 (0.320) data 0.238 (0.242) loss_x loss_x 0.2766 (0.4198) acc_x 90.6250 (90.0000) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [10/25] time 0.372 (0.337) data 0.294 (0.252) loss_x loss_x 0.6899 (0.4629) acc_x 87.5000 (90.0000) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [15/25] time 0.396 (0.348) data 0.318 (0.265) loss_x loss_x 0.3455 (0.4673) acc_x 90.6250 (89.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/25] time 0.348 (0.349) data 0.271 (0.268) loss_x loss_x 0.5986 (0.4633) acc_x 87.5000 (89.5312) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/25] time 0.353 (0.355) data 0.261 (0.272) loss_x loss_x 0.5078 (0.4614) acc_x 87.5000 (89.5000) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.5080, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 829
clean true:826
clean false:3
clean_rate:0.9963811821471653
noisy true:460
noisy false:343
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 803
epoch [56/200] batch [5/25] time 0.312 (0.344) data 0.234 (0.245) loss_x loss_x 0.3528 (0.4211) acc_x 90.6250 (87.5000) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/25] time 0.348 (0.340) data 0.270 (0.251) loss_x loss_x 0.9824 (0.5174) acc_x 84.3750 (87.5000) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [15/25] time 0.327 (0.345) data 0.250 (0.260) loss_x loss_x 0.3394 (0.4534) acc_x 90.6250 (89.1667) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/25] time 0.384 (0.350) data 0.306 (0.267) loss_x loss_x 0.3906 (0.4260) acc_x 93.7500 (90.4688) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/25] time 0.365 (0.359) data 0.288 (0.273) loss_x loss_x 0.4170 (0.4264) acc_x 93.7500 (90.8750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.5049, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 824
clean true:822
clean false:2
clean_rate:0.9975728155339806
noisy true:469
noisy false:339
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 808
epoch [57/200] batch [5/25] time 0.301 (0.335) data 0.224 (0.258) loss_x loss_x 0.6704 (0.5041) acc_x 87.5000 (90.6250) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [10/25] time 0.297 (0.320) data 0.219 (0.243) loss_x loss_x 0.5249 (0.4741) acc_x 90.6250 (90.3125) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/25] time 0.305 (0.323) data 0.227 (0.238) loss_x loss_x 0.3621 (0.4968) acc_x 90.6250 (89.3750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/25] time 0.286 (0.317) data 0.209 (0.234) loss_x loss_x 0.5952 (0.5130) acc_x 90.6250 (88.9062) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [25/25] time 0.355 (0.325) data 0.277 (0.241) loss_x loss_x 0.3879 (0.4946) acc_x 96.8750 (89.2500) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 361
confident_label rate tensor(0.4982, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 813
clean true:811
clean false:2
clean_rate:0.997539975399754
noisy true:460
noisy false:359
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 819
epoch [58/200] batch [5/25] time 0.338 (0.354) data 0.260 (0.276) loss_x loss_x 0.6016 (0.5194) acc_x 90.6250 (88.1250) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [10/25] time 0.368 (0.356) data 0.290 (0.270) loss_x loss_x 0.7085 (0.5110) acc_x 81.2500 (88.7500) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [15/25] time 0.351 (0.356) data 0.273 (0.273) loss_x loss_x 0.3633 (0.4712) acc_x 93.7500 (89.5833) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/25] time 0.307 (0.354) data 0.229 (0.268) loss_x loss_x 0.2211 (0.4465) acc_x 96.8750 (89.8438) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/25] time 0.363 (0.347) data 0.285 (0.263) loss_x loss_x 0.7202 (0.4439) acc_x 78.1250 (89.7500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.5018, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 819
clean true:817
clean false:2
clean_rate:0.9975579975579976
noisy true:464
noisy false:349
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 813
epoch [59/200] batch [5/25] time 0.357 (0.353) data 0.279 (0.275) loss_x loss_x 0.9785 (0.5863) acc_x 78.1250 (86.2500) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [10/25] time 0.346 (0.363) data 0.269 (0.279) loss_x loss_x 0.2098 (0.4943) acc_x 96.8750 (88.7500) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [15/25] time 0.296 (0.348) data 0.219 (0.266) loss_x loss_x 0.8813 (0.5165) acc_x 78.1250 (88.3333) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/25] time 0.377 (0.351) data 0.300 (0.268) loss_x loss_x 0.2391 (0.5056) acc_x 93.7500 (88.1250) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/25] time 0.295 (0.344) data 0.218 (0.261) loss_x loss_x 0.2866 (0.5087) acc_x 96.8750 (87.7500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 324
confident_label rate tensor(0.5147, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 840
clean true:837
clean false:3
clean_rate:0.9964285714285714
noisy true:471
noisy false:321
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 792
epoch [60/200] batch [5/26] time 0.350 (0.369) data 0.272 (0.279) loss_x loss_x 0.3337 (0.3710) acc_x 90.6250 (92.5000) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [10/26] time 0.376 (0.370) data 0.298 (0.286) loss_x loss_x 0.4109 (0.4024) acc_x 90.6250 (90.9375) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [15/26] time 0.360 (0.377) data 0.283 (0.288) loss_x loss_x 0.5239 (0.4171) acc_x 90.6250 (90.4167) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [20/26] time 0.376 (0.374) data 0.299 (0.288) loss_x loss_x 0.3560 (0.4179) acc_x 93.7500 (90.4688) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/26] time 0.297 (0.366) data 0.219 (0.281) loss_x loss_x 0.5005 (0.4384) acc_x 81.2500 (89.5000) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.5092, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 831
clean true:828
clean false:3
clean_rate:0.9963898916967509
noisy true:463
noisy false:338
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 801
epoch [61/200] batch [5/25] time 0.354 (0.358) data 0.277 (0.281) loss_x loss_x 0.6128 (0.5107) acc_x 84.3750 (86.2500) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [10/25] time 0.349 (0.351) data 0.271 (0.274) loss_x loss_x 0.3499 (0.4425) acc_x 93.7500 (89.0625) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [15/25] time 0.467 (0.366) data 0.280 (0.281) loss_x loss_x 0.5898 (0.4523) acc_x 90.6250 (88.5417) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/25] time 0.363 (0.365) data 0.284 (0.282) loss_x loss_x 0.4614 (0.4559) acc_x 93.7500 (88.2812) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/25] time 0.343 (0.363) data 0.266 (0.281) loss_x loss_x 0.4045 (0.4533) acc_x 90.6250 (88.2500) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.5110, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 834
clean true:833
clean false:1
clean_rate:0.9988009592326139
noisy true:476
noisy false:322
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 798
epoch [62/200] batch [5/26] time 0.418 (0.334) data 0.233 (0.234) loss_x loss_x 0.2505 (0.4422) acc_x 96.8750 (88.7500) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [10/26] time 0.349 (0.350) data 0.271 (0.262) loss_x loss_x 0.4443 (0.4264) acc_x 90.6250 (89.6875) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [15/26] time 0.373 (0.350) data 0.295 (0.265) loss_x loss_x 0.2832 (0.4203) acc_x 96.8750 (89.3750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/26] time 0.375 (0.361) data 0.297 (0.273) loss_x loss_x 0.5669 (0.4803) acc_x 90.6250 (87.9688) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/26] time 0.334 (0.360) data 0.257 (0.274) loss_x loss_x 0.6445 (0.5029) acc_x 87.5000 (87.7500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 324
confident_label rate tensor(0.5074, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 828
clean true:826
clean false:2
clean_rate:0.9975845410628019
noisy true:482
noisy false:322
after delete: len(clean_dataset) 828
after delete: len(noisy_dataset) 804
epoch [63/200] batch [5/25] time 0.382 (0.379) data 0.304 (0.301) loss_x loss_x 0.4683 (0.4179) acc_x 87.5000 (90.0000) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [10/25] time 0.301 (0.360) data 0.224 (0.275) loss_x loss_x 0.3972 (0.4032) acc_x 87.5000 (89.3750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [15/25] time 0.335 (0.356) data 0.257 (0.266) loss_x loss_x 0.4771 (0.4066) acc_x 87.5000 (89.1667) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/25] time 0.363 (0.357) data 0.286 (0.271) loss_x loss_x 0.4526 (0.4104) acc_x 90.6250 (89.6875) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/25] time 0.358 (0.360) data 0.280 (0.273) loss_x loss_x 0.3591 (0.4225) acc_x 93.7500 (89.6250) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.5129, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 837
clean true:834
clean false:3
clean_rate:0.996415770609319
noisy true:463
noisy false:332
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 795
epoch [64/200] batch [5/26] time 0.345 (0.328) data 0.268 (0.250) loss_x loss_x 0.5786 (0.4547) acc_x 81.2500 (89.3750) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [10/26] time 0.329 (0.342) data 0.251 (0.262) loss_x loss_x 0.4985 (0.4235) acc_x 87.5000 (90.0000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [15/26] time 0.317 (0.344) data 0.239 (0.265) loss_x loss_x 0.6206 (0.4774) acc_x 84.3750 (87.9167) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/26] time 0.302 (0.333) data 0.224 (0.255) loss_x loss_x 0.8691 (0.5387) acc_x 78.1250 (86.2500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/26] time 0.357 (0.340) data 0.279 (0.261) loss_x loss_x 0.6909 (0.5062) acc_x 87.5000 (87.5000) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 343
confident_label rate tensor(0.5080, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 829
clean true:824
clean false:5
clean_rate:0.9939686369119421
noisy true:465
noisy false:338
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 803
epoch [65/200] batch [5/25] time 0.343 (0.367) data 0.266 (0.289) loss_x loss_x 0.3445 (0.4099) acc_x 87.5000 (85.6250) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [10/25] time 0.457 (0.368) data 0.270 (0.280) loss_x loss_x 0.4409 (0.4273) acc_x 84.3750 (88.1250) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [15/25] time 0.388 (0.354) data 0.310 (0.269) loss_x loss_x 0.3032 (0.4569) acc_x 90.6250 (88.3333) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/25] time 0.374 (0.356) data 0.297 (0.273) loss_x loss_x 0.3970 (0.4418) acc_x 93.7500 (89.0625) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/25] time 0.287 (0.352) data 0.210 (0.270) loss_x loss_x 0.5215 (0.4847) acc_x 81.2500 (87.7500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.5110, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 834
clean true:832
clean false:2
clean_rate:0.9976019184652278
noisy true:485
noisy false:313
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 798
epoch [66/200] batch [5/26] time 0.370 (0.394) data 0.292 (0.294) loss_x loss_x 0.4282 (0.3199) acc_x 90.6250 (93.1250) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [10/26] time 0.341 (0.378) data 0.263 (0.289) loss_x loss_x 0.4282 (0.3829) acc_x 93.7500 (91.5625) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [15/26] time 0.355 (0.380) data 0.277 (0.288) loss_x loss_x 0.6387 (0.3895) acc_x 84.3750 (90.8333) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [20/26] time 0.354 (0.373) data 0.276 (0.284) loss_x loss_x 0.2939 (0.3770) acc_x 96.8750 (91.7188) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/26] time 0.399 (0.374) data 0.321 (0.287) loss_x loss_x 0.5376 (0.3999) acc_x 93.7500 (91.2500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.5061, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 826
clean true:824
clean false:2
clean_rate:0.9975786924939467
noisy true:466
noisy false:340
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 806
epoch [67/200] batch [5/25] time 0.344 (0.338) data 0.267 (0.260) loss_x loss_x 0.1637 (0.4019) acc_x 96.8750 (90.0000) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [10/25] time 0.394 (0.355) data 0.316 (0.277) loss_x loss_x 0.2328 (0.4244) acc_x 100.0000 (90.3125) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [15/25] time 0.348 (0.365) data 0.270 (0.280) loss_x loss_x 0.1500 (0.4142) acc_x 100.0000 (90.4167) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/25] time 0.384 (0.365) data 0.306 (0.282) loss_x loss_x 0.4492 (0.4074) acc_x 93.7500 (90.7812) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/25] time 0.310 (0.365) data 0.233 (0.280) loss_x loss_x 0.2285 (0.4216) acc_x 100.0000 (91.0000) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 317
confident_label rate tensor(0.5116, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 835
clean true:834
clean false:1
clean_rate:0.9988023952095808
noisy true:481
noisy false:316
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 797
epoch [68/200] batch [5/26] time 0.305 (0.325) data 0.227 (0.247) loss_x loss_x 0.3955 (0.3756) acc_x 93.7500 (91.8750) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [10/26] time 0.365 (0.340) data 0.288 (0.262) loss_x loss_x 0.5176 (0.4137) acc_x 90.6250 (91.2500) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [15/26] time 0.406 (0.349) data 0.283 (0.268) loss_x loss_x 0.6758 (0.4418) acc_x 87.5000 (90.8333) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/26] time 0.373 (0.352) data 0.296 (0.272) loss_x loss_x 0.4060 (0.4513) acc_x 90.6250 (90.1562) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/26] time 0.326 (0.355) data 0.248 (0.271) loss_x loss_x 0.3845 (0.4311) acc_x 93.7500 (90.8750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.5067, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 827
clean true:821
clean false:6
clean_rate:0.992744860943168
noisy true:466
noisy false:339
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 805
epoch [69/200] batch [5/25] time 0.300 (0.325) data 0.222 (0.247) loss_x loss_x 0.2883 (0.3082) acc_x 90.6250 (91.8750) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [10/25] time 0.344 (0.325) data 0.266 (0.246) loss_x loss_x 0.5034 (0.4096) acc_x 81.2500 (89.0625) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/25] time 0.362 (0.337) data 0.285 (0.260) loss_x loss_x 0.1823 (0.4055) acc_x 96.8750 (89.5833) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/25] time 0.352 (0.348) data 0.275 (0.265) loss_x loss_x 0.3884 (0.4316) acc_x 96.8750 (89.8438) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/25] time 0.374 (0.349) data 0.296 (0.267) loss_x loss_x 0.7729 (0.4428) acc_x 90.6250 (90.1250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.5080, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 829
clean true:828
clean false:1
clean_rate:0.9987937273823885
noisy true:473
noisy false:330
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 803
epoch [70/200] batch [5/25] time 0.347 (0.364) data 0.270 (0.286) loss_x loss_x 0.2500 (0.3206) acc_x 93.7500 (91.8750) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [10/25] time 0.452 (0.363) data 0.267 (0.275) loss_x loss_x 0.2881 (0.3925) acc_x 96.8750 (91.5625) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [15/25] time 0.349 (0.356) data 0.272 (0.271) loss_x loss_x 0.2695 (0.4299) acc_x 87.5000 (90.4167) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/25] time 0.292 (0.342) data 0.214 (0.259) loss_x loss_x 0.5723 (0.4351) acc_x 87.5000 (90.4688) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/25] time 0.309 (0.333) data 0.231 (0.251) loss_x loss_x 0.5625 (0.4621) acc_x 87.5000 (89.1250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:849
clean false:3
clean_rate:0.9964788732394366
noisy true:462
noisy false:318
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [71/200] batch [5/26] time 0.350 (0.398) data 0.272 (0.302) loss_x loss_x 0.3538 (0.3984) acc_x 87.5000 (90.0000) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [10/26] time 0.364 (0.379) data 0.284 (0.292) loss_x loss_x 0.4482 (0.5354) acc_x 87.5000 (85.9375) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [15/26] time 0.355 (0.373) data 0.277 (0.287) loss_x loss_x 0.6436 (0.5123) acc_x 90.6250 (87.9167) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [20/26] time 0.378 (0.373) data 0.301 (0.288) loss_x loss_x 0.5386 (0.4861) acc_x 87.5000 (88.5938) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/26] time 0.352 (0.370) data 0.272 (0.287) loss_x loss_x 0.3857 (0.4806) acc_x 93.7500 (89.1250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.5018, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 819
clean true:818
clean false:1
clean_rate:0.9987789987789988
noisy true:466
noisy false:347
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 813
epoch [72/200] batch [5/25] time 0.345 (0.361) data 0.267 (0.261) loss_x loss_x 0.2319 (0.4694) acc_x 96.8750 (88.1250) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [10/25] time 0.340 (0.356) data 0.262 (0.267) loss_x loss_x 0.3086 (0.4766) acc_x 96.8750 (89.3750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [15/25] time 0.370 (0.358) data 0.292 (0.273) loss_x loss_x 0.2568 (0.4624) acc_x 93.7500 (89.3750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/25] time 0.387 (0.363) data 0.278 (0.279) loss_x loss_x 0.4211 (0.4310) acc_x 90.6250 (90.3125) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/25] time 0.338 (0.362) data 0.261 (0.278) loss_x loss_x 0.3669 (0.4146) acc_x 87.5000 (90.6250) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 330
confident_label rate tensor(0.5104, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 833
clean true:829
clean false:4
clean_rate:0.9951980792316927
noisy true:473
noisy false:326
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 799
epoch [73/200] batch [5/26] time 0.362 (0.379) data 0.247 (0.294) loss_x loss_x 0.3711 (0.3787) acc_x 90.6250 (91.2500) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [10/26] time 0.379 (0.357) data 0.301 (0.276) loss_x loss_x 0.3020 (0.3394) acc_x 90.6250 (92.8125) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [15/26] time 0.421 (0.371) data 0.343 (0.283) loss_x loss_x 0.4238 (0.3253) acc_x 90.6250 (93.5417) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [20/26] time 0.379 (0.370) data 0.301 (0.285) loss_x loss_x 0.6611 (0.3634) acc_x 84.3750 (91.7188) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/26] time 0.368 (0.370) data 0.289 (0.286) loss_x loss_x 0.3025 (0.3600) acc_x 96.8750 (92.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.5190, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 847
clean true:844
clean false:3
clean_rate:0.9964580873671782
noisy true:480
noisy false:305
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 785
epoch [74/200] batch [5/26] time 0.342 (0.362) data 0.263 (0.284) loss_x loss_x 0.7939 (0.4844) acc_x 81.2500 (86.8750) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [10/26] time 0.344 (0.361) data 0.267 (0.283) loss_x loss_x 0.5415 (0.4764) acc_x 87.5000 (87.1875) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [15/26] time 0.301 (0.354) data 0.223 (0.268) loss_x loss_x 0.6411 (0.4663) acc_x 84.3750 (88.3333) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/26] time 0.345 (0.353) data 0.268 (0.269) loss_x loss_x 0.7427 (0.4807) acc_x 84.3750 (88.7500) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/26] time 0.483 (0.359) data 0.309 (0.273) loss_x loss_x 0.2539 (0.4784) acc_x 96.8750 (88.6250) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:848
clean false:4
clean_rate:0.9953051643192489
noisy true:476
noisy false:304
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [75/200] batch [5/26] time 0.338 (0.335) data 0.261 (0.258) loss_x loss_x 0.3904 (0.4572) acc_x 90.6250 (87.5000) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [10/26] time 0.358 (0.353) data 0.280 (0.266) loss_x loss_x 0.6001 (0.4790) acc_x 81.2500 (87.5000) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [15/26] time 0.361 (0.359) data 0.284 (0.275) loss_x loss_x 0.9678 (0.5022) acc_x 81.2500 (87.7083) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/26] time 0.327 (0.359) data 0.249 (0.277) loss_x loss_x 0.4822 (0.4771) acc_x 84.3750 (87.8125) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/26] time 0.313 (0.356) data 0.235 (0.272) loss_x loss_x 0.4465 (0.4886) acc_x 90.6250 (87.3750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 304
confident_label rate tensor(0.5214, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 851
clean true:849
clean false:2
clean_rate:0.9976498237367802
noisy true:479
noisy false:302
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 781
epoch [76/200] batch [5/26] time 0.323 (0.365) data 0.244 (0.265) loss_x loss_x 0.4822 (0.3639) acc_x 84.3750 (90.0000) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [10/26] time 0.323 (0.343) data 0.245 (0.254) loss_x loss_x 0.1874 (0.3289) acc_x 96.8750 (92.1875) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [15/26] time 0.462 (0.361) data 0.272 (0.268) loss_x loss_x 0.5234 (0.3637) acc_x 87.5000 (91.6667) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/26] time 0.374 (0.360) data 0.297 (0.271) loss_x loss_x 0.3035 (0.3827) acc_x 96.8750 (91.2500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/26] time 0.331 (0.365) data 0.253 (0.276) loss_x loss_x 0.5581 (0.3918) acc_x 84.3750 (90.5000) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 312
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 859
clean true:855
clean false:4
clean_rate:0.9953434225844005
noisy true:465
noisy false:308
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 773
epoch [77/200] batch [5/26] time 0.363 (0.360) data 0.286 (0.283) loss_x loss_x 0.4121 (0.5015) acc_x 90.6250 (87.5000) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [10/26] time 0.304 (0.354) data 0.226 (0.277) loss_x loss_x 0.6523 (0.5194) acc_x 87.5000 (87.5000) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [15/26] time 0.358 (0.349) data 0.281 (0.264) loss_x loss_x 0.6294 (0.5096) acc_x 81.2500 (87.7083) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/26] time 0.391 (0.353) data 0.314 (0.270) loss_x loss_x 0.7197 (0.4936) acc_x 78.1250 (87.9688) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/26] time 0.384 (0.356) data 0.306 (0.273) loss_x loss_x 0.4614 (0.4894) acc_x 87.5000 (87.6250) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 871
clean true:869
clean false:2
clean_rate:0.9977037887485649
noisy true:480
noisy false:281
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 761
epoch [78/200] batch [5/27] time 0.375 (0.366) data 0.298 (0.288) loss_x loss_x 0.3389 (0.3473) acc_x 90.6250 (90.6250) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [10/27] time 0.351 (0.360) data 0.274 (0.282) loss_x loss_x 0.6094 (0.4024) acc_x 87.5000 (90.9375) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [15/27] time 0.349 (0.353) data 0.270 (0.275) loss_x loss_x 0.4968 (0.4015) acc_x 90.6250 (90.6250) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [20/27] time 0.321 (0.347) data 0.243 (0.264) loss_x loss_x 0.3689 (0.4178) acc_x 90.6250 (90.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/27] time 0.372 (0.352) data 0.293 (0.270) loss_x loss_x 0.4221 (0.4045) acc_x 90.6250 (90.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.5202, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 849
clean true:848
clean false:1
clean_rate:0.9988221436984688
noisy true:476
noisy false:307
after delete: len(clean_dataset) 849
after delete: len(noisy_dataset) 783
epoch [79/200] batch [5/26] time 0.376 (0.387) data 0.298 (0.288) loss_x loss_x 0.4551 (0.5056) acc_x 84.3750 (86.8750) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [10/26] time 0.354 (0.371) data 0.277 (0.282) loss_x loss_x 0.1068 (0.4306) acc_x 100.0000 (89.6875) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [15/26] time 0.369 (0.375) data 0.291 (0.283) loss_x loss_x 0.3679 (0.4047) acc_x 93.7500 (90.4167) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [20/26] time 0.347 (0.366) data 0.270 (0.278) loss_x loss_x 0.4492 (0.4128) acc_x 87.5000 (90.3125) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/26] time 0.315 (0.363) data 0.236 (0.275) loss_x loss_x 0.3220 (0.3923) acc_x 96.8750 (91.1250) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 294
confident_label rate tensor(0.5282, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 862
clean true:860
clean false:2
clean_rate:0.9976798143851509
noisy true:478
noisy false:292
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 770
epoch [80/200] batch [5/26] time 0.314 (0.308) data 0.237 (0.230) loss_x loss_x 0.5522 (0.4502) acc_x 90.6250 (91.2500) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [10/26] time 0.340 (0.328) data 0.262 (0.251) loss_x loss_x 0.2607 (0.3960) acc_x 93.7500 (91.5625) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [15/26] time 0.366 (0.343) data 0.289 (0.265) loss_x loss_x 0.4548 (0.4363) acc_x 93.7500 (90.2083) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/26] time 0.396 (0.353) data 0.318 (0.275) loss_x loss_x 0.3755 (0.4546) acc_x 96.8750 (90.3125) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/26] time 0.357 (0.360) data 0.279 (0.277) loss_x loss_x 0.3320 (0.4380) acc_x 90.6250 (90.5000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 871
clean true:868
clean false:3
clean_rate:0.9965556831228473
noisy true:474
noisy false:287
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 761
epoch [81/200] batch [5/27] time 0.304 (0.311) data 0.226 (0.232) loss_x loss_x 0.4824 (0.4689) acc_x 87.5000 (89.3750) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [10/27] time 0.369 (0.316) data 0.291 (0.238) loss_x loss_x 0.3223 (0.4239) acc_x 87.5000 (90.3125) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [15/27] time 0.347 (0.330) data 0.270 (0.252) loss_x loss_x 0.3684 (0.4114) acc_x 93.7500 (90.6250) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/27] time 0.325 (0.338) data 0.248 (0.255) loss_x loss_x 0.4441 (0.4200) acc_x 87.5000 (89.8438) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/27] time 0.475 (0.348) data 0.291 (0.262) loss_x loss_x 0.2274 (0.4094) acc_x 90.6250 (89.3750) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.5153, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 841
clean true:839
clean false:2
clean_rate:0.9976218787158145
noisy true:478
noisy false:313
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 791
epoch [82/200] batch [5/26] time 0.296 (0.299) data 0.218 (0.221) loss_x loss_x 0.3701 (0.4152) acc_x 90.6250 (90.6250) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [10/26] time 0.306 (0.301) data 0.228 (0.222) loss_x loss_x 0.5171 (0.4281) acc_x 84.3750 (90.3125) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/26] time 0.289 (0.299) data 0.211 (0.221) loss_x loss_x 0.4746 (0.4678) acc_x 84.3750 (88.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/26] time 0.348 (0.319) data 0.270 (0.236) loss_x loss_x 0.1576 (0.4390) acc_x 96.8750 (88.9062) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/26] time 0.355 (0.327) data 0.278 (0.245) loss_x loss_x 0.4089 (0.4286) acc_x 90.6250 (89.3750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.5319, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 868
clean true:868
clean false:0
clean_rate:1.0
noisy true:477
noisy false:287
after delete: len(clean_dataset) 868
after delete: len(noisy_dataset) 764
epoch [83/200] batch [5/27] time 0.350 (0.349) data 0.273 (0.271) loss_x loss_x 0.3062 (0.4511) acc_x 96.8750 (89.3750) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [10/27] time 0.332 (0.350) data 0.254 (0.272) loss_x loss_x 0.2656 (0.4047) acc_x 96.8750 (90.6250) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [15/27] time 0.413 (0.339) data 0.226 (0.254) loss_x loss_x 0.3096 (0.4518) acc_x 96.8750 (89.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [20/27] time 0.307 (0.329) data 0.229 (0.246) loss_x loss_x 0.4094 (0.4511) acc_x 93.7500 (89.3750) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/27] time 0.342 (0.329) data 0.264 (0.247) loss_x loss_x 0.5586 (0.4372) acc_x 84.3750 (89.2500) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 875
clean true:873
clean false:2
clean_rate:0.9977142857142857
noisy true:488
noisy false:269
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 757
epoch [84/200] batch [5/27] time 0.437 (0.372) data 0.274 (0.278) loss_x loss_x 0.3743 (0.3249) acc_x 90.6250 (93.1250) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [10/27] time 0.351 (0.360) data 0.274 (0.274) loss_x loss_x 0.5005 (0.3971) acc_x 93.7500 (91.5625) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [15/27] time 0.302 (0.350) data 0.224 (0.267) loss_x loss_x 0.0894 (0.3612) acc_x 100.0000 (92.2917) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [20/27] time 0.313 (0.345) data 0.235 (0.258) loss_x loss_x 0.3225 (0.4064) acc_x 96.8750 (91.4062) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/27] time 0.340 (0.344) data 0.262 (0.259) loss_x loss_x 0.3660 (0.4043) acc_x 93.7500 (91.3750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 317
confident_label rate tensor(0.5202, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 849
clean true:847
clean false:2
clean_rate:0.9976442873969376
noisy true:468
noisy false:315
after delete: len(clean_dataset) 849
after delete: len(noisy_dataset) 783
epoch [85/200] batch [5/26] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.3274 (0.3417) acc_x 93.7500 (91.8750) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [10/26] time 0.360 (0.353) data 0.282 (0.265) loss_x loss_x 0.5059 (0.4277) acc_x 84.3750 (89.3750) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [15/26] time 0.354 (0.352) data 0.276 (0.267) loss_x loss_x 0.2874 (0.4258) acc_x 93.7500 (90.0000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/26] time 0.301 (0.347) data 0.223 (0.264) loss_x loss_x 0.3618 (0.4277) acc_x 90.6250 (90.3125) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/26] time 0.305 (0.342) data 0.227 (0.256) loss_x loss_x 0.6221 (0.4346) acc_x 81.2500 (89.7500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 871
clean true:868
clean false:3
clean_rate:0.9965556831228473
noisy true:487
noisy false:274
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 761
epoch [86/200] batch [5/27] time 0.365 (0.377) data 0.287 (0.282) loss_x loss_x 0.5356 (0.4350) acc_x 87.5000 (87.5000) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [10/27] time 0.347 (0.364) data 0.269 (0.277) loss_x loss_x 0.3022 (0.4361) acc_x 96.8750 (89.6875) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [15/27] time 0.375 (0.361) data 0.298 (0.277) loss_x loss_x 0.4036 (0.4480) acc_x 90.6250 (88.9583) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [20/27] time 0.349 (0.359) data 0.272 (0.277) loss_x loss_x 0.2289 (0.4081) acc_x 93.7500 (90.4688) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/27] time 0.297 (0.356) data 0.219 (0.271) loss_x loss_x 0.2961 (0.4220) acc_x 93.7500 (90.1250) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 298
confident_label rate tensor(0.5288, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 863
clean true:862
clean false:1
clean_rate:0.9988412514484357
noisy true:472
noisy false:297
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 769
epoch [87/200] batch [5/26] time 0.355 (0.343) data 0.277 (0.265) loss_x loss_x 0.8662 (0.6344) acc_x 81.2500 (84.3750) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [10/26] time 0.344 (0.358) data 0.267 (0.269) loss_x loss_x 0.6099 (0.4992) acc_x 84.3750 (87.8125) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [15/26] time 0.353 (0.352) data 0.275 (0.267) loss_x loss_x 0.1501 (0.4176) acc_x 93.7500 (90.4167) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/26] time 0.468 (0.358) data 0.287 (0.270) loss_x loss_x 0.3921 (0.4104) acc_x 87.5000 (89.8438) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/26] time 0.302 (0.352) data 0.224 (0.266) loss_x loss_x 0.3113 (0.4089) acc_x 90.6250 (89.5000) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.5239, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 855
clean true:855
clean false:0
clean_rate:1.0
noisy true:484
noisy false:293
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 777
epoch [88/200] batch [5/26] time 0.334 (0.339) data 0.256 (0.261) loss_x loss_x 0.5112 (0.5046) acc_x 87.5000 (85.0000) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [10/26] time 0.350 (0.345) data 0.273 (0.267) loss_x loss_x 0.6680 (0.4734) acc_x 81.2500 (87.1875) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [15/26] time 0.451 (0.354) data 0.265 (0.269) loss_x loss_x 0.1776 (0.4129) acc_x 96.8750 (89.1667) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/26] time 0.339 (0.355) data 0.262 (0.272) loss_x loss_x 0.6045 (0.4075) acc_x 81.2500 (89.0625) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/26] time 0.362 (0.353) data 0.284 (0.272) loss_x loss_x 0.4370 (0.4276) acc_x 93.7500 (89.1250) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 875
clean true:873
clean false:2
clean_rate:0.9977142857142857
noisy true:498
noisy false:259
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 757
epoch [89/200] batch [5/27] time 0.326 (0.371) data 0.248 (0.275) loss_x loss_x 0.8735 (0.6103) acc_x 75.0000 (86.8750) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [10/27] time 0.303 (0.343) data 0.225 (0.256) loss_x loss_x 0.3962 (0.4864) acc_x 93.7500 (90.0000) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [15/27] time 0.340 (0.344) data 0.263 (0.261) loss_x loss_x 0.1680 (0.4676) acc_x 96.8750 (89.3750) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [20/27] time 0.351 (0.350) data 0.273 (0.263) loss_x loss_x 0.3176 (0.4452) acc_x 93.7500 (89.5312) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/27] time 0.354 (0.351) data 0.277 (0.265) loss_x loss_x 0.4370 (0.4593) acc_x 84.3750 (88.7500) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 865
clean true:864
clean false:1
clean_rate:0.9988439306358381
noisy true:498
noisy false:269
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 767
epoch [90/200] batch [5/27] time 0.352 (0.370) data 0.274 (0.292) loss_x loss_x 0.3013 (0.3787) acc_x 96.8750 (91.2500) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [10/27] time 0.365 (0.362) data 0.288 (0.285) loss_x loss_x 0.4138 (0.4016) acc_x 90.6250 (90.6250) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [15/27] time 0.337 (0.359) data 0.260 (0.275) loss_x loss_x 0.2323 (0.4072) acc_x 96.8750 (90.4167) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [20/27] time 0.342 (0.358) data 0.263 (0.276) loss_x loss_x 0.5625 (0.4200) acc_x 84.3750 (90.3125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/27] time 0.421 (0.358) data 0.235 (0.272) loss_x loss_x 0.4136 (0.4119) acc_x 90.6250 (90.3750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.5374, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 877
clean true:872
clean false:5
clean_rate:0.9942987457240593
noisy true:496
noisy false:259
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 755
epoch [91/200] batch [5/27] time 0.397 (0.355) data 0.318 (0.277) loss_x loss_x 0.7183 (0.4429) acc_x 78.1250 (89.3750) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [10/27] time 0.305 (0.334) data 0.227 (0.256) loss_x loss_x 0.7485 (0.5099) acc_x 81.2500 (86.8750) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [15/27] time 0.347 (0.341) data 0.270 (0.258) loss_x loss_x 0.4644 (0.4710) acc_x 87.5000 (88.3333) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [20/27] time 0.351 (0.343) data 0.273 (0.261) loss_x loss_x 0.5654 (0.4591) acc_x 90.6250 (88.2812) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/27] time 0.352 (0.345) data 0.275 (0.265) loss_x loss_x 0.4487 (0.4641) acc_x 90.6250 (88.1250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.5453, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 890
clean true:887
clean false:3
clean_rate:0.996629213483146
noisy true:500
noisy false:242
after delete: len(clean_dataset) 890
after delete: len(noisy_dataset) 742
epoch [92/200] batch [5/27] time 0.332 (0.356) data 0.254 (0.278) loss_x loss_x 0.3669 (0.4419) acc_x 93.7500 (89.3750) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [10/27] time 0.350 (0.361) data 0.273 (0.273) loss_x loss_x 0.4824 (0.3659) acc_x 87.5000 (92.5000) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [15/27] time 0.302 (0.348) data 0.223 (0.263) loss_x loss_x 0.3896 (0.3592) acc_x 96.8750 (92.0833) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [20/27] time 0.372 (0.356) data 0.293 (0.272) loss_x loss_x 0.3293 (0.3726) acc_x 90.6250 (90.9375) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/27] time 0.373 (0.357) data 0.295 (0.275) loss_x loss_x 0.3750 (0.3796) acc_x 93.7500 (90.6250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.5392, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 880
clean true:875
clean false:5
clean_rate:0.9943181818181818
noisy true:498
noisy false:254
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 752
epoch [93/200] batch [5/27] time 0.355 (0.342) data 0.277 (0.264) loss_x loss_x 0.6655 (0.5144) acc_x 78.1250 (87.5000) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [10/27] time 0.356 (0.346) data 0.278 (0.268) loss_x loss_x 0.1907 (0.4561) acc_x 100.0000 (89.6875) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [15/27] time 0.365 (0.348) data 0.286 (0.270) loss_x loss_x 0.3857 (0.4454) acc_x 90.6250 (89.5833) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [20/27] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.4734 (0.4650) acc_x 87.5000 (89.5312) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/27] time 0.309 (0.346) data 0.231 (0.268) loss_x loss_x 0.3057 (0.4405) acc_x 96.8750 (90.0000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.5411, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 883
clean true:881
clean false:2
clean_rate:0.9977349943374858
noisy true:482
noisy false:267
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 749
epoch [94/200] batch [5/27] time 0.390 (0.326) data 0.276 (0.241) loss_x loss_x 0.2732 (0.3365) acc_x 96.8750 (92.5000) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [10/27] time 0.339 (0.332) data 0.261 (0.251) loss_x loss_x 0.3953 (0.3258) acc_x 90.6250 (93.4375) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [15/27] time 0.413 (0.344) data 0.258 (0.259) loss_x loss_x 0.2869 (0.3486) acc_x 96.8750 (92.7083) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [20/27] time 0.327 (0.344) data 0.250 (0.260) loss_x loss_x 0.3245 (0.3737) acc_x 90.6250 (91.4062) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/27] time 0.338 (0.346) data 0.259 (0.261) loss_x loss_x 0.4626 (0.3972) acc_x 84.3750 (91.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.5404, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 882
clean true:878
clean false:4
clean_rate:0.9954648526077098
noisy true:490
noisy false:260
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 750
epoch [95/200] batch [5/27] time 0.305 (0.341) data 0.227 (0.260) loss_x loss_x 0.1589 (0.2980) acc_x 96.8750 (94.3750) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [10/27] time 0.316 (0.324) data 0.239 (0.245) loss_x loss_x 0.3220 (0.3233) acc_x 87.5000 (93.4375) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [15/27] time 0.303 (0.323) data 0.225 (0.237) loss_x loss_x 0.7026 (0.3647) acc_x 84.3750 (92.0833) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/27] time 0.372 (0.323) data 0.294 (0.239) loss_x loss_x 0.4287 (0.3718) acc_x 90.6250 (91.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/27] time 0.451 (0.335) data 0.267 (0.248) loss_x loss_x 0.4600 (0.3654) acc_x 81.2500 (91.6250) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.5380, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 878
clean true:875
clean false:3
clean_rate:0.9965831435079726
noisy true:490
noisy false:264
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 754
epoch [96/200] batch [5/27] time 0.347 (0.354) data 0.268 (0.275) loss_x loss_x 0.5317 (0.2964) acc_x 84.3750 (93.7500) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [10/27] time 0.325 (0.339) data 0.246 (0.260) loss_x loss_x 0.3047 (0.3369) acc_x 96.8750 (92.8125) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [15/27] time 0.300 (0.327) data 0.222 (0.249) loss_x loss_x 0.5532 (0.3722) acc_x 87.5000 (92.0833) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/27] time 0.294 (0.318) data 0.216 (0.240) loss_x loss_x 0.4106 (0.3793) acc_x 90.6250 (92.3438) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/27] time 0.310 (0.316) data 0.232 (0.238) loss_x loss_x 0.3450 (0.3966) acc_x 96.8750 (91.7500) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:886
clean false:5
clean_rate:0.9943883277216611
noisy true:486
noisy false:255
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [97/200] batch [5/27] time 0.416 (0.378) data 0.270 (0.287) loss_x loss_x 0.2839 (0.3991) acc_x 93.7500 (93.1250) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [10/27] time 0.308 (0.363) data 0.231 (0.279) loss_x loss_x 0.9312 (0.4860) acc_x 75.0000 (90.3125) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [15/27] time 0.326 (0.350) data 0.249 (0.268) loss_x loss_x 0.4358 (0.4673) acc_x 90.6250 (90.2083) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [20/27] time 0.301 (0.347) data 0.223 (0.265) loss_x loss_x 0.1829 (0.4573) acc_x 96.8750 (90.7812) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/27] time 0.343 (0.340) data 0.265 (0.259) loss_x loss_x 0.3855 (0.4384) acc_x 90.6250 (90.5000) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.5447, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 889
clean true:884
clean false:5
clean_rate:0.9943757030371203
noisy true:491
noisy false:252
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 743
epoch [98/200] batch [5/27] time 0.397 (0.393) data 0.319 (0.305) loss_x loss_x 0.2595 (0.4038) acc_x 93.7500 (89.3750) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [10/27] time 0.340 (0.380) data 0.263 (0.297) loss_x loss_x 0.7202 (0.4502) acc_x 78.1250 (89.0625) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [15/27] time 0.373 (0.374) data 0.296 (0.292) loss_x loss_x 0.3577 (0.4545) acc_x 90.6250 (89.1667) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [20/27] time 0.326 (0.371) data 0.248 (0.287) loss_x loss_x 0.3958 (0.4252) acc_x 93.7500 (90.3125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/27] time 0.309 (0.366) data 0.232 (0.281) loss_x loss_x 0.4314 (0.4104) acc_x 84.3750 (90.8750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.5478, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 894
clean true:889
clean false:5
clean_rate:0.9944071588366891
noisy true:499
noisy false:239
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 738
epoch [99/200] batch [5/27] time 0.354 (0.360) data 0.277 (0.282) loss_x loss_x 0.1337 (0.5132) acc_x 100.0000 (88.7500) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [10/27] time 0.352 (0.352) data 0.274 (0.275) loss_x loss_x 0.4148 (0.4367) acc_x 93.7500 (90.6250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [15/27] time 0.361 (0.350) data 0.284 (0.272) loss_x loss_x 0.3142 (0.4210) acc_x 90.6250 (91.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [20/27] time 0.364 (0.354) data 0.287 (0.272) loss_x loss_x 0.1530 (0.3875) acc_x 96.8750 (91.7188) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/27] time 0.347 (0.355) data 0.269 (0.274) loss_x loss_x 0.2693 (0.3675) acc_x 90.6250 (91.6250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.5325, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 869
clean true:867
clean false:2
clean_rate:0.997698504027618
noisy true:495
noisy false:268
all clean rate:  [0.9746835443037974, 0.9928057553956835, 0.994413407821229, 0.9929824561403509, 0.9983164983164983, 0.9965870307167235, 0.998330550918197, 1.0, 0.9983471074380166, 0.9967373572593801, 0.9935587761674718, 0.9922600619195047, 0.9984276729559748, 0.9984350547730829, 0.9939117199391172, 0.9938744257274119, 0.9969924812030075, 0.9970104633781763, 0.9984709480122325, 0.9985486211901307, 0.9985507246376811, 0.9971949509116409, 0.9956521739130435, 0.9957264957264957, 0.9943977591036415, 0.9958563535911602, 0.9985974754558204, 0.9946737683089214, 0.9972527472527473, 1.0, 0.9959568733153639, 0.9986301369863013, 0.9960212201591512, 0.9973226238286479, 0.9947643979057592, 0.9934640522875817, 0.9961538461538462, 0.9947916666666666, 0.9961734693877551, 0.9961340206185567, 0.9974093264248705, 0.9974937343358395, 0.9961977186311787, 0.998745294855709, 0.9962640099626401, 0.996268656716418, 0.9974522292993631, 0.9962732919254659, 0.9961389961389961, 1.0, 0.9987437185929648, 0.997563946406821, 0.9938949938949939, 0.997539975399754, 0.995085995085995, 0.9963811821471653, 0.9975728155339806, 0.997539975399754, 0.9975579975579976, 0.9964285714285714, 0.9963898916967509, 0.9988009592326139, 0.9975845410628019, 0.996415770609319, 0.9939686369119421, 0.9976019184652278, 0.9975786924939467, 0.9988023952095808, 0.992744860943168, 0.9987937273823885, 0.9964788732394366, 0.9987789987789988, 0.9951980792316927, 0.9964580873671782, 0.9953051643192489, 0.9976498237367802, 0.9953434225844005, 0.9977037887485649, 0.9988221436984688, 0.9976798143851509, 0.9965556831228473, 0.9976218787158145, 1.0, 0.9977142857142857, 0.9976442873969376, 0.9965556831228473, 0.9988412514484357, 1.0, 0.9977142857142857, 0.9988439306358381, 0.9942987457240593, 0.996629213483146, 0.9943181818181818, 0.9977349943374858, 0.9954648526077098, 0.9965831435079726, 0.9943883277216611, 0.9943757030371203, 0.9944071588366891, 0.997698504027618]
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 763
epoch [100/200] batch [5/27] time 0.361 (0.369) data 0.284 (0.284) loss_x loss_x 0.4285 (0.3449) acc_x 87.5000 (91.2500) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [10/27] time 0.365 (0.364) data 0.288 (0.282) loss_x loss_x 0.4182 (0.3600) acc_x 87.5000 (90.9375) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [15/27] time 0.367 (0.362) data 0.288 (0.282) loss_x loss_x 0.2715 (0.3248) acc_x 90.6250 (91.8750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [20/27] time 0.406 (0.366) data 0.328 (0.286) loss_x loss_x 0.2137 (0.3345) acc_x 93.7500 (91.7188) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/27] time 0.468 (0.370) data 0.280 (0.286) loss_x loss_x 0.5371 (0.3379) acc_x 84.3750 (91.6250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:882
clean false:2
clean_rate:0.997737556561086
noisy true:499
noisy false:249
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [101/200] batch [5/27] time 0.319 (0.318) data 0.242 (0.240) loss_x loss_x 0.6270 (0.4222) acc_x 84.3750 (88.1250) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [10/27] time 0.382 (0.345) data 0.304 (0.256) loss_x loss_x 0.3643 (0.4024) acc_x 96.8750 (90.0000) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [15/27] time 0.351 (0.348) data 0.273 (0.263) loss_x loss_x 0.5815 (0.4073) acc_x 87.5000 (90.2083) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [20/27] time 0.349 (0.349) data 0.271 (0.266) loss_x loss_x 0.2874 (0.3820) acc_x 90.6250 (90.6250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/27] time 0.323 (0.349) data 0.245 (0.267) loss_x loss_x 0.4919 (0.3823) acc_x 90.6250 (90.6250) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.5343, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 872
clean true:870
clean false:2
clean_rate:0.9977064220183486
noisy true:496
noisy false:264
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 760
epoch [102/200] batch [5/27] time 0.356 (0.380) data 0.279 (0.280) loss_x loss_x 0.2600 (0.4534) acc_x 96.8750 (90.6250) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [10/27] time 0.300 (0.345) data 0.222 (0.257) loss_x loss_x 0.4272 (0.4341) acc_x 84.3750 (89.0625) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [15/27] time 0.355 (0.338) data 0.277 (0.253) loss_x loss_x 0.1132 (0.3730) acc_x 100.0000 (91.2500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [20/27] time 0.333 (0.343) data 0.255 (0.255) loss_x loss_x 0.2700 (0.3916) acc_x 93.7500 (91.0938) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/27] time 0.323 (0.337) data 0.245 (0.251) loss_x loss_x 0.4229 (0.3827) acc_x 93.7500 (91.7500) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:900
clean false:4
clean_rate:0.995575221238938
noisy true:497
noisy false:231
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [103/200] batch [5/28] time 0.359 (0.348) data 0.281 (0.271) loss_x loss_x 0.2842 (0.3137) acc_x 93.7500 (93.7500) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [10/28] time 0.361 (0.341) data 0.284 (0.264) loss_x loss_x 0.2227 (0.3045) acc_x 96.8750 (94.3750) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [15/28] time 0.321 (0.345) data 0.243 (0.261) loss_x loss_x 0.7192 (0.3517) acc_x 84.3750 (92.9167) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [20/28] time 0.296 (0.341) data 0.218 (0.259) loss_x loss_x 0.5376 (0.3608) acc_x 87.5000 (92.3438) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/28] time 0.336 (0.334) data 0.258 (0.253) loss_x loss_x 0.7969 (0.3895) acc_x 81.2500 (91.2500) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.5392, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 880
clean true:878
clean false:2
clean_rate:0.9977272727272727
noisy true:496
noisy false:256
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 752
epoch [104/200] batch [5/27] time 0.379 (0.330) data 0.224 (0.237) loss_x loss_x 0.1356 (0.4443) acc_x 100.0000 (89.3750) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [10/27] time 0.326 (0.322) data 0.248 (0.236) loss_x loss_x 0.3560 (0.3714) acc_x 93.7500 (91.2500) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [15/27] time 0.352 (0.329) data 0.274 (0.246) loss_x loss_x 0.2418 (0.3495) acc_x 100.0000 (92.7083) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/27] time 0.368 (0.336) data 0.282 (0.254) loss_x loss_x 0.3342 (0.3345) acc_x 93.7500 (92.8125) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/27] time 0.327 (0.338) data 0.250 (0.257) loss_x loss_x 0.3611 (0.3335) acc_x 87.5000 (92.7500) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.5392, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 880
clean true:876
clean false:4
clean_rate:0.9954545454545455
noisy true:509
noisy false:243
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 752
epoch [105/200] batch [5/27] time 0.295 (0.351) data 0.217 (0.273) loss_x loss_x 0.7061 (0.4616) acc_x 84.3750 (88.1250) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [10/27] time 0.288 (0.323) data 0.210 (0.246) loss_x loss_x 0.5200 (0.4178) acc_x 90.6250 (90.6250) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [15/27] time 0.304 (0.327) data 0.227 (0.242) loss_x loss_x 0.3198 (0.3802) acc_x 93.7500 (91.0417) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/27] time 0.315 (0.328) data 0.237 (0.245) loss_x loss_x 0.5972 (0.3849) acc_x 84.3750 (91.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/27] time 0.350 (0.333) data 0.271 (0.251) loss_x loss_x 0.3091 (0.3560) acc_x 90.6250 (91.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.5423, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 885
clean true:880
clean false:5
clean_rate:0.9943502824858758
noisy true:494
noisy false:253
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 747
epoch [106/200] batch [5/27] time 0.417 (0.373) data 0.340 (0.295) loss_x loss_x 0.2249 (0.4002) acc_x 96.8750 (90.6250) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [10/27] time 0.300 (0.351) data 0.222 (0.274) loss_x loss_x 0.4331 (0.4672) acc_x 93.7500 (90.3125) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [15/27] time 0.307 (0.335) data 0.229 (0.257) loss_x loss_x 0.4060 (0.4274) acc_x 87.5000 (90.2083) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [20/27] time 0.311 (0.329) data 0.233 (0.251) loss_x loss_x 0.1516 (0.4049) acc_x 100.0000 (90.9375) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/27] time 0.364 (0.336) data 0.286 (0.254) loss_x loss_x 0.2250 (0.3825) acc_x 96.8750 (91.3750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.5435, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 887
clean true:883
clean false:4
clean_rate:0.9954904171364148
noisy true:495
noisy false:250
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 745
epoch [107/200] batch [5/27] time 0.477 (0.385) data 0.286 (0.284) loss_x loss_x 0.3958 (0.4017) acc_x 87.5000 (92.5000) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [10/27] time 0.363 (0.375) data 0.285 (0.286) loss_x loss_x 0.3354 (0.3599) acc_x 96.8750 (93.4375) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [15/27] time 0.385 (0.376) data 0.308 (0.291) loss_x loss_x 0.3665 (0.3514) acc_x 96.8750 (93.1250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [20/27] time 0.321 (0.359) data 0.244 (0.275) loss_x loss_x 0.4524 (0.3591) acc_x 81.2500 (92.3438) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/27] time 0.415 (0.352) data 0.227 (0.265) loss_x loss_x 0.2189 (0.3586) acc_x 96.8750 (92.3750) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.5453, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 890
clean true:888
clean false:2
clean_rate:0.9977528089887641
noisy true:497
noisy false:245
after delete: len(clean_dataset) 890
after delete: len(noisy_dataset) 742
epoch [108/200] batch [5/27] time 0.415 (0.372) data 0.255 (0.277) loss_x loss_x 0.3284 (0.3353) acc_x 90.6250 (91.2500) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [10/27] time 0.369 (0.367) data 0.291 (0.281) loss_x loss_x 0.2695 (0.3231) acc_x 90.6250 (91.8750) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [15/27] time 0.414 (0.372) data 0.286 (0.285) loss_x loss_x 0.4519 (0.3829) acc_x 87.5000 (90.2083) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [20/27] time 0.352 (0.370) data 0.275 (0.285) loss_x loss_x 0.3552 (0.3849) acc_x 87.5000 (90.1562) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/27] time 0.305 (0.363) data 0.227 (0.275) loss_x loss_x 0.2336 (0.3762) acc_x 96.8750 (91.0000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:891
clean false:5
clean_rate:0.9944196428571429
noisy true:488
noisy false:248
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [109/200] batch [5/28] time 0.370 (0.373) data 0.292 (0.295) loss_x loss_x 0.3889 (0.4421) acc_x 90.6250 (89.3750) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [10/28] time 0.382 (0.377) data 0.304 (0.298) loss_x loss_x 0.5146 (0.3952) acc_x 84.3750 (90.0000) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [15/28] time 0.350 (0.376) data 0.272 (0.294) loss_x loss_x 0.5386 (0.3784) acc_x 90.6250 (91.4583) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [20/28] time 0.366 (0.369) data 0.289 (0.287) loss_x loss_x 0.6094 (0.3969) acc_x 84.3750 (90.3125) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/28] time 0.294 (0.362) data 0.216 (0.277) loss_x loss_x 0.3000 (0.3948) acc_x 93.7500 (90.3750) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.5423, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 885
clean true:883
clean false:2
clean_rate:0.9977401129943503
noisy true:492
noisy false:255
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 747
epoch [110/200] batch [5/27] time 0.350 (0.383) data 0.273 (0.297) loss_x loss_x 0.4880 (0.3639) acc_x 90.6250 (93.1250) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [10/27] time 0.348 (0.373) data 0.270 (0.291) loss_x loss_x 0.2720 (0.3759) acc_x 93.7500 (92.8125) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [15/27] time 0.456 (0.373) data 0.288 (0.287) loss_x loss_x 0.3433 (0.3402) acc_x 93.7500 (93.7500) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [20/27] time 0.353 (0.370) data 0.276 (0.285) loss_x loss_x 0.5713 (0.3616) acc_x 90.6250 (92.8125) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/27] time 0.310 (0.366) data 0.233 (0.279) loss_x loss_x 0.5220 (0.3816) acc_x 87.5000 (92.2500) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.5447, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 889
clean true:885
clean false:4
clean_rate:0.9955005624296963
noisy true:497
noisy false:246
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 743
epoch [111/200] batch [5/27] time 0.369 (0.395) data 0.291 (0.296) loss_x loss_x 0.4541 (0.4337) acc_x 93.7500 (91.2500) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [10/27] time 0.462 (0.386) data 0.273 (0.286) loss_x loss_x 0.4189 (0.4123) acc_x 90.6250 (90.6250) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [15/27] time 0.353 (0.378) data 0.275 (0.285) loss_x loss_x 0.3447 (0.3635) acc_x 96.8750 (92.2917) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [20/27] time 0.359 (0.369) data 0.282 (0.280) loss_x loss_x 0.1361 (0.3282) acc_x 100.0000 (93.5938) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/27] time 0.361 (0.369) data 0.283 (0.281) loss_x loss_x 0.3252 (0.3313) acc_x 96.8750 (93.3750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.5478, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 894
clean true:890
clean false:4
clean_rate:0.9955257270693513
noisy true:492
noisy false:246
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 738
epoch [112/200] batch [5/27] time 0.375 (0.354) data 0.298 (0.276) loss_x loss_x 0.2075 (0.3359) acc_x 100.0000 (91.2500) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [10/27] time 0.383 (0.372) data 0.305 (0.283) loss_x loss_x 0.3013 (0.3264) acc_x 93.7500 (92.5000) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [15/27] time 0.360 (0.372) data 0.283 (0.287) loss_x loss_x 0.5151 (0.3344) acc_x 87.5000 (92.0833) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [20/27] time 0.363 (0.373) data 0.286 (0.284) loss_x loss_x 0.4243 (0.3581) acc_x 87.5000 (91.7188) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/27] time 0.358 (0.371) data 0.281 (0.284) loss_x loss_x 0.2245 (0.3539) acc_x 96.8750 (92.0000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:893
clean false:5
clean_rate:0.9944320712694877
noisy true:483
noisy false:251
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [113/200] batch [5/28] time 0.382 (0.366) data 0.289 (0.285) loss_x loss_x 0.4011 (0.3509) acc_x 90.6250 (94.3750) lr 8.2807e-04 eta 0:00:08
epoch [113/200] batch [10/28] time 0.304 (0.348) data 0.227 (0.269) loss_x loss_x 0.3982 (0.3754) acc_x 87.5000 (91.5625) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [15/28] time 0.331 (0.339) data 0.253 (0.260) loss_x loss_x 0.3015 (0.3463) acc_x 90.6250 (92.2917) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [20/28] time 0.460 (0.348) data 0.302 (0.266) loss_x loss_x 0.3938 (0.3570) acc_x 93.7500 (92.6562) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/28] time 0.358 (0.351) data 0.281 (0.270) loss_x loss_x 0.2542 (0.3619) acc_x 93.7500 (92.3750) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:900
clean false:3
clean_rate:0.9966777408637874
noisy true:494
noisy false:235
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [114/200] batch [5/28] time 0.351 (0.355) data 0.273 (0.277) loss_x loss_x 0.2299 (0.3047) acc_x 100.0000 (93.7500) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [10/28] time 0.341 (0.352) data 0.263 (0.273) loss_x loss_x 0.5342 (0.3339) acc_x 87.5000 (92.8125) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [15/28] time 0.329 (0.349) data 0.252 (0.271) loss_x loss_x 0.8013 (0.4036) acc_x 84.3750 (91.6667) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [20/28] time 0.486 (0.357) data 0.296 (0.273) loss_x loss_x 0.5518 (0.3740) acc_x 87.5000 (92.1875) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/28] time 0.350 (0.357) data 0.273 (0.275) loss_x loss_x 0.2386 (0.3606) acc_x 90.6250 (92.5000) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:887
clean false:4
clean_rate:0.9955106621773289
noisy true:495
noisy false:246
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [115/200] batch [5/27] time 0.349 (0.390) data 0.272 (0.291) loss_x loss_x 0.1703 (0.3767) acc_x 100.0000 (91.8750) lr 7.9721e-04 eta 0:00:08
epoch [115/200] batch [10/27] time 0.350 (0.370) data 0.272 (0.282) loss_x loss_x 0.5562 (0.3817) acc_x 87.5000 (91.2500) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [15/27] time 0.317 (0.360) data 0.239 (0.268) loss_x loss_x 0.3845 (0.3804) acc_x 84.3750 (91.2500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [20/27] time 0.333 (0.354) data 0.255 (0.265) loss_x loss_x 0.4834 (0.3812) acc_x 87.5000 (91.2500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/27] time 0.367 (0.350) data 0.288 (0.263) loss_x loss_x 0.2578 (0.3727) acc_x 93.7500 (91.2500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:901
clean false:5
clean_rate:0.9944812362030905
noisy true:492
noisy false:234
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [116/200] batch [5/28] time 0.347 (0.326) data 0.269 (0.249) loss_x loss_x 0.2356 (0.4934) acc_x 93.7500 (90.0000) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [10/28] time 0.364 (0.340) data 0.287 (0.262) loss_x loss_x 0.1478 (0.4030) acc_x 100.0000 (91.8750) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [15/28] time 0.353 (0.347) data 0.276 (0.267) loss_x loss_x 0.2886 (0.3669) acc_x 96.8750 (92.5000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [20/28] time 0.365 (0.355) data 0.287 (0.276) loss_x loss_x 0.1814 (0.3455) acc_x 96.8750 (92.8125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/28] time 0.350 (0.360) data 0.273 (0.281) loss_x loss_x 0.2081 (0.3405) acc_x 93.7500 (93.0000) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:897
clean false:4
clean_rate:0.9955604883462819
noisy true:499
noisy false:232
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [117/200] batch [5/28] time 0.305 (0.306) data 0.227 (0.229) loss_x loss_x 0.2278 (0.4033) acc_x 96.8750 (92.5000) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [10/28] time 0.312 (0.315) data 0.234 (0.238) loss_x loss_x 0.4097 (0.3714) acc_x 90.6250 (93.1250) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [15/28] time 0.330 (0.329) data 0.252 (0.247) loss_x loss_x 0.7417 (0.4199) acc_x 71.8750 (90.2083) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [20/28] time 0.323 (0.336) data 0.245 (0.255) loss_x loss_x 0.4302 (0.4156) acc_x 87.5000 (89.6875) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/28] time 0.382 (0.343) data 0.304 (0.262) loss_x loss_x 0.3691 (0.4020) acc_x 90.6250 (90.1250) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.5472, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 893
clean true:889
clean false:4
clean_rate:0.9955207166853304
noisy true:496
noisy false:243
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 739
epoch [118/200] batch [5/27] time 0.349 (0.346) data 0.271 (0.268) loss_x loss_x 0.5132 (0.4468) acc_x 87.5000 (90.0000) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [10/27] time 0.309 (0.347) data 0.231 (0.259) loss_x loss_x 0.4109 (0.3523) acc_x 87.5000 (91.8750) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [15/27] time 0.307 (0.337) data 0.229 (0.252) loss_x loss_x 0.2244 (0.3112) acc_x 100.0000 (93.5417) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [20/27] time 0.360 (0.348) data 0.282 (0.259) loss_x loss_x 0.3594 (0.3426) acc_x 93.7500 (92.0312) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/27] time 0.346 (0.350) data 0.268 (0.263) loss_x loss_x 0.4607 (0.3543) acc_x 87.5000 (91.6250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:887
clean false:5
clean_rate:0.9943946188340808
noisy true:512
noisy false:228
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [119/200] batch [5/27] time 0.329 (0.352) data 0.251 (0.273) loss_x loss_x 0.4751 (0.3530) acc_x 90.6250 (93.7500) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [10/27] time 0.374 (0.356) data 0.296 (0.278) loss_x loss_x 0.4319 (0.3900) acc_x 81.2500 (91.5625) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [15/27] time 0.330 (0.356) data 0.253 (0.273) loss_x loss_x 0.3076 (0.3699) acc_x 93.7500 (92.0833) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/27] time 0.325 (0.347) data 0.246 (0.265) loss_x loss_x 0.4268 (0.3696) acc_x 87.5000 (91.5625) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/27] time 0.353 (0.354) data 0.275 (0.268) loss_x loss_x 0.5903 (0.3921) acc_x 84.3750 (91.1250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.5429, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 886
clean true:882
clean false:4
clean_rate:0.9954853273137697
noisy true:487
noisy false:259
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 746
epoch [120/200] batch [5/27] time 0.362 (0.377) data 0.284 (0.277) loss_x loss_x 0.2930 (0.3252) acc_x 93.7500 (95.6250) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [10/27] time 0.354 (0.367) data 0.276 (0.278) loss_x loss_x 0.2260 (0.3004) acc_x 100.0000 (95.0000) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [15/27] time 0.339 (0.369) data 0.260 (0.277) loss_x loss_x 0.2554 (0.3388) acc_x 93.7500 (93.7500) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [20/27] time 0.306 (0.363) data 0.229 (0.269) loss_x loss_x 0.3008 (0.3343) acc_x 93.7500 (93.5938) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/27] time 0.309 (0.352) data 0.232 (0.261) loss_x loss_x 0.3843 (0.3643) acc_x 93.7500 (92.7500) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.5441, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 888
clean true:884
clean false:4
clean_rate:0.9954954954954955
noisy true:494
noisy false:250
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 744
epoch [121/200] batch [5/27] time 0.383 (0.399) data 0.304 (0.299) loss_x loss_x 0.2810 (0.4025) acc_x 93.7500 (90.6250) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [10/27] time 0.337 (0.371) data 0.259 (0.282) loss_x loss_x 0.3079 (0.3821) acc_x 93.7500 (91.5625) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [15/27] time 0.355 (0.367) data 0.278 (0.281) loss_x loss_x 0.1981 (0.3565) acc_x 96.8750 (92.0833) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [20/27] time 0.329 (0.365) data 0.251 (0.281) loss_x loss_x 0.4336 (0.3841) acc_x 87.5000 (91.5625) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/27] time 0.300 (0.353) data 0.222 (0.271) loss_x loss_x 0.4214 (0.3864) acc_x 87.5000 (90.7500) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:898
clean false:4
clean_rate:0.9955654101995566
noisy true:496
noisy false:234
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [122/200] batch [5/28] time 0.370 (0.372) data 0.291 (0.278) loss_x loss_x 0.2837 (0.2787) acc_x 93.7500 (93.1250) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [10/28] time 0.332 (0.369) data 0.254 (0.283) loss_x loss_x 0.4941 (0.2726) acc_x 81.2500 (92.8125) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [15/28] time 0.366 (0.372) data 0.288 (0.289) loss_x loss_x 0.3950 (0.3181) acc_x 90.6250 (92.2917) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [20/28] time 0.347 (0.366) data 0.270 (0.284) loss_x loss_x 0.4221 (0.3391) acc_x 90.6250 (91.7188) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/28] time 0.353 (0.362) data 0.275 (0.281) loss_x loss_x 0.3794 (0.3343) acc_x 93.7500 (92.5000) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.5435, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 887
clean true:885
clean false:2
clean_rate:0.9977452085682075
noisy true:504
noisy false:241
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 745
epoch [123/200] batch [5/27] time 0.352 (0.363) data 0.275 (0.286) loss_x loss_x 0.3237 (0.3183) acc_x 90.6250 (92.5000) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [10/27] time 0.367 (0.384) data 0.290 (0.297) loss_x loss_x 0.3831 (0.3850) acc_x 90.6250 (90.9375) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [15/27] time 0.372 (0.382) data 0.295 (0.298) loss_x loss_x 0.3293 (0.3640) acc_x 93.7500 (91.4583) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [20/27] time 0.360 (0.377) data 0.283 (0.295) loss_x loss_x 0.4197 (0.3559) acc_x 90.6250 (91.5625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/27] time 0.363 (0.374) data 0.286 (0.291) loss_x loss_x 0.2156 (0.3458) acc_x 93.7500 (92.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:895
clean false:4
clean_rate:0.9955506117908788
noisy true:485
noisy false:248
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [124/200] batch [5/28] time 0.365 (0.374) data 0.287 (0.296) loss_x loss_x 0.2688 (0.2955) acc_x 93.7500 (93.1250) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [10/28] time 0.360 (0.377) data 0.283 (0.292) loss_x loss_x 0.5010 (0.3260) acc_x 90.6250 (92.5000) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [15/28] time 0.366 (0.373) data 0.288 (0.291) loss_x loss_x 0.1935 (0.3453) acc_x 96.8750 (91.6667) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [20/28] time 0.367 (0.371) data 0.289 (0.290) loss_x loss_x 0.5273 (0.3406) acc_x 84.3750 (92.1875) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/28] time 0.493 (0.377) data 0.307 (0.292) loss_x loss_x 0.2183 (0.3364) acc_x 100.0000 (92.5000) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:894
clean false:5
clean_rate:0.9944382647385984
noisy true:503
noisy false:230
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [125/200] batch [5/28] time 0.344 (0.362) data 0.266 (0.280) loss_x loss_x 0.3948 (0.3211) acc_x 90.6250 (93.1250) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [10/28] time 0.360 (0.359) data 0.283 (0.279) loss_x loss_x 0.3477 (0.4236) acc_x 93.7500 (91.2500) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [15/28] time 0.351 (0.359) data 0.274 (0.280) loss_x loss_x 0.3774 (0.4105) acc_x 93.7500 (91.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [20/28] time 0.360 (0.366) data 0.282 (0.282) loss_x loss_x 0.4104 (0.3915) acc_x 90.6250 (91.2500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/28] time 0.326 (0.363) data 0.249 (0.280) loss_x loss_x 0.2971 (0.3614) acc_x 93.7500 (92.1250) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:883
clean false:1
clean_rate:0.998868778280543
noisy true:499
noisy false:249
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [126/200] batch [5/27] time 0.485 (0.390) data 0.297 (0.290) loss_x loss_x 0.4927 (0.4632) acc_x 87.5000 (88.1250) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [10/27] time 0.325 (0.364) data 0.248 (0.275) loss_x loss_x 0.3130 (0.4028) acc_x 93.7500 (90.0000) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [15/27] time 0.314 (0.352) data 0.236 (0.267) loss_x loss_x 0.3325 (0.3676) acc_x 90.6250 (90.6250) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [20/27] time 0.373 (0.353) data 0.295 (0.264) loss_x loss_x 0.2250 (0.3482) acc_x 96.8750 (91.2500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/27] time 0.363 (0.355) data 0.285 (0.268) loss_x loss_x 0.1993 (0.3642) acc_x 96.8750 (91.5000) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:906
clean false:8
clean_rate:0.9912472647702407
noisy true:504
noisy false:214
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [127/200] batch [5/28] time 0.349 (0.360) data 0.272 (0.277) loss_x loss_x 0.3066 (0.2679) acc_x 90.6250 (92.5000) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [10/28] time 0.308 (0.332) data 0.231 (0.252) loss_x loss_x 0.2500 (0.3416) acc_x 93.7500 (91.8750) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [15/28] time 0.346 (0.335) data 0.265 (0.256) loss_x loss_x 0.3362 (0.3235) acc_x 90.6250 (91.6667) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [20/28] time 0.393 (0.343) data 0.315 (0.264) loss_x loss_x 0.2390 (0.3177) acc_x 93.7500 (91.2500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/28] time 0.306 (0.346) data 0.228 (0.263) loss_x loss_x 0.3413 (0.3273) acc_x 93.7500 (91.1250) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:896
clean false:5
clean_rate:0.9944506104328524
noisy true:495
noisy false:236
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [128/200] batch [5/28] time 0.369 (0.352) data 0.291 (0.275) loss_x loss_x 0.6631 (0.4081) acc_x 81.2500 (90.0000) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [10/28] time 0.350 (0.365) data 0.272 (0.276) loss_x loss_x 0.3801 (0.3612) acc_x 93.7500 (91.8750) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [15/28] time 0.391 (0.354) data 0.313 (0.269) loss_x loss_x 0.3965 (0.3484) acc_x 93.7500 (92.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/28] time 0.418 (0.366) data 0.340 (0.279) loss_x loss_x 0.2056 (0.3503) acc_x 96.8750 (92.0312) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/28] time 0.382 (0.368) data 0.305 (0.283) loss_x loss_x 0.2030 (0.3361) acc_x 96.8750 (92.5000) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:899
clean false:3
clean_rate:0.9966740576496674
noisy true:500
noisy false:230
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [129/200] batch [5/28] time 0.347 (0.363) data 0.269 (0.284) loss_x loss_x 0.1497 (0.3575) acc_x 100.0000 (92.5000) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/28] time 0.375 (0.363) data 0.298 (0.276) loss_x loss_x 0.5444 (0.3527) acc_x 87.5000 (93.4375) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [15/28] time 0.361 (0.355) data 0.283 (0.271) loss_x loss_x 0.4351 (0.3519) acc_x 90.6250 (92.7083) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [20/28] time 0.353 (0.360) data 0.275 (0.276) loss_x loss_x 0.1554 (0.3262) acc_x 96.8750 (93.2812) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/28] time 0.363 (0.364) data 0.286 (0.281) loss_x loss_x 0.3806 (0.3084) acc_x 87.5000 (93.6250) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5447, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 889
clean true:887
clean false:2
clean_rate:0.9977502812148481
noisy true:507
noisy false:236
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 743
epoch [130/200] batch [5/27] time 0.353 (0.358) data 0.275 (0.281) loss_x loss_x 0.6299 (0.3717) acc_x 78.1250 (90.0000) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [10/27] time 0.363 (0.380) data 0.286 (0.292) loss_x loss_x 0.3440 (0.3664) acc_x 90.6250 (90.9375) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [15/27] time 0.329 (0.373) data 0.251 (0.288) loss_x loss_x 0.4670 (0.3663) acc_x 90.6250 (91.2500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/27] time 0.357 (0.372) data 0.280 (0.289) loss_x loss_x 0.3557 (0.3562) acc_x 96.8750 (91.4062) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/27] time 0.356 (0.372) data 0.278 (0.290) loss_x loss_x 0.2617 (0.3522) acc_x 93.7500 (91.8750) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:897
clean false:4
clean_rate:0.9955604883462819
noisy true:502
noisy false:229
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [131/200] batch [5/28] time 0.329 (0.390) data 0.251 (0.290) loss_x loss_x 0.3730 (0.3202) acc_x 90.6250 (92.5000) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [10/28] time 0.329 (0.365) data 0.251 (0.276) loss_x loss_x 0.4185 (0.3607) acc_x 87.5000 (92.1875) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [15/28] time 0.393 (0.368) data 0.315 (0.282) loss_x loss_x 0.4534 (0.3619) acc_x 87.5000 (92.2917) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/28] time 0.310 (0.361) data 0.231 (0.278) loss_x loss_x 0.2223 (0.3471) acc_x 90.6250 (92.3438) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/28] time 0.365 (0.352) data 0.286 (0.270) loss_x loss_x 0.1171 (0.3259) acc_x 96.8750 (92.5000) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:902
clean false:2
clean_rate:0.9977876106194691
noisy true:499
noisy false:229
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [132/200] batch [5/28] time 0.345 (0.317) data 0.268 (0.239) loss_x loss_x 0.3469 (0.3639) acc_x 93.7500 (90.6250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [10/28] time 0.348 (0.338) data 0.269 (0.260) loss_x loss_x 0.4993 (0.3923) acc_x 87.5000 (90.3125) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [15/28] time 0.341 (0.344) data 0.263 (0.266) loss_x loss_x 0.1140 (0.3628) acc_x 100.0000 (91.2500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/28] time 0.372 (0.348) data 0.294 (0.270) loss_x loss_x 0.4414 (0.3485) acc_x 90.6250 (91.4062) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/28] time 0.364 (0.356) data 0.286 (0.273) loss_x loss_x 0.6123 (0.3530) acc_x 84.3750 (91.1250) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:908
clean false:6
clean_rate:0.9934354485776805
noisy true:489
noisy false:229
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [133/200] batch [5/28] time 0.418 (0.358) data 0.250 (0.262) loss_x loss_x 0.2482 (0.3529) acc_x 93.7500 (92.5000) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [10/28] time 0.309 (0.334) data 0.231 (0.247) loss_x loss_x 0.3550 (0.3569) acc_x 90.6250 (92.8125) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [15/28] time 0.367 (0.332) data 0.289 (0.248) loss_x loss_x 0.3118 (0.3353) acc_x 93.7500 (93.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/28] time 0.394 (0.345) data 0.316 (0.261) loss_x loss_x 0.3958 (0.3561) acc_x 93.7500 (92.5000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/28] time 0.369 (0.353) data 0.291 (0.270) loss_x loss_x 0.3350 (0.3612) acc_x 90.6250 (92.0000) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:897
clean false:1
clean_rate:0.9988864142538976
noisy true:500
noisy false:234
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [134/200] batch [5/28] time 0.315 (0.313) data 0.237 (0.235) loss_x loss_x 0.5293 (0.3378) acc_x 90.6250 (91.8750) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/28] time 0.349 (0.317) data 0.270 (0.239) loss_x loss_x 0.1841 (0.3207) acc_x 96.8750 (92.5000) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [15/28] time 0.346 (0.322) data 0.268 (0.244) loss_x loss_x 0.2910 (0.3171) acc_x 90.6250 (92.7083) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [20/28] time 0.420 (0.340) data 0.341 (0.257) loss_x loss_x 0.2190 (0.3214) acc_x 93.7500 (92.3438) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/28] time 0.350 (0.347) data 0.272 (0.264) loss_x loss_x 0.2080 (0.3279) acc_x 96.8750 (92.3750) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:912
clean false:2
clean_rate:0.9978118161925602
noisy true:503
noisy false:215
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [135/200] batch [5/28] time 0.377 (0.372) data 0.300 (0.295) loss_x loss_x 0.3362 (0.3590) acc_x 90.6250 (92.5000) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/28] time 0.348 (0.355) data 0.270 (0.272) loss_x loss_x 0.4421 (0.3698) acc_x 87.5000 (91.2500) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [15/28] time 0.449 (0.357) data 0.296 (0.271) loss_x loss_x 0.3145 (0.3663) acc_x 93.7500 (91.6667) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [20/28] time 0.342 (0.355) data 0.264 (0.271) loss_x loss_x 0.4133 (0.3732) acc_x 87.5000 (91.0938) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/28] time 0.338 (0.359) data 0.261 (0.276) loss_x loss_x 0.3044 (0.3570) acc_x 90.6250 (91.0000) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:905
clean false:4
clean_rate:0.9955995599559956
noisy true:509
noisy false:214
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [136/200] batch [5/28] time 0.362 (0.371) data 0.285 (0.294) loss_x loss_x 0.3157 (0.3313) acc_x 93.7500 (90.6250) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [10/28] time 0.303 (0.350) data 0.225 (0.261) loss_x loss_x 0.4338 (0.3669) acc_x 90.6250 (90.3125) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [15/28] time 0.299 (0.334) data 0.223 (0.250) loss_x loss_x 0.2700 (0.3870) acc_x 93.7500 (89.1667) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [20/28] time 0.318 (0.343) data 0.240 (0.254) loss_x loss_x 0.4851 (0.3701) acc_x 87.5000 (89.8438) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/28] time 0.362 (0.355) data 0.285 (0.264) loss_x loss_x 0.2343 (0.3702) acc_x 96.8750 (90.0000) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:895
clean false:3
clean_rate:0.9966592427616926
noisy true:519
noisy false:215
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [137/200] batch [5/28] time 0.363 (0.391) data 0.285 (0.291) loss_x loss_x 0.4741 (0.3741) acc_x 90.6250 (93.1250) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [10/28] time 0.303 (0.351) data 0.225 (0.262) loss_x loss_x 0.2979 (0.3311) acc_x 93.7500 (92.5000) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [15/28] time 0.411 (0.343) data 0.226 (0.251) loss_x loss_x 0.2637 (0.3688) acc_x 93.7500 (91.6667) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [20/28] time 0.312 (0.337) data 0.233 (0.248) loss_x loss_x 0.6479 (0.3715) acc_x 84.3750 (91.7188) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/28] time 0.349 (0.335) data 0.272 (0.249) loss_x loss_x 0.5635 (0.3651) acc_x 81.2500 (91.3750) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:900
clean false:2
clean_rate:0.9977827050997783
noisy true:501
noisy false:229
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [138/200] batch [5/28] time 0.372 (0.365) data 0.294 (0.287) loss_x loss_x 0.3730 (0.3144) acc_x 90.6250 (91.8750) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [10/28] time 0.311 (0.356) data 0.234 (0.276) loss_x loss_x 0.1263 (0.3034) acc_x 100.0000 (93.1250) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [15/28] time 0.300 (0.338) data 0.222 (0.258) loss_x loss_x 0.2571 (0.2957) acc_x 96.8750 (93.9583) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [20/28] time 0.361 (0.336) data 0.229 (0.253) loss_x loss_x 0.3525 (0.3167) acc_x 87.5000 (92.8125) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/28] time 0.299 (0.330) data 0.221 (0.248) loss_x loss_x 0.4717 (0.3153) acc_x 87.5000 (92.6250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5472, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 893
clean true:890
clean false:3
clean_rate:0.9966405375139977
noisy true:514
noisy false:225
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 739
epoch [139/200] batch [5/27] time 0.373 (0.376) data 0.295 (0.298) loss_x loss_x 0.3105 (0.3151) acc_x 93.7500 (91.8750) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [10/27] time 0.357 (0.375) data 0.278 (0.297) loss_x loss_x 0.2749 (0.2839) acc_x 93.7500 (94.0625) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [15/27] time 0.356 (0.376) data 0.278 (0.298) loss_x loss_x 0.4622 (0.3055) acc_x 84.3750 (93.1250) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/27] time 0.316 (0.366) data 0.238 (0.285) loss_x loss_x 0.2494 (0.3009) acc_x 90.6250 (92.9688) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/27] time 0.291 (0.355) data 0.214 (0.275) loss_x loss_x 0.2484 (0.2875) acc_x 93.7500 (93.5000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:900
clean false:2
clean_rate:0.9977827050997783
noisy true:497
noisy false:233
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [140/200] batch [5/28] time 0.367 (0.360) data 0.289 (0.283) loss_x loss_x 0.3525 (0.3895) acc_x 87.5000 (89.3750) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [10/28] time 0.351 (0.372) data 0.272 (0.285) loss_x loss_x 0.4429 (0.4048) acc_x 84.3750 (89.0625) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [15/28] time 0.374 (0.371) data 0.297 (0.287) loss_x loss_x 0.2135 (0.3700) acc_x 96.8750 (90.8333) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [20/28] time 0.345 (0.366) data 0.267 (0.284) loss_x loss_x 0.2335 (0.3667) acc_x 100.0000 (91.4062) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/28] time 0.304 (0.359) data 0.225 (0.273) loss_x loss_x 0.3684 (0.3725) acc_x 90.6250 (91.5000) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:907
clean false:5
clean_rate:0.9945175438596491
noisy true:496
noisy false:224
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [141/200] batch [5/28] time 0.330 (0.344) data 0.253 (0.267) loss_x loss_x 0.4268 (0.2824) acc_x 90.6250 (94.3750) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [10/28] time 0.379 (0.349) data 0.300 (0.271) loss_x loss_x 0.4045 (0.3045) acc_x 90.6250 (93.1250) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [15/28] time 0.477 (0.364) data 0.291 (0.279) loss_x loss_x 0.3096 (0.3391) acc_x 93.7500 (92.0833) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [20/28] time 0.496 (0.370) data 0.310 (0.281) loss_x loss_x 0.2537 (0.3355) acc_x 93.7500 (92.3438) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/28] time 0.351 (0.368) data 0.273 (0.282) loss_x loss_x 0.6519 (0.3291) acc_x 75.0000 (92.3750) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.5478, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 894
clean true:889
clean false:5
clean_rate:0.9944071588366891
noisy true:502
noisy false:236
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 738
epoch [142/200] batch [5/27] time 0.371 (0.354) data 0.294 (0.276) loss_x loss_x 0.3433 (0.3840) acc_x 93.7500 (91.2500) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [10/27] time 0.381 (0.369) data 0.303 (0.291) loss_x loss_x 0.5229 (0.3242) acc_x 87.5000 (93.4375) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [15/27] time 0.376 (0.373) data 0.299 (0.289) loss_x loss_x 0.1532 (0.2993) acc_x 96.8750 (93.5417) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [20/27] time 0.347 (0.373) data 0.270 (0.290) loss_x loss_x 0.3159 (0.3020) acc_x 90.6250 (93.4375) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/27] time 0.352 (0.371) data 0.275 (0.290) loss_x loss_x 0.5205 (0.3103) acc_x 87.5000 (93.3750) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 197
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:900
clean false:4
clean_rate:0.995575221238938
noisy true:535
noisy false:193
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [143/200] batch [5/28] time 0.355 (0.362) data 0.277 (0.262) loss_x loss_x 0.2128 (0.2942) acc_x 93.7500 (92.5000) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [10/28] time 0.347 (0.378) data 0.269 (0.278) loss_x loss_x 0.3782 (0.2771) acc_x 87.5000 (93.4375) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [15/28] time 0.380 (0.376) data 0.302 (0.284) loss_x loss_x 0.2891 (0.3029) acc_x 93.7500 (93.3333) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [20/28] time 0.375 (0.382) data 0.298 (0.290) loss_x loss_x 0.2917 (0.3254) acc_x 90.6250 (92.3438) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [25/28] time 0.350 (0.380) data 0.272 (0.291) loss_x loss_x 0.2356 (0.3292) acc_x 90.6250 (92.5000) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:904
clean false:3
clean_rate:0.9966923925027563
noisy true:497
noisy false:228
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [144/200] batch [5/28] time 0.357 (0.379) data 0.279 (0.301) loss_x loss_x 0.3325 (0.3267) acc_x 96.8750 (94.3750) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [10/28] time 0.374 (0.385) data 0.297 (0.297) loss_x loss_x 0.1512 (0.3104) acc_x 96.8750 (93.7500) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [15/28] time 0.380 (0.382) data 0.301 (0.297) loss_x loss_x 0.3772 (0.3258) acc_x 87.5000 (92.7083) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [20/28] time 0.365 (0.383) data 0.287 (0.294) loss_x loss_x 0.2286 (0.3229) acc_x 96.8750 (93.2812) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [25/28] time 0.412 (0.383) data 0.299 (0.295) loss_x loss_x 0.4023 (0.3234) acc_x 93.7500 (93.3750) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:903
clean false:4
clean_rate:0.9955898566703418
noisy true:515
noisy false:210
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [145/200] batch [5/28] time 0.366 (0.356) data 0.289 (0.278) loss_x loss_x 0.6538 (0.4113) acc_x 90.6250 (92.5000) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [10/28] time 0.380 (0.377) data 0.302 (0.288) loss_x loss_x 0.3691 (0.3465) acc_x 93.7500 (93.1250) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [15/28] time 0.356 (0.375) data 0.278 (0.290) loss_x loss_x 0.3186 (0.3159) acc_x 96.8750 (94.1667) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/28] time 0.383 (0.373) data 0.306 (0.290) loss_x loss_x 0.4316 (0.3339) acc_x 90.6250 (93.2812) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/28] time 0.375 (0.375) data 0.297 (0.293) loss_x loss_x 0.1993 (0.3271) acc_x 90.6250 (93.0000) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:901
clean false:5
clean_rate:0.9944812362030905
noisy true:514
noisy false:212
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [146/200] batch [5/28] time 0.349 (0.381) data 0.271 (0.282) loss_x loss_x 0.4878 (0.3241) acc_x 81.2500 (93.1250) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [10/28] time 0.350 (0.363) data 0.272 (0.274) loss_x loss_x 0.3787 (0.3641) acc_x 87.5000 (92.1875) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [15/28] time 0.337 (0.360) data 0.259 (0.275) loss_x loss_x 0.2927 (0.3460) acc_x 90.6250 (92.2917) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/28] time 0.301 (0.349) data 0.223 (0.263) loss_x loss_x 0.5234 (0.3534) acc_x 90.6250 (91.8750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/28] time 0.361 (0.351) data 0.283 (0.267) loss_x loss_x 0.3252 (0.3505) acc_x 87.5000 (91.6250) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:913
clean false:5
clean_rate:0.9945533769063181
noisy true:517
noisy false:197
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [147/200] batch [5/28] time 0.321 (0.327) data 0.244 (0.250) loss_x loss_x 0.2349 (0.2551) acc_x 96.8750 (95.6250) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [10/28] time 0.354 (0.349) data 0.276 (0.271) loss_x loss_x 0.2114 (0.2818) acc_x 93.7500 (93.7500) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [15/28] time 0.355 (0.359) data 0.277 (0.274) loss_x loss_x 0.3728 (0.3071) acc_x 90.6250 (92.9167) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [20/28] time 0.456 (0.363) data 0.297 (0.276) loss_x loss_x 0.2292 (0.3120) acc_x 96.8750 (93.2812) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/28] time 0.317 (0.360) data 0.240 (0.275) loss_x loss_x 0.2771 (0.3091) acc_x 93.7500 (93.1250) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:897
clean false:4
clean_rate:0.9955604883462819
noisy true:505
noisy false:226
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [148/200] batch [5/28] time 0.344 (0.377) data 0.266 (0.299) loss_x loss_x 0.2642 (0.3458) acc_x 90.6250 (92.5000) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [10/28] time 0.320 (0.372) data 0.241 (0.294) loss_x loss_x 0.3616 (0.3169) acc_x 87.5000 (92.1875) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [15/28] time 0.429 (0.358) data 0.241 (0.273) loss_x loss_x 0.4336 (0.3107) acc_x 87.5000 (92.7083) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [20/28] time 0.368 (0.361) data 0.291 (0.277) loss_x loss_x 0.3030 (0.3099) acc_x 96.8750 (93.2812) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/28] time 0.344 (0.360) data 0.266 (0.278) loss_x loss_x 0.5420 (0.3203) acc_x 93.7500 (93.2500) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5643, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 921
clean true:916
clean false:5
clean_rate:0.99457111834962
noisy true:494
noisy false:217
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 711
epoch [149/200] batch [5/28] time 0.381 (0.334) data 0.304 (0.256) loss_x loss_x 0.5508 (0.3598) acc_x 84.3750 (90.0000) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [10/28] time 0.365 (0.346) data 0.288 (0.268) loss_x loss_x 0.7578 (0.3793) acc_x 87.5000 (90.9375) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [15/28] time 0.337 (0.346) data 0.259 (0.269) loss_x loss_x 0.5244 (0.3648) acc_x 81.2500 (91.0417) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [20/28] time 0.311 (0.340) data 0.234 (0.262) loss_x loss_x 0.4480 (0.3481) acc_x 90.6250 (91.4062) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/28] time 0.359 (0.340) data 0.282 (0.262) loss_x loss_x 0.5005 (0.3666) acc_x 81.2500 (90.3750) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 913
clean true:911
clean false:2
clean_rate:0.9978094194961665
noisy true:508
noisy false:211
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 719
epoch [150/200] batch [5/28] time 0.398 (0.370) data 0.320 (0.288) loss_x loss_x 0.1503 (0.2798) acc_x 96.8750 (95.0000) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [10/28] time 0.319 (0.358) data 0.240 (0.279) loss_x loss_x 0.4160 (0.3234) acc_x 84.3750 (92.5000) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [15/28] time 0.335 (0.358) data 0.257 (0.279) loss_x loss_x 0.7461 (0.3311) acc_x 81.2500 (92.9167) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [20/28] time 0.333 (0.353) data 0.255 (0.274) loss_x loss_x 0.3999 (0.3071) acc_x 90.6250 (93.2812) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/28] time 0.364 (0.351) data 0.287 (0.273) loss_x loss_x 0.5601 (0.3150) acc_x 81.2500 (92.7500) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.5564, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 908
clean true:904
clean false:4
clean_rate:0.9955947136563876
noisy true:499
noisy false:225
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 724
epoch [151/200] batch [5/28] time 0.350 (0.335) data 0.272 (0.257) loss_x loss_x 0.3750 (0.3631) acc_x 93.7500 (91.2500) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [10/28] time 0.305 (0.327) data 0.227 (0.238) loss_x loss_x 0.1926 (0.3541) acc_x 100.0000 (91.8750) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [15/28] time 0.344 (0.321) data 0.267 (0.236) loss_x loss_x 0.4294 (0.3521) acc_x 87.5000 (91.4583) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/28] time 0.310 (0.326) data 0.231 (0.242) loss_x loss_x 0.2366 (0.3246) acc_x 96.8750 (92.1875) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/28] time 0.379 (0.332) data 0.301 (0.250) loss_x loss_x 0.3086 (0.3077) acc_x 96.8750 (92.8750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:896
clean false:3
clean_rate:0.996662958843159
noisy true:499
noisy false:234
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [152/200] batch [5/28] time 0.371 (0.388) data 0.293 (0.288) loss_x loss_x 0.4299 (0.3113) acc_x 87.5000 (92.5000) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [10/28] time 0.383 (0.380) data 0.305 (0.292) loss_x loss_x 0.0969 (0.2753) acc_x 100.0000 (93.1250) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [15/28] time 0.357 (0.380) data 0.280 (0.288) loss_x loss_x 0.2278 (0.3163) acc_x 96.8750 (92.0833) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/28] time 0.353 (0.379) data 0.275 (0.290) loss_x loss_x 0.3816 (0.3227) acc_x 87.5000 (91.7188) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [25/28] time 0.418 (0.376) data 0.231 (0.285) loss_x loss_x 0.2905 (0.3075) acc_x 90.6250 (92.3750) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:902
clean false:3
clean_rate:0.9966850828729282
noisy true:512
noisy false:215
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [153/200] batch [5/28] time 0.354 (0.362) data 0.277 (0.285) loss_x loss_x 0.4731 (0.2522) acc_x 87.5000 (95.6250) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [10/28] time 0.361 (0.372) data 0.284 (0.284) loss_x loss_x 0.1819 (0.2716) acc_x 93.7500 (95.0000) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [15/28] time 0.343 (0.373) data 0.265 (0.281) loss_x loss_x 0.5361 (0.2781) acc_x 87.5000 (94.7917) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [20/28] time 0.357 (0.369) data 0.280 (0.280) loss_x loss_x 0.1577 (0.2896) acc_x 96.8750 (94.2188) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/28] time 0.350 (0.368) data 0.272 (0.282) loss_x loss_x 0.3066 (0.2811) acc_x 93.7500 (94.5000) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:905
clean false:6
clean_rate:0.9934138309549945
noisy true:501
noisy false:220
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [154/200] batch [5/28] time 0.392 (0.384) data 0.315 (0.285) loss_x loss_x 0.3325 (0.3440) acc_x 93.7500 (93.1250) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [10/28] time 0.324 (0.366) data 0.247 (0.277) loss_x loss_x 0.3066 (0.3340) acc_x 90.6250 (93.4375) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [15/28] time 0.337 (0.355) data 0.259 (0.269) loss_x loss_x 0.3835 (0.3088) acc_x 87.5000 (93.3333) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [20/28] time 0.339 (0.355) data 0.260 (0.271) loss_x loss_x 0.6328 (0.3337) acc_x 81.2500 (92.5000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/28] time 0.377 (0.357) data 0.300 (0.274) loss_x loss_x 0.1508 (0.3305) acc_x 100.0000 (93.0000) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:908
clean false:3
clean_rate:0.9967069154774972
noisy true:502
noisy false:219
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [155/200] batch [5/28] time 0.302 (0.359) data 0.223 (0.267) loss_x loss_x 0.2375 (0.3213) acc_x 96.8750 (91.8750) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [10/28] time 0.351 (0.346) data 0.273 (0.259) loss_x loss_x 0.6445 (0.4190) acc_x 81.2500 (90.3125) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [15/28] time 0.349 (0.349) data 0.272 (0.265) loss_x loss_x 0.7090 (0.4132) acc_x 90.6250 (90.6250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/28] time 0.357 (0.353) data 0.279 (0.270) loss_x loss_x 0.4333 (0.3754) acc_x 93.7500 (92.1875) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/28] time 0.362 (0.356) data 0.285 (0.275) loss_x loss_x 0.3843 (0.3661) acc_x 90.6250 (92.3750) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 920
clean true:916
clean false:4
clean_rate:0.9956521739130435
noisy true:509
noisy false:203
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 712
epoch [156/200] batch [5/28] time 0.361 (0.345) data 0.284 (0.267) loss_x loss_x 0.1539 (0.3530) acc_x 100.0000 (91.8750) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/28] time 0.374 (0.351) data 0.296 (0.273) loss_x loss_x 0.2115 (0.3194) acc_x 96.8750 (93.1250) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [15/28] time 0.338 (0.352) data 0.261 (0.274) loss_x loss_x 0.5674 (0.3264) acc_x 84.3750 (92.2917) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [20/28] time 0.345 (0.357) data 0.267 (0.275) loss_x loss_x 0.3462 (0.3112) acc_x 87.5000 (92.3438) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/28] time 0.461 (0.358) data 0.274 (0.272) loss_x loss_x 0.5435 (0.3432) acc_x 90.6250 (91.8750) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:906
clean false:5
clean_rate:0.9945115257958288
noisy true:522
noisy false:199
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [157/200] batch [5/28] time 0.356 (0.346) data 0.278 (0.268) loss_x loss_x 0.2075 (0.2608) acc_x 93.7500 (93.7500) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [10/28] time 0.351 (0.356) data 0.274 (0.278) loss_x loss_x 0.2478 (0.2709) acc_x 93.7500 (94.0625) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [15/28] time 0.380 (0.361) data 0.303 (0.283) loss_x loss_x 0.1038 (0.2749) acc_x 100.0000 (93.3333) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [20/28] time 0.351 (0.358) data 0.274 (0.280) loss_x loss_x 0.6255 (0.2945) acc_x 84.3750 (92.9688) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/28] time 0.342 (0.361) data 0.264 (0.281) loss_x loss_x 0.3054 (0.2881) acc_x 93.7500 (93.1250) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5607, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 915
clean true:913
clean false:2
clean_rate:0.9978142076502732
noisy true:507
noisy false:210
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 717
epoch [158/200] batch [5/28] time 0.344 (0.324) data 0.267 (0.246) loss_x loss_x 0.4124 (0.3543) acc_x 90.6250 (91.8750) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/28] time 0.305 (0.332) data 0.227 (0.243) loss_x loss_x 0.1324 (0.3012) acc_x 100.0000 (92.8125) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/28] time 0.335 (0.343) data 0.257 (0.258) loss_x loss_x 0.2427 (0.2944) acc_x 96.8750 (93.3333) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/28] time 0.376 (0.345) data 0.298 (0.262) loss_x loss_x 0.2440 (0.3098) acc_x 96.8750 (93.2812) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/28] time 0.362 (0.357) data 0.284 (0.270) loss_x loss_x 0.4646 (0.3134) acc_x 90.6250 (93.3750) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:906
clean false:4
clean_rate:0.9956043956043956
noisy true:520
noisy false:202
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [159/200] batch [5/28] time 0.351 (0.357) data 0.274 (0.280) loss_x loss_x 0.2891 (0.3548) acc_x 93.7500 (90.0000) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [10/28] time 0.289 (0.333) data 0.212 (0.255) loss_x loss_x 0.5664 (0.3522) acc_x 84.3750 (90.9375) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [15/28] time 0.306 (0.329) data 0.229 (0.251) loss_x loss_x 0.2098 (0.3213) acc_x 93.7500 (92.7083) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/28] time 0.311 (0.328) data 0.233 (0.250) loss_x loss_x 0.4575 (0.3335) acc_x 90.6250 (92.8125) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/28] time 0.362 (0.326) data 0.283 (0.247) loss_x loss_x 0.3784 (0.3299) acc_x 84.3750 (92.2500) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:905
clean false:6
clean_rate:0.9934138309549945
noisy true:498
noisy false:223
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [160/200] batch [5/28] time 0.350 (0.357) data 0.272 (0.271) loss_x loss_x 0.2795 (0.2825) acc_x 96.8750 (93.7500) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [10/28] time 0.373 (0.364) data 0.296 (0.282) loss_x loss_x 0.2319 (0.3026) acc_x 96.8750 (93.1250) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [15/28] time 0.350 (0.361) data 0.273 (0.281) loss_x loss_x 0.5557 (0.3274) acc_x 87.5000 (92.5000) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [20/28] time 0.312 (0.357) data 0.234 (0.276) loss_x loss_x 0.3035 (0.3218) acc_x 90.6250 (92.3438) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/28] time 0.316 (0.347) data 0.239 (0.268) loss_x loss_x 0.3176 (0.3140) acc_x 90.6250 (92.6250) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:895
clean false:3
clean_rate:0.9966592427616926
noisy true:517
noisy false:217
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [161/200] batch [5/28] time 0.352 (0.385) data 0.274 (0.307) loss_x loss_x 0.2202 (0.3885) acc_x 96.8750 (93.1250) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [10/28] time 0.355 (0.388) data 0.277 (0.299) loss_x loss_x 0.3638 (0.3258) acc_x 93.7500 (94.3750) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [15/28] time 0.367 (0.383) data 0.288 (0.298) loss_x loss_x 0.2389 (0.3477) acc_x 93.7500 (93.1250) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [20/28] time 0.293 (0.377) data 0.216 (0.289) loss_x loss_x 0.5518 (0.3712) acc_x 87.5000 (92.3438) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [25/28] time 0.406 (0.365) data 0.221 (0.275) loss_x loss_x 0.4309 (0.3815) acc_x 87.5000 (91.5000) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:897
clean false:5
clean_rate:0.9944567627494457
noisy true:500
noisy false:230
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [162/200] batch [5/28] time 0.369 (0.373) data 0.291 (0.295) loss_x loss_x 0.1891 (0.2445) acc_x 100.0000 (95.0000) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/28] time 0.339 (0.388) data 0.260 (0.299) loss_x loss_x 0.3330 (0.2540) acc_x 93.7500 (94.3750) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [15/28] time 0.325 (0.369) data 0.248 (0.284) loss_x loss_x 0.1539 (0.2705) acc_x 100.0000 (94.3750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [20/28] time 0.299 (0.357) data 0.222 (0.271) loss_x loss_x 0.4167 (0.2941) acc_x 87.5000 (93.1250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/28] time 0.372 (0.358) data 0.294 (0.273) loss_x loss_x 0.2303 (0.2847) acc_x 100.0000 (93.6250) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 913
clean true:909
clean false:4
clean_rate:0.9956188389923329
noisy true:509
noisy false:210
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 719
epoch [163/200] batch [5/28] time 0.371 (0.375) data 0.293 (0.297) loss_x loss_x 0.4604 (0.3882) acc_x 87.5000 (91.2500) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [10/28] time 0.356 (0.372) data 0.279 (0.291) loss_x loss_x 0.4785 (0.3405) acc_x 90.6250 (92.5000) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [15/28] time 0.377 (0.371) data 0.299 (0.291) loss_x loss_x 0.3462 (0.3553) acc_x 93.7500 (91.6667) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [20/28] time 0.380 (0.373) data 0.302 (0.288) loss_x loss_x 0.2832 (0.3323) acc_x 93.7500 (92.3438) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/28] time 0.344 (0.373) data 0.266 (0.287) loss_x loss_x 0.2798 (0.3223) acc_x 87.5000 (92.3750) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:901
clean false:5
clean_rate:0.9944812362030905
noisy true:506
noisy false:220
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [164/200] batch [5/28] time 0.431 (0.344) data 0.244 (0.244) loss_x loss_x 0.4053 (0.3148) acc_x 90.6250 (91.2500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [10/28] time 0.402 (0.366) data 0.324 (0.277) loss_x loss_x 0.4460 (0.3600) acc_x 84.3750 (90.9375) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/28] time 0.364 (0.366) data 0.286 (0.277) loss_x loss_x 0.2671 (0.3889) acc_x 96.8750 (90.8333) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [20/28] time 0.365 (0.368) data 0.287 (0.282) loss_x loss_x 0.3679 (0.3779) acc_x 84.3750 (90.9375) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/28] time 0.357 (0.367) data 0.280 (0.283) loss_x loss_x 0.3179 (0.3500) acc_x 93.7500 (91.8750) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:922
clean false:4
clean_rate:0.9956803455723542
noisy true:492
noisy false:214
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [165/200] batch [5/28] time 0.362 (0.378) data 0.284 (0.300) loss_x loss_x 0.1023 (0.2654) acc_x 96.8750 (91.8750) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [10/28] time 0.314 (0.384) data 0.236 (0.295) loss_x loss_x 0.1489 (0.2743) acc_x 100.0000 (93.1250) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [15/28] time 0.357 (0.363) data 0.280 (0.277) loss_x loss_x 0.2510 (0.2860) acc_x 93.7500 (92.9167) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/28] time 0.337 (0.359) data 0.259 (0.275) loss_x loss_x 0.1078 (0.2701) acc_x 100.0000 (93.9062) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/28] time 0.344 (0.359) data 0.267 (0.277) loss_x loss_x 0.2266 (0.3065) acc_x 100.0000 (92.6250) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 913
clean true:910
clean false:3
clean_rate:0.9967141292442497
noisy true:508
noisy false:211
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 719
epoch [166/200] batch [5/28] time 0.385 (0.378) data 0.307 (0.300) loss_x loss_x 0.1210 (0.2947) acc_x 100.0000 (93.7500) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [10/28] time 0.362 (0.390) data 0.285 (0.301) loss_x loss_x 0.2908 (0.3358) acc_x 90.6250 (91.5625) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/28] time 0.379 (0.378) data 0.301 (0.293) loss_x loss_x 0.2771 (0.3310) acc_x 93.7500 (92.0833) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [20/28] time 0.328 (0.363) data 0.250 (0.280) loss_x loss_x 0.1908 (0.3085) acc_x 93.7500 (92.8125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/28] time 0.333 (0.359) data 0.256 (0.277) loss_x loss_x 0.3455 (0.3052) acc_x 90.6250 (92.6250) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:910
clean false:2
clean_rate:0.9978070175438597
noisy true:511
noisy false:209
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [167/200] batch [5/28] time 0.383 (0.374) data 0.305 (0.296) loss_x loss_x 0.2727 (0.2862) acc_x 96.8750 (94.3750) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [10/28] time 0.395 (0.382) data 0.318 (0.294) loss_x loss_x 0.2457 (0.3030) acc_x 96.8750 (93.4375) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [15/28] time 0.334 (0.370) data 0.256 (0.285) loss_x loss_x 0.2878 (0.2720) acc_x 93.7500 (94.3750) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [20/28] time 0.328 (0.367) data 0.250 (0.284) loss_x loss_x 0.1287 (0.2931) acc_x 100.0000 (93.5938) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/28] time 0.316 (0.369) data 0.238 (0.283) loss_x loss_x 0.1545 (0.2826) acc_x 96.8750 (93.6250) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:903
clean false:6
clean_rate:0.9933993399339934
noisy true:511
noisy false:212
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [168/200] batch [5/28] time 0.339 (0.325) data 0.262 (0.248) loss_x loss_x 0.4377 (0.4177) acc_x 93.7500 (91.2500) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/28] time 0.414 (0.342) data 0.225 (0.253) loss_x loss_x 0.2681 (0.3816) acc_x 100.0000 (91.8750) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [15/28] time 0.371 (0.332) data 0.294 (0.247) loss_x loss_x 0.3816 (0.3798) acc_x 93.7500 (92.2917) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [20/28] time 0.357 (0.347) data 0.279 (0.260) loss_x loss_x 0.3057 (0.3665) acc_x 93.7500 (92.1875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/28] time 0.378 (0.350) data 0.300 (0.265) loss_x loss_x 0.4490 (0.3661) acc_x 90.6250 (92.0000) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:907
clean false:5
clean_rate:0.9945175438596491
noisy true:507
noisy false:213
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [169/200] batch [5/28] time 0.365 (0.372) data 0.288 (0.295) loss_x loss_x 0.3401 (0.2776) acc_x 93.7500 (95.6250) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [10/28] time 0.306 (0.367) data 0.229 (0.289) loss_x loss_x 0.2729 (0.2428) acc_x 93.7500 (96.2500) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [15/28] time 0.344 (0.347) data 0.265 (0.269) loss_x loss_x 0.3374 (0.2670) acc_x 93.7500 (95.4167) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/28] time 0.305 (0.339) data 0.227 (0.258) loss_x loss_x 0.4773 (0.2851) acc_x 90.6250 (94.8438) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/28] time 0.368 (0.338) data 0.290 (0.256) loss_x loss_x 0.2937 (0.2741) acc_x 93.7500 (94.8750) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 922
clean true:917
clean false:5
clean_rate:0.9945770065075922
noisy true:509
noisy false:201
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 710
epoch [170/200] batch [5/28] time 0.304 (0.346) data 0.226 (0.268) loss_x loss_x 0.1671 (0.3941) acc_x 96.8750 (89.3750) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [10/28] time 0.364 (0.341) data 0.287 (0.263) loss_x loss_x 0.2301 (0.3624) acc_x 100.0000 (91.8750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [15/28] time 0.375 (0.358) data 0.298 (0.273) loss_x loss_x 0.2556 (0.3355) acc_x 93.7500 (92.2917) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [20/28] time 0.391 (0.365) data 0.313 (0.282) loss_x loss_x 0.4265 (0.3499) acc_x 87.5000 (91.4062) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/28] time 0.300 (0.358) data 0.222 (0.276) loss_x loss_x 0.4502 (0.3582) acc_x 90.6250 (91.0000) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:909
clean false:3
clean_rate:0.9967105263157895
noisy true:509
noisy false:211
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [171/200] batch [5/28] time 0.357 (0.371) data 0.279 (0.286) loss_x loss_x 0.3191 (0.2960) acc_x 87.5000 (90.0000) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [10/28] time 0.352 (0.369) data 0.274 (0.287) loss_x loss_x 0.4001 (0.3452) acc_x 93.7500 (90.3125) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [15/28] time 0.354 (0.359) data 0.276 (0.279) loss_x loss_x 0.0789 (0.2920) acc_x 100.0000 (92.9167) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [20/28] time 0.343 (0.358) data 0.266 (0.275) loss_x loss_x 0.2399 (0.2822) acc_x 93.7500 (92.9688) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/28] time 0.304 (0.356) data 0.226 (0.274) loss_x loss_x 0.4399 (0.3257) acc_x 93.7500 (92.2500) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.5607, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 915
clean true:911
clean false:4
clean_rate:0.9956284153005465
noisy true:506
noisy false:211
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 717
epoch [172/200] batch [5/28] time 0.369 (0.365) data 0.291 (0.287) loss_x loss_x 0.3713 (0.3199) acc_x 96.8750 (93.7500) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [10/28] time 0.446 (0.370) data 0.306 (0.286) loss_x loss_x 0.2184 (0.3199) acc_x 96.8750 (93.4375) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [15/28] time 0.372 (0.365) data 0.294 (0.283) loss_x loss_x 0.1731 (0.2917) acc_x 90.6250 (93.5417) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/28] time 0.304 (0.358) data 0.226 (0.277) loss_x loss_x 0.3245 (0.2984) acc_x 93.7500 (93.2812) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/28] time 0.377 (0.355) data 0.300 (0.270) loss_x loss_x 0.1671 (0.2847) acc_x 100.0000 (94.0000) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.5692, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 929
clean true:923
clean false:6
clean_rate:0.9935414424111948
noisy true:515
noisy false:188
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 703
epoch [173/200] batch [5/29] time 0.418 (0.377) data 0.340 (0.300) loss_x loss_x 0.3315 (0.3742) acc_x 93.7500 (92.5000) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [10/29] time 0.483 (0.384) data 0.296 (0.295) loss_x loss_x 0.6011 (0.3849) acc_x 90.6250 (92.5000) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [15/29] time 0.398 (0.384) data 0.321 (0.299) loss_x loss_x 0.2913 (0.3891) acc_x 93.7500 (92.2917) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [20/29] time 0.345 (0.382) data 0.267 (0.294) loss_x loss_x 0.1213 (0.3502) acc_x 100.0000 (92.8125) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [25/29] time 0.344 (0.376) data 0.267 (0.290) loss_x loss_x 0.3906 (0.3751) acc_x 93.7500 (92.7500) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 210
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:909
clean false:3
clean_rate:0.9967105263157895
noisy true:513
noisy false:207
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [174/200] batch [5/28] time 0.322 (0.347) data 0.245 (0.250) loss_x loss_x 0.4705 (0.3494) acc_x 84.3750 (90.0000) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [10/28] time 0.385 (0.346) data 0.307 (0.259) loss_x loss_x 0.4148 (0.3577) acc_x 93.7500 (91.8750) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [15/28] time 0.450 (0.358) data 0.290 (0.268) loss_x loss_x 0.2451 (0.3301) acc_x 93.7500 (92.9167) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [20/28] time 0.407 (0.361) data 0.329 (0.275) loss_x loss_x 0.2247 (0.3392) acc_x 96.8750 (92.8125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/28] time 0.355 (0.363) data 0.277 (0.278) loss_x loss_x 0.2520 (0.3268) acc_x 93.7500 (93.0000) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 208
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 917
clean true:913
clean false:4
clean_rate:0.9956379498364231
noisy true:511
noisy false:204
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 715
epoch [175/200] batch [5/28] time 0.334 (0.367) data 0.257 (0.290) loss_x loss_x 0.6118 (0.3401) acc_x 78.1250 (90.6250) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [10/28] time 0.362 (0.375) data 0.284 (0.286) loss_x loss_x 0.5112 (0.3347) acc_x 93.7500 (93.1250) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [15/28] time 0.356 (0.369) data 0.279 (0.285) loss_x loss_x 0.3198 (0.3120) acc_x 90.6250 (93.3333) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [20/28] time 0.344 (0.368) data 0.267 (0.280) loss_x loss_x 0.2964 (0.3054) acc_x 93.7500 (93.5938) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/28] time 0.377 (0.367) data 0.299 (0.281) loss_x loss_x 0.2888 (0.3102) acc_x 96.8750 (93.7500) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:913
clean false:6
clean_rate:0.9934711643090316
noisy true:512
noisy false:201
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [176/200] batch [5/28] time 0.336 (0.354) data 0.259 (0.276) loss_x loss_x 0.3098 (0.2178) acc_x 90.6250 (95.6250) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [10/28] time 0.347 (0.356) data 0.270 (0.278) loss_x loss_x 0.2130 (0.2623) acc_x 100.0000 (94.6875) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [15/28] time 0.349 (0.353) data 0.271 (0.276) loss_x loss_x 0.1975 (0.3098) acc_x 96.8750 (93.5417) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [20/28] time 0.347 (0.352) data 0.270 (0.274) loss_x loss_x 0.2695 (0.3206) acc_x 93.7500 (92.9688) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/28] time 0.343 (0.350) data 0.266 (0.272) loss_x loss_x 0.3123 (0.3166) acc_x 90.6250 (92.7500) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:899
clean false:6
clean_rate:0.9933701657458563
noisy true:508
noisy false:219
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [177/200] batch [5/28] time 0.360 (0.352) data 0.282 (0.274) loss_x loss_x 0.3762 (0.2289) acc_x 90.6250 (95.6250) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/28] time 0.354 (0.356) data 0.277 (0.278) loss_x loss_x 0.2299 (0.2951) acc_x 93.7500 (94.0625) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [15/28] time 0.348 (0.353) data 0.271 (0.275) loss_x loss_x 0.1539 (0.2887) acc_x 96.8750 (93.9583) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [20/28] time 0.333 (0.351) data 0.256 (0.274) loss_x loss_x 0.2905 (0.3072) acc_x 96.8750 (93.4375) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/28] time 0.345 (0.349) data 0.268 (0.272) loss_x loss_x 0.2216 (0.2906) acc_x 96.8750 (94.0000) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:912
clean false:6
clean_rate:0.9934640522875817
noisy true:508
noisy false:206
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [178/200] batch [5/28] time 0.344 (0.354) data 0.266 (0.277) loss_x loss_x 0.4368 (0.4930) acc_x 87.5000 (88.7500) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [10/28] time 0.348 (0.355) data 0.270 (0.278) loss_x loss_x 0.4216 (0.4019) acc_x 90.6250 (91.5625) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [15/28] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.1470 (0.3984) acc_x 96.8750 (91.4583) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [20/28] time 0.328 (0.347) data 0.250 (0.269) loss_x loss_x 0.2524 (0.3641) acc_x 93.7500 (92.1875) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/28] time 0.331 (0.342) data 0.254 (0.265) loss_x loss_x 0.2998 (0.3547) acc_x 93.7500 (92.3750) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:908
clean false:6
clean_rate:0.9934354485776805
noisy true:494
noisy false:224
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [179/200] batch [5/28] time 0.347 (0.355) data 0.270 (0.278) loss_x loss_x 0.4636 (0.3212) acc_x 90.6250 (93.1250) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [10/28] time 0.351 (0.350) data 0.273 (0.273) loss_x loss_x 0.3711 (0.3246) acc_x 93.7500 (94.0625) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [15/28] time 0.307 (0.346) data 0.229 (0.268) loss_x loss_x 0.2683 (0.3462) acc_x 93.7500 (92.2917) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [20/28] time 0.354 (0.345) data 0.277 (0.267) loss_x loss_x 0.4553 (0.3453) acc_x 90.6250 (91.8750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/28] time 0.359 (0.346) data 0.282 (0.269) loss_x loss_x 0.4673 (0.3478) acc_x 90.6250 (92.1250) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 203
confident_label rate tensor(0.5662, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 924
clean true:921
clean false:3
clean_rate:0.9967532467532467
noisy true:508
noisy false:200
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 708
epoch [180/200] batch [5/28] time 0.347 (0.345) data 0.270 (0.268) loss_x loss_x 0.2498 (0.3088) acc_x 96.8750 (94.3750) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [10/28] time 0.301 (0.337) data 0.223 (0.260) loss_x loss_x 0.2322 (0.2930) acc_x 96.8750 (92.5000) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [15/28] time 0.343 (0.330) data 0.266 (0.252) loss_x loss_x 0.2015 (0.2996) acc_x 96.8750 (92.5000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [20/28] time 0.354 (0.332) data 0.275 (0.255) loss_x loss_x 0.5498 (0.3032) acc_x 84.3750 (92.3438) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/28] time 0.347 (0.336) data 0.270 (0.258) loss_x loss_x 0.3018 (0.3077) acc_x 90.6250 (92.8750) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.5643, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 921
clean true:918
clean false:3
clean_rate:0.996742671009772
noisy true:516
noisy false:195
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 711
epoch [181/200] batch [5/28] time 0.341 (0.340) data 0.263 (0.262) loss_x loss_x 0.2532 (0.3609) acc_x 93.7500 (90.0000) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [10/28] time 0.291 (0.318) data 0.212 (0.240) loss_x loss_x 0.5010 (0.3642) acc_x 87.5000 (91.5625) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [15/28] time 0.333 (0.320) data 0.255 (0.242) loss_x loss_x 0.4058 (0.3505) acc_x 87.5000 (91.4583) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [20/28] time 0.343 (0.327) data 0.266 (0.250) loss_x loss_x 0.1478 (0.3123) acc_x 96.8750 (92.3438) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/28] time 0.331 (0.330) data 0.253 (0.253) loss_x loss_x 0.3064 (0.3246) acc_x 87.5000 (91.8750) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 205
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 920
clean true:915
clean false:5
clean_rate:0.9945652173913043
noisy true:512
noisy false:200
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 712
epoch [182/200] batch [5/28] time 0.308 (0.333) data 0.230 (0.256) loss_x loss_x 0.3262 (0.3348) acc_x 96.8750 (93.1250) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [10/28] time 0.340 (0.325) data 0.262 (0.247) loss_x loss_x 0.2693 (0.2959) acc_x 90.6250 (93.7500) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [15/28] time 0.346 (0.328) data 0.269 (0.250) loss_x loss_x 0.4197 (0.2908) acc_x 90.6250 (93.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [20/28] time 0.334 (0.328) data 0.256 (0.250) loss_x loss_x 0.5298 (0.3134) acc_x 87.5000 (93.1250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/28] time 0.343 (0.331) data 0.266 (0.254) loss_x loss_x 0.4028 (0.3155) acc_x 90.6250 (92.7500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:929
clean false:3
clean_rate:0.9967811158798283
noisy true:505
noisy false:195
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [183/200] batch [5/29] time 0.343 (0.358) data 0.266 (0.281) loss_x loss_x 0.3296 (0.3012) acc_x 96.8750 (93.7500) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [10/29] time 0.338 (0.356) data 0.260 (0.278) loss_x loss_x 0.3108 (0.3071) acc_x 90.6250 (92.8125) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [15/29] time 0.348 (0.353) data 0.271 (0.275) loss_x loss_x 0.1545 (0.3031) acc_x 96.8750 (92.7083) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [20/29] time 0.384 (0.350) data 0.306 (0.272) loss_x loss_x 0.5127 (0.3225) acc_x 87.5000 (92.0312) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [25/29] time 0.310 (0.347) data 0.232 (0.270) loss_x loss_x 0.3206 (0.3230) acc_x 90.6250 (92.2500) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 208
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 922
clean true:918
clean false:4
clean_rate:0.9956616052060737
noisy true:506
noisy false:204
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 710
epoch [184/200] batch [5/28] time 0.344 (0.344) data 0.266 (0.267) loss_x loss_x 0.2397 (0.1951) acc_x 96.8750 (97.5000) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [10/28] time 0.343 (0.343) data 0.266 (0.266) loss_x loss_x 0.4041 (0.2494) acc_x 93.7500 (96.2500) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [15/28] time 0.312 (0.335) data 0.235 (0.257) loss_x loss_x 0.1321 (0.2950) acc_x 100.0000 (94.1667) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [20/28] time 0.339 (0.335) data 0.262 (0.258) loss_x loss_x 0.1398 (0.3034) acc_x 100.0000 (93.9062) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/28] time 0.331 (0.337) data 0.254 (0.260) loss_x loss_x 0.4111 (0.3281) acc_x 87.5000 (92.7500) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:905
clean false:4
clean_rate:0.9955995599559956
noisy true:502
noisy false:221
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [185/200] batch [5/28] time 0.351 (0.358) data 0.274 (0.280) loss_x loss_x 0.3318 (0.3437) acc_x 90.6250 (91.2500) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [10/28] time 0.363 (0.346) data 0.286 (0.268) loss_x loss_x 0.3264 (0.3001) acc_x 96.8750 (93.4375) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [15/28] time 0.364 (0.347) data 0.287 (0.269) loss_x loss_x 0.3228 (0.3134) acc_x 90.6250 (92.5000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [20/28] time 0.338 (0.346) data 0.261 (0.268) loss_x loss_x 0.4004 (0.2974) acc_x 93.7500 (93.4375) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/28] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.2815 (0.3008) acc_x 93.7500 (93.6250) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:914
clean false:5
clean_rate:0.9945593035908596
noisy true:511
noisy false:202
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [186/200] batch [5/28] time 0.345 (0.343) data 0.268 (0.266) loss_x loss_x 0.3479 (0.2551) acc_x 93.7500 (95.6250) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [10/28] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.1788 (0.2965) acc_x 96.8750 (94.0625) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [15/28] time 0.333 (0.332) data 0.256 (0.255) loss_x loss_x 0.7412 (0.3512) acc_x 81.2500 (92.0833) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [20/28] time 0.336 (0.333) data 0.259 (0.256) loss_x loss_x 0.4880 (0.3743) acc_x 90.6250 (91.7188) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/28] time 0.349 (0.336) data 0.271 (0.258) loss_x loss_x 0.2206 (0.3402) acc_x 96.8750 (92.8750) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:892
clean false:6
clean_rate:0.9933184855233853
noisy true:512
noisy false:222
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [187/200] batch [5/28] time 0.352 (0.353) data 0.274 (0.275) loss_x loss_x 0.4507 (0.4259) acc_x 96.8750 (90.0000) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [10/28] time 0.349 (0.352) data 0.272 (0.274) loss_x loss_x 0.0858 (0.3392) acc_x 100.0000 (90.9375) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [15/28] time 0.315 (0.340) data 0.237 (0.263) loss_x loss_x 0.1411 (0.3409) acc_x 100.0000 (91.4583) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [20/28] time 0.356 (0.338) data 0.279 (0.261) loss_x loss_x 0.1224 (0.3081) acc_x 96.8750 (92.6562) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/28] time 0.338 (0.340) data 0.261 (0.262) loss_x loss_x 0.1832 (0.3086) acc_x 93.7500 (92.6250) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:913
clean false:6
clean_rate:0.9934711643090316
noisy true:495
noisy false:218
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [188/200] batch [5/28] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.5293 (0.2532) acc_x 78.1250 (94.3750) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [10/28] time 0.335 (0.345) data 0.258 (0.268) loss_x loss_x 0.1206 (0.2657) acc_x 96.8750 (94.3750) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [15/28] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.1564 (0.2786) acc_x 96.8750 (94.5833) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [20/28] time 0.361 (0.345) data 0.284 (0.268) loss_x loss_x 0.1606 (0.2982) acc_x 96.8750 (93.5938) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/28] time 0.339 (0.344) data 0.261 (0.266) loss_x loss_x 0.2285 (0.2917) acc_x 96.8750 (94.1250) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:907
clean false:4
clean_rate:0.995609220636663
noisy true:498
noisy false:223
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [189/200] batch [5/28] time 0.354 (0.343) data 0.277 (0.266) loss_x loss_x 0.3516 (0.2593) acc_x 87.5000 (94.3750) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [10/28] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.4751 (0.3076) acc_x 87.5000 (93.4375) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [15/28] time 0.354 (0.344) data 0.277 (0.266) loss_x loss_x 0.1058 (0.2916) acc_x 100.0000 (93.9583) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [20/28] time 0.334 (0.342) data 0.256 (0.265) loss_x loss_x 0.1362 (0.2821) acc_x 96.8750 (94.2188) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/28] time 0.331 (0.341) data 0.254 (0.263) loss_x loss_x 0.6055 (0.2964) acc_x 81.2500 (93.6250) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:905
clean false:4
clean_rate:0.9955995599559956
noisy true:513
noisy false:210
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [190/200] batch [5/28] time 0.347 (0.338) data 0.270 (0.260) loss_x loss_x 0.1981 (0.2449) acc_x 96.8750 (95.0000) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [10/28] time 0.344 (0.341) data 0.267 (0.264) loss_x loss_x 0.4465 (0.3464) acc_x 90.6250 (93.1250) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [15/28] time 0.290 (0.334) data 0.212 (0.257) loss_x loss_x 0.1594 (0.3152) acc_x 96.8750 (93.1250) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [20/28] time 0.331 (0.332) data 0.254 (0.255) loss_x loss_x 0.3660 (0.3328) acc_x 90.6250 (92.3438) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/28] time 0.331 (0.331) data 0.254 (0.254) loss_x loss_x 0.3535 (0.3445) acc_x 90.6250 (92.1250) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.5717, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 933
clean true:926
clean false:7
clean_rate:0.992497320471597
noisy true:517
noisy false:182
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 699
epoch [191/200] batch [5/29] time 0.313 (0.308) data 0.236 (0.231) loss_x loss_x 0.3582 (0.2454) acc_x 87.5000 (93.7500) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [10/29] time 0.343 (0.320) data 0.266 (0.242) loss_x loss_x 0.5239 (0.2848) acc_x 87.5000 (92.1875) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [15/29] time 0.354 (0.321) data 0.277 (0.243) loss_x loss_x 0.2134 (0.2953) acc_x 100.0000 (92.9167) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [20/29] time 0.357 (0.326) data 0.279 (0.249) loss_x loss_x 0.2092 (0.2992) acc_x 96.8750 (93.2812) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/29] time 0.346 (0.329) data 0.269 (0.252) loss_x loss_x 0.3047 (0.3512) acc_x 93.7500 (92.2500) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 916
clean true:910
clean false:6
clean_rate:0.9934497816593887
noisy true:510
noisy false:206
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 716
epoch [192/200] batch [5/28] time 0.300 (0.300) data 0.222 (0.222) loss_x loss_x 0.1715 (0.3205) acc_x 100.0000 (93.7500) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [10/28] time 0.331 (0.312) data 0.253 (0.234) loss_x loss_x 0.4568 (0.3336) acc_x 87.5000 (92.8125) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [15/28] time 0.344 (0.319) data 0.266 (0.242) loss_x loss_x 0.3848 (0.3311) acc_x 90.6250 (92.7083) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [20/28] time 0.344 (0.324) data 0.267 (0.247) loss_x loss_x 0.3218 (0.3572) acc_x 93.7500 (91.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/28] time 0.347 (0.329) data 0.270 (0.252) loss_x loss_x 0.4553 (0.3495) acc_x 87.5000 (92.1250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 205
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 925
clean true:920
clean false:5
clean_rate:0.9945945945945946
noisy true:507
noisy false:200
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 707
epoch [193/200] batch [5/28] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.5264 (0.2575) acc_x 84.3750 (95.0000) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [10/28] time 0.346 (0.339) data 0.269 (0.261) loss_x loss_x 0.4019 (0.3115) acc_x 90.6250 (93.1250) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [15/28] time 0.337 (0.342) data 0.259 (0.264) loss_x loss_x 0.1653 (0.3035) acc_x 100.0000 (94.1667) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [20/28] time 0.330 (0.342) data 0.253 (0.264) loss_x loss_x 0.4524 (0.3299) acc_x 90.6250 (93.5938) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/28] time 0.346 (0.340) data 0.269 (0.263) loss_x loss_x 0.2729 (0.3290) acc_x 93.7500 (93.2500) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.5643, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 921
clean true:918
clean false:3
clean_rate:0.996742671009772
noisy true:510
noisy false:201
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 711
epoch [194/200] batch [5/28] time 0.338 (0.344) data 0.262 (0.267) loss_x loss_x 0.3979 (0.2745) acc_x 90.6250 (94.3750) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [10/28] time 0.345 (0.344) data 0.267 (0.267) loss_x loss_x 0.4470 (0.3112) acc_x 90.6250 (93.7500) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [15/28] time 0.354 (0.345) data 0.277 (0.268) loss_x loss_x 0.3225 (0.2984) acc_x 90.6250 (93.5417) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [20/28] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 0.1870 (0.3067) acc_x 100.0000 (93.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/28] time 0.334 (0.343) data 0.257 (0.266) loss_x loss_x 0.3862 (0.3254) acc_x 90.6250 (93.0000) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.5717, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 933
clean true:929
clean false:4
clean_rate:0.9957127545551983
noisy true:512
noisy false:187
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 699
epoch [195/200] batch [5/29] time 0.341 (0.356) data 0.264 (0.278) loss_x loss_x 0.3071 (0.3274) acc_x 96.8750 (93.7500) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/29] time 0.323 (0.346) data 0.245 (0.268) loss_x loss_x 0.2817 (0.3052) acc_x 90.6250 (93.1250) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [15/29] time 0.350 (0.346) data 0.273 (0.268) loss_x loss_x 0.1836 (0.3128) acc_x 96.8750 (93.1250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [20/29] time 0.340 (0.345) data 0.263 (0.268) loss_x loss_x 0.4915 (0.3212) acc_x 84.3750 (92.5000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [25/29] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.2742 (0.3343) acc_x 93.7500 (92.6250) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 920
clean true:915
clean false:5
clean_rate:0.9945652173913043
noisy true:506
noisy false:206
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 712
epoch [196/200] batch [5/28] time 0.374 (0.354) data 0.297 (0.277) loss_x loss_x 0.3362 (0.4021) acc_x 93.7500 (93.1250) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [10/28] time 0.345 (0.353) data 0.268 (0.276) loss_x loss_x 0.4436 (0.3525) acc_x 93.7500 (93.1250) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [15/28] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.1448 (0.3588) acc_x 100.0000 (92.0833) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [20/28] time 0.347 (0.349) data 0.269 (0.272) loss_x loss_x 0.2037 (0.3437) acc_x 93.7500 (92.6562) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/28] time 0.336 (0.347) data 0.259 (0.269) loss_x loss_x 0.2888 (0.3547) acc_x 96.8750 (92.7500) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 920
clean true:917
clean false:3
clean_rate:0.9967391304347826
noisy true:515
noisy false:197
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 712
epoch [197/200] batch [5/28] time 0.329 (0.351) data 0.251 (0.273) loss_x loss_x 0.1631 (0.1746) acc_x 100.0000 (97.5000) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [10/28] time 0.339 (0.352) data 0.262 (0.274) loss_x loss_x 0.6416 (0.2802) acc_x 87.5000 (93.4375) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [15/28] time 0.349 (0.349) data 0.271 (0.271) loss_x loss_x 0.7007 (0.3112) acc_x 90.6250 (93.3333) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [20/28] time 0.337 (0.346) data 0.260 (0.269) loss_x loss_x 0.1642 (0.2937) acc_x 100.0000 (93.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/28] time 0.340 (0.343) data 0.263 (0.265) loss_x loss_x 0.2092 (0.2777) acc_x 96.8750 (94.0000) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 916
clean true:912
clean false:4
clean_rate:0.9956331877729258
noisy true:514
noisy false:202
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 716
epoch [198/200] batch [5/28] time 0.323 (0.337) data 0.245 (0.259) loss_x loss_x 0.2280 (0.3424) acc_x 93.7500 (90.0000) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [10/28] time 0.334 (0.337) data 0.257 (0.260) loss_x loss_x 0.4165 (0.3067) acc_x 90.6250 (92.1875) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [15/28] time 0.297 (0.326) data 0.219 (0.249) loss_x loss_x 0.1802 (0.2966) acc_x 96.8750 (91.8750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [20/28] time 0.343 (0.325) data 0.265 (0.248) loss_x loss_x 0.2539 (0.2903) acc_x 93.7500 (92.3438) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/28] time 0.344 (0.330) data 0.267 (0.252) loss_x loss_x 0.2118 (0.2840) acc_x 96.8750 (92.5000) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:894
clean false:5
clean_rate:0.9944382647385984
noisy true:519
noisy false:214
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [199/200] batch [5/28] time 0.350 (0.353) data 0.273 (0.275) loss_x loss_x 0.4067 (0.3111) acc_x 93.7500 (93.1250) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [10/28] time 0.343 (0.345) data 0.265 (0.268) loss_x loss_x 0.2032 (0.3167) acc_x 96.8750 (93.1250) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [15/28] time 0.326 (0.334) data 0.249 (0.257) loss_x loss_x 0.4451 (0.3261) acc_x 93.7500 (92.7083) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [20/28] time 0.355 (0.336) data 0.277 (0.258) loss_x loss_x 0.3015 (0.3162) acc_x 96.8750 (93.1250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/28] time 0.351 (0.338) data 0.273 (0.261) loss_x loss_x 0.2401 (0.3123) acc_x 96.8750 (93.2500) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:899
clean false:3
clean_rate:0.9966740576496674
noisy true:508
noisy false:222
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [200/200] batch [5/28] time 0.303 (0.323) data 0.225 (0.244) loss_x loss_x 0.1901 (0.2457) acc_x 100.0000 (95.0000) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [10/28] time 0.320 (0.324) data 0.243 (0.246) loss_x loss_x 0.3264 (0.3201) acc_x 87.5000 (92.1875) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [15/28] time 0.334 (0.328) data 0.257 (0.250) loss_x loss_x 0.2294 (0.3398) acc_x 93.7500 (92.0833) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [20/28] time 0.335 (0.330) data 0.258 (0.253) loss_x loss_x 0.3213 (0.3339) acc_x 90.6250 (91.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/28] time 0.338 (0.331) data 0.258 (0.253) loss_x loss_x 0.3450 (0.3457) acc_x 87.5000 (91.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,214
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 88.4%
Elapsed: 1:38:09
