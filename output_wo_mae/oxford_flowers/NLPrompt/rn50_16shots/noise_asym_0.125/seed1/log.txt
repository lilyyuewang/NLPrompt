***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.2010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 328
clean true:326
clean false:2
clean_rate:0.9939024390243902
noisy true:49
noisy false:1255
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1304
epoch [1/200] batch [5/10] time 0.295 (0.323) data 0.217 (0.227) loss_x loss_x 3.0273 (2.7855) acc_x 31.2500 (35.0000) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/10] time 0.335 (0.323) data 0.257 (0.235) loss_x loss_x 2.3008 (2.5811) acc_x 46.8750 (40.0000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1123
confident_label rate tensor(0.2727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 445
clean true:442
clean false:3
clean_rate:0.9932584269662922
noisy true:67
noisy false:1120
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1187
epoch [2/200] batch [5/13] time 0.339 (0.318) data 0.261 (0.240) loss_x loss_x 0.8340 (1.1547) acc_x 81.2500 (76.2500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/13] time 0.351 (0.331) data 0.272 (0.253) loss_x loss_x 0.9966 (1.0999) acc_x 81.2500 (74.0625) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 770
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:753
clean false:2
clean_rate:0.9973509933774835
noisy true:109
noisy false:768
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [3/200] batch [5/23] time 0.358 (0.328) data 0.281 (0.250) loss_x loss_x 0.8525 (0.7246) acc_x 78.1250 (81.8750) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/23] time 0.348 (0.343) data 0.270 (0.265) loss_x loss_x 0.6646 (0.6706) acc_x 81.2500 (83.7500) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/23] time 0.324 (0.341) data 0.246 (0.264) loss_x loss_x 1.0537 (0.7671) acc_x 68.7500 (81.2500) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/23] time 0.346 (0.343) data 0.267 (0.266) loss_x loss_x 1.2090 (0.8710) acc_x 81.2500 (79.6875) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 733
confident_label rate tensor(0.4816, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 786
clean true:785
clean false:1
clean_rate:0.9987277353689568
noisy true:114
noisy false:732
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 846
epoch [4/200] batch [5/24] time 0.358 (0.360) data 0.280 (0.283) loss_x loss_x 0.9883 (0.9142) acc_x 81.2500 (81.8750) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/24] time 0.353 (0.358) data 0.276 (0.280) loss_x loss_x 0.7793 (0.8773) acc_x 81.2500 (80.6250) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [15/24] time 0.332 (0.354) data 0.254 (0.276) loss_x loss_x 0.8330 (0.8137) acc_x 84.3750 (82.5000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [20/24] time 0.350 (0.351) data 0.272 (0.273) loss_x loss_x 0.8315 (0.8314) acc_x 81.2500 (80.9375) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 722
confident_label rate tensor(0.4865, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 794
clean true:792
clean false:2
clean_rate:0.9974811083123426
noisy true:118
noisy false:720
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 838
epoch [5/200] batch [5/24] time 0.345 (0.343) data 0.266 (0.265) loss_x loss_x 1.1113 (0.9310) acc_x 71.8750 (76.8750) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [10/24] time 0.327 (0.331) data 0.249 (0.254) loss_x loss_x 0.5742 (0.7916) acc_x 87.5000 (80.9375) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/24] time 0.352 (0.330) data 0.275 (0.253) loss_x loss_x 0.5913 (0.7915) acc_x 87.5000 (80.2083) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/24] time 0.342 (0.334) data 0.264 (0.256) loss_x loss_x 0.7471 (0.7781) acc_x 78.1250 (81.2500) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 720
confident_label rate tensor(0.4957, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 809
clean true:808
clean false:1
clean_rate:0.9987639060568603
noisy true:104
noisy false:719
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 823
epoch [6/200] batch [5/25] time 0.350 (0.335) data 0.272 (0.257) loss_x loss_x 0.7773 (0.6651) acc_x 81.2500 (83.1250) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/25] time 0.351 (0.344) data 0.274 (0.266) loss_x loss_x 0.6396 (0.6365) acc_x 81.2500 (84.6875) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/25] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.4258 (0.6571) acc_x 90.6250 (84.1667) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/25] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 0.8306 (0.6581) acc_x 84.3750 (84.6875) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/25] time 0.341 (0.344) data 0.264 (0.267) loss_x loss_x 0.4756 (0.6586) acc_x 93.7500 (85.0000) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 688
confident_label rate tensor(0.5116, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 835
clean true:833
clean false:2
clean_rate:0.9976047904191617
noisy true:111
noisy false:686
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 797
epoch [7/200] batch [5/26] time 0.343 (0.351) data 0.265 (0.273) loss_x loss_x 0.5723 (0.7197) acc_x 84.3750 (81.8750) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [10/26] time 0.353 (0.347) data 0.276 (0.270) loss_x loss_x 0.5713 (0.7417) acc_x 87.5000 (81.2500) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/26] time 0.292 (0.336) data 0.214 (0.258) loss_x loss_x 0.6221 (0.7217) acc_x 87.5000 (81.2500) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/26] time 0.357 (0.331) data 0.280 (0.254) loss_x loss_x 0.3774 (0.6993) acc_x 96.8750 (82.5000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/26] time 0.340 (0.333) data 0.262 (0.256) loss_x loss_x 0.7852 (0.7109) acc_x 81.2500 (82.8750) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 702
confident_label rate tensor(0.5018, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 819
clean true:818
clean false:1
clean_rate:0.9987789987789988
noisy true:112
noisy false:701
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 813
epoch [8/200] batch [5/25] time 0.391 (0.370) data 0.313 (0.292) loss_x loss_x 1.2070 (0.7835) acc_x 65.6250 (81.2500) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [10/25] time 0.380 (0.374) data 0.302 (0.296) loss_x loss_x 0.6577 (0.7515) acc_x 81.2500 (81.2500) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/25] time 0.334 (0.363) data 0.256 (0.286) loss_x loss_x 0.7109 (0.7171) acc_x 90.6250 (81.6667) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/25] time 0.353 (0.360) data 0.274 (0.282) loss_x loss_x 1.1553 (0.7717) acc_x 71.8750 (80.3125) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/25] time 0.326 (0.357) data 0.249 (0.279) loss_x loss_x 0.4888 (0.7706) acc_x 87.5000 (81.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 670
confident_label rate tensor(0.5147, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 840
clean true:837
clean false:3
clean_rate:0.9964285714285714
noisy true:125
noisy false:667
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 792
epoch [9/200] batch [5/26] time 0.301 (0.315) data 0.223 (0.237) loss_x loss_x 1.0645 (0.8185) acc_x 84.3750 (79.3750) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [10/26] time 0.357 (0.325) data 0.280 (0.247) loss_x loss_x 0.6772 (0.7454) acc_x 84.3750 (81.8750) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/26] time 0.370 (0.334) data 0.292 (0.256) loss_x loss_x 1.0029 (0.7615) acc_x 75.0000 (81.2500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/26] time 0.358 (0.337) data 0.280 (0.259) loss_x loss_x 0.4973 (0.7326) acc_x 87.5000 (82.3438) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/26] time 0.358 (0.342) data 0.281 (0.264) loss_x loss_x 0.3933 (0.7222) acc_x 90.6250 (82.6250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 678
confident_label rate tensor(0.5110, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 834
clean true:833
clean false:1
clean_rate:0.9988009592326139
noisy true:121
noisy false:677
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 798
epoch [10/200] batch [5/26] time 0.347 (0.374) data 0.269 (0.297) loss_x loss_x 0.5913 (0.6142) acc_x 87.5000 (86.8750) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [10/26] time 0.346 (0.361) data 0.267 (0.284) loss_x loss_x 0.4810 (0.6131) acc_x 90.6250 (85.9375) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/26] time 0.365 (0.358) data 0.287 (0.281) loss_x loss_x 0.5913 (0.6243) acc_x 81.2500 (85.4167) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/26] time 0.304 (0.352) data 0.226 (0.274) loss_x loss_x 0.6772 (0.6911) acc_x 87.5000 (84.5312) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/26] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.7275 (0.7098) acc_x 75.0000 (83.5000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 664
confident_label rate tensor(0.5214, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 851
clean true:848
clean false:3
clean_rate:0.9964747356051704
noisy true:120
noisy false:661
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 781
epoch [11/200] batch [5/26] time 0.367 (0.366) data 0.290 (0.288) loss_x loss_x 0.3440 (0.5609) acc_x 90.6250 (85.0000) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [10/26] time 0.347 (0.356) data 0.269 (0.278) loss_x loss_x 0.4634 (0.5779) acc_x 93.7500 (85.9375) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/26] time 0.353 (0.353) data 0.276 (0.275) loss_x loss_x 0.9355 (0.6240) acc_x 71.8750 (85.2083) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/26] time 0.357 (0.355) data 0.280 (0.277) loss_x loss_x 0.4216 (0.6067) acc_x 93.7500 (85.9375) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/26] time 0.338 (0.354) data 0.261 (0.276) loss_x loss_x 0.7847 (0.6179) acc_x 75.0000 (85.5000) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 624
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:890
clean false:1
clean_rate:0.9988776655443322
noisy true:118
noisy false:623
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [12/200] batch [5/27] time 0.313 (0.312) data 0.236 (0.234) loss_x loss_x 0.5391 (0.6462) acc_x 87.5000 (83.7500) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/27] time 0.343 (0.316) data 0.266 (0.238) loss_x loss_x 0.6543 (0.6522) acc_x 78.1250 (82.5000) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/27] time 0.349 (0.327) data 0.271 (0.250) loss_x loss_x 0.5742 (0.6105) acc_x 81.2500 (82.9167) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/27] time 0.354 (0.332) data 0.277 (0.254) loss_x loss_x 0.7578 (0.6778) acc_x 71.8750 (81.4062) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/27] time 0.348 (0.336) data 0.270 (0.258) loss_x loss_x 0.6729 (0.6799) acc_x 81.2500 (81.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 634
confident_label rate tensor(0.5343, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 872
clean true:871
clean false:1
clean_rate:0.9988532110091743
noisy true:127
noisy false:633
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 760
epoch [13/200] batch [5/27] time 0.324 (0.325) data 0.247 (0.247) loss_x loss_x 0.5776 (0.6684) acc_x 84.3750 (83.1250) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [10/27] time 0.343 (0.330) data 0.266 (0.253) loss_x loss_x 0.5532 (0.6444) acc_x 87.5000 (84.6875) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/27] time 0.349 (0.336) data 0.272 (0.258) loss_x loss_x 0.6626 (0.6410) acc_x 84.3750 (85.0000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/27] time 0.353 (0.338) data 0.276 (0.261) loss_x loss_x 0.5396 (0.6301) acc_x 87.5000 (85.6250) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/27] time 0.355 (0.340) data 0.278 (0.262) loss_x loss_x 0.5825 (0.6436) acc_x 90.6250 (85.2500) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 637
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 867
clean true:865
clean false:2
clean_rate:0.9976931949250288
noisy true:130
noisy false:635
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 765
epoch [14/200] batch [5/27] time 0.355 (0.355) data 0.277 (0.277) loss_x loss_x 0.4041 (0.5104) acc_x 90.6250 (88.1250) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [10/27] time 0.349 (0.353) data 0.272 (0.275) loss_x loss_x 0.6748 (0.6168) acc_x 81.2500 (85.3125) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [15/27] time 0.349 (0.351) data 0.271 (0.273) loss_x loss_x 0.7002 (0.6196) acc_x 87.5000 (85.4167) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/27] time 0.359 (0.351) data 0.281 (0.273) loss_x loss_x 0.7783 (0.6527) acc_x 81.2500 (83.9062) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/27] time 0.341 (0.350) data 0.264 (0.272) loss_x loss_x 0.9668 (0.6626) acc_x 75.0000 (83.8750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 626
confident_label rate tensor(0.5392, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 880
clean true:880
clean false:0
clean_rate:1.0
noisy true:126
noisy false:626
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 752
epoch [15/200] batch [5/27] time 0.344 (0.352) data 0.267 (0.274) loss_x loss_x 0.6523 (0.5791) acc_x 81.2500 (84.3750) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [10/27] time 0.326 (0.346) data 0.249 (0.269) loss_x loss_x 0.3628 (0.5452) acc_x 93.7500 (87.5000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/27] time 0.352 (0.336) data 0.275 (0.258) loss_x loss_x 0.7393 (0.5960) acc_x 78.1250 (86.0417) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/27] time 0.340 (0.339) data 0.263 (0.261) loss_x loss_x 0.5449 (0.6092) acc_x 87.5000 (85.1562) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/27] time 0.310 (0.339) data 0.232 (0.261) loss_x loss_x 1.3496 (0.6709) acc_x 68.7500 (83.7500) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 607
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:894
clean false:2
clean_rate:0.9977678571428571
noisy true:131
noisy false:605
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [16/200] batch [5/28] time 0.370 (0.354) data 0.292 (0.276) loss_x loss_x 0.4636 (0.5762) acc_x 90.6250 (86.2500) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [10/28] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.8218 (0.6496) acc_x 71.8750 (84.0625) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [15/28] time 0.334 (0.343) data 0.256 (0.265) loss_x loss_x 1.3164 (0.6887) acc_x 75.0000 (83.1250) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/28] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.5298 (0.6935) acc_x 87.5000 (83.2812) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/28] time 0.306 (0.342) data 0.229 (0.264) loss_x loss_x 0.6895 (0.6613) acc_x 87.5000 (84.1250) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 603
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:907
clean false:3
clean_rate:0.9967032967032967
noisy true:122
noisy false:600
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [17/200] batch [5/28] time 0.342 (0.359) data 0.264 (0.281) loss_x loss_x 0.4238 (0.5050) acc_x 93.7500 (90.6250) lr 1.9724e-03 eta 0:00:08
epoch [17/200] batch [10/28] time 0.344 (0.353) data 0.266 (0.275) loss_x loss_x 0.5347 (0.5528) acc_x 90.6250 (87.8125) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [15/28] time 0.368 (0.353) data 0.290 (0.276) loss_x loss_x 0.7925 (0.6330) acc_x 78.1250 (85.8333) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/28] time 0.354 (0.351) data 0.277 (0.274) loss_x loss_x 0.8477 (0.6648) acc_x 78.1250 (84.6875) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/28] time 0.342 (0.353) data 0.264 (0.276) loss_x loss_x 0.4736 (0.6568) acc_x 87.5000 (84.1250) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 606
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:900
clean false:2
clean_rate:0.9977827050997783
noisy true:126
noisy false:604
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [18/200] batch [5/28] time 0.349 (0.361) data 0.271 (0.283) loss_x loss_x 0.5581 (0.6046) acc_x 84.3750 (86.8750) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [10/28] time 0.330 (0.352) data 0.253 (0.275) loss_x loss_x 0.7236 (0.6438) acc_x 81.2500 (85.0000) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [15/28] time 0.355 (0.351) data 0.278 (0.273) loss_x loss_x 0.4883 (0.6306) acc_x 90.6250 (85.8333) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/28] time 0.310 (0.344) data 0.232 (0.266) loss_x loss_x 0.8267 (0.6361) acc_x 78.1250 (85.1562) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/28] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.4934 (0.6454) acc_x 87.5000 (84.6250) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 600
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:908
clean false:2
clean_rate:0.9978021978021978
noisy true:124
noisy false:598
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [19/200] batch [5/28] time 0.363 (0.344) data 0.285 (0.266) loss_x loss_x 0.4841 (0.6270) acc_x 87.5000 (82.5000) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [10/28] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 1.0879 (0.6482) acc_x 68.7500 (82.8125) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [15/28] time 0.356 (0.345) data 0.278 (0.268) loss_x loss_x 0.4263 (0.6168) acc_x 90.6250 (84.1667) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/28] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.8838 (0.6539) acc_x 78.1250 (83.4375) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/28] time 0.352 (0.343) data 0.275 (0.266) loss_x loss_x 0.5796 (0.6643) acc_x 90.6250 (83.7500) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 590
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 917
clean true:915
clean false:2
clean_rate:0.9978189749182116
noisy true:127
noisy false:588
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 715
epoch [20/200] batch [5/28] time 0.294 (0.308) data 0.217 (0.231) loss_x loss_x 0.7290 (0.6504) acc_x 81.2500 (81.8750) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [10/28] time 0.349 (0.314) data 0.272 (0.236) loss_x loss_x 0.2517 (0.6302) acc_x 96.8750 (84.6875) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [15/28] time 0.333 (0.322) data 0.256 (0.244) loss_x loss_x 0.5376 (0.6038) acc_x 84.3750 (84.7917) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/28] time 0.343 (0.328) data 0.265 (0.251) loss_x loss_x 0.7070 (0.6422) acc_x 81.2500 (83.4375) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/28] time 0.328 (0.332) data 0.251 (0.255) loss_x loss_x 0.8359 (0.6586) acc_x 78.1250 (83.0000) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:931
clean false:1
clean_rate:0.9989270386266095
noisy true:139
noisy false:561
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [21/200] batch [5/29] time 0.324 (0.347) data 0.247 (0.269) loss_x loss_x 0.7104 (0.5967) acc_x 81.2500 (86.8750) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [10/29] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.5684 (0.5743) acc_x 90.6250 (86.5625) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [15/29] time 0.342 (0.348) data 0.265 (0.271) loss_x loss_x 0.5938 (0.6025) acc_x 84.3750 (85.6250) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [20/29] time 0.339 (0.346) data 0.262 (0.269) loss_x loss_x 0.5303 (0.5942) acc_x 90.6250 (86.4062) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/29] time 0.364 (0.347) data 0.286 (0.269) loss_x loss_x 0.6768 (0.5993) acc_x 84.3750 (85.7500) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.5778, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 943
clean true:940
clean false:3
clean_rate:0.9968186638388123
noisy true:128
noisy false:561
after delete: len(clean_dataset) 943
after delete: len(noisy_dataset) 689
epoch [22/200] batch [5/29] time 0.351 (0.355) data 0.274 (0.278) loss_x loss_x 0.7017 (0.5930) acc_x 78.1250 (86.8750) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [10/29] time 0.322 (0.348) data 0.243 (0.271) loss_x loss_x 0.6938 (0.5002) acc_x 87.5000 (90.0000) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [15/29] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.5439 (0.5378) acc_x 90.6250 (88.5417) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/29] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.3352 (0.5655) acc_x 96.8750 (87.5000) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/29] time 0.336 (0.344) data 0.257 (0.267) loss_x loss_x 0.6167 (0.5811) acc_x 87.5000 (86.8750) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 535
confident_label rate tensor(0.5931, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 968
clean true:967
clean false:1
clean_rate:0.9989669421487604
noisy true:130
noisy false:534
after delete: len(clean_dataset) 968
after delete: len(noisy_dataset) 664
epoch [23/200] batch [5/30] time 0.351 (0.349) data 0.273 (0.271) loss_x loss_x 0.2996 (0.6834) acc_x 90.6250 (82.5000) lr 1.9461e-03 eta 0:00:08
epoch [23/200] batch [10/30] time 0.312 (0.342) data 0.233 (0.264) loss_x loss_x 0.4358 (0.6842) acc_x 87.5000 (82.5000) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [15/30] time 0.346 (0.341) data 0.269 (0.264) loss_x loss_x 0.6934 (0.6515) acc_x 75.0000 (83.5417) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [20/30] time 0.331 (0.341) data 0.254 (0.263) loss_x loss_x 0.7852 (0.6729) acc_x 81.2500 (83.5938) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/30] time 0.347 (0.341) data 0.270 (0.263) loss_x loss_x 0.5522 (0.6375) acc_x 90.6250 (84.8750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/30] time 0.337 (0.342) data 0.259 (0.264) loss_x loss_x 0.5825 (0.6169) acc_x 81.2500 (85.1042) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 547
confident_label rate tensor(0.5858, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 956
clean true:955
clean false:1
clean_rate:0.9989539748953975
noisy true:130
noisy false:546
after delete: len(clean_dataset) 956
after delete: len(noisy_dataset) 676
epoch [24/200] batch [5/29] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.8335 (0.5701) acc_x 81.2500 (86.8750) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [10/29] time 0.333 (0.345) data 0.256 (0.268) loss_x loss_x 0.7437 (0.5506) acc_x 75.0000 (86.8750) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [15/29] time 0.337 (0.344) data 0.260 (0.267) loss_x loss_x 0.4922 (0.5747) acc_x 90.6250 (86.4583) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/29] time 0.345 (0.346) data 0.268 (0.269) loss_x loss_x 0.4907 (0.5676) acc_x 93.7500 (86.8750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/29] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.5991 (0.5569) acc_x 87.5000 (87.1250) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 522
confident_label rate tensor(0.6011, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 981
clean true:978
clean false:3
clean_rate:0.9969418960244648
noisy true:132
noisy false:519
after delete: len(clean_dataset) 981
after delete: len(noisy_dataset) 651
epoch [25/200] batch [5/30] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.4885 (0.5247) acc_x 93.7500 (88.7500) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [10/30] time 0.337 (0.344) data 0.260 (0.266) loss_x loss_x 0.7563 (0.5392) acc_x 81.2500 (88.1250) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [15/30] time 0.348 (0.342) data 0.271 (0.264) loss_x loss_x 0.7954 (0.6089) acc_x 84.3750 (86.6667) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [20/30] time 0.346 (0.342) data 0.268 (0.264) loss_x loss_x 0.9272 (0.6183) acc_x 75.0000 (85.6250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/30] time 0.326 (0.340) data 0.249 (0.262) loss_x loss_x 0.6245 (0.6111) acc_x 87.5000 (85.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/30] time 0.336 (0.340) data 0.258 (0.263) loss_x loss_x 0.7280 (0.6246) acc_x 81.2500 (84.5833) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 500
confident_label rate tensor(0.6121, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 999
clean true:998
clean false:1
clean_rate:0.998998998998999
noisy true:134
noisy false:499
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 633
epoch [26/200] batch [5/31] time 0.338 (0.343) data 0.260 (0.265) loss_x loss_x 0.7236 (0.5397) acc_x 81.2500 (87.5000) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [10/31] time 0.348 (0.343) data 0.271 (0.265) loss_x loss_x 0.4810 (0.5449) acc_x 84.3750 (86.5625) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [15/31] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.8521 (0.5767) acc_x 81.2500 (85.2083) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [20/31] time 0.304 (0.342) data 0.226 (0.264) loss_x loss_x 0.5200 (0.5738) acc_x 90.6250 (84.8438) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/31] time 0.341 (0.342) data 0.262 (0.264) loss_x loss_x 0.4380 (0.5708) acc_x 90.6250 (85.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [30/31] time 0.303 (0.337) data 0.226 (0.260) loss_x loss_x 0.5161 (0.5724) acc_x 87.5000 (85.9375) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 502
confident_label rate tensor(0.6097, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 995
clean true:993
clean false:2
clean_rate:0.9979899497487437
noisy true:137
noisy false:500
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 637
epoch [27/200] batch [5/31] time 0.350 (0.357) data 0.273 (0.279) loss_x loss_x 0.6841 (0.7185) acc_x 87.5000 (83.7500) lr 1.9239e-03 eta 0:00:09
epoch [27/200] batch [10/31] time 0.320 (0.347) data 0.242 (0.269) loss_x loss_x 0.9639 (0.7333) acc_x 75.0000 (81.8750) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [15/31] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.5107 (0.6551) acc_x 84.3750 (83.1250) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [20/31] time 0.332 (0.344) data 0.254 (0.266) loss_x loss_x 0.4507 (0.6152) acc_x 90.6250 (85.1562) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/31] time 0.334 (0.343) data 0.256 (0.265) loss_x loss_x 0.7100 (0.6017) acc_x 84.3750 (85.2500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/31] time 0.340 (0.341) data 0.263 (0.264) loss_x loss_x 0.5015 (0.5938) acc_x 84.3750 (85.3125) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 506
confident_label rate tensor(0.6091, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 994
clean true:993
clean false:1
clean_rate:0.9989939637826962
noisy true:133
noisy false:505
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 638
epoch [28/200] batch [5/31] time 0.313 (0.320) data 0.235 (0.242) loss_x loss_x 0.6558 (0.6592) acc_x 90.6250 (81.8750) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [10/31] time 0.316 (0.319) data 0.239 (0.241) loss_x loss_x 0.5190 (0.5588) acc_x 84.3750 (85.0000) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [15/31] time 0.347 (0.329) data 0.269 (0.251) loss_x loss_x 0.6270 (0.5928) acc_x 84.3750 (84.7917) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [20/31] time 0.344 (0.331) data 0.266 (0.253) loss_x loss_x 0.6294 (0.6076) acc_x 84.3750 (84.6875) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/31] time 0.383 (0.334) data 0.305 (0.256) loss_x loss_x 0.3159 (0.5807) acc_x 93.7500 (85.7500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [30/31] time 0.333 (0.336) data 0.255 (0.258) loss_x loss_x 0.3523 (0.5861) acc_x 90.6250 (85.6250) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 503
confident_label rate tensor(0.6134, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1001
clean true:1000
clean false:1
clean_rate:0.999000999000999
noisy true:129
noisy false:502
after delete: len(clean_dataset) 1001
after delete: len(noisy_dataset) 631
epoch [29/200] batch [5/31] time 0.308 (0.348) data 0.230 (0.271) loss_x loss_x 0.5771 (0.5191) acc_x 84.3750 (86.8750) lr 1.9114e-03 eta 0:00:09
epoch [29/200] batch [10/31] time 0.341 (0.342) data 0.264 (0.264) loss_x loss_x 1.0029 (0.5663) acc_x 68.7500 (85.0000) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [15/31] time 0.347 (0.344) data 0.270 (0.266) loss_x loss_x 0.6079 (0.5904) acc_x 90.6250 (85.0000) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [20/31] time 0.353 (0.344) data 0.276 (0.267) loss_x loss_x 0.6289 (0.5618) acc_x 75.0000 (85.4688) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/31] time 0.363 (0.345) data 0.286 (0.268) loss_x loss_x 0.3550 (0.5721) acc_x 93.7500 (84.8750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/31] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.5972 (0.5805) acc_x 90.6250 (85.5208) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 484
confident_label rate tensor(0.6256, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1021
clean true:1018
clean false:3
clean_rate:0.9970617042115573
noisy true:130
noisy false:481
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 611
epoch [30/200] batch [5/31] time 0.342 (0.344) data 0.265 (0.267) loss_x loss_x 0.6299 (0.5825) acc_x 87.5000 (83.7500) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [10/31] time 0.349 (0.346) data 0.272 (0.268) loss_x loss_x 0.6357 (0.6009) acc_x 87.5000 (85.3125) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [15/31] time 0.305 (0.341) data 0.227 (0.264) loss_x loss_x 0.8257 (0.5845) acc_x 71.8750 (85.0000) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [20/31] time 0.352 (0.342) data 0.274 (0.264) loss_x loss_x 0.4624 (0.5791) acc_x 90.6250 (85.6250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/31] time 0.355 (0.343) data 0.277 (0.266) loss_x loss_x 0.3201 (0.5549) acc_x 93.7500 (86.6250) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/31] time 0.361 (0.345) data 0.283 (0.267) loss_x loss_x 0.5820 (0.5441) acc_x 84.3750 (86.6667) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.6305, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1029
clean true:1028
clean false:1
clean_rate:0.9990281827016521
noisy true:132
noisy false:471
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 603
epoch [31/200] batch [5/32] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.7207 (0.7514) acc_x 84.3750 (83.7500) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [10/32] time 0.349 (0.352) data 0.272 (0.275) loss_x loss_x 0.7783 (0.6685) acc_x 78.1250 (86.2500) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [15/32] time 0.358 (0.352) data 0.281 (0.274) loss_x loss_x 0.4580 (0.6492) acc_x 84.3750 (85.8333) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [20/32] time 0.331 (0.349) data 0.254 (0.271) loss_x loss_x 0.6597 (0.6333) acc_x 87.5000 (85.9375) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [25/32] time 0.345 (0.347) data 0.267 (0.270) loss_x loss_x 0.7783 (0.5989) acc_x 81.2500 (86.2500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/32] time 0.341 (0.347) data 0.263 (0.270) loss_x loss_x 0.3430 (0.5803) acc_x 96.8750 (86.7708) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 442
confident_label rate tensor(0.6385, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1042
clean true:1041
clean false:1
clean_rate:0.9990403071017274
noisy true:149
noisy false:441
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 590
epoch [32/200] batch [5/32] time 0.347 (0.352) data 0.270 (0.275) loss_x loss_x 0.5518 (0.5175) acc_x 87.5000 (88.1250) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [10/32] time 0.352 (0.349) data 0.275 (0.272) loss_x loss_x 0.8418 (0.5692) acc_x 81.2500 (86.8750) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [15/32] time 0.348 (0.349) data 0.271 (0.272) loss_x loss_x 0.3401 (0.5207) acc_x 90.6250 (87.7083) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [20/32] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.7051 (0.5364) acc_x 78.1250 (87.3438) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [25/32] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.6489 (0.5490) acc_x 90.6250 (86.8750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/32] time 0.320 (0.344) data 0.242 (0.266) loss_x loss_x 0.6060 (0.5432) acc_x 90.6250 (87.2917) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 490
confident_label rate tensor(0.6183, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1009
clean true:1008
clean false:1
clean_rate:0.9990089197224975
noisy true:134
noisy false:489
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 623
epoch [33/200] batch [5/31] time 0.332 (0.343) data 0.254 (0.265) loss_x loss_x 0.6064 (0.5477) acc_x 84.3750 (88.1250) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [10/31] time 0.335 (0.343) data 0.258 (0.265) loss_x loss_x 0.5249 (0.5578) acc_x 90.6250 (87.5000) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [15/31] time 0.324 (0.342) data 0.246 (0.264) loss_x loss_x 0.8623 (0.5629) acc_x 84.3750 (87.7083) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [20/31] time 0.354 (0.343) data 0.275 (0.265) loss_x loss_x 0.3252 (0.5888) acc_x 90.6250 (86.4062) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/31] time 0.343 (0.343) data 0.265 (0.266) loss_x loss_x 0.4910 (0.5886) acc_x 87.5000 (86.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [30/31] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.5771 (0.5834) acc_x 87.5000 (86.1458) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.6275, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1024
clean true:1022
clean false:2
clean_rate:0.998046875
noisy true:138
noisy false:470
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 608
epoch [34/200] batch [5/32] time 0.304 (0.317) data 0.226 (0.238) loss_x loss_x 0.8574 (0.6334) acc_x 75.0000 (84.3750) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [10/32] time 0.349 (0.333) data 0.272 (0.255) loss_x loss_x 0.5088 (0.5902) acc_x 84.3750 (85.0000) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [15/32] time 0.341 (0.336) data 0.263 (0.259) loss_x loss_x 0.3154 (0.5367) acc_x 90.6250 (86.0417) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [20/32] time 0.351 (0.340) data 0.273 (0.262) loss_x loss_x 0.3628 (0.5047) acc_x 87.5000 (87.1875) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [25/32] time 0.339 (0.341) data 0.261 (0.263) loss_x loss_x 1.0391 (0.5491) acc_x 78.1250 (86.3750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/32] time 0.339 (0.340) data 0.261 (0.263) loss_x loss_x 0.3984 (0.5339) acc_x 87.5000 (86.3542) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.6330, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1033
clean true:1031
clean false:2
clean_rate:0.9980638915779284
noisy true:139
noisy false:460
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 599
epoch [35/200] batch [5/32] time 0.367 (0.346) data 0.290 (0.269) loss_x loss_x 0.9189 (0.7158) acc_x 78.1250 (81.8750) lr 1.8686e-03 eta 0:00:09
epoch [35/200] batch [10/32] time 0.333 (0.348) data 0.255 (0.270) loss_x loss_x 0.6333 (0.5698) acc_x 84.3750 (85.6250) lr 1.8686e-03 eta 0:00:07
epoch [35/200] batch [15/32] time 0.355 (0.346) data 0.277 (0.268) loss_x loss_x 0.2566 (0.5156) acc_x 96.8750 (87.2917) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [20/32] time 0.335 (0.346) data 0.258 (0.268) loss_x loss_x 0.5566 (0.5320) acc_x 84.3750 (86.7188) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [25/32] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.5547 (0.5308) acc_x 84.3750 (86.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/32] time 0.372 (0.345) data 0.295 (0.268) loss_x loss_x 0.6465 (0.5249) acc_x 81.2500 (87.2917) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 435
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1063
clean true:1062
clean false:1
clean_rate:0.9990592662276576
noisy true:135
noisy false:434
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 569
epoch [36/200] batch [5/33] time 0.380 (0.352) data 0.301 (0.274) loss_x loss_x 0.6279 (0.4672) acc_x 90.6250 (91.8750) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [10/33] time 0.338 (0.349) data 0.260 (0.271) loss_x loss_x 0.5762 (0.5103) acc_x 81.2500 (88.1250) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [15/33] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.2686 (0.4764) acc_x 93.7500 (88.7500) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [20/33] time 0.362 (0.345) data 0.284 (0.267) loss_x loss_x 0.5161 (0.5021) acc_x 90.6250 (87.6562) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [25/33] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.1620 (0.4823) acc_x 100.0000 (88.1250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [30/33] time 0.346 (0.344) data 0.268 (0.267) loss_x loss_x 0.7539 (0.4970) acc_x 78.1250 (87.8125) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.6507, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1062
clean true:1060
clean false:2
clean_rate:0.9981167608286252
noisy true:138
noisy false:432
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 570
epoch [37/200] batch [5/33] time 0.347 (0.357) data 0.269 (0.280) loss_x loss_x 0.4966 (0.5010) acc_x 84.3750 (89.3750) lr 1.8526e-03 eta 0:00:10
epoch [37/200] batch [10/33] time 0.366 (0.352) data 0.287 (0.275) loss_x loss_x 0.6567 (0.5335) acc_x 84.3750 (88.4375) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [15/33] time 0.349 (0.357) data 0.272 (0.279) loss_x loss_x 0.9863 (0.5445) acc_x 78.1250 (87.7083) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [20/33] time 0.353 (0.354) data 0.276 (0.277) loss_x loss_x 0.2103 (0.5091) acc_x 96.8750 (88.5938) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [25/33] time 0.339 (0.353) data 0.262 (0.275) loss_x loss_x 0.6855 (0.5030) acc_x 87.5000 (89.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/33] time 0.333 (0.351) data 0.255 (0.274) loss_x loss_x 0.4797 (0.5009) acc_x 87.5000 (88.8542) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 427
confident_label rate tensor(0.6507, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1062
clean true:1061
clean false:1
clean_rate:0.9990583804143126
noisy true:144
noisy false:426
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 570
epoch [38/200] batch [5/33] time 0.334 (0.347) data 0.257 (0.270) loss_x loss_x 0.5850 (0.4402) acc_x 90.6250 (91.2500) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [10/33] time 0.347 (0.351) data 0.269 (0.273) loss_x loss_x 0.2395 (0.4106) acc_x 96.8750 (91.2500) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [15/33] time 0.342 (0.347) data 0.265 (0.270) loss_x loss_x 0.4890 (0.4445) acc_x 87.5000 (89.3750) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [20/33] time 0.381 (0.348) data 0.304 (0.271) loss_x loss_x 0.8438 (0.4589) acc_x 78.1250 (88.5938) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [25/33] time 0.349 (0.347) data 0.272 (0.269) loss_x loss_x 0.5913 (0.4733) acc_x 90.6250 (88.2500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [30/33] time 0.320 (0.345) data 0.243 (0.267) loss_x loss_x 0.5024 (0.4834) acc_x 87.5000 (87.7083) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1078
clean false:1
clean_rate:0.9990732159406858
noisy true:151
noisy false:402
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [39/200] batch [5/33] time 0.368 (0.350) data 0.290 (0.272) loss_x loss_x 0.5210 (0.4909) acc_x 87.5000 (86.8750) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [10/33] time 0.341 (0.349) data 0.262 (0.271) loss_x loss_x 0.6230 (0.5258) acc_x 87.5000 (87.5000) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [15/33] time 0.300 (0.341) data 0.221 (0.263) loss_x loss_x 0.5088 (0.5448) acc_x 84.3750 (85.6250) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [20/33] time 0.341 (0.335) data 0.264 (0.257) loss_x loss_x 0.3752 (0.5310) acc_x 87.5000 (85.9375) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [25/33] time 0.338 (0.336) data 0.260 (0.259) loss_x loss_x 0.5767 (0.5483) acc_x 93.7500 (85.5000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/33] time 0.345 (0.338) data 0.266 (0.260) loss_x loss_x 0.4243 (0.5369) acc_x 93.7500 (86.3542) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 377
confident_label rate tensor(0.6777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:150
noisy false:376
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 526
epoch [40/200] batch [5/34] time 0.328 (0.355) data 0.250 (0.277) loss_x loss_x 0.8394 (0.5638) acc_x 75.0000 (85.0000) lr 1.8271e-03 eta 0:00:10
epoch [40/200] batch [10/34] time 0.337 (0.344) data 0.259 (0.267) loss_x loss_x 0.5581 (0.6144) acc_x 84.3750 (84.3750) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [15/34] time 0.344 (0.344) data 0.265 (0.266) loss_x loss_x 0.8096 (0.5756) acc_x 71.8750 (85.0000) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [20/34] time 0.339 (0.340) data 0.262 (0.263) loss_x loss_x 0.8291 (0.5570) acc_x 84.3750 (86.2500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [25/34] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.2603 (0.5234) acc_x 96.8750 (87.6250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [30/34] time 0.329 (0.341) data 0.251 (0.264) loss_x loss_x 0.5625 (0.5450) acc_x 84.3750 (86.7708) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:147
noisy false:400
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [41/200] batch [5/33] time 0.343 (0.352) data 0.265 (0.274) loss_x loss_x 0.5522 (0.5301) acc_x 87.5000 (88.1250) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [10/33] time 0.344 (0.350) data 0.266 (0.272) loss_x loss_x 0.7217 (0.5462) acc_x 81.2500 (85.6250) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [15/33] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.2068 (0.5262) acc_x 96.8750 (86.8750) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [20/33] time 0.346 (0.347) data 0.269 (0.270) loss_x loss_x 0.3560 (0.5071) acc_x 87.5000 (87.6562) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [25/33] time 0.350 (0.347) data 0.273 (0.270) loss_x loss_x 0.2910 (0.5136) acc_x 90.6250 (87.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/33] time 0.326 (0.347) data 0.249 (0.269) loss_x loss_x 0.5854 (0.5293) acc_x 87.5000 (87.6042) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1079
clean false:1
clean_rate:0.9990740740740741
noisy true:149
noisy false:403
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [42/200] batch [5/33] time 0.351 (0.348) data 0.273 (0.270) loss_x loss_x 0.3289 (0.5210) acc_x 96.8750 (88.1250) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [10/33] time 0.337 (0.344) data 0.260 (0.266) loss_x loss_x 0.9014 (0.6085) acc_x 75.0000 (85.3125) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [15/33] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.5425 (0.5521) acc_x 84.3750 (86.4583) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [20/33] time 0.311 (0.338) data 0.234 (0.261) loss_x loss_x 0.5142 (0.5430) acc_x 90.6250 (87.1875) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [25/33] time 0.374 (0.339) data 0.296 (0.261) loss_x loss_x 0.3132 (0.5385) acc_x 93.7500 (86.6250) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/33] time 0.352 (0.341) data 0.274 (0.264) loss_x loss_x 0.5000 (0.5253) acc_x 84.3750 (86.6667) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1090
clean false:2
clean_rate:0.9981684981684982
noisy true:142
noisy false:398
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [43/200] batch [5/34] time 0.324 (0.348) data 0.245 (0.270) loss_x loss_x 0.5654 (0.6158) acc_x 87.5000 (85.6250) lr 1.7997e-03 eta 0:00:10
epoch [43/200] batch [10/34] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.5190 (0.5620) acc_x 84.3750 (85.6250) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [15/34] time 0.353 (0.342) data 0.275 (0.264) loss_x loss_x 0.4036 (0.5580) acc_x 93.7500 (86.8750) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [20/34] time 0.306 (0.337) data 0.229 (0.259) loss_x loss_x 0.6118 (0.5512) acc_x 93.7500 (86.8750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [25/34] time 0.350 (0.339) data 0.272 (0.261) loss_x loss_x 0.2942 (0.5282) acc_x 93.7500 (87.7500) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [30/34] time 0.356 (0.341) data 0.278 (0.263) loss_x loss_x 0.5791 (0.5326) acc_x 87.5000 (87.3958) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1087
clean false:1
clean_rate:0.9990808823529411
noisy true:138
noisy false:406
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [44/200] batch [5/34] time 0.353 (0.349) data 0.275 (0.271) loss_x loss_x 0.4265 (0.4801) acc_x 90.6250 (87.5000) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [10/34] time 0.360 (0.351) data 0.282 (0.273) loss_x loss_x 0.6968 (0.5925) acc_x 81.2500 (85.3125) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [15/34] time 0.349 (0.354) data 0.271 (0.276) loss_x loss_x 0.4453 (0.5580) acc_x 93.7500 (85.8333) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [20/34] time 0.372 (0.354) data 0.294 (0.276) loss_x loss_x 0.4319 (0.5399) acc_x 87.5000 (86.0938) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/34] time 0.341 (0.355) data 0.263 (0.278) loss_x loss_x 0.6226 (0.5367) acc_x 87.5000 (86.3750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [30/34] time 0.338 (0.355) data 0.261 (0.277) loss_x loss_x 0.3096 (0.5408) acc_x 93.7500 (86.4583) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.6661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1087
clean true:1085
clean false:2
clean_rate:0.9981600735970562
noisy true:146
noisy false:399
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 545
epoch [45/200] batch [5/33] time 0.319 (0.340) data 0.242 (0.262) loss_x loss_x 0.2808 (0.4314) acc_x 93.7500 (90.6250) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [10/33] time 0.338 (0.336) data 0.261 (0.259) loss_x loss_x 0.2534 (0.4533) acc_x 100.0000 (91.2500) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [15/33] time 0.345 (0.338) data 0.268 (0.261) loss_x loss_x 0.4214 (0.4507) acc_x 93.7500 (90.8333) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [20/33] time 0.300 (0.330) data 0.223 (0.253) loss_x loss_x 0.6104 (0.4729) acc_x 84.3750 (90.3125) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [25/33] time 0.353 (0.332) data 0.276 (0.255) loss_x loss_x 0.4412 (0.5029) acc_x 87.5000 (88.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/33] time 0.332 (0.335) data 0.254 (0.257) loss_x loss_x 0.4924 (0.4822) acc_x 87.5000 (89.5833) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 371
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1116
clean true:1115
clean false:1
clean_rate:0.9991039426523297
noisy true:146
noisy false:370
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 516
epoch [46/200] batch [5/34] time 0.366 (0.351) data 0.288 (0.273) loss_x loss_x 0.5107 (0.4948) acc_x 84.3750 (88.7500) lr 1.7705e-03 eta 0:00:10
epoch [46/200] batch [10/34] time 0.303 (0.337) data 0.225 (0.259) loss_x loss_x 0.5488 (0.4852) acc_x 87.5000 (88.7500) lr 1.7705e-03 eta 0:00:08
epoch [46/200] batch [15/34] time 0.309 (0.326) data 0.231 (0.248) loss_x loss_x 0.4397 (0.4863) acc_x 93.7500 (88.7500) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [20/34] time 0.326 (0.328) data 0.248 (0.250) loss_x loss_x 0.6855 (0.5033) acc_x 81.2500 (87.9688) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [25/34] time 0.335 (0.329) data 0.258 (0.252) loss_x loss_x 0.3203 (0.5018) acc_x 93.7500 (87.8750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/34] time 0.356 (0.331) data 0.279 (0.254) loss_x loss_x 0.4988 (0.5026) acc_x 84.3750 (87.6042) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 381
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1095
clean false:1
clean_rate:0.9990875912408759
noisy true:156
noisy false:380
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [47/200] batch [5/34] time 0.323 (0.315) data 0.245 (0.237) loss_x loss_x 0.4636 (0.5188) acc_x 84.3750 (85.0000) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [10/34] time 0.349 (0.329) data 0.272 (0.252) loss_x loss_x 0.7783 (0.5632) acc_x 81.2500 (85.9375) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [15/34] time 0.336 (0.332) data 0.259 (0.255) loss_x loss_x 0.4414 (0.5309) acc_x 87.5000 (87.0833) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [20/34] time 0.300 (0.329) data 0.222 (0.251) loss_x loss_x 0.3489 (0.5087) acc_x 96.8750 (87.6562) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [25/34] time 0.353 (0.332) data 0.276 (0.254) loss_x loss_x 0.3857 (0.5239) acc_x 93.7500 (87.8750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/34] time 0.336 (0.333) data 0.259 (0.255) loss_x loss_x 0.3308 (0.5129) acc_x 90.6250 (88.2292) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.6820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1113
clean true:1112
clean false:1
clean_rate:0.9991015274034142
noisy true:150
noisy false:369
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 519
epoch [48/200] batch [5/34] time 0.329 (0.359) data 0.252 (0.281) loss_x loss_x 0.6528 (0.4416) acc_x 87.5000 (90.0000) lr 1.7501e-03 eta 0:00:10
epoch [48/200] batch [10/34] time 0.353 (0.352) data 0.275 (0.274) loss_x loss_x 0.1992 (0.4813) acc_x 100.0000 (89.0625) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [15/34] time 0.336 (0.352) data 0.258 (0.274) loss_x loss_x 0.5928 (0.5365) acc_x 87.5000 (87.7083) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [20/34] time 0.325 (0.350) data 0.248 (0.272) loss_x loss_x 0.5791 (0.5407) acc_x 84.3750 (86.8750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [25/34] time 0.360 (0.350) data 0.282 (0.273) loss_x loss_x 0.6367 (0.5267) acc_x 84.3750 (87.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [30/34] time 0.349 (0.350) data 0.271 (0.273) loss_x loss_x 0.8853 (0.5575) acc_x 78.1250 (86.4583) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 375
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:149
noisy false:374
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [49/200] batch [5/34] time 0.333 (0.343) data 0.255 (0.265) loss_x loss_x 0.5366 (0.4467) acc_x 87.5000 (90.0000) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/34] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.4048 (0.4102) acc_x 93.7500 (90.9375) lr 1.7396e-03 eta 0:00:08
epoch [49/200] batch [15/34] time 0.340 (0.345) data 0.262 (0.268) loss_x loss_x 0.4766 (0.4817) acc_x 84.3750 (88.3333) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [20/34] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.6260 (0.5206) acc_x 87.5000 (87.8125) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [25/34] time 0.338 (0.344) data 0.261 (0.266) loss_x loss_x 0.5483 (0.5059) acc_x 87.5000 (88.0000) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [30/34] time 0.304 (0.338) data 0.226 (0.260) loss_x loss_x 0.4670 (0.4867) acc_x 84.3750 (88.3333) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 362
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1124
clean true:1123
clean false:1
clean_rate:0.9991103202846975
noisy true:147
noisy false:361
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 508
epoch [50/200] batch [5/35] time 0.299 (0.327) data 0.220 (0.249) loss_x loss_x 0.4500 (0.4447) acc_x 90.6250 (90.0000) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [10/35] time 0.346 (0.326) data 0.268 (0.249) loss_x loss_x 0.5708 (0.4204) acc_x 81.2500 (89.6875) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [15/35] time 0.331 (0.331) data 0.253 (0.253) loss_x loss_x 0.5181 (0.4802) acc_x 90.6250 (88.1250) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [20/35] time 0.344 (0.333) data 0.266 (0.255) loss_x loss_x 0.5312 (0.4791) acc_x 84.3750 (88.2812) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [25/35] time 0.299 (0.333) data 0.220 (0.256) loss_x loss_x 0.5645 (0.4948) acc_x 90.6250 (88.2500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [30/35] time 0.335 (0.334) data 0.258 (0.257) loss_x loss_x 0.8779 (0.5111) acc_x 78.1250 (87.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [35/35] time 0.341 (0.337) data 0.263 (0.259) loss_x loss_x 0.4209 (0.4957) acc_x 90.6250 (88.3036) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1120
clean true:1117
clean false:3
clean_rate:0.9973214285714286
noisy true:148
noisy false:364
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 512
epoch [51/200] batch [5/35] time 0.316 (0.332) data 0.237 (0.254) loss_x loss_x 0.4568 (0.4718) acc_x 90.6250 (90.6250) lr 1.7181e-03 eta 0:00:09
epoch [51/200] batch [10/35] time 0.340 (0.339) data 0.263 (0.262) loss_x loss_x 0.5361 (0.5435) acc_x 84.3750 (88.4375) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [15/35] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.4028 (0.5008) acc_x 96.8750 (88.7500) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [20/35] time 0.338 (0.342) data 0.261 (0.265) loss_x loss_x 0.3477 (0.4745) acc_x 90.6250 (88.7500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [25/35] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.4685 (0.4720) acc_x 87.5000 (89.3750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [30/35] time 0.347 (0.343) data 0.270 (0.266) loss_x loss_x 0.3174 (0.4868) acc_x 90.6250 (88.9583) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [35/35] time 0.347 (0.344) data 0.270 (0.267) loss_x loss_x 0.5742 (0.5026) acc_x 87.5000 (88.3929) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 353
confident_label rate tensor(0.6924, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1130
clean true:1129
clean false:1
clean_rate:0.9991150442477876
noisy true:150
noisy false:352
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 502
epoch [52/200] batch [5/35] time 0.350 (0.349) data 0.273 (0.271) loss_x loss_x 0.5068 (0.5729) acc_x 93.7500 (86.2500) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [10/35] time 0.361 (0.351) data 0.284 (0.273) loss_x loss_x 0.2502 (0.5553) acc_x 96.8750 (86.8750) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [15/35] time 0.350 (0.348) data 0.272 (0.271) loss_x loss_x 0.5010 (0.5264) acc_x 87.5000 (87.7083) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [20/35] time 0.339 (0.345) data 0.262 (0.268) loss_x loss_x 0.5425 (0.5633) acc_x 81.2500 (86.0938) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [25/35] time 0.342 (0.345) data 0.264 (0.268) loss_x loss_x 0.3804 (0.5494) acc_x 90.6250 (86.2500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [30/35] time 0.319 (0.343) data 0.240 (0.265) loss_x loss_x 0.2642 (0.5235) acc_x 96.8750 (86.8750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [35/35] time 0.349 (0.342) data 0.272 (0.265) loss_x loss_x 0.3882 (0.5226) acc_x 81.2500 (86.8750) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 373
confident_label rate tensor(0.6783, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1107
clean true:1105
clean false:2
clean_rate:0.998193315266486
noisy true:154
noisy false:371
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 525
epoch [53/200] batch [5/34] time 0.337 (0.344) data 0.260 (0.266) loss_x loss_x 0.6304 (0.5375) acc_x 84.3750 (87.5000) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [10/34] time 0.341 (0.337) data 0.263 (0.259) loss_x loss_x 0.5767 (0.5354) acc_x 81.2500 (87.5000) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [15/34] time 0.353 (0.342) data 0.275 (0.264) loss_x loss_x 0.3081 (0.4574) acc_x 96.8750 (90.2083) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [20/34] time 0.328 (0.341) data 0.250 (0.264) loss_x loss_x 0.4458 (0.4456) acc_x 90.6250 (90.3125) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [25/34] time 0.310 (0.340) data 0.232 (0.262) loss_x loss_x 0.5000 (0.4386) acc_x 84.3750 (90.3750) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [30/34] time 0.342 (0.339) data 0.265 (0.262) loss_x loss_x 0.4663 (0.4666) acc_x 87.5000 (89.1667) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 362
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1118
clean true:1117
clean false:1
clean_rate:0.9991055456171736
noisy true:153
noisy false:361
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 514
epoch [54/200] batch [5/34] time 0.349 (0.340) data 0.271 (0.262) loss_x loss_x 0.6548 (0.5340) acc_x 84.3750 (86.2500) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [10/34] time 0.351 (0.345) data 0.274 (0.267) loss_x loss_x 0.8965 (0.5808) acc_x 84.3750 (86.2500) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [15/34] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.6372 (0.5581) acc_x 81.2500 (86.8750) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [20/34] time 0.351 (0.346) data 0.273 (0.268) loss_x loss_x 0.4226 (0.5107) acc_x 84.3750 (87.5000) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [25/34] time 0.359 (0.349) data 0.281 (0.272) loss_x loss_x 0.5693 (0.4962) acc_x 81.2500 (88.0000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [30/34] time 0.349 (0.349) data 0.272 (0.271) loss_x loss_x 0.4319 (0.4966) acc_x 87.5000 (87.6042) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 350
confident_label rate tensor(0.6924, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1130
clean true:1129
clean false:1
clean_rate:0.9991150442477876
noisy true:153
noisy false:349
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 502
epoch [55/200] batch [5/35] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.4297 (0.5592) acc_x 90.6250 (86.8750) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [10/35] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.4055 (0.5055) acc_x 84.3750 (88.1250) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [15/35] time 0.338 (0.343) data 0.260 (0.266) loss_x loss_x 0.5811 (0.4850) acc_x 87.5000 (88.9583) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [20/35] time 0.329 (0.345) data 0.251 (0.268) loss_x loss_x 0.5083 (0.4821) acc_x 81.2500 (88.5938) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [25/35] time 0.357 (0.345) data 0.280 (0.268) loss_x loss_x 0.4539 (0.4834) acc_x 87.5000 (88.0000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [30/35] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.5200 (0.4706) acc_x 90.6250 (88.3333) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [35/35] time 0.318 (0.340) data 0.239 (0.262) loss_x loss_x 0.5508 (0.4811) acc_x 84.3750 (88.3929) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 369
confident_label rate tensor(0.6826, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1114
clean true:1112
clean false:2
clean_rate:0.9982046678635548
noisy true:151
noisy false:367
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 518
epoch [56/200] batch [5/34] time 0.340 (0.340) data 0.261 (0.262) loss_x loss_x 0.4719 (0.5741) acc_x 90.6250 (84.3750) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [10/34] time 0.330 (0.342) data 0.252 (0.264) loss_x loss_x 0.6484 (0.5640) acc_x 84.3750 (86.8750) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [15/34] time 0.307 (0.328) data 0.229 (0.250) loss_x loss_x 0.5400 (0.5375) acc_x 84.3750 (86.8750) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [20/34] time 0.345 (0.326) data 0.267 (0.249) loss_x loss_x 0.3391 (0.5036) acc_x 90.6250 (87.8125) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/34] time 0.355 (0.331) data 0.277 (0.253) loss_x loss_x 0.2494 (0.4870) acc_x 96.8750 (88.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/34] time 0.349 (0.333) data 0.271 (0.256) loss_x loss_x 0.5210 (0.4801) acc_x 87.5000 (88.4375) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 361
confident_label rate tensor(0.6893, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1125
clean true:1123
clean false:2
clean_rate:0.9982222222222222
noisy true:148
noisy false:359
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 507
epoch [57/200] batch [5/35] time 0.357 (0.356) data 0.279 (0.278) loss_x loss_x 0.4104 (0.5032) acc_x 90.6250 (88.1250) lr 1.6494e-03 eta 0:00:10
epoch [57/200] batch [10/35] time 0.339 (0.359) data 0.259 (0.281) loss_x loss_x 0.6504 (0.5292) acc_x 84.3750 (87.1875) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [15/35] time 0.345 (0.358) data 0.266 (0.280) loss_x loss_x 0.4951 (0.4763) acc_x 90.6250 (88.7500) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [20/35] time 0.376 (0.360) data 0.297 (0.282) loss_x loss_x 0.4636 (0.5056) acc_x 87.5000 (88.1250) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [25/35] time 0.316 (0.357) data 0.238 (0.279) loss_x loss_x 0.4114 (0.4762) acc_x 90.6250 (88.7500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [30/35] time 0.351 (0.356) data 0.272 (0.278) loss_x loss_x 0.3315 (0.4745) acc_x 93.7500 (88.6458) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [35/35] time 0.356 (0.356) data 0.278 (0.278) loss_x loss_x 0.4902 (0.4739) acc_x 84.3750 (88.3929) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.7010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1144
clean true:1143
clean false:1
clean_rate:0.9991258741258742
noisy true:158
noisy false:330
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 488
epoch [58/200] batch [5/35] time 0.350 (0.365) data 0.273 (0.288) loss_x loss_x 0.4434 (0.4011) acc_x 90.6250 (90.0000) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [10/35] time 0.350 (0.353) data 0.272 (0.276) loss_x loss_x 0.4902 (0.4178) acc_x 87.5000 (90.6250) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [15/35] time 0.345 (0.348) data 0.267 (0.271) loss_x loss_x 0.5806 (0.4921) acc_x 87.5000 (88.1250) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [20/35] time 0.349 (0.350) data 0.271 (0.272) loss_x loss_x 0.4709 (0.4557) acc_x 87.5000 (89.3750) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [25/35] time 0.353 (0.349) data 0.275 (0.272) loss_x loss_x 0.4065 (0.4453) acc_x 84.3750 (89.2500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [30/35] time 0.317 (0.346) data 0.239 (0.269) loss_x loss_x 0.3313 (0.4555) acc_x 93.7500 (89.1667) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [35/35] time 0.354 (0.347) data 0.277 (0.269) loss_x loss_x 0.6553 (0.4626) acc_x 81.2500 (88.8393) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 352
confident_label rate tensor(0.6961, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1136
clean true:1135
clean false:1
clean_rate:0.9991197183098591
noisy true:145
noisy false:351
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 496
epoch [59/200] batch [5/35] time 0.312 (0.310) data 0.234 (0.232) loss_x loss_x 0.5215 (0.3515) acc_x 81.2500 (90.0000) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [10/35] time 0.345 (0.327) data 0.267 (0.249) loss_x loss_x 0.7749 (0.3887) acc_x 75.0000 (89.6875) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [15/35] time 0.341 (0.333) data 0.263 (0.255) loss_x loss_x 0.3320 (0.3972) acc_x 93.7500 (89.3750) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [20/35] time 0.351 (0.336) data 0.273 (0.258) loss_x loss_x 0.4373 (0.4185) acc_x 93.7500 (88.9062) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [25/35] time 0.319 (0.333) data 0.240 (0.255) loss_x loss_x 0.3872 (0.4444) acc_x 87.5000 (88.1250) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [30/35] time 0.351 (0.337) data 0.274 (0.259) loss_x loss_x 0.3298 (0.4332) acc_x 87.5000 (88.4375) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [35/35] time 0.325 (0.338) data 0.247 (0.261) loss_x loss_x 0.4363 (0.4210) acc_x 90.6250 (88.8393) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.6893, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1125
clean true:1124
clean false:1
clean_rate:0.9991111111111111
noisy true:161
noisy false:346
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 507
epoch [60/200] batch [5/35] time 0.356 (0.350) data 0.279 (0.272) loss_x loss_x 0.4570 (0.3834) acc_x 87.5000 (90.6250) lr 1.6129e-03 eta 0:00:10
epoch [60/200] batch [10/35] time 0.336 (0.345) data 0.257 (0.267) loss_x loss_x 0.2986 (0.4449) acc_x 96.8750 (88.7500) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [15/35] time 0.351 (0.348) data 0.274 (0.270) loss_x loss_x 0.5288 (0.4588) acc_x 96.8750 (89.1667) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [20/35] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.5815 (0.4629) acc_x 84.3750 (89.2188) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [25/35] time 0.343 (0.347) data 0.266 (0.269) loss_x loss_x 0.3127 (0.4734) acc_x 90.6250 (88.8750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [30/35] time 0.321 (0.346) data 0.244 (0.268) loss_x loss_x 0.4612 (0.4797) acc_x 87.5000 (89.0625) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [35/35] time 0.332 (0.342) data 0.253 (0.264) loss_x loss_x 0.5127 (0.4851) acc_x 81.2500 (88.8393) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.6991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1141
clean true:1139
clean false:2
clean_rate:0.9982471516213848
noisy true:147
noisy false:344
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 491
epoch [61/200] batch [5/35] time 0.374 (0.359) data 0.297 (0.281) loss_x loss_x 0.3184 (0.4533) acc_x 90.6250 (88.7500) lr 1.6004e-03 eta 0:00:10
epoch [61/200] batch [10/35] time 0.346 (0.351) data 0.269 (0.274) loss_x loss_x 0.4526 (0.4453) acc_x 84.3750 (88.7500) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [15/35] time 0.350 (0.350) data 0.273 (0.272) loss_x loss_x 0.3892 (0.4618) acc_x 93.7500 (88.7500) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [20/35] time 0.299 (0.344) data 0.221 (0.266) loss_x loss_x 0.3423 (0.4405) acc_x 96.8750 (89.6875) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [25/35] time 0.351 (0.338) data 0.273 (0.260) loss_x loss_x 0.6465 (0.4364) acc_x 84.3750 (89.7500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [30/35] time 0.345 (0.339) data 0.268 (0.262) loss_x loss_x 0.2307 (0.4269) acc_x 100.0000 (90.1042) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [35/35] time 0.346 (0.340) data 0.269 (0.262) loss_x loss_x 0.4768 (0.4359) acc_x 87.5000 (90.0893) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.7059, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1152
clean true:1151
clean false:1
clean_rate:0.9991319444444444
noisy true:150
noisy false:330
after delete: len(clean_dataset) 1152
after delete: len(noisy_dataset) 480
epoch [62/200] batch [5/36] time 0.364 (0.352) data 0.286 (0.273) loss_x loss_x 0.3987 (0.4877) acc_x 90.6250 (87.5000) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [10/36] time 0.329 (0.348) data 0.252 (0.270) loss_x loss_x 0.3367 (0.5062) acc_x 93.7500 (88.4375) lr 1.5878e-03 eta 0:00:09
epoch [62/200] batch [15/36] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.3657 (0.5165) acc_x 96.8750 (88.3333) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [20/36] time 0.368 (0.343) data 0.290 (0.265) loss_x loss_x 0.4253 (0.5032) acc_x 87.5000 (88.7500) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [25/36] time 0.358 (0.344) data 0.280 (0.266) loss_x loss_x 0.4053 (0.4768) acc_x 93.7500 (89.6250) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [30/36] time 0.333 (0.345) data 0.256 (0.267) loss_x loss_x 0.5322 (0.4834) acc_x 90.6250 (89.1667) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [35/36] time 0.308 (0.342) data 0.231 (0.264) loss_x loss_x 0.2529 (0.4861) acc_x 93.7500 (89.1071) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 358
confident_label rate tensor(0.6942, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1133
clean true:1132
clean false:1
clean_rate:0.999117387466902
noisy true:142
noisy false:357
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 499
epoch [63/200] batch [5/35] time 0.337 (0.346) data 0.260 (0.268) loss_x loss_x 0.5195 (0.4406) acc_x 84.3750 (90.6250) lr 1.5750e-03 eta 0:00:10
epoch [63/200] batch [10/35] time 0.318 (0.345) data 0.240 (0.268) loss_x loss_x 0.2793 (0.4231) acc_x 96.8750 (90.3125) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [15/35] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.6016 (0.4665) acc_x 87.5000 (89.3750) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [20/35] time 0.344 (0.340) data 0.267 (0.263) loss_x loss_x 0.3230 (0.4570) acc_x 100.0000 (90.3125) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [25/35] time 0.340 (0.341) data 0.262 (0.264) loss_x loss_x 0.2922 (0.4304) acc_x 93.7500 (91.1250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [30/35] time 0.338 (0.340) data 0.261 (0.263) loss_x loss_x 0.3721 (0.4312) acc_x 87.5000 (91.1458) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [35/35] time 0.331 (0.340) data 0.253 (0.263) loss_x loss_x 0.3342 (0.4336) acc_x 90.6250 (90.8929) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.6936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:147
noisy false:353
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 500
epoch [64/200] batch [5/35] time 0.359 (0.351) data 0.282 (0.273) loss_x loss_x 0.2117 (0.3399) acc_x 96.8750 (95.0000) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [10/35] time 0.338 (0.350) data 0.261 (0.272) loss_x loss_x 0.3203 (0.3554) acc_x 96.8750 (94.0625) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [15/35] time 0.336 (0.346) data 0.258 (0.268) loss_x loss_x 0.6738 (0.4400) acc_x 84.3750 (91.0417) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [20/35] time 0.347 (0.346) data 0.270 (0.268) loss_x loss_x 0.4768 (0.4384) acc_x 90.6250 (91.0938) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [25/35] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.3203 (0.4209) acc_x 96.8750 (91.6250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [30/35] time 0.347 (0.345) data 0.269 (0.267) loss_x loss_x 0.2913 (0.4175) acc_x 90.6250 (91.6667) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [35/35] time 0.343 (0.345) data 0.266 (0.267) loss_x loss_x 0.4788 (0.4247) acc_x 84.3750 (91.0714) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.6991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1141
clean true:1138
clean false:3
clean_rate:0.9973707274320771
noisy true:147
noisy false:344
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 491
epoch [65/200] batch [5/35] time 0.351 (0.349) data 0.273 (0.271) loss_x loss_x 0.1973 (0.3375) acc_x 96.8750 (91.2500) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [10/35] time 0.342 (0.345) data 0.264 (0.267) loss_x loss_x 0.5088 (0.4234) acc_x 93.7500 (90.9375) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [15/35] time 0.345 (0.342) data 0.268 (0.265) loss_x loss_x 0.4651 (0.4156) acc_x 87.5000 (90.6250) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [20/35] time 0.353 (0.344) data 0.276 (0.266) loss_x loss_x 0.5356 (0.4136) acc_x 90.6250 (90.4688) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [25/35] time 0.352 (0.346) data 0.275 (0.268) loss_x loss_x 0.5435 (0.4013) acc_x 84.3750 (91.0000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [30/35] time 0.331 (0.346) data 0.254 (0.269) loss_x loss_x 0.3374 (0.4221) acc_x 90.6250 (90.5208) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [35/35] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.4082 (0.4220) acc_x 93.7500 (90.5357) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 327
confident_label rate tensor(0.7028, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1147
clean true:1146
clean false:1
clean_rate:0.999128160418483
noisy true:159
noisy false:326
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 485
epoch [66/200] batch [5/35] time 0.351 (0.353) data 0.273 (0.275) loss_x loss_x 0.7461 (0.4837) acc_x 78.1250 (87.5000) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [10/35] time 0.302 (0.336) data 0.224 (0.259) loss_x loss_x 0.3892 (0.4216) acc_x 93.7500 (89.6875) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [15/35] time 0.340 (0.334) data 0.263 (0.257) loss_x loss_x 0.5718 (0.4695) acc_x 84.3750 (88.1250) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [20/35] time 0.357 (0.339) data 0.279 (0.262) loss_x loss_x 0.6045 (0.4882) acc_x 87.5000 (87.6562) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [25/35] time 0.354 (0.343) data 0.276 (0.265) loss_x loss_x 0.2576 (0.4785) acc_x 90.6250 (88.1250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [30/35] time 0.334 (0.342) data 0.257 (0.265) loss_x loss_x 0.5527 (0.4861) acc_x 87.5000 (87.8125) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [35/35] time 0.342 (0.343) data 0.264 (0.265) loss_x loss_x 0.2607 (0.4686) acc_x 90.6250 (88.2143) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 336
confident_label rate tensor(0.7022, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1146
clean true:1145
clean false:1
clean_rate:0.9991273996509599
noisy true:151
noisy false:335
after delete: len(clean_dataset) 1146
after delete: len(noisy_dataset) 486
epoch [67/200] batch [5/35] time 0.359 (0.355) data 0.282 (0.278) loss_x loss_x 0.3545 (0.4507) acc_x 90.6250 (90.6250) lr 1.5225e-03 eta 0:00:10
epoch [67/200] batch [10/35] time 0.357 (0.354) data 0.280 (0.276) loss_x loss_x 0.5454 (0.4552) acc_x 87.5000 (89.6875) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [15/35] time 0.345 (0.353) data 0.267 (0.276) loss_x loss_x 0.5874 (0.4476) acc_x 93.7500 (90.4167) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [20/35] time 0.341 (0.351) data 0.264 (0.274) loss_x loss_x 0.5132 (0.4525) acc_x 87.5000 (90.1562) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [25/35] time 0.303 (0.348) data 0.224 (0.271) loss_x loss_x 0.2664 (0.4532) acc_x 93.7500 (90.1250) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [30/35] time 0.301 (0.342) data 0.223 (0.264) loss_x loss_x 0.3904 (0.4631) acc_x 93.7500 (89.8958) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [35/35] time 0.333 (0.342) data 0.256 (0.264) loss_x loss_x 0.3179 (0.4527) acc_x 90.6250 (90.1786) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 319
confident_label rate tensor(0.7114, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1161
clean true:1159
clean false:2
clean_rate:0.9982773471145564
noisy true:154
noisy false:317
after delete: len(clean_dataset) 1161
after delete: len(noisy_dataset) 471
epoch [68/200] batch [5/36] time 0.342 (0.337) data 0.264 (0.259) loss_x loss_x 0.6763 (0.4545) acc_x 87.5000 (88.7500) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [10/36] time 0.348 (0.331) data 0.270 (0.253) loss_x loss_x 0.2866 (0.3963) acc_x 90.6250 (91.5625) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [15/36] time 0.297 (0.324) data 0.220 (0.246) loss_x loss_x 0.5386 (0.4135) acc_x 84.3750 (90.4167) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [20/36] time 0.333 (0.324) data 0.255 (0.246) loss_x loss_x 0.8896 (0.4563) acc_x 84.3750 (89.8438) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [25/36] time 0.319 (0.327) data 0.241 (0.249) loss_x loss_x 0.3213 (0.4523) acc_x 93.7500 (89.7500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [30/36] time 0.338 (0.330) data 0.260 (0.252) loss_x loss_x 0.4604 (0.4707) acc_x 90.6250 (89.2708) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [35/36] time 0.350 (0.333) data 0.272 (0.255) loss_x loss_x 0.1642 (0.4536) acc_x 96.8750 (89.6429) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.7126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1163
clean true:1161
clean false:2
clean_rate:0.998280309544282
noisy true:150
noisy false:319
after delete: len(clean_dataset) 1163
after delete: len(noisy_dataset) 469
epoch [69/200] batch [5/36] time 0.331 (0.344) data 0.254 (0.266) loss_x loss_x 0.4639 (0.4232) acc_x 84.3750 (88.1250) lr 1.4955e-03 eta 0:00:10
epoch [69/200] batch [10/36] time 0.333 (0.341) data 0.256 (0.263) loss_x loss_x 0.6001 (0.5176) acc_x 81.2500 (86.5625) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [15/36] time 0.349 (0.340) data 0.272 (0.262) loss_x loss_x 0.4231 (0.5551) acc_x 87.5000 (86.2500) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [20/36] time 0.338 (0.342) data 0.260 (0.264) loss_x loss_x 0.5269 (0.5101) acc_x 87.5000 (87.3438) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [25/36] time 0.345 (0.340) data 0.266 (0.263) loss_x loss_x 0.6724 (0.5248) acc_x 84.3750 (87.1250) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [30/36] time 0.343 (0.341) data 0.266 (0.264) loss_x loss_x 0.5288 (0.5089) acc_x 84.3750 (86.9792) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [35/36] time 0.302 (0.340) data 0.225 (0.262) loss_x loss_x 0.4502 (0.4956) acc_x 93.7500 (87.4107) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.7040, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1149
clean true:1148
clean false:1
clean_rate:0.999129677980853
noisy true:152
noisy false:331
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 483
epoch [70/200] batch [5/35] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.5024 (0.4800) acc_x 87.5000 (87.5000) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [10/35] time 0.347 (0.340) data 0.269 (0.263) loss_x loss_x 0.4221 (0.4550) acc_x 90.6250 (89.3750) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [15/35] time 0.302 (0.342) data 0.225 (0.264) loss_x loss_x 0.4260 (0.4899) acc_x 96.8750 (88.7500) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [20/35] time 0.346 (0.338) data 0.269 (0.260) loss_x loss_x 0.7090 (0.5079) acc_x 87.5000 (88.9062) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [25/35] time 0.325 (0.339) data 0.248 (0.262) loss_x loss_x 0.3015 (0.4794) acc_x 87.5000 (88.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [30/35] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.3013 (0.4570) acc_x 93.7500 (89.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [35/35] time 0.334 (0.340) data 0.256 (0.263) loss_x loss_x 0.5044 (0.4496) acc_x 87.5000 (89.2857) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.7120, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1162
clean true:1161
clean false:1
clean_rate:0.9991394148020654
noisy true:156
noisy false:314
after delete: len(clean_dataset) 1162
after delete: len(noisy_dataset) 470
epoch [71/200] batch [5/36] time 0.368 (0.353) data 0.291 (0.275) loss_x loss_x 0.2578 (0.3316) acc_x 96.8750 (93.1250) lr 1.4679e-03 eta 0:00:10
epoch [71/200] batch [10/36] time 0.326 (0.349) data 0.248 (0.272) loss_x loss_x 0.2834 (0.3488) acc_x 96.8750 (92.5000) lr 1.4679e-03 eta 0:00:09
epoch [71/200] batch [15/36] time 0.333 (0.348) data 0.256 (0.270) loss_x loss_x 0.5537 (0.3785) acc_x 87.5000 (91.6667) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [20/36] time 0.344 (0.345) data 0.266 (0.268) loss_x loss_x 0.6050 (0.4174) acc_x 90.6250 (90.9375) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [25/36] time 0.368 (0.347) data 0.291 (0.270) loss_x loss_x 0.2111 (0.3905) acc_x 93.7500 (91.3750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [30/36] time 0.331 (0.347) data 0.254 (0.269) loss_x loss_x 0.6543 (0.4075) acc_x 78.1250 (90.3125) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [35/36] time 0.332 (0.347) data 0.254 (0.269) loss_x loss_x 0.9497 (0.4252) acc_x 75.0000 (89.5536) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 304
confident_label rate tensor(0.7206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1176
clean true:1174
clean false:2
clean_rate:0.9982993197278912
noisy true:154
noisy false:302
after delete: len(clean_dataset) 1176
after delete: len(noisy_dataset) 456
epoch [72/200] batch [5/36] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.4771 (0.5060) acc_x 93.7500 (88.1250) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [10/36] time 0.343 (0.343) data 0.265 (0.266) loss_x loss_x 0.4341 (0.5004) acc_x 84.3750 (86.8750) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [15/36] time 0.327 (0.343) data 0.249 (0.266) loss_x loss_x 0.8677 (0.5071) acc_x 78.1250 (86.2500) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [20/36] time 0.345 (0.342) data 0.267 (0.264) loss_x loss_x 0.4199 (0.4773) acc_x 93.7500 (87.8125) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [25/36] time 0.360 (0.344) data 0.282 (0.267) loss_x loss_x 0.5249 (0.4532) acc_x 87.5000 (88.8750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [30/36] time 0.320 (0.343) data 0.243 (0.266) loss_x loss_x 0.3782 (0.4504) acc_x 90.6250 (89.3750) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [35/36] time 0.313 (0.338) data 0.234 (0.260) loss_x loss_x 0.5376 (0.4533) acc_x 87.5000 (89.1964) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.7059, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1152
clean true:1152
clean false:0
clean_rate:1.0
noisy true:148
noisy false:332
after delete: len(clean_dataset) 1152
after delete: len(noisy_dataset) 480
epoch [73/200] batch [5/36] time 0.352 (0.352) data 0.274 (0.275) loss_x loss_x 0.4148 (0.3930) acc_x 90.6250 (91.8750) lr 1.4399e-03 eta 0:00:10
epoch [73/200] batch [10/36] time 0.294 (0.344) data 0.216 (0.266) loss_x loss_x 0.3943 (0.4085) acc_x 87.5000 (90.3125) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [15/36] time 0.343 (0.331) data 0.264 (0.253) loss_x loss_x 0.6167 (0.4589) acc_x 81.2500 (89.3750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [20/36] time 0.335 (0.335) data 0.258 (0.257) loss_x loss_x 0.6211 (0.4565) acc_x 84.3750 (88.2812) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [25/36] time 0.358 (0.338) data 0.280 (0.260) loss_x loss_x 0.3296 (0.4700) acc_x 93.7500 (87.8750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [30/36] time 0.329 (0.338) data 0.252 (0.260) loss_x loss_x 0.3069 (0.4712) acc_x 93.7500 (88.0208) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [35/36] time 0.300 (0.335) data 0.222 (0.257) loss_x loss_x 0.5093 (0.4574) acc_x 87.5000 (88.3036) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.7267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1186
clean true:1184
clean false:2
clean_rate:0.9983136593591906
noisy true:164
noisy false:282
after delete: len(clean_dataset) 1186
after delete: len(noisy_dataset) 446
epoch [74/200] batch [5/37] time 0.354 (0.358) data 0.275 (0.280) loss_x loss_x 0.4160 (0.4306) acc_x 87.5000 (88.1250) lr 1.4258e-03 eta 0:00:11
epoch [74/200] batch [10/37] time 0.349 (0.354) data 0.271 (0.276) loss_x loss_x 0.2969 (0.5326) acc_x 93.7500 (86.8750) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [15/37] time 0.356 (0.346) data 0.278 (0.268) loss_x loss_x 0.4934 (0.5008) acc_x 78.1250 (87.9167) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [20/37] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.4639 (0.4879) acc_x 87.5000 (88.4375) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [25/37] time 0.321 (0.345) data 0.244 (0.267) loss_x loss_x 0.3191 (0.4801) acc_x 93.7500 (88.5000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [30/37] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.4138 (0.4714) acc_x 84.3750 (88.2292) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [35/37] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.3809 (0.4728) acc_x 84.3750 (88.2143) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 309
confident_label rate tensor(0.7145, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1166
clean true:1164
clean false:2
clean_rate:0.9982847341337907
noisy true:159
noisy false:307
after delete: len(clean_dataset) 1166
after delete: len(noisy_dataset) 466
epoch [75/200] batch [5/36] time 0.346 (0.353) data 0.269 (0.276) loss_x loss_x 0.3564 (0.3854) acc_x 93.7500 (90.6250) lr 1.4115e-03 eta 0:00:10
epoch [75/200] batch [10/36] time 0.343 (0.354) data 0.266 (0.276) loss_x loss_x 0.4468 (0.3678) acc_x 90.6250 (90.9375) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [15/36] time 0.353 (0.350) data 0.275 (0.273) loss_x loss_x 0.4702 (0.3713) acc_x 84.3750 (90.6250) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [20/36] time 0.344 (0.349) data 0.267 (0.271) loss_x loss_x 0.3252 (0.4028) acc_x 93.7500 (90.6250) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [25/36] time 0.330 (0.348) data 0.253 (0.270) loss_x loss_x 0.6548 (0.4069) acc_x 81.2500 (89.7500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [30/36] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.4114 (0.4126) acc_x 87.5000 (89.8958) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [35/36] time 0.342 (0.344) data 0.264 (0.267) loss_x loss_x 0.3003 (0.4124) acc_x 93.7500 (89.8214) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 314
confident_label rate tensor(0.7132, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1164
clean true:1164
clean false:0
clean_rate:1.0
noisy true:154
noisy false:314
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 468
epoch [76/200] batch [5/36] time 0.346 (0.351) data 0.268 (0.274) loss_x loss_x 0.2069 (0.3408) acc_x 100.0000 (95.6250) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [10/36] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.4187 (0.4130) acc_x 90.6250 (91.8750) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [15/36] time 0.342 (0.346) data 0.265 (0.269) loss_x loss_x 0.3574 (0.4066) acc_x 93.7500 (91.6667) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [20/36] time 0.385 (0.348) data 0.306 (0.271) loss_x loss_x 0.4646 (0.4093) acc_x 87.5000 (91.4062) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [25/36] time 0.298 (0.341) data 0.220 (0.264) loss_x loss_x 0.6060 (0.4074) acc_x 84.3750 (91.2500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [30/36] time 0.344 (0.339) data 0.265 (0.262) loss_x loss_x 0.4919 (0.4144) acc_x 84.3750 (90.8333) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [35/36] time 0.336 (0.340) data 0.259 (0.262) loss_x loss_x 0.4170 (0.3960) acc_x 81.2500 (91.0714) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 281
confident_label rate tensor(0.7316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1194
clean true:1193
clean false:1
clean_rate:0.9991624790619765
noisy true:158
noisy false:280
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 438
epoch [77/200] batch [5/37] time 0.299 (0.315) data 0.221 (0.236) loss_x loss_x 0.6211 (0.5248) acc_x 78.1250 (83.7500) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [10/37] time 0.331 (0.326) data 0.254 (0.248) loss_x loss_x 0.3467 (0.4652) acc_x 90.6250 (86.2500) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [15/37] time 0.337 (0.331) data 0.259 (0.253) loss_x loss_x 0.4761 (0.4351) acc_x 90.6250 (87.7083) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [20/37] time 0.325 (0.332) data 0.248 (0.254) loss_x loss_x 0.3118 (0.4168) acc_x 96.8750 (88.9062) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [25/37] time 0.311 (0.327) data 0.233 (0.249) loss_x loss_x 0.4951 (0.4414) acc_x 93.7500 (89.0000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [30/37] time 0.336 (0.328) data 0.258 (0.250) loss_x loss_x 0.4150 (0.4450) acc_x 90.6250 (89.0625) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [35/37] time 0.335 (0.330) data 0.257 (0.252) loss_x loss_x 0.2500 (0.4405) acc_x 93.7500 (89.5536) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 298
confident_label rate tensor(0.7218, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1178
clean true:1177
clean false:1
clean_rate:0.9991511035653651
noisy true:157
noisy false:297
after delete: len(clean_dataset) 1178
after delete: len(noisy_dataset) 454
epoch [78/200] batch [5/36] time 0.344 (0.344) data 0.267 (0.267) loss_x loss_x 0.4258 (0.4073) acc_x 90.6250 (91.8750) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [10/36] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.3271 (0.4237) acc_x 90.6250 (90.3125) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [15/36] time 0.350 (0.347) data 0.272 (0.269) loss_x loss_x 0.4900 (0.4143) acc_x 87.5000 (91.0417) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [20/36] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.2905 (0.3892) acc_x 93.7500 (92.1875) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [25/36] time 0.337 (0.345) data 0.260 (0.268) loss_x loss_x 0.3586 (0.4075) acc_x 90.6250 (90.8750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [30/36] time 0.342 (0.345) data 0.265 (0.267) loss_x loss_x 0.7007 (0.4249) acc_x 87.5000 (90.7292) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [35/36] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.4060 (0.4524) acc_x 93.7500 (89.8214) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 288
confident_label rate tensor(0.7255, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1184
clean true:1183
clean false:1
clean_rate:0.9991554054054054
noisy true:161
noisy false:287
after delete: len(clean_dataset) 1184
after delete: len(noisy_dataset) 448
epoch [79/200] batch [5/37] time 0.354 (0.346) data 0.276 (0.268) loss_x loss_x 0.2688 (0.4724) acc_x 90.6250 (87.5000) lr 1.3535e-03 eta 0:00:11
epoch [79/200] batch [10/37] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.2834 (0.4094) acc_x 93.7500 (89.3750) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [15/37] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.2717 (0.4533) acc_x 93.7500 (87.9167) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [20/37] time 0.333 (0.341) data 0.256 (0.264) loss_x loss_x 0.3362 (0.4752) acc_x 93.7500 (87.0312) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [25/37] time 0.339 (0.341) data 0.261 (0.264) loss_x loss_x 0.3884 (0.4616) acc_x 90.6250 (87.8750) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [30/37] time 0.289 (0.340) data 0.211 (0.262) loss_x loss_x 0.4045 (0.4447) acc_x 93.7500 (88.8542) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [35/37] time 0.309 (0.334) data 0.232 (0.256) loss_x loss_x 0.3167 (0.4264) acc_x 93.7500 (89.1964) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 285
confident_label rate tensor(0.7286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1189
clean true:1188
clean false:1
clean_rate:0.9991589571068125
noisy true:159
noisy false:284
after delete: len(clean_dataset) 1189
after delete: len(noisy_dataset) 443
epoch [80/200] batch [5/37] time 0.331 (0.338) data 0.254 (0.260) loss_x loss_x 0.6675 (0.4819) acc_x 81.2500 (88.1250) lr 1.3387e-03 eta 0:00:10
epoch [80/200] batch [10/37] time 0.348 (0.341) data 0.270 (0.263) loss_x loss_x 0.5259 (0.4536) acc_x 81.2500 (89.0625) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [15/37] time 0.307 (0.338) data 0.229 (0.260) loss_x loss_x 0.5356 (0.4407) acc_x 87.5000 (90.0000) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [20/37] time 0.281 (0.334) data 0.203 (0.257) loss_x loss_x 0.4565 (0.4475) acc_x 87.5000 (90.3125) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [25/37] time 0.303 (0.328) data 0.225 (0.250) loss_x loss_x 0.3545 (0.4432) acc_x 93.7500 (90.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [30/37] time 0.347 (0.330) data 0.270 (0.252) loss_x loss_x 0.3359 (0.4267) acc_x 93.7500 (91.0417) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [35/37] time 0.350 (0.333) data 0.273 (0.255) loss_x loss_x 0.2922 (0.4155) acc_x 93.7500 (91.0714) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.7237, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1181
clean true:1180
clean false:1
clean_rate:0.9991532599491956
noisy true:160
noisy false:291
after delete: len(clean_dataset) 1181
after delete: len(noisy_dataset) 451
epoch [81/200] batch [5/36] time 0.303 (0.319) data 0.225 (0.240) loss_x loss_x 0.6064 (0.4160) acc_x 84.3750 (91.2500) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/36] time 0.331 (0.322) data 0.253 (0.245) loss_x loss_x 0.4658 (0.5028) acc_x 84.3750 (87.5000) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [15/36] time 0.329 (0.329) data 0.251 (0.251) loss_x loss_x 0.4229 (0.4782) acc_x 84.3750 (87.9167) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/36] time 0.349 (0.333) data 0.272 (0.255) loss_x loss_x 0.2969 (0.4465) acc_x 93.7500 (88.4375) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [25/36] time 0.313 (0.333) data 0.235 (0.255) loss_x loss_x 0.3613 (0.4556) acc_x 90.6250 (88.1250) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [30/36] time 0.346 (0.334) data 0.268 (0.256) loss_x loss_x 0.4336 (0.4370) acc_x 90.6250 (88.9583) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [35/36] time 0.337 (0.335) data 0.259 (0.257) loss_x loss_x 0.5317 (0.4458) acc_x 90.6250 (88.7500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 291
confident_label rate tensor(0.7255, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1184
clean true:1183
clean false:1
clean_rate:0.9991554054054054
noisy true:158
noisy false:290
after delete: len(clean_dataset) 1184
after delete: len(noisy_dataset) 448
epoch [82/200] batch [5/37] time 0.371 (0.356) data 0.293 (0.278) loss_x loss_x 0.3010 (0.3525) acc_x 93.7500 (91.2500) lr 1.3090e-03 eta 0:00:11
epoch [82/200] batch [10/37] time 0.325 (0.345) data 0.247 (0.267) loss_x loss_x 0.4216 (0.4327) acc_x 90.6250 (89.6875) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [15/37] time 0.290 (0.341) data 0.212 (0.263) loss_x loss_x 0.4426 (0.4359) acc_x 90.6250 (89.5833) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [20/37] time 0.311 (0.331) data 0.233 (0.253) loss_x loss_x 0.3469 (0.4684) acc_x 87.5000 (89.2188) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [25/37] time 0.343 (0.331) data 0.266 (0.253) loss_x loss_x 0.4094 (0.4435) acc_x 93.7500 (90.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [30/37] time 0.344 (0.333) data 0.267 (0.255) loss_x loss_x 0.4048 (0.4342) acc_x 93.7500 (90.4167) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [35/37] time 0.376 (0.336) data 0.299 (0.258) loss_x loss_x 0.2274 (0.4232) acc_x 96.8750 (90.6250) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.7224, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1179
clean true:1178
clean false:1
clean_rate:0.9991518235793045
noisy true:153
noisy false:300
after delete: len(clean_dataset) 1179
after delete: len(noisy_dataset) 453
epoch [83/200] batch [5/36] time 0.344 (0.353) data 0.267 (0.276) loss_x loss_x 0.2445 (0.3514) acc_x 100.0000 (91.2500) lr 1.2940e-03 eta 0:00:10
epoch [83/200] batch [10/36] time 0.341 (0.347) data 0.264 (0.269) loss_x loss_x 0.7275 (0.4182) acc_x 81.2500 (89.3750) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [15/36] time 0.348 (0.346) data 0.270 (0.269) loss_x loss_x 0.2756 (0.4320) acc_x 96.8750 (89.5833) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [20/36] time 0.347 (0.344) data 0.269 (0.267) loss_x loss_x 0.2810 (0.4358) acc_x 96.8750 (89.3750) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [25/36] time 0.353 (0.346) data 0.275 (0.269) loss_x loss_x 0.2358 (0.4134) acc_x 96.8750 (90.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [30/36] time 0.346 (0.342) data 0.269 (0.264) loss_x loss_x 0.5430 (0.4315) acc_x 81.2500 (88.9583) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [35/36] time 0.342 (0.342) data 0.264 (0.264) loss_x loss_x 0.2471 (0.4342) acc_x 93.7500 (89.0179) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.7353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1200
clean true:1199
clean false:1
clean_rate:0.9991666666666666
noisy true:164
noisy false:268
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 432
epoch [84/200] batch [5/37] time 0.310 (0.317) data 0.232 (0.238) loss_x loss_x 0.4329 (0.3595) acc_x 90.6250 (92.5000) lr 1.2790e-03 eta 0:00:10
epoch [84/200] batch [10/37] time 0.345 (0.332) data 0.267 (0.254) loss_x loss_x 0.6333 (0.4741) acc_x 78.1250 (89.3750) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [15/37] time 0.361 (0.337) data 0.283 (0.259) loss_x loss_x 0.3398 (0.4820) acc_x 90.6250 (88.3333) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [20/37] time 0.347 (0.342) data 0.270 (0.264) loss_x loss_x 0.5381 (0.4834) acc_x 90.6250 (87.9688) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [25/37] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.1179 (0.4749) acc_x 100.0000 (88.3750) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [30/37] time 0.338 (0.340) data 0.260 (0.262) loss_x loss_x 0.4219 (0.4480) acc_x 90.6250 (88.9583) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [35/37] time 0.331 (0.341) data 0.254 (0.263) loss_x loss_x 0.4229 (0.4580) acc_x 87.5000 (88.8393) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.7328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1196
clean true:1196
clean false:0
clean_rate:1.0
noisy true:165
noisy false:271
after delete: len(clean_dataset) 1196
after delete: len(noisy_dataset) 436
epoch [85/200] batch [5/37] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.4702 (0.4272) acc_x 87.5000 (88.7500) lr 1.2639e-03 eta 0:00:11
epoch [85/200] batch [10/37] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.2019 (0.4573) acc_x 96.8750 (87.5000) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [15/37] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.2052 (0.4201) acc_x 100.0000 (90.0000) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [20/37] time 0.350 (0.346) data 0.273 (0.268) loss_x loss_x 0.1962 (0.3887) acc_x 100.0000 (91.2500) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [25/37] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.3704 (0.3709) acc_x 93.7500 (92.2500) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [30/37] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.4097 (0.3788) acc_x 87.5000 (91.8750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [35/37] time 0.348 (0.346) data 0.270 (0.269) loss_x loss_x 0.4524 (0.3900) acc_x 90.6250 (91.4286) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.7328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1196
clean true:1195
clean false:1
clean_rate:0.9991638795986622
noisy true:172
noisy false:264
after delete: len(clean_dataset) 1196
after delete: len(noisy_dataset) 436
epoch [86/200] batch [5/37] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.5010 (0.4374) acc_x 87.5000 (89.3750) lr 1.2487e-03 eta 0:00:11
epoch [86/200] batch [10/37] time 0.355 (0.350) data 0.278 (0.272) loss_x loss_x 0.2512 (0.4167) acc_x 93.7500 (90.0000) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [15/37] time 0.331 (0.347) data 0.253 (0.269) loss_x loss_x 0.2397 (0.3904) acc_x 96.8750 (91.2500) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [20/37] time 0.352 (0.346) data 0.275 (0.269) loss_x loss_x 0.2366 (0.4111) acc_x 93.7500 (91.0938) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [25/37] time 0.349 (0.346) data 0.272 (0.268) loss_x loss_x 0.1854 (0.3750) acc_x 96.8750 (91.8750) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [30/37] time 0.328 (0.340) data 0.250 (0.262) loss_x loss_x 0.5420 (0.3786) acc_x 87.5000 (91.7708) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [35/37] time 0.341 (0.338) data 0.263 (0.260) loss_x loss_x 0.3494 (0.3896) acc_x 90.6250 (91.4286) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.7359, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1201
clean true:1200
clean false:1
clean_rate:0.9991673605328892
noisy true:163
noisy false:268
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 431
epoch [87/200] batch [5/37] time 0.300 (0.330) data 0.222 (0.252) loss_x loss_x 0.3328 (0.4333) acc_x 90.6250 (89.3750) lr 1.2334e-03 eta 0:00:10
epoch [87/200] batch [10/37] time 0.341 (0.320) data 0.263 (0.242) loss_x loss_x 0.2369 (0.3991) acc_x 93.7500 (89.3750) lr 1.2334e-03 eta 0:00:08
epoch [87/200] batch [15/37] time 0.346 (0.329) data 0.269 (0.251) loss_x loss_x 0.4468 (0.3715) acc_x 84.3750 (90.8333) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [20/37] time 0.356 (0.335) data 0.278 (0.257) loss_x loss_x 0.2277 (0.3781) acc_x 93.7500 (91.0938) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [25/37] time 0.337 (0.336) data 0.259 (0.258) loss_x loss_x 0.3425 (0.3905) acc_x 93.7500 (91.2500) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [30/37] time 0.332 (0.335) data 0.254 (0.257) loss_x loss_x 0.5073 (0.3910) acc_x 87.5000 (91.0417) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [35/37] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.5298 (0.3958) acc_x 84.3750 (90.6250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.7433, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1213
clean true:1213
clean false:0
clean_rate:1.0
noisy true:167
noisy false:252
after delete: len(clean_dataset) 1213
after delete: len(noisy_dataset) 419
epoch [88/200] batch [5/37] time 0.350 (0.330) data 0.272 (0.252) loss_x loss_x 0.3469 (0.4651) acc_x 90.6250 (88.7500) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [10/37] time 0.344 (0.339) data 0.266 (0.261) loss_x loss_x 0.2651 (0.4075) acc_x 96.8750 (90.9375) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [15/37] time 0.338 (0.340) data 0.261 (0.262) loss_x loss_x 0.3545 (0.3992) acc_x 96.8750 (91.2500) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [20/37] time 0.332 (0.341) data 0.253 (0.263) loss_x loss_x 0.4790 (0.4052) acc_x 90.6250 (90.6250) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [25/37] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.5552 (0.3896) acc_x 87.5000 (91.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [30/37] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.6016 (0.3881) acc_x 78.1250 (90.8333) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [35/37] time 0.344 (0.345) data 0.266 (0.267) loss_x loss_x 0.4429 (0.3909) acc_x 90.6250 (90.7143) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.7335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1197
clean true:1196
clean false:1
clean_rate:0.9991645781119465
noisy true:154
noisy false:281
after delete: len(clean_dataset) 1197
after delete: len(noisy_dataset) 435
epoch [89/200] batch [5/37] time 0.334 (0.346) data 0.257 (0.268) loss_x loss_x 0.5366 (0.4793) acc_x 84.3750 (89.3750) lr 1.2028e-03 eta 0:00:11
epoch [89/200] batch [10/37] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.5552 (0.5323) acc_x 78.1250 (87.5000) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [15/37] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.3496 (0.4678) acc_x 96.8750 (88.9583) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [20/37] time 0.351 (0.348) data 0.273 (0.270) loss_x loss_x 0.3154 (0.4390) acc_x 90.6250 (89.5312) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [25/37] time 0.369 (0.348) data 0.290 (0.271) loss_x loss_x 0.4009 (0.4434) acc_x 90.6250 (90.0000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [30/37] time 0.301 (0.343) data 0.223 (0.265) loss_x loss_x 0.5151 (0.4270) acc_x 87.5000 (90.4167) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [35/37] time 0.353 (0.340) data 0.275 (0.262) loss_x loss_x 0.4646 (0.4293) acc_x 84.3750 (89.7321) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.7377, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1204
clean true:1204
clean false:0
clean_rate:1.0
noisy true:166
noisy false:262
after delete: len(clean_dataset) 1204
after delete: len(noisy_dataset) 428
epoch [90/200] batch [5/37] time 0.300 (0.349) data 0.222 (0.272) loss_x loss_x 0.6123 (0.3642) acc_x 87.5000 (91.8750) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [10/37] time 0.357 (0.340) data 0.279 (0.262) loss_x loss_x 0.3074 (0.3705) acc_x 96.8750 (91.8750) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [15/37] time 0.339 (0.342) data 0.261 (0.264) loss_x loss_x 0.3760 (0.3935) acc_x 90.6250 (91.2500) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [20/37] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.5884 (0.4036) acc_x 81.2500 (90.7812) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [25/37] time 0.322 (0.342) data 0.244 (0.264) loss_x loss_x 0.2729 (0.4027) acc_x 90.6250 (90.8750) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [30/37] time 0.341 (0.337) data 0.264 (0.260) loss_x loss_x 0.3171 (0.4037) acc_x 96.8750 (90.8333) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [35/37] time 0.328 (0.338) data 0.250 (0.260) loss_x loss_x 0.7720 (0.4267) acc_x 84.3750 (90.4464) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.7439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1214
clean true:1214
clean false:0
clean_rate:1.0
noisy true:166
noisy false:252
after delete: len(clean_dataset) 1214
after delete: len(noisy_dataset) 418
epoch [91/200] batch [5/37] time 0.306 (0.331) data 0.228 (0.253) loss_x loss_x 0.5015 (0.3521) acc_x 84.3750 (88.1250) lr 1.1719e-03 eta 0:00:10
epoch [91/200] batch [10/37] time 0.336 (0.331) data 0.259 (0.253) loss_x loss_x 0.3853 (0.3999) acc_x 81.2500 (88.4375) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/37] time 0.345 (0.336) data 0.268 (0.258) loss_x loss_x 0.3611 (0.3858) acc_x 90.6250 (90.2083) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [20/37] time 0.342 (0.338) data 0.265 (0.260) loss_x loss_x 0.6348 (0.4209) acc_x 84.3750 (89.3750) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [25/37] time 0.340 (0.340) data 0.263 (0.262) loss_x loss_x 0.5840 (0.4245) acc_x 81.2500 (89.2500) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [30/37] time 0.345 (0.340) data 0.267 (0.262) loss_x loss_x 0.2957 (0.4241) acc_x 96.8750 (88.9583) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [35/37] time 0.345 (0.340) data 0.266 (0.262) loss_x loss_x 0.5093 (0.4353) acc_x 87.5000 (88.5714) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.7414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1210
clean true:1210
clean false:0
clean_rate:1.0
noisy true:165
noisy false:257
after delete: len(clean_dataset) 1210
after delete: len(noisy_dataset) 422
epoch [92/200] batch [5/37] time 0.350 (0.344) data 0.272 (0.267) loss_x loss_x 0.4712 (0.4001) acc_x 90.6250 (92.5000) lr 1.1564e-03 eta 0:00:11
epoch [92/200] batch [10/37] time 0.337 (0.345) data 0.259 (0.267) loss_x loss_x 0.2808 (0.4037) acc_x 93.7500 (91.5625) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [15/37] time 0.357 (0.344) data 0.279 (0.267) loss_x loss_x 0.3237 (0.3879) acc_x 90.6250 (91.6667) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [20/37] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.3784 (0.3949) acc_x 87.5000 (91.4062) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [25/37] time 0.351 (0.345) data 0.273 (0.268) loss_x loss_x 0.1920 (0.3747) acc_x 96.8750 (92.1250) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [30/37] time 0.336 (0.345) data 0.258 (0.268) loss_x loss_x 0.5869 (0.3796) acc_x 87.5000 (91.7708) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [35/37] time 0.301 (0.342) data 0.223 (0.265) loss_x loss_x 0.3210 (0.3951) acc_x 90.6250 (91.4286) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.7439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1214
clean true:1213
clean false:1
clean_rate:0.999176276771005
noisy true:164
noisy false:254
after delete: len(clean_dataset) 1214
after delete: len(noisy_dataset) 418
epoch [93/200] batch [5/37] time 0.347 (0.356) data 0.269 (0.278) loss_x loss_x 0.4741 (0.4191) acc_x 87.5000 (89.3750) lr 1.1409e-03 eta 0:00:11
epoch [93/200] batch [10/37] time 0.298 (0.335) data 0.220 (0.258) loss_x loss_x 0.4744 (0.4082) acc_x 90.6250 (90.6250) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [15/37] time 0.344 (0.336) data 0.266 (0.258) loss_x loss_x 0.7798 (0.4098) acc_x 78.1250 (90.0000) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [20/37] time 0.344 (0.340) data 0.266 (0.262) loss_x loss_x 0.2285 (0.3969) acc_x 93.7500 (90.1562) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [25/37] time 0.359 (0.342) data 0.282 (0.264) loss_x loss_x 0.4004 (0.4112) acc_x 93.7500 (90.0000) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [30/37] time 0.313 (0.342) data 0.235 (0.264) loss_x loss_x 0.2480 (0.4089) acc_x 93.7500 (90.3125) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [35/37] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.5728 (0.4226) acc_x 87.5000 (90.0000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.7396, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1207
clean true:1206
clean false:1
clean_rate:0.9991714995857498
noisy true:166
noisy false:259
after delete: len(clean_dataset) 1207
after delete: len(noisy_dataset) 425
epoch [94/200] batch [5/37] time 0.317 (0.351) data 0.240 (0.273) loss_x loss_x 0.1820 (0.2520) acc_x 96.8750 (95.6250) lr 1.1253e-03 eta 0:00:11
epoch [94/200] batch [10/37] time 0.327 (0.343) data 0.249 (0.265) loss_x loss_x 0.6450 (0.3508) acc_x 81.2500 (92.8125) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [15/37] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.3525 (0.3358) acc_x 93.7500 (93.1250) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [20/37] time 0.337 (0.343) data 0.260 (0.265) loss_x loss_x 0.3635 (0.3728) acc_x 90.6250 (92.1875) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [25/37] time 0.337 (0.343) data 0.260 (0.265) loss_x loss_x 0.4153 (0.3793) acc_x 87.5000 (91.1250) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [30/37] time 0.339 (0.339) data 0.262 (0.261) loss_x loss_x 0.2451 (0.3960) acc_x 93.7500 (90.2083) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [35/37] time 0.333 (0.338) data 0.255 (0.261) loss_x loss_x 0.2554 (0.3906) acc_x 93.7500 (90.3571) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.7408, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1209
clean true:1208
clean false:1
clean_rate:0.9991728701406121
noisy true:163
noisy false:260
after delete: len(clean_dataset) 1209
after delete: len(noisy_dataset) 423
epoch [95/200] batch [5/37] time 0.330 (0.340) data 0.252 (0.262) loss_x loss_x 0.4475 (0.2945) acc_x 90.6250 (93.1250) lr 1.1097e-03 eta 0:00:10
epoch [95/200] batch [10/37] time 0.356 (0.354) data 0.277 (0.276) loss_x loss_x 0.1396 (0.3154) acc_x 100.0000 (93.1250) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [15/37] time 0.369 (0.356) data 0.290 (0.278) loss_x loss_x 0.1993 (0.3274) acc_x 93.7500 (92.9167) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [20/37] time 0.306 (0.351) data 0.229 (0.272) loss_x loss_x 0.3975 (0.3361) acc_x 87.5000 (92.6562) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [25/37] time 0.366 (0.348) data 0.288 (0.270) loss_x loss_x 0.4951 (0.3602) acc_x 84.3750 (92.0000) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [30/37] time 0.363 (0.350) data 0.285 (0.272) loss_x loss_x 0.2146 (0.3748) acc_x 96.8750 (91.9792) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [35/37] time 0.305 (0.348) data 0.227 (0.270) loss_x loss_x 0.2505 (0.3740) acc_x 90.6250 (91.6964) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 248
confident_label rate tensor(0.7488, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1222
clean true:1222
clean false:0
clean_rate:1.0
noisy true:162
noisy false:248
after delete: len(clean_dataset) 1222
after delete: len(noisy_dataset) 410
epoch [96/200] batch [5/38] time 0.348 (0.349) data 0.271 (0.271) loss_x loss_x 0.5347 (0.4753) acc_x 90.6250 (91.8750) lr 1.0941e-03 eta 0:00:11
epoch [96/200] batch [10/38] time 0.364 (0.347) data 0.286 (0.270) loss_x loss_x 0.2922 (0.4369) acc_x 90.6250 (90.6250) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [15/38] time 0.312 (0.343) data 0.236 (0.266) loss_x loss_x 0.5532 (0.4284) acc_x 84.3750 (90.6250) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [20/38] time 0.294 (0.333) data 0.217 (0.255) loss_x loss_x 0.3623 (0.4263) acc_x 90.6250 (90.3125) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [25/38] time 0.330 (0.332) data 0.253 (0.254) loss_x loss_x 0.2849 (0.4066) acc_x 93.7500 (90.7500) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [30/38] time 0.341 (0.331) data 0.264 (0.254) loss_x loss_x 0.2170 (0.3905) acc_x 93.7500 (90.9375) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [35/38] time 0.350 (0.333) data 0.272 (0.255) loss_x loss_x 0.3787 (0.3949) acc_x 93.7500 (90.8929) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.7420, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1211
clean true:1210
clean false:1
clean_rate:0.9991742361684558
noisy true:161
noisy false:260
after delete: len(clean_dataset) 1211
after delete: len(noisy_dataset) 421
epoch [97/200] batch [5/37] time 0.350 (0.344) data 0.272 (0.265) loss_x loss_x 0.3225 (0.5306) acc_x 93.7500 (88.7500) lr 1.0785e-03 eta 0:00:10
epoch [97/200] batch [10/37] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.4758 (0.4989) acc_x 84.3750 (88.7500) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [15/37] time 0.352 (0.342) data 0.274 (0.264) loss_x loss_x 0.3542 (0.4665) acc_x 90.6250 (90.6250) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [20/37] time 0.306 (0.340) data 0.228 (0.263) loss_x loss_x 0.2949 (0.4639) acc_x 96.8750 (90.1562) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [25/37] time 0.356 (0.340) data 0.277 (0.262) loss_x loss_x 0.4500 (0.4403) acc_x 96.8750 (90.7500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [30/37] time 0.353 (0.341) data 0.273 (0.263) loss_x loss_x 0.4102 (0.4325) acc_x 93.7500 (91.1458) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [35/37] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.3716 (0.4234) acc_x 87.5000 (91.0714) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.7396, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1207
clean true:1205
clean false:2
clean_rate:0.9983429991714996
noisy true:168
noisy false:257
after delete: len(clean_dataset) 1207
after delete: len(noisy_dataset) 425
epoch [98/200] batch [5/37] time 0.349 (0.342) data 0.271 (0.265) loss_x loss_x 0.3342 (0.3167) acc_x 90.6250 (93.7500) lr 1.0628e-03 eta 0:00:10
epoch [98/200] batch [10/37] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.7344 (0.3436) acc_x 84.3750 (92.5000) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [15/37] time 0.370 (0.349) data 0.292 (0.271) loss_x loss_x 0.5195 (0.3738) acc_x 87.5000 (92.0833) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [20/37] time 0.346 (0.349) data 0.268 (0.272) loss_x loss_x 0.3145 (0.3721) acc_x 87.5000 (91.8750) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [25/37] time 0.327 (0.349) data 0.250 (0.271) loss_x loss_x 0.2107 (0.3742) acc_x 96.8750 (91.5000) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [30/37] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.5908 (0.3931) acc_x 90.6250 (91.1458) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [35/37] time 0.342 (0.347) data 0.265 (0.270) loss_x loss_x 0.5186 (0.3915) acc_x 93.7500 (91.5179) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.7482, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1221
clean true:1220
clean false:1
clean_rate:0.9991809991809992
noisy true:169
noisy false:242
after delete: len(clean_dataset) 1221
after delete: len(noisy_dataset) 411
epoch [99/200] batch [5/38] time 0.362 (0.352) data 0.284 (0.274) loss_x loss_x 0.3584 (0.3296) acc_x 87.5000 (91.2500) lr 1.0471e-03 eta 0:00:11
epoch [99/200] batch [10/38] time 0.334 (0.349) data 0.257 (0.272) loss_x loss_x 0.6504 (0.3382) acc_x 81.2500 (90.9375) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [15/38] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.5503 (0.3952) acc_x 90.6250 (90.6250) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [20/38] time 0.366 (0.347) data 0.288 (0.270) loss_x loss_x 0.5830 (0.3928) acc_x 84.3750 (90.9375) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [25/38] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.4812 (0.4062) acc_x 90.6250 (90.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [30/38] time 0.317 (0.343) data 0.239 (0.265) loss_x loss_x 0.3186 (0.3846) acc_x 90.6250 (90.7292) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [35/38] time 0.337 (0.339) data 0.260 (0.261) loss_x loss_x 0.4092 (0.3932) acc_x 87.5000 (90.6250) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.7518, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1227
clean true:1227
clean false:0
clean_rate:1.0
noisy true:158
noisy false:247
all clean rate:  [0.9939024390243902, 0.9932584269662922, 0.9973509933774835, 0.9987277353689568, 0.9974811083123426, 0.9987639060568603, 0.9976047904191617, 0.9987789987789988, 0.9964285714285714, 0.9988009592326139, 0.9964747356051704, 0.9988776655443322, 0.9988532110091743, 0.9976931949250288, 1.0, 0.9977678571428571, 0.9967032967032967, 0.9977827050997783, 0.9978021978021978, 0.9978189749182116, 0.9989270386266095, 0.9968186638388123, 0.9989669421487604, 0.9989539748953975, 0.9969418960244648, 0.998998998998999, 0.9979899497487437, 0.9989939637826962, 0.999000999000999, 0.9970617042115573, 0.9990281827016521, 0.9990403071017274, 0.9990089197224975, 0.998046875, 0.9980638915779284, 0.9990592662276576, 0.9981167608286252, 0.9990583804143126, 0.9990732159406858, 0.9990958408679927, 0.9990783410138249, 0.9990740740740741, 0.9981684981684982, 0.9990808823529411, 0.9981600735970562, 0.9991039426523297, 0.9990875912408759, 0.9991015274034142, 0.9990982867448152, 0.9991103202846975, 0.9973214285714286, 0.9991150442477876, 0.998193315266486, 0.9991055456171736, 0.9991150442477876, 0.9982046678635548, 0.9982222222222222, 0.9991258741258742, 0.9991197183098591, 0.9991111111111111, 0.9982471516213848, 0.9991319444444444, 0.999117387466902, 0.9991166077738516, 0.9973707274320771, 0.999128160418483, 0.9991273996509599, 0.9982773471145564, 0.998280309544282, 0.999129677980853, 0.9991394148020654, 0.9982993197278912, 1.0, 0.9983136593591906, 0.9982847341337907, 1.0, 0.9991624790619765, 0.9991511035653651, 0.9991554054054054, 0.9991589571068125, 0.9991532599491956, 0.9991554054054054, 0.9991518235793045, 0.9991666666666666, 1.0, 0.9991638795986622, 0.9991673605328892, 1.0, 0.9991645781119465, 1.0, 1.0, 1.0, 0.999176276771005, 0.9991714995857498, 0.9991728701406121, 1.0, 0.9991742361684558, 0.9983429991714996, 0.9991809991809992, 1.0]
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 405
epoch [100/200] batch [5/38] time 0.347 (0.351) data 0.270 (0.273) loss_x loss_x 0.5239 (0.3367) acc_x 87.5000 (92.5000) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [10/38] time 0.292 (0.337) data 0.215 (0.259) loss_x loss_x 0.4915 (0.4216) acc_x 90.6250 (90.6250) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [15/38] time 0.360 (0.335) data 0.282 (0.257) loss_x loss_x 0.3269 (0.3922) acc_x 90.6250 (91.0417) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [20/38] time 0.350 (0.338) data 0.273 (0.260) loss_x loss_x 0.2299 (0.3668) acc_x 93.7500 (91.5625) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [25/38] time 0.353 (0.340) data 0.275 (0.263) loss_x loss_x 0.4912 (0.3720) acc_x 90.6250 (91.7500) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [30/38] time 0.311 (0.340) data 0.233 (0.263) loss_x loss_x 0.2463 (0.3843) acc_x 93.7500 (91.1458) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [35/38] time 0.344 (0.339) data 0.266 (0.262) loss_x loss_x 0.3472 (0.3780) acc_x 93.7500 (91.3393) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1223
clean true:1222
clean false:1
clean_rate:0.9991823385118561
noisy true:163
noisy false:246
after delete: len(clean_dataset) 1223
after delete: len(noisy_dataset) 409
epoch [101/200] batch [5/38] time 0.331 (0.334) data 0.254 (0.256) loss_x loss_x 0.3408 (0.3177) acc_x 90.6250 (93.7500) lr 1.0157e-03 eta 0:00:11
epoch [101/200] batch [10/38] time 0.321 (0.327) data 0.243 (0.249) loss_x loss_x 0.6421 (0.3507) acc_x 87.5000 (91.5625) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [15/38] time 0.345 (0.334) data 0.268 (0.257) loss_x loss_x 0.3032 (0.3370) acc_x 93.7500 (92.5000) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [20/38] time 0.348 (0.340) data 0.271 (0.262) loss_x loss_x 0.5869 (0.3525) acc_x 84.3750 (91.8750) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [25/38] time 0.348 (0.342) data 0.271 (0.264) loss_x loss_x 0.2881 (0.3524) acc_x 93.7500 (91.8750) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [30/38] time 0.336 (0.341) data 0.258 (0.264) loss_x loss_x 0.1887 (0.3501) acc_x 93.7500 (91.9792) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [35/38] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.2830 (0.3538) acc_x 90.6250 (91.5179) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.7518, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1227
clean true:1226
clean false:1
clean_rate:0.9991850040749797
noisy true:165
noisy false:240
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 405
epoch [102/200] batch [5/38] time 0.358 (0.350) data 0.281 (0.273) loss_x loss_x 0.3447 (0.3750) acc_x 96.8750 (93.1250) lr 1.0000e-03 eta 0:00:11
epoch [102/200] batch [10/38] time 0.346 (0.354) data 0.268 (0.277) loss_x loss_x 0.5054 (0.4290) acc_x 81.2500 (90.3125) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [15/38] time 0.330 (0.348) data 0.253 (0.271) loss_x loss_x 0.3088 (0.3986) acc_x 93.7500 (91.4583) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [20/38] time 0.355 (0.349) data 0.278 (0.272) loss_x loss_x 0.3721 (0.4137) acc_x 90.6250 (90.0000) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [25/38] time 0.352 (0.349) data 0.275 (0.271) loss_x loss_x 0.4250 (0.4284) acc_x 87.5000 (88.7500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [30/38] time 0.338 (0.348) data 0.260 (0.270) loss_x loss_x 0.4561 (0.4222) acc_x 90.6250 (89.1667) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [35/38] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.3801 (0.4218) acc_x 93.7500 (89.4643) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.7555, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1233
clean true:1232
clean false:1
clean_rate:0.9991889699918897
noisy true:167
noisy false:232
after delete: len(clean_dataset) 1233
after delete: len(noisy_dataset) 399
epoch [103/200] batch [5/38] time 0.337 (0.342) data 0.259 (0.265) loss_x loss_x 0.8818 (0.5514) acc_x 75.0000 (83.7500) lr 9.8429e-04 eta 0:00:11
epoch [103/200] batch [10/38] time 0.338 (0.342) data 0.260 (0.265) loss_x loss_x 0.4407 (0.4019) acc_x 84.3750 (89.0625) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [15/38] time 0.339 (0.342) data 0.261 (0.265) loss_x loss_x 0.1394 (0.3950) acc_x 100.0000 (90.0000) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [20/38] time 0.336 (0.343) data 0.259 (0.265) loss_x loss_x 0.8428 (0.4141) acc_x 81.2500 (90.0000) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [25/38] time 0.306 (0.341) data 0.228 (0.263) loss_x loss_x 0.3264 (0.4090) acc_x 90.6250 (89.7500) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [30/38] time 0.368 (0.340) data 0.290 (0.262) loss_x loss_x 0.3196 (0.4020) acc_x 87.5000 (89.8958) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [35/38] time 0.349 (0.342) data 0.271 (0.264) loss_x loss_x 0.3770 (0.3989) acc_x 84.3750 (90.1786) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.7445, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1215
clean true:1214
clean false:1
clean_rate:0.9991769547325103
noisy true:168
noisy false:249
after delete: len(clean_dataset) 1215
after delete: len(noisy_dataset) 417
epoch [104/200] batch [5/37] time 0.297 (0.342) data 0.220 (0.264) loss_x loss_x 0.4211 (0.3685) acc_x 87.5000 (90.0000) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [10/37] time 0.327 (0.329) data 0.248 (0.251) loss_x loss_x 0.2184 (0.3653) acc_x 93.7500 (89.6875) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [15/37] time 0.336 (0.333) data 0.258 (0.255) loss_x loss_x 0.3748 (0.3781) acc_x 93.7500 (89.7917) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [20/37] time 0.335 (0.335) data 0.257 (0.257) loss_x loss_x 0.3989 (0.3941) acc_x 90.6250 (89.5312) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [25/37] time 0.347 (0.337) data 0.269 (0.259) loss_x loss_x 0.3401 (0.4118) acc_x 90.6250 (89.8750) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [30/37] time 0.354 (0.334) data 0.276 (0.257) loss_x loss_x 0.2725 (0.4118) acc_x 93.7500 (90.1042) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [35/37] time 0.345 (0.336) data 0.268 (0.258) loss_x loss_x 0.3711 (0.4165) acc_x 93.7500 (89.9107) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.7494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1223
clean true:1222
clean false:1
clean_rate:0.9991823385118561
noisy true:163
noisy false:246
after delete: len(clean_dataset) 1223
after delete: len(noisy_dataset) 409
epoch [105/200] batch [5/38] time 0.320 (0.340) data 0.242 (0.262) loss_x loss_x 0.3572 (0.4163) acc_x 90.6250 (91.2500) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [10/38] time 0.321 (0.338) data 0.244 (0.260) loss_x loss_x 0.4412 (0.3735) acc_x 93.7500 (91.8750) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [15/38] time 0.331 (0.332) data 0.254 (0.255) loss_x loss_x 0.7119 (0.4073) acc_x 78.1250 (91.0417) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [20/38] time 0.351 (0.336) data 0.273 (0.258) loss_x loss_x 0.2482 (0.4107) acc_x 96.8750 (90.7812) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [25/38] time 0.336 (0.338) data 0.259 (0.260) loss_x loss_x 0.3848 (0.4098) acc_x 90.6250 (90.7500) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [30/38] time 0.339 (0.338) data 0.261 (0.260) loss_x loss_x 0.2013 (0.3878) acc_x 100.0000 (91.3542) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [35/38] time 0.331 (0.338) data 0.253 (0.260) loss_x loss_x 0.4500 (0.3920) acc_x 90.6250 (91.5179) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.7426, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1212
clean true:1211
clean false:1
clean_rate:0.9991749174917491
noisy true:169
noisy false:251
after delete: len(clean_dataset) 1212
after delete: len(noisy_dataset) 420
epoch [106/200] batch [5/37] time 0.360 (0.353) data 0.283 (0.275) loss_x loss_x 0.4111 (0.4483) acc_x 93.7500 (89.3750) lr 9.3721e-04 eta 0:00:11
epoch [106/200] batch [10/37] time 0.345 (0.354) data 0.267 (0.276) loss_x loss_x 0.2180 (0.3953) acc_x 100.0000 (90.9375) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [15/37] time 0.345 (0.352) data 0.268 (0.274) loss_x loss_x 0.5166 (0.3750) acc_x 90.6250 (91.4583) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [20/37] time 0.345 (0.352) data 0.267 (0.274) loss_x loss_x 0.3770 (0.3898) acc_x 87.5000 (90.7812) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [25/37] time 0.349 (0.350) data 0.272 (0.273) loss_x loss_x 0.5596 (0.4103) acc_x 93.7500 (90.8750) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [30/37] time 0.346 (0.349) data 0.269 (0.271) loss_x loss_x 0.2452 (0.3983) acc_x 96.8750 (91.4583) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [35/37] time 0.341 (0.349) data 0.264 (0.271) loss_x loss_x 0.2891 (0.3886) acc_x 93.7500 (91.6071) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.7482, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1221
clean true:1220
clean false:1
clean_rate:0.9991809991809992
noisy true:160
noisy false:251
after delete: len(clean_dataset) 1221
after delete: len(noisy_dataset) 411
epoch [107/200] batch [5/38] time 0.354 (0.359) data 0.276 (0.281) loss_x loss_x 0.4983 (0.5124) acc_x 84.3750 (88.7500) lr 9.2154e-04 eta 0:00:11
epoch [107/200] batch [10/38] time 0.341 (0.351) data 0.263 (0.273) loss_x loss_x 0.5615 (0.4723) acc_x 84.3750 (89.0625) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [15/38] time 0.320 (0.341) data 0.242 (0.263) loss_x loss_x 0.6514 (0.4576) acc_x 87.5000 (89.7917) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [20/38] time 0.303 (0.331) data 0.225 (0.253) loss_x loss_x 0.3379 (0.4241) acc_x 87.5000 (90.1562) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [25/38] time 0.327 (0.327) data 0.250 (0.249) loss_x loss_x 0.2783 (0.3948) acc_x 90.6250 (91.0000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [30/38] time 0.325 (0.329) data 0.247 (0.251) loss_x loss_x 0.3374 (0.4234) acc_x 93.7500 (90.2083) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [35/38] time 0.289 (0.330) data 0.211 (0.252) loss_x loss_x 0.5156 (0.4297) acc_x 84.3750 (89.9107) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.7512, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1226
clean true:1225
clean false:1
clean_rate:0.9991843393148451
noisy true:164
noisy false:242
after delete: len(clean_dataset) 1226
after delete: len(noisy_dataset) 406
epoch [108/200] batch [5/38] time 0.350 (0.354) data 0.271 (0.276) loss_x loss_x 0.2041 (0.3766) acc_x 90.6250 (91.8750) lr 9.0589e-04 eta 0:00:11
epoch [108/200] batch [10/38] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.6763 (0.4146) acc_x 81.2500 (90.9375) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [15/38] time 0.347 (0.348) data 0.269 (0.270) loss_x loss_x 0.5059 (0.4534) acc_x 84.3750 (90.0000) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [20/38] time 0.347 (0.343) data 0.270 (0.266) loss_x loss_x 0.4480 (0.4567) acc_x 90.6250 (89.6875) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [25/38] time 0.343 (0.344) data 0.265 (0.267) loss_x loss_x 0.2369 (0.4328) acc_x 93.7500 (90.1250) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [30/38] time 0.341 (0.345) data 0.264 (0.267) loss_x loss_x 0.4397 (0.4263) acc_x 84.3750 (90.0000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [35/38] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.4338 (0.4078) acc_x 93.7500 (90.8036) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.7567, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1235
clean true:1234
clean false:1
clean_rate:0.9991902834008097
noisy true:170
noisy false:227
after delete: len(clean_dataset) 1235
after delete: len(noisy_dataset) 397
epoch [109/200] batch [5/38] time 0.332 (0.345) data 0.254 (0.268) loss_x loss_x 0.1785 (0.2428) acc_x 100.0000 (95.6250) lr 8.9027e-04 eta 0:00:11
epoch [109/200] batch [10/38] time 0.340 (0.344) data 0.263 (0.267) loss_x loss_x 0.3674 (0.3170) acc_x 96.8750 (93.7500) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [15/38] time 0.353 (0.346) data 0.276 (0.269) loss_x loss_x 0.3186 (0.3023) acc_x 90.6250 (93.9583) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [20/38] time 0.336 (0.345) data 0.258 (0.268) loss_x loss_x 0.3757 (0.3281) acc_x 90.6250 (93.2812) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [25/38] time 0.358 (0.345) data 0.281 (0.268) loss_x loss_x 0.2441 (0.3360) acc_x 96.8750 (93.0000) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [30/38] time 0.353 (0.346) data 0.275 (0.269) loss_x loss_x 0.3564 (0.3354) acc_x 93.7500 (93.0208) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [35/38] time 0.340 (0.345) data 0.262 (0.268) loss_x loss_x 0.2910 (0.3533) acc_x 93.7500 (92.2321) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.7475, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1220
clean true:1219
clean false:1
clean_rate:0.9991803278688525
noisy true:161
noisy false:251
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 412
epoch [110/200] batch [5/38] time 0.342 (0.340) data 0.265 (0.262) loss_x loss_x 0.2057 (0.3613) acc_x 96.8750 (92.5000) lr 8.7467e-04 eta 0:00:11
epoch [110/200] batch [10/38] time 0.344 (0.340) data 0.266 (0.262) loss_x loss_x 0.2664 (0.3621) acc_x 96.8750 (92.5000) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [15/38] time 0.337 (0.342) data 0.260 (0.264) loss_x loss_x 0.6230 (0.3997) acc_x 84.3750 (91.4583) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [20/38] time 0.335 (0.342) data 0.257 (0.264) loss_x loss_x 0.1494 (0.3859) acc_x 100.0000 (91.8750) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [25/38] time 0.314 (0.335) data 0.236 (0.257) loss_x loss_x 0.1760 (0.3618) acc_x 100.0000 (92.8750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [30/38] time 0.350 (0.337) data 0.273 (0.259) loss_x loss_x 0.3184 (0.3549) acc_x 93.7500 (92.9167) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [35/38] time 0.358 (0.338) data 0.280 (0.260) loss_x loss_x 0.2323 (0.3493) acc_x 96.8750 (92.7679) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.7525, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1228
clean true:1227
clean false:1
clean_rate:0.999185667752443
noisy true:168
noisy false:236
after delete: len(clean_dataset) 1228
after delete: len(noisy_dataset) 404
epoch [111/200] batch [5/38] time 0.330 (0.345) data 0.252 (0.266) loss_x loss_x 0.3411 (0.3098) acc_x 93.7500 (93.1250) lr 8.5910e-04 eta 0:00:11
epoch [111/200] batch [10/38] time 0.334 (0.345) data 0.255 (0.267) loss_x loss_x 0.6738 (0.3755) acc_x 84.3750 (91.8750) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [15/38] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.4404 (0.3941) acc_x 87.5000 (91.2500) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [20/38] time 0.302 (0.343) data 0.224 (0.265) loss_x loss_x 0.5518 (0.3861) acc_x 81.2500 (90.9375) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [25/38] time 0.357 (0.342) data 0.280 (0.264) loss_x loss_x 0.5161 (0.4115) acc_x 87.5000 (89.7500) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [30/38] time 0.358 (0.346) data 0.281 (0.268) loss_x loss_x 0.4683 (0.4152) acc_x 90.6250 (89.7917) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [35/38] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.5068 (0.4076) acc_x 90.6250 (90.0000) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.7531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1229
clean true:1228
clean false:1
clean_rate:0.9991863303498779
noisy true:165
noisy false:238
after delete: len(clean_dataset) 1229
after delete: len(noisy_dataset) 403
epoch [112/200] batch [5/38] time 0.336 (0.344) data 0.258 (0.267) loss_x loss_x 0.7261 (0.5358) acc_x 84.3750 (90.6250) lr 8.4357e-04 eta 0:00:11
epoch [112/200] batch [10/38] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.4153 (0.4520) acc_x 87.5000 (91.5625) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [15/38] time 0.339 (0.344) data 0.261 (0.267) loss_x loss_x 0.2512 (0.4419) acc_x 93.7500 (91.2500) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [20/38] time 0.335 (0.343) data 0.257 (0.266) loss_x loss_x 0.2344 (0.4433) acc_x 100.0000 (91.0938) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [25/38] time 0.352 (0.344) data 0.274 (0.266) loss_x loss_x 0.4353 (0.4236) acc_x 96.8750 (91.6250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [30/38] time 0.339 (0.343) data 0.262 (0.265) loss_x loss_x 0.3167 (0.4141) acc_x 90.6250 (91.6667) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [35/38] time 0.347 (0.343) data 0.268 (0.265) loss_x loss_x 0.3218 (0.4198) acc_x 90.6250 (91.1607) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.7439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1214
clean true:1213
clean false:1
clean_rate:0.999176276771005
noisy true:170
noisy false:248
after delete: len(clean_dataset) 1214
after delete: len(noisy_dataset) 418
epoch [113/200] batch [5/37] time 0.359 (0.349) data 0.281 (0.271) loss_x loss_x 0.2289 (0.5589) acc_x 90.6250 (86.8750) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [10/37] time 0.350 (0.347) data 0.271 (0.270) loss_x loss_x 0.3210 (0.4326) acc_x 93.7500 (90.3125) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [15/37] time 0.356 (0.345) data 0.279 (0.267) loss_x loss_x 0.3835 (0.3997) acc_x 93.7500 (91.0417) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [20/37] time 0.321 (0.345) data 0.243 (0.267) loss_x loss_x 0.5698 (0.4270) acc_x 87.5000 (90.3125) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [25/37] time 0.354 (0.345) data 0.277 (0.267) loss_x loss_x 0.2983 (0.4075) acc_x 87.5000 (90.3750) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [30/37] time 0.332 (0.345) data 0.254 (0.267) loss_x loss_x 0.5396 (0.4158) acc_x 87.5000 (90.0000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [35/37] time 0.341 (0.344) data 0.264 (0.267) loss_x loss_x 0.2041 (0.4109) acc_x 100.0000 (90.0893) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.7512, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1226
clean true:1225
clean false:1
clean_rate:0.9991843393148451
noisy true:168
noisy false:238
after delete: len(clean_dataset) 1226
after delete: len(noisy_dataset) 406
epoch [114/200] batch [5/38] time 0.349 (0.352) data 0.272 (0.274) loss_x loss_x 0.4028 (0.3677) acc_x 90.6250 (90.0000) lr 8.1262e-04 eta 0:00:11
epoch [114/200] batch [10/38] time 0.321 (0.349) data 0.242 (0.271) loss_x loss_x 0.3455 (0.3230) acc_x 90.6250 (92.5000) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [15/38] time 0.328 (0.344) data 0.251 (0.266) loss_x loss_x 0.3860 (0.3458) acc_x 84.3750 (91.8750) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [20/38] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.4238 (0.3544) acc_x 93.7500 (92.0312) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [25/38] time 0.349 (0.342) data 0.272 (0.265) loss_x loss_x 0.4861 (0.3504) acc_x 93.7500 (92.3750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [30/38] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.1754 (0.3500) acc_x 96.8750 (92.0833) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [35/38] time 0.341 (0.339) data 0.264 (0.262) loss_x loss_x 0.2101 (0.3524) acc_x 93.7500 (91.7857) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.7482, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1221
clean true:1221
clean false:0
clean_rate:1.0
noisy true:167
noisy false:244
after delete: len(clean_dataset) 1221
after delete: len(noisy_dataset) 411
epoch [115/200] batch [5/38] time 0.362 (0.349) data 0.284 (0.271) loss_x loss_x 0.2603 (0.3925) acc_x 96.8750 (93.1250) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [10/38] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.4119 (0.3677) acc_x 90.6250 (92.5000) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [15/38] time 0.335 (0.346) data 0.257 (0.268) loss_x loss_x 0.5669 (0.3815) acc_x 96.8750 (92.2917) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [20/38] time 0.352 (0.346) data 0.274 (0.268) loss_x loss_x 0.3643 (0.3648) acc_x 87.5000 (92.3438) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [25/38] time 0.335 (0.344) data 0.258 (0.267) loss_x loss_x 0.5029 (0.3690) acc_x 87.5000 (91.8750) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [30/38] time 0.347 (0.344) data 0.270 (0.267) loss_x loss_x 0.3076 (0.3862) acc_x 96.8750 (91.8750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [35/38] time 0.329 (0.344) data 0.252 (0.266) loss_x loss_x 0.2406 (0.3947) acc_x 96.8750 (91.5179) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.7567, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1235
clean true:1234
clean false:1
clean_rate:0.9991902834008097
noisy true:173
noisy false:224
after delete: len(clean_dataset) 1235
after delete: len(noisy_dataset) 397
epoch [116/200] batch [5/38] time 0.344 (0.360) data 0.266 (0.283) loss_x loss_x 0.4114 (0.4671) acc_x 96.8750 (90.6250) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [10/38] time 0.341 (0.352) data 0.262 (0.275) loss_x loss_x 0.2874 (0.3930) acc_x 90.6250 (90.9375) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [15/38] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.2991 (0.3788) acc_x 96.8750 (91.2500) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [20/38] time 0.331 (0.348) data 0.253 (0.271) loss_x loss_x 0.3440 (0.3891) acc_x 90.6250 (90.9375) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [25/38] time 0.334 (0.343) data 0.256 (0.266) loss_x loss_x 0.5308 (0.3828) acc_x 93.7500 (91.7500) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [30/38] time 0.333 (0.340) data 0.255 (0.262) loss_x loss_x 0.4561 (0.3794) acc_x 81.2500 (91.4583) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [35/38] time 0.346 (0.340) data 0.268 (0.263) loss_x loss_x 0.2252 (0.3651) acc_x 100.0000 (92.1429) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.7433, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1213
clean true:1212
clean false:1
clean_rate:0.9991755976916735
noisy true:176
noisy false:243
after delete: len(clean_dataset) 1213
after delete: len(noisy_dataset) 419
epoch [117/200] batch [5/37] time 0.335 (0.334) data 0.258 (0.255) loss_x loss_x 0.4382 (0.3613) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:10
epoch [117/200] batch [10/37] time 0.339 (0.337) data 0.262 (0.258) loss_x loss_x 0.6826 (0.4300) acc_x 84.3750 (89.0625) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [15/37] time 0.338 (0.337) data 0.261 (0.259) loss_x loss_x 0.5356 (0.4060) acc_x 90.6250 (90.6250) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [20/37] time 0.336 (0.340) data 0.259 (0.262) loss_x loss_x 0.4802 (0.3804) acc_x 84.3750 (90.9375) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [25/37] time 0.350 (0.338) data 0.272 (0.260) loss_x loss_x 0.2639 (0.3674) acc_x 90.6250 (91.5000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [30/37] time 0.352 (0.340) data 0.275 (0.262) loss_x loss_x 0.4321 (0.3677) acc_x 90.6250 (91.6667) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [35/37] time 0.348 (0.341) data 0.270 (0.263) loss_x loss_x 0.5029 (0.3623) acc_x 84.3750 (91.6071) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.7610, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1242
clean true:1241
clean false:1
clean_rate:0.999194847020934
noisy true:166
noisy false:224
after delete: len(clean_dataset) 1242
after delete: len(noisy_dataset) 390
epoch [118/200] batch [5/38] time 0.326 (0.337) data 0.249 (0.259) loss_x loss_x 0.5732 (0.4186) acc_x 84.3750 (88.7500) lr 7.5131e-04 eta 0:00:11
epoch [118/200] batch [10/38] time 0.361 (0.342) data 0.283 (0.264) loss_x loss_x 0.4924 (0.4216) acc_x 90.6250 (88.7500) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [15/38] time 0.347 (0.341) data 0.270 (0.264) loss_x loss_x 0.2625 (0.3843) acc_x 90.6250 (90.6250) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [20/38] time 0.354 (0.344) data 0.276 (0.266) loss_x loss_x 0.5728 (0.3868) acc_x 87.5000 (90.4688) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [25/38] time 0.338 (0.344) data 0.261 (0.266) loss_x loss_x 0.3511 (0.3914) acc_x 93.7500 (90.3750) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [30/38] time 0.309 (0.338) data 0.232 (0.260) loss_x loss_x 0.3999 (0.3831) acc_x 93.7500 (91.0417) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [35/38] time 0.307 (0.338) data 0.230 (0.260) loss_x loss_x 0.2971 (0.3723) acc_x 93.7500 (91.0714) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.7561, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1234
clean true:1234
clean false:0
clean_rate:1.0
noisy true:168
noisy false:230
after delete: len(clean_dataset) 1234
after delete: len(noisy_dataset) 398
epoch [119/200] batch [5/38] time 0.350 (0.348) data 0.272 (0.271) loss_x loss_x 0.3562 (0.3767) acc_x 96.8750 (93.7500) lr 7.3613e-04 eta 0:00:11
epoch [119/200] batch [10/38] time 0.350 (0.345) data 0.273 (0.268) loss_x loss_x 0.3789 (0.3508) acc_x 87.5000 (93.1250) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [15/38] time 0.350 (0.345) data 0.272 (0.268) loss_x loss_x 0.2925 (0.3569) acc_x 90.6250 (92.0833) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [20/38] time 0.347 (0.346) data 0.270 (0.268) loss_x loss_x 0.3518 (0.3529) acc_x 93.7500 (91.5625) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [25/38] time 0.336 (0.346) data 0.259 (0.268) loss_x loss_x 0.6875 (0.3838) acc_x 78.1250 (90.6250) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [30/38] time 0.311 (0.341) data 0.233 (0.263) loss_x loss_x 0.6880 (0.3965) acc_x 78.1250 (90.5208) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [35/38] time 0.338 (0.338) data 0.261 (0.260) loss_x loss_x 0.5278 (0.3846) acc_x 87.5000 (90.9821) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.7549, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1232
clean true:1231
clean false:1
clean_rate:0.9991883116883117
noisy true:167
noisy false:233
after delete: len(clean_dataset) 1232
after delete: len(noisy_dataset) 400
epoch [120/200] batch [5/38] time 0.341 (0.348) data 0.263 (0.270) loss_x loss_x 0.5288 (0.3048) acc_x 84.3750 (92.5000) lr 7.2101e-04 eta 0:00:11
epoch [120/200] batch [10/38] time 0.315 (0.331) data 0.235 (0.253) loss_x loss_x 0.3237 (0.2974) acc_x 90.6250 (93.4375) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [15/38] time 0.339 (0.329) data 0.262 (0.251) loss_x loss_x 0.2551 (0.3540) acc_x 93.7500 (91.8750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [20/38] time 0.353 (0.336) data 0.276 (0.258) loss_x loss_x 0.1740 (0.3540) acc_x 96.8750 (92.3438) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [25/38] time 0.334 (0.337) data 0.257 (0.260) loss_x loss_x 0.4348 (0.3561) acc_x 90.6250 (92.5000) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [30/38] time 0.356 (0.337) data 0.278 (0.259) loss_x loss_x 0.1588 (0.3504) acc_x 100.0000 (92.6042) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [35/38] time 0.338 (0.338) data 0.261 (0.260) loss_x loss_x 0.5068 (0.3600) acc_x 87.5000 (92.1429) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.7592, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1239
clean true:1238
clean false:1
clean_rate:0.9991928974979822
noisy true:170
noisy false:223
after delete: len(clean_dataset) 1239
after delete: len(noisy_dataset) 393
epoch [121/200] batch [5/38] time 0.362 (0.360) data 0.285 (0.283) loss_x loss_x 0.1807 (0.3512) acc_x 96.8750 (93.1250) lr 7.0596e-04 eta 0:00:11
epoch [121/200] batch [10/38] time 0.340 (0.350) data 0.261 (0.272) loss_x loss_x 0.2339 (0.2829) acc_x 96.8750 (94.3750) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [15/38] time 0.315 (0.346) data 0.237 (0.269) loss_x loss_x 0.3059 (0.3276) acc_x 96.8750 (93.1250) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [20/38] time 0.334 (0.346) data 0.256 (0.268) loss_x loss_x 0.3992 (0.3517) acc_x 90.6250 (92.5000) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [25/38] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.3083 (0.3552) acc_x 90.6250 (92.1250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [30/38] time 0.359 (0.344) data 0.282 (0.267) loss_x loss_x 0.3770 (0.3509) acc_x 81.2500 (91.7708) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [35/38] time 0.325 (0.343) data 0.248 (0.265) loss_x loss_x 0.2399 (0.3544) acc_x 96.8750 (92.2321) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.7506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1225
clean true:1224
clean false:1
clean_rate:0.9991836734693877
noisy true:166
noisy false:241
after delete: len(clean_dataset) 1225
after delete: len(noisy_dataset) 407
epoch [122/200] batch [5/38] time 0.337 (0.350) data 0.259 (0.272) loss_x loss_x 0.1639 (0.3340) acc_x 100.0000 (93.1250) lr 6.9098e-04 eta 0:00:11
epoch [122/200] batch [10/38] time 0.337 (0.347) data 0.260 (0.269) loss_x loss_x 0.3635 (0.3095) acc_x 93.7500 (93.1250) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [15/38] time 0.341 (0.348) data 0.263 (0.270) loss_x loss_x 0.4683 (0.3033) acc_x 90.6250 (93.9583) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [20/38] time 0.335 (0.344) data 0.258 (0.267) loss_x loss_x 0.3804 (0.3187) acc_x 90.6250 (93.2812) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [25/38] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.2118 (0.3304) acc_x 96.8750 (92.8750) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [30/38] time 0.353 (0.344) data 0.276 (0.266) loss_x loss_x 0.3564 (0.3364) acc_x 90.6250 (92.2917) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [35/38] time 0.306 (0.341) data 0.228 (0.263) loss_x loss_x 0.1924 (0.3307) acc_x 96.8750 (92.3214) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.7616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1243
clean true:1241
clean false:2
clean_rate:0.998390989541432
noisy true:165
noisy false:224
after delete: len(clean_dataset) 1243
after delete: len(noisy_dataset) 389
epoch [123/200] batch [5/38] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.7734 (0.5730) acc_x 78.1250 (85.6250) lr 6.7608e-04 eta 0:00:11
epoch [123/200] batch [10/38] time 0.335 (0.339) data 0.257 (0.262) loss_x loss_x 0.3613 (0.4476) acc_x 87.5000 (88.7500) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [15/38] time 0.303 (0.334) data 0.225 (0.256) loss_x loss_x 0.3284 (0.4207) acc_x 93.7500 (89.3750) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [20/38] time 0.352 (0.330) data 0.274 (0.253) loss_x loss_x 0.4358 (0.3997) acc_x 87.5000 (89.5312) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [25/38] time 0.341 (0.332) data 0.264 (0.254) loss_x loss_x 0.1465 (0.3751) acc_x 100.0000 (90.5000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [30/38] time 0.340 (0.335) data 0.262 (0.257) loss_x loss_x 0.2554 (0.3683) acc_x 96.8750 (90.9375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [35/38] time 0.305 (0.335) data 0.226 (0.257) loss_x loss_x 0.1749 (0.3572) acc_x 93.7500 (91.2500) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 221
confident_label rate tensor(0.7610, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1242
clean true:1241
clean false:1
clean_rate:0.999194847020934
noisy true:170
noisy false:220
after delete: len(clean_dataset) 1242
after delete: len(noisy_dataset) 390
epoch [124/200] batch [5/38] time 0.337 (0.338) data 0.260 (0.260) loss_x loss_x 0.5171 (0.3361) acc_x 96.8750 (93.7500) lr 6.6126e-04 eta 0:00:11
epoch [124/200] batch [10/38] time 0.390 (0.348) data 0.311 (0.270) loss_x loss_x 0.2141 (0.3492) acc_x 96.8750 (92.1875) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [15/38] time 0.339 (0.348) data 0.261 (0.270) loss_x loss_x 0.3359 (0.3476) acc_x 93.7500 (92.2917) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [20/38] time 0.311 (0.346) data 0.233 (0.268) loss_x loss_x 0.2966 (0.3258) acc_x 87.5000 (92.5000) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [25/38] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.3440 (0.3265) acc_x 90.6250 (92.2500) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [30/38] time 0.347 (0.344) data 0.270 (0.267) loss_x loss_x 0.3000 (0.3188) acc_x 93.7500 (92.7083) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [35/38] time 0.349 (0.344) data 0.272 (0.267) loss_x loss_x 0.3079 (0.3166) acc_x 90.6250 (92.6786) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.7586, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1238
clean true:1237
clean false:1
clean_rate:0.9991922455573505
noisy true:168
noisy false:226
after delete: len(clean_dataset) 1238
after delete: len(noisy_dataset) 394
epoch [125/200] batch [5/38] time 0.346 (0.352) data 0.266 (0.274) loss_x loss_x 0.3286 (0.3581) acc_x 93.7500 (91.2500) lr 6.4653e-04 eta 0:00:11
epoch [125/200] batch [10/38] time 0.350 (0.350) data 0.273 (0.272) loss_x loss_x 0.3003 (0.3354) acc_x 87.5000 (89.3750) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [15/38] time 0.353 (0.350) data 0.276 (0.272) loss_x loss_x 0.6509 (0.3441) acc_x 81.2500 (90.0000) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [20/38] time 0.351 (0.349) data 0.274 (0.271) loss_x loss_x 0.5376 (0.3389) acc_x 87.5000 (90.4688) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [25/38] time 0.333 (0.347) data 0.256 (0.270) loss_x loss_x 0.5527 (0.3430) acc_x 87.5000 (90.6250) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [30/38] time 0.354 (0.346) data 0.276 (0.269) loss_x loss_x 0.0997 (0.3536) acc_x 100.0000 (90.5208) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [35/38] time 0.338 (0.345) data 0.261 (0.268) loss_x loss_x 0.3418 (0.3526) acc_x 93.7500 (90.8036) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.7653, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1249
clean true:1249
clean false:0
clean_rate:1.0
noisy true:168
noisy false:215
after delete: len(clean_dataset) 1249
after delete: len(noisy_dataset) 383
epoch [126/200] batch [5/39] time 0.338 (0.340) data 0.261 (0.262) loss_x loss_x 0.4802 (0.4201) acc_x 87.5000 (88.1250) lr 6.3188e-04 eta 0:00:11
epoch [126/200] batch [10/39] time 0.345 (0.341) data 0.267 (0.264) loss_x loss_x 0.1962 (0.3945) acc_x 100.0000 (89.3750) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [15/39] time 0.346 (0.343) data 0.269 (0.266) loss_x loss_x 0.5278 (0.3784) acc_x 90.6250 (89.5833) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [20/39] time 0.394 (0.346) data 0.317 (0.269) loss_x loss_x 0.5430 (0.3897) acc_x 90.6250 (90.1562) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [25/39] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.3003 (0.3867) acc_x 96.8750 (90.6250) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [30/39] time 0.298 (0.345) data 0.220 (0.267) loss_x loss_x 0.2979 (0.3717) acc_x 93.7500 (90.9375) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [35/39] time 0.329 (0.340) data 0.251 (0.262) loss_x loss_x 0.2869 (0.3775) acc_x 93.7500 (90.8036) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.7623, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1244
clean true:1243
clean false:1
clean_rate:0.9991961414790996
noisy true:171
noisy false:217
after delete: len(clean_dataset) 1244
after delete: len(noisy_dataset) 388
epoch [127/200] batch [5/38] time 0.347 (0.356) data 0.269 (0.278) loss_x loss_x 0.2155 (0.2649) acc_x 93.7500 (92.5000) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [10/38] time 0.311 (0.344) data 0.233 (0.266) loss_x loss_x 0.5894 (0.3296) acc_x 81.2500 (91.2500) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [15/38] time 0.354 (0.344) data 0.276 (0.266) loss_x loss_x 0.3796 (0.3061) acc_x 93.7500 (92.7083) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [20/38] time 0.351 (0.347) data 0.273 (0.269) loss_x loss_x 0.3157 (0.3472) acc_x 93.7500 (91.7188) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [25/38] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.3623 (0.3335) acc_x 90.6250 (92.0000) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [30/38] time 0.305 (0.345) data 0.226 (0.267) loss_x loss_x 0.3018 (0.3202) acc_x 93.7500 (92.7083) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [35/38] time 0.347 (0.343) data 0.270 (0.265) loss_x loss_x 0.3765 (0.3362) acc_x 90.6250 (91.8750) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.7604, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1241
clean true:1241
clean false:0
clean_rate:1.0
noisy true:172
noisy false:219
after delete: len(clean_dataset) 1241
after delete: len(noisy_dataset) 391
epoch [128/200] batch [5/38] time 0.328 (0.338) data 0.251 (0.259) loss_x loss_x 0.3948 (0.4074) acc_x 87.5000 (91.2500) lr 6.0285e-04 eta 0:00:11
epoch [128/200] batch [10/38] time 0.342 (0.343) data 0.265 (0.265) loss_x loss_x 0.4275 (0.3653) acc_x 87.5000 (92.1875) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [15/38] time 0.347 (0.344) data 0.270 (0.267) loss_x loss_x 0.3101 (0.3882) acc_x 84.3750 (90.4167) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [20/38] time 0.376 (0.348) data 0.298 (0.270) loss_x loss_x 0.1899 (0.3611) acc_x 93.7500 (91.4062) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [25/38] time 0.305 (0.346) data 0.228 (0.268) loss_x loss_x 0.4324 (0.3619) acc_x 93.7500 (91.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [30/38] time 0.340 (0.346) data 0.263 (0.268) loss_x loss_x 0.5962 (0.3532) acc_x 84.3750 (91.8750) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [35/38] time 0.357 (0.344) data 0.279 (0.267) loss_x loss_x 0.4761 (0.3533) acc_x 81.2500 (91.4286) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.7629, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1245
clean true:1244
clean false:1
clean_rate:0.9991967871485944
noisy true:164
noisy false:223
after delete: len(clean_dataset) 1245
after delete: len(noisy_dataset) 387
epoch [129/200] batch [5/38] time 0.348 (0.358) data 0.271 (0.280) loss_x loss_x 0.4644 (0.3643) acc_x 93.7500 (91.2500) lr 5.8849e-04 eta 0:00:11
epoch [129/200] batch [10/38] time 0.331 (0.351) data 0.253 (0.274) loss_x loss_x 0.5317 (0.3270) acc_x 87.5000 (92.1875) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [15/38] time 0.346 (0.350) data 0.268 (0.272) loss_x loss_x 0.3152 (0.3231) acc_x 93.7500 (92.7083) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [20/38] time 0.353 (0.349) data 0.276 (0.271) loss_x loss_x 0.1671 (0.3082) acc_x 96.8750 (92.6562) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [25/38] time 0.368 (0.349) data 0.291 (0.271) loss_x loss_x 0.6118 (0.3229) acc_x 93.7500 (92.8750) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [30/38] time 0.309 (0.343) data 0.231 (0.265) loss_x loss_x 0.3630 (0.3357) acc_x 90.6250 (92.2917) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [35/38] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.3936 (0.3335) acc_x 90.6250 (92.4107) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.7567, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1235
clean true:1234
clean false:1
clean_rate:0.9991902834008097
noisy true:166
noisy false:231
after delete: len(clean_dataset) 1235
after delete: len(noisy_dataset) 397
epoch [130/200] batch [5/38] time 0.345 (0.337) data 0.268 (0.259) loss_x loss_x 0.3010 (0.3414) acc_x 93.7500 (94.3750) lr 5.7422e-04 eta 0:00:11
epoch [130/200] batch [10/38] time 0.336 (0.336) data 0.258 (0.258) loss_x loss_x 0.3853 (0.3684) acc_x 90.6250 (92.5000) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [15/38] time 0.338 (0.336) data 0.261 (0.259) loss_x loss_x 0.2791 (0.3485) acc_x 93.7500 (92.9167) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [20/38] time 0.320 (0.338) data 0.242 (0.260) loss_x loss_x 0.2896 (0.3444) acc_x 93.7500 (92.8125) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [25/38] time 0.352 (0.340) data 0.274 (0.262) loss_x loss_x 0.2722 (0.3461) acc_x 93.7500 (92.8750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [30/38] time 0.345 (0.342) data 0.268 (0.264) loss_x loss_x 0.4041 (0.3406) acc_x 87.5000 (92.9167) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [35/38] time 0.350 (0.344) data 0.273 (0.267) loss_x loss_x 0.3384 (0.3416) acc_x 93.7500 (92.8571) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.7555, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1233
clean true:1232
clean false:1
clean_rate:0.9991889699918897
noisy true:172
noisy false:227
after delete: len(clean_dataset) 1233
after delete: len(noisy_dataset) 399
epoch [131/200] batch [5/38] time 0.349 (0.331) data 0.272 (0.253) loss_x loss_x 0.5576 (0.3459) acc_x 90.6250 (93.1250) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [10/38] time 0.343 (0.335) data 0.265 (0.257) loss_x loss_x 0.1506 (0.3007) acc_x 100.0000 (94.6875) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [15/38] time 0.334 (0.337) data 0.256 (0.259) loss_x loss_x 0.9048 (0.3413) acc_x 81.2500 (92.7083) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [20/38] time 0.350 (0.340) data 0.273 (0.262) loss_x loss_x 0.5830 (0.3598) acc_x 87.5000 (91.7188) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [25/38] time 0.349 (0.340) data 0.271 (0.263) loss_x loss_x 0.2998 (0.3554) acc_x 90.6250 (91.5000) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [30/38] time 0.348 (0.341) data 0.270 (0.263) loss_x loss_x 0.6152 (0.3616) acc_x 84.3750 (91.4583) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [35/38] time 0.338 (0.341) data 0.261 (0.263) loss_x loss_x 0.3015 (0.3495) acc_x 90.6250 (91.4286) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.7537, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1230
clean true:1229
clean false:1
clean_rate:0.9991869918699187
noisy true:168
noisy false:234
after delete: len(clean_dataset) 1230
after delete: len(noisy_dataset) 402
epoch [132/200] batch [5/38] time 0.344 (0.337) data 0.266 (0.260) loss_x loss_x 0.4011 (0.3994) acc_x 87.5000 (90.0000) lr 5.4601e-04 eta 0:00:11
epoch [132/200] batch [10/38] time 0.333 (0.337) data 0.255 (0.260) loss_x loss_x 0.3774 (0.3863) acc_x 93.7500 (90.3125) lr 5.4601e-04 eta 0:00:09
epoch [132/200] batch [15/38] time 0.349 (0.339) data 0.271 (0.262) loss_x loss_x 0.3955 (0.3854) acc_x 90.6250 (90.6250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [20/38] time 0.341 (0.340) data 0.264 (0.262) loss_x loss_x 0.3691 (0.3716) acc_x 90.6250 (90.7812) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [25/38] time 0.323 (0.341) data 0.245 (0.263) loss_x loss_x 0.2043 (0.3683) acc_x 96.8750 (91.1250) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [30/38] time 0.330 (0.340) data 0.252 (0.262) loss_x loss_x 0.1879 (0.3493) acc_x 100.0000 (91.8750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [35/38] time 0.302 (0.335) data 0.224 (0.258) loss_x loss_x 0.5044 (0.3657) acc_x 84.3750 (91.5179) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.7623, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1244
clean true:1243
clean false:1
clean_rate:0.9991961414790996
noisy true:170
noisy false:218
after delete: len(clean_dataset) 1244
after delete: len(noisy_dataset) 388
epoch [133/200] batch [5/38] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.6836 (0.3878) acc_x 90.6250 (93.1250) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [10/38] time 0.346 (0.349) data 0.268 (0.271) loss_x loss_x 0.4167 (0.3817) acc_x 87.5000 (92.5000) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [15/38] time 0.310 (0.343) data 0.232 (0.266) loss_x loss_x 0.1730 (0.3444) acc_x 96.8750 (92.9167) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [20/38] time 0.325 (0.333) data 0.246 (0.256) loss_x loss_x 0.2349 (0.3789) acc_x 96.8750 (91.4062) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [25/38] time 0.376 (0.340) data 0.299 (0.262) loss_x loss_x 0.4243 (0.3640) acc_x 87.5000 (91.7500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [30/38] time 0.343 (0.341) data 0.265 (0.264) loss_x loss_x 0.2244 (0.3520) acc_x 100.0000 (92.0833) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [35/38] time 0.318 (0.341) data 0.241 (0.263) loss_x loss_x 0.3081 (0.3569) acc_x 93.7500 (92.3214) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.7525, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1228
clean true:1227
clean false:1
clean_rate:0.999185667752443
noisy true:167
noisy false:237
after delete: len(clean_dataset) 1228
after delete: len(noisy_dataset) 404
epoch [134/200] batch [5/38] time 0.324 (0.342) data 0.246 (0.264) loss_x loss_x 0.5107 (0.3882) acc_x 81.2500 (88.1250) lr 5.1825e-04 eta 0:00:11
epoch [134/200] batch [10/38] time 0.341 (0.341) data 0.263 (0.264) loss_x loss_x 0.2358 (0.3651) acc_x 96.8750 (90.6250) lr 5.1825e-04 eta 0:00:09
epoch [134/200] batch [15/38] time 0.305 (0.337) data 0.227 (0.260) loss_x loss_x 0.4851 (0.3750) acc_x 87.5000 (90.2083) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [20/38] time 0.353 (0.339) data 0.275 (0.261) loss_x loss_x 0.2046 (0.3431) acc_x 96.8750 (91.4062) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [25/38] time 0.369 (0.341) data 0.292 (0.263) loss_x loss_x 0.2397 (0.3544) acc_x 96.8750 (91.3750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [30/38] time 0.334 (0.341) data 0.257 (0.264) loss_x loss_x 0.7876 (0.3678) acc_x 81.2500 (91.3542) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [35/38] time 0.332 (0.341) data 0.255 (0.264) loss_x loss_x 0.5273 (0.3582) acc_x 90.6250 (91.7857) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.7574, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1236
clean true:1234
clean false:2
clean_rate:0.9983818770226537
noisy true:166
noisy false:230
after delete: len(clean_dataset) 1236
after delete: len(noisy_dataset) 396
epoch [135/200] batch [5/38] time 0.347 (0.337) data 0.270 (0.259) loss_x loss_x 0.3215 (0.3848) acc_x 96.8750 (93.7500) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [10/38] time 0.348 (0.346) data 0.270 (0.269) loss_x loss_x 0.3167 (0.3565) acc_x 93.7500 (93.7500) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [15/38] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.2952 (0.3487) acc_x 90.6250 (93.3333) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [20/38] time 0.358 (0.348) data 0.280 (0.271) loss_x loss_x 0.4846 (0.3441) acc_x 90.6250 (93.2812) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [25/38] time 0.339 (0.348) data 0.262 (0.270) loss_x loss_x 0.6416 (0.3619) acc_x 84.3750 (92.7500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [30/38] time 0.347 (0.347) data 0.270 (0.270) loss_x loss_x 0.2913 (0.3518) acc_x 90.6250 (92.5000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [35/38] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.2859 (0.3385) acc_x 96.8750 (92.6786) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.7678, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1253
clean true:1251
clean false:2
clean_rate:0.9984038308060654
noisy true:168
noisy false:211
after delete: len(clean_dataset) 1253
after delete: len(noisy_dataset) 379
epoch [136/200] batch [5/39] time 0.349 (0.352) data 0.272 (0.275) loss_x loss_x 0.4419 (0.3122) acc_x 93.7500 (93.1250) lr 4.9096e-04 eta 0:00:11
epoch [136/200] batch [10/39] time 0.352 (0.345) data 0.275 (0.268) loss_x loss_x 0.5278 (0.3477) acc_x 93.7500 (92.5000) lr 4.9096e-04 eta 0:00:10
epoch [136/200] batch [15/39] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.2101 (0.3587) acc_x 96.8750 (92.2917) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [20/39] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.2446 (0.3850) acc_x 93.7500 (90.6250) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [25/39] time 0.354 (0.342) data 0.276 (0.264) loss_x loss_x 0.2170 (0.3837) acc_x 96.8750 (91.0000) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [30/39] time 0.345 (0.342) data 0.267 (0.264) loss_x loss_x 0.8198 (0.4051) acc_x 81.2500 (90.5208) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [35/39] time 0.343 (0.342) data 0.265 (0.264) loss_x loss_x 0.3611 (0.3972) acc_x 90.6250 (90.5357) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.7531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1229
clean true:1228
clean false:1
clean_rate:0.9991863303498779
noisy true:170
noisy false:233
after delete: len(clean_dataset) 1229
after delete: len(noisy_dataset) 403
epoch [137/200] batch [5/38] time 0.339 (0.340) data 0.262 (0.262) loss_x loss_x 0.1326 (0.3863) acc_x 100.0000 (91.8750) lr 4.7750e-04 eta 0:00:11
epoch [137/200] batch [10/38] time 0.318 (0.337) data 0.241 (0.260) loss_x loss_x 0.6504 (0.3746) acc_x 84.3750 (92.1875) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [15/38] time 0.332 (0.336) data 0.255 (0.258) loss_x loss_x 0.2327 (0.3711) acc_x 96.8750 (92.0833) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [20/38] time 0.312 (0.330) data 0.233 (0.252) loss_x loss_x 0.2578 (0.3631) acc_x 93.7500 (91.7188) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [25/38] time 0.313 (0.331) data 0.235 (0.253) loss_x loss_x 0.5151 (0.3738) acc_x 90.6250 (91.8750) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [30/38] time 0.343 (0.333) data 0.266 (0.255) loss_x loss_x 0.2086 (0.3529) acc_x 93.7500 (92.2917) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [35/38] time 0.342 (0.334) data 0.265 (0.257) loss_x loss_x 0.2102 (0.3634) acc_x 96.8750 (91.6071) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.7727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1261
clean true:1260
clean false:1
clean_rate:0.9992069785884219
noisy true:170
noisy false:201
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 371
epoch [138/200] batch [5/39] time 0.353 (0.350) data 0.275 (0.272) loss_x loss_x 0.2443 (0.3301) acc_x 93.7500 (94.3750) lr 4.6417e-04 eta 0:00:11
epoch [138/200] batch [10/39] time 0.310 (0.338) data 0.233 (0.260) loss_x loss_x 0.6841 (0.4192) acc_x 90.6250 (91.5625) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [15/39] time 0.328 (0.338) data 0.250 (0.261) loss_x loss_x 0.6650 (0.4356) acc_x 87.5000 (91.2500) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [20/39] time 0.343 (0.341) data 0.266 (0.263) loss_x loss_x 0.3525 (0.4349) acc_x 96.8750 (91.2500) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [25/39] time 0.349 (0.341) data 0.272 (0.264) loss_x loss_x 0.3301 (0.4257) acc_x 90.6250 (90.8750) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [30/39] time 0.367 (0.341) data 0.289 (0.264) loss_x loss_x 0.1907 (0.4253) acc_x 96.8750 (90.5208) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [35/39] time 0.359 (0.343) data 0.281 (0.266) loss_x loss_x 0.1949 (0.4197) acc_x 96.8750 (90.5357) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 203
confident_label rate tensor(0.7702, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1257
clean true:1256
clean false:1
clean_rate:0.9992044550517104
noisy true:173
noisy false:202
after delete: len(clean_dataset) 1257
after delete: len(noisy_dataset) 375
epoch [139/200] batch [5/39] time 0.337 (0.349) data 0.259 (0.271) loss_x loss_x 0.4517 (0.3840) acc_x 87.5000 (91.2500) lr 4.5098e-04 eta 0:00:11
epoch [139/200] batch [10/39] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.4583 (0.3851) acc_x 87.5000 (90.6250) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [15/39] time 0.344 (0.343) data 0.267 (0.265) loss_x loss_x 0.1927 (0.3713) acc_x 96.8750 (91.4583) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [20/39] time 0.301 (0.332) data 0.223 (0.254) loss_x loss_x 0.2971 (0.3525) acc_x 93.7500 (91.8750) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [25/39] time 0.347 (0.330) data 0.270 (0.253) loss_x loss_x 0.3738 (0.3577) acc_x 93.7500 (91.5000) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [30/39] time 0.337 (0.332) data 0.258 (0.255) loss_x loss_x 0.8237 (0.3779) acc_x 78.1250 (91.0417) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [35/39] time 0.336 (0.333) data 0.258 (0.255) loss_x loss_x 0.3406 (0.3767) acc_x 90.6250 (90.8929) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.7672, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1252
clean true:1252
clean false:0
clean_rate:1.0
noisy true:173
noisy false:207
after delete: len(clean_dataset) 1252
after delete: len(noisy_dataset) 380
epoch [140/200] batch [5/39] time 0.351 (0.332) data 0.273 (0.254) loss_x loss_x 0.4355 (0.3371) acc_x 90.6250 (90.6250) lr 4.3792e-04 eta 0:00:11
epoch [140/200] batch [10/39] time 0.339 (0.338) data 0.262 (0.260) loss_x loss_x 0.4038 (0.3612) acc_x 84.3750 (90.9375) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [15/39] time 0.341 (0.340) data 0.264 (0.262) loss_x loss_x 0.2332 (0.3239) acc_x 96.8750 (92.5000) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [20/39] time 0.353 (0.341) data 0.276 (0.264) loss_x loss_x 0.2803 (0.3201) acc_x 93.7500 (92.5000) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [25/39] time 0.308 (0.338) data 0.231 (0.260) loss_x loss_x 0.2354 (0.3347) acc_x 93.7500 (92.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [30/39] time 0.339 (0.338) data 0.261 (0.261) loss_x loss_x 0.3088 (0.3418) acc_x 90.6250 (92.3958) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [35/39] time 0.365 (0.340) data 0.288 (0.262) loss_x loss_x 0.1230 (0.3280) acc_x 96.8750 (92.5893) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 210
confident_label rate tensor(0.7721, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1260
clean true:1258
clean false:2
clean_rate:0.9984126984126984
noisy true:164
noisy false:208
after delete: len(clean_dataset) 1260
after delete: len(noisy_dataset) 372
epoch [141/200] batch [5/39] time 0.308 (0.302) data 0.230 (0.224) loss_x loss_x 0.2434 (0.3403) acc_x 96.8750 (93.1250) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [10/39] time 0.332 (0.320) data 0.255 (0.242) loss_x loss_x 0.7051 (0.4251) acc_x 81.2500 (90.0000) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [15/39] time 0.348 (0.328) data 0.271 (0.251) loss_x loss_x 0.2964 (0.3882) acc_x 90.6250 (90.8333) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [20/39] time 0.351 (0.331) data 0.274 (0.253) loss_x loss_x 0.2494 (0.3809) acc_x 93.7500 (91.4062) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [25/39] time 0.354 (0.334) data 0.277 (0.257) loss_x loss_x 0.3591 (0.3704) acc_x 87.5000 (91.6250) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [30/39] time 0.344 (0.337) data 0.266 (0.259) loss_x loss_x 0.2751 (0.3682) acc_x 93.7500 (91.4583) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [35/39] time 0.346 (0.338) data 0.268 (0.261) loss_x loss_x 0.4563 (0.3874) acc_x 93.7500 (90.9821) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.7708, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1258
clean true:1257
clean false:1
clean_rate:0.9992050874403816
noisy true:166
noisy false:208
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 374
epoch [142/200] batch [5/39] time 0.352 (0.356) data 0.275 (0.279) loss_x loss_x 0.2527 (0.4844) acc_x 93.7500 (90.6250) lr 4.1221e-04 eta 0:00:12
epoch [142/200] batch [10/39] time 0.346 (0.350) data 0.268 (0.273) loss_x loss_x 0.5581 (0.4345) acc_x 87.5000 (91.5625) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [15/39] time 0.358 (0.349) data 0.281 (0.272) loss_x loss_x 0.3279 (0.4015) acc_x 93.7500 (92.0833) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [20/39] time 0.334 (0.347) data 0.257 (0.269) loss_x loss_x 0.4490 (0.3961) acc_x 84.3750 (91.2500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [25/39] time 0.340 (0.348) data 0.262 (0.271) loss_x loss_x 0.6431 (0.3992) acc_x 81.2500 (90.7500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [30/39] time 0.305 (0.342) data 0.227 (0.265) loss_x loss_x 0.1377 (0.3994) acc_x 100.0000 (90.8333) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [35/39] time 0.349 (0.342) data 0.272 (0.265) loss_x loss_x 0.6802 (0.4135) acc_x 81.2500 (90.2679) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 197
confident_label rate tensor(0.7757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:170
noisy false:196
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 366
epoch [143/200] batch [5/39] time 0.308 (0.340) data 0.230 (0.261) loss_x loss_x 0.1958 (0.3632) acc_x 93.7500 (90.0000) lr 3.9958e-04 eta 0:00:11
epoch [143/200] batch [10/39] time 0.346 (0.333) data 0.269 (0.255) loss_x loss_x 0.1108 (0.3156) acc_x 100.0000 (92.5000) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [15/39] time 0.334 (0.336) data 0.257 (0.258) loss_x loss_x 0.1920 (0.3341) acc_x 96.8750 (91.8750) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [20/39] time 0.343 (0.337) data 0.265 (0.259) loss_x loss_x 0.3496 (0.3259) acc_x 96.8750 (92.1875) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [25/39] time 0.324 (0.337) data 0.246 (0.259) loss_x loss_x 0.3916 (0.3213) acc_x 90.6250 (92.2500) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [30/39] time 0.347 (0.337) data 0.269 (0.259) loss_x loss_x 0.1123 (0.3301) acc_x 100.0000 (92.2917) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [35/39] time 0.327 (0.337) data 0.249 (0.260) loss_x loss_x 0.3198 (0.3316) acc_x 96.8750 (92.5000) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.7708, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1258
clean true:1257
clean false:1
clean_rate:0.9992050874403816
noisy true:171
noisy false:203
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 374
epoch [144/200] batch [5/39] time 0.327 (0.328) data 0.249 (0.250) loss_x loss_x 0.4351 (0.5081) acc_x 90.6250 (88.7500) lr 3.8709e-04 eta 0:00:11
epoch [144/200] batch [10/39] time 0.295 (0.318) data 0.217 (0.240) loss_x loss_x 0.2103 (0.4142) acc_x 96.8750 (90.0000) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [15/39] time 0.286 (0.310) data 0.209 (0.232) loss_x loss_x 0.3904 (0.4353) acc_x 90.6250 (89.3750) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [20/39] time 0.291 (0.306) data 0.213 (0.229) loss_x loss_x 0.6260 (0.4282) acc_x 90.6250 (90.1562) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [25/39] time 0.296 (0.305) data 0.218 (0.227) loss_x loss_x 0.3875 (0.4287) acc_x 93.7500 (90.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [30/39] time 0.345 (0.312) data 0.268 (0.234) loss_x loss_x 0.6196 (0.4240) acc_x 84.3750 (90.3125) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [35/39] time 0.342 (0.317) data 0.264 (0.239) loss_x loss_x 0.3442 (0.4112) acc_x 90.6250 (90.5357) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.7592, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1239
clean true:1239
clean false:0
clean_rate:1.0
noisy true:173
noisy false:220
after delete: len(clean_dataset) 1239
after delete: len(noisy_dataset) 393
epoch [145/200] batch [5/38] time 0.294 (0.305) data 0.217 (0.228) loss_x loss_x 0.2639 (0.3811) acc_x 90.6250 (91.2500) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [10/38] time 0.342 (0.314) data 0.265 (0.237) loss_x loss_x 0.5767 (0.3790) acc_x 90.6250 (91.5625) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [15/38] time 0.295 (0.318) data 0.218 (0.241) loss_x loss_x 0.2480 (0.3779) acc_x 96.8750 (91.2500) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [20/38] time 0.341 (0.320) data 0.264 (0.243) loss_x loss_x 0.5474 (0.3639) acc_x 84.3750 (91.5625) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [25/38] time 0.345 (0.324) data 0.268 (0.247) loss_x loss_x 0.1639 (0.3766) acc_x 100.0000 (91.7500) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [30/38] time 0.335 (0.328) data 0.257 (0.250) loss_x loss_x 0.3013 (0.3630) acc_x 93.7500 (92.0833) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [35/38] time 0.342 (0.330) data 0.265 (0.253) loss_x loss_x 0.4055 (0.3655) acc_x 93.7500 (92.1429) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.7672, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1252
clean true:1252
clean false:0
clean_rate:1.0
noisy true:173
noisy false:207
after delete: len(clean_dataset) 1252
after delete: len(noisy_dataset) 380
epoch [146/200] batch [5/39] time 0.346 (0.312) data 0.268 (0.234) loss_x loss_x 0.3647 (0.3034) acc_x 90.6250 (94.3750) lr 3.6258e-04 eta 0:00:10
epoch [146/200] batch [10/39] time 0.296 (0.312) data 0.219 (0.234) loss_x loss_x 0.4062 (0.3573) acc_x 90.6250 (92.5000) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [15/39] time 0.305 (0.308) data 0.227 (0.231) loss_x loss_x 0.4316 (0.3414) acc_x 90.6250 (92.7083) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [20/39] time 0.329 (0.309) data 0.251 (0.232) loss_x loss_x 0.2227 (0.3217) acc_x 96.8750 (93.1250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [25/39] time 0.301 (0.308) data 0.224 (0.231) loss_x loss_x 0.2781 (0.3113) acc_x 93.7500 (93.5000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [30/39] time 0.301 (0.306) data 0.223 (0.228) loss_x loss_x 0.4783 (0.3221) acc_x 90.6250 (93.3333) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [35/39] time 0.303 (0.305) data 0.226 (0.227) loss_x loss_x 0.2250 (0.3245) acc_x 93.7500 (93.1250) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.7806, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1274
clean true:1273
clean false:1
clean_rate:0.9992150706436421
noisy true:164
noisy false:194
after delete: len(clean_dataset) 1274
after delete: len(noisy_dataset) 358
epoch [147/200] batch [5/39] time 0.302 (0.326) data 0.224 (0.248) loss_x loss_x 0.6226 (0.4730) acc_x 84.3750 (87.5000) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [10/39] time 0.304 (0.318) data 0.225 (0.240) loss_x loss_x 0.2336 (0.3631) acc_x 93.7500 (91.2500) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [15/39] time 0.290 (0.311) data 0.212 (0.233) loss_x loss_x 0.6543 (0.3823) acc_x 87.5000 (90.8333) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [20/39] time 0.291 (0.312) data 0.214 (0.234) loss_x loss_x 0.3184 (0.3653) acc_x 93.7500 (91.2500) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [25/39] time 0.290 (0.310) data 0.212 (0.232) loss_x loss_x 0.5278 (0.3940) acc_x 84.3750 (90.6250) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [30/39] time 0.306 (0.308) data 0.230 (0.231) loss_x loss_x 0.5474 (0.3864) acc_x 87.5000 (90.8333) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [35/39] time 0.290 (0.307) data 0.213 (0.229) loss_x loss_x 0.6465 (0.3872) acc_x 81.2500 (90.6250) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.7727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1261
clean true:1260
clean false:1
clean_rate:0.9992069785884219
noisy true:170
noisy false:201
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 371
epoch [148/200] batch [5/39] time 0.350 (0.322) data 0.272 (0.244) loss_x loss_x 0.2900 (0.2665) acc_x 96.8750 (94.3750) lr 3.3869e-04 eta 0:00:10
epoch [148/200] batch [10/39] time 0.291 (0.312) data 0.214 (0.234) loss_x loss_x 0.5845 (0.3153) acc_x 78.1250 (91.8750) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [15/39] time 0.340 (0.315) data 0.262 (0.237) loss_x loss_x 0.3958 (0.3444) acc_x 93.7500 (92.0833) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [20/39] time 0.300 (0.315) data 0.223 (0.238) loss_x loss_x 0.1716 (0.3662) acc_x 96.8750 (91.7188) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [25/39] time 0.302 (0.317) data 0.224 (0.239) loss_x loss_x 0.4038 (0.3613) acc_x 87.5000 (92.0000) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [30/39] time 0.296 (0.314) data 0.218 (0.236) loss_x loss_x 0.3933 (0.3564) acc_x 90.6250 (92.2917) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [35/39] time 0.294 (0.311) data 0.216 (0.233) loss_x loss_x 0.3455 (0.3640) acc_x 90.6250 (92.2321) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.7653, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1249
clean true:1248
clean false:1
clean_rate:0.9991993594875901
noisy true:180
noisy false:203
after delete: len(clean_dataset) 1249
after delete: len(noisy_dataset) 383
epoch [149/200] batch [5/39] time 0.300 (0.302) data 0.222 (0.225) loss_x loss_x 0.3103 (0.2757) acc_x 93.7500 (96.2500) lr 3.2699e-04 eta 0:00:10
epoch [149/200] batch [10/39] time 0.314 (0.303) data 0.236 (0.226) loss_x loss_x 0.3315 (0.3244) acc_x 90.6250 (92.8125) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [15/39] time 0.306 (0.303) data 0.228 (0.225) loss_x loss_x 0.1819 (0.3163) acc_x 96.8750 (93.1250) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [20/39] time 0.326 (0.310) data 0.248 (0.233) loss_x loss_x 0.4812 (0.3216) acc_x 90.6250 (92.6562) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [25/39] time 0.298 (0.308) data 0.221 (0.230) loss_x loss_x 0.2805 (0.3300) acc_x 90.6250 (92.6250) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [30/39] time 0.295 (0.306) data 0.217 (0.228) loss_x loss_x 0.3086 (0.3189) acc_x 93.7500 (93.1250) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [35/39] time 0.295 (0.304) data 0.217 (0.227) loss_x loss_x 0.2983 (0.3325) acc_x 93.7500 (92.6786) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 203
confident_label rate tensor(0.7672, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1252
clean true:1251
clean false:1
clean_rate:0.9992012779552716
noisy true:178
noisy false:202
after delete: len(clean_dataset) 1252
after delete: len(noisy_dataset) 380
epoch [150/200] batch [5/39] time 0.348 (0.346) data 0.271 (0.268) loss_x loss_x 0.3193 (0.2994) acc_x 93.7500 (94.3750) lr 3.1545e-04 eta 0:00:11
epoch [150/200] batch [10/39] time 0.299 (0.337) data 0.221 (0.260) loss_x loss_x 0.2788 (0.3112) acc_x 93.7500 (93.4375) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [15/39] time 0.294 (0.326) data 0.217 (0.249) loss_x loss_x 0.3506 (0.3104) acc_x 90.6250 (93.1250) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [20/39] time 0.293 (0.320) data 0.216 (0.243) loss_x loss_x 0.3875 (0.3199) acc_x 93.7500 (93.2812) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [25/39] time 0.315 (0.317) data 0.237 (0.240) loss_x loss_x 0.3735 (0.3299) acc_x 93.7500 (93.1250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [30/39] time 0.321 (0.317) data 0.243 (0.240) loss_x loss_x 0.7041 (0.3328) acc_x 87.5000 (93.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [35/39] time 0.296 (0.315) data 0.218 (0.237) loss_x loss_x 0.6240 (0.3404) acc_x 81.2500 (92.6786) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.7714, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1259
clean true:1258
clean false:1
clean_rate:0.9992057188244639
noisy true:168
noisy false:205
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 373
epoch [151/200] batch [5/39] time 0.300 (0.295) data 0.222 (0.218) loss_x loss_x 0.3354 (0.3859) acc_x 93.7500 (94.3750) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [10/39] time 0.293 (0.296) data 0.215 (0.218) loss_x loss_x 0.2502 (0.3293) acc_x 96.8750 (94.3750) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [15/39] time 0.300 (0.297) data 0.222 (0.219) loss_x loss_x 0.3801 (0.3497) acc_x 90.6250 (92.7083) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [20/39] time 0.300 (0.299) data 0.222 (0.221) loss_x loss_x 0.4717 (0.3581) acc_x 96.8750 (92.6562) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [25/39] time 0.307 (0.299) data 0.229 (0.221) loss_x loss_x 0.4292 (0.3980) acc_x 87.5000 (91.6250) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [30/39] time 0.297 (0.298) data 0.219 (0.220) loss_x loss_x 0.8242 (0.4005) acc_x 78.1250 (91.4583) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [35/39] time 0.290 (0.298) data 0.212 (0.220) loss_x loss_x 0.4543 (0.3968) acc_x 87.5000 (91.4286) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.7776, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1269
clean true:1268
clean false:1
clean_rate:0.9992119779353822
noisy true:171
noisy false:192
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 363
epoch [152/200] batch [5/39] time 0.357 (0.337) data 0.279 (0.259) loss_x loss_x 0.2474 (0.2735) acc_x 93.7500 (93.7500) lr 2.9289e-04 eta 0:00:11
epoch [152/200] batch [10/39] time 0.342 (0.342) data 0.265 (0.264) loss_x loss_x 0.3538 (0.2677) acc_x 90.6250 (94.3750) lr 2.9289e-04 eta 0:00:09
epoch [152/200] batch [15/39] time 0.339 (0.344) data 0.261 (0.266) loss_x loss_x 0.5342 (0.2985) acc_x 90.6250 (93.9583) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [20/39] time 0.307 (0.337) data 0.229 (0.259) loss_x loss_x 0.5435 (0.3373) acc_x 84.3750 (92.9688) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [25/39] time 0.348 (0.336) data 0.270 (0.258) loss_x loss_x 0.5415 (0.3433) acc_x 84.3750 (92.3750) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [30/39] time 0.335 (0.338) data 0.257 (0.259) loss_x loss_x 0.2225 (0.3329) acc_x 100.0000 (92.8125) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [35/39] time 0.339 (0.338) data 0.261 (0.260) loss_x loss_x 0.2351 (0.3248) acc_x 93.7500 (92.8571) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.7757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:177
noisy false:189
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 366
epoch [153/200] batch [5/39] time 0.297 (0.304) data 0.219 (0.226) loss_x loss_x 0.2451 (0.2242) acc_x 96.8750 (95.6250) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [10/39] time 0.346 (0.313) data 0.270 (0.235) loss_x loss_x 0.2297 (0.2560) acc_x 96.8750 (94.0625) lr 2.8187e-04 eta 0:00:09
epoch [153/200] batch [15/39] time 0.300 (0.309) data 0.222 (0.231) loss_x loss_x 0.2125 (0.2806) acc_x 96.8750 (93.7500) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [20/39] time 0.297 (0.306) data 0.219 (0.228) loss_x loss_x 0.4314 (0.3174) acc_x 93.7500 (93.1250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [25/39] time 0.297 (0.306) data 0.220 (0.228) loss_x loss_x 0.4465 (0.3223) acc_x 90.6250 (92.7500) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [30/39] time 0.294 (0.306) data 0.217 (0.228) loss_x loss_x 0.4365 (0.3154) acc_x 84.3750 (92.9167) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [35/39] time 0.344 (0.310) data 0.267 (0.233) loss_x loss_x 0.4670 (0.3260) acc_x 87.5000 (92.9464) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.7727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1261
clean true:1260
clean false:1
clean_rate:0.9992069785884219
noisy true:185
noisy false:186
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 371
epoch [154/200] batch [5/39] time 0.359 (0.331) data 0.281 (0.253) loss_x loss_x 0.5151 (0.4294) acc_x 84.3750 (90.6250) lr 2.7103e-04 eta 0:00:11
epoch [154/200] batch [10/39] time 0.344 (0.338) data 0.265 (0.260) loss_x loss_x 0.2891 (0.3591) acc_x 96.8750 (93.1250) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [15/39] time 0.338 (0.339) data 0.260 (0.261) loss_x loss_x 0.2537 (0.3600) acc_x 93.7500 (92.7083) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [20/39] time 0.301 (0.335) data 0.223 (0.257) loss_x loss_x 0.2986 (0.3575) acc_x 93.7500 (92.5000) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [25/39] time 0.335 (0.332) data 0.256 (0.254) loss_x loss_x 0.2578 (0.3507) acc_x 93.7500 (92.0000) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [30/39] time 0.335 (0.329) data 0.257 (0.251) loss_x loss_x 0.2969 (0.3438) acc_x 93.7500 (92.0833) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [35/39] time 0.337 (0.326) data 0.259 (0.248) loss_x loss_x 0.2659 (0.3296) acc_x 96.8750 (92.5893) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.7684, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1254
clean true:1252
clean false:2
clean_rate:0.9984051036682615
noisy true:167
noisy false:211
after delete: len(clean_dataset) 1254
after delete: len(noisy_dataset) 378
epoch [155/200] batch [5/39] time 0.304 (0.304) data 0.227 (0.227) loss_x loss_x 0.2808 (0.3343) acc_x 96.8750 (93.1250) lr 2.6037e-04 eta 0:00:10
epoch [155/200] batch [10/39] time 0.293 (0.301) data 0.215 (0.223) loss_x loss_x 0.2046 (0.3077) acc_x 96.8750 (93.7500) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [15/39] time 0.297 (0.298) data 0.218 (0.221) loss_x loss_x 0.2632 (0.3141) acc_x 93.7500 (93.3333) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [20/39] time 0.294 (0.298) data 0.216 (0.220) loss_x loss_x 0.4348 (0.3153) acc_x 84.3750 (93.1250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [25/39] time 0.289 (0.296) data 0.212 (0.219) loss_x loss_x 0.3579 (0.3145) acc_x 93.7500 (93.6250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [30/39] time 0.296 (0.296) data 0.218 (0.218) loss_x loss_x 0.4617 (0.3631) acc_x 87.5000 (92.2917) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [35/39] time 0.286 (0.295) data 0.208 (0.218) loss_x loss_x 0.4321 (0.3610) acc_x 90.6250 (92.4107) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.7733, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1262
clean true:1260
clean false:2
clean_rate:0.9984152139461173
noisy true:172
noisy false:198
after delete: len(clean_dataset) 1262
after delete: len(noisy_dataset) 370
epoch [156/200] batch [5/39] time 0.295 (0.298) data 0.217 (0.220) loss_x loss_x 0.3540 (0.4224) acc_x 90.6250 (90.6250) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [10/39] time 0.294 (0.296) data 0.216 (0.219) loss_x loss_x 0.3018 (0.3746) acc_x 90.6250 (91.2500) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [15/39] time 0.302 (0.296) data 0.224 (0.219) loss_x loss_x 0.2468 (0.3816) acc_x 96.8750 (91.6667) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [20/39] time 0.290 (0.295) data 0.212 (0.217) loss_x loss_x 0.3511 (0.3722) acc_x 90.6250 (91.4062) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [25/39] time 0.295 (0.295) data 0.217 (0.218) loss_x loss_x 0.4570 (0.3587) acc_x 87.5000 (91.6250) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [30/39] time 0.298 (0.295) data 0.221 (0.217) loss_x loss_x 0.2646 (0.3694) acc_x 96.8750 (91.2500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [35/39] time 0.296 (0.295) data 0.219 (0.217) loss_x loss_x 0.7349 (0.3776) acc_x 84.3750 (91.0714) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 172
confident_label rate tensor(0.7874, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1285
clean true:1284
clean false:1
clean_rate:0.9992217898832685
noisy true:176
noisy false:171
after delete: len(clean_dataset) 1285
after delete: len(noisy_dataset) 347
epoch [157/200] batch [5/40] time 0.286 (0.305) data 0.208 (0.227) loss_x loss_x 0.3145 (0.3194) acc_x 90.6250 (90.0000) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [10/40] time 0.290 (0.297) data 0.212 (0.220) loss_x loss_x 0.2271 (0.3045) acc_x 93.7500 (92.1875) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [15/40] time 0.314 (0.303) data 0.236 (0.225) loss_x loss_x 0.2561 (0.2849) acc_x 93.7500 (93.1250) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [20/40] time 0.297 (0.300) data 0.219 (0.223) loss_x loss_x 0.4934 (0.3119) acc_x 87.5000 (92.5000) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [25/40] time 0.304 (0.299) data 0.226 (0.222) loss_x loss_x 0.3379 (0.3392) acc_x 96.8750 (91.7500) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [30/40] time 0.292 (0.298) data 0.214 (0.221) loss_x loss_x 0.4360 (0.3499) acc_x 87.5000 (91.4583) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [35/40] time 0.302 (0.298) data 0.224 (0.220) loss_x loss_x 0.3069 (0.3535) acc_x 90.6250 (91.6071) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [40/40] time 0.292 (0.297) data 0.214 (0.220) loss_x loss_x 0.4097 (0.3627) acc_x 93.7500 (91.3281) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.7714, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1259
clean true:1258
clean false:1
clean_rate:0.9992057188244639
noisy true:176
noisy false:197
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 373
epoch [158/200] batch [5/39] time 0.307 (0.313) data 0.229 (0.235) loss_x loss_x 0.5396 (0.3582) acc_x 87.5000 (93.7500) lr 2.2949e-04 eta 0:00:10
epoch [158/200] batch [10/39] time 0.297 (0.304) data 0.220 (0.226) loss_x loss_x 0.3962 (0.3398) acc_x 87.5000 (93.4375) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [15/39] time 0.297 (0.300) data 0.219 (0.222) loss_x loss_x 0.2644 (0.3298) acc_x 96.8750 (93.3333) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [20/39] time 0.295 (0.299) data 0.217 (0.221) loss_x loss_x 0.3696 (0.3114) acc_x 87.5000 (93.2812) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [25/39] time 0.290 (0.297) data 0.213 (0.220) loss_x loss_x 0.4314 (0.3188) acc_x 90.6250 (93.0000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [30/39] time 0.297 (0.297) data 0.220 (0.219) loss_x loss_x 0.8647 (0.3626) acc_x 84.3750 (91.7708) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [35/39] time 0.297 (0.297) data 0.219 (0.219) loss_x loss_x 0.6104 (0.3754) acc_x 84.3750 (91.3393) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.7757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:172
noisy false:194
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 366
epoch [159/200] batch [5/39] time 0.302 (0.303) data 0.224 (0.225) loss_x loss_x 0.2854 (0.3866) acc_x 93.7500 (90.0000) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [10/39] time 0.295 (0.301) data 0.217 (0.223) loss_x loss_x 0.2483 (0.3077) acc_x 96.8750 (93.1250) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [15/39] time 0.288 (0.297) data 0.211 (0.220) loss_x loss_x 0.2961 (0.3132) acc_x 90.6250 (93.3333) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [20/39] time 0.290 (0.296) data 0.213 (0.218) loss_x loss_x 0.4788 (0.3057) acc_x 87.5000 (93.4375) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [25/39] time 0.285 (0.295) data 0.207 (0.217) loss_x loss_x 0.3936 (0.3063) acc_x 87.5000 (93.1250) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [30/39] time 0.304 (0.295) data 0.225 (0.217) loss_x loss_x 0.2198 (0.3094) acc_x 93.7500 (93.3333) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [35/39] time 0.294 (0.295) data 0.217 (0.217) loss_x loss_x 0.2849 (0.3012) acc_x 90.6250 (93.3929) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.7751, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1265
clean true:1264
clean false:1
clean_rate:0.9992094861660079
noisy true:166
noisy false:201
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 367
epoch [160/200] batch [5/39] time 0.298 (0.302) data 0.221 (0.225) loss_x loss_x 0.0991 (0.1948) acc_x 100.0000 (97.5000) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [10/39] time 0.296 (0.300) data 0.219 (0.222) loss_x loss_x 0.3584 (0.2779) acc_x 87.5000 (95.0000) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [15/39] time 0.293 (0.299) data 0.216 (0.221) loss_x loss_x 0.5498 (0.3053) acc_x 84.3750 (93.7500) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [20/39] time 0.288 (0.297) data 0.211 (0.219) loss_x loss_x 0.2261 (0.3117) acc_x 93.7500 (93.4375) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [25/39] time 0.306 (0.296) data 0.229 (0.219) loss_x loss_x 0.1602 (0.3168) acc_x 96.8750 (93.3750) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [30/39] time 0.293 (0.296) data 0.216 (0.218) loss_x loss_x 0.3877 (0.3349) acc_x 90.6250 (92.9167) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [35/39] time 0.299 (0.295) data 0.221 (0.218) loss_x loss_x 0.2133 (0.3392) acc_x 100.0000 (92.8571) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.7855, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1282
clean true:1282
clean false:0
clean_rate:1.0
noisy true:174
noisy false:176
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 350
epoch [161/200] batch [5/40] time 0.297 (0.295) data 0.219 (0.218) loss_x loss_x 0.3313 (0.3646) acc_x 96.8750 (92.5000) lr 2.0032e-04 eta 0:00:10
epoch [161/200] batch [10/40] time 0.306 (0.296) data 0.228 (0.218) loss_x loss_x 0.1830 (0.3426) acc_x 100.0000 (93.1250) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [15/40] time 0.307 (0.296) data 0.229 (0.219) loss_x loss_x 0.1182 (0.3310) acc_x 96.8750 (92.5000) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [20/40] time 0.292 (0.296) data 0.214 (0.219) loss_x loss_x 0.3638 (0.3311) acc_x 90.6250 (92.9688) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [25/40] time 0.286 (0.296) data 0.209 (0.218) loss_x loss_x 0.2439 (0.3388) acc_x 93.7500 (92.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [30/40] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.5522 (0.3546) acc_x 84.3750 (91.9792) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [35/40] time 0.292 (0.295) data 0.214 (0.217) loss_x loss_x 0.2944 (0.3439) acc_x 93.7500 (92.2321) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [40/40] time 0.291 (0.295) data 0.213 (0.217) loss_x loss_x 0.1892 (0.3435) acc_x 96.8750 (92.3438) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 184
confident_label rate tensor(0.7812, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1275
clean true:1274
clean false:1
clean_rate:0.9992156862745099
noisy true:174
noisy false:183
after delete: len(clean_dataset) 1275
after delete: len(noisy_dataset) 357
epoch [162/200] batch [5/39] time 0.304 (0.299) data 0.226 (0.221) loss_x loss_x 0.1770 (0.3009) acc_x 96.8750 (95.0000) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [10/39] time 0.290 (0.297) data 0.212 (0.219) loss_x loss_x 0.3174 (0.3084) acc_x 93.7500 (93.7500) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [15/39] time 0.292 (0.295) data 0.214 (0.218) loss_x loss_x 0.3196 (0.3253) acc_x 96.8750 (93.7500) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [20/39] time 0.290 (0.295) data 0.212 (0.218) loss_x loss_x 0.4375 (0.3243) acc_x 90.6250 (93.4375) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [25/39] time 0.286 (0.295) data 0.208 (0.217) loss_x loss_x 0.5083 (0.3281) acc_x 87.5000 (93.0000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [30/39] time 0.291 (0.295) data 0.213 (0.217) loss_x loss_x 0.2744 (0.3151) acc_x 93.7500 (93.4375) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [35/39] time 0.290 (0.295) data 0.213 (0.217) loss_x loss_x 0.2954 (0.3138) acc_x 93.7500 (93.5714) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.7776, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1269
clean true:1268
clean false:1
clean_rate:0.9992119779353822
noisy true:178
noisy false:185
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 363
epoch [163/200] batch [5/39] time 0.289 (0.285) data 0.211 (0.207) loss_x loss_x 0.3198 (0.3289) acc_x 90.6250 (92.5000) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [10/39] time 0.296 (0.289) data 0.218 (0.212) loss_x loss_x 0.1846 (0.3433) acc_x 96.8750 (92.8125) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [15/39] time 0.288 (0.291) data 0.211 (0.213) loss_x loss_x 0.3108 (0.3194) acc_x 96.8750 (93.5417) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [20/39] time 0.301 (0.291) data 0.223 (0.213) loss_x loss_x 0.2583 (0.3501) acc_x 93.7500 (92.1875) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [25/39] time 0.296 (0.291) data 0.218 (0.214) loss_x loss_x 0.2649 (0.3482) acc_x 93.7500 (92.5000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [30/39] time 0.295 (0.291) data 0.217 (0.214) loss_x loss_x 0.3982 (0.3440) acc_x 90.6250 (92.2917) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [35/39] time 0.286 (0.292) data 0.209 (0.214) loss_x loss_x 0.4739 (0.3401) acc_x 84.3750 (92.3214) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.7721, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1260
clean true:1259
clean false:1
clean_rate:0.9992063492063492
noisy true:177
noisy false:195
after delete: len(clean_dataset) 1260
after delete: len(noisy_dataset) 372
epoch [164/200] batch [5/39] time 0.300 (0.304) data 0.223 (0.227) loss_x loss_x 0.4204 (0.3937) acc_x 90.6250 (88.7500) lr 1.7292e-04 eta 0:00:10
epoch [164/200] batch [10/39] time 0.297 (0.302) data 0.220 (0.224) loss_x loss_x 0.1248 (0.3245) acc_x 96.8750 (91.5625) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [15/39] time 0.298 (0.300) data 0.221 (0.223) loss_x loss_x 0.2910 (0.3380) acc_x 93.7500 (91.6667) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [20/39] time 0.313 (0.301) data 0.236 (0.223) loss_x loss_x 0.2296 (0.3472) acc_x 93.7500 (91.0938) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [25/39] time 0.302 (0.299) data 0.225 (0.222) loss_x loss_x 0.1798 (0.3263) acc_x 96.8750 (91.8750) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [30/39] time 0.302 (0.298) data 0.224 (0.221) loss_x loss_x 0.3367 (0.3273) acc_x 90.6250 (92.1875) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [35/39] time 0.296 (0.297) data 0.219 (0.220) loss_x loss_x 0.2399 (0.3318) acc_x 96.8750 (92.2321) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.7782, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1270
clean true:1267
clean false:3
clean_rate:0.9976377952755906
noisy true:175
noisy false:187
after delete: len(clean_dataset) 1270
after delete: len(noisy_dataset) 362
epoch [165/200] batch [5/39] time 0.294 (0.289) data 0.217 (0.211) loss_x loss_x 0.2639 (0.4580) acc_x 96.8750 (90.6250) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [10/39] time 0.292 (0.292) data 0.215 (0.214) loss_x loss_x 0.2332 (0.3583) acc_x 93.7500 (92.8125) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [15/39] time 0.292 (0.294) data 0.215 (0.216) loss_x loss_x 0.3130 (0.3506) acc_x 90.6250 (92.0833) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [20/39] time 0.287 (0.295) data 0.209 (0.217) loss_x loss_x 0.3479 (0.3353) acc_x 87.5000 (92.5000) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [25/39] time 0.299 (0.294) data 0.221 (0.216) loss_x loss_x 0.4431 (0.3399) acc_x 90.6250 (92.6250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [30/39] time 0.305 (0.294) data 0.228 (0.216) loss_x loss_x 0.4983 (0.3409) acc_x 93.7500 (92.8125) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [35/39] time 0.300 (0.294) data 0.222 (0.216) loss_x loss_x 0.2666 (0.3483) acc_x 100.0000 (92.5893) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.7770, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1268
clean true:1267
clean false:1
clean_rate:0.999211356466877
noisy true:174
noisy false:190
after delete: len(clean_dataset) 1268
after delete: len(noisy_dataset) 364
epoch [166/200] batch [5/39] time 0.292 (0.292) data 0.214 (0.214) loss_x loss_x 0.3235 (0.2845) acc_x 87.5000 (93.7500) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [10/39] time 0.292 (0.291) data 0.214 (0.213) loss_x loss_x 0.3557 (0.3154) acc_x 90.6250 (93.4375) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [15/39] time 0.299 (0.292) data 0.221 (0.214) loss_x loss_x 0.5850 (0.3225) acc_x 84.3750 (93.1250) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [20/39] time 0.301 (0.293) data 0.224 (0.215) loss_x loss_x 0.0695 (0.2973) acc_x 100.0000 (93.7500) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [25/39] time 0.295 (0.293) data 0.217 (0.215) loss_x loss_x 0.5190 (0.3002) acc_x 81.2500 (93.3750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [30/39] time 0.290 (0.293) data 0.212 (0.215) loss_x loss_x 0.3184 (0.3122) acc_x 93.7500 (92.6042) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [35/39] time 0.295 (0.293) data 0.217 (0.216) loss_x loss_x 0.5908 (0.3154) acc_x 87.5000 (92.7679) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.7837, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1279
clean true:1277
clean false:2
clean_rate:0.9984362783424551
noisy true:172
noisy false:181
after delete: len(clean_dataset) 1279
after delete: len(noisy_dataset) 353
epoch [167/200] batch [5/39] time 0.308 (0.309) data 0.230 (0.231) loss_x loss_x 0.4807 (0.2958) acc_x 90.6250 (93.7500) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [10/39] time 0.296 (0.301) data 0.218 (0.224) loss_x loss_x 0.2732 (0.3263) acc_x 96.8750 (91.8750) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [15/39] time 0.300 (0.299) data 0.222 (0.221) loss_x loss_x 0.1099 (0.3370) acc_x 96.8750 (91.8750) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [20/39] time 0.289 (0.298) data 0.211 (0.220) loss_x loss_x 0.3887 (0.3416) acc_x 93.7500 (92.1875) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [25/39] time 0.298 (0.298) data 0.220 (0.220) loss_x loss_x 0.4353 (0.3424) acc_x 84.3750 (92.1250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [30/39] time 0.299 (0.297) data 0.221 (0.219) loss_x loss_x 0.2742 (0.3481) acc_x 93.7500 (91.7708) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [35/39] time 0.298 (0.297) data 0.220 (0.219) loss_x loss_x 0.4993 (0.3496) acc_x 93.7500 (91.9643) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.7739, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1263
clean true:1263
clean false:0
clean_rate:1.0
noisy true:167
noisy false:202
after delete: len(clean_dataset) 1263
after delete: len(noisy_dataset) 369
epoch [168/200] batch [5/39] time 0.291 (0.291) data 0.213 (0.213) loss_x loss_x 0.3916 (0.3611) acc_x 87.5000 (91.2500) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [10/39] time 0.287 (0.291) data 0.209 (0.214) loss_x loss_x 0.2269 (0.3387) acc_x 93.7500 (91.5625) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [15/39] time 0.282 (0.291) data 0.204 (0.213) loss_x loss_x 0.2427 (0.3158) acc_x 96.8750 (92.7083) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [20/39] time 0.290 (0.290) data 0.213 (0.213) loss_x loss_x 0.3223 (0.3346) acc_x 93.7500 (91.8750) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [25/39] time 0.285 (0.291) data 0.207 (0.213) loss_x loss_x 0.3105 (0.3355) acc_x 93.7500 (91.8750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [30/39] time 0.283 (0.290) data 0.206 (0.213) loss_x loss_x 0.2363 (0.3344) acc_x 96.8750 (92.1875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [35/39] time 0.293 (0.291) data 0.216 (0.213) loss_x loss_x 0.2666 (0.3323) acc_x 93.7500 (92.1429) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.7745, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1264
clean true:1263
clean false:1
clean_rate:0.9992088607594937
noisy true:177
noisy false:191
after delete: len(clean_dataset) 1264
after delete: len(noisy_dataset) 368
epoch [169/200] batch [5/39] time 0.309 (0.304) data 0.232 (0.226) loss_x loss_x 0.4446 (0.4096) acc_x 87.5000 (92.5000) lr 1.3137e-04 eta 0:00:10
epoch [169/200] batch [10/39] time 0.298 (0.303) data 0.220 (0.225) loss_x loss_x 0.4158 (0.3763) acc_x 87.5000 (92.8125) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [15/39] time 0.293 (0.301) data 0.215 (0.223) loss_x loss_x 0.3306 (0.3619) acc_x 93.7500 (93.1250) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [20/39] time 0.289 (0.299) data 0.212 (0.221) loss_x loss_x 0.3062 (0.3524) acc_x 93.7500 (93.1250) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [25/39] time 0.293 (0.298) data 0.215 (0.221) loss_x loss_x 0.3567 (0.3522) acc_x 90.6250 (93.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [30/39] time 0.285 (0.298) data 0.207 (0.220) loss_x loss_x 0.3682 (0.3630) acc_x 93.7500 (92.5000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [35/39] time 0.296 (0.297) data 0.219 (0.219) loss_x loss_x 0.5005 (0.3685) acc_x 93.7500 (92.4107) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 179
confident_label rate tensor(0.7782, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1270
clean true:1269
clean false:1
clean_rate:0.9992125984251968
noisy true:184
noisy false:178
after delete: len(clean_dataset) 1270
after delete: len(noisy_dataset) 362
epoch [170/200] batch [5/39] time 0.296 (0.297) data 0.218 (0.219) loss_x loss_x 0.2172 (0.3473) acc_x 96.8750 (93.1250) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [10/39] time 0.304 (0.297) data 0.227 (0.219) loss_x loss_x 0.3647 (0.3174) acc_x 90.6250 (92.1875) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [15/39] time 0.302 (0.298) data 0.224 (0.220) loss_x loss_x 0.0870 (0.3065) acc_x 100.0000 (92.5000) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [20/39] time 0.290 (0.297) data 0.212 (0.219) loss_x loss_x 0.6377 (0.3436) acc_x 87.5000 (92.1875) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [25/39] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.4580 (0.3353) acc_x 87.5000 (92.3750) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [30/39] time 0.292 (0.295) data 0.215 (0.218) loss_x loss_x 0.3669 (0.3310) acc_x 93.7500 (92.2917) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [35/39] time 0.295 (0.297) data 0.218 (0.219) loss_x loss_x 0.1119 (0.3263) acc_x 100.0000 (92.5000) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.7739, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1263
clean true:1262
clean false:1
clean_rate:0.9992082343626286
noisy true:178
noisy false:191
after delete: len(clean_dataset) 1263
after delete: len(noisy_dataset) 369
epoch [171/200] batch [5/39] time 0.303 (0.301) data 0.225 (0.223) loss_x loss_x 0.1543 (0.3510) acc_x 100.0000 (93.7500) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [10/39] time 0.299 (0.304) data 0.222 (0.226) loss_x loss_x 0.1932 (0.2703) acc_x 96.8750 (95.0000) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [15/39] time 0.297 (0.303) data 0.219 (0.225) loss_x loss_x 0.1432 (0.2683) acc_x 100.0000 (95.4167) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [20/39] time 0.287 (0.300) data 0.210 (0.222) loss_x loss_x 0.6416 (0.2903) acc_x 84.3750 (94.6875) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [25/39] time 0.306 (0.299) data 0.228 (0.221) loss_x loss_x 0.3794 (0.3103) acc_x 93.7500 (93.7500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [30/39] time 0.290 (0.298) data 0.212 (0.220) loss_x loss_x 0.1159 (0.3099) acc_x 100.0000 (93.6458) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [35/39] time 0.296 (0.297) data 0.218 (0.219) loss_x loss_x 0.3462 (0.3170) acc_x 90.6250 (93.3036) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.7898, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1289
clean true:1288
clean false:1
clean_rate:0.9992242048099301
noisy true:170
noisy false:173
after delete: len(clean_dataset) 1289
after delete: len(noisy_dataset) 343
epoch [172/200] batch [5/40] time 0.308 (0.309) data 0.231 (0.232) loss_x loss_x 0.2944 (0.3138) acc_x 93.7500 (93.1250) lr 1.0899e-04 eta 0:00:10
epoch [172/200] batch [10/40] time 0.297 (0.302) data 0.219 (0.225) loss_x loss_x 0.3174 (0.3515) acc_x 90.6250 (92.8125) lr 1.0899e-04 eta 0:00:09
epoch [172/200] batch [15/40] time 0.290 (0.299) data 0.213 (0.222) loss_x loss_x 0.3784 (0.3312) acc_x 90.6250 (92.9167) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [20/40] time 0.289 (0.297) data 0.211 (0.219) loss_x loss_x 0.4709 (0.3543) acc_x 90.6250 (92.0312) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [25/40] time 0.300 (0.297) data 0.223 (0.219) loss_x loss_x 0.3164 (0.3609) acc_x 90.6250 (91.8750) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [30/40] time 0.295 (0.297) data 0.218 (0.219) loss_x loss_x 0.2118 (0.3602) acc_x 96.8750 (91.7708) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [35/40] time 0.301 (0.297) data 0.223 (0.219) loss_x loss_x 0.1821 (0.3490) acc_x 96.8750 (91.9643) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [40/40] time 0.291 (0.296) data 0.213 (0.219) loss_x loss_x 0.5977 (0.3466) acc_x 84.3750 (92.1094) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.7757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:180
noisy false:186
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 366
epoch [173/200] batch [5/39] time 0.291 (0.293) data 0.213 (0.215) loss_x loss_x 0.4189 (0.3007) acc_x 87.5000 (93.1250) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [10/39] time 0.297 (0.293) data 0.219 (0.215) loss_x loss_x 0.1727 (0.2858) acc_x 96.8750 (92.5000) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [15/39] time 0.294 (0.293) data 0.216 (0.215) loss_x loss_x 0.2549 (0.3032) acc_x 93.7500 (92.7083) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [20/39] time 0.295 (0.295) data 0.217 (0.217) loss_x loss_x 0.3152 (0.3062) acc_x 87.5000 (92.8125) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [25/39] time 0.295 (0.294) data 0.217 (0.216) loss_x loss_x 0.3110 (0.3132) acc_x 96.8750 (92.8750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [30/39] time 0.290 (0.294) data 0.212 (0.217) loss_x loss_x 0.3613 (0.3073) acc_x 93.7500 (93.2292) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [35/39] time 0.309 (0.295) data 0.232 (0.217) loss_x loss_x 0.3167 (0.3052) acc_x 90.6250 (93.3036) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.7812, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1275
clean true:1275
clean false:0
clean_rate:1.0
noisy true:170
noisy false:187
after delete: len(clean_dataset) 1275
after delete: len(noisy_dataset) 357
epoch [174/200] batch [5/39] time 0.300 (0.304) data 0.222 (0.227) loss_x loss_x 0.4348 (0.3464) acc_x 87.5000 (91.2500) lr 9.5173e-05 eta 0:00:10
epoch [174/200] batch [10/39] time 0.293 (0.298) data 0.216 (0.221) loss_x loss_x 0.3467 (0.3140) acc_x 93.7500 (91.8750) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [15/39] time 0.283 (0.297) data 0.205 (0.220) loss_x loss_x 0.4016 (0.3285) acc_x 87.5000 (91.8750) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [20/39] time 0.290 (0.296) data 0.212 (0.219) loss_x loss_x 0.2654 (0.3336) acc_x 93.7500 (91.5625) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [25/39] time 0.286 (0.296) data 0.208 (0.219) loss_x loss_x 0.4834 (0.3389) acc_x 84.3750 (91.3750) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [30/39] time 0.296 (0.295) data 0.218 (0.218) loss_x loss_x 0.2463 (0.3430) acc_x 96.8750 (91.4583) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [35/39] time 0.295 (0.295) data 0.217 (0.217) loss_x loss_x 0.3809 (0.3557) acc_x 90.6250 (91.0714) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.7751, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1265
clean true:1264
clean false:1
clean_rate:0.9992094861660079
noisy true:177
noisy false:190
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 367
epoch [175/200] batch [5/39] time 0.287 (0.294) data 0.209 (0.217) loss_x loss_x 0.4985 (0.3893) acc_x 90.6250 (89.3750) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [10/39] time 0.297 (0.296) data 0.220 (0.219) loss_x loss_x 0.2534 (0.3828) acc_x 90.6250 (90.3125) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [15/39] time 0.285 (0.295) data 0.207 (0.218) loss_x loss_x 0.4319 (0.3577) acc_x 93.7500 (91.6667) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [20/39] time 0.307 (0.296) data 0.229 (0.219) loss_x loss_x 0.2119 (0.3421) acc_x 100.0000 (92.1875) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [25/39] time 0.299 (0.296) data 0.221 (0.219) loss_x loss_x 0.2067 (0.3166) acc_x 93.7500 (93.0000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [30/39] time 0.288 (0.296) data 0.210 (0.219) loss_x loss_x 0.5327 (0.3159) acc_x 87.5000 (92.7083) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [35/39] time 0.286 (0.295) data 0.209 (0.218) loss_x loss_x 0.5273 (0.3264) acc_x 87.5000 (92.5893) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.7849, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1281
clean true:1279
clean false:2
clean_rate:0.9984387197501952
noisy true:170
noisy false:181
after delete: len(clean_dataset) 1281
after delete: len(noisy_dataset) 351
epoch [176/200] batch [5/40] time 0.293 (0.292) data 0.215 (0.214) loss_x loss_x 0.2966 (0.2670) acc_x 93.7500 (96.2500) lr 8.2245e-05 eta 0:00:10
epoch [176/200] batch [10/40] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.5684 (0.3184) acc_x 87.5000 (94.0625) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [15/40] time 0.301 (0.298) data 0.223 (0.221) loss_x loss_x 0.2355 (0.3116) acc_x 93.7500 (94.3750) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [20/40] time 0.299 (0.297) data 0.221 (0.219) loss_x loss_x 0.3069 (0.3313) acc_x 93.7500 (93.7500) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [25/40] time 0.299 (0.297) data 0.221 (0.220) loss_x loss_x 0.5396 (0.3409) acc_x 84.3750 (93.0000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [30/40] time 0.299 (0.297) data 0.221 (0.219) loss_x loss_x 0.2952 (0.3415) acc_x 93.7500 (93.1250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [35/40] time 0.294 (0.298) data 0.217 (0.220) loss_x loss_x 0.2070 (0.3326) acc_x 93.7500 (93.3929) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [40/40] time 0.289 (0.298) data 0.212 (0.220) loss_x loss_x 0.7344 (0.3338) acc_x 84.3750 (93.3594) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.7751, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1265
clean true:1264
clean false:1
clean_rate:0.9992094861660079
noisy true:176
noisy false:191
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 367
epoch [177/200] batch [5/39] time 0.296 (0.295) data 0.218 (0.217) loss_x loss_x 0.1057 (0.2671) acc_x 100.0000 (93.7500) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [10/39] time 0.286 (0.295) data 0.208 (0.217) loss_x loss_x 0.3679 (0.2958) acc_x 87.5000 (92.5000) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [15/39] time 0.293 (0.295) data 0.215 (0.217) loss_x loss_x 0.4031 (0.2918) acc_x 84.3750 (92.9167) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [20/39] time 0.297 (0.295) data 0.219 (0.217) loss_x loss_x 0.0964 (0.2827) acc_x 100.0000 (93.4375) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [25/39] time 0.289 (0.294) data 0.211 (0.217) loss_x loss_x 0.2634 (0.2971) acc_x 96.8750 (93.2500) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [30/39] time 0.299 (0.295) data 0.221 (0.217) loss_x loss_x 0.1564 (0.2891) acc_x 96.8750 (93.5417) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [35/39] time 0.297 (0.295) data 0.220 (0.218) loss_x loss_x 0.3020 (0.2936) acc_x 93.7500 (93.7500) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.7745, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1264
clean true:1262
clean false:2
clean_rate:0.9984177215189873
noisy true:170
noisy false:198
after delete: len(clean_dataset) 1264
after delete: len(noisy_dataset) 368
epoch [178/200] batch [5/39] time 0.300 (0.300) data 0.222 (0.223) loss_x loss_x 0.5703 (0.3324) acc_x 87.5000 (93.7500) lr 7.0224e-05 eta 0:00:10
epoch [178/200] batch [10/39] time 0.290 (0.298) data 0.212 (0.220) loss_x loss_x 0.2939 (0.3737) acc_x 93.7500 (93.7500) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [15/39] time 0.294 (0.298) data 0.216 (0.220) loss_x loss_x 0.2595 (0.3779) acc_x 93.7500 (92.7083) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [20/39] time 0.291 (0.298) data 0.213 (0.220) loss_x loss_x 0.4104 (0.3599) acc_x 90.6250 (92.8125) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [25/39] time 0.290 (0.297) data 0.212 (0.220) loss_x loss_x 0.2460 (0.3824) acc_x 93.7500 (91.8750) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [30/39] time 0.299 (0.298) data 0.221 (0.220) loss_x loss_x 0.2349 (0.3741) acc_x 90.6250 (91.9792) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [35/39] time 0.293 (0.297) data 0.215 (0.219) loss_x loss_x 0.2454 (0.3755) acc_x 93.7500 (92.1429) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.7727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1261
clean true:1259
clean false:2
clean_rate:0.9984139571768438
noisy true:179
noisy false:192
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 371
epoch [179/200] batch [5/39] time 0.306 (0.299) data 0.228 (0.220) loss_x loss_x 0.3601 (0.2657) acc_x 90.6250 (94.3750) lr 6.4556e-05 eta 0:00:10
epoch [179/200] batch [10/39] time 0.291 (0.299) data 0.213 (0.221) loss_x loss_x 0.3657 (0.3253) acc_x 93.7500 (92.8125) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [15/39] time 0.298 (0.300) data 0.220 (0.222) loss_x loss_x 0.2358 (0.3271) acc_x 96.8750 (93.1250) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [20/39] time 0.295 (0.300) data 0.217 (0.222) loss_x loss_x 0.3174 (0.3249) acc_x 93.7500 (93.4375) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [25/39] time 0.332 (0.304) data 0.254 (0.226) loss_x loss_x 0.3970 (0.3420) acc_x 84.3750 (92.5000) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [30/39] time 0.320 (0.305) data 0.242 (0.227) loss_x loss_x 0.2817 (0.3458) acc_x 93.7500 (92.5000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [35/39] time 0.298 (0.304) data 0.220 (0.226) loss_x loss_x 0.5112 (0.3514) acc_x 93.7500 (92.3214) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.7714, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1259
clean true:1258
clean false:1
clean_rate:0.9992057188244639
noisy true:168
noisy false:205
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 373
epoch [180/200] batch [5/39] time 0.297 (0.294) data 0.219 (0.217) loss_x loss_x 0.2751 (0.3697) acc_x 93.7500 (90.6250) lr 5.9119e-05 eta 0:00:10
epoch [180/200] batch [10/39] time 0.296 (0.295) data 0.218 (0.217) loss_x loss_x 0.1516 (0.3566) acc_x 100.0000 (91.5625) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [15/39] time 0.298 (0.295) data 0.220 (0.218) loss_x loss_x 0.3503 (0.3775) acc_x 90.6250 (91.4583) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [20/39] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.4658 (0.3642) acc_x 87.5000 (92.0312) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [25/39] time 0.293 (0.295) data 0.215 (0.217) loss_x loss_x 0.5068 (0.3712) acc_x 87.5000 (92.1250) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [30/39] time 0.295 (0.296) data 0.217 (0.218) loss_x loss_x 0.1521 (0.3544) acc_x 96.8750 (92.7083) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [35/39] time 0.292 (0.296) data 0.214 (0.218) loss_x loss_x 0.4333 (0.3455) acc_x 87.5000 (92.7679) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.7837, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1279
clean true:1277
clean false:2
clean_rate:0.9984362783424551
noisy true:172
noisy false:181
after delete: len(clean_dataset) 1279
after delete: len(noisy_dataset) 353
epoch [181/200] batch [5/39] time 0.306 (0.298) data 0.229 (0.221) loss_x loss_x 0.4253 (0.3811) acc_x 90.6250 (90.0000) lr 5.3915e-05 eta 0:00:10
epoch [181/200] batch [10/39] time 0.308 (0.299) data 0.230 (0.221) loss_x loss_x 0.3879 (0.3398) acc_x 90.6250 (91.5625) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [15/39] time 0.296 (0.298) data 0.218 (0.220) loss_x loss_x 0.2798 (0.3426) acc_x 93.7500 (92.5000) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [20/39] time 0.302 (0.297) data 0.224 (0.219) loss_x loss_x 0.1613 (0.3460) acc_x 100.0000 (92.3438) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [25/39] time 0.287 (0.298) data 0.209 (0.221) loss_x loss_x 0.4763 (0.3575) acc_x 81.2500 (91.7500) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [30/39] time 0.292 (0.298) data 0.216 (0.220) loss_x loss_x 0.4495 (0.3552) acc_x 90.6250 (91.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [35/39] time 0.303 (0.298) data 0.226 (0.220) loss_x loss_x 0.2458 (0.3377) acc_x 96.8750 (92.1429) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 203
confident_label rate tensor(0.7727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1261
clean true:1259
clean false:2
clean_rate:0.9984139571768438
noisy true:170
noisy false:201
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 371
epoch [182/200] batch [5/39] time 0.300 (0.304) data 0.222 (0.226) loss_x loss_x 0.3538 (0.3460) acc_x 90.6250 (91.2500) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [10/39] time 0.297 (0.301) data 0.219 (0.223) loss_x loss_x 0.3347 (0.3500) acc_x 93.7500 (91.8750) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [15/39] time 0.305 (0.301) data 0.227 (0.223) loss_x loss_x 0.1909 (0.3625) acc_x 96.8750 (91.6667) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [20/39] time 0.295 (0.300) data 0.215 (0.222) loss_x loss_x 0.1895 (0.3643) acc_x 93.7500 (91.5625) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [25/39] time 0.291 (0.301) data 0.213 (0.223) loss_x loss_x 0.3872 (0.3646) acc_x 93.7500 (92.0000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [30/39] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.3000 (0.3516) acc_x 93.7500 (92.2917) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [35/39] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.4587 (0.3508) acc_x 87.5000 (92.0536) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.7868, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1284
clean true:1282
clean false:2
clean_rate:0.9984423676012462
noisy true:174
noisy false:174
after delete: len(clean_dataset) 1284
after delete: len(noisy_dataset) 348
epoch [183/200] batch [5/40] time 0.293 (0.299) data 0.215 (0.221) loss_x loss_x 0.4294 (0.2464) acc_x 93.7500 (96.8750) lr 4.4207e-05 eta 0:00:10
epoch [183/200] batch [10/40] time 0.284 (0.295) data 0.207 (0.218) loss_x loss_x 0.5488 (0.3290) acc_x 84.3750 (94.0625) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [15/40] time 0.297 (0.296) data 0.219 (0.218) loss_x loss_x 0.2369 (0.3309) acc_x 93.7500 (93.7500) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [20/40] time 0.294 (0.296) data 0.217 (0.218) loss_x loss_x 0.3318 (0.3057) acc_x 93.7500 (94.5312) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [25/40] time 0.297 (0.296) data 0.220 (0.218) loss_x loss_x 0.3301 (0.3207) acc_x 90.6250 (93.7500) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [30/40] time 0.307 (0.297) data 0.229 (0.219) loss_x loss_x 0.1615 (0.3441) acc_x 100.0000 (93.2292) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [35/40] time 0.298 (0.297) data 0.220 (0.219) loss_x loss_x 0.1467 (0.3418) acc_x 100.0000 (93.2143) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [40/40] time 0.293 (0.297) data 0.215 (0.219) loss_x loss_x 0.6436 (0.3431) acc_x 84.3750 (93.2031) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 182
confident_label rate tensor(0.7788, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1271
clean true:1269
clean false:2
clean_rate:0.998426435877262
noisy true:181
noisy false:180
after delete: len(clean_dataset) 1271
after delete: len(noisy_dataset) 361
epoch [184/200] batch [5/39] time 0.292 (0.296) data 0.215 (0.218) loss_x loss_x 0.3535 (0.3966) acc_x 90.6250 (90.0000) lr 3.9706e-05 eta 0:00:10
epoch [184/200] batch [10/39] time 0.289 (0.295) data 0.211 (0.217) loss_x loss_x 0.5386 (0.3882) acc_x 87.5000 (90.9375) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [15/39] time 0.292 (0.295) data 0.214 (0.217) loss_x loss_x 0.4492 (0.3961) acc_x 87.5000 (91.0417) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [20/39] time 0.294 (0.296) data 0.216 (0.218) loss_x loss_x 0.4595 (0.3934) acc_x 87.5000 (91.2500) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [25/39] time 0.277 (0.293) data 0.199 (0.215) loss_x loss_x 0.2939 (0.3700) acc_x 93.7500 (91.7500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [30/39] time 0.295 (0.293) data 0.217 (0.215) loss_x loss_x 0.3628 (0.3524) acc_x 93.7500 (91.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [35/39] time 0.299 (0.295) data 0.222 (0.217) loss_x loss_x 0.3979 (0.3444) acc_x 87.5000 (91.9643) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 172
confident_label rate tensor(0.7855, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1282
clean true:1280
clean false:2
clean_rate:0.9984399375975039
noisy true:180
noisy false:170
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 350
epoch [185/200] batch [5/40] time 0.298 (0.295) data 0.220 (0.217) loss_x loss_x 0.4011 (0.3263) acc_x 87.5000 (93.1250) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [10/40] time 0.293 (0.295) data 0.215 (0.217) loss_x loss_x 0.1986 (0.3139) acc_x 96.8750 (94.3750) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [15/40] time 0.296 (0.295) data 0.218 (0.217) loss_x loss_x 0.3137 (0.3330) acc_x 93.7500 (93.1250) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [20/40] time 0.300 (0.296) data 0.222 (0.218) loss_x loss_x 0.3066 (0.3380) acc_x 90.6250 (93.2812) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [25/40] time 0.287 (0.295) data 0.209 (0.217) loss_x loss_x 0.3225 (0.3377) acc_x 87.5000 (93.0000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [30/40] time 0.296 (0.295) data 0.218 (0.217) loss_x loss_x 0.4468 (0.3437) acc_x 90.6250 (92.6042) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [35/40] time 0.306 (0.295) data 0.228 (0.217) loss_x loss_x 0.3774 (0.3561) acc_x 87.5000 (92.3214) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [40/40] time 0.302 (0.296) data 0.224 (0.218) loss_x loss_x 0.3093 (0.3653) acc_x 93.7500 (92.0312) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.7843, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1280
clean true:1279
clean false:1
clean_rate:0.99921875
noisy true:173
noisy false:179
after delete: len(clean_dataset) 1280
after delete: len(noisy_dataset) 352
epoch [186/200] batch [5/40] time 0.296 (0.301) data 0.219 (0.223) loss_x loss_x 0.3425 (0.2589) acc_x 90.6250 (94.3750) lr 3.1417e-05 eta 0:00:10
epoch [186/200] batch [10/40] time 0.298 (0.297) data 0.221 (0.220) loss_x loss_x 0.4290 (0.3127) acc_x 84.3750 (92.8125) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [15/40] time 0.291 (0.296) data 0.214 (0.218) loss_x loss_x 0.2563 (0.3482) acc_x 96.8750 (91.2500) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [20/40] time 0.305 (0.297) data 0.228 (0.219) loss_x loss_x 0.3772 (0.3178) acc_x 93.7500 (92.5000) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [25/40] time 0.290 (0.297) data 0.213 (0.219) loss_x loss_x 0.2493 (0.3014) acc_x 90.6250 (92.8750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [30/40] time 0.290 (0.297) data 0.212 (0.219) loss_x loss_x 0.3779 (0.3076) acc_x 90.6250 (92.8125) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [35/40] time 0.295 (0.296) data 0.218 (0.219) loss_x loss_x 0.6108 (0.3250) acc_x 84.3750 (92.5000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [40/40] time 0.294 (0.296) data 0.216 (0.219) loss_x loss_x 0.4231 (0.3274) acc_x 93.7500 (92.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.7763, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1267
clean true:1266
clean false:1
clean_rate:0.9992107340173638
noisy true:177
noisy false:188
after delete: len(clean_dataset) 1267
after delete: len(noisy_dataset) 365
epoch [187/200] batch [5/39] time 0.298 (0.296) data 0.221 (0.217) loss_x loss_x 0.7686 (0.4528) acc_x 75.0000 (86.8750) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [10/39] time 0.294 (0.296) data 0.217 (0.218) loss_x loss_x 0.2023 (0.3914) acc_x 96.8750 (90.0000) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [15/39] time 0.319 (0.299) data 0.242 (0.221) loss_x loss_x 0.3223 (0.3725) acc_x 90.6250 (90.4167) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [20/39] time 0.295 (0.298) data 0.218 (0.220) loss_x loss_x 0.1818 (0.3484) acc_x 100.0000 (91.5625) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [25/39] time 0.300 (0.298) data 0.222 (0.220) loss_x loss_x 0.2062 (0.3412) acc_x 96.8750 (92.0000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [30/39] time 0.303 (0.298) data 0.224 (0.220) loss_x loss_x 0.2058 (0.3301) acc_x 96.8750 (92.6042) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [35/39] time 0.296 (0.298) data 0.219 (0.221) loss_x loss_x 0.2966 (0.3213) acc_x 90.6250 (92.8571) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.7800, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1273
clean true:1272
clean false:1
clean_rate:0.9992144540455616
noisy true:169
noisy false:190
after delete: len(clean_dataset) 1273
after delete: len(noisy_dataset) 359
epoch [188/200] batch [5/39] time 0.300 (0.294) data 0.221 (0.216) loss_x loss_x 0.2400 (0.3720) acc_x 100.0000 (93.1250) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [10/39] time 0.302 (0.299) data 0.224 (0.221) loss_x loss_x 0.2932 (0.3383) acc_x 96.8750 (94.6875) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [15/39] time 0.298 (0.299) data 0.220 (0.221) loss_x loss_x 0.6519 (0.3643) acc_x 87.5000 (92.7083) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [20/39] time 0.290 (0.298) data 0.212 (0.220) loss_x loss_x 0.3184 (0.3630) acc_x 90.6250 (92.3438) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [25/39] time 0.312 (0.299) data 0.235 (0.221) loss_x loss_x 0.2356 (0.3622) acc_x 96.8750 (92.3750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [30/39] time 0.307 (0.298) data 0.230 (0.221) loss_x loss_x 0.3894 (0.3642) acc_x 93.7500 (92.3958) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [35/39] time 0.304 (0.299) data 0.227 (0.221) loss_x loss_x 0.4961 (0.3627) acc_x 93.7500 (92.5893) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 171
confident_label rate tensor(0.7849, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1281
clean true:1280
clean false:1
clean_rate:0.9992193598750976
noisy true:181
noisy false:170
after delete: len(clean_dataset) 1281
after delete: len(noisy_dataset) 351
epoch [189/200] batch [5/40] time 0.300 (0.300) data 0.223 (0.222) loss_x loss_x 0.2087 (0.3695) acc_x 96.8750 (91.8750) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [10/40] time 0.296 (0.299) data 0.219 (0.221) loss_x loss_x 0.4006 (0.3508) acc_x 90.6250 (92.5000) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [15/40] time 0.284 (0.296) data 0.207 (0.218) loss_x loss_x 0.5815 (0.3678) acc_x 84.3750 (91.4583) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [20/40] time 0.286 (0.294) data 0.208 (0.216) loss_x loss_x 0.3887 (0.3640) acc_x 93.7500 (91.7188) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [25/40] time 0.293 (0.294) data 0.216 (0.216) loss_x loss_x 0.2939 (0.3568) acc_x 90.6250 (91.7500) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [30/40] time 0.291 (0.293) data 0.213 (0.215) loss_x loss_x 0.2430 (0.3585) acc_x 96.8750 (91.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [35/40] time 0.288 (0.293) data 0.211 (0.216) loss_x loss_x 0.6040 (0.3723) acc_x 81.2500 (91.4286) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [40/40] time 0.285 (0.292) data 0.207 (0.214) loss_x loss_x 0.2720 (0.3747) acc_x 96.8750 (91.3281) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 175
confident_label rate tensor(0.7868, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1284
clean true:1283
clean false:1
clean_rate:0.9992211838006231
noisy true:174
noisy false:174
after delete: len(clean_dataset) 1284
after delete: len(noisy_dataset) 348
epoch [190/200] batch [5/40] time 0.299 (0.294) data 0.221 (0.217) loss_x loss_x 0.2202 (0.3175) acc_x 93.7500 (95.0000) lr 1.7713e-05 eta 0:00:10
epoch [190/200] batch [10/40] time 0.292 (0.295) data 0.215 (0.217) loss_x loss_x 0.2930 (0.3067) acc_x 96.8750 (93.7500) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [15/40] time 0.292 (0.295) data 0.214 (0.217) loss_x loss_x 0.3015 (0.3311) acc_x 93.7500 (92.5000) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [20/40] time 0.296 (0.298) data 0.218 (0.221) loss_x loss_x 0.2156 (0.3334) acc_x 96.8750 (92.8125) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [25/40] time 0.289 (0.297) data 0.211 (0.219) loss_x loss_x 0.3811 (0.3391) acc_x 93.7500 (92.3750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [30/40] time 0.301 (0.296) data 0.223 (0.219) loss_x loss_x 0.1703 (0.3239) acc_x 100.0000 (92.7083) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [35/40] time 0.284 (0.296) data 0.206 (0.218) loss_x loss_x 0.2214 (0.3146) acc_x 93.7500 (92.9464) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [40/40] time 0.290 (0.295) data 0.212 (0.217) loss_x loss_x 0.6455 (0.3373) acc_x 84.3750 (92.5781) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.7757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:171
noisy false:195
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 366
epoch [191/200] batch [5/39] time 0.285 (0.296) data 0.208 (0.218) loss_x loss_x 0.3787 (0.2447) acc_x 90.6250 (96.2500) lr 1.4891e-05 eta 0:00:10
epoch [191/200] batch [10/39] time 0.304 (0.298) data 0.226 (0.221) loss_x loss_x 0.2156 (0.3120) acc_x 100.0000 (93.7500) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [15/39] time 0.295 (0.297) data 0.217 (0.219) loss_x loss_x 0.4307 (0.3359) acc_x 87.5000 (93.1250) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [20/39] time 0.293 (0.297) data 0.216 (0.220) loss_x loss_x 0.3887 (0.3217) acc_x 90.6250 (93.2812) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [25/39] time 0.292 (0.297) data 0.213 (0.219) loss_x loss_x 0.1384 (0.3103) acc_x 96.8750 (93.8750) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [30/39] time 0.286 (0.295) data 0.207 (0.217) loss_x loss_x 0.2988 (0.3136) acc_x 93.7500 (93.7500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [35/39] time 0.287 (0.294) data 0.209 (0.216) loss_x loss_x 0.1372 (0.3182) acc_x 100.0000 (93.3929) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.7806, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1274
clean true:1272
clean false:2
clean_rate:0.9984301412872841
noisy true:172
noisy false:186
after delete: len(clean_dataset) 1274
after delete: len(noisy_dataset) 358
epoch [192/200] batch [5/39] time 0.309 (0.314) data 0.230 (0.235) loss_x loss_x 0.1100 (0.2993) acc_x 100.0000 (93.1250) lr 1.2312e-05 eta 0:00:10
epoch [192/200] batch [10/39] time 0.309 (0.310) data 0.231 (0.231) loss_x loss_x 0.1137 (0.2771) acc_x 100.0000 (93.4375) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [15/39] time 0.315 (0.308) data 0.236 (0.229) loss_x loss_x 0.1923 (0.2710) acc_x 93.7500 (93.3333) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [20/39] time 0.306 (0.307) data 0.228 (0.229) loss_x loss_x 0.3643 (0.3181) acc_x 90.6250 (91.8750) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [25/39] time 0.306 (0.307) data 0.227 (0.228) loss_x loss_x 0.3989 (0.3180) acc_x 87.5000 (92.2500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [30/39] time 0.310 (0.307) data 0.231 (0.228) loss_x loss_x 0.3904 (0.3219) acc_x 84.3750 (91.6667) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [35/39] time 0.306 (0.307) data 0.228 (0.228) loss_x loss_x 0.1960 (0.3166) acc_x 96.8750 (92.0536) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.7714, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1259
clean true:1258
clean false:1
clean_rate:0.9992057188244639
noisy true:172
noisy false:201
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 373
epoch [193/200] batch [5/39] time 0.286 (0.281) data 0.208 (0.203) loss_x loss_x 0.5967 (0.4581) acc_x 84.3750 (90.6250) lr 9.9763e-06 eta 0:00:09
epoch [193/200] batch [10/39] time 0.275 (0.282) data 0.197 (0.204) loss_x loss_x 0.6860 (0.4177) acc_x 81.2500 (91.2500) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [15/39] time 0.278 (0.281) data 0.200 (0.204) loss_x loss_x 0.5732 (0.3999) acc_x 87.5000 (91.4583) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [20/39] time 0.313 (0.287) data 0.233 (0.209) loss_x loss_x 0.2874 (0.3632) acc_x 96.8750 (92.6562) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [25/39] time 0.282 (0.286) data 0.204 (0.208) loss_x loss_x 0.3247 (0.3749) acc_x 90.6250 (92.0000) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [30/39] time 0.286 (0.285) data 0.208 (0.207) loss_x loss_x 0.2786 (0.3772) acc_x 96.8750 (91.9792) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [35/39] time 0.274 (0.284) data 0.196 (0.206) loss_x loss_x 0.4358 (0.3742) acc_x 87.5000 (91.6071) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.7812, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1275
clean true:1273
clean false:2
clean_rate:0.9984313725490196
noisy true:173
noisy false:184
after delete: len(clean_dataset) 1275
after delete: len(noisy_dataset) 357
epoch [194/200] batch [5/39] time 0.281 (0.284) data 0.203 (0.207) loss_x loss_x 0.1604 (0.2427) acc_x 93.7500 (94.3750) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [10/39] time 0.289 (0.285) data 0.211 (0.207) loss_x loss_x 0.2347 (0.2823) acc_x 90.6250 (93.4375) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [15/39] time 0.290 (0.284) data 0.213 (0.206) loss_x loss_x 0.1500 (0.3326) acc_x 100.0000 (92.7083) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [20/39] time 0.285 (0.284) data 0.208 (0.206) loss_x loss_x 0.2866 (0.3421) acc_x 96.8750 (92.9688) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [25/39] time 0.289 (0.285) data 0.211 (0.207) loss_x loss_x 0.1598 (0.3192) acc_x 96.8750 (93.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [30/39] time 0.295 (0.285) data 0.218 (0.207) loss_x loss_x 0.3430 (0.3287) acc_x 87.5000 (92.8125) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [35/39] time 0.283 (0.285) data 0.205 (0.207) loss_x loss_x 0.4885 (0.3496) acc_x 87.5000 (92.4107) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 175
confident_label rate tensor(0.7880, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1286
clean true:1286
clean false:0
clean_rate:1.0
noisy true:171
noisy false:175
after delete: len(clean_dataset) 1286
after delete: len(noisy_dataset) 346
epoch [195/200] batch [5/40] time 0.285 (0.282) data 0.208 (0.204) loss_x loss_x 0.2083 (0.3721) acc_x 96.8750 (93.7500) lr 6.0390e-06 eta 0:00:09
epoch [195/200] batch [10/40] time 0.281 (0.284) data 0.203 (0.206) loss_x loss_x 0.3503 (0.3482) acc_x 90.6250 (92.8125) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [15/40] time 0.277 (0.284) data 0.199 (0.206) loss_x loss_x 0.4871 (0.3223) acc_x 84.3750 (93.1250) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [20/40] time 0.282 (0.284) data 0.204 (0.207) loss_x loss_x 0.2913 (0.3326) acc_x 93.7500 (92.8125) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [25/40] time 0.278 (0.284) data 0.200 (0.206) loss_x loss_x 0.3853 (0.3435) acc_x 90.6250 (92.5000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [30/40] time 0.283 (0.284) data 0.206 (0.206) loss_x loss_x 0.2042 (0.3573) acc_x 96.8750 (92.0833) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [35/40] time 0.285 (0.284) data 0.207 (0.206) loss_x loss_x 0.2140 (0.3477) acc_x 96.8750 (92.3214) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [40/40] time 0.278 (0.284) data 0.200 (0.206) loss_x loss_x 0.4353 (0.3477) acc_x 90.6250 (92.4219) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 160
confident_label rate tensor(0.7929, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1294
clean true:1293
clean false:1
clean_rate:0.999227202472952
noisy true:179
noisy false:159
after delete: len(clean_dataset) 1294
after delete: len(noisy_dataset) 338
epoch [196/200] batch [5/40] time 0.286 (0.287) data 0.208 (0.209) loss_x loss_x 0.2225 (0.3054) acc_x 100.0000 (91.8750) lr 4.4380e-06 eta 0:00:10
epoch [196/200] batch [10/40] time 0.287 (0.288) data 0.209 (0.210) loss_x loss_x 0.4304 (0.3462) acc_x 87.5000 (90.9375) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [15/40] time 0.297 (0.287) data 0.219 (0.209) loss_x loss_x 0.4341 (0.3727) acc_x 87.5000 (90.6250) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [20/40] time 0.284 (0.287) data 0.206 (0.209) loss_x loss_x 0.3853 (0.3885) acc_x 90.6250 (90.1562) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [25/40] time 0.295 (0.287) data 0.217 (0.209) loss_x loss_x 0.6665 (0.3672) acc_x 81.2500 (91.1250) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [30/40] time 0.322 (0.289) data 0.244 (0.211) loss_x loss_x 0.3372 (0.3494) acc_x 90.6250 (91.8750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [35/40] time 0.304 (0.292) data 0.225 (0.213) loss_x loss_x 0.4087 (0.3533) acc_x 87.5000 (91.9643) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [40/40] time 0.271 (0.292) data 0.193 (0.214) loss_x loss_x 0.5332 (0.3692) acc_x 87.5000 (91.4844) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 178
confident_label rate tensor(0.7782, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1270
clean true:1269
clean false:1
clean_rate:0.9992125984251968
noisy true:185
noisy false:177
after delete: len(clean_dataset) 1270
after delete: len(noisy_dataset) 362
epoch [197/200] batch [5/39] time 0.277 (0.284) data 0.199 (0.206) loss_x loss_x 0.4456 (0.2723) acc_x 84.3750 (93.7500) lr 3.0827e-06 eta 0:00:09
epoch [197/200] batch [10/39] time 0.283 (0.282) data 0.205 (0.204) loss_x loss_x 0.4392 (0.2986) acc_x 90.6250 (92.5000) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [15/39] time 0.280 (0.281) data 0.202 (0.203) loss_x loss_x 0.2710 (0.2772) acc_x 93.7500 (93.5417) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [20/39] time 0.305 (0.282) data 0.228 (0.204) loss_x loss_x 0.2438 (0.2751) acc_x 96.8750 (93.9062) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [25/39] time 0.293 (0.284) data 0.215 (0.206) loss_x loss_x 0.2539 (0.2980) acc_x 93.7500 (93.3750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [30/39] time 0.293 (0.284) data 0.215 (0.206) loss_x loss_x 0.3125 (0.2971) acc_x 90.6250 (93.5417) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [35/39] time 0.294 (0.285) data 0.216 (0.207) loss_x loss_x 0.2406 (0.3016) acc_x 93.7500 (93.4821) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 166
confident_label rate tensor(0.7892, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1288
clean true:1287
clean false:1
clean_rate:0.9992236024844721
noisy true:179
noisy false:165
after delete: len(clean_dataset) 1288
after delete: len(noisy_dataset) 344
epoch [198/200] batch [5/40] time 0.290 (0.284) data 0.212 (0.206) loss_x loss_x 0.3110 (0.3017) acc_x 90.6250 (92.5000) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [10/40] time 0.279 (0.284) data 0.201 (0.206) loss_x loss_x 0.3044 (0.3111) acc_x 84.3750 (91.8750) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [15/40] time 0.320 (0.289) data 0.240 (0.211) loss_x loss_x 0.3171 (0.3180) acc_x 93.7500 (92.9167) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [20/40] time 0.307 (0.294) data 0.227 (0.216) loss_x loss_x 0.2539 (0.3383) acc_x 93.7500 (92.1875) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [25/40] time 0.307 (0.296) data 0.228 (0.217) loss_x loss_x 0.5928 (0.3737) acc_x 84.3750 (91.5000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [30/40] time 0.304 (0.297) data 0.225 (0.218) loss_x loss_x 0.5854 (0.3861) acc_x 84.3750 (90.9375) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [35/40] time 0.293 (0.297) data 0.214 (0.219) loss_x loss_x 0.4583 (0.3890) acc_x 87.5000 (90.7143) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [40/40] time 0.306 (0.298) data 0.227 (0.219) loss_x loss_x 0.2583 (0.3966) acc_x 96.8750 (90.7031) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.7849, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1281
clean true:1280
clean false:1
clean_rate:0.9992193598750976
noisy true:176
noisy false:175
after delete: len(clean_dataset) 1281
after delete: len(noisy_dataset) 351
epoch [199/200] batch [5/40] time 0.284 (0.285) data 0.206 (0.208) loss_x loss_x 0.1606 (0.2685) acc_x 96.8750 (94.3750) lr 1.1101e-06 eta 0:00:09
epoch [199/200] batch [10/40] time 0.279 (0.284) data 0.201 (0.206) loss_x loss_x 0.4995 (0.3388) acc_x 87.5000 (92.8125) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [15/40] time 0.287 (0.285) data 0.209 (0.207) loss_x loss_x 0.3496 (0.3261) acc_x 93.7500 (92.9167) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [20/40] time 0.289 (0.284) data 0.211 (0.206) loss_x loss_x 0.2123 (0.2952) acc_x 93.7500 (93.9062) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [25/40] time 0.286 (0.283) data 0.208 (0.205) loss_x loss_x 0.1754 (0.2944) acc_x 96.8750 (94.3750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [30/40] time 0.277 (0.283) data 0.200 (0.205) loss_x loss_x 0.1249 (0.2961) acc_x 100.0000 (94.4792) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [35/40] time 0.279 (0.282) data 0.201 (0.205) loss_x loss_x 0.2247 (0.3034) acc_x 96.8750 (94.1071) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [40/40] time 0.279 (0.282) data 0.202 (0.204) loss_x loss_x 0.3420 (0.3157) acc_x 90.6250 (93.8281) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 171
confident_label rate tensor(0.7874, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1285
clean true:1284
clean false:1
clean_rate:0.9992217898832685
noisy true:177
noisy false:170
after delete: len(clean_dataset) 1285
after delete: len(noisy_dataset) 347
epoch [200/200] batch [5/40] time 0.283 (0.282) data 0.205 (0.204) loss_x loss_x 0.5908 (0.4383) acc_x 93.7500 (90.6250) lr 4.9344e-07 eta 0:00:09
epoch [200/200] batch [10/40] time 0.306 (0.297) data 0.227 (0.218) loss_x loss_x 0.3291 (0.3887) acc_x 90.6250 (91.2500) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [15/40] time 0.306 (0.300) data 0.227 (0.222) loss_x loss_x 0.4104 (0.3920) acc_x 90.6250 (91.0417) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [20/40] time 0.302 (0.301) data 0.224 (0.222) loss_x loss_x 0.2432 (0.3810) acc_x 93.7500 (91.5625) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [25/40] time 0.308 (0.301) data 0.230 (0.223) loss_x loss_x 0.1672 (0.3714) acc_x 100.0000 (91.8750) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [30/40] time 0.303 (0.302) data 0.224 (0.223) loss_x loss_x 0.2336 (0.3547) acc_x 93.7500 (91.8750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [35/40] time 0.307 (0.303) data 0.228 (0.224) loss_x loss_x 0.2571 (0.3350) acc_x 96.8750 (92.4107) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [40/40] time 0.299 (0.303) data 0.220 (0.224) loss_x loss_x 0.4653 (0.3438) acc_x 84.3750 (92.1875) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,233
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 90.4%
Elapsed: 1:40:47
