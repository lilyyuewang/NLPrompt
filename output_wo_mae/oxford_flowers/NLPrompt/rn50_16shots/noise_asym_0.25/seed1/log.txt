***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 282
clean true:280
clean false:2
clean_rate:0.9929078014184397
noisy true:95
noisy false:1255
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1350
epoch [1/200] batch [5/8] time 0.292 (0.346) data 0.214 (0.248) loss_x loss_x 2.6133 (2.6301) acc_x 43.7500 (40.6250) lr 1.0000e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1185
confident_label rate tensor(0.2004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 327
clean true:324
clean false:3
clean_rate:0.9908256880733946
noisy true:123
noisy false:1182
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1305
epoch [2/200] batch [5/10] time 0.333 (0.350) data 0.255 (0.272) loss_x loss_x 0.7661 (1.1800) acc_x 84.3750 (74.3750) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/10] time 0.352 (0.356) data 0.272 (0.278) loss_x loss_x 0.9717 (1.0367) acc_x 81.2500 (75.9375) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 745
confident_label rate tensor(0.4118, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 672
clean true:669
clean false:3
clean_rate:0.9955357142857143
noisy true:218
noisy false:742
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 960
epoch [3/200] batch [5/21] time 0.362 (0.360) data 0.284 (0.282) loss_x loss_x 0.8423 (1.0789) acc_x 78.1250 (75.6250) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/21] time 0.353 (0.354) data 0.275 (0.277) loss_x loss_x 0.8584 (0.9810) acc_x 81.2500 (77.1875) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/21] time 0.352 (0.351) data 0.274 (0.273) loss_x loss_x 0.9766 (0.9734) acc_x 68.7500 (76.4583) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/21] time 0.363 (0.352) data 0.286 (0.274) loss_x loss_x 0.7314 (0.9300) acc_x 81.2500 (76.7188) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 745
confident_label rate tensor(0.4130, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 674
clean true:672
clean false:2
clean_rate:0.9970326409495549
noisy true:215
noisy false:743
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 958
epoch [4/200] batch [5/21] time 0.335 (0.353) data 0.258 (0.275) loss_x loss_x 0.7651 (0.7878) acc_x 78.1250 (80.6250) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [10/21] time 0.350 (0.353) data 0.271 (0.276) loss_x loss_x 1.6885 (0.8684) acc_x 68.7500 (80.9375) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/21] time 0.338 (0.348) data 0.261 (0.270) loss_x loss_x 1.3867 (0.8776) acc_x 65.6250 (79.5833) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/21] time 0.362 (0.350) data 0.284 (0.272) loss_x loss_x 0.5918 (0.8472) acc_x 84.3750 (80.1562) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 748
confident_label rate tensor(0.4136, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 675
clean true:671
clean false:4
clean_rate:0.9940740740740741
noisy true:213
noisy false:744
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 957
epoch [5/200] batch [5/21] time 0.339 (0.351) data 0.261 (0.273) loss_x loss_x 0.9258 (0.8888) acc_x 84.3750 (79.3750) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/21] time 0.304 (0.328) data 0.226 (0.250) loss_x loss_x 0.6436 (0.8375) acc_x 81.2500 (79.0625) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/21] time 0.348 (0.330) data 0.270 (0.252) loss_x loss_x 1.2129 (0.8572) acc_x 71.8750 (79.5833) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/21] time 0.369 (0.338) data 0.292 (0.260) loss_x loss_x 0.4692 (0.8401) acc_x 90.6250 (80.6250) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 707
confident_label rate tensor(0.4320, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 705
clean true:702
clean false:3
clean_rate:0.9957446808510638
noisy true:223
noisy false:704
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 927
epoch [6/200] batch [5/22] time 0.361 (0.362) data 0.282 (0.283) loss_x loss_x 0.7217 (0.8434) acc_x 78.1250 (76.8750) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/22] time 0.343 (0.353) data 0.265 (0.274) loss_x loss_x 0.9561 (0.7826) acc_x 71.8750 (78.4375) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/22] time 0.367 (0.355) data 0.287 (0.276) loss_x loss_x 0.4810 (0.7281) acc_x 87.5000 (80.8333) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/22] time 0.347 (0.351) data 0.268 (0.273) loss_x loss_x 0.7437 (0.7135) acc_x 81.2500 (81.5625) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 695
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:710
clean false:2
clean_rate:0.9971910112359551
noisy true:227
noisy false:693
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [7/200] batch [5/22] time 0.351 (0.351) data 0.273 (0.273) loss_x loss_x 0.6006 (0.6221) acc_x 93.7500 (87.5000) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/22] time 0.342 (0.352) data 0.264 (0.274) loss_x loss_x 0.5361 (0.6531) acc_x 87.5000 (87.1875) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/22] time 0.353 (0.350) data 0.275 (0.271) loss_x loss_x 0.8081 (0.7272) acc_x 84.3750 (84.5833) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/22] time 0.353 (0.352) data 0.275 (0.274) loss_x loss_x 1.1250 (0.7550) acc_x 68.7500 (83.4375) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 706
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 710
clean true:707
clean false:3
clean_rate:0.995774647887324
noisy true:219
noisy false:703
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 922
epoch [8/200] batch [5/22] time 0.364 (0.348) data 0.286 (0.270) loss_x loss_x 0.5659 (0.7279) acc_x 90.6250 (81.8750) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/22] time 0.333 (0.341) data 0.255 (0.263) loss_x loss_x 0.9634 (0.8041) acc_x 71.8750 (79.3750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [15/22] time 0.294 (0.335) data 0.216 (0.256) loss_x loss_x 0.5474 (0.7497) acc_x 87.5000 (80.8333) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/22] time 0.334 (0.330) data 0.255 (0.252) loss_x loss_x 0.8608 (0.7142) acc_x 78.1250 (82.0312) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 690
confident_label rate tensor(0.4442, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 725
clean true:721
clean false:4
clean_rate:0.9944827586206897
noisy true:221
noisy false:686
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 907
epoch [9/200] batch [5/22] time 0.346 (0.336) data 0.268 (0.257) loss_x loss_x 0.7148 (0.7599) acc_x 78.1250 (80.0000) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [10/22] time 0.330 (0.338) data 0.252 (0.260) loss_x loss_x 1.1465 (0.7985) acc_x 71.8750 (80.0000) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [15/22] time 0.329 (0.335) data 0.251 (0.257) loss_x loss_x 0.8950 (0.8115) acc_x 78.1250 (80.6250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/22] time 0.348 (0.339) data 0.270 (0.260) loss_x loss_x 0.7256 (0.7849) acc_x 84.3750 (81.4062) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 676
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:717
clean false:3
clean_rate:0.9958333333333333
noisy true:239
noisy false:673
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [10/200] batch [5/22] time 0.394 (0.340) data 0.316 (0.262) loss_x loss_x 0.8711 (0.5849) acc_x 71.8750 (85.0000) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/22] time 0.334 (0.342) data 0.257 (0.264) loss_x loss_x 0.8735 (0.6980) acc_x 81.2500 (83.1250) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/22] time 0.346 (0.344) data 0.268 (0.266) loss_x loss_x 0.4348 (0.6627) acc_x 93.7500 (83.5417) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/22] time 0.334 (0.343) data 0.256 (0.265) loss_x loss_x 0.6841 (0.6567) acc_x 84.3750 (84.0625) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 674
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 719
clean true:716
clean false:3
clean_rate:0.9958275382475661
noisy true:242
noisy false:671
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 913
epoch [11/200] batch [5/22] time 0.352 (0.345) data 0.274 (0.267) loss_x loss_x 0.4275 (0.7202) acc_x 90.6250 (81.2500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/22] time 0.341 (0.343) data 0.262 (0.265) loss_x loss_x 0.7266 (0.6635) acc_x 87.5000 (82.5000) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [15/22] time 0.327 (0.342) data 0.248 (0.264) loss_x loss_x 0.5107 (0.6715) acc_x 87.5000 (83.1250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/22] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.7505 (0.6547) acc_x 81.2500 (83.5938) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 646
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:747
clean false:2
clean_rate:0.9973297730307076
noisy true:239
noisy false:644
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [12/200] batch [5/23] time 0.365 (0.345) data 0.286 (0.267) loss_x loss_x 0.6128 (0.6340) acc_x 87.5000 (86.2500) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/23] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.7036 (0.6875) acc_x 87.5000 (83.1250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/23] time 0.310 (0.337) data 0.231 (0.259) loss_x loss_x 1.0449 (0.7690) acc_x 90.6250 (81.4583) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/23] time 0.299 (0.332) data 0.221 (0.254) loss_x loss_x 0.6865 (0.7655) acc_x 87.5000 (81.0938) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 645
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:751
clean false:6
clean_rate:0.9920739762219286
noisy true:236
noisy false:639
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [13/200] batch [5/23] time 0.348 (0.346) data 0.269 (0.268) loss_x loss_x 0.6787 (0.6825) acc_x 84.3750 (83.7500) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/23] time 0.352 (0.337) data 0.274 (0.259) loss_x loss_x 0.5986 (0.6522) acc_x 87.5000 (83.7500) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [15/23] time 0.368 (0.344) data 0.290 (0.266) loss_x loss_x 0.6250 (0.6359) acc_x 81.2500 (84.5833) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/23] time 0.362 (0.346) data 0.283 (0.267) loss_x loss_x 0.4761 (0.6383) acc_x 90.6250 (85.3125) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 631
confident_label rate tensor(0.4663, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 761
clean true:757
clean false:4
clean_rate:0.9947437582128777
noisy true:244
noisy false:627
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 871
epoch [14/200] batch [5/23] time 0.329 (0.341) data 0.252 (0.263) loss_x loss_x 0.5303 (0.7267) acc_x 93.7500 (85.6250) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/23] time 0.336 (0.334) data 0.259 (0.256) loss_x loss_x 0.4961 (0.6958) acc_x 90.6250 (84.0625) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/23] time 0.346 (0.338) data 0.269 (0.260) loss_x loss_x 0.7988 (0.7104) acc_x 78.1250 (83.1250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/23] time 0.345 (0.339) data 0.266 (0.262) loss_x loss_x 0.6382 (0.6631) acc_x 81.2500 (84.0625) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 611
confident_label rate tensor(0.4712, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 769
clean true:765
clean false:4
clean_rate:0.9947984395318595
noisy true:256
noisy false:607
after delete: len(clean_dataset) 769
after delete: len(noisy_dataset) 863
epoch [15/200] batch [5/24] time 0.365 (0.347) data 0.287 (0.269) loss_x loss_x 0.7007 (0.6543) acc_x 87.5000 (83.1250) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [10/24] time 0.337 (0.346) data 0.260 (0.268) loss_x loss_x 0.6631 (0.6711) acc_x 81.2500 (81.2500) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/24] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.6548 (0.6927) acc_x 81.2500 (80.4167) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/24] time 0.333 (0.339) data 0.255 (0.262) loss_x loss_x 0.7207 (0.6825) acc_x 81.2500 (81.4062) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 598
confident_label rate tensor(0.4773, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 779
clean true:774
clean false:5
clean_rate:0.993581514762516
noisy true:260
noisy false:593
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 853
epoch [16/200] batch [5/24] time 0.310 (0.306) data 0.231 (0.228) loss_x loss_x 0.6519 (0.6207) acc_x 87.5000 (85.6250) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/24] time 0.328 (0.321) data 0.251 (0.243) loss_x loss_x 0.6895 (0.6058) acc_x 84.3750 (86.2500) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/24] time 0.334 (0.329) data 0.256 (0.251) loss_x loss_x 0.5361 (0.6639) acc_x 90.6250 (85.0000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/24] time 0.351 (0.331) data 0.272 (0.253) loss_x loss_x 0.2717 (0.6253) acc_x 93.7500 (85.3125) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 582
confident_label rate tensor(0.4859, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 793
clean true:790
clean false:3
clean_rate:0.9962168978562421
noisy true:260
noisy false:579
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 839
epoch [17/200] batch [5/24] time 0.350 (0.340) data 0.272 (0.262) loss_x loss_x 0.8403 (0.5584) acc_x 81.2500 (88.1250) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [10/24] time 0.328 (0.348) data 0.251 (0.271) loss_x loss_x 1.3574 (0.6430) acc_x 68.7500 (85.3125) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/24] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.6201 (0.7246) acc_x 84.3750 (82.2917) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/24] time 0.347 (0.346) data 0.269 (0.268) loss_x loss_x 0.5034 (0.6784) acc_x 87.5000 (83.7500) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 577
confident_label rate tensor(0.4884, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 797
clean true:797
clean false:0
clean_rate:1.0
noisy true:258
noisy false:577
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 835
epoch [18/200] batch [5/24] time 0.339 (0.313) data 0.261 (0.234) loss_x loss_x 0.4651 (0.5645) acc_x 87.5000 (84.3750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/24] time 0.348 (0.332) data 0.270 (0.253) loss_x loss_x 0.5586 (0.6212) acc_x 81.2500 (82.8125) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/24] time 0.337 (0.335) data 0.259 (0.257) loss_x loss_x 0.3992 (0.5982) acc_x 87.5000 (84.7917) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [20/24] time 0.342 (0.339) data 0.265 (0.260) loss_x loss_x 0.4604 (0.6196) acc_x 84.3750 (83.9062) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 561
confident_label rate tensor(0.4951, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 808
clean true:807
clean false:1
clean_rate:0.9987623762376238
noisy true:264
noisy false:560
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 824
epoch [19/200] batch [5/25] time 0.330 (0.338) data 0.252 (0.260) loss_x loss_x 0.5054 (0.7184) acc_x 87.5000 (83.7500) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [10/25] time 0.343 (0.336) data 0.265 (0.258) loss_x loss_x 0.9507 (0.7154) acc_x 75.0000 (82.8125) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/25] time 0.352 (0.340) data 0.275 (0.262) loss_x loss_x 0.6206 (0.6932) acc_x 87.5000 (83.3333) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/25] time 0.322 (0.340) data 0.245 (0.261) loss_x loss_x 0.5918 (0.6766) acc_x 84.3750 (83.5938) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/25] time 0.310 (0.332) data 0.232 (0.253) loss_x loss_x 0.4324 (0.6570) acc_x 87.5000 (83.2500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 542
confident_label rate tensor(0.5055, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 825
clean true:822
clean false:3
clean_rate:0.9963636363636363
noisy true:268
noisy false:539
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 807
epoch [20/200] batch [5/25] time 0.316 (0.337) data 0.238 (0.258) loss_x loss_x 0.7969 (0.6322) acc_x 81.2500 (81.2500) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/25] time 0.308 (0.331) data 0.231 (0.253) loss_x loss_x 0.5737 (0.6468) acc_x 87.5000 (81.8750) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/25] time 0.292 (0.320) data 0.215 (0.242) loss_x loss_x 1.0215 (0.6510) acc_x 68.7500 (83.5417) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/25] time 0.333 (0.322) data 0.255 (0.244) loss_x loss_x 0.6343 (0.6398) acc_x 81.2500 (83.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/25] time 0.311 (0.323) data 0.232 (0.245) loss_x loss_x 0.6465 (0.6395) acc_x 81.2500 (84.0000) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 513
confident_label rate tensor(0.5251, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 857
clean true:854
clean false:3
clean_rate:0.9964994165694282
noisy true:265
noisy false:510
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 775
epoch [21/200] batch [5/26] time 0.324 (0.342) data 0.246 (0.263) loss_x loss_x 0.5420 (0.6274) acc_x 84.3750 (84.3750) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [10/26] time 0.367 (0.345) data 0.289 (0.267) loss_x loss_x 0.5156 (0.6259) acc_x 84.3750 (84.6875) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/26] time 0.335 (0.348) data 0.257 (0.270) loss_x loss_x 0.5938 (0.6896) acc_x 84.3750 (82.5000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/26] time 0.347 (0.347) data 0.269 (0.269) loss_x loss_x 0.5420 (0.6709) acc_x 84.3750 (82.5000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/26] time 0.353 (0.347) data 0.275 (0.269) loss_x loss_x 0.6812 (0.6825) acc_x 81.2500 (81.8750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 510
confident_label rate tensor(0.5233, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 854
clean true:850
clean false:4
clean_rate:0.9953161592505855
noisy true:272
noisy false:506
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 778
epoch [22/200] batch [5/26] time 0.355 (0.356) data 0.277 (0.277) loss_x loss_x 0.6538 (0.5726) acc_x 78.1250 (85.0000) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [10/26] time 0.342 (0.349) data 0.264 (0.271) loss_x loss_x 0.6831 (0.6353) acc_x 84.3750 (84.0625) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/26] time 0.361 (0.349) data 0.282 (0.271) loss_x loss_x 0.7065 (0.6241) acc_x 78.1250 (83.5417) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/26] time 0.336 (0.349) data 0.257 (0.271) loss_x loss_x 0.4331 (0.5820) acc_x 90.6250 (84.8438) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/26] time 0.348 (0.344) data 0.271 (0.266) loss_x loss_x 0.4487 (0.5812) acc_x 81.2500 (85.0000) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 505
confident_label rate tensor(0.5257, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 858
clean true:855
clean false:3
clean_rate:0.9965034965034965
noisy true:272
noisy false:502
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 774
epoch [23/200] batch [5/26] time 0.343 (0.343) data 0.264 (0.265) loss_x loss_x 0.8042 (0.6777) acc_x 84.3750 (83.1250) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [10/26] time 0.310 (0.338) data 0.232 (0.260) loss_x loss_x 0.7129 (0.6809) acc_x 78.1250 (82.5000) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/26] time 0.338 (0.336) data 0.260 (0.258) loss_x loss_x 0.7285 (0.6640) acc_x 75.0000 (82.9167) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/26] time 0.343 (0.337) data 0.266 (0.259) loss_x loss_x 0.4268 (0.6360) acc_x 90.6250 (83.7500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/26] time 0.358 (0.336) data 0.280 (0.258) loss_x loss_x 0.6602 (0.6122) acc_x 78.1250 (84.7500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 495
confident_label rate tensor(0.5349, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 873
clean true:871
clean false:2
clean_rate:0.997709049255441
noisy true:266
noisy false:493
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 759
epoch [24/200] batch [5/27] time 0.346 (0.339) data 0.268 (0.261) loss_x loss_x 0.3716 (0.4435) acc_x 93.7500 (89.3750) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [10/27] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.6978 (0.5626) acc_x 81.2500 (87.1875) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/27] time 0.355 (0.335) data 0.277 (0.257) loss_x loss_x 0.4895 (0.5143) acc_x 93.7500 (88.5417) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/27] time 0.341 (0.337) data 0.263 (0.259) loss_x loss_x 0.4187 (0.5080) acc_x 90.6250 (88.4375) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/27] time 0.344 (0.339) data 0.266 (0.261) loss_x loss_x 0.5259 (0.5372) acc_x 90.6250 (87.6250) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 473
confident_label rate tensor(0.5398, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 881
clean true:881
clean false:0
clean_rate:1.0
noisy true:278
noisy false:473
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 751
epoch [25/200] batch [5/27] time 0.295 (0.325) data 0.217 (0.247) loss_x loss_x 0.5088 (0.5838) acc_x 93.7500 (86.2500) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [10/27] time 0.340 (0.327) data 0.262 (0.249) loss_x loss_x 0.4558 (0.5353) acc_x 93.7500 (87.8125) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/27] time 0.339 (0.334) data 0.261 (0.256) loss_x loss_x 0.6372 (0.5318) acc_x 87.5000 (87.7083) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [20/27] time 0.356 (0.338) data 0.279 (0.260) loss_x loss_x 0.2869 (0.5270) acc_x 96.8750 (87.5000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/27] time 0.351 (0.339) data 0.274 (0.261) loss_x loss_x 0.5518 (0.5250) acc_x 84.3750 (87.0000) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 457
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:908
clean false:2
clean_rate:0.9978021978021978
noisy true:267
noisy false:455
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [26/200] batch [5/28] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.6138 (0.5731) acc_x 81.2500 (85.0000) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [10/28] time 0.333 (0.345) data 0.256 (0.268) loss_x loss_x 0.4331 (0.5484) acc_x 90.6250 (87.5000) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [15/28] time 0.300 (0.339) data 0.222 (0.262) loss_x loss_x 0.6270 (0.5552) acc_x 81.2500 (87.0833) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/28] time 0.341 (0.332) data 0.264 (0.255) loss_x loss_x 0.8135 (0.5667) acc_x 84.3750 (87.6562) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/28] time 0.352 (0.336) data 0.275 (0.258) loss_x loss_x 0.8628 (0.5737) acc_x 75.0000 (87.3750) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 453
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:900
clean false:5
clean_rate:0.994475138121547
noisy true:279
noisy false:448
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [27/200] batch [5/28] time 0.348 (0.333) data 0.270 (0.255) loss_x loss_x 0.4812 (0.6167) acc_x 93.7500 (83.7500) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [10/28] time 0.347 (0.337) data 0.269 (0.259) loss_x loss_x 0.4792 (0.5884) acc_x 87.5000 (84.3750) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [15/28] time 0.339 (0.334) data 0.261 (0.256) loss_x loss_x 0.5059 (0.5935) acc_x 84.3750 (83.9583) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/28] time 0.342 (0.336) data 0.265 (0.258) loss_x loss_x 0.4512 (0.5844) acc_x 93.7500 (85.1562) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/28] time 0.354 (0.337) data 0.276 (0.259) loss_x loss_x 0.6211 (0.5857) acc_x 87.5000 (85.2500) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:916
clean false:3
clean_rate:0.9967355821545157
noisy true:282
noisy false:431
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [28/200] batch [5/28] time 0.335 (0.345) data 0.257 (0.267) loss_x loss_x 0.3433 (0.4207) acc_x 96.8750 (93.7500) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [10/28] time 0.338 (0.340) data 0.260 (0.263) loss_x loss_x 0.7007 (0.4897) acc_x 78.1250 (90.0000) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [15/28] time 0.331 (0.339) data 0.253 (0.261) loss_x loss_x 0.7725 (0.5128) acc_x 68.7500 (87.9167) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/28] time 0.351 (0.341) data 0.274 (0.264) loss_x loss_x 0.3616 (0.5219) acc_x 90.6250 (87.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/28] time 0.348 (0.342) data 0.270 (0.265) loss_x loss_x 0.3379 (0.5270) acc_x 87.5000 (86.7500) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:900
clean false:1
clean_rate:0.9988901220865705
noisy true:280
noisy false:451
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [29/200] batch [5/28] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.8203 (0.6904) acc_x 81.2500 (86.8750) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [10/28] time 0.307 (0.338) data 0.229 (0.261) loss_x loss_x 0.6631 (0.6012) acc_x 87.5000 (88.1250) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [15/28] time 0.345 (0.339) data 0.267 (0.262) loss_x loss_x 0.2686 (0.5837) acc_x 96.8750 (88.1250) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [20/28] time 0.340 (0.340) data 0.262 (0.262) loss_x loss_x 0.5488 (0.5701) acc_x 90.6250 (87.6562) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/28] time 0.309 (0.335) data 0.231 (0.257) loss_x loss_x 0.8296 (0.5750) acc_x 78.1250 (87.1250) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.5680, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 927
clean true:924
clean false:3
clean_rate:0.9967637540453075
noisy true:274
noisy false:431
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 705
epoch [30/200] batch [5/28] time 0.336 (0.339) data 0.259 (0.262) loss_x loss_x 0.8486 (0.5369) acc_x 78.1250 (88.1250) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [10/28] time 0.333 (0.337) data 0.254 (0.259) loss_x loss_x 0.4697 (0.5114) acc_x 87.5000 (87.5000) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [15/28] time 0.352 (0.339) data 0.275 (0.262) loss_x loss_x 0.4944 (0.5125) acc_x 87.5000 (87.9167) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [20/28] time 0.342 (0.341) data 0.264 (0.263) loss_x loss_x 0.8481 (0.5462) acc_x 87.5000 (86.8750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/28] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.5288 (0.5715) acc_x 81.2500 (85.7500) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 418
confident_label rate tensor(0.5680, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 927
clean true:925
clean false:2
clean_rate:0.9978425026968716
noisy true:289
noisy false:416
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 705
epoch [31/200] batch [5/28] time 0.354 (0.355) data 0.276 (0.278) loss_x loss_x 0.2974 (0.4391) acc_x 93.7500 (90.0000) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [10/28] time 0.344 (0.350) data 0.267 (0.273) loss_x loss_x 0.6646 (0.4433) acc_x 78.1250 (89.3750) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [15/28] time 0.345 (0.350) data 0.267 (0.273) loss_x loss_x 0.6187 (0.4875) acc_x 90.6250 (88.1250) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [20/28] time 0.348 (0.349) data 0.271 (0.271) loss_x loss_x 0.4775 (0.4764) acc_x 90.6250 (88.4375) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/28] time 0.338 (0.347) data 0.260 (0.270) loss_x loss_x 0.2659 (0.4784) acc_x 100.0000 (88.2500) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 443
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:900
clean false:4
clean_rate:0.995575221238938
noisy true:289
noisy false:439
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [32/200] batch [5/28] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.5532 (0.5251) acc_x 87.5000 (87.5000) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [10/28] time 0.335 (0.343) data 0.257 (0.265) loss_x loss_x 0.4539 (0.5465) acc_x 84.3750 (86.8750) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [15/28] time 0.291 (0.335) data 0.213 (0.257) loss_x loss_x 0.6333 (0.4967) acc_x 78.1250 (87.5000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [20/28] time 0.335 (0.331) data 0.257 (0.253) loss_x loss_x 0.7490 (0.5069) acc_x 81.2500 (87.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/28] time 0.341 (0.334) data 0.264 (0.256) loss_x loss_x 0.4731 (0.4983) acc_x 81.2500 (87.2500) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:936
clean false:2
clean_rate:0.997867803837953
noisy true:293
noisy false:401
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [33/200] batch [5/29] time 0.298 (0.325) data 0.221 (0.248) loss_x loss_x 0.4863 (0.4281) acc_x 93.7500 (90.6250) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [10/29] time 0.306 (0.326) data 0.227 (0.248) loss_x loss_x 0.4214 (0.4717) acc_x 90.6250 (89.0625) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [15/29] time 0.343 (0.336) data 0.265 (0.258) loss_x loss_x 0.6216 (0.4871) acc_x 87.5000 (89.1667) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [20/29] time 0.335 (0.338) data 0.258 (0.260) loss_x loss_x 0.4451 (0.4902) acc_x 84.3750 (89.0625) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/29] time 0.354 (0.340) data 0.276 (0.262) loss_x loss_x 0.6958 (0.5287) acc_x 78.1250 (87.7500) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 408
confident_label rate tensor(0.5692, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 929
clean true:926
clean false:3
clean_rate:0.9967707212055974
noisy true:298
noisy false:405
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 703
epoch [34/200] batch [5/29] time 0.343 (0.345) data 0.265 (0.268) loss_x loss_x 0.6094 (0.5540) acc_x 87.5000 (88.1250) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [10/29] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.3540 (0.5483) acc_x 93.7500 (87.8125) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [15/29] time 0.350 (0.346) data 0.272 (0.268) loss_x loss_x 0.3779 (0.5204) acc_x 87.5000 (87.7083) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [20/29] time 0.355 (0.346) data 0.277 (0.269) loss_x loss_x 0.6055 (0.4922) acc_x 84.3750 (88.5938) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/29] time 0.344 (0.346) data 0.266 (0.268) loss_x loss_x 0.4849 (0.5082) acc_x 87.5000 (88.3750) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.5766, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 941
clean true:937
clean false:4
clean_rate:0.9957492029755579
noisy true:295
noisy false:396
after delete: len(clean_dataset) 941
after delete: len(noisy_dataset) 691
epoch [35/200] batch [5/29] time 0.347 (0.348) data 0.270 (0.270) loss_x loss_x 0.9688 (0.7094) acc_x 71.8750 (82.5000) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [10/29] time 0.339 (0.344) data 0.262 (0.267) loss_x loss_x 0.6865 (0.6355) acc_x 78.1250 (84.0625) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [15/29] time 0.339 (0.345) data 0.261 (0.268) loss_x loss_x 0.5176 (0.5658) acc_x 87.5000 (86.8750) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [20/29] time 0.307 (0.343) data 0.229 (0.265) loss_x loss_x 0.4526 (0.5613) acc_x 93.7500 (87.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/29] time 0.316 (0.335) data 0.239 (0.257) loss_x loss_x 0.4441 (0.5476) acc_x 93.7500 (88.1250) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.5815, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 949
clean true:946
clean false:3
clean_rate:0.9968387776606955
noisy true:299
noisy false:384
after delete: len(clean_dataset) 949
after delete: len(noisy_dataset) 683
epoch [36/200] batch [5/29] time 0.354 (0.355) data 0.276 (0.277) loss_x loss_x 0.5830 (0.4893) acc_x 84.3750 (88.1250) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [10/29] time 0.313 (0.344) data 0.234 (0.266) loss_x loss_x 0.6191 (0.4563) acc_x 81.2500 (89.6875) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [15/29] time 0.347 (0.344) data 0.268 (0.267) loss_x loss_x 0.6606 (0.4589) acc_x 81.2500 (89.3750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/29] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 1.1221 (0.5134) acc_x 75.0000 (87.8125) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/29] time 0.365 (0.348) data 0.287 (0.270) loss_x loss_x 0.5938 (0.5137) acc_x 84.3750 (87.5000) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 396
confident_label rate tensor(0.5858, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 956
clean true:950
clean false:6
clean_rate:0.9937238493723849
noisy true:286
noisy false:390
after delete: len(clean_dataset) 956
after delete: len(noisy_dataset) 676
epoch [37/200] batch [5/29] time 0.333 (0.344) data 0.256 (0.266) loss_x loss_x 0.6929 (0.5322) acc_x 81.2500 (86.2500) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [10/29] time 0.348 (0.346) data 0.271 (0.269) loss_x loss_x 0.2229 (0.4592) acc_x 100.0000 (90.3125) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [15/29] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.5215 (0.4796) acc_x 87.5000 (90.0000) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [20/29] time 0.360 (0.347) data 0.282 (0.269) loss_x loss_x 0.5195 (0.4800) acc_x 96.8750 (90.0000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/29] time 0.345 (0.347) data 0.268 (0.270) loss_x loss_x 0.4224 (0.4651) acc_x 87.5000 (90.2500) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 388
confident_label rate tensor(0.5864, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 957
clean true:953
clean false:4
clean_rate:0.9958202716823407
noisy true:291
noisy false:384
after delete: len(clean_dataset) 957
after delete: len(noisy_dataset) 675
epoch [38/200] batch [5/29] time 0.344 (0.349) data 0.267 (0.271) loss_x loss_x 0.9316 (0.5426) acc_x 71.8750 (85.6250) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [10/29] time 0.296 (0.343) data 0.218 (0.265) loss_x loss_x 0.5381 (0.5011) acc_x 87.5000 (88.4375) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [15/29] time 0.367 (0.337) data 0.289 (0.259) loss_x loss_x 0.3696 (0.5208) acc_x 93.7500 (88.3333) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [20/29] time 0.348 (0.339) data 0.270 (0.261) loss_x loss_x 0.3135 (0.4883) acc_x 87.5000 (88.5938) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/29] time 0.348 (0.338) data 0.270 (0.260) loss_x loss_x 0.4045 (0.4826) acc_x 87.5000 (88.8750) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 412
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:926
clean false:6
clean_rate:0.9935622317596566
noisy true:294
noisy false:406
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [39/200] batch [5/29] time 0.346 (0.337) data 0.269 (0.259) loss_x loss_x 0.6846 (0.5250) acc_x 84.3750 (87.5000) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [10/29] time 0.342 (0.340) data 0.265 (0.262) loss_x loss_x 0.7969 (0.5175) acc_x 84.3750 (88.4375) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [15/29] time 0.343 (0.341) data 0.266 (0.263) loss_x loss_x 0.2430 (0.4668) acc_x 100.0000 (88.9583) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [20/29] time 0.357 (0.342) data 0.278 (0.265) loss_x loss_x 0.8149 (0.4700) acc_x 78.1250 (89.2188) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/29] time 0.351 (0.342) data 0.273 (0.264) loss_x loss_x 0.3096 (0.4638) acc_x 93.7500 (89.5000) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 388
confident_label rate tensor(0.5797, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 946
clean true:936
clean false:10
clean_rate:0.9894291754756871
noisy true:308
noisy false:378
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 686
epoch [40/200] batch [5/29] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.4224 (0.4780) acc_x 90.6250 (86.2500) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [10/29] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.6411 (0.4580) acc_x 87.5000 (88.4375) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [15/29] time 0.340 (0.339) data 0.262 (0.261) loss_x loss_x 0.4319 (0.4762) acc_x 87.5000 (88.7500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [20/29] time 0.344 (0.339) data 0.266 (0.261) loss_x loss_x 0.5308 (0.4655) acc_x 90.6250 (89.2188) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/29] time 0.305 (0.337) data 0.227 (0.259) loss_x loss_x 0.3589 (0.4463) acc_x 93.7500 (89.7500) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 383
confident_label rate tensor(0.5931, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 968
clean true:962
clean false:6
clean_rate:0.993801652892562
noisy true:287
noisy false:377
after delete: len(clean_dataset) 968
after delete: len(noisy_dataset) 664
epoch [41/200] batch [5/30] time 0.367 (0.349) data 0.290 (0.271) loss_x loss_x 0.4285 (0.5617) acc_x 81.2500 (85.0000) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [10/30] time 0.358 (0.347) data 0.281 (0.269) loss_x loss_x 0.2451 (0.5456) acc_x 93.7500 (86.2500) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [15/30] time 0.353 (0.346) data 0.276 (0.269) loss_x loss_x 0.7495 (0.5768) acc_x 81.2500 (85.4167) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [20/30] time 0.341 (0.347) data 0.264 (0.269) loss_x loss_x 0.2365 (0.5615) acc_x 93.7500 (85.9375) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/30] time 0.303 (0.341) data 0.225 (0.263) loss_x loss_x 0.4355 (0.5885) acc_x 90.6250 (85.5000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/30] time 0.301 (0.334) data 0.222 (0.257) loss_x loss_x 0.4041 (0.5643) acc_x 90.6250 (86.4583) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 363
confident_label rate tensor(0.5919, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 966
clean true:964
clean false:2
clean_rate:0.9979296066252588
noisy true:305
noisy false:361
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 666
epoch [42/200] batch [5/30] time 0.342 (0.349) data 0.264 (0.272) loss_x loss_x 0.6064 (0.5141) acc_x 87.5000 (88.1250) lr 1.8090e-03 eta 0:00:08
epoch [42/200] batch [10/30] time 0.307 (0.330) data 0.229 (0.252) loss_x loss_x 0.2720 (0.5250) acc_x 96.8750 (88.7500) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [15/30] time 0.324 (0.321) data 0.247 (0.243) loss_x loss_x 0.9175 (0.5614) acc_x 87.5000 (88.1250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [20/30] time 0.339 (0.326) data 0.262 (0.249) loss_x loss_x 0.4280 (0.5083) acc_x 84.3750 (88.9062) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/30] time 0.307 (0.328) data 0.229 (0.250) loss_x loss_x 0.4121 (0.5059) acc_x 93.7500 (88.8750) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/30] time 0.344 (0.328) data 0.266 (0.250) loss_x loss_x 0.6714 (0.5074) acc_x 81.2500 (88.6458) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 350
confident_label rate tensor(0.6060, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 989
clean true:983
clean false:6
clean_rate:0.993933265925177
noisy true:299
noisy false:344
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 643
epoch [43/200] batch [5/30] time 0.325 (0.325) data 0.248 (0.247) loss_x loss_x 0.2491 (0.4217) acc_x 96.8750 (90.6250) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [10/30] time 0.350 (0.337) data 0.273 (0.259) loss_x loss_x 0.5659 (0.4303) acc_x 90.6250 (89.6875) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [15/30] time 0.348 (0.341) data 0.270 (0.264) loss_x loss_x 0.3564 (0.4692) acc_x 93.7500 (88.9583) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [20/30] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.6963 (0.4786) acc_x 87.5000 (88.4375) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/30] time 0.298 (0.338) data 0.220 (0.260) loss_x loss_x 0.5488 (0.4817) acc_x 87.5000 (88.5000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/30] time 0.339 (0.336) data 0.262 (0.258) loss_x loss_x 0.8843 (0.4979) acc_x 78.1250 (88.2292) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 359
confident_label rate tensor(0.5974, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 975
clean true:970
clean false:5
clean_rate:0.9948717948717949
noisy true:303
noisy false:354
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 657
epoch [44/200] batch [5/30] time 0.347 (0.360) data 0.269 (0.282) loss_x loss_x 0.3259 (0.5262) acc_x 90.6250 (86.8750) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [10/30] time 0.344 (0.352) data 0.266 (0.275) loss_x loss_x 0.2111 (0.3993) acc_x 96.8750 (90.6250) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [15/30] time 0.325 (0.340) data 0.248 (0.262) loss_x loss_x 0.6475 (0.4335) acc_x 84.3750 (89.3750) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [20/30] time 0.324 (0.337) data 0.247 (0.260) loss_x loss_x 0.5762 (0.4495) acc_x 90.6250 (89.0625) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [25/30] time 0.349 (0.337) data 0.272 (0.259) loss_x loss_x 0.7930 (0.4589) acc_x 78.1250 (88.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/30] time 0.344 (0.338) data 0.266 (0.260) loss_x loss_x 0.3445 (0.4629) acc_x 90.6250 (88.9583) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.5790, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 945
clean true:940
clean false:5
clean_rate:0.9947089947089947
noisy true:297
noisy false:390
after delete: len(clean_dataset) 945
after delete: len(noisy_dataset) 687
epoch [45/200] batch [5/29] time 0.341 (0.326) data 0.263 (0.248) loss_x loss_x 0.3059 (0.3476) acc_x 90.6250 (92.5000) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [10/29] time 0.328 (0.331) data 0.250 (0.253) loss_x loss_x 0.7393 (0.4240) acc_x 78.1250 (90.0000) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [15/29] time 0.340 (0.334) data 0.263 (0.256) loss_x loss_x 0.2744 (0.4226) acc_x 100.0000 (90.2083) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [20/29] time 0.291 (0.326) data 0.213 (0.249) loss_x loss_x 0.6172 (0.4369) acc_x 78.1250 (89.2188) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/29] time 0.323 (0.322) data 0.245 (0.244) loss_x loss_x 0.6582 (0.4591) acc_x 87.5000 (88.8750) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 378
confident_label rate tensor(0.5950, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 971
clean true:967
clean false:4
clean_rate:0.995880535530381
noisy true:287
noisy false:374
after delete: len(clean_dataset) 971
after delete: len(noisy_dataset) 661
epoch [46/200] batch [5/30] time 0.294 (0.309) data 0.216 (0.231) loss_x loss_x 0.5811 (0.5094) acc_x 84.3750 (88.1250) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [10/30] time 0.333 (0.308) data 0.255 (0.230) loss_x loss_x 0.5889 (0.4897) acc_x 87.5000 (87.1875) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [15/30] time 0.344 (0.320) data 0.266 (0.242) loss_x loss_x 0.4199 (0.4642) acc_x 93.7500 (87.2917) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [20/30] time 0.343 (0.326) data 0.265 (0.248) loss_x loss_x 0.2776 (0.4611) acc_x 93.7500 (87.8125) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/30] time 0.336 (0.328) data 0.258 (0.250) loss_x loss_x 0.3513 (0.4618) acc_x 93.7500 (87.7500) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/30] time 0.341 (0.330) data 0.263 (0.252) loss_x loss_x 0.5205 (0.4574) acc_x 90.6250 (87.9167) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 340
confident_label rate tensor(0.6109, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 997
clean true:991
clean false:6
clean_rate:0.9939819458375125
noisy true:301
noisy false:334
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 635
epoch [47/200] batch [5/31] time 0.356 (0.356) data 0.278 (0.278) loss_x loss_x 0.3606 (0.3371) acc_x 93.7500 (91.2500) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [10/31] time 0.338 (0.350) data 0.260 (0.272) loss_x loss_x 0.6895 (0.4454) acc_x 78.1250 (87.8125) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [15/31] time 0.323 (0.339) data 0.246 (0.261) loss_x loss_x 0.2837 (0.4690) acc_x 93.7500 (88.5417) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/31] time 0.307 (0.332) data 0.229 (0.255) loss_x loss_x 0.5825 (0.4779) acc_x 87.5000 (88.1250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/31] time 0.350 (0.338) data 0.273 (0.261) loss_x loss_x 0.5239 (0.4582) acc_x 87.5000 (88.8750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/31] time 0.324 (0.339) data 0.247 (0.261) loss_x loss_x 0.8633 (0.4634) acc_x 84.3750 (88.6458) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.6121, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 999
clean true:994
clean false:5
clean_rate:0.994994994994995
noisy true:310
noisy false:323
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 633
epoch [48/200] batch [5/31] time 0.358 (0.350) data 0.280 (0.272) loss_x loss_x 0.2876 (0.5706) acc_x 93.7500 (86.2500) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [10/31] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.6929 (0.5403) acc_x 78.1250 (86.5625) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [15/31] time 0.354 (0.346) data 0.277 (0.268) loss_x loss_x 0.5688 (0.5259) acc_x 90.6250 (87.2917) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [20/31] time 0.332 (0.343) data 0.255 (0.265) loss_x loss_x 0.3274 (0.5325) acc_x 93.7500 (87.6562) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/31] time 0.354 (0.344) data 0.276 (0.267) loss_x loss_x 0.6899 (0.5136) acc_x 81.2500 (88.0000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/31] time 0.339 (0.344) data 0.262 (0.266) loss_x loss_x 0.4565 (0.5114) acc_x 87.5000 (87.9167) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.6060, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 989
clean true:986
clean false:3
clean_rate:0.9969666329625885
noisy true:304
noisy false:339
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 643
epoch [49/200] batch [5/30] time 0.367 (0.361) data 0.290 (0.284) loss_x loss_x 0.3831 (0.4506) acc_x 87.5000 (89.3750) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/30] time 0.338 (0.352) data 0.261 (0.275) loss_x loss_x 0.2998 (0.4459) acc_x 93.7500 (89.0625) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [15/30] time 0.346 (0.352) data 0.268 (0.274) loss_x loss_x 0.3572 (0.4257) acc_x 90.6250 (89.1667) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [20/30] time 0.350 (0.350) data 0.272 (0.272) loss_x loss_x 0.2976 (0.4289) acc_x 93.7500 (89.3750) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/30] time 0.300 (0.344) data 0.222 (0.267) loss_x loss_x 0.3640 (0.3974) acc_x 87.5000 (90.1250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/30] time 0.334 (0.339) data 0.257 (0.261) loss_x loss_x 0.5981 (0.4164) acc_x 87.5000 (89.3750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 362
confident_label rate tensor(0.6005, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 980
clean true:974
clean false:6
clean_rate:0.9938775510204082
noisy true:296
noisy false:356
after delete: len(clean_dataset) 980
after delete: len(noisy_dataset) 652
epoch [50/200] batch [5/30] time 0.322 (0.329) data 0.244 (0.251) loss_x loss_x 0.3555 (0.4051) acc_x 90.6250 (89.3750) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [10/30] time 0.346 (0.335) data 0.269 (0.257) loss_x loss_x 0.4927 (0.4325) acc_x 84.3750 (88.4375) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [15/30] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.6064 (0.4445) acc_x 87.5000 (88.7500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [20/30] time 0.283 (0.328) data 0.205 (0.250) loss_x loss_x 0.4436 (0.4476) acc_x 90.6250 (88.7500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/30] time 0.332 (0.328) data 0.254 (0.250) loss_x loss_x 0.4719 (0.4394) acc_x 87.5000 (89.0000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/30] time 0.351 (0.331) data 0.273 (0.253) loss_x loss_x 0.3936 (0.4422) acc_x 87.5000 (88.9583) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.6097, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 995
clean true:989
clean false:6
clean_rate:0.9939698492462311
noisy true:302
noisy false:335
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 637
epoch [51/200] batch [5/31] time 0.339 (0.343) data 0.261 (0.265) loss_x loss_x 0.4988 (0.6164) acc_x 84.3750 (83.1250) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [10/31] time 0.330 (0.341) data 0.253 (0.263) loss_x loss_x 0.2107 (0.5136) acc_x 100.0000 (86.8750) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [15/31] time 0.344 (0.341) data 0.267 (0.264) loss_x loss_x 0.3237 (0.4507) acc_x 96.8750 (89.1667) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [20/31] time 0.351 (0.343) data 0.273 (0.266) loss_x loss_x 0.7314 (0.4956) acc_x 81.2500 (87.6562) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/31] time 0.347 (0.342) data 0.270 (0.264) loss_x loss_x 0.2173 (0.4930) acc_x 96.8750 (88.1250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/31] time 0.337 (0.340) data 0.258 (0.263) loss_x loss_x 0.1671 (0.4669) acc_x 96.8750 (88.7500) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 353
confident_label rate tensor(0.6066, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 990
clean true:984
clean false:6
clean_rate:0.9939393939393939
noisy true:295
noisy false:347
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 642
epoch [52/200] batch [5/30] time 0.362 (0.359) data 0.285 (0.280) loss_x loss_x 0.2452 (0.4322) acc_x 90.6250 (90.6250) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [10/30] time 0.361 (0.355) data 0.284 (0.277) loss_x loss_x 0.3157 (0.4058) acc_x 96.8750 (90.9375) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [15/30] time 0.333 (0.352) data 0.255 (0.274) loss_x loss_x 0.4104 (0.4345) acc_x 93.7500 (89.5833) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [20/30] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.5991 (0.4640) acc_x 81.2500 (89.2188) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [25/30] time 0.306 (0.344) data 0.228 (0.267) loss_x loss_x 0.4578 (0.4915) acc_x 93.7500 (88.7500) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/30] time 0.339 (0.343) data 0.262 (0.265) loss_x loss_x 0.5703 (0.4966) acc_x 87.5000 (88.1250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 344
confident_label rate tensor(0.6072, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 991
clean true:984
clean false:7
clean_rate:0.992936427850656
noisy true:304
noisy false:337
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 641
epoch [53/200] batch [5/30] time 0.296 (0.309) data 0.218 (0.231) loss_x loss_x 0.7227 (0.4426) acc_x 87.5000 (92.5000) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [10/30] time 0.340 (0.323) data 0.261 (0.245) loss_x loss_x 1.1982 (0.5623) acc_x 71.8750 (87.8125) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [15/30] time 0.354 (0.331) data 0.276 (0.253) loss_x loss_x 0.3701 (0.4786) acc_x 96.8750 (89.5833) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [20/30] time 0.330 (0.331) data 0.252 (0.253) loss_x loss_x 0.4983 (0.4700) acc_x 87.5000 (89.5312) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/30] time 0.349 (0.335) data 0.272 (0.257) loss_x loss_x 0.4209 (0.4902) acc_x 90.6250 (88.3750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/30] time 0.342 (0.337) data 0.264 (0.259) loss_x loss_x 0.3459 (0.4851) acc_x 90.6250 (88.3333) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 343
confident_label rate tensor(0.6121, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 999
clean true:995
clean false:4
clean_rate:0.995995995995996
noisy true:294
noisy false:339
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 633
epoch [54/200] batch [5/31] time 0.354 (0.352) data 0.276 (0.274) loss_x loss_x 0.4185 (0.4716) acc_x 93.7500 (90.6250) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [10/31] time 0.339 (0.349) data 0.261 (0.271) loss_x loss_x 1.0332 (0.5454) acc_x 71.8750 (86.8750) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [15/31] time 0.352 (0.347) data 0.275 (0.270) loss_x loss_x 0.6211 (0.5456) acc_x 81.2500 (86.6667) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [20/31] time 0.349 (0.347) data 0.272 (0.269) loss_x loss_x 0.3098 (0.5031) acc_x 90.6250 (87.8125) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [25/31] time 0.340 (0.346) data 0.262 (0.268) loss_x loss_x 0.5054 (0.5262) acc_x 84.3750 (87.2500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/31] time 0.332 (0.344) data 0.254 (0.267) loss_x loss_x 0.4226 (0.5302) acc_x 93.7500 (87.3958) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.6097, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 995
clean true:991
clean false:4
clean_rate:0.9959798994974874
noisy true:303
noisy false:334
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 637
epoch [55/200] batch [5/31] time 0.348 (0.357) data 0.269 (0.279) loss_x loss_x 0.3633 (0.4010) acc_x 90.6250 (91.2500) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [10/31] time 0.372 (0.355) data 0.295 (0.277) loss_x loss_x 0.3135 (0.4192) acc_x 93.7500 (92.1875) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [15/31] time 0.343 (0.352) data 0.266 (0.274) loss_x loss_x 0.2169 (0.3962) acc_x 100.0000 (92.0833) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [20/31] time 0.340 (0.349) data 0.263 (0.271) loss_x loss_x 0.3542 (0.3999) acc_x 87.5000 (92.1875) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [25/31] time 0.350 (0.347) data 0.273 (0.269) loss_x loss_x 0.3767 (0.4167) acc_x 93.7500 (91.3750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/31] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.6030 (0.4348) acc_x 93.7500 (90.5208) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 318
confident_label rate tensor(0.6170, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1007
clean true:1002
clean false:5
clean_rate:0.9950347567030785
noisy true:312
noisy false:313
after delete: len(clean_dataset) 1007
after delete: len(noisy_dataset) 625
epoch [56/200] batch [5/31] time 0.346 (0.340) data 0.268 (0.262) loss_x loss_x 0.5527 (0.4762) acc_x 87.5000 (88.7500) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [10/31] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.5952 (0.4678) acc_x 87.5000 (88.7500) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [15/31] time 0.346 (0.344) data 0.268 (0.266) loss_x loss_x 0.4050 (0.4949) acc_x 93.7500 (88.7500) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [20/31] time 0.349 (0.345) data 0.271 (0.267) loss_x loss_x 0.9272 (0.5187) acc_x 78.1250 (87.1875) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [25/31] time 0.343 (0.347) data 0.266 (0.269) loss_x loss_x 0.5439 (0.4982) acc_x 90.6250 (87.7500) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/31] time 0.338 (0.346) data 0.261 (0.268) loss_x loss_x 0.6797 (0.4833) acc_x 81.2500 (88.5417) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.6127, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1000
clean true:996
clean false:4
clean_rate:0.996
noisy true:308
noisy false:324
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 632
epoch [57/200] batch [5/31] time 0.349 (0.344) data 0.272 (0.266) loss_x loss_x 0.3887 (0.6173) acc_x 87.5000 (83.7500) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [10/31] time 0.342 (0.348) data 0.265 (0.271) loss_x loss_x 0.2637 (0.5545) acc_x 96.8750 (87.5000) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [15/31] time 0.340 (0.346) data 0.263 (0.269) loss_x loss_x 0.5059 (0.5448) acc_x 90.6250 (87.9167) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [20/31] time 0.362 (0.346) data 0.285 (0.268) loss_x loss_x 0.3369 (0.5311) acc_x 93.7500 (88.2812) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/31] time 0.295 (0.343) data 0.217 (0.265) loss_x loss_x 0.3792 (0.5127) acc_x 90.6250 (87.7500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/31] time 0.306 (0.336) data 0.228 (0.258) loss_x loss_x 0.7817 (0.5278) acc_x 84.3750 (87.5000) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 294
confident_label rate tensor(0.6281, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1025
clean true:1020
clean false:5
clean_rate:0.9951219512195122
noisy true:318
noisy false:289
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 607
epoch [58/200] batch [5/32] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.2354 (0.2900) acc_x 96.8750 (94.3750) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [10/32] time 0.301 (0.322) data 0.223 (0.244) loss_x loss_x 0.5327 (0.4121) acc_x 87.5000 (90.9375) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [15/32] time 0.346 (0.324) data 0.269 (0.246) loss_x loss_x 0.8389 (0.5004) acc_x 81.2500 (88.7500) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [20/32] time 0.329 (0.329) data 0.251 (0.251) loss_x loss_x 0.5742 (0.4777) acc_x 90.6250 (89.2188) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [25/32] time 0.308 (0.328) data 0.229 (0.251) loss_x loss_x 0.2744 (0.4809) acc_x 96.8750 (89.2500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/32] time 0.354 (0.330) data 0.276 (0.253) loss_x loss_x 0.3420 (0.4909) acc_x 93.7500 (88.9583) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.6176, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1008
clean true:1004
clean false:4
clean_rate:0.996031746031746
noisy true:297
noisy false:327
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 624
epoch [59/200] batch [5/31] time 0.358 (0.351) data 0.279 (0.272) loss_x loss_x 0.3696 (0.4332) acc_x 93.7500 (90.0000) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [10/31] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.2396 (0.4019) acc_x 93.7500 (90.6250) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [15/31] time 0.326 (0.348) data 0.248 (0.270) loss_x loss_x 0.3855 (0.4360) acc_x 90.6250 (89.3750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [20/31] time 0.351 (0.348) data 0.273 (0.270) loss_x loss_x 0.4487 (0.4361) acc_x 96.8750 (89.8438) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/31] time 0.359 (0.349) data 0.281 (0.271) loss_x loss_x 0.4683 (0.4282) acc_x 84.3750 (89.8750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [30/31] time 0.340 (0.348) data 0.263 (0.270) loss_x loss_x 0.3494 (0.4355) acc_x 93.7500 (89.5833) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 309
confident_label rate tensor(0.6176, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1008
clean true:1006
clean false:2
clean_rate:0.998015873015873
noisy true:317
noisy false:307
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 624
epoch [60/200] batch [5/31] time 0.357 (0.344) data 0.280 (0.266) loss_x loss_x 0.4199 (0.4112) acc_x 87.5000 (89.3750) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [10/31] time 0.346 (0.342) data 0.268 (0.264) loss_x loss_x 0.5449 (0.4525) acc_x 84.3750 (88.4375) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [15/31] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.5894 (0.4548) acc_x 93.7500 (89.1667) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [20/31] time 0.317 (0.340) data 0.240 (0.262) loss_x loss_x 0.7622 (0.4521) acc_x 87.5000 (90.0000) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/31] time 0.340 (0.341) data 0.263 (0.264) loss_x loss_x 0.4045 (0.4485) acc_x 90.6250 (89.7500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/31] time 0.300 (0.337) data 0.222 (0.260) loss_x loss_x 0.5288 (0.4566) acc_x 90.6250 (89.6875) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 305
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1015
clean true:1011
clean false:4
clean_rate:0.9960591133004926
noisy true:316
noisy false:301
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 617
epoch [61/200] batch [5/31] time 0.349 (0.346) data 0.272 (0.268) loss_x loss_x 0.1947 (0.3642) acc_x 96.8750 (91.2500) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [10/31] time 0.310 (0.330) data 0.232 (0.252) loss_x loss_x 0.3884 (0.4150) acc_x 93.7500 (90.0000) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [15/31] time 0.340 (0.326) data 0.263 (0.249) loss_x loss_x 0.3506 (0.3891) acc_x 90.6250 (90.4167) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [20/31] time 0.350 (0.332) data 0.272 (0.254) loss_x loss_x 0.4248 (0.4015) acc_x 84.3750 (90.3125) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/31] time 0.310 (0.333) data 0.232 (0.255) loss_x loss_x 0.3694 (0.4004) acc_x 90.6250 (90.1250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/31] time 0.343 (0.333) data 0.265 (0.255) loss_x loss_x 0.2966 (0.4138) acc_x 93.7500 (89.7917) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.6250, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1020
clean true:1017
clean false:3
clean_rate:0.9970588235294118
noisy true:314
noisy false:298
after delete: len(clean_dataset) 1020
after delete: len(noisy_dataset) 612
epoch [62/200] batch [5/31] time 0.350 (0.317) data 0.272 (0.239) loss_x loss_x 0.4846 (0.4024) acc_x 87.5000 (90.0000) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [10/31] time 0.338 (0.333) data 0.261 (0.255) loss_x loss_x 0.7446 (0.4205) acc_x 84.3750 (90.3125) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [15/31] time 0.346 (0.337) data 0.268 (0.260) loss_x loss_x 0.6411 (0.4078) acc_x 90.6250 (91.0417) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [20/31] time 0.343 (0.340) data 0.266 (0.263) loss_x loss_x 0.2571 (0.4012) acc_x 100.0000 (91.7188) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [25/31] time 0.341 (0.342) data 0.263 (0.265) loss_x loss_x 0.6611 (0.4368) acc_x 81.2500 (90.5000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/31] time 0.348 (0.344) data 0.271 (0.266) loss_x loss_x 0.3679 (0.4357) acc_x 87.5000 (90.5208) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.6029, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 984
clean true:982
clean false:2
clean_rate:0.9979674796747967
noisy true:317
noisy false:331
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 648
epoch [63/200] batch [5/30] time 0.348 (0.351) data 0.270 (0.273) loss_x loss_x 0.6392 (0.3366) acc_x 84.3750 (93.1250) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [10/30] time 0.344 (0.349) data 0.267 (0.271) loss_x loss_x 0.2883 (0.3447) acc_x 90.6250 (91.2500) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [15/30] time 0.349 (0.347) data 0.272 (0.269) loss_x loss_x 0.4795 (0.3254) acc_x 90.6250 (92.5000) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [20/30] time 0.340 (0.347) data 0.262 (0.270) loss_x loss_x 0.2822 (0.3285) acc_x 93.7500 (92.6562) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [25/30] time 0.349 (0.345) data 0.272 (0.268) loss_x loss_x 0.2292 (0.3375) acc_x 93.7500 (92.7500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/30] time 0.307 (0.342) data 0.229 (0.264) loss_x loss_x 0.2546 (0.3492) acc_x 93.7500 (92.3958) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.6232, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1017
clean true:1015
clean false:2
clean_rate:0.9980334316617503
noisy true:318
noisy false:297
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 615
epoch [64/200] batch [5/31] time 0.348 (0.342) data 0.271 (0.265) loss_x loss_x 0.3774 (0.5672) acc_x 90.6250 (84.3750) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [10/31] time 0.315 (0.326) data 0.237 (0.248) loss_x loss_x 0.3025 (0.4644) acc_x 93.7500 (87.1875) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [15/31] time 0.338 (0.327) data 0.261 (0.249) loss_x loss_x 0.5166 (0.4431) acc_x 87.5000 (88.5417) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [20/31] time 0.337 (0.331) data 0.259 (0.253) loss_x loss_x 0.6343 (0.4519) acc_x 78.1250 (88.2812) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [25/31] time 0.326 (0.331) data 0.247 (0.254) loss_x loss_x 0.5361 (0.4305) acc_x 87.5000 (88.8750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/31] time 0.342 (0.332) data 0.265 (0.254) loss_x loss_x 0.3455 (0.4329) acc_x 90.6250 (88.8542) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 327
confident_label rate tensor(0.6183, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1009
clean true:1007
clean false:2
clean_rate:0.998017839444995
noisy true:298
noisy false:325
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 623
epoch [65/200] batch [5/31] time 0.312 (0.334) data 0.234 (0.256) loss_x loss_x 0.2598 (0.4119) acc_x 96.8750 (90.6250) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [10/31] time 0.352 (0.335) data 0.275 (0.257) loss_x loss_x 0.3584 (0.3885) acc_x 96.8750 (91.8750) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [15/31] time 0.349 (0.337) data 0.272 (0.259) loss_x loss_x 0.3267 (0.3626) acc_x 96.8750 (92.2917) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [20/31] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.5190 (0.3765) acc_x 90.6250 (92.0312) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [25/31] time 0.340 (0.340) data 0.263 (0.262) loss_x loss_x 0.6509 (0.3843) acc_x 78.1250 (91.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/31] time 0.340 (0.342) data 0.263 (0.264) loss_x loss_x 0.5059 (0.4054) acc_x 90.6250 (90.9375) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 311
confident_label rate tensor(0.6183, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1009
clean true:1006
clean false:3
clean_rate:0.9970267591674926
noisy true:315
noisy false:308
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 623
epoch [66/200] batch [5/31] time 0.349 (0.350) data 0.271 (0.273) loss_x loss_x 0.3713 (0.4862) acc_x 90.6250 (86.8750) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [10/31] time 0.343 (0.348) data 0.265 (0.271) loss_x loss_x 0.1282 (0.4372) acc_x 100.0000 (88.4375) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [15/31] time 0.335 (0.344) data 0.257 (0.267) loss_x loss_x 0.2025 (0.4858) acc_x 93.7500 (86.8750) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [20/31] time 0.334 (0.345) data 0.257 (0.267) loss_x loss_x 0.3301 (0.4457) acc_x 90.6250 (87.9688) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [25/31] time 0.358 (0.345) data 0.280 (0.267) loss_x loss_x 0.3025 (0.4289) acc_x 93.7500 (89.0000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/31] time 0.324 (0.345) data 0.247 (0.267) loss_x loss_x 0.3647 (0.4267) acc_x 87.5000 (89.0625) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 313
confident_label rate tensor(0.6158, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1005
clean true:1003
clean false:2
clean_rate:0.9980099502487563
noisy true:316
noisy false:311
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 627
epoch [67/200] batch [5/31] time 0.335 (0.336) data 0.258 (0.258) loss_x loss_x 0.3606 (0.4454) acc_x 90.6250 (91.2500) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [10/31] time 0.291 (0.328) data 0.214 (0.251) loss_x loss_x 0.3557 (0.4479) acc_x 93.7500 (89.6875) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [15/31] time 0.295 (0.319) data 0.217 (0.242) loss_x loss_x 0.2634 (0.4586) acc_x 96.8750 (89.7917) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [20/31] time 0.301 (0.314) data 0.224 (0.236) loss_x loss_x 0.3201 (0.4447) acc_x 93.7500 (90.6250) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [25/31] time 0.347 (0.319) data 0.269 (0.241) loss_x loss_x 0.4448 (0.4557) acc_x 90.6250 (90.1250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/31] time 0.342 (0.323) data 0.265 (0.245) loss_x loss_x 0.4985 (0.4603) acc_x 90.6250 (89.8958) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.6360, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1038
clean true:1035
clean false:3
clean_rate:0.9971098265895953
noisy true:320
noisy false:274
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 594
epoch [68/200] batch [5/32] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.4619 (0.6749) acc_x 93.7500 (87.5000) lr 1.5090e-03 eta 0:00:09
epoch [68/200] batch [10/32] time 0.337 (0.332) data 0.260 (0.254) loss_x loss_x 0.5688 (0.5733) acc_x 87.5000 (88.7500) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [15/32] time 0.349 (0.336) data 0.272 (0.258) loss_x loss_x 0.3396 (0.5160) acc_x 90.6250 (89.5833) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [20/32] time 0.339 (0.338) data 0.261 (0.260) loss_x loss_x 0.4126 (0.5235) acc_x 90.6250 (89.2188) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [25/32] time 0.344 (0.339) data 0.267 (0.261) loss_x loss_x 0.5649 (0.5110) acc_x 84.3750 (88.7500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/32] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.3472 (0.5080) acc_x 96.8750 (88.3333) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 309
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1015
clean true:1011
clean false:4
clean_rate:0.9960591133004926
noisy true:312
noisy false:305
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 617
epoch [69/200] batch [5/31] time 0.359 (0.353) data 0.282 (0.276) loss_x loss_x 0.2812 (0.4254) acc_x 90.6250 (88.1250) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [10/31] time 0.335 (0.345) data 0.258 (0.268) loss_x loss_x 0.4917 (0.4261) acc_x 84.3750 (89.6875) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [15/31] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.3628 (0.4221) acc_x 93.7500 (89.5833) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [20/31] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.4934 (0.4144) acc_x 90.6250 (90.1562) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [25/31] time 0.357 (0.348) data 0.280 (0.271) loss_x loss_x 0.3923 (0.3975) acc_x 93.7500 (90.8750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/31] time 0.341 (0.348) data 0.262 (0.270) loss_x loss_x 0.4780 (0.3908) acc_x 90.6250 (91.0417) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 305
confident_label rate tensor(0.6201, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1012
clean true:1010
clean false:2
clean_rate:0.9980237154150198
noisy true:317
noisy false:303
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 620
epoch [70/200] batch [5/31] time 0.339 (0.359) data 0.262 (0.281) loss_x loss_x 0.4148 (0.3728) acc_x 90.6250 (91.2500) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [10/31] time 0.317 (0.342) data 0.239 (0.264) loss_x loss_x 0.4456 (0.3669) acc_x 90.6250 (91.5625) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [15/31] time 0.312 (0.331) data 0.233 (0.253) loss_x loss_x 0.2612 (0.3492) acc_x 90.6250 (91.8750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [20/31] time 0.335 (0.333) data 0.257 (0.255) loss_x loss_x 0.4299 (0.3519) acc_x 87.5000 (91.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [25/31] time 0.339 (0.333) data 0.261 (0.256) loss_x loss_x 0.6479 (0.3804) acc_x 81.2500 (91.2500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/31] time 0.337 (0.334) data 0.259 (0.257) loss_x loss_x 0.3816 (0.3874) acc_x 87.5000 (90.8333) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.6262, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1022
clean true:1021
clean false:1
clean_rate:0.9990215264187867
noisy true:318
noisy false:292
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 610
epoch [71/200] batch [5/31] time 0.340 (0.332) data 0.261 (0.254) loss_x loss_x 0.4807 (0.3911) acc_x 84.3750 (91.8750) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [10/31] time 0.339 (0.339) data 0.261 (0.260) loss_x loss_x 0.6040 (0.4719) acc_x 84.3750 (89.0625) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [15/31] time 0.328 (0.342) data 0.251 (0.264) loss_x loss_x 0.6074 (0.4594) acc_x 78.1250 (88.7500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [20/31] time 0.337 (0.342) data 0.259 (0.264) loss_x loss_x 0.1884 (0.4365) acc_x 96.8750 (89.5312) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [25/31] time 0.346 (0.342) data 0.269 (0.265) loss_x loss_x 0.6069 (0.4456) acc_x 81.2500 (89.0000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/31] time 0.346 (0.343) data 0.269 (0.265) loss_x loss_x 0.4719 (0.4590) acc_x 90.6250 (88.7500) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.6213, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1014
clean true:1011
clean false:3
clean_rate:0.9970414201183432
noisy true:326
noisy false:292
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 618
epoch [72/200] batch [5/31] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.7148 (0.5421) acc_x 81.2500 (86.2500) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [10/31] time 0.336 (0.341) data 0.259 (0.263) loss_x loss_x 0.4309 (0.5063) acc_x 87.5000 (88.1250) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [15/31] time 0.346 (0.341) data 0.269 (0.263) loss_x loss_x 0.5034 (0.4959) acc_x 84.3750 (87.9167) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [20/31] time 0.331 (0.340) data 0.254 (0.263) loss_x loss_x 0.5464 (0.4904) acc_x 84.3750 (87.9688) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/31] time 0.331 (0.339) data 0.253 (0.262) loss_x loss_x 0.4724 (0.4788) acc_x 87.5000 (88.6250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/31] time 0.344 (0.341) data 0.266 (0.263) loss_x loss_x 0.5225 (0.4710) acc_x 87.5000 (88.8542) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.6330, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1033
clean true:1029
clean false:4
clean_rate:0.9961277831558567
noisy true:316
noisy false:283
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 599
epoch [73/200] batch [5/32] time 0.312 (0.332) data 0.235 (0.255) loss_x loss_x 0.3040 (0.3387) acc_x 90.6250 (91.2500) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [10/32] time 0.336 (0.329) data 0.258 (0.251) loss_x loss_x 0.2360 (0.3469) acc_x 96.8750 (92.5000) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [15/32] time 0.351 (0.333) data 0.274 (0.255) loss_x loss_x 0.2810 (0.3689) acc_x 87.5000 (90.6250) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [20/32] time 0.325 (0.335) data 0.246 (0.257) loss_x loss_x 0.5625 (0.3824) acc_x 87.5000 (90.9375) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [25/32] time 0.354 (0.337) data 0.277 (0.259) loss_x loss_x 0.3928 (0.3971) acc_x 84.3750 (90.2500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [30/32] time 0.343 (0.339) data 0.266 (0.262) loss_x loss_x 0.1821 (0.3976) acc_x 100.0000 (90.3125) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.6336, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1034
clean true:1031
clean false:3
clean_rate:0.9970986460348162
noisy true:326
noisy false:272
after delete: len(clean_dataset) 1034
after delete: len(noisy_dataset) 598
epoch [74/200] batch [5/32] time 0.348 (0.341) data 0.270 (0.263) loss_x loss_x 0.4951 (0.3467) acc_x 84.3750 (91.8750) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [10/32] time 0.340 (0.340) data 0.263 (0.262) loss_x loss_x 0.2576 (0.3832) acc_x 93.7500 (90.3125) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [15/32] time 0.352 (0.343) data 0.274 (0.265) loss_x loss_x 0.4302 (0.3674) acc_x 87.5000 (91.0417) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [20/32] time 0.344 (0.343) data 0.267 (0.265) loss_x loss_x 0.4690 (0.4039) acc_x 90.6250 (89.8438) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [25/32] time 0.358 (0.343) data 0.281 (0.266) loss_x loss_x 0.4260 (0.4274) acc_x 90.6250 (89.3750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [30/32] time 0.350 (0.342) data 0.273 (0.265) loss_x loss_x 0.5283 (0.4300) acc_x 90.6250 (89.2708) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 279
confident_label rate tensor(0.6305, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1029
clean true:1028
clean false:1
clean_rate:0.9990281827016521
noisy true:325
noisy false:278
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 603
epoch [75/200] batch [5/32] time 0.342 (0.359) data 0.264 (0.281) loss_x loss_x 0.2749 (0.3178) acc_x 90.6250 (92.5000) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [10/32] time 0.340 (0.354) data 0.262 (0.276) loss_x loss_x 0.5288 (0.3533) acc_x 84.3750 (92.1875) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [15/32] time 0.341 (0.350) data 0.264 (0.273) loss_x loss_x 0.2803 (0.3825) acc_x 96.8750 (91.8750) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [20/32] time 0.295 (0.341) data 0.217 (0.264) loss_x loss_x 0.5439 (0.4126) acc_x 87.5000 (91.0938) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [25/32] time 0.343 (0.335) data 0.266 (0.257) loss_x loss_x 0.5762 (0.4186) acc_x 84.3750 (90.7500) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [30/32] time 0.337 (0.335) data 0.260 (0.257) loss_x loss_x 0.5742 (0.4174) acc_x 90.6250 (90.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.6281, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1025
clean true:1024
clean false:1
clean_rate:0.9990243902439024
noisy true:316
noisy false:291
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 607
epoch [76/200] batch [5/32] time 0.350 (0.359) data 0.272 (0.281) loss_x loss_x 0.5386 (0.4583) acc_x 87.5000 (88.7500) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [10/32] time 0.329 (0.349) data 0.252 (0.271) loss_x loss_x 0.4204 (0.4304) acc_x 90.6250 (89.6875) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [15/32] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.4192 (0.4040) acc_x 90.6250 (90.4167) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [20/32] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.3423 (0.4190) acc_x 96.8750 (90.7812) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [25/32] time 0.347 (0.347) data 0.270 (0.270) loss_x loss_x 0.6943 (0.4204) acc_x 84.3750 (90.5000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/32] time 0.344 (0.347) data 0.267 (0.269) loss_x loss_x 0.5068 (0.4200) acc_x 84.3750 (90.5208) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.6305, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1029
clean true:1028
clean false:1
clean_rate:0.9990281827016521
noisy true:309
noisy false:294
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 603
epoch [77/200] batch [5/32] time 0.342 (0.347) data 0.263 (0.269) loss_x loss_x 0.2395 (0.3897) acc_x 96.8750 (92.5000) lr 1.3827e-03 eta 0:00:09
epoch [77/200] batch [10/32] time 0.348 (0.348) data 0.270 (0.270) loss_x loss_x 0.5039 (0.3865) acc_x 90.6250 (91.5625) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [15/32] time 0.301 (0.339) data 0.224 (0.261) loss_x loss_x 0.3191 (0.3945) acc_x 100.0000 (92.0833) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [20/32] time 0.307 (0.334) data 0.229 (0.256) loss_x loss_x 0.2983 (0.3777) acc_x 90.6250 (92.5000) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [25/32] time 0.348 (0.334) data 0.271 (0.256) loss_x loss_x 0.2690 (0.3755) acc_x 96.8750 (92.3750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [30/32] time 0.330 (0.336) data 0.252 (0.258) loss_x loss_x 0.5503 (0.3914) acc_x 84.3750 (91.6667) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.6152, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1004
clean true:1003
clean false:1
clean_rate:0.999003984063745
noisy true:328
noisy false:300
after delete: len(clean_dataset) 1004
after delete: len(noisy_dataset) 628
epoch [78/200] batch [5/31] time 0.351 (0.342) data 0.274 (0.264) loss_x loss_x 0.2520 (0.3609) acc_x 93.7500 (90.6250) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [10/31] time 0.344 (0.334) data 0.266 (0.256) loss_x loss_x 0.1848 (0.3898) acc_x 100.0000 (90.6250) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [15/31] time 0.358 (0.339) data 0.280 (0.262) loss_x loss_x 0.6919 (0.4271) acc_x 84.3750 (89.3750) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [20/31] time 0.334 (0.341) data 0.255 (0.263) loss_x loss_x 0.5283 (0.4122) acc_x 84.3750 (89.5312) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [25/31] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.4419 (0.3946) acc_x 90.6250 (90.1250) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/31] time 0.346 (0.339) data 0.268 (0.261) loss_x loss_x 0.2693 (0.3740) acc_x 87.5000 (90.3125) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 278
confident_label rate tensor(0.6330, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1033
clean true:1031
clean false:2
clean_rate:0.9980638915779284
noisy true:323
noisy false:276
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 599
epoch [79/200] batch [5/32] time 0.316 (0.339) data 0.238 (0.261) loss_x loss_x 0.2637 (0.2780) acc_x 84.3750 (90.0000) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [10/32] time 0.363 (0.331) data 0.286 (0.253) loss_x loss_x 0.2333 (0.2971) acc_x 96.8750 (91.2500) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [15/32] time 0.350 (0.337) data 0.273 (0.259) loss_x loss_x 0.3472 (0.3276) acc_x 96.8750 (91.6667) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [20/32] time 0.341 (0.337) data 0.264 (0.259) loss_x loss_x 0.4861 (0.3280) acc_x 87.5000 (91.8750) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [25/32] time 0.336 (0.338) data 0.259 (0.260) loss_x loss_x 0.3691 (0.3656) acc_x 90.6250 (90.8750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/32] time 0.350 (0.338) data 0.273 (0.261) loss_x loss_x 0.4160 (0.3641) acc_x 87.5000 (91.1458) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.6422, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1048
clean true:1045
clean false:3
clean_rate:0.9971374045801527
noisy true:324
noisy false:260
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 584
epoch [80/200] batch [5/32] time 0.347 (0.348) data 0.270 (0.270) loss_x loss_x 0.3113 (0.3144) acc_x 93.7500 (92.5000) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [10/32] time 0.333 (0.345) data 0.256 (0.267) loss_x loss_x 0.5894 (0.3893) acc_x 84.3750 (91.2500) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [15/32] time 0.341 (0.345) data 0.264 (0.267) loss_x loss_x 0.4116 (0.3989) acc_x 87.5000 (89.7917) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [20/32] time 0.348 (0.345) data 0.271 (0.268) loss_x loss_x 0.5098 (0.3953) acc_x 84.3750 (90.3125) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [25/32] time 0.350 (0.347) data 0.273 (0.269) loss_x loss_x 0.5933 (0.4117) acc_x 81.2500 (90.1250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/32] time 0.348 (0.347) data 0.270 (0.270) loss_x loss_x 0.2881 (0.3910) acc_x 90.6250 (90.3125) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 278
confident_label rate tensor(0.6317, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1031
clean true:1026
clean false:5
clean_rate:0.9951503394762367
noisy true:328
noisy false:273
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 601
epoch [81/200] batch [5/32] time 0.350 (0.356) data 0.273 (0.278) loss_x loss_x 0.3105 (0.3418) acc_x 93.7500 (93.1250) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/32] time 0.348 (0.349) data 0.271 (0.271) loss_x loss_x 0.2037 (0.3547) acc_x 96.8750 (92.1875) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [15/32] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.7451 (0.4026) acc_x 78.1250 (90.4167) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [20/32] time 0.326 (0.340) data 0.246 (0.262) loss_x loss_x 0.3408 (0.3825) acc_x 90.6250 (91.2500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/32] time 0.355 (0.343) data 0.278 (0.265) loss_x loss_x 0.6094 (0.3946) acc_x 78.1250 (90.3750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/32] time 0.359 (0.345) data 0.281 (0.267) loss_x loss_x 0.3132 (0.3876) acc_x 87.5000 (90.7292) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 297
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1015
clean true:1013
clean false:2
clean_rate:0.9980295566502463
noisy true:322
noisy false:295
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 617
epoch [82/200] batch [5/31] time 0.350 (0.351) data 0.273 (0.274) loss_x loss_x 0.3679 (0.3425) acc_x 93.7500 (91.8750) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [10/31] time 0.355 (0.346) data 0.277 (0.268) loss_x loss_x 0.4919 (0.4295) acc_x 87.5000 (90.0000) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [15/31] time 0.336 (0.349) data 0.258 (0.271) loss_x loss_x 0.7637 (0.4434) acc_x 78.1250 (88.9583) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [20/31] time 0.349 (0.347) data 0.272 (0.269) loss_x loss_x 0.2227 (0.4455) acc_x 96.8750 (88.7500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [25/31] time 0.340 (0.348) data 0.263 (0.270) loss_x loss_x 0.3081 (0.4094) acc_x 100.0000 (90.2500) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [30/31] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.3013 (0.3998) acc_x 93.7500 (90.6250) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.6250, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1020
clean true:1016
clean false:4
clean_rate:0.996078431372549
noisy true:321
noisy false:291
after delete: len(clean_dataset) 1020
after delete: len(noisy_dataset) 612
epoch [83/200] batch [5/31] time 0.350 (0.350) data 0.272 (0.272) loss_x loss_x 0.3716 (0.3673) acc_x 90.6250 (88.7500) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [10/31] time 0.347 (0.351) data 0.270 (0.273) loss_x loss_x 0.7847 (0.4280) acc_x 87.5000 (89.3750) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [15/31] time 0.347 (0.350) data 0.270 (0.272) loss_x loss_x 0.3364 (0.4536) acc_x 93.7500 (88.5417) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [20/31] time 0.340 (0.351) data 0.263 (0.273) loss_x loss_x 0.3503 (0.4622) acc_x 93.7500 (88.7500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [25/31] time 0.359 (0.351) data 0.282 (0.274) loss_x loss_x 0.2991 (0.4678) acc_x 96.8750 (89.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/31] time 0.341 (0.350) data 0.264 (0.273) loss_x loss_x 0.2764 (0.4633) acc_x 100.0000 (89.5833) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 281
confident_label rate tensor(0.6342, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1035
clean true:1032
clean false:3
clean_rate:0.9971014492753624
noisy true:319
noisy false:278
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 597
epoch [84/200] batch [5/32] time 0.373 (0.364) data 0.295 (0.286) loss_x loss_x 0.3616 (0.3246) acc_x 90.6250 (93.7500) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/32] time 0.385 (0.362) data 0.308 (0.285) loss_x loss_x 0.3611 (0.3688) acc_x 87.5000 (91.8750) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [15/32] time 0.353 (0.352) data 0.275 (0.274) loss_x loss_x 0.3994 (0.3745) acc_x 90.6250 (91.4583) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [20/32] time 0.337 (0.350) data 0.260 (0.272) loss_x loss_x 0.2708 (0.3976) acc_x 96.8750 (90.9375) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [25/32] time 0.328 (0.348) data 0.251 (0.270) loss_x loss_x 0.4670 (0.4017) acc_x 84.3750 (91.0000) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/32] time 0.347 (0.344) data 0.269 (0.267) loss_x loss_x 0.2954 (0.3950) acc_x 93.7500 (90.9375) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.6434, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1050
clean true:1049
clean false:1
clean_rate:0.9990476190476191
noisy true:323
noisy false:259
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 582
epoch [85/200] batch [5/32] time 0.311 (0.320) data 0.234 (0.242) loss_x loss_x 0.2374 (0.3181) acc_x 96.8750 (95.0000) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [10/32] time 0.296 (0.308) data 0.218 (0.230) loss_x loss_x 0.2419 (0.3983) acc_x 96.8750 (91.8750) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [15/32] time 0.299 (0.304) data 0.222 (0.227) loss_x loss_x 0.2729 (0.4319) acc_x 93.7500 (90.8333) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [20/32] time 0.350 (0.313) data 0.273 (0.235) loss_x loss_x 0.6689 (0.4430) acc_x 84.3750 (90.4688) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [25/32] time 0.351 (0.320) data 0.274 (0.243) loss_x loss_x 0.5552 (0.4327) acc_x 81.2500 (90.6250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [30/32] time 0.353 (0.325) data 0.276 (0.248) loss_x loss_x 0.4058 (0.4361) acc_x 93.7500 (90.6250) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.6366, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1039
clean true:1038
clean false:1
clean_rate:0.9990375360923965
noisy true:327
noisy false:266
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 593
epoch [86/200] batch [5/32] time 0.332 (0.350) data 0.254 (0.272) loss_x loss_x 0.4839 (0.3483) acc_x 90.6250 (93.1250) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [10/32] time 0.344 (0.350) data 0.266 (0.272) loss_x loss_x 0.4761 (0.3797) acc_x 84.3750 (91.2500) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [15/32] time 0.357 (0.350) data 0.280 (0.272) loss_x loss_x 0.5791 (0.3873) acc_x 87.5000 (91.2500) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [20/32] time 0.345 (0.349) data 0.268 (0.271) loss_x loss_x 0.4180 (0.3770) acc_x 81.2500 (90.7812) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [25/32] time 0.351 (0.349) data 0.274 (0.271) loss_x loss_x 0.4253 (0.3744) acc_x 84.3750 (90.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/32] time 0.330 (0.345) data 0.252 (0.268) loss_x loss_x 0.4194 (0.3997) acc_x 90.6250 (90.0000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.6458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1054
clean true:1052
clean false:2
clean_rate:0.9981024667931688
noisy true:329
noisy false:249
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 578
epoch [87/200] batch [5/32] time 0.333 (0.345) data 0.256 (0.267) loss_x loss_x 0.6016 (0.4893) acc_x 81.2500 (86.8750) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/32] time 0.302 (0.331) data 0.224 (0.253) loss_x loss_x 0.3806 (0.4475) acc_x 93.7500 (88.4375) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/32] time 0.359 (0.331) data 0.281 (0.253) loss_x loss_x 0.7129 (0.4788) acc_x 78.1250 (87.9167) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [20/32] time 0.345 (0.335) data 0.266 (0.257) loss_x loss_x 1.0635 (0.5117) acc_x 75.0000 (87.1875) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [25/32] time 0.323 (0.336) data 0.244 (0.258) loss_x loss_x 0.5020 (0.5095) acc_x 84.3750 (86.7500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/32] time 0.332 (0.334) data 0.255 (0.256) loss_x loss_x 0.3943 (0.4977) acc_x 90.6250 (87.2917) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.6281, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1025
clean true:1023
clean false:2
clean_rate:0.9980487804878049
noisy true:313
noisy false:294
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 607
epoch [88/200] batch [5/32] time 0.352 (0.338) data 0.275 (0.261) loss_x loss_x 0.2386 (0.3444) acc_x 96.8750 (91.8750) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [10/32] time 0.341 (0.329) data 0.263 (0.252) loss_x loss_x 0.5698 (0.4320) acc_x 90.6250 (90.0000) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [15/32] time 0.343 (0.331) data 0.266 (0.253) loss_x loss_x 0.2964 (0.4074) acc_x 93.7500 (90.6250) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [20/32] time 0.338 (0.334) data 0.261 (0.256) loss_x loss_x 0.2866 (0.3920) acc_x 93.7500 (91.2500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [25/32] time 0.342 (0.335) data 0.264 (0.258) loss_x loss_x 0.4309 (0.4006) acc_x 90.6250 (90.8750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [30/32] time 0.323 (0.334) data 0.246 (0.256) loss_x loss_x 0.6802 (0.4062) acc_x 87.5000 (90.7292) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.6428, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1049
clean true:1048
clean false:1
clean_rate:0.9990467111534795
noisy true:328
noisy false:255
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 583
epoch [89/200] batch [5/32] time 0.350 (0.347) data 0.272 (0.270) loss_x loss_x 0.2795 (0.3485) acc_x 96.8750 (95.0000) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/32] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.1875 (0.3053) acc_x 96.8750 (94.6875) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [15/32] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.3445 (0.3198) acc_x 93.7500 (94.1667) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [20/32] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.2800 (0.3400) acc_x 96.8750 (93.7500) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [25/32] time 0.363 (0.349) data 0.286 (0.271) loss_x loss_x 0.3394 (0.3574) acc_x 93.7500 (92.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [30/32] time 0.346 (0.349) data 0.268 (0.272) loss_x loss_x 0.2993 (0.3723) acc_x 100.0000 (92.0833) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.6422, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1048
clean true:1044
clean false:4
clean_rate:0.9961832061068703
noisy true:317
noisy false:267
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 584
epoch [90/200] batch [5/32] time 0.343 (0.351) data 0.266 (0.274) loss_x loss_x 1.1045 (0.4397) acc_x 68.7500 (90.0000) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/32] time 0.356 (0.349) data 0.279 (0.272) loss_x loss_x 0.4268 (0.4116) acc_x 87.5000 (89.0625) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [15/32] time 0.346 (0.349) data 0.268 (0.272) loss_x loss_x 0.2275 (0.3940) acc_x 93.7500 (89.5833) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [20/32] time 0.347 (0.343) data 0.269 (0.266) loss_x loss_x 0.2776 (0.3776) acc_x 93.7500 (90.4688) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [25/32] time 0.359 (0.345) data 0.281 (0.268) loss_x loss_x 0.4529 (0.3847) acc_x 87.5000 (90.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [30/32] time 0.328 (0.345) data 0.249 (0.267) loss_x loss_x 0.3389 (0.3899) acc_x 87.5000 (90.0000) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.6391, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1043
clean true:1041
clean false:2
clean_rate:0.9980824544582934
noisy true:326
noisy false:263
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 589
epoch [91/200] batch [5/32] time 0.319 (0.336) data 0.241 (0.258) loss_x loss_x 0.2203 (0.4274) acc_x 93.7500 (90.0000) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [10/32] time 0.343 (0.335) data 0.265 (0.257) loss_x loss_x 0.4468 (0.4274) acc_x 87.5000 (90.6250) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [15/32] time 0.354 (0.341) data 0.275 (0.264) loss_x loss_x 0.2949 (0.4123) acc_x 93.7500 (90.8333) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [20/32] time 0.358 (0.342) data 0.280 (0.265) loss_x loss_x 0.3477 (0.3965) acc_x 93.7500 (91.4062) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/32] time 0.360 (0.346) data 0.282 (0.268) loss_x loss_x 0.5830 (0.3873) acc_x 84.3750 (91.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/32] time 0.352 (0.346) data 0.274 (0.269) loss_x loss_x 0.4219 (0.3939) acc_x 87.5000 (91.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.6495, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1060
clean true:1056
clean false:4
clean_rate:0.9962264150943396
noisy true:334
noisy false:238
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 572
epoch [92/200] batch [5/33] time 0.335 (0.330) data 0.257 (0.253) loss_x loss_x 0.2949 (0.3592) acc_x 93.7500 (91.2500) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [10/33] time 0.344 (0.335) data 0.266 (0.258) loss_x loss_x 0.3513 (0.4178) acc_x 96.8750 (89.3750) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/33] time 0.345 (0.340) data 0.267 (0.262) loss_x loss_x 0.2976 (0.3900) acc_x 90.6250 (90.0000) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [20/33] time 0.339 (0.339) data 0.262 (0.261) loss_x loss_x 0.3633 (0.3971) acc_x 93.7500 (90.3125) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [25/33] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.5454 (0.3929) acc_x 90.6250 (90.5000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/33] time 0.337 (0.340) data 0.260 (0.262) loss_x loss_x 0.5117 (0.4009) acc_x 90.6250 (90.5208) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.6489, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1059
clean true:1058
clean false:1
clean_rate:0.9990557129367328
noisy true:330
noisy false:243
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 573
epoch [93/200] batch [5/33] time 0.355 (0.349) data 0.278 (0.271) loss_x loss_x 0.4836 (0.4843) acc_x 90.6250 (86.8750) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [10/33] time 0.346 (0.345) data 0.268 (0.268) loss_x loss_x 0.3660 (0.4126) acc_x 93.7500 (90.3125) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [15/33] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.6357 (0.4198) acc_x 84.3750 (89.7917) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [20/33] time 0.307 (0.334) data 0.229 (0.256) loss_x loss_x 0.4248 (0.4103) acc_x 90.6250 (90.4688) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [25/33] time 0.350 (0.333) data 0.272 (0.256) loss_x loss_x 0.1809 (0.3823) acc_x 100.0000 (91.3750) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [30/33] time 0.363 (0.336) data 0.285 (0.258) loss_x loss_x 0.3027 (0.3915) acc_x 90.6250 (90.7292) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.6373, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1040
clean true:1037
clean false:3
clean_rate:0.9971153846153846
noisy true:330
noisy false:262
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 592
epoch [94/200] batch [5/32] time 0.343 (0.340) data 0.266 (0.262) loss_x loss_x 0.8438 (0.5292) acc_x 81.2500 (85.6250) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [10/32] time 0.329 (0.339) data 0.252 (0.262) loss_x loss_x 0.7544 (0.4901) acc_x 75.0000 (86.5625) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/32] time 0.302 (0.337) data 0.224 (0.259) loss_x loss_x 0.3545 (0.4505) acc_x 93.7500 (87.9167) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [20/32] time 0.348 (0.340) data 0.271 (0.262) loss_x loss_x 0.4526 (0.4461) acc_x 87.5000 (88.5938) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [25/32] time 0.351 (0.341) data 0.274 (0.264) loss_x loss_x 0.3245 (0.4257) acc_x 90.6250 (89.2500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/32] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.4509 (0.4068) acc_x 87.5000 (89.6875) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.6373, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1040
clean true:1039
clean false:1
clean_rate:0.9990384615384615
noisy true:322
noisy false:270
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 592
epoch [95/200] batch [5/32] time 0.343 (0.353) data 0.266 (0.275) loss_x loss_x 0.4851 (0.4751) acc_x 90.6250 (91.2500) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [10/32] time 0.341 (0.351) data 0.263 (0.274) loss_x loss_x 0.3250 (0.3913) acc_x 93.7500 (92.1875) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [15/32] time 0.357 (0.344) data 0.278 (0.266) loss_x loss_x 0.3943 (0.3880) acc_x 87.5000 (92.5000) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [20/32] time 0.342 (0.343) data 0.265 (0.265) loss_x loss_x 0.2866 (0.3801) acc_x 96.8750 (91.8750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [25/32] time 0.348 (0.343) data 0.270 (0.265) loss_x loss_x 0.2761 (0.3843) acc_x 93.7500 (91.5000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [30/32] time 0.339 (0.343) data 0.262 (0.265) loss_x loss_x 0.5854 (0.4004) acc_x 90.6250 (90.9375) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.6495, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1060
clean true:1057
clean false:3
clean_rate:0.9971698113207547
noisy true:321
noisy false:251
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 572
epoch [96/200] batch [5/33] time 0.331 (0.348) data 0.253 (0.270) loss_x loss_x 0.6758 (0.5602) acc_x 87.5000 (88.7500) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [10/33] time 0.337 (0.346) data 0.259 (0.269) loss_x loss_x 0.5684 (0.4893) acc_x 84.3750 (89.6875) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/33] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.3149 (0.4682) acc_x 90.6250 (90.4167) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [20/33] time 0.338 (0.345) data 0.261 (0.267) loss_x loss_x 0.6782 (0.4718) acc_x 90.6250 (90.0000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [25/33] time 0.330 (0.338) data 0.253 (0.260) loss_x loss_x 0.2739 (0.4480) acc_x 96.8750 (90.5000) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [30/33] time 0.341 (0.338) data 0.264 (0.260) loss_x loss_x 0.6304 (0.4582) acc_x 84.3750 (90.2083) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.6440, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1051
clean true:1049
clean false:2
clean_rate:0.9980970504281637
noisy true:319
noisy false:262
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 581
epoch [97/200] batch [5/32] time 0.344 (0.337) data 0.267 (0.259) loss_x loss_x 0.5381 (0.4245) acc_x 87.5000 (89.3750) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [10/32] time 0.339 (0.342) data 0.261 (0.264) loss_x loss_x 0.4424 (0.4152) acc_x 90.6250 (90.3125) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [15/32] time 0.312 (0.338) data 0.234 (0.260) loss_x loss_x 0.2338 (0.3943) acc_x 96.8750 (90.6250) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [20/32] time 0.343 (0.340) data 0.266 (0.262) loss_x loss_x 0.6074 (0.4203) acc_x 84.3750 (90.1562) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [25/32] time 0.321 (0.340) data 0.244 (0.263) loss_x loss_x 0.4255 (0.4242) acc_x 87.5000 (89.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [30/32] time 0.335 (0.342) data 0.257 (0.264) loss_x loss_x 0.4475 (0.4066) acc_x 87.5000 (90.2083) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.6391, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1043
clean true:1040
clean false:3
clean_rate:0.99712368168744
noisy true:324
noisy false:265
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 589
epoch [98/200] batch [5/32] time 0.343 (0.341) data 0.265 (0.263) loss_x loss_x 0.3569 (0.3862) acc_x 90.6250 (93.1250) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [10/32] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.3379 (0.4017) acc_x 90.6250 (91.8750) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [15/32] time 0.309 (0.337) data 0.231 (0.259) loss_x loss_x 0.4348 (0.3875) acc_x 81.2500 (91.6667) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [20/32] time 0.344 (0.335) data 0.266 (0.258) loss_x loss_x 0.2252 (0.3804) acc_x 96.8750 (91.8750) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [25/32] time 0.327 (0.334) data 0.249 (0.257) loss_x loss_x 0.2325 (0.3819) acc_x 96.8750 (91.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/32] time 0.343 (0.337) data 0.265 (0.259) loss_x loss_x 0.2064 (0.3706) acc_x 100.0000 (92.2917) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.6458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1054
clean true:1053
clean false:1
clean_rate:0.9990512333965844
noisy true:335
noisy false:243
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 578
epoch [99/200] batch [5/32] time 0.347 (0.356) data 0.269 (0.277) loss_x loss_x 0.3884 (0.3156) acc_x 87.5000 (93.1250) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/32] time 0.355 (0.353) data 0.277 (0.275) loss_x loss_x 0.4863 (0.3389) acc_x 87.5000 (91.8750) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [15/32] time 0.361 (0.352) data 0.283 (0.274) loss_x loss_x 0.5713 (0.3829) acc_x 84.3750 (91.4583) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [20/32] time 0.353 (0.350) data 0.276 (0.272) loss_x loss_x 0.1757 (0.3666) acc_x 96.8750 (91.5625) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [25/32] time 0.299 (0.341) data 0.221 (0.263) loss_x loss_x 0.4189 (0.3867) acc_x 93.7500 (90.8750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/32] time 0.332 (0.339) data 0.255 (0.261) loss_x loss_x 0.6636 (0.4131) acc_x 78.1250 (90.1042) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.6379, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1041
clean true:1039
clean false:2
clean_rate:0.9980787704130644
noisy true:322
noisy false:269
all clean rate:  [0.9929078014184397, 0.9908256880733946, 0.9955357142857143, 0.9970326409495549, 0.9940740740740741, 0.9957446808510638, 0.9971910112359551, 0.995774647887324, 0.9944827586206897, 0.9958333333333333, 0.9958275382475661, 0.9973297730307076, 0.9920739762219286, 0.9947437582128777, 0.9947984395318595, 0.993581514762516, 0.9962168978562421, 1.0, 0.9987623762376238, 0.9963636363636363, 0.9964994165694282, 0.9953161592505855, 0.9965034965034965, 0.997709049255441, 1.0, 0.9978021978021978, 0.994475138121547, 0.9967355821545157, 0.9988901220865705, 0.9967637540453075, 0.9978425026968716, 0.995575221238938, 0.997867803837953, 0.9967707212055974, 0.9957492029755579, 0.9968387776606955, 0.9937238493723849, 0.9958202716823407, 0.9935622317596566, 0.9894291754756871, 0.993801652892562, 0.9979296066252588, 0.993933265925177, 0.9948717948717949, 0.9947089947089947, 0.995880535530381, 0.9939819458375125, 0.994994994994995, 0.9969666329625885, 0.9938775510204082, 0.9939698492462311, 0.9939393939393939, 0.992936427850656, 0.995995995995996, 0.9959798994974874, 0.9950347567030785, 0.996, 0.9951219512195122, 0.996031746031746, 0.998015873015873, 0.9960591133004926, 0.9970588235294118, 0.9979674796747967, 0.9980334316617503, 0.998017839444995, 0.9970267591674926, 0.9980099502487563, 0.9971098265895953, 0.9960591133004926, 0.9980237154150198, 0.9990215264187867, 0.9970414201183432, 0.9961277831558567, 0.9970986460348162, 0.9990281827016521, 0.9990243902439024, 0.9990281827016521, 0.999003984063745, 0.9980638915779284, 0.9971374045801527, 0.9951503394762367, 0.9980295566502463, 0.996078431372549, 0.9971014492753624, 0.9990476190476191, 0.9990375360923965, 0.9981024667931688, 0.9980487804878049, 0.9990467111534795, 0.9961832061068703, 0.9980824544582934, 0.9962264150943396, 0.9990557129367328, 0.9971153846153846, 0.9990384615384615, 0.9971698113207547, 0.9980970504281637, 0.99712368168744, 0.9990512333965844, 0.9980787704130644]
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 591
epoch [100/200] batch [5/32] time 0.305 (0.334) data 0.227 (0.255) loss_x loss_x 0.1083 (0.4619) acc_x 100.0000 (88.1250) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [10/32] time 0.337 (0.333) data 0.259 (0.255) loss_x loss_x 0.1830 (0.4137) acc_x 96.8750 (89.6875) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [15/32] time 0.347 (0.332) data 0.270 (0.254) loss_x loss_x 0.4263 (0.3924) acc_x 87.5000 (90.4167) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [20/32] time 0.302 (0.329) data 0.224 (0.251) loss_x loss_x 0.4343 (0.3897) acc_x 87.5000 (90.4688) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [25/32] time 0.337 (0.333) data 0.259 (0.256) loss_x loss_x 0.4653 (0.4117) acc_x 87.5000 (90.1250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [30/32] time 0.354 (0.336) data 0.277 (0.258) loss_x loss_x 0.3999 (0.4103) acc_x 84.3750 (90.0000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.6422, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1048
clean true:1046
clean false:2
clean_rate:0.9980916030534351
noisy true:329
noisy false:255
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 584
epoch [101/200] batch [5/32] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.6323 (0.3524) acc_x 81.2500 (91.2500) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [10/32] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.5503 (0.3437) acc_x 84.3750 (91.2500) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [15/32] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.3459 (0.3565) acc_x 93.7500 (91.4583) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [20/32] time 0.350 (0.343) data 0.272 (0.265) loss_x loss_x 0.6343 (0.3671) acc_x 90.6250 (91.4062) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [25/32] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.4294 (0.3593) acc_x 90.6250 (91.5000) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [30/32] time 0.357 (0.344) data 0.280 (0.267) loss_x loss_x 0.3447 (0.3601) acc_x 90.6250 (91.4583) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.6526, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1065
clean true:1061
clean false:4
clean_rate:0.996244131455399
noisy true:319
noisy false:248
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 567
epoch [102/200] batch [5/33] time 0.344 (0.347) data 0.266 (0.268) loss_x loss_x 0.3696 (0.3330) acc_x 84.3750 (91.2500) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [10/33] time 0.344 (0.343) data 0.267 (0.265) loss_x loss_x 0.3298 (0.3969) acc_x 96.8750 (89.6875) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [15/33] time 0.363 (0.347) data 0.285 (0.269) loss_x loss_x 0.3499 (0.4094) acc_x 90.6250 (89.7917) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [20/33] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.3792 (0.4098) acc_x 90.6250 (90.0000) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [25/33] time 0.299 (0.345) data 0.220 (0.267) loss_x loss_x 0.2277 (0.4055) acc_x 100.0000 (90.3750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [30/33] time 0.348 (0.340) data 0.270 (0.262) loss_x loss_x 0.1906 (0.3985) acc_x 100.0000 (90.5208) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.6336, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1034
clean true:1032
clean false:2
clean_rate:0.9980657640232108
noisy true:323
noisy false:275
after delete: len(clean_dataset) 1034
after delete: len(noisy_dataset) 598
epoch [103/200] batch [5/32] time 0.308 (0.310) data 0.230 (0.232) loss_x loss_x 0.2737 (0.3284) acc_x 93.7500 (93.7500) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [10/32] time 0.344 (0.324) data 0.266 (0.246) loss_x loss_x 0.1951 (0.3262) acc_x 96.8750 (93.7500) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [15/32] time 0.324 (0.328) data 0.247 (0.250) loss_x loss_x 0.4263 (0.3946) acc_x 84.3750 (91.2500) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [20/32] time 0.337 (0.328) data 0.259 (0.250) loss_x loss_x 0.1895 (0.3797) acc_x 100.0000 (91.8750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [25/32] time 0.361 (0.332) data 0.284 (0.254) loss_x loss_x 0.2434 (0.3701) acc_x 93.7500 (91.8750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [30/32] time 0.343 (0.334) data 0.266 (0.256) loss_x loss_x 0.4565 (0.3764) acc_x 87.5000 (91.7708) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.6464, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1055
clean true:1051
clean false:4
clean_rate:0.9962085308056872
noisy true:318
noisy false:259
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 577
epoch [104/200] batch [5/32] time 0.347 (0.351) data 0.269 (0.273) loss_x loss_x 0.4214 (0.4124) acc_x 90.6250 (88.7500) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [10/32] time 0.343 (0.347) data 0.266 (0.269) loss_x loss_x 0.2688 (0.3974) acc_x 93.7500 (90.0000) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/32] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.5195 (0.4109) acc_x 84.3750 (90.6250) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [20/32] time 0.320 (0.344) data 0.242 (0.266) loss_x loss_x 0.4119 (0.4041) acc_x 90.6250 (91.0938) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [25/32] time 0.350 (0.345) data 0.273 (0.267) loss_x loss_x 0.2520 (0.4047) acc_x 93.7500 (91.0000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [30/32] time 0.326 (0.344) data 0.248 (0.266) loss_x loss_x 0.2717 (0.4129) acc_x 90.6250 (90.7292) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.6409, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1046
clean true:1043
clean false:3
clean_rate:0.997131931166348
noisy true:336
noisy false:250
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 586
epoch [105/200] batch [5/32] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.2969 (0.3868) acc_x 90.6250 (91.2500) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [10/32] time 0.342 (0.348) data 0.265 (0.270) loss_x loss_x 0.8003 (0.4837) acc_x 81.2500 (89.3750) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/32] time 0.344 (0.348) data 0.266 (0.271) loss_x loss_x 0.4392 (0.4671) acc_x 84.3750 (88.9583) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [20/32] time 0.346 (0.348) data 0.268 (0.271) loss_x loss_x 0.5010 (0.4348) acc_x 84.3750 (89.2188) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [25/32] time 0.312 (0.345) data 0.233 (0.268) loss_x loss_x 0.2181 (0.4351) acc_x 93.7500 (89.0000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/32] time 0.382 (0.347) data 0.304 (0.269) loss_x loss_x 0.3811 (0.4104) acc_x 90.6250 (89.8958) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.6562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1071
clean true:1068
clean false:3
clean_rate:0.9971988795518207
noisy true:338
noisy false:223
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 561
epoch [106/200] batch [5/33] time 0.350 (0.336) data 0.273 (0.259) loss_x loss_x 0.1168 (0.3170) acc_x 100.0000 (93.7500) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [10/33] time 0.353 (0.341) data 0.276 (0.264) loss_x loss_x 0.2559 (0.3610) acc_x 93.7500 (91.5625) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [15/33] time 0.342 (0.342) data 0.263 (0.264) loss_x loss_x 0.6768 (0.3793) acc_x 75.0000 (90.8333) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [20/33] time 0.312 (0.340) data 0.234 (0.262) loss_x loss_x 0.1831 (0.3609) acc_x 93.7500 (91.4062) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [25/33] time 0.297 (0.332) data 0.219 (0.254) loss_x loss_x 0.5337 (0.3702) acc_x 93.7500 (91.3750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [30/33] time 0.334 (0.331) data 0.256 (0.253) loss_x loss_x 0.4783 (0.3693) acc_x 84.3750 (91.3542) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.6501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1061
clean true:1059
clean false:2
clean_rate:0.998114985862394
noisy true:327
noisy false:244
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 571
epoch [107/200] batch [5/33] time 0.316 (0.337) data 0.237 (0.259) loss_x loss_x 0.3879 (0.3725) acc_x 87.5000 (88.7500) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [10/33] time 0.301 (0.322) data 0.223 (0.244) loss_x loss_x 0.4170 (0.3565) acc_x 93.7500 (90.9375) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/33] time 0.355 (0.326) data 0.277 (0.248) loss_x loss_x 0.3816 (0.3568) acc_x 90.6250 (91.6667) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [20/33] time 0.350 (0.331) data 0.271 (0.253) loss_x loss_x 0.3591 (0.3615) acc_x 93.7500 (92.1875) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [25/33] time 0.358 (0.332) data 0.281 (0.254) loss_x loss_x 0.1974 (0.3631) acc_x 96.8750 (92.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/33] time 0.341 (0.335) data 0.263 (0.257) loss_x loss_x 0.4109 (0.3608) acc_x 87.5000 (92.5000) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.6495, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1060
clean true:1056
clean false:4
clean_rate:0.9962264150943396
noisy true:337
noisy false:235
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 572
epoch [108/200] batch [5/33] time 0.346 (0.342) data 0.269 (0.264) loss_x loss_x 0.2529 (0.3152) acc_x 87.5000 (92.5000) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/33] time 0.354 (0.344) data 0.277 (0.266) loss_x loss_x 0.4985 (0.3325) acc_x 87.5000 (92.1875) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/33] time 0.351 (0.345) data 0.273 (0.267) loss_x loss_x 0.3269 (0.3383) acc_x 93.7500 (91.2500) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [20/33] time 0.347 (0.345) data 0.269 (0.267) loss_x loss_x 0.6147 (0.3779) acc_x 78.1250 (89.8438) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [25/33] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.3330 (0.3729) acc_x 93.7500 (90.0000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [30/33] time 0.339 (0.344) data 0.262 (0.267) loss_x loss_x 0.5298 (0.3693) acc_x 84.3750 (90.2083) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.6397, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1044
clean true:1041
clean false:3
clean_rate:0.9971264367816092
noisy true:329
noisy false:259
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 588
epoch [109/200] batch [5/32] time 0.349 (0.353) data 0.271 (0.275) loss_x loss_x 0.3657 (0.4007) acc_x 90.6250 (91.2500) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [10/32] time 0.350 (0.349) data 0.273 (0.272) loss_x loss_x 0.4043 (0.3838) acc_x 90.6250 (91.5625) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [15/32] time 0.333 (0.343) data 0.255 (0.265) loss_x loss_x 0.1750 (0.3533) acc_x 93.7500 (92.2917) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [20/32] time 0.352 (0.344) data 0.274 (0.266) loss_x loss_x 0.6943 (0.3829) acc_x 87.5000 (91.5625) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [25/32] time 0.324 (0.344) data 0.245 (0.266) loss_x loss_x 0.3867 (0.3793) acc_x 93.7500 (91.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [30/32] time 0.340 (0.345) data 0.263 (0.267) loss_x loss_x 0.2688 (0.3727) acc_x 100.0000 (92.0833) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.6575, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1073
clean true:1069
clean false:4
clean_rate:0.9962721342031687
noisy true:332
noisy false:227
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 559
epoch [110/200] batch [5/33] time 0.353 (0.358) data 0.275 (0.281) loss_x loss_x 0.4099 (0.4095) acc_x 84.3750 (90.0000) lr 8.7467e-04 eta 0:00:10
epoch [110/200] batch [10/33] time 0.343 (0.358) data 0.265 (0.280) loss_x loss_x 0.3779 (0.3958) acc_x 90.6250 (91.2500) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [15/33] time 0.349 (0.355) data 0.272 (0.278) loss_x loss_x 0.6338 (0.3795) acc_x 81.2500 (91.8750) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [20/33] time 0.342 (0.354) data 0.264 (0.276) loss_x loss_x 0.5801 (0.3798) acc_x 87.5000 (91.2500) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [25/33] time 0.366 (0.354) data 0.288 (0.276) loss_x loss_x 0.2368 (0.3991) acc_x 93.7500 (90.7500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [30/33] time 0.357 (0.353) data 0.280 (0.275) loss_x loss_x 0.3110 (0.4090) acc_x 93.7500 (90.4167) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.6544, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1068
clean true:1066
clean false:2
clean_rate:0.99812734082397
noisy true:322
noisy false:242
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 564
epoch [111/200] batch [5/33] time 0.367 (0.354) data 0.289 (0.277) loss_x loss_x 0.2925 (0.4417) acc_x 96.8750 (93.1250) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [10/33] time 0.337 (0.346) data 0.259 (0.269) loss_x loss_x 0.4961 (0.4067) acc_x 87.5000 (91.8750) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [15/33] time 0.349 (0.346) data 0.271 (0.269) loss_x loss_x 0.3169 (0.3633) acc_x 93.7500 (93.3333) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [20/33] time 0.296 (0.339) data 0.218 (0.262) loss_x loss_x 0.4727 (0.3743) acc_x 87.5000 (92.3438) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [25/33] time 0.324 (0.335) data 0.246 (0.257) loss_x loss_x 0.4978 (0.3713) acc_x 90.6250 (92.2500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [30/33] time 0.350 (0.336) data 0.272 (0.258) loss_x loss_x 0.6660 (0.3827) acc_x 84.3750 (91.8750) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.6624, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1081
clean true:1079
clean false:2
clean_rate:0.9981498612395929
noisy true:330
noisy false:221
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 551
epoch [112/200] batch [5/33] time 0.353 (0.353) data 0.275 (0.275) loss_x loss_x 0.2374 (0.3848) acc_x 100.0000 (93.7500) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [10/33] time 0.350 (0.351) data 0.273 (0.273) loss_x loss_x 0.2988 (0.3685) acc_x 93.7500 (91.8750) lr 8.4357e-04 eta 0:00:08
epoch [112/200] batch [15/33] time 0.358 (0.348) data 0.279 (0.270) loss_x loss_x 0.3909 (0.3466) acc_x 93.7500 (93.3333) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [20/33] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.2886 (0.3384) acc_x 93.7500 (93.5938) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [25/33] time 0.344 (0.347) data 0.266 (0.269) loss_x loss_x 0.2480 (0.3604) acc_x 93.7500 (92.7500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [30/33] time 0.355 (0.348) data 0.277 (0.270) loss_x loss_x 0.4343 (0.3754) acc_x 87.5000 (92.3958) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.6385, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1042
clean true:1038
clean false:4
clean_rate:0.9961612284069098
noisy true:319
noisy false:271
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 590
epoch [113/200] batch [5/32] time 0.307 (0.340) data 0.228 (0.262) loss_x loss_x 0.3267 (0.3522) acc_x 93.7500 (93.1250) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [10/32] time 0.344 (0.338) data 0.265 (0.260) loss_x loss_x 0.1860 (0.3387) acc_x 96.8750 (92.5000) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [15/32] time 0.358 (0.342) data 0.281 (0.264) loss_x loss_x 0.2083 (0.3209) acc_x 93.7500 (92.9167) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [20/32] time 0.331 (0.341) data 0.253 (0.264) loss_x loss_x 0.4536 (0.3510) acc_x 90.6250 (92.3438) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [25/32] time 0.351 (0.343) data 0.274 (0.265) loss_x loss_x 0.1531 (0.3442) acc_x 100.0000 (92.6250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [30/32] time 0.337 (0.342) data 0.259 (0.264) loss_x loss_x 0.1892 (0.3652) acc_x 96.8750 (92.2917) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1063
clean true:1060
clean false:3
clean_rate:0.9971777986829727
noisy true:338
noisy false:231
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 569
epoch [114/200] batch [5/33] time 0.343 (0.343) data 0.266 (0.266) loss_x loss_x 0.2354 (0.4035) acc_x 93.7500 (88.7500) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [10/33] time 0.347 (0.342) data 0.270 (0.265) loss_x loss_x 0.4822 (0.4235) acc_x 81.2500 (88.4375) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [15/33] time 0.330 (0.344) data 0.252 (0.266) loss_x loss_x 0.7217 (0.4037) acc_x 90.6250 (90.4167) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [20/33] time 0.312 (0.335) data 0.234 (0.257) loss_x loss_x 0.2235 (0.3750) acc_x 96.8750 (91.2500) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [25/33] time 0.342 (0.336) data 0.265 (0.258) loss_x loss_x 0.4380 (0.3535) acc_x 90.6250 (91.8750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [30/33] time 0.347 (0.337) data 0.270 (0.260) loss_x loss_x 0.3613 (0.3580) acc_x 87.5000 (91.6667) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 240
confident_label rate tensor(0.6526, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1065
clean true:1063
clean false:2
clean_rate:0.9981220657276996
noisy true:329
noisy false:238
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 567
epoch [115/200] batch [5/33] time 0.351 (0.348) data 0.273 (0.271) loss_x loss_x 0.3689 (0.3863) acc_x 93.7500 (91.8750) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [10/33] time 0.339 (0.344) data 0.261 (0.267) loss_x loss_x 0.2864 (0.3916) acc_x 93.7500 (90.9375) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [15/33] time 0.302 (0.333) data 0.224 (0.255) loss_x loss_x 0.3076 (0.3659) acc_x 87.5000 (91.2500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [20/33] time 0.327 (0.332) data 0.249 (0.254) loss_x loss_x 0.3105 (0.3635) acc_x 93.7500 (91.4062) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [25/33] time 0.338 (0.334) data 0.261 (0.257) loss_x loss_x 0.2869 (0.3623) acc_x 93.7500 (91.1250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [30/33] time 0.296 (0.329) data 0.218 (0.251) loss_x loss_x 0.4216 (0.3650) acc_x 90.6250 (91.4583) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.6569, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1072
clean true:1070
clean false:2
clean_rate:0.9981343283582089
noisy true:331
noisy false:229
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 560
epoch [116/200] batch [5/33] time 0.339 (0.351) data 0.262 (0.273) loss_x loss_x 0.1957 (0.2975) acc_x 96.8750 (94.3750) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [10/33] time 0.338 (0.349) data 0.261 (0.272) loss_x loss_x 0.2720 (0.2976) acc_x 93.7500 (93.7500) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [15/33] time 0.335 (0.347) data 0.257 (0.270) loss_x loss_x 0.4106 (0.3116) acc_x 93.7500 (93.7500) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [20/33] time 0.364 (0.349) data 0.287 (0.271) loss_x loss_x 0.1761 (0.3230) acc_x 96.8750 (92.9688) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [25/33] time 0.361 (0.350) data 0.283 (0.272) loss_x loss_x 0.1964 (0.3176) acc_x 96.8750 (93.5000) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [30/33] time 0.341 (0.348) data 0.263 (0.270) loss_x loss_x 0.5591 (0.3277) acc_x 87.5000 (93.0208) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1064
clean false:6
clean_rate:0.994392523364486
noisy true:329
noisy false:233
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [117/200] batch [5/33] time 0.352 (0.344) data 0.274 (0.267) loss_x loss_x 0.5552 (0.3884) acc_x 90.6250 (93.7500) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [10/33] time 0.358 (0.347) data 0.281 (0.269) loss_x loss_x 0.4324 (0.3512) acc_x 84.3750 (92.1875) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/33] time 0.301 (0.335) data 0.223 (0.258) loss_x loss_x 0.1743 (0.3221) acc_x 96.8750 (92.7083) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [20/33] time 0.346 (0.332) data 0.267 (0.254) loss_x loss_x 0.4778 (0.3395) acc_x 84.3750 (91.8750) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [25/33] time 0.346 (0.335) data 0.269 (0.258) loss_x loss_x 0.3108 (0.3273) acc_x 84.3750 (91.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [30/33] time 0.358 (0.340) data 0.280 (0.262) loss_x loss_x 0.2622 (0.3479) acc_x 93.7500 (91.7708) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6575, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1073
clean true:1070
clean false:3
clean_rate:0.9972041006523765
noisy true:344
noisy false:215
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 559
epoch [118/200] batch [5/33] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.3303 (0.3217) acc_x 93.7500 (92.5000) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [10/33] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.4595 (0.3703) acc_x 90.6250 (91.5625) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [15/33] time 0.350 (0.344) data 0.273 (0.266) loss_x loss_x 0.3254 (0.3676) acc_x 93.7500 (91.6667) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [20/33] time 0.352 (0.344) data 0.275 (0.267) loss_x loss_x 0.2050 (0.3731) acc_x 96.8750 (91.0938) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [25/33] time 0.351 (0.345) data 0.270 (0.267) loss_x loss_x 0.4133 (0.3635) acc_x 87.5000 (91.1250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [30/33] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.5005 (0.3761) acc_x 90.6250 (90.9375) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.6501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1061
clean true:1058
clean false:3
clean_rate:0.9971724787935909
noisy true:340
noisy false:231
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 571
epoch [119/200] batch [5/33] time 0.362 (0.348) data 0.285 (0.270) loss_x loss_x 0.4487 (0.3984) acc_x 93.7500 (92.5000) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [10/33] time 0.362 (0.349) data 0.285 (0.271) loss_x loss_x 0.1000 (0.3702) acc_x 100.0000 (91.5625) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [15/33] time 0.348 (0.347) data 0.271 (0.269) loss_x loss_x 0.3613 (0.3426) acc_x 93.7500 (92.0833) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [20/33] time 0.353 (0.350) data 0.276 (0.272) loss_x loss_x 0.3542 (0.3364) acc_x 90.6250 (92.3438) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [25/33] time 0.352 (0.350) data 0.275 (0.272) loss_x loss_x 0.2678 (0.3417) acc_x 93.7500 (92.5000) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/33] time 0.306 (0.346) data 0.228 (0.269) loss_x loss_x 0.2205 (0.3288) acc_x 96.8750 (92.6042) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.6483, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1058
clean true:1054
clean false:4
clean_rate:0.996219281663516
noisy true:346
noisy false:228
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 574
epoch [120/200] batch [5/33] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.5825 (0.3568) acc_x 81.2500 (88.1250) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [10/33] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.3201 (0.3350) acc_x 93.7500 (91.2500) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [15/33] time 0.344 (0.343) data 0.267 (0.265) loss_x loss_x 0.4417 (0.3515) acc_x 90.6250 (91.0417) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [20/33] time 0.340 (0.342) data 0.263 (0.264) loss_x loss_x 0.5898 (0.3772) acc_x 87.5000 (90.1562) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [25/33] time 0.356 (0.343) data 0.278 (0.266) loss_x loss_x 0.2410 (0.3599) acc_x 96.8750 (91.1250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/33] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.3191 (0.3655) acc_x 93.7500 (90.8333) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.6605, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1078
clean true:1073
clean false:5
clean_rate:0.9953617810760668
noisy true:346
noisy false:208
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 554
epoch [121/200] batch [5/33] time 0.351 (0.343) data 0.273 (0.266) loss_x loss_x 0.2214 (0.3985) acc_x 96.8750 (88.7500) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [10/33] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.1870 (0.3324) acc_x 96.8750 (90.9375) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [15/33] time 0.340 (0.343) data 0.262 (0.266) loss_x loss_x 0.4019 (0.3411) acc_x 84.3750 (91.0417) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [20/33] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.3274 (0.3225) acc_x 90.6250 (91.4062) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [25/33] time 0.327 (0.341) data 0.249 (0.263) loss_x loss_x 0.5308 (0.3355) acc_x 87.5000 (91.1250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [30/33] time 0.349 (0.342) data 0.270 (0.264) loss_x loss_x 0.2803 (0.3425) acc_x 93.7500 (91.2500) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1063
clean true:1061
clean false:2
clean_rate:0.9981185324553151
noisy true:334
noisy false:235
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 569
epoch [122/200] batch [5/33] time 0.319 (0.343) data 0.242 (0.266) loss_x loss_x 0.4902 (0.3448) acc_x 84.3750 (91.2500) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [10/33] time 0.333 (0.340) data 0.256 (0.262) loss_x loss_x 0.1522 (0.3551) acc_x 100.0000 (91.5625) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [15/33] time 0.353 (0.347) data 0.275 (0.269) loss_x loss_x 0.3567 (0.3619) acc_x 90.6250 (91.2500) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [20/33] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.2947 (0.3864) acc_x 96.8750 (90.9375) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [25/33] time 0.298 (0.341) data 0.220 (0.263) loss_x loss_x 0.4180 (0.3919) acc_x 90.6250 (90.8750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [30/33] time 0.329 (0.335) data 0.251 (0.257) loss_x loss_x 0.2695 (0.3816) acc_x 93.7500 (91.1458) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.6661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1087
clean true:1083
clean false:4
clean_rate:0.9963201471941122
noisy true:343
noisy false:202
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 545
epoch [123/200] batch [5/33] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.3647 (0.3066) acc_x 93.7500 (92.5000) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [10/33] time 0.356 (0.336) data 0.278 (0.258) loss_x loss_x 0.6016 (0.3158) acc_x 84.3750 (91.8750) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [15/33] time 0.352 (0.338) data 0.274 (0.260) loss_x loss_x 0.3992 (0.3735) acc_x 93.7500 (90.2083) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [20/33] time 0.317 (0.336) data 0.239 (0.258) loss_x loss_x 0.3933 (0.3820) acc_x 87.5000 (90.1562) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [25/33] time 0.349 (0.333) data 0.271 (0.255) loss_x loss_x 0.5688 (0.3741) acc_x 84.3750 (90.6250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [30/33] time 0.349 (0.336) data 0.271 (0.257) loss_x loss_x 0.3757 (0.3834) acc_x 93.7500 (90.8333) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1097
clean false:4
clean_rate:0.9963669391462306
noisy true:328
noisy false:203
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [124/200] batch [5/34] time 0.339 (0.351) data 0.262 (0.274) loss_x loss_x 0.2356 (0.2182) acc_x 96.8750 (97.5000) lr 6.6126e-04 eta 0:00:10
epoch [124/200] batch [10/34] time 0.336 (0.351) data 0.258 (0.273) loss_x loss_x 0.4866 (0.2752) acc_x 84.3750 (94.6875) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [15/34] time 0.346 (0.350) data 0.268 (0.272) loss_x loss_x 0.3357 (0.3056) acc_x 93.7500 (93.7500) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [20/34] time 0.345 (0.349) data 0.268 (0.271) loss_x loss_x 0.3738 (0.3215) acc_x 90.6250 (93.1250) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [25/34] time 0.320 (0.342) data 0.243 (0.264) loss_x loss_x 0.2996 (0.3355) acc_x 90.6250 (92.8750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [30/34] time 0.349 (0.342) data 0.271 (0.265) loss_x loss_x 0.3779 (0.3424) acc_x 93.7500 (93.0208) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1069
clean false:1
clean_rate:0.9990654205607477
noisy true:338
noisy false:224
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [125/200] batch [5/33] time 0.349 (0.345) data 0.271 (0.268) loss_x loss_x 0.3530 (0.4241) acc_x 93.7500 (90.6250) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [10/33] time 0.332 (0.344) data 0.254 (0.266) loss_x loss_x 0.3213 (0.3905) acc_x 96.8750 (90.6250) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/33] time 0.335 (0.345) data 0.258 (0.267) loss_x loss_x 0.4343 (0.3887) acc_x 87.5000 (90.4167) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [20/33] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.3147 (0.3904) acc_x 93.7500 (90.1562) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [25/33] time 0.332 (0.344) data 0.254 (0.267) loss_x loss_x 0.8506 (0.4008) acc_x 78.1250 (89.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [30/33] time 0.291 (0.339) data 0.213 (0.262) loss_x loss_x 0.1864 (0.3952) acc_x 96.8750 (89.7917) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.6605, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1078
clean true:1075
clean false:3
clean_rate:0.9972170686456401
noisy true:343
noisy false:211
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 554
epoch [126/200] batch [5/33] time 0.341 (0.346) data 0.264 (0.269) loss_x loss_x 0.2886 (0.3357) acc_x 93.7500 (92.5000) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [10/33] time 0.302 (0.332) data 0.224 (0.255) loss_x loss_x 0.2561 (0.3007) acc_x 93.7500 (93.7500) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [15/33] time 0.348 (0.329) data 0.270 (0.251) loss_x loss_x 0.4172 (0.3252) acc_x 90.6250 (92.7083) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [20/33] time 0.343 (0.334) data 0.265 (0.256) loss_x loss_x 0.5898 (0.3203) acc_x 81.2500 (92.6562) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [25/33] time 0.313 (0.336) data 0.235 (0.258) loss_x loss_x 0.4216 (0.3114) acc_x 84.3750 (92.7500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/33] time 0.356 (0.336) data 0.279 (0.258) loss_x loss_x 0.2445 (0.3126) acc_x 93.7500 (92.5000) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6783, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1107
clean true:1104
clean false:3
clean_rate:0.997289972899729
noisy true:343
noisy false:182
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 525
epoch [127/200] batch [5/34] time 0.304 (0.327) data 0.225 (0.249) loss_x loss_x 0.2888 (0.3648) acc_x 96.8750 (91.2500) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [10/34] time 0.337 (0.334) data 0.259 (0.256) loss_x loss_x 0.4231 (0.3490) acc_x 90.6250 (91.2500) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [15/34] time 0.337 (0.336) data 0.259 (0.258) loss_x loss_x 0.3013 (0.3668) acc_x 93.7500 (91.4583) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [20/34] time 0.363 (0.338) data 0.284 (0.261) loss_x loss_x 0.3987 (0.3672) acc_x 90.6250 (91.5625) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [25/34] time 0.351 (0.341) data 0.274 (0.263) loss_x loss_x 0.3240 (0.3897) acc_x 96.8750 (90.8750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [30/34] time 0.339 (0.341) data 0.262 (0.263) loss_x loss_x 0.5791 (0.3950) acc_x 90.6250 (90.7292) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6685, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1091
clean true:1088
clean false:3
clean_rate:0.997250229147571
noisy true:348
noisy false:193
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 541
epoch [128/200] batch [5/34] time 0.340 (0.351) data 0.263 (0.274) loss_x loss_x 0.3950 (0.4566) acc_x 87.5000 (86.2500) lr 6.0285e-04 eta 0:00:10
epoch [128/200] batch [10/34] time 0.372 (0.350) data 0.295 (0.272) loss_x loss_x 0.2971 (0.3845) acc_x 90.6250 (89.0625) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [15/34] time 0.345 (0.350) data 0.268 (0.272) loss_x loss_x 0.1755 (0.3807) acc_x 100.0000 (90.4167) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [20/34] time 0.336 (0.348) data 0.258 (0.271) loss_x loss_x 0.3186 (0.3740) acc_x 90.6250 (90.4688) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [25/34] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.7544 (0.3879) acc_x 81.2500 (90.1250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [30/34] time 0.322 (0.345) data 0.243 (0.267) loss_x loss_x 0.3469 (0.3832) acc_x 96.8750 (90.5208) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.6661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1087
clean true:1084
clean false:3
clean_rate:0.9972401103955841
noisy true:333
noisy false:212
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 545
epoch [129/200] batch [5/33] time 0.340 (0.341) data 0.262 (0.264) loss_x loss_x 0.3862 (0.3686) acc_x 87.5000 (91.8750) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [10/33] time 0.341 (0.336) data 0.263 (0.258) loss_x loss_x 0.2512 (0.3885) acc_x 96.8750 (92.1875) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [15/33] time 0.343 (0.336) data 0.266 (0.259) loss_x loss_x 0.2888 (0.3968) acc_x 96.8750 (92.0833) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [20/33] time 0.326 (0.338) data 0.248 (0.260) loss_x loss_x 0.3142 (0.3722) acc_x 90.6250 (92.3438) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [25/33] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.2859 (0.3643) acc_x 87.5000 (92.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [30/33] time 0.338 (0.340) data 0.260 (0.263) loss_x loss_x 0.5356 (0.3661) acc_x 87.5000 (91.6667) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1077
clean false:3
clean_rate:0.9972222222222222
noisy true:337
noisy false:215
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [130/200] batch [5/33] time 0.340 (0.329) data 0.263 (0.251) loss_x loss_x 0.4246 (0.4055) acc_x 90.6250 (90.0000) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [10/33] time 0.344 (0.335) data 0.266 (0.257) loss_x loss_x 0.3572 (0.3974) acc_x 90.6250 (90.3125) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/33] time 0.355 (0.340) data 0.278 (0.262) loss_x loss_x 0.2927 (0.3728) acc_x 93.7500 (91.0417) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [20/33] time 0.340 (0.340) data 0.263 (0.262) loss_x loss_x 0.3257 (0.3767) acc_x 90.6250 (91.2500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [25/33] time 0.336 (0.341) data 0.259 (0.264) loss_x loss_x 0.5244 (0.3744) acc_x 87.5000 (91.0000) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [30/33] time 0.364 (0.342) data 0.287 (0.265) loss_x loss_x 0.3250 (0.3612) acc_x 93.7500 (91.2500) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1087
clean false:2
clean_rate:0.9981634527089073
noisy true:333
noisy false:210
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [131/200] batch [5/34] time 0.346 (0.352) data 0.269 (0.275) loss_x loss_x 0.2903 (0.2908) acc_x 96.8750 (95.0000) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [10/34] time 0.349 (0.351) data 0.271 (0.273) loss_x loss_x 0.2983 (0.2961) acc_x 90.6250 (93.7500) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [15/34] time 0.359 (0.352) data 0.282 (0.274) loss_x loss_x 0.2573 (0.3036) acc_x 93.7500 (92.7083) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [20/34] time 0.350 (0.352) data 0.272 (0.274) loss_x loss_x 0.1360 (0.2991) acc_x 100.0000 (92.6562) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [25/34] time 0.352 (0.352) data 0.275 (0.274) loss_x loss_x 0.3232 (0.2926) acc_x 93.7500 (92.8750) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [30/34] time 0.298 (0.347) data 0.220 (0.269) loss_x loss_x 0.3867 (0.3115) acc_x 87.5000 (92.5000) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1068
clean false:2
clean_rate:0.9981308411214953
noisy true:331
noisy false:231
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [132/200] batch [5/33] time 0.312 (0.306) data 0.233 (0.228) loss_x loss_x 0.2035 (0.3636) acc_x 93.7500 (91.8750) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [10/33] time 0.348 (0.320) data 0.269 (0.242) loss_x loss_x 0.3455 (0.3267) acc_x 90.6250 (93.1250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [15/33] time 0.334 (0.325) data 0.257 (0.247) loss_x loss_x 0.3657 (0.3350) acc_x 93.7500 (92.9167) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [20/33] time 0.337 (0.327) data 0.253 (0.249) loss_x loss_x 0.2382 (0.3339) acc_x 96.8750 (92.9688) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [25/33] time 0.338 (0.328) data 0.260 (0.249) loss_x loss_x 0.2844 (0.3340) acc_x 93.7500 (92.5000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [30/33] time 0.358 (0.332) data 0.280 (0.254) loss_x loss_x 0.4114 (0.3501) acc_x 93.7500 (92.3958) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1092
clean false:2
clean_rate:0.9981718464351006
noisy true:340
noisy false:198
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [133/200] batch [5/34] time 0.361 (0.314) data 0.284 (0.236) loss_x loss_x 0.4912 (0.4043) acc_x 90.6250 (90.6250) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [10/34] time 0.368 (0.334) data 0.291 (0.257) loss_x loss_x 0.1295 (0.3660) acc_x 100.0000 (91.8750) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [15/34] time 0.355 (0.338) data 0.278 (0.260) loss_x loss_x 0.4236 (0.3674) acc_x 90.6250 (91.2500) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [20/34] time 0.317 (0.338) data 0.239 (0.260) loss_x loss_x 0.2708 (0.3558) acc_x 93.7500 (92.1875) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [25/34] time 0.360 (0.342) data 0.282 (0.264) loss_x loss_x 0.2712 (0.3515) acc_x 90.6250 (91.7500) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [30/34] time 0.352 (0.344) data 0.274 (0.267) loss_x loss_x 0.3540 (0.3538) acc_x 93.7500 (91.7708) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6697, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1093
clean true:1090
clean false:3
clean_rate:0.9972552607502287
noisy true:350
noisy false:189
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 539
epoch [134/200] batch [5/34] time 0.314 (0.350) data 0.235 (0.271) loss_x loss_x 0.3701 (0.2981) acc_x 84.3750 (93.1250) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [10/34] time 0.366 (0.359) data 0.288 (0.280) loss_x loss_x 0.3679 (0.3312) acc_x 93.7500 (91.2500) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [15/34] time 0.363 (0.362) data 0.286 (0.283) loss_x loss_x 0.3718 (0.3430) acc_x 93.7500 (92.0833) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [20/34] time 0.302 (0.355) data 0.224 (0.277) loss_x loss_x 0.3967 (0.3657) acc_x 93.7500 (91.5625) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [25/34] time 0.341 (0.350) data 0.263 (0.271) loss_x loss_x 0.4521 (0.3585) acc_x 90.6250 (92.0000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [30/34] time 0.342 (0.349) data 0.265 (0.270) loss_x loss_x 0.4502 (0.3529) acc_x 84.3750 (91.9792) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.6593, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1076
clean true:1072
clean false:4
clean_rate:0.9962825278810409
noisy true:334
noisy false:222
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 556
epoch [135/200] batch [5/33] time 0.339 (0.362) data 0.262 (0.285) loss_x loss_x 0.2346 (0.2873) acc_x 96.8750 (92.5000) lr 5.0454e-04 eta 0:00:10
epoch [135/200] batch [10/33] time 0.352 (0.347) data 0.274 (0.269) loss_x loss_x 0.2174 (0.2615) acc_x 96.8750 (93.4375) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/33] time 0.363 (0.350) data 0.285 (0.272) loss_x loss_x 0.3071 (0.2950) acc_x 93.7500 (93.1250) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [20/33] time 0.364 (0.352) data 0.286 (0.274) loss_x loss_x 0.2212 (0.3266) acc_x 93.7500 (92.6562) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [25/33] time 0.353 (0.352) data 0.275 (0.274) loss_x loss_x 0.2734 (0.3186) acc_x 93.7500 (93.0000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [30/33] time 0.341 (0.351) data 0.264 (0.273) loss_x loss_x 0.5254 (0.3270) acc_x 87.5000 (92.5000) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6605, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1078
clean true:1076
clean false:2
clean_rate:0.9981447124304267
noisy true:347
noisy false:207
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 554
epoch [136/200] batch [5/33] time 0.349 (0.351) data 0.270 (0.273) loss_x loss_x 0.3359 (0.3035) acc_x 90.6250 (90.6250) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/33] time 0.347 (0.349) data 0.268 (0.271) loss_x loss_x 0.3091 (0.3450) acc_x 90.6250 (90.0000) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [15/33] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.1362 (0.3264) acc_x 100.0000 (91.6667) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [20/33] time 0.342 (0.345) data 0.264 (0.267) loss_x loss_x 0.3169 (0.3404) acc_x 93.7500 (91.2500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [25/33] time 0.341 (0.345) data 0.264 (0.267) loss_x loss_x 0.1799 (0.3233) acc_x 96.8750 (91.7500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [30/33] time 0.352 (0.344) data 0.275 (0.266) loss_x loss_x 0.1871 (0.3365) acc_x 96.8750 (91.6667) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1096
clean false:3
clean_rate:0.997270245677889
noisy true:344
noisy false:189
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [137/200] batch [5/34] time 0.344 (0.346) data 0.266 (0.268) loss_x loss_x 0.1841 (0.3062) acc_x 96.8750 (95.0000) lr 4.7750e-04 eta 0:00:10
epoch [137/200] batch [10/34] time 0.344 (0.346) data 0.267 (0.268) loss_x loss_x 0.3579 (0.3889) acc_x 90.6250 (92.1875) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [15/34] time 0.303 (0.339) data 0.225 (0.262) loss_x loss_x 0.3862 (0.3627) acc_x 90.6250 (92.5000) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [20/34] time 0.338 (0.336) data 0.260 (0.258) loss_x loss_x 0.3623 (0.3640) acc_x 96.8750 (92.6562) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [25/34] time 0.341 (0.336) data 0.264 (0.259) loss_x loss_x 0.4292 (0.3686) acc_x 87.5000 (92.5000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [30/34] time 0.368 (0.338) data 0.290 (0.260) loss_x loss_x 0.2419 (0.3638) acc_x 93.7500 (92.3958) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.6575, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1073
clean true:1070
clean false:3
clean_rate:0.9972041006523765
noisy true:339
noisy false:220
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 559
epoch [138/200] batch [5/33] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.2534 (0.2902) acc_x 96.8750 (94.3750) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [10/33] time 0.337 (0.337) data 0.259 (0.259) loss_x loss_x 0.0925 (0.2735) acc_x 100.0000 (94.6875) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [15/33] time 0.335 (0.338) data 0.258 (0.260) loss_x loss_x 0.4263 (0.3109) acc_x 84.3750 (93.1250) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [20/33] time 0.351 (0.340) data 0.273 (0.263) loss_x loss_x 0.6045 (0.3457) acc_x 87.5000 (92.1875) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [25/33] time 0.320 (0.339) data 0.243 (0.261) loss_x loss_x 0.3506 (0.3491) acc_x 87.5000 (92.0000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [30/33] time 0.338 (0.339) data 0.260 (0.261) loss_x loss_x 0.4019 (0.3490) acc_x 87.5000 (91.7708) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1085
clean false:0
clean_rate:1.0
noisy true:345
noisy false:202
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [139/200] batch [5/33] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.1835 (0.2643) acc_x 96.8750 (95.0000) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [10/33] time 0.351 (0.350) data 0.273 (0.272) loss_x loss_x 0.4541 (0.3657) acc_x 93.7500 (92.8125) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [15/33] time 0.334 (0.348) data 0.256 (0.270) loss_x loss_x 0.4397 (0.3523) acc_x 93.7500 (93.1250) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [20/33] time 0.332 (0.346) data 0.254 (0.268) loss_x loss_x 0.2263 (0.3422) acc_x 96.8750 (92.9688) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [25/33] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.2566 (0.3250) acc_x 90.6250 (93.2500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [30/33] time 0.354 (0.347) data 0.276 (0.269) loss_x loss_x 0.2659 (0.3246) acc_x 96.8750 (93.2292) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 205
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1093
clean false:2
clean_rate:0.9981735159817352
noisy true:334
noisy false:203
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [140/200] batch [5/34] time 0.342 (0.346) data 0.265 (0.267) loss_x loss_x 0.4368 (0.3995) acc_x 90.6250 (91.8750) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [10/34] time 0.352 (0.346) data 0.275 (0.268) loss_x loss_x 0.3503 (0.3715) acc_x 93.7500 (92.5000) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [15/34] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.1930 (0.3447) acc_x 96.8750 (92.9167) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [20/34] time 0.316 (0.342) data 0.238 (0.264) loss_x loss_x 0.5796 (0.3627) acc_x 81.2500 (91.5625) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [25/34] time 0.354 (0.342) data 0.277 (0.265) loss_x loss_x 0.3552 (0.3855) acc_x 87.5000 (90.3750) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [30/34] time 0.347 (0.344) data 0.269 (0.266) loss_x loss_x 0.4819 (0.3760) acc_x 93.7500 (91.0417) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1086
clean false:3
clean_rate:0.9972451790633609
noisy true:332
noisy false:211
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [141/200] batch [5/34] time 0.358 (0.358) data 0.281 (0.280) loss_x loss_x 0.4924 (0.3407) acc_x 87.5000 (93.1250) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [10/34] time 0.312 (0.346) data 0.234 (0.268) loss_x loss_x 0.1975 (0.3466) acc_x 96.8750 (92.1875) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [15/34] time 0.307 (0.331) data 0.230 (0.253) loss_x loss_x 0.2537 (0.3637) acc_x 90.6250 (91.6667) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [20/34] time 0.351 (0.336) data 0.274 (0.258) loss_x loss_x 0.4304 (0.3717) acc_x 90.6250 (91.2500) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [25/34] time 0.336 (0.337) data 0.259 (0.259) loss_x loss_x 0.4443 (0.3759) acc_x 87.5000 (91.0000) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [30/34] time 0.344 (0.338) data 0.266 (0.260) loss_x loss_x 0.1454 (0.3812) acc_x 96.8750 (91.0417) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1094
clean false:2
clean_rate:0.9981751824817519
noisy true:337
noisy false:199
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [142/200] batch [5/34] time 0.349 (0.357) data 0.272 (0.280) loss_x loss_x 0.2661 (0.2956) acc_x 93.7500 (92.5000) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [10/34] time 0.339 (0.353) data 0.262 (0.276) loss_x loss_x 0.2031 (0.3151) acc_x 93.7500 (92.8125) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [15/34] time 0.359 (0.352) data 0.281 (0.274) loss_x loss_x 0.3386 (0.3476) acc_x 93.7500 (92.5000) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [20/34] time 0.343 (0.350) data 0.266 (0.273) loss_x loss_x 0.5415 (0.3641) acc_x 87.5000 (91.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [25/34] time 0.359 (0.348) data 0.281 (0.271) loss_x loss_x 0.3066 (0.3672) acc_x 96.8750 (92.0000) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [30/34] time 0.337 (0.346) data 0.260 (0.269) loss_x loss_x 0.3115 (0.3660) acc_x 96.8750 (92.0833) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.6581, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1074
clean true:1072
clean false:2
clean_rate:0.9981378026070763
noisy true:341
noisy false:217
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 558
epoch [143/200] batch [5/33] time 0.352 (0.353) data 0.274 (0.275) loss_x loss_x 0.3555 (0.3073) acc_x 93.7500 (94.3750) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [10/33] time 0.324 (0.345) data 0.245 (0.267) loss_x loss_x 0.5332 (0.3229) acc_x 84.3750 (93.4375) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [15/33] time 0.360 (0.347) data 0.282 (0.269) loss_x loss_x 0.5518 (0.3371) acc_x 87.5000 (92.9167) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [20/33] time 0.335 (0.346) data 0.257 (0.269) loss_x loss_x 0.3726 (0.3323) acc_x 93.7500 (92.9688) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [25/33] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.2244 (0.3228) acc_x 96.8750 (93.0000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [30/33] time 0.339 (0.346) data 0.262 (0.269) loss_x loss_x 0.5244 (0.3257) acc_x 93.7500 (93.0208) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6642, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1084
clean true:1081
clean false:3
clean_rate:0.9972324723247232
noisy true:342
noisy false:206
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 548
epoch [144/200] batch [5/33] time 0.346 (0.350) data 0.269 (0.272) loss_x loss_x 0.5835 (0.4591) acc_x 81.2500 (89.3750) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [10/33] time 0.359 (0.350) data 0.281 (0.272) loss_x loss_x 0.4019 (0.4473) acc_x 93.7500 (89.3750) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [15/33] time 0.327 (0.347) data 0.249 (0.269) loss_x loss_x 0.3635 (0.3918) acc_x 87.5000 (90.8333) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [20/33] time 0.363 (0.348) data 0.286 (0.271) loss_x loss_x 0.4929 (0.3820) acc_x 87.5000 (91.0938) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [25/33] time 0.347 (0.348) data 0.269 (0.270) loss_x loss_x 0.3606 (0.3665) acc_x 96.8750 (91.3750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [30/33] time 0.356 (0.348) data 0.278 (0.271) loss_x loss_x 0.1925 (0.3503) acc_x 96.8750 (91.8750) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:331
noisy false:200
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [145/200] batch [5/34] time 0.345 (0.352) data 0.268 (0.274) loss_x loss_x 0.3276 (0.2714) acc_x 90.6250 (95.0000) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [10/34] time 0.348 (0.351) data 0.271 (0.273) loss_x loss_x 0.4062 (0.3259) acc_x 90.6250 (93.4375) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [15/34] time 0.341 (0.348) data 0.264 (0.270) loss_x loss_x 0.4397 (0.3497) acc_x 90.6250 (92.5000) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [20/34] time 0.300 (0.339) data 0.222 (0.261) loss_x loss_x 0.4971 (0.3546) acc_x 84.3750 (92.0312) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [25/34] time 0.343 (0.337) data 0.265 (0.260) loss_x loss_x 0.4219 (0.3465) acc_x 87.5000 (91.8750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [30/34] time 0.330 (0.337) data 0.253 (0.259) loss_x loss_x 0.3157 (0.3530) acc_x 90.6250 (91.4583) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1100
clean false:3
clean_rate:0.9972801450589301
noisy true:342
noisy false:187
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [146/200] batch [5/34] time 0.342 (0.349) data 0.264 (0.272) loss_x loss_x 0.4202 (0.3180) acc_x 87.5000 (90.6250) lr 3.6258e-04 eta 0:00:10
epoch [146/200] batch [10/34] time 0.344 (0.347) data 0.266 (0.270) loss_x loss_x 0.2791 (0.3637) acc_x 90.6250 (91.5625) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [15/34] time 0.328 (0.339) data 0.251 (0.262) loss_x loss_x 0.3713 (0.3467) acc_x 90.6250 (92.5000) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [20/34] time 0.339 (0.341) data 0.261 (0.264) loss_x loss_x 0.4897 (0.3499) acc_x 87.5000 (92.0312) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [25/34] time 0.341 (0.342) data 0.264 (0.265) loss_x loss_x 0.4233 (0.3531) acc_x 87.5000 (91.8750) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [30/34] time 0.346 (0.343) data 0.269 (0.265) loss_x loss_x 0.3320 (0.3513) acc_x 93.7500 (92.0833) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1099
clean false:2
clean_rate:0.9981834695731153
noisy true:341
noisy false:190
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [147/200] batch [5/34] time 0.340 (0.348) data 0.262 (0.271) loss_x loss_x 0.3010 (0.2443) acc_x 93.7500 (95.6250) lr 3.5055e-04 eta 0:00:10
epoch [147/200] batch [10/34] time 0.349 (0.345) data 0.271 (0.268) loss_x loss_x 0.3843 (0.2806) acc_x 87.5000 (94.3750) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [15/34] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.4817 (0.3029) acc_x 93.7500 (94.3750) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [20/34] time 0.337 (0.344) data 0.259 (0.267) loss_x loss_x 0.4048 (0.3223) acc_x 90.6250 (93.5938) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [25/34] time 0.343 (0.344) data 0.266 (0.266) loss_x loss_x 0.2593 (0.3383) acc_x 96.8750 (93.5000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [30/34] time 0.331 (0.344) data 0.253 (0.266) loss_x loss_x 0.6582 (0.3437) acc_x 84.3750 (93.4375) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1100
clean false:2
clean_rate:0.9981851179673321
noisy true:332
noisy false:198
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [148/200] batch [5/34] time 0.302 (0.329) data 0.224 (0.251) loss_x loss_x 0.2812 (0.2291) acc_x 96.8750 (96.8750) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [10/34] time 0.349 (0.332) data 0.271 (0.254) loss_x loss_x 0.4187 (0.3027) acc_x 93.7500 (94.3750) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [15/34] time 0.354 (0.334) data 0.276 (0.257) loss_x loss_x 0.3591 (0.3093) acc_x 93.7500 (93.9583) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [20/34] time 0.291 (0.332) data 0.213 (0.254) loss_x loss_x 0.6191 (0.3153) acc_x 87.5000 (93.7500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [25/34] time 0.316 (0.326) data 0.239 (0.248) loss_x loss_x 0.4338 (0.3290) acc_x 93.7500 (93.5000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [30/34] time 0.349 (0.328) data 0.271 (0.251) loss_x loss_x 0.2893 (0.3324) acc_x 93.7500 (93.2292) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.6685, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1091
clean true:1088
clean false:3
clean_rate:0.997250229147571
noisy true:327
noisy false:214
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 541
epoch [149/200] batch [5/34] time 0.305 (0.309) data 0.227 (0.231) loss_x loss_x 0.2139 (0.2944) acc_x 96.8750 (91.8750) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [10/34] time 0.324 (0.323) data 0.246 (0.245) loss_x loss_x 0.2979 (0.3268) acc_x 90.6250 (92.5000) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [15/34] time 0.350 (0.330) data 0.273 (0.252) loss_x loss_x 0.1034 (0.3511) acc_x 100.0000 (91.6667) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [20/34] time 0.341 (0.330) data 0.264 (0.252) loss_x loss_x 0.4456 (0.3433) acc_x 90.6250 (91.4062) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [25/34] time 0.348 (0.333) data 0.270 (0.256) loss_x loss_x 0.4016 (0.3511) acc_x 93.7500 (91.2500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [30/34] time 0.350 (0.336) data 0.272 (0.258) loss_x loss_x 0.2588 (0.3502) acc_x 93.7500 (91.4583) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1106
clean false:3
clean_rate:0.9972948602344455
noisy true:333
noisy false:190
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [150/200] batch [5/34] time 0.346 (0.346) data 0.268 (0.269) loss_x loss_x 0.3162 (0.2407) acc_x 96.8750 (96.8750) lr 3.1545e-04 eta 0:00:10
epoch [150/200] batch [10/34] time 0.333 (0.345) data 0.256 (0.268) loss_x loss_x 0.3774 (0.3403) acc_x 90.6250 (93.4375) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [15/34] time 0.349 (0.344) data 0.272 (0.266) loss_x loss_x 0.2448 (0.3557) acc_x 90.6250 (92.7083) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [20/34] time 0.331 (0.345) data 0.253 (0.267) loss_x loss_x 0.1781 (0.3364) acc_x 96.8750 (93.4375) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [25/34] time 0.377 (0.351) data 0.297 (0.273) loss_x loss_x 0.4011 (0.3288) acc_x 87.5000 (93.2500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [30/34] time 0.316 (0.352) data 0.237 (0.274) loss_x loss_x 0.2275 (0.3249) acc_x 100.0000 (93.5417) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1105
clean false:3
clean_rate:0.9972924187725631
noisy true:339
noisy false:185
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [151/200] batch [5/34] time 0.349 (0.344) data 0.272 (0.267) loss_x loss_x 0.3274 (0.2897) acc_x 90.6250 (92.5000) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [10/34] time 0.347 (0.344) data 0.270 (0.266) loss_x loss_x 0.4045 (0.3224) acc_x 90.6250 (93.7500) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [15/34] time 0.346 (0.344) data 0.269 (0.267) loss_x loss_x 0.4067 (0.3258) acc_x 84.3750 (92.7083) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [20/34] time 0.354 (0.345) data 0.276 (0.268) loss_x loss_x 0.2115 (0.3397) acc_x 96.8750 (92.1875) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [25/34] time 0.349 (0.345) data 0.272 (0.268) loss_x loss_x 0.3362 (0.3287) acc_x 93.7500 (92.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [30/34] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.5259 (0.3500) acc_x 87.5000 (91.8750) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1093
clean false:2
clean_rate:0.9981735159817352
noisy true:344
noisy false:193
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [152/200] batch [5/34] time 0.302 (0.309) data 0.225 (0.232) loss_x loss_x 0.2761 (0.4217) acc_x 93.7500 (88.7500) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [10/34] time 0.333 (0.322) data 0.255 (0.244) loss_x loss_x 0.4639 (0.3709) acc_x 93.7500 (90.6250) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/34] time 0.323 (0.327) data 0.246 (0.249) loss_x loss_x 0.2241 (0.3245) acc_x 96.8750 (92.5000) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [20/34] time 0.322 (0.326) data 0.244 (0.248) loss_x loss_x 0.2078 (0.3222) acc_x 96.8750 (92.3438) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [25/34] time 0.288 (0.320) data 0.211 (0.242) loss_x loss_x 0.4172 (0.3241) acc_x 87.5000 (92.2500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [30/34] time 0.288 (0.316) data 0.211 (0.238) loss_x loss_x 0.1787 (0.3220) acc_x 96.8750 (92.7083) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.6642, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1084
clean true:1081
clean false:3
clean_rate:0.9972324723247232
noisy true:340
noisy false:208
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 548
epoch [153/200] batch [5/33] time 0.303 (0.316) data 0.225 (0.238) loss_x loss_x 0.3032 (0.2664) acc_x 90.6250 (95.0000) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [10/33] time 0.301 (0.310) data 0.223 (0.232) loss_x loss_x 0.2290 (0.3625) acc_x 90.6250 (91.5625) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [15/33] time 0.328 (0.307) data 0.251 (0.230) loss_x loss_x 0.3508 (0.3263) acc_x 93.7500 (92.7083) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [20/33] time 0.292 (0.312) data 0.214 (0.234) loss_x loss_x 0.4255 (0.3192) acc_x 87.5000 (92.5000) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [25/33] time 0.299 (0.310) data 0.221 (0.232) loss_x loss_x 0.2399 (0.3395) acc_x 96.8750 (91.8750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [30/33] time 0.300 (0.309) data 0.222 (0.231) loss_x loss_x 0.1500 (0.3204) acc_x 96.8750 (91.9792) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1077
clean false:2
clean_rate:0.9981464318813716
noisy true:336
noisy false:217
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [154/200] batch [5/33] time 0.297 (0.305) data 0.219 (0.227) loss_x loss_x 0.2581 (0.3484) acc_x 87.5000 (90.0000) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [10/33] time 0.298 (0.303) data 0.221 (0.225) loss_x loss_x 0.4822 (0.3280) acc_x 90.6250 (91.5625) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [15/33] time 0.279 (0.299) data 0.201 (0.222) loss_x loss_x 0.5391 (0.3221) acc_x 84.3750 (92.2917) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [20/33] time 0.300 (0.299) data 0.222 (0.221) loss_x loss_x 0.3140 (0.3078) acc_x 90.6250 (92.8125) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [25/33] time 0.293 (0.298) data 0.216 (0.220) loss_x loss_x 0.2559 (0.2987) acc_x 100.0000 (93.6250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [30/33] time 0.295 (0.297) data 0.217 (0.219) loss_x loss_x 0.2084 (0.3058) acc_x 100.0000 (93.5417) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1102
clean false:1
clean_rate:0.99909338168631
noisy true:334
noisy false:195
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [155/200] batch [5/34] time 0.298 (0.292) data 0.220 (0.214) loss_x loss_x 0.3381 (0.3895) acc_x 90.6250 (90.6250) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [10/34] time 0.331 (0.298) data 0.253 (0.220) loss_x loss_x 0.6123 (0.3695) acc_x 87.5000 (91.8750) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [15/34] time 0.298 (0.299) data 0.220 (0.222) loss_x loss_x 0.4382 (0.3562) acc_x 93.7500 (92.0833) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [20/34] time 0.292 (0.298) data 0.214 (0.220) loss_x loss_x 0.3154 (0.3450) acc_x 90.6250 (92.5000) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [25/34] time 0.341 (0.303) data 0.264 (0.225) loss_x loss_x 0.3787 (0.3312) acc_x 96.8750 (92.7500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [30/34] time 0.302 (0.302) data 0.223 (0.224) loss_x loss_x 0.2476 (0.3280) acc_x 96.8750 (92.5000) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 184
confident_label rate tensor(0.6783, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1107
clean true:1104
clean false:3
clean_rate:0.997289972899729
noisy true:344
noisy false:181
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 525
epoch [156/200] batch [5/34] time 0.287 (0.332) data 0.210 (0.254) loss_x loss_x 0.3105 (0.3644) acc_x 93.7500 (93.7500) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [10/34] time 0.288 (0.320) data 0.210 (0.242) loss_x loss_x 0.3403 (0.3530) acc_x 90.6250 (93.4375) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [15/34] time 0.300 (0.312) data 0.223 (0.234) loss_x loss_x 0.3921 (0.3424) acc_x 93.7500 (94.1667) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [20/34] time 0.311 (0.310) data 0.234 (0.232) loss_x loss_x 0.2062 (0.3290) acc_x 96.8750 (94.0625) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [25/34] time 0.335 (0.317) data 0.257 (0.239) loss_x loss_x 0.2742 (0.3273) acc_x 93.7500 (93.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [30/34] time 0.299 (0.314) data 0.222 (0.236) loss_x loss_x 0.3562 (0.3196) acc_x 90.6250 (93.4375) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1089
clean false:1
clean_rate:0.9990825688073395
noisy true:353
noisy false:189
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [157/200] batch [5/34] time 0.293 (0.294) data 0.215 (0.216) loss_x loss_x 0.3381 (0.4280) acc_x 87.5000 (86.8750) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [10/34] time 0.296 (0.293) data 0.218 (0.215) loss_x loss_x 0.2405 (0.3349) acc_x 93.7500 (90.9375) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/34] time 0.292 (0.294) data 0.214 (0.216) loss_x loss_x 0.2708 (0.3171) acc_x 90.6250 (91.4583) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [20/34] time 0.296 (0.294) data 0.218 (0.216) loss_x loss_x 0.6460 (0.3407) acc_x 90.6250 (91.4062) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [25/34] time 0.347 (0.297) data 0.269 (0.219) loss_x loss_x 0.2683 (0.3409) acc_x 96.8750 (91.8750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [30/34] time 0.294 (0.298) data 0.216 (0.220) loss_x loss_x 0.6909 (0.3457) acc_x 84.3750 (91.6667) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.6654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1086
clean true:1083
clean false:3
clean_rate:0.9972375690607734
noisy true:342
noisy false:204
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 546
epoch [158/200] batch [5/33] time 0.298 (0.298) data 0.220 (0.220) loss_x loss_x 0.4421 (0.3765) acc_x 93.7500 (93.1250) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [10/33] time 0.294 (0.302) data 0.216 (0.224) loss_x loss_x 0.1927 (0.3461) acc_x 100.0000 (93.7500) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [15/33] time 0.299 (0.300) data 0.222 (0.223) loss_x loss_x 0.3066 (0.3273) acc_x 87.5000 (92.7083) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [20/33] time 0.289 (0.299) data 0.211 (0.221) loss_x loss_x 0.3599 (0.3516) acc_x 84.3750 (91.4062) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [25/33] time 0.296 (0.299) data 0.218 (0.221) loss_x loss_x 0.4214 (0.3455) acc_x 93.7500 (92.0000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [30/33] time 0.296 (0.298) data 0.220 (0.221) loss_x loss_x 0.3003 (0.3370) acc_x 93.7500 (92.2917) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1096
clean false:2
clean_rate:0.9981785063752276
noisy true:340
noisy false:194
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [159/200] batch [5/34] time 0.291 (0.292) data 0.213 (0.214) loss_x loss_x 0.3010 (0.3400) acc_x 96.8750 (91.2500) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [10/34] time 0.291 (0.293) data 0.212 (0.216) loss_x loss_x 0.4353 (0.3380) acc_x 84.3750 (91.8750) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [15/34] time 0.313 (0.299) data 0.235 (0.221) loss_x loss_x 0.2449 (0.2933) acc_x 96.8750 (93.5417) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [20/34] time 0.342 (0.309) data 0.265 (0.231) loss_x loss_x 0.2644 (0.2878) acc_x 93.7500 (94.0625) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [25/34] time 0.330 (0.314) data 0.253 (0.237) loss_x loss_x 0.2162 (0.2851) acc_x 96.8750 (94.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [30/34] time 0.289 (0.313) data 0.212 (0.235) loss_x loss_x 0.2776 (0.2955) acc_x 93.7500 (94.0625) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:354
noisy false:193
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [160/200] batch [5/33] time 0.337 (0.328) data 0.260 (0.251) loss_x loss_x 0.2988 (0.3646) acc_x 93.7500 (91.8750) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [10/33] time 0.293 (0.321) data 0.216 (0.244) loss_x loss_x 0.1613 (0.3239) acc_x 100.0000 (92.8125) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [15/33] time 0.291 (0.311) data 0.213 (0.234) loss_x loss_x 0.2004 (0.3150) acc_x 100.0000 (93.5417) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [20/33] time 0.299 (0.306) data 0.221 (0.229) loss_x loss_x 0.4790 (0.3253) acc_x 90.6250 (93.2812) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [25/33] time 0.285 (0.304) data 0.208 (0.226) loss_x loss_x 0.6641 (0.3294) acc_x 84.3750 (93.0000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [30/33] time 0.292 (0.302) data 0.214 (0.224) loss_x loss_x 0.4258 (0.3465) acc_x 87.5000 (92.3958) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1096
clean false:5
clean_rate:0.9954586739327884
noisy true:337
noisy false:194
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [161/200] batch [5/34] time 0.297 (0.300) data 0.220 (0.222) loss_x loss_x 0.1989 (0.2239) acc_x 93.7500 (95.0000) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [10/34] time 0.296 (0.299) data 0.219 (0.221) loss_x loss_x 0.4526 (0.2714) acc_x 93.7500 (94.6875) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [15/34] time 0.293 (0.296) data 0.216 (0.219) loss_x loss_x 0.2480 (0.3078) acc_x 93.7500 (93.5417) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [20/34] time 0.298 (0.297) data 0.220 (0.219) loss_x loss_x 0.2607 (0.3152) acc_x 96.8750 (92.9688) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [25/34] time 0.292 (0.298) data 0.215 (0.220) loss_x loss_x 0.3145 (0.3135) acc_x 96.8750 (93.0000) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [30/34] time 0.291 (0.297) data 0.214 (0.219) loss_x loss_x 0.3157 (0.3135) acc_x 90.6250 (93.1250) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1116
clean true:1115
clean false:1
clean_rate:0.9991039426523297
noisy true:331
noisy false:185
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 516
epoch [162/200] batch [5/34] time 0.294 (0.293) data 0.217 (0.216) loss_x loss_x 0.3210 (0.3663) acc_x 90.6250 (89.3750) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/34] time 0.289 (0.293) data 0.212 (0.216) loss_x loss_x 0.3286 (0.3559) acc_x 93.7500 (90.6250) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [15/34] time 0.295 (0.294) data 0.217 (0.217) loss_x loss_x 0.3635 (0.3611) acc_x 90.6250 (90.2083) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [20/34] time 0.292 (0.294) data 0.215 (0.217) loss_x loss_x 0.3081 (0.3609) acc_x 90.6250 (90.0000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [25/34] time 0.299 (0.294) data 0.221 (0.217) loss_x loss_x 0.4541 (0.3560) acc_x 90.6250 (90.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [30/34] time 0.305 (0.294) data 0.228 (0.217) loss_x loss_x 0.2502 (0.3583) acc_x 93.7500 (90.4167) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1108
clean false:2
clean_rate:0.9981981981981982
noisy true:348
noisy false:174
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [163/200] batch [5/34] time 0.293 (0.302) data 0.216 (0.225) loss_x loss_x 0.2852 (0.3472) acc_x 96.8750 (92.5000) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [10/34] time 0.298 (0.298) data 0.221 (0.221) loss_x loss_x 0.3535 (0.3691) acc_x 90.6250 (91.2500) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [15/34] time 0.293 (0.298) data 0.216 (0.221) loss_x loss_x 0.6382 (0.3701) acc_x 87.5000 (91.4583) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [20/34] time 0.296 (0.298) data 0.218 (0.221) loss_x loss_x 0.1796 (0.3485) acc_x 96.8750 (92.6562) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [25/34] time 0.300 (0.297) data 0.224 (0.219) loss_x loss_x 0.2012 (0.3543) acc_x 96.8750 (92.3750) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [30/34] time 0.287 (0.297) data 0.210 (0.219) loss_x loss_x 0.4768 (0.3722) acc_x 87.5000 (91.7708) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1077
clean false:3
clean_rate:0.9972222222222222
noisy true:342
noisy false:210
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [164/200] batch [5/33] time 0.302 (0.299) data 0.225 (0.221) loss_x loss_x 0.3142 (0.3773) acc_x 96.8750 (93.7500) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [10/33] time 0.298 (0.295) data 0.220 (0.218) loss_x loss_x 0.4194 (0.3949) acc_x 90.6250 (91.5625) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/33] time 0.295 (0.295) data 0.217 (0.217) loss_x loss_x 0.3464 (0.4192) acc_x 90.6250 (90.0000) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [20/33] time 0.289 (0.295) data 0.211 (0.217) loss_x loss_x 0.5894 (0.3771) acc_x 81.2500 (90.9375) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [25/33] time 0.295 (0.295) data 0.218 (0.217) loss_x loss_x 0.2930 (0.3687) acc_x 93.7500 (91.1250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [30/33] time 0.291 (0.295) data 0.213 (0.217) loss_x loss_x 0.5298 (0.3763) acc_x 87.5000 (91.1458) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.6697, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1093
clean true:1090
clean false:3
clean_rate:0.9972552607502287
noisy true:331
noisy false:208
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 539
epoch [165/200] batch [5/34] time 0.311 (0.300) data 0.234 (0.222) loss_x loss_x 0.1659 (0.2867) acc_x 100.0000 (93.7500) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [10/34] time 0.301 (0.303) data 0.223 (0.225) loss_x loss_x 0.3933 (0.3289) acc_x 93.7500 (93.4375) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [15/34] time 0.296 (0.304) data 0.218 (0.226) loss_x loss_x 0.3564 (0.3099) acc_x 90.6250 (93.5417) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [20/34] time 0.296 (0.303) data 0.219 (0.225) loss_x loss_x 0.2896 (0.3200) acc_x 93.7500 (92.8125) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [25/34] time 0.293 (0.304) data 0.215 (0.226) loss_x loss_x 0.4026 (0.3136) acc_x 90.6250 (93.5000) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [30/34] time 0.288 (0.302) data 0.210 (0.225) loss_x loss_x 0.8198 (0.3274) acc_x 84.3750 (93.3333) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1098
clean false:4
clean_rate:0.9963702359346642
noisy true:353
noisy false:177
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [166/200] batch [5/34] time 0.289 (0.292) data 0.211 (0.214) loss_x loss_x 0.4429 (0.3557) acc_x 90.6250 (95.6250) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [10/34] time 0.292 (0.294) data 0.214 (0.216) loss_x loss_x 0.2393 (0.3137) acc_x 100.0000 (95.0000) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/34] time 0.296 (0.293) data 0.218 (0.215) loss_x loss_x 0.1688 (0.3368) acc_x 96.8750 (93.7500) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [20/34] time 0.295 (0.292) data 0.217 (0.214) loss_x loss_x 0.2783 (0.3445) acc_x 93.7500 (93.2812) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [25/34] time 0.287 (0.293) data 0.209 (0.215) loss_x loss_x 0.2297 (0.3514) acc_x 93.7500 (92.8750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [30/34] time 0.292 (0.293) data 0.214 (0.215) loss_x loss_x 0.3242 (0.3547) acc_x 93.7500 (92.6042) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1096
clean false:4
clean_rate:0.9963636363636363
noisy true:338
noisy false:194
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [167/200] batch [5/34] time 0.296 (0.297) data 0.218 (0.219) loss_x loss_x 0.2452 (0.2870) acc_x 93.7500 (93.7500) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [10/34] time 0.294 (0.298) data 0.217 (0.220) loss_x loss_x 0.2158 (0.3507) acc_x 93.7500 (91.8750) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [15/34] time 0.292 (0.297) data 0.214 (0.219) loss_x loss_x 0.3738 (0.3560) acc_x 93.7500 (91.8750) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [20/34] time 0.293 (0.297) data 0.215 (0.219) loss_x loss_x 0.6265 (0.3651) acc_x 84.3750 (91.4062) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [25/34] time 0.298 (0.297) data 0.220 (0.219) loss_x loss_x 0.4932 (0.3473) acc_x 87.5000 (92.0000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [30/34] time 0.296 (0.297) data 0.219 (0.220) loss_x loss_x 0.3450 (0.3474) acc_x 90.6250 (91.9792) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1108
clean false:2
clean_rate:0.9981981981981982
noisy true:343
noisy false:179
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [168/200] batch [5/34] time 0.298 (0.298) data 0.220 (0.221) loss_x loss_x 0.2993 (0.3836) acc_x 93.7500 (93.1250) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [10/34] time 0.290 (0.294) data 0.213 (0.217) loss_x loss_x 0.3469 (0.3758) acc_x 93.7500 (93.1250) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [15/34] time 0.289 (0.295) data 0.212 (0.217) loss_x loss_x 0.2646 (0.3318) acc_x 96.8750 (93.7500) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [20/34] time 0.292 (0.294) data 0.214 (0.217) loss_x loss_x 0.2661 (0.3334) acc_x 90.6250 (92.6562) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [25/34] time 0.283 (0.294) data 0.205 (0.216) loss_x loss_x 0.7192 (0.3532) acc_x 75.0000 (91.6250) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [30/34] time 0.291 (0.293) data 0.214 (0.216) loss_x loss_x 0.4060 (0.3535) acc_x 90.6250 (91.7708) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 170
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1120
clean true:1117
clean false:3
clean_rate:0.9973214285714286
noisy true:345
noisy false:167
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 512
epoch [169/200] batch [5/35] time 0.303 (0.302) data 0.225 (0.224) loss_x loss_x 0.3623 (0.4254) acc_x 90.6250 (87.5000) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [10/35] time 0.286 (0.300) data 0.208 (0.222) loss_x loss_x 0.2957 (0.3835) acc_x 93.7500 (90.0000) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [15/35] time 0.302 (0.297) data 0.224 (0.219) loss_x loss_x 0.1982 (0.3517) acc_x 96.8750 (91.2500) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [20/35] time 0.302 (0.297) data 0.224 (0.219) loss_x loss_x 0.3547 (0.3354) acc_x 93.7500 (92.1875) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [25/35] time 0.299 (0.296) data 0.221 (0.218) loss_x loss_x 0.3906 (0.3380) acc_x 87.5000 (92.0000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [30/35] time 0.298 (0.295) data 0.220 (0.217) loss_x loss_x 0.2164 (0.3431) acc_x 100.0000 (92.1875) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [35/35] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.2642 (0.3368) acc_x 93.7500 (92.4107) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1087
clean false:2
clean_rate:0.9981634527089073
noisy true:336
noisy false:207
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [170/200] batch [5/34] time 0.301 (0.305) data 0.223 (0.227) loss_x loss_x 0.2864 (0.3093) acc_x 93.7500 (91.8750) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [10/34] time 0.299 (0.303) data 0.221 (0.225) loss_x loss_x 0.0941 (0.3739) acc_x 100.0000 (90.9375) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [15/34] time 0.292 (0.299) data 0.214 (0.221) loss_x loss_x 0.4170 (0.3663) acc_x 87.5000 (91.4583) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [20/34] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.7764 (0.3834) acc_x 84.3750 (91.4062) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [25/34] time 0.299 (0.299) data 0.222 (0.221) loss_x loss_x 0.4229 (0.3534) acc_x 90.6250 (92.2500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [30/34] time 0.297 (0.299) data 0.220 (0.221) loss_x loss_x 0.2233 (0.3435) acc_x 100.0000 (92.2917) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1098
clean false:3
clean_rate:0.997275204359673
noisy true:342
noisy false:189
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [171/200] batch [5/34] time 0.311 (0.304) data 0.233 (0.226) loss_x loss_x 0.2405 (0.2266) acc_x 100.0000 (97.5000) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [10/34] time 0.290 (0.302) data 0.212 (0.224) loss_x loss_x 0.4700 (0.2570) acc_x 87.5000 (95.6250) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [15/34] time 0.301 (0.300) data 0.223 (0.222) loss_x loss_x 0.1365 (0.2967) acc_x 100.0000 (92.9167) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [20/34] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.1681 (0.2965) acc_x 96.8750 (92.9688) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [25/34] time 0.294 (0.298) data 0.216 (0.220) loss_x loss_x 0.1909 (0.3182) acc_x 100.0000 (92.6250) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [30/34] time 0.296 (0.298) data 0.218 (0.220) loss_x loss_x 0.2001 (0.3134) acc_x 100.0000 (92.9167) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1100
clean false:2
clean_rate:0.9981851179673321
noisy true:345
noisy false:185
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [172/200] batch [5/34] time 0.291 (0.294) data 0.214 (0.216) loss_x loss_x 0.2245 (0.2638) acc_x 100.0000 (95.6250) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [10/34] time 0.290 (0.293) data 0.212 (0.215) loss_x loss_x 0.6138 (0.3029) acc_x 84.3750 (94.3750) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [15/34] time 0.287 (0.291) data 0.209 (0.213) loss_x loss_x 0.0549 (0.3083) acc_x 100.0000 (94.3750) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [20/34] time 0.281 (0.291) data 0.203 (0.213) loss_x loss_x 0.6255 (0.3283) acc_x 81.2500 (93.2812) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [25/34] time 0.296 (0.291) data 0.218 (0.213) loss_x loss_x 0.2162 (0.3190) acc_x 96.8750 (93.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [30/34] time 0.300 (0.292) data 0.223 (0.214) loss_x loss_x 0.4492 (0.3435) acc_x 93.7500 (93.3333) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1101
clean false:2
clean_rate:0.9981867633726201
noisy true:341
noisy false:188
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [173/200] batch [5/34] time 0.299 (0.293) data 0.221 (0.215) loss_x loss_x 0.3628 (0.3755) acc_x 87.5000 (89.3750) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [10/34] time 0.295 (0.294) data 0.217 (0.216) loss_x loss_x 0.2578 (0.3335) acc_x 93.7500 (91.5625) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [15/34] time 0.291 (0.294) data 0.212 (0.216) loss_x loss_x 0.3479 (0.3043) acc_x 93.7500 (92.9167) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [20/34] time 0.289 (0.294) data 0.211 (0.216) loss_x loss_x 0.1996 (0.3054) acc_x 100.0000 (92.6562) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [25/34] time 0.287 (0.293) data 0.210 (0.215) loss_x loss_x 0.3652 (0.3189) acc_x 90.6250 (92.6250) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [30/34] time 0.295 (0.293) data 0.217 (0.215) loss_x loss_x 0.2571 (0.3091) acc_x 93.7500 (93.0208) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 163
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1120
clean true:1118
clean false:2
clean_rate:0.9982142857142857
noisy true:351
noisy false:161
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 512
epoch [174/200] batch [5/35] time 0.298 (0.300) data 0.220 (0.221) loss_x loss_x 0.3867 (0.3493) acc_x 87.5000 (91.2500) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [10/35] time 0.295 (0.298) data 0.217 (0.220) loss_x loss_x 0.1501 (0.2879) acc_x 100.0000 (94.0625) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [15/35] time 0.283 (0.297) data 0.206 (0.219) loss_x loss_x 0.3411 (0.3156) acc_x 87.5000 (93.1250) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [20/35] time 0.297 (0.295) data 0.219 (0.217) loss_x loss_x 0.2328 (0.3230) acc_x 96.8750 (92.6562) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [25/35] time 0.284 (0.295) data 0.206 (0.218) loss_x loss_x 0.7417 (0.3414) acc_x 75.0000 (91.8750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [30/35] time 0.291 (0.295) data 0.213 (0.217) loss_x loss_x 0.3621 (0.3338) acc_x 90.6250 (92.0833) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [35/35] time 0.300 (0.295) data 0.222 (0.217) loss_x loss_x 0.3335 (0.3281) acc_x 90.6250 (92.0536) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 210
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1086
clean false:3
clean_rate:0.9972451790633609
noisy true:336
noisy false:207
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [175/200] batch [5/34] time 0.302 (0.296) data 0.224 (0.219) loss_x loss_x 0.3389 (0.3533) acc_x 90.6250 (91.2500) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [10/34] time 0.291 (0.295) data 0.213 (0.217) loss_x loss_x 0.4746 (0.3287) acc_x 87.5000 (91.8750) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [15/34] time 0.302 (0.295) data 0.224 (0.217) loss_x loss_x 0.2986 (0.3583) acc_x 93.7500 (91.4583) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [20/34] time 0.291 (0.294) data 0.213 (0.216) loss_x loss_x 0.2368 (0.3518) acc_x 96.8750 (91.4062) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [25/34] time 0.286 (0.292) data 0.209 (0.215) loss_x loss_x 0.3416 (0.3612) acc_x 93.7500 (91.3750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [30/34] time 0.298 (0.292) data 0.221 (0.215) loss_x loss_x 0.2686 (0.3736) acc_x 90.6250 (90.9375) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1094
clean false:3
clean_rate:0.9972652689152234
noisy true:331
noisy false:204
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [176/200] batch [5/34] time 0.300 (0.303) data 0.222 (0.225) loss_x loss_x 0.2576 (0.3296) acc_x 93.7500 (91.2500) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [10/34] time 0.301 (0.302) data 0.222 (0.224) loss_x loss_x 0.1852 (0.3286) acc_x 96.8750 (92.5000) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [15/34] time 0.299 (0.306) data 0.220 (0.227) loss_x loss_x 0.2190 (0.3224) acc_x 96.8750 (92.5000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [20/34] time 0.316 (0.305) data 0.237 (0.227) loss_x loss_x 0.1165 (0.3115) acc_x 100.0000 (93.1250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [25/34] time 0.302 (0.305) data 0.224 (0.227) loss_x loss_x 0.1550 (0.2960) acc_x 100.0000 (93.7500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [30/34] time 0.307 (0.305) data 0.228 (0.227) loss_x loss_x 0.3291 (0.3025) acc_x 93.7500 (93.6458) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 179
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1101
clean false:3
clean_rate:0.9972826086956522
noisy true:352
noisy false:176
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [177/200] batch [5/34] time 0.301 (0.303) data 0.224 (0.225) loss_x loss_x 0.2598 (0.2288) acc_x 93.7500 (96.2500) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/34] time 0.293 (0.296) data 0.216 (0.218) loss_x loss_x 0.2729 (0.2772) acc_x 93.7500 (93.7500) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [15/34] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.1997 (0.2975) acc_x 93.7500 (92.2917) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [20/34] time 0.291 (0.294) data 0.214 (0.216) loss_x loss_x 0.4204 (0.3361) acc_x 93.7500 (91.5625) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/34] time 0.288 (0.294) data 0.210 (0.216) loss_x loss_x 0.2612 (0.3297) acc_x 93.7500 (92.1250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [30/34] time 0.295 (0.294) data 0.217 (0.216) loss_x loss_x 0.3601 (0.3310) acc_x 90.6250 (91.7708) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1098
clean false:4
clean_rate:0.9963702359346642
noisy true:339
noisy false:191
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [178/200] batch [5/34] time 0.299 (0.308) data 0.221 (0.231) loss_x loss_x 0.3657 (0.2550) acc_x 93.7500 (93.7500) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [10/34] time 0.288 (0.300) data 0.210 (0.222) loss_x loss_x 0.1714 (0.2458) acc_x 100.0000 (95.0000) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [15/34] time 0.291 (0.297) data 0.214 (0.219) loss_x loss_x 0.1429 (0.2501) acc_x 100.0000 (95.2083) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [20/34] time 0.293 (0.296) data 0.216 (0.218) loss_x loss_x 0.2054 (0.2765) acc_x 100.0000 (94.8438) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [25/34] time 0.301 (0.295) data 0.224 (0.218) loss_x loss_x 0.2268 (0.2831) acc_x 96.8750 (94.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [30/34] time 0.293 (0.295) data 0.216 (0.217) loss_x loss_x 0.3999 (0.2985) acc_x 90.6250 (94.1667) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1093
clean false:2
clean_rate:0.9981735159817352
noisy true:351
noisy false:186
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [179/200] batch [5/34] time 0.300 (0.298) data 0.222 (0.220) loss_x loss_x 0.1654 (0.2955) acc_x 100.0000 (94.3750) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [10/34] time 0.293 (0.295) data 0.216 (0.218) loss_x loss_x 0.5005 (0.3501) acc_x 90.6250 (93.4375) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [15/34] time 0.293 (0.295) data 0.216 (0.218) loss_x loss_x 0.3674 (0.3357) acc_x 90.6250 (93.5417) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [20/34] time 0.292 (0.295) data 0.214 (0.217) loss_x loss_x 0.3853 (0.3215) acc_x 90.6250 (93.7500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [25/34] time 0.293 (0.294) data 0.215 (0.217) loss_x loss_x 0.4309 (0.3270) acc_x 87.5000 (93.2500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [30/34] time 0.296 (0.294) data 0.218 (0.216) loss_x loss_x 0.4197 (0.3409) acc_x 93.7500 (92.8125) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1098
clean false:5
clean_rate:0.9954669084315503
noisy true:332
noisy false:197
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [180/200] batch [5/34] time 0.305 (0.302) data 0.227 (0.224) loss_x loss_x 0.2937 (0.3583) acc_x 93.7500 (93.7500) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [10/34] time 0.294 (0.303) data 0.216 (0.225) loss_x loss_x 0.5928 (0.3520) acc_x 84.3750 (92.8125) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [15/34] time 0.308 (0.304) data 0.230 (0.226) loss_x loss_x 0.4375 (0.3580) acc_x 90.6250 (91.8750) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [20/34] time 0.302 (0.304) data 0.224 (0.226) loss_x loss_x 0.3687 (0.3863) acc_x 84.3750 (91.4062) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [25/34] time 0.297 (0.302) data 0.219 (0.224) loss_x loss_x 0.4990 (0.3893) acc_x 87.5000 (91.2500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/34] time 0.293 (0.301) data 0.215 (0.223) loss_x loss_x 0.2421 (0.3773) acc_x 96.8750 (91.4583) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 175
confident_label rate tensor(0.6826, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1114
clean true:1111
clean false:3
clean_rate:0.9973070017953322
noisy true:346
noisy false:172
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 518
epoch [181/200] batch [5/34] time 0.302 (0.295) data 0.225 (0.217) loss_x loss_x 0.2891 (0.3271) acc_x 93.7500 (92.5000) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [10/34] time 0.288 (0.293) data 0.210 (0.215) loss_x loss_x 0.3379 (0.2986) acc_x 90.6250 (92.8125) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [15/34] time 0.295 (0.293) data 0.217 (0.215) loss_x loss_x 0.3127 (0.3180) acc_x 90.6250 (92.7083) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [20/34] time 0.285 (0.293) data 0.207 (0.216) loss_x loss_x 0.4141 (0.3421) acc_x 90.6250 (92.5000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [25/34] time 0.284 (0.293) data 0.206 (0.215) loss_x loss_x 0.5337 (0.3407) acc_x 90.6250 (92.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [30/34] time 0.285 (0.292) data 0.207 (0.214) loss_x loss_x 0.2720 (0.3399) acc_x 93.7500 (92.7083) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1098
clean false:2
clean_rate:0.9981818181818182
noisy true:343
noisy false:189
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [182/200] batch [5/34] time 0.289 (0.294) data 0.212 (0.217) loss_x loss_x 0.4885 (0.3119) acc_x 87.5000 (92.5000) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [10/34] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.3435 (0.3156) acc_x 90.6250 (91.5625) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [15/34] time 0.290 (0.295) data 0.212 (0.217) loss_x loss_x 0.3435 (0.2967) acc_x 93.7500 (92.9167) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [20/34] time 0.289 (0.293) data 0.212 (0.215) loss_x loss_x 0.2279 (0.2955) acc_x 93.7500 (92.9688) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [25/34] time 0.290 (0.293) data 0.213 (0.216) loss_x loss_x 0.3691 (0.3112) acc_x 93.7500 (92.6250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [30/34] time 0.291 (0.294) data 0.213 (0.216) loss_x loss_x 0.3364 (0.2981) acc_x 90.6250 (93.2292) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1095
clean false:3
clean_rate:0.9972677595628415
noisy true:347
noisy false:187
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [183/200] batch [5/34] time 0.298 (0.294) data 0.220 (0.217) loss_x loss_x 0.0696 (0.3001) acc_x 100.0000 (93.7500) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [10/34] time 0.287 (0.294) data 0.211 (0.217) loss_x loss_x 0.2617 (0.3130) acc_x 93.7500 (94.0625) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [15/34] time 0.292 (0.292) data 0.215 (0.215) loss_x loss_x 0.2086 (0.3191) acc_x 96.8750 (93.1250) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [20/34] time 0.290 (0.292) data 0.212 (0.215) loss_x loss_x 0.2747 (0.3068) acc_x 90.6250 (92.9688) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [25/34] time 0.280 (0.292) data 0.202 (0.214) loss_x loss_x 0.3396 (0.3327) acc_x 90.6250 (92.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [30/34] time 0.291 (0.292) data 0.214 (0.215) loss_x loss_x 0.3203 (0.3331) acc_x 87.5000 (91.7708) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1102
clean false:1
clean_rate:0.99909338168631
noisy true:344
noisy false:185
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [184/200] batch [5/34] time 0.291 (0.292) data 0.213 (0.214) loss_x loss_x 0.3240 (0.2888) acc_x 93.7500 (95.6250) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [10/34] time 0.340 (0.298) data 0.262 (0.220) loss_x loss_x 0.2343 (0.3293) acc_x 93.7500 (94.0625) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [15/34] time 0.290 (0.300) data 0.212 (0.222) loss_x loss_x 0.2434 (0.3550) acc_x 93.7500 (92.2917) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [20/34] time 0.294 (0.298) data 0.216 (0.220) loss_x loss_x 0.5254 (0.3444) acc_x 93.7500 (92.9688) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [25/34] time 0.289 (0.297) data 0.211 (0.219) loss_x loss_x 0.2798 (0.3371) acc_x 93.7500 (92.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/34] time 0.289 (0.296) data 0.212 (0.219) loss_x loss_x 0.3486 (0.3374) acc_x 90.6250 (92.6042) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1095
clean false:3
clean_rate:0.9972677595628415
noisy true:348
noisy false:186
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [185/200] batch [5/34] time 0.293 (0.293) data 0.215 (0.215) loss_x loss_x 0.4534 (0.4024) acc_x 90.6250 (90.0000) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [10/34] time 0.301 (0.298) data 0.223 (0.220) loss_x loss_x 0.6328 (0.3922) acc_x 84.3750 (89.3750) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [15/34] time 0.298 (0.298) data 0.221 (0.220) loss_x loss_x 0.2180 (0.3532) acc_x 93.7500 (91.0417) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [20/34] time 0.297 (0.298) data 0.220 (0.220) loss_x loss_x 0.3196 (0.3326) acc_x 93.7500 (92.1875) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [25/34] time 0.303 (0.298) data 0.225 (0.220) loss_x loss_x 0.3220 (0.3226) acc_x 90.6250 (92.3750) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [30/34] time 0.286 (0.297) data 0.209 (0.219) loss_x loss_x 0.4993 (0.3335) acc_x 87.5000 (91.8750) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1095
clean false:3
clean_rate:0.9972677595628415
noisy true:342
noisy false:192
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [186/200] batch [5/34] time 0.287 (0.296) data 0.210 (0.218) loss_x loss_x 0.1996 (0.2297) acc_x 93.7500 (95.6250) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [10/34] time 0.287 (0.291) data 0.210 (0.213) loss_x loss_x 0.4021 (0.2856) acc_x 93.7500 (94.3750) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [15/34] time 0.296 (0.291) data 0.217 (0.214) loss_x loss_x 0.2482 (0.3046) acc_x 100.0000 (93.9583) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [20/34] time 0.291 (0.291) data 0.213 (0.214) loss_x loss_x 0.1211 (0.2947) acc_x 100.0000 (94.3750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [25/34] time 0.291 (0.293) data 0.213 (0.215) loss_x loss_x 0.3562 (0.2976) acc_x 90.6250 (94.1250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [30/34] time 0.295 (0.293) data 0.217 (0.215) loss_x loss_x 0.4727 (0.3114) acc_x 93.7500 (93.9583) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1102
clean false:2
clean_rate:0.9981884057971014
noisy true:345
noisy false:183
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [187/200] batch [5/34] time 0.296 (0.294) data 0.218 (0.217) loss_x loss_x 0.3108 (0.3805) acc_x 93.7500 (91.8750) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [10/34] time 0.295 (0.294) data 0.217 (0.216) loss_x loss_x 0.4417 (0.3449) acc_x 84.3750 (91.8750) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [15/34] time 0.300 (0.294) data 0.222 (0.216) loss_x loss_x 0.2244 (0.3280) acc_x 100.0000 (92.7083) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [20/34] time 0.296 (0.294) data 0.218 (0.217) loss_x loss_x 0.4690 (0.3398) acc_x 90.6250 (92.6562) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [25/34] time 0.294 (0.294) data 0.216 (0.216) loss_x loss_x 0.1980 (0.3486) acc_x 96.8750 (92.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [30/34] time 0.302 (0.295) data 0.225 (0.217) loss_x loss_x 0.2585 (0.3421) acc_x 93.7500 (92.5000) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1102
clean false:3
clean_rate:0.9972850678733032
noisy true:343
noisy false:184
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [188/200] batch [5/34] time 0.307 (0.324) data 0.229 (0.245) loss_x loss_x 0.2766 (0.2425) acc_x 93.7500 (95.6250) lr 2.4083e-05 eta 0:00:09
epoch [188/200] batch [10/34] time 0.301 (0.314) data 0.223 (0.235) loss_x loss_x 0.1990 (0.2667) acc_x 93.7500 (95.6250) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [15/34] time 0.295 (0.311) data 0.216 (0.232) loss_x loss_x 0.1438 (0.2841) acc_x 100.0000 (95.2083) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [20/34] time 0.290 (0.307) data 0.212 (0.228) loss_x loss_x 0.4758 (0.2808) acc_x 90.6250 (95.0000) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [25/34] time 0.300 (0.306) data 0.222 (0.227) loss_x loss_x 0.1310 (0.2714) acc_x 100.0000 (95.3750) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [30/34] time 0.300 (0.304) data 0.222 (0.226) loss_x loss_x 0.5103 (0.2808) acc_x 84.3750 (94.6875) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1096
clean false:4
clean_rate:0.9963636363636363
noisy true:344
noisy false:188
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [189/200] batch [5/34] time 0.303 (0.316) data 0.224 (0.237) loss_x loss_x 0.3259 (0.3993) acc_x 93.7500 (90.6250) lr 2.0777e-05 eta 0:00:09
epoch [189/200] batch [10/34] time 0.301 (0.309) data 0.223 (0.230) loss_x loss_x 0.2617 (0.3583) acc_x 96.8750 (92.5000) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [15/34] time 0.302 (0.306) data 0.224 (0.228) loss_x loss_x 0.2683 (0.3205) acc_x 93.7500 (93.5417) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [20/34] time 0.291 (0.303) data 0.212 (0.225) loss_x loss_x 0.5103 (0.3804) acc_x 84.3750 (91.0938) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [25/34] time 0.295 (0.303) data 0.217 (0.224) loss_x loss_x 0.3772 (0.3603) acc_x 90.6250 (91.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [30/34] time 0.293 (0.302) data 0.215 (0.223) loss_x loss_x 0.6147 (0.3638) acc_x 81.2500 (91.7708) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1106
clean false:3
clean_rate:0.9972948602344455
noisy true:343
noisy false:180
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [190/200] batch [5/34] time 0.301 (0.316) data 0.223 (0.237) loss_x loss_x 0.1862 (0.2826) acc_x 96.8750 (93.7500) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [10/34] time 0.307 (0.308) data 0.228 (0.230) loss_x loss_x 0.1838 (0.2927) acc_x 96.8750 (93.4375) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [15/34] time 0.305 (0.306) data 0.227 (0.227) loss_x loss_x 0.1879 (0.2895) acc_x 96.8750 (93.7500) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [20/34] time 0.296 (0.305) data 0.218 (0.226) loss_x loss_x 0.3318 (0.2880) acc_x 96.8750 (93.7500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [25/34] time 0.298 (0.305) data 0.219 (0.226) loss_x loss_x 0.2627 (0.2771) acc_x 96.8750 (94.2500) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [30/34] time 0.294 (0.304) data 0.216 (0.226) loss_x loss_x 0.4111 (0.2776) acc_x 93.7500 (94.2708) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1107
clean false:3
clean_rate:0.9972972972972973
noisy true:344
noisy false:178
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [191/200] batch [5/34] time 0.288 (0.293) data 0.210 (0.215) loss_x loss_x 0.3518 (0.2975) acc_x 93.7500 (93.7500) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [10/34] time 0.303 (0.295) data 0.225 (0.216) loss_x loss_x 0.1554 (0.3252) acc_x 93.7500 (92.8125) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [15/34] time 0.300 (0.295) data 0.222 (0.216) loss_x loss_x 0.2695 (0.3163) acc_x 93.7500 (92.5000) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [20/34] time 0.304 (0.296) data 0.225 (0.218) loss_x loss_x 0.3884 (0.3046) acc_x 87.5000 (92.6562) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [25/34] time 0.300 (0.297) data 0.222 (0.219) loss_x loss_x 0.4683 (0.3121) acc_x 84.3750 (92.3750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [30/34] time 0.300 (0.297) data 0.222 (0.219) loss_x loss_x 0.4814 (0.3219) acc_x 90.6250 (92.1875) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1099
clean false:3
clean_rate:0.9972776769509982
noisy true:342
noisy false:188
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [192/200] batch [5/34] time 0.303 (0.306) data 0.225 (0.227) loss_x loss_x 0.3787 (0.4203) acc_x 90.6250 (91.2500) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [10/34] time 0.305 (0.302) data 0.226 (0.223) loss_x loss_x 0.3757 (0.4110) acc_x 84.3750 (90.0000) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [15/34] time 0.305 (0.301) data 0.227 (0.223) loss_x loss_x 0.2893 (0.3795) acc_x 93.7500 (90.6250) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [20/34] time 0.302 (0.300) data 0.224 (0.222) loss_x loss_x 0.0953 (0.3345) acc_x 100.0000 (92.0312) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [25/34] time 0.304 (0.300) data 0.225 (0.222) loss_x loss_x 0.1737 (0.3114) acc_x 96.8750 (93.0000) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [30/34] time 0.295 (0.299) data 0.217 (0.221) loss_x loss_x 0.5479 (0.3124) acc_x 87.5000 (93.1250) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1095
clean false:4
clean_rate:0.9963603275705186
noisy true:347
noisy false:186
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [193/200] batch [5/34] time 0.309 (0.306) data 0.231 (0.227) loss_x loss_x 0.3291 (0.4324) acc_x 93.7500 (88.7500) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [10/34] time 0.305 (0.304) data 0.227 (0.225) loss_x loss_x 0.1553 (0.3630) acc_x 96.8750 (90.9375) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [15/34] time 0.294 (0.304) data 0.217 (0.226) loss_x loss_x 0.2317 (0.3334) acc_x 96.8750 (91.8750) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [20/34] time 0.302 (0.303) data 0.223 (0.225) loss_x loss_x 0.2374 (0.3208) acc_x 96.8750 (92.6562) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [25/34] time 0.305 (0.301) data 0.226 (0.223) loss_x loss_x 0.4368 (0.3188) acc_x 90.6250 (92.7500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/34] time 0.302 (0.301) data 0.224 (0.222) loss_x loss_x 0.3362 (0.3115) acc_x 90.6250 (92.8125) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1103
clean false:2
clean_rate:0.9981900452488688
noisy true:342
noisy false:185
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [194/200] batch [5/34] time 0.295 (0.301) data 0.217 (0.223) loss_x loss_x 0.1925 (0.1735) acc_x 96.8750 (98.1250) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [10/34] time 0.297 (0.298) data 0.219 (0.220) loss_x loss_x 0.3965 (0.2511) acc_x 93.7500 (95.6250) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [15/34] time 0.309 (0.299) data 0.231 (0.221) loss_x loss_x 0.1555 (0.2486) acc_x 96.8750 (95.6250) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [20/34] time 0.307 (0.302) data 0.230 (0.224) loss_x loss_x 0.7202 (0.2984) acc_x 84.3750 (93.5938) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [25/34] time 0.301 (0.303) data 0.223 (0.225) loss_x loss_x 0.2573 (0.2896) acc_x 96.8750 (94.0000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/34] time 0.291 (0.301) data 0.213 (0.224) loss_x loss_x 0.2913 (0.2932) acc_x 93.7500 (93.8542) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 171
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1115
clean false:4
clean_rate:0.9964253798033958
noisy true:346
noisy false:167
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [195/200] batch [5/34] time 0.299 (0.298) data 0.221 (0.221) loss_x loss_x 0.2812 (0.2941) acc_x 90.6250 (91.2500) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/34] time 0.294 (0.297) data 0.217 (0.219) loss_x loss_x 0.2224 (0.3333) acc_x 96.8750 (90.9375) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [15/34] time 0.286 (0.297) data 0.207 (0.219) loss_x loss_x 0.3740 (0.3821) acc_x 93.7500 (90.0000) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [20/34] time 0.303 (0.297) data 0.224 (0.219) loss_x loss_x 0.1656 (0.3670) acc_x 96.8750 (90.9375) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [25/34] time 0.296 (0.297) data 0.218 (0.219) loss_x loss_x 0.4031 (0.3724) acc_x 90.6250 (91.2500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [30/34] time 0.295 (0.296) data 0.218 (0.219) loss_x loss_x 0.2878 (0.3716) acc_x 93.7500 (91.5625) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 197
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1091
clean false:1
clean_rate:0.9990842490842491
noisy true:344
noisy false:196
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [196/200] batch [5/34] time 0.294 (0.298) data 0.216 (0.219) loss_x loss_x 0.1925 (0.3346) acc_x 100.0000 (91.2500) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [10/34] time 0.297 (0.297) data 0.219 (0.219) loss_x loss_x 0.3486 (0.3311) acc_x 96.8750 (91.8750) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [15/34] time 0.303 (0.296) data 0.225 (0.218) loss_x loss_x 0.1824 (0.3406) acc_x 93.7500 (91.6667) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [20/34] time 0.295 (0.298) data 0.217 (0.220) loss_x loss_x 0.2203 (0.3171) acc_x 96.8750 (92.6562) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [25/34] time 0.290 (0.299) data 0.212 (0.221) loss_x loss_x 0.2397 (0.2962) acc_x 90.6250 (92.6250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [30/34] time 0.293 (0.298) data 0.215 (0.220) loss_x loss_x 0.3582 (0.2870) acc_x 93.7500 (92.9167) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1101
clean false:4
clean_rate:0.9963800904977376
noisy true:346
noisy false:181
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [197/200] batch [5/34] time 0.294 (0.294) data 0.216 (0.217) loss_x loss_x 0.3772 (0.4610) acc_x 93.7500 (90.0000) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [10/34] time 0.296 (0.296) data 0.218 (0.218) loss_x loss_x 0.4041 (0.3873) acc_x 90.6250 (91.5625) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [15/34] time 0.315 (0.298) data 0.237 (0.220) loss_x loss_x 0.1865 (0.3486) acc_x 96.8750 (92.7083) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [20/34] time 0.309 (0.300) data 0.231 (0.222) loss_x loss_x 0.2588 (0.3416) acc_x 93.7500 (92.1875) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [25/34] time 0.294 (0.300) data 0.215 (0.222) loss_x loss_x 0.2932 (0.3177) acc_x 90.6250 (92.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [30/34] time 0.298 (0.301) data 0.221 (0.223) loss_x loss_x 0.4878 (0.3152) acc_x 87.5000 (92.5000) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1101
clean false:1
clean_rate:0.9990925589836661
noisy true:337
noisy false:193
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [198/200] batch [5/34] time 0.290 (0.300) data 0.211 (0.221) loss_x loss_x 0.3459 (0.2483) acc_x 90.6250 (94.3750) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [10/34] time 0.301 (0.298) data 0.223 (0.219) loss_x loss_x 0.4075 (0.2585) acc_x 90.6250 (94.6875) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [15/34] time 0.296 (0.297) data 0.217 (0.218) loss_x loss_x 0.2517 (0.2681) acc_x 90.6250 (93.9583) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [20/34] time 0.301 (0.297) data 0.223 (0.218) loss_x loss_x 0.4883 (0.2836) acc_x 90.6250 (94.0625) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [25/34] time 0.302 (0.297) data 0.224 (0.218) loss_x loss_x 0.1495 (0.2849) acc_x 96.8750 (94.1250) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [30/34] time 0.290 (0.297) data 0.212 (0.218) loss_x loss_x 0.1493 (0.2937) acc_x 100.0000 (94.0625) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1096
clean false:2
clean_rate:0.9981785063752276
noisy true:335
noisy false:199
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [199/200] batch [5/34] time 0.303 (0.305) data 0.224 (0.227) loss_x loss_x 0.1639 (0.2481) acc_x 96.8750 (96.2500) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [10/34] time 0.288 (0.301) data 0.210 (0.223) loss_x loss_x 0.4133 (0.2581) acc_x 90.6250 (95.9375) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [15/34] time 0.296 (0.300) data 0.218 (0.222) loss_x loss_x 0.3552 (0.3059) acc_x 90.6250 (94.5833) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [20/34] time 0.293 (0.298) data 0.215 (0.220) loss_x loss_x 0.3022 (0.3061) acc_x 93.7500 (94.2188) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [25/34] time 0.300 (0.298) data 0.222 (0.220) loss_x loss_x 0.3062 (0.2902) acc_x 93.7500 (94.3750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [30/34] time 0.291 (0.297) data 0.213 (0.219) loss_x loss_x 0.2615 (0.2930) acc_x 96.8750 (94.3750) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1101
clean false:3
clean_rate:0.9972826086956522
noisy true:350
noisy false:178
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [200/200] batch [5/34] time 0.297 (0.303) data 0.218 (0.224) loss_x loss_x 0.4629 (0.3541) acc_x 90.6250 (91.8750) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [10/34] time 0.294 (0.300) data 0.215 (0.221) loss_x loss_x 0.4634 (0.3919) acc_x 84.3750 (90.3125) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [15/34] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.3335 (0.3980) acc_x 90.6250 (90.2083) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [20/34] time 0.287 (0.298) data 0.209 (0.220) loss_x loss_x 0.2776 (0.4000) acc_x 93.7500 (90.6250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [25/34] time 0.293 (0.298) data 0.214 (0.220) loss_x loss_x 0.3225 (0.3805) acc_x 96.8750 (91.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [30/34] time 0.298 (0.298) data 0.220 (0.219) loss_x loss_x 0.1978 (0.3686) acc_x 96.8750 (91.0417) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,234
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 90.5%
Elapsed: 1:36:18
