***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1440, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 235
clean true:231
clean false:4
clean_rate:0.9829787234042553
noisy true:144
noisy false:1253
after delete: len(clean_dataset) 235
after delete: len(noisy_dataset) 1397
epoch [1/200] batch [5/7] time 0.343 (0.360) data 0.264 (0.264) loss_x loss_x 2.5273 (2.7555) acc_x 37.5000 (30.6250) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1167
confident_label rate tensor(0.1740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 284
clean true:282
clean false:2
clean_rate:0.9929577464788732
noisy true:183
noisy false:1165
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 1348
epoch [2/200] batch [5/8] time 0.352 (0.359) data 0.273 (0.281) loss_x loss_x 1.0459 (1.1905) acc_x 81.2500 (73.7500) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 765
confident_label rate tensor(0.3388, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 553
clean true:549
clean false:4
clean_rate:0.9927667269439421
noisy true:318
noisy false:761
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1079
epoch [3/200] batch [5/17] time 0.347 (0.355) data 0.269 (0.276) loss_x loss_x 0.7837 (0.8912) acc_x 90.6250 (80.6250) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/17] time 0.294 (0.330) data 0.211 (0.251) loss_x loss_x 0.7866 (0.8549) acc_x 78.1250 (79.0625) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/17] time 0.354 (0.327) data 0.275 (0.248) loss_x loss_x 0.6792 (0.8555) acc_x 81.2500 (79.1667) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 769
confident_label rate tensor(0.3352, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 547
clean true:544
clean false:3
clean_rate:0.9945155393053017
noisy true:319
noisy false:766
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1085
epoch [4/200] batch [5/17] time 0.347 (0.349) data 0.269 (0.271) loss_x loss_x 0.3716 (0.6993) acc_x 96.8750 (81.2500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/17] time 0.318 (0.339) data 0.239 (0.261) loss_x loss_x 0.6997 (0.7806) acc_x 84.3750 (80.9375) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/17] time 0.345 (0.342) data 0.268 (0.263) loss_x loss_x 0.8486 (0.7693) acc_x 81.2500 (81.4583) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 728
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:568
clean false:3
clean_rate:0.9947460595446584
noisy true:336
noisy false:725
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [5/200] batch [5/17] time 0.358 (0.339) data 0.279 (0.260) loss_x loss_x 0.8677 (0.8286) acc_x 71.8750 (80.6250) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/17] time 0.363 (0.348) data 0.284 (0.269) loss_x loss_x 0.7207 (0.7265) acc_x 84.3750 (84.0625) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/17] time 0.342 (0.344) data 0.263 (0.266) loss_x loss_x 0.8574 (0.7403) acc_x 81.2500 (82.9167) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 703
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:584
clean false:4
clean_rate:0.9931972789115646
noisy true:345
noisy false:699
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [6/200] batch [5/18] time 0.347 (0.354) data 0.268 (0.276) loss_x loss_x 0.7031 (0.7068) acc_x 75.0000 (80.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/18] time 0.301 (0.345) data 0.223 (0.266) loss_x loss_x 0.6025 (0.6665) acc_x 78.1250 (82.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/18] time 0.364 (0.347) data 0.286 (0.269) loss_x loss_x 1.2031 (0.7828) acc_x 75.0000 (80.8333) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 716
confident_label rate tensor(0.3560, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 581
clean true:576
clean false:5
clean_rate:0.9913941480206541
noisy true:340
noisy false:711
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1051
epoch [7/200] batch [5/18] time 0.329 (0.345) data 0.251 (0.266) loss_x loss_x 1.0996 (0.8980) acc_x 68.7500 (79.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/18] time 0.346 (0.344) data 0.267 (0.265) loss_x loss_x 0.7446 (0.8913) acc_x 78.1250 (80.0000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/18] time 0.336 (0.345) data 0.257 (0.267) loss_x loss_x 0.5449 (0.8443) acc_x 90.6250 (80.4167) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 678
confident_label rate tensor(0.3683, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 601
clean true:595
clean false:6
clean_rate:0.9900166389351082
noisy true:359
noisy false:672
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1031
epoch [8/200] batch [5/18] time 0.356 (0.333) data 0.278 (0.253) loss_x loss_x 0.6445 (0.6984) acc_x 78.1250 (80.6250) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/18] time 0.350 (0.341) data 0.272 (0.262) loss_x loss_x 0.7207 (0.6912) acc_x 84.3750 (82.5000) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/18] time 0.338 (0.342) data 0.260 (0.262) loss_x loss_x 0.8848 (0.7160) acc_x 81.2500 (81.2500) lr 1.9956e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 671
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 608
clean true:604
clean false:4
clean_rate:0.993421052631579
noisy true:357
noisy false:667
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1024
epoch [9/200] batch [5/19] time 0.355 (0.347) data 0.275 (0.268) loss_x loss_x 0.4336 (0.7504) acc_x 93.7500 (84.3750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/19] time 0.346 (0.349) data 0.266 (0.269) loss_x loss_x 0.6836 (0.7026) acc_x 78.1250 (82.8125) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/19] time 0.330 (0.345) data 0.252 (0.266) loss_x loss_x 0.8213 (0.7654) acc_x 78.1250 (80.4167) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 689
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 605
clean true:601
clean false:4
clean_rate:0.9933884297520661
noisy true:342
noisy false:685
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1027
epoch [10/200] batch [5/18] time 0.370 (0.357) data 0.293 (0.278) loss_x loss_x 0.7451 (0.6743) acc_x 87.5000 (86.2500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/18] time 0.342 (0.351) data 0.263 (0.273) loss_x loss_x 1.1543 (0.7766) acc_x 75.0000 (81.5625) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/18] time 0.303 (0.345) data 0.224 (0.267) loss_x loss_x 0.5776 (0.7405) acc_x 84.3750 (83.1250) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 663
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:610
clean false:4
clean_rate:0.993485342019544
noisy true:359
noisy false:659
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [11/200] batch [5/19] time 0.336 (0.339) data 0.258 (0.261) loss_x loss_x 0.4836 (0.5732) acc_x 84.3750 (86.2500) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/19] time 0.338 (0.340) data 0.260 (0.262) loss_x loss_x 0.7495 (0.6385) acc_x 90.6250 (85.9375) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/19] time 0.334 (0.341) data 0.255 (0.263) loss_x loss_x 0.9062 (0.6459) acc_x 59.3750 (84.1667) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 642
confident_label rate tensor(0.3866, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 631
clean true:625
clean false:6
clean_rate:0.9904912836767037
noisy true:365
noisy false:636
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 1001
epoch [12/200] batch [5/19] time 0.360 (0.347) data 0.282 (0.269) loss_x loss_x 0.6641 (0.7379) acc_x 78.1250 (82.5000) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/19] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.7188 (0.6851) acc_x 84.3750 (84.0625) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/19] time 0.338 (0.347) data 0.259 (0.269) loss_x loss_x 0.6133 (0.6674) acc_x 87.5000 (84.5833) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 650
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 622
clean true:618
clean false:4
clean_rate:0.9935691318327974
noisy true:364
noisy false:646
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 1010
epoch [13/200] batch [5/19] time 0.342 (0.325) data 0.264 (0.247) loss_x loss_x 1.0801 (0.7582) acc_x 71.8750 (79.3750) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/19] time 0.342 (0.341) data 0.262 (0.262) loss_x loss_x 0.5801 (0.6879) acc_x 90.6250 (81.8750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/19] time 0.332 (0.343) data 0.254 (0.265) loss_x loss_x 0.7363 (0.6930) acc_x 87.5000 (82.5000) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 645
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:612
clean false:5
clean_rate:0.9918962722852512
noisy true:375
noisy false:640
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [14/200] batch [5/19] time 0.353 (0.356) data 0.275 (0.277) loss_x loss_x 0.5107 (0.5766) acc_x 90.6250 (90.6250) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/19] time 0.292 (0.340) data 0.214 (0.262) loss_x loss_x 0.8218 (0.6298) acc_x 81.2500 (88.1250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/19] time 0.353 (0.339) data 0.274 (0.261) loss_x loss_x 0.6050 (0.6136) acc_x 84.3750 (87.0833) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 613
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:661
clean false:4
clean_rate:0.9939849624060151
noisy true:358
noisy false:609
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [15/200] batch [5/20] time 0.334 (0.347) data 0.256 (0.269) loss_x loss_x 0.6543 (0.6543) acc_x 81.2500 (81.8750) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/20] time 0.331 (0.340) data 0.253 (0.262) loss_x loss_x 0.6255 (0.6664) acc_x 87.5000 (82.8125) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/20] time 0.330 (0.341) data 0.253 (0.263) loss_x loss_x 0.6426 (0.6699) acc_x 84.3750 (83.7500) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/20] time 0.355 (0.342) data 0.276 (0.264) loss_x loss_x 0.5420 (0.6937) acc_x 87.5000 (82.8125) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 624
confident_label rate tensor(0.3940, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 643
clean true:639
clean false:4
clean_rate:0.9937791601866252
noisy true:369
noisy false:620
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 989
epoch [16/200] batch [5/20] time 0.362 (0.348) data 0.284 (0.270) loss_x loss_x 0.5889 (0.6092) acc_x 81.2500 (81.2500) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/20] time 0.349 (0.345) data 0.271 (0.267) loss_x loss_x 0.5161 (0.6260) acc_x 84.3750 (81.8750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/20] time 0.354 (0.344) data 0.275 (0.266) loss_x loss_x 0.4668 (0.5930) acc_x 90.6250 (83.1250) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/20] time 0.332 (0.344) data 0.254 (0.266) loss_x loss_x 0.6416 (0.5959) acc_x 84.3750 (84.5312) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 612
confident_label rate tensor(0.3977, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 649
clean true:645
clean false:4
clean_rate:0.9938366718027735
noisy true:375
noisy false:608
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 983
epoch [17/200] batch [5/20] time 0.314 (0.332) data 0.236 (0.254) loss_x loss_x 0.7261 (0.5637) acc_x 84.3750 (87.5000) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/20] time 0.358 (0.342) data 0.281 (0.264) loss_x loss_x 0.3186 (0.5715) acc_x 93.7500 (84.3750) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/20] time 0.290 (0.331) data 0.213 (0.253) loss_x loss_x 0.7671 (0.6386) acc_x 78.1250 (83.3333) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/20] time 0.341 (0.328) data 0.263 (0.250) loss_x loss_x 0.3250 (0.6166) acc_x 90.6250 (83.9062) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 582
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 660
clean true:656
clean false:4
clean_rate:0.9939393939393939
noisy true:394
noisy false:578
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 972
epoch [18/200] batch [5/20] time 0.305 (0.336) data 0.226 (0.258) loss_x loss_x 0.4072 (0.6129) acc_x 90.6250 (84.3750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/20] time 0.341 (0.335) data 0.263 (0.257) loss_x loss_x 0.6382 (0.6325) acc_x 90.6250 (84.6875) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/20] time 0.310 (0.326) data 0.231 (0.247) loss_x loss_x 0.7471 (0.6269) acc_x 81.2500 (84.3750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/20] time 0.345 (0.330) data 0.267 (0.252) loss_x loss_x 0.5171 (0.5834) acc_x 87.5000 (85.6250) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 580
confident_label rate tensor(0.4130, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 674
clean true:668
clean false:6
clean_rate:0.9910979228486647
noisy true:384
noisy false:574
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 958
epoch [19/200] batch [5/21] time 0.297 (0.317) data 0.218 (0.238) loss_x loss_x 0.3486 (0.4801) acc_x 87.5000 (86.2500) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/21] time 0.301 (0.313) data 0.223 (0.235) loss_x loss_x 0.3840 (0.5940) acc_x 93.7500 (85.0000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/21] time 0.359 (0.323) data 0.281 (0.245) loss_x loss_x 0.7563 (0.5995) acc_x 75.0000 (84.5833) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/21] time 0.345 (0.329) data 0.266 (0.250) loss_x loss_x 0.8584 (0.6204) acc_x 71.8750 (83.5938) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 561
confident_label rate tensor(0.4161, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 679
clean true:676
clean false:3
clean_rate:0.9955817378497791
noisy true:395
noisy false:558
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 953
epoch [20/200] batch [5/21] time 0.341 (0.352) data 0.263 (0.274) loss_x loss_x 0.5244 (0.5961) acc_x 87.5000 (82.5000) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/21] time 0.354 (0.349) data 0.275 (0.271) loss_x loss_x 0.5479 (0.6634) acc_x 84.3750 (83.1250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/21] time 0.353 (0.349) data 0.275 (0.270) loss_x loss_x 0.6636 (0.6642) acc_x 84.3750 (83.5417) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/21] time 0.352 (0.350) data 0.274 (0.272) loss_x loss_x 0.2125 (0.6571) acc_x 96.8750 (83.1250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 573
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 671
clean true:666
clean false:5
clean_rate:0.992548435171386
noisy true:393
noisy false:568
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 961
epoch [21/200] batch [5/20] time 0.344 (0.351) data 0.266 (0.272) loss_x loss_x 0.4983 (0.5193) acc_x 87.5000 (87.5000) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/20] time 0.340 (0.351) data 0.262 (0.272) loss_x loss_x 0.8315 (0.5984) acc_x 78.1250 (85.9375) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/20] time 0.337 (0.347) data 0.258 (0.269) loss_x loss_x 0.7695 (0.6414) acc_x 84.3750 (84.7917) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/20] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.4561 (0.5955) acc_x 87.5000 (85.6250) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.4179, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 682
clean true:677
clean false:5
clean_rate:0.9926686217008798
noisy true:380
noisy false:570
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 950
epoch [22/200] batch [5/21] time 0.353 (0.350) data 0.275 (0.273) loss_x loss_x 1.0918 (0.8255) acc_x 71.8750 (83.7500) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/21] time 0.333 (0.351) data 0.255 (0.273) loss_x loss_x 0.7910 (0.7161) acc_x 87.5000 (84.6875) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/21] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.8008 (0.6776) acc_x 75.0000 (84.5833) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/21] time 0.352 (0.349) data 0.274 (0.271) loss_x loss_x 0.8550 (0.7257) acc_x 78.1250 (83.4375) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.4234, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 691
clean true:683
clean false:8
clean_rate:0.9884225759768451
noisy true:393
noisy false:548
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 941
epoch [23/200] batch [5/21] time 0.338 (0.349) data 0.259 (0.270) loss_x loss_x 0.4954 (0.6361) acc_x 84.3750 (81.8750) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/21] time 0.333 (0.346) data 0.255 (0.268) loss_x loss_x 0.5776 (0.6234) acc_x 87.5000 (83.7500) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/21] time 0.299 (0.339) data 0.221 (0.261) loss_x loss_x 0.5752 (0.6086) acc_x 84.3750 (85.0000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/21] time 0.359 (0.337) data 0.282 (0.258) loss_x loss_x 0.5220 (0.5849) acc_x 81.2500 (85.3125) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 528
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:713
clean false:11
clean_rate:0.9848066298342542
noisy true:391
noisy false:517
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [24/200] batch [5/22] time 0.317 (0.333) data 0.239 (0.256) loss_x loss_x 0.3350 (0.4865) acc_x 93.7500 (91.2500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/22] time 0.312 (0.327) data 0.234 (0.249) loss_x loss_x 1.0127 (0.5749) acc_x 78.1250 (88.4375) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/22] time 0.298 (0.321) data 0.220 (0.243) loss_x loss_x 1.0107 (0.6000) acc_x 78.1250 (86.8750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/22] time 0.338 (0.324) data 0.260 (0.246) loss_x loss_x 0.4209 (0.6143) acc_x 93.7500 (86.0938) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:702
clean false:10
clean_rate:0.9859550561797753
noisy true:399
noisy false:521
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [25/200] batch [5/22] time 0.341 (0.358) data 0.264 (0.280) loss_x loss_x 0.6138 (0.5280) acc_x 78.1250 (86.8750) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/22] time 0.310 (0.339) data 0.231 (0.261) loss_x loss_x 0.3845 (0.5352) acc_x 90.6250 (87.8125) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/22] time 0.350 (0.333) data 0.272 (0.255) loss_x loss_x 0.4336 (0.5816) acc_x 87.5000 (87.0833) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/22] time 0.335 (0.338) data 0.257 (0.260) loss_x loss_x 0.5693 (0.5725) acc_x 87.5000 (87.3438) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 524
confident_label rate tensor(0.4357, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 711
clean true:702
clean false:9
clean_rate:0.9873417721518988
noisy true:406
noisy false:515
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 921
epoch [26/200] batch [5/22] time 0.344 (0.324) data 0.266 (0.245) loss_x loss_x 0.8125 (0.6705) acc_x 68.7500 (78.7500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/22] time 0.331 (0.330) data 0.253 (0.251) loss_x loss_x 0.5498 (0.5794) acc_x 87.5000 (84.6875) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/22] time 0.336 (0.335) data 0.258 (0.256) loss_x loss_x 0.5127 (0.5960) acc_x 87.5000 (84.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/22] time 0.368 (0.340) data 0.290 (0.261) loss_x loss_x 0.4866 (0.6081) acc_x 84.3750 (84.6875) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 521
confident_label rate tensor(0.4461, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 728
clean true:718
clean false:10
clean_rate:0.9862637362637363
noisy true:393
noisy false:511
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 904
epoch [27/200] batch [5/22] time 0.346 (0.341) data 0.267 (0.262) loss_x loss_x 0.7197 (0.5441) acc_x 78.1250 (85.6250) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/22] time 0.350 (0.345) data 0.272 (0.266) loss_x loss_x 0.6143 (0.6015) acc_x 81.2500 (85.3125) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/22] time 0.318 (0.342) data 0.239 (0.263) loss_x loss_x 0.5625 (0.5705) acc_x 81.2500 (85.8333) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/22] time 0.354 (0.340) data 0.276 (0.261) loss_x loss_x 0.6699 (0.6135) acc_x 81.2500 (84.8438) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 521
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 719
clean true:708
clean false:11
clean_rate:0.9847009735744089
noisy true:403
noisy false:510
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 913
epoch [28/200] batch [5/22] time 0.345 (0.352) data 0.266 (0.273) loss_x loss_x 0.2373 (0.4530) acc_x 93.7500 (90.6250) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/22] time 0.306 (0.330) data 0.227 (0.251) loss_x loss_x 0.6450 (0.5188) acc_x 78.1250 (86.2500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/22] time 0.347 (0.336) data 0.269 (0.257) loss_x loss_x 0.8838 (0.6004) acc_x 84.3750 (85.4167) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/22] time 0.341 (0.338) data 0.263 (0.260) loss_x loss_x 0.4363 (0.6073) acc_x 90.6250 (85.6250) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 488
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:735
clean false:7
clean_rate:0.9905660377358491
noisy true:409
noisy false:481
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [29/200] batch [5/23] time 0.306 (0.340) data 0.227 (0.261) loss_x loss_x 0.8804 (0.6057) acc_x 78.1250 (84.3750) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/23] time 0.342 (0.334) data 0.264 (0.255) loss_x loss_x 0.3428 (0.5226) acc_x 90.6250 (86.2500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/23] time 0.359 (0.338) data 0.281 (0.260) loss_x loss_x 0.6733 (0.6015) acc_x 84.3750 (84.5833) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/23] time 0.335 (0.338) data 0.257 (0.260) loss_x loss_x 1.0967 (0.6074) acc_x 75.0000 (84.3750) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 509
confident_label rate tensor(0.4485, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 732
clean true:724
clean false:8
clean_rate:0.9890710382513661
noisy true:399
noisy false:501
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 900
epoch [30/200] batch [5/22] time 0.349 (0.347) data 0.271 (0.268) loss_x loss_x 0.4231 (0.4356) acc_x 87.5000 (90.6250) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/22] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.4648 (0.5104) acc_x 90.6250 (88.7500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/22] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.5640 (0.5272) acc_x 84.3750 (88.3333) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/22] time 0.331 (0.343) data 0.253 (0.265) loss_x loss_x 0.6357 (0.5272) acc_x 81.2500 (88.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 524
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 718
clean true:708
clean false:10
clean_rate:0.9860724233983287
noisy true:400
noisy false:514
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 914
epoch [31/200] batch [5/22] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.2355 (0.5555) acc_x 96.8750 (88.1250) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [10/22] time 0.343 (0.342) data 0.264 (0.264) loss_x loss_x 1.0117 (0.5425) acc_x 87.5000 (89.3750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/22] time 0.324 (0.342) data 0.246 (0.264) loss_x loss_x 0.7954 (0.5121) acc_x 81.2500 (89.7917) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/22] time 0.335 (0.342) data 0.257 (0.264) loss_x loss_x 0.4209 (0.4872) acc_x 84.3750 (90.1562) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 494
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:726
clean false:10
clean_rate:0.9864130434782609
noisy true:412
noisy false:484
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [32/200] batch [5/23] time 0.347 (0.349) data 0.269 (0.271) loss_x loss_x 0.3865 (0.4799) acc_x 90.6250 (88.7500) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/23] time 0.346 (0.347) data 0.267 (0.269) loss_x loss_x 0.5107 (0.4850) acc_x 84.3750 (89.0625) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/23] time 0.360 (0.348) data 0.282 (0.270) loss_x loss_x 0.2434 (0.4733) acc_x 96.8750 (90.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/23] time 0.353 (0.349) data 0.275 (0.271) loss_x loss_x 0.3040 (0.4795) acc_x 100.0000 (89.5312) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 487
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:730
clean false:11
clean_rate:0.9851551956815114
noisy true:415
noisy false:476
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [33/200] batch [5/23] time 0.342 (0.354) data 0.264 (0.276) loss_x loss_x 0.5396 (0.5649) acc_x 87.5000 (85.0000) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [10/23] time 0.335 (0.350) data 0.257 (0.272) loss_x loss_x 0.4243 (0.5285) acc_x 93.7500 (87.5000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/23] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.5059 (0.5671) acc_x 84.3750 (86.2500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/23] time 0.348 (0.348) data 0.271 (0.270) loss_x loss_x 0.5586 (0.5452) acc_x 90.6250 (87.0312) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 500
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:725
clean false:14
clean_rate:0.9810554803788903
noisy true:407
noisy false:486
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [34/200] batch [5/23] time 0.341 (0.341) data 0.262 (0.262) loss_x loss_x 0.7402 (0.5179) acc_x 75.0000 (88.1250) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/23] time 0.335 (0.340) data 0.257 (0.262) loss_x loss_x 0.5293 (0.5644) acc_x 90.6250 (88.1250) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/23] time 0.340 (0.340) data 0.262 (0.261) loss_x loss_x 0.6870 (0.5888) acc_x 81.2500 (87.5000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/23] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.9614 (0.6352) acc_x 81.2500 (86.8750) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:725
clean false:10
clean_rate:0.9863945578231292
noisy true:425
noisy false:472
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [35/200] batch [5/22] time 0.342 (0.360) data 0.263 (0.281) loss_x loss_x 0.8799 (0.6704) acc_x 78.1250 (84.3750) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/22] time 0.348 (0.356) data 0.270 (0.277) loss_x loss_x 0.4468 (0.6842) acc_x 90.6250 (83.4375) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/22] time 0.342 (0.356) data 0.263 (0.277) loss_x loss_x 0.7104 (0.6608) acc_x 78.1250 (83.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/22] time 0.327 (0.352) data 0.248 (0.273) loss_x loss_x 0.4829 (0.6379) acc_x 93.7500 (85.3125) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:736
clean false:9
clean_rate:0.9879194630872483
noisy true:427
noisy false:460
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [36/200] batch [5/23] time 0.345 (0.342) data 0.267 (0.263) loss_x loss_x 0.4236 (0.4484) acc_x 96.8750 (90.6250) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [10/23] time 0.348 (0.343) data 0.270 (0.264) loss_x loss_x 0.5205 (0.4728) acc_x 84.3750 (88.7500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/23] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.2778 (0.4988) acc_x 93.7500 (87.7083) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/23] time 0.342 (0.340) data 0.263 (0.262) loss_x loss_x 0.6895 (0.5205) acc_x 84.3750 (86.8750) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:749
clean false:8
clean_rate:0.9894319682959049
noisy true:407
noisy false:468
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [37/200] batch [5/23] time 0.331 (0.346) data 0.252 (0.267) loss_x loss_x 0.7251 (0.5290) acc_x 75.0000 (86.8750) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/23] time 0.334 (0.333) data 0.255 (0.254) loss_x loss_x 0.2169 (0.5577) acc_x 100.0000 (86.8750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/23] time 0.349 (0.336) data 0.271 (0.258) loss_x loss_x 0.4470 (0.5607) acc_x 90.6250 (87.5000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/23] time 0.337 (0.339) data 0.259 (0.261) loss_x loss_x 0.2898 (0.5627) acc_x 96.8750 (87.6562) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:743
clean false:11
clean_rate:0.9854111405835544
noisy true:422
noisy false:456
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [38/200] batch [5/23] time 0.314 (0.312) data 0.235 (0.234) loss_x loss_x 0.6626 (0.5544) acc_x 87.5000 (86.2500) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/23] time 0.338 (0.327) data 0.259 (0.249) loss_x loss_x 0.5532 (0.5229) acc_x 87.5000 (87.8125) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/23] time 0.343 (0.331) data 0.265 (0.253) loss_x loss_x 0.6187 (0.5426) acc_x 81.2500 (87.2917) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/23] time 0.340 (0.330) data 0.262 (0.252) loss_x loss_x 0.7144 (0.5553) acc_x 87.5000 (87.0312) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 475
confident_label rate tensor(0.4491, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 733
clean true:724
clean false:9
clean_rate:0.9877216916780355
noisy true:433
noisy false:466
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 899
epoch [39/200] batch [5/22] time 0.337 (0.335) data 0.259 (0.257) loss_x loss_x 0.3247 (0.5481) acc_x 90.6250 (88.1250) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/22] time 0.350 (0.338) data 0.272 (0.260) loss_x loss_x 0.2585 (0.4756) acc_x 96.8750 (90.0000) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/22] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.2654 (0.4449) acc_x 96.8750 (90.8333) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/22] time 0.365 (0.343) data 0.287 (0.265) loss_x loss_x 0.2358 (0.4442) acc_x 96.8750 (90.0000) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 454
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:746
clean false:9
clean_rate:0.9880794701986755
noisy true:432
noisy false:445
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [40/200] batch [5/23] time 0.304 (0.330) data 0.227 (0.252) loss_x loss_x 0.3193 (0.4757) acc_x 93.7500 (89.3750) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/23] time 0.345 (0.330) data 0.267 (0.252) loss_x loss_x 0.1653 (0.4468) acc_x 100.0000 (89.6875) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/23] time 0.343 (0.333) data 0.265 (0.255) loss_x loss_x 0.5142 (0.4829) acc_x 84.3750 (87.5000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/23] time 0.311 (0.332) data 0.232 (0.254) loss_x loss_x 0.4087 (0.5321) acc_x 87.5000 (86.0938) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:736
clean false:11
clean_rate:0.9852744310575636
noisy true:416
noisy false:469
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [41/200] batch [5/23] time 0.330 (0.342) data 0.252 (0.264) loss_x loss_x 0.7153 (0.4481) acc_x 78.1250 (88.7500) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/23] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.8340 (0.5161) acc_x 78.1250 (86.8750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/23] time 0.330 (0.336) data 0.251 (0.257) loss_x loss_x 0.4771 (0.5047) acc_x 87.5000 (87.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/23] time 0.372 (0.339) data 0.294 (0.261) loss_x loss_x 0.4180 (0.4886) acc_x 93.7500 (87.9688) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 459
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:742
clean false:13
clean_rate:0.9827814569536424
noisy true:431
noisy false:446
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [42/200] batch [5/23] time 0.298 (0.342) data 0.219 (0.263) loss_x loss_x 0.6235 (0.3985) acc_x 84.3750 (90.0000) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/23] time 0.337 (0.332) data 0.259 (0.254) loss_x loss_x 0.6860 (0.4569) acc_x 78.1250 (88.4375) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/23] time 0.352 (0.338) data 0.274 (0.259) loss_x loss_x 0.2610 (0.5165) acc_x 93.7500 (87.5000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/23] time 0.346 (0.341) data 0.269 (0.263) loss_x loss_x 0.3635 (0.5433) acc_x 87.5000 (86.7188) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 463
confident_label rate tensor(0.4663, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 761
clean true:747
clean false:14
clean_rate:0.9816031537450722
noisy true:422
noisy false:449
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 871
epoch [43/200] batch [5/23] time 0.351 (0.343) data 0.272 (0.265) loss_x loss_x 0.8286 (0.6910) acc_x 84.3750 (84.3750) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [10/23] time 0.345 (0.344) data 0.266 (0.266) loss_x loss_x 0.4214 (0.5361) acc_x 87.5000 (88.4375) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/23] time 0.357 (0.347) data 0.279 (0.269) loss_x loss_x 0.4500 (0.5125) acc_x 87.5000 (89.1667) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/23] time 0.355 (0.346) data 0.276 (0.268) loss_x loss_x 0.4460 (0.5080) acc_x 87.5000 (88.9062) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 420
confident_label rate tensor(0.4816, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 786
clean true:775
clean false:11
clean_rate:0.9860050890585241
noisy true:437
noisy false:409
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 846
epoch [44/200] batch [5/24] time 0.329 (0.352) data 0.252 (0.274) loss_x loss_x 0.9482 (0.5544) acc_x 87.5000 (87.5000) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [10/24] time 0.348 (0.346) data 0.269 (0.268) loss_x loss_x 0.2214 (0.4650) acc_x 93.7500 (89.0625) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/24] time 0.385 (0.350) data 0.307 (0.272) loss_x loss_x 0.6338 (0.5085) acc_x 87.5000 (88.1250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/24] time 0.351 (0.350) data 0.272 (0.272) loss_x loss_x 0.4707 (0.5128) acc_x 84.3750 (87.6562) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 453
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:748
clean false:10
clean_rate:0.9868073878627969
noisy true:431
noisy false:443
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [45/200] batch [5/23] time 0.338 (0.340) data 0.260 (0.262) loss_x loss_x 0.4905 (0.4816) acc_x 87.5000 (88.7500) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [10/23] time 0.348 (0.342) data 0.270 (0.264) loss_x loss_x 0.4792 (0.4689) acc_x 84.3750 (88.1250) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/23] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.3711 (0.5299) acc_x 90.6250 (87.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/23] time 0.338 (0.341) data 0.260 (0.262) loss_x loss_x 0.4934 (0.5004) acc_x 87.5000 (88.7500) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 459
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:744
clean false:8
clean_rate:0.9893617021276596
noisy true:429
noisy false:451
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [46/200] batch [5/23] time 0.331 (0.344) data 0.253 (0.266) loss_x loss_x 0.5576 (0.4608) acc_x 84.3750 (90.0000) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [10/23] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.5864 (0.5289) acc_x 78.1250 (88.4375) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/23] time 0.343 (0.341) data 0.264 (0.263) loss_x loss_x 0.3010 (0.5210) acc_x 93.7500 (88.3333) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/23] time 0.336 (0.341) data 0.258 (0.263) loss_x loss_x 0.6841 (0.5018) acc_x 87.5000 (88.9062) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 463
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:735
clean false:8
clean_rate:0.9892328398384926
noisy true:434
noisy false:455
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [47/200] batch [5/23] time 0.346 (0.354) data 0.269 (0.276) loss_x loss_x 0.5708 (0.4806) acc_x 84.3750 (89.3750) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [10/23] time 0.334 (0.347) data 0.256 (0.269) loss_x loss_x 0.5156 (0.4549) acc_x 87.5000 (90.3125) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/23] time 0.355 (0.346) data 0.276 (0.267) loss_x loss_x 0.4053 (0.4652) acc_x 87.5000 (90.2083) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/23] time 0.343 (0.347) data 0.265 (0.269) loss_x loss_x 0.5239 (0.4559) acc_x 84.3750 (90.0000) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 426
confident_label rate tensor(0.4767, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 778
clean true:769
clean false:9
clean_rate:0.9884318766066839
noisy true:437
noisy false:417
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 854
epoch [48/200] batch [5/24] time 0.348 (0.354) data 0.270 (0.276) loss_x loss_x 0.5303 (0.5095) acc_x 84.3750 (86.2500) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/24] time 0.331 (0.352) data 0.254 (0.274) loss_x loss_x 0.5225 (0.4897) acc_x 90.6250 (88.1250) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/24] time 0.335 (0.349) data 0.257 (0.271) loss_x loss_x 0.6392 (0.4839) acc_x 87.5000 (88.5417) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/24] time 0.301 (0.337) data 0.222 (0.259) loss_x loss_x 0.6909 (0.4851) acc_x 84.3750 (88.4375) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.4755, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 776
clean true:768
clean false:8
clean_rate:0.9896907216494846
noisy true:443
noisy false:413
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 856
epoch [49/200] batch [5/24] time 0.346 (0.354) data 0.268 (0.276) loss_x loss_x 0.3408 (0.4772) acc_x 90.6250 (87.5000) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/24] time 0.307 (0.340) data 0.228 (0.262) loss_x loss_x 0.6396 (0.4622) acc_x 84.3750 (89.0625) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/24] time 0.348 (0.332) data 0.267 (0.254) loss_x loss_x 0.7300 (0.4897) acc_x 87.5000 (88.9583) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/24] time 0.353 (0.339) data 0.275 (0.260) loss_x loss_x 0.2729 (0.5006) acc_x 96.8750 (88.9062) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 422
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 791
clean true:780
clean false:11
clean_rate:0.9860935524652339
noisy true:430
noisy false:411
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 841
epoch [50/200] batch [5/24] time 0.339 (0.314) data 0.261 (0.236) loss_x loss_x 0.3872 (0.5260) acc_x 93.7500 (88.7500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/24] time 0.335 (0.328) data 0.256 (0.249) loss_x loss_x 0.4417 (0.4506) acc_x 93.7500 (90.6250) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/24] time 0.340 (0.334) data 0.262 (0.255) loss_x loss_x 0.6025 (0.4849) acc_x 84.3750 (88.1250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/24] time 0.345 (0.337) data 0.266 (0.258) loss_x loss_x 0.8584 (0.4984) acc_x 78.1250 (87.6562) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.4730, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 772
clean true:762
clean false:10
clean_rate:0.9870466321243523
noisy true:436
noisy false:424
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 860
epoch [51/200] batch [5/24] time 0.352 (0.358) data 0.274 (0.280) loss_x loss_x 0.2365 (0.3066) acc_x 96.8750 (95.6250) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [10/24] time 0.325 (0.345) data 0.247 (0.267) loss_x loss_x 0.8315 (0.3462) acc_x 78.1250 (93.4375) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/24] time 0.333 (0.342) data 0.255 (0.264) loss_x loss_x 0.1936 (0.3506) acc_x 100.0000 (93.1250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/24] time 0.343 (0.341) data 0.264 (0.263) loss_x loss_x 0.3262 (0.3867) acc_x 96.8750 (92.3438) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.4865, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 794
clean true:783
clean false:11
clean_rate:0.9861460957178841
noisy true:428
noisy false:410
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 838
epoch [52/200] batch [5/24] time 0.338 (0.343) data 0.260 (0.265) loss_x loss_x 0.4565 (0.4356) acc_x 87.5000 (90.6250) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [10/24] time 0.320 (0.339) data 0.241 (0.260) loss_x loss_x 0.4353 (0.3813) acc_x 87.5000 (91.5625) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/24] time 0.333 (0.338) data 0.255 (0.259) loss_x loss_x 0.8853 (0.4395) acc_x 75.0000 (88.9583) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/24] time 0.328 (0.339) data 0.250 (0.260) loss_x loss_x 0.5566 (0.4330) acc_x 78.1250 (88.9062) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.4828, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 788
clean true:773
clean false:15
clean_rate:0.9809644670050761
noisy true:443
noisy false:401
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 844
epoch [53/200] batch [5/24] time 0.364 (0.353) data 0.283 (0.273) loss_x loss_x 0.3247 (0.3956) acc_x 90.6250 (92.5000) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [10/24] time 0.362 (0.357) data 0.283 (0.277) loss_x loss_x 0.2042 (0.3998) acc_x 96.8750 (91.8750) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/24] time 0.369 (0.360) data 0.290 (0.281) loss_x loss_x 0.5366 (0.3998) acc_x 84.3750 (91.0417) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/24] time 0.372 (0.361) data 0.294 (0.282) loss_x loss_x 0.3674 (0.4064) acc_x 90.6250 (90.9375) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 409
confident_label rate tensor(0.4792, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 782
clean true:771
clean false:11
clean_rate:0.9859335038363172
noisy true:452
noisy false:398
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 850
epoch [54/200] batch [5/24] time 0.350 (0.344) data 0.272 (0.266) loss_x loss_x 0.2417 (0.5376) acc_x 93.7500 (88.7500) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [10/24] time 0.358 (0.346) data 0.280 (0.267) loss_x loss_x 0.2333 (0.4443) acc_x 93.7500 (90.6250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/24] time 0.353 (0.347) data 0.274 (0.268) loss_x loss_x 0.5811 (0.4181) acc_x 84.3750 (91.2500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/24] time 0.346 (0.349) data 0.269 (0.271) loss_x loss_x 0.4541 (0.3928) acc_x 90.6250 (91.4062) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 425
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 773
clean true:761
clean false:12
clean_rate:0.9844760672703752
noisy true:446
noisy false:413
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 859
epoch [55/200] batch [5/24] time 0.338 (0.356) data 0.260 (0.277) loss_x loss_x 0.7881 (0.4150) acc_x 87.5000 (91.8750) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [10/24] time 0.365 (0.356) data 0.287 (0.278) loss_x loss_x 0.2593 (0.3963) acc_x 90.6250 (90.9375) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/24] time 0.341 (0.352) data 0.264 (0.274) loss_x loss_x 0.6104 (0.4144) acc_x 78.1250 (89.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/24] time 0.359 (0.352) data 0.281 (0.274) loss_x loss_x 0.2861 (0.4190) acc_x 93.7500 (88.9062) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 426
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 777
clean true:766
clean false:11
clean_rate:0.9858429858429858
noisy true:440
noisy false:415
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 855
epoch [56/200] batch [5/24] time 0.299 (0.323) data 0.221 (0.245) loss_x loss_x 0.5249 (0.4062) acc_x 90.6250 (91.2500) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/24] time 0.335 (0.328) data 0.257 (0.250) loss_x loss_x 0.4780 (0.4964) acc_x 87.5000 (87.8125) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/24] time 0.340 (0.334) data 0.261 (0.256) loss_x loss_x 0.7515 (0.4936) acc_x 84.3750 (88.3333) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/24] time 0.354 (0.337) data 0.276 (0.259) loss_x loss_x 0.1986 (0.4816) acc_x 96.8750 (88.4375) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 405
confident_label rate tensor(0.4835, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 789
clean true:778
clean false:11
clean_rate:0.9860583016476553
noisy true:449
noisy false:394
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 843
epoch [57/200] batch [5/24] time 0.327 (0.322) data 0.249 (0.244) loss_x loss_x 0.5933 (0.4100) acc_x 78.1250 (89.3750) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [10/24] time 0.347 (0.336) data 0.269 (0.258) loss_x loss_x 0.2969 (0.4198) acc_x 90.6250 (88.4375) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/24] time 0.343 (0.339) data 0.265 (0.260) loss_x loss_x 0.2729 (0.4056) acc_x 90.6250 (88.9583) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/24] time 0.316 (0.330) data 0.238 (0.252) loss_x loss_x 0.3118 (0.4392) acc_x 87.5000 (88.7500) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 429
confident_label rate tensor(0.4755, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 776
clean true:769
clean false:7
clean_rate:0.990979381443299
noisy true:434
noisy false:422
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 856
epoch [58/200] batch [5/24] time 0.369 (0.333) data 0.291 (0.254) loss_x loss_x 0.5332 (0.4253) acc_x 84.3750 (88.7500) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [10/24] time 0.350 (0.341) data 0.272 (0.262) loss_x loss_x 0.4216 (0.4610) acc_x 84.3750 (86.8750) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/24] time 0.340 (0.341) data 0.261 (0.263) loss_x loss_x 0.2871 (0.4416) acc_x 90.6250 (88.5417) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/24] time 0.340 (0.341) data 0.263 (0.263) loss_x loss_x 0.3884 (0.4651) acc_x 87.5000 (87.5000) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 414
confident_label rate tensor(0.4816, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 786
clean true:777
clean false:9
clean_rate:0.9885496183206107
noisy true:441
noisy false:405
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 846
epoch [59/200] batch [5/24] time 0.342 (0.340) data 0.263 (0.261) loss_x loss_x 0.2966 (0.4027) acc_x 93.7500 (91.2500) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [10/24] time 0.344 (0.343) data 0.265 (0.264) loss_x loss_x 0.3271 (0.4278) acc_x 87.5000 (89.6875) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/24] time 0.351 (0.344) data 0.272 (0.266) loss_x loss_x 0.5107 (0.4508) acc_x 87.5000 (88.3333) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/24] time 0.335 (0.341) data 0.258 (0.263) loss_x loss_x 0.1594 (0.4469) acc_x 100.0000 (88.5938) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 419
confident_label rate tensor(0.4810, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 785
clean true:774
clean false:11
clean_rate:0.9859872611464968
noisy true:439
noisy false:408
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 847
epoch [60/200] batch [5/24] time 0.331 (0.348) data 0.253 (0.270) loss_x loss_x 0.4448 (0.3451) acc_x 81.2500 (91.8750) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [10/24] time 0.307 (0.333) data 0.229 (0.255) loss_x loss_x 0.6938 (0.3535) acc_x 84.3750 (91.2500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/24] time 0.349 (0.333) data 0.271 (0.255) loss_x loss_x 0.5225 (0.3702) acc_x 93.7500 (91.2500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/24] time 0.340 (0.336) data 0.262 (0.258) loss_x loss_x 0.2856 (0.3815) acc_x 96.8750 (91.2500) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 396
confident_label rate tensor(0.4982, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 813
clean true:800
clean false:13
clean_rate:0.984009840098401
noisy true:436
noisy false:383
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 819
epoch [61/200] batch [5/25] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.3984 (0.5433) acc_x 93.7500 (86.2500) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [10/25] time 0.340 (0.347) data 0.261 (0.269) loss_x loss_x 0.7168 (0.5475) acc_x 84.3750 (86.5625) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [15/25] time 0.354 (0.347) data 0.276 (0.269) loss_x loss_x 0.4797 (0.4830) acc_x 87.5000 (88.1250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/25] time 0.348 (0.347) data 0.270 (0.269) loss_x loss_x 0.6714 (0.4946) acc_x 84.3750 (88.1250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/25] time 0.331 (0.345) data 0.253 (0.267) loss_x loss_x 0.6562 (0.5065) acc_x 81.2500 (87.7500) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 384
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 811
clean true:801
clean false:10
clean_rate:0.9876695437731196
noisy true:447
noisy false:374
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 821
epoch [62/200] batch [5/25] time 0.312 (0.339) data 0.234 (0.261) loss_x loss_x 0.5425 (0.5084) acc_x 84.3750 (86.8750) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/25] time 0.352 (0.340) data 0.274 (0.262) loss_x loss_x 0.2264 (0.4397) acc_x 96.8750 (89.0625) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [15/25] time 0.352 (0.344) data 0.274 (0.265) loss_x loss_x 0.3816 (0.3986) acc_x 90.6250 (90.0000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/25] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.4043 (0.4008) acc_x 96.8750 (90.7812) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/25] time 0.351 (0.344) data 0.272 (0.266) loss_x loss_x 0.4600 (0.4193) acc_x 81.2500 (89.6250) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 803
clean true:792
clean false:11
clean_rate:0.9863013698630136
noisy true:436
noisy false:393
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 829
epoch [63/200] batch [5/25] time 0.364 (0.352) data 0.286 (0.274) loss_x loss_x 0.2524 (0.3545) acc_x 93.7500 (90.6250) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [10/25] time 0.341 (0.350) data 0.263 (0.272) loss_x loss_x 0.3545 (0.4005) acc_x 90.6250 (89.3750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [15/25] time 0.340 (0.349) data 0.262 (0.271) loss_x loss_x 0.2905 (0.3974) acc_x 93.7500 (89.1667) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/25] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.5356 (0.4191) acc_x 78.1250 (88.9062) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/25] time 0.351 (0.349) data 0.273 (0.271) loss_x loss_x 0.3982 (0.4293) acc_x 96.8750 (89.2500) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 384
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 804
clean true:792
clean false:12
clean_rate:0.9850746268656716
noisy true:456
noisy false:372
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 828
epoch [64/200] batch [5/25] time 0.342 (0.350) data 0.263 (0.272) loss_x loss_x 0.4102 (0.3638) acc_x 87.5000 (88.7500) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [10/25] time 0.346 (0.354) data 0.268 (0.276) loss_x loss_x 0.4348 (0.3901) acc_x 90.6250 (88.7500) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [15/25] time 0.316 (0.348) data 0.237 (0.270) loss_x loss_x 0.2352 (0.4090) acc_x 100.0000 (89.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/25] time 0.357 (0.347) data 0.279 (0.269) loss_x loss_x 0.3203 (0.4297) acc_x 90.6250 (88.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/25] time 0.347 (0.345) data 0.269 (0.266) loss_x loss_x 0.4104 (0.4368) acc_x 90.6250 (88.8750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 384
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 810
clean true:799
clean false:11
clean_rate:0.9864197530864197
noisy true:449
noisy false:373
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 822
epoch [65/200] batch [5/25] time 0.357 (0.355) data 0.279 (0.277) loss_x loss_x 0.6924 (0.5711) acc_x 84.3750 (87.5000) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [10/25] time 0.336 (0.349) data 0.258 (0.271) loss_x loss_x 0.5093 (0.5332) acc_x 87.5000 (87.5000) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [15/25] time 0.359 (0.348) data 0.281 (0.270) loss_x loss_x 0.3032 (0.4738) acc_x 87.5000 (88.3333) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/25] time 0.347 (0.346) data 0.269 (0.268) loss_x loss_x 0.3242 (0.4703) acc_x 90.6250 (88.1250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/25] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.5933 (0.4854) acc_x 84.3750 (87.5000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 389
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 814
clean true:805
clean false:9
clean_rate:0.9889434889434889
noisy true:438
noisy false:380
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 818
epoch [66/200] batch [5/25] time 0.291 (0.329) data 0.213 (0.251) loss_x loss_x 0.6943 (0.5314) acc_x 84.3750 (87.5000) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [10/25] time 0.339 (0.323) data 0.261 (0.244) loss_x loss_x 0.3311 (0.4853) acc_x 90.6250 (89.0625) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/25] time 0.346 (0.329) data 0.268 (0.251) loss_x loss_x 0.6040 (0.4850) acc_x 84.3750 (88.9583) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/25] time 0.348 (0.334) data 0.269 (0.255) loss_x loss_x 0.4404 (0.4751) acc_x 84.3750 (89.2188) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/25] time 0.345 (0.336) data 0.267 (0.258) loss_x loss_x 0.4497 (0.4666) acc_x 87.5000 (89.0000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 409
confident_label rate tensor(0.4877, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 796
clean true:786
clean false:10
clean_rate:0.9874371859296482
noisy true:437
noisy false:399
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 836
epoch [67/200] batch [5/24] time 0.319 (0.334) data 0.240 (0.255) loss_x loss_x 0.2803 (0.3146) acc_x 93.7500 (91.8750) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [10/24] time 0.349 (0.341) data 0.269 (0.262) loss_x loss_x 0.4126 (0.3929) acc_x 90.6250 (89.3750) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/24] time 0.363 (0.351) data 0.285 (0.272) loss_x loss_x 0.4766 (0.3997) acc_x 87.5000 (89.3750) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/24] time 0.371 (0.355) data 0.293 (0.276) loss_x loss_x 0.9175 (0.4296) acc_x 81.2500 (89.5312) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 380
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 815
clean true:806
clean false:9
clean_rate:0.9889570552147239
noisy true:446
noisy false:371
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 817
epoch [68/200] batch [5/25] time 0.348 (0.351) data 0.269 (0.273) loss_x loss_x 0.6060 (0.4461) acc_x 87.5000 (88.1250) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [10/25] time 0.341 (0.347) data 0.264 (0.268) loss_x loss_x 0.2205 (0.4399) acc_x 93.7500 (88.4375) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [15/25] time 0.341 (0.344) data 0.262 (0.266) loss_x loss_x 0.2810 (0.4445) acc_x 93.7500 (88.9583) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/25] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.4490 (0.4739) acc_x 93.7500 (88.2812) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/25] time 0.344 (0.342) data 0.265 (0.264) loss_x loss_x 0.3120 (0.4488) acc_x 93.7500 (88.8750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 378
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 817
clean true:806
clean false:11
clean_rate:0.9865361077111383
noisy true:448
noisy false:367
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 815
epoch [69/200] batch [5/25] time 0.355 (0.360) data 0.276 (0.281) loss_x loss_x 0.6670 (0.4442) acc_x 84.3750 (88.7500) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [10/25] time 0.361 (0.357) data 0.283 (0.279) loss_x loss_x 0.4172 (0.4217) acc_x 87.5000 (89.6875) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [15/25] time 0.296 (0.350) data 0.218 (0.272) loss_x loss_x 0.5312 (0.4491) acc_x 84.3750 (88.7500) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/25] time 0.330 (0.344) data 0.252 (0.266) loss_x loss_x 0.4080 (0.4894) acc_x 87.5000 (87.5000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/25] time 0.332 (0.342) data 0.254 (0.264) loss_x loss_x 0.4358 (0.4630) acc_x 90.6250 (88.3750) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 369
confident_label rate tensor(0.5043, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 823
clean true:814
clean false:9
clean_rate:0.9890643985419199
noisy true:449
noisy false:360
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 809
epoch [70/200] batch [5/25] time 0.342 (0.344) data 0.263 (0.265) loss_x loss_x 0.3669 (0.4529) acc_x 90.6250 (86.8750) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [10/25] time 0.348 (0.346) data 0.269 (0.267) loss_x loss_x 0.2878 (0.4680) acc_x 90.6250 (87.5000) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [15/25] time 0.325 (0.336) data 0.246 (0.257) loss_x loss_x 0.6240 (0.4609) acc_x 75.0000 (87.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/25] time 0.358 (0.339) data 0.279 (0.261) loss_x loss_x 0.4934 (0.4445) acc_x 90.6250 (88.4375) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/25] time 0.360 (0.342) data 0.281 (0.263) loss_x loss_x 0.2273 (0.4387) acc_x 100.0000 (89.2500) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 817
clean true:809
clean false:8
clean_rate:0.9902080783353733
noisy true:456
noisy false:359
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 815
epoch [71/200] batch [5/25] time 0.343 (0.346) data 0.265 (0.267) loss_x loss_x 0.5962 (0.4627) acc_x 90.6250 (90.0000) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [10/25] time 0.304 (0.335) data 0.225 (0.257) loss_x loss_x 0.4780 (0.4922) acc_x 87.5000 (89.0625) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [15/25] time 0.344 (0.331) data 0.266 (0.253) loss_x loss_x 0.6284 (0.4972) acc_x 81.2500 (89.1667) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/25] time 0.356 (0.334) data 0.277 (0.256) loss_x loss_x 0.5601 (0.5037) acc_x 81.2500 (88.4375) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/25] time 0.343 (0.336) data 0.266 (0.258) loss_x loss_x 0.7661 (0.5227) acc_x 78.1250 (88.0000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 369
confident_label rate tensor(0.5049, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 824
clean true:814
clean false:10
clean_rate:0.9878640776699029
noisy true:449
noisy false:359
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 808
epoch [72/200] batch [5/25] time 0.343 (0.347) data 0.265 (0.268) loss_x loss_x 0.4690 (0.4256) acc_x 84.3750 (89.3750) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [10/25] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.2307 (0.3951) acc_x 93.7500 (90.0000) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [15/25] time 0.342 (0.342) data 0.264 (0.263) loss_x loss_x 0.5288 (0.4379) acc_x 84.3750 (89.7917) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/25] time 0.349 (0.343) data 0.270 (0.265) loss_x loss_x 0.7695 (0.4443) acc_x 78.1250 (89.8438) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/25] time 0.303 (0.344) data 0.224 (0.265) loss_x loss_x 0.5625 (0.4438) acc_x 87.5000 (90.0000) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 363
confident_label rate tensor(0.5055, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 825
clean true:813
clean false:12
clean_rate:0.9854545454545455
noisy true:456
noisy false:351
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 807
epoch [73/200] batch [5/25] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.3401 (0.3843) acc_x 93.7500 (92.5000) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [10/25] time 0.325 (0.342) data 0.247 (0.264) loss_x loss_x 0.6294 (0.4755) acc_x 87.5000 (89.0625) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [15/25] time 0.323 (0.341) data 0.245 (0.263) loss_x loss_x 0.2222 (0.4374) acc_x 100.0000 (90.2083) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/25] time 0.331 (0.336) data 0.253 (0.257) loss_x loss_x 0.4968 (0.4700) acc_x 81.2500 (89.0625) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/25] time 0.297 (0.329) data 0.219 (0.251) loss_x loss_x 0.4641 (0.4713) acc_x 90.6250 (89.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.5080, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 829
clean true:819
clean false:10
clean_rate:0.9879372738238842
noisy true:456
noisy false:347
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 803
epoch [74/200] batch [5/25] time 0.340 (0.339) data 0.262 (0.260) loss_x loss_x 0.4719 (0.4137) acc_x 93.7500 (92.5000) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [10/25] time 0.343 (0.341) data 0.264 (0.263) loss_x loss_x 0.1335 (0.4072) acc_x 100.0000 (92.1875) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [15/25] time 0.332 (0.340) data 0.253 (0.262) loss_x loss_x 0.4905 (0.4063) acc_x 84.3750 (91.4583) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/25] time 0.341 (0.338) data 0.263 (0.259) loss_x loss_x 0.6167 (0.4167) acc_x 84.3750 (90.3125) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/25] time 0.350 (0.337) data 0.272 (0.258) loss_x loss_x 0.3628 (0.4157) acc_x 90.6250 (90.0000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 818
clean true:807
clean false:11
clean_rate:0.9865525672371638
noisy true:455
noisy false:359
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 814
epoch [75/200] batch [5/25] time 0.325 (0.334) data 0.247 (0.256) loss_x loss_x 0.6021 (0.4513) acc_x 78.1250 (88.7500) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/25] time 0.341 (0.330) data 0.263 (0.252) loss_x loss_x 0.2495 (0.5020) acc_x 93.7500 (87.1875) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/25] time 0.294 (0.328) data 0.216 (0.250) loss_x loss_x 0.4861 (0.4702) acc_x 90.6250 (88.5417) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/25] time 0.346 (0.330) data 0.267 (0.252) loss_x loss_x 0.2722 (0.4726) acc_x 93.7500 (89.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/25] time 0.311 (0.330) data 0.232 (0.251) loss_x loss_x 0.6714 (0.4548) acc_x 84.3750 (89.8750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.5086, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 830
clean true:819
clean false:11
clean_rate:0.9867469879518073
noisy true:443
noisy false:359
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 802
epoch [76/200] batch [5/25] time 0.328 (0.349) data 0.250 (0.270) loss_x loss_x 0.3103 (0.3426) acc_x 93.7500 (93.1250) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [10/25] time 0.332 (0.347) data 0.254 (0.269) loss_x loss_x 0.4263 (0.3987) acc_x 84.3750 (90.3125) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [15/25] time 0.335 (0.346) data 0.255 (0.267) loss_x loss_x 0.2942 (0.4197) acc_x 90.6250 (90.2083) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/25] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.3701 (0.4311) acc_x 87.5000 (90.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/25] time 0.374 (0.345) data 0.295 (0.266) loss_x loss_x 0.5664 (0.4323) acc_x 90.6250 (90.0000) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 352
confident_label rate tensor(0.5159, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 842
clean true:833
clean false:9
clean_rate:0.9893111638954869
noisy true:447
noisy false:343
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 790
epoch [77/200] batch [5/26] time 0.329 (0.321) data 0.250 (0.243) loss_x loss_x 0.2305 (0.3138) acc_x 90.6250 (91.2500) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [10/26] time 0.338 (0.331) data 0.260 (0.252) loss_x loss_x 0.8076 (0.3996) acc_x 78.1250 (89.6875) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [15/26] time 0.321 (0.331) data 0.243 (0.253) loss_x loss_x 0.7231 (0.4614) acc_x 75.0000 (87.0833) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/26] time 0.292 (0.324) data 0.214 (0.246) loss_x loss_x 0.3538 (0.4343) acc_x 90.6250 (88.4375) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/26] time 0.306 (0.320) data 0.227 (0.241) loss_x loss_x 0.2231 (0.4385) acc_x 96.8750 (88.5000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 352
confident_label rate tensor(0.5104, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 833
clean true:823
clean false:10
clean_rate:0.9879951980792316
noisy true:457
noisy false:342
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 799
epoch [78/200] batch [5/26] time 0.368 (0.346) data 0.290 (0.267) loss_x loss_x 0.2561 (0.4480) acc_x 93.7500 (90.0000) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [10/26] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.2900 (0.4053) acc_x 90.6250 (90.3125) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [15/26] time 0.338 (0.345) data 0.259 (0.266) loss_x loss_x 0.7686 (0.4222) acc_x 87.5000 (90.0000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/26] time 0.303 (0.342) data 0.224 (0.263) loss_x loss_x 0.2247 (0.4065) acc_x 100.0000 (90.7812) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/26] time 0.347 (0.338) data 0.269 (0.260) loss_x loss_x 0.4380 (0.4041) acc_x 93.7500 (90.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 356
confident_label rate tensor(0.5049, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 824
clean true:815
clean false:9
clean_rate:0.9890776699029126
noisy true:461
noisy false:347
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 808
epoch [79/200] batch [5/25] time 0.320 (0.319) data 0.241 (0.240) loss_x loss_x 0.4358 (0.4678) acc_x 90.6250 (87.5000) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [10/25] time 0.346 (0.331) data 0.268 (0.252) loss_x loss_x 0.4631 (0.4619) acc_x 87.5000 (88.1250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/25] time 0.303 (0.330) data 0.224 (0.252) loss_x loss_x 0.4229 (0.4562) acc_x 90.6250 (87.9167) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/25] time 0.348 (0.329) data 0.270 (0.251) loss_x loss_x 0.3376 (0.4253) acc_x 93.7500 (89.5312) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/25] time 0.373 (0.334) data 0.295 (0.256) loss_x loss_x 0.5967 (0.4308) acc_x 87.5000 (89.5000) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 352
confident_label rate tensor(0.5135, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 838
clean true:829
clean false:9
clean_rate:0.9892601431980907
noisy true:451
noisy false:343
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 794
epoch [80/200] batch [5/26] time 0.343 (0.341) data 0.266 (0.262) loss_x loss_x 0.4480 (0.3996) acc_x 84.3750 (90.0000) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [10/26] time 0.348 (0.337) data 0.270 (0.259) loss_x loss_x 0.4954 (0.3986) acc_x 87.5000 (90.3125) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [15/26] time 0.332 (0.337) data 0.254 (0.259) loss_x loss_x 0.3943 (0.3987) acc_x 93.7500 (90.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/26] time 0.294 (0.329) data 0.215 (0.250) loss_x loss_x 0.3472 (0.3928) acc_x 90.6250 (90.6250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/26] time 0.345 (0.327) data 0.266 (0.249) loss_x loss_x 0.5981 (0.4176) acc_x 93.7500 (90.8750) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.5098, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 832
clean true:820
clean false:12
clean_rate:0.9855769230769231
noisy true:458
noisy false:342
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 800
epoch [81/200] batch [5/26] time 0.341 (0.352) data 0.263 (0.274) loss_x loss_x 0.4438 (0.3946) acc_x 93.7500 (93.1250) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [10/26] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.5273 (0.4083) acc_x 84.3750 (91.8750) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [15/26] time 0.336 (0.343) data 0.257 (0.265) loss_x loss_x 0.4519 (0.4206) acc_x 90.6250 (91.2500) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/26] time 0.382 (0.341) data 0.303 (0.263) loss_x loss_x 0.3198 (0.4466) acc_x 90.6250 (90.4688) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/26] time 0.350 (0.342) data 0.272 (0.264) loss_x loss_x 0.5205 (0.4499) acc_x 87.5000 (90.1250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.5043, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 823
clean true:813
clean false:10
clean_rate:0.9878493317132442
noisy true:459
noisy false:350
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 809
epoch [82/200] batch [5/25] time 0.350 (0.342) data 0.272 (0.264) loss_x loss_x 0.6680 (0.4020) acc_x 81.2500 (88.1250) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [10/25] time 0.339 (0.343) data 0.261 (0.265) loss_x loss_x 0.2443 (0.4010) acc_x 93.7500 (89.6875) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [15/25] time 0.326 (0.340) data 0.248 (0.261) loss_x loss_x 0.6772 (0.4451) acc_x 90.6250 (89.3750) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/25] time 0.342 (0.341) data 0.264 (0.263) loss_x loss_x 0.2559 (0.4139) acc_x 96.8750 (90.3125) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/25] time 0.346 (0.342) data 0.268 (0.264) loss_x loss_x 0.3987 (0.4111) acc_x 90.6250 (90.5000) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.5178, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 845
clean true:833
clean false:12
clean_rate:0.9857988165680474
noisy true:458
noisy false:329
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 787
epoch [83/200] batch [5/26] time 0.351 (0.343) data 0.273 (0.265) loss_x loss_x 0.1975 (0.3911) acc_x 96.8750 (90.6250) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [10/26] time 0.324 (0.339) data 0.246 (0.261) loss_x loss_x 0.6704 (0.4746) acc_x 90.6250 (88.7500) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [15/26] time 0.303 (0.328) data 0.225 (0.250) loss_x loss_x 0.2664 (0.4579) acc_x 90.6250 (88.9583) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/26] time 0.329 (0.329) data 0.250 (0.251) loss_x loss_x 0.5820 (0.4397) acc_x 84.3750 (89.5312) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/26] time 0.333 (0.331) data 0.254 (0.252) loss_x loss_x 0.4287 (0.4400) acc_x 87.5000 (89.8750) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.5104, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 833
clean true:822
clean false:11
clean_rate:0.9867947178871549
noisy true:459
noisy false:340
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 799
epoch [84/200] batch [5/26] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.2426 (0.3298) acc_x 96.8750 (92.5000) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [10/26] time 0.330 (0.340) data 0.252 (0.262) loss_x loss_x 0.3293 (0.3529) acc_x 90.6250 (91.5625) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [15/26] time 0.354 (0.340) data 0.275 (0.262) loss_x loss_x 0.2966 (0.3689) acc_x 96.8750 (91.4583) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/26] time 0.305 (0.331) data 0.226 (0.253) loss_x loss_x 0.3442 (0.3847) acc_x 93.7500 (91.4062) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/26] time 0.299 (0.327) data 0.220 (0.249) loss_x loss_x 0.6836 (0.4042) acc_x 84.3750 (90.3750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 371
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 810
clean true:801
clean false:9
clean_rate:0.9888888888888889
noisy true:460
noisy false:362
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 822
epoch [85/200] batch [5/25] time 0.348 (0.358) data 0.270 (0.279) loss_x loss_x 0.4854 (0.3550) acc_x 90.6250 (92.5000) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [10/25] time 0.362 (0.352) data 0.284 (0.273) loss_x loss_x 0.3518 (0.3690) acc_x 93.7500 (92.1875) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [15/25] time 0.316 (0.348) data 0.237 (0.270) loss_x loss_x 0.2522 (0.3476) acc_x 93.7500 (92.2917) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/25] time 0.339 (0.347) data 0.260 (0.268) loss_x loss_x 0.7061 (0.4089) acc_x 81.2500 (90.6250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/25] time 0.346 (0.348) data 0.268 (0.269) loss_x loss_x 0.3525 (0.3870) acc_x 87.5000 (91.1250) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.5104, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 833
clean true:825
clean false:8
clean_rate:0.9903961584633854
noisy true:460
noisy false:339
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 799
epoch [86/200] batch [5/26] time 0.297 (0.340) data 0.218 (0.262) loss_x loss_x 0.2505 (0.4493) acc_x 93.7500 (92.5000) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [10/26] time 0.305 (0.321) data 0.227 (0.243) loss_x loss_x 0.2440 (0.4121) acc_x 96.8750 (92.8125) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [15/26] time 0.340 (0.328) data 0.261 (0.250) loss_x loss_x 0.3145 (0.4123) acc_x 90.6250 (91.6667) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/26] time 0.336 (0.332) data 0.258 (0.253) loss_x loss_x 0.6294 (0.4125) acc_x 87.5000 (91.7188) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/26] time 0.350 (0.334) data 0.273 (0.256) loss_x loss_x 0.4038 (0.4337) acc_x 90.6250 (91.5000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.5190, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 847
clean true:835
clean false:12
clean_rate:0.9858323494687131
noisy true:474
noisy false:311
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 785
epoch [87/200] batch [5/26] time 0.324 (0.321) data 0.246 (0.242) loss_x loss_x 1.1182 (0.4227) acc_x 81.2500 (91.2500) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/26] time 0.346 (0.338) data 0.268 (0.259) loss_x loss_x 0.2041 (0.3892) acc_x 96.8750 (91.5625) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [15/26] time 0.355 (0.341) data 0.277 (0.262) loss_x loss_x 0.2935 (0.4249) acc_x 93.7500 (89.7917) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/26] time 0.292 (0.335) data 0.213 (0.257) loss_x loss_x 0.3887 (0.4065) acc_x 93.7500 (90.9375) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/26] time 0.355 (0.336) data 0.277 (0.258) loss_x loss_x 0.4832 (0.4202) acc_x 81.2500 (90.2500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.5135, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 838
clean true:830
clean false:8
clean_rate:0.9904534606205251
noisy true:467
noisy false:327
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 794
epoch [88/200] batch [5/26] time 0.301 (0.328) data 0.223 (0.250) loss_x loss_x 0.3708 (0.3666) acc_x 87.5000 (91.2500) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [10/26] time 0.294 (0.314) data 0.217 (0.236) loss_x loss_x 0.4690 (0.3977) acc_x 87.5000 (90.3125) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [15/26] time 0.354 (0.325) data 0.276 (0.247) loss_x loss_x 0.4404 (0.4317) acc_x 93.7500 (90.0000) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/26] time 0.336 (0.332) data 0.258 (0.254) loss_x loss_x 0.3970 (0.4210) acc_x 93.7500 (90.0000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [25/26] time 0.353 (0.336) data 0.275 (0.258) loss_x loss_x 0.5894 (0.4072) acc_x 84.3750 (90.3750) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.5147, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 840
clean true:830
clean false:10
clean_rate:0.9880952380952381
noisy true:465
noisy false:327
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 792
epoch [89/200] batch [5/26] time 0.298 (0.301) data 0.219 (0.223) loss_x loss_x 0.2981 (0.3054) acc_x 93.7500 (91.2500) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [10/26] time 0.345 (0.320) data 0.267 (0.242) loss_x loss_x 0.3574 (0.3417) acc_x 90.6250 (91.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [15/26] time 0.357 (0.331) data 0.279 (0.252) loss_x loss_x 0.1279 (0.3394) acc_x 100.0000 (92.0833) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/26] time 0.363 (0.334) data 0.285 (0.256) loss_x loss_x 0.3081 (0.3533) acc_x 93.7500 (92.0312) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/26] time 0.329 (0.337) data 0.251 (0.259) loss_x loss_x 0.3237 (0.3616) acc_x 90.6250 (91.8750) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.5165, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 843
clean true:832
clean false:11
clean_rate:0.9869513641755635
noisy true:455
noisy false:334
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 789
epoch [90/200] batch [5/26] time 0.304 (0.327) data 0.225 (0.248) loss_x loss_x 0.3342 (0.3437) acc_x 93.7500 (91.2500) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [10/26] time 0.348 (0.327) data 0.270 (0.248) loss_x loss_x 0.5596 (0.4083) acc_x 81.2500 (89.3750) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [15/26] time 0.341 (0.332) data 0.263 (0.253) loss_x loss_x 0.5005 (0.4419) acc_x 87.5000 (88.9583) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/26] time 0.350 (0.336) data 0.272 (0.258) loss_x loss_x 0.3501 (0.4204) acc_x 90.6250 (89.5312) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/26] time 0.326 (0.339) data 0.248 (0.261) loss_x loss_x 0.4128 (0.4243) acc_x 87.5000 (89.2500) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.5184, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 846
clean true:835
clean false:11
clean_rate:0.9869976359338062
noisy true:472
noisy false:314
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 786
epoch [91/200] batch [5/26] time 0.335 (0.318) data 0.258 (0.240) loss_x loss_x 0.2954 (0.3613) acc_x 90.6250 (89.3750) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [10/26] time 0.332 (0.326) data 0.254 (0.247) loss_x loss_x 0.4219 (0.3946) acc_x 93.7500 (90.3125) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [15/26] time 0.346 (0.333) data 0.267 (0.255) loss_x loss_x 0.5156 (0.3705) acc_x 87.5000 (91.2500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/26] time 0.340 (0.336) data 0.262 (0.257) loss_x loss_x 0.4783 (0.3893) acc_x 87.5000 (90.9375) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/26] time 0.363 (0.338) data 0.284 (0.260) loss_x loss_x 0.3608 (0.4162) acc_x 96.8750 (90.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:843
clean false:9
clean_rate:0.9894366197183099
noisy true:466
noisy false:314
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [92/200] batch [5/26] time 0.371 (0.422) data 0.293 (0.343) loss_x loss_x 0.6826 (0.4107) acc_x 81.2500 (90.0000) lr 1.1564e-03 eta 0:00:08
epoch [92/200] batch [10/26] time 0.346 (0.386) data 0.267 (0.307) loss_x loss_x 0.3225 (0.3515) acc_x 96.8750 (91.8750) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [15/26] time 0.390 (0.378) data 0.312 (0.300) loss_x loss_x 0.3772 (0.3763) acc_x 90.6250 (91.4583) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [20/26] time 0.360 (0.376) data 0.282 (0.298) loss_x loss_x 0.7607 (0.4098) acc_x 81.2500 (90.3125) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/26] time 0.354 (0.371) data 0.276 (0.293) loss_x loss_x 0.2458 (0.3849) acc_x 96.8750 (91.1250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.5165, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 843
clean true:831
clean false:12
clean_rate:0.9857651245551602
noisy true:464
noisy false:325
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 789
epoch [93/200] batch [5/26] time 0.329 (0.331) data 0.250 (0.253) loss_x loss_x 0.5049 (0.3740) acc_x 84.3750 (90.6250) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [10/26] time 0.347 (0.327) data 0.270 (0.248) loss_x loss_x 0.3076 (0.3279) acc_x 96.8750 (93.4375) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [15/26] time 0.352 (0.333) data 0.274 (0.255) loss_x loss_x 0.2202 (0.3490) acc_x 93.7500 (92.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/26] time 0.333 (0.336) data 0.255 (0.258) loss_x loss_x 0.6909 (0.4058) acc_x 84.3750 (90.1562) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/26] time 0.362 (0.339) data 0.283 (0.261) loss_x loss_x 0.2666 (0.3963) acc_x 93.7500 (90.7500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 320
confident_label rate tensor(0.5184, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 846
clean true:835
clean false:11
clean_rate:0.9869976359338062
noisy true:477
noisy false:309
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 786
epoch [94/200] batch [5/26] time 0.298 (0.344) data 0.219 (0.265) loss_x loss_x 0.4128 (0.3913) acc_x 93.7500 (93.1250) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [10/26] time 0.337 (0.335) data 0.259 (0.257) loss_x loss_x 0.6772 (0.3992) acc_x 84.3750 (91.8750) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [15/26] time 0.330 (0.335) data 0.252 (0.257) loss_x loss_x 0.3162 (0.4038) acc_x 87.5000 (91.2500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/26] time 0.347 (0.338) data 0.269 (0.260) loss_x loss_x 0.5195 (0.4401) acc_x 81.2500 (90.1562) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/26] time 0.353 (0.340) data 0.274 (0.261) loss_x loss_x 0.4485 (0.4602) acc_x 84.3750 (89.7500) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.5294, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 864
clean true:855
clean false:9
clean_rate:0.9895833333333334
noisy true:487
noisy false:281
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 768
epoch [95/200] batch [5/27] time 0.343 (0.329) data 0.265 (0.251) loss_x loss_x 0.7363 (0.5032) acc_x 84.3750 (89.3750) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [10/27] time 0.339 (0.336) data 0.260 (0.257) loss_x loss_x 0.3604 (0.4413) acc_x 93.7500 (90.9375) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [15/27] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.1885 (0.3966) acc_x 96.8750 (91.2500) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [20/27] time 0.346 (0.341) data 0.268 (0.262) loss_x loss_x 0.2642 (0.3966) acc_x 93.7500 (90.7812) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/27] time 0.339 (0.342) data 0.261 (0.264) loss_x loss_x 0.3030 (0.3935) acc_x 93.7500 (91.1250) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.5306, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 866
clean true:855
clean false:11
clean_rate:0.9872979214780601
noisy true:482
noisy false:284
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 766
epoch [96/200] batch [5/27] time 0.338 (0.339) data 0.260 (0.261) loss_x loss_x 0.4304 (0.4067) acc_x 87.5000 (90.0000) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [10/27] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.2446 (0.4188) acc_x 96.8750 (90.9375) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [15/27] time 0.334 (0.339) data 0.256 (0.261) loss_x loss_x 0.5645 (0.4389) acc_x 87.5000 (90.2083) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [20/27] time 0.345 (0.341) data 0.267 (0.263) loss_x loss_x 0.6313 (0.4312) acc_x 90.6250 (90.9375) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/27] time 0.353 (0.342) data 0.276 (0.264) loss_x loss_x 0.2805 (0.4330) acc_x 96.8750 (90.8750) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 334
confident_label rate tensor(0.5196, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 848
clean true:837
clean false:11
clean_rate:0.9870283018867925
noisy true:461
noisy false:323
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 784
epoch [97/200] batch [5/26] time 0.321 (0.341) data 0.242 (0.263) loss_x loss_x 0.1520 (0.3907) acc_x 100.0000 (92.5000) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [10/26] time 0.333 (0.339) data 0.254 (0.261) loss_x loss_x 0.3745 (0.4346) acc_x 90.6250 (90.6250) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [15/26] time 0.344 (0.336) data 0.266 (0.258) loss_x loss_x 0.3613 (0.4520) acc_x 90.6250 (90.0000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/26] time 0.340 (0.338) data 0.262 (0.260) loss_x loss_x 0.3625 (0.4526) acc_x 87.5000 (89.5312) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/26] time 0.301 (0.338) data 0.224 (0.260) loss_x loss_x 0.1294 (0.4280) acc_x 100.0000 (90.2500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.5227, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 853
clean true:842
clean false:11
clean_rate:0.9871043376318874
noisy true:461
noisy false:318
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 779
epoch [98/200] batch [5/26] time 0.335 (0.343) data 0.257 (0.265) loss_x loss_x 0.1542 (0.3432) acc_x 100.0000 (92.5000) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [10/26] time 0.349 (0.340) data 0.271 (0.262) loss_x loss_x 0.3843 (0.3795) acc_x 93.7500 (91.5625) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [15/26] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.2832 (0.3764) acc_x 93.7500 (91.4583) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/26] time 0.336 (0.341) data 0.258 (0.263) loss_x loss_x 0.4260 (0.3927) acc_x 93.7500 (91.2500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/26] time 0.355 (0.342) data 0.276 (0.264) loss_x loss_x 0.3037 (0.3965) acc_x 96.8750 (91.1250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 305
confident_label rate tensor(0.5270, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 860
clean true:850
clean false:10
clean_rate:0.9883720930232558
noisy true:477
noisy false:295
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 772
epoch [99/200] batch [5/26] time 0.357 (0.357) data 0.279 (0.279) loss_x loss_x 0.5278 (0.5504) acc_x 84.3750 (86.8750) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [10/26] time 0.334 (0.348) data 0.256 (0.269) loss_x loss_x 0.5186 (0.5205) acc_x 84.3750 (87.5000) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [15/26] time 0.301 (0.342) data 0.222 (0.263) loss_x loss_x 0.8042 (0.4992) acc_x 81.2500 (88.3333) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/26] time 0.358 (0.348) data 0.279 (0.269) loss_x loss_x 0.3252 (0.5154) acc_x 96.8750 (88.4375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/26] time 0.353 (0.349) data 0.275 (0.270) loss_x loss_x 0.3640 (0.5041) acc_x 93.7500 (88.8750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.5184, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 846
clean true:836
clean false:10
clean_rate:0.9881796690307328
noisy true:473
noisy false:313
all clean rate:  [0.9829787234042553, 0.9929577464788732, 0.9927667269439421, 0.9945155393053017, 0.9947460595446584, 0.9931972789115646, 0.9913941480206541, 0.9900166389351082, 0.993421052631579, 0.9933884297520661, 0.993485342019544, 0.9904912836767037, 0.9935691318327974, 0.9918962722852512, 0.9939849624060151, 0.9937791601866252, 0.9938366718027735, 0.9939393939393939, 0.9910979228486647, 0.9955817378497791, 0.992548435171386, 0.9926686217008798, 0.9884225759768451, 0.9848066298342542, 0.9859550561797753, 0.9873417721518988, 0.9862637362637363, 0.9847009735744089, 0.9905660377358491, 0.9890710382513661, 0.9860724233983287, 0.9864130434782609, 0.9851551956815114, 0.9810554803788903, 0.9863945578231292, 0.9879194630872483, 0.9894319682959049, 0.9854111405835544, 0.9877216916780355, 0.9880794701986755, 0.9852744310575636, 0.9827814569536424, 0.9816031537450722, 0.9860050890585241, 0.9868073878627969, 0.9893617021276596, 0.9892328398384926, 0.9884318766066839, 0.9896907216494846, 0.9860935524652339, 0.9870466321243523, 0.9861460957178841, 0.9809644670050761, 0.9859335038363172, 0.9844760672703752, 0.9858429858429858, 0.9860583016476553, 0.990979381443299, 0.9885496183206107, 0.9859872611464968, 0.984009840098401, 0.9876695437731196, 0.9863013698630136, 0.9850746268656716, 0.9864197530864197, 0.9889434889434889, 0.9874371859296482, 0.9889570552147239, 0.9865361077111383, 0.9890643985419199, 0.9902080783353733, 0.9878640776699029, 0.9854545454545455, 0.9879372738238842, 0.9865525672371638, 0.9867469879518073, 0.9893111638954869, 0.9879951980792316, 0.9890776699029126, 0.9892601431980907, 0.9855769230769231, 0.9878493317132442, 0.9857988165680474, 0.9867947178871549, 0.9888888888888889, 0.9903961584633854, 0.9858323494687131, 0.9904534606205251, 0.9880952380952381, 0.9869513641755635, 0.9869976359338062, 0.9894366197183099, 0.9857651245551602, 0.9869976359338062, 0.9895833333333334, 0.9872979214780601, 0.9870283018867925, 0.9871043376318874, 0.9883720930232558, 0.9881796690307328]
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 786
epoch [100/200] batch [5/26] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.7441 (0.4473) acc_x 90.6250 (91.2500) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [10/26] time 0.349 (0.339) data 0.271 (0.261) loss_x loss_x 0.3562 (0.4589) acc_x 90.6250 (89.6875) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [15/26] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.6875 (0.4309) acc_x 81.2500 (90.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/26] time 0.351 (0.346) data 0.273 (0.268) loss_x loss_x 0.1935 (0.4586) acc_x 96.8750 (89.5312) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/26] time 0.296 (0.343) data 0.218 (0.265) loss_x loss_x 0.2422 (0.4271) acc_x 96.8750 (90.5000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 318
confident_label rate tensor(0.5165, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 843
clean true:837
clean false:6
clean_rate:0.9928825622775801
noisy true:477
noisy false:312
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 789
epoch [101/200] batch [5/26] time 0.325 (0.345) data 0.247 (0.267) loss_x loss_x 0.1908 (0.3491) acc_x 100.0000 (91.8750) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [10/26] time 0.351 (0.345) data 0.272 (0.267) loss_x loss_x 0.3713 (0.3862) acc_x 90.6250 (90.6250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [15/26] time 0.343 (0.346) data 0.265 (0.268) loss_x loss_x 0.1764 (0.3691) acc_x 100.0000 (91.8750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/26] time 0.307 (0.343) data 0.228 (0.265) loss_x loss_x 0.2413 (0.3748) acc_x 93.7500 (91.5625) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/26] time 0.368 (0.346) data 0.291 (0.268) loss_x loss_x 0.1941 (0.3822) acc_x 93.7500 (91.5000) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.5270, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 860
clean true:852
clean false:8
clean_rate:0.9906976744186047
noisy true:472
noisy false:300
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 772
epoch [102/200] batch [5/26] time 0.342 (0.344) data 0.263 (0.266) loss_x loss_x 0.2632 (0.4669) acc_x 93.7500 (89.3750) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [10/26] time 0.304 (0.324) data 0.226 (0.246) loss_x loss_x 0.1388 (0.3854) acc_x 100.0000 (92.1875) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [15/26] time 0.342 (0.326) data 0.264 (0.247) loss_x loss_x 0.3420 (0.3836) acc_x 90.6250 (92.0833) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/26] time 0.354 (0.331) data 0.277 (0.252) loss_x loss_x 0.1549 (0.3803) acc_x 100.0000 (92.0312) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/26] time 0.340 (0.332) data 0.261 (0.253) loss_x loss_x 0.5410 (0.3711) acc_x 90.6250 (92.1250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:843
clean false:9
clean_rate:0.9894366197183099
noisy true:468
noisy false:312
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [103/200] batch [5/26] time 0.340 (0.348) data 0.262 (0.270) loss_x loss_x 0.3342 (0.3398) acc_x 90.6250 (92.5000) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [10/26] time 0.302 (0.324) data 0.223 (0.246) loss_x loss_x 0.5776 (0.3690) acc_x 87.5000 (91.5625) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [15/26] time 0.331 (0.323) data 0.253 (0.245) loss_x loss_x 0.3889 (0.3855) acc_x 90.6250 (91.0417) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/26] time 0.332 (0.326) data 0.254 (0.248) loss_x loss_x 0.3682 (0.3779) acc_x 90.6250 (91.5625) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/26] time 0.337 (0.330) data 0.259 (0.252) loss_x loss_x 0.5918 (0.3815) acc_x 84.3750 (91.7500) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 310
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 859
clean true:849
clean false:10
clean_rate:0.9883585564610011
noisy true:473
noisy false:300
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 773
epoch [104/200] batch [5/26] time 0.335 (0.340) data 0.257 (0.262) loss_x loss_x 0.3611 (0.4678) acc_x 87.5000 (90.0000) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [10/26] time 0.295 (0.330) data 0.216 (0.252) loss_x loss_x 0.2264 (0.4158) acc_x 93.7500 (90.9375) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [15/26] time 0.329 (0.323) data 0.251 (0.244) loss_x loss_x 0.2174 (0.3844) acc_x 96.8750 (91.4583) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/26] time 0.352 (0.328) data 0.274 (0.249) loss_x loss_x 0.3325 (0.3634) acc_x 93.7500 (91.7188) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/26] time 0.326 (0.329) data 0.248 (0.250) loss_x loss_x 0.3186 (0.3567) acc_x 90.6250 (91.6250) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.5276, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 861
clean true:853
clean false:8
clean_rate:0.9907084785133565
noisy true:463
noisy false:308
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 771
epoch [105/200] batch [5/26] time 0.347 (0.346) data 0.269 (0.268) loss_x loss_x 0.1354 (0.3993) acc_x 100.0000 (90.0000) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [10/26] time 0.344 (0.343) data 0.265 (0.265) loss_x loss_x 0.3149 (0.3882) acc_x 96.8750 (90.9375) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [15/26] time 0.302 (0.335) data 0.223 (0.257) loss_x loss_x 0.4065 (0.3989) acc_x 93.7500 (90.6250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/26] time 0.339 (0.337) data 0.261 (0.259) loss_x loss_x 0.8330 (0.4250) acc_x 71.8750 (89.3750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/26] time 0.349 (0.339) data 0.271 (0.260) loss_x loss_x 0.3796 (0.4094) acc_x 93.7500 (90.0000) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 865
clean true:855
clean false:10
clean_rate:0.9884393063583815
noisy true:485
noisy false:282
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 767
epoch [106/200] batch [5/27] time 0.341 (0.340) data 0.263 (0.262) loss_x loss_x 0.4983 (0.3414) acc_x 84.3750 (90.6250) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [10/27] time 0.339 (0.350) data 0.262 (0.271) loss_x loss_x 0.3218 (0.3257) acc_x 90.6250 (92.1875) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [15/27] time 0.329 (0.339) data 0.251 (0.261) loss_x loss_x 0.2844 (0.3551) acc_x 90.6250 (91.2500) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [20/27] time 0.339 (0.339) data 0.261 (0.261) loss_x loss_x 0.3713 (0.3759) acc_x 93.7500 (90.3125) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/27] time 0.310 (0.339) data 0.231 (0.260) loss_x loss_x 0.3542 (0.3655) acc_x 87.5000 (90.5000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 297
confident_label rate tensor(0.5349, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 873
clean true:864
clean false:9
clean_rate:0.9896907216494846
noisy true:471
noisy false:288
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 759
epoch [107/200] batch [5/27] time 0.368 (0.346) data 0.290 (0.268) loss_x loss_x 0.5083 (0.5237) acc_x 90.6250 (89.3750) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [10/27] time 0.303 (0.342) data 0.225 (0.263) loss_x loss_x 0.2935 (0.4469) acc_x 90.6250 (89.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [15/27] time 0.344 (0.337) data 0.266 (0.259) loss_x loss_x 0.1406 (0.3854) acc_x 100.0000 (91.4583) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [20/27] time 0.311 (0.338) data 0.233 (0.260) loss_x loss_x 0.8105 (0.4114) acc_x 84.3750 (91.5625) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/27] time 0.354 (0.340) data 0.275 (0.262) loss_x loss_x 0.2764 (0.4128) acc_x 96.8750 (91.2500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.5208, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 850
clean true:844
clean false:6
clean_rate:0.9929411764705882
noisy true:472
noisy false:310
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 782
epoch [108/200] batch [5/26] time 0.386 (0.376) data 0.308 (0.297) loss_x loss_x 0.5796 (0.4583) acc_x 81.2500 (89.3750) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [10/26] time 0.373 (0.372) data 0.295 (0.293) loss_x loss_x 0.4739 (0.4209) acc_x 84.3750 (90.6250) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [15/26] time 0.352 (0.364) data 0.274 (0.285) loss_x loss_x 0.3657 (0.4253) acc_x 84.3750 (89.7917) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [20/26] time 0.321 (0.358) data 0.241 (0.279) loss_x loss_x 0.4492 (0.4228) acc_x 90.6250 (89.8438) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/26] time 0.338 (0.355) data 0.259 (0.276) loss_x loss_x 0.2673 (0.4027) acc_x 96.8750 (90.3750) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.5355, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 874
clean true:864
clean false:10
clean_rate:0.988558352402746
noisy true:485
noisy false:273
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 758
epoch [109/200] batch [5/27] time 0.344 (0.352) data 0.266 (0.274) loss_x loss_x 0.4236 (0.4371) acc_x 87.5000 (88.7500) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [10/27] time 0.346 (0.350) data 0.269 (0.272) loss_x loss_x 0.2490 (0.4306) acc_x 96.8750 (90.3125) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [15/27] time 0.336 (0.341) data 0.258 (0.263) loss_x loss_x 0.4629 (0.4352) acc_x 90.6250 (90.4167) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [20/27] time 0.346 (0.341) data 0.268 (0.263) loss_x loss_x 0.3909 (0.4652) acc_x 93.7500 (90.1562) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/27] time 0.344 (0.342) data 0.266 (0.264) loss_x loss_x 0.3574 (0.4618) acc_x 93.7500 (90.1250) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 307
confident_label rate tensor(0.5312, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 867
clean true:857
clean false:10
clean_rate:0.9884659746251442
noisy true:468
noisy false:297
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 765
epoch [110/200] batch [5/27] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.3506 (0.3899) acc_x 90.6250 (91.8750) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [10/27] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.3853 (0.4284) acc_x 90.6250 (91.2500) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [15/27] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.4822 (0.4169) acc_x 84.3750 (90.4167) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [20/27] time 0.345 (0.345) data 0.266 (0.266) loss_x loss_x 0.4067 (0.4168) acc_x 87.5000 (90.3125) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/27] time 0.351 (0.344) data 0.273 (0.266) loss_x loss_x 0.5176 (0.4255) acc_x 84.3750 (89.7500) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 288
confident_label rate tensor(0.5368, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 876
clean true:866
clean false:10
clean_rate:0.9885844748858448
noisy true:478
noisy false:278
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 756
epoch [111/200] batch [5/27] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.3416 (0.3571) acc_x 96.8750 (92.5000) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [10/27] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.3103 (0.3481) acc_x 93.7500 (92.8125) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [15/27] time 0.337 (0.344) data 0.258 (0.266) loss_x loss_x 0.3625 (0.3632) acc_x 93.7500 (92.0833) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [20/27] time 0.343 (0.344) data 0.265 (0.266) loss_x loss_x 0.4219 (0.3564) acc_x 90.6250 (91.7188) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/27] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.2795 (0.3775) acc_x 96.8750 (91.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.5282, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 862
clean true:855
clean false:7
clean_rate:0.9918793503480279
noisy true:494
noisy false:276
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 770
epoch [112/200] batch [5/26] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.3188 (0.3658) acc_x 93.7500 (90.6250) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [10/26] time 0.350 (0.344) data 0.271 (0.266) loss_x loss_x 0.3604 (0.3295) acc_x 90.6250 (93.1250) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [15/26] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.2964 (0.3227) acc_x 93.7500 (93.3333) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/26] time 0.369 (0.348) data 0.292 (0.270) loss_x loss_x 0.7310 (0.3463) acc_x 81.2500 (92.6562) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/26] time 0.329 (0.347) data 0.250 (0.269) loss_x loss_x 0.3591 (0.3489) acc_x 87.5000 (92.3750) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.5404, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 882
clean true:872
clean false:10
clean_rate:0.9886621315192744
noisy true:494
noisy false:256
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 750
epoch [113/200] batch [5/27] time 0.344 (0.346) data 0.266 (0.268) loss_x loss_x 0.2695 (0.3792) acc_x 93.7500 (90.6250) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [10/27] time 0.330 (0.343) data 0.252 (0.265) loss_x loss_x 0.2576 (0.3702) acc_x 93.7500 (91.5625) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [15/27] time 0.344 (0.340) data 0.266 (0.262) loss_x loss_x 0.3794 (0.4058) acc_x 90.6250 (90.2083) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [20/27] time 0.302 (0.339) data 0.225 (0.261) loss_x loss_x 0.3728 (0.3915) acc_x 93.7500 (90.0000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/27] time 0.337 (0.331) data 0.258 (0.253) loss_x loss_x 0.5010 (0.3839) acc_x 90.6250 (90.3750) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 304
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 870
clean true:858
clean false:12
clean_rate:0.9862068965517241
noisy true:470
noisy false:292
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 762
epoch [114/200] batch [5/27] time 0.348 (0.338) data 0.270 (0.260) loss_x loss_x 0.5972 (0.4355) acc_x 87.5000 (91.8750) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [10/27] time 0.347 (0.342) data 0.270 (0.263) loss_x loss_x 0.2637 (0.4341) acc_x 93.7500 (92.1875) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [15/27] time 0.326 (0.336) data 0.248 (0.258) loss_x loss_x 0.2917 (0.4005) acc_x 96.8750 (92.9167) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [20/27] time 0.358 (0.337) data 0.280 (0.258) loss_x loss_x 0.4282 (0.4002) acc_x 90.6250 (92.0312) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/27] time 0.331 (0.339) data 0.254 (0.261) loss_x loss_x 0.6025 (0.3905) acc_x 84.3750 (92.3750) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 285
confident_label rate tensor(0.5337, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 871
clean true:860
clean false:11
clean_rate:0.9873708381171068
noisy true:487
noisy false:274
after delete: len(clean_dataset) 871
after delete: len(noisy_dataset) 761
epoch [115/200] batch [5/27] time 0.330 (0.337) data 0.251 (0.259) loss_x loss_x 0.9263 (0.5143) acc_x 84.3750 (90.0000) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [10/27] time 0.294 (0.322) data 0.216 (0.244) loss_x loss_x 0.3748 (0.4187) acc_x 90.6250 (90.6250) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [15/27] time 0.350 (0.322) data 0.272 (0.244) loss_x loss_x 0.7256 (0.4498) acc_x 90.6250 (90.4167) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/27] time 0.337 (0.326) data 0.259 (0.248) loss_x loss_x 0.4341 (0.4277) acc_x 87.5000 (90.4688) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/27] time 0.342 (0.330) data 0.264 (0.252) loss_x loss_x 0.3574 (0.4434) acc_x 90.6250 (89.7500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 288
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 859
clean true:850
clean false:9
clean_rate:0.989522700814901
noisy true:494
noisy false:279
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 773
epoch [116/200] batch [5/26] time 0.351 (0.350) data 0.272 (0.271) loss_x loss_x 0.5674 (0.3084) acc_x 93.7500 (95.6250) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [10/26] time 0.352 (0.347) data 0.274 (0.269) loss_x loss_x 0.1729 (0.3247) acc_x 100.0000 (93.7500) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [15/26] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.2969 (0.3298) acc_x 100.0000 (93.7500) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/26] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.3645 (0.3356) acc_x 87.5000 (92.8125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/26] time 0.346 (0.345) data 0.268 (0.267) loss_x loss_x 0.2991 (0.3358) acc_x 96.8750 (93.5000) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.5355, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 874
clean true:866
clean false:8
clean_rate:0.9908466819221968
noisy true:473
noisy false:285
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 758
epoch [117/200] batch [5/27] time 0.376 (0.350) data 0.297 (0.272) loss_x loss_x 0.1931 (0.3240) acc_x 96.8750 (93.1250) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [10/27] time 0.343 (0.346) data 0.265 (0.268) loss_x loss_x 0.1638 (0.3052) acc_x 96.8750 (93.4375) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [15/27] time 0.353 (0.348) data 0.275 (0.269) loss_x loss_x 0.3330 (0.3107) acc_x 96.8750 (93.3333) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [20/27] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.0709 (0.3146) acc_x 100.0000 (93.2812) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/27] time 0.344 (0.345) data 0.266 (0.267) loss_x loss_x 0.6504 (0.3418) acc_x 87.5000 (92.6250) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.5398, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 881
clean true:872
clean false:9
clean_rate:0.9897843359818388
noisy true:494
noisy false:257
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 751
epoch [118/200] batch [5/27] time 0.359 (0.354) data 0.280 (0.276) loss_x loss_x 0.3850 (0.3361) acc_x 93.7500 (91.8750) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [10/27] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.6035 (0.4134) acc_x 87.5000 (90.6250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [15/27] time 0.353 (0.347) data 0.276 (0.269) loss_x loss_x 0.2428 (0.3565) acc_x 96.8750 (92.5000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [20/27] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.3938 (0.3516) acc_x 93.7500 (92.6562) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/27] time 0.349 (0.348) data 0.271 (0.270) loss_x loss_x 0.2869 (0.3647) acc_x 96.8750 (92.7500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:874
clean false:10
clean_rate:0.9886877828054299
noisy true:475
noisy false:273
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [119/200] batch [5/27] time 0.337 (0.350) data 0.259 (0.272) loss_x loss_x 0.7080 (0.3811) acc_x 84.3750 (90.6250) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [10/27] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.7319 (0.4068) acc_x 84.3750 (90.3125) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [15/27] time 0.313 (0.343) data 0.234 (0.265) loss_x loss_x 0.3936 (0.3923) acc_x 90.6250 (90.0000) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/27] time 0.342 (0.343) data 0.264 (0.265) loss_x loss_x 0.4375 (0.3692) acc_x 87.5000 (90.9375) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/27] time 0.352 (0.342) data 0.273 (0.264) loss_x loss_x 0.3279 (0.3751) acc_x 90.6250 (90.8750) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.5251, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 857
clean true:851
clean false:6
clean_rate:0.9929988331388565
noisy true:485
noisy false:290
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 775
epoch [120/200] batch [5/26] time 0.316 (0.334) data 0.238 (0.255) loss_x loss_x 0.4380 (0.3281) acc_x 87.5000 (92.5000) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [10/26] time 0.341 (0.336) data 0.263 (0.257) loss_x loss_x 0.7344 (0.4538) acc_x 87.5000 (89.6875) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/26] time 0.337 (0.337) data 0.258 (0.259) loss_x loss_x 0.2600 (0.4049) acc_x 93.7500 (91.4583) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/26] time 0.345 (0.337) data 0.266 (0.258) loss_x loss_x 0.4683 (0.4038) acc_x 90.6250 (91.8750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/26] time 0.341 (0.338) data 0.263 (0.259) loss_x loss_x 0.4126 (0.3970) acc_x 87.5000 (91.8750) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.5282, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 862
clean true:853
clean false:9
clean_rate:0.9895591647331786
noisy true:487
noisy false:283
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 770
epoch [121/200] batch [5/26] time 0.347 (0.350) data 0.269 (0.270) loss_x loss_x 0.2260 (0.2359) acc_x 93.7500 (95.0000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [10/26] time 0.346 (0.350) data 0.268 (0.271) loss_x loss_x 0.3108 (0.2583) acc_x 96.8750 (94.3750) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [15/26] time 0.364 (0.348) data 0.286 (0.270) loss_x loss_x 0.3914 (0.2742) acc_x 87.5000 (93.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/26] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.5254 (0.2903) acc_x 93.7500 (93.2812) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/26] time 0.330 (0.345) data 0.252 (0.266) loss_x loss_x 0.8149 (0.3117) acc_x 75.0000 (92.5000) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 875
clean true:868
clean false:7
clean_rate:0.992
noisy true:481
noisy false:276
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 757
epoch [122/200] batch [5/27] time 0.349 (0.319) data 0.271 (0.240) loss_x loss_x 0.5806 (0.3362) acc_x 84.3750 (92.5000) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [10/27] time 0.350 (0.328) data 0.272 (0.250) loss_x loss_x 0.4385 (0.3176) acc_x 90.6250 (93.1250) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [15/27] time 0.329 (0.332) data 0.251 (0.254) loss_x loss_x 0.6206 (0.3410) acc_x 84.3750 (92.5000) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/27] time 0.342 (0.335) data 0.264 (0.257) loss_x loss_x 0.6899 (0.3486) acc_x 87.5000 (92.6562) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/27] time 0.353 (0.339) data 0.274 (0.261) loss_x loss_x 0.4883 (0.3679) acc_x 87.5000 (91.7500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.5380, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 878
clean true:872
clean false:6
clean_rate:0.9931662870159453
noisy true:489
noisy false:265
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 754
epoch [123/200] batch [5/27] time 0.337 (0.329) data 0.259 (0.250) loss_x loss_x 0.4421 (0.3063) acc_x 96.8750 (95.0000) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [10/27] time 0.353 (0.336) data 0.275 (0.258) loss_x loss_x 0.2632 (0.2906) acc_x 93.7500 (94.3750) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [15/27] time 0.341 (0.339) data 0.263 (0.260) loss_x loss_x 0.2339 (0.2966) acc_x 96.8750 (93.9583) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [20/27] time 0.352 (0.342) data 0.274 (0.264) loss_x loss_x 0.2810 (0.2956) acc_x 93.7500 (94.2188) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/27] time 0.358 (0.343) data 0.280 (0.265) loss_x loss_x 0.2032 (0.3067) acc_x 96.8750 (93.6250) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.5441, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 888
clean true:880
clean false:8
clean_rate:0.990990990990991
noisy true:475
noisy false:269
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 744
epoch [124/200] batch [5/27] time 0.303 (0.333) data 0.225 (0.255) loss_x loss_x 0.4832 (0.4076) acc_x 90.6250 (91.2500) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [10/27] time 0.331 (0.323) data 0.252 (0.245) loss_x loss_x 0.6353 (0.4465) acc_x 84.3750 (89.3750) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [15/27] time 0.332 (0.326) data 0.254 (0.247) loss_x loss_x 0.7900 (0.4361) acc_x 81.2500 (89.3750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/27] time 0.329 (0.331) data 0.251 (0.253) loss_x loss_x 0.2922 (0.4621) acc_x 90.6250 (88.7500) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/27] time 0.353 (0.329) data 0.274 (0.251) loss_x loss_x 0.2891 (0.4373) acc_x 93.7500 (89.5000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 297
confident_label rate tensor(0.5343, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 872
clean true:867
clean false:5
clean_rate:0.9942660550458715
noisy true:468
noisy false:292
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 760
epoch [125/200] batch [5/27] time 0.353 (0.348) data 0.275 (0.270) loss_x loss_x 0.6333 (0.3944) acc_x 87.5000 (91.8750) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [10/27] time 0.362 (0.351) data 0.284 (0.273) loss_x loss_x 0.4460 (0.3964) acc_x 90.6250 (91.5625) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [15/27] time 0.332 (0.348) data 0.254 (0.270) loss_x loss_x 0.4829 (0.4018) acc_x 87.5000 (90.4167) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [20/27] time 0.327 (0.347) data 0.249 (0.268) loss_x loss_x 0.6875 (0.4181) acc_x 84.3750 (90.1562) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/27] time 0.356 (0.342) data 0.278 (0.264) loss_x loss_x 0.7021 (0.4285) acc_x 84.3750 (89.6250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:895
clean false:4
clean_rate:0.9955506117908788
noisy true:498
noisy false:235
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [126/200] batch [5/28] time 0.347 (0.346) data 0.269 (0.268) loss_x loss_x 0.4709 (0.3667) acc_x 90.6250 (90.6250) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [10/28] time 0.365 (0.346) data 0.287 (0.268) loss_x loss_x 0.3337 (0.3399) acc_x 87.5000 (90.0000) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [15/28] time 0.353 (0.346) data 0.275 (0.268) loss_x loss_x 0.5239 (0.3355) acc_x 87.5000 (90.6250) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [20/28] time 0.315 (0.340) data 0.236 (0.262) loss_x loss_x 0.1556 (0.3371) acc_x 96.8750 (91.0938) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/28] time 0.354 (0.340) data 0.275 (0.262) loss_x loss_x 0.6143 (0.3664) acc_x 90.6250 (91.1250) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.5349, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 873
clean true:867
clean false:6
clean_rate:0.993127147766323
noisy true:499
noisy false:260
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 759
epoch [127/200] batch [5/27] time 0.348 (0.340) data 0.270 (0.262) loss_x loss_x 0.2761 (0.3686) acc_x 93.7500 (92.5000) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [10/27] time 0.356 (0.342) data 0.277 (0.264) loss_x loss_x 0.1606 (0.3393) acc_x 96.8750 (92.5000) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [15/27] time 0.366 (0.340) data 0.288 (0.262) loss_x loss_x 0.2827 (0.3503) acc_x 90.6250 (91.8750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [20/27] time 0.336 (0.342) data 0.259 (0.263) loss_x loss_x 0.4009 (0.3520) acc_x 90.6250 (91.8750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/27] time 0.352 (0.343) data 0.273 (0.264) loss_x loss_x 0.3296 (0.3609) acc_x 87.5000 (91.5000) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 870
clean true:865
clean false:5
clean_rate:0.9942528735632183
noisy true:494
noisy false:268
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 762
epoch [128/200] batch [5/27] time 0.347 (0.350) data 0.269 (0.271) loss_x loss_x 0.4731 (0.3310) acc_x 84.3750 (91.8750) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [10/27] time 0.345 (0.340) data 0.264 (0.262) loss_x loss_x 0.5176 (0.3894) acc_x 87.5000 (92.1875) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [15/27] time 0.370 (0.344) data 0.291 (0.265) loss_x loss_x 0.3276 (0.3451) acc_x 93.7500 (93.1250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/27] time 0.353 (0.347) data 0.273 (0.269) loss_x loss_x 0.1760 (0.3305) acc_x 100.0000 (93.5938) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/27] time 0.314 (0.345) data 0.236 (0.267) loss_x loss_x 0.8501 (0.3658) acc_x 78.1250 (92.7500) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.5386, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 879
clean true:870
clean false:9
clean_rate:0.9897610921501706
noisy true:498
noisy false:255
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 753
epoch [129/200] batch [5/27] time 0.448 (0.366) data 0.370 (0.288) loss_x loss_x 0.2698 (0.3312) acc_x 93.7500 (93.1250) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/27] time 0.350 (0.358) data 0.273 (0.280) loss_x loss_x 0.1949 (0.3368) acc_x 100.0000 (91.5625) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [15/27] time 0.363 (0.352) data 0.285 (0.274) loss_x loss_x 0.1179 (0.3168) acc_x 100.0000 (93.1250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [20/27] time 0.352 (0.351) data 0.274 (0.273) loss_x loss_x 0.3174 (0.3226) acc_x 93.7500 (93.2812) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/27] time 0.340 (0.351) data 0.262 (0.272) loss_x loss_x 0.3108 (0.3391) acc_x 93.7500 (92.7500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.5423, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 885
clean true:875
clean false:10
clean_rate:0.9887005649717514
noisy true:480
noisy false:267
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 747
epoch [130/200] batch [5/27] time 0.346 (0.348) data 0.268 (0.269) loss_x loss_x 0.4419 (0.4159) acc_x 93.7500 (91.8750) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [10/27] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.2213 (0.4417) acc_x 96.8750 (91.2500) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [15/27] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.3372 (0.3913) acc_x 90.6250 (92.0833) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/27] time 0.338 (0.343) data 0.260 (0.265) loss_x loss_x 0.4490 (0.3871) acc_x 81.2500 (91.0938) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/27] time 0.310 (0.341) data 0.231 (0.262) loss_x loss_x 0.3845 (0.3830) acc_x 90.6250 (90.8750) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.5429, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 886
clean true:877
clean false:9
clean_rate:0.989841986455982
noisy true:488
noisy false:258
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 746
epoch [131/200] batch [5/27] time 0.326 (0.345) data 0.247 (0.266) loss_x loss_x 0.2073 (0.3089) acc_x 96.8750 (95.0000) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [10/27] time 0.342 (0.342) data 0.264 (0.263) loss_x loss_x 0.3079 (0.3577) acc_x 93.7500 (91.5625) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [15/27] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.4395 (0.3794) acc_x 90.6250 (91.6667) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/27] time 0.354 (0.342) data 0.275 (0.263) loss_x loss_x 0.1472 (0.3599) acc_x 100.0000 (91.5625) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/27] time 0.333 (0.340) data 0.255 (0.261) loss_x loss_x 0.4409 (0.3628) acc_x 93.7500 (91.8750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:894
clean false:7
clean_rate:0.9922308546059934
noisy true:499
noisy false:232
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [132/200] batch [5/28] time 0.333 (0.340) data 0.254 (0.262) loss_x loss_x 0.4780 (0.4207) acc_x 90.6250 (90.6250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [10/28] time 0.343 (0.338) data 0.265 (0.260) loss_x loss_x 0.2671 (0.3900) acc_x 90.6250 (90.3125) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [15/28] time 0.304 (0.324) data 0.225 (0.246) loss_x loss_x 0.2303 (0.3586) acc_x 96.8750 (91.4583) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/28] time 0.331 (0.327) data 0.254 (0.248) loss_x loss_x 0.2391 (0.3558) acc_x 93.7500 (91.0938) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/28] time 0.349 (0.330) data 0.272 (0.252) loss_x loss_x 0.3562 (0.3727) acc_x 93.7500 (90.7500) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 221
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:907
clean false:7
clean_rate:0.9923413566739606
noisy true:504
noisy false:214
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [133/200] batch [5/28] time 0.339 (0.349) data 0.261 (0.271) loss_x loss_x 0.6201 (0.3870) acc_x 84.3750 (91.8750) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [10/28] time 0.321 (0.345) data 0.242 (0.267) loss_x loss_x 0.3784 (0.3920) acc_x 84.3750 (90.6250) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [15/28] time 0.339 (0.336) data 0.262 (0.258) loss_x loss_x 0.4749 (0.3868) acc_x 90.6250 (90.8333) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/28] time 0.323 (0.337) data 0.245 (0.258) loss_x loss_x 0.4500 (0.3849) acc_x 90.6250 (91.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/28] time 0.317 (0.337) data 0.238 (0.258) loss_x loss_x 0.5347 (0.3842) acc_x 84.3750 (90.8750) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:875
clean false:9
clean_rate:0.9898190045248869
noisy true:493
noisy false:255
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [134/200] batch [5/27] time 0.364 (0.350) data 0.285 (0.272) loss_x loss_x 0.3835 (0.3085) acc_x 87.5000 (95.0000) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/27] time 0.339 (0.347) data 0.261 (0.269) loss_x loss_x 0.3208 (0.3530) acc_x 87.5000 (92.1875) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [15/27] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.2866 (0.3193) acc_x 90.6250 (93.1250) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [20/27] time 0.330 (0.346) data 0.252 (0.268) loss_x loss_x 0.4248 (0.3562) acc_x 90.6250 (91.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/27] time 0.345 (0.344) data 0.266 (0.265) loss_x loss_x 0.3906 (0.3579) acc_x 87.5000 (91.0000) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.5411, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 883
clean true:876
clean false:7
clean_rate:0.9920724801812004
noisy true:489
noisy false:260
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 749
epoch [135/200] batch [5/27] time 0.330 (0.338) data 0.251 (0.260) loss_x loss_x 0.3445 (0.3983) acc_x 93.7500 (89.3750) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [10/27] time 0.335 (0.334) data 0.257 (0.256) loss_x loss_x 0.4734 (0.3948) acc_x 93.7500 (90.0000) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [15/27] time 0.344 (0.334) data 0.266 (0.256) loss_x loss_x 0.1318 (0.4166) acc_x 100.0000 (90.8333) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [20/27] time 0.301 (0.332) data 0.222 (0.254) loss_x loss_x 0.3254 (0.4001) acc_x 90.6250 (90.4688) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/27] time 0.304 (0.326) data 0.225 (0.247) loss_x loss_x 0.3074 (0.3948) acc_x 93.7500 (90.2500) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.5478, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 894
clean true:885
clean false:9
clean_rate:0.9899328859060402
noisy true:480
noisy false:258
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 738
epoch [136/200] batch [5/27] time 0.331 (0.346) data 0.253 (0.267) loss_x loss_x 0.4319 (0.3580) acc_x 84.3750 (89.3750) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [10/27] time 0.320 (0.340) data 0.242 (0.262) loss_x loss_x 0.2527 (0.3202) acc_x 93.7500 (92.1875) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [15/27] time 0.329 (0.337) data 0.251 (0.259) loss_x loss_x 0.4954 (0.3490) acc_x 87.5000 (91.2500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [20/27] time 0.309 (0.334) data 0.230 (0.256) loss_x loss_x 0.4858 (0.3538) acc_x 87.5000 (92.0312) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/27] time 0.348 (0.330) data 0.270 (0.251) loss_x loss_x 0.3340 (0.3619) acc_x 84.3750 (91.6250) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:885
clean false:6
clean_rate:0.9932659932659933
noisy true:500
noisy false:241
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [137/200] batch [5/27] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.8047 (0.4064) acc_x 87.5000 (90.0000) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [10/27] time 0.343 (0.342) data 0.265 (0.263) loss_x loss_x 0.6689 (0.4007) acc_x 87.5000 (90.9375) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [15/27] time 0.338 (0.339) data 0.259 (0.261) loss_x loss_x 0.4844 (0.4191) acc_x 87.5000 (89.7917) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [20/27] time 0.308 (0.340) data 0.229 (0.262) loss_x loss_x 0.1493 (0.4045) acc_x 96.8750 (90.0000) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/27] time 0.326 (0.334) data 0.247 (0.256) loss_x loss_x 0.3584 (0.4034) acc_x 87.5000 (90.1250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.5404, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 882
clean true:875
clean false:7
clean_rate:0.9920634920634921
noisy true:497
noisy false:253
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 750
epoch [138/200] batch [5/27] time 0.334 (0.342) data 0.256 (0.264) loss_x loss_x 0.3750 (0.3602) acc_x 90.6250 (91.2500) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [10/27] time 0.336 (0.340) data 0.258 (0.262) loss_x loss_x 0.6953 (0.3741) acc_x 87.5000 (91.5625) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [15/27] time 0.336 (0.336) data 0.258 (0.258) loss_x loss_x 0.3755 (0.3969) acc_x 93.7500 (90.8333) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [20/27] time 0.302 (0.330) data 0.223 (0.252) loss_x loss_x 0.3208 (0.3981) acc_x 90.6250 (90.7812) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/27] time 0.346 (0.326) data 0.268 (0.248) loss_x loss_x 0.2681 (0.3990) acc_x 96.8750 (91.0000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.5349, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 873
clean true:867
clean false:6
clean_rate:0.993127147766323
noisy true:495
noisy false:264
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 759
epoch [139/200] batch [5/27] time 0.329 (0.347) data 0.251 (0.269) loss_x loss_x 0.3193 (0.2546) acc_x 93.7500 (95.0000) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [10/27] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.1730 (0.2542) acc_x 96.8750 (95.3125) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [15/27] time 0.347 (0.341) data 0.270 (0.263) loss_x loss_x 0.3477 (0.3150) acc_x 90.6250 (92.7083) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/27] time 0.338 (0.341) data 0.259 (0.263) loss_x loss_x 0.1924 (0.2923) acc_x 96.8750 (93.5938) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/27] time 0.293 (0.336) data 0.214 (0.258) loss_x loss_x 0.5264 (0.2936) acc_x 90.6250 (93.6250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:886
clean false:6
clean_rate:0.9932735426008968
noisy true:487
noisy false:253
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [140/200] batch [5/27] time 0.344 (0.332) data 0.266 (0.254) loss_x loss_x 0.1880 (0.2452) acc_x 96.8750 (93.1250) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [10/27] time 0.355 (0.338) data 0.277 (0.260) loss_x loss_x 0.1813 (0.2843) acc_x 96.8750 (93.4375) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [15/27] time 0.352 (0.342) data 0.273 (0.263) loss_x loss_x 0.2764 (0.3004) acc_x 93.7500 (93.1250) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [20/27] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.6167 (0.3331) acc_x 84.3750 (92.9688) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/27] time 0.337 (0.341) data 0.258 (0.262) loss_x loss_x 0.3835 (0.3337) acc_x 93.7500 (92.6250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:890
clean false:6
clean_rate:0.9933035714285714
noisy true:495
noisy false:241
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [141/200] batch [5/28] time 0.348 (0.343) data 0.270 (0.264) loss_x loss_x 0.2000 (0.3957) acc_x 100.0000 (91.8750) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [10/28] time 0.310 (0.335) data 0.233 (0.257) loss_x loss_x 0.3062 (0.4063) acc_x 93.7500 (91.5625) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [15/28] time 0.345 (0.335) data 0.265 (0.257) loss_x loss_x 0.2808 (0.3869) acc_x 96.8750 (91.4583) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [20/28] time 0.349 (0.336) data 0.271 (0.258) loss_x loss_x 0.3210 (0.3804) acc_x 90.6250 (91.4062) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/28] time 0.354 (0.340) data 0.276 (0.261) loss_x loss_x 0.3621 (0.3775) acc_x 96.8750 (91.7500) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.5368, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 876
clean true:869
clean false:7
clean_rate:0.9920091324200914
noisy true:499
noisy false:257
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 756
epoch [142/200] batch [5/27] time 0.338 (0.354) data 0.260 (0.276) loss_x loss_x 0.3975 (0.3287) acc_x 90.6250 (91.2500) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [10/27] time 0.302 (0.339) data 0.223 (0.260) loss_x loss_x 0.2322 (0.3495) acc_x 93.7500 (90.6250) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [15/27] time 0.337 (0.330) data 0.260 (0.252) loss_x loss_x 0.2925 (0.3246) acc_x 93.7500 (91.4583) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/27] time 0.351 (0.335) data 0.273 (0.257) loss_x loss_x 0.4067 (0.3323) acc_x 93.7500 (91.5625) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/27] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.5947 (0.3679) acc_x 81.2500 (90.7500) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:893
clean false:5
clean_rate:0.9944320712694877
noisy true:501
noisy false:233
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [143/200] batch [5/28] time 0.315 (0.342) data 0.236 (0.263) loss_x loss_x 0.3123 (0.4362) acc_x 87.5000 (91.2500) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [10/28] time 0.326 (0.334) data 0.248 (0.256) loss_x loss_x 0.3643 (0.4092) acc_x 93.7500 (90.6250) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [15/28] time 0.347 (0.338) data 0.268 (0.259) loss_x loss_x 0.2069 (0.4108) acc_x 100.0000 (90.4167) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [20/28] time 0.339 (0.340) data 0.260 (0.262) loss_x loss_x 0.2842 (0.3812) acc_x 90.6250 (90.9375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/28] time 0.351 (0.342) data 0.274 (0.264) loss_x loss_x 0.4583 (0.3786) acc_x 90.6250 (90.7500) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:884
clean false:8
clean_rate:0.9910313901345291
noisy true:494
noisy false:246
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [144/200] batch [5/27] time 0.349 (0.347) data 0.270 (0.268) loss_x loss_x 0.3455 (0.2360) acc_x 84.3750 (94.3750) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [10/27] time 0.335 (0.341) data 0.257 (0.262) loss_x loss_x 0.4026 (0.2541) acc_x 93.7500 (94.0625) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [15/27] time 0.382 (0.343) data 0.304 (0.265) loss_x loss_x 0.7427 (0.3170) acc_x 81.2500 (92.0833) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [20/27] time 0.326 (0.343) data 0.248 (0.264) loss_x loss_x 0.3018 (0.3108) acc_x 90.6250 (92.6562) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/27] time 0.327 (0.341) data 0.249 (0.263) loss_x loss_x 0.3396 (0.3317) acc_x 93.7500 (92.0000) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.5441, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 888
clean true:880
clean false:8
clean_rate:0.990990990990991
noisy true:503
noisy false:241
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 744
epoch [145/200] batch [5/27] time 0.326 (0.336) data 0.248 (0.258) loss_x loss_x 0.1660 (0.3328) acc_x 100.0000 (92.5000) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [10/27] time 0.354 (0.342) data 0.275 (0.264) loss_x loss_x 0.3298 (0.3231) acc_x 84.3750 (91.8750) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [15/27] time 0.341 (0.341) data 0.263 (0.263) loss_x loss_x 0.3171 (0.3594) acc_x 90.6250 (90.2083) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/27] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.2898 (0.3580) acc_x 93.7500 (90.6250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/27] time 0.335 (0.343) data 0.257 (0.265) loss_x loss_x 0.3049 (0.3738) acc_x 93.7500 (90.1250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:898
clean false:5
clean_rate:0.9944629014396457
noisy true:490
noisy false:239
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [146/200] batch [5/28] time 0.357 (0.357) data 0.279 (0.279) loss_x loss_x 0.2140 (0.3649) acc_x 100.0000 (93.1250) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [10/28] time 0.333 (0.349) data 0.255 (0.271) loss_x loss_x 0.3262 (0.3963) acc_x 90.6250 (90.9375) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [15/28] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.4016 (0.3922) acc_x 87.5000 (91.0417) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/28] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.2461 (0.3886) acc_x 96.8750 (91.0938) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/28] time 0.353 (0.346) data 0.275 (0.268) loss_x loss_x 0.3315 (0.3851) acc_x 93.7500 (91.0000) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:894
clean false:4
clean_rate:0.9955456570155902
noisy true:500
noisy false:234
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [147/200] batch [5/28] time 0.332 (0.351) data 0.254 (0.273) loss_x loss_x 0.3154 (0.4083) acc_x 96.8750 (91.2500) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [10/28] time 0.334 (0.347) data 0.256 (0.269) loss_x loss_x 0.3687 (0.4010) acc_x 93.7500 (90.6250) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [15/28] time 0.382 (0.353) data 0.303 (0.274) loss_x loss_x 0.2164 (0.3671) acc_x 93.7500 (91.8750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [20/28] time 0.340 (0.353) data 0.261 (0.275) loss_x loss_x 0.2666 (0.3496) acc_x 93.7500 (92.5000) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/28] time 0.301 (0.346) data 0.222 (0.268) loss_x loss_x 0.3157 (0.3509) acc_x 93.7500 (92.3750) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:876
clean false:8
clean_rate:0.9909502262443439
noisy true:488
noisy false:260
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [148/200] batch [5/27] time 0.346 (0.342) data 0.268 (0.264) loss_x loss_x 0.3311 (0.3520) acc_x 90.6250 (90.6250) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [10/27] time 0.339 (0.345) data 0.262 (0.267) loss_x loss_x 0.2898 (0.3554) acc_x 100.0000 (93.1250) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [15/27] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.5688 (0.3689) acc_x 90.6250 (93.1250) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [20/27] time 0.320 (0.341) data 0.242 (0.263) loss_x loss_x 0.4167 (0.3511) acc_x 90.6250 (92.9688) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/27] time 0.335 (0.341) data 0.257 (0.263) loss_x loss_x 0.5029 (0.3570) acc_x 81.2500 (92.5000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:888
clean false:8
clean_rate:0.9910714285714286
noisy true:501
noisy false:235
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [149/200] batch [5/28] time 0.319 (0.339) data 0.241 (0.261) loss_x loss_x 0.4021 (0.3431) acc_x 87.5000 (92.5000) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [10/28] time 0.292 (0.328) data 0.214 (0.250) loss_x loss_x 0.4148 (0.3571) acc_x 93.7500 (92.1875) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [15/28] time 0.341 (0.328) data 0.263 (0.250) loss_x loss_x 0.3103 (0.3538) acc_x 93.7500 (92.9167) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [20/28] time 0.326 (0.327) data 0.248 (0.249) loss_x loss_x 0.2017 (0.3680) acc_x 100.0000 (92.6562) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/28] time 0.343 (0.329) data 0.265 (0.251) loss_x loss_x 0.3433 (0.3723) acc_x 87.5000 (92.3750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.5441, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 888
clean true:879
clean false:9
clean_rate:0.9898648648648649
noisy true:500
noisy false:244
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 744
epoch [150/200] batch [5/27] time 0.310 (0.328) data 0.232 (0.249) loss_x loss_x 0.2905 (0.2796) acc_x 93.7500 (93.7500) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [10/27] time 0.314 (0.329) data 0.235 (0.251) loss_x loss_x 0.2257 (0.3069) acc_x 93.7500 (93.1250) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [15/27] time 0.326 (0.331) data 0.248 (0.252) loss_x loss_x 0.2661 (0.3406) acc_x 96.8750 (92.0833) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/27] time 0.367 (0.336) data 0.289 (0.258) loss_x loss_x 0.3506 (0.3519) acc_x 90.6250 (92.0312) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/27] time 0.332 (0.336) data 0.254 (0.257) loss_x loss_x 0.2715 (0.3588) acc_x 96.8750 (91.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.5564, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 908
clean true:900
clean false:8
clean_rate:0.9911894273127754
noisy true:509
noisy false:215
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 724
epoch [151/200] batch [5/28] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.2417 (0.2837) acc_x 96.8750 (93.1250) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [10/28] time 0.333 (0.344) data 0.255 (0.265) loss_x loss_x 0.3108 (0.2915) acc_x 90.6250 (93.4375) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [15/28] time 0.358 (0.342) data 0.280 (0.264) loss_x loss_x 0.2308 (0.3407) acc_x 96.8750 (92.5000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/28] time 0.360 (0.342) data 0.283 (0.264) loss_x loss_x 0.2382 (0.3369) acc_x 93.7500 (92.5000) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/28] time 0.338 (0.342) data 0.260 (0.263) loss_x loss_x 0.5107 (0.3566) acc_x 87.5000 (91.8750) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:896
clean false:7
clean_rate:0.9922480620155039
noisy true:507
noisy false:222
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [152/200] batch [5/28] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.2612 (0.3423) acc_x 93.7500 (93.1250) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [10/28] time 0.338 (0.348) data 0.258 (0.270) loss_x loss_x 0.2947 (0.3695) acc_x 96.8750 (91.8750) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [15/28] time 0.343 (0.346) data 0.264 (0.268) loss_x loss_x 0.4441 (0.3997) acc_x 90.6250 (90.2083) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/28] time 0.348 (0.348) data 0.270 (0.269) loss_x loss_x 0.2639 (0.3779) acc_x 96.8750 (91.4062) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/28] time 0.371 (0.346) data 0.293 (0.268) loss_x loss_x 0.3447 (0.3596) acc_x 93.7500 (92.2500) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:885
clean false:7
clean_rate:0.992152466367713
noisy true:491
noisy false:249
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [153/200] batch [5/27] time 0.337 (0.347) data 0.259 (0.269) loss_x loss_x 0.2363 (0.3348) acc_x 96.8750 (93.7500) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [10/27] time 0.328 (0.338) data 0.249 (0.259) loss_x loss_x 0.1407 (0.3440) acc_x 100.0000 (93.4375) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [15/27] time 0.334 (0.331) data 0.256 (0.252) loss_x loss_x 0.3582 (0.3240) acc_x 93.7500 (93.9583) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/27] time 0.303 (0.329) data 0.225 (0.250) loss_x loss_x 0.4832 (0.3119) acc_x 87.5000 (94.2188) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/27] time 0.349 (0.333) data 0.272 (0.254) loss_x loss_x 0.4878 (0.3100) acc_x 84.3750 (94.1250) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:902
clean false:5
clean_rate:0.9944873208379272
noisy true:497
noisy false:228
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [154/200] batch [5/28] time 0.339 (0.347) data 0.260 (0.268) loss_x loss_x 0.7046 (0.4490) acc_x 71.8750 (84.3750) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [10/28] time 0.344 (0.346) data 0.266 (0.267) loss_x loss_x 0.3601 (0.3846) acc_x 96.8750 (88.1250) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [15/28] time 0.338 (0.345) data 0.260 (0.266) loss_x loss_x 0.1937 (0.3739) acc_x 96.8750 (89.5833) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [20/28] time 0.343 (0.345) data 0.264 (0.266) loss_x loss_x 0.4053 (0.3817) acc_x 84.3750 (89.8438) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/28] time 0.349 (0.346) data 0.271 (0.267) loss_x loss_x 0.2590 (0.3584) acc_x 96.8750 (90.7500) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:883
clean false:8
clean_rate:0.9910213243546577
noisy true:481
noisy false:260
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [155/200] batch [5/27] time 0.356 (0.349) data 0.278 (0.271) loss_x loss_x 0.3494 (0.3889) acc_x 90.6250 (91.2500) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [10/27] time 0.335 (0.350) data 0.257 (0.272) loss_x loss_x 0.3777 (0.3686) acc_x 93.7500 (91.8750) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [15/27] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.5576 (0.3762) acc_x 84.3750 (91.4583) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/27] time 0.367 (0.350) data 0.289 (0.271) loss_x loss_x 0.5732 (0.4043) acc_x 84.3750 (90.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/27] time 0.347 (0.349) data 0.269 (0.271) loss_x loss_x 0.1421 (0.4090) acc_x 100.0000 (90.2500) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:896
clean false:6
clean_rate:0.9933481152993349
noisy true:510
noisy false:220
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [156/200] batch [5/28] time 0.335 (0.342) data 0.257 (0.264) loss_x loss_x 0.1630 (0.3065) acc_x 96.8750 (92.5000) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/28] time 0.338 (0.347) data 0.260 (0.268) loss_x loss_x 0.2644 (0.2825) acc_x 93.7500 (93.7500) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [15/28] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.7026 (0.2988) acc_x 84.3750 (93.9583) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [20/28] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.3464 (0.3406) acc_x 90.6250 (92.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/28] time 0.347 (0.345) data 0.269 (0.267) loss_x loss_x 0.2568 (0.3256) acc_x 93.7500 (92.6250) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:899
clean false:4
clean_rate:0.9955703211517165
noisy true:498
noisy false:231
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [157/200] batch [5/28] time 0.355 (0.357) data 0.276 (0.278) loss_x loss_x 0.2981 (0.2526) acc_x 90.6250 (93.1250) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [10/28] time 0.346 (0.351) data 0.268 (0.272) loss_x loss_x 0.3276 (0.3526) acc_x 93.7500 (91.8750) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [15/28] time 0.343 (0.346) data 0.265 (0.268) loss_x loss_x 0.4548 (0.3865) acc_x 87.5000 (90.2083) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [20/28] time 0.353 (0.347) data 0.273 (0.268) loss_x loss_x 0.3750 (0.3766) acc_x 90.6250 (90.6250) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/28] time 0.337 (0.345) data 0.258 (0.267) loss_x loss_x 0.2600 (0.3581) acc_x 96.8750 (91.2500) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:876
clean false:8
clean_rate:0.9909502262443439
noisy true:491
noisy false:257
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [158/200] batch [5/27] time 0.358 (0.353) data 0.280 (0.275) loss_x loss_x 0.1222 (0.3342) acc_x 96.8750 (92.5000) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/27] time 0.354 (0.352) data 0.277 (0.274) loss_x loss_x 0.3367 (0.3450) acc_x 93.7500 (92.5000) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/27] time 0.323 (0.347) data 0.244 (0.269) loss_x loss_x 0.2465 (0.3386) acc_x 96.8750 (92.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/27] time 0.308 (0.337) data 0.229 (0.259) loss_x loss_x 0.4949 (0.3574) acc_x 84.3750 (91.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/27] time 0.349 (0.336) data 0.271 (0.257) loss_x loss_x 0.5732 (0.3871) acc_x 87.5000 (91.0000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5515, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 900
clean true:889
clean false:11
clean_rate:0.9877777777777778
noisy true:512
noisy false:220
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 732
epoch [159/200] batch [5/28] time 0.344 (0.350) data 0.266 (0.272) loss_x loss_x 0.3252 (0.4542) acc_x 84.3750 (86.2500) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [10/28] time 0.336 (0.345) data 0.257 (0.267) loss_x loss_x 0.2588 (0.4371) acc_x 93.7500 (87.8125) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [15/28] time 0.296 (0.341) data 0.218 (0.263) loss_x loss_x 0.3745 (0.3899) acc_x 93.7500 (90.4167) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/28] time 0.336 (0.336) data 0.258 (0.257) loss_x loss_x 0.3875 (0.3859) acc_x 90.6250 (90.6250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/28] time 0.344 (0.336) data 0.266 (0.258) loss_x loss_x 0.5039 (0.4049) acc_x 87.5000 (90.1250) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.5423, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 885
clean true:880
clean false:5
clean_rate:0.9943502824858758
noisy true:493
noisy false:254
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 747
epoch [160/200] batch [5/27] time 0.345 (0.344) data 0.266 (0.265) loss_x loss_x 0.2817 (0.3698) acc_x 90.6250 (91.2500) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [10/27] time 0.306 (0.333) data 0.228 (0.254) loss_x loss_x 0.3113 (0.3155) acc_x 90.6250 (92.5000) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [15/27] time 0.326 (0.326) data 0.248 (0.247) loss_x loss_x 0.3738 (0.3078) acc_x 90.6250 (93.3333) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/27] time 0.349 (0.330) data 0.270 (0.252) loss_x loss_x 0.3787 (0.3401) acc_x 93.7500 (92.3438) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/27] time 0.378 (0.336) data 0.300 (0.257) loss_x loss_x 0.3706 (0.3298) acc_x 90.6250 (93.0000) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:892
clean false:4
clean_rate:0.9955357142857143
noisy true:502
noisy false:234
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [161/200] batch [5/28] time 0.320 (0.353) data 0.241 (0.274) loss_x loss_x 0.2737 (0.3259) acc_x 93.7500 (92.5000) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [10/28] time 0.366 (0.355) data 0.286 (0.276) loss_x loss_x 0.2397 (0.2521) acc_x 96.8750 (95.0000) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [15/28] time 0.321 (0.350) data 0.242 (0.271) loss_x loss_x 0.4980 (0.2635) acc_x 90.6250 (95.4167) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [20/28] time 0.324 (0.344) data 0.245 (0.265) loss_x loss_x 0.2969 (0.2733) acc_x 93.7500 (94.5312) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/28] time 0.348 (0.342) data 0.269 (0.263) loss_x loss_x 0.4771 (0.2948) acc_x 93.7500 (94.3750) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:903
clean false:6
clean_rate:0.9933993399339934
noisy true:506
noisy false:217
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [162/200] batch [5/28] time 0.303 (0.339) data 0.224 (0.261) loss_x loss_x 0.2717 (0.2700) acc_x 96.8750 (94.3750) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [10/28] time 0.298 (0.319) data 0.219 (0.240) loss_x loss_x 0.4048 (0.3194) acc_x 90.6250 (93.4375) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [15/28] time 0.335 (0.323) data 0.257 (0.245) loss_x loss_x 0.2983 (0.3082) acc_x 96.8750 (94.1667) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [20/28] time 0.345 (0.328) data 0.267 (0.250) loss_x loss_x 0.3933 (0.3182) acc_x 87.5000 (93.1250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/28] time 0.337 (0.330) data 0.259 (0.252) loss_x loss_x 0.2537 (0.3141) acc_x 96.8750 (93.1250) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.5515, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 900
clean true:896
clean false:4
clean_rate:0.9955555555555555
noisy true:509
noisy false:223
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 732
epoch [163/200] batch [5/28] time 0.343 (0.341) data 0.264 (0.262) loss_x loss_x 0.3142 (0.4627) acc_x 93.7500 (91.2500) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [10/28] time 0.347 (0.345) data 0.269 (0.266) loss_x loss_x 0.2734 (0.4244) acc_x 96.8750 (91.2500) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [15/28] time 0.341 (0.345) data 0.263 (0.266) loss_x loss_x 0.2542 (0.3908) acc_x 93.7500 (91.4583) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [20/28] time 0.344 (0.346) data 0.266 (0.267) loss_x loss_x 0.2671 (0.3669) acc_x 93.7500 (92.1875) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/28] time 0.346 (0.346) data 0.267 (0.268) loss_x loss_x 0.3301 (0.3561) acc_x 87.5000 (92.0000) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:901
clean false:6
clean_rate:0.9933847850055126
noisy true:505
noisy false:220
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [164/200] batch [5/28] time 0.344 (0.352) data 0.266 (0.274) loss_x loss_x 0.2136 (0.2917) acc_x 90.6250 (92.5000) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [10/28] time 0.345 (0.346) data 0.266 (0.267) loss_x loss_x 0.5625 (0.3414) acc_x 90.6250 (91.8750) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/28] time 0.355 (0.350) data 0.276 (0.272) loss_x loss_x 0.1439 (0.3214) acc_x 96.8750 (92.5000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [20/28] time 0.359 (0.350) data 0.281 (0.271) loss_x loss_x 0.3103 (0.3307) acc_x 90.6250 (91.7188) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/28] time 0.336 (0.350) data 0.258 (0.271) loss_x loss_x 0.2900 (0.3370) acc_x 96.8750 (92.0000) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.5472, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 893
clean true:889
clean false:4
clean_rate:0.9955207166853304
noisy true:500
noisy false:239
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 739
epoch [165/200] batch [5/27] time 0.294 (0.332) data 0.215 (0.254) loss_x loss_x 0.3184 (0.5060) acc_x 90.6250 (88.1250) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [10/27] time 0.360 (0.329) data 0.281 (0.250) loss_x loss_x 0.0989 (0.3564) acc_x 100.0000 (91.8750) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [15/27] time 0.353 (0.334) data 0.275 (0.256) loss_x loss_x 0.2249 (0.3643) acc_x 96.8750 (92.0833) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/27] time 0.299 (0.333) data 0.221 (0.255) loss_x loss_x 0.5864 (0.3611) acc_x 90.6250 (92.1875) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/27] time 0.298 (0.326) data 0.221 (0.248) loss_x loss_x 0.5757 (0.3688) acc_x 87.5000 (92.0000) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:905
clean false:6
clean_rate:0.9934138309549945
noisy true:505
noisy false:216
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [166/200] batch [5/28] time 0.349 (0.338) data 0.271 (0.259) loss_x loss_x 0.3716 (0.3211) acc_x 87.5000 (91.8750) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [10/28] time 0.314 (0.325) data 0.234 (0.247) loss_x loss_x 0.4517 (0.3406) acc_x 93.7500 (93.1250) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [15/28] time 0.310 (0.328) data 0.233 (0.250) loss_x loss_x 0.4138 (0.3283) acc_x 93.7500 (93.5417) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [20/28] time 0.304 (0.322) data 0.226 (0.244) loss_x loss_x 0.1887 (0.3290) acc_x 96.8750 (92.9688) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/28] time 0.300 (0.318) data 0.222 (0.240) loss_x loss_x 0.3892 (0.3336) acc_x 93.7500 (92.8750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:898
clean false:6
clean_rate:0.9933628318584071
noisy true:498
noisy false:230
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [167/200] batch [5/28] time 0.324 (0.340) data 0.245 (0.261) loss_x loss_x 0.3042 (0.2716) acc_x 90.6250 (93.7500) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [10/28] time 0.343 (0.330) data 0.264 (0.251) loss_x loss_x 0.3726 (0.3169) acc_x 90.6250 (93.1250) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [15/28] time 0.302 (0.331) data 0.224 (0.252) loss_x loss_x 0.1862 (0.2979) acc_x 93.7500 (93.5417) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [20/28] time 0.302 (0.326) data 0.225 (0.248) loss_x loss_x 0.3276 (0.3136) acc_x 93.7500 (92.9688) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/28] time 0.347 (0.329) data 0.269 (0.251) loss_x loss_x 0.2656 (0.3311) acc_x 96.8750 (92.6250) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:897
clean false:6
clean_rate:0.9933554817275747
noisy true:499
noisy false:230
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [168/200] batch [5/28] time 0.296 (0.304) data 0.219 (0.226) loss_x loss_x 0.3818 (0.3955) acc_x 90.6250 (91.2500) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/28] time 0.303 (0.303) data 0.224 (0.224) loss_x loss_x 0.0907 (0.3558) acc_x 100.0000 (93.1250) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [15/28] time 0.304 (0.302) data 0.226 (0.224) loss_x loss_x 0.2101 (0.3592) acc_x 96.8750 (92.5000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/28] time 0.347 (0.309) data 0.269 (0.231) loss_x loss_x 0.3298 (0.3361) acc_x 93.7500 (92.8125) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/28] time 0.350 (0.317) data 0.272 (0.239) loss_x loss_x 0.7822 (0.3492) acc_x 81.2500 (92.3750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:895
clean false:6
clean_rate:0.9933407325194229
noisy true:503
noisy false:228
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [169/200] batch [5/28] time 0.297 (0.304) data 0.220 (0.226) loss_x loss_x 0.2291 (0.2559) acc_x 96.8750 (95.0000) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/28] time 0.306 (0.303) data 0.228 (0.225) loss_x loss_x 0.2600 (0.3528) acc_x 93.7500 (92.5000) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [15/28] time 0.342 (0.317) data 0.265 (0.239) loss_x loss_x 0.2571 (0.3377) acc_x 96.8750 (92.7083) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/28] time 0.342 (0.322) data 0.263 (0.244) loss_x loss_x 0.4421 (0.3250) acc_x 87.5000 (92.8125) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/28] time 0.345 (0.326) data 0.266 (0.248) loss_x loss_x 0.7471 (0.3416) acc_x 81.2500 (92.5000) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:907
clean false:4
clean_rate:0.995609220636663
noisy true:510
noisy false:211
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [170/200] batch [5/28] time 0.333 (0.335) data 0.255 (0.256) loss_x loss_x 0.4058 (0.3178) acc_x 87.5000 (93.1250) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [10/28] time 0.347 (0.336) data 0.269 (0.258) loss_x loss_x 0.3918 (0.3481) acc_x 87.5000 (91.8750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [15/28] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.3442 (0.3190) acc_x 93.7500 (93.3333) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [20/28] time 0.356 (0.342) data 0.278 (0.264) loss_x loss_x 0.3918 (0.3119) acc_x 90.6250 (92.9688) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/28] time 0.354 (0.343) data 0.276 (0.265) loss_x loss_x 0.2308 (0.3120) acc_x 96.8750 (93.0000) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:899
clean false:6
clean_rate:0.9933701657458563
noisy true:499
noisy false:228
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [171/200] batch [5/28] time 0.301 (0.318) data 0.223 (0.241) loss_x loss_x 0.6035 (0.3568) acc_x 84.3750 (90.0000) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [10/28] time 0.291 (0.308) data 0.214 (0.231) loss_x loss_x 0.1464 (0.3284) acc_x 100.0000 (92.1875) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [15/28] time 0.288 (0.303) data 0.210 (0.226) loss_x loss_x 0.1768 (0.3161) acc_x 93.7500 (93.3333) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/28] time 0.293 (0.301) data 0.215 (0.223) loss_x loss_x 0.4114 (0.3243) acc_x 90.6250 (92.6562) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/28] time 0.294 (0.300) data 0.216 (0.222) loss_x loss_x 0.4771 (0.3348) acc_x 90.6250 (92.5000) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:899
clean false:6
clean_rate:0.9933701657458563
noisy true:511
noisy false:216
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [172/200] batch [5/28] time 0.297 (0.314) data 0.219 (0.235) loss_x loss_x 0.5229 (0.3142) acc_x 84.3750 (91.2500) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [10/28] time 0.318 (0.319) data 0.240 (0.240) loss_x loss_x 0.2913 (0.2812) acc_x 93.7500 (93.1250) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [15/28] time 0.296 (0.319) data 0.219 (0.241) loss_x loss_x 0.4741 (0.3118) acc_x 90.6250 (92.7083) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/28] time 0.307 (0.315) data 0.229 (0.236) loss_x loss_x 0.2935 (0.3179) acc_x 90.6250 (92.3438) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/28] time 0.354 (0.317) data 0.276 (0.239) loss_x loss_x 0.2200 (0.3090) acc_x 96.8750 (92.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:888
clean false:4
clean_rate:0.9955156950672646
noisy true:500
noisy false:240
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [173/200] batch [5/27] time 0.346 (0.343) data 0.268 (0.265) loss_x loss_x 0.2747 (0.3320) acc_x 90.6250 (92.5000) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [10/27] time 0.297 (0.324) data 0.219 (0.246) loss_x loss_x 0.4736 (0.3629) acc_x 90.6250 (91.5625) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [15/27] time 0.296 (0.316) data 0.218 (0.238) loss_x loss_x 0.2551 (0.3530) acc_x 93.7500 (91.4583) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/27] time 0.319 (0.311) data 0.240 (0.233) loss_x loss_x 0.3081 (0.3419) acc_x 90.6250 (92.1875) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/27] time 0.299 (0.309) data 0.222 (0.231) loss_x loss_x 0.3638 (0.3548) acc_x 93.7500 (91.8750) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:906
clean false:5
clean_rate:0.9945115257958288
noisy true:513
noisy false:208
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [174/200] batch [5/28] time 0.293 (0.298) data 0.215 (0.220) loss_x loss_x 0.3423 (0.3609) acc_x 90.6250 (91.2500) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/28] time 0.334 (0.303) data 0.257 (0.225) loss_x loss_x 0.3289 (0.3721) acc_x 87.5000 (90.6250) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [15/28] time 0.305 (0.302) data 0.226 (0.224) loss_x loss_x 0.2155 (0.3256) acc_x 96.8750 (92.5000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/28] time 0.288 (0.302) data 0.211 (0.224) loss_x loss_x 0.3262 (0.3263) acc_x 90.6250 (91.8750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/28] time 0.299 (0.302) data 0.221 (0.224) loss_x loss_x 0.2307 (0.3295) acc_x 96.8750 (92.5000) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:904
clean false:5
clean_rate:0.9944994499449945
noisy true:516
noisy false:207
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [175/200] batch [5/28] time 0.298 (0.304) data 0.220 (0.226) loss_x loss_x 0.2468 (0.3986) acc_x 96.8750 (91.8750) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [10/28] time 0.300 (0.302) data 0.221 (0.224) loss_x loss_x 0.3496 (0.4305) acc_x 93.7500 (90.9375) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [15/28] time 0.298 (0.302) data 0.220 (0.223) loss_x loss_x 0.1992 (0.3556) acc_x 96.8750 (93.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/28] time 0.297 (0.300) data 0.219 (0.222) loss_x loss_x 0.4148 (0.3802) acc_x 87.5000 (92.1875) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/28] time 0.341 (0.307) data 0.262 (0.229) loss_x loss_x 0.3147 (0.3643) acc_x 93.7500 (92.7500) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:895
clean false:7
clean_rate:0.9922394678492239
noisy true:483
noisy false:247
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [176/200] batch [5/28] time 0.345 (0.302) data 0.268 (0.224) loss_x loss_x 0.3108 (0.3159) acc_x 96.8750 (94.3750) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [10/28] time 0.309 (0.300) data 0.231 (0.222) loss_x loss_x 0.2368 (0.2932) acc_x 96.8750 (95.0000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [15/28] time 0.285 (0.299) data 0.207 (0.221) loss_x loss_x 0.2644 (0.3241) acc_x 90.6250 (93.9583) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/28] time 0.294 (0.298) data 0.216 (0.220) loss_x loss_x 0.4810 (0.3395) acc_x 84.3750 (92.8125) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/28] time 0.295 (0.298) data 0.216 (0.220) loss_x loss_x 0.3921 (0.3258) acc_x 93.7500 (93.2500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:886
clean false:6
clean_rate:0.9932735426008968
noisy true:505
noisy false:235
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [177/200] batch [5/27] time 0.302 (0.305) data 0.224 (0.226) loss_x loss_x 0.3120 (0.2198) acc_x 96.8750 (96.2500) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [10/27] time 0.289 (0.302) data 0.210 (0.223) loss_x loss_x 0.8291 (0.3155) acc_x 78.1250 (92.8125) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [15/27] time 0.299 (0.298) data 0.220 (0.219) loss_x loss_x 0.1421 (0.2937) acc_x 100.0000 (93.9583) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/27] time 0.294 (0.298) data 0.216 (0.219) loss_x loss_x 0.3455 (0.3026) acc_x 90.6250 (93.4375) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/27] time 0.290 (0.297) data 0.212 (0.219) loss_x loss_x 0.2000 (0.3046) acc_x 90.6250 (92.8750) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:892
clean false:4
clean_rate:0.9955357142857143
noisy true:504
noisy false:232
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [178/200] batch [5/28] time 0.290 (0.293) data 0.213 (0.215) loss_x loss_x 0.3752 (0.3141) acc_x 93.7500 (93.7500) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [10/28] time 0.283 (0.292) data 0.204 (0.214) loss_x loss_x 0.6367 (0.3456) acc_x 90.6250 (93.7500) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [15/28] time 0.295 (0.294) data 0.217 (0.216) loss_x loss_x 0.3606 (0.3742) acc_x 90.6250 (91.8750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/28] time 0.292 (0.294) data 0.214 (0.216) loss_x loss_x 0.7944 (0.3878) acc_x 84.3750 (91.4062) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/28] time 0.295 (0.295) data 0.217 (0.217) loss_x loss_x 0.1350 (0.3621) acc_x 100.0000 (92.2500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:896
clean false:5
clean_rate:0.9944506104328524
noisy true:503
noisy false:228
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [179/200] batch [5/28] time 0.293 (0.302) data 0.214 (0.223) loss_x loss_x 0.3264 (0.3186) acc_x 90.6250 (92.5000) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [10/28] time 0.286 (0.296) data 0.207 (0.217) loss_x loss_x 0.1805 (0.2503) acc_x 96.8750 (94.6875) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [15/28] time 0.305 (0.297) data 0.227 (0.219) loss_x loss_x 0.4082 (0.2722) acc_x 93.7500 (94.1667) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/28] time 0.290 (0.297) data 0.212 (0.218) loss_x loss_x 0.2881 (0.2812) acc_x 90.6250 (93.5938) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/28] time 0.301 (0.296) data 0.222 (0.218) loss_x loss_x 0.1340 (0.2860) acc_x 100.0000 (94.0000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:900
clean false:4
clean_rate:0.995575221238938
noisy true:498
noisy false:230
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [180/200] batch [5/28] time 0.294 (0.293) data 0.216 (0.214) loss_x loss_x 0.2317 (0.1836) acc_x 100.0000 (98.1250) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/28] time 0.290 (0.294) data 0.212 (0.216) loss_x loss_x 0.4995 (0.2527) acc_x 87.5000 (95.3125) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [15/28] time 0.289 (0.293) data 0.211 (0.215) loss_x loss_x 0.2192 (0.2645) acc_x 93.7500 (95.2083) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/28] time 0.286 (0.293) data 0.208 (0.214) loss_x loss_x 0.3479 (0.2721) acc_x 90.6250 (94.5312) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/28] time 0.298 (0.293) data 0.219 (0.214) loss_x loss_x 0.3066 (0.2934) acc_x 93.7500 (93.8750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:902
clean false:7
clean_rate:0.9922992299229924
noisy true:493
noisy false:230
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [181/200] batch [5/28] time 0.308 (0.297) data 0.229 (0.219) loss_x loss_x 0.2067 (0.4022) acc_x 93.7500 (88.7500) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [10/28] time 0.289 (0.294) data 0.209 (0.215) loss_x loss_x 0.2483 (0.3249) acc_x 100.0000 (92.8125) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [15/28] time 0.300 (0.295) data 0.222 (0.217) loss_x loss_x 0.2942 (0.3201) acc_x 87.5000 (92.5000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/28] time 0.298 (0.297) data 0.220 (0.219) loss_x loss_x 0.5771 (0.3397) acc_x 84.3750 (92.0312) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/28] time 0.298 (0.297) data 0.219 (0.219) loss_x loss_x 0.3379 (0.3651) acc_x 90.6250 (91.2500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:892
clean false:10
clean_rate:0.9889135254988913
noisy true:505
noisy false:225
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [182/200] batch [5/28] time 0.300 (0.294) data 0.221 (0.215) loss_x loss_x 0.2211 (0.3152) acc_x 93.7500 (92.5000) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [10/28] time 0.297 (0.293) data 0.219 (0.215) loss_x loss_x 0.2979 (0.2755) acc_x 90.6250 (93.1250) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [15/28] time 0.298 (0.294) data 0.220 (0.215) loss_x loss_x 0.3206 (0.2805) acc_x 90.6250 (93.1250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/28] time 0.284 (0.293) data 0.205 (0.214) loss_x loss_x 0.7827 (0.3196) acc_x 84.3750 (92.1875) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/28] time 0.285 (0.294) data 0.207 (0.215) loss_x loss_x 0.1250 (0.3173) acc_x 96.8750 (92.1250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:899
clean false:6
clean_rate:0.9933701657458563
noisy true:502
noisy false:225
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [183/200] batch [5/28] time 0.290 (0.295) data 0.210 (0.216) loss_x loss_x 0.3149 (0.3494) acc_x 93.7500 (91.8750) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [10/28] time 0.295 (0.295) data 0.217 (0.216) loss_x loss_x 0.4954 (0.3800) acc_x 84.3750 (91.2500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [15/28] time 0.304 (0.296) data 0.225 (0.218) loss_x loss_x 0.2416 (0.3718) acc_x 93.7500 (91.0417) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/28] time 0.300 (0.298) data 0.221 (0.219) loss_x loss_x 0.3838 (0.3686) acc_x 93.7500 (90.7812) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/28] time 0.296 (0.297) data 0.218 (0.219) loss_x loss_x 0.2340 (0.3595) acc_x 96.8750 (91.2500) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5564, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 908
clean true:903
clean false:5
clean_rate:0.9944933920704846
noisy true:493
noisy false:231
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 724
epoch [184/200] batch [5/28] time 0.298 (0.300) data 0.220 (0.223) loss_x loss_x 0.2825 (0.3989) acc_x 93.7500 (90.6250) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [10/28] time 0.298 (0.298) data 0.219 (0.220) loss_x loss_x 0.3340 (0.3539) acc_x 84.3750 (90.9375) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [15/28] time 0.285 (0.295) data 0.207 (0.217) loss_x loss_x 0.5015 (0.3703) acc_x 96.8750 (91.0417) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/28] time 0.290 (0.294) data 0.212 (0.216) loss_x loss_x 0.4150 (0.3609) acc_x 87.5000 (91.0938) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/28] time 0.300 (0.295) data 0.222 (0.216) loss_x loss_x 0.7183 (0.3698) acc_x 87.5000 (91.1250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:906
clean false:4
clean_rate:0.9956043956043956
noisy true:507
noisy false:215
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [185/200] batch [5/28] time 0.288 (0.297) data 0.209 (0.219) loss_x loss_x 0.2510 (0.2747) acc_x 93.7500 (93.7500) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [10/28] time 0.292 (0.296) data 0.213 (0.217) loss_x loss_x 0.3743 (0.3335) acc_x 93.7500 (92.8125) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [15/28] time 0.301 (0.296) data 0.222 (0.217) loss_x loss_x 0.1635 (0.3333) acc_x 93.7500 (92.9167) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/28] time 0.297 (0.296) data 0.218 (0.217) loss_x loss_x 0.3320 (0.3454) acc_x 96.8750 (92.9688) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/28] time 0.294 (0.294) data 0.215 (0.216) loss_x loss_x 0.3640 (0.3507) acc_x 87.5000 (92.3750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:923
clean false:5
clean_rate:0.9946120689655172
noisy true:507
noisy false:197
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [186/200] batch [5/29] time 0.299 (0.296) data 0.220 (0.216) loss_x loss_x 0.3381 (0.3402) acc_x 93.7500 (93.1250) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [10/29] time 0.293 (0.295) data 0.215 (0.216) loss_x loss_x 0.2808 (0.3063) acc_x 93.7500 (94.0625) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [15/29] time 0.294 (0.294) data 0.216 (0.215) loss_x loss_x 0.2515 (0.3040) acc_x 96.8750 (93.5417) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [20/29] time 0.297 (0.293) data 0.219 (0.215) loss_x loss_x 0.1910 (0.3158) acc_x 100.0000 (93.1250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/29] time 0.299 (0.294) data 0.220 (0.215) loss_x loss_x 0.2125 (0.3296) acc_x 96.8750 (92.6250) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 913
clean true:907
clean false:6
clean_rate:0.9934282584884995
noisy true:500
noisy false:219
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 719
epoch [187/200] batch [5/28] time 0.295 (0.296) data 0.217 (0.218) loss_x loss_x 0.2810 (0.2883) acc_x 96.8750 (92.5000) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [10/28] time 0.309 (0.297) data 0.231 (0.219) loss_x loss_x 0.4360 (0.2867) acc_x 93.7500 (93.4375) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [15/28] time 0.287 (0.297) data 0.208 (0.219) loss_x loss_x 0.5205 (0.3125) acc_x 90.6250 (92.7083) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/28] time 0.291 (0.295) data 0.213 (0.217) loss_x loss_x 0.2632 (0.3236) acc_x 96.8750 (92.5000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/28] time 0.282 (0.295) data 0.204 (0.217) loss_x loss_x 0.5723 (0.3145) acc_x 84.3750 (92.6250) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 917
clean true:907
clean false:10
clean_rate:0.9890948745910578
noisy true:497
noisy false:218
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 715
epoch [188/200] batch [5/28] time 0.307 (0.302) data 0.228 (0.223) loss_x loss_x 0.8276 (0.4598) acc_x 84.3750 (88.7500) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [10/28] time 0.295 (0.300) data 0.216 (0.221) loss_x loss_x 0.3430 (0.4218) acc_x 90.6250 (89.0625) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [15/28] time 0.288 (0.301) data 0.209 (0.222) loss_x loss_x 0.5850 (0.4084) acc_x 84.3750 (89.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/28] time 0.300 (0.300) data 0.221 (0.221) loss_x loss_x 0.2224 (0.3992) acc_x 93.7500 (89.6875) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/28] time 0.303 (0.299) data 0.224 (0.220) loss_x loss_x 0.5029 (0.4063) acc_x 87.5000 (89.2500) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:891
clean false:8
clean_rate:0.9911012235817576
noisy true:500
noisy false:233
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [189/200] batch [5/28] time 0.295 (0.286) data 0.216 (0.207) loss_x loss_x 0.3230 (0.3302) acc_x 90.6250 (91.8750) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [10/28] time 0.296 (0.291) data 0.217 (0.212) loss_x loss_x 0.2018 (0.2703) acc_x 100.0000 (94.3750) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [15/28] time 0.298 (0.294) data 0.220 (0.215) loss_x loss_x 0.4670 (0.3334) acc_x 93.7500 (93.1250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/28] time 0.299 (0.295) data 0.220 (0.216) loss_x loss_x 0.6069 (0.3557) acc_x 87.5000 (92.9688) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/28] time 0.307 (0.296) data 0.228 (0.218) loss_x loss_x 0.3179 (0.3677) acc_x 93.7500 (92.2500) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:897
clean false:6
clean_rate:0.9933554817275747
noisy true:506
noisy false:223
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [190/200] batch [5/28] time 0.289 (0.285) data 0.211 (0.206) loss_x loss_x 0.2803 (0.2811) acc_x 93.7500 (94.3750) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/28] time 0.278 (0.283) data 0.200 (0.205) loss_x loss_x 0.4531 (0.3552) acc_x 87.5000 (92.8125) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [15/28] time 0.277 (0.283) data 0.199 (0.204) loss_x loss_x 0.3032 (0.3794) acc_x 90.6250 (91.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/28] time 0.283 (0.283) data 0.205 (0.204) loss_x loss_x 0.3362 (0.3729) acc_x 90.6250 (91.8750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/28] time 0.275 (0.282) data 0.196 (0.204) loss_x loss_x 0.4702 (0.3633) acc_x 84.3750 (91.8750) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:902
clean false:5
clean_rate:0.9944873208379272
noisy true:489
noisy false:236
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [191/200] batch [5/28] time 0.290 (0.290) data 0.211 (0.211) loss_x loss_x 0.3572 (0.4557) acc_x 90.6250 (91.8750) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [10/28] time 0.284 (0.286) data 0.206 (0.208) loss_x loss_x 0.2350 (0.3943) acc_x 96.8750 (93.1250) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [15/28] time 0.290 (0.286) data 0.212 (0.207) loss_x loss_x 0.4365 (0.3748) acc_x 90.6250 (92.9167) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/28] time 0.276 (0.285) data 0.197 (0.206) loss_x loss_x 0.4937 (0.3704) acc_x 90.6250 (92.9688) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/28] time 0.278 (0.285) data 0.199 (0.206) loss_x loss_x 0.4192 (0.3683) acc_x 87.5000 (92.6250) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:912
clean false:6
clean_rate:0.9934640522875817
noisy true:508
noisy false:206
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [192/200] batch [5/28] time 0.286 (0.284) data 0.208 (0.205) loss_x loss_x 0.3264 (0.3305) acc_x 93.7500 (93.7500) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [10/28] time 0.280 (0.280) data 0.202 (0.202) loss_x loss_x 0.4368 (0.3554) acc_x 93.7500 (93.4375) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [15/28] time 0.281 (0.280) data 0.202 (0.201) loss_x loss_x 0.2186 (0.3403) acc_x 96.8750 (93.3333) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/28] time 0.281 (0.281) data 0.202 (0.202) loss_x loss_x 0.4814 (0.3366) acc_x 87.5000 (92.9688) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/28] time 0.286 (0.281) data 0.207 (0.203) loss_x loss_x 0.2593 (0.3378) acc_x 93.7500 (92.6250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 202
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 925
clean true:920
clean false:5
clean_rate:0.9945945945945946
noisy true:510
noisy false:197
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 707
epoch [193/200] batch [5/28] time 0.284 (0.292) data 0.205 (0.214) loss_x loss_x 0.5303 (0.3302) acc_x 87.5000 (92.5000) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [10/28] time 0.285 (0.289) data 0.206 (0.210) loss_x loss_x 0.4172 (0.3069) acc_x 87.5000 (92.8125) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [15/28] time 0.282 (0.287) data 0.204 (0.208) loss_x loss_x 0.3057 (0.3584) acc_x 90.6250 (91.6667) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/28] time 0.289 (0.287) data 0.211 (0.208) loss_x loss_x 0.3799 (0.3618) acc_x 90.6250 (91.2500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/28] time 0.280 (0.285) data 0.201 (0.207) loss_x loss_x 0.1252 (0.3358) acc_x 100.0000 (92.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:911
clean false:7
clean_rate:0.9923747276688453
noisy true:507
noisy false:207
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [194/200] batch [5/28] time 0.284 (0.292) data 0.206 (0.213) loss_x loss_x 0.3865 (0.2643) acc_x 90.6250 (95.0000) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [10/28] time 0.280 (0.289) data 0.202 (0.211) loss_x loss_x 0.2273 (0.3003) acc_x 93.7500 (93.7500) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [15/28] time 0.278 (0.287) data 0.200 (0.208) loss_x loss_x 0.1549 (0.3123) acc_x 96.8750 (94.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/28] time 0.284 (0.286) data 0.206 (0.207) loss_x loss_x 0.2715 (0.3223) acc_x 96.8750 (93.7500) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/28] time 0.278 (0.284) data 0.200 (0.206) loss_x loss_x 0.3196 (0.3228) acc_x 90.6250 (93.3750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5515, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 900
clean true:893
clean false:7
clean_rate:0.9922222222222222
noisy true:506
noisy false:226
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 732
epoch [195/200] batch [5/28] time 0.286 (0.282) data 0.208 (0.203) loss_x loss_x 0.5107 (0.5133) acc_x 84.3750 (85.6250) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [10/28] time 0.284 (0.283) data 0.206 (0.204) loss_x loss_x 0.3215 (0.4301) acc_x 87.5000 (88.7500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [15/28] time 0.282 (0.282) data 0.204 (0.204) loss_x loss_x 0.1949 (0.3969) acc_x 96.8750 (90.6250) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/28] time 0.279 (0.283) data 0.201 (0.204) loss_x loss_x 0.3567 (0.3661) acc_x 90.6250 (91.5625) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/28] time 0.289 (0.283) data 0.210 (0.204) loss_x loss_x 0.2678 (0.3613) acc_x 96.8750 (91.6250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 916
clean true:913
clean false:3
clean_rate:0.9967248908296943
noisy true:495
noisy false:221
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 716
epoch [196/200] batch [5/28] time 0.277 (0.281) data 0.198 (0.202) loss_x loss_x 0.2296 (0.2690) acc_x 96.8750 (95.0000) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [10/28] time 0.282 (0.282) data 0.204 (0.204) loss_x loss_x 0.2028 (0.3312) acc_x 96.8750 (93.1250) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [15/28] time 0.285 (0.281) data 0.207 (0.203) loss_x loss_x 0.4353 (0.3596) acc_x 93.7500 (92.2917) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/28] time 0.272 (0.281) data 0.193 (0.202) loss_x loss_x 0.4778 (0.3612) acc_x 84.3750 (91.4062) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/28] time 0.280 (0.281) data 0.202 (0.203) loss_x loss_x 0.2563 (0.3390) acc_x 93.7500 (92.1250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5521, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 901
clean true:894
clean false:7
clean_rate:0.9922308546059934
noisy true:507
noisy false:224
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 731
epoch [197/200] batch [5/28] time 0.281 (0.282) data 0.202 (0.204) loss_x loss_x 0.3340 (0.3360) acc_x 90.6250 (91.2500) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [10/28] time 0.276 (0.282) data 0.198 (0.204) loss_x loss_x 0.6953 (0.4157) acc_x 87.5000 (90.9375) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [15/28] time 0.285 (0.282) data 0.206 (0.203) loss_x loss_x 0.2537 (0.3978) acc_x 93.7500 (90.4167) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/28] time 0.281 (0.282) data 0.202 (0.203) loss_x loss_x 0.4136 (0.3763) acc_x 87.5000 (90.7812) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/28] time 0.276 (0.282) data 0.198 (0.204) loss_x loss_x 0.4954 (0.3637) acc_x 84.3750 (91.0000) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:902
clean false:7
clean_rate:0.9922992299229924
noisy true:494
noisy false:229
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [198/200] batch [5/28] time 0.288 (0.287) data 0.210 (0.208) loss_x loss_x 0.1892 (0.3130) acc_x 100.0000 (93.1250) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [10/28] time 0.286 (0.284) data 0.207 (0.206) loss_x loss_x 0.2771 (0.3416) acc_x 96.8750 (92.5000) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [15/28] time 0.280 (0.283) data 0.201 (0.204) loss_x loss_x 0.4185 (0.3443) acc_x 90.6250 (92.7083) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/28] time 0.291 (0.283) data 0.213 (0.205) loss_x loss_x 0.2314 (0.3270) acc_x 93.7500 (92.9688) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/28] time 0.284 (0.283) data 0.205 (0.205) loss_x loss_x 0.1311 (0.2992) acc_x 100.0000 (93.8750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5496, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 897
clean true:890
clean false:7
clean_rate:0.992196209587514
noisy true:514
noisy false:221
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 735
epoch [199/200] batch [5/28] time 0.291 (0.287) data 0.213 (0.208) loss_x loss_x 0.4863 (0.3966) acc_x 90.6250 (88.7500) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/28] time 0.293 (0.285) data 0.214 (0.207) loss_x loss_x 0.1340 (0.3552) acc_x 100.0000 (90.3125) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [15/28] time 0.289 (0.284) data 0.211 (0.206) loss_x loss_x 0.3376 (0.3597) acc_x 90.6250 (90.0000) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/28] time 0.293 (0.287) data 0.215 (0.209) loss_x loss_x 0.6060 (0.3847) acc_x 93.7500 (90.3125) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/28] time 0.287 (0.288) data 0.209 (0.209) loss_x loss_x 0.4590 (0.4000) acc_x 87.5000 (90.1250) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:889
clean false:7
clean_rate:0.9921875
noisy true:497
noisy false:239
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [200/200] batch [5/28] time 0.290 (0.284) data 0.212 (0.206) loss_x loss_x 0.2390 (0.3033) acc_x 96.8750 (91.8750) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [10/28] time 0.284 (0.284) data 0.206 (0.205) loss_x loss_x 0.1736 (0.3283) acc_x 96.8750 (91.8750) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [15/28] time 0.284 (0.281) data 0.205 (0.203) loss_x loss_x 0.0969 (0.3258) acc_x 100.0000 (92.2917) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/28] time 0.274 (0.280) data 0.196 (0.202) loss_x loss_x 0.2362 (0.3065) acc_x 96.8750 (92.8125) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/28] time 0.281 (0.280) data 0.203 (0.202) loss_x loss_x 0.4006 (0.3341) acc_x 90.6250 (92.0000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,183
* accuracy: 88.6%
* error: 11.4%
* macro_f1: 88.4%
Elapsed: 1:30:50
