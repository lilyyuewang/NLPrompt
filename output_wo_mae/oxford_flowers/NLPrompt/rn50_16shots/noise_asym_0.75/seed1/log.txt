***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.0631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 103
clean true:96
clean false:7
clean_rate:0.9320388349514563
noisy true:279
noisy false:1250
after delete: len(clean_dataset) 103
after delete: len(noisy_dataset) 1529
epoch [1/200] batch [1/3] time 0.426 (0.426) data 0.259 (0.259) loss_x loss_x 2.7988 (2.7988) acc_x 37.5000 (37.5000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/3] time 0.304 (0.365) data 0.225 (0.242) loss_x loss_x 2.6621 (2.7305) acc_x 50.0000 (43.7500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/3] time 0.304 (0.344) data 0.225 (0.237) loss_x loss_x 2.9199 (2.7936) acc_x 37.5000 (41.6667) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1250
confident_label rate tensor(0.0582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 95
clean true:89
clean false:6
clean_rate:0.9368421052631579
noisy true:293
noisy false:1244
after delete: len(clean_dataset) 95
after delete: len(noisy_dataset) 1537
epoch [2/200] batch [1/2] time 0.363 (0.363) data 0.285 (0.285) loss_x loss_x 2.5547 (2.5547) acc_x 34.3750 (34.3750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [2/2] time 0.361 (0.362) data 0.284 (0.285) loss_x loss_x 0.8340 (1.6943) acc_x 81.2500 (57.8125) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 777
confident_label rate tensor(0.1336, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 218
clean true:216
clean false:2
clean_rate:0.9908256880733946
noisy true:639
noisy false:775
after delete: len(clean_dataset) 218
after delete: len(noisy_dataset) 1414
epoch [3/200] batch [5/6] time 0.342 (0.358) data 0.264 (0.280) loss_x loss_x 1.2617 (0.9041) acc_x 68.7500 (74.3750) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 746
confident_label rate tensor(0.1471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 240
clean true:236
clean false:4
clean_rate:0.9833333333333333
noisy true:650
noisy false:742
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 1392
epoch [4/200] batch [5/7] time 0.311 (0.334) data 0.233 (0.256) loss_x loss_x 0.8066 (0.8319) acc_x 75.0000 (77.5000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 720
confident_label rate tensor(0.1458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 238
clean true:234
clean false:4
clean_rate:0.9831932773109243
noisy true:678
noisy false:716
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1394
epoch [5/200] batch [5/7] time 0.356 (0.354) data 0.275 (0.276) loss_x loss_x 0.5933 (0.9140) acc_x 84.3750 (79.3750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 729
confident_label rate tensor(0.1520, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 248
clean true:244
clean false:4
clean_rate:0.9838709677419355
noisy true:659
noisy false:725
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 1384
epoch [6/200] batch [5/7] time 0.353 (0.356) data 0.276 (0.278) loss_x loss_x 1.0195 (0.8023) acc_x 78.1250 (80.6250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 739
confident_label rate tensor(0.1458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 238
clean true:229
clean false:9
clean_rate:0.9621848739495799
noisy true:664
noisy false:730
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1394
epoch [7/200] batch [5/7] time 0.344 (0.354) data 0.266 (0.276) loss_x loss_x 0.5918 (0.7865) acc_x 90.6250 (83.7500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 733
confident_label rate tensor(0.1428, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 233
clean true:226
clean false:7
clean_rate:0.9699570815450643
noisy true:673
noisy false:726
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 1399
epoch [8/200] batch [5/7] time 0.342 (0.310) data 0.264 (0.233) loss_x loss_x 0.6309 (0.7039) acc_x 84.3750 (82.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 724
confident_label rate tensor(0.1452, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 237
clean true:229
clean false:8
clean_rate:0.9662447257383966
noisy true:679
noisy false:716
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 1395
epoch [9/200] batch [5/7] time 0.333 (0.347) data 0.255 (0.269) loss_x loss_x 1.0137 (0.6441) acc_x 68.7500 (82.5000) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 737
confident_label rate tensor(0.1428, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 233
clean true:224
clean false:9
clean_rate:0.9613733905579399
noisy true:671
noisy false:728
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 1399
epoch [10/200] batch [5/7] time 0.333 (0.341) data 0.255 (0.263) loss_x loss_x 0.8896 (0.6578) acc_x 87.5000 (87.5000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 697
confident_label rate tensor(0.1599, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 261
clean true:255
clean false:6
clean_rate:0.9770114942528736
noisy true:680
noisy false:691
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 1371
epoch [11/200] batch [5/8] time 0.348 (0.357) data 0.271 (0.279) loss_x loss_x 0.6372 (0.8516) acc_x 87.5000 (79.3750) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 687
confident_label rate tensor(0.1581, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 258
clean true:254
clean false:4
clean_rate:0.9844961240310077
noisy true:691
noisy false:683
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 1374
epoch [12/200] batch [5/8] time 0.363 (0.361) data 0.284 (0.283) loss_x loss_x 0.8457 (0.6918) acc_x 68.7500 (80.0000) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 690
confident_label rate tensor(0.1550, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 253
clean true:242
clean false:11
clean_rate:0.9565217391304348
noisy true:700
noisy false:679
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 1379
epoch [13/200] batch [5/7] time 0.349 (0.349) data 0.270 (0.271) loss_x loss_x 1.3945 (0.8102) acc_x 71.8750 (83.1250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 718
confident_label rate tensor(0.1544, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 252
clean true:243
clean false:9
clean_rate:0.9642857142857143
noisy true:671
noisy false:709
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 1380
epoch [14/200] batch [5/7] time 0.359 (0.350) data 0.281 (0.273) loss_x loss_x 0.6113 (0.6535) acc_x 84.3750 (84.3750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 700
confident_label rate tensor(0.1581, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 258
clean true:249
clean false:9
clean_rate:0.9651162790697675
noisy true:683
noisy false:691
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 1374
epoch [15/200] batch [5/8] time 0.345 (0.344) data 0.268 (0.267) loss_x loss_x 0.5254 (0.6304) acc_x 90.6250 (86.8750) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 694
confident_label rate tensor(0.1562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 255
clean true:247
clean false:8
clean_rate:0.9686274509803922
noisy true:691
noisy false:686
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 1377
epoch [16/200] batch [5/7] time 0.357 (0.345) data 0.280 (0.267) loss_x loss_x 0.6787 (0.6095) acc_x 81.2500 (85.0000) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 656
confident_label rate tensor(0.1642, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 268
clean true:258
clean false:10
clean_rate:0.9626865671641791
noisy true:718
noisy false:646
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 1364
epoch [17/200] batch [5/8] time 0.297 (0.324) data 0.220 (0.247) loss_x loss_x 1.0371 (0.7518) acc_x 81.2500 (83.7500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 669
confident_label rate tensor(0.1605, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 262
clean true:248
clean false:14
clean_rate:0.9465648854961832
noisy true:715
noisy false:655
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 1370
epoch [18/200] batch [5/8] time 0.366 (0.366) data 0.289 (0.288) loss_x loss_x 0.6924 (0.7122) acc_x 78.1250 (83.1250) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 716
confident_label rate tensor(0.1581, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 258
clean true:248
clean false:10
clean_rate:0.9612403100775194
noisy true:668
noisy false:706
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 1374
epoch [19/200] batch [5/8] time 0.364 (0.357) data 0.286 (0.279) loss_x loss_x 0.6074 (0.6895) acc_x 90.6250 (86.8750) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 694
confident_label rate tensor(0.1593, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 260
clean true:251
clean false:9
clean_rate:0.9653846153846154
noisy true:687
noisy false:685
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 1372
epoch [20/200] batch [5/8] time 0.326 (0.343) data 0.248 (0.266) loss_x loss_x 0.3179 (0.6816) acc_x 96.8750 (85.0000) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 670
confident_label rate tensor(0.1679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 274
clean true:259
clean false:15
clean_rate:0.9452554744525548
noisy true:703
noisy false:655
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 1358
epoch [21/200] batch [5/8] time 0.326 (0.316) data 0.249 (0.238) loss_x loss_x 0.5063 (0.5346) acc_x 90.6250 (85.6250) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 650
confident_label rate tensor(0.1679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 274
clean true:257
clean false:17
clean_rate:0.9379562043795621
noisy true:725
noisy false:633
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 1358
epoch [22/200] batch [5/8] time 0.346 (0.351) data 0.269 (0.273) loss_x loss_x 0.6006 (0.4864) acc_x 84.3750 (89.3750) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 639
confident_label rate tensor(0.1746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 285
clean true:261
clean false:24
clean_rate:0.9157894736842105
noisy true:732
noisy false:615
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1347
epoch [23/200] batch [5/8] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.5659 (0.5486) acc_x 84.3750 (85.6250) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 673
confident_label rate tensor(0.1710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 279
clean true:260
clean false:19
clean_rate:0.931899641577061
noisy true:699
noisy false:654
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 1353
epoch [24/200] batch [5/8] time 0.344 (0.329) data 0.267 (0.250) loss_x loss_x 0.4136 (0.4753) acc_x 84.3750 (87.5000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 648
confident_label rate tensor(0.1746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 285
clean true:263
clean false:22
clean_rate:0.9228070175438596
noisy true:721
noisy false:626
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1347
epoch [25/200] batch [5/8] time 0.304 (0.347) data 0.226 (0.269) loss_x loss_x 0.7734 (0.5597) acc_x 87.5000 (88.1250) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 643
confident_label rate tensor(0.1789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 292
clean true:266
clean false:26
clean_rate:0.910958904109589
noisy true:723
noisy false:617
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 1340
epoch [26/200] batch [5/9] time 0.297 (0.363) data 0.219 (0.285) loss_x loss_x 0.5054 (0.5365) acc_x 84.3750 (86.8750) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 631
confident_label rate tensor(0.1746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 285
clean true:260
clean false:25
clean_rate:0.9122807017543859
noisy true:741
noisy false:606
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1347
epoch [27/200] batch [5/8] time 0.339 (0.343) data 0.262 (0.265) loss_x loss_x 0.2395 (0.4301) acc_x 93.7500 (91.2500) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 627
confident_label rate tensor(0.1850, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 302
clean true:275
clean false:27
clean_rate:0.9105960264900662
noisy true:730
noisy false:600
after delete: len(clean_dataset) 302
after delete: len(noisy_dataset) 1330
epoch [28/200] batch [5/9] time 0.347 (0.343) data 0.269 (0.264) loss_x loss_x 0.5703 (0.6457) acc_x 87.5000 (86.2500) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 647
confident_label rate tensor(0.1801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 294
clean true:266
clean false:28
clean_rate:0.9047619047619048
noisy true:719
noisy false:619
after delete: len(clean_dataset) 294
after delete: len(noisy_dataset) 1338
epoch [29/200] batch [5/9] time 0.347 (0.327) data 0.269 (0.249) loss_x loss_x 1.0830 (0.5869) acc_x 75.0000 (87.5000) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 635
confident_label rate tensor(0.1863, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 304
clean true:277
clean false:27
clean_rate:0.9111842105263158
noisy true:720
noisy false:608
after delete: len(clean_dataset) 304
after delete: len(noisy_dataset) 1328
epoch [30/200] batch [5/9] time 0.330 (0.341) data 0.252 (0.263) loss_x loss_x 0.9097 (0.6531) acc_x 81.2500 (85.6250) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 649
confident_label rate tensor(0.1850, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 302
clean true:267
clean false:35
clean_rate:0.8841059602649006
noisy true:716
noisy false:614
after delete: len(clean_dataset) 302
after delete: len(noisy_dataset) 1330
epoch [31/200] batch [5/9] time 0.362 (0.365) data 0.284 (0.287) loss_x loss_x 0.3550 (0.4850) acc_x 90.6250 (86.8750) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 631
confident_label rate tensor(0.1979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 323
clean true:284
clean false:39
clean_rate:0.8792569659442725
noisy true:717
noisy false:592
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 1309
epoch [32/200] batch [5/10] time 0.343 (0.342) data 0.265 (0.264) loss_x loss_x 0.6528 (0.5139) acc_x 81.2500 (86.8750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/10] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.3394 (0.5226) acc_x 90.6250 (87.5000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 620
confident_label rate tensor(0.1936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 316
clean true:282
clean false:34
clean_rate:0.8924050632911392
noisy true:730
noisy false:586
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1316
epoch [33/200] batch [5/9] time 0.342 (0.352) data 0.265 (0.274) loss_x loss_x 0.4136 (0.5494) acc_x 90.6250 (86.8750) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 615
confident_label rate tensor(0.1912, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 312
clean true:278
clean false:34
clean_rate:0.8910256410256411
noisy true:739
noisy false:581
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1320
epoch [34/200] batch [5/9] time 0.348 (0.350) data 0.271 (0.272) loss_x loss_x 0.4587 (0.5296) acc_x 90.6250 (88.7500) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 603
confident_label rate tensor(0.2065, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 337
clean true:299
clean false:38
clean_rate:0.887240356083086
noisy true:730
noisy false:565
after delete: len(clean_dataset) 337
after delete: len(noisy_dataset) 1295
epoch [35/200] batch [5/10] time 0.354 (0.353) data 0.277 (0.276) loss_x loss_x 0.7178 (0.5840) acc_x 84.3750 (87.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/10] time 0.363 (0.352) data 0.286 (0.275) loss_x loss_x 0.5410 (0.5782) acc_x 84.3750 (86.2500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 600
confident_label rate tensor(0.2077, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 339
clean true:298
clean false:41
clean_rate:0.8790560471976401
noisy true:734
noisy false:559
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1293
epoch [36/200] batch [5/10] time 0.347 (0.342) data 0.270 (0.265) loss_x loss_x 0.3801 (0.6746) acc_x 90.6250 (81.8750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/10] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.3743 (0.5857) acc_x 87.5000 (84.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 618
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 319
clean true:277
clean false:42
clean_rate:0.8683385579937304
noisy true:737
noisy false:576
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 1313
epoch [37/200] batch [5/9] time 0.352 (0.340) data 0.274 (0.263) loss_x loss_x 0.3833 (0.5708) acc_x 93.7500 (83.1250) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 639
confident_label rate tensor(0.1949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 318
clean true:279
clean false:39
clean_rate:0.8773584905660378
noisy true:714
noisy false:600
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1314
epoch [38/200] batch [5/9] time 0.351 (0.345) data 0.273 (0.267) loss_x loss_x 0.2286 (0.4259) acc_x 100.0000 (91.2500) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 616
confident_label rate tensor(0.2016, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 329
clean true:287
clean false:42
clean_rate:0.8723404255319149
noisy true:729
noisy false:574
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1303
epoch [39/200] batch [5/10] time 0.347 (0.355) data 0.269 (0.277) loss_x loss_x 0.2800 (0.3820) acc_x 96.8750 (92.5000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/10] time 0.330 (0.335) data 0.252 (0.257) loss_x loss_x 0.3606 (0.4389) acc_x 93.7500 (89.0625) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 615
confident_label rate tensor(0.1973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 322
clean true:282
clean false:40
clean_rate:0.8757763975155279
noisy true:735
noisy false:575
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1310
epoch [40/200] batch [5/10] time 0.327 (0.319) data 0.250 (0.241) loss_x loss_x 0.6343 (0.5056) acc_x 81.2500 (86.8750) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/10] time 0.339 (0.327) data 0.261 (0.249) loss_x loss_x 0.5493 (0.5178) acc_x 81.2500 (86.5625) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 599
confident_label rate tensor(0.2065, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 337
clean true:291
clean false:46
clean_rate:0.8635014836795252
noisy true:742
noisy false:553
after delete: len(clean_dataset) 337
after delete: len(noisy_dataset) 1295
epoch [41/200] batch [5/10] time 0.296 (0.319) data 0.218 (0.241) loss_x loss_x 0.4539 (0.3504) acc_x 93.7500 (94.3750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/10] time 0.344 (0.321) data 0.266 (0.243) loss_x loss_x 0.5435 (0.4970) acc_x 87.5000 (89.0625) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 583
confident_label rate tensor(0.2132, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 348
clean true:296
clean false:52
clean_rate:0.8505747126436781
noisy true:753
noisy false:531
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1284
epoch [42/200] batch [5/10] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.5137 (0.6870) acc_x 84.3750 (80.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/10] time 0.303 (0.334) data 0.225 (0.256) loss_x loss_x 0.7158 (0.6219) acc_x 81.2500 (82.8125) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 629
confident_label rate tensor(0.2071, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 338
clean true:288
clean false:50
clean_rate:0.8520710059171598
noisy true:715
noisy false:579
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1294
epoch [43/200] batch [5/10] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.5547 (0.6595) acc_x 90.6250 (83.1250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/10] time 0.352 (0.341) data 0.275 (0.263) loss_x loss_x 0.3540 (0.5114) acc_x 90.6250 (86.8750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 619
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 356
clean true:298
clean false:58
clean_rate:0.8370786516853933
noisy true:715
noisy false:561
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1276
epoch [44/200] batch [5/11] time 0.352 (0.354) data 0.274 (0.276) loss_x loss_x 0.3181 (0.5146) acc_x 93.7500 (86.8750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/11] time 0.333 (0.346) data 0.255 (0.268) loss_x loss_x 0.6348 (0.5134) acc_x 84.3750 (86.8750) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 595
confident_label rate tensor(0.2102, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 343
clean true:290
clean false:53
clean_rate:0.8454810495626822
noisy true:747
noisy false:542
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1289
epoch [45/200] batch [5/10] time 0.358 (0.357) data 0.281 (0.280) loss_x loss_x 0.7412 (0.4778) acc_x 84.3750 (88.7500) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/10] time 0.347 (0.353) data 0.269 (0.276) loss_x loss_x 0.6104 (0.4770) acc_x 93.7500 (89.0625) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 594
confident_label rate tensor(0.2077, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 339
clean true:288
clean false:51
clean_rate:0.8495575221238938
noisy true:750
noisy false:543
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1293
epoch [46/200] batch [5/10] time 0.352 (0.348) data 0.274 (0.270) loss_x loss_x 0.5942 (0.5047) acc_x 87.5000 (88.7500) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/10] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.8066 (0.5047) acc_x 78.1250 (87.5000) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 588
confident_label rate tensor(0.2126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 347
clean true:292
clean false:55
clean_rate:0.8414985590778098
noisy true:752
noisy false:533
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1285
epoch [47/200] batch [5/10] time 0.346 (0.343) data 0.269 (0.266) loss_x loss_x 0.4148 (0.5583) acc_x 93.7500 (88.7500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/10] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.2837 (0.5324) acc_x 93.7500 (88.7500) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 611
confident_label rate tensor(0.2059, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 336
clean true:282
clean false:54
clean_rate:0.8392857142857143
noisy true:739
noisy false:557
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1296
epoch [48/200] batch [5/10] time 0.354 (0.350) data 0.277 (0.272) loss_x loss_x 0.5107 (0.5136) acc_x 84.3750 (88.1250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/10] time 0.361 (0.348) data 0.283 (0.270) loss_x loss_x 0.3242 (0.5496) acc_x 90.6250 (87.5000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.2040, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 333
clean true:283
clean false:50
clean_rate:0.8498498498498499
noisy true:768
noisy false:531
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1299
epoch [49/200] batch [5/10] time 0.330 (0.348) data 0.253 (0.271) loss_x loss_x 0.7925 (0.4971) acc_x 81.2500 (89.3750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/10] time 0.348 (0.346) data 0.271 (0.269) loss_x loss_x 0.4116 (0.4716) acc_x 96.8750 (90.0000) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 582
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 357
clean true:299
clean false:58
clean_rate:0.8375350140056023
noisy true:751
noisy false:524
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1275
epoch [50/200] batch [5/11] time 0.354 (0.351) data 0.276 (0.274) loss_x loss_x 0.4873 (0.5139) acc_x 87.5000 (87.5000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/11] time 0.356 (0.348) data 0.278 (0.270) loss_x loss_x 0.3567 (0.4788) acc_x 87.5000 (88.1250) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 588
confident_label rate tensor(0.2138, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 349
clean true:291
clean false:58
clean_rate:0.833810888252149
noisy true:753
noisy false:530
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1283
epoch [51/200] batch [5/10] time 0.338 (0.331) data 0.260 (0.253) loss_x loss_x 0.4084 (0.4807) acc_x 87.5000 (90.0000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/10] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.4539 (0.4637) acc_x 90.6250 (90.3125) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 599
confident_label rate tensor(0.2126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 347
clean true:289
clean false:58
clean_rate:0.8328530259365994
noisy true:744
noisy false:541
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1285
epoch [52/200] batch [5/10] time 0.304 (0.333) data 0.225 (0.255) loss_x loss_x 0.8984 (0.5278) acc_x 84.3750 (89.3750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/10] time 0.356 (0.336) data 0.278 (0.258) loss_x loss_x 0.5859 (0.5616) acc_x 87.5000 (88.1250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 365
clean true:303
clean false:62
clean_rate:0.8301369863013699
noisy true:748
noisy false:519
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1267
epoch [53/200] batch [5/11] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.7910 (0.5533) acc_x 78.1250 (87.5000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/11] time 0.313 (0.339) data 0.235 (0.262) loss_x loss_x 0.4646 (0.5545) acc_x 90.6250 (88.4375) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 568
confident_label rate tensor(0.2230, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 364
clean true:299
clean false:65
clean_rate:0.8214285714285714
noisy true:765
noisy false:503
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1268
epoch [54/200] batch [5/11] time 0.350 (0.349) data 0.272 (0.272) loss_x loss_x 0.6460 (0.4924) acc_x 93.7500 (90.0000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/11] time 0.358 (0.350) data 0.280 (0.272) loss_x loss_x 0.4451 (0.4975) acc_x 90.6250 (89.0625) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 596
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:297
clean false:63
clean_rate:0.825
noisy true:739
noisy false:533
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [55/200] batch [5/11] time 0.355 (0.348) data 0.278 (0.270) loss_x loss_x 0.5698 (0.6405) acc_x 90.6250 (85.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/11] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.4119 (0.5957) acc_x 90.6250 (86.5625) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 565
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 357
clean true:297
clean false:60
clean_rate:0.8319327731092437
noisy true:770
noisy false:505
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1275
epoch [56/200] batch [5/11] time 0.312 (0.323) data 0.232 (0.245) loss_x loss_x 0.3074 (0.3828) acc_x 93.7500 (90.6250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/11] time 0.346 (0.325) data 0.269 (0.247) loss_x loss_x 0.4778 (0.3798) acc_x 84.3750 (90.9375) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.2224, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 363
clean true:305
clean false:58
clean_rate:0.8402203856749312
noisy true:765
noisy false:504
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1269
epoch [57/200] batch [5/11] time 0.351 (0.343) data 0.274 (0.265) loss_x loss_x 0.6099 (0.4372) acc_x 84.3750 (88.1250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/11] time 0.351 (0.341) data 0.273 (0.264) loss_x loss_x 0.2932 (0.3769) acc_x 93.7500 (90.9375) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 579
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 353
clean true:299
clean false:54
clean_rate:0.8470254957507082
noisy true:754
noisy false:525
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1279
epoch [58/200] batch [5/11] time 0.344 (0.344) data 0.267 (0.267) loss_x loss_x 0.4031 (0.4955) acc_x 93.7500 (88.7500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/11] time 0.348 (0.342) data 0.270 (0.264) loss_x loss_x 0.3352 (0.4374) acc_x 90.6250 (88.1250) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.2328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 380
clean true:318
clean false:62
clean_rate:0.8368421052631579
noisy true:765
noisy false:487
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1252
epoch [59/200] batch [5/11] time 0.348 (0.352) data 0.270 (0.275) loss_x loss_x 0.5249 (0.4269) acc_x 90.6250 (92.5000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/11] time 0.348 (0.348) data 0.270 (0.270) loss_x loss_x 0.3542 (0.4696) acc_x 90.6250 (90.0000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 593
confident_label rate tensor(0.2224, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 363
clean true:301
clean false:62
clean_rate:0.8292011019283747
noisy true:738
noisy false:531
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1269
epoch [60/200] batch [5/11] time 0.342 (0.343) data 0.263 (0.266) loss_x loss_x 0.3611 (0.3749) acc_x 87.5000 (90.0000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/11] time 0.345 (0.340) data 0.268 (0.263) loss_x loss_x 0.6118 (0.4610) acc_x 84.3750 (89.0625) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 545
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:313
clean false:61
clean_rate:0.8368983957219251
noisy true:774
noisy false:484
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [61/200] batch [5/11] time 0.356 (0.353) data 0.278 (0.275) loss_x loss_x 0.4243 (0.3740) acc_x 93.7500 (90.6250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/11] time 0.346 (0.351) data 0.268 (0.274) loss_x loss_x 0.5469 (0.4182) acc_x 87.5000 (89.6875) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 573
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:306
clean false:68
clean_rate:0.8181818181818182
noisy true:753
noisy false:505
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [62/200] batch [5/11] time 0.353 (0.350) data 0.275 (0.272) loss_x loss_x 0.3696 (0.4819) acc_x 93.7500 (88.1250) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/11] time 0.358 (0.345) data 0.280 (0.267) loss_x loss_x 0.3010 (0.4513) acc_x 93.7500 (90.0000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.2218, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 362
clean true:294
clean false:68
clean_rate:0.8121546961325967
noisy true:763
noisy false:507
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1270
epoch [63/200] batch [5/11] time 0.356 (0.346) data 0.278 (0.268) loss_x loss_x 0.4253 (0.4820) acc_x 87.5000 (86.8750) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/11] time 0.289 (0.334) data 0.212 (0.256) loss_x loss_x 0.5195 (0.4720) acc_x 87.5000 (87.8125) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 568
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:309
clean false:65
clean_rate:0.8262032085561497
noisy true:755
noisy false:503
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [64/200] batch [5/11] time 0.355 (0.356) data 0.277 (0.278) loss_x loss_x 0.5171 (0.4615) acc_x 90.6250 (87.5000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/11] time 0.347 (0.350) data 0.270 (0.272) loss_x loss_x 0.5098 (0.5267) acc_x 90.6250 (85.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 543
confident_label rate tensor(0.2249, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 367
clean true:306
clean false:61
clean_rate:0.8337874659400545
noisy true:783
noisy false:482
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1265
epoch [65/200] batch [5/11] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.6250 (0.5388) acc_x 90.6250 (88.1250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/11] time 0.351 (0.350) data 0.274 (0.273) loss_x loss_x 1.0029 (0.4816) acc_x 75.0000 (89.0625) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 353
clean true:292
clean false:61
clean_rate:0.8271954674220963
noisy true:759
noisy false:520
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1279
epoch [66/200] batch [5/11] time 0.352 (0.361) data 0.274 (0.283) loss_x loss_x 0.3035 (0.2938) acc_x 96.8750 (93.7500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/11] time 0.322 (0.353) data 0.245 (0.275) loss_x loss_x 0.3005 (0.3339) acc_x 93.7500 (92.8125) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 563
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:307
clean false:66
clean_rate:0.8230563002680965
noisy true:762
noisy false:497
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [67/200] batch [5/11] time 0.294 (0.309) data 0.216 (0.231) loss_x loss_x 0.5942 (0.4358) acc_x 90.6250 (90.6250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/11] time 0.336 (0.320) data 0.259 (0.242) loss_x loss_x 0.4304 (0.4501) acc_x 87.5000 (89.3750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:310
clean false:68
clean_rate:0.8201058201058201
noisy true:758
noisy false:496
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [68/200] batch [5/11] time 0.330 (0.330) data 0.252 (0.253) loss_x loss_x 0.2654 (0.2938) acc_x 96.8750 (93.7500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/11] time 0.349 (0.337) data 0.271 (0.259) loss_x loss_x 0.4541 (0.3883) acc_x 90.6250 (91.2500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 554
confident_label rate tensor(0.2310, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 377
clean true:314
clean false:63
clean_rate:0.8328912466843501
noisy true:764
noisy false:491
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1255
epoch [69/200] batch [5/11] time 0.324 (0.339) data 0.247 (0.261) loss_x loss_x 0.4182 (0.3404) acc_x 93.7500 (92.5000) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/11] time 0.343 (0.341) data 0.266 (0.263) loss_x loss_x 0.5840 (0.4628) acc_x 90.6250 (87.5000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 572
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:308
clean false:66
clean_rate:0.8235294117647058
noisy true:752
noisy false:506
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [70/200] batch [5/11] time 0.293 (0.344) data 0.215 (0.265) loss_x loss_x 0.3345 (0.4360) acc_x 90.6250 (90.0000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/11] time 0.303 (0.322) data 0.225 (0.244) loss_x loss_x 0.6543 (0.5021) acc_x 81.2500 (89.0625) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 561
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:322
clean false:59
clean_rate:0.8451443569553806
noisy true:749
noisy false:502
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [71/200] batch [5/11] time 0.337 (0.342) data 0.259 (0.264) loss_x loss_x 0.4102 (0.4289) acc_x 93.7500 (90.0000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/11] time 0.348 (0.340) data 0.271 (0.263) loss_x loss_x 0.5542 (0.4844) acc_x 84.3750 (88.1250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 592
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 365
clean true:299
clean false:66
clean_rate:0.8191780821917808
noisy true:741
noisy false:526
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1267
epoch [72/200] batch [5/11] time 0.352 (0.356) data 0.275 (0.278) loss_x loss_x 0.4788 (0.4266) acc_x 87.5000 (91.2500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/11] time 0.341 (0.353) data 0.264 (0.276) loss_x loss_x 0.2257 (0.4089) acc_x 96.8750 (91.5625) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:304
clean false:69
clean_rate:0.8150134048257373
noisy true:766
noisy false:493
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [73/200] batch [5/11] time 0.344 (0.348) data 0.266 (0.271) loss_x loss_x 0.4238 (0.3105) acc_x 84.3750 (91.2500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/11] time 0.353 (0.349) data 0.275 (0.272) loss_x loss_x 0.2386 (0.4274) acc_x 96.8750 (90.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:306
clean false:67
clean_rate:0.8203753351206434
noisy true:770
noisy false:489
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [74/200] batch [5/11] time 0.312 (0.325) data 0.233 (0.247) loss_x loss_x 0.4639 (0.4540) acc_x 87.5000 (90.6250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/11] time 0.344 (0.337) data 0.266 (0.259) loss_x loss_x 0.4998 (0.4672) acc_x 87.5000 (89.3750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 543
confident_label rate tensor(0.2304, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 376
clean true:313
clean false:63
clean_rate:0.8324468085106383
noisy true:776
noisy false:480
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1256
epoch [75/200] batch [5/11] time 0.351 (0.358) data 0.272 (0.280) loss_x loss_x 0.3135 (0.3871) acc_x 93.7500 (91.8750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/11] time 0.337 (0.339) data 0.260 (0.261) loss_x loss_x 0.2932 (0.3513) acc_x 93.7500 (92.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 555
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:308
clean false:66
clean_rate:0.8235294117647058
noisy true:769
noisy false:489
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [76/200] batch [5/11] time 0.328 (0.345) data 0.250 (0.267) loss_x loss_x 0.4119 (0.4496) acc_x 90.6250 (91.2500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/11] time 0.346 (0.344) data 0.268 (0.266) loss_x loss_x 0.3315 (0.3760) acc_x 90.6250 (92.1875) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 541
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:311
clean false:67
clean_rate:0.8227513227513228
noisy true:780
noisy false:474
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [77/200] batch [5/11] time 0.352 (0.346) data 0.275 (0.269) loss_x loss_x 0.3325 (0.3401) acc_x 90.6250 (92.5000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/11] time 0.347 (0.342) data 0.269 (0.264) loss_x loss_x 0.5420 (0.3996) acc_x 84.3750 (90.6250) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:311
clean false:72
clean_rate:0.8120104438642297
noisy true:764
noisy false:485
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [78/200] batch [5/11] time 0.308 (0.333) data 0.230 (0.255) loss_x loss_x 0.3030 (0.4043) acc_x 93.7500 (91.2500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/11] time 0.303 (0.317) data 0.223 (0.239) loss_x loss_x 0.4500 (0.4045) acc_x 84.3750 (90.3125) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 548
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:311
clean false:68
clean_rate:0.820580474934037
noisy true:773
noisy false:480
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [79/200] batch [5/11] time 0.356 (0.351) data 0.278 (0.273) loss_x loss_x 0.2173 (0.3187) acc_x 96.8750 (93.1250) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/11] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.5405 (0.4206) acc_x 87.5000 (90.9375) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.2328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 380
clean true:309
clean false:71
clean_rate:0.8131578947368421
noisy true:749
noisy false:503
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1252
epoch [80/200] batch [5/11] time 0.327 (0.346) data 0.250 (0.269) loss_x loss_x 0.4807 (0.4215) acc_x 87.5000 (89.3750) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/11] time 0.340 (0.342) data 0.263 (0.265) loss_x loss_x 0.2898 (0.3805) acc_x 93.7500 (91.2500) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 570
confident_label rate tensor(0.2377, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 388
clean true:314
clean false:74
clean_rate:0.8092783505154639
noisy true:748
noisy false:496
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1244
epoch [81/200] batch [5/12] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.5947 (0.4606) acc_x 87.5000 (87.5000) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/12] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.4238 (0.3891) acc_x 84.3750 (88.7500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 565
confident_label rate tensor(0.2371, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 387
clean true:314
clean false:73
clean_rate:0.8113695090439277
noisy true:753
noisy false:492
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1245
epoch [82/200] batch [5/12] time 0.350 (0.347) data 0.273 (0.270) loss_x loss_x 0.2339 (0.3997) acc_x 93.7500 (90.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/12] time 0.326 (0.344) data 0.248 (0.266) loss_x loss_x 0.4651 (0.4002) acc_x 84.3750 (90.6250) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.2365, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 386
clean true:315
clean false:71
clean_rate:0.8160621761658031
noisy true:743
noisy false:503
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1246
epoch [83/200] batch [5/12] time 0.297 (0.324) data 0.220 (0.247) loss_x loss_x 0.5083 (0.4895) acc_x 87.5000 (89.3750) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/12] time 0.351 (0.326) data 0.273 (0.248) loss_x loss_x 0.6362 (0.5449) acc_x 84.3750 (88.1250) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 570
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:301
clean false:72
clean_rate:0.806970509383378
noisy true:761
noisy false:498
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [84/200] batch [5/11] time 0.337 (0.336) data 0.259 (0.258) loss_x loss_x 0.3955 (0.3697) acc_x 90.6250 (91.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/11] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.5762 (0.3818) acc_x 78.1250 (90.9375) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:312
clean false:72
clean_rate:0.8125
noisy true:762
noisy false:486
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [85/200] batch [5/12] time 0.349 (0.339) data 0.272 (0.261) loss_x loss_x 0.3679 (0.3469) acc_x 87.5000 (88.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/12] time 0.333 (0.339) data 0.255 (0.261) loss_x loss_x 0.3342 (0.3769) acc_x 90.6250 (90.0000) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 587
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:300
clean false:79
clean_rate:0.7915567282321899
noisy true:745
noisy false:508
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [86/200] batch [5/11] time 0.345 (0.353) data 0.267 (0.275) loss_x loss_x 0.6685 (0.4000) acc_x 81.2500 (90.0000) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/11] time 0.333 (0.347) data 0.256 (0.269) loss_x loss_x 0.3313 (0.4021) acc_x 96.8750 (90.9375) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 584
confident_label rate tensor(0.2426, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 396
clean true:317
clean false:79
clean_rate:0.8005050505050505
noisy true:731
noisy false:505
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1236
epoch [87/200] batch [5/12] time 0.346 (0.350) data 0.269 (0.273) loss_x loss_x 0.5352 (0.5018) acc_x 90.6250 (88.1250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/12] time 0.297 (0.329) data 0.219 (0.252) loss_x loss_x 0.2030 (0.4370) acc_x 96.8750 (89.3750) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 543
confident_label rate tensor(0.2426, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 396
clean true:316
clean false:80
clean_rate:0.797979797979798
noisy true:773
noisy false:463
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1236
epoch [88/200] batch [5/12] time 0.346 (0.351) data 0.269 (0.273) loss_x loss_x 0.2937 (0.4998) acc_x 93.7500 (90.0000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/12] time 0.342 (0.348) data 0.265 (0.271) loss_x loss_x 0.7461 (0.4724) acc_x 84.3750 (90.3125) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2445, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 399
clean true:318
clean false:81
clean_rate:0.7969924812030075
noisy true:756
noisy false:477
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1233
epoch [89/200] batch [5/12] time 0.294 (0.295) data 0.215 (0.217) loss_x loss_x 0.3884 (0.3406) acc_x 93.7500 (93.1250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/12] time 0.304 (0.303) data 0.226 (0.226) loss_x loss_x 0.3132 (0.4027) acc_x 93.7500 (92.1875) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 561
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:306
clean false:77
clean_rate:0.7989556135770235
noisy true:765
noisy false:484
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [90/200] batch [5/11] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.5654 (0.4340) acc_x 87.5000 (90.0000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/11] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.5430 (0.4456) acc_x 87.5000 (88.7500) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 572
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:308
clean false:75
clean_rate:0.804177545691906
noisy true:752
noisy false:497
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [91/200] batch [5/11] time 0.321 (0.342) data 0.244 (0.265) loss_x loss_x 0.3386 (0.2860) acc_x 90.6250 (93.7500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/11] time 0.333 (0.342) data 0.255 (0.265) loss_x loss_x 0.6235 (0.3945) acc_x 87.5000 (91.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 592
confident_label rate tensor(0.2433, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 397
clean true:313
clean false:84
clean_rate:0.7884130982367759
noisy true:727
noisy false:508
after delete: len(clean_dataset) 397
after delete: len(noisy_dataset) 1235
epoch [92/200] batch [5/12] time 0.363 (0.348) data 0.285 (0.270) loss_x loss_x 0.4395 (0.4297) acc_x 93.7500 (89.3750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/12] time 0.333 (0.347) data 0.256 (0.269) loss_x loss_x 0.6016 (0.4373) acc_x 81.2500 (88.4375) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 578
confident_label rate tensor(0.2396, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 391
clean true:320
clean false:71
clean_rate:0.8184143222506394
noisy true:734
noisy false:507
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1241
epoch [93/200] batch [5/12] time 0.353 (0.356) data 0.275 (0.278) loss_x loss_x 0.3511 (0.3363) acc_x 90.6250 (92.5000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/12] time 0.346 (0.350) data 0.269 (0.273) loss_x loss_x 0.3525 (0.4091) acc_x 90.6250 (91.2500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 573
confident_label rate tensor(0.2371, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 387
clean true:312
clean false:75
clean_rate:0.8062015503875969
noisy true:747
noisy false:498
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1245
epoch [94/200] batch [5/12] time 0.311 (0.313) data 0.233 (0.235) loss_x loss_x 0.3516 (0.4495) acc_x 93.7500 (93.1250) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/12] time 0.358 (0.323) data 0.281 (0.245) loss_x loss_x 0.2194 (0.3542) acc_x 93.7500 (94.3750) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 580
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 395
clean true:314
clean false:81
clean_rate:0.7949367088607595
noisy true:738
noisy false:499
after delete: len(clean_dataset) 395
after delete: len(noisy_dataset) 1237
epoch [95/200] batch [5/12] time 0.354 (0.348) data 0.276 (0.270) loss_x loss_x 0.2822 (0.3675) acc_x 96.8750 (93.1250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/12] time 0.353 (0.347) data 0.275 (0.269) loss_x loss_x 0.1959 (0.3498) acc_x 93.7500 (93.1250) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.2463, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 402
clean true:321
clean false:81
clean_rate:0.7985074626865671
noisy true:749
noisy false:481
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1230
epoch [96/200] batch [5/12] time 0.339 (0.339) data 0.262 (0.261) loss_x loss_x 0.2542 (0.4181) acc_x 90.6250 (89.3750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/12] time 0.294 (0.324) data 0.216 (0.246) loss_x loss_x 0.4697 (0.3786) acc_x 81.2500 (88.7500) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 591
confident_label rate tensor(0.2439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 398
clean true:318
clean false:80
clean_rate:0.7989949748743719
noisy true:723
noisy false:511
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1234
epoch [97/200] batch [5/12] time 0.336 (0.350) data 0.258 (0.272) loss_x loss_x 0.1597 (0.3477) acc_x 100.0000 (93.1250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/12] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.4104 (0.3417) acc_x 90.6250 (92.8125) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.2402, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 392
clean true:314
clean false:78
clean_rate:0.8010204081632653
noisy true:743
noisy false:497
after delete: len(clean_dataset) 392
after delete: len(noisy_dataset) 1240
epoch [98/200] batch [5/12] time 0.309 (0.333) data 0.231 (0.255) loss_x loss_x 0.2698 (0.3855) acc_x 96.8750 (90.0000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/12] time 0.347 (0.329) data 0.270 (0.251) loss_x loss_x 0.5166 (0.3487) acc_x 87.5000 (90.6250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.2396, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 391
clean true:315
clean false:76
clean_rate:0.8056265984654731
noisy true:761
noisy false:480
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1241
epoch [99/200] batch [5/12] time 0.362 (0.355) data 0.284 (0.277) loss_x loss_x 0.2827 (0.3529) acc_x 96.8750 (91.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/12] time 0.340 (0.351) data 0.261 (0.273) loss_x loss_x 0.1838 (0.3621) acc_x 100.0000 (92.5000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.2426, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 396
clean true:310
clean false:86
clean_rate:0.7828282828282829
noisy true:772
noisy false:464
all clean rate:  [0.9320388349514563, 0.9368421052631579, 0.9908256880733946, 0.9833333333333333, 0.9831932773109243, 0.9838709677419355, 0.9621848739495799, 0.9699570815450643, 0.9662447257383966, 0.9613733905579399, 0.9770114942528736, 0.9844961240310077, 0.9565217391304348, 0.9642857142857143, 0.9651162790697675, 0.9686274509803922, 0.9626865671641791, 0.9465648854961832, 0.9612403100775194, 0.9653846153846154, 0.9452554744525548, 0.9379562043795621, 0.9157894736842105, 0.931899641577061, 0.9228070175438596, 0.910958904109589, 0.9122807017543859, 0.9105960264900662, 0.9047619047619048, 0.9111842105263158, 0.8841059602649006, 0.8792569659442725, 0.8924050632911392, 0.8910256410256411, 0.887240356083086, 0.8790560471976401, 0.8683385579937304, 0.8773584905660378, 0.8723404255319149, 0.8757763975155279, 0.8635014836795252, 0.8505747126436781, 0.8520710059171598, 0.8370786516853933, 0.8454810495626822, 0.8495575221238938, 0.8414985590778098, 0.8392857142857143, 0.8498498498498499, 0.8375350140056023, 0.833810888252149, 0.8328530259365994, 0.8301369863013699, 0.8214285714285714, 0.825, 0.8319327731092437, 0.8402203856749312, 0.8470254957507082, 0.8368421052631579, 0.8292011019283747, 0.8368983957219251, 0.8181818181818182, 0.8121546961325967, 0.8262032085561497, 0.8337874659400545, 0.8271954674220963, 0.8230563002680965, 0.8201058201058201, 0.8328912466843501, 0.8235294117647058, 0.8451443569553806, 0.8191780821917808, 0.8150134048257373, 0.8203753351206434, 0.8324468085106383, 0.8235294117647058, 0.8227513227513228, 0.8120104438642297, 0.820580474934037, 0.8131578947368421, 0.8092783505154639, 0.8113695090439277, 0.8160621761658031, 0.806970509383378, 0.8125, 0.7915567282321899, 0.8005050505050505, 0.797979797979798, 0.7969924812030075, 0.7989556135770235, 0.804177545691906, 0.7884130982367759, 0.8184143222506394, 0.8062015503875969, 0.7949367088607595, 0.7985074626865671, 0.7989949748743719, 0.8010204081632653, 0.8056265984654731, 0.7828282828282829]
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1236
epoch [100/200] batch [5/12] time 0.348 (0.340) data 0.271 (0.262) loss_x loss_x 0.2852 (0.3224) acc_x 90.6250 (92.5000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/12] time 0.347 (0.340) data 0.269 (0.263) loss_x loss_x 0.3835 (0.3268) acc_x 90.6250 (92.1875) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 409
clean true:326
clean false:83
clean_rate:0.7970660146699267
noisy true:749
noisy false:474
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1223
epoch [101/200] batch [5/12] time 0.343 (0.344) data 0.265 (0.267) loss_x loss_x 0.2319 (0.2982) acc_x 93.7500 (92.5000) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/12] time 0.346 (0.344) data 0.269 (0.267) loss_x loss_x 0.3618 (0.3062) acc_x 87.5000 (92.1875) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.2445, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 399
clean true:317
clean false:82
clean_rate:0.7944862155388471
noisy true:759
noisy false:474
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1233
epoch [102/200] batch [5/12] time 0.343 (0.350) data 0.266 (0.273) loss_x loss_x 0.5845 (0.3517) acc_x 84.3750 (92.5000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/12] time 0.349 (0.351) data 0.272 (0.273) loss_x loss_x 0.6318 (0.4154) acc_x 78.1250 (90.0000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 571
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 394
clean true:316
clean false:78
clean_rate:0.8020304568527918
noisy true:745
noisy false:493
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1238
epoch [103/200] batch [5/12] time 0.342 (0.356) data 0.265 (0.278) loss_x loss_x 0.4055 (0.3660) acc_x 93.7500 (91.8750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/12] time 0.341 (0.354) data 0.262 (0.277) loss_x loss_x 0.2698 (0.3387) acc_x 93.7500 (92.5000) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 548
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 413
clean true:326
clean false:87
clean_rate:0.7893462469733656
noisy true:758
noisy false:461
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1219
epoch [104/200] batch [5/12] time 0.359 (0.359) data 0.281 (0.281) loss_x loss_x 0.3696 (0.3450) acc_x 93.7500 (92.5000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/12] time 0.341 (0.351) data 0.263 (0.273) loss_x loss_x 0.4417 (0.3730) acc_x 93.7500 (91.5625) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 573
confident_label rate tensor(0.2396, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 391
clean true:311
clean false:80
clean_rate:0.7953964194373402
noisy true:748
noisy false:493
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1241
epoch [105/200] batch [5/12] time 0.327 (0.342) data 0.248 (0.264) loss_x loss_x 0.5210 (0.3260) acc_x 84.3750 (91.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/12] time 0.361 (0.347) data 0.283 (0.269) loss_x loss_x 0.4128 (0.3706) acc_x 87.5000 (90.0000) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 573
confident_label rate tensor(0.2402, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 392
clean true:312
clean false:80
clean_rate:0.7959183673469388
noisy true:747
noisy false:493
after delete: len(clean_dataset) 392
after delete: len(noisy_dataset) 1240
epoch [106/200] batch [5/12] time 0.330 (0.342) data 0.252 (0.264) loss_x loss_x 0.3091 (0.3229) acc_x 93.7500 (90.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/12] time 0.316 (0.337) data 0.237 (0.259) loss_x loss_x 0.1782 (0.3249) acc_x 93.7500 (90.9375) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 567
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 394
clean true:313
clean false:81
clean_rate:0.7944162436548223
noisy true:752
noisy false:486
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1238
epoch [107/200] batch [5/12] time 0.345 (0.353) data 0.267 (0.275) loss_x loss_x 0.2991 (0.4516) acc_x 90.6250 (89.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/12] time 0.296 (0.335) data 0.219 (0.257) loss_x loss_x 0.1490 (0.3696) acc_x 93.7500 (90.6250) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2426, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 396
clean true:313
clean false:83
clean_rate:0.7904040404040404
noisy true:761
noisy false:475
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1236
epoch [108/200] batch [5/12] time 0.366 (0.344) data 0.288 (0.265) loss_x loss_x 0.2401 (0.3562) acc_x 93.7500 (90.0000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/12] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.1522 (0.3774) acc_x 100.0000 (90.9375) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 560
confident_label rate tensor(0.2457, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 401
clean true:321
clean false:80
clean_rate:0.800498753117207
noisy true:751
noisy false:480
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 1231
epoch [109/200] batch [5/12] time 0.300 (0.313) data 0.222 (0.235) loss_x loss_x 0.1691 (0.3758) acc_x 96.8750 (91.2500) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/12] time 0.355 (0.322) data 0.277 (0.244) loss_x loss_x 0.5737 (0.3616) acc_x 87.5000 (92.5000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.2518, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 411
clean true:322
clean false:89
clean_rate:0.7834549878345499
noisy true:746
noisy false:475
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1221
epoch [110/200] batch [5/12] time 0.340 (0.333) data 0.262 (0.255) loss_x loss_x 0.2603 (0.4085) acc_x 93.7500 (88.7500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/12] time 0.326 (0.333) data 0.248 (0.255) loss_x loss_x 0.2010 (0.3946) acc_x 100.0000 (91.5625) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 406
clean true:320
clean false:86
clean_rate:0.7881773399014779
noisy true:743
noisy false:483
after delete: len(clean_dataset) 406
after delete: len(noisy_dataset) 1226
epoch [111/200] batch [5/12] time 0.350 (0.345) data 0.273 (0.267) loss_x loss_x 0.1555 (0.3504) acc_x 96.8750 (91.2500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/12] time 0.341 (0.345) data 0.263 (0.268) loss_x loss_x 0.4966 (0.3504) acc_x 87.5000 (91.5625) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 571
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 409
clean true:325
clean false:84
clean_rate:0.7946210268948656
noisy true:736
noisy false:487
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1223
epoch [112/200] batch [5/12] time 0.370 (0.386) data 0.291 (0.307) loss_x loss_x 0.2378 (0.2913) acc_x 93.7500 (95.0000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/12] time 0.326 (0.350) data 0.248 (0.271) loss_x loss_x 0.2949 (0.3703) acc_x 93.7500 (92.5000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 567
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 406
clean true:320
clean false:86
clean_rate:0.7881773399014779
noisy true:745
noisy false:481
after delete: len(clean_dataset) 406
after delete: len(noisy_dataset) 1226
epoch [113/200] batch [5/12] time 0.366 (0.325) data 0.289 (0.247) loss_x loss_x 0.2773 (0.5056) acc_x 90.6250 (88.7500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/12] time 0.335 (0.335) data 0.258 (0.258) loss_x loss_x 0.5195 (0.4423) acc_x 90.6250 (89.3750) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 548
confident_label rate tensor(0.2439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 398
clean true:313
clean false:85
clean_rate:0.7864321608040201
noisy true:771
noisy false:463
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1234
epoch [114/200] batch [5/12] time 0.350 (0.355) data 0.273 (0.277) loss_x loss_x 0.6279 (0.3449) acc_x 87.5000 (92.5000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/12] time 0.335 (0.349) data 0.257 (0.271) loss_x loss_x 0.4377 (0.3503) acc_x 93.7500 (93.4375) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 568
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 408
clean true:314
clean false:94
clean_rate:0.7696078431372549
noisy true:750
noisy false:474
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1224
epoch [115/200] batch [5/12] time 0.347 (0.357) data 0.270 (0.279) loss_x loss_x 0.3796 (0.3694) acc_x 93.7500 (93.1250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/12] time 0.335 (0.352) data 0.257 (0.274) loss_x loss_x 0.1154 (0.3015) acc_x 100.0000 (94.3750) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 568
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:316
clean false:91
clean_rate:0.7764127764127764
noisy true:748
noisy false:477
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [116/200] batch [5/12] time 0.352 (0.351) data 0.274 (0.273) loss_x loss_x 0.2898 (0.5739) acc_x 96.8750 (88.1250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/12] time 0.342 (0.345) data 0.265 (0.268) loss_x loss_x 0.5767 (0.4640) acc_x 90.6250 (89.6875) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 553
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:316
clean false:91
clean_rate:0.7764127764127764
noisy true:763
noisy false:462
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [117/200] batch [5/12] time 0.335 (0.341) data 0.257 (0.263) loss_x loss_x 0.2942 (0.3570) acc_x 93.7500 (91.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/12] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.3696 (0.3594) acc_x 93.7500 (92.8125) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 420
clean true:328
clean false:92
clean_rate:0.780952380952381
noisy true:730
noisy false:482
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1212
epoch [118/200] batch [5/13] time 0.345 (0.352) data 0.267 (0.274) loss_x loss_x 0.5210 (0.4143) acc_x 87.5000 (90.6250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/13] time 0.338 (0.349) data 0.260 (0.271) loss_x loss_x 0.2776 (0.3646) acc_x 96.8750 (91.5625) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:319
clean false:88
clean_rate:0.7837837837837838
noisy true:756
noisy false:469
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [119/200] batch [5/12] time 0.356 (0.351) data 0.277 (0.273) loss_x loss_x 0.4387 (0.2726) acc_x 87.5000 (93.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/12] time 0.335 (0.350) data 0.257 (0.272) loss_x loss_x 0.2717 (0.3318) acc_x 93.7500 (92.1875) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 570
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:318
clean false:89
clean_rate:0.7813267813267813
noisy true:744
noisy false:481
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [120/200] batch [5/12] time 0.339 (0.356) data 0.261 (0.279) loss_x loss_x 0.5073 (0.3356) acc_x 90.6250 (91.8750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/12] time 0.337 (0.350) data 0.260 (0.273) loss_x loss_x 0.5806 (0.3554) acc_x 90.6250 (92.1875) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 408
clean true:316
clean false:92
clean_rate:0.7745098039215687
noisy true:747
noisy false:477
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1224
epoch [121/200] batch [5/12] time 0.350 (0.351) data 0.273 (0.273) loss_x loss_x 0.2930 (0.2560) acc_x 93.7500 (94.3750) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/12] time 0.346 (0.351) data 0.269 (0.273) loss_x loss_x 0.1007 (0.2958) acc_x 100.0000 (93.4375) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 408
clean true:317
clean false:91
clean_rate:0.7769607843137255
noisy true:759
noisy false:465
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1224
epoch [122/200] batch [5/12] time 0.318 (0.336) data 0.241 (0.258) loss_x loss_x 0.4353 (0.3240) acc_x 87.5000 (93.1250) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/12] time 0.310 (0.328) data 0.231 (0.250) loss_x loss_x 0.4175 (0.3541) acc_x 90.6250 (91.8750) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.2518, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 411
clean true:322
clean false:89
clean_rate:0.7834549878345499
noisy true:760
noisy false:461
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1221
epoch [123/200] batch [5/12] time 0.327 (0.334) data 0.249 (0.256) loss_x loss_x 0.2279 (0.3874) acc_x 93.7500 (88.7500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/12] time 0.330 (0.337) data 0.253 (0.260) loss_x loss_x 0.5962 (0.3555) acc_x 90.6250 (91.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 553
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 409
clean true:319
clean false:90
clean_rate:0.7799511002444988
noisy true:760
noisy false:463
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1223
epoch [124/200] batch [5/12] time 0.351 (0.329) data 0.273 (0.251) loss_x loss_x 0.3284 (0.3685) acc_x 90.6250 (91.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/12] time 0.358 (0.341) data 0.280 (0.263) loss_x loss_x 0.1774 (0.3399) acc_x 93.7500 (93.1250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 544
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:320
clean false:87
clean_rate:0.7862407862407862
noisy true:768
noisy false:457
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [125/200] batch [5/12] time 0.303 (0.319) data 0.224 (0.241) loss_x loss_x 0.4661 (0.3849) acc_x 87.5000 (90.0000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/12] time 0.346 (0.322) data 0.268 (0.244) loss_x loss_x 0.4932 (0.4693) acc_x 90.6250 (89.3750) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 566
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 409
clean true:314
clean false:95
clean_rate:0.7677261613691931
noisy true:752
noisy false:471
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1223
epoch [126/200] batch [5/12] time 0.352 (0.351) data 0.274 (0.273) loss_x loss_x 0.1881 (0.3316) acc_x 96.8750 (91.2500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/12] time 0.306 (0.332) data 0.228 (0.254) loss_x loss_x 0.2064 (0.3535) acc_x 100.0000 (91.2500) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 555
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:317
clean false:90
clean_rate:0.7788697788697788
noisy true:760
noisy false:465
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [127/200] batch [5/12] time 0.337 (0.346) data 0.260 (0.268) loss_x loss_x 0.3367 (0.3020) acc_x 90.6250 (93.7500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/12] time 0.349 (0.347) data 0.270 (0.269) loss_x loss_x 0.1953 (0.3543) acc_x 93.7500 (92.8125) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 580
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:317
clean false:90
clean_rate:0.7788697788697788
noisy true:735
noisy false:490
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [128/200] batch [5/12] time 0.348 (0.342) data 0.271 (0.265) loss_x loss_x 0.4353 (0.2772) acc_x 87.5000 (94.3750) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/12] time 0.355 (0.344) data 0.277 (0.267) loss_x loss_x 0.2773 (0.2775) acc_x 93.7500 (93.4375) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 566
confident_label rate tensor(0.2512, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 410
clean true:323
clean false:87
clean_rate:0.7878048780487805
noisy true:743
noisy false:479
after delete: len(clean_dataset) 410
after delete: len(noisy_dataset) 1222
epoch [129/200] batch [5/12] time 0.346 (0.349) data 0.268 (0.271) loss_x loss_x 0.3418 (0.3087) acc_x 90.6250 (92.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/12] time 0.362 (0.347) data 0.284 (0.269) loss_x loss_x 0.4019 (0.3379) acc_x 93.7500 (91.8750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.2457, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 401
clean true:316
clean false:85
clean_rate:0.7880299251870324
noisy true:741
noisy false:490
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 1231
epoch [130/200] batch [5/12] time 0.326 (0.334) data 0.248 (0.257) loss_x loss_x 0.3528 (0.4500) acc_x 90.6250 (88.7500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/12] time 0.331 (0.333) data 0.254 (0.255) loss_x loss_x 0.5239 (0.4507) acc_x 78.1250 (87.1875) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 544
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 422
clean true:325
clean false:97
clean_rate:0.7701421800947867
noisy true:763
noisy false:447
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1210
epoch [131/200] batch [5/13] time 0.338 (0.348) data 0.260 (0.269) loss_x loss_x 0.5205 (0.3788) acc_x 93.7500 (91.8750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/13] time 0.365 (0.350) data 0.288 (0.272) loss_x loss_x 0.3733 (0.3586) acc_x 90.6250 (91.8750) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 552
confident_label rate tensor(0.2549, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 416
clean true:324
clean false:92
clean_rate:0.7788461538461539
noisy true:756
noisy false:460
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1216
epoch [132/200] batch [5/13] time 0.341 (0.348) data 0.263 (0.270) loss_x loss_x 0.4856 (0.2805) acc_x 90.6250 (95.0000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/13] time 0.335 (0.347) data 0.258 (0.270) loss_x loss_x 0.3159 (0.2869) acc_x 93.7500 (95.0000) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.2525, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 412
clean true:321
clean false:91
clean_rate:0.779126213592233
noisy true:747
noisy false:473
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1220
epoch [133/200] batch [5/12] time 0.350 (0.352) data 0.273 (0.273) loss_x loss_x 0.4604 (0.3628) acc_x 87.5000 (91.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/12] time 0.339 (0.344) data 0.262 (0.266) loss_x loss_x 0.1642 (0.3316) acc_x 100.0000 (91.8750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:328
clean false:99
clean_rate:0.7681498829039812
noisy true:723
noisy false:482
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [134/200] batch [5/13] time 0.352 (0.355) data 0.274 (0.278) loss_x loss_x 0.4365 (0.3998) acc_x 90.6250 (91.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/13] time 0.349 (0.348) data 0.271 (0.271) loss_x loss_x 0.4775 (0.3782) acc_x 87.5000 (91.5625) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 561
confident_label rate tensor(0.2555, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 417
clean true:321
clean false:96
clean_rate:0.7697841726618705
noisy true:750
noisy false:465
after delete: len(clean_dataset) 417
after delete: len(noisy_dataset) 1215
epoch [135/200] batch [5/13] time 0.344 (0.354) data 0.267 (0.276) loss_x loss_x 0.1487 (0.2374) acc_x 96.8750 (94.3750) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/13] time 0.344 (0.350) data 0.266 (0.273) loss_x loss_x 0.7686 (0.3410) acc_x 78.1250 (92.1875) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 567
confident_label rate tensor(0.2592, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 423
clean true:323
clean false:100
clean_rate:0.7635933806146572
noisy true:742
noisy false:467
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1209
epoch [136/200] batch [5/13] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.3987 (0.3296) acc_x 90.6250 (91.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/13] time 0.341 (0.341) data 0.263 (0.263) loss_x loss_x 0.4729 (0.3378) acc_x 87.5000 (90.9375) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 543
confident_label rate tensor(0.2604, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 425
clean true:327
clean false:98
clean_rate:0.7694117647058824
noisy true:762
noisy false:445
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1207
epoch [137/200] batch [5/13] time 0.326 (0.339) data 0.248 (0.261) loss_x loss_x 0.6279 (0.3825) acc_x 90.6250 (91.8750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/13] time 0.334 (0.339) data 0.256 (0.261) loss_x loss_x 0.2971 (0.4566) acc_x 96.8750 (91.2500) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 566
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 419
clean true:322
clean false:97
clean_rate:0.7684964200477327
noisy true:744
noisy false:469
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1213
epoch [138/200] batch [5/13] time 0.288 (0.334) data 0.210 (0.257) loss_x loss_x 0.5645 (0.4420) acc_x 84.3750 (90.0000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/13] time 0.332 (0.330) data 0.255 (0.253) loss_x loss_x 0.5010 (0.3682) acc_x 81.2500 (90.3125) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 578
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 413
clean true:321
clean false:92
clean_rate:0.7772397094430993
noisy true:733
noisy false:486
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1219
epoch [139/200] batch [5/12] time 0.344 (0.354) data 0.266 (0.276) loss_x loss_x 0.2910 (0.3467) acc_x 93.7500 (91.2500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/12] time 0.340 (0.348) data 0.262 (0.270) loss_x loss_x 0.3625 (0.3430) acc_x 93.7500 (91.8750) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.2537, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 414
clean true:320
clean false:94
clean_rate:0.7729468599033816
noisy true:750
noisy false:468
after delete: len(clean_dataset) 414
after delete: len(noisy_dataset) 1218
epoch [140/200] batch [5/12] time 0.342 (0.349) data 0.265 (0.271) loss_x loss_x 0.3362 (0.4035) acc_x 93.7500 (90.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/12] time 0.349 (0.342) data 0.271 (0.264) loss_x loss_x 0.4993 (0.3388) acc_x 87.5000 (92.8125) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 576
confident_label rate tensor(0.2592, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 423
clean true:327
clean false:96
clean_rate:0.7730496453900709
noisy true:729
noisy false:480
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1209
epoch [141/200] batch [5/13] time 0.352 (0.341) data 0.275 (0.263) loss_x loss_x 0.2333 (0.2854) acc_x 93.7500 (95.0000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/13] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.4536 (0.3872) acc_x 81.2500 (90.9375) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.2641, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 431
clean true:329
clean false:102
clean_rate:0.7633410672853829
noisy true:754
noisy false:447
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1201
epoch [142/200] batch [5/13] time 0.300 (0.308) data 0.222 (0.230) loss_x loss_x 0.3948 (0.3777) acc_x 87.5000 (91.8750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/13] time 0.339 (0.315) data 0.261 (0.237) loss_x loss_x 0.2791 (0.3595) acc_x 90.6250 (91.5625) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 576
confident_label rate tensor(0.2623, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 428
clean true:326
clean false:102
clean_rate:0.7616822429906542
noisy true:730
noisy false:474
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1204
epoch [143/200] batch [5/13] time 0.334 (0.348) data 0.256 (0.270) loss_x loss_x 0.4224 (0.3261) acc_x 87.5000 (91.8750) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/13] time 0.309 (0.331) data 0.231 (0.254) loss_x loss_x 0.4927 (0.3587) acc_x 90.6250 (91.5625) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 553
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 409
clean true:320
clean false:89
clean_rate:0.78239608801956
noisy true:759
noisy false:464
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1223
epoch [144/200] batch [5/12] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.2120 (0.3681) acc_x 93.7500 (91.2500) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/12] time 0.331 (0.347) data 0.254 (0.269) loss_x loss_x 0.6465 (0.3528) acc_x 93.7500 (92.8125) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 413
clean true:321
clean false:92
clean_rate:0.7772397094430993
noisy true:753
noisy false:466
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1219
epoch [145/200] batch [5/12] time 0.351 (0.346) data 0.274 (0.268) loss_x loss_x 0.2837 (0.2898) acc_x 93.7500 (94.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/12] time 0.341 (0.342) data 0.264 (0.265) loss_x loss_x 0.2468 (0.3229) acc_x 93.7500 (92.5000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.2561, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 418
clean true:327
clean false:91
clean_rate:0.7822966507177034
noisy true:756
noisy false:458
after delete: len(clean_dataset) 418
after delete: len(noisy_dataset) 1214
epoch [146/200] batch [5/13] time 0.347 (0.342) data 0.269 (0.264) loss_x loss_x 0.4023 (0.4347) acc_x 87.5000 (90.6250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/13] time 0.342 (0.342) data 0.264 (0.264) loss_x loss_x 0.1826 (0.3497) acc_x 96.8750 (92.1875) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 586
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 413
clean true:313
clean false:100
clean_rate:0.7578692493946732
noisy true:733
noisy false:486
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1219
epoch [147/200] batch [5/12] time 0.343 (0.352) data 0.266 (0.274) loss_x loss_x 0.3972 (0.3386) acc_x 93.7500 (93.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/12] time 0.348 (0.349) data 0.271 (0.272) loss_x loss_x 0.5200 (0.3702) acc_x 84.3750 (92.1875) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 548
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 422
clean true:323
clean false:99
clean_rate:0.7654028436018957
noisy true:761
noisy false:449
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1210
epoch [148/200] batch [5/13] time 0.338 (0.343) data 0.261 (0.266) loss_x loss_x 0.3459 (0.3493) acc_x 93.7500 (95.6250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/13] time 0.334 (0.343) data 0.256 (0.266) loss_x loss_x 0.3472 (0.3599) acc_x 90.6250 (92.5000) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.2518, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 411
clean true:314
clean false:97
clean_rate:0.7639902676399026
noisy true:761
noisy false:460
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1221
epoch [149/200] batch [5/12] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.4397 (0.3863) acc_x 90.6250 (91.2500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/12] time 0.330 (0.340) data 0.253 (0.263) loss_x loss_x 0.1982 (0.3422) acc_x 96.8750 (92.5000) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 561
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:328
clean false:99
clean_rate:0.7681498829039812
noisy true:743
noisy false:462
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [150/200] batch [5/13] time 0.302 (0.329) data 0.224 (0.251) loss_x loss_x 0.3557 (0.3281) acc_x 90.6250 (91.2500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/13] time 0.348 (0.324) data 0.270 (0.246) loss_x loss_x 0.6323 (0.3927) acc_x 84.3750 (90.3125) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 567
confident_label rate tensor(0.2598, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 424
clean true:330
clean false:94
clean_rate:0.7783018867924528
noisy true:735
noisy false:473
after delete: len(clean_dataset) 424
after delete: len(noisy_dataset) 1208
epoch [151/200] batch [5/13] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.4470 (0.4097) acc_x 87.5000 (88.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/13] time 0.345 (0.341) data 0.268 (0.264) loss_x loss_x 0.2842 (0.4241) acc_x 90.6250 (89.6875) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 554
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 419
clean true:324
clean false:95
clean_rate:0.7732696897374701
noisy true:754
noisy false:459
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1213
epoch [152/200] batch [5/13] time 0.346 (0.331) data 0.268 (0.253) loss_x loss_x 0.4304 (0.3680) acc_x 81.2500 (92.5000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/13] time 0.336 (0.336) data 0.258 (0.258) loss_x loss_x 0.2576 (0.3481) acc_x 90.6250 (91.8750) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 421
clean true:329
clean false:92
clean_rate:0.7814726840855107
noisy true:754
noisy false:457
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1211
epoch [153/200] batch [5/13] time 0.350 (0.342) data 0.273 (0.264) loss_x loss_x 0.2715 (0.3292) acc_x 96.8750 (93.1250) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/13] time 0.299 (0.319) data 0.222 (0.242) loss_x loss_x 0.5430 (0.3538) acc_x 90.6250 (92.5000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.2555, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 417
clean true:317
clean false:100
clean_rate:0.7601918465227818
noisy true:753
noisy false:462
after delete: len(clean_dataset) 417
after delete: len(noisy_dataset) 1215
epoch [154/200] batch [5/13] time 0.348 (0.348) data 0.271 (0.270) loss_x loss_x 0.4299 (0.3123) acc_x 87.5000 (92.5000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/13] time 0.341 (0.348) data 0.264 (0.271) loss_x loss_x 0.5200 (0.3356) acc_x 81.2500 (90.9375) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 413
clean true:318
clean false:95
clean_rate:0.7699757869249395
noisy true:750
noisy false:469
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1219
epoch [155/200] batch [5/12] time 0.345 (0.354) data 0.268 (0.277) loss_x loss_x 0.4587 (0.3343) acc_x 84.3750 (93.1250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/12] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.2487 (0.3004) acc_x 93.7500 (93.4375) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.2610, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 426
clean true:325
clean false:101
clean_rate:0.7629107981220657
noisy true:758
noisy false:448
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1206
epoch [156/200] batch [5/13] time 0.364 (0.353) data 0.287 (0.276) loss_x loss_x 0.3491 (0.3072) acc_x 90.6250 (91.8750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/13] time 0.344 (0.350) data 0.266 (0.273) loss_x loss_x 0.5176 (0.3762) acc_x 90.6250 (90.6250) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 554
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 421
clean true:325
clean false:96
clean_rate:0.7719714964370546
noisy true:753
noisy false:458
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1211
epoch [157/200] batch [5/13] time 0.341 (0.350) data 0.263 (0.272) loss_x loss_x 0.3770 (0.3332) acc_x 90.6250 (93.7500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/13] time 0.342 (0.347) data 0.264 (0.270) loss_x loss_x 0.3662 (0.3417) acc_x 90.6250 (93.4375) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.2555, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 417
clean true:319
clean false:98
clean_rate:0.7649880095923262
noisy true:756
noisy false:459
after delete: len(clean_dataset) 417
after delete: len(noisy_dataset) 1215
epoch [158/200] batch [5/13] time 0.339 (0.346) data 0.262 (0.268) loss_x loss_x 0.3430 (0.2929) acc_x 90.6250 (91.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/13] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.2002 (0.2892) acc_x 100.0000 (93.4375) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 540
confident_label rate tensor(0.2647, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 432
clean true:333
clean false:99
clean_rate:0.7708333333333334
noisy true:759
noisy false:441
after delete: len(clean_dataset) 432
after delete: len(noisy_dataset) 1200
epoch [159/200] batch [5/13] time 0.380 (0.361) data 0.302 (0.283) loss_x loss_x 0.3882 (0.3640) acc_x 93.7500 (92.5000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/13] time 0.349 (0.354) data 0.272 (0.276) loss_x loss_x 0.4448 (0.3598) acc_x 90.6250 (92.8125) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 551
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 422
clean true:326
clean false:96
clean_rate:0.7725118483412322
noisy true:755
noisy false:455
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1210
epoch [160/200] batch [5/13] time 0.340 (0.357) data 0.262 (0.279) loss_x loss_x 0.2878 (0.2781) acc_x 93.7500 (95.0000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/13] time 0.358 (0.351) data 0.281 (0.273) loss_x loss_x 0.4216 (0.2975) acc_x 96.8750 (95.0000) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 543
confident_label rate tensor(0.2604, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 425
clean true:326
clean false:99
clean_rate:0.7670588235294118
noisy true:763
noisy false:444
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1207
epoch [161/200] batch [5/13] time 0.348 (0.353) data 0.271 (0.275) loss_x loss_x 0.2595 (0.2996) acc_x 93.7500 (91.8750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/13] time 0.352 (0.352) data 0.273 (0.274) loss_x loss_x 0.5298 (0.3258) acc_x 84.3750 (92.1875) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.2610, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 426
clean true:320
clean false:106
clean_rate:0.7511737089201878
noisy true:781
noisy false:425
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1206
epoch [162/200] batch [5/13] time 0.339 (0.352) data 0.261 (0.274) loss_x loss_x 0.4478 (0.2720) acc_x 90.6250 (95.0000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/13] time 0.348 (0.352) data 0.271 (0.274) loss_x loss_x 0.2542 (0.2916) acc_x 96.8750 (93.4375) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 547
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:323
clean false:104
clean_rate:0.7564402810304449
noisy true:762
noisy false:443
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [163/200] batch [5/13] time 0.346 (0.351) data 0.268 (0.274) loss_x loss_x 0.2095 (0.2991) acc_x 96.8750 (93.1250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/13] time 0.348 (0.348) data 0.270 (0.271) loss_x loss_x 0.5127 (0.3084) acc_x 87.5000 (93.7500) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.2623, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 428
clean true:321
clean false:107
clean_rate:0.75
noisy true:742
noisy false:462
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1204
epoch [164/200] batch [5/13] time 0.336 (0.348) data 0.259 (0.270) loss_x loss_x 0.8022 (0.3843) acc_x 75.0000 (92.5000) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/13] time 0.353 (0.346) data 0.275 (0.269) loss_x loss_x 0.1732 (0.3241) acc_x 96.8750 (93.7500) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 541
confident_label rate tensor(0.2659, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 434
clean true:331
clean false:103
clean_rate:0.7626728110599078
noisy true:760
noisy false:438
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1198
epoch [165/200] batch [5/13] time 0.324 (0.338) data 0.247 (0.260) loss_x loss_x 0.1377 (0.2979) acc_x 100.0000 (94.3750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/13] time 0.335 (0.340) data 0.257 (0.262) loss_x loss_x 0.7349 (0.3508) acc_x 81.2500 (92.8125) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 572
confident_label rate tensor(0.2684, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 438
clean true:326
clean false:112
clean_rate:0.7442922374429224
noisy true:734
noisy false:460
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1194
epoch [166/200] batch [5/13] time 0.343 (0.327) data 0.265 (0.249) loss_x loss_x 0.4067 (0.4193) acc_x 87.5000 (87.5000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/13] time 0.333 (0.332) data 0.256 (0.254) loss_x loss_x 0.3330 (0.4035) acc_x 90.6250 (88.4375) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 568
confident_label rate tensor(0.2696, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 440
clean true:330
clean false:110
clean_rate:0.75
noisy true:734
noisy false:458
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1192
epoch [167/200] batch [5/13] time 0.350 (0.344) data 0.273 (0.266) loss_x loss_x 0.3369 (0.3727) acc_x 93.7500 (91.2500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/13] time 0.326 (0.342) data 0.247 (0.265) loss_x loss_x 0.4827 (0.3857) acc_x 87.5000 (90.6250) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.2665, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 435
clean true:329
clean false:106
clean_rate:0.7563218390804598
noisy true:746
noisy false:451
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1197
epoch [168/200] batch [5/13] time 0.323 (0.340) data 0.245 (0.263) loss_x loss_x 0.4031 (0.2747) acc_x 87.5000 (93.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/13] time 0.353 (0.346) data 0.276 (0.269) loss_x loss_x 0.2898 (0.2794) acc_x 90.6250 (93.4375) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 430
clean true:325
clean false:105
clean_rate:0.7558139534883721
noisy true:738
noisy false:464
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1202
epoch [169/200] batch [5/13] time 0.307 (0.311) data 0.229 (0.233) loss_x loss_x 0.2443 (0.2821) acc_x 96.8750 (94.3750) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/13] time 0.351 (0.327) data 0.272 (0.248) loss_x loss_x 0.2283 (0.2984) acc_x 93.7500 (93.4375) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 588
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:319
clean false:108
clean_rate:0.747072599531616
noisy true:725
noisy false:480
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [170/200] batch [5/13] time 0.342 (0.360) data 0.264 (0.282) loss_x loss_x 0.3906 (0.3723) acc_x 96.8750 (92.5000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/13] time 0.304 (0.332) data 0.225 (0.254) loss_x loss_x 0.1361 (0.3755) acc_x 100.0000 (92.8125) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 567
confident_label rate tensor(0.2678, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 437
clean true:328
clean false:109
clean_rate:0.7505720823798627
noisy true:737
noisy false:458
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1195
epoch [171/200] batch [5/13] time 0.362 (0.353) data 0.284 (0.275) loss_x loss_x 0.1869 (0.2553) acc_x 96.8750 (96.2500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/13] time 0.349 (0.353) data 0.272 (0.275) loss_x loss_x 0.2367 (0.2608) acc_x 96.8750 (95.0000) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 542
confident_label rate tensor(0.2653, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 433
clean true:329
clean false:104
clean_rate:0.7598152424942263
noisy true:761
noisy false:438
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1199
epoch [172/200] batch [5/13] time 0.340 (0.352) data 0.262 (0.274) loss_x loss_x 0.2311 (0.1874) acc_x 96.8750 (96.2500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/13] time 0.343 (0.350) data 0.266 (0.273) loss_x loss_x 0.2183 (0.2608) acc_x 100.0000 (94.6875) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2690, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 439
clean true:333
clean false:106
clean_rate:0.7585421412300684
noisy true:741
noisy false:452
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1193
epoch [173/200] batch [5/13] time 0.339 (0.352) data 0.262 (0.274) loss_x loss_x 0.3154 (0.2884) acc_x 90.6250 (92.5000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/13] time 0.342 (0.350) data 0.264 (0.273) loss_x loss_x 0.4636 (0.2828) acc_x 87.5000 (93.1250) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 578
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 420
clean true:315
clean false:105
clean_rate:0.75
noisy true:739
noisy false:473
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1212
epoch [174/200] batch [5/13] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.2803 (0.3399) acc_x 93.7500 (93.7500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/13] time 0.367 (0.344) data 0.289 (0.266) loss_x loss_x 0.1624 (0.3479) acc_x 96.8750 (93.1250) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 559
confident_label rate tensor(0.2659, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 434
clean true:326
clean false:108
clean_rate:0.7511520737327189
noisy true:747
noisy false:451
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1198
epoch [175/200] batch [5/13] time 0.329 (0.351) data 0.251 (0.273) loss_x loss_x 0.2208 (0.2208) acc_x 93.7500 (96.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/13] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.3826 (0.2728) acc_x 93.7500 (94.3750) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:323
clean false:104
clean_rate:0.7564402810304449
noisy true:759
noisy false:446
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [176/200] batch [5/13] time 0.350 (0.350) data 0.273 (0.273) loss_x loss_x 0.4111 (0.3521) acc_x 90.6250 (92.5000) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/13] time 0.340 (0.349) data 0.263 (0.271) loss_x loss_x 0.3186 (0.3494) acc_x 93.7500 (92.8125) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.2641, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 431
clean true:321
clean false:110
clean_rate:0.7447795823665894
noisy true:747
noisy false:454
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1201
epoch [177/200] batch [5/13] time 0.351 (0.352) data 0.274 (0.274) loss_x loss_x 0.1873 (0.2443) acc_x 100.0000 (94.3750) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/13] time 0.347 (0.348) data 0.270 (0.271) loss_x loss_x 0.4900 (0.3036) acc_x 78.1250 (91.8750) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 537
confident_label rate tensor(0.2629, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 429
clean true:328
clean false:101
clean_rate:0.7645687645687645
noisy true:767
noisy false:436
after delete: len(clean_dataset) 429
after delete: len(noisy_dataset) 1203
epoch [178/200] batch [5/13] time 0.342 (0.341) data 0.264 (0.264) loss_x loss_x 0.6973 (0.4439) acc_x 78.1250 (88.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/13] time 0.333 (0.342) data 0.256 (0.265) loss_x loss_x 0.2212 (0.3835) acc_x 93.7500 (90.3125) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2678, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 437
clean true:331
clean false:106
clean_rate:0.7574370709382151
noisy true:743
noisy false:452
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1195
epoch [179/200] batch [5/13] time 0.310 (0.315) data 0.233 (0.237) loss_x loss_x 0.2603 (0.3403) acc_x 96.8750 (92.5000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/13] time 0.349 (0.330) data 0.272 (0.252) loss_x loss_x 0.2803 (0.3387) acc_x 93.7500 (92.8125) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 565
confident_label rate tensor(0.2653, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 433
clean true:326
clean false:107
clean_rate:0.7528868360277137
noisy true:741
noisy false:458
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1199
epoch [180/200] batch [5/13] time 0.342 (0.346) data 0.264 (0.269) loss_x loss_x 0.3940 (0.3809) acc_x 84.3750 (91.2500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/13] time 0.331 (0.343) data 0.254 (0.265) loss_x loss_x 0.2371 (0.3171) acc_x 93.7500 (93.1250) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 565
confident_label rate tensor(0.2623, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 428
clean true:323
clean false:105
clean_rate:0.7546728971962616
noisy true:744
noisy false:460
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1204
epoch [181/200] batch [5/13] time 0.342 (0.339) data 0.264 (0.261) loss_x loss_x 0.3435 (0.3659) acc_x 90.6250 (93.7500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/13] time 0.338 (0.338) data 0.261 (0.260) loss_x loss_x 0.3596 (0.3341) acc_x 87.5000 (93.4375) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 553
confident_label rate tensor(0.2641, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 431
clean true:326
clean false:105
clean_rate:0.7563805104408353
noisy true:753
noisy false:448
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1201
epoch [182/200] batch [5/13] time 0.331 (0.326) data 0.252 (0.248) loss_x loss_x 0.3745 (0.2706) acc_x 90.6250 (96.2500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/13] time 0.353 (0.334) data 0.276 (0.257) loss_x loss_x 0.3008 (0.2716) acc_x 90.6250 (94.6875) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 430
clean true:326
clean false:104
clean_rate:0.7581395348837209
noisy true:757
noisy false:445
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1202
epoch [183/200] batch [5/13] time 0.303 (0.317) data 0.225 (0.239) loss_x loss_x 0.2842 (0.2881) acc_x 90.6250 (93.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/13] time 0.396 (0.320) data 0.318 (0.242) loss_x loss_x 0.1570 (0.2543) acc_x 96.8750 (94.0625) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 430
clean true:328
clean false:102
clean_rate:0.7627906976744186
noisy true:754
noisy false:448
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1202
epoch [184/200] batch [5/13] time 0.329 (0.338) data 0.250 (0.260) loss_x loss_x 0.5400 (0.3742) acc_x 93.7500 (91.2500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/13] time 0.351 (0.340) data 0.274 (0.262) loss_x loss_x 0.0710 (0.3087) acc_x 100.0000 (93.4375) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 545
confident_label rate tensor(0.2647, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 432
clean true:324
clean false:108
clean_rate:0.75
noisy true:763
noisy false:437
after delete: len(clean_dataset) 432
after delete: len(noisy_dataset) 1200
epoch [185/200] batch [5/13] time 0.345 (0.350) data 0.267 (0.272) loss_x loss_x 0.3716 (0.2734) acc_x 87.5000 (93.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/13] time 0.352 (0.343) data 0.275 (0.265) loss_x loss_x 0.3647 (0.3146) acc_x 93.7500 (92.1875) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 430
clean true:324
clean false:106
clean_rate:0.7534883720930232
noisy true:739
noisy false:463
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1202
epoch [186/200] batch [5/13] time 0.334 (0.334) data 0.256 (0.257) loss_x loss_x 0.6392 (0.4464) acc_x 93.7500 (91.2500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/13] time 0.342 (0.323) data 0.264 (0.245) loss_x loss_x 0.2849 (0.3694) acc_x 90.6250 (91.8750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 541
confident_label rate tensor(0.2702, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 441
clean true:332
clean false:109
clean_rate:0.7528344671201814
noisy true:759
noisy false:432
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1191
epoch [187/200] batch [5/13] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.2261 (0.4180) acc_x 90.6250 (88.1250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/13] time 0.313 (0.339) data 0.235 (0.261) loss_x loss_x 0.2698 (0.3469) acc_x 93.7500 (91.8750) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 572
confident_label rate tensor(0.2684, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 438
clean true:330
clean false:108
clean_rate:0.7534246575342466
noisy true:730
noisy false:464
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1194
epoch [188/200] batch [5/13] time 0.341 (0.348) data 0.264 (0.271) loss_x loss_x 0.3533 (0.3382) acc_x 90.6250 (90.6250) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/13] time 0.342 (0.347) data 0.265 (0.270) loss_x loss_x 0.3152 (0.3365) acc_x 93.7500 (91.2500) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 563
confident_label rate tensor(0.2678, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 437
clean true:319
clean false:118
clean_rate:0.7299771167048055
noisy true:750
noisy false:445
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1195
epoch [189/200] batch [5/13] time 0.356 (0.355) data 0.279 (0.277) loss_x loss_x 0.2593 (0.3318) acc_x 90.6250 (91.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/13] time 0.339 (0.351) data 0.261 (0.273) loss_x loss_x 0.3994 (0.3733) acc_x 90.6250 (91.5625) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 570
confident_label rate tensor(0.2659, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 434
clean true:320
clean false:114
clean_rate:0.7373271889400922
noisy true:742
noisy false:456
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1198
epoch [190/200] batch [5/13] time 0.345 (0.346) data 0.268 (0.269) loss_x loss_x 0.3655 (0.5081) acc_x 90.6250 (88.1250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/13] time 0.351 (0.348) data 0.274 (0.271) loss_x loss_x 0.2532 (0.3934) acc_x 96.8750 (91.5625) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 568
confident_label rate tensor(0.2665, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 435
clean true:329
clean false:106
clean_rate:0.7563218390804598
noisy true:735
noisy false:462
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1197
epoch [191/200] batch [5/13] time 0.351 (0.350) data 0.273 (0.273) loss_x loss_x 0.3130 (0.4818) acc_x 93.7500 (88.7500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/13] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.4062 (0.3767) acc_x 87.5000 (91.2500) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2684, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 438
clean true:327
clean false:111
clean_rate:0.7465753424657534
noisy true:747
noisy false:447
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1194
epoch [192/200] batch [5/13] time 0.352 (0.358) data 0.274 (0.280) loss_x loss_x 0.4631 (0.2822) acc_x 90.6250 (93.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/13] time 0.345 (0.352) data 0.267 (0.274) loss_x loss_x 0.5283 (0.3055) acc_x 87.5000 (92.8125) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 571
confident_label rate tensor(0.2623, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 428
clean true:315
clean false:113
clean_rate:0.735981308411215
noisy true:746
noisy false:458
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1204
epoch [193/200] batch [5/13] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.2405 (0.3163) acc_x 96.8750 (91.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/13] time 0.357 (0.347) data 0.280 (0.269) loss_x loss_x 0.2859 (0.3400) acc_x 96.8750 (91.5625) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:326
clean false:101
clean_rate:0.7634660421545667
noisy true:748
noisy false:457
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [194/200] batch [5/13] time 0.352 (0.347) data 0.275 (0.269) loss_x loss_x 0.4651 (0.3316) acc_x 87.5000 (93.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/13] time 0.323 (0.348) data 0.245 (0.271) loss_x loss_x 0.5093 (0.3243) acc_x 90.6250 (93.1250) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 551
confident_label rate tensor(0.2727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 445
clean true:336
clean false:109
clean_rate:0.755056179775281
noisy true:745
noisy false:442
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1187
epoch [195/200] batch [5/13] time 0.331 (0.343) data 0.253 (0.264) loss_x loss_x 0.5654 (0.3143) acc_x 84.3750 (93.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/13] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.3977 (0.3012) acc_x 96.8750 (92.8125) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 562
confident_label rate tensor(0.2690, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 439
clean true:329
clean false:110
clean_rate:0.7494305239179955
noisy true:741
noisy false:452
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1193
epoch [196/200] batch [5/13] time 0.320 (0.324) data 0.241 (0.246) loss_x loss_x 0.2150 (0.2743) acc_x 96.8750 (95.6250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/13] time 0.350 (0.334) data 0.273 (0.256) loss_x loss_x 0.1787 (0.3123) acc_x 100.0000 (94.3750) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 559
confident_label rate tensor(0.2659, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 434
clean true:325
clean false:109
clean_rate:0.7488479262672811
noisy true:748
noisy false:450
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1198
epoch [197/200] batch [5/13] time 0.351 (0.363) data 0.273 (0.285) loss_x loss_x 0.4087 (0.4943) acc_x 90.6250 (88.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/13] time 0.344 (0.350) data 0.266 (0.272) loss_x loss_x 0.3193 (0.4420) acc_x 90.6250 (90.0000) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 545
confident_label rate tensor(0.2714, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 443
clean true:330
clean false:113
clean_rate:0.744920993227991
noisy true:757
noisy false:432
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1189
epoch [198/200] batch [5/13] time 0.345 (0.338) data 0.267 (0.259) loss_x loss_x 0.3767 (0.3099) acc_x 93.7500 (91.8750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/13] time 0.338 (0.339) data 0.260 (0.262) loss_x loss_x 0.4163 (0.3165) acc_x 93.7500 (92.1875) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 541
confident_label rate tensor(0.2708, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 442
clean true:331
clean false:111
clean_rate:0.748868778280543
noisy true:760
noisy false:430
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1190
epoch [199/200] batch [5/13] time 0.336 (0.329) data 0.259 (0.250) loss_x loss_x 0.2869 (0.2945) acc_x 93.7500 (92.5000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/13] time 0.338 (0.322) data 0.260 (0.244) loss_x loss_x 0.2710 (0.3235) acc_x 90.6250 (92.5000) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 542
confident_label rate tensor(0.2690, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 439
clean true:330
clean false:109
clean_rate:0.7517084282460137
noisy true:760
noisy false:433
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1193
epoch [200/200] batch [5/13] time 0.351 (0.349) data 0.274 (0.271) loss_x loss_x 0.1943 (0.2449) acc_x 93.7500 (95.6250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/13] time 0.308 (0.344) data 0.230 (0.266) loss_x loss_x 0.3020 (0.2690) acc_x 93.7500 (95.0000) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 1,731
* accuracy: 70.3%
* error: 29.7%
* macro_f1: 68.0%
Elapsed: 1:15:44
