***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 282
clean true:280
clean false:2
clean_rate:0.9929078014184397
noisy true:95
noisy false:1255
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1350
epoch [1/200] batch [5/8] time 0.289 (0.309) data 0.211 (0.213) loss_x loss_x 2.6016 (2.6488) acc_x 43.7500 (40.6250) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1181
confident_label rate tensor(0.2010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 328
clean true:326
clean false:2
clean_rate:0.9939024390243902
noisy true:125
noisy false:1179
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1304
epoch [2/200] batch [5/10] time 0.329 (0.342) data 0.251 (0.264) loss_x loss_x 1.0420 (1.2092) acc_x 75.0000 (73.7500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/10] time 0.327 (0.338) data 0.249 (0.260) loss_x loss_x 0.9897 (0.9992) acc_x 75.0000 (77.1875) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 792
confident_label rate tensor(0.3897, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 636
clean true:635
clean false:1
clean_rate:0.9984276729559748
noisy true:205
noisy false:791
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 996
epoch [3/200] batch [5/19] time 0.339 (0.337) data 0.261 (0.259) loss_x loss_x 0.8354 (0.9144) acc_x 84.3750 (74.3750) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/19] time 0.368 (0.342) data 0.291 (0.264) loss_x loss_x 0.8022 (0.9018) acc_x 75.0000 (75.9375) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/19] time 0.346 (0.342) data 0.269 (0.265) loss_x loss_x 0.7007 (0.8845) acc_x 71.8750 (76.2500) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 752
confident_label rate tensor(0.4124, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 673
clean true:672
clean false:1
clean_rate:0.9985141158989599
noisy true:208
noisy false:751
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 959
epoch [4/200] batch [5/21] time 0.339 (0.349) data 0.262 (0.271) loss_x loss_x 1.2109 (0.9107) acc_x 71.8750 (80.6250) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [10/21] time 0.339 (0.343) data 0.261 (0.265) loss_x loss_x 0.7944 (0.9181) acc_x 81.2500 (77.1875) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/21] time 0.351 (0.343) data 0.273 (0.265) loss_x loss_x 0.5679 (0.8502) acc_x 93.7500 (80.8333) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/21] time 0.341 (0.341) data 0.264 (0.264) loss_x loss_x 0.8525 (0.8258) acc_x 78.1250 (80.7812) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 721
confident_label rate tensor(0.4240, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 692
clean true:690
clean false:2
clean_rate:0.9971098265895953
noisy true:221
noisy false:719
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 940
epoch [5/200] batch [5/21] time 0.297 (0.314) data 0.220 (0.236) loss_x loss_x 0.9653 (0.8166) acc_x 71.8750 (81.8750) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/21] time 0.290 (0.303) data 0.212 (0.225) loss_x loss_x 0.8955 (0.8306) acc_x 75.0000 (79.6875) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/21] time 0.398 (0.316) data 0.321 (0.238) loss_x loss_x 0.8687 (0.8155) acc_x 81.2500 (79.7917) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/21] time 0.345 (0.323) data 0.268 (0.245) loss_x loss_x 0.6138 (0.7756) acc_x 87.5000 (81.4062) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 706
confident_label rate tensor(0.4320, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 705
clean true:702
clean false:3
clean_rate:0.9957446808510638
noisy true:224
noisy false:703
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 927
epoch [6/200] batch [5/22] time 0.339 (0.346) data 0.262 (0.268) loss_x loss_x 0.6489 (0.7028) acc_x 75.0000 (81.8750) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [10/22] time 0.296 (0.331) data 0.219 (0.253) loss_x loss_x 1.1318 (0.7952) acc_x 81.2500 (82.1875) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/22] time 0.294 (0.317) data 0.217 (0.240) loss_x loss_x 0.5303 (0.8054) acc_x 87.5000 (81.4583) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/22] time 0.295 (0.310) data 0.218 (0.233) loss_x loss_x 0.9937 (0.8036) acc_x 71.8750 (81.0938) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 699
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 710
clean true:710
clean false:0
clean_rate:1.0
noisy true:223
noisy false:699
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 922
epoch [7/200] batch [5/22] time 0.344 (0.340) data 0.267 (0.263) loss_x loss_x 0.8994 (0.9046) acc_x 87.5000 (81.2500) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/22] time 0.353 (0.343) data 0.275 (0.265) loss_x loss_x 1.0781 (0.8127) acc_x 68.7500 (80.3125) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/22] time 0.318 (0.339) data 0.241 (0.262) loss_x loss_x 1.5176 (0.8465) acc_x 71.8750 (80.8333) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/22] time 0.356 (0.341) data 0.278 (0.264) loss_x loss_x 0.8809 (0.8138) acc_x 78.1250 (81.2500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 698
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:710
clean false:2
clean_rate:0.9971910112359551
noisy true:224
noisy false:696
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [8/200] batch [5/22] time 0.346 (0.343) data 0.268 (0.265) loss_x loss_x 0.8315 (0.6957) acc_x 78.1250 (83.1250) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/22] time 0.290 (0.321) data 0.213 (0.244) loss_x loss_x 1.1064 (0.7117) acc_x 68.7500 (82.1875) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/22] time 0.371 (0.331) data 0.293 (0.254) loss_x loss_x 0.6865 (0.7002) acc_x 81.2500 (82.0833) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/22] time 0.336 (0.334) data 0.259 (0.256) loss_x loss_x 0.5474 (0.7007) acc_x 87.5000 (81.2500) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 688
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 716
clean true:716
clean false:0
clean_rate:1.0
noisy true:228
noisy false:688
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 916
epoch [9/200] batch [5/22] time 0.297 (0.303) data 0.219 (0.225) loss_x loss_x 0.2593 (0.5350) acc_x 93.7500 (86.8750) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [10/22] time 0.297 (0.298) data 0.219 (0.220) loss_x loss_x 0.4788 (0.6255) acc_x 90.6250 (84.3750) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/22] time 0.335 (0.310) data 0.258 (0.233) loss_x loss_x 0.9102 (0.6205) acc_x 78.1250 (83.9583) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/22] time 0.344 (0.318) data 0.267 (0.241) loss_x loss_x 0.7017 (0.6567) acc_x 78.1250 (82.6562) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 654
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:741
clean false:1
clean_rate:0.9986522911051213
noisy true:237
noisy false:653
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [10/200] batch [5/23] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.8496 (0.7220) acc_x 81.2500 (82.5000) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [10/23] time 0.341 (0.334) data 0.264 (0.257) loss_x loss_x 0.6729 (0.6865) acc_x 78.1250 (81.8750) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/23] time 0.346 (0.337) data 0.269 (0.260) loss_x loss_x 0.6118 (0.6723) acc_x 81.2500 (82.2917) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/23] time 0.331 (0.333) data 0.254 (0.255) loss_x loss_x 0.8911 (0.6773) acc_x 75.0000 (82.1875) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 672
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 715
clean true:711
clean false:4
clean_rate:0.9944055944055944
noisy true:249
noisy false:668
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 917
epoch [11/200] batch [5/22] time 0.297 (0.330) data 0.220 (0.252) loss_x loss_x 0.6104 (0.7136) acc_x 84.3750 (82.5000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/22] time 0.296 (0.313) data 0.218 (0.236) loss_x loss_x 0.5718 (0.6910) acc_x 87.5000 (82.8125) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/22] time 0.343 (0.312) data 0.266 (0.235) loss_x loss_x 0.6597 (0.6793) acc_x 84.3750 (83.3333) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/22] time 0.342 (0.318) data 0.265 (0.241) loss_x loss_x 0.3154 (0.6600) acc_x 100.0000 (84.2188) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 657
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:738
clean false:1
clean_rate:0.9986468200270636
noisy true:237
noisy false:656
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [12/200] batch [5/23] time 0.348 (0.341) data 0.270 (0.264) loss_x loss_x 0.7373 (0.7109) acc_x 81.2500 (81.2500) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/23] time 0.345 (0.344) data 0.268 (0.267) loss_x loss_x 0.5640 (0.5774) acc_x 87.5000 (85.6250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/23] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.7158 (0.5781) acc_x 78.1250 (85.4167) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/23] time 0.300 (0.340) data 0.223 (0.263) loss_x loss_x 0.7422 (0.5886) acc_x 87.5000 (85.3125) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 645
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:755
clean false:2
clean_rate:0.9973579920739762
noisy true:232
noisy false:643
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [13/200] batch [5/23] time 0.340 (0.338) data 0.262 (0.261) loss_x loss_x 0.3423 (0.4985) acc_x 93.7500 (86.2500) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/23] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.4250 (0.5795) acc_x 96.8750 (86.5625) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [15/23] time 0.326 (0.337) data 0.249 (0.259) loss_x loss_x 0.4624 (0.5821) acc_x 87.5000 (86.0417) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/23] time 0.343 (0.338) data 0.265 (0.261) loss_x loss_x 0.8960 (0.6122) acc_x 81.2500 (85.4688) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 625
confident_label rate tensor(0.4712, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 769
clean true:767
clean false:2
clean_rate:0.9973992197659298
noisy true:240
noisy false:623
after delete: len(clean_dataset) 769
after delete: len(noisy_dataset) 863
epoch [14/200] batch [5/24] time 0.334 (0.338) data 0.257 (0.260) loss_x loss_x 0.7246 (0.5217) acc_x 84.3750 (85.0000) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/24] time 0.351 (0.344) data 0.274 (0.267) loss_x loss_x 0.3462 (0.6208) acc_x 87.5000 (83.1250) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/24] time 0.326 (0.342) data 0.249 (0.265) loss_x loss_x 0.3496 (0.6514) acc_x 93.7500 (82.5000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [20/24] time 0.320 (0.334) data 0.243 (0.257) loss_x loss_x 0.4795 (0.6707) acc_x 90.6250 (82.1875) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 603
confident_label rate tensor(0.4755, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 776
clean true:774
clean false:2
clean_rate:0.9974226804123711
noisy true:255
noisy false:601
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 856
epoch [15/200] batch [5/24] time 0.300 (0.302) data 0.222 (0.225) loss_x loss_x 0.5894 (0.6323) acc_x 87.5000 (83.7500) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/24] time 0.328 (0.311) data 0.250 (0.234) loss_x loss_x 0.4287 (0.6717) acc_x 87.5000 (83.7500) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/24] time 0.335 (0.322) data 0.258 (0.245) loss_x loss_x 0.6592 (0.6204) acc_x 87.5000 (85.0000) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/24] time 0.349 (0.329) data 0.272 (0.251) loss_x loss_x 0.7271 (0.6510) acc_x 81.2500 (83.9062) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 621
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:761
clean false:1
clean_rate:0.9986876640419947
noisy true:250
noisy false:620
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [16/200] batch [5/23] time 0.354 (0.342) data 0.278 (0.264) loss_x loss_x 0.3977 (0.6381) acc_x 93.7500 (84.3750) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [10/23] time 0.291 (0.322) data 0.213 (0.244) loss_x loss_x 0.5132 (0.6135) acc_x 90.6250 (86.5625) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/23] time 0.334 (0.319) data 0.257 (0.241) loss_x loss_x 0.4895 (0.5950) acc_x 90.6250 (87.0833) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/23] time 0.340 (0.325) data 0.263 (0.248) loss_x loss_x 0.6421 (0.5487) acc_x 81.2500 (88.1250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 586
confident_label rate tensor(0.4835, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 789
clean true:787
clean false:2
clean_rate:0.9974651457541192
noisy true:259
noisy false:584
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 843
epoch [17/200] batch [5/24] time 0.331 (0.325) data 0.254 (0.247) loss_x loss_x 0.6221 (0.6762) acc_x 84.3750 (85.0000) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [10/24] time 0.385 (0.338) data 0.307 (0.260) loss_x loss_x 0.3799 (0.6805) acc_x 93.7500 (84.0625) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/24] time 0.349 (0.339) data 0.272 (0.261) loss_x loss_x 0.5117 (0.6601) acc_x 87.5000 (84.1667) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/24] time 0.317 (0.334) data 0.239 (0.256) loss_x loss_x 0.3843 (0.6365) acc_x 93.7500 (84.0625) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 586
confident_label rate tensor(0.4908, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 801
clean true:799
clean false:2
clean_rate:0.9975031210986267
noisy true:247
noisy false:584
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 831
epoch [18/200] batch [5/25] time 0.339 (0.342) data 0.261 (0.265) loss_x loss_x 0.7393 (0.7599) acc_x 78.1250 (77.5000) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/25] time 0.341 (0.341) data 0.264 (0.264) loss_x loss_x 0.8442 (0.7326) acc_x 81.2500 (80.0000) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/25] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.4485 (0.6420) acc_x 90.6250 (82.7083) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [20/25] time 0.337 (0.337) data 0.260 (0.260) loss_x loss_x 0.5938 (0.6363) acc_x 84.3750 (83.1250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/25] time 0.306 (0.336) data 0.228 (0.259) loss_x loss_x 0.5259 (0.6085) acc_x 81.2500 (84.0000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 803
clean true:802
clean false:1
clean_rate:0.9987546699875467
noisy true:249
noisy false:580
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 829
epoch [19/200] batch [5/25] time 0.340 (0.340) data 0.262 (0.262) loss_x loss_x 0.8887 (0.7904) acc_x 75.0000 (79.3750) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [10/25] time 0.338 (0.340) data 0.260 (0.263) loss_x loss_x 0.6104 (0.7276) acc_x 78.1250 (80.6250) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/25] time 0.357 (0.344) data 0.279 (0.266) loss_x loss_x 0.6426 (0.6832) acc_x 84.3750 (81.6667) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/25] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.3079 (0.6391) acc_x 90.6250 (82.5000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/25] time 0.293 (0.336) data 0.216 (0.259) loss_x loss_x 0.3123 (0.6144) acc_x 90.6250 (83.6250) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 820
clean true:820
clean false:0
clean_rate:1.0
noisy true:263
noisy false:549
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 812
epoch [20/200] batch [5/25] time 0.297 (0.336) data 0.220 (0.259) loss_x loss_x 0.6006 (0.6599) acc_x 81.2500 (85.0000) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/25] time 0.346 (0.333) data 0.269 (0.255) loss_x loss_x 0.2825 (0.6280) acc_x 96.8750 (87.1875) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/25] time 0.336 (0.334) data 0.257 (0.257) loss_x loss_x 0.6289 (0.6095) acc_x 90.6250 (86.8750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/25] time 0.341 (0.337) data 0.264 (0.259) loss_x loss_x 0.2942 (0.5893) acc_x 96.8750 (87.5000) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/25] time 0.362 (0.338) data 0.285 (0.260) loss_x loss_x 0.7227 (0.5907) acc_x 81.2500 (87.1250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 576
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 804
clean true:804
clean false:0
clean_rate:1.0
noisy true:252
noisy false:576
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 828
epoch [21/200] batch [5/25] time 0.337 (0.354) data 0.260 (0.276) loss_x loss_x 0.4351 (0.5891) acc_x 87.5000 (85.6250) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [10/25] time 0.341 (0.348) data 0.263 (0.271) loss_x loss_x 0.5132 (0.6485) acc_x 90.6250 (85.6250) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/25] time 0.349 (0.351) data 0.272 (0.273) loss_x loss_x 0.3972 (0.6209) acc_x 90.6250 (86.4583) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/25] time 0.341 (0.349) data 0.263 (0.271) loss_x loss_x 0.4460 (0.6160) acc_x 93.7500 (86.7188) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/25] time 0.352 (0.349) data 0.274 (0.271) loss_x loss_x 0.4482 (0.6248) acc_x 90.6250 (86.7500) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 533
confident_label rate tensor(0.5172, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 844
clean true:843
clean false:1
clean_rate:0.9988151658767772
noisy true:256
noisy false:532
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 788
epoch [22/200] batch [5/26] time 0.328 (0.341) data 0.251 (0.264) loss_x loss_x 0.7720 (0.6544) acc_x 78.1250 (84.3750) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [10/26] time 0.346 (0.343) data 0.269 (0.266) loss_x loss_x 0.4368 (0.6031) acc_x 90.6250 (84.6875) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/26] time 0.341 (0.339) data 0.264 (0.262) loss_x loss_x 0.8525 (0.5642) acc_x 81.2500 (85.6250) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/26] time 0.339 (0.340) data 0.262 (0.263) loss_x loss_x 0.3901 (0.5318) acc_x 87.5000 (86.8750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/26] time 0.316 (0.339) data 0.238 (0.262) loss_x loss_x 0.3606 (0.5195) acc_x 93.7500 (87.3750) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.5208, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 850
clean true:849
clean false:1
clean_rate:0.9988235294117647
noisy true:252
noisy false:530
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 782
epoch [23/200] batch [5/26] time 0.296 (0.306) data 0.218 (0.229) loss_x loss_x 0.5000 (0.6677) acc_x 87.5000 (85.0000) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/26] time 0.334 (0.307) data 0.256 (0.229) loss_x loss_x 0.6353 (0.6105) acc_x 81.2500 (84.6875) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/26] time 0.347 (0.316) data 0.270 (0.239) loss_x loss_x 0.7524 (0.5941) acc_x 84.3750 (85.2083) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/26] time 0.345 (0.322) data 0.268 (0.244) loss_x loss_x 0.4485 (0.5625) acc_x 90.6250 (85.4688) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [25/26] time 0.334 (0.326) data 0.257 (0.249) loss_x loss_x 0.8188 (0.5735) acc_x 84.3750 (85.1250) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 532
confident_label rate tensor(0.5153, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 841
clean true:841
clean false:0
clean_rate:1.0
noisy true:259
noisy false:532
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 791
epoch [24/200] batch [5/26] time 0.409 (0.354) data 0.331 (0.276) loss_x loss_x 0.4080 (0.5083) acc_x 87.5000 (86.8750) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [10/26] time 0.346 (0.350) data 0.269 (0.273) loss_x loss_x 0.6250 (0.5583) acc_x 87.5000 (86.8750) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/26] time 0.317 (0.339) data 0.238 (0.261) loss_x loss_x 0.4336 (0.5806) acc_x 90.6250 (86.4583) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/26] time 0.340 (0.334) data 0.263 (0.257) loss_x loss_x 0.2499 (0.5389) acc_x 90.6250 (87.3438) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/26] time 0.289 (0.331) data 0.213 (0.253) loss_x loss_x 0.5513 (0.5433) acc_x 84.3750 (87.0000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 516
confident_label rate tensor(0.5227, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 853
clean true:852
clean false:1
clean_rate:0.9988276670574443
noisy true:264
noisy false:515
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 779
epoch [25/200] batch [5/26] time 0.341 (0.341) data 0.264 (0.264) loss_x loss_x 0.4060 (0.6216) acc_x 90.6250 (85.0000) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [10/26] time 0.290 (0.324) data 0.212 (0.246) loss_x loss_x 0.3853 (0.4977) acc_x 93.7500 (88.7500) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/26] time 0.346 (0.318) data 0.269 (0.240) loss_x loss_x 0.9487 (0.5573) acc_x 78.1250 (86.8750) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/26] time 0.337 (0.323) data 0.260 (0.246) loss_x loss_x 0.5107 (0.5782) acc_x 87.5000 (86.4062) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [25/26] time 0.318 (0.325) data 0.241 (0.248) loss_x loss_x 0.8208 (0.5826) acc_x 75.0000 (86.1250) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 510
confident_label rate tensor(0.5257, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 858
clean true:857
clean false:1
clean_rate:0.9988344988344988
noisy true:265
noisy false:509
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 774
epoch [26/200] batch [5/26] time 0.349 (0.342) data 0.272 (0.265) loss_x loss_x 0.5361 (0.4529) acc_x 90.6250 (91.2500) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [10/26] time 0.312 (0.339) data 0.234 (0.262) loss_x loss_x 0.4536 (0.4762) acc_x 90.6250 (90.0000) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [15/26] time 0.345 (0.342) data 0.268 (0.265) loss_x loss_x 0.6636 (0.4931) acc_x 90.6250 (89.1667) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/26] time 0.301 (0.340) data 0.225 (0.263) loss_x loss_x 0.4009 (0.4948) acc_x 93.7500 (89.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/26] time 0.343 (0.335) data 0.266 (0.257) loss_x loss_x 0.7065 (0.5085) acc_x 84.3750 (89.0000) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 495
confident_label rate tensor(0.5325, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 869
clean true:868
clean false:1
clean_rate:0.998849252013809
noisy true:269
noisy false:494
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 763
epoch [27/200] batch [5/27] time 0.345 (0.313) data 0.267 (0.236) loss_x loss_x 0.2622 (0.4190) acc_x 93.7500 (89.3750) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [10/27] time 0.345 (0.330) data 0.268 (0.252) loss_x loss_x 0.8008 (0.5118) acc_x 81.2500 (87.8125) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [15/27] time 0.327 (0.332) data 0.251 (0.255) loss_x loss_x 0.7715 (0.5718) acc_x 81.2500 (85.6250) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/27] time 0.295 (0.329) data 0.218 (0.252) loss_x loss_x 1.0791 (0.5901) acc_x 68.7500 (85.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/27] time 0.288 (0.322) data 0.210 (0.245) loss_x loss_x 0.8184 (0.5919) acc_x 78.1250 (85.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.5355, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 874
clean true:873
clean false:1
clean_rate:0.9988558352402745
noisy true:279
noisy false:479
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 758
epoch [28/200] batch [5/27] time 0.343 (0.343) data 0.265 (0.266) loss_x loss_x 0.2947 (0.5505) acc_x 96.8750 (87.5000) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [10/27] time 0.336 (0.340) data 0.259 (0.262) loss_x loss_x 0.5142 (0.5665) acc_x 93.7500 (87.5000) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [15/27] time 0.331 (0.329) data 0.254 (0.252) loss_x loss_x 0.5664 (0.5315) acc_x 81.2500 (87.2917) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [20/27] time 0.330 (0.333) data 0.253 (0.256) loss_x loss_x 0.5767 (0.5207) acc_x 84.3750 (87.6562) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/27] time 0.335 (0.335) data 0.258 (0.257) loss_x loss_x 0.2786 (0.5239) acc_x 100.0000 (87.5000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 507
confident_label rate tensor(0.5276, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 861
clean true:861
clean false:0
clean_rate:1.0
noisy true:264
noisy false:507
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 771
epoch [29/200] batch [5/26] time 0.335 (0.341) data 0.257 (0.263) loss_x loss_x 0.6401 (0.5060) acc_x 81.2500 (88.7500) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [10/26] time 0.291 (0.327) data 0.213 (0.249) loss_x loss_x 0.3892 (0.5835) acc_x 87.5000 (86.8750) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/26] time 0.285 (0.315) data 0.207 (0.238) loss_x loss_x 0.4766 (0.5744) acc_x 87.5000 (86.4583) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [20/26] time 0.345 (0.323) data 0.268 (0.245) loss_x loss_x 0.3257 (0.5246) acc_x 87.5000 (87.8125) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/26] time 0.366 (0.328) data 0.288 (0.251) loss_x loss_x 0.2411 (0.5021) acc_x 96.8750 (88.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.5490, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 896
clean true:895
clean false:1
clean_rate:0.9988839285714286
noisy true:261
noisy false:475
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 736
epoch [30/200] batch [5/28] time 0.293 (0.298) data 0.215 (0.221) loss_x loss_x 0.4036 (0.5632) acc_x 93.7500 (89.3750) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [10/28] time 0.328 (0.321) data 0.251 (0.243) loss_x loss_x 0.3799 (0.5834) acc_x 96.8750 (88.4375) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [15/28] time 0.288 (0.321) data 0.211 (0.243) loss_x loss_x 0.4099 (0.5998) acc_x 87.5000 (87.2917) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [20/28] time 0.346 (0.324) data 0.269 (0.247) loss_x loss_x 0.5459 (0.6008) acc_x 81.2500 (85.9375) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/28] time 0.352 (0.328) data 0.274 (0.250) loss_x loss_x 0.4675 (0.5904) acc_x 87.5000 (86.0000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 457
confident_label rate tensor(0.5496, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 897
clean true:893
clean false:4
clean_rate:0.9955406911928651
noisy true:282
noisy false:453
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 735
epoch [31/200] batch [5/28] time 0.333 (0.337) data 0.256 (0.259) loss_x loss_x 0.6221 (0.5943) acc_x 84.3750 (86.2500) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [10/28] time 0.335 (0.331) data 0.258 (0.254) loss_x loss_x 0.3994 (0.5206) acc_x 93.7500 (88.1250) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [15/28] time 0.330 (0.334) data 0.253 (0.256) loss_x loss_x 0.6387 (0.5172) acc_x 84.3750 (88.5417) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [20/28] time 0.296 (0.324) data 0.220 (0.247) loss_x loss_x 0.4709 (0.4961) acc_x 75.0000 (88.2812) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/28] time 0.334 (0.327) data 0.256 (0.250) loss_x loss_x 0.7085 (0.5093) acc_x 81.2500 (87.8750) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:891
clean false:0
clean_rate:1.0
noisy true:273
noisy false:468
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [32/200] batch [5/27] time 0.347 (0.331) data 0.269 (0.253) loss_x loss_x 0.4382 (0.5148) acc_x 90.6250 (90.0000) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [10/27] time 0.350 (0.331) data 0.273 (0.254) loss_x loss_x 0.5063 (0.5026) acc_x 90.6250 (90.9375) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [15/27] time 0.358 (0.336) data 0.281 (0.258) loss_x loss_x 0.6401 (0.5009) acc_x 78.1250 (88.1250) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [20/27] time 0.335 (0.337) data 0.257 (0.259) loss_x loss_x 0.4214 (0.5092) acc_x 87.5000 (88.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/27] time 0.343 (0.338) data 0.265 (0.260) loss_x loss_x 0.6025 (0.5028) acc_x 78.1250 (88.6250) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 483
confident_label rate tensor(0.5355, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 874
clean true:873
clean false:1
clean_rate:0.9988558352402745
noisy true:276
noisy false:482
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 758
epoch [33/200] batch [5/27] time 0.343 (0.338) data 0.266 (0.260) loss_x loss_x 0.1759 (0.4094) acc_x 100.0000 (89.3750) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [10/27] time 0.331 (0.338) data 0.254 (0.260) loss_x loss_x 0.4363 (0.4731) acc_x 93.7500 (88.1250) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [15/27] time 0.296 (0.336) data 0.219 (0.259) loss_x loss_x 0.5991 (0.4823) acc_x 84.3750 (88.5417) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [20/27] time 0.298 (0.326) data 0.220 (0.249) loss_x loss_x 0.4250 (0.4717) acc_x 87.5000 (89.2188) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/27] time 0.353 (0.324) data 0.275 (0.246) loss_x loss_x 0.4871 (0.4712) acc_x 84.3750 (88.8750) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:898
clean false:1
clean_rate:0.9988876529477196
noisy true:265
noisy false:468
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [34/200] batch [5/28] time 0.342 (0.325) data 0.264 (0.247) loss_x loss_x 0.4434 (0.5176) acc_x 90.6250 (86.2500) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [10/28] time 0.354 (0.338) data 0.277 (0.261) loss_x loss_x 0.4045 (0.5419) acc_x 90.6250 (86.2500) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [15/28] time 0.348 (0.340) data 0.271 (0.263) loss_x loss_x 0.4404 (0.5205) acc_x 93.7500 (87.5000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [20/28] time 0.335 (0.340) data 0.258 (0.263) loss_x loss_x 0.5103 (0.5276) acc_x 84.3750 (86.7188) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/28] time 0.297 (0.336) data 0.219 (0.259) loss_x loss_x 0.3423 (0.5189) acc_x 90.6250 (87.6250) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:897
clean false:1
clean_rate:0.9988864142538976
noisy true:263
noisy false:471
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [35/200] batch [5/28] time 0.320 (0.325) data 0.242 (0.247) loss_x loss_x 0.4656 (0.5319) acc_x 87.5000 (85.0000) lr 1.8686e-03 eta 0:00:07
epoch [35/200] batch [10/28] time 0.290 (0.311) data 0.212 (0.234) loss_x loss_x 0.3384 (0.4664) acc_x 93.7500 (87.5000) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [15/28] time 0.336 (0.315) data 0.258 (0.238) loss_x loss_x 0.6475 (0.4905) acc_x 75.0000 (87.2917) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [20/28] time 0.327 (0.319) data 0.250 (0.241) loss_x loss_x 0.5083 (0.4905) acc_x 84.3750 (87.5000) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/28] time 0.343 (0.322) data 0.266 (0.244) loss_x loss_x 0.3870 (0.5130) acc_x 93.7500 (87.1250) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 442
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:906
clean false:0
clean_rate:1.0
noisy true:284
noisy false:442
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [36/200] batch [5/28] time 0.323 (0.334) data 0.246 (0.256) loss_x loss_x 0.5293 (0.4137) acc_x 90.6250 (91.8750) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [10/28] time 0.291 (0.324) data 0.214 (0.247) loss_x loss_x 0.4663 (0.5167) acc_x 90.6250 (86.8750) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [15/28] time 0.293 (0.314) data 0.216 (0.237) loss_x loss_x 0.3606 (0.4916) acc_x 87.5000 (87.7083) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/28] time 0.342 (0.320) data 0.264 (0.243) loss_x loss_x 0.5034 (0.5019) acc_x 87.5000 (87.0312) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/28] time 0.290 (0.321) data 0.213 (0.244) loss_x loss_x 0.4089 (0.5007) acc_x 84.3750 (86.7500) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 449
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:903
clean false:1
clean_rate:0.9988938053097345
noisy true:280
noisy false:448
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [37/200] batch [5/28] time 0.333 (0.344) data 0.256 (0.267) loss_x loss_x 0.6597 (0.5447) acc_x 84.3750 (88.1250) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [10/28] time 0.351 (0.345) data 0.274 (0.267) loss_x loss_x 0.1202 (0.4852) acc_x 100.0000 (90.3125) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [15/28] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.5830 (0.4979) acc_x 84.3750 (89.3750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [20/28] time 0.297 (0.334) data 0.220 (0.256) loss_x loss_x 0.2839 (0.4833) acc_x 93.7500 (89.6875) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/28] time 0.317 (0.333) data 0.240 (0.256) loss_x loss_x 0.5815 (0.4943) acc_x 84.3750 (89.1250) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 438
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:906
clean false:0
clean_rate:1.0
noisy true:288
noisy false:438
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [38/200] batch [5/28] time 0.366 (0.342) data 0.288 (0.265) loss_x loss_x 0.2277 (0.4606) acc_x 100.0000 (90.6250) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [10/28] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.4487 (0.5184) acc_x 87.5000 (88.7500) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [15/28] time 0.307 (0.332) data 0.230 (0.255) loss_x loss_x 0.2893 (0.4465) acc_x 93.7500 (90.4167) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [20/28] time 0.304 (0.331) data 0.227 (0.254) loss_x loss_x 0.3921 (0.4453) acc_x 90.6250 (90.4688) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/28] time 0.336 (0.328) data 0.259 (0.251) loss_x loss_x 0.5825 (0.4772) acc_x 84.3750 (89.0000) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:910
clean false:1
clean_rate:0.9989023051591658
noisy true:292
noisy false:429
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [39/200] batch [5/28] time 0.342 (0.347) data 0.265 (0.270) loss_x loss_x 0.3604 (0.4940) acc_x 90.6250 (87.5000) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [10/28] time 0.347 (0.347) data 0.270 (0.270) loss_x loss_x 0.4006 (0.4923) acc_x 87.5000 (88.4375) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [15/28] time 0.327 (0.343) data 0.250 (0.266) loss_x loss_x 0.4783 (0.4822) acc_x 87.5000 (88.3333) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [20/28] time 0.295 (0.332) data 0.217 (0.255) loss_x loss_x 0.6694 (0.4881) acc_x 90.6250 (88.5938) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/28] time 0.339 (0.333) data 0.260 (0.255) loss_x loss_x 0.3708 (0.4778) acc_x 90.6250 (88.7500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 425
confident_label rate tensor(0.5662, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 924
clean true:924
clean false:0
clean_rate:1.0
noisy true:283
noisy false:425
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 708
epoch [40/200] batch [5/28] time 0.294 (0.326) data 0.217 (0.248) loss_x loss_x 0.5273 (0.3980) acc_x 87.5000 (90.0000) lr 1.8271e-03 eta 0:00:07
epoch [40/200] batch [10/28] time 0.295 (0.311) data 0.218 (0.234) loss_x loss_x 0.3799 (0.3944) acc_x 93.7500 (91.8750) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [15/28] time 0.351 (0.324) data 0.273 (0.247) loss_x loss_x 0.2106 (0.4177) acc_x 100.0000 (91.0417) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [20/28] time 0.341 (0.328) data 0.263 (0.251) loss_x loss_x 0.7988 (0.4761) acc_x 75.0000 (88.4375) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/28] time 0.340 (0.330) data 0.263 (0.253) loss_x loss_x 0.5703 (0.4980) acc_x 87.5000 (88.1250) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:931
clean false:1
clean_rate:0.9989270386266095
noisy true:285
noisy false:415
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [41/200] batch [5/29] time 0.333 (0.333) data 0.256 (0.255) loss_x loss_x 0.4070 (0.4806) acc_x 90.6250 (88.1250) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [10/29] time 0.335 (0.327) data 0.257 (0.250) loss_x loss_x 0.6147 (0.4654) acc_x 84.3750 (87.5000) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [15/29] time 0.291 (0.316) data 0.215 (0.238) loss_x loss_x 0.5859 (0.4522) acc_x 81.2500 (86.8750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [20/29] time 0.287 (0.309) data 0.210 (0.232) loss_x loss_x 0.2086 (0.4541) acc_x 96.8750 (87.1875) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/29] time 0.289 (0.305) data 0.211 (0.228) loss_x loss_x 0.5073 (0.4738) acc_x 90.6250 (86.7500) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.5778, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 943
clean true:943
clean false:0
clean_rate:1.0
noisy true:294
noisy false:395
after delete: len(clean_dataset) 943
after delete: len(noisy_dataset) 689
epoch [42/200] batch [5/29] time 0.300 (0.325) data 0.222 (0.247) loss_x loss_x 0.7388 (0.5112) acc_x 81.2500 (86.8750) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [10/29] time 0.339 (0.331) data 0.261 (0.254) loss_x loss_x 0.2505 (0.4569) acc_x 93.7500 (89.3750) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [15/29] time 0.334 (0.334) data 0.256 (0.257) loss_x loss_x 1.0049 (0.4762) acc_x 71.8750 (88.5417) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [20/29] time 0.349 (0.337) data 0.272 (0.260) loss_x loss_x 0.3704 (0.4501) acc_x 90.6250 (89.8438) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/29] time 0.343 (0.339) data 0.266 (0.261) loss_x loss_x 0.6460 (0.4501) acc_x 84.3750 (90.1250) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 386
confident_label rate tensor(0.5803, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 947
clean true:947
clean false:0
clean_rate:1.0
noisy true:299
noisy false:386
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 685
epoch [43/200] batch [5/29] time 0.362 (0.345) data 0.285 (0.268) loss_x loss_x 0.3987 (0.4372) acc_x 93.7500 (91.8750) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [10/29] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.5347 (0.4776) acc_x 84.3750 (90.0000) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [15/29] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.2156 (0.4642) acc_x 100.0000 (90.0000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [20/29] time 0.338 (0.341) data 0.261 (0.264) loss_x loss_x 0.3357 (0.4658) acc_x 93.7500 (89.5312) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/29] time 0.319 (0.341) data 0.241 (0.263) loss_x loss_x 0.4700 (0.4680) acc_x 87.5000 (89.1250) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 397
confident_label rate tensor(0.5772, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 942
clean true:940
clean false:2
clean_rate:0.9978768577494692
noisy true:295
noisy false:395
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 690
epoch [44/200] batch [5/29] time 0.349 (0.361) data 0.272 (0.284) loss_x loss_x 0.8037 (0.4871) acc_x 81.2500 (89.3750) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [10/29] time 0.346 (0.353) data 0.269 (0.276) loss_x loss_x 0.6914 (0.5350) acc_x 81.2500 (87.1875) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [15/29] time 0.341 (0.351) data 0.264 (0.274) loss_x loss_x 0.6714 (0.4933) acc_x 90.6250 (88.7500) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [20/29] time 0.349 (0.347) data 0.272 (0.270) loss_x loss_x 0.7661 (0.5302) acc_x 93.7500 (87.8125) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [25/29] time 0.344 (0.347) data 0.267 (0.269) loss_x loss_x 0.7798 (0.5221) acc_x 81.2500 (87.8750) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 394
confident_label rate tensor(0.5797, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 946
clean true:945
clean false:1
clean_rate:0.9989429175475687
noisy true:293
noisy false:393
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 686
epoch [45/200] batch [5/29] time 0.348 (0.346) data 0.271 (0.268) loss_x loss_x 0.4639 (0.4506) acc_x 87.5000 (88.7500) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [10/29] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.2583 (0.4099) acc_x 96.8750 (90.9375) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [15/29] time 0.344 (0.345) data 0.266 (0.267) loss_x loss_x 0.6958 (0.4248) acc_x 78.1250 (89.3750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [20/29] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.3423 (0.4348) acc_x 90.6250 (89.0625) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [25/29] time 0.352 (0.345) data 0.274 (0.268) loss_x loss_x 0.3977 (0.4424) acc_x 93.7500 (88.7500) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 374
confident_label rate tensor(0.5809, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 948
clean true:948
clean false:0
clean_rate:1.0
noisy true:310
noisy false:374
after delete: len(clean_dataset) 948
after delete: len(noisy_dataset) 684
epoch [46/200] batch [5/29] time 0.348 (0.345) data 0.271 (0.267) loss_x loss_x 0.5200 (0.4688) acc_x 93.7500 (89.3750) lr 1.7705e-03 eta 0:00:08
epoch [46/200] batch [10/29] time 0.300 (0.337) data 0.222 (0.260) loss_x loss_x 0.5400 (0.4808) acc_x 81.2500 (88.1250) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [15/29] time 0.325 (0.334) data 0.248 (0.257) loss_x loss_x 0.4949 (0.4547) acc_x 90.6250 (89.5833) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [20/29] time 0.342 (0.337) data 0.265 (0.259) loss_x loss_x 0.4229 (0.4449) acc_x 93.7500 (89.3750) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/29] time 0.337 (0.337) data 0.260 (0.260) loss_x loss_x 0.5024 (0.4742) acc_x 84.3750 (87.8750) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 369
confident_label rate tensor(0.5974, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 975
clean true:974
clean false:1
clean_rate:0.9989743589743589
noisy true:289
noisy false:368
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 657
epoch [47/200] batch [5/30] time 0.332 (0.324) data 0.255 (0.246) loss_x loss_x 0.4490 (0.4077) acc_x 84.3750 (92.5000) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [10/30] time 0.288 (0.321) data 0.210 (0.244) loss_x loss_x 0.6099 (0.5041) acc_x 90.6250 (89.0625) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [15/30] time 0.339 (0.320) data 0.261 (0.243) loss_x loss_x 0.6724 (0.5208) acc_x 78.1250 (87.9167) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [20/30] time 0.341 (0.328) data 0.263 (0.251) loss_x loss_x 0.5483 (0.5066) acc_x 90.6250 (88.1250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/30] time 0.338 (0.330) data 0.261 (0.253) loss_x loss_x 0.4224 (0.5053) acc_x 90.6250 (88.2500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/30] time 0.344 (0.333) data 0.266 (0.256) loss_x loss_x 0.5981 (0.4998) acc_x 90.6250 (88.4375) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 381
confident_label rate tensor(0.5882, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 960
clean true:960
clean false:0
clean_rate:1.0
noisy true:291
noisy false:381
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 672
epoch [48/200] batch [5/30] time 0.295 (0.328) data 0.218 (0.251) loss_x loss_x 0.6338 (0.4698) acc_x 84.3750 (86.8750) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [10/30] time 0.343 (0.319) data 0.266 (0.241) loss_x loss_x 0.3428 (0.4592) acc_x 87.5000 (87.8125) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [15/30] time 0.340 (0.326) data 0.263 (0.248) loss_x loss_x 0.2401 (0.4514) acc_x 100.0000 (88.3333) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [20/30] time 0.303 (0.328) data 0.225 (0.250) loss_x loss_x 0.3184 (0.4364) acc_x 93.7500 (88.9062) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/30] time 0.341 (0.324) data 0.264 (0.246) loss_x loss_x 0.3132 (0.4217) acc_x 96.8750 (89.7500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/30] time 0.341 (0.327) data 0.264 (0.250) loss_x loss_x 0.3049 (0.4171) acc_x 90.6250 (89.7917) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.5962, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 973
clean true:971
clean false:2
clean_rate:0.9979445015416238
noisy true:291
noisy false:368
after delete: len(clean_dataset) 973
after delete: len(noisy_dataset) 659
epoch [49/200] batch [5/30] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.3777 (0.3596) acc_x 93.7500 (91.8750) lr 1.7396e-03 eta 0:00:08
epoch [49/200] batch [10/30] time 0.346 (0.345) data 0.269 (0.267) loss_x loss_x 0.3887 (0.4063) acc_x 93.7500 (91.2500) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [15/30] time 0.338 (0.342) data 0.260 (0.265) loss_x loss_x 0.2462 (0.4276) acc_x 96.8750 (90.6250) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [20/30] time 0.336 (0.342) data 0.259 (0.265) loss_x loss_x 0.4583 (0.4232) acc_x 84.3750 (90.0000) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/30] time 0.346 (0.342) data 0.268 (0.264) loss_x loss_x 0.2903 (0.4260) acc_x 93.7500 (90.1250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/30] time 0.344 (0.342) data 0.267 (0.264) loss_x loss_x 0.3787 (0.4408) acc_x 90.6250 (89.3750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 372
confident_label rate tensor(0.5919, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 966
clean true:966
clean false:0
clean_rate:1.0
noisy true:294
noisy false:372
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 666
epoch [50/200] batch [5/30] time 0.333 (0.350) data 0.256 (0.273) loss_x loss_x 0.3208 (0.4522) acc_x 93.7500 (90.0000) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [10/30] time 0.346 (0.347) data 0.268 (0.270) loss_x loss_x 0.4692 (0.4521) acc_x 81.2500 (88.4375) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [15/30] time 0.354 (0.343) data 0.276 (0.266) loss_x loss_x 0.2708 (0.4433) acc_x 93.7500 (88.9583) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [20/30] time 0.348 (0.344) data 0.269 (0.267) loss_x loss_x 0.2178 (0.4280) acc_x 100.0000 (89.5312) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/30] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.1703 (0.4101) acc_x 100.0000 (90.1250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/30] time 0.340 (0.340) data 0.263 (0.263) loss_x loss_x 0.2908 (0.4106) acc_x 93.7500 (90.1042) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.5919, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 966
clean true:966
clean false:0
clean_rate:1.0
noisy true:299
noisy false:367
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 666
epoch [51/200] batch [5/30] time 0.333 (0.349) data 0.256 (0.272) loss_x loss_x 0.2966 (0.3838) acc_x 90.6250 (93.7500) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [10/30] time 0.299 (0.326) data 0.221 (0.249) loss_x loss_x 0.3350 (0.4295) acc_x 93.7500 (91.2500) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [15/30] time 0.357 (0.323) data 0.279 (0.246) loss_x loss_x 0.1763 (0.4918) acc_x 96.8750 (89.1667) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [20/30] time 0.348 (0.329) data 0.271 (0.251) loss_x loss_x 0.2935 (0.5213) acc_x 90.6250 (87.6562) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/30] time 0.363 (0.333) data 0.285 (0.256) loss_x loss_x 0.4597 (0.4951) acc_x 87.5000 (88.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/30] time 0.371 (0.336) data 0.293 (0.258) loss_x loss_x 0.3982 (0.4960) acc_x 90.6250 (88.4375) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.6097, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 995
clean true:995
clean false:0
clean_rate:1.0
noisy true:300
noisy false:337
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 637
epoch [52/200] batch [5/31] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.7256 (0.6446) acc_x 84.3750 (83.7500) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [10/31] time 0.289 (0.320) data 0.211 (0.242) loss_x loss_x 0.5122 (0.5588) acc_x 87.5000 (86.8750) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [15/31] time 0.338 (0.327) data 0.261 (0.249) loss_x loss_x 0.6235 (0.5486) acc_x 78.1250 (86.2500) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [20/31] time 0.343 (0.330) data 0.266 (0.252) loss_x loss_x 0.5308 (0.5243) acc_x 87.5000 (87.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [25/31] time 0.335 (0.333) data 0.258 (0.255) loss_x loss_x 0.3853 (0.5018) acc_x 93.7500 (87.8750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/31] time 0.362 (0.337) data 0.285 (0.259) loss_x loss_x 0.5190 (0.5188) acc_x 90.6250 (88.0208) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.5962, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 973
clean true:973
clean false:0
clean_rate:1.0
noisy true:310
noisy false:349
after delete: len(clean_dataset) 973
after delete: len(noisy_dataset) 659
epoch [53/200] batch [5/30] time 0.369 (0.354) data 0.292 (0.277) loss_x loss_x 0.4053 (0.3263) acc_x 90.6250 (91.8750) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [10/30] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.3933 (0.3787) acc_x 90.6250 (90.9375) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [15/30] time 0.302 (0.339) data 0.224 (0.261) loss_x loss_x 0.2296 (0.3652) acc_x 96.8750 (91.8750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [20/30] time 0.350 (0.339) data 0.273 (0.262) loss_x loss_x 0.2876 (0.3696) acc_x 96.8750 (92.3438) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/30] time 0.350 (0.341) data 0.272 (0.263) loss_x loss_x 0.8301 (0.3831) acc_x 87.5000 (92.0000) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/30] time 0.335 (0.341) data 0.258 (0.263) loss_x loss_x 0.3198 (0.3903) acc_x 90.6250 (91.4583) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.5950, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 971
clean true:971
clean false:0
clean_rate:1.0
noisy true:315
noisy false:346
after delete: len(clean_dataset) 971
after delete: len(noisy_dataset) 661
epoch [54/200] batch [5/30] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.4878 (0.3945) acc_x 81.2500 (89.3750) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [10/30] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.5898 (0.4436) acc_x 81.2500 (89.6875) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [15/30] time 0.336 (0.341) data 0.259 (0.264) loss_x loss_x 0.5112 (0.4663) acc_x 84.3750 (89.1667) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [20/30] time 0.341 (0.334) data 0.263 (0.257) loss_x loss_x 0.3418 (0.4585) acc_x 90.6250 (89.5312) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [25/30] time 0.331 (0.335) data 0.253 (0.258) loss_x loss_x 0.3406 (0.4231) acc_x 87.5000 (90.6250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/30] time 0.291 (0.331) data 0.214 (0.254) loss_x loss_x 0.8486 (0.4424) acc_x 71.8750 (89.5833) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.5987, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 977
clean true:977
clean false:0
clean_rate:1.0
noisy true:300
noisy false:355
after delete: len(clean_dataset) 977
after delete: len(noisy_dataset) 655
epoch [55/200] batch [5/30] time 0.296 (0.311) data 0.218 (0.234) loss_x loss_x 0.2268 (0.3364) acc_x 96.8750 (93.1250) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [10/30] time 0.345 (0.326) data 0.267 (0.249) loss_x loss_x 0.5054 (0.3794) acc_x 87.5000 (91.8750) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [15/30] time 0.336 (0.329) data 0.259 (0.251) loss_x loss_x 0.2595 (0.3573) acc_x 96.8750 (92.0833) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [20/30] time 0.299 (0.330) data 0.221 (0.252) loss_x loss_x 0.3967 (0.3904) acc_x 90.6250 (90.7812) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [25/30] time 0.297 (0.329) data 0.218 (0.251) loss_x loss_x 0.3508 (0.3935) acc_x 93.7500 (90.2500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/30] time 0.349 (0.327) data 0.272 (0.250) loss_x loss_x 0.2245 (0.3892) acc_x 96.8750 (90.3125) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 330
confident_label rate tensor(0.6085, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 993
clean true:993
clean false:0
clean_rate:1.0
noisy true:309
noisy false:330
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 639
epoch [56/200] batch [5/31] time 0.314 (0.299) data 0.237 (0.221) loss_x loss_x 0.3147 (0.4935) acc_x 90.6250 (88.1250) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [10/31] time 0.332 (0.318) data 0.255 (0.241) loss_x loss_x 0.3447 (0.4651) acc_x 93.7500 (89.0625) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [15/31] time 0.346 (0.326) data 0.268 (0.248) loss_x loss_x 0.4727 (0.4662) acc_x 84.3750 (88.1250) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [20/31] time 0.345 (0.331) data 0.267 (0.253) loss_x loss_x 0.5562 (0.4817) acc_x 81.2500 (87.8125) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [25/31] time 0.358 (0.329) data 0.281 (0.251) loss_x loss_x 0.1785 (0.4753) acc_x 96.8750 (88.2500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/31] time 0.341 (0.330) data 0.264 (0.253) loss_x loss_x 0.6274 (0.4708) acc_x 84.3750 (88.4375) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.6066, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 990
clean true:989
clean false:1
clean_rate:0.998989898989899
noisy true:311
noisy false:331
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 642
epoch [57/200] batch [5/30] time 0.296 (0.327) data 0.217 (0.249) loss_x loss_x 0.5186 (0.3806) acc_x 87.5000 (91.2500) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [10/30] time 0.292 (0.309) data 0.215 (0.232) loss_x loss_x 0.4836 (0.4789) acc_x 84.3750 (88.4375) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [15/30] time 0.296 (0.304) data 0.218 (0.226) loss_x loss_x 0.4277 (0.4305) acc_x 87.5000 (89.7917) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [20/30] time 0.297 (0.302) data 0.219 (0.224) loss_x loss_x 0.3542 (0.4207) acc_x 87.5000 (90.1562) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/30] time 0.336 (0.308) data 0.259 (0.230) loss_x loss_x 0.6099 (0.4320) acc_x 84.3750 (90.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/30] time 0.341 (0.313) data 0.263 (0.236) loss_x loss_x 0.2482 (0.4253) acc_x 100.0000 (90.4167) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 306
confident_label rate tensor(0.6225, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1016
clean true:1016
clean false:0
clean_rate:1.0
noisy true:310
noisy false:306
after delete: len(clean_dataset) 1016
after delete: len(noisy_dataset) 616
epoch [58/200] batch [5/31] time 0.351 (0.349) data 0.274 (0.271) loss_x loss_x 0.2512 (0.2900) acc_x 93.7500 (93.7500) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [10/31] time 0.337 (0.344) data 0.260 (0.267) loss_x loss_x 0.1749 (0.2846) acc_x 100.0000 (93.7500) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [15/31] time 0.284 (0.334) data 0.207 (0.257) loss_x loss_x 0.6450 (0.3587) acc_x 90.6250 (92.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [20/31] time 0.340 (0.329) data 0.263 (0.252) loss_x loss_x 0.7012 (0.4146) acc_x 90.6250 (90.6250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [25/31] time 0.292 (0.321) data 0.214 (0.244) loss_x loss_x 0.4067 (0.4200) acc_x 90.6250 (90.7500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/31] time 0.334 (0.324) data 0.257 (0.247) loss_x loss_x 0.6685 (0.4464) acc_x 84.3750 (90.0000) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.6121, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 999
clean true:999
clean false:0
clean_rate:1.0
noisy true:296
noisy false:337
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 633
epoch [59/200] batch [5/31] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.1815 (0.3247) acc_x 96.8750 (91.8750) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [10/31] time 0.298 (0.335) data 0.220 (0.258) loss_x loss_x 0.3984 (0.3352) acc_x 93.7500 (91.8750) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [15/31] time 0.345 (0.332) data 0.267 (0.254) loss_x loss_x 0.2703 (0.3112) acc_x 93.7500 (92.9167) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [20/31] time 0.355 (0.336) data 0.277 (0.258) loss_x loss_x 0.1403 (0.3219) acc_x 100.0000 (92.8125) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/31] time 0.311 (0.328) data 0.233 (0.250) loss_x loss_x 0.2385 (0.3248) acc_x 96.8750 (93.2500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/31] time 0.345 (0.330) data 0.268 (0.252) loss_x loss_x 0.4138 (0.3399) acc_x 93.7500 (92.9167) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.6078, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 992
clean true:989
clean false:3
clean_rate:0.9969758064516129
noisy true:305
noisy false:335
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 640
epoch [60/200] batch [5/31] time 0.339 (0.349) data 0.261 (0.272) loss_x loss_x 0.8877 (0.5753) acc_x 71.8750 (86.8750) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [10/31] time 0.349 (0.349) data 0.269 (0.272) loss_x loss_x 0.3728 (0.5004) acc_x 90.6250 (89.0625) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [15/31] time 0.330 (0.349) data 0.253 (0.271) loss_x loss_x 0.6377 (0.4826) acc_x 87.5000 (88.5417) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [20/31] time 0.344 (0.346) data 0.267 (0.269) loss_x loss_x 0.2294 (0.4695) acc_x 93.7500 (89.3750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/31] time 0.336 (0.344) data 0.258 (0.267) loss_x loss_x 0.4316 (0.4824) acc_x 96.8750 (89.2500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/31] time 0.346 (0.339) data 0.269 (0.262) loss_x loss_x 0.5098 (0.4876) acc_x 87.5000 (89.2708) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.6085, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 993
clean true:993
clean false:0
clean_rate:1.0
noisy true:308
noisy false:331
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 639
epoch [61/200] batch [5/31] time 0.338 (0.349) data 0.260 (0.271) loss_x loss_x 0.5996 (0.3466) acc_x 84.3750 (91.2500) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [10/31] time 0.339 (0.346) data 0.262 (0.269) loss_x loss_x 0.3992 (0.3646) acc_x 90.6250 (90.9375) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [15/31] time 0.342 (0.345) data 0.265 (0.267) loss_x loss_x 0.5215 (0.3616) acc_x 84.3750 (91.6667) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [20/31] time 0.346 (0.344) data 0.268 (0.267) loss_x loss_x 0.4109 (0.3741) acc_x 84.3750 (91.5625) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/31] time 0.300 (0.339) data 0.222 (0.262) loss_x loss_x 0.3528 (0.4146) acc_x 96.8750 (90.3750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/31] time 0.339 (0.335) data 0.261 (0.258) loss_x loss_x 0.5073 (0.4138) acc_x 75.0000 (90.1042) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 330
confident_label rate tensor(0.6029, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 984
clean true:984
clean false:0
clean_rate:1.0
noisy true:318
noisy false:330
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 648
epoch [62/200] batch [5/30] time 0.320 (0.332) data 0.242 (0.255) loss_x loss_x 0.3220 (0.4305) acc_x 93.7500 (89.3750) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [10/30] time 0.353 (0.339) data 0.276 (0.262) loss_x loss_x 0.4714 (0.4091) acc_x 84.3750 (90.0000) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [15/30] time 0.340 (0.341) data 0.263 (0.264) loss_x loss_x 0.4519 (0.4292) acc_x 90.6250 (88.7500) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [20/30] time 0.334 (0.340) data 0.257 (0.263) loss_x loss_x 0.6089 (0.4206) acc_x 81.2500 (89.3750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [25/30] time 0.290 (0.334) data 0.213 (0.257) loss_x loss_x 0.2202 (0.3908) acc_x 96.8750 (90.6250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/30] time 0.321 (0.333) data 0.244 (0.256) loss_x loss_x 0.3572 (0.3872) acc_x 93.7500 (90.9375) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 330
confident_label rate tensor(0.6146, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1003
clean true:1003
clean false:0
clean_rate:1.0
noisy true:299
noisy false:330
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 629
epoch [63/200] batch [5/31] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.3665 (0.3362) acc_x 90.6250 (92.5000) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [10/31] time 0.293 (0.340) data 0.215 (0.263) loss_x loss_x 0.3296 (0.3410) acc_x 96.8750 (92.8125) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [15/31] time 0.332 (0.327) data 0.254 (0.250) loss_x loss_x 0.1350 (0.3244) acc_x 100.0000 (93.5417) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [20/31] time 0.332 (0.330) data 0.254 (0.252) loss_x loss_x 0.3906 (0.3467) acc_x 87.5000 (92.1875) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [25/31] time 0.345 (0.333) data 0.268 (0.255) loss_x loss_x 0.2788 (0.3588) acc_x 90.6250 (91.8750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/31] time 0.346 (0.334) data 0.268 (0.256) loss_x loss_x 0.4353 (0.3652) acc_x 90.6250 (91.7708) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 322
confident_label rate tensor(0.6140, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1002
clean true:1000
clean false:2
clean_rate:0.998003992015968
noisy true:310
noisy false:320
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 630
epoch [64/200] batch [5/31] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.3037 (0.4381) acc_x 96.8750 (89.3750) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [10/31] time 0.293 (0.334) data 0.216 (0.257) loss_x loss_x 0.3684 (0.4725) acc_x 96.8750 (90.0000) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [15/31] time 0.361 (0.334) data 0.283 (0.257) loss_x loss_x 0.2800 (0.4459) acc_x 93.7500 (90.4167) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [20/31] time 0.320 (0.335) data 0.243 (0.257) loss_x loss_x 0.2729 (0.4214) acc_x 93.7500 (90.7812) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [25/31] time 0.314 (0.327) data 0.236 (0.250) loss_x loss_x 0.2566 (0.4209) acc_x 96.8750 (90.5000) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/31] time 0.295 (0.324) data 0.218 (0.246) loss_x loss_x 0.4299 (0.4174) acc_x 87.5000 (90.1042) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 311
confident_label rate tensor(0.6207, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1013
clean true:1013
clean false:0
clean_rate:1.0
noisy true:308
noisy false:311
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 619
epoch [65/200] batch [5/31] time 0.343 (0.344) data 0.266 (0.267) loss_x loss_x 0.5146 (0.5323) acc_x 87.5000 (90.0000) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [10/31] time 0.352 (0.345) data 0.275 (0.267) loss_x loss_x 0.3728 (0.4382) acc_x 87.5000 (90.3125) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [15/31] time 0.348 (0.345) data 0.271 (0.268) loss_x loss_x 0.2825 (0.4383) acc_x 96.8750 (90.2083) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [20/31] time 0.341 (0.345) data 0.264 (0.268) loss_x loss_x 0.4958 (0.4395) acc_x 87.5000 (90.6250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [25/31] time 0.330 (0.339) data 0.252 (0.261) loss_x loss_x 0.3669 (0.4425) acc_x 90.6250 (90.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/31] time 0.332 (0.335) data 0.254 (0.258) loss_x loss_x 0.4556 (0.4268) acc_x 87.5000 (90.8333) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 326
confident_label rate tensor(0.6060, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 989
clean true:988
clean false:1
clean_rate:0.9989888776541962
noisy true:318
noisy false:325
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 643
epoch [66/200] batch [5/30] time 0.340 (0.336) data 0.263 (0.258) loss_x loss_x 0.6064 (0.3895) acc_x 84.3750 (90.0000) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [10/30] time 0.375 (0.348) data 0.298 (0.270) loss_x loss_x 0.3130 (0.3544) acc_x 93.7500 (91.5625) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [15/30] time 0.347 (0.346) data 0.270 (0.268) loss_x loss_x 0.3425 (0.3819) acc_x 87.5000 (90.6250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [20/30] time 0.349 (0.346) data 0.272 (0.269) loss_x loss_x 0.1635 (0.3637) acc_x 100.0000 (91.4062) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [25/30] time 0.347 (0.346) data 0.270 (0.269) loss_x loss_x 0.4548 (0.3966) acc_x 90.6250 (90.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/30] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.3281 (0.3985) acc_x 90.6250 (90.4167) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.6158, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1005
clean true:1005
clean false:0
clean_rate:1.0
noisy true:306
noisy false:321
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 627
epoch [67/200] batch [5/31] time 0.295 (0.323) data 0.218 (0.246) loss_x loss_x 0.4751 (0.3325) acc_x 90.6250 (95.0000) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [10/31] time 0.351 (0.329) data 0.274 (0.251) loss_x loss_x 0.2275 (0.3784) acc_x 90.6250 (91.8750) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [15/31] time 0.353 (0.335) data 0.275 (0.257) loss_x loss_x 0.2203 (0.3591) acc_x 96.8750 (93.1250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [20/31] time 0.339 (0.338) data 0.262 (0.260) loss_x loss_x 0.6978 (0.3981) acc_x 78.1250 (91.2500) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [25/31] time 0.345 (0.339) data 0.268 (0.261) loss_x loss_x 0.3157 (0.4027) acc_x 93.7500 (91.2500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [30/31] time 0.341 (0.337) data 0.264 (0.260) loss_x loss_x 0.3572 (0.3978) acc_x 93.7500 (91.6667) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.6072, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 991
clean true:991
clean false:0
clean_rate:1.0
noisy true:310
noisy false:331
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 641
epoch [68/200] batch [5/30] time 0.339 (0.343) data 0.262 (0.265) loss_x loss_x 0.4863 (0.4547) acc_x 90.6250 (89.3750) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [10/30] time 0.335 (0.348) data 0.258 (0.270) loss_x loss_x 0.3159 (0.3983) acc_x 93.7500 (90.6250) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [15/30] time 0.296 (0.330) data 0.219 (0.253) loss_x loss_x 0.3948 (0.3865) acc_x 93.7500 (91.4583) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/30] time 0.287 (0.327) data 0.210 (0.250) loss_x loss_x 0.5869 (0.4190) acc_x 87.5000 (90.3125) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [25/30] time 0.300 (0.321) data 0.222 (0.244) loss_x loss_x 0.4158 (0.4107) acc_x 87.5000 (90.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/30] time 0.341 (0.321) data 0.263 (0.243) loss_x loss_x 0.3794 (0.4162) acc_x 90.6250 (90.0000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.6250, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1020
clean true:1018
clean false:2
clean_rate:0.9980392156862745
noisy true:313
noisy false:299
after delete: len(clean_dataset) 1020
after delete: len(noisy_dataset) 612
epoch [69/200] batch [5/31] time 0.357 (0.347) data 0.279 (0.270) loss_x loss_x 0.3083 (0.3447) acc_x 96.8750 (93.7500) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [10/31] time 0.346 (0.344) data 0.268 (0.267) loss_x loss_x 0.2839 (0.3927) acc_x 93.7500 (92.5000) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [15/31] time 0.338 (0.342) data 0.260 (0.265) loss_x loss_x 0.4031 (0.4065) acc_x 90.6250 (91.8750) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [20/31] time 0.352 (0.345) data 0.275 (0.268) loss_x loss_x 0.3677 (0.3986) acc_x 90.6250 (91.5625) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [25/31] time 0.319 (0.342) data 0.242 (0.265) loss_x loss_x 0.4795 (0.4288) acc_x 90.6250 (90.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/31] time 0.342 (0.342) data 0.265 (0.265) loss_x loss_x 0.3608 (0.4397) acc_x 93.7500 (90.5208) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 322
confident_label rate tensor(0.6152, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1004
clean true:1004
clean false:0
clean_rate:1.0
noisy true:306
noisy false:322
after delete: len(clean_dataset) 1004
after delete: len(noisy_dataset) 628
epoch [70/200] batch [5/31] time 0.332 (0.312) data 0.254 (0.234) loss_x loss_x 0.4043 (0.4809) acc_x 90.6250 (87.5000) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [10/31] time 0.333 (0.326) data 0.256 (0.248) loss_x loss_x 0.3850 (0.4040) acc_x 93.7500 (91.5625) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [15/31] time 0.338 (0.332) data 0.261 (0.255) loss_x loss_x 0.2859 (0.4123) acc_x 90.6250 (90.4167) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [20/31] time 0.334 (0.334) data 0.257 (0.257) loss_x loss_x 0.6289 (0.4249) acc_x 81.2500 (89.6875) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [25/31] time 0.338 (0.334) data 0.261 (0.257) loss_x loss_x 0.2451 (0.4443) acc_x 96.8750 (88.5000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/31] time 0.339 (0.335) data 0.262 (0.258) loss_x loss_x 0.4119 (0.4314) acc_x 90.6250 (88.9583) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.6238, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1018
clean true:1018
clean false:0
clean_rate:1.0
noisy true:313
noisy false:301
after delete: len(clean_dataset) 1018
after delete: len(noisy_dataset) 614
epoch [71/200] batch [5/31] time 0.336 (0.338) data 0.258 (0.260) loss_x loss_x 0.1815 (0.4538) acc_x 96.8750 (91.2500) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [10/31] time 0.312 (0.323) data 0.235 (0.245) loss_x loss_x 0.3992 (0.4849) acc_x 87.5000 (89.3750) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [15/31] time 0.339 (0.329) data 0.261 (0.251) loss_x loss_x 0.6611 (0.5069) acc_x 87.5000 (89.3750) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [20/31] time 0.347 (0.334) data 0.270 (0.257) loss_x loss_x 0.6074 (0.4608) acc_x 90.6250 (90.6250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [25/31] time 0.347 (0.336) data 0.269 (0.258) loss_x loss_x 0.3240 (0.4513) acc_x 90.6250 (90.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/31] time 0.336 (0.337) data 0.259 (0.260) loss_x loss_x 0.2981 (0.4291) acc_x 93.7500 (90.7292) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 310
confident_label rate tensor(0.6183, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1009
clean true:1009
clean false:0
clean_rate:1.0
noisy true:313
noisy false:310
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 623
epoch [72/200] batch [5/31] time 0.337 (0.343) data 0.260 (0.266) loss_x loss_x 0.3364 (0.2951) acc_x 96.8750 (95.6250) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [10/31] time 0.343 (0.343) data 0.266 (0.266) loss_x loss_x 0.2622 (0.3133) acc_x 96.8750 (94.3750) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [15/31] time 0.291 (0.338) data 0.214 (0.261) loss_x loss_x 0.3076 (0.3223) acc_x 93.7500 (93.9583) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [20/31] time 0.325 (0.329) data 0.247 (0.251) loss_x loss_x 0.4211 (0.3391) acc_x 87.5000 (93.4375) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/31] time 0.342 (0.330) data 0.265 (0.253) loss_x loss_x 0.2671 (0.3523) acc_x 90.6250 (92.6250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/31] time 0.343 (0.332) data 0.266 (0.255) loss_x loss_x 0.4438 (0.3704) acc_x 90.6250 (91.7708) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 326
confident_label rate tensor(0.6115, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 998
clean true:997
clean false:1
clean_rate:0.998997995991984
noisy true:309
noisy false:325
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 634
epoch [73/200] batch [5/31] time 0.292 (0.293) data 0.215 (0.215) loss_x loss_x 0.3586 (0.3753) acc_x 93.7500 (90.6250) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [10/31] time 0.335 (0.318) data 0.258 (0.241) loss_x loss_x 0.4797 (0.3475) acc_x 90.6250 (91.8750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [15/31] time 0.339 (0.328) data 0.262 (0.251) loss_x loss_x 0.3674 (0.3394) acc_x 90.6250 (91.8750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [20/31] time 0.341 (0.331) data 0.263 (0.254) loss_x loss_x 0.4167 (0.3706) acc_x 93.7500 (91.8750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [25/31] time 0.347 (0.331) data 0.270 (0.254) loss_x loss_x 0.3735 (0.3798) acc_x 87.5000 (91.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/31] time 0.337 (0.334) data 0.259 (0.257) loss_x loss_x 0.3694 (0.3873) acc_x 93.7500 (91.8750) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 306
confident_label rate tensor(0.6146, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1003
clean true:1003
clean false:0
clean_rate:1.0
noisy true:323
noisy false:306
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 629
epoch [74/200] batch [5/31] time 0.343 (0.339) data 0.266 (0.262) loss_x loss_x 0.2925 (0.3703) acc_x 96.8750 (93.1250) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [10/31] time 0.340 (0.339) data 0.263 (0.262) loss_x loss_x 0.5522 (0.4006) acc_x 84.3750 (91.5625) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [15/31] time 0.340 (0.334) data 0.262 (0.256) loss_x loss_x 0.4402 (0.4273) acc_x 90.6250 (90.6250) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [20/31] time 0.333 (0.332) data 0.256 (0.254) loss_x loss_x 0.6104 (0.4298) acc_x 84.3750 (90.1562) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [25/31] time 0.328 (0.329) data 0.250 (0.252) loss_x loss_x 0.5781 (0.4398) acc_x 81.2500 (89.7500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/31] time 0.349 (0.332) data 0.271 (0.255) loss_x loss_x 0.5117 (0.4339) acc_x 90.6250 (90.3125) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 314
confident_label rate tensor(0.6152, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1004
clean true:1003
clean false:1
clean_rate:0.999003984063745
noisy true:315
noisy false:313
after delete: len(clean_dataset) 1004
after delete: len(noisy_dataset) 628
epoch [75/200] batch [5/31] time 0.366 (0.357) data 0.288 (0.280) loss_x loss_x 0.3887 (0.3977) acc_x 93.7500 (93.1250) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [10/31] time 0.360 (0.357) data 0.284 (0.280) loss_x loss_x 0.5229 (0.4212) acc_x 90.6250 (92.8125) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [15/31] time 0.350 (0.354) data 0.272 (0.276) loss_x loss_x 0.4873 (0.4558) acc_x 87.5000 (92.0833) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [20/31] time 0.344 (0.351) data 0.266 (0.273) loss_x loss_x 0.4336 (0.4290) acc_x 90.6250 (92.1875) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [25/31] time 0.295 (0.347) data 0.217 (0.269) loss_x loss_x 0.3450 (0.4278) acc_x 90.6250 (91.3750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [30/31] time 0.311 (0.343) data 0.234 (0.266) loss_x loss_x 0.1975 (0.4128) acc_x 93.7500 (91.4583) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 319
confident_label rate tensor(0.6158, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1005
clean true:1005
clean false:0
clean_rate:1.0
noisy true:308
noisy false:319
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 627
epoch [76/200] batch [5/31] time 0.338 (0.328) data 0.260 (0.250) loss_x loss_x 0.5811 (0.4102) acc_x 87.5000 (91.2500) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [10/31] time 0.362 (0.334) data 0.285 (0.257) loss_x loss_x 0.4099 (0.4002) acc_x 90.6250 (90.9375) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [15/31] time 0.347 (0.337) data 0.269 (0.260) loss_x loss_x 0.5645 (0.3995) acc_x 84.3750 (90.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [20/31] time 0.340 (0.339) data 0.262 (0.262) loss_x loss_x 0.6226 (0.4121) acc_x 81.2500 (89.6875) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [25/31] time 0.346 (0.340) data 0.269 (0.263) loss_x loss_x 0.3162 (0.3993) acc_x 93.7500 (90.5000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/31] time 0.294 (0.337) data 0.216 (0.260) loss_x loss_x 0.3276 (0.3997) acc_x 93.7500 (90.5208) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 298
confident_label rate tensor(0.6213, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1014
clean true:1014
clean false:0
clean_rate:1.0
noisy true:320
noisy false:298
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 618
epoch [77/200] batch [5/31] time 0.329 (0.335) data 0.251 (0.257) loss_x loss_x 0.3606 (0.3939) acc_x 90.6250 (91.2500) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [10/31] time 0.326 (0.338) data 0.249 (0.260) loss_x loss_x 0.4766 (0.4817) acc_x 87.5000 (89.0625) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [15/31] time 0.291 (0.324) data 0.214 (0.246) loss_x loss_x 0.3528 (0.4076) acc_x 93.7500 (90.2083) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [20/31] time 0.342 (0.323) data 0.265 (0.246) loss_x loss_x 0.4590 (0.4162) acc_x 87.5000 (89.5312) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [25/31] time 0.341 (0.326) data 0.264 (0.249) loss_x loss_x 0.6777 (0.4231) acc_x 84.3750 (89.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/31] time 0.361 (0.330) data 0.284 (0.253) loss_x loss_x 0.2299 (0.4199) acc_x 96.8750 (89.5833) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 310
confident_label rate tensor(0.6158, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1005
clean true:1005
clean false:0
clean_rate:1.0
noisy true:317
noisy false:310
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 627
epoch [78/200] batch [5/31] time 0.333 (0.341) data 0.255 (0.263) loss_x loss_x 0.4319 (0.5026) acc_x 90.6250 (88.1250) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [10/31] time 0.316 (0.339) data 0.238 (0.261) loss_x loss_x 0.4016 (0.4279) acc_x 90.6250 (90.0000) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [15/31] time 0.312 (0.327) data 0.235 (0.250) loss_x loss_x 0.2866 (0.3905) acc_x 90.6250 (90.6250) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [20/31] time 0.352 (0.330) data 0.274 (0.252) loss_x loss_x 0.5259 (0.3821) acc_x 90.6250 (91.4062) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [25/31] time 0.335 (0.334) data 0.258 (0.256) loss_x loss_x 0.7031 (0.3925) acc_x 81.2500 (91.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/31] time 0.338 (0.334) data 0.261 (0.257) loss_x loss_x 0.1935 (0.3757) acc_x 96.8750 (91.5625) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 272
confident_label rate tensor(0.6324, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1032
clean true:1032
clean false:0
clean_rate:1.0
noisy true:328
noisy false:272
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 600
epoch [79/200] batch [5/32] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.2280 (0.4052) acc_x 93.7500 (91.2500) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [10/32] time 0.333 (0.341) data 0.256 (0.264) loss_x loss_x 0.4302 (0.4029) acc_x 90.6250 (90.9375) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [15/32] time 0.347 (0.342) data 0.270 (0.265) loss_x loss_x 0.2467 (0.4020) acc_x 93.7500 (90.4167) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [20/32] time 0.286 (0.336) data 0.209 (0.258) loss_x loss_x 0.5894 (0.3965) acc_x 90.6250 (90.9375) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [25/32] time 0.311 (0.328) data 0.234 (0.250) loss_x loss_x 0.2100 (0.3858) acc_x 96.8750 (91.2500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/32] time 0.343 (0.330) data 0.265 (0.253) loss_x loss_x 0.4543 (0.4137) acc_x 87.5000 (90.4167) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 291
confident_label rate tensor(0.6275, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1024
clean true:1023
clean false:1
clean_rate:0.9990234375
noisy true:318
noisy false:290
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 608
epoch [80/200] batch [5/32] time 0.293 (0.295) data 0.216 (0.218) loss_x loss_x 0.8140 (0.4271) acc_x 81.2500 (91.2500) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [10/32] time 0.304 (0.297) data 0.226 (0.219) loss_x loss_x 0.2791 (0.3490) acc_x 96.8750 (93.1250) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [15/32] time 0.299 (0.297) data 0.221 (0.219) loss_x loss_x 0.2905 (0.3647) acc_x 93.7500 (91.6667) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [20/32] time 0.290 (0.297) data 0.212 (0.219) loss_x loss_x 0.2534 (0.3681) acc_x 96.8750 (91.7188) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [25/32] time 0.344 (0.306) data 0.266 (0.228) loss_x loss_x 0.2859 (0.3773) acc_x 90.6250 (91.5000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/32] time 0.339 (0.311) data 0.262 (0.233) loss_x loss_x 0.8311 (0.3967) acc_x 81.2500 (91.0417) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 278
confident_label rate tensor(0.6324, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1032
clean true:1032
clean false:0
clean_rate:1.0
noisy true:322
noisy false:278
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 600
epoch [81/200] batch [5/32] time 0.334 (0.345) data 0.257 (0.268) loss_x loss_x 0.3965 (0.4219) acc_x 90.6250 (89.3750) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/32] time 0.330 (0.344) data 0.253 (0.267) loss_x loss_x 0.5713 (0.3918) acc_x 90.6250 (90.9375) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [15/32] time 0.343 (0.344) data 0.266 (0.266) loss_x loss_x 0.4297 (0.4130) acc_x 90.6250 (89.5833) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [20/32] time 0.332 (0.342) data 0.254 (0.265) loss_x loss_x 0.5059 (0.4125) acc_x 81.2500 (88.9062) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/32] time 0.337 (0.334) data 0.260 (0.257) loss_x loss_x 0.2883 (0.4083) acc_x 93.7500 (89.6250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/32] time 0.341 (0.336) data 0.263 (0.259) loss_x loss_x 0.5825 (0.4088) acc_x 87.5000 (89.7917) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.6354, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1037
clean true:1037
clean false:0
clean_rate:1.0
noisy true:322
noisy false:273
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 595
epoch [82/200] batch [5/32] time 0.318 (0.312) data 0.240 (0.234) loss_x loss_x 0.2859 (0.4523) acc_x 90.6250 (88.1250) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [10/32] time 0.362 (0.330) data 0.285 (0.253) loss_x loss_x 0.4763 (0.4554) acc_x 81.2500 (86.8750) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [15/32] time 0.367 (0.338) data 0.289 (0.260) loss_x loss_x 0.7134 (0.4717) acc_x 78.1250 (86.6667) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [20/32] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.1342 (0.4329) acc_x 100.0000 (88.2812) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [25/32] time 0.325 (0.340) data 0.248 (0.262) loss_x loss_x 0.3821 (0.4336) acc_x 87.5000 (88.1250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [30/32] time 0.333 (0.340) data 0.255 (0.262) loss_x loss_x 0.4099 (0.4299) acc_x 87.5000 (88.2292) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.6311, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1030
clean true:1030
clean false:0
clean_rate:1.0
noisy true:327
noisy false:275
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 602
epoch [83/200] batch [5/32] time 0.361 (0.365) data 0.283 (0.287) loss_x loss_x 0.4036 (0.4297) acc_x 87.5000 (89.3750) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [10/32] time 0.400 (0.367) data 0.322 (0.290) loss_x loss_x 0.2866 (0.3863) acc_x 93.7500 (91.2500) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [15/32] time 0.309 (0.361) data 0.231 (0.283) loss_x loss_x 0.2124 (0.3784) acc_x 96.8750 (90.8333) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [20/32] time 0.305 (0.348) data 0.227 (0.271) loss_x loss_x 0.1660 (0.4056) acc_x 96.8750 (90.1562) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/32] time 0.293 (0.338) data 0.216 (0.260) loss_x loss_x 0.7222 (0.4032) acc_x 81.2500 (90.3750) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/32] time 0.344 (0.332) data 0.266 (0.255) loss_x loss_x 0.6157 (0.4074) acc_x 84.3750 (90.2083) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.6317, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1031
clean true:1030
clean false:1
clean_rate:0.9990300678952473
noisy true:315
noisy false:286
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 601
epoch [84/200] batch [5/32] time 0.344 (0.361) data 0.266 (0.283) loss_x loss_x 0.7080 (0.4115) acc_x 78.1250 (86.2500) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/32] time 0.397 (0.369) data 0.320 (0.291) loss_x loss_x 0.4985 (0.3973) acc_x 93.7500 (90.3125) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [15/32] time 0.351 (0.364) data 0.272 (0.286) loss_x loss_x 0.3706 (0.4111) acc_x 84.3750 (89.3750) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [20/32] time 0.355 (0.364) data 0.277 (0.286) loss_x loss_x 0.4890 (0.4172) acc_x 90.6250 (89.2188) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [25/32] time 0.342 (0.365) data 0.265 (0.287) loss_x loss_x 0.2173 (0.4246) acc_x 93.7500 (88.6250) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/32] time 0.336 (0.360) data 0.259 (0.282) loss_x loss_x 0.3425 (0.4121) acc_x 90.6250 (89.3750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 289
confident_label rate tensor(0.6262, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1022
clean true:1022
clean false:0
clean_rate:1.0
noisy true:321
noisy false:289
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 610
epoch [85/200] batch [5/31] time 0.355 (0.358) data 0.278 (0.281) loss_x loss_x 0.3027 (0.3768) acc_x 93.7500 (91.2500) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [10/31] time 0.353 (0.369) data 0.276 (0.292) loss_x loss_x 0.3511 (0.3767) acc_x 96.8750 (92.5000) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [15/31] time 0.358 (0.367) data 0.281 (0.290) loss_x loss_x 0.3340 (0.3465) acc_x 90.6250 (92.9167) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [20/31] time 0.335 (0.368) data 0.257 (0.290) loss_x loss_x 0.3599 (0.3492) acc_x 90.6250 (92.8125) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [25/31] time 0.357 (0.365) data 0.279 (0.287) loss_x loss_x 0.4128 (0.3353) acc_x 87.5000 (93.1250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [30/31] time 0.336 (0.362) data 0.258 (0.284) loss_x loss_x 0.7544 (0.3785) acc_x 90.6250 (91.7708) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.6268, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1023
clean true:1022
clean false:1
clean_rate:0.9990224828934506
noisy true:326
noisy false:283
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 609
epoch [86/200] batch [5/31] time 0.308 (0.345) data 0.230 (0.267) loss_x loss_x 0.3542 (0.3925) acc_x 90.6250 (91.8750) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [10/31] time 0.310 (0.324) data 0.233 (0.246) loss_x loss_x 0.3420 (0.4032) acc_x 90.6250 (90.9375) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [15/31] time 0.332 (0.333) data 0.255 (0.255) loss_x loss_x 0.4224 (0.3651) acc_x 84.3750 (91.6667) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [20/31] time 0.351 (0.338) data 0.273 (0.260) loss_x loss_x 0.2262 (0.3534) acc_x 93.7500 (92.1875) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [25/31] time 0.356 (0.345) data 0.278 (0.267) loss_x loss_x 0.2163 (0.3476) acc_x 93.7500 (92.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/31] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.4397 (0.3691) acc_x 84.3750 (91.6667) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 274
confident_label rate tensor(0.6299, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1028
clean true:1028
clean false:0
clean_rate:1.0
noisy true:330
noisy false:274
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 604
epoch [87/200] batch [5/32] time 0.377 (0.365) data 0.299 (0.288) loss_x loss_x 0.5342 (0.4227) acc_x 93.7500 (89.3750) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/32] time 0.372 (0.362) data 0.294 (0.284) loss_x loss_x 0.2793 (0.4116) acc_x 93.7500 (90.3125) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/32] time 0.353 (0.362) data 0.274 (0.285) loss_x loss_x 0.4290 (0.3936) acc_x 90.6250 (90.8333) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [20/32] time 0.357 (0.350) data 0.279 (0.273) loss_x loss_x 0.4536 (0.4049) acc_x 90.6250 (90.4688) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [25/32] time 0.353 (0.352) data 0.274 (0.274) loss_x loss_x 0.4988 (0.3948) acc_x 87.5000 (90.5000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/32] time 0.348 (0.351) data 0.270 (0.274) loss_x loss_x 0.2722 (0.3907) acc_x 96.8750 (90.4167) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.6403, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1045
clean true:1043
clean false:2
clean_rate:0.9980861244019139
noisy true:326
noisy false:261
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 587
epoch [88/200] batch [5/32] time 0.351 (0.368) data 0.273 (0.290) loss_x loss_x 0.3054 (0.3736) acc_x 90.6250 (89.3750) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [10/32] time 0.360 (0.363) data 0.282 (0.285) loss_x loss_x 0.6714 (0.4739) acc_x 75.0000 (88.1250) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [15/32] time 0.362 (0.365) data 0.285 (0.287) loss_x loss_x 0.3945 (0.4873) acc_x 87.5000 (89.1667) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [20/32] time 0.337 (0.367) data 0.259 (0.290) loss_x loss_x 0.2036 (0.4768) acc_x 96.8750 (89.3750) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [25/32] time 0.347 (0.359) data 0.270 (0.282) loss_x loss_x 0.3420 (0.4949) acc_x 90.6250 (88.8750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [30/32] time 0.387 (0.360) data 0.309 (0.282) loss_x loss_x 0.5137 (0.4873) acc_x 84.3750 (88.8542) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.6501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1061
clean true:1061
clean false:0
clean_rate:1.0
noisy true:324
noisy false:247
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 571
epoch [89/200] batch [5/33] time 0.347 (0.358) data 0.270 (0.280) loss_x loss_x 0.5269 (0.4920) acc_x 84.3750 (87.5000) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [10/33] time 0.366 (0.359) data 0.289 (0.282) loss_x loss_x 0.4309 (0.4326) acc_x 90.6250 (89.0625) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [15/33] time 0.344 (0.356) data 0.267 (0.278) loss_x loss_x 0.7280 (0.4688) acc_x 78.1250 (88.3333) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [20/33] time 0.352 (0.350) data 0.274 (0.272) loss_x loss_x 0.5889 (0.4660) acc_x 90.6250 (88.5938) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [25/33] time 0.374 (0.351) data 0.297 (0.273) loss_x loss_x 0.6899 (0.4658) acc_x 84.3750 (88.7500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [30/33] time 0.390 (0.354) data 0.312 (0.276) loss_x loss_x 0.2465 (0.4563) acc_x 93.7500 (89.1667) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.6348, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1036
clean true:1036
clean false:0
clean_rate:1.0
noisy true:331
noisy false:265
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 596
epoch [90/200] batch [5/32] time 0.342 (0.367) data 0.264 (0.290) loss_x loss_x 0.2451 (0.3133) acc_x 96.8750 (93.1250) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/32] time 0.378 (0.361) data 0.300 (0.284) loss_x loss_x 0.4480 (0.3392) acc_x 90.6250 (92.5000) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [15/32] time 0.348 (0.362) data 0.270 (0.285) loss_x loss_x 0.5054 (0.3673) acc_x 87.5000 (92.0833) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [20/32] time 0.308 (0.354) data 0.230 (0.276) loss_x loss_x 0.2766 (0.3707) acc_x 100.0000 (92.1875) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [25/32] time 0.398 (0.360) data 0.320 (0.282) loss_x loss_x 0.6621 (0.3853) acc_x 78.1250 (91.8750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [30/32] time 0.376 (0.361) data 0.298 (0.284) loss_x loss_x 0.5801 (0.3951) acc_x 84.3750 (91.3542) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.6471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1056
clean true:1056
clean false:0
clean_rate:1.0
noisy true:321
noisy false:255
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 576
epoch [91/200] batch [5/33] time 0.355 (0.358) data 0.277 (0.280) loss_x loss_x 0.5288 (0.3616) acc_x 90.6250 (92.5000) lr 1.1719e-03 eta 0:00:10
epoch [91/200] batch [10/33] time 0.385 (0.361) data 0.307 (0.283) loss_x loss_x 0.2410 (0.3181) acc_x 96.8750 (92.8125) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/33] time 0.368 (0.372) data 0.290 (0.295) loss_x loss_x 0.3562 (0.3642) acc_x 90.6250 (92.5000) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [20/33] time 0.391 (0.381) data 0.314 (0.304) loss_x loss_x 0.2922 (0.3560) acc_x 96.8750 (92.6562) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/33] time 0.307 (0.369) data 0.229 (0.292) loss_x loss_x 0.4797 (0.3539) acc_x 87.5000 (92.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/33] time 0.334 (0.364) data 0.256 (0.286) loss_x loss_x 0.3923 (0.3637) acc_x 90.6250 (92.2917) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.6501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1061
clean true:1059
clean false:2
clean_rate:0.998114985862394
noisy true:331
noisy false:240
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 571
epoch [92/200] batch [5/33] time 0.429 (0.390) data 0.351 (0.313) loss_x loss_x 0.1938 (0.2589) acc_x 96.8750 (93.7500) lr 1.1564e-03 eta 0:00:10
epoch [92/200] batch [10/33] time 0.351 (0.387) data 0.273 (0.309) loss_x loss_x 0.5679 (0.3736) acc_x 81.2500 (90.3125) lr 1.1564e-03 eta 0:00:08
epoch [92/200] batch [15/33] time 0.376 (0.382) data 0.299 (0.304) loss_x loss_x 0.3965 (0.3893) acc_x 87.5000 (89.7917) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [20/33] time 0.380 (0.383) data 0.303 (0.305) loss_x loss_x 0.4670 (0.3985) acc_x 90.6250 (90.0000) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [25/33] time 0.306 (0.373) data 0.228 (0.295) loss_x loss_x 0.4221 (0.3988) acc_x 84.3750 (90.1250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/33] time 0.310 (0.362) data 0.233 (0.284) loss_x loss_x 0.5737 (0.4002) acc_x 87.5000 (90.2083) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.6397, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1044
clean true:1043
clean false:1
clean_rate:0.9990421455938697
noisy true:332
noisy false:256
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 588
epoch [93/200] batch [5/32] time 0.416 (0.387) data 0.338 (0.309) loss_x loss_x 0.4175 (0.3491) acc_x 90.6250 (91.2500) lr 1.1409e-03 eta 0:00:10
epoch [93/200] batch [10/32] time 0.327 (0.369) data 0.249 (0.291) loss_x loss_x 0.2854 (0.3676) acc_x 96.8750 (90.0000) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [15/32] time 0.332 (0.358) data 0.254 (0.281) loss_x loss_x 0.4602 (0.4421) acc_x 90.6250 (88.9583) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [20/32] time 0.366 (0.357) data 0.289 (0.279) loss_x loss_x 0.3137 (0.4201) acc_x 90.6250 (89.6875) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [25/32] time 0.388 (0.363) data 0.309 (0.286) loss_x loss_x 0.1993 (0.4408) acc_x 96.8750 (89.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [30/32] time 0.340 (0.369) data 0.263 (0.291) loss_x loss_x 0.3755 (0.4267) acc_x 90.6250 (89.8958) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.6544, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1068
clean true:1068
clean false:0
clean_rate:1.0
noisy true:336
noisy false:228
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 564
epoch [94/200] batch [5/33] time 0.348 (0.352) data 0.271 (0.274) loss_x loss_x 0.5181 (0.4392) acc_x 84.3750 (90.6250) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [10/33] time 0.395 (0.371) data 0.317 (0.293) loss_x loss_x 0.4907 (0.4552) acc_x 93.7500 (90.0000) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [15/33] time 0.359 (0.374) data 0.281 (0.296) loss_x loss_x 0.4312 (0.4767) acc_x 90.6250 (89.5833) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [20/33] time 0.400 (0.378) data 0.323 (0.301) loss_x loss_x 0.2009 (0.4440) acc_x 93.7500 (89.6875) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [25/33] time 0.349 (0.373) data 0.271 (0.295) loss_x loss_x 0.5342 (0.4413) acc_x 81.2500 (89.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/33] time 0.335 (0.368) data 0.258 (0.290) loss_x loss_x 0.7344 (0.4259) acc_x 81.2500 (90.0000) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.6458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1054
clean true:1053
clean false:1
clean_rate:0.9990512333965844
noisy true:330
noisy false:248
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 578
epoch [95/200] batch [5/32] time 0.349 (0.367) data 0.271 (0.289) loss_x loss_x 0.2820 (0.3456) acc_x 96.8750 (93.1250) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [10/32] time 0.410 (0.383) data 0.333 (0.305) loss_x loss_x 0.5820 (0.3651) acc_x 84.3750 (92.8125) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [15/32] time 0.368 (0.375) data 0.290 (0.297) loss_x loss_x 0.5796 (0.4124) acc_x 84.3750 (91.4583) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [20/32] time 0.358 (0.375) data 0.280 (0.297) loss_x loss_x 0.5952 (0.4019) acc_x 90.6250 (91.7188) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [25/32] time 0.344 (0.372) data 0.267 (0.295) loss_x loss_x 0.2964 (0.3961) acc_x 93.7500 (91.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [30/32] time 0.336 (0.367) data 0.258 (0.290) loss_x loss_x 0.4758 (0.3969) acc_x 90.6250 (91.3542) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.6520, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1064
clean true:1064
clean false:0
clean_rate:1.0
noisy true:341
noisy false:227
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 568
epoch [96/200] batch [5/33] time 0.404 (0.340) data 0.326 (0.261) loss_x loss_x 0.2893 (0.3661) acc_x 90.6250 (91.2500) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [10/33] time 0.366 (0.365) data 0.288 (0.287) loss_x loss_x 0.4890 (0.3806) acc_x 87.5000 (91.2500) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [15/33] time 0.407 (0.376) data 0.328 (0.298) loss_x loss_x 0.2507 (0.3601) acc_x 96.8750 (91.6667) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [20/33] time 0.311 (0.368) data 0.232 (0.290) loss_x loss_x 0.4177 (0.3595) acc_x 93.7500 (92.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [25/33] time 0.297 (0.355) data 0.219 (0.277) loss_x loss_x 0.5469 (0.3738) acc_x 93.7500 (92.2500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [30/33] time 0.306 (0.348) data 0.227 (0.270) loss_x loss_x 0.5396 (0.3774) acc_x 90.6250 (92.2917) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1075
clean true:1075
clean false:0
clean_rate:1.0
noisy true:333
noisy false:224
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 557
epoch [97/200] batch [5/33] time 0.358 (0.387) data 0.280 (0.309) loss_x loss_x 0.5039 (0.2584) acc_x 87.5000 (95.6250) lr 1.0785e-03 eta 0:00:10
epoch [97/200] batch [10/33] time 0.361 (0.379) data 0.282 (0.300) loss_x loss_x 0.3318 (0.2786) acc_x 90.6250 (94.3750) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [15/33] time 0.291 (0.353) data 0.213 (0.274) loss_x loss_x 0.4302 (0.3243) acc_x 84.3750 (92.7083) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [20/33] time 0.309 (0.339) data 0.231 (0.261) loss_x loss_x 0.1493 (0.3423) acc_x 100.0000 (92.9688) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [25/33] time 0.303 (0.333) data 0.225 (0.254) loss_x loss_x 0.3564 (0.3370) acc_x 93.7500 (93.1250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [30/33] time 0.364 (0.334) data 0.286 (0.256) loss_x loss_x 0.5903 (0.3329) acc_x 78.1250 (92.9167) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.6501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1061
clean true:1060
clean false:1
clean_rate:0.9990574929311969
noisy true:341
noisy false:230
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 571
epoch [98/200] batch [5/33] time 0.437 (0.393) data 0.360 (0.314) loss_x loss_x 0.4712 (0.4229) acc_x 84.3750 (89.3750) lr 1.0628e-03 eta 0:00:10
epoch [98/200] batch [10/33] time 0.351 (0.371) data 0.273 (0.293) loss_x loss_x 0.5239 (0.4255) acc_x 84.3750 (90.0000) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [15/33] time 0.330 (0.358) data 0.252 (0.280) loss_x loss_x 0.6738 (0.4252) acc_x 87.5000 (90.8333) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [20/33] time 0.383 (0.351) data 0.306 (0.273) loss_x loss_x 0.4431 (0.4088) acc_x 84.3750 (90.7812) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [25/33] time 0.347 (0.352) data 0.268 (0.274) loss_x loss_x 0.5942 (0.4160) acc_x 87.5000 (90.2500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/33] time 0.309 (0.348) data 0.231 (0.269) loss_x loss_x 0.3235 (0.3996) acc_x 90.6250 (90.6250) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.6409, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1046
clean true:1046
clean false:0
clean_rate:1.0
noisy true:336
noisy false:250
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 586
epoch [99/200] batch [5/32] time 0.348 (0.369) data 0.271 (0.292) loss_x loss_x 0.2164 (0.3158) acc_x 93.7500 (93.7500) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/32] time 0.322 (0.349) data 0.244 (0.271) loss_x loss_x 0.2568 (0.3288) acc_x 93.7500 (91.5625) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [15/32] time 0.337 (0.344) data 0.260 (0.266) loss_x loss_x 0.4744 (0.3895) acc_x 87.5000 (90.6250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [20/32] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.2598 (0.3811) acc_x 96.8750 (91.0938) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [25/32] time 0.342 (0.346) data 0.264 (0.269) loss_x loss_x 0.5571 (0.4013) acc_x 87.5000 (90.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/32] time 0.348 (0.348) data 0.271 (0.270) loss_x loss_x 0.5312 (0.4003) acc_x 90.6250 (90.5208) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.6538, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1067
clean true:1066
clean false:1
clean_rate:0.9990627928772259
noisy true:327
noisy false:238
all clean rate:  [0.9929078014184397, 0.9939024390243902, 0.9984276729559748, 0.9985141158989599, 0.9971098265895953, 0.9957446808510638, 1.0, 0.9971910112359551, 1.0, 0.9986522911051213, 0.9944055944055944, 0.9986468200270636, 0.9973579920739762, 0.9973992197659298, 0.9974226804123711, 0.9986876640419947, 0.9974651457541192, 0.9975031210986267, 0.9987546699875467, 1.0, 1.0, 0.9988151658767772, 0.9988235294117647, 1.0, 0.9988276670574443, 0.9988344988344988, 0.998849252013809, 0.9988558352402745, 1.0, 0.9988839285714286, 0.9955406911928651, 1.0, 0.9988558352402745, 0.9988876529477196, 0.9988864142538976, 1.0, 0.9988938053097345, 1.0, 0.9989023051591658, 1.0, 0.9989270386266095, 1.0, 1.0, 0.9978768577494692, 0.9989429175475687, 1.0, 0.9989743589743589, 1.0, 0.9979445015416238, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.998989898989899, 1.0, 1.0, 0.9969758064516129, 1.0, 1.0, 1.0, 0.998003992015968, 1.0, 0.9989888776541962, 1.0, 1.0, 0.9980392156862745, 1.0, 1.0, 1.0, 0.998997995991984, 1.0, 0.999003984063745, 1.0, 1.0, 1.0, 1.0, 0.9990234375, 1.0, 1.0, 1.0, 0.9990300678952473, 1.0, 0.9990224828934506, 1.0, 0.9980861244019139, 1.0, 1.0, 1.0, 0.998114985862394, 0.9990421455938697, 1.0, 0.9990512333965844, 1.0, 1.0, 0.9990574929311969, 1.0, 0.9990627928772259]
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 565
epoch [100/200] batch [5/33] time 0.357 (0.356) data 0.279 (0.279) loss_x loss_x 0.5029 (0.4342) acc_x 84.3750 (89.3750) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [10/33] time 0.341 (0.353) data 0.264 (0.275) loss_x loss_x 0.4067 (0.4373) acc_x 93.7500 (90.3125) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [15/33] time 0.333 (0.349) data 0.255 (0.272) loss_x loss_x 0.4788 (0.4017) acc_x 90.6250 (91.6667) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [20/33] time 0.354 (0.348) data 0.277 (0.270) loss_x loss_x 0.3340 (0.4098) acc_x 93.7500 (91.7188) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [25/33] time 0.368 (0.348) data 0.290 (0.270) loss_x loss_x 0.5103 (0.4240) acc_x 90.6250 (91.3750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [30/33] time 0.324 (0.353) data 0.246 (0.276) loss_x loss_x 0.6992 (0.4453) acc_x 78.1250 (90.5208) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.6593, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1076
clean true:1076
clean false:0
clean_rate:1.0
noisy true:336
noisy false:220
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 556
epoch [101/200] batch [5/33] time 0.338 (0.372) data 0.260 (0.294) loss_x loss_x 0.4216 (0.2851) acc_x 84.3750 (92.5000) lr 1.0157e-03 eta 0:00:10
epoch [101/200] batch [10/33] time 0.322 (0.348) data 0.244 (0.270) loss_x loss_x 0.3254 (0.3288) acc_x 93.7500 (91.5625) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [15/33] time 0.353 (0.346) data 0.275 (0.268) loss_x loss_x 0.1825 (0.3396) acc_x 96.8750 (92.0833) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [20/33] time 0.358 (0.350) data 0.281 (0.273) loss_x loss_x 0.3884 (0.3704) acc_x 90.6250 (92.0312) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [25/33] time 0.394 (0.354) data 0.317 (0.276) loss_x loss_x 0.4619 (0.3690) acc_x 90.6250 (92.0000) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [30/33] time 0.364 (0.354) data 0.286 (0.276) loss_x loss_x 0.4453 (0.3801) acc_x 87.5000 (91.8750) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.6569, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1072
clean true:1071
clean false:1
clean_rate:0.9990671641791045
noisy true:335
noisy false:225
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 560
epoch [102/200] batch [5/33] time 0.343 (0.352) data 0.265 (0.274) loss_x loss_x 0.2520 (0.3373) acc_x 93.7500 (91.2500) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [10/33] time 0.362 (0.368) data 0.284 (0.290) loss_x loss_x 0.2375 (0.3285) acc_x 93.7500 (91.2500) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [15/33] time 0.425 (0.371) data 0.348 (0.292) loss_x loss_x 0.4023 (0.3354) acc_x 90.6250 (91.6667) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [20/33] time 0.351 (0.374) data 0.273 (0.295) loss_x loss_x 0.3047 (0.3278) acc_x 93.7500 (91.8750) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [25/33] time 0.388 (0.373) data 0.311 (0.295) loss_x loss_x 0.4385 (0.3286) acc_x 87.5000 (91.8750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [30/33] time 0.342 (0.374) data 0.265 (0.296) loss_x loss_x 0.4426 (0.3605) acc_x 93.7500 (91.3542) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.6422, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1048
clean true:1047
clean false:1
clean_rate:0.9990458015267175
noisy true:341
noisy false:243
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 584
epoch [103/200] batch [5/32] time 0.341 (0.349) data 0.263 (0.272) loss_x loss_x 0.4087 (0.3586) acc_x 87.5000 (90.0000) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [10/32] time 0.389 (0.350) data 0.312 (0.272) loss_x loss_x 0.1790 (0.3457) acc_x 100.0000 (91.8750) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [15/32] time 0.354 (0.360) data 0.277 (0.282) loss_x loss_x 0.4905 (0.3478) acc_x 87.5000 (92.2917) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [20/32] time 0.339 (0.365) data 0.261 (0.287) loss_x loss_x 0.5259 (0.3476) acc_x 84.3750 (92.3438) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [25/32] time 0.405 (0.373) data 0.327 (0.295) loss_x loss_x 0.3608 (0.3540) acc_x 90.6250 (91.6250) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [30/32] time 0.342 (0.375) data 0.265 (0.297) loss_x loss_x 0.6606 (0.3695) acc_x 78.1250 (91.1458) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.6562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1071
clean true:1070
clean false:1
clean_rate:0.9990662931839402
noisy true:329
noisy false:232
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 561
epoch [104/200] batch [5/33] time 0.353 (0.388) data 0.275 (0.310) loss_x loss_x 0.6543 (0.4410) acc_x 84.3750 (89.3750) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [10/33] time 0.300 (0.366) data 0.223 (0.288) loss_x loss_x 0.4192 (0.4077) acc_x 90.6250 (90.3125) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [15/33] time 0.398 (0.355) data 0.320 (0.277) loss_x loss_x 0.2854 (0.3967) acc_x 93.7500 (90.8333) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [20/33] time 0.358 (0.359) data 0.280 (0.281) loss_x loss_x 0.4246 (0.4004) acc_x 87.5000 (91.2500) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [25/33] time 0.356 (0.358) data 0.277 (0.280) loss_x loss_x 0.2600 (0.3971) acc_x 100.0000 (91.3750) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [30/33] time 0.311 (0.351) data 0.232 (0.273) loss_x loss_x 0.2458 (0.3865) acc_x 93.7500 (91.4583) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.6520, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1064
clean true:1063
clean false:1
clean_rate:0.9990601503759399
noisy true:336
noisy false:232
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 568
epoch [105/200] batch [5/33] time 0.354 (0.387) data 0.276 (0.309) loss_x loss_x 0.3279 (0.3847) acc_x 90.6250 (90.6250) lr 9.5289e-04 eta 0:00:10
epoch [105/200] batch [10/33] time 0.373 (0.382) data 0.295 (0.304) loss_x loss_x 0.3914 (0.3973) acc_x 90.6250 (90.9375) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [15/33] time 0.389 (0.377) data 0.312 (0.299) loss_x loss_x 0.4023 (0.3533) acc_x 87.5000 (92.0833) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [20/33] time 0.343 (0.371) data 0.266 (0.293) loss_x loss_x 0.2003 (0.3366) acc_x 100.0000 (92.8125) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [25/33] time 0.302 (0.362) data 0.224 (0.284) loss_x loss_x 0.3572 (0.3337) acc_x 93.7500 (93.0000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/33] time 0.345 (0.354) data 0.267 (0.276) loss_x loss_x 0.4395 (0.3348) acc_x 87.5000 (92.9167) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.6654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1086
clean true:1086
clean false:0
clean_rate:1.0
noisy true:332
noisy false:214
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 546
epoch [106/200] batch [5/33] time 0.358 (0.356) data 0.281 (0.278) loss_x loss_x 0.4819 (0.2959) acc_x 84.3750 (93.7500) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [10/33] time 0.363 (0.356) data 0.286 (0.278) loss_x loss_x 0.4453 (0.3676) acc_x 84.3750 (91.2500) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [15/33] time 0.350 (0.357) data 0.272 (0.280) loss_x loss_x 0.3569 (0.4171) acc_x 90.6250 (89.7917) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [20/33] time 0.301 (0.355) data 0.224 (0.277) loss_x loss_x 0.2776 (0.3885) acc_x 96.8750 (90.9375) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [25/33] time 0.368 (0.351) data 0.291 (0.274) loss_x loss_x 0.3022 (0.3841) acc_x 90.6250 (91.2500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [30/33] time 0.330 (0.350) data 0.253 (0.273) loss_x loss_x 0.2949 (0.3824) acc_x 93.7500 (91.3542) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1086
clean false:2
clean_rate:0.9981617647058824
noisy true:337
noisy false:207
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [107/200] batch [5/34] time 0.306 (0.310) data 0.228 (0.232) loss_x loss_x 0.4749 (0.3062) acc_x 93.7500 (95.6250) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [10/34] time 0.357 (0.324) data 0.278 (0.245) loss_x loss_x 0.1914 (0.3706) acc_x 96.8750 (93.1250) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/34] time 0.314 (0.320) data 0.236 (0.241) loss_x loss_x 0.3181 (0.3522) acc_x 93.7500 (94.1667) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [20/34] time 0.356 (0.332) data 0.278 (0.253) loss_x loss_x 0.4146 (0.3823) acc_x 81.2500 (92.1875) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [25/34] time 0.316 (0.331) data 0.238 (0.253) loss_x loss_x 0.2727 (0.3631) acc_x 93.7500 (92.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/34] time 0.340 (0.334) data 0.263 (0.255) loss_x loss_x 0.4399 (0.3662) acc_x 81.2500 (91.8750) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.6630, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1082
clean true:1082
clean false:0
clean_rate:1.0
noisy true:330
noisy false:220
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 550
epoch [108/200] batch [5/33] time 0.356 (0.343) data 0.279 (0.266) loss_x loss_x 0.2896 (0.3535) acc_x 93.7500 (91.8750) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/33] time 0.299 (0.335) data 0.221 (0.257) loss_x loss_x 0.3403 (0.3399) acc_x 90.6250 (92.5000) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/33] time 0.296 (0.322) data 0.218 (0.245) loss_x loss_x 0.3765 (0.3610) acc_x 93.7500 (92.0833) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [20/33] time 0.345 (0.322) data 0.267 (0.244) loss_x loss_x 0.4050 (0.3602) acc_x 87.5000 (91.8750) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [25/33] time 0.353 (0.327) data 0.275 (0.250) loss_x loss_x 0.4128 (0.3770) acc_x 90.6250 (91.7500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [30/33] time 0.360 (0.330) data 0.282 (0.252) loss_x loss_x 0.1534 (0.3674) acc_x 96.8750 (91.5625) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1086
clean false:2
clean_rate:0.9981617647058824
noisy true:330
noisy false:214
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [109/200] batch [5/34] time 0.351 (0.349) data 0.273 (0.271) loss_x loss_x 0.3167 (0.3927) acc_x 93.7500 (90.0000) lr 8.9027e-04 eta 0:00:10
epoch [109/200] batch [10/34] time 0.347 (0.350) data 0.270 (0.272) loss_x loss_x 0.3760 (0.3982) acc_x 93.7500 (90.9375) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [15/34] time 0.339 (0.349) data 0.262 (0.271) loss_x loss_x 0.4402 (0.3890) acc_x 87.5000 (90.6250) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [20/34] time 0.338 (0.348) data 0.261 (0.270) loss_x loss_x 0.3616 (0.4151) acc_x 93.7500 (89.6875) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [25/34] time 0.301 (0.342) data 0.223 (0.264) loss_x loss_x 0.6753 (0.4292) acc_x 87.5000 (90.1250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [30/34] time 0.338 (0.338) data 0.261 (0.261) loss_x loss_x 0.2788 (0.3962) acc_x 87.5000 (90.9375) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1095
clean false:2
clean_rate:0.9981768459434822
noisy true:339
noisy false:196
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [110/200] batch [5/34] time 0.308 (0.326) data 0.231 (0.249) loss_x loss_x 0.3105 (0.3531) acc_x 96.8750 (91.2500) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [10/34] time 0.340 (0.338) data 0.263 (0.260) loss_x loss_x 0.6567 (0.4181) acc_x 90.6250 (90.0000) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [15/34] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.2542 (0.4033) acc_x 96.8750 (90.4167) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [20/34] time 0.360 (0.342) data 0.283 (0.265) loss_x loss_x 0.3206 (0.3899) acc_x 90.6250 (90.1562) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [25/34] time 0.339 (0.343) data 0.261 (0.266) loss_x loss_x 0.5708 (0.3819) acc_x 84.3750 (90.2500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [30/34] time 0.353 (0.344) data 0.276 (0.266) loss_x loss_x 0.1980 (0.3705) acc_x 90.6250 (90.7292) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1078
clean false:1
clean_rate:0.9990732159406858
noisy true:335
noisy false:218
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [111/200] batch [5/33] time 0.311 (0.337) data 0.234 (0.260) loss_x loss_x 0.5537 (0.3356) acc_x 84.3750 (93.7500) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [10/33] time 0.291 (0.316) data 0.213 (0.238) loss_x loss_x 0.4182 (0.4057) acc_x 90.6250 (92.1875) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [15/33] time 0.342 (0.321) data 0.265 (0.243) loss_x loss_x 0.4253 (0.4233) acc_x 87.5000 (91.2500) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [20/33] time 0.350 (0.330) data 0.273 (0.253) loss_x loss_x 0.7227 (0.4129) acc_x 84.3750 (90.9375) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [25/33] time 0.338 (0.332) data 0.261 (0.254) loss_x loss_x 0.4250 (0.4095) acc_x 90.6250 (91.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [30/33] time 0.359 (0.335) data 0.281 (0.257) loss_x loss_x 0.3613 (0.3946) acc_x 87.5000 (91.1458) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1086
clean true:1085
clean false:1
clean_rate:0.9990791896869244
noisy true:329
noisy false:217
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 546
epoch [112/200] batch [5/33] time 0.326 (0.337) data 0.248 (0.259) loss_x loss_x 0.6084 (0.4102) acc_x 87.5000 (90.0000) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [10/33] time 0.337 (0.333) data 0.260 (0.256) loss_x loss_x 0.4373 (0.3810) acc_x 87.5000 (90.3125) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/33] time 0.291 (0.322) data 0.214 (0.245) loss_x loss_x 0.2959 (0.3754) acc_x 90.6250 (90.4167) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [20/33] time 0.342 (0.319) data 0.265 (0.242) loss_x loss_x 0.3611 (0.3634) acc_x 96.8750 (91.5625) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [25/33] time 0.347 (0.325) data 0.269 (0.247) loss_x loss_x 0.4446 (0.3507) acc_x 84.3750 (91.6250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [30/33] time 0.342 (0.328) data 0.265 (0.250) loss_x loss_x 0.6450 (0.3682) acc_x 87.5000 (91.1458) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 221
confident_label rate tensor(0.6569, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1072
clean true:1071
clean false:1
clean_rate:0.9990671641791045
noisy true:340
noisy false:220
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 560
epoch [113/200] batch [5/33] time 0.356 (0.358) data 0.278 (0.280) loss_x loss_x 0.3958 (0.3728) acc_x 90.6250 (90.0000) lr 8.2807e-04 eta 0:00:10
epoch [113/200] batch [10/33] time 0.336 (0.349) data 0.259 (0.271) loss_x loss_x 0.2634 (0.3721) acc_x 93.7500 (91.2500) lr 8.2807e-04 eta 0:00:08
epoch [113/200] batch [15/33] time 0.293 (0.336) data 0.215 (0.258) loss_x loss_x 0.2847 (0.3709) acc_x 93.7500 (91.6667) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [20/33] time 0.294 (0.330) data 0.217 (0.252) loss_x loss_x 0.4565 (0.3697) acc_x 90.6250 (91.7188) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [25/33] time 0.339 (0.328) data 0.262 (0.251) loss_x loss_x 0.4138 (0.3767) acc_x 90.6250 (91.5000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [30/33] time 0.336 (0.330) data 0.259 (0.252) loss_x loss_x 0.2069 (0.3642) acc_x 96.8750 (91.6667) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.6569, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1072
clean true:1071
clean false:1
clean_rate:0.9990671641791045
noisy true:348
noisy false:212
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 560
epoch [114/200] batch [5/33] time 0.341 (0.343) data 0.263 (0.266) loss_x loss_x 0.5273 (0.3171) acc_x 84.3750 (93.7500) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [10/33] time 0.330 (0.337) data 0.253 (0.260) loss_x loss_x 0.5557 (0.3609) acc_x 81.2500 (91.8750) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [15/33] time 0.326 (0.337) data 0.249 (0.260) loss_x loss_x 0.4827 (0.3623) acc_x 87.5000 (91.8750) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [20/33] time 0.342 (0.336) data 0.265 (0.259) loss_x loss_x 0.3933 (0.3515) acc_x 90.6250 (91.7188) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [25/33] time 0.325 (0.336) data 0.247 (0.259) loss_x loss_x 0.3457 (0.3395) acc_x 90.6250 (92.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [30/33] time 0.325 (0.331) data 0.247 (0.254) loss_x loss_x 0.3328 (0.3546) acc_x 96.8750 (91.9792) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.6636, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1083
clean true:1083
clean false:0
clean_rate:1.0
noisy true:343
noisy false:206
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 549
epoch [115/200] batch [5/33] time 0.336 (0.341) data 0.258 (0.264) loss_x loss_x 0.2971 (0.2619) acc_x 93.7500 (95.6250) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [10/33] time 0.345 (0.342) data 0.267 (0.264) loss_x loss_x 0.3691 (0.2915) acc_x 90.6250 (93.4375) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [15/33] time 0.344 (0.343) data 0.267 (0.266) loss_x loss_x 0.5000 (0.3180) acc_x 84.3750 (93.3333) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [20/33] time 0.354 (0.343) data 0.277 (0.265) loss_x loss_x 0.3960 (0.3184) acc_x 90.6250 (93.2812) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [25/33] time 0.358 (0.343) data 0.279 (0.265) loss_x loss_x 0.3628 (0.3234) acc_x 90.6250 (93.3750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [30/33] time 0.330 (0.341) data 0.252 (0.264) loss_x loss_x 0.7358 (0.3342) acc_x 78.1250 (92.8125) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1088
clean false:2
clean_rate:0.998165137614679
noisy true:333
noisy false:209
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [116/200] batch [5/34] time 0.288 (0.318) data 0.211 (0.240) loss_x loss_x 0.2783 (0.2932) acc_x 93.7500 (93.7500) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [10/34] time 0.344 (0.313) data 0.266 (0.236) loss_x loss_x 0.5249 (0.3406) acc_x 84.3750 (93.1250) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [15/34] time 0.341 (0.325) data 0.264 (0.247) loss_x loss_x 0.6914 (0.3890) acc_x 87.5000 (91.8750) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [20/34] time 0.331 (0.328) data 0.254 (0.251) loss_x loss_x 0.3689 (0.3829) acc_x 87.5000 (91.5625) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [25/34] time 0.347 (0.333) data 0.269 (0.255) loss_x loss_x 0.3364 (0.3852) acc_x 96.8750 (91.3750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [30/34] time 0.350 (0.337) data 0.272 (0.259) loss_x loss_x 0.4375 (0.3908) acc_x 90.6250 (91.3542) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.6526, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1065
clean true:1065
clean false:0
clean_rate:1.0
noisy true:331
noisy false:236
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 567
epoch [117/200] batch [5/33] time 0.306 (0.320) data 0.228 (0.242) loss_x loss_x 0.3035 (0.3474) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [10/33] time 0.340 (0.324) data 0.263 (0.247) loss_x loss_x 0.2761 (0.3149) acc_x 96.8750 (93.7500) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/33] time 0.292 (0.320) data 0.214 (0.243) loss_x loss_x 0.4763 (0.3663) acc_x 93.7500 (91.6667) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [20/33] time 0.328 (0.316) data 0.250 (0.238) loss_x loss_x 0.3892 (0.3501) acc_x 84.3750 (91.5625) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [25/33] time 0.361 (0.319) data 0.283 (0.241) loss_x loss_x 0.4016 (0.3450) acc_x 87.5000 (91.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [30/33] time 0.339 (0.322) data 0.261 (0.244) loss_x loss_x 0.3235 (0.3387) acc_x 90.6250 (91.8750) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1079
clean false:0
clean_rate:1.0
noisy true:331
noisy false:222
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [118/200] batch [5/33] time 0.350 (0.361) data 0.272 (0.284) loss_x loss_x 0.3801 (0.3483) acc_x 87.5000 (90.6250) lr 7.5131e-04 eta 0:00:10
epoch [118/200] batch [10/33] time 0.336 (0.351) data 0.258 (0.273) loss_x loss_x 0.2639 (0.3375) acc_x 90.6250 (90.6250) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [15/33] time 0.337 (0.348) data 0.260 (0.271) loss_x loss_x 0.3145 (0.3252) acc_x 90.6250 (91.6667) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [20/33] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.3210 (0.3520) acc_x 96.8750 (90.7812) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [25/33] time 0.292 (0.338) data 0.214 (0.261) loss_x loss_x 0.4619 (0.3506) acc_x 87.5000 (90.7500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [30/33] time 0.300 (0.331) data 0.222 (0.254) loss_x loss_x 0.1335 (0.3463) acc_x 96.8750 (90.8333) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.6550, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1069
clean true:1068
clean false:1
clean_rate:0.9990645463049579
noisy true:334
noisy false:229
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 563
epoch [119/200] batch [5/33] time 0.339 (0.327) data 0.262 (0.250) loss_x loss_x 0.1852 (0.3157) acc_x 96.8750 (91.2500) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [10/33] time 0.288 (0.310) data 0.211 (0.233) loss_x loss_x 0.1803 (0.3400) acc_x 100.0000 (91.8750) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [15/33] time 0.349 (0.309) data 0.272 (0.232) loss_x loss_x 0.2908 (0.3361) acc_x 93.7500 (91.6667) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [20/33] time 0.370 (0.320) data 0.292 (0.243) loss_x loss_x 0.1547 (0.3144) acc_x 96.8750 (92.3438) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [25/33] time 0.344 (0.324) data 0.267 (0.247) loss_x loss_x 0.9014 (0.3427) acc_x 84.3750 (91.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/33] time 0.356 (0.328) data 0.277 (0.250) loss_x loss_x 0.3357 (0.3712) acc_x 90.6250 (91.0417) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.6593, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1076
clean true:1075
clean false:1
clean_rate:0.9990706319702602
noisy true:340
noisy false:216
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 556
epoch [120/200] batch [5/33] time 0.294 (0.300) data 0.216 (0.222) loss_x loss_x 0.4321 (0.3458) acc_x 93.7500 (93.1250) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [10/33] time 0.338 (0.321) data 0.260 (0.243) loss_x loss_x 0.2751 (0.3332) acc_x 93.7500 (93.7500) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [15/33] time 0.288 (0.324) data 0.210 (0.246) loss_x loss_x 0.4702 (0.3464) acc_x 90.6250 (92.7083) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [20/33] time 0.324 (0.319) data 0.243 (0.241) loss_x loss_x 0.2363 (0.3344) acc_x 93.7500 (92.8125) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [25/33] time 0.349 (0.323) data 0.272 (0.245) loss_x loss_x 0.2729 (0.3251) acc_x 96.8750 (93.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/33] time 0.329 (0.328) data 0.251 (0.251) loss_x loss_x 0.7090 (0.3370) acc_x 81.2500 (92.8125) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1097
clean false:1
clean_rate:0.9990892531876139
noisy true:352
noisy false:182
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [121/200] batch [5/34] time 0.330 (0.343) data 0.252 (0.266) loss_x loss_x 0.1931 (0.3379) acc_x 90.6250 (90.0000) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [10/34] time 0.290 (0.319) data 0.212 (0.241) loss_x loss_x 0.2925 (0.3082) acc_x 90.6250 (91.8750) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [15/34] time 0.339 (0.325) data 0.261 (0.247) loss_x loss_x 0.4736 (0.3554) acc_x 93.7500 (90.8333) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [20/34] time 0.294 (0.325) data 0.216 (0.247) loss_x loss_x 0.3562 (0.3468) acc_x 93.7500 (91.5625) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [25/34] time 0.347 (0.324) data 0.269 (0.246) loss_x loss_x 0.6289 (0.3660) acc_x 87.5000 (91.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [30/34] time 0.346 (0.325) data 0.268 (0.248) loss_x loss_x 0.2871 (0.3671) acc_x 93.7500 (91.4583) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.6605, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1078
clean true:1077
clean false:1
clean_rate:0.9990723562152134
noisy true:336
noisy false:218
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 554
epoch [122/200] batch [5/33] time 0.366 (0.354) data 0.289 (0.276) loss_x loss_x 0.3560 (0.3778) acc_x 87.5000 (91.8750) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [10/33] time 0.349 (0.350) data 0.271 (0.273) loss_x loss_x 0.2859 (0.3573) acc_x 90.6250 (91.2500) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [15/33] time 0.298 (0.342) data 0.220 (0.265) loss_x loss_x 0.3210 (0.3344) acc_x 93.7500 (92.5000) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [20/33] time 0.327 (0.332) data 0.249 (0.254) loss_x loss_x 0.3789 (0.3346) acc_x 90.6250 (92.5000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [25/33] time 0.320 (0.332) data 0.243 (0.255) loss_x loss_x 0.6606 (0.3550) acc_x 81.2500 (91.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [30/33] time 0.321 (0.333) data 0.243 (0.255) loss_x loss_x 0.4111 (0.3629) acc_x 90.6250 (91.2500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1096
clean false:1
clean_rate:0.9990884229717412
noisy true:336
noisy false:199
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [123/200] batch [5/34] time 0.349 (0.347) data 0.272 (0.269) loss_x loss_x 0.2303 (0.2774) acc_x 93.7500 (93.7500) lr 6.7608e-04 eta 0:00:10
epoch [123/200] batch [10/34] time 0.347 (0.346) data 0.270 (0.269) loss_x loss_x 0.1256 (0.2301) acc_x 96.8750 (95.6250) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [15/34] time 0.336 (0.344) data 0.259 (0.267) loss_x loss_x 0.5640 (0.2966) acc_x 84.3750 (93.5417) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [20/34] time 0.345 (0.345) data 0.268 (0.268) loss_x loss_x 0.2134 (0.2977) acc_x 93.7500 (93.9062) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [25/34] time 0.295 (0.342) data 0.217 (0.264) loss_x loss_x 0.5156 (0.2905) acc_x 93.7500 (94.3750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [30/34] time 0.334 (0.335) data 0.256 (0.258) loss_x loss_x 0.2588 (0.2769) acc_x 93.7500 (94.7917) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:339
noisy false:193
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [124/200] batch [5/34] time 0.349 (0.342) data 0.271 (0.264) loss_x loss_x 0.2335 (0.3076) acc_x 100.0000 (95.6250) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [10/34] time 0.296 (0.342) data 0.219 (0.265) loss_x loss_x 0.3584 (0.3381) acc_x 90.6250 (93.7500) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [15/34] time 0.365 (0.343) data 0.287 (0.265) loss_x loss_x 0.2489 (0.3905) acc_x 93.7500 (91.6667) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [20/34] time 0.332 (0.341) data 0.254 (0.264) loss_x loss_x 0.4763 (0.3907) acc_x 90.6250 (91.8750) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [25/34] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.1968 (0.3606) acc_x 93.7500 (92.3750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [30/34] time 0.357 (0.345) data 0.280 (0.267) loss_x loss_x 0.4666 (0.3567) acc_x 87.5000 (92.5000) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1079
clean false:0
clean_rate:1.0
noisy true:339
noisy false:214
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [125/200] batch [5/33] time 0.333 (0.312) data 0.256 (0.234) loss_x loss_x 0.3606 (0.2621) acc_x 87.5000 (94.3750) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [10/33] time 0.346 (0.321) data 0.269 (0.243) loss_x loss_x 0.4282 (0.2979) acc_x 90.6250 (94.6875) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/33] time 0.335 (0.328) data 0.257 (0.250) loss_x loss_x 0.3286 (0.2986) acc_x 93.7500 (93.9583) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [20/33] time 0.339 (0.330) data 0.261 (0.253) loss_x loss_x 0.5430 (0.3066) acc_x 84.3750 (93.7500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [25/33] time 0.340 (0.333) data 0.262 (0.255) loss_x loss_x 0.3779 (0.3147) acc_x 90.6250 (93.1250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [30/33] time 0.349 (0.334) data 0.272 (0.257) loss_x loss_x 0.3882 (0.3219) acc_x 93.7500 (93.3333) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:330
noisy false:217
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [126/200] batch [5/33] time 0.345 (0.321) data 0.267 (0.243) loss_x loss_x 0.3970 (0.3114) acc_x 87.5000 (93.1250) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [10/33] time 0.345 (0.332) data 0.268 (0.255) loss_x loss_x 0.2969 (0.3352) acc_x 93.7500 (92.8125) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [15/33] time 0.335 (0.328) data 0.257 (0.250) loss_x loss_x 0.5581 (0.3596) acc_x 81.2500 (91.4583) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [20/33] time 0.334 (0.326) data 0.257 (0.249) loss_x loss_x 0.3867 (0.3513) acc_x 93.7500 (91.8750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [25/33] time 0.338 (0.329) data 0.260 (0.251) loss_x loss_x 0.3469 (0.3348) acc_x 87.5000 (92.2500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/33] time 0.339 (0.330) data 0.262 (0.253) loss_x loss_x 0.2627 (0.3304) acc_x 87.5000 (92.0833) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1079
clean false:0
clean_rate:1.0
noisy true:329
noisy false:224
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [127/200] batch [5/33] time 0.353 (0.354) data 0.275 (0.276) loss_x loss_x 0.3547 (0.3018) acc_x 93.7500 (92.5000) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [10/33] time 0.321 (0.348) data 0.243 (0.270) loss_x loss_x 0.2488 (0.3366) acc_x 96.8750 (92.1875) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [15/33] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.2952 (0.3564) acc_x 90.6250 (92.0833) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [20/33] time 0.297 (0.339) data 0.219 (0.261) loss_x loss_x 0.1838 (0.3536) acc_x 96.8750 (91.8750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [25/33] time 0.295 (0.333) data 0.218 (0.256) loss_x loss_x 0.3318 (0.3564) acc_x 90.6250 (91.8750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [30/33] time 0.306 (0.328) data 0.228 (0.250) loss_x loss_x 0.2212 (0.3413) acc_x 96.8750 (92.0833) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.6538, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1067
clean true:1067
clean false:0
clean_rate:1.0
noisy true:338
noisy false:227
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 565
epoch [128/200] batch [5/33] time 0.322 (0.345) data 0.244 (0.267) loss_x loss_x 0.3721 (0.2940) acc_x 93.7500 (95.0000) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [10/33] time 0.346 (0.347) data 0.268 (0.270) loss_x loss_x 0.5073 (0.3212) acc_x 87.5000 (92.8125) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [15/33] time 0.334 (0.343) data 0.257 (0.266) loss_x loss_x 0.4023 (0.3311) acc_x 90.6250 (92.5000) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [20/33] time 0.333 (0.341) data 0.255 (0.263) loss_x loss_x 0.2627 (0.3581) acc_x 93.7500 (92.1875) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [25/33] time 0.288 (0.336) data 0.210 (0.258) loss_x loss_x 0.2499 (0.3452) acc_x 96.8750 (92.5000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [30/33] time 0.356 (0.335) data 0.278 (0.257) loss_x loss_x 0.4985 (0.3557) acc_x 81.2500 (92.1875) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.6581, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1074
clean true:1072
clean false:2
clean_rate:0.9981378026070763
noisy true:345
noisy false:213
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 558
epoch [129/200] batch [5/33] time 0.340 (0.320) data 0.263 (0.243) loss_x loss_x 0.1997 (0.2537) acc_x 96.8750 (94.3750) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/33] time 0.343 (0.332) data 0.265 (0.255) loss_x loss_x 0.5854 (0.3413) acc_x 78.1250 (91.5625) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [15/33] time 0.352 (0.336) data 0.275 (0.259) loss_x loss_x 0.2410 (0.3472) acc_x 93.7500 (91.4583) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [20/33] time 0.343 (0.339) data 0.266 (0.262) loss_x loss_x 0.2507 (0.3335) acc_x 93.7500 (91.7188) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [25/33] time 0.337 (0.339) data 0.260 (0.262) loss_x loss_x 0.2756 (0.3752) acc_x 93.7500 (90.8750) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [30/33] time 0.332 (0.337) data 0.254 (0.260) loss_x loss_x 0.3252 (0.3595) acc_x 87.5000 (91.3542) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1092
clean false:3
clean_rate:0.9972602739726028
noisy true:342
noisy false:195
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [130/200] batch [5/34] time 0.335 (0.330) data 0.258 (0.252) loss_x loss_x 0.4041 (0.3517) acc_x 90.6250 (91.8750) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [10/34] time 0.300 (0.321) data 0.223 (0.243) loss_x loss_x 0.2241 (0.3700) acc_x 93.7500 (92.5000) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/34] time 0.288 (0.314) data 0.210 (0.236) loss_x loss_x 0.3088 (0.3712) acc_x 93.7500 (91.6667) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [20/34] time 0.357 (0.315) data 0.280 (0.238) loss_x loss_x 0.2888 (0.3758) acc_x 93.7500 (91.7188) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [25/34] time 0.321 (0.320) data 0.243 (0.242) loss_x loss_x 0.2874 (0.3531) acc_x 96.8750 (92.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [30/34] time 0.346 (0.324) data 0.268 (0.246) loss_x loss_x 0.1484 (0.3508) acc_x 100.0000 (92.5000) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 208
confident_label rate tensor(0.6642, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1084
clean true:1082
clean false:2
clean_rate:0.9981549815498155
noisy true:342
noisy false:206
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 548
epoch [131/200] batch [5/33] time 0.357 (0.343) data 0.279 (0.266) loss_x loss_x 0.2756 (0.4258) acc_x 93.7500 (93.1250) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [10/33] time 0.350 (0.347) data 0.272 (0.269) loss_x loss_x 0.1792 (0.3805) acc_x 93.7500 (91.5625) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [15/33] time 0.334 (0.344) data 0.256 (0.266) loss_x loss_x 0.4941 (0.3719) acc_x 90.6250 (91.8750) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [20/33] time 0.344 (0.339) data 0.266 (0.261) loss_x loss_x 0.1494 (0.3776) acc_x 96.8750 (91.5625) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [25/33] time 0.335 (0.338) data 0.258 (0.260) loss_x loss_x 0.2876 (0.3841) acc_x 93.7500 (91.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [30/33] time 0.347 (0.337) data 0.269 (0.260) loss_x loss_x 0.2820 (0.3740) acc_x 93.7500 (91.4583) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1096
clean false:1
clean_rate:0.9990884229717412
noisy true:336
noisy false:199
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [132/200] batch [5/34] time 0.354 (0.350) data 0.276 (0.272) loss_x loss_x 0.1912 (0.3665) acc_x 96.8750 (91.2500) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [10/34] time 0.333 (0.346) data 0.256 (0.269) loss_x loss_x 0.3884 (0.3871) acc_x 93.7500 (91.5625) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [15/34] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.2700 (0.3706) acc_x 90.6250 (91.8750) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [20/34] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.2856 (0.3744) acc_x 93.7500 (91.2500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [25/34] time 0.345 (0.345) data 0.268 (0.268) loss_x loss_x 0.4114 (0.3763) acc_x 87.5000 (91.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [30/34] time 0.357 (0.342) data 0.279 (0.264) loss_x loss_x 0.1434 (0.3473) acc_x 96.8750 (92.0833) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:340
noisy false:189
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [133/200] batch [5/34] time 0.371 (0.315) data 0.293 (0.237) loss_x loss_x 0.6245 (0.3667) acc_x 87.5000 (93.7500) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [10/34] time 0.342 (0.330) data 0.265 (0.253) loss_x loss_x 0.1337 (0.3185) acc_x 96.8750 (94.6875) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [15/34] time 0.350 (0.335) data 0.273 (0.257) loss_x loss_x 0.4211 (0.3198) acc_x 90.6250 (93.9583) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [20/34] time 0.348 (0.337) data 0.271 (0.260) loss_x loss_x 0.1825 (0.3329) acc_x 96.8750 (93.4375) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [25/34] time 0.327 (0.337) data 0.250 (0.259) loss_x loss_x 0.4438 (0.3435) acc_x 93.7500 (92.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [30/34] time 0.335 (0.333) data 0.258 (0.255) loss_x loss_x 0.4724 (0.3442) acc_x 81.2500 (92.5000) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1096
clean false:1
clean_rate:0.9990884229717412
noisy true:342
noisy false:193
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [134/200] batch [5/34] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.3982 (0.3807) acc_x 90.6250 (91.8750) lr 5.1825e-04 eta 0:00:09
epoch [134/200] batch [10/34] time 0.343 (0.344) data 0.266 (0.267) loss_x loss_x 0.3054 (0.3638) acc_x 90.6250 (91.8750) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [15/34] time 0.313 (0.334) data 0.236 (0.257) loss_x loss_x 0.2610 (0.3790) acc_x 90.6250 (91.4583) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [20/34] time 0.337 (0.329) data 0.259 (0.252) loss_x loss_x 0.3342 (0.3654) acc_x 93.7500 (91.8750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [25/34] time 0.349 (0.333) data 0.272 (0.255) loss_x loss_x 0.2600 (0.3580) acc_x 93.7500 (91.6250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [30/34] time 0.350 (0.335) data 0.272 (0.257) loss_x loss_x 0.1981 (0.3401) acc_x 100.0000 (92.5000) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1079
clean false:1
clean_rate:0.9990740740740741
noisy true:344
noisy false:208
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [135/200] batch [5/33] time 0.337 (0.338) data 0.259 (0.261) loss_x loss_x 0.1042 (0.2269) acc_x 100.0000 (95.6250) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [10/33] time 0.342 (0.337) data 0.265 (0.260) loss_x loss_x 0.3035 (0.3048) acc_x 93.7500 (93.4375) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/33] time 0.339 (0.335) data 0.262 (0.257) loss_x loss_x 0.3853 (0.3199) acc_x 93.7500 (92.9167) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [20/33] time 0.355 (0.336) data 0.278 (0.259) loss_x loss_x 0.5508 (0.3183) acc_x 90.6250 (93.2812) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [25/33] time 0.343 (0.337) data 0.265 (0.259) loss_x loss_x 0.2096 (0.3026) acc_x 96.8750 (93.6250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [30/33] time 0.285 (0.329) data 0.207 (0.251) loss_x loss_x 0.3916 (0.3106) acc_x 93.7500 (93.5417) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1098
clean false:2
clean_rate:0.9981818181818182
noisy true:342
noisy false:190
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [136/200] batch [5/34] time 0.335 (0.323) data 0.258 (0.246) loss_x loss_x 0.4875 (0.3760) acc_x 84.3750 (89.3750) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/34] time 0.349 (0.336) data 0.271 (0.259) loss_x loss_x 0.1769 (0.3449) acc_x 93.7500 (90.9375) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [15/34] time 0.344 (0.340) data 0.266 (0.262) loss_x loss_x 0.1799 (0.3446) acc_x 96.8750 (91.8750) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [20/34] time 0.350 (0.341) data 0.273 (0.264) loss_x loss_x 0.3472 (0.3576) acc_x 93.7500 (91.7188) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [25/34] time 0.352 (0.342) data 0.275 (0.264) loss_x loss_x 0.1527 (0.3600) acc_x 96.8750 (91.7500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [30/34] time 0.296 (0.339) data 0.219 (0.262) loss_x loss_x 0.1689 (0.3483) acc_x 100.0000 (91.9792) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1094
clean false:1
clean_rate:0.9990867579908675
noisy true:337
noisy false:200
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [137/200] batch [5/34] time 0.298 (0.310) data 0.221 (0.232) loss_x loss_x 0.1914 (0.2518) acc_x 100.0000 (93.7500) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [10/34] time 0.348 (0.314) data 0.272 (0.237) loss_x loss_x 0.2388 (0.2345) acc_x 93.7500 (94.6875) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [15/34] time 0.307 (0.320) data 0.230 (0.243) loss_x loss_x 0.4734 (0.2725) acc_x 87.5000 (93.3333) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [20/34] time 0.353 (0.327) data 0.276 (0.250) loss_x loss_x 0.1032 (0.2674) acc_x 96.8750 (93.4375) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [25/34] time 0.348 (0.331) data 0.270 (0.254) loss_x loss_x 0.3010 (0.2855) acc_x 90.6250 (92.8750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [30/34] time 0.342 (0.332) data 0.265 (0.255) loss_x loss_x 0.2949 (0.2899) acc_x 90.6250 (92.9167) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1102
clean false:1
clean_rate:0.99909338168631
noisy true:341
noisy false:188
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [138/200] batch [5/34] time 0.336 (0.330) data 0.259 (0.253) loss_x loss_x 0.4771 (0.3101) acc_x 84.3750 (94.3750) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [10/34] time 0.348 (0.336) data 0.271 (0.259) loss_x loss_x 0.5098 (0.3243) acc_x 87.5000 (92.1875) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [15/34] time 0.344 (0.337) data 0.267 (0.260) loss_x loss_x 0.1857 (0.2947) acc_x 93.7500 (93.5417) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [20/34] time 0.293 (0.331) data 0.216 (0.254) loss_x loss_x 0.2346 (0.3003) acc_x 96.8750 (93.4375) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [25/34] time 0.288 (0.324) data 0.211 (0.247) loss_x loss_x 0.3579 (0.2987) acc_x 87.5000 (93.2500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [30/34] time 0.326 (0.325) data 0.249 (0.248) loss_x loss_x 0.8159 (0.3158) acc_x 84.3750 (93.0208) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6624, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1081
clean true:1081
clean false:0
clean_rate:1.0
noisy true:333
noisy false:218
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 551
epoch [139/200] batch [5/33] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.1385 (0.3405) acc_x 100.0000 (91.2500) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [10/33] time 0.350 (0.343) data 0.273 (0.265) loss_x loss_x 0.2571 (0.2826) acc_x 96.8750 (93.7500) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [15/33] time 0.315 (0.341) data 0.238 (0.264) loss_x loss_x 0.1886 (0.2978) acc_x 96.8750 (93.5417) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [20/33] time 0.341 (0.339) data 0.263 (0.262) loss_x loss_x 0.2041 (0.2835) acc_x 96.8750 (94.2188) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [25/33] time 0.295 (0.333) data 0.218 (0.256) loss_x loss_x 0.4551 (0.3054) acc_x 84.3750 (93.5000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [30/33] time 0.336 (0.331) data 0.258 (0.254) loss_x loss_x 0.1686 (0.3257) acc_x 96.8750 (92.8125) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:346
noisy false:187
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [140/200] batch [5/34] time 0.347 (0.347) data 0.270 (0.270) loss_x loss_x 0.4260 (0.3228) acc_x 90.6250 (91.8750) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [10/34] time 0.292 (0.337) data 0.214 (0.260) loss_x loss_x 0.6465 (0.3453) acc_x 90.6250 (92.8125) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [15/34] time 0.303 (0.332) data 0.225 (0.254) loss_x loss_x 0.2186 (0.3467) acc_x 93.7500 (92.7083) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [20/34] time 0.294 (0.323) data 0.216 (0.246) loss_x loss_x 0.2825 (0.3683) acc_x 93.7500 (91.5625) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [25/34] time 0.353 (0.320) data 0.275 (0.243) loss_x loss_x 0.2384 (0.3600) acc_x 90.6250 (91.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [30/34] time 0.314 (0.323) data 0.237 (0.246) loss_x loss_x 0.4148 (0.3731) acc_x 90.6250 (91.5625) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 210
confident_label rate tensor(0.6661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1087
clean true:1086
clean false:1
clean_rate:0.9990800367985281
noisy true:336
noisy false:209
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 545
epoch [141/200] batch [5/33] time 0.347 (0.350) data 0.269 (0.271) loss_x loss_x 0.2292 (0.3506) acc_x 96.8750 (90.6250) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [10/33] time 0.347 (0.344) data 0.270 (0.266) loss_x loss_x 0.1918 (0.2954) acc_x 96.8750 (92.8125) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [15/33] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.3423 (0.3137) acc_x 93.7500 (93.1250) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [20/33] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.3447 (0.3164) acc_x 93.7500 (92.8125) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [25/33] time 0.296 (0.335) data 0.219 (0.258) loss_x loss_x 0.4434 (0.3153) acc_x 90.6250 (93.0000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [30/33] time 0.295 (0.329) data 0.217 (0.251) loss_x loss_x 0.3218 (0.3249) acc_x 93.7500 (92.5000) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:344
noisy false:180
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [142/200] batch [5/34] time 0.348 (0.345) data 0.271 (0.267) loss_x loss_x 0.3745 (0.2953) acc_x 93.7500 (94.3750) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [10/34] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.2778 (0.2623) acc_x 93.7500 (95.0000) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [15/34] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.3430 (0.2762) acc_x 93.7500 (94.3750) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [20/34] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.2673 (0.2924) acc_x 93.7500 (93.9062) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [25/34] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.1564 (0.2844) acc_x 96.8750 (94.0000) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [30/34] time 0.332 (0.341) data 0.255 (0.264) loss_x loss_x 0.3242 (0.3010) acc_x 87.5000 (93.1250) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:344
noisy false:180
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [143/200] batch [5/34] time 0.344 (0.330) data 0.265 (0.253) loss_x loss_x 0.3955 (0.3169) acc_x 90.6250 (94.3750) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [10/34] time 0.333 (0.336) data 0.256 (0.259) loss_x loss_x 0.4438 (0.3258) acc_x 90.6250 (93.4375) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [15/34] time 0.347 (0.339) data 0.269 (0.261) loss_x loss_x 0.1914 (0.2989) acc_x 96.8750 (93.3333) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [20/34] time 0.329 (0.337) data 0.251 (0.260) loss_x loss_x 0.4036 (0.3266) acc_x 87.5000 (92.0312) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [25/34] time 0.288 (0.329) data 0.210 (0.251) loss_x loss_x 0.2847 (0.3176) acc_x 93.7500 (92.0000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [30/34] time 0.342 (0.331) data 0.266 (0.253) loss_x loss_x 0.3296 (0.3171) acc_x 90.6250 (92.0833) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1106
clean true:1106
clean false:0
clean_rate:1.0
noisy true:341
noisy false:185
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 526
epoch [144/200] batch [5/34] time 0.336 (0.320) data 0.259 (0.242) loss_x loss_x 0.7310 (0.4102) acc_x 90.6250 (90.6250) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [10/34] time 0.337 (0.329) data 0.259 (0.252) loss_x loss_x 0.3853 (0.4005) acc_x 90.6250 (90.9375) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [15/34] time 0.298 (0.325) data 0.221 (0.247) loss_x loss_x 0.2556 (0.3650) acc_x 100.0000 (92.2917) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [20/34] time 0.337 (0.319) data 0.259 (0.242) loss_x loss_x 0.2812 (0.3520) acc_x 90.6250 (92.0312) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [25/34] time 0.339 (0.324) data 0.261 (0.246) loss_x loss_x 0.3955 (0.3395) acc_x 93.7500 (92.6250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [30/34] time 0.325 (0.325) data 0.248 (0.248) loss_x loss_x 0.5244 (0.3439) acc_x 84.3750 (92.3958) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1095
clean false:0
clean_rate:1.0
noisy true:352
noisy false:185
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [145/200] batch [5/34] time 0.330 (0.339) data 0.253 (0.262) loss_x loss_x 0.2754 (0.2960) acc_x 96.8750 (96.8750) lr 3.7476e-04 eta 0:00:09
epoch [145/200] batch [10/34] time 0.345 (0.336) data 0.267 (0.259) loss_x loss_x 0.2771 (0.3052) acc_x 96.8750 (94.6875) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [15/34] time 0.334 (0.338) data 0.256 (0.260) loss_x loss_x 0.3477 (0.2939) acc_x 93.7500 (94.5833) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [20/34] time 0.346 (0.340) data 0.269 (0.262) loss_x loss_x 0.3914 (0.3084) acc_x 87.5000 (93.7500) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [25/34] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.6079 (0.3190) acc_x 90.6250 (93.6250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [30/34] time 0.300 (0.340) data 0.222 (0.262) loss_x loss_x 0.2791 (0.3180) acc_x 96.8750 (93.7500) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1102
clean false:2
clean_rate:0.9981884057971014
noisy true:334
noisy false:194
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [146/200] batch [5/34] time 0.390 (0.358) data 0.312 (0.281) loss_x loss_x 0.2627 (0.2972) acc_x 96.8750 (93.1250) lr 3.6258e-04 eta 0:00:10
epoch [146/200] batch [10/34] time 0.343 (0.344) data 0.266 (0.266) loss_x loss_x 0.3992 (0.3539) acc_x 93.7500 (91.8750) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [15/34] time 0.295 (0.333) data 0.217 (0.256) loss_x loss_x 0.5112 (0.3919) acc_x 90.6250 (90.8333) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [20/34] time 0.298 (0.327) data 0.221 (0.249) loss_x loss_x 0.1957 (0.3685) acc_x 93.7500 (91.0938) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [25/34] time 0.355 (0.330) data 0.277 (0.253) loss_x loss_x 0.5254 (0.3761) acc_x 81.2500 (90.5000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [30/34] time 0.355 (0.333) data 0.278 (0.256) loss_x loss_x 0.1639 (0.3677) acc_x 100.0000 (90.7292) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 197
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1092
clean false:0
clean_rate:1.0
noisy true:343
noisy false:197
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [147/200] batch [5/34] time 0.332 (0.332) data 0.255 (0.255) loss_x loss_x 0.3623 (0.3031) acc_x 90.6250 (91.8750) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [10/34] time 0.336 (0.327) data 0.258 (0.249) loss_x loss_x 0.2949 (0.3157) acc_x 93.7500 (91.2500) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [15/34] time 0.340 (0.333) data 0.262 (0.255) loss_x loss_x 0.2654 (0.3597) acc_x 93.7500 (91.0417) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [20/34] time 0.331 (0.335) data 0.254 (0.258) loss_x loss_x 0.2205 (0.3507) acc_x 96.8750 (91.7188) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [25/34] time 0.319 (0.336) data 0.242 (0.258) loss_x loss_x 0.2849 (0.3527) acc_x 93.7500 (91.6250) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [30/34] time 0.298 (0.329) data 0.221 (0.252) loss_x loss_x 0.1630 (0.3400) acc_x 100.0000 (92.0833) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1095
clean false:0
clean_rate:1.0
noisy true:338
noisy false:199
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [148/200] batch [5/34] time 0.345 (0.310) data 0.266 (0.233) loss_x loss_x 0.1738 (0.4146) acc_x 93.7500 (90.0000) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [10/34] time 0.346 (0.330) data 0.268 (0.252) loss_x loss_x 0.3252 (0.3526) acc_x 90.6250 (90.9375) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [15/34] time 0.342 (0.335) data 0.265 (0.257) loss_x loss_x 0.2073 (0.3180) acc_x 93.7500 (92.2917) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [20/34] time 0.333 (0.335) data 0.256 (0.258) loss_x loss_x 0.2590 (0.3253) acc_x 100.0000 (92.3438) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [25/34] time 0.360 (0.339) data 0.283 (0.261) loss_x loss_x 0.1617 (0.3058) acc_x 100.0000 (93.1250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [30/34] time 0.310 (0.337) data 0.232 (0.260) loss_x loss_x 0.5015 (0.3248) acc_x 87.5000 (92.9167) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 197
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1097
clean false:1
clean_rate:0.9990892531876139
noisy true:338
noisy false:196
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [149/200] batch [5/34] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.2010 (0.3380) acc_x 100.0000 (93.7500) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [10/34] time 0.319 (0.339) data 0.242 (0.262) loss_x loss_x 0.5161 (0.3360) acc_x 84.3750 (93.1250) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [15/34] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.4194 (0.3489) acc_x 87.5000 (92.5000) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [20/34] time 0.345 (0.340) data 0.268 (0.262) loss_x loss_x 0.3474 (0.3405) acc_x 90.6250 (92.5000) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [25/34] time 0.338 (0.340) data 0.261 (0.263) loss_x loss_x 0.2444 (0.3302) acc_x 96.8750 (92.5000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [30/34] time 0.354 (0.341) data 0.277 (0.264) loss_x loss_x 0.1693 (0.3256) acc_x 96.8750 (92.8125) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6685, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1091
clean true:1091
clean false:0
clean_rate:1.0
noisy true:342
noisy false:199
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 541
epoch [150/200] batch [5/34] time 0.357 (0.345) data 0.280 (0.267) loss_x loss_x 0.2200 (0.2788) acc_x 96.8750 (93.7500) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [10/34] time 0.287 (0.338) data 0.210 (0.261) loss_x loss_x 0.5005 (0.3129) acc_x 87.5000 (93.7500) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [15/34] time 0.327 (0.336) data 0.250 (0.259) loss_x loss_x 0.1609 (0.2898) acc_x 96.8750 (94.1667) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [20/34] time 0.294 (0.326) data 0.217 (0.248) loss_x loss_x 0.4875 (0.2949) acc_x 87.5000 (93.7500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [25/34] time 0.298 (0.320) data 0.220 (0.242) loss_x loss_x 0.4861 (0.3102) acc_x 90.6250 (93.8750) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [30/34] time 0.307 (0.319) data 0.230 (0.242) loss_x loss_x 0.3220 (0.2992) acc_x 93.7500 (94.1667) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 182
confident_label rate tensor(0.6777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1106
clean true:1106
clean false:0
clean_rate:1.0
noisy true:344
noisy false:182
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 526
epoch [151/200] batch [5/34] time 0.345 (0.337) data 0.268 (0.259) loss_x loss_x 0.3191 (0.3523) acc_x 93.7500 (92.5000) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [10/34] time 0.377 (0.345) data 0.300 (0.268) loss_x loss_x 0.1366 (0.3264) acc_x 96.8750 (92.8125) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [15/34] time 0.343 (0.345) data 0.266 (0.267) loss_x loss_x 0.3176 (0.3183) acc_x 93.7500 (93.1250) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [20/34] time 0.337 (0.344) data 0.260 (0.266) loss_x loss_x 0.2257 (0.3225) acc_x 96.8750 (93.2812) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [25/34] time 0.351 (0.343) data 0.274 (0.266) loss_x loss_x 0.4529 (0.3381) acc_x 81.2500 (92.7500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [30/34] time 0.336 (0.343) data 0.259 (0.265) loss_x loss_x 0.3948 (0.3328) acc_x 90.6250 (92.9167) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:345
noisy false:188
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [152/200] batch [5/34] time 0.286 (0.333) data 0.209 (0.255) loss_x loss_x 0.2318 (0.3315) acc_x 100.0000 (95.0000) lr 2.9289e-04 eta 0:00:09
epoch [152/200] batch [10/34] time 0.290 (0.313) data 0.211 (0.236) loss_x loss_x 0.4045 (0.3322) acc_x 90.6250 (94.0625) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/34] time 0.355 (0.318) data 0.278 (0.240) loss_x loss_x 0.3447 (0.3030) acc_x 87.5000 (94.1667) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [20/34] time 0.358 (0.325) data 0.280 (0.248) loss_x loss_x 0.5269 (0.3043) acc_x 87.5000 (94.0625) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [25/34] time 0.346 (0.329) data 0.268 (0.251) loss_x loss_x 0.2869 (0.2880) acc_x 96.8750 (94.5000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [30/34] time 0.331 (0.331) data 0.255 (0.254) loss_x loss_x 0.1571 (0.2866) acc_x 96.8750 (94.2708) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1096
clean false:1
clean_rate:0.9990884229717412
noisy true:347
noisy false:188
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [153/200] batch [5/34] time 0.346 (0.346) data 0.269 (0.269) loss_x loss_x 0.2686 (0.2928) acc_x 96.8750 (95.0000) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [10/34] time 0.338 (0.343) data 0.260 (0.265) loss_x loss_x 0.5786 (0.3228) acc_x 87.5000 (93.4375) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [15/34] time 0.334 (0.342) data 0.256 (0.264) loss_x loss_x 0.3035 (0.3080) acc_x 90.6250 (93.5417) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [20/34] time 0.334 (0.341) data 0.256 (0.264) loss_x loss_x 0.3818 (0.3063) acc_x 93.7500 (92.9688) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [25/34] time 0.346 (0.338) data 0.268 (0.260) loss_x loss_x 0.3420 (0.3141) acc_x 93.7500 (92.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [30/34] time 0.334 (0.337) data 0.257 (0.260) loss_x loss_x 0.3186 (0.3211) acc_x 93.7500 (92.3958) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1110
clean false:1
clean_rate:0.9990999099909991
noisy true:348
noisy false:173
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [154/200] batch [5/34] time 0.342 (0.339) data 0.265 (0.262) loss_x loss_x 0.2145 (0.3031) acc_x 96.8750 (93.7500) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [10/34] time 0.322 (0.330) data 0.244 (0.253) loss_x loss_x 0.4089 (0.2889) acc_x 90.6250 (93.1250) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [15/34] time 0.346 (0.330) data 0.268 (0.253) loss_x loss_x 0.2722 (0.2816) acc_x 93.7500 (92.9167) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [20/34] time 0.356 (0.334) data 0.279 (0.256) loss_x loss_x 0.1387 (0.2761) acc_x 96.8750 (93.2812) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [25/34] time 0.291 (0.333) data 0.214 (0.255) loss_x loss_x 0.4873 (0.3088) acc_x 78.1250 (92.5000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [30/34] time 0.341 (0.334) data 0.264 (0.257) loss_x loss_x 0.4143 (0.3268) acc_x 87.5000 (92.0833) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:334
noisy false:190
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [155/200] batch [5/34] time 0.327 (0.342) data 0.250 (0.264) loss_x loss_x 0.3198 (0.4014) acc_x 93.7500 (90.6250) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [10/34] time 0.342 (0.339) data 0.264 (0.262) loss_x loss_x 0.5684 (0.4000) acc_x 81.2500 (90.9375) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [15/34] time 0.347 (0.343) data 0.270 (0.265) loss_x loss_x 0.1479 (0.3727) acc_x 96.8750 (91.2500) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [20/34] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.1591 (0.3635) acc_x 100.0000 (92.1875) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [25/34] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.1827 (0.3570) acc_x 93.7500 (92.3750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [30/34] time 0.337 (0.343) data 0.259 (0.265) loss_x loss_x 0.4131 (0.3550) acc_x 90.6250 (92.3958) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 164
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1122
clean false:1
clean_rate:0.9991095280498664
noisy true:346
noisy false:163
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [156/200] batch [5/35] time 0.322 (0.346) data 0.245 (0.268) loss_x loss_x 0.4963 (0.3885) acc_x 87.5000 (91.2500) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [10/35] time 0.323 (0.337) data 0.245 (0.259) loss_x loss_x 0.2854 (0.3234) acc_x 90.6250 (93.1250) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [15/35] time 0.346 (0.327) data 0.268 (0.249) loss_x loss_x 0.3462 (0.3205) acc_x 90.6250 (93.3333) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [20/35] time 0.351 (0.333) data 0.273 (0.255) loss_x loss_x 0.2930 (0.3305) acc_x 90.6250 (92.9688) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [25/35] time 0.331 (0.335) data 0.253 (0.258) loss_x loss_x 0.4226 (0.3268) acc_x 93.7500 (93.0000) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [30/35] time 0.366 (0.338) data 0.288 (0.260) loss_x loss_x 0.2690 (0.3242) acc_x 90.6250 (93.0208) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [35/35] time 0.297 (0.336) data 0.219 (0.258) loss_x loss_x 0.3643 (0.3242) acc_x 90.6250 (92.9464) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 203
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1094
clean false:1
clean_rate:0.9990867579908675
noisy true:335
noisy false:202
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [157/200] batch [5/34] time 0.295 (0.306) data 0.217 (0.228) loss_x loss_x 0.3042 (0.3197) acc_x 93.7500 (93.1250) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [10/34] time 0.292 (0.304) data 0.215 (0.226) loss_x loss_x 0.3896 (0.3329) acc_x 90.6250 (91.5625) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/34] time 0.390 (0.326) data 0.312 (0.248) loss_x loss_x 0.4517 (0.3355) acc_x 90.6250 (91.8750) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [20/34] time 0.373 (0.334) data 0.294 (0.256) loss_x loss_x 0.2448 (0.3183) acc_x 93.7500 (92.5000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [25/34] time 0.352 (0.340) data 0.274 (0.262) loss_x loss_x 0.4561 (0.3192) acc_x 90.6250 (92.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [30/34] time 0.360 (0.341) data 0.281 (0.263) loss_x loss_x 0.1985 (0.3445) acc_x 96.8750 (91.9792) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 179
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1108
clean false:2
clean_rate:0.9981981981981982
noisy true:345
noisy false:177
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [158/200] batch [5/34] time 0.307 (0.314) data 0.229 (0.236) loss_x loss_x 0.1577 (0.2395) acc_x 93.7500 (95.6250) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [10/34] time 0.296 (0.307) data 0.218 (0.229) loss_x loss_x 0.4202 (0.2721) acc_x 93.7500 (94.6875) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [15/34] time 0.315 (0.306) data 0.237 (0.228) loss_x loss_x 0.2307 (0.2958) acc_x 96.8750 (93.7500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [20/34] time 0.341 (0.309) data 0.264 (0.231) loss_x loss_x 0.2421 (0.3128) acc_x 96.8750 (93.4375) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [25/34] time 0.363 (0.316) data 0.286 (0.238) loss_x loss_x 0.5991 (0.3267) acc_x 81.2500 (93.0000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [30/34] time 0.363 (0.323) data 0.285 (0.245) loss_x loss_x 0.3064 (0.3319) acc_x 90.6250 (92.6042) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 197
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1090
clean false:0
clean_rate:1.0
noisy true:345
noisy false:197
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [159/200] batch [5/34] time 0.344 (0.352) data 0.266 (0.274) loss_x loss_x 0.1810 (0.3260) acc_x 96.8750 (94.3750) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [10/34] time 0.346 (0.347) data 0.269 (0.269) loss_x loss_x 0.2279 (0.3496) acc_x 96.8750 (93.1250) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [15/34] time 0.295 (0.331) data 0.217 (0.253) loss_x loss_x 0.2239 (0.3419) acc_x 93.7500 (92.7083) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [20/34] time 0.293 (0.323) data 0.215 (0.245) loss_x loss_x 0.1404 (0.3185) acc_x 96.8750 (93.1250) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [25/34] time 0.296 (0.317) data 0.218 (0.239) loss_x loss_x 0.2676 (0.3054) acc_x 96.8750 (93.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [30/34] time 0.304 (0.314) data 0.226 (0.236) loss_x loss_x 0.1991 (0.2879) acc_x 100.0000 (94.0625) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.6777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1106
clean true:1106
clean false:0
clean_rate:1.0
noisy true:340
noisy false:186
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 526
epoch [160/200] batch [5/34] time 0.336 (0.345) data 0.259 (0.267) loss_x loss_x 0.4622 (0.3819) acc_x 90.6250 (90.6250) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [10/34] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.2729 (0.3542) acc_x 93.7500 (91.5625) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [15/34] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.3186 (0.3290) acc_x 93.7500 (92.0833) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [20/34] time 0.349 (0.341) data 0.271 (0.263) loss_x loss_x 0.2661 (0.3365) acc_x 90.6250 (91.5625) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [25/34] time 0.356 (0.344) data 0.279 (0.266) loss_x loss_x 0.1510 (0.3154) acc_x 100.0000 (92.2500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [30/34] time 0.294 (0.340) data 0.216 (0.263) loss_x loss_x 0.4402 (0.3269) acc_x 90.6250 (92.0833) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:340
noisy false:186
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 526
epoch [161/200] batch [5/34] time 0.352 (0.352) data 0.274 (0.274) loss_x loss_x 0.3767 (0.3042) acc_x 90.6250 (91.8750) lr 2.0032e-04 eta 0:00:10
epoch [161/200] batch [10/34] time 0.345 (0.350) data 0.267 (0.273) loss_x loss_x 0.3027 (0.2784) acc_x 93.7500 (93.1250) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [15/34] time 0.351 (0.348) data 0.274 (0.270) loss_x loss_x 0.4241 (0.3262) acc_x 93.7500 (92.7083) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [20/34] time 0.341 (0.348) data 0.264 (0.270) loss_x loss_x 0.4976 (0.3499) acc_x 84.3750 (91.8750) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [25/34] time 0.333 (0.345) data 0.256 (0.267) loss_x loss_x 0.4561 (0.3507) acc_x 96.8750 (92.0000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [30/34] time 0.357 (0.345) data 0.279 (0.268) loss_x loss_x 0.2908 (0.3450) acc_x 93.7500 (92.2917) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:358
noisy false:173
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [162/200] batch [5/34] time 0.287 (0.347) data 0.211 (0.270) loss_x loss_x 0.5791 (0.3316) acc_x 84.3750 (92.5000) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [10/34] time 0.299 (0.321) data 0.222 (0.245) loss_x loss_x 0.3408 (0.3377) acc_x 93.7500 (92.1875) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [15/34] time 0.336 (0.328) data 0.259 (0.251) loss_x loss_x 0.3013 (0.3189) acc_x 96.8750 (92.9167) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [20/34] time 0.344 (0.332) data 0.267 (0.255) loss_x loss_x 0.1509 (0.2996) acc_x 96.8750 (93.5938) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [25/34] time 0.348 (0.334) data 0.271 (0.257) loss_x loss_x 0.3940 (0.3063) acc_x 90.6250 (93.3750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [30/34] time 0.373 (0.339) data 0.295 (0.262) loss_x loss_x 0.4590 (0.3051) acc_x 84.3750 (93.3333) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1115
clean true:1114
clean false:1
clean_rate:0.9991031390134529
noisy true:344
noisy false:173
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 517
epoch [163/200] batch [5/34] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.7095 (0.4690) acc_x 81.2500 (87.5000) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [10/34] time 0.291 (0.333) data 0.213 (0.255) loss_x loss_x 0.3733 (0.4071) acc_x 87.5000 (89.6875) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [15/34] time 0.340 (0.336) data 0.263 (0.259) loss_x loss_x 0.5298 (0.3962) acc_x 84.3750 (90.0000) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [20/34] time 0.328 (0.337) data 0.251 (0.259) loss_x loss_x 0.2537 (0.3680) acc_x 93.7500 (91.2500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [25/34] time 0.313 (0.336) data 0.236 (0.259) loss_x loss_x 0.3972 (0.3543) acc_x 90.6250 (91.6250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [30/34] time 0.347 (0.333) data 0.270 (0.256) loss_x loss_x 0.1720 (0.3482) acc_x 100.0000 (92.2917) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1104
clean false:0
clean_rate:1.0
noisy true:336
noisy false:192
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [164/200] batch [5/34] time 0.346 (0.349) data 0.269 (0.271) loss_x loss_x 0.5640 (0.3974) acc_x 84.3750 (90.0000) lr 1.7292e-04 eta 0:00:10
epoch [164/200] batch [10/34] time 0.326 (0.345) data 0.248 (0.268) loss_x loss_x 0.2842 (0.3620) acc_x 96.8750 (92.5000) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [15/34] time 0.348 (0.343) data 0.271 (0.265) loss_x loss_x 0.2966 (0.3475) acc_x 90.6250 (91.8750) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [20/34] time 0.350 (0.339) data 0.272 (0.262) loss_x loss_x 0.1875 (0.3454) acc_x 96.8750 (92.0312) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [25/34] time 0.360 (0.343) data 0.282 (0.266) loss_x loss_x 0.3262 (0.3429) acc_x 93.7500 (92.3750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [30/34] time 0.337 (0.344) data 0.259 (0.267) loss_x loss_x 0.3184 (0.3397) acc_x 87.5000 (92.2917) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 161
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1122
clean false:1
clean_rate:0.9991095280498664
noisy true:349
noisy false:160
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [165/200] batch [5/35] time 0.358 (0.351) data 0.281 (0.274) loss_x loss_x 0.1606 (0.2536) acc_x 96.8750 (95.0000) lr 1.6419e-04 eta 0:00:10
epoch [165/200] batch [10/35] time 0.347 (0.348) data 0.270 (0.271) loss_x loss_x 0.2651 (0.2615) acc_x 93.7500 (94.6875) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [15/35] time 0.307 (0.336) data 0.229 (0.258) loss_x loss_x 0.4644 (0.2995) acc_x 81.2500 (93.1250) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [20/35] time 0.349 (0.331) data 0.272 (0.254) loss_x loss_x 0.2966 (0.3094) acc_x 90.6250 (92.1875) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [25/35] time 0.326 (0.334) data 0.249 (0.257) loss_x loss_x 0.2333 (0.3090) acc_x 96.8750 (92.5000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [30/35] time 0.326 (0.334) data 0.248 (0.257) loss_x loss_x 0.3062 (0.3183) acc_x 93.7500 (91.9792) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [35/35] time 0.351 (0.337) data 0.274 (0.259) loss_x loss_x 0.2627 (0.3159) acc_x 96.8750 (92.2321) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 178
confident_label rate tensor(0.6820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1113
clean true:1113
clean false:0
clean_rate:1.0
noisy true:341
noisy false:178
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 519
epoch [166/200] batch [5/34] time 0.353 (0.351) data 0.276 (0.273) loss_x loss_x 0.1854 (0.1664) acc_x 96.8750 (98.1250) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [10/34] time 0.363 (0.348) data 0.286 (0.270) loss_x loss_x 0.1588 (0.1859) acc_x 100.0000 (97.5000) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [15/34] time 0.343 (0.347) data 0.265 (0.270) loss_x loss_x 0.3313 (0.2266) acc_x 93.7500 (96.2500) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [20/34] time 0.340 (0.345) data 0.263 (0.268) loss_x loss_x 0.2703 (0.2368) acc_x 93.7500 (95.7812) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [25/34] time 0.344 (0.344) data 0.267 (0.267) loss_x loss_x 0.3110 (0.2383) acc_x 93.7500 (95.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [30/34] time 0.296 (0.340) data 0.219 (0.262) loss_x loss_x 0.7427 (0.2725) acc_x 84.3750 (94.7917) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1098
clean false:0
clean_rate:1.0
noisy true:345
noisy false:189
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [167/200] batch [5/34] time 0.372 (0.347) data 0.294 (0.270) loss_x loss_x 0.3042 (0.3387) acc_x 93.7500 (93.1250) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [10/34] time 0.319 (0.340) data 0.241 (0.263) loss_x loss_x 0.3123 (0.3858) acc_x 90.6250 (91.8750) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [15/34] time 0.338 (0.334) data 0.260 (0.256) loss_x loss_x 0.2803 (0.3292) acc_x 93.7500 (93.3333) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [20/34] time 0.339 (0.336) data 0.261 (0.258) loss_x loss_x 0.2197 (0.3264) acc_x 90.6250 (93.4375) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [25/34] time 0.333 (0.337) data 0.256 (0.259) loss_x loss_x 0.4944 (0.3361) acc_x 84.3750 (93.0000) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [30/34] time 0.338 (0.339) data 0.261 (0.261) loss_x loss_x 0.3997 (0.3393) acc_x 96.8750 (93.1250) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:346
noisy false:180
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 526
epoch [168/200] batch [5/34] time 0.349 (0.335) data 0.272 (0.257) loss_x loss_x 0.1364 (0.1933) acc_x 100.0000 (95.6250) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [10/34] time 0.349 (0.339) data 0.272 (0.261) loss_x loss_x 0.1445 (0.2596) acc_x 96.8750 (94.3750) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [15/34] time 0.289 (0.337) data 0.213 (0.259) loss_x loss_x 0.4397 (0.2896) acc_x 84.3750 (93.7500) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [20/34] time 0.294 (0.329) data 0.217 (0.252) loss_x loss_x 0.1526 (0.3242) acc_x 93.7500 (92.1875) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [25/34] time 0.291 (0.322) data 0.214 (0.245) loss_x loss_x 0.1907 (0.3151) acc_x 96.8750 (92.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [30/34] time 0.341 (0.319) data 0.264 (0.242) loss_x loss_x 0.2178 (0.3220) acc_x 96.8750 (92.7083) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1101
clean false:0
clean_rate:1.0
noisy true:350
noisy false:181
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [169/200] batch [5/34] time 0.351 (0.346) data 0.273 (0.269) loss_x loss_x 0.1407 (0.2238) acc_x 100.0000 (95.6250) lr 1.3137e-04 eta 0:00:10
epoch [169/200] batch [10/34] time 0.289 (0.337) data 0.212 (0.260) loss_x loss_x 0.2932 (0.2827) acc_x 93.7500 (93.7500) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [15/34] time 0.351 (0.341) data 0.274 (0.263) loss_x loss_x 0.2401 (0.2850) acc_x 96.8750 (94.1667) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [20/34] time 0.358 (0.343) data 0.280 (0.265) loss_x loss_x 0.2800 (0.3092) acc_x 93.7500 (93.5938) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [25/34] time 0.389 (0.347) data 0.312 (0.269) loss_x loss_x 0.1666 (0.3153) acc_x 100.0000 (93.6250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [30/34] time 0.292 (0.345) data 0.214 (0.268) loss_x loss_x 0.2852 (0.3076) acc_x 93.7500 (93.5417) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1100
clean false:3
clean_rate:0.9972801450589301
noisy true:342
noisy false:187
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [170/200] batch [5/34] time 0.339 (0.345) data 0.261 (0.268) loss_x loss_x 0.2257 (0.2823) acc_x 96.8750 (93.1250) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [10/34] time 0.347 (0.340) data 0.269 (0.263) loss_x loss_x 0.6182 (0.3210) acc_x 87.5000 (92.8125) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [15/34] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.3867 (0.3255) acc_x 87.5000 (92.9167) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [20/34] time 0.291 (0.336) data 0.213 (0.259) loss_x loss_x 0.2593 (0.3099) acc_x 93.7500 (93.2812) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [25/34] time 0.310 (0.330) data 0.232 (0.252) loss_x loss_x 0.3000 (0.3225) acc_x 96.8750 (92.7500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [30/34] time 0.336 (0.332) data 0.259 (0.255) loss_x loss_x 0.1831 (0.3171) acc_x 96.8750 (93.1250) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:343
noisy false:180
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [171/200] batch [5/34] time 0.348 (0.348) data 0.270 (0.270) loss_x loss_x 0.4709 (0.4532) acc_x 93.7500 (89.3750) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [10/34] time 0.345 (0.347) data 0.268 (0.270) loss_x loss_x 0.2549 (0.3911) acc_x 93.7500 (90.9375) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [15/34] time 0.344 (0.345) data 0.266 (0.268) loss_x loss_x 0.2325 (0.3475) acc_x 96.8750 (92.7083) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [20/34] time 0.348 (0.346) data 0.270 (0.269) loss_x loss_x 0.4497 (0.3431) acc_x 93.7500 (92.9688) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [25/34] time 0.350 (0.347) data 0.273 (0.270) loss_x loss_x 0.2119 (0.3323) acc_x 96.8750 (93.3750) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [30/34] time 0.298 (0.345) data 0.220 (0.268) loss_x loss_x 0.2421 (0.3297) acc_x 96.8750 (92.9167) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:344
noisy false:179
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [172/200] batch [5/34] time 0.353 (0.343) data 0.275 (0.266) loss_x loss_x 0.1342 (0.2387) acc_x 96.8750 (94.3750) lr 1.0899e-04 eta 0:00:09
epoch [172/200] batch [10/34] time 0.353 (0.347) data 0.276 (0.270) loss_x loss_x 0.5039 (0.3103) acc_x 87.5000 (92.5000) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [15/34] time 0.349 (0.346) data 0.272 (0.269) loss_x loss_x 0.2029 (0.3266) acc_x 96.8750 (92.9167) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [20/34] time 0.332 (0.346) data 0.255 (0.269) loss_x loss_x 0.2385 (0.3139) acc_x 96.8750 (93.4375) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [25/34] time 0.354 (0.345) data 0.276 (0.268) loss_x loss_x 0.1854 (0.3119) acc_x 96.8750 (93.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [30/34] time 0.334 (0.347) data 0.257 (0.269) loss_x loss_x 0.2061 (0.3012) acc_x 96.8750 (93.6458) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1110
clean false:1
clean_rate:0.9990999099909991
noisy true:333
noisy false:188
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [173/200] batch [5/34] time 0.290 (0.292) data 0.212 (0.215) loss_x loss_x 0.4028 (0.3406) acc_x 93.7500 (91.2500) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [10/34] time 0.347 (0.313) data 0.270 (0.236) loss_x loss_x 0.1783 (0.3288) acc_x 96.8750 (91.8750) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [15/34] time 0.365 (0.327) data 0.287 (0.249) loss_x loss_x 0.2297 (0.3336) acc_x 93.7500 (91.6667) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [20/34] time 0.353 (0.334) data 0.276 (0.257) loss_x loss_x 0.4631 (0.3395) acc_x 90.6250 (91.4062) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [25/34] time 0.349 (0.337) data 0.272 (0.259) loss_x loss_x 0.2820 (0.3484) acc_x 93.7500 (91.2500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [30/34] time 0.342 (0.338) data 0.264 (0.260) loss_x loss_x 0.3179 (0.3395) acc_x 93.7500 (91.4583) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 167
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1111
clean false:0
clean_rate:1.0
noisy true:354
noisy false:167
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [174/200] batch [5/34] time 0.356 (0.347) data 0.279 (0.269) loss_x loss_x 0.1898 (0.2939) acc_x 96.8750 (93.7500) lr 9.5173e-05 eta 0:00:10
epoch [174/200] batch [10/34] time 0.346 (0.347) data 0.269 (0.270) loss_x loss_x 0.2334 (0.2682) acc_x 93.7500 (94.0625) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [15/34] time 0.304 (0.335) data 0.226 (0.257) loss_x loss_x 0.2405 (0.2971) acc_x 96.8750 (93.3333) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [20/34] time 0.348 (0.335) data 0.271 (0.258) loss_x loss_x 0.2351 (0.2979) acc_x 93.7500 (92.9688) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [25/34] time 0.335 (0.336) data 0.257 (0.259) loss_x loss_x 0.4167 (0.3021) acc_x 84.3750 (92.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [30/34] time 0.341 (0.336) data 0.264 (0.258) loss_x loss_x 0.3015 (0.3095) acc_x 93.7500 (92.9167) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1113
clean true:1113
clean false:0
clean_rate:1.0
noisy true:330
noisy false:189
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 519
epoch [175/200] batch [5/34] time 0.339 (0.345) data 0.262 (0.268) loss_x loss_x 0.3708 (0.3533) acc_x 87.5000 (92.5000) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [10/34] time 0.346 (0.343) data 0.268 (0.266) loss_x loss_x 0.3508 (0.3576) acc_x 93.7500 (92.8125) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [15/34] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.5376 (0.3645) acc_x 87.5000 (92.7083) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [20/34] time 0.338 (0.346) data 0.261 (0.268) loss_x loss_x 0.3257 (0.3442) acc_x 93.7500 (92.9688) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [25/34] time 0.292 (0.339) data 0.214 (0.262) loss_x loss_x 0.3047 (0.3427) acc_x 90.6250 (92.2500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [30/34] time 0.305 (0.332) data 0.228 (0.255) loss_x loss_x 0.0997 (0.3256) acc_x 96.8750 (92.7083) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 175
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:348
noisy false:175
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [176/200] batch [5/34] time 0.290 (0.295) data 0.213 (0.218) loss_x loss_x 0.3123 (0.3059) acc_x 93.7500 (91.2500) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [10/34] time 0.352 (0.320) data 0.274 (0.243) loss_x loss_x 0.0798 (0.2455) acc_x 100.0000 (93.7500) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [15/34] time 0.361 (0.328) data 0.284 (0.251) loss_x loss_x 0.4849 (0.2861) acc_x 93.7500 (92.9167) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [20/34] time 0.361 (0.335) data 0.283 (0.257) loss_x loss_x 0.3269 (0.2768) acc_x 93.7500 (93.5938) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [25/34] time 0.355 (0.338) data 0.277 (0.260) loss_x loss_x 0.3145 (0.2874) acc_x 90.6250 (93.2500) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [30/34] time 0.347 (0.339) data 0.270 (0.261) loss_x loss_x 0.1763 (0.2943) acc_x 100.0000 (93.2292) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 179
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:344
noisy false:179
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [177/200] batch [5/34] time 0.289 (0.298) data 0.211 (0.220) loss_x loss_x 0.4448 (0.2815) acc_x 90.6250 (93.7500) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/34] time 0.344 (0.323) data 0.267 (0.245) loss_x loss_x 0.4509 (0.3208) acc_x 93.7500 (93.4375) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [15/34] time 0.339 (0.326) data 0.261 (0.248) loss_x loss_x 0.3257 (0.3625) acc_x 96.8750 (92.5000) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [20/34] time 0.349 (0.330) data 0.272 (0.252) loss_x loss_x 0.2218 (0.3503) acc_x 93.7500 (92.1875) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/34] time 0.344 (0.333) data 0.265 (0.256) loss_x loss_x 0.2590 (0.3336) acc_x 93.7500 (92.6250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [30/34] time 0.344 (0.334) data 0.266 (0.257) loss_x loss_x 0.2659 (0.3215) acc_x 93.7500 (92.8125) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1112
clean true:1112
clean false:0
clean_rate:1.0
noisy true:337
noisy false:183
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 520
epoch [178/200] batch [5/34] time 0.308 (0.296) data 0.231 (0.218) loss_x loss_x 0.1172 (0.3078) acc_x 96.8750 (93.1250) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [10/34] time 0.337 (0.309) data 0.258 (0.231) loss_x loss_x 0.2251 (0.3115) acc_x 93.7500 (92.8125) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [15/34] time 0.341 (0.318) data 0.264 (0.240) loss_x loss_x 0.2786 (0.3142) acc_x 93.7500 (92.5000) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [20/34] time 0.294 (0.320) data 0.216 (0.243) loss_x loss_x 0.1685 (0.3132) acc_x 96.8750 (92.5000) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [25/34] time 0.287 (0.314) data 0.209 (0.237) loss_x loss_x 0.3621 (0.3243) acc_x 93.7500 (92.5000) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [30/34] time 0.333 (0.315) data 0.254 (0.238) loss_x loss_x 0.2676 (0.3224) acc_x 93.7500 (92.2917) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1117
clean true:1116
clean false:1
clean_rate:0.999104744852283
noisy true:340
noisy false:175
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 515
epoch [179/200] batch [5/34] time 0.333 (0.340) data 0.255 (0.263) loss_x loss_x 0.2013 (0.3022) acc_x 93.7500 (93.1250) lr 6.4556e-05 eta 0:00:09
epoch [179/200] batch [10/34] time 0.337 (0.335) data 0.259 (0.258) loss_x loss_x 0.2986 (0.3470) acc_x 93.7500 (91.2500) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [15/34] time 0.352 (0.340) data 0.273 (0.263) loss_x loss_x 0.3079 (0.3200) acc_x 87.5000 (91.4583) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [20/34] time 0.345 (0.342) data 0.268 (0.265) loss_x loss_x 0.4333 (0.3237) acc_x 90.6250 (91.7188) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [25/34] time 0.350 (0.342) data 0.272 (0.265) loss_x loss_x 0.3826 (0.3172) acc_x 96.8750 (92.2500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [30/34] time 0.296 (0.341) data 0.219 (0.263) loss_x loss_x 0.5371 (0.3325) acc_x 93.7500 (92.0833) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1095
clean false:0
clean_rate:1.0
noisy true:347
noisy false:190
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [180/200] batch [5/34] time 0.361 (0.349) data 0.283 (0.271) loss_x loss_x 0.2240 (0.3732) acc_x 96.8750 (91.2500) lr 5.9119e-05 eta 0:00:10
epoch [180/200] batch [10/34] time 0.300 (0.334) data 0.221 (0.256) loss_x loss_x 0.1523 (0.3632) acc_x 100.0000 (90.9375) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [15/34] time 0.311 (0.323) data 0.233 (0.245) loss_x loss_x 0.6694 (0.3506) acc_x 81.2500 (91.4583) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [20/34] time 0.302 (0.318) data 0.225 (0.240) loss_x loss_x 0.1570 (0.3445) acc_x 96.8750 (92.0312) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [25/34] time 0.343 (0.317) data 0.266 (0.239) loss_x loss_x 0.4277 (0.3544) acc_x 90.6250 (91.5000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/34] time 0.343 (0.322) data 0.266 (0.244) loss_x loss_x 0.3162 (0.3427) acc_x 96.8750 (92.2917) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 184
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:349
noisy false:184
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [181/200] batch [5/34] time 0.347 (0.350) data 0.270 (0.273) loss_x loss_x 0.5464 (0.3675) acc_x 93.7500 (92.5000) lr 5.3915e-05 eta 0:00:10
epoch [181/200] batch [10/34] time 0.336 (0.337) data 0.259 (0.259) loss_x loss_x 0.4849 (0.3517) acc_x 90.6250 (92.5000) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [15/34] time 0.334 (0.335) data 0.255 (0.257) loss_x loss_x 0.2238 (0.3515) acc_x 90.6250 (92.2917) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [20/34] time 0.341 (0.335) data 0.264 (0.258) loss_x loss_x 0.1440 (0.3373) acc_x 96.8750 (92.5000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [25/34] time 0.336 (0.338) data 0.258 (0.260) loss_x loss_x 0.3721 (0.3485) acc_x 90.6250 (92.0000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [30/34] time 0.325 (0.338) data 0.247 (0.260) loss_x loss_x 0.2720 (0.3507) acc_x 93.7500 (91.9792) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 154
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:351
noisy false:154
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 505
epoch [182/200] batch [5/35] time 0.337 (0.348) data 0.260 (0.270) loss_x loss_x 0.1859 (0.2503) acc_x 96.8750 (95.0000) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [10/35] time 0.354 (0.345) data 0.276 (0.268) loss_x loss_x 0.3149 (0.2846) acc_x 90.6250 (93.4375) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [15/35] time 0.345 (0.344) data 0.268 (0.266) loss_x loss_x 0.1265 (0.2782) acc_x 100.0000 (93.9583) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [20/35] time 0.344 (0.343) data 0.266 (0.266) loss_x loss_x 0.4292 (0.3004) acc_x 93.7500 (93.2812) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [25/35] time 0.354 (0.343) data 0.277 (0.266) loss_x loss_x 0.2139 (0.2988) acc_x 96.8750 (93.5000) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [30/35] time 0.361 (0.344) data 0.284 (0.266) loss_x loss_x 0.3345 (0.3247) acc_x 96.8750 (93.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [35/35] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.1906 (0.3183) acc_x 96.8750 (93.3929) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 172
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1111
clean false:0
clean_rate:1.0
noisy true:349
noisy false:172
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [183/200] batch [5/34] time 0.360 (0.337) data 0.283 (0.259) loss_x loss_x 0.2498 (0.3020) acc_x 93.7500 (92.5000) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [10/34] time 0.319 (0.338) data 0.242 (0.260) loss_x loss_x 0.3450 (0.3272) acc_x 90.6250 (91.5625) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [15/34] time 0.343 (0.344) data 0.265 (0.266) loss_x loss_x 0.1967 (0.3035) acc_x 100.0000 (93.3333) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [20/34] time 0.356 (0.345) data 0.279 (0.268) loss_x loss_x 0.2544 (0.3181) acc_x 96.8750 (93.5938) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [25/34] time 0.361 (0.345) data 0.283 (0.267) loss_x loss_x 0.2152 (0.3267) acc_x 96.8750 (93.5000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [30/34] time 0.345 (0.344) data 0.267 (0.267) loss_x loss_x 0.3557 (0.3250) acc_x 87.5000 (93.5417) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1098
clean false:0
clean_rate:1.0
noisy true:347
noisy false:187
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [184/200] batch [5/34] time 0.341 (0.336) data 0.264 (0.258) loss_x loss_x 0.3877 (0.2984) acc_x 90.6250 (93.7500) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [10/34] time 0.296 (0.330) data 0.218 (0.252) loss_x loss_x 0.1674 (0.2498) acc_x 100.0000 (95.9375) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [15/34] time 0.320 (0.322) data 0.242 (0.244) loss_x loss_x 0.2664 (0.2506) acc_x 90.6250 (95.0000) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [20/34] time 0.340 (0.326) data 0.263 (0.249) loss_x loss_x 0.3884 (0.2882) acc_x 90.6250 (93.9062) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [25/34] time 0.355 (0.330) data 0.278 (0.253) loss_x loss_x 0.3899 (0.2869) acc_x 90.6250 (94.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/34] time 0.343 (0.333) data 0.265 (0.256) loss_x loss_x 0.1841 (0.2869) acc_x 100.0000 (94.4792) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:339
noisy false:185
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [185/200] batch [5/34] time 0.348 (0.342) data 0.269 (0.265) loss_x loss_x 0.2505 (0.2849) acc_x 93.7500 (95.0000) lr 3.5443e-05 eta 0:00:09
epoch [185/200] batch [10/34] time 0.325 (0.340) data 0.248 (0.262) loss_x loss_x 0.3467 (0.2765) acc_x 90.6250 (94.3750) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [15/34] time 0.344 (0.340) data 0.266 (0.263) loss_x loss_x 0.4055 (0.2568) acc_x 90.6250 (95.0000) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [20/34] time 0.299 (0.334) data 0.221 (0.256) loss_x loss_x 0.2147 (0.2618) acc_x 93.7500 (95.0000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [25/34] time 0.299 (0.327) data 0.221 (0.250) loss_x loss_x 0.3108 (0.2710) acc_x 93.7500 (94.5000) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [30/34] time 0.362 (0.329) data 0.284 (0.251) loss_x loss_x 0.3181 (0.2827) acc_x 93.7500 (94.1667) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 173
confident_label rate tensor(0.6814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1112
clean true:1112
clean false:0
clean_rate:1.0
noisy true:347
noisy false:173
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 520
epoch [186/200] batch [5/34] time 0.346 (0.348) data 0.268 (0.271) loss_x loss_x 0.3359 (0.2376) acc_x 90.6250 (94.3750) lr 3.1417e-05 eta 0:00:10
epoch [186/200] batch [10/34] time 0.323 (0.342) data 0.246 (0.265) loss_x loss_x 0.8184 (0.3389) acc_x 84.3750 (92.5000) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [15/34] time 0.342 (0.341) data 0.264 (0.264) loss_x loss_x 0.3130 (0.3528) acc_x 93.7500 (91.6667) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [20/34] time 0.344 (0.342) data 0.267 (0.264) loss_x loss_x 0.5498 (0.3491) acc_x 84.3750 (91.4062) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [25/34] time 0.299 (0.340) data 0.221 (0.262) loss_x loss_x 0.5078 (0.3447) acc_x 90.6250 (91.5000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [30/34] time 0.346 (0.337) data 0.269 (0.259) loss_x loss_x 0.1265 (0.3375) acc_x 100.0000 (91.7708) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 173
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1117
clean false:2
clean_rate:0.998212689901698
noisy true:342
noisy false:171
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [187/200] batch [5/34] time 0.337 (0.345) data 0.259 (0.267) loss_x loss_x 0.3967 (0.4612) acc_x 90.6250 (88.1250) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [10/34] time 0.354 (0.344) data 0.276 (0.266) loss_x loss_x 0.2876 (0.4193) acc_x 90.6250 (89.3750) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [15/34] time 0.350 (0.343) data 0.273 (0.265) loss_x loss_x 0.3162 (0.3783) acc_x 93.7500 (90.8333) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [20/34] time 0.355 (0.345) data 0.277 (0.267) loss_x loss_x 0.1455 (0.3648) acc_x 96.8750 (91.0938) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [25/34] time 0.349 (0.345) data 0.271 (0.267) loss_x loss_x 0.3508 (0.3610) acc_x 93.7500 (91.3750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [30/34] time 0.348 (0.345) data 0.271 (0.267) loss_x loss_x 0.2415 (0.3393) acc_x 93.7500 (92.1875) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 171
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1117
clean true:1116
clean false:1
clean_rate:0.999104744852283
noisy true:345
noisy false:170
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 515
epoch [188/200] batch [5/34] time 0.323 (0.331) data 0.245 (0.254) loss_x loss_x 0.3149 (0.3218) acc_x 90.6250 (91.2500) lr 2.4083e-05 eta 0:00:09
epoch [188/200] batch [10/34] time 0.334 (0.335) data 0.257 (0.257) loss_x loss_x 0.1427 (0.3305) acc_x 100.0000 (92.1875) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [15/34] time 0.325 (0.335) data 0.248 (0.257) loss_x loss_x 0.2729 (0.3040) acc_x 93.7500 (93.3333) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [20/34] time 0.337 (0.336) data 0.259 (0.259) loss_x loss_x 0.1725 (0.3011) acc_x 96.8750 (93.2812) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [25/34] time 0.300 (0.330) data 0.222 (0.252) loss_x loss_x 0.2256 (0.3050) acc_x 93.7500 (93.2500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [30/34] time 0.332 (0.331) data 0.254 (0.253) loss_x loss_x 0.3052 (0.3027) acc_x 93.7500 (93.6458) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 175
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1117
clean false:2
clean_rate:0.998212689901698
noisy true:340
noisy false:173
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [189/200] batch [5/34] time 0.333 (0.356) data 0.255 (0.278) loss_x loss_x 0.3591 (0.3247) acc_x 87.5000 (91.2500) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [10/34] time 0.336 (0.357) data 0.258 (0.279) loss_x loss_x 0.2793 (0.2946) acc_x 93.7500 (93.1250) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [15/34] time 0.338 (0.351) data 0.260 (0.273) loss_x loss_x 0.2583 (0.2932) acc_x 93.7500 (93.1250) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [20/34] time 0.335 (0.344) data 0.257 (0.267) loss_x loss_x 0.2177 (0.2881) acc_x 96.8750 (93.5938) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [25/34] time 0.332 (0.343) data 0.255 (0.265) loss_x loss_x 0.1730 (0.2873) acc_x 96.8750 (93.8750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [30/34] time 0.325 (0.340) data 0.247 (0.263) loss_x loss_x 0.6440 (0.2950) acc_x 84.3750 (93.5417) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 178
confident_label rate tensor(0.6826, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1114
clean true:1111
clean false:3
clean_rate:0.9973070017953322
noisy true:343
noisy false:175
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 518
epoch [190/200] batch [5/34] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.6440 (0.3723) acc_x 84.3750 (90.6250) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [10/34] time 0.343 (0.344) data 0.264 (0.266) loss_x loss_x 0.5439 (0.3527) acc_x 87.5000 (92.5000) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [15/34] time 0.336 (0.340) data 0.258 (0.262) loss_x loss_x 0.1467 (0.3449) acc_x 96.8750 (91.6667) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [20/34] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.2426 (0.3240) acc_x 96.8750 (92.6562) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [25/34] time 0.340 (0.339) data 0.262 (0.261) loss_x loss_x 0.2173 (0.3237) acc_x 93.7500 (93.0000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [30/34] time 0.341 (0.339) data 0.264 (0.262) loss_x loss_x 0.2400 (0.3163) acc_x 96.8750 (93.2292) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:344
noisy false:180
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [191/200] batch [5/34] time 0.357 (0.343) data 0.279 (0.264) loss_x loss_x 0.2386 (0.2563) acc_x 100.0000 (95.6250) lr 1.4891e-05 eta 0:00:09
epoch [191/200] batch [10/34] time 0.338 (0.343) data 0.261 (0.266) loss_x loss_x 0.2123 (0.2810) acc_x 96.8750 (95.0000) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [15/34] time 0.338 (0.345) data 0.261 (0.267) loss_x loss_x 0.2168 (0.2916) acc_x 100.0000 (94.7917) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [20/34] time 0.344 (0.344) data 0.267 (0.266) loss_x loss_x 0.4141 (0.3048) acc_x 87.5000 (93.5938) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [25/34] time 0.340 (0.344) data 0.263 (0.267) loss_x loss_x 0.3518 (0.2944) acc_x 93.7500 (93.8750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [30/34] time 0.375 (0.344) data 0.298 (0.266) loss_x loss_x 0.2290 (0.2839) acc_x 93.7500 (94.1667) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:341
noisy false:182
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [192/200] batch [5/34] time 0.306 (0.328) data 0.228 (0.250) loss_x loss_x 0.2500 (0.2575) acc_x 90.6250 (92.5000) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [10/34] time 0.323 (0.322) data 0.245 (0.244) loss_x loss_x 0.4011 (0.2867) acc_x 93.7500 (94.0625) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [15/34] time 0.342 (0.328) data 0.263 (0.249) loss_x loss_x 0.3782 (0.3118) acc_x 90.6250 (92.5000) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [20/34] time 0.357 (0.332) data 0.279 (0.254) loss_x loss_x 0.2788 (0.3106) acc_x 93.7500 (92.5000) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [25/34] time 0.332 (0.334) data 0.254 (0.256) loss_x loss_x 0.4336 (0.3216) acc_x 87.5000 (92.2500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [30/34] time 0.347 (0.337) data 0.269 (0.259) loss_x loss_x 0.4224 (0.3262) acc_x 90.6250 (92.1875) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6783, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1107
clean true:1106
clean false:1
clean_rate:0.999096657633243
noisy true:350
noisy false:175
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 525
epoch [193/200] batch [5/34] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.2917 (0.2850) acc_x 93.7500 (94.3750) lr 9.9763e-06 eta 0:00:10
epoch [193/200] batch [10/34] time 0.299 (0.335) data 0.221 (0.257) loss_x loss_x 0.2289 (0.3031) acc_x 87.5000 (92.5000) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [15/34] time 0.308 (0.324) data 0.230 (0.246) loss_x loss_x 0.1981 (0.2819) acc_x 93.7500 (93.3333) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [20/34] time 0.331 (0.326) data 0.253 (0.249) loss_x loss_x 0.2001 (0.3002) acc_x 96.8750 (93.1250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [25/34] time 0.336 (0.330) data 0.258 (0.253) loss_x loss_x 0.4246 (0.3084) acc_x 90.6250 (92.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/34] time 0.356 (0.332) data 0.278 (0.255) loss_x loss_x 0.1958 (0.2934) acc_x 96.8750 (93.2292) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:357
noisy false:175
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [194/200] batch [5/34] time 0.359 (0.354) data 0.281 (0.276) loss_x loss_x 0.3931 (0.2918) acc_x 87.5000 (95.0000) lr 7.8853e-06 eta 0:00:10
epoch [194/200] batch [10/34] time 0.343 (0.351) data 0.265 (0.273) loss_x loss_x 0.4385 (0.3248) acc_x 90.6250 (94.0625) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [15/34] time 0.321 (0.339) data 0.243 (0.261) loss_x loss_x 0.2656 (0.3226) acc_x 96.8750 (93.9583) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [20/34] time 0.309 (0.334) data 0.232 (0.256) loss_x loss_x 0.2268 (0.2969) acc_x 93.7500 (94.2188) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [25/34] time 0.348 (0.331) data 0.270 (0.253) loss_x loss_x 0.2878 (0.3076) acc_x 93.7500 (92.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/34] time 0.362 (0.334) data 0.285 (0.256) loss_x loss_x 0.4434 (0.3072) acc_x 90.6250 (92.8125) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 167
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1124
clean true:1122
clean false:2
clean_rate:0.998220640569395
noisy true:343
noisy false:165
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 508
epoch [195/200] batch [5/35] time 0.337 (0.348) data 0.259 (0.271) loss_x loss_x 0.1932 (0.1790) acc_x 96.8750 (98.1250) lr 6.0390e-06 eta 0:00:10
epoch [195/200] batch [10/35] time 0.308 (0.340) data 0.230 (0.262) loss_x loss_x 0.2335 (0.2392) acc_x 96.8750 (96.5625) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [15/35] time 0.361 (0.343) data 0.281 (0.265) loss_x loss_x 0.1740 (0.2674) acc_x 96.8750 (94.7917) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [20/35] time 0.360 (0.344) data 0.283 (0.266) loss_x loss_x 0.4250 (0.2971) acc_x 90.6250 (93.7500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [25/35] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.4165 (0.3169) acc_x 93.7500 (93.1250) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [30/35] time 0.347 (0.346) data 0.270 (0.268) loss_x loss_x 0.3943 (0.3053) acc_x 96.8750 (93.7500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [35/35] time 0.350 (0.347) data 0.273 (0.269) loss_x loss_x 0.1648 (0.2923) acc_x 100.0000 (94.0179) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:336
noisy false:176
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 512
epoch [196/200] batch [5/35] time 0.350 (0.344) data 0.272 (0.266) loss_x loss_x 0.1970 (0.3558) acc_x 93.7500 (90.6250) lr 4.4380e-06 eta 0:00:10
epoch [196/200] batch [10/35] time 0.344 (0.346) data 0.267 (0.268) loss_x loss_x 0.1434 (0.3402) acc_x 96.8750 (90.9375) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [15/35] time 0.340 (0.345) data 0.263 (0.267) loss_x loss_x 0.2207 (0.3455) acc_x 100.0000 (91.8750) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [20/35] time 0.308 (0.335) data 0.231 (0.258) loss_x loss_x 0.3000 (0.3299) acc_x 90.6250 (92.3438) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [25/35] time 0.336 (0.335) data 0.258 (0.257) loss_x loss_x 0.3552 (0.3274) acc_x 93.7500 (92.5000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [30/35] time 0.337 (0.336) data 0.260 (0.259) loss_x loss_x 0.1544 (0.3113) acc_x 100.0000 (93.1250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [35/35] time 0.352 (0.338) data 0.275 (0.261) loss_x loss_x 0.1448 (0.3043) acc_x 93.7500 (92.9464) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.6820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1113
clean true:1113
clean false:0
clean_rate:1.0
noisy true:339
noisy false:180
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 519
epoch [197/200] batch [5/34] time 0.355 (0.353) data 0.277 (0.275) loss_x loss_x 0.1392 (0.2957) acc_x 96.8750 (92.5000) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [10/34] time 0.339 (0.348) data 0.262 (0.270) loss_x loss_x 0.4302 (0.3101) acc_x 90.6250 (92.5000) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [15/34] time 0.362 (0.350) data 0.285 (0.273) loss_x loss_x 0.1104 (0.3168) acc_x 100.0000 (92.0833) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [20/34] time 0.309 (0.346) data 0.231 (0.269) loss_x loss_x 0.1422 (0.2992) acc_x 100.0000 (92.6562) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [25/34] time 0.354 (0.340) data 0.277 (0.263) loss_x loss_x 0.4971 (0.3134) acc_x 84.3750 (92.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [30/34] time 0.339 (0.342) data 0.261 (0.264) loss_x loss_x 0.4026 (0.3124) acc_x 90.6250 (92.9167) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 172
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1115
clean true:1114
clean false:1
clean_rate:0.9991031390134529
noisy true:346
noisy false:171
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 517
epoch [198/200] batch [5/34] time 0.333 (0.348) data 0.255 (0.270) loss_x loss_x 0.3408 (0.3030) acc_x 90.6250 (91.2500) lr 1.9733e-06 eta 0:00:10
epoch [198/200] batch [10/34] time 0.338 (0.343) data 0.260 (0.265) loss_x loss_x 0.3381 (0.2803) acc_x 90.6250 (92.8125) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [15/34] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.5049 (0.2937) acc_x 84.3750 (92.5000) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [20/34] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.4683 (0.3170) acc_x 87.5000 (91.8750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [25/34] time 0.322 (0.341) data 0.244 (0.264) loss_x loss_x 0.1907 (0.3028) acc_x 100.0000 (92.8750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [30/34] time 0.345 (0.338) data 0.267 (0.260) loss_x loss_x 0.1648 (0.2873) acc_x 100.0000 (93.5417) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 169
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1117
clean true:1116
clean false:1
clean_rate:0.999104744852283
noisy true:347
noisy false:168
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 515
epoch [199/200] batch [5/34] time 0.338 (0.349) data 0.261 (0.271) loss_x loss_x 0.1584 (0.3773) acc_x 96.8750 (92.5000) lr 1.1101e-06 eta 0:00:10
epoch [199/200] batch [10/34] time 0.368 (0.349) data 0.291 (0.272) loss_x loss_x 0.1515 (0.3262) acc_x 96.8750 (94.0625) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [15/34] time 0.342 (0.348) data 0.263 (0.270) loss_x loss_x 0.2197 (0.3114) acc_x 93.7500 (94.1667) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [20/34] time 0.347 (0.347) data 0.269 (0.269) loss_x loss_x 0.1813 (0.3063) acc_x 96.8750 (93.7500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [25/34] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.2639 (0.3167) acc_x 93.7500 (93.0000) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [30/34] time 0.328 (0.345) data 0.250 (0.267) loss_x loss_x 0.5083 (0.3249) acc_x 84.3750 (92.6042) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 165
confident_label rate tensor(0.6893, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1125
clean true:1125
clean false:0
clean_rate:1.0
noisy true:342
noisy false:165
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 507
epoch [200/200] batch [5/35] time 0.339 (0.343) data 0.261 (0.265) loss_x loss_x 0.3716 (0.3352) acc_x 93.7500 (93.1250) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [10/35] time 0.300 (0.332) data 0.223 (0.255) loss_x loss_x 0.1868 (0.2988) acc_x 96.8750 (93.7500) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [15/35] time 0.332 (0.335) data 0.255 (0.258) loss_x loss_x 0.3289 (0.3180) acc_x 96.8750 (93.3333) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [20/35] time 0.385 (0.337) data 0.306 (0.260) loss_x loss_x 0.2778 (0.3390) acc_x 93.7500 (92.0312) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [25/35] time 0.334 (0.337) data 0.256 (0.260) loss_x loss_x 0.2964 (0.3336) acc_x 96.8750 (92.1250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [30/35] time 0.367 (0.340) data 0.289 (0.262) loss_x loss_x 0.3904 (0.3203) acc_x 87.5000 (92.3958) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [35/35] time 0.337 (0.341) data 0.259 (0.263) loss_x loss_x 0.1486 (0.3325) acc_x 96.8750 (91.7857) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,239
* accuracy: 90.9%
* error: 9.1%
* macro_f1: 90.6%
Elapsed: 1:37:27
