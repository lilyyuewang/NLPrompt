***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.0895, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 146
clean true:140
clean false:6
clean_rate:0.958904109589041
noisy true:235
noisy false:1251
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 1486
epoch [1/200] batch [1/4] time 0.436 (0.436) data 0.263 (0.263) loss_x loss_x 3.1230 (3.1230) acc_x 15.6250 (15.6250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [2/4] time 0.297 (0.367) data 0.218 (0.241) loss_x loss_x 2.5273 (2.8252) acc_x 56.2500 (35.9375) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/4] time 0.291 (0.342) data 0.213 (0.231) loss_x loss_x 2.8574 (2.8359) acc_x 43.7500 (38.5417) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [4/4] time 0.355 (0.345) data 0.277 (0.243) loss_x loss_x 2.7832 (2.8228) acc_x 43.7500 (39.8438) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1221
confident_label rate tensor(0.1005, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 164
clean true:157
clean false:7
clean_rate:0.9573170731707317
noisy true:254
noisy false:1214
after delete: len(clean_dataset) 164
after delete: len(noisy_dataset) 1468
epoch [2/200] batch [5/5] time 0.363 (0.345) data 0.284 (0.267) loss_x loss_x 0.7676 (1.4902) acc_x 78.1250 (66.8750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 759
confident_label rate tensor(0.2004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 327
clean true:323
clean false:4
clean_rate:0.9877675840978594
noisy true:550
noisy false:755
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1305
epoch [3/200] batch [5/10] time 0.310 (0.348) data 0.232 (0.270) loss_x loss_x 1.2285 (1.1853) acc_x 75.0000 (68.1250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/10] time 0.352 (0.336) data 0.274 (0.258) loss_x loss_x 0.9209 (0.9893) acc_x 81.2500 (73.4375) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 751
confident_label rate tensor(0.2071, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 338
clean true:331
clean false:7
clean_rate:0.9792899408284024
noisy true:550
noisy false:744
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1294
epoch [4/200] batch [5/10] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.9648 (0.7939) acc_x 81.2500 (79.3750) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/10] time 0.313 (0.343) data 0.236 (0.265) loss_x loss_x 0.6543 (0.7761) acc_x 87.5000 (80.6250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 759
confident_label rate tensor(0.2102, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 343
clean true:337
clean false:6
clean_rate:0.9825072886297376
noisy true:536
noisy false:753
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1289
epoch [5/200] batch [5/10] time 0.361 (0.350) data 0.284 (0.272) loss_x loss_x 0.5820 (0.6979) acc_x 84.3750 (83.1250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/10] time 0.341 (0.350) data 0.263 (0.272) loss_x loss_x 0.7603 (0.7532) acc_x 81.2500 (80.0000) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 705
confident_label rate tensor(0.2157, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 352
clean true:348
clean false:4
clean_rate:0.9886363636363636
noisy true:579
noisy false:701
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1280
epoch [6/200] batch [5/11] time 0.346 (0.324) data 0.269 (0.246) loss_x loss_x 0.8027 (0.6842) acc_x 78.1250 (82.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/11] time 0.329 (0.334) data 0.251 (0.256) loss_x loss_x 0.7236 (0.7297) acc_x 84.3750 (81.5625) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 710
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 357
clean true:353
clean false:4
clean_rate:0.988795518207283
noisy true:569
noisy false:706
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1275
epoch [7/200] batch [5/11] time 0.352 (0.352) data 0.274 (0.275) loss_x loss_x 0.8779 (0.7085) acc_x 75.0000 (79.3750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/11] time 0.351 (0.360) data 0.274 (0.282) loss_x loss_x 0.7178 (0.6959) acc_x 84.3750 (81.2500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 696
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 355
clean true:351
clean false:4
clean_rate:0.9887323943661972
noisy true:585
noisy false:692
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1277
epoch [8/200] batch [5/11] time 0.344 (0.354) data 0.266 (0.276) loss_x loss_x 0.8169 (0.7863) acc_x 84.3750 (85.0000) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/11] time 0.350 (0.351) data 0.273 (0.273) loss_x loss_x 0.9458 (0.7363) acc_x 75.0000 (83.4375) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 697
confident_label rate tensor(0.2243, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 366
clean true:362
clean false:4
clean_rate:0.9890710382513661
noisy true:573
noisy false:693
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1266
epoch [9/200] batch [5/11] time 0.354 (0.353) data 0.276 (0.275) loss_x loss_x 0.6748 (0.6813) acc_x 71.8750 (80.0000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/11] time 0.334 (0.352) data 0.257 (0.274) loss_x loss_x 0.8345 (0.6869) acc_x 81.2500 (81.5625) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 703
confident_label rate tensor(0.2145, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 350
clean true:344
clean false:6
clean_rate:0.9828571428571429
noisy true:585
noisy false:697
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1282
epoch [10/200] batch [5/10] time 0.334 (0.345) data 0.256 (0.268) loss_x loss_x 1.2988 (0.8714) acc_x 68.7500 (82.5000) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/10] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.6992 (0.8494) acc_x 81.2500 (81.5625) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 665
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 356
clean true:353
clean false:3
clean_rate:0.9915730337078652
noisy true:614
noisy false:662
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1276
epoch [11/200] batch [5/11] time 0.324 (0.347) data 0.247 (0.270) loss_x loss_x 0.5444 (0.5603) acc_x 87.5000 (88.7500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/11] time 0.334 (0.346) data 0.256 (0.269) loss_x loss_x 0.5293 (0.6281) acc_x 84.3750 (86.5625) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 675
confident_label rate tensor(0.2377, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 388
clean true:384
clean false:4
clean_rate:0.9896907216494846
noisy true:573
noisy false:671
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1244
epoch [12/200] batch [5/12] time 0.335 (0.343) data 0.258 (0.265) loss_x loss_x 0.5000 (0.4829) acc_x 84.3750 (90.0000) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/12] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 1.0264 (0.6677) acc_x 62.5000 (84.0625) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 701
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:354
clean false:6
clean_rate:0.9833333333333333
noisy true:577
noisy false:695
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [13/200] batch [5/11] time 0.343 (0.335) data 0.266 (0.257) loss_x loss_x 0.7412 (0.6465) acc_x 78.1250 (83.7500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/11] time 0.332 (0.341) data 0.254 (0.263) loss_x loss_x 0.4600 (0.6992) acc_x 93.7500 (83.1250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 657
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:371
clean false:7
clean_rate:0.9814814814814815
noisy true:604
noisy false:650
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [14/200] batch [5/11] time 0.341 (0.350) data 0.264 (0.272) loss_x loss_x 0.4207 (0.5150) acc_x 87.5000 (88.7500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/11] time 0.296 (0.337) data 0.218 (0.259) loss_x loss_x 0.4189 (0.6166) acc_x 87.5000 (85.3125) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 676
confident_label rate tensor(0.2255, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 368
clean true:363
clean false:5
clean_rate:0.9864130434782609
noisy true:593
noisy false:671
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1264
epoch [15/200] batch [5/11] time 0.362 (0.353) data 0.285 (0.275) loss_x loss_x 0.5415 (0.5343) acc_x 90.6250 (86.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/11] time 0.331 (0.351) data 0.254 (0.273) loss_x loss_x 0.3425 (0.5331) acc_x 90.6250 (87.1875) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 660
confident_label rate tensor(0.2390, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 390
clean true:381
clean false:9
clean_rate:0.9769230769230769
noisy true:591
noisy false:651
after delete: len(clean_dataset) 390
after delete: len(noisy_dataset) 1242
epoch [16/200] batch [5/12] time 0.371 (0.363) data 0.294 (0.286) loss_x loss_x 0.6362 (0.5829) acc_x 84.3750 (86.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/12] time 0.327 (0.351) data 0.249 (0.274) loss_x loss_x 1.0391 (0.7322) acc_x 75.0000 (82.5000) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 659
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:376
clean false:8
clean_rate:0.9791666666666666
noisy true:597
noisy false:651
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [17/200] batch [5/12] time 0.365 (0.355) data 0.288 (0.278) loss_x loss_x 0.8008 (0.6681) acc_x 84.3750 (83.7500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/12] time 0.344 (0.351) data 0.267 (0.274) loss_x loss_x 0.7588 (0.7181) acc_x 81.2500 (84.6875) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 649
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:370
clean false:4
clean_rate:0.9893048128342246
noisy true:613
noisy false:645
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [18/200] batch [5/11] time 0.353 (0.348) data 0.276 (0.271) loss_x loss_x 0.4861 (0.6300) acc_x 84.3750 (83.1250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/11] time 0.332 (0.345) data 0.253 (0.267) loss_x loss_x 0.6938 (0.6497) acc_x 71.8750 (82.1875) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 649
confident_label rate tensor(0.2371, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 387
clean true:381
clean false:6
clean_rate:0.9844961240310077
noisy true:602
noisy false:643
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1245
epoch [19/200] batch [5/12] time 0.356 (0.333) data 0.279 (0.256) loss_x loss_x 0.4333 (0.4544) acc_x 87.5000 (89.3750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/12] time 0.306 (0.322) data 0.227 (0.244) loss_x loss_x 0.7334 (0.5319) acc_x 84.3750 (87.5000) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 649
confident_label rate tensor(0.2377, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 388
clean true:384
clean false:4
clean_rate:0.9896907216494846
noisy true:599
noisy false:645
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1244
epoch [20/200] batch [5/12] time 0.320 (0.333) data 0.242 (0.254) loss_x loss_x 0.7090 (0.5580) acc_x 81.2500 (86.8750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/12] time 0.340 (0.321) data 0.262 (0.243) loss_x loss_x 0.6909 (0.5304) acc_x 68.7500 (85.3125) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 643
confident_label rate tensor(0.2439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 398
clean true:387
clean false:11
clean_rate:0.9723618090452262
noisy true:602
noisy false:632
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1234
epoch [21/200] batch [5/12] time 0.339 (0.362) data 0.261 (0.285) loss_x loss_x 0.7017 (0.6744) acc_x 87.5000 (83.1250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/12] time 0.303 (0.341) data 0.224 (0.263) loss_x loss_x 0.5005 (0.6500) acc_x 93.7500 (83.7500) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 639
confident_label rate tensor(0.2445, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 399
clean true:391
clean false:8
clean_rate:0.9799498746867168
noisy true:602
noisy false:631
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1233
epoch [22/200] batch [5/12] time 0.325 (0.335) data 0.247 (0.258) loss_x loss_x 0.7803 (0.5837) acc_x 78.1250 (84.3750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/12] time 0.318 (0.322) data 0.240 (0.244) loss_x loss_x 0.5366 (0.6386) acc_x 84.3750 (84.6875) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 634
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 404
clean true:398
clean false:6
clean_rate:0.9851485148514851
noisy true:600
noisy false:628
after delete: len(clean_dataset) 404
after delete: len(noisy_dataset) 1228
epoch [23/200] batch [5/12] time 0.344 (0.344) data 0.266 (0.267) loss_x loss_x 0.4602 (0.6418) acc_x 87.5000 (86.2500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/12] time 0.348 (0.340) data 0.271 (0.263) loss_x loss_x 0.6753 (0.6438) acc_x 78.1250 (85.9375) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.2549, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 416
clean true:408
clean false:8
clean_rate:0.9807692307692307
noisy true:643
noisy false:573
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1216
epoch [24/200] batch [5/13] time 0.356 (0.332) data 0.279 (0.254) loss_x loss_x 0.7441 (0.6605) acc_x 81.2500 (80.6250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/13] time 0.349 (0.341) data 0.272 (0.263) loss_x loss_x 0.4414 (0.6427) acc_x 90.6250 (83.4375) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 605
confident_label rate tensor(0.2482, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 405
clean true:396
clean false:9
clean_rate:0.9777777777777777
noisy true:631
noisy false:596
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1227
epoch [25/200] batch [5/12] time 0.313 (0.320) data 0.234 (0.242) loss_x loss_x 0.4282 (0.5465) acc_x 87.5000 (85.6250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/12] time 0.336 (0.329) data 0.258 (0.251) loss_x loss_x 0.3940 (0.5624) acc_x 90.6250 (86.8750) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 606
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 419
clean true:406
clean false:13
clean_rate:0.9689737470167065
noisy true:620
noisy false:593
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1213
epoch [26/200] batch [5/13] time 0.370 (0.328) data 0.291 (0.250) loss_x loss_x 0.2539 (0.6184) acc_x 100.0000 (84.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/13] time 0.346 (0.329) data 0.269 (0.252) loss_x loss_x 0.7588 (0.6277) acc_x 81.2500 (84.3750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 598
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 421
clean true:412
clean false:9
clean_rate:0.9786223277909739
noisy true:622
noisy false:589
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1211
epoch [27/200] batch [5/13] time 0.338 (0.334) data 0.260 (0.257) loss_x loss_x 0.9194 (0.5567) acc_x 68.7500 (85.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/13] time 0.315 (0.327) data 0.236 (0.249) loss_x loss_x 0.3147 (0.4794) acc_x 96.8750 (88.7500) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 570
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 430
clean true:420
clean false:10
clean_rate:0.9767441860465116
noisy true:642
noisy false:560
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1202
epoch [28/200] batch [5/13] time 0.354 (0.347) data 0.277 (0.269) loss_x loss_x 0.6753 (0.5487) acc_x 84.3750 (87.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/13] time 0.353 (0.344) data 0.275 (0.266) loss_x loss_x 0.4221 (0.5279) acc_x 87.5000 (89.3750) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 584
confident_label rate tensor(0.2629, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 429
clean true:417
clean false:12
clean_rate:0.972027972027972
noisy true:631
noisy false:572
after delete: len(clean_dataset) 429
after delete: len(noisy_dataset) 1203
epoch [29/200] batch [5/13] time 0.325 (0.342) data 0.247 (0.265) loss_x loss_x 0.5352 (0.4721) acc_x 84.3750 (85.6250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/13] time 0.331 (0.330) data 0.254 (0.252) loss_x loss_x 0.4504 (0.5278) acc_x 90.6250 (87.1875) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 545
confident_label rate tensor(0.2647, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 432
clean true:418
clean false:14
clean_rate:0.9675925925925926
noisy true:669
noisy false:531
after delete: len(clean_dataset) 432
after delete: len(noisy_dataset) 1200
epoch [30/200] batch [5/13] time 0.342 (0.341) data 0.264 (0.263) loss_x loss_x 0.5977 (0.6041) acc_x 87.5000 (87.5000) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/13] time 0.352 (0.346) data 0.274 (0.268) loss_x loss_x 0.7144 (0.5846) acc_x 78.1250 (86.2500) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 540
confident_label rate tensor(0.2770, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 452
clean true:445
clean false:7
clean_rate:0.9845132743362832
noisy true:647
noisy false:533
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1180
epoch [31/200] batch [5/14] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.9468 (0.6958) acc_x 81.2500 (84.3750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/14] time 0.417 (0.360) data 0.339 (0.282) loss_x loss_x 0.4084 (0.6072) acc_x 90.6250 (85.9375) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.2727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 445
clean true:435
clean false:10
clean_rate:0.9775280898876404
noisy true:647
noisy false:540
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1187
epoch [32/200] batch [5/13] time 0.357 (0.354) data 0.280 (0.276) loss_x loss_x 0.6636 (0.5874) acc_x 84.3750 (87.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/13] time 0.341 (0.351) data 0.263 (0.274) loss_x loss_x 0.6704 (0.6669) acc_x 78.1250 (84.6875) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 536
confident_label rate tensor(0.2727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 445
clean true:432
clean false:13
clean_rate:0.9707865168539326
noisy true:664
noisy false:523
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1187
epoch [33/200] batch [5/13] time 0.342 (0.356) data 0.264 (0.278) loss_x loss_x 0.4502 (0.6292) acc_x 84.3750 (87.5000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/13] time 0.343 (0.353) data 0.266 (0.276) loss_x loss_x 0.6113 (0.5757) acc_x 84.3750 (87.5000) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 551
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 447
clean true:432
clean false:15
clean_rate:0.9664429530201343
noisy true:649
noisy false:536
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1185
epoch [34/200] batch [5/13] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.7563 (0.5871) acc_x 78.1250 (85.6250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/13] time 0.339 (0.344) data 0.261 (0.266) loss_x loss_x 0.6860 (0.5884) acc_x 87.5000 (85.9375) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 548
confident_label rate tensor(0.2763, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 451
clean true:439
clean false:12
clean_rate:0.9733924611973392
noisy true:645
noisy false:536
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1181
epoch [35/200] batch [5/14] time 0.335 (0.332) data 0.258 (0.254) loss_x loss_x 0.5244 (0.6687) acc_x 81.2500 (81.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/14] time 0.379 (0.337) data 0.301 (0.260) loss_x loss_x 0.4385 (0.6834) acc_x 81.2500 (80.6250) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 526
confident_label rate tensor(0.2776, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 453
clean true:438
clean false:15
clean_rate:0.9668874172185431
noisy true:668
noisy false:511
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1179
epoch [36/200] batch [5/14] time 0.347 (0.353) data 0.269 (0.275) loss_x loss_x 0.5752 (0.5814) acc_x 81.2500 (83.7500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/14] time 0.350 (0.338) data 0.273 (0.261) loss_x loss_x 0.6650 (0.6032) acc_x 84.3750 (84.3750) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 532
confident_label rate tensor(0.2868, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 468
clean true:451
clean false:17
clean_rate:0.9636752136752137
noisy true:649
noisy false:515
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1164
epoch [37/200] batch [5/14] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.6318 (0.5834) acc_x 81.2500 (85.0000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/14] time 0.371 (0.340) data 0.292 (0.262) loss_x loss_x 0.4272 (0.5737) acc_x 84.3750 (83.7500) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 516
confident_label rate tensor(0.2751, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 449
clean true:434
clean false:15
clean_rate:0.9665924276169265
noisy true:682
noisy false:501
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1183
epoch [38/200] batch [5/14] time 0.339 (0.342) data 0.262 (0.264) loss_x loss_x 0.4185 (0.5065) acc_x 90.6250 (90.6250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/14] time 0.315 (0.334) data 0.236 (0.256) loss_x loss_x 0.9146 (0.6084) acc_x 78.1250 (86.5625) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.2880, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 470
clean true:456
clean false:14
clean_rate:0.9702127659574468
noisy true:694
noisy false:468
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1162
epoch [39/200] batch [5/14] time 0.324 (0.329) data 0.245 (0.251) loss_x loss_x 0.7485 (0.6150) acc_x 78.1250 (83.7500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/14] time 0.341 (0.342) data 0.264 (0.265) loss_x loss_x 0.8545 (0.6162) acc_x 81.2500 (84.3750) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 490
confident_label rate tensor(0.2935, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 479
clean true:466
clean false:13
clean_rate:0.9728601252609603
noisy true:676
noisy false:477
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1153
epoch [40/200] batch [5/14] time 0.351 (0.344) data 0.274 (0.266) loss_x loss_x 0.4038 (0.6298) acc_x 87.5000 (84.3750) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/14] time 0.347 (0.343) data 0.270 (0.265) loss_x loss_x 0.6343 (0.6537) acc_x 87.5000 (84.3750) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 493
confident_label rate tensor(0.3015, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 492
clean true:479
clean false:13
clean_rate:0.9735772357723578
noisy true:660
noisy false:480
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1140
epoch [41/200] batch [5/15] time 0.329 (0.348) data 0.251 (0.271) loss_x loss_x 0.7827 (0.5440) acc_x 78.1250 (85.0000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/15] time 0.348 (0.344) data 0.271 (0.266) loss_x loss_x 0.7495 (0.5931) acc_x 78.1250 (84.3750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/15] time 0.326 (0.342) data 0.249 (0.264) loss_x loss_x 0.6030 (0.6021) acc_x 87.5000 (84.7917) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 486
confident_label rate tensor(0.2929, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 478
clean true:465
clean false:13
clean_rate:0.9728033472803347
noisy true:681
noisy false:473
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1154
epoch [42/200] batch [5/14] time 0.344 (0.344) data 0.267 (0.266) loss_x loss_x 0.6826 (0.5298) acc_x 87.5000 (88.7500) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/14] time 0.358 (0.346) data 0.281 (0.268) loss_x loss_x 0.5122 (0.5142) acc_x 84.3750 (87.1875) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 484
confident_label rate tensor(0.2947, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 481
clean true:468
clean false:13
clean_rate:0.972972972972973
noisy true:680
noisy false:471
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1151
epoch [43/200] batch [5/15] time 0.312 (0.324) data 0.234 (0.246) loss_x loss_x 0.5479 (0.6212) acc_x 84.3750 (85.6250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/15] time 0.337 (0.340) data 0.260 (0.262) loss_x loss_x 0.5288 (0.6357) acc_x 90.6250 (85.0000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/15] time 0.357 (0.343) data 0.280 (0.265) loss_x loss_x 0.5093 (0.6017) acc_x 93.7500 (86.4583) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 481
confident_label rate tensor(0.2972, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 485
clean true:471
clean false:14
clean_rate:0.9711340206185567
noisy true:680
noisy false:467
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1147
epoch [44/200] batch [5/15] time 0.338 (0.346) data 0.260 (0.268) loss_x loss_x 0.6484 (0.5389) acc_x 81.2500 (85.0000) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/15] time 0.330 (0.343) data 0.252 (0.265) loss_x loss_x 0.3767 (0.4497) acc_x 90.6250 (88.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/15] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.8960 (0.4838) acc_x 81.2500 (88.9583) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.3058, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 499
clean true:484
clean false:15
clean_rate:0.969939879759519
noisy true:692
noisy false:441
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1133
epoch [45/200] batch [5/15] time 0.343 (0.349) data 0.266 (0.271) loss_x loss_x 0.5713 (0.5260) acc_x 87.5000 (86.2500) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/15] time 0.350 (0.347) data 0.272 (0.270) loss_x loss_x 0.5317 (0.5937) acc_x 87.5000 (84.6875) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/15] time 0.322 (0.344) data 0.244 (0.266) loss_x loss_x 0.1659 (0.6044) acc_x 100.0000 (85.2083) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.2953, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 482
clean true:465
clean false:17
clean_rate:0.9647302904564315
noisy true:695
noisy false:455
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1150
epoch [46/200] batch [5/15] time 0.325 (0.332) data 0.247 (0.254) loss_x loss_x 0.6475 (0.4885) acc_x 84.3750 (86.2500) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/15] time 0.372 (0.340) data 0.294 (0.262) loss_x loss_x 0.4673 (0.4624) acc_x 87.5000 (88.1250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/15] time 0.301 (0.330) data 0.223 (0.253) loss_x loss_x 0.2756 (0.4337) acc_x 96.8750 (90.2083) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 499
confident_label rate tensor(0.3015, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 492
clean true:469
clean false:23
clean_rate:0.9532520325203252
noisy true:664
noisy false:476
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1140
epoch [47/200] batch [5/15] time 0.352 (0.346) data 0.274 (0.268) loss_x loss_x 0.5415 (0.5230) acc_x 78.1250 (85.0000) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/15] time 0.334 (0.345) data 0.256 (0.267) loss_x loss_x 0.4514 (0.4816) acc_x 87.5000 (87.1875) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/15] time 0.295 (0.335) data 0.217 (0.258) loss_x loss_x 0.4375 (0.5142) acc_x 87.5000 (86.2500) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 442
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 506
clean true:484
clean false:22
clean_rate:0.9565217391304348
noisy true:706
noisy false:420
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1126
epoch [48/200] batch [5/15] time 0.343 (0.351) data 0.266 (0.274) loss_x loss_x 0.4026 (0.4842) acc_x 90.6250 (91.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/15] time 0.353 (0.348) data 0.275 (0.271) loss_x loss_x 0.3140 (0.4506) acc_x 90.6250 (90.6250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/15] time 0.296 (0.336) data 0.218 (0.258) loss_x loss_x 0.4788 (0.4717) acc_x 87.5000 (90.0000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.2990, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 488
clean true:464
clean false:24
clean_rate:0.9508196721311475
noisy true:692
noisy false:452
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1144
epoch [49/200] batch [5/15] time 0.347 (0.361) data 0.269 (0.283) loss_x loss_x 0.5249 (0.4085) acc_x 90.6250 (91.2500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/15] time 0.297 (0.338) data 0.219 (0.260) loss_x loss_x 0.4001 (0.4677) acc_x 87.5000 (88.7500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/15] time 0.324 (0.335) data 0.246 (0.257) loss_x loss_x 0.4150 (0.4694) acc_x 93.7500 (89.7917) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 458
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 504
clean true:481
clean false:23
clean_rate:0.9543650793650794
noisy true:693
noisy false:435
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1128
epoch [50/200] batch [5/15] time 0.317 (0.314) data 0.239 (0.236) loss_x loss_x 0.3914 (0.4722) acc_x 93.7500 (90.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/15] time 0.351 (0.328) data 0.274 (0.250) loss_x loss_x 0.2377 (0.4143) acc_x 93.7500 (91.2500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/15] time 0.327 (0.331) data 0.249 (0.254) loss_x loss_x 0.8691 (0.4199) acc_x 78.1250 (90.8333) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 457
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 512
clean true:484
clean false:28
clean_rate:0.9453125
noisy true:691
noisy false:429
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1120
epoch [51/200] batch [5/16] time 0.352 (0.329) data 0.274 (0.251) loss_x loss_x 0.4451 (0.5392) acc_x 93.7500 (86.8750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/16] time 0.324 (0.334) data 0.247 (0.256) loss_x loss_x 0.4590 (0.5663) acc_x 90.6250 (85.6250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/16] time 0.325 (0.338) data 0.248 (0.260) loss_x loss_x 0.3889 (0.5366) acc_x 93.7500 (87.2917) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 450
confident_label rate tensor(0.3082, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 503
clean true:482
clean false:21
clean_rate:0.9582504970178927
noisy true:700
noisy false:429
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1129
epoch [52/200] batch [5/15] time 0.346 (0.358) data 0.268 (0.280) loss_x loss_x 0.3843 (0.6204) acc_x 93.7500 (87.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/15] time 0.347 (0.352) data 0.269 (0.274) loss_x loss_x 0.5093 (0.5275) acc_x 87.5000 (88.4375) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/15] time 0.348 (0.342) data 0.270 (0.264) loss_x loss_x 0.4492 (0.5416) acc_x 93.7500 (88.3333) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 431
confident_label rate tensor(0.3143, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 513
clean true:489
clean false:24
clean_rate:0.9532163742690059
noisy true:712
noisy false:407
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1119
epoch [53/200] batch [5/16] time 0.317 (0.335) data 0.238 (0.257) loss_x loss_x 0.4531 (0.4926) acc_x 87.5000 (86.2500) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/16] time 0.365 (0.334) data 0.288 (0.256) loss_x loss_x 0.3350 (0.4659) acc_x 93.7500 (87.8125) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/16] time 0.342 (0.338) data 0.264 (0.260) loss_x loss_x 0.8008 (0.4762) acc_x 81.2500 (87.0833) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 448
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 508
clean true:482
clean false:26
clean_rate:0.9488188976377953
noisy true:702
noisy false:422
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1124
epoch [54/200] batch [5/15] time 0.356 (0.349) data 0.279 (0.272) loss_x loss_x 0.5913 (0.5884) acc_x 84.3750 (87.5000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/15] time 0.338 (0.347) data 0.260 (0.269) loss_x loss_x 0.2969 (0.5011) acc_x 93.7500 (88.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/15] time 0.340 (0.349) data 0.262 (0.271) loss_x loss_x 0.6719 (0.4951) acc_x 78.1250 (88.3333) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 409
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 510
clean true:491
clean false:19
clean_rate:0.9627450980392157
noisy true:732
noisy false:390
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1122
epoch [55/200] batch [5/15] time 0.351 (0.354) data 0.273 (0.276) loss_x loss_x 0.5557 (0.4677) acc_x 87.5000 (90.6250) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/15] time 0.339 (0.351) data 0.261 (0.273) loss_x loss_x 0.5762 (0.4539) acc_x 87.5000 (90.3125) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/15] time 0.350 (0.347) data 0.273 (0.270) loss_x loss_x 0.4919 (0.4298) acc_x 81.2500 (90.4167) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3107, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 507
clean true:484
clean false:23
clean_rate:0.9546351084812623
noisy true:696
noisy false:429
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1125
epoch [56/200] batch [5/15] time 0.332 (0.347) data 0.255 (0.269) loss_x loss_x 0.4221 (0.4143) acc_x 90.6250 (90.0000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/15] time 0.356 (0.347) data 0.279 (0.269) loss_x loss_x 0.3071 (0.4627) acc_x 93.7500 (87.5000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/15] time 0.336 (0.345) data 0.258 (0.267) loss_x loss_x 0.6025 (0.4593) acc_x 87.5000 (88.1250) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 440
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 512
clean true:487
clean false:25
clean_rate:0.951171875
noisy true:705
noisy false:415
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1120
epoch [57/200] batch [5/16] time 0.354 (0.347) data 0.277 (0.270) loss_x loss_x 0.4636 (0.3832) acc_x 93.7500 (93.1250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/16] time 0.344 (0.346) data 0.267 (0.268) loss_x loss_x 0.5044 (0.4192) acc_x 93.7500 (92.8125) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/16] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.4714 (0.4673) acc_x 84.3750 (90.4167) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 512
clean true:487
clean false:25
clean_rate:0.951171875
noisy true:715
noisy false:405
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1120
epoch [58/200] batch [5/16] time 0.345 (0.343) data 0.267 (0.266) loss_x loss_x 0.2764 (0.5372) acc_x 100.0000 (90.0000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/16] time 0.356 (0.332) data 0.279 (0.255) loss_x loss_x 0.2407 (0.4821) acc_x 96.8750 (90.9375) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/16] time 0.328 (0.334) data 0.250 (0.257) loss_x loss_x 0.3223 (0.4806) acc_x 90.6250 (90.0000) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 431
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 517
clean true:490
clean false:27
clean_rate:0.9477756286266924
noisy true:711
noisy false:404
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1115
epoch [59/200] batch [5/16] time 0.343 (0.351) data 0.266 (0.273) loss_x loss_x 0.2086 (0.3417) acc_x 96.8750 (90.0000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/16] time 0.337 (0.345) data 0.260 (0.267) loss_x loss_x 0.5044 (0.4784) acc_x 87.5000 (88.1250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/16] time 0.335 (0.342) data 0.258 (0.264) loss_x loss_x 0.3938 (0.4776) acc_x 93.7500 (88.1250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 516
clean true:499
clean false:17
clean_rate:0.9670542635658915
noisy true:726
noisy false:390
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1116
epoch [60/200] batch [5/16] time 0.355 (0.353) data 0.278 (0.275) loss_x loss_x 0.3557 (0.4733) acc_x 93.7500 (88.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/16] time 0.343 (0.349) data 0.266 (0.271) loss_x loss_x 0.4636 (0.5447) acc_x 93.7500 (87.8125) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/16] time 0.344 (0.349) data 0.267 (0.271) loss_x loss_x 0.6670 (0.5329) acc_x 81.2500 (87.7083) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 424
confident_label rate tensor(0.3064, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 500
clean true:479
clean false:21
clean_rate:0.958
noisy true:729
noisy false:403
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1132
epoch [61/200] batch [5/15] time 0.340 (0.349) data 0.262 (0.272) loss_x loss_x 0.5869 (0.4232) acc_x 90.6250 (90.0000) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/15] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.4934 (0.4689) acc_x 84.3750 (87.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/15] time 0.335 (0.338) data 0.258 (0.260) loss_x loss_x 0.3652 (0.3956) acc_x 93.7500 (90.8333) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 427
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 522
clean true:496
clean false:26
clean_rate:0.9501915708812261
noisy true:709
noisy false:401
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1110
epoch [62/200] batch [5/16] time 0.335 (0.347) data 0.257 (0.270) loss_x loss_x 0.4678 (0.5030) acc_x 90.6250 (90.6250) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/16] time 0.340 (0.350) data 0.263 (0.272) loss_x loss_x 0.4500 (0.5189) acc_x 90.6250 (87.8125) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/16] time 0.333 (0.351) data 0.255 (0.273) loss_x loss_x 1.1846 (0.5317) acc_x 68.7500 (87.7083) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 438
confident_label rate tensor(0.3223, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 526
clean true:503
clean false:23
clean_rate:0.9562737642585551
noisy true:691
noisy false:415
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1106
epoch [63/200] batch [5/16] time 0.343 (0.354) data 0.266 (0.277) loss_x loss_x 0.4065 (0.4081) acc_x 93.7500 (91.8750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/16] time 0.351 (0.353) data 0.273 (0.275) loss_x loss_x 0.2192 (0.3839) acc_x 96.8750 (91.2500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/16] time 0.365 (0.347) data 0.288 (0.269) loss_x loss_x 0.2336 (0.4137) acc_x 96.8750 (90.2083) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 413
confident_label rate tensor(0.3241, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 529
clean true:506
clean false:23
clean_rate:0.9565217391304348
noisy true:713
noisy false:390
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1103
epoch [64/200] batch [5/16] time 0.346 (0.342) data 0.268 (0.263) loss_x loss_x 0.3333 (0.3828) acc_x 93.7500 (91.2500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/16] time 0.342 (0.342) data 0.264 (0.264) loss_x loss_x 0.4106 (0.4615) acc_x 90.6250 (90.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/16] time 0.328 (0.341) data 0.250 (0.263) loss_x loss_x 0.2490 (0.4383) acc_x 93.7500 (90.2083) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.3254, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 531
clean true:503
clean false:28
clean_rate:0.9472693032015066
noisy true:734
noisy false:367
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1101
epoch [65/200] batch [5/16] time 0.350 (0.350) data 0.273 (0.272) loss_x loss_x 0.5786 (0.5166) acc_x 87.5000 (85.6250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/16] time 0.312 (0.336) data 0.233 (0.258) loss_x loss_x 0.5396 (0.4615) acc_x 87.5000 (87.1875) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/16] time 0.341 (0.335) data 0.263 (0.257) loss_x loss_x 0.7876 (0.5567) acc_x 84.3750 (86.0417) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.3266, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 533
clean true:509
clean false:24
clean_rate:0.9549718574108818
noisy true:723
noisy false:376
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1099
epoch [66/200] batch [5/16] time 0.358 (0.344) data 0.281 (0.265) loss_x loss_x 0.1214 (0.4480) acc_x 100.0000 (90.6250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/16] time 0.314 (0.339) data 0.235 (0.261) loss_x loss_x 0.3318 (0.4937) acc_x 96.8750 (88.7500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/16] time 0.379 (0.342) data 0.300 (0.264) loss_x loss_x 0.3867 (0.5256) acc_x 93.7500 (87.9167) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.3217, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 525
clean true:500
clean false:25
clean_rate:0.9523809523809523
noisy true:702
noisy false:405
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1107
epoch [67/200] batch [5/16] time 0.342 (0.330) data 0.263 (0.251) loss_x loss_x 0.4114 (0.3167) acc_x 87.5000 (92.5000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/16] time 0.345 (0.337) data 0.267 (0.259) loss_x loss_x 0.3962 (0.3702) acc_x 90.6250 (91.8750) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/16] time 0.348 (0.342) data 0.271 (0.264) loss_x loss_x 0.2988 (0.3805) acc_x 93.7500 (91.0417) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.3284, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 536
clean true:510
clean false:26
clean_rate:0.9514925373134329
noisy true:730
noisy false:366
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 1096
epoch [68/200] batch [5/16] time 0.323 (0.348) data 0.246 (0.270) loss_x loss_x 0.3257 (0.4677) acc_x 96.8750 (90.0000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/16] time 0.337 (0.341) data 0.259 (0.264) loss_x loss_x 0.5317 (0.4773) acc_x 87.5000 (90.0000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/16] time 0.293 (0.335) data 0.215 (0.257) loss_x loss_x 0.4526 (0.5141) acc_x 93.7500 (88.9583) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 420
confident_label rate tensor(0.3229, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 527
clean true:504
clean false:23
clean_rate:0.9563567362428842
noisy true:708
noisy false:397
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1105
epoch [69/200] batch [5/16] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.6060 (0.4143) acc_x 84.3750 (91.8750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/16] time 0.312 (0.340) data 0.234 (0.263) loss_x loss_x 0.4336 (0.4367) acc_x 87.5000 (90.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/16] time 0.343 (0.332) data 0.265 (0.254) loss_x loss_x 0.4502 (0.4090) acc_x 93.7500 (91.2500) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.3217, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 525
clean true:498
clean false:27
clean_rate:0.9485714285714286
noisy true:731
noisy false:376
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1107
epoch [70/200] batch [5/16] time 0.304 (0.336) data 0.226 (0.258) loss_x loss_x 0.3733 (0.3669) acc_x 87.5000 (90.0000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/16] time 0.306 (0.323) data 0.229 (0.245) loss_x loss_x 0.7686 (0.4082) acc_x 81.2500 (90.3125) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/16] time 0.343 (0.329) data 0.265 (0.252) loss_x loss_x 0.2959 (0.4675) acc_x 90.6250 (89.7917) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.3266, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 533
clean true:507
clean false:26
clean_rate:0.9512195121951219
noisy true:730
noisy false:369
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1099
epoch [71/200] batch [5/16] time 0.324 (0.321) data 0.246 (0.242) loss_x loss_x 0.2764 (0.4496) acc_x 96.8750 (90.0000) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/16] time 0.334 (0.332) data 0.256 (0.254) loss_x loss_x 0.3281 (0.4045) acc_x 93.7500 (90.9375) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/16] time 0.330 (0.335) data 0.253 (0.257) loss_x loss_x 0.4241 (0.4219) acc_x 90.6250 (90.8333) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 424
confident_label rate tensor(0.3248, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 530
clean true:497
clean false:33
clean_rate:0.9377358490566038
noisy true:711
noisy false:391
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1102
epoch [72/200] batch [5/16] time 0.350 (0.349) data 0.273 (0.271) loss_x loss_x 0.4075 (0.4403) acc_x 90.6250 (90.0000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/16] time 0.347 (0.345) data 0.268 (0.267) loss_x loss_x 0.3325 (0.3840) acc_x 93.7500 (90.9375) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/16] time 0.345 (0.338) data 0.268 (0.260) loss_x loss_x 0.5552 (0.4045) acc_x 87.5000 (91.0417) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.3260, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 532
clean true:508
clean false:24
clean_rate:0.9548872180451128
noisy true:737
noisy false:363
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1100
epoch [73/200] batch [5/16] time 0.340 (0.336) data 0.262 (0.258) loss_x loss_x 0.5718 (0.4475) acc_x 87.5000 (90.6250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/16] time 0.354 (0.339) data 0.275 (0.261) loss_x loss_x 0.3320 (0.3738) acc_x 90.6250 (93.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/16] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.3740 (0.4059) acc_x 90.6250 (91.0417) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 436
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 522
clean true:493
clean false:29
clean_rate:0.9444444444444444
noisy true:703
noisy false:407
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1110
epoch [74/200] batch [5/16] time 0.335 (0.352) data 0.257 (0.274) loss_x loss_x 0.6084 (0.5207) acc_x 84.3750 (89.3750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/16] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.4346 (0.4371) acc_x 90.6250 (90.3125) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/16] time 0.326 (0.344) data 0.248 (0.266) loss_x loss_x 0.7363 (0.4803) acc_x 84.3750 (89.1667) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 386
confident_label rate tensor(0.3241, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 529
clean true:501
clean false:28
clean_rate:0.947069943289225
noisy true:745
noisy false:358
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1103
epoch [75/200] batch [5/16] time 0.359 (0.356) data 0.281 (0.279) loss_x loss_x 0.5332 (0.4134) acc_x 81.2500 (89.3750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/16] time 0.343 (0.351) data 0.266 (0.273) loss_x loss_x 0.3101 (0.3655) acc_x 96.8750 (91.2500) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/16] time 0.355 (0.350) data 0.277 (0.272) loss_x loss_x 0.4951 (0.3746) acc_x 87.5000 (91.4583) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 548
clean true:517
clean false:31
clean_rate:0.9434306569343066
noisy true:713
noisy false:371
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1084
epoch [76/200] batch [5/17] time 0.352 (0.354) data 0.275 (0.277) loss_x loss_x 0.3052 (0.3435) acc_x 90.6250 (92.5000) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/17] time 0.338 (0.350) data 0.261 (0.273) loss_x loss_x 0.3948 (0.4252) acc_x 90.6250 (90.3125) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/17] time 0.349 (0.350) data 0.271 (0.272) loss_x loss_x 0.4470 (0.4118) acc_x 87.5000 (90.4167) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.3309, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 540
clean true:511
clean false:29
clean_rate:0.9462962962962963
noisy true:734
noisy false:358
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1092
epoch [77/200] batch [5/16] time 0.348 (0.351) data 0.270 (0.274) loss_x loss_x 0.6113 (0.4062) acc_x 84.3750 (91.8750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/16] time 0.341 (0.347) data 0.264 (0.270) loss_x loss_x 0.3691 (0.3928) acc_x 93.7500 (92.5000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/16] time 0.336 (0.348) data 0.258 (0.271) loss_x loss_x 0.2180 (0.3852) acc_x 100.0000 (92.9167) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.3272, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 534
clean true:508
clean false:26
clean_rate:0.951310861423221
noisy true:729
noisy false:369
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1098
epoch [78/200] batch [5/16] time 0.359 (0.369) data 0.281 (0.290) loss_x loss_x 0.5156 (0.3984) acc_x 90.6250 (92.5000) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/16] time 0.316 (0.353) data 0.237 (0.275) loss_x loss_x 0.3328 (0.4422) acc_x 93.7500 (90.9375) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/16] time 0.321 (0.342) data 0.242 (0.264) loss_x loss_x 0.4797 (0.4030) acc_x 93.7500 (92.0833) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.3376, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 551
clean true:523
clean false:28
clean_rate:0.9491833030852994
noisy true:716
noisy false:365
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1081
epoch [79/200] batch [5/17] time 0.342 (0.347) data 0.264 (0.270) loss_x loss_x 0.3923 (0.3231) acc_x 87.5000 (92.5000) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/17] time 0.318 (0.343) data 0.240 (0.266) loss_x loss_x 0.1682 (0.3825) acc_x 96.8750 (91.8750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/17] time 0.301 (0.331) data 0.222 (0.253) loss_x loss_x 0.3611 (0.3787) acc_x 90.6250 (92.0833) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 379
confident_label rate tensor(0.3352, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 547
clean true:521
clean false:26
clean_rate:0.9524680073126143
noisy true:732
noisy false:353
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1085
epoch [80/200] batch [5/17] time 0.344 (0.350) data 0.267 (0.272) loss_x loss_x 0.4956 (0.5848) acc_x 84.3750 (86.8750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/17] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.4526 (0.5733) acc_x 90.6250 (86.2500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/17] time 0.304 (0.331) data 0.226 (0.253) loss_x loss_x 0.3765 (0.5422) acc_x 93.7500 (87.2917) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 385
confident_label rate tensor(0.3339, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 545
clean true:517
clean false:28
clean_rate:0.9486238532110092
noisy true:730
noisy false:357
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1087
epoch [81/200] batch [5/17] time 0.360 (0.373) data 0.283 (0.295) loss_x loss_x 0.4028 (0.2986) acc_x 90.6250 (94.3750) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/17] time 0.310 (0.342) data 0.233 (0.265) loss_x loss_x 0.1271 (0.3186) acc_x 96.8750 (93.7500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/17] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.4702 (0.3623) acc_x 81.2500 (91.4583) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 399
confident_label rate tensor(0.3309, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 540
clean true:507
clean false:33
clean_rate:0.9388888888888889
noisy true:726
noisy false:366
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1092
epoch [82/200] batch [5/16] time 0.350 (0.336) data 0.272 (0.259) loss_x loss_x 0.5981 (0.4421) acc_x 84.3750 (89.3750) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/16] time 0.334 (0.340) data 0.256 (0.263) loss_x loss_x 0.6221 (0.4738) acc_x 84.3750 (89.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/16] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.3931 (0.4602) acc_x 90.6250 (89.5833) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 390
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 549
clean true:515
clean false:34
clean_rate:0.9380692167577414
noisy true:727
noisy false:356
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1083
epoch [83/200] batch [5/17] time 0.316 (0.342) data 0.238 (0.264) loss_x loss_x 0.2915 (0.3445) acc_x 90.6250 (91.2500) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/17] time 0.358 (0.345) data 0.280 (0.267) loss_x loss_x 0.3999 (0.3628) acc_x 90.6250 (92.1875) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/17] time 0.343 (0.345) data 0.265 (0.268) loss_x loss_x 0.2112 (0.3830) acc_x 96.8750 (92.0833) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.3303, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 539
clean true:505
clean false:34
clean_rate:0.9369202226345084
noisy true:732
noisy false:361
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1093
epoch [84/200] batch [5/16] time 0.330 (0.345) data 0.253 (0.267) loss_x loss_x 0.3022 (0.3857) acc_x 96.8750 (91.8750) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/16] time 0.336 (0.345) data 0.259 (0.267) loss_x loss_x 0.2893 (0.3699) acc_x 93.7500 (92.8125) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/16] time 0.334 (0.343) data 0.256 (0.266) loss_x loss_x 0.5874 (0.4152) acc_x 87.5000 (90.6250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.3327, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 543
clean true:513
clean false:30
clean_rate:0.9447513812154696
noisy true:718
noisy false:371
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1089
epoch [85/200] batch [5/16] time 0.324 (0.349) data 0.246 (0.271) loss_x loss_x 0.3835 (0.3585) acc_x 93.7500 (93.1250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/16] time 0.343 (0.347) data 0.266 (0.269) loss_x loss_x 0.4075 (0.3832) acc_x 93.7500 (92.8125) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/16] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.2964 (0.3541) acc_x 96.8750 (92.7083) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 397
confident_label rate tensor(0.3290, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 537
clean true:503
clean false:34
clean_rate:0.9366852886405959
noisy true:732
noisy false:363
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1095
epoch [86/200] batch [5/16] time 0.352 (0.348) data 0.275 (0.270) loss_x loss_x 0.4919 (0.4331) acc_x 84.3750 (90.0000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/16] time 0.346 (0.344) data 0.268 (0.266) loss_x loss_x 0.5312 (0.4193) acc_x 84.3750 (89.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/16] time 0.329 (0.344) data 0.251 (0.267) loss_x loss_x 0.4553 (0.4194) acc_x 87.5000 (89.3750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 396
confident_label rate tensor(0.3339, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 545
clean true:509
clean false:36
clean_rate:0.9339449541284404
noisy true:727
noisy false:360
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1087
epoch [87/200] batch [5/17] time 0.351 (0.358) data 0.272 (0.280) loss_x loss_x 0.6289 (0.4982) acc_x 87.5000 (91.8750) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/17] time 0.327 (0.354) data 0.249 (0.276) loss_x loss_x 0.4617 (0.4048) acc_x 84.3750 (92.1875) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/17] time 0.305 (0.340) data 0.226 (0.262) loss_x loss_x 0.3140 (0.3918) acc_x 96.8750 (92.0833) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 372
confident_label rate tensor(0.3352, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 547
clean true:513
clean false:34
clean_rate:0.9378427787934186
noisy true:747
noisy false:338
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1085
epoch [88/200] batch [5/17] time 0.303 (0.315) data 0.225 (0.237) loss_x loss_x 0.2603 (0.2807) acc_x 96.8750 (96.2500) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/17] time 0.352 (0.325) data 0.274 (0.247) loss_x loss_x 0.3840 (0.3563) acc_x 90.6250 (94.0625) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/17] time 0.355 (0.332) data 0.277 (0.254) loss_x loss_x 0.2203 (0.3535) acc_x 100.0000 (93.3333) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 368
confident_label rate tensor(0.3382, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 552
clean true:520
clean false:32
clean_rate:0.9420289855072463
noisy true:744
noisy false:336
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1080
epoch [89/200] batch [5/17] time 0.340 (0.312) data 0.263 (0.234) loss_x loss_x 0.5806 (0.4377) acc_x 90.6250 (88.7500) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/17] time 0.304 (0.318) data 0.227 (0.241) loss_x loss_x 0.4473 (0.3922) acc_x 90.6250 (90.0000) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/17] time 0.333 (0.322) data 0.255 (0.244) loss_x loss_x 0.2135 (0.4170) acc_x 100.0000 (90.2083) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 365
confident_label rate tensor(0.3352, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 547
clean true:521
clean false:26
clean_rate:0.9524680073126143
noisy true:746
noisy false:339
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1085
epoch [90/200] batch [5/17] time 0.346 (0.352) data 0.268 (0.274) loss_x loss_x 0.3682 (0.4424) acc_x 90.6250 (88.7500) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/17] time 0.314 (0.340) data 0.235 (0.261) loss_x loss_x 0.2119 (0.4488) acc_x 96.8750 (90.3125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/17] time 0.323 (0.332) data 0.244 (0.253) loss_x loss_x 0.1515 (0.4167) acc_x 96.8750 (90.6250) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 412
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 535
clean true:504
clean false:31
clean_rate:0.9420560747663551
noisy true:716
noisy false:381
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1097
epoch [91/200] batch [5/16] time 0.353 (0.355) data 0.274 (0.276) loss_x loss_x 0.4773 (0.3480) acc_x 93.7500 (93.1250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/16] time 0.355 (0.351) data 0.277 (0.273) loss_x loss_x 0.4470 (0.3707) acc_x 87.5000 (91.8750) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/16] time 0.344 (0.350) data 0.266 (0.271) loss_x loss_x 0.2761 (0.3682) acc_x 96.8750 (91.8750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 379
confident_label rate tensor(0.3327, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 543
clean true:513
clean false:30
clean_rate:0.9447513812154696
noisy true:740
noisy false:349
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1089
epoch [92/200] batch [5/16] time 0.335 (0.352) data 0.257 (0.274) loss_x loss_x 0.5137 (0.3883) acc_x 93.7500 (93.7500) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/16] time 0.334 (0.351) data 0.256 (0.273) loss_x loss_x 0.6328 (0.3814) acc_x 81.2500 (92.1875) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/16] time 0.348 (0.348) data 0.270 (0.271) loss_x loss_x 0.4690 (0.4030) acc_x 81.2500 (90.6250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 361
confident_label rate tensor(0.3309, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 540
clean true:511
clean false:29
clean_rate:0.9462962962962963
noisy true:760
noisy false:332
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1092
epoch [93/200] batch [5/16] time 0.344 (0.354) data 0.267 (0.277) loss_x loss_x 0.2651 (0.3749) acc_x 93.7500 (94.3750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/16] time 0.338 (0.348) data 0.261 (0.270) loss_x loss_x 0.3115 (0.3682) acc_x 93.7500 (92.5000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/16] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.3191 (0.3794) acc_x 90.6250 (91.2500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.3272, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 534
clean true:507
clean false:27
clean_rate:0.949438202247191
noisy true:724
noisy false:374
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1098
epoch [94/200] batch [5/16] time 0.360 (0.360) data 0.282 (0.281) loss_x loss_x 0.7056 (0.4276) acc_x 81.2500 (88.7500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/16] time 0.336 (0.348) data 0.259 (0.270) loss_x loss_x 0.1411 (0.3846) acc_x 96.8750 (90.9375) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/16] time 0.366 (0.348) data 0.289 (0.270) loss_x loss_x 0.3733 (0.3986) acc_x 90.6250 (90.6250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 365
confident_label rate tensor(0.3425, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 559
clean true:525
clean false:34
clean_rate:0.9391771019677997
noisy true:742
noisy false:331
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1073
epoch [95/200] batch [5/17] time 0.349 (0.352) data 0.272 (0.275) loss_x loss_x 0.2047 (0.3413) acc_x 100.0000 (91.8750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/17] time 0.343 (0.350) data 0.265 (0.273) loss_x loss_x 0.3977 (0.4061) acc_x 93.7500 (89.6875) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/17] time 0.328 (0.347) data 0.250 (0.270) loss_x loss_x 0.3884 (0.4058) acc_x 90.6250 (89.7917) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 359
confident_label rate tensor(0.3413, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 557
clean true:531
clean false:26
clean_rate:0.9533213644524237
noisy true:742
noisy false:333
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1075
epoch [96/200] batch [5/17] time 0.364 (0.356) data 0.286 (0.278) loss_x loss_x 0.3252 (0.2888) acc_x 93.7500 (93.7500) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/17] time 0.339 (0.348) data 0.261 (0.270) loss_x loss_x 0.3335 (0.3197) acc_x 96.8750 (93.1250) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/17] time 0.317 (0.350) data 0.239 (0.273) loss_x loss_x 0.3801 (0.3715) acc_x 93.7500 (91.4583) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 377
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:530
clean false:33
clean_rate:0.9413854351687388
noisy true:725
noisy false:344
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [97/200] batch [5/17] time 0.347 (0.348) data 0.269 (0.270) loss_x loss_x 0.4182 (0.3489) acc_x 90.6250 (92.5000) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/17] time 0.333 (0.345) data 0.254 (0.267) loss_x loss_x 0.6641 (0.3703) acc_x 93.7500 (92.5000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/17] time 0.302 (0.334) data 0.224 (0.256) loss_x loss_x 0.2529 (0.3883) acc_x 93.7500 (92.0833) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.3382, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 552
clean true:519
clean false:33
clean_rate:0.9402173913043478
noisy true:746
noisy false:334
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1080
epoch [98/200] batch [5/17] time 0.330 (0.331) data 0.252 (0.254) loss_x loss_x 0.3811 (0.4229) acc_x 90.6250 (88.1250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/17] time 0.337 (0.329) data 0.260 (0.251) loss_x loss_x 0.2585 (0.3929) acc_x 93.7500 (89.6875) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/17] time 0.350 (0.335) data 0.273 (0.258) loss_x loss_x 0.4607 (0.3807) acc_x 84.3750 (90.2083) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 376
confident_label rate tensor(0.3382, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 552
clean true:520
clean false:32
clean_rate:0.9420289855072463
noisy true:736
noisy false:344
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1080
epoch [99/200] batch [5/17] time 0.353 (0.319) data 0.275 (0.240) loss_x loss_x 0.3611 (0.4920) acc_x 90.6250 (87.5000) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/17] time 0.333 (0.332) data 0.256 (0.254) loss_x loss_x 0.7461 (0.4775) acc_x 81.2500 (87.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/17] time 0.369 (0.336) data 0.292 (0.258) loss_x loss_x 0.4070 (0.5006) acc_x 90.6250 (87.0833) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.3413, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 557
clean true:529
clean false:28
clean_rate:0.9497307001795332
noisy true:757
noisy false:318
all clean rate:  [0.958904109589041, 0.9573170731707317, 0.9877675840978594, 0.9792899408284024, 0.9825072886297376, 0.9886363636363636, 0.988795518207283, 0.9887323943661972, 0.9890710382513661, 0.9828571428571429, 0.9915730337078652, 0.9896907216494846, 0.9833333333333333, 0.9814814814814815, 0.9864130434782609, 0.9769230769230769, 0.9791666666666666, 0.9893048128342246, 0.9844961240310077, 0.9896907216494846, 0.9723618090452262, 0.9799498746867168, 0.9851485148514851, 0.9807692307692307, 0.9777777777777777, 0.9689737470167065, 0.9786223277909739, 0.9767441860465116, 0.972027972027972, 0.9675925925925926, 0.9845132743362832, 0.9775280898876404, 0.9707865168539326, 0.9664429530201343, 0.9733924611973392, 0.9668874172185431, 0.9636752136752137, 0.9665924276169265, 0.9702127659574468, 0.9728601252609603, 0.9735772357723578, 0.9728033472803347, 0.972972972972973, 0.9711340206185567, 0.969939879759519, 0.9647302904564315, 0.9532520325203252, 0.9565217391304348, 0.9508196721311475, 0.9543650793650794, 0.9453125, 0.9582504970178927, 0.9532163742690059, 0.9488188976377953, 0.9627450980392157, 0.9546351084812623, 0.951171875, 0.951171875, 0.9477756286266924, 0.9670542635658915, 0.958, 0.9501915708812261, 0.9562737642585551, 0.9565217391304348, 0.9472693032015066, 0.9549718574108818, 0.9523809523809523, 0.9514925373134329, 0.9563567362428842, 0.9485714285714286, 0.9512195121951219, 0.9377358490566038, 0.9548872180451128, 0.9444444444444444, 0.947069943289225, 0.9434306569343066, 0.9462962962962963, 0.951310861423221, 0.9491833030852994, 0.9524680073126143, 0.9486238532110092, 0.9388888888888889, 0.9380692167577414, 0.9369202226345084, 0.9447513812154696, 0.9366852886405959, 0.9339449541284404, 0.9378427787934186, 0.9420289855072463, 0.9524680073126143, 0.9420560747663551, 0.9447513812154696, 0.9462962962962963, 0.949438202247191, 0.9391771019677997, 0.9533213644524237, 0.9413854351687388, 0.9402173913043478, 0.9420289855072463, 0.9497307001795332]
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1075
epoch [100/200] batch [5/17] time 0.324 (0.333) data 0.247 (0.255) loss_x loss_x 0.2869 (0.3596) acc_x 93.7500 (95.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/17] time 0.342 (0.337) data 0.264 (0.259) loss_x loss_x 0.2664 (0.3854) acc_x 93.7500 (93.1250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/17] time 0.337 (0.331) data 0.259 (0.253) loss_x loss_x 0.3252 (0.3943) acc_x 93.7500 (92.7083) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 366
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:531
clean false:32
clean_rate:0.9431616341030196
noisy true:735
noisy false:334
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [101/200] batch [5/17] time 0.342 (0.339) data 0.263 (0.261) loss_x loss_x 0.4680 (0.5622) acc_x 93.7500 (85.0000) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/17] time 0.355 (0.334) data 0.277 (0.256) loss_x loss_x 0.3123 (0.4517) acc_x 93.7500 (88.1250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/17] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.1936 (0.4198) acc_x 96.8750 (88.7500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.3395, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 554
clean true:525
clean false:29
clean_rate:0.9476534296028881
noisy true:737
noisy false:341
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1078
epoch [102/200] batch [5/17] time 0.340 (0.350) data 0.263 (0.272) loss_x loss_x 0.5029 (0.4528) acc_x 87.5000 (90.0000) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/17] time 0.322 (0.342) data 0.244 (0.264) loss_x loss_x 0.5742 (0.4359) acc_x 84.3750 (89.3750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/17] time 0.331 (0.339) data 0.254 (0.261) loss_x loss_x 0.4219 (0.4358) acc_x 87.5000 (89.3750) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.3370, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 550
clean true:521
clean false:29
clean_rate:0.9472727272727273
noisy true:744
noisy false:338
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1082
epoch [103/200] batch [5/17] time 0.345 (0.348) data 0.267 (0.271) loss_x loss_x 0.2400 (0.3998) acc_x 96.8750 (88.7500) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/17] time 0.352 (0.344) data 0.273 (0.266) loss_x loss_x 0.3704 (0.4076) acc_x 90.6250 (88.7500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/17] time 0.346 (0.345) data 0.269 (0.268) loss_x loss_x 0.3528 (0.4073) acc_x 96.8750 (89.7917) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 381
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 548
clean true:516
clean false:32
clean_rate:0.9416058394160584
noisy true:735
noisy false:349
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1084
epoch [104/200] batch [5/17] time 0.365 (0.360) data 0.288 (0.282) loss_x loss_x 0.3772 (0.3971) acc_x 96.8750 (90.6250) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/17] time 0.345 (0.365) data 0.268 (0.288) loss_x loss_x 0.4329 (0.3566) acc_x 84.3750 (91.5625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/17] time 0.347 (0.361) data 0.269 (0.284) loss_x loss_x 0.3276 (0.3805) acc_x 93.7500 (91.4583) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.3395, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 554
clean true:521
clean false:33
clean_rate:0.9404332129963899
noisy true:766
noisy false:312
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1078
epoch [105/200] batch [5/17] time 0.303 (0.336) data 0.226 (0.259) loss_x loss_x 0.6348 (0.4054) acc_x 81.2500 (88.1250) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/17] time 0.337 (0.340) data 0.260 (0.263) loss_x loss_x 0.2808 (0.3570) acc_x 96.8750 (91.8750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/17] time 0.341 (0.339) data 0.263 (0.262) loss_x loss_x 0.2649 (0.3353) acc_x 96.8750 (93.1250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.3413, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 557
clean true:532
clean false:25
clean_rate:0.9551166965888689
noisy true:777
noisy false:298
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1075
epoch [106/200] batch [5/17] time 0.340 (0.347) data 0.262 (0.270) loss_x loss_x 0.2695 (0.3612) acc_x 93.7500 (90.6250) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/17] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.3799 (0.3934) acc_x 93.7500 (90.3125) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/17] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.2861 (0.3418) acc_x 90.6250 (91.8750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.3413, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 557
clean true:528
clean false:29
clean_rate:0.947935368043088
noisy true:737
noisy false:338
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1075
epoch [107/200] batch [5/17] time 0.349 (0.354) data 0.272 (0.277) loss_x loss_x 0.4050 (0.3720) acc_x 90.6250 (91.2500) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/17] time 0.336 (0.349) data 0.259 (0.272) loss_x loss_x 0.1571 (0.3682) acc_x 100.0000 (91.8750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/17] time 0.385 (0.349) data 0.308 (0.271) loss_x loss_x 0.1812 (0.3641) acc_x 96.8750 (91.8750) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.3474, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 567
clean true:538
clean false:29
clean_rate:0.9488536155202821
noisy true:739
noisy false:326
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1065
epoch [108/200] batch [5/17] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.4148 (0.4150) acc_x 93.7500 (92.5000) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/17] time 0.344 (0.342) data 0.266 (0.265) loss_x loss_x 0.4800 (0.3778) acc_x 90.6250 (92.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/17] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.4426 (0.3940) acc_x 87.5000 (90.6250) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.3468, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 566
clean true:537
clean false:29
clean_rate:0.9487632508833922
noisy true:770
noisy false:296
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1066
epoch [109/200] batch [5/17] time 0.343 (0.324) data 0.266 (0.246) loss_x loss_x 0.3218 (0.3669) acc_x 93.7500 (91.8750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/17] time 0.342 (0.334) data 0.265 (0.256) loss_x loss_x 0.4700 (0.4136) acc_x 87.5000 (90.6250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/17] time 0.339 (0.339) data 0.261 (0.262) loss_x loss_x 0.7661 (0.4370) acc_x 84.3750 (89.3750) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.3468, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 566
clean true:535
clean false:31
clean_rate:0.9452296819787986
noisy true:746
noisy false:320
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1066
epoch [110/200] batch [5/17] time 0.348 (0.353) data 0.270 (0.275) loss_x loss_x 0.1636 (0.2330) acc_x 96.8750 (95.6250) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/17] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.1235 (0.2938) acc_x 100.0000 (94.3750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/17] time 0.347 (0.347) data 0.269 (0.269) loss_x loss_x 0.2096 (0.2809) acc_x 96.8750 (94.3750) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 359
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 560
clean true:528
clean false:32
clean_rate:0.9428571428571428
noisy true:745
noisy false:327
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1072
epoch [111/200] batch [5/17] time 0.348 (0.355) data 0.270 (0.277) loss_x loss_x 0.3313 (0.3053) acc_x 93.7500 (94.3750) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/17] time 0.334 (0.347) data 0.256 (0.270) loss_x loss_x 0.1429 (0.3004) acc_x 96.8750 (93.1250) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/17] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.2734 (0.3194) acc_x 96.8750 (93.3333) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 365
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:531
clean false:32
clean_rate:0.9431616341030196
noisy true:736
noisy false:333
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [112/200] batch [5/17] time 0.336 (0.355) data 0.258 (0.278) loss_x loss_x 0.2125 (0.3048) acc_x 96.8750 (93.1250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/17] time 0.340 (0.349) data 0.262 (0.272) loss_x loss_x 0.2211 (0.3229) acc_x 96.8750 (93.4375) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/17] time 0.315 (0.337) data 0.237 (0.259) loss_x loss_x 0.4519 (0.3513) acc_x 87.5000 (92.5000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:530
clean false:33
clean_rate:0.9413854351687388
noisy true:748
noisy false:321
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [113/200] batch [5/17] time 0.367 (0.352) data 0.289 (0.274) loss_x loss_x 0.3240 (0.3783) acc_x 90.6250 (92.5000) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/17] time 0.320 (0.340) data 0.242 (0.262) loss_x loss_x 0.4309 (0.3438) acc_x 84.3750 (91.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/17] time 0.358 (0.340) data 0.281 (0.262) loss_x loss_x 0.3467 (0.3584) acc_x 93.7500 (91.6667) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 383
confident_label rate tensor(0.3468, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 566
clean true:535
clean false:31
clean_rate:0.9452296819787986
noisy true:714
noisy false:352
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1066
epoch [114/200] batch [5/17] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.1960 (0.3301) acc_x 100.0000 (91.8750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/17] time 0.352 (0.345) data 0.274 (0.267) loss_x loss_x 0.2391 (0.2766) acc_x 93.7500 (93.7500) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/17] time 0.331 (0.341) data 0.253 (0.263) loss_x loss_x 0.3696 (0.2980) acc_x 87.5000 (92.9167) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.3419, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 558
clean true:527
clean false:31
clean_rate:0.9444444444444444
noisy true:756
noisy false:318
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1074
epoch [115/200] batch [5/17] time 0.342 (0.352) data 0.265 (0.275) loss_x loss_x 0.2074 (0.3043) acc_x 96.8750 (94.3750) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/17] time 0.338 (0.350) data 0.259 (0.272) loss_x loss_x 0.4207 (0.3294) acc_x 93.7500 (95.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/17] time 0.351 (0.341) data 0.273 (0.263) loss_x loss_x 0.5278 (0.3396) acc_x 84.3750 (93.9583) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 375
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 560
clean true:528
clean false:32
clean_rate:0.9428571428571428
noisy true:729
noisy false:343
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1072
epoch [116/200] batch [5/17] time 0.345 (0.345) data 0.266 (0.267) loss_x loss_x 0.5483 (0.5355) acc_x 84.3750 (87.5000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/17] time 0.362 (0.335) data 0.284 (0.257) loss_x loss_x 0.2134 (0.4768) acc_x 93.7500 (88.1250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/17] time 0.329 (0.336) data 0.252 (0.258) loss_x loss_x 0.2756 (0.4264) acc_x 96.8750 (89.5833) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 358
confident_label rate tensor(0.3438, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 561
clean true:530
clean false:31
clean_rate:0.9447415329768271
noisy true:744
noisy false:327
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1071
epoch [117/200] batch [5/17] time 0.312 (0.313) data 0.235 (0.235) loss_x loss_x 0.4771 (0.3042) acc_x 87.5000 (93.1250) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/17] time 0.352 (0.328) data 0.275 (0.250) loss_x loss_x 0.2522 (0.2769) acc_x 96.8750 (93.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/17] time 0.339 (0.332) data 0.262 (0.254) loss_x loss_x 0.4744 (0.3428) acc_x 90.6250 (92.7083) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 340
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:534
clean false:29
clean_rate:0.9484902309058615
noisy true:758
noisy false:311
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [118/200] batch [5/17] time 0.348 (0.315) data 0.270 (0.236) loss_x loss_x 0.3926 (0.3526) acc_x 87.5000 (93.7500) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/17] time 0.347 (0.327) data 0.269 (0.249) loss_x loss_x 0.3538 (0.3825) acc_x 90.6250 (91.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/17] time 0.341 (0.333) data 0.263 (0.255) loss_x loss_x 0.6709 (0.3692) acc_x 87.5000 (91.8750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 350
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:533
clean false:30
clean_rate:0.9467140319715808
noisy true:749
noisy false:320
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [119/200] batch [5/17] time 0.351 (0.355) data 0.273 (0.277) loss_x loss_x 0.4509 (0.3082) acc_x 84.3750 (92.5000) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/17] time 0.355 (0.350) data 0.277 (0.273) loss_x loss_x 0.3237 (0.3240) acc_x 93.7500 (92.5000) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/17] time 0.342 (0.347) data 0.265 (0.270) loss_x loss_x 0.3250 (0.3278) acc_x 93.7500 (92.2917) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 374
confident_label rate tensor(0.3401, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 555
clean true:523
clean false:32
clean_rate:0.9423423423423424
noisy true:735
noisy false:342
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1077
epoch [120/200] batch [5/17] time 0.341 (0.353) data 0.263 (0.275) loss_x loss_x 0.2937 (0.3373) acc_x 93.7500 (92.5000) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/17] time 0.337 (0.347) data 0.260 (0.269) loss_x loss_x 0.5083 (0.3511) acc_x 87.5000 (90.9375) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/17] time 0.332 (0.347) data 0.254 (0.269) loss_x loss_x 0.6001 (0.3698) acc_x 81.2500 (90.0000) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:537
clean false:34
clean_rate:0.9404553415061296
noisy true:748
noisy false:313
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [121/200] batch [5/17] time 0.351 (0.350) data 0.273 (0.272) loss_x loss_x 0.4404 (0.3327) acc_x 90.6250 (92.5000) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/17] time 0.336 (0.347) data 0.259 (0.270) loss_x loss_x 0.4133 (0.3335) acc_x 90.6250 (92.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/17] time 0.344 (0.339) data 0.266 (0.262) loss_x loss_x 0.4041 (0.3192) acc_x 90.6250 (93.5417) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 364
confident_label rate tensor(0.3419, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 558
clean true:527
clean false:31
clean_rate:0.9444444444444444
noisy true:741
noisy false:333
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1074
epoch [122/200] batch [5/17] time 0.347 (0.345) data 0.268 (0.268) loss_x loss_x 0.3237 (0.3116) acc_x 90.6250 (92.5000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/17] time 0.352 (0.345) data 0.274 (0.267) loss_x loss_x 0.7095 (0.3644) acc_x 84.3750 (92.8125) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/17] time 0.334 (0.342) data 0.256 (0.265) loss_x loss_x 0.1539 (0.3493) acc_x 100.0000 (93.3333) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.3376, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 551
clean true:518
clean false:33
clean_rate:0.9401088929219601
noisy true:757
noisy false:324
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1081
epoch [123/200] batch [5/17] time 0.335 (0.341) data 0.258 (0.263) loss_x loss_x 0.3647 (0.3820) acc_x 90.6250 (90.0000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/17] time 0.345 (0.342) data 0.268 (0.264) loss_x loss_x 0.4314 (0.4152) acc_x 93.7500 (90.9375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/17] time 0.343 (0.342) data 0.265 (0.265) loss_x loss_x 0.3101 (0.3924) acc_x 93.7500 (90.8333) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:535
clean false:28
clean_rate:0.9502664298401421
noisy true:743
noisy false:326
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [124/200] batch [5/17] time 0.343 (0.354) data 0.265 (0.276) loss_x loss_x 0.2913 (0.2878) acc_x 93.7500 (93.1250) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/17] time 0.348 (0.358) data 0.270 (0.280) loss_x loss_x 0.4834 (0.3160) acc_x 87.5000 (92.1875) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/17] time 0.348 (0.356) data 0.270 (0.278) loss_x loss_x 0.6040 (0.3274) acc_x 81.2500 (91.6667) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 560
clean true:534
clean false:26
clean_rate:0.9535714285714286
noisy true:750
noisy false:322
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1072
epoch [125/200] batch [5/17] time 0.369 (0.351) data 0.291 (0.273) loss_x loss_x 0.2228 (0.2795) acc_x 96.8750 (96.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/17] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.1626 (0.2761) acc_x 96.8750 (95.9375) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/17] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.4270 (0.3349) acc_x 90.6250 (93.9583) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 334
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:534
clean false:28
clean_rate:0.9501779359430605
noisy true:764
noisy false:306
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [126/200] batch [5/17] time 0.376 (0.345) data 0.298 (0.268) loss_x loss_x 0.2834 (0.3352) acc_x 96.8750 (92.5000) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/17] time 0.347 (0.345) data 0.270 (0.267) loss_x loss_x 0.2460 (0.3358) acc_x 96.8750 (93.1250) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/17] time 0.296 (0.336) data 0.218 (0.258) loss_x loss_x 0.5586 (0.3571) acc_x 84.3750 (92.0833) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.3425, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 559
clean true:527
clean false:32
clean_rate:0.9427549194991055
noisy true:768
noisy false:305
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1073
epoch [127/200] batch [5/17] time 0.342 (0.341) data 0.265 (0.264) loss_x loss_x 0.4473 (0.2909) acc_x 90.6250 (95.6250) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/17] time 0.326 (0.341) data 0.248 (0.263) loss_x loss_x 0.3835 (0.3197) acc_x 87.5000 (94.0625) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/17] time 0.347 (0.331) data 0.269 (0.253) loss_x loss_x 0.5474 (0.3365) acc_x 87.5000 (93.1250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 339
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:533
clean false:32
clean_rate:0.9433628318584071
noisy true:760
noisy false:307
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [128/200] batch [5/17] time 0.344 (0.347) data 0.267 (0.269) loss_x loss_x 0.3152 (0.3818) acc_x 93.7500 (91.2500) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/17] time 0.299 (0.341) data 0.221 (0.264) loss_x loss_x 0.2712 (0.3624) acc_x 93.7500 (91.2500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/17] time 0.348 (0.336) data 0.270 (0.258) loss_x loss_x 0.3899 (0.3605) acc_x 87.5000 (91.0417) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:539
clean false:32
clean_rate:0.9439579684763573
noisy true:755
noisy false:306
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [129/200] batch [5/17] time 0.299 (0.325) data 0.220 (0.247) loss_x loss_x 0.5664 (0.3536) acc_x 84.3750 (92.5000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/17] time 0.361 (0.326) data 0.283 (0.248) loss_x loss_x 0.1862 (0.3604) acc_x 96.8750 (92.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/17] time 0.361 (0.336) data 0.283 (0.258) loss_x loss_x 0.2234 (0.3359) acc_x 96.8750 (93.1250) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 343
confident_label rate tensor(0.3407, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 556
clean true:522
clean false:34
clean_rate:0.9388489208633094
noisy true:767
noisy false:309
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1076
epoch [130/200] batch [5/17] time 0.347 (0.325) data 0.269 (0.247) loss_x loss_x 0.2141 (0.2834) acc_x 96.8750 (91.2500) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/17] time 0.450 (0.345) data 0.371 (0.267) loss_x loss_x 0.4839 (0.3175) acc_x 84.3750 (91.5625) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/17] time 0.301 (0.349) data 0.223 (0.271) loss_x loss_x 0.3950 (0.3405) acc_x 90.6250 (91.2500) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 569
clean true:542
clean false:27
clean_rate:0.9525483304042179
noisy true:749
noisy false:314
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1063
epoch [131/200] batch [5/17] time 0.349 (0.347) data 0.271 (0.270) loss_x loss_x 0.2169 (0.3619) acc_x 96.8750 (90.6250) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/17] time 0.325 (0.341) data 0.247 (0.263) loss_x loss_x 0.1143 (0.3090) acc_x 100.0000 (92.1875) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/17] time 0.346 (0.334) data 0.269 (0.256) loss_x loss_x 0.2754 (0.3439) acc_x 90.6250 (91.8750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.3456, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 564
clean true:528
clean false:36
clean_rate:0.9361702127659575
noisy true:744
noisy false:324
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1068
epoch [132/200] batch [5/17] time 0.332 (0.342) data 0.254 (0.264) loss_x loss_x 0.1786 (0.2888) acc_x 96.8750 (93.7500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/17] time 0.312 (0.331) data 0.234 (0.253) loss_x loss_x 0.6138 (0.3609) acc_x 84.3750 (91.5625) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/17] time 0.333 (0.337) data 0.255 (0.259) loss_x loss_x 0.1608 (0.3118) acc_x 93.7500 (92.5000) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 358
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:529
clean false:34
clean_rate:0.9396092362344582
noisy true:745
noisy false:324
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [133/200] batch [5/17] time 0.341 (0.338) data 0.263 (0.260) loss_x loss_x 0.7217 (0.4051) acc_x 81.2500 (88.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/17] time 0.355 (0.344) data 0.277 (0.266) loss_x loss_x 0.4065 (0.3539) acc_x 90.6250 (91.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/17] time 0.349 (0.345) data 0.271 (0.267) loss_x loss_x 0.2954 (0.3313) acc_x 93.7500 (91.2500) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:543
clean false:32
clean_rate:0.9443478260869566
noisy true:757
noisy false:300
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [134/200] batch [5/17] time 0.339 (0.349) data 0.262 (0.272) loss_x loss_x 0.3313 (0.3993) acc_x 93.7500 (90.6250) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/17] time 0.368 (0.351) data 0.291 (0.273) loss_x loss_x 0.2369 (0.3309) acc_x 93.7500 (92.5000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/17] time 0.345 (0.354) data 0.268 (0.277) loss_x loss_x 0.1647 (0.3379) acc_x 93.7500 (92.2917) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:536
clean false:34
clean_rate:0.9403508771929825
noisy true:748
noisy false:314
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [135/200] batch [5/17] time 0.347 (0.349) data 0.269 (0.271) loss_x loss_x 0.3743 (0.3256) acc_x 90.6250 (93.7500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/17] time 0.355 (0.347) data 0.277 (0.270) loss_x loss_x 0.3210 (0.3501) acc_x 90.6250 (92.8125) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/17] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.1344 (0.3375) acc_x 100.0000 (93.5417) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 353
confident_label rate tensor(0.3419, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 558
clean true:526
clean false:32
clean_rate:0.942652329749104
noisy true:753
noisy false:321
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1074
epoch [136/200] batch [5/17] time 0.335 (0.358) data 0.258 (0.280) loss_x loss_x 0.5132 (0.4395) acc_x 87.5000 (90.6250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/17] time 0.354 (0.355) data 0.277 (0.278) loss_x loss_x 0.4326 (0.3798) acc_x 90.6250 (91.5625) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/17] time 0.342 (0.354) data 0.264 (0.276) loss_x loss_x 0.3708 (0.3518) acc_x 87.5000 (92.2917) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 352
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 569
clean true:538
clean false:31
clean_rate:0.945518453427065
noisy true:742
noisy false:321
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1063
epoch [137/200] batch [5/17] time 0.333 (0.343) data 0.255 (0.265) loss_x loss_x 0.2695 (0.2297) acc_x 90.6250 (95.0000) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/17] time 0.294 (0.331) data 0.217 (0.254) loss_x loss_x 0.5879 (0.3187) acc_x 84.3750 (93.4375) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/17] time 0.341 (0.333) data 0.263 (0.255) loss_x loss_x 0.2122 (0.3009) acc_x 96.8750 (94.1667) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 364
confident_label rate tensor(0.3401, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 555
clean true:525
clean false:30
clean_rate:0.9459459459459459
noisy true:743
noisy false:334
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1077
epoch [138/200] batch [5/17] time 0.344 (0.347) data 0.266 (0.270) loss_x loss_x 0.4536 (0.2653) acc_x 87.5000 (95.0000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/17] time 0.348 (0.345) data 0.271 (0.267) loss_x loss_x 0.2566 (0.2361) acc_x 96.8750 (96.2500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/17] time 0.326 (0.342) data 0.249 (0.264) loss_x loss_x 0.3538 (0.3002) acc_x 90.6250 (93.9583) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:545
clean false:31
clean_rate:0.9461805555555556
noisy true:764
noisy false:292
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [139/200] batch [5/18] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.2852 (0.2620) acc_x 93.7500 (93.1250) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/18] time 0.345 (0.342) data 0.267 (0.265) loss_x loss_x 0.2014 (0.2863) acc_x 96.8750 (93.1250) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/18] time 0.318 (0.337) data 0.240 (0.259) loss_x loss_x 0.2373 (0.2869) acc_x 100.0000 (93.7500) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:531
clean false:34
clean_rate:0.9398230088495575
noisy true:753
noisy false:314
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [140/200] batch [5/17] time 0.308 (0.309) data 0.229 (0.231) loss_x loss_x 0.1218 (0.2998) acc_x 100.0000 (91.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/17] time 0.352 (0.325) data 0.274 (0.247) loss_x loss_x 0.3489 (0.3049) acc_x 90.6250 (92.1875) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/17] time 0.347 (0.331) data 0.269 (0.253) loss_x loss_x 0.4351 (0.3257) acc_x 87.5000 (91.8750) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 353
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:542
clean false:33
clean_rate:0.9426086956521739
noisy true:737
noisy false:320
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [141/200] batch [5/17] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.3369 (0.3905) acc_x 93.7500 (91.8750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/17] time 0.343 (0.343) data 0.265 (0.266) loss_x loss_x 0.4192 (0.4140) acc_x 90.6250 (90.6250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/17] time 0.328 (0.340) data 0.250 (0.262) loss_x loss_x 0.1925 (0.4077) acc_x 96.8750 (90.8333) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.3480, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 568
clean true:538
clean false:30
clean_rate:0.9471830985915493
noisy true:745
noisy false:319
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1064
epoch [142/200] batch [5/17] time 0.339 (0.339) data 0.262 (0.261) loss_x loss_x 0.2019 (0.4097) acc_x 96.8750 (88.7500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/17] time 0.345 (0.338) data 0.268 (0.261) loss_x loss_x 0.3577 (0.3349) acc_x 87.5000 (91.2500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/17] time 0.356 (0.343) data 0.278 (0.266) loss_x loss_x 0.2029 (0.3378) acc_x 96.8750 (91.6667) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.3474, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 567
clean true:533
clean false:34
clean_rate:0.9400352733686067
noisy true:754
noisy false:311
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1065
epoch [143/200] batch [5/17] time 0.346 (0.354) data 0.267 (0.276) loss_x loss_x 0.4934 (0.4402) acc_x 90.6250 (91.8750) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/17] time 0.341 (0.352) data 0.263 (0.275) loss_x loss_x 0.4363 (0.3980) acc_x 93.7500 (92.5000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/17] time 0.331 (0.350) data 0.253 (0.272) loss_x loss_x 0.3716 (0.3866) acc_x 90.6250 (91.8750) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 358
confident_label rate tensor(0.3517, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 574
clean true:542
clean false:32
clean_rate:0.9442508710801394
noisy true:732
noisy false:326
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1058
epoch [144/200] batch [5/17] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.2551 (0.3536) acc_x 93.7500 (93.7500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/17] time 0.347 (0.350) data 0.270 (0.272) loss_x loss_x 0.0956 (0.3755) acc_x 100.0000 (93.1250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/17] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.2073 (0.3507) acc_x 96.8750 (93.1250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.3468, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 566
clean true:536
clean false:30
clean_rate:0.9469964664310954
noisy true:754
noisy false:312
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1066
epoch [145/200] batch [5/17] time 0.305 (0.345) data 0.228 (0.268) loss_x loss_x 0.3997 (0.2927) acc_x 87.5000 (92.5000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/17] time 0.348 (0.328) data 0.271 (0.250) loss_x loss_x 0.3828 (0.3260) acc_x 93.7500 (93.1250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/17] time 0.352 (0.333) data 0.274 (0.256) loss_x loss_x 0.4871 (0.3812) acc_x 87.5000 (90.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.3517, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 574
clean true:541
clean false:33
clean_rate:0.9425087108013938
noisy true:758
noisy false:300
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1058
epoch [146/200] batch [5/17] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.2029 (0.2443) acc_x 96.8750 (93.7500) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/17] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.1266 (0.2682) acc_x 96.8750 (93.7500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/17] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.3025 (0.2780) acc_x 90.6250 (93.9583) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:538
clean false:33
clean_rate:0.9422066549912435
noisy true:743
noisy false:318
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [147/200] batch [5/17] time 0.347 (0.350) data 0.269 (0.273) loss_x loss_x 0.1792 (0.2461) acc_x 96.8750 (94.3750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/17] time 0.347 (0.350) data 0.270 (0.273) loss_x loss_x 0.4851 (0.3001) acc_x 90.6250 (93.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/17] time 0.349 (0.348) data 0.271 (0.271) loss_x loss_x 0.2220 (0.3101) acc_x 96.8750 (93.3333) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 361
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:529
clean false:33
clean_rate:0.9412811387900356
noisy true:742
noisy false:328
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [148/200] batch [5/17] time 0.360 (0.348) data 0.282 (0.270) loss_x loss_x 0.6323 (0.4428) acc_x 90.6250 (90.6250) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/17] time 0.377 (0.349) data 0.299 (0.272) loss_x loss_x 0.2690 (0.3328) acc_x 93.7500 (93.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/17] time 0.344 (0.348) data 0.266 (0.271) loss_x loss_x 0.3853 (0.3019) acc_x 93.7500 (94.5833) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 343
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 569
clean true:537
clean false:32
clean_rate:0.9437609841827768
noisy true:752
noisy false:311
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1063
epoch [149/200] batch [5/17] time 0.329 (0.345) data 0.252 (0.267) loss_x loss_x 0.1830 (0.2884) acc_x 96.8750 (93.7500) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/17] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.2146 (0.3247) acc_x 96.8750 (92.8125) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/17] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.4436 (0.3614) acc_x 87.5000 (91.6667) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 327
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:540
clean false:31
clean_rate:0.9457092819614711
noisy true:765
noisy false:296
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [150/200] batch [5/17] time 0.342 (0.355) data 0.263 (0.277) loss_x loss_x 0.3267 (0.3231) acc_x 96.8750 (93.7500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/17] time 0.332 (0.351) data 0.255 (0.274) loss_x loss_x 0.3586 (0.3262) acc_x 93.7500 (93.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/17] time 0.337 (0.349) data 0.259 (0.271) loss_x loss_x 0.3738 (0.3098) acc_x 90.6250 (93.9583) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:542
clean false:33
clean_rate:0.9426086956521739
noisy true:755
noisy false:302
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [151/200] batch [5/17] time 0.351 (0.351) data 0.273 (0.273) loss_x loss_x 0.2651 (0.2457) acc_x 93.7500 (94.3750) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/17] time 0.346 (0.349) data 0.268 (0.271) loss_x loss_x 0.2827 (0.2320) acc_x 93.7500 (95.6250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/17] time 0.349 (0.348) data 0.271 (0.270) loss_x loss_x 0.2788 (0.2536) acc_x 93.7500 (94.7917) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:541
clean false:35
clean_rate:0.9392361111111112
noisy true:734
noisy false:322
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [152/200] batch [5/18] time 0.351 (0.356) data 0.274 (0.278) loss_x loss_x 0.2800 (0.2525) acc_x 90.6250 (94.3750) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/18] time 0.352 (0.352) data 0.274 (0.274) loss_x loss_x 0.5498 (0.3456) acc_x 87.5000 (91.8750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/18] time 0.346 (0.350) data 0.267 (0.272) loss_x loss_x 0.3501 (0.3393) acc_x 90.6250 (91.2500) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 362
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:538
clean false:32
clean_rate:0.9438596491228071
noisy true:732
noisy false:330
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [153/200] batch [5/17] time 0.348 (0.346) data 0.271 (0.268) loss_x loss_x 0.2976 (0.3176) acc_x 90.6250 (91.2500) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/17] time 0.352 (0.344) data 0.273 (0.267) loss_x loss_x 0.2817 (0.3603) acc_x 90.6250 (90.6250) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/17] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.1294 (0.3502) acc_x 100.0000 (91.0417) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:537
clean false:33
clean_rate:0.9421052631578948
noisy true:748
noisy false:314
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [154/200] batch [5/17] time 0.351 (0.349) data 0.273 (0.272) loss_x loss_x 0.1727 (0.2227) acc_x 100.0000 (96.2500) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/17] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.3140 (0.2592) acc_x 90.6250 (95.0000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/17] time 0.299 (0.340) data 0.221 (0.262) loss_x loss_x 0.3635 (0.2772) acc_x 93.7500 (92.9167) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.3566, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 582
clean true:547
clean false:35
clean_rate:0.9398625429553265
noisy true:738
noisy false:312
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1050
epoch [155/200] batch [5/18] time 0.346 (0.350) data 0.269 (0.272) loss_x loss_x 0.3906 (0.3342) acc_x 93.7500 (93.1250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/18] time 0.336 (0.343) data 0.259 (0.265) loss_x loss_x 0.3105 (0.3736) acc_x 90.6250 (92.5000) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/18] time 0.339 (0.340) data 0.262 (0.263) loss_x loss_x 0.2191 (0.3399) acc_x 96.8750 (92.7083) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:541
clean false:34
clean_rate:0.9408695652173913
noisy true:753
noisy false:304
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [156/200] batch [5/17] time 0.330 (0.342) data 0.252 (0.264) loss_x loss_x 0.2113 (0.2844) acc_x 96.8750 (95.6250) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/17] time 0.338 (0.344) data 0.261 (0.266) loss_x loss_x 0.4026 (0.3482) acc_x 90.6250 (92.8125) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/17] time 0.319 (0.340) data 0.241 (0.263) loss_x loss_x 0.2947 (0.3590) acc_x 90.6250 (91.4583) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 356
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:543
clean false:34
clean_rate:0.9410745233968805
noisy true:733
noisy false:322
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [157/200] batch [5/18] time 0.330 (0.350) data 0.253 (0.272) loss_x loss_x 0.3279 (0.2775) acc_x 93.7500 (92.5000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/18] time 0.315 (0.339) data 0.236 (0.261) loss_x loss_x 0.2231 (0.3511) acc_x 96.8750 (90.6250) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/18] time 0.338 (0.341) data 0.261 (0.264) loss_x loss_x 0.6040 (0.3421) acc_x 78.1250 (90.2083) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:545
clean false:32
clean_rate:0.9445407279029463
noisy true:758
noisy false:297
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [158/200] batch [5/18] time 0.298 (0.327) data 0.220 (0.249) loss_x loss_x 0.3147 (0.3091) acc_x 93.7500 (92.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/18] time 0.342 (0.335) data 0.264 (0.257) loss_x loss_x 0.4546 (0.2990) acc_x 87.5000 (94.0625) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/18] time 0.324 (0.336) data 0.247 (0.258) loss_x loss_x 0.2756 (0.2789) acc_x 87.5000 (94.1667) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.3542, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 578
clean true:544
clean false:34
clean_rate:0.9411764705882353
noisy true:740
noisy false:314
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1054
epoch [159/200] batch [5/18] time 0.349 (0.357) data 0.271 (0.280) loss_x loss_x 0.3220 (0.3975) acc_x 93.7500 (91.2500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/18] time 0.346 (0.354) data 0.269 (0.277) loss_x loss_x 0.2383 (0.3312) acc_x 93.7500 (92.8125) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/18] time 0.343 (0.353) data 0.266 (0.275) loss_x loss_x 0.2040 (0.3249) acc_x 100.0000 (93.1250) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 569
clean true:536
clean false:33
clean_rate:0.9420035149384886
noisy true:741
noisy false:322
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1063
epoch [160/200] batch [5/17] time 0.325 (0.331) data 0.248 (0.254) loss_x loss_x 0.4116 (0.2679) acc_x 87.5000 (95.0000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/17] time 0.359 (0.338) data 0.281 (0.261) loss_x loss_x 0.0998 (0.3101) acc_x 96.8750 (93.7500) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/17] time 0.343 (0.339) data 0.265 (0.261) loss_x loss_x 0.2957 (0.3413) acc_x 93.7500 (93.1250) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:558
clean false:30
clean_rate:0.9489795918367347
noisy true:766
noisy false:278
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [161/200] batch [5/18] time 0.355 (0.353) data 0.277 (0.275) loss_x loss_x 0.1597 (0.3217) acc_x 100.0000 (92.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/18] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.1782 (0.2988) acc_x 96.8750 (92.8125) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/18] time 0.353 (0.346) data 0.275 (0.268) loss_x loss_x 0.2358 (0.2972) acc_x 96.8750 (92.9167) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 326
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:543
clean false:33
clean_rate:0.9427083333333334
noisy true:763
noisy false:293
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [162/200] batch [5/18] time 0.354 (0.353) data 0.276 (0.275) loss_x loss_x 0.2947 (0.2988) acc_x 96.8750 (94.3750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/18] time 0.355 (0.348) data 0.277 (0.271) loss_x loss_x 0.1620 (0.2755) acc_x 100.0000 (95.0000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/18] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.3162 (0.2851) acc_x 93.7500 (94.3750) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 365
confident_label rate tensor(0.3401, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 555
clean true:524
clean false:31
clean_rate:0.9441441441441442
noisy true:743
noisy false:334
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1077
epoch [163/200] batch [5/17] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.1595 (0.2904) acc_x 96.8750 (93.7500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/17] time 0.343 (0.337) data 0.266 (0.259) loss_x loss_x 0.2249 (0.2904) acc_x 93.7500 (93.7500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/17] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.2455 (0.2828) acc_x 93.7500 (93.7500) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.3468, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 566
clean true:531
clean false:35
clean_rate:0.9381625441696113
noisy true:741
noisy false:325
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1066
epoch [164/200] batch [5/17] time 0.344 (0.351) data 0.266 (0.273) loss_x loss_x 0.5142 (0.2578) acc_x 87.5000 (93.7500) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/17] time 0.336 (0.348) data 0.258 (0.271) loss_x loss_x 0.2566 (0.2890) acc_x 93.7500 (94.3750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/17] time 0.338 (0.344) data 0.260 (0.267) loss_x loss_x 0.0842 (0.2901) acc_x 100.0000 (94.7917) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 549
clean true:518
clean false:31
clean_rate:0.9435336976320583
noisy true:772
noisy false:311
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1083
epoch [165/200] batch [5/17] time 0.336 (0.352) data 0.258 (0.275) loss_x loss_x 0.2549 (0.3374) acc_x 93.7500 (93.1250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/17] time 0.333 (0.344) data 0.255 (0.266) loss_x loss_x 0.6348 (0.3291) acc_x 84.3750 (93.4375) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/17] time 0.343 (0.346) data 0.265 (0.268) loss_x loss_x 0.5923 (0.3238) acc_x 93.7500 (94.3750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.3480, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 568
clean true:536
clean false:32
clean_rate:0.9436619718309859
noisy true:754
noisy false:310
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1064
epoch [166/200] batch [5/17] time 0.342 (0.346) data 0.264 (0.268) loss_x loss_x 0.4219 (0.3445) acc_x 87.5000 (94.3750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/17] time 0.350 (0.351) data 0.272 (0.273) loss_x loss_x 0.3706 (0.3262) acc_x 87.5000 (94.0625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/17] time 0.328 (0.344) data 0.249 (0.266) loss_x loss_x 0.0925 (0.3209) acc_x 100.0000 (93.5417) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:539
clean false:37
clean_rate:0.9357638888888888
noisy true:761
noisy false:295
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [167/200] batch [5/18] time 0.343 (0.355) data 0.264 (0.276) loss_x loss_x 0.3706 (0.3083) acc_x 96.8750 (94.3750) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/18] time 0.344 (0.346) data 0.267 (0.267) loss_x loss_x 0.5063 (0.3057) acc_x 90.6250 (94.0625) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/18] time 0.346 (0.346) data 0.267 (0.268) loss_x loss_x 0.4111 (0.3189) acc_x 87.5000 (93.3333) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 343
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:537
clean false:34
clean_rate:0.9404553415061296
noisy true:752
noisy false:309
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [168/200] batch [5/17] time 0.341 (0.340) data 0.263 (0.262) loss_x loss_x 0.6367 (0.4486) acc_x 87.5000 (90.6250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/17] time 0.345 (0.331) data 0.267 (0.254) loss_x loss_x 0.1755 (0.4038) acc_x 96.8750 (91.8750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/17] time 0.335 (0.329) data 0.258 (0.252) loss_x loss_x 0.3440 (0.3529) acc_x 90.6250 (93.1250) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.3425, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 559
clean true:531
clean false:28
clean_rate:0.9499105545617174
noisy true:744
noisy false:329
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1073
epoch [169/200] batch [5/17] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.3479 (0.4509) acc_x 93.7500 (90.0000) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/17] time 0.301 (0.339) data 0.223 (0.261) loss_x loss_x 0.2954 (0.3568) acc_x 96.8750 (92.8125) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/17] time 0.332 (0.336) data 0.254 (0.258) loss_x loss_x 0.3430 (0.3323) acc_x 93.7500 (93.3333) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.3456, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 564
clean true:536
clean false:28
clean_rate:0.950354609929078
noisy true:771
noisy false:297
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1068
epoch [170/200] batch [5/17] time 0.326 (0.342) data 0.248 (0.265) loss_x loss_x 0.1305 (0.2724) acc_x 100.0000 (92.5000) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/17] time 0.310 (0.324) data 0.233 (0.246) loss_x loss_x 0.2489 (0.2561) acc_x 93.7500 (93.7500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/17] time 0.343 (0.331) data 0.266 (0.253) loss_x loss_x 0.2448 (0.2681) acc_x 96.8750 (93.3333) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 391
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:528
clean false:34
clean_rate:0.9395017793594306
noisy true:713
noisy false:357
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [171/200] batch [5/17] time 0.330 (0.336) data 0.252 (0.258) loss_x loss_x 0.2615 (0.2359) acc_x 93.7500 (93.7500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/17] time 0.308 (0.326) data 0.229 (0.248) loss_x loss_x 0.3223 (0.2947) acc_x 93.7500 (92.1875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/17] time 0.334 (0.332) data 0.257 (0.254) loss_x loss_x 0.4502 (0.2943) acc_x 81.2500 (92.0833) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.3505, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 572
clean true:539
clean false:33
clean_rate:0.9423076923076923
noisy true:745
noisy false:315
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1060
epoch [172/200] batch [5/17] time 0.346 (0.354) data 0.268 (0.276) loss_x loss_x 0.4214 (0.3522) acc_x 93.7500 (91.8750) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/17] time 0.341 (0.354) data 0.264 (0.276) loss_x loss_x 0.3936 (0.3798) acc_x 93.7500 (91.5625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/17] time 0.301 (0.350) data 0.223 (0.272) loss_x loss_x 0.3308 (0.3278) acc_x 93.7500 (93.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.3517, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 574
clean true:540
clean false:34
clean_rate:0.9407665505226481
noisy true:754
noisy false:304
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1058
epoch [173/200] batch [5/17] time 0.352 (0.358) data 0.274 (0.280) loss_x loss_x 0.3901 (0.2891) acc_x 96.8750 (95.6250) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/17] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.2627 (0.2448) acc_x 90.6250 (95.3125) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/17] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.6372 (0.3072) acc_x 90.6250 (94.3750) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 366
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 573
clean true:537
clean false:36
clean_rate:0.93717277486911
noisy true:729
noisy false:330
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1059
epoch [174/200] batch [5/17] time 0.343 (0.349) data 0.266 (0.272) loss_x loss_x 0.2822 (0.2887) acc_x 96.8750 (93.7500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/17] time 0.353 (0.349) data 0.276 (0.271) loss_x loss_x 0.2690 (0.2808) acc_x 90.6250 (93.7500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/17] time 0.336 (0.348) data 0.259 (0.270) loss_x loss_x 0.1943 (0.2608) acc_x 96.8750 (94.5833) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:547
clean false:29
clean_rate:0.9496527777777778
noisy true:739
noisy false:317
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [175/200] batch [5/18] time 0.352 (0.348) data 0.274 (0.270) loss_x loss_x 0.2808 (0.3314) acc_x 93.7500 (93.1250) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/18] time 0.338 (0.347) data 0.260 (0.269) loss_x loss_x 0.2886 (0.3106) acc_x 93.7500 (93.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/18] time 0.335 (0.348) data 0.257 (0.270) loss_x loss_x 0.3923 (0.3093) acc_x 90.6250 (93.3333) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 322
confident_label rate tensor(0.3554, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 580
clean true:546
clean false:34
clean_rate:0.9413793103448276
noisy true:764
noisy false:288
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1052
epoch [176/200] batch [5/18] time 0.341 (0.349) data 0.264 (0.272) loss_x loss_x 0.1975 (0.2993) acc_x 96.8750 (92.5000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/18] time 0.354 (0.349) data 0.277 (0.271) loss_x loss_x 0.3057 (0.2530) acc_x 90.6250 (94.6875) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/18] time 0.349 (0.346) data 0.271 (0.268) loss_x loss_x 0.4609 (0.2861) acc_x 93.7500 (93.9583) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 569
clean true:536
clean false:33
clean_rate:0.9420035149384886
noisy true:767
noisy false:296
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1063
epoch [177/200] batch [5/17] time 0.342 (0.351) data 0.265 (0.274) loss_x loss_x 0.2842 (0.3387) acc_x 93.7500 (91.2500) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/17] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.3303 (0.3099) acc_x 93.7500 (92.5000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/17] time 0.347 (0.345) data 0.269 (0.268) loss_x loss_x 0.1810 (0.2940) acc_x 96.8750 (93.5417) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:534
clean false:31
clean_rate:0.9451327433628318
noisy true:743
noisy false:324
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [178/200] batch [5/17] time 0.333 (0.351) data 0.256 (0.273) loss_x loss_x 0.3389 (0.2671) acc_x 93.7500 (93.7500) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/17] time 0.346 (0.349) data 0.269 (0.271) loss_x loss_x 0.2273 (0.3133) acc_x 96.8750 (93.1250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/17] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.5464 (0.3070) acc_x 90.6250 (93.5417) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 342
confident_label rate tensor(0.3474, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 567
clean true:536
clean false:31
clean_rate:0.9453262786596119
noisy true:754
noisy false:311
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1065
epoch [179/200] batch [5/17] time 0.355 (0.356) data 0.278 (0.278) loss_x loss_x 0.2500 (0.2015) acc_x 96.8750 (96.2500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/17] time 0.350 (0.354) data 0.273 (0.276) loss_x loss_x 0.2157 (0.2725) acc_x 100.0000 (95.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/17] time 0.338 (0.349) data 0.260 (0.271) loss_x loss_x 0.3481 (0.2858) acc_x 93.7500 (95.2083) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 334
confident_label rate tensor(0.3474, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 567
clean true:537
clean false:30
clean_rate:0.9470899470899471
noisy true:761
noisy false:304
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1065
epoch [180/200] batch [5/17] time 0.345 (0.351) data 0.268 (0.274) loss_x loss_x 0.2300 (0.2813) acc_x 100.0000 (95.0000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/17] time 0.331 (0.346) data 0.253 (0.269) loss_x loss_x 0.5483 (0.3179) acc_x 81.2500 (92.5000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/17] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.1340 (0.2827) acc_x 100.0000 (93.7500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.3548, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 579
clean true:546
clean false:33
clean_rate:0.9430051813471503
noisy true:758
noisy false:295
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1053
epoch [181/200] batch [5/18] time 0.335 (0.345) data 0.258 (0.267) loss_x loss_x 0.4019 (0.3550) acc_x 87.5000 (90.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/18] time 0.358 (0.344) data 0.280 (0.267) loss_x loss_x 0.2529 (0.3431) acc_x 93.7500 (91.2500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/18] time 0.293 (0.343) data 0.214 (0.265) loss_x loss_x 0.4348 (0.3340) acc_x 87.5000 (91.4583) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.3566, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 582
clean true:547
clean false:35
clean_rate:0.9398625429553265
noisy true:731
noisy false:319
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1050
epoch [182/200] batch [5/18] time 0.350 (0.354) data 0.273 (0.277) loss_x loss_x 0.1198 (0.2467) acc_x 100.0000 (95.0000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/18] time 0.341 (0.350) data 0.264 (0.272) loss_x loss_x 0.1858 (0.3141) acc_x 100.0000 (93.1250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/18] time 0.310 (0.343) data 0.231 (0.265) loss_x loss_x 0.3481 (0.3410) acc_x 93.7500 (92.7083) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.3517, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 574
clean true:539
clean false:35
clean_rate:0.9390243902439024
noisy true:742
noisy false:316
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1058
epoch [183/200] batch [5/17] time 0.340 (0.346) data 0.262 (0.268) loss_x loss_x 0.3508 (0.2997) acc_x 90.6250 (91.8750) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/17] time 0.301 (0.340) data 0.223 (0.262) loss_x loss_x 0.1641 (0.2930) acc_x 96.8750 (94.0625) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/17] time 0.313 (0.328) data 0.234 (0.250) loss_x loss_x 0.5405 (0.3010) acc_x 84.3750 (93.5417) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 569
clean true:539
clean false:30
clean_rate:0.9472759226713533
noisy true:742
noisy false:321
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1063
epoch [184/200] batch [5/17] time 0.348 (0.336) data 0.271 (0.259) loss_x loss_x 0.1058 (0.2635) acc_x 100.0000 (96.2500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/17] time 0.331 (0.338) data 0.254 (0.261) loss_x loss_x 0.6826 (0.3031) acc_x 87.5000 (94.3750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/17] time 0.315 (0.332) data 0.237 (0.255) loss_x loss_x 0.1503 (0.3007) acc_x 100.0000 (93.9583) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:540
clean false:31
clean_rate:0.9457092819614711
noisy true:747
noisy false:314
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [185/200] batch [5/17] time 0.338 (0.350) data 0.261 (0.272) loss_x loss_x 0.4902 (0.3327) acc_x 87.5000 (91.8750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/17] time 0.297 (0.340) data 0.219 (0.262) loss_x loss_x 0.2383 (0.2822) acc_x 93.7500 (93.4375) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/17] time 0.305 (0.327) data 0.227 (0.249) loss_x loss_x 0.1595 (0.2595) acc_x 96.8750 (94.3750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 337
confident_label rate tensor(0.3554, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 580
clean true:548
clean false:32
clean_rate:0.9448275862068966
noisy true:747
noisy false:305
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1052
epoch [186/200] batch [5/18] time 0.310 (0.339) data 0.232 (0.261) loss_x loss_x 0.2491 (0.2320) acc_x 96.8750 (94.3750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/18] time 0.344 (0.326) data 0.267 (0.248) loss_x loss_x 0.3511 (0.2526) acc_x 93.7500 (94.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/18] time 0.354 (0.332) data 0.277 (0.255) loss_x loss_x 0.2605 (0.2765) acc_x 93.7500 (93.7500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.3554, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 580
clean true:548
clean false:32
clean_rate:0.9448275862068966
noisy true:756
noisy false:296
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1052
epoch [187/200] batch [5/18] time 0.340 (0.345) data 0.263 (0.267) loss_x loss_x 0.3523 (0.2852) acc_x 90.6250 (95.0000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/18] time 0.343 (0.344) data 0.265 (0.267) loss_x loss_x 0.1117 (0.2737) acc_x 100.0000 (93.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/18] time 0.333 (0.343) data 0.256 (0.266) loss_x loss_x 0.2356 (0.2569) acc_x 93.7500 (94.3750) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.3542, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 578
clean true:542
clean false:36
clean_rate:0.9377162629757786
noisy true:744
noisy false:310
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1054
epoch [188/200] batch [5/18] time 0.295 (0.299) data 0.217 (0.222) loss_x loss_x 0.1230 (0.2598) acc_x 100.0000 (94.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/18] time 0.293 (0.298) data 0.215 (0.220) loss_x loss_x 0.4229 (0.2838) acc_x 87.5000 (93.4375) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/18] time 0.301 (0.298) data 0.223 (0.221) loss_x loss_x 0.1591 (0.2808) acc_x 96.8750 (94.1667) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.3517, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 574
clean true:544
clean false:30
clean_rate:0.9477351916376306
noisy true:756
noisy false:302
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1058
epoch [189/200] batch [5/17] time 0.298 (0.304) data 0.221 (0.227) loss_x loss_x 0.3679 (0.2895) acc_x 93.7500 (95.6250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/17] time 0.300 (0.308) data 0.222 (0.230) loss_x loss_x 0.3020 (0.2613) acc_x 96.8750 (95.9375) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/17] time 0.299 (0.306) data 0.221 (0.228) loss_x loss_x 0.3601 (0.2679) acc_x 96.8750 (95.8333) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 339
confident_label rate tensor(0.3419, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 558
clean true:526
clean false:32
clean_rate:0.942652329749104
noisy true:767
noisy false:307
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1074
epoch [190/200] batch [5/17] time 0.296 (0.295) data 0.218 (0.218) loss_x loss_x 0.2932 (0.2743) acc_x 96.8750 (95.0000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/17] time 0.302 (0.296) data 0.225 (0.219) loss_x loss_x 0.2239 (0.2536) acc_x 96.8750 (95.0000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/17] time 0.296 (0.296) data 0.219 (0.219) loss_x loss_x 0.2301 (0.2666) acc_x 93.7500 (94.5833) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 339
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:540
clean false:35
clean_rate:0.9391304347826087
noisy true:753
noisy false:304
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [191/200] batch [5/17] time 0.290 (0.294) data 0.211 (0.217) loss_x loss_x 0.4216 (0.3536) acc_x 96.8750 (95.0000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/17] time 0.295 (0.295) data 0.218 (0.217) loss_x loss_x 0.2869 (0.3188) acc_x 93.7500 (94.0625) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/17] time 0.289 (0.294) data 0.212 (0.216) loss_x loss_x 0.5049 (0.3001) acc_x 90.6250 (93.9583) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 573
clean true:538
clean false:35
clean_rate:0.9389179755671903
noisy true:761
noisy false:298
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1059
epoch [192/200] batch [5/17] time 0.290 (0.292) data 0.212 (0.214) loss_x loss_x 0.3723 (0.3875) acc_x 93.7500 (92.5000) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/17] time 0.306 (0.299) data 0.229 (0.221) loss_x loss_x 0.4424 (0.3731) acc_x 90.6250 (93.1250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/17] time 0.294 (0.299) data 0.217 (0.221) loss_x loss_x 0.2739 (0.3300) acc_x 96.8750 (93.7500) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:545
clean false:32
clean_rate:0.9445407279029463
noisy true:749
noisy false:306
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [193/200] batch [5/18] time 0.296 (0.298) data 0.219 (0.220) loss_x loss_x 0.5239 (0.3743) acc_x 81.2500 (91.2500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/18] time 0.299 (0.297) data 0.222 (0.220) loss_x loss_x 0.1919 (0.3133) acc_x 93.7500 (92.8125) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/18] time 0.290 (0.296) data 0.213 (0.219) loss_x loss_x 0.2563 (0.2918) acc_x 93.7500 (93.5417) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:543
clean false:34
clean_rate:0.9410745233968805
noisy true:764
noisy false:291
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [194/200] batch [5/18] time 0.294 (0.300) data 0.216 (0.222) loss_x loss_x 0.2465 (0.3603) acc_x 96.8750 (91.2500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/18] time 0.299 (0.298) data 0.221 (0.220) loss_x loss_x 0.3623 (0.3443) acc_x 93.7500 (92.1875) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/18] time 0.301 (0.297) data 0.223 (0.220) loss_x loss_x 0.2844 (0.3128) acc_x 90.6250 (93.1250) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 318
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:552
clean false:36
clean_rate:0.9387755102040817
noisy true:762
noisy false:282
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [195/200] batch [5/18] time 0.294 (0.294) data 0.216 (0.217) loss_x loss_x 0.1653 (0.2807) acc_x 96.8750 (95.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/18] time 0.304 (0.296) data 0.226 (0.218) loss_x loss_x 0.4836 (0.3300) acc_x 90.6250 (94.0625) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/18] time 0.293 (0.295) data 0.215 (0.217) loss_x loss_x 0.2317 (0.3355) acc_x 96.8750 (93.1250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 327
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:545
clean false:32
clean_rate:0.9445407279029463
noisy true:760
noisy false:295
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [196/200] batch [5/18] time 0.288 (0.294) data 0.211 (0.216) loss_x loss_x 0.2605 (0.2226) acc_x 93.7500 (94.3750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/18] time 0.299 (0.294) data 0.221 (0.216) loss_x loss_x 0.1620 (0.2742) acc_x 100.0000 (93.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/18] time 0.335 (0.307) data 0.258 (0.229) loss_x loss_x 0.3203 (0.2871) acc_x 93.7500 (93.9583) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:547
clean false:30
clean_rate:0.9480069324090121
noisy true:740
noisy false:315
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [197/200] batch [5/18] time 0.292 (0.299) data 0.214 (0.221) loss_x loss_x 0.2009 (0.3184) acc_x 96.8750 (92.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/18] time 0.293 (0.296) data 0.215 (0.219) loss_x loss_x 0.1367 (0.2917) acc_x 100.0000 (93.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/18] time 0.289 (0.301) data 0.212 (0.223) loss_x loss_x 0.1871 (0.2767) acc_x 96.8750 (93.9583) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 347
confident_label rate tensor(0.3480, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 568
clean true:539
clean false:29
clean_rate:0.948943661971831
noisy true:746
noisy false:318
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1064
epoch [198/200] batch [5/17] time 0.287 (0.291) data 0.211 (0.214) loss_x loss_x 0.3760 (0.3551) acc_x 84.3750 (90.0000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/17] time 0.292 (0.292) data 0.214 (0.214) loss_x loss_x 0.1951 (0.3018) acc_x 100.0000 (91.8750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/17] time 0.290 (0.291) data 0.212 (0.213) loss_x loss_x 0.6001 (0.3178) acc_x 84.3750 (91.8750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.3591, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 586
clean true:552
clean false:34
clean_rate:0.9419795221843004
noisy true:726
noisy false:320
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1046
epoch [199/200] batch [5/18] time 0.292 (0.287) data 0.214 (0.209) loss_x loss_x 0.3589 (0.3303) acc_x 90.6250 (91.8750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/18] time 0.299 (0.291) data 0.221 (0.213) loss_x loss_x 0.2050 (0.3064) acc_x 96.8750 (93.1250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/18] time 0.285 (0.290) data 0.207 (0.212) loss_x loss_x 0.5649 (0.3574) acc_x 90.6250 (92.0833) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:542
clean false:33
clean_rate:0.9426086956521739
noisy true:769
noisy false:288
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [200/200] batch [5/17] time 0.302 (0.292) data 0.225 (0.215) loss_x loss_x 0.2198 (0.3064) acc_x 96.8750 (92.5000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/17] time 0.281 (0.300) data 0.204 (0.223) loss_x loss_x 0.1638 (0.2948) acc_x 96.8750 (93.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/17] time 0.288 (0.297) data 0.211 (0.220) loss_x loss_x 0.2151 (0.2954) acc_x 96.8750 (93.3333) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,029
* accuracy: 82.4%
* error: 17.6%
* macro_f1: 81.5%
Elapsed: 1:20:39
