***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:661
clean false:3
clean_rate:0.9954819277108434
noisy true:94
noisy false:842
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [1/200] batch [5/20] time 0.187 (0.205) data 0.111 (0.108) loss_x loss_x 2.9219 (2.8426) acc_x 62.5000 (61.2500) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [10/20] time 0.193 (0.201) data 0.117 (0.114) loss_x loss_x 2.4121 (2.6352) acc_x 56.2500 (62.8125) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [15/20] time 0.193 (0.199) data 0.117 (0.116) loss_x loss_x 1.4990 (2.3648) acc_x 81.2500 (67.2917) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [20/20] time 0.197 (0.203) data 0.121 (0.116) loss_x loss_x 1.2686 (2.2034) acc_x 75.0000 (67.3438) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 685
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 804
clean true:798
clean false:6
clean_rate:0.9925373134328358
noisy true:117
noisy false:679
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 796
epoch [2/200] batch [5/25] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 1.0234 (1.1803) acc_x 78.1250 (73.7500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [10/25] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 1.0127 (1.2576) acc_x 78.1250 (72.1875) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [15/25] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.6284 (1.1722) acc_x 87.5000 (73.3333) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [20/25] time 0.193 (0.186) data 0.111 (0.104) loss_x loss_x 1.0479 (1.1225) acc_x 71.8750 (74.3750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [25/25] time 0.182 (0.185) data 0.104 (0.104) loss_x loss_x 0.7656 (1.1304) acc_x 87.5000 (73.0000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 520
confident_label rate tensor(0.5831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 933
clean true:932
clean false:1
clean_rate:0.9989281886387996
noisy true:148
noisy false:519
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 667
epoch [3/200] batch [5/29] time 0.171 (0.166) data 0.095 (0.090) loss_x loss_x 1.0410 (1.0127) acc_x 78.1250 (73.1250) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/29] time 0.161 (0.163) data 0.085 (0.087) loss_x loss_x 0.5703 (0.8666) acc_x 87.5000 (77.8125) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/29] time 0.166 (0.164) data 0.090 (0.087) loss_x loss_x 1.2334 (0.9135) acc_x 75.0000 (76.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/29] time 0.176 (0.168) data 0.100 (0.091) loss_x loss_x 0.5845 (0.8800) acc_x 84.3750 (77.6562) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/29] time 0.182 (0.169) data 0.106 (0.092) loss_x loss_x 0.6938 (0.8340) acc_x 84.3750 (79.1250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 539
confident_label rate tensor(0.5744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 919
clean true:919
clean false:0
clean_rate:1.0
noisy true:142
noisy false:539
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 681
epoch [4/200] batch [5/28] time 0.199 (0.205) data 0.122 (0.106) loss_x loss_x 1.1094 (0.7813) acc_x 68.7500 (77.5000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/28] time 0.188 (0.194) data 0.111 (0.106) loss_x loss_x 0.8979 (0.7462) acc_x 75.0000 (78.1250) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/28] time 0.211 (0.191) data 0.134 (0.107) loss_x loss_x 1.1064 (0.7542) acc_x 78.1250 (79.1667) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/28] time 0.202 (0.190) data 0.126 (0.108) loss_x loss_x 0.8345 (0.7839) acc_x 78.1250 (79.0625) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/28] time 0.181 (0.190) data 0.104 (0.110) loss_x loss_x 1.1943 (0.7727) acc_x 68.7500 (79.5000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.5938, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 950
clean true:949
clean false:1
clean_rate:0.9989473684210526
noisy true:160
noisy false:490
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 650
epoch [5/200] batch [5/29] time 0.188 (0.212) data 0.111 (0.109) loss_x loss_x 1.0244 (0.8155) acc_x 81.2500 (78.1250) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/29] time 0.170 (0.197) data 0.093 (0.107) loss_x loss_x 0.7393 (0.8735) acc_x 84.3750 (77.8125) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/29] time 0.172 (0.194) data 0.095 (0.108) loss_x loss_x 0.8525 (0.8937) acc_x 75.0000 (75.6250) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/29] time 0.242 (0.193) data 0.108 (0.107) loss_x loss_x 0.6143 (0.8652) acc_x 81.2500 (76.8750) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/29] time 0.183 (0.197) data 0.107 (0.108) loss_x loss_x 0.7402 (0.8354) acc_x 78.1250 (77.7500) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.6144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 983
clean true:983
clean false:0
clean_rate:1.0
noisy true:145
noisy false:472
after delete: len(clean_dataset) 983
after delete: len(noisy_dataset) 617
epoch [6/200] batch [5/30] time 0.188 (0.218) data 0.113 (0.120) loss_x loss_x 0.9277 (0.7789) acc_x 78.1250 (77.5000) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [10/30] time 0.178 (0.201) data 0.102 (0.114) loss_x loss_x 1.0010 (0.8414) acc_x 78.1250 (77.8125) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/30] time 0.206 (0.198) data 0.129 (0.115) loss_x loss_x 0.9014 (0.8146) acc_x 75.0000 (77.9167) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/30] time 0.173 (0.194) data 0.097 (0.112) loss_x loss_x 0.8091 (0.8249) acc_x 71.8750 (77.9688) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/30] time 0.203 (0.196) data 0.127 (0.110) loss_x loss_x 1.0889 (0.8508) acc_x 75.0000 (76.8750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [30/30] time 0.184 (0.196) data 0.108 (0.112) loss_x loss_x 1.0566 (0.8441) acc_x 78.1250 (77.1875) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.6112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 978
clean true:978
clean false:0
clean_rate:1.0
noisy true:139
noisy false:483
after delete: len(clean_dataset) 978
after delete: len(noisy_dataset) 622
epoch [7/200] batch [5/30] time 0.157 (0.182) data 0.079 (0.105) loss_x loss_x 1.3789 (1.0378) acc_x 65.6250 (76.2500) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/30] time 0.190 (0.178) data 0.114 (0.101) loss_x loss_x 0.4370 (0.8785) acc_x 90.6250 (80.3125) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/30] time 0.198 (0.179) data 0.121 (0.103) loss_x loss_x 0.5928 (0.8367) acc_x 84.3750 (79.3750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/30] time 0.260 (0.185) data 0.108 (0.105) loss_x loss_x 0.9863 (0.8562) acc_x 81.2500 (79.2188) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/30] time 0.189 (0.187) data 0.113 (0.106) loss_x loss_x 0.5425 (0.8216) acc_x 90.6250 (80.5000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [30/30] time 0.176 (0.187) data 0.100 (0.107) loss_x loss_x 0.4390 (0.7854) acc_x 87.5000 (81.1458) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.6212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 994
clean true:993
clean false:1
clean_rate:0.9989939637826962
noisy true:145
noisy false:461
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 606
epoch [8/200] batch [5/31] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 1.2109 (0.8786) acc_x 68.7500 (79.3750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/31] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.8389 (0.8257) acc_x 81.2500 (79.0625) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/31] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.7563 (0.8305) acc_x 75.0000 (78.7500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/31] time 0.181 (0.185) data 0.104 (0.103) loss_x loss_x 0.7163 (0.8237) acc_x 84.3750 (78.4375) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/31] time 0.184 (0.185) data 0.107 (0.104) loss_x loss_x 1.4082 (0.8187) acc_x 50.0000 (78.3750) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/31] time 0.174 (0.183) data 0.097 (0.103) loss_x loss_x 0.6450 (0.7932) acc_x 84.3750 (79.0625) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.6175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 988
clean true:987
clean false:1
clean_rate:0.9989878542510121
noisy true:141
noisy false:471
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 612
epoch [9/200] batch [5/30] time 0.177 (0.198) data 0.101 (0.100) loss_x loss_x 0.7129 (0.7827) acc_x 78.1250 (77.5000) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/30] time 0.160 (0.184) data 0.084 (0.097) loss_x loss_x 0.3257 (0.7424) acc_x 87.5000 (78.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/30] time 0.165 (0.184) data 0.089 (0.100) loss_x loss_x 1.0439 (0.7685) acc_x 78.1250 (78.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/30] time 0.173 (0.181) data 0.096 (0.099) loss_x loss_x 0.4243 (0.7471) acc_x 90.6250 (78.9062) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/30] time 0.242 (0.182) data 0.165 (0.101) loss_x loss_x 0.7622 (0.7766) acc_x 75.0000 (78.1250) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [30/30] time 0.181 (0.181) data 0.105 (0.101) loss_x loss_x 1.2471 (0.8170) acc_x 59.3750 (76.9792) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.6181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 989
clean true:989
clean false:0
clean_rate:1.0
noisy true:143
noisy false:468
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 611
epoch [10/200] batch [5/30] time 0.186 (0.189) data 0.108 (0.112) loss_x loss_x 0.7358 (0.7438) acc_x 78.1250 (79.3750) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/30] time 0.194 (0.186) data 0.118 (0.109) loss_x loss_x 0.5830 (0.6561) acc_x 84.3750 (83.4375) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/30] time 0.162 (0.183) data 0.086 (0.107) loss_x loss_x 0.4280 (0.6398) acc_x 84.3750 (82.7083) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/30] time 0.164 (0.185) data 0.087 (0.101) loss_x loss_x 0.7358 (0.6846) acc_x 78.1250 (80.7812) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/30] time 0.167 (0.180) data 0.091 (0.098) loss_x loss_x 1.0986 (0.7211) acc_x 75.0000 (80.5000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [30/30] time 0.169 (0.178) data 0.093 (0.097) loss_x loss_x 0.8638 (0.7235) acc_x 71.8750 (80.2083) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.6387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1022
clean true:1022
clean false:0
clean_rate:1.0
noisy true:148
noisy false:430
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 578
epoch [11/200] batch [5/31] time 0.189 (0.191) data 0.112 (0.115) loss_x loss_x 0.5171 (0.7230) acc_x 90.6250 (80.6250) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/31] time 0.175 (0.185) data 0.098 (0.108) loss_x loss_x 0.8008 (0.7847) acc_x 81.2500 (80.3125) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/31] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.7661 (0.7536) acc_x 78.1250 (79.5833) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/31] time 0.192 (0.181) data 0.116 (0.105) loss_x loss_x 0.8145 (0.7734) acc_x 71.8750 (79.2188) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/31] time 0.173 (0.180) data 0.097 (0.103) loss_x loss_x 0.6348 (0.7455) acc_x 81.2500 (79.8750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/31] time 0.169 (0.178) data 0.092 (0.102) loss_x loss_x 1.4268 (0.7613) acc_x 62.5000 (79.3750) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.6137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 982
clean true:981
clean false:1
clean_rate:0.9989816700610998
noisy true:142
noisy false:476
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 618
epoch [12/200] batch [5/30] time 0.170 (0.181) data 0.094 (0.105) loss_x loss_x 1.2051 (0.8158) acc_x 68.7500 (77.5000) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/30] time 0.173 (0.185) data 0.096 (0.108) loss_x loss_x 0.7148 (0.8524) acc_x 84.3750 (76.8750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/30] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 1.4248 (0.8297) acc_x 62.5000 (77.2917) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/30] time 0.173 (0.183) data 0.096 (0.107) loss_x loss_x 0.5864 (0.8546) acc_x 81.2500 (76.8750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/30] time 0.172 (0.180) data 0.096 (0.104) loss_x loss_x 0.8359 (0.8572) acc_x 75.0000 (77.1250) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [30/30] time 0.186 (0.180) data 0.110 (0.104) loss_x loss_x 0.6597 (0.8326) acc_x 78.1250 (77.7083) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.6119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 979
clean true:979
clean false:0
clean_rate:1.0
noisy true:141
noisy false:480
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 621
epoch [13/200] batch [5/30] time 0.171 (0.174) data 0.094 (0.098) loss_x loss_x 0.7271 (0.8969) acc_x 81.2500 (75.6250) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/30] time 0.163 (0.175) data 0.087 (0.099) loss_x loss_x 0.3340 (0.8668) acc_x 96.8750 (76.8750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/30] time 0.179 (0.177) data 0.103 (0.101) loss_x loss_x 0.4045 (0.7624) acc_x 90.6250 (79.3750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/30] time 0.167 (0.174) data 0.091 (0.098) loss_x loss_x 0.8765 (0.7825) acc_x 81.2500 (79.5312) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/30] time 0.170 (0.176) data 0.092 (0.099) loss_x loss_x 0.7769 (0.7785) acc_x 81.2500 (79.2500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [30/30] time 0.167 (0.175) data 0.090 (0.099) loss_x loss_x 0.7373 (0.7478) acc_x 78.1250 (80.1042) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.6231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 997
clean true:996
clean false:1
clean_rate:0.9989969909729187
noisy true:145
noisy false:458
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 603
epoch [14/200] batch [5/31] time 0.181 (0.170) data 0.104 (0.093) loss_x loss_x 0.9600 (0.8195) acc_x 81.2500 (77.5000) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/31] time 0.179 (0.175) data 0.103 (0.098) loss_x loss_x 0.7466 (0.7213) acc_x 78.1250 (80.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/31] time 0.187 (0.175) data 0.110 (0.098) loss_x loss_x 0.5815 (0.7306) acc_x 87.5000 (80.2083) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/31] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 1.1152 (0.7637) acc_x 68.7500 (79.0625) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/31] time 0.173 (0.176) data 0.096 (0.100) loss_x loss_x 0.4688 (0.7600) acc_x 90.6250 (79.5000) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [30/31] time 0.169 (0.180) data 0.093 (0.100) loss_x loss_x 0.7803 (0.7664) acc_x 81.2500 (79.4792) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.6356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1017
clean true:1016
clean false:1
clean_rate:0.9990167158308751
noisy true:145
noisy false:438
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 583
epoch [15/200] batch [5/31] time 0.217 (0.193) data 0.141 (0.116) loss_x loss_x 1.0283 (0.9566) acc_x 71.8750 (75.0000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/31] time 0.190 (0.191) data 0.114 (0.114) loss_x loss_x 0.8569 (0.7909) acc_x 75.0000 (78.4375) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/31] time 0.179 (0.188) data 0.100 (0.112) loss_x loss_x 0.3591 (0.6802) acc_x 93.7500 (81.6667) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/31] time 0.176 (0.186) data 0.099 (0.109) loss_x loss_x 0.7607 (0.7316) acc_x 81.2500 (79.6875) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/31] time 0.157 (0.181) data 0.081 (0.105) loss_x loss_x 1.0146 (0.7285) acc_x 71.8750 (80.1250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [30/31] time 0.179 (0.181) data 0.102 (0.105) loss_x loss_x 0.7300 (0.7210) acc_x 75.0000 (80.0000) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.6300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1008
clean true:1007
clean false:1
clean_rate:0.9990079365079365
noisy true:153
noisy false:439
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 592
epoch [16/200] batch [5/31] time 0.161 (0.168) data 0.085 (0.091) loss_x loss_x 0.9810 (0.8379) acc_x 71.8750 (78.1250) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [10/31] time 0.176 (0.170) data 0.100 (0.094) loss_x loss_x 0.7349 (0.9139) acc_x 75.0000 (75.6250) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/31] time 0.191 (0.175) data 0.115 (0.098) loss_x loss_x 0.7334 (0.8643) acc_x 81.2500 (75.6250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/31] time 0.289 (0.183) data 0.103 (0.098) loss_x loss_x 0.6597 (0.8155) acc_x 87.5000 (78.4375) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/31] time 0.183 (0.182) data 0.107 (0.098) loss_x loss_x 0.6592 (0.7837) acc_x 84.3750 (79.5000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/31] time 0.171 (0.181) data 0.094 (0.098) loss_x loss_x 1.3916 (0.8171) acc_x 71.8750 (78.6458) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.6506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1041
clean true:1039
clean false:2
clean_rate:0.9980787704130644
noisy true:149
noisy false:410
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 559
epoch [17/200] batch [5/32] time 0.189 (0.194) data 0.112 (0.118) loss_x loss_x 0.8154 (0.8654) acc_x 71.8750 (76.2500) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/32] time 0.182 (0.189) data 0.106 (0.113) loss_x loss_x 0.4087 (0.7950) acc_x 93.7500 (80.6250) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/32] time 0.179 (0.190) data 0.103 (0.114) loss_x loss_x 0.9688 (0.8026) acc_x 78.1250 (79.5833) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/32] time 0.194 (0.199) data 0.117 (0.114) loss_x loss_x 0.4155 (0.8110) acc_x 90.6250 (79.0625) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/32] time 0.182 (0.196) data 0.106 (0.112) loss_x loss_x 1.0156 (0.7986) acc_x 65.6250 (79.1250) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [30/32] time 0.187 (0.194) data 0.109 (0.112) loss_x loss_x 0.6611 (0.7813) acc_x 84.3750 (79.6875) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.6394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1023
clean true:1020
clean false:3
clean_rate:0.9970674486803519
noisy true:142
noisy false:435
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 577
epoch [18/200] batch [5/31] time 0.165 (0.172) data 0.090 (0.096) loss_x loss_x 1.2881 (0.8662) acc_x 65.6250 (75.6250) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/31] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.7202 (0.8849) acc_x 84.3750 (76.5625) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/31] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.6797 (0.8182) acc_x 81.2500 (77.5000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/31] time 0.173 (0.182) data 0.097 (0.097) loss_x loss_x 1.0078 (0.7846) acc_x 62.5000 (77.5000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/31] time 0.166 (0.179) data 0.090 (0.095) loss_x loss_x 0.7192 (0.7748) acc_x 81.2500 (78.6250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [30/31] time 0.186 (0.178) data 0.110 (0.096) loss_x loss_x 0.6851 (0.7619) acc_x 75.0000 (78.8542) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.6369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1019
clean true:1018
clean false:1
clean_rate:0.9990186457311089
noisy true:137
noisy false:444
after delete: len(clean_dataset) 1019
after delete: len(noisy_dataset) 581
epoch [19/200] batch [5/31] time 0.186 (0.182) data 0.110 (0.106) loss_x loss_x 0.5376 (0.6385) acc_x 81.2500 (83.7500) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/31] time 0.165 (0.179) data 0.089 (0.103) loss_x loss_x 0.4626 (0.6160) acc_x 84.3750 (84.3750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/31] time 0.188 (0.175) data 0.111 (0.099) loss_x loss_x 1.1943 (0.6308) acc_x 81.2500 (83.7500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/31] time 0.182 (0.181) data 0.106 (0.099) loss_x loss_x 0.7129 (0.7040) acc_x 71.8750 (81.4062) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/31] time 0.295 (0.184) data 0.109 (0.099) loss_x loss_x 0.5142 (0.6735) acc_x 90.6250 (82.5000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [30/31] time 0.191 (0.183) data 0.114 (0.099) loss_x loss_x 0.7808 (0.6979) acc_x 78.1250 (81.9792) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.6231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 997
clean true:996
clean false:1
clean_rate:0.9989969909729187
noisy true:149
noisy false:454
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 603
epoch [20/200] batch [5/31] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5767 (0.6849) acc_x 81.2500 (81.2500) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/31] time 0.181 (0.200) data 0.105 (0.107) loss_x loss_x 0.7363 (0.6913) acc_x 71.8750 (81.2500) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/31] time 0.190 (0.196) data 0.114 (0.108) loss_x loss_x 0.6880 (0.7395) acc_x 87.5000 (80.2083) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/31] time 0.208 (0.194) data 0.132 (0.109) loss_x loss_x 0.7358 (0.7131) acc_x 87.5000 (81.4062) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/31] time 0.196 (0.192) data 0.120 (0.109) loss_x loss_x 0.6567 (0.6996) acc_x 81.2500 (81.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/31] time 0.183 (0.191) data 0.107 (0.109) loss_x loss_x 0.8726 (0.7215) acc_x 71.8750 (80.7292) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.6575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1052
clean true:1051
clean false:1
clean_rate:0.9990494296577946
noisy true:145
noisy false:403
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 548
epoch [21/200] batch [5/32] time 0.181 (0.172) data 0.103 (0.095) loss_x loss_x 0.8560 (0.7833) acc_x 78.1250 (80.6250) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/32] time 0.218 (0.184) data 0.141 (0.108) loss_x loss_x 0.7959 (0.7992) acc_x 78.1250 (80.0000) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/32] time 0.191 (0.186) data 0.115 (0.109) loss_x loss_x 0.4331 (0.6660) acc_x 87.5000 (83.5417) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/32] time 0.180 (0.192) data 0.103 (0.110) loss_x loss_x 0.9502 (0.6976) acc_x 75.0000 (82.1875) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/32] time 0.176 (0.191) data 0.100 (0.110) loss_x loss_x 0.9375 (0.6974) acc_x 75.0000 (82.0000) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [30/32] time 0.169 (0.188) data 0.093 (0.108) loss_x loss_x 1.0938 (0.7291) acc_x 81.2500 (81.1458) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.6425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1028
clean true:1028
clean false:0
clean_rate:1.0
noisy true:149
noisy false:423
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 572
epoch [22/200] batch [5/32] time 0.166 (0.164) data 0.089 (0.087) loss_x loss_x 0.5254 (0.6804) acc_x 87.5000 (84.3750) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/32] time 0.167 (0.166) data 0.091 (0.089) loss_x loss_x 0.3894 (0.7760) acc_x 90.6250 (79.6875) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/32] time 0.178 (0.174) data 0.102 (0.092) loss_x loss_x 0.6948 (0.8073) acc_x 87.5000 (79.5833) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/32] time 0.198 (0.176) data 0.122 (0.095) loss_x loss_x 0.7261 (0.7868) acc_x 78.1250 (80.3125) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/32] time 0.193 (0.177) data 0.116 (0.098) loss_x loss_x 0.5850 (0.7665) acc_x 84.3750 (80.3750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [30/32] time 0.184 (0.177) data 0.107 (0.098) loss_x loss_x 0.6460 (0.7432) acc_x 78.1250 (80.8333) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.6475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1036
clean true:1034
clean false:2
clean_rate:0.9980694980694981
noisy true:147
noisy false:417
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 564
epoch [23/200] batch [5/32] time 0.173 (0.179) data 0.097 (0.102) loss_x loss_x 0.6479 (0.7060) acc_x 84.3750 (82.5000) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/32] time 0.207 (0.186) data 0.131 (0.110) loss_x loss_x 0.7246 (0.7226) acc_x 78.1250 (81.2500) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/32] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.9810 (0.7524) acc_x 65.6250 (79.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/32] time 0.186 (0.186) data 0.110 (0.110) loss_x loss_x 0.5918 (0.7378) acc_x 84.3750 (79.5312) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/32] time 0.185 (0.186) data 0.108 (0.110) loss_x loss_x 0.8950 (0.7195) acc_x 71.8750 (80.1250) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/32] time 0.185 (0.188) data 0.109 (0.112) loss_x loss_x 0.3733 (0.7318) acc_x 84.3750 (79.8958) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.6425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1028
clean true:1028
clean false:0
clean_rate:1.0
noisy true:140
noisy false:432
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 572
epoch [24/200] batch [5/32] time 0.182 (0.220) data 0.106 (0.108) loss_x loss_x 1.1934 (0.6944) acc_x 71.8750 (83.7500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/32] time 0.182 (0.198) data 0.104 (0.103) loss_x loss_x 0.3447 (0.6654) acc_x 93.7500 (83.4375) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/32] time 0.187 (0.194) data 0.110 (0.105) loss_x loss_x 0.8364 (0.6787) acc_x 68.7500 (81.8750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/32] time 0.185 (0.188) data 0.108 (0.103) loss_x loss_x 0.6304 (0.6474) acc_x 81.2500 (82.6562) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/32] time 0.174 (0.187) data 0.097 (0.103) loss_x loss_x 0.8452 (0.6741) acc_x 78.1250 (82.0000) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [30/32] time 0.169 (0.184) data 0.091 (0.101) loss_x loss_x 0.5405 (0.6615) acc_x 81.2500 (81.8750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.6325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1012
clean true:1010
clean false:2
clean_rate:0.9980237154150198
noisy true:142
noisy false:446
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 588
epoch [25/200] batch [5/31] time 0.182 (0.174) data 0.105 (0.098) loss_x loss_x 0.4255 (0.5908) acc_x 87.5000 (83.7500) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/31] time 0.182 (0.178) data 0.106 (0.102) loss_x loss_x 0.7754 (0.6972) acc_x 81.2500 (83.1250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/31] time 0.184 (0.180) data 0.108 (0.104) loss_x loss_x 0.3752 (0.6898) acc_x 93.7500 (83.3333) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/31] time 0.195 (0.184) data 0.117 (0.107) loss_x loss_x 0.4731 (0.6893) acc_x 81.2500 (82.3438) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/31] time 0.193 (0.186) data 0.117 (0.109) loss_x loss_x 1.1348 (0.6973) acc_x 65.6250 (82.2500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/31] time 0.228 (0.187) data 0.151 (0.111) loss_x loss_x 0.3098 (0.6755) acc_x 90.6250 (82.1875) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.6600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1056
clean true:1055
clean false:1
clean_rate:0.9990530303030303
noisy true:147
noisy false:397
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 544
epoch [26/200] batch [5/33] time 0.185 (0.214) data 0.108 (0.120) loss_x loss_x 0.7407 (0.7983) acc_x 81.2500 (76.8750) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/33] time 0.195 (0.201) data 0.119 (0.116) loss_x loss_x 0.7627 (0.7502) acc_x 71.8750 (77.8125) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/33] time 0.184 (0.196) data 0.108 (0.114) loss_x loss_x 0.5728 (0.7371) acc_x 90.6250 (78.5417) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/33] time 0.181 (0.193) data 0.105 (0.112) loss_x loss_x 1.1533 (0.7189) acc_x 71.8750 (79.5312) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/33] time 0.185 (0.192) data 0.109 (0.112) loss_x loss_x 0.8086 (0.6964) acc_x 81.2500 (79.8750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [30/33] time 0.160 (0.191) data 0.083 (0.110) loss_x loss_x 1.4775 (0.7221) acc_x 68.7500 (80.1042) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.6488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1038
clean true:1038
clean false:0
clean_rate:1.0
noisy true:144
noisy false:418
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 562
epoch [27/200] batch [5/32] time 0.163 (0.165) data 0.086 (0.088) loss_x loss_x 0.5488 (0.6703) acc_x 87.5000 (82.5000) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/32] time 0.171 (0.167) data 0.094 (0.090) loss_x loss_x 0.8232 (0.6825) acc_x 81.2500 (81.8750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/32] time 0.195 (0.172) data 0.118 (0.095) loss_x loss_x 0.2832 (0.6587) acc_x 93.7500 (82.7083) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/32] time 0.236 (0.186) data 0.160 (0.101) loss_x loss_x 0.6655 (0.7022) acc_x 81.2500 (82.1875) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/32] time 0.171 (0.186) data 0.094 (0.103) loss_x loss_x 0.5356 (0.7359) acc_x 84.3750 (80.8750) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [30/32] time 0.177 (0.184) data 0.101 (0.102) loss_x loss_x 0.6372 (0.7314) acc_x 84.3750 (81.5625) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.6500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1040
clean true:1040
clean false:0
clean_rate:1.0
noisy true:149
noisy false:411
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 560
epoch [28/200] batch [5/32] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.7373 (0.5082) acc_x 75.0000 (85.0000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/32] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 1.0195 (0.6341) acc_x 75.0000 (84.0625) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/32] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 0.9170 (0.7002) acc_x 71.8750 (81.2500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [20/32] time 0.160 (0.174) data 0.084 (0.098) loss_x loss_x 0.8950 (0.6858) acc_x 78.1250 (81.2500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/32] time 0.277 (0.176) data 0.091 (0.095) loss_x loss_x 0.6616 (0.6620) acc_x 75.0000 (81.8750) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/32] time 0.209 (0.178) data 0.133 (0.098) loss_x loss_x 0.9346 (0.6831) acc_x 75.0000 (81.6667) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.6538, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1046
clean true:1045
clean false:1
clean_rate:0.9990439770554493
noisy true:141
noisy false:413
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 554
epoch [29/200] batch [5/32] time 0.174 (0.177) data 0.095 (0.100) loss_x loss_x 0.3530 (0.5693) acc_x 93.7500 (87.5000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/32] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 1.0283 (0.7310) acc_x 78.1250 (81.8750) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/32] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.6611 (0.6925) acc_x 87.5000 (83.3333) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/32] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 0.6294 (0.6928) acc_x 84.3750 (83.1250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/32] time 0.178 (0.176) data 0.102 (0.099) loss_x loss_x 0.8442 (0.7578) acc_x 75.0000 (81.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [30/32] time 0.171 (0.181) data 0.093 (0.098) loss_x loss_x 0.6206 (0.7464) acc_x 87.5000 (81.4583) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.6662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1066
clean true:1065
clean false:1
clean_rate:0.99906191369606
noisy true:148
noisy false:386
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 534
epoch [30/200] batch [5/33] time 0.181 (0.189) data 0.105 (0.113) loss_x loss_x 0.6211 (0.7360) acc_x 84.3750 (80.0000) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/33] time 0.182 (0.191) data 0.106 (0.114) loss_x loss_x 0.5132 (0.7353) acc_x 87.5000 (80.0000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/33] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.8208 (0.7293) acc_x 75.0000 (80.6250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/33] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.5010 (0.7083) acc_x 84.3750 (80.7812) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/33] time 0.165 (0.184) data 0.089 (0.107) loss_x loss_x 0.7314 (0.7176) acc_x 75.0000 (80.7500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/33] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 0.5098 (0.7261) acc_x 87.5000 (81.0417) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.6506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1041
clean true:1041
clean false:0
clean_rate:1.0
noisy true:145
noisy false:414
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 559
epoch [31/200] batch [5/32] time 0.172 (0.172) data 0.095 (0.095) loss_x loss_x 0.6826 (0.7048) acc_x 81.2500 (84.3750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/32] time 0.177 (0.172) data 0.100 (0.095) loss_x loss_x 0.6699 (0.6646) acc_x 87.5000 (84.0625) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/32] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 1.4082 (0.7073) acc_x 68.7500 (82.7083) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/32] time 0.184 (0.175) data 0.108 (0.098) loss_x loss_x 0.2388 (0.6800) acc_x 93.7500 (82.6562) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/32] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.7241 (0.6588) acc_x 81.2500 (83.3750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [30/32] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.9033 (0.6807) acc_x 71.8750 (82.5000) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.6469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1035
clean true:1034
clean false:1
clean_rate:0.9990338164251208
noisy true:143
noisy false:422
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 565
epoch [32/200] batch [5/32] time 0.274 (0.215) data 0.087 (0.096) loss_x loss_x 0.9224 (0.8659) acc_x 75.0000 (75.0000) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/32] time 0.181 (0.199) data 0.105 (0.102) loss_x loss_x 0.5317 (0.7840) acc_x 87.5000 (77.8125) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/32] time 0.169 (0.188) data 0.092 (0.098) loss_x loss_x 1.0488 (0.7552) acc_x 75.0000 (79.3750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/32] time 0.185 (0.185) data 0.109 (0.098) loss_x loss_x 0.3098 (0.7261) acc_x 90.6250 (80.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/32] time 0.182 (0.185) data 0.106 (0.100) loss_x loss_x 0.4592 (0.7140) acc_x 87.5000 (80.1250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [30/32] time 0.188 (0.185) data 0.112 (0.101) loss_x loss_x 0.3647 (0.6870) acc_x 90.6250 (81.1458) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.6575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1052
clean true:1052
clean false:0
clean_rate:1.0
noisy true:150
noisy false:398
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 548
epoch [33/200] batch [5/32] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.7324 (0.6568) acc_x 78.1250 (83.7500) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/32] time 0.177 (0.172) data 0.083 (0.094) loss_x loss_x 0.7490 (0.6916) acc_x 78.1250 (82.8125) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/32] time 0.183 (0.182) data 0.106 (0.095) loss_x loss_x 0.2932 (0.6866) acc_x 90.6250 (82.7083) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/32] time 0.159 (0.181) data 0.081 (0.096) loss_x loss_x 1.3203 (0.7439) acc_x 65.6250 (80.7812) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/32] time 0.175 (0.178) data 0.098 (0.095) loss_x loss_x 0.6587 (0.7208) acc_x 78.1250 (80.6250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/32] time 0.179 (0.178) data 0.103 (0.096) loss_x loss_x 1.2334 (0.7398) acc_x 71.8750 (79.8958) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.6619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1059
clean true:1058
clean false:1
clean_rate:0.9990557129367328
noisy true:149
noisy false:392
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 541
epoch [34/200] batch [5/33] time 0.203 (0.190) data 0.128 (0.114) loss_x loss_x 0.4897 (0.6026) acc_x 87.5000 (83.7500) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/33] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.9526 (0.7227) acc_x 75.0000 (80.0000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/33] time 0.177 (0.187) data 0.101 (0.110) loss_x loss_x 0.6475 (0.7322) acc_x 78.1250 (80.0000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/33] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 1.1260 (0.7451) acc_x 75.0000 (79.3750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/33] time 0.181 (0.185) data 0.106 (0.109) loss_x loss_x 0.4636 (0.7136) acc_x 87.5000 (80.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [30/33] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.3555 (0.6924) acc_x 93.7500 (81.8750) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.6456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1033
clean true:1032
clean false:1
clean_rate:0.9990319457889641
noisy true:147
noisy false:420
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 567
epoch [35/200] batch [5/32] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.6016 (0.7045) acc_x 81.2500 (80.0000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/32] time 0.189 (0.185) data 0.113 (0.108) loss_x loss_x 0.4680 (0.6554) acc_x 87.5000 (82.5000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/32] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.8169 (0.6506) acc_x 81.2500 (82.9167) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/32] time 0.167 (0.183) data 0.090 (0.107) loss_x loss_x 0.5918 (0.6269) acc_x 75.0000 (83.4375) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/32] time 0.201 (0.184) data 0.124 (0.108) loss_x loss_x 0.2598 (0.6211) acc_x 90.6250 (82.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/32] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 1.0703 (0.6519) acc_x 75.0000 (82.0833) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.6669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1067
clean true:1066
clean false:1
clean_rate:0.9990627928772259
noisy true:140
noisy false:393
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 533
epoch [36/200] batch [5/33] time 0.188 (0.192) data 0.112 (0.115) loss_x loss_x 0.9624 (0.6604) acc_x 78.1250 (84.3750) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/33] time 0.198 (0.189) data 0.121 (0.112) loss_x loss_x 0.4382 (0.6895) acc_x 87.5000 (83.7500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/33] time 0.176 (0.187) data 0.100 (0.111) loss_x loss_x 0.8022 (0.6773) acc_x 84.3750 (83.5417) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/33] time 0.187 (0.184) data 0.111 (0.107) loss_x loss_x 0.5278 (0.6700) acc_x 87.5000 (83.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/33] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.6328 (0.6554) acc_x 87.5000 (84.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/33] time 0.223 (0.188) data 0.099 (0.107) loss_x loss_x 0.8940 (0.6376) acc_x 84.3750 (84.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.6500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1040
clean true:1039
clean false:1
clean_rate:0.9990384615384615
noisy true:147
noisy false:413
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 560
epoch [37/200] batch [5/32] time 0.164 (0.169) data 0.087 (0.093) loss_x loss_x 0.8076 (0.6839) acc_x 87.5000 (84.3750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/32] time 0.177 (0.168) data 0.101 (0.091) loss_x loss_x 1.0029 (0.7441) acc_x 71.8750 (81.8750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/32] time 0.182 (0.172) data 0.106 (0.095) loss_x loss_x 0.8374 (0.7212) acc_x 81.2500 (81.4583) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/32] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.8687 (0.6930) acc_x 78.1250 (83.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/32] time 0.179 (0.176) data 0.103 (0.100) loss_x loss_x 1.1143 (0.6670) acc_x 71.8750 (83.3750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/32] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.7520 (0.6523) acc_x 81.2500 (83.4375) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.6450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1032
clean true:1032
clean false:0
clean_rate:1.0
noisy true:155
noisy false:413
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 568
epoch [38/200] batch [5/32] time 0.182 (0.186) data 0.106 (0.110) loss_x loss_x 0.7422 (0.5303) acc_x 81.2500 (88.1250) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/32] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.4370 (0.5070) acc_x 87.5000 (87.1875) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/32] time 0.205 (0.186) data 0.127 (0.109) loss_x loss_x 0.5435 (0.5269) acc_x 84.3750 (86.0417) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/32] time 0.187 (0.191) data 0.110 (0.109) loss_x loss_x 0.8086 (0.5843) acc_x 81.2500 (85.6250) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/32] time 0.177 (0.189) data 0.100 (0.108) loss_x loss_x 0.6299 (0.6004) acc_x 81.2500 (85.3750) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/32] time 0.185 (0.187) data 0.108 (0.107) loss_x loss_x 0.5498 (0.5961) acc_x 84.3750 (85.4167) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.6606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1057
clean true:1057
clean false:0
clean_rate:1.0
noisy true:151
noisy false:392
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 543
epoch [39/200] batch [5/33] time 0.188 (0.189) data 0.112 (0.112) loss_x loss_x 0.1672 (0.6154) acc_x 96.8750 (83.7500) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/33] time 0.184 (0.202) data 0.108 (0.111) loss_x loss_x 0.7627 (0.7002) acc_x 81.2500 (80.6250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/33] time 0.185 (0.197) data 0.108 (0.111) loss_x loss_x 0.5405 (0.6141) acc_x 87.5000 (83.3333) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/33] time 0.163 (0.194) data 0.087 (0.109) loss_x loss_x 1.1455 (0.6071) acc_x 75.0000 (83.9062) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/33] time 0.182 (0.191) data 0.106 (0.109) loss_x loss_x 0.7021 (0.6046) acc_x 87.5000 (84.1250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/33] time 0.183 (0.190) data 0.107 (0.109) loss_x loss_x 0.5469 (0.5930) acc_x 81.2500 (84.1667) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1058
clean true:1057
clean false:1
clean_rate:0.999054820415879
noisy true:154
noisy false:388
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 542
epoch [40/200] batch [5/33] time 0.170 (0.176) data 0.093 (0.100) loss_x loss_x 0.7373 (0.6538) acc_x 81.2500 (84.3750) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/33] time 0.184 (0.176) data 0.107 (0.100) loss_x loss_x 0.5474 (0.6251) acc_x 84.3750 (84.6875) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/33] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.5161 (0.5581) acc_x 81.2500 (86.0417) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/33] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 0.8262 (0.5637) acc_x 78.1250 (86.4062) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/33] time 0.159 (0.179) data 0.083 (0.098) loss_x loss_x 0.8662 (0.6158) acc_x 71.8750 (84.3750) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [30/33] time 0.181 (0.177) data 0.104 (0.097) loss_x loss_x 0.7393 (0.6304) acc_x 84.3750 (84.4792) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.6606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1057
clean true:1056
clean false:1
clean_rate:0.9990539262062441
noisy true:138
noisy false:405
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 543
epoch [41/200] batch [5/33] time 0.188 (0.181) data 0.112 (0.104) loss_x loss_x 0.2042 (0.5961) acc_x 90.6250 (85.0000) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/33] time 0.183 (0.197) data 0.107 (0.106) loss_x loss_x 0.3081 (0.5992) acc_x 93.7500 (85.0000) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/33] time 0.184 (0.193) data 0.107 (0.107) loss_x loss_x 0.2961 (0.6030) acc_x 87.5000 (84.3750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/33] time 0.185 (0.191) data 0.108 (0.107) loss_x loss_x 0.5156 (0.6171) acc_x 87.5000 (84.2188) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/33] time 0.182 (0.189) data 0.105 (0.107) loss_x loss_x 0.7007 (0.6567) acc_x 84.3750 (83.5000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/33] time 0.183 (0.190) data 0.107 (0.108) loss_x loss_x 0.5225 (0.6321) acc_x 81.2500 (83.9583) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.6544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1047
clean true:1047
clean false:0
clean_rate:1.0
noisy true:150
noisy false:403
after delete: len(clean_dataset) 1047
after delete: len(noisy_dataset) 553
epoch [42/200] batch [5/32] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.5645 (0.4711) acc_x 81.2500 (86.8750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/32] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 0.7568 (0.5007) acc_x 75.0000 (86.8750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/32] time 0.266 (0.191) data 0.081 (0.107) loss_x loss_x 0.7124 (0.5586) acc_x 78.1250 (84.7917) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/32] time 0.185 (0.193) data 0.108 (0.106) loss_x loss_x 0.5552 (0.6059) acc_x 84.3750 (84.0625) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/32] time 0.181 (0.191) data 0.105 (0.106) loss_x loss_x 0.8057 (0.6452) acc_x 84.3750 (83.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/32] time 0.162 (0.186) data 0.085 (0.103) loss_x loss_x 1.0449 (0.6717) acc_x 81.2500 (82.9167) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.6506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1041
clean true:1041
clean false:0
clean_rate:1.0
noisy true:150
noisy false:409
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 559
epoch [43/200] batch [5/32] time 0.214 (0.179) data 0.137 (0.102) loss_x loss_x 0.5967 (0.6968) acc_x 87.5000 (84.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/32] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.3630 (0.6534) acc_x 90.6250 (85.3125) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/32] time 0.166 (0.178) data 0.090 (0.101) loss_x loss_x 0.7661 (0.6286) acc_x 78.1250 (85.0000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/32] time 0.199 (0.179) data 0.123 (0.103) loss_x loss_x 0.8018 (0.5966) acc_x 81.2500 (85.3125) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/32] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.3992 (0.6009) acc_x 90.6250 (84.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/32] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.7119 (0.5938) acc_x 81.2500 (84.6875) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.6769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1083
clean true:1082
clean false:1
clean_rate:0.9990766389658357
noisy true:152
noisy false:365
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 517
epoch [44/200] batch [5/33] time 0.175 (0.189) data 0.098 (0.112) loss_x loss_x 0.7383 (0.7047) acc_x 75.0000 (80.6250) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/33] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.9199 (0.6295) acc_x 75.0000 (82.8125) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/33] time 0.181 (0.187) data 0.105 (0.111) loss_x loss_x 0.7476 (0.6426) acc_x 84.3750 (82.9167) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/33] time 0.181 (0.187) data 0.105 (0.110) loss_x loss_x 0.4058 (0.6459) acc_x 93.7500 (82.9688) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/33] time 0.190 (0.187) data 0.112 (0.111) loss_x loss_x 0.6045 (0.6995) acc_x 81.2500 (82.0000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/33] time 0.181 (0.187) data 0.105 (0.111) loss_x loss_x 0.8760 (0.6906) acc_x 84.3750 (82.1875) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.6606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1057
clean true:1057
clean false:0
clean_rate:1.0
noisy true:149
noisy false:394
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 543
epoch [45/200] batch [5/33] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.8628 (0.7120) acc_x 75.0000 (80.0000) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/33] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.7295 (0.7010) acc_x 81.2500 (80.9375) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/33] time 0.173 (0.187) data 0.097 (0.111) loss_x loss_x 0.9551 (0.6633) acc_x 71.8750 (81.6667) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/33] time 0.179 (0.187) data 0.103 (0.110) loss_x loss_x 0.7563 (0.6399) acc_x 81.2500 (82.8125) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/33] time 0.180 (0.186) data 0.103 (0.109) loss_x loss_x 0.3306 (0.6128) acc_x 90.6250 (83.3750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/33] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.9424 (0.6450) acc_x 78.1250 (82.2917) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.6656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1065
clean true:1065
clean false:0
clean_rate:1.0
noisy true:152
noisy false:383
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 535
epoch [46/200] batch [5/33] time 0.168 (0.186) data 0.091 (0.110) loss_x loss_x 0.8174 (0.6058) acc_x 84.3750 (84.3750) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/33] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 1.3408 (0.6907) acc_x 65.6250 (82.8125) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/33] time 0.162 (0.181) data 0.085 (0.104) loss_x loss_x 0.3887 (0.6119) acc_x 84.3750 (83.5417) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/33] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.9858 (0.6448) acc_x 71.8750 (82.0312) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/33] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.7905 (0.6341) acc_x 75.0000 (82.5000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/33] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.6191 (0.6034) acc_x 81.2500 (83.0208) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.6750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1080
clean true:1080
clean false:0
clean_rate:1.0
noisy true:151
noisy false:369
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 520
epoch [47/200] batch [5/33] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.7827 (0.6119) acc_x 81.2500 (83.1250) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/33] time 0.160 (0.171) data 0.084 (0.095) loss_x loss_x 0.5928 (0.6441) acc_x 87.5000 (82.1875) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/33] time 0.197 (0.179) data 0.122 (0.102) loss_x loss_x 0.1770 (0.6426) acc_x 96.8750 (82.7083) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/33] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 1.1064 (0.7030) acc_x 75.0000 (81.7188) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/33] time 0.167 (0.180) data 0.090 (0.104) loss_x loss_x 0.4927 (0.6826) acc_x 84.3750 (81.8750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/33] time 0.191 (0.180) data 0.114 (0.104) loss_x loss_x 0.1921 (0.6684) acc_x 96.8750 (82.2917) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.6656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1065
clean true:1064
clean false:1
clean_rate:0.9990610328638497
noisy true:154
noisy false:381
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 535
epoch [48/200] batch [5/33] time 0.196 (0.216) data 0.120 (0.115) loss_x loss_x 1.1094 (0.8334) acc_x 68.7500 (78.7500) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/33] time 0.188 (0.201) data 0.112 (0.112) loss_x loss_x 0.7988 (0.6911) acc_x 81.2500 (81.8750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/33] time 0.186 (0.196) data 0.109 (0.111) loss_x loss_x 0.6670 (0.6500) acc_x 84.3750 (82.7083) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/33] time 0.189 (0.193) data 0.112 (0.111) loss_x loss_x 0.6021 (0.6104) acc_x 81.2500 (83.7500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/33] time 0.184 (0.191) data 0.108 (0.110) loss_x loss_x 0.5693 (0.6554) acc_x 84.3750 (83.1250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/33] time 0.279 (0.193) data 0.106 (0.109) loss_x loss_x 0.3809 (0.6539) acc_x 93.7500 (83.5417) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.6706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1073
clean true:1073
clean false:0
clean_rate:1.0
noisy true:149
noisy false:378
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 527
epoch [49/200] batch [5/33] time 0.226 (0.192) data 0.149 (0.116) loss_x loss_x 0.4788 (0.6305) acc_x 84.3750 (83.7500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/33] time 0.198 (0.187) data 0.122 (0.110) loss_x loss_x 0.6938 (0.6467) acc_x 78.1250 (83.4375) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/33] time 0.188 (0.187) data 0.112 (0.111) loss_x loss_x 1.1025 (0.6613) acc_x 78.1250 (82.7083) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/33] time 0.188 (0.193) data 0.111 (0.111) loss_x loss_x 0.8325 (0.6908) acc_x 81.2500 (81.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/33] time 0.186 (0.190) data 0.109 (0.110) loss_x loss_x 0.5977 (0.7015) acc_x 84.3750 (81.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/33] time 0.171 (0.187) data 0.094 (0.107) loss_x loss_x 0.5991 (0.6885) acc_x 81.2500 (81.4583) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.6631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1061
clean true:1059
clean false:2
clean_rate:0.998114985862394
noisy true:143
noisy false:396
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 539
epoch [50/200] batch [5/33] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.7905 (0.5824) acc_x 78.1250 (83.7500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/33] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.8354 (0.6783) acc_x 81.2500 (82.5000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/33] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.8589 (0.6157) acc_x 75.0000 (83.1250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/33] time 0.291 (0.191) data 0.106 (0.109) loss_x loss_x 0.8989 (0.6174) acc_x 71.8750 (83.2812) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/33] time 0.181 (0.193) data 0.105 (0.109) loss_x loss_x 0.3938 (0.5842) acc_x 87.5000 (84.0000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/33] time 0.189 (0.191) data 0.113 (0.109) loss_x loss_x 1.1680 (0.6295) acc_x 71.8750 (82.8125) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.6700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1072
clean true:1072
clean false:0
clean_rate:1.0
noisy true:147
noisy false:381
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 528
epoch [51/200] batch [5/33] time 0.193 (0.190) data 0.116 (0.114) loss_x loss_x 0.7310 (0.7155) acc_x 78.1250 (84.3750) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/33] time 0.185 (0.187) data 0.108 (0.111) loss_x loss_x 1.0508 (0.7035) acc_x 75.0000 (82.5000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/33] time 0.299 (0.195) data 0.112 (0.111) loss_x loss_x 0.2395 (0.6624) acc_x 90.6250 (83.3333) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/33] time 0.176 (0.192) data 0.099 (0.110) loss_x loss_x 0.4729 (0.6370) acc_x 84.3750 (83.2812) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/33] time 0.161 (0.187) data 0.085 (0.106) loss_x loss_x 1.0723 (0.6323) acc_x 81.2500 (83.6250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/33] time 0.169 (0.183) data 0.093 (0.103) loss_x loss_x 0.6685 (0.6334) acc_x 81.2500 (83.6458) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.6762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1082
clean true:1081
clean false:1
clean_rate:0.9990757855822551
noisy true:149
noisy false:369
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 518
epoch [52/200] batch [5/33] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.8120 (0.7215) acc_x 65.6250 (81.2500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/33] time 0.176 (0.185) data 0.100 (0.098) loss_x loss_x 0.5942 (0.6408) acc_x 87.5000 (83.7500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/33] time 0.183 (0.184) data 0.105 (0.100) loss_x loss_x 0.5537 (0.5877) acc_x 87.5000 (84.5833) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/33] time 0.168 (0.183) data 0.091 (0.101) loss_x loss_x 0.7085 (0.6146) acc_x 84.3750 (83.9062) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/33] time 0.174 (0.181) data 0.097 (0.100) loss_x loss_x 0.3728 (0.5985) acc_x 90.6250 (84.1250) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/33] time 0.183 (0.184) data 0.106 (0.100) loss_x loss_x 0.5293 (0.6212) acc_x 87.5000 (83.1250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.6737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1078
clean true:1077
clean false:1
clean_rate:0.9990723562152134
noisy true:149
noisy false:373
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 522
epoch [53/200] batch [5/33] time 0.178 (0.176) data 0.101 (0.100) loss_x loss_x 0.8281 (0.5664) acc_x 87.5000 (86.2500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/33] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.4114 (0.6132) acc_x 87.5000 (83.1250) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/33] time 0.187 (0.179) data 0.110 (0.102) loss_x loss_x 0.3875 (0.5539) acc_x 87.5000 (85.4167) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/33] time 0.181 (0.187) data 0.105 (0.104) loss_x loss_x 0.6450 (0.5765) acc_x 75.0000 (84.5312) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/33] time 0.180 (0.185) data 0.104 (0.104) loss_x loss_x 0.5767 (0.5946) acc_x 87.5000 (84.3750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/33] time 0.182 (0.186) data 0.104 (0.106) loss_x loss_x 0.6875 (0.5808) acc_x 84.3750 (85.0000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.6669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1067
clean true:1067
clean false:0
clean_rate:1.0
noisy true:159
noisy false:374
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 533
epoch [54/200] batch [5/33] time 0.170 (0.181) data 0.094 (0.104) loss_x loss_x 0.7129 (0.5880) acc_x 81.2500 (84.3750) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/33] time 0.160 (0.188) data 0.084 (0.098) loss_x loss_x 0.6519 (0.6571) acc_x 78.1250 (82.5000) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/33] time 0.182 (0.181) data 0.106 (0.096) loss_x loss_x 0.5459 (0.6324) acc_x 93.7500 (83.7500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/33] time 0.179 (0.177) data 0.102 (0.094) loss_x loss_x 0.4172 (0.6429) acc_x 90.6250 (83.9062) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/33] time 0.164 (0.176) data 0.087 (0.095) loss_x loss_x 0.4958 (0.6370) acc_x 87.5000 (83.8750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/33] time 0.182 (0.175) data 0.106 (0.095) loss_x loss_x 1.1719 (0.6775) acc_x 75.0000 (83.1250) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.6794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1087
clean true:1087
clean false:0
clean_rate:1.0
noisy true:150
noisy false:363
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 513
epoch [55/200] batch [5/33] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.4575 (0.5609) acc_x 84.3750 (83.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/33] time 0.179 (0.198) data 0.102 (0.108) loss_x loss_x 0.6343 (0.5589) acc_x 78.1250 (83.7500) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/33] time 0.159 (0.191) data 0.083 (0.105) loss_x loss_x 0.5371 (0.6075) acc_x 81.2500 (82.7083) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/33] time 0.191 (0.188) data 0.114 (0.105) loss_x loss_x 0.6396 (0.6131) acc_x 84.3750 (82.3438) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/33] time 0.168 (0.186) data 0.092 (0.104) loss_x loss_x 0.8467 (0.6212) acc_x 78.1250 (82.0000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/33] time 0.197 (0.191) data 0.121 (0.106) loss_x loss_x 0.4417 (0.6161) acc_x 87.5000 (82.1875) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1109
clean false:1
clean_rate:0.9990990990990991
noisy true:149
noisy false:341
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [56/200] batch [5/34] time 0.203 (0.198) data 0.126 (0.122) loss_x loss_x 0.8408 (0.6608) acc_x 84.3750 (83.1250) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/34] time 0.195 (0.198) data 0.119 (0.122) loss_x loss_x 0.2876 (0.5900) acc_x 90.6250 (85.0000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/34] time 0.183 (0.193) data 0.107 (0.116) loss_x loss_x 0.4819 (0.5721) acc_x 87.5000 (85.8333) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/34] time 0.175 (0.189) data 0.097 (0.113) loss_x loss_x 0.6235 (0.5876) acc_x 87.5000 (85.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/34] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 1.3213 (0.5948) acc_x 59.3750 (84.8750) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/34] time 0.199 (0.188) data 0.122 (0.111) loss_x loss_x 0.7480 (0.5933) acc_x 81.2500 (85.1042) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.6675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1068
clean true:1068
clean false:0
clean_rate:1.0
noisy true:156
noisy false:376
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 532
epoch [57/200] batch [5/33] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 1.0537 (0.6631) acc_x 75.0000 (83.1250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/33] time 0.165 (0.176) data 0.089 (0.099) loss_x loss_x 0.4741 (0.6053) acc_x 87.5000 (83.4375) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/33] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 0.7329 (0.6221) acc_x 84.3750 (83.1250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/33] time 0.175 (0.183) data 0.098 (0.099) loss_x loss_x 1.0469 (0.6672) acc_x 68.7500 (81.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/33] time 0.190 (0.183) data 0.112 (0.100) loss_x loss_x 0.7417 (0.6421) acc_x 75.0000 (82.2500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/33] time 0.173 (0.183) data 0.096 (0.101) loss_x loss_x 0.3062 (0.6225) acc_x 93.7500 (83.0208) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.6750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1080
clean true:1078
clean false:2
clean_rate:0.9981481481481481
noisy true:145
noisy false:375
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 520
epoch [58/200] batch [5/33] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.8892 (0.6237) acc_x 71.8750 (82.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/33] time 0.194 (0.186) data 0.117 (0.109) loss_x loss_x 0.5054 (0.5936) acc_x 87.5000 (84.6875) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/33] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 1.0039 (0.6208) acc_x 78.1250 (84.5833) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/33] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.4285 (0.6047) acc_x 87.5000 (84.6875) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/33] time 0.192 (0.177) data 0.115 (0.100) loss_x loss_x 0.5874 (0.6163) acc_x 81.2500 (83.6250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/33] time 0.178 (0.177) data 0.102 (0.100) loss_x loss_x 0.3660 (0.5894) acc_x 90.6250 (84.3750) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1104
clean false:1
clean_rate:0.9990950226244344
noisy true:152
noisy false:343
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [59/200] batch [5/34] time 0.191 (0.198) data 0.114 (0.108) loss_x loss_x 0.5713 (0.7273) acc_x 84.3750 (80.0000) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/34] time 0.163 (0.184) data 0.087 (0.101) loss_x loss_x 0.5596 (0.6056) acc_x 90.6250 (83.4375) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/34] time 0.157 (0.177) data 0.081 (0.096) loss_x loss_x 1.1719 (0.6476) acc_x 71.8750 (82.7083) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/34] time 0.165 (0.174) data 0.089 (0.094) loss_x loss_x 0.7588 (0.6506) acc_x 78.1250 (82.9688) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/34] time 0.160 (0.172) data 0.083 (0.093) loss_x loss_x 0.8398 (0.6401) acc_x 81.2500 (83.0000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/34] time 0.170 (0.173) data 0.093 (0.094) loss_x loss_x 0.6460 (0.6326) acc_x 84.3750 (83.2292) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.6825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1092
clean true:1092
clean false:0
clean_rate:1.0
noisy true:156
noisy false:352
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 508
epoch [60/200] batch [5/34] time 0.175 (0.167) data 0.099 (0.090) loss_x loss_x 0.6294 (0.6539) acc_x 78.1250 (82.5000) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/34] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.5278 (0.6427) acc_x 90.6250 (83.4375) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/34] time 0.175 (0.176) data 0.099 (0.099) loss_x loss_x 0.7651 (0.6539) acc_x 75.0000 (81.8750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/34] time 0.178 (0.176) data 0.102 (0.100) loss_x loss_x 0.6094 (0.6963) acc_x 84.3750 (81.4062) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/34] time 0.161 (0.181) data 0.084 (0.100) loss_x loss_x 0.5420 (0.6847) acc_x 87.5000 (82.2500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/34] time 0.198 (0.181) data 0.119 (0.100) loss_x loss_x 0.5527 (0.6585) acc_x 87.5000 (83.2292) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.6737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1078
clean true:1077
clean false:1
clean_rate:0.9990723562152134
noisy true:152
noisy false:370
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 522
epoch [61/200] batch [5/33] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.3525 (0.6221) acc_x 90.6250 (83.7500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/33] time 0.171 (0.173) data 0.095 (0.097) loss_x loss_x 0.9902 (0.6163) acc_x 75.0000 (83.7500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/33] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.4954 (0.6018) acc_x 84.3750 (83.7500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/33] time 0.164 (0.173) data 0.087 (0.096) loss_x loss_x 0.4333 (0.5890) acc_x 90.6250 (84.3750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/33] time 0.275 (0.182) data 0.114 (0.102) loss_x loss_x 0.7690 (0.6189) acc_x 75.0000 (83.7500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/33] time 0.175 (0.180) data 0.098 (0.101) loss_x loss_x 0.5151 (0.6274) acc_x 87.5000 (83.4375) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1107
clean false:0
clean_rate:1.0
noisy true:143
noisy false:350
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [62/200] batch [5/34] time 0.188 (0.204) data 0.112 (0.127) loss_x loss_x 0.5132 (0.4554) acc_x 81.2500 (85.0000) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/34] time 0.168 (0.187) data 0.091 (0.110) loss_x loss_x 0.5864 (0.5146) acc_x 87.5000 (84.0625) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/34] time 0.174 (0.185) data 0.097 (0.108) loss_x loss_x 0.7427 (0.5592) acc_x 87.5000 (84.7917) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/34] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 1.0088 (0.5991) acc_x 75.0000 (84.5312) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/34] time 0.189 (0.184) data 0.113 (0.108) loss_x loss_x 0.8564 (0.6081) acc_x 84.3750 (84.2500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/34] time 0.160 (0.183) data 0.082 (0.106) loss_x loss_x 0.6729 (0.6215) acc_x 81.2500 (83.4375) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.6712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1074
clean true:1074
clean false:0
clean_rate:1.0
noisy true:153
noisy false:373
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 526
epoch [63/200] batch [5/33] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.6406 (0.7568) acc_x 78.1250 (80.6250) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/33] time 0.168 (0.195) data 0.091 (0.096) loss_x loss_x 0.5776 (0.6517) acc_x 81.2500 (83.1250) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/33] time 0.183 (0.190) data 0.107 (0.099) loss_x loss_x 0.6455 (0.6548) acc_x 75.0000 (82.7083) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/33] time 0.167 (0.191) data 0.091 (0.104) loss_x loss_x 0.3792 (0.6159) acc_x 90.6250 (84.0625) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/33] time 0.166 (0.187) data 0.090 (0.101) loss_x loss_x 0.6265 (0.6281) acc_x 84.3750 (83.3750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/33] time 0.160 (0.182) data 0.082 (0.099) loss_x loss_x 0.6626 (0.6349) acc_x 78.1250 (83.2292) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.6737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1078
clean true:1078
clean false:0
clean_rate:1.0
noisy true:157
noisy false:365
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 522
epoch [64/200] batch [5/33] time 0.185 (0.182) data 0.109 (0.106) loss_x loss_x 0.9780 (0.9213) acc_x 71.8750 (76.8750) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/33] time 0.188 (0.184) data 0.112 (0.108) loss_x loss_x 0.6953 (0.7551) acc_x 84.3750 (80.6250) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/33] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.7339 (0.7259) acc_x 78.1250 (81.8750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/33] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.9507 (0.6880) acc_x 71.8750 (81.8750) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/33] time 0.182 (0.191) data 0.105 (0.109) loss_x loss_x 0.5430 (0.6753) acc_x 81.2500 (82.5000) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/33] time 0.175 (0.187) data 0.097 (0.106) loss_x loss_x 0.9990 (0.6922) acc_x 75.0000 (82.3958) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1094
clean true:1094
clean false:0
clean_rate:1.0
noisy true:156
noisy false:350
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 506
epoch [65/200] batch [5/34] time 0.183 (0.174) data 0.107 (0.098) loss_x loss_x 0.7090 (0.6917) acc_x 81.2500 (81.2500) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/34] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.5181 (0.5857) acc_x 84.3750 (84.6875) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/34] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.9146 (0.6075) acc_x 81.2500 (85.0000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/34] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.9985 (0.6317) acc_x 75.0000 (84.2188) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/34] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.9536 (0.6616) acc_x 71.8750 (83.2500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/34] time 0.295 (0.185) data 0.109 (0.104) loss_x loss_x 0.7456 (0.6554) acc_x 75.0000 (83.5417) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.6731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1077
clean true:1077
clean false:0
clean_rate:1.0
noisy true:149
noisy false:374
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 523
epoch [66/200] batch [5/33] time 0.209 (0.200) data 0.132 (0.123) loss_x loss_x 0.4753 (0.5165) acc_x 87.5000 (85.6250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/33] time 0.179 (0.192) data 0.102 (0.116) loss_x loss_x 0.3831 (0.5148) acc_x 87.5000 (85.9375) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/33] time 0.188 (0.190) data 0.112 (0.113) loss_x loss_x 0.4192 (0.5125) acc_x 87.5000 (85.4167) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/33] time 0.181 (0.188) data 0.105 (0.111) loss_x loss_x 0.3647 (0.5534) acc_x 87.5000 (83.9062) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/33] time 0.186 (0.187) data 0.110 (0.111) loss_x loss_x 0.4460 (0.5570) acc_x 87.5000 (83.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/33] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.6338 (0.5636) acc_x 78.1250 (83.1250) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.6681, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1069
clean true:1069
clean false:0
clean_rate:1.0
noisy true:150
noisy false:381
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 531
epoch [67/200] batch [5/33] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.6104 (0.7640) acc_x 81.2500 (78.1250) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/33] time 0.185 (0.176) data 0.108 (0.100) loss_x loss_x 0.3379 (0.7395) acc_x 93.7500 (80.3125) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/33] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.4783 (0.7031) acc_x 90.6250 (82.0833) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/33] time 0.187 (0.179) data 0.111 (0.102) loss_x loss_x 1.1279 (0.7244) acc_x 68.7500 (81.4062) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/33] time 0.158 (0.179) data 0.082 (0.102) loss_x loss_x 0.3179 (0.6637) acc_x 93.7500 (82.8750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/33] time 0.182 (0.179) data 0.106 (0.103) loss_x loss_x 0.8862 (0.6662) acc_x 75.0000 (82.7083) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.6719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1075
clean true:1075
clean false:0
clean_rate:1.0
noisy true:161
noisy false:364
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 525
epoch [68/200] batch [5/33] time 0.183 (0.194) data 0.106 (0.118) loss_x loss_x 0.2722 (0.5209) acc_x 93.7500 (86.8750) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/33] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.6528 (0.5866) acc_x 84.3750 (84.0625) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/33] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5464 (0.6027) acc_x 81.2500 (84.3750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/33] time 0.180 (0.185) data 0.104 (0.108) loss_x loss_x 0.2524 (0.5799) acc_x 93.7500 (84.8438) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/33] time 0.170 (0.187) data 0.093 (0.107) loss_x loss_x 0.4241 (0.5978) acc_x 87.5000 (84.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/33] time 0.161 (0.183) data 0.085 (0.104) loss_x loss_x 0.5317 (0.5653) acc_x 81.2500 (85.0000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:156
noisy false:336
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 492
epoch [69/200] batch [5/34] time 0.175 (0.183) data 0.098 (0.106) loss_x loss_x 0.1808 (0.4741) acc_x 96.8750 (86.8750) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/34] time 0.173 (0.177) data 0.096 (0.100) loss_x loss_x 0.3098 (0.5244) acc_x 90.6250 (84.6875) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/34] time 0.170 (0.183) data 0.093 (0.099) loss_x loss_x 0.3335 (0.5722) acc_x 90.6250 (84.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/34] time 0.188 (0.182) data 0.112 (0.099) loss_x loss_x 0.3577 (0.5903) acc_x 87.5000 (84.6875) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/34] time 0.180 (0.182) data 0.103 (0.100) loss_x loss_x 0.5366 (0.5652) acc_x 90.6250 (85.0000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/34] time 0.169 (0.180) data 0.093 (0.100) loss_x loss_x 0.4304 (0.5719) acc_x 84.3750 (84.1667) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.6787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1086
clean true:1084
clean false:2
clean_rate:0.998158379373849
noisy true:153
noisy false:361
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 514
epoch [70/200] batch [5/33] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.8296 (0.6689) acc_x 78.1250 (83.1250) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/33] time 0.177 (0.174) data 0.101 (0.098) loss_x loss_x 1.1709 (0.7650) acc_x 84.3750 (81.2500) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/33] time 0.172 (0.175) data 0.096 (0.099) loss_x loss_x 1.4160 (0.7880) acc_x 65.6250 (80.6250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/33] time 0.191 (0.180) data 0.116 (0.103) loss_x loss_x 0.6060 (0.7333) acc_x 90.6250 (82.5000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/33] time 0.159 (0.179) data 0.083 (0.102) loss_x loss_x 0.7725 (0.7044) acc_x 84.3750 (82.6250) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/33] time 0.291 (0.182) data 0.110 (0.102) loss_x loss_x 0.6821 (0.7018) acc_x 87.5000 (82.6042) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1098
clean true:1098
clean false:0
clean_rate:1.0
noisy true:152
noisy false:350
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 502
epoch [71/200] batch [5/34] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.5601 (0.5874) acc_x 84.3750 (85.0000) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/34] time 0.216 (0.186) data 0.139 (0.110) loss_x loss_x 0.4529 (0.5388) acc_x 93.7500 (87.5000) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/34] time 0.157 (0.190) data 0.081 (0.114) loss_x loss_x 0.9043 (0.6489) acc_x 81.2500 (84.5833) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/34] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.5708 (0.6179) acc_x 81.2500 (84.5312) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/34] time 0.174 (0.183) data 0.096 (0.106) loss_x loss_x 0.5298 (0.6071) acc_x 84.3750 (85.0000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/34] time 0.196 (0.184) data 0.120 (0.107) loss_x loss_x 0.6221 (0.6004) acc_x 84.3750 (85.0000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1106
clean true:1104
clean false:2
clean_rate:0.9981916817359855
noisy true:146
noisy false:348
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 494
epoch [72/200] batch [5/34] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.4648 (0.6437) acc_x 87.5000 (81.8750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/34] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.9858 (0.5822) acc_x 78.1250 (84.0625) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/34] time 0.206 (0.186) data 0.116 (0.108) loss_x loss_x 0.4050 (0.5964) acc_x 90.6250 (83.3333) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/34] time 0.183 (0.187) data 0.106 (0.108) loss_x loss_x 0.6050 (0.5955) acc_x 87.5000 (83.7500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/34] time 0.193 (0.186) data 0.117 (0.107) loss_x loss_x 0.2482 (0.5914) acc_x 96.8750 (84.2500) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/34] time 0.185 (0.189) data 0.109 (0.111) loss_x loss_x 0.9292 (0.5862) acc_x 75.0000 (84.4792) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:150
noisy false:342
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 492
epoch [73/200] batch [5/34] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.5845 (0.5611) acc_x 84.3750 (88.7500) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/34] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.4343 (0.5368) acc_x 84.3750 (88.7500) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/34] time 0.170 (0.178) data 0.094 (0.102) loss_x loss_x 0.6104 (0.5563) acc_x 78.1250 (87.2917) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/34] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.6523 (0.6064) acc_x 81.2500 (85.3125) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/34] time 0.163 (0.177) data 0.085 (0.100) loss_x loss_x 0.9937 (0.6205) acc_x 81.2500 (85.2500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/34] time 0.176 (0.176) data 0.100 (0.100) loss_x loss_x 0.6069 (0.6223) acc_x 81.2500 (85.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:150
noisy false:341
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 491
epoch [74/200] batch [5/34] time 0.185 (0.176) data 0.109 (0.099) loss_x loss_x 0.5117 (0.5098) acc_x 81.2500 (85.0000) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/34] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 1.1221 (0.5542) acc_x 68.7500 (84.0625) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/34] time 0.172 (0.173) data 0.096 (0.096) loss_x loss_x 0.3450 (0.5981) acc_x 90.6250 (83.7500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/34] time 0.177 (0.173) data 0.101 (0.097) loss_x loss_x 0.4734 (0.6000) acc_x 87.5000 (83.9062) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/34] time 0.186 (0.181) data 0.109 (0.099) loss_x loss_x 0.8872 (0.5796) acc_x 75.0000 (84.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/34] time 0.188 (0.182) data 0.112 (0.101) loss_x loss_x 0.4170 (0.5898) acc_x 84.3750 (84.0625) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.6756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1081
clean true:1081
clean false:0
clean_rate:1.0
noisy true:149
noisy false:370
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 519
epoch [75/200] batch [5/33] time 0.172 (0.167) data 0.096 (0.091) loss_x loss_x 0.7310 (0.5317) acc_x 78.1250 (84.3750) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/33] time 0.197 (0.179) data 0.121 (0.102) loss_x loss_x 0.4126 (0.5981) acc_x 93.7500 (84.3750) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/33] time 0.179 (0.180) data 0.103 (0.104) loss_x loss_x 0.3953 (0.5799) acc_x 90.6250 (85.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/33] time 0.184 (0.180) data 0.107 (0.104) loss_x loss_x 0.4841 (0.5631) acc_x 90.6250 (85.4688) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/33] time 0.166 (0.179) data 0.090 (0.102) loss_x loss_x 0.6235 (0.5868) acc_x 84.3750 (84.8750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/33] time 0.162 (0.176) data 0.086 (0.100) loss_x loss_x 0.2468 (0.5945) acc_x 90.6250 (84.3750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.6987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1118
clean true:1118
clean false:0
clean_rate:1.0
noisy true:151
noisy false:331
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 482
epoch [76/200] batch [5/34] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.8745 (0.6955) acc_x 75.0000 (81.8750) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/34] time 0.179 (0.192) data 0.102 (0.101) loss_x loss_x 0.2286 (0.5839) acc_x 93.7500 (84.3750) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/34] time 0.187 (0.191) data 0.111 (0.104) loss_x loss_x 0.6377 (0.5541) acc_x 81.2500 (85.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/34] time 0.170 (0.186) data 0.093 (0.102) loss_x loss_x 0.6553 (0.5679) acc_x 84.3750 (85.6250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/34] time 0.180 (0.186) data 0.104 (0.103) loss_x loss_x 0.3105 (0.5506) acc_x 90.6250 (85.6250) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/34] time 0.174 (0.184) data 0.098 (0.102) loss_x loss_x 0.6558 (0.5663) acc_x 84.3750 (85.3125) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1095
clean true:1095
clean false:0
clean_rate:1.0
noisy true:159
noisy false:346
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 505
epoch [77/200] batch [5/34] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 0.6123 (0.7074) acc_x 84.3750 (81.8750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/34] time 0.187 (0.184) data 0.111 (0.107) loss_x loss_x 0.2371 (0.5795) acc_x 90.6250 (84.0625) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/34] time 0.180 (0.194) data 0.104 (0.110) loss_x loss_x 0.7241 (0.5672) acc_x 81.2500 (84.1667) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/34] time 0.165 (0.187) data 0.088 (0.105) loss_x loss_x 0.3101 (0.5530) acc_x 93.7500 (85.3125) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/34] time 0.164 (0.183) data 0.087 (0.102) loss_x loss_x 0.5273 (0.5818) acc_x 81.2500 (84.6250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/34] time 0.179 (0.182) data 0.103 (0.102) loss_x loss_x 0.5078 (0.6014) acc_x 87.5000 (84.1667) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1086
clean true:1086
clean false:0
clean_rate:1.0
noisy true:164
noisy false:350
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 514
epoch [78/200] batch [5/33] time 0.204 (0.194) data 0.128 (0.117) loss_x loss_x 0.7256 (0.8053) acc_x 81.2500 (80.0000) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/33] time 0.169 (0.191) data 0.091 (0.114) loss_x loss_x 0.5537 (0.6718) acc_x 87.5000 (83.4375) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/33] time 0.160 (0.181) data 0.084 (0.104) loss_x loss_x 0.4431 (0.5998) acc_x 90.6250 (85.0000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/33] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.5107 (0.6100) acc_x 84.3750 (84.3750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/33] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.4871 (0.6034) acc_x 87.5000 (84.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/33] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.6714 (0.5987) acc_x 84.3750 (84.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1091
clean true:1088
clean false:3
clean_rate:0.997250229147571
noisy true:154
noisy false:355
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 509
epoch [79/200] batch [5/34] time 0.177 (0.184) data 0.099 (0.107) loss_x loss_x 0.8784 (0.6276) acc_x 71.8750 (82.5000) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/34] time 0.182 (0.193) data 0.105 (0.106) loss_x loss_x 0.4417 (0.5629) acc_x 87.5000 (83.4375) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/34] time 0.168 (0.188) data 0.092 (0.104) loss_x loss_x 0.6387 (0.5791) acc_x 87.5000 (83.5417) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/34] time 0.177 (0.187) data 0.101 (0.105) loss_x loss_x 0.5132 (0.5551) acc_x 87.5000 (84.2188) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/34] time 0.185 (0.186) data 0.108 (0.105) loss_x loss_x 0.5117 (0.5786) acc_x 84.3750 (84.1250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/34] time 0.180 (0.187) data 0.103 (0.107) loss_x loss_x 0.8115 (0.5988) acc_x 81.2500 (83.5417) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1096
clean true:1095
clean false:1
clean_rate:0.9990875912408759
noisy true:153
noisy false:351
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 504
epoch [80/200] batch [5/34] time 0.178 (0.180) data 0.102 (0.104) loss_x loss_x 0.4236 (0.6084) acc_x 87.5000 (83.1250) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/34] time 0.168 (0.179) data 0.088 (0.102) loss_x loss_x 1.1182 (0.5827) acc_x 68.7500 (84.0625) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/34] time 0.164 (0.175) data 0.088 (0.098) loss_x loss_x 0.7520 (0.5860) acc_x 78.1250 (83.9583) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/34] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.3293 (0.5404) acc_x 90.6250 (85.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/34] time 0.175 (0.175) data 0.099 (0.098) loss_x loss_x 0.4622 (0.5470) acc_x 87.5000 (85.1250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/34] time 0.167 (0.178) data 0.090 (0.097) loss_x loss_x 0.7573 (0.5423) acc_x 75.0000 (85.2083) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.6662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1066
clean true:1065
clean false:1
clean_rate:0.99906191369606
noisy true:147
noisy false:387
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 534
epoch [81/200] batch [5/33] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.4856 (0.5322) acc_x 93.7500 (88.7500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/33] time 0.162 (0.171) data 0.084 (0.095) loss_x loss_x 0.5645 (0.5417) acc_x 84.3750 (86.5625) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/33] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.6035 (0.5614) acc_x 81.2500 (85.8333) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/33] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 0.9785 (0.6112) acc_x 75.0000 (83.7500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/33] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 1.0557 (0.6023) acc_x 75.0000 (84.0000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/33] time 0.192 (0.180) data 0.115 (0.103) loss_x loss_x 0.4495 (0.5962) acc_x 81.2500 (84.0625) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.6956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1113
clean true:1111
clean false:2
clean_rate:0.9982030548068284
noisy true:148
noisy false:339
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 487
epoch [82/200] batch [5/34] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.7891 (0.7011) acc_x 75.0000 (80.6250) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/34] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.8350 (0.6555) acc_x 75.0000 (82.5000) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/34] time 0.196 (0.186) data 0.120 (0.110) loss_x loss_x 0.5610 (0.6489) acc_x 84.3750 (83.9583) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/34] time 0.187 (0.187) data 0.111 (0.110) loss_x loss_x 0.6060 (0.6161) acc_x 75.0000 (83.7500) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/34] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.6206 (0.6487) acc_x 84.3750 (83.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/34] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.3088 (0.6264) acc_x 93.7500 (83.9583) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1106
clean true:1103
clean false:3
clean_rate:0.9972875226039783
noisy true:151
noisy false:343
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 494
epoch [83/200] batch [5/34] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.5435 (0.6064) acc_x 87.5000 (81.8750) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/34] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.2507 (0.5571) acc_x 90.6250 (84.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/34] time 0.192 (0.182) data 0.113 (0.105) loss_x loss_x 0.5039 (0.5757) acc_x 90.6250 (84.3750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/34] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8374 (0.6231) acc_x 84.3750 (83.9062) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/34] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.6152 (0.5967) acc_x 81.2500 (84.6250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/34] time 0.203 (0.185) data 0.127 (0.108) loss_x loss_x 0.5405 (0.5804) acc_x 87.5000 (84.8958) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:150
noisy false:341
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 491
epoch [84/200] batch [5/34] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.5474 (0.4438) acc_x 84.3750 (88.1250) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/34] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6138 (0.5887) acc_x 81.2500 (84.3750) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/34] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.5581 (0.5721) acc_x 81.2500 (84.5833) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/34] time 0.188 (0.185) data 0.109 (0.108) loss_x loss_x 0.5767 (0.5410) acc_x 93.7500 (85.7812) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/34] time 0.189 (0.189) data 0.113 (0.112) loss_x loss_x 0.4937 (0.5230) acc_x 87.5000 (86.3750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/34] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 0.5547 (0.5305) acc_x 81.2500 (86.1458) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1126
clean false:1
clean_rate:0.9991126885536823
noisy true:152
noisy false:321
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [85/200] batch [5/35] time 0.159 (0.173) data 0.083 (0.097) loss_x loss_x 0.4250 (0.5787) acc_x 87.5000 (84.3750) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/35] time 0.188 (0.175) data 0.112 (0.098) loss_x loss_x 0.5869 (0.6694) acc_x 87.5000 (82.1875) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/35] time 0.178 (0.177) data 0.102 (0.101) loss_x loss_x 0.5449 (0.6611) acc_x 81.2500 (82.2917) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/35] time 0.173 (0.177) data 0.096 (0.101) loss_x loss_x 0.4961 (0.6199) acc_x 90.6250 (83.5938) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/35] time 0.175 (0.182) data 0.096 (0.101) loss_x loss_x 0.5083 (0.6598) acc_x 87.5000 (83.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/35] time 0.173 (0.181) data 0.097 (0.101) loss_x loss_x 0.4011 (0.6440) acc_x 81.2500 (83.2292) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [35/35] time 0.168 (0.181) data 0.091 (0.102) loss_x loss_x 0.6528 (0.6252) acc_x 87.5000 (83.4821) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.6862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1098
clean true:1098
clean false:0
clean_rate:1.0
noisy true:149
noisy false:353
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 502
epoch [86/200] batch [5/34] time 0.203 (0.191) data 0.126 (0.114) loss_x loss_x 0.6006 (0.6497) acc_x 81.2500 (83.7500) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/34] time 0.171 (0.186) data 0.094 (0.110) loss_x loss_x 0.3108 (0.5671) acc_x 87.5000 (85.0000) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/34] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.6611 (0.6207) acc_x 78.1250 (83.1250) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/34] time 0.163 (0.185) data 0.086 (0.109) loss_x loss_x 0.6357 (0.6038) acc_x 84.3750 (83.9062) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/34] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.7441 (0.5804) acc_x 84.3750 (84.8750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/34] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.5962 (0.5939) acc_x 81.2500 (84.4792) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.7081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1133
clean true:1131
clean false:2
clean_rate:0.9982347749338041
noisy true:147
noisy false:320
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 467
epoch [87/200] batch [5/35] time 0.246 (0.208) data 0.108 (0.097) loss_x loss_x 0.5083 (0.9258) acc_x 87.5000 (75.0000) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/35] time 0.190 (0.200) data 0.114 (0.106) loss_x loss_x 0.2639 (0.6968) acc_x 96.8750 (81.5625) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/35] time 0.181 (0.199) data 0.105 (0.111) loss_x loss_x 0.8281 (0.7115) acc_x 75.0000 (81.4583) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/35] time 0.158 (0.194) data 0.082 (0.109) loss_x loss_x 0.5615 (0.6720) acc_x 87.5000 (83.1250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/35] time 0.180 (0.190) data 0.104 (0.107) loss_x loss_x 0.3857 (0.6681) acc_x 90.6250 (83.6250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/35] time 0.185 (0.190) data 0.109 (0.107) loss_x loss_x 0.6675 (0.6512) acc_x 84.3750 (83.6458) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [35/35] time 0.215 (0.191) data 0.139 (0.109) loss_x loss_x 0.6094 (0.6455) acc_x 87.5000 (83.7500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:153
noisy false:339
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 492
epoch [88/200] batch [5/34] time 0.186 (0.191) data 0.110 (0.114) loss_x loss_x 0.4492 (0.5947) acc_x 90.6250 (86.2500) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/34] time 0.179 (0.186) data 0.103 (0.110) loss_x loss_x 0.6792 (0.6063) acc_x 84.3750 (85.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/34] time 0.178 (0.185) data 0.102 (0.109) loss_x loss_x 0.7939 (0.6353) acc_x 84.3750 (84.3750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/34] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.9194 (0.6469) acc_x 78.1250 (84.2188) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/34] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6646 (0.6315) acc_x 81.2500 (84.3750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/34] time 0.227 (0.187) data 0.151 (0.110) loss_x loss_x 0.3840 (0.6020) acc_x 90.6250 (84.0625) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1106
clean false:1
clean_rate:0.999096657633243
noisy true:149
noisy false:344
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [89/200] batch [5/34] time 0.178 (0.180) data 0.102 (0.103) loss_x loss_x 0.8833 (0.7831) acc_x 75.0000 (81.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/34] time 0.191 (0.176) data 0.114 (0.099) loss_x loss_x 0.6343 (0.6654) acc_x 84.3750 (83.4375) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/34] time 0.195 (0.180) data 0.119 (0.103) loss_x loss_x 0.3889 (0.6227) acc_x 93.7500 (83.3333) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/34] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.8047 (0.6526) acc_x 81.2500 (83.1250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/34] time 0.173 (0.175) data 0.095 (0.098) loss_x loss_x 0.4277 (0.6244) acc_x 87.5000 (83.7500) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/34] time 0.201 (0.176) data 0.125 (0.099) loss_x loss_x 0.5059 (0.6062) acc_x 84.3750 (83.8542) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:145
noisy false:355
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 500
epoch [90/200] batch [5/34] time 0.180 (0.187) data 0.103 (0.110) loss_x loss_x 0.5972 (0.5778) acc_x 84.3750 (85.0000) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/34] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.5161 (0.6482) acc_x 90.6250 (84.0625) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/34] time 0.169 (0.182) data 0.093 (0.105) loss_x loss_x 0.2971 (0.6308) acc_x 93.7500 (85.0000) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/34] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 0.2278 (0.6069) acc_x 93.7500 (84.8438) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/34] time 0.197 (0.180) data 0.121 (0.103) loss_x loss_x 0.3828 (0.5796) acc_x 90.6250 (85.0000) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/34] time 0.173 (0.184) data 0.097 (0.107) loss_x loss_x 0.2830 (0.5790) acc_x 90.6250 (84.2708) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1104
clean true:1103
clean false:1
clean_rate:0.9990942028985508
noisy true:152
noisy false:344
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 496
epoch [91/200] batch [5/34] time 0.191 (0.185) data 0.113 (0.109) loss_x loss_x 0.6069 (0.4906) acc_x 81.2500 (86.2500) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/34] time 0.192 (0.200) data 0.114 (0.110) loss_x loss_x 0.4553 (0.5523) acc_x 84.3750 (84.3750) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/34] time 0.183 (0.195) data 0.107 (0.110) loss_x loss_x 0.8452 (0.5550) acc_x 71.8750 (83.9583) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/34] time 0.167 (0.190) data 0.091 (0.107) loss_x loss_x 1.1240 (0.6149) acc_x 78.1250 (83.9062) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/34] time 0.166 (0.186) data 0.089 (0.104) loss_x loss_x 0.4731 (0.6211) acc_x 87.5000 (84.1250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/34] time 0.165 (0.183) data 0.089 (0.102) loss_x loss_x 0.4839 (0.6036) acc_x 90.6250 (84.5833) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.6800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1088
clean true:1087
clean false:1
clean_rate:0.9990808823529411
noisy true:157
noisy false:355
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 512
epoch [92/200] batch [5/34] time 0.163 (0.175) data 0.087 (0.098) loss_x loss_x 0.4146 (0.5607) acc_x 90.6250 (86.2500) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/34] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.5879 (0.5389) acc_x 81.2500 (85.9375) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/34] time 0.202 (0.193) data 0.125 (0.105) loss_x loss_x 0.7529 (0.5433) acc_x 81.2500 (85.8333) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/34] time 0.161 (0.190) data 0.084 (0.105) loss_x loss_x 0.5693 (0.5649) acc_x 81.2500 (85.0000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/34] time 0.203 (0.188) data 0.126 (0.105) loss_x loss_x 0.4414 (0.5680) acc_x 90.6250 (84.8750) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/34] time 0.171 (0.186) data 0.095 (0.103) loss_x loss_x 0.1973 (0.5730) acc_x 90.6250 (84.3750) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:151
noisy false:346
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [93/200] batch [5/34] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.3669 (0.5957) acc_x 84.3750 (80.6250) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/34] time 0.204 (0.189) data 0.128 (0.113) loss_x loss_x 0.8491 (0.5628) acc_x 78.1250 (83.7500) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/34] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.5352 (0.5618) acc_x 84.3750 (83.3333) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/34] time 0.175 (0.191) data 0.099 (0.109) loss_x loss_x 0.5269 (0.5389) acc_x 87.5000 (84.6875) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/34] time 0.180 (0.190) data 0.104 (0.108) loss_x loss_x 0.6616 (0.5532) acc_x 81.2500 (84.5000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/34] time 0.196 (0.189) data 0.119 (0.108) loss_x loss_x 0.4773 (0.5399) acc_x 90.6250 (84.4792) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1106
clean true:1106
clean false:0
clean_rate:1.0
noisy true:155
noisy false:339
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 494
epoch [94/200] batch [5/34] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.5762 (0.4937) acc_x 84.3750 (87.5000) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/34] time 0.184 (0.180) data 0.107 (0.104) loss_x loss_x 0.3904 (0.5428) acc_x 90.6250 (85.0000) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/34] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.6128 (0.5146) acc_x 81.2500 (85.8333) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/34] time 0.312 (0.186) data 0.126 (0.103) loss_x loss_x 1.0371 (0.5695) acc_x 75.0000 (83.5938) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/34] time 0.216 (0.192) data 0.140 (0.107) loss_x loss_x 0.5659 (0.5582) acc_x 84.3750 (84.2500) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/34] time 0.191 (0.195) data 0.115 (0.111) loss_x loss_x 0.8926 (0.5459) acc_x 75.0000 (84.5833) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:157
noisy false:340
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [95/200] batch [5/34] time 0.232 (0.203) data 0.155 (0.126) loss_x loss_x 0.2461 (0.4373) acc_x 93.7500 (89.3750) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/34] time 0.181 (0.194) data 0.105 (0.118) loss_x loss_x 0.6162 (0.4637) acc_x 81.2500 (87.8125) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/34] time 0.248 (0.195) data 0.171 (0.118) loss_x loss_x 0.5171 (0.5966) acc_x 87.5000 (84.5833) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/34] time 0.176 (0.193) data 0.098 (0.116) loss_x loss_x 0.8428 (0.6203) acc_x 71.8750 (83.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/34] time 0.163 (0.190) data 0.087 (0.113) loss_x loss_x 0.5161 (0.6129) acc_x 81.2500 (83.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/34] time 0.272 (0.193) data 0.107 (0.113) loss_x loss_x 0.4233 (0.6177) acc_x 90.6250 (83.9583) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.7063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1130
clean true:1130
clean false:0
clean_rate:1.0
noisy true:143
noisy false:327
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 470
epoch [96/200] batch [5/35] time 0.171 (0.185) data 0.095 (0.108) loss_x loss_x 0.4128 (0.5955) acc_x 84.3750 (85.6250) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/35] time 0.168 (0.193) data 0.090 (0.102) loss_x loss_x 0.4895 (0.6571) acc_x 81.2500 (83.1250) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/35] time 0.172 (0.188) data 0.095 (0.102) loss_x loss_x 0.6138 (0.5731) acc_x 81.2500 (84.7917) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/35] time 0.188 (0.186) data 0.111 (0.102) loss_x loss_x 0.2793 (0.5566) acc_x 93.7500 (85.4688) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/35] time 0.180 (0.185) data 0.104 (0.102) loss_x loss_x 1.1670 (0.5715) acc_x 68.7500 (84.8750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/35] time 0.184 (0.183) data 0.108 (0.101) loss_x loss_x 0.6338 (0.5669) acc_x 87.5000 (85.1042) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [35/35] time 0.181 (0.183) data 0.105 (0.102) loss_x loss_x 0.5933 (0.5685) acc_x 84.3750 (84.8214) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:150
noisy false:342
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 492
epoch [97/200] batch [5/34] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.5522 (0.5841) acc_x 90.6250 (87.5000) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/34] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.4163 (0.5063) acc_x 90.6250 (88.1250) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/34] time 0.162 (0.182) data 0.086 (0.097) loss_x loss_x 0.6909 (0.6071) acc_x 81.2500 (85.0000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/34] time 0.167 (0.181) data 0.090 (0.098) loss_x loss_x 0.7476 (0.6523) acc_x 84.3750 (84.2188) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/34] time 0.159 (0.177) data 0.083 (0.096) loss_x loss_x 0.2993 (0.6440) acc_x 90.6250 (84.6250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/34] time 0.186 (0.178) data 0.110 (0.098) loss_x loss_x 0.1545 (0.5992) acc_x 100.0000 (85.6250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.6806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1089
clean true:1089
clean false:0
clean_rate:1.0
noisy true:145
noisy false:366
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 511
epoch [98/200] batch [5/34] time 0.188 (0.188) data 0.112 (0.111) loss_x loss_x 0.2959 (0.6153) acc_x 87.5000 (86.2500) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/34] time 0.170 (0.183) data 0.093 (0.106) loss_x loss_x 0.7310 (0.6341) acc_x 87.5000 (86.2500) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/34] time 0.279 (0.188) data 0.095 (0.104) loss_x loss_x 0.1750 (0.6220) acc_x 93.7500 (85.0000) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/34] time 0.180 (0.188) data 0.104 (0.106) loss_x loss_x 0.6855 (0.6238) acc_x 78.1250 (84.5312) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/34] time 0.181 (0.187) data 0.103 (0.106) loss_x loss_x 0.7217 (0.6126) acc_x 81.2500 (84.7500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/34] time 0.184 (0.186) data 0.107 (0.106) loss_x loss_x 0.7593 (0.5979) acc_x 78.1250 (84.7917) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1095
clean true:1092
clean false:3
clean_rate:0.9972602739726028
noisy true:148
noisy false:357
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 505
epoch [99/200] batch [5/34] time 0.286 (0.210) data 0.099 (0.111) loss_x loss_x 0.6187 (0.5190) acc_x 81.2500 (86.8750) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [10/34] time 0.187 (0.204) data 0.109 (0.106) loss_x loss_x 0.4246 (0.5120) acc_x 87.5000 (86.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/34] time 0.191 (0.198) data 0.115 (0.107) loss_x loss_x 0.4275 (0.5446) acc_x 90.6250 (85.6250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/34] time 0.249 (0.203) data 0.106 (0.107) loss_x loss_x 0.4861 (0.5504) acc_x 84.3750 (85.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/34] time 0.192 (0.201) data 0.113 (0.109) loss_x loss_x 0.1927 (0.5124) acc_x 90.6250 (86.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/34] time 0.165 (0.196) data 0.087 (0.107) loss_x loss_x 0.3225 (0.5476) acc_x 93.7500 (85.6250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1100
clean true:1100
clean false:0
clean_rate:1.0
noisy true:146
noisy false:354
all clean rate:  [0.9954819277108434, 0.9925373134328358, 0.9989281886387996, 1.0, 0.9989473684210526, 1.0, 1.0, 0.9989939637826962, 0.9989878542510121, 1.0, 1.0, 0.9989816700610998, 1.0, 0.9989969909729187, 0.9990167158308751, 0.9990079365079365, 0.9980787704130644, 0.9970674486803519, 0.9990186457311089, 0.9989969909729187, 0.9990494296577946, 1.0, 0.9980694980694981, 1.0, 0.9980237154150198, 0.9990530303030303, 1.0, 1.0, 0.9990439770554493, 0.99906191369606, 1.0, 0.9990338164251208, 1.0, 0.9990557129367328, 0.9990319457889641, 0.9990627928772259, 0.9990384615384615, 1.0, 1.0, 0.999054820415879, 0.9990539262062441, 1.0, 1.0, 0.9990766389658357, 1.0, 1.0, 1.0, 0.9990610328638497, 1.0, 0.998114985862394, 1.0, 0.9990757855822551, 0.9990723562152134, 1.0, 1.0, 0.9990990990990991, 1.0, 0.9981481481481481, 0.9990950226244344, 1.0, 0.9990723562152134, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.998158379373849, 1.0, 0.9981916817359855, 0.9990974729241877, 1.0, 1.0, 1.0, 1.0, 1.0, 0.997250229147571, 0.9990875912408759, 0.99906191369606, 0.9982030548068284, 0.9972875226039783, 0.9990982867448152, 0.9991126885536823, 1.0, 0.9982347749338041, 1.0, 0.999096657633243, 0.9990909090909091, 0.9990942028985508, 0.9990808823529411, 1.0, 1.0, 1.0, 1.0, 0.9990974729241877, 1.0, 0.9972602739726028, 1.0]
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 500
epoch [100/200] batch [5/34] time 0.171 (0.175) data 0.095 (0.098) loss_x loss_x 0.7012 (0.5228) acc_x 81.2500 (85.0000) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/34] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.3491 (0.4994) acc_x 84.3750 (85.9375) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/34] time 0.177 (0.174) data 0.101 (0.098) loss_x loss_x 0.6963 (0.5257) acc_x 81.2500 (86.0417) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/34] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.5439 (0.5445) acc_x 81.2500 (85.1562) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/34] time 0.181 (0.173) data 0.105 (0.096) loss_x loss_x 0.2351 (0.5409) acc_x 93.7500 (85.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/34] time 0.194 (0.174) data 0.117 (0.097) loss_x loss_x 0.7441 (0.5698) acc_x 78.1250 (84.2708) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:147
noisy false:347
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 494
epoch [101/200] batch [5/34] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.3506 (0.4861) acc_x 87.5000 (85.6250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/34] time 0.182 (0.175) data 0.106 (0.099) loss_x loss_x 0.7461 (0.5281) acc_x 84.3750 (85.9375) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/34] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.8340 (0.5699) acc_x 84.3750 (85.2083) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/34] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.3083 (0.6069) acc_x 90.6250 (84.5312) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/34] time 0.190 (0.182) data 0.113 (0.105) loss_x loss_x 0.5698 (0.6274) acc_x 87.5000 (84.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/34] time 0.185 (0.187) data 0.108 (0.106) loss_x loss_x 0.3567 (0.6159) acc_x 90.6250 (84.2708) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1105
clean false:0
clean_rate:1.0
noisy true:149
noisy false:346
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [102/200] batch [5/34] time 0.177 (0.178) data 0.101 (0.102) loss_x loss_x 0.6743 (0.6315) acc_x 84.3750 (86.2500) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/34] time 0.239 (0.184) data 0.162 (0.108) loss_x loss_x 0.6323 (0.5948) acc_x 81.2500 (86.2500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/34] time 0.168 (0.181) data 0.092 (0.105) loss_x loss_x 0.4529 (0.5878) acc_x 84.3750 (85.6250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/34] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.3503 (0.5576) acc_x 90.6250 (86.2500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/34] time 0.169 (0.186) data 0.092 (0.106) loss_x loss_x 0.4077 (0.5688) acc_x 90.6250 (85.8750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/34] time 0.183 (0.185) data 0.106 (0.105) loss_x loss_x 0.5718 (0.5445) acc_x 81.2500 (86.2500) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:152
noisy false:348
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 500
epoch [103/200] batch [5/34] time 0.192 (0.176) data 0.116 (0.099) loss_x loss_x 0.4016 (0.5688) acc_x 84.3750 (82.5000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/34] time 0.178 (0.179) data 0.101 (0.103) loss_x loss_x 0.3054 (0.5796) acc_x 93.7500 (85.9375) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/34] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.5303 (0.5312) acc_x 81.2500 (85.8333) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/34] time 0.171 (0.177) data 0.094 (0.101) loss_x loss_x 0.4922 (0.5290) acc_x 81.2500 (85.7812) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/34] time 0.301 (0.183) data 0.115 (0.101) loss_x loss_x 0.2146 (0.5331) acc_x 96.8750 (85.5000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/34] time 0.189 (0.185) data 0.112 (0.103) loss_x loss_x 0.3967 (0.5561) acc_x 93.7500 (85.2083) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.7031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1125
clean true:1125
clean false:0
clean_rate:1.0
noisy true:145
noisy false:330
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 475
epoch [104/200] batch [5/35] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.4028 (0.5572) acc_x 93.7500 (83.1250) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/35] time 0.175 (0.178) data 0.099 (0.101) loss_x loss_x 0.3030 (0.5511) acc_x 90.6250 (84.0625) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/35] time 0.302 (0.191) data 0.134 (0.102) loss_x loss_x 0.3975 (0.5951) acc_x 90.6250 (83.3333) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/35] time 0.198 (0.192) data 0.121 (0.105) loss_x loss_x 0.1992 (0.5635) acc_x 90.6250 (83.9062) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/35] time 0.221 (0.192) data 0.145 (0.107) loss_x loss_x 0.6890 (0.5536) acc_x 87.5000 (84.5000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/35] time 0.175 (0.190) data 0.099 (0.107) loss_x loss_x 0.7144 (0.5630) acc_x 81.2500 (84.3750) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [35/35] time 0.183 (0.188) data 0.107 (0.105) loss_x loss_x 0.8501 (0.5656) acc_x 78.1250 (84.5536) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1104
clean true:1104
clean false:0
clean_rate:1.0
noisy true:154
noisy false:342
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 496
epoch [105/200] batch [5/34] time 0.172 (0.170) data 0.096 (0.094) loss_x loss_x 0.7158 (0.6426) acc_x 81.2500 (82.5000) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/34] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.6748 (0.6054) acc_x 81.2500 (83.4375) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/34] time 0.186 (0.171) data 0.110 (0.095) loss_x loss_x 0.6519 (0.5330) acc_x 87.5000 (85.8333) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/34] time 0.174 (0.182) data 0.097 (0.096) loss_x loss_x 0.5171 (0.5565) acc_x 87.5000 (85.7812) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/34] time 0.174 (0.180) data 0.097 (0.096) loss_x loss_x 0.5386 (0.5716) acc_x 87.5000 (85.1250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/34] time 0.173 (0.181) data 0.097 (0.098) loss_x loss_x 0.1910 (0.5576) acc_x 96.8750 (85.8333) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1101
clean true:1101
clean false:0
clean_rate:1.0
noisy true:152
noisy false:347
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 499
epoch [106/200] batch [5/34] time 0.202 (0.201) data 0.125 (0.119) loss_x loss_x 0.4001 (0.5470) acc_x 78.1250 (84.3750) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/34] time 0.197 (0.197) data 0.120 (0.109) loss_x loss_x 0.3184 (0.5360) acc_x 93.7500 (86.5625) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/34] time 0.196 (0.190) data 0.119 (0.106) loss_x loss_x 0.7749 (0.5320) acc_x 87.5000 (86.8750) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/34] time 0.185 (0.185) data 0.109 (0.103) loss_x loss_x 0.2216 (0.5169) acc_x 96.8750 (87.3438) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/34] time 0.170 (0.183) data 0.094 (0.103) loss_x loss_x 0.6733 (0.5428) acc_x 81.2500 (87.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/34] time 0.167 (0.181) data 0.090 (0.101) loss_x loss_x 0.2878 (0.5128) acc_x 87.5000 (87.7083) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:151
noisy false:348
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 499
epoch [107/200] batch [5/34] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.6870 (0.5515) acc_x 78.1250 (84.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/34] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.3877 (0.5557) acc_x 90.6250 (85.0000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/34] time 0.186 (0.181) data 0.111 (0.105) loss_x loss_x 0.2749 (0.5337) acc_x 90.6250 (85.0000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/34] time 0.188 (0.189) data 0.112 (0.107) loss_x loss_x 0.1794 (0.5005) acc_x 93.7500 (86.4062) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/34] time 0.186 (0.189) data 0.110 (0.108) loss_x loss_x 0.3096 (0.5111) acc_x 93.7500 (86.2500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/34] time 0.187 (0.189) data 0.111 (0.109) loss_x loss_x 0.1638 (0.5160) acc_x 96.8750 (86.0417) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1105
clean false:0
clean_rate:1.0
noisy true:156
noisy false:339
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [108/200] batch [5/34] time 0.187 (0.183) data 0.111 (0.106) loss_x loss_x 0.2272 (0.4875) acc_x 93.7500 (87.5000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/34] time 0.193 (0.184) data 0.117 (0.108) loss_x loss_x 0.3435 (0.4408) acc_x 87.5000 (87.5000) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/34] time 0.185 (0.198) data 0.108 (0.114) loss_x loss_x 0.3936 (0.4837) acc_x 87.5000 (86.2500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/34] time 0.214 (0.199) data 0.138 (0.117) loss_x loss_x 0.5454 (0.5473) acc_x 84.3750 (85.3125) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/34] time 0.172 (0.196) data 0.095 (0.115) loss_x loss_x 0.6777 (0.5450) acc_x 81.2500 (85.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/34] time 0.178 (0.194) data 0.101 (0.113) loss_x loss_x 0.1459 (0.5412) acc_x 96.8750 (86.1458) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1110
clean false:0
clean_rate:1.0
noisy true:153
noisy false:337
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [109/200] batch [5/34] time 0.190 (0.180) data 0.112 (0.103) loss_x loss_x 1.0869 (0.6603) acc_x 71.8750 (81.8750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/34] time 0.192 (0.183) data 0.116 (0.106) loss_x loss_x 1.1074 (0.6166) acc_x 75.0000 (84.0625) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/34] time 0.175 (0.189) data 0.099 (0.105) loss_x loss_x 0.6250 (0.6105) acc_x 87.5000 (83.7500) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/34] time 0.160 (0.185) data 0.083 (0.103) loss_x loss_x 0.4797 (0.6362) acc_x 90.6250 (83.4375) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/34] time 0.168 (0.183) data 0.092 (0.102) loss_x loss_x 0.7256 (0.6488) acc_x 75.0000 (82.8750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/34] time 0.171 (0.181) data 0.094 (0.101) loss_x loss_x 0.6738 (0.6392) acc_x 87.5000 (83.4375) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:141
noisy false:350
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 491
epoch [110/200] batch [5/34] time 0.164 (0.173) data 0.087 (0.095) loss_x loss_x 0.4060 (0.4942) acc_x 90.6250 (90.0000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/34] time 0.168 (0.177) data 0.090 (0.100) loss_x loss_x 0.4832 (0.5186) acc_x 81.2500 (88.7500) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/34] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.5957 (0.5198) acc_x 75.0000 (87.0833) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/34] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.2156 (0.5380) acc_x 93.7500 (85.9375) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/34] time 0.276 (0.182) data 0.091 (0.099) loss_x loss_x 0.6626 (0.5386) acc_x 81.2500 (85.5000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/34] time 0.169 (0.181) data 0.093 (0.100) loss_x loss_x 0.5063 (0.5249) acc_x 90.6250 (86.0417) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:145
noisy false:328
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [111/200] batch [5/35] time 0.194 (0.200) data 0.118 (0.123) loss_x loss_x 0.3899 (0.5121) acc_x 87.5000 (85.0000) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/35] time 0.190 (0.194) data 0.113 (0.118) loss_x loss_x 0.6855 (0.5504) acc_x 78.1250 (85.6250) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/35] time 0.188 (0.192) data 0.111 (0.115) loss_x loss_x 0.5195 (0.5598) acc_x 81.2500 (84.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/35] time 0.179 (0.197) data 0.103 (0.115) loss_x loss_x 0.5181 (0.5533) acc_x 90.6250 (85.3125) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/35] time 0.189 (0.195) data 0.112 (0.114) loss_x loss_x 0.5068 (0.5183) acc_x 84.3750 (86.3750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/35] time 0.179 (0.193) data 0.102 (0.112) loss_x loss_x 0.4448 (0.5005) acc_x 87.5000 (86.8750) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [35/35] time 0.163 (0.190) data 0.086 (0.110) loss_x loss_x 0.5679 (0.5177) acc_x 90.6250 (86.5179) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:156
noisy false:324
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [112/200] batch [5/35] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.2913 (0.4842) acc_x 93.7500 (90.6250) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/35] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.7021 (0.4938) acc_x 84.3750 (89.0625) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/35] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.4653 (0.4775) acc_x 93.7500 (89.5833) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/35] time 0.182 (0.193) data 0.105 (0.110) loss_x loss_x 0.9307 (0.5733) acc_x 68.7500 (86.7188) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/35] time 0.182 (0.192) data 0.105 (0.110) loss_x loss_x 0.7812 (0.5810) acc_x 78.1250 (86.1250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/35] time 0.184 (0.190) data 0.108 (0.108) loss_x loss_x 1.2451 (0.5945) acc_x 75.0000 (85.7292) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [35/35] time 0.156 (0.188) data 0.080 (0.107) loss_x loss_x 0.3843 (0.5570) acc_x 87.5000 (86.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1096
clean true:1094
clean false:2
clean_rate:0.9981751824817519
noisy true:159
noisy false:345
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 504
epoch [113/200] batch [5/34] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.3093 (0.5611) acc_x 93.7500 (85.6250) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/34] time 0.175 (0.182) data 0.097 (0.106) loss_x loss_x 0.4971 (0.5220) acc_x 87.5000 (86.2500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/34] time 0.165 (0.193) data 0.089 (0.109) loss_x loss_x 0.4497 (0.5154) acc_x 87.5000 (86.4583) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/34] time 0.176 (0.190) data 0.099 (0.107) loss_x loss_x 0.5503 (0.4862) acc_x 84.3750 (87.1875) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/34] time 0.183 (0.190) data 0.107 (0.109) loss_x loss_x 0.5195 (0.5024) acc_x 78.1250 (86.5000) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/34] time 0.178 (0.189) data 0.101 (0.108) loss_x loss_x 0.6714 (0.4980) acc_x 87.5000 (86.5625) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.7063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1130
clean true:1130
clean false:0
clean_rate:1.0
noisy true:156
noisy false:314
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 470
epoch [114/200] batch [5/35] time 0.168 (0.170) data 0.092 (0.094) loss_x loss_x 0.3477 (0.4147) acc_x 87.5000 (88.7500) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/35] time 0.180 (0.172) data 0.103 (0.096) loss_x loss_x 0.9160 (0.5300) acc_x 78.1250 (87.1875) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/35] time 0.172 (0.173) data 0.096 (0.097) loss_x loss_x 0.2896 (0.5477) acc_x 90.6250 (85.6250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/35] time 0.163 (0.171) data 0.086 (0.094) loss_x loss_x 0.1783 (0.5628) acc_x 93.7500 (85.3125) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/35] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.4727 (0.5713) acc_x 84.3750 (85.3750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/35] time 0.183 (0.178) data 0.107 (0.098) loss_x loss_x 0.5068 (0.5616) acc_x 81.2500 (85.2083) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [35/35] time 0.174 (0.177) data 0.098 (0.097) loss_x loss_x 0.4739 (0.5465) acc_x 90.6250 (85.9821) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.6956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1113
clean true:1112
clean false:1
clean_rate:0.9991015274034142
noisy true:143
noisy false:344
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 487
epoch [115/200] batch [5/34] time 0.194 (0.190) data 0.117 (0.113) loss_x loss_x 0.3579 (0.5185) acc_x 84.3750 (85.0000) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/34] time 0.173 (0.191) data 0.096 (0.110) loss_x loss_x 0.5991 (0.5932) acc_x 87.5000 (84.6875) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/34] time 0.169 (0.188) data 0.092 (0.108) loss_x loss_x 0.3816 (0.5631) acc_x 90.6250 (86.6667) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/34] time 0.173 (0.189) data 0.096 (0.107) loss_x loss_x 0.9741 (0.5921) acc_x 75.0000 (85.9375) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/34] time 0.169 (0.186) data 0.093 (0.105) loss_x loss_x 0.5439 (0.6004) acc_x 84.3750 (85.3750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/34] time 0.178 (0.185) data 0.102 (0.104) loss_x loss_x 1.0488 (0.6108) acc_x 71.8750 (85.2083) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.6944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1111
clean true:1110
clean false:1
clean_rate:0.9990999099909991
noisy true:149
noisy false:340
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 489
epoch [116/200] batch [5/34] time 0.308 (0.218) data 0.122 (0.112) loss_x loss_x 0.7065 (0.6184) acc_x 81.2500 (85.6250) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [10/34] time 0.199 (0.205) data 0.123 (0.114) loss_x loss_x 0.4241 (0.6121) acc_x 87.5000 (84.6875) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/34] time 0.182 (0.199) data 0.107 (0.112) loss_x loss_x 0.6123 (0.5831) acc_x 87.5000 (85.6250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/34] time 0.199 (0.195) data 0.123 (0.111) loss_x loss_x 0.2517 (0.5652) acc_x 90.6250 (85.7812) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/34] time 0.170 (0.189) data 0.094 (0.107) loss_x loss_x 0.9189 (0.5599) acc_x 75.0000 (85.7500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/34] time 0.164 (0.187) data 0.087 (0.106) loss_x loss_x 0.5400 (0.5536) acc_x 87.5000 (85.8333) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.7019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1123
clean true:1123
clean false:0
clean_rate:1.0
noisy true:157
noisy false:320
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 477
epoch [117/200] batch [5/35] time 0.291 (0.213) data 0.104 (0.110) loss_x loss_x 0.6221 (0.5101) acc_x 81.2500 (85.6250) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [10/35] time 0.209 (0.206) data 0.131 (0.116) loss_x loss_x 0.4338 (0.5744) acc_x 84.3750 (85.0000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [15/35] time 0.183 (0.196) data 0.107 (0.111) loss_x loss_x 0.7051 (0.5551) acc_x 87.5000 (86.8750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/35] time 0.181 (0.193) data 0.103 (0.109) loss_x loss_x 0.6816 (0.5551) acc_x 90.6250 (86.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/35] time 0.180 (0.189) data 0.104 (0.107) loss_x loss_x 0.2450 (0.5199) acc_x 90.6250 (87.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/35] time 0.170 (0.187) data 0.093 (0.106) loss_x loss_x 0.4009 (0.5289) acc_x 90.6250 (86.8750) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [35/35] time 0.181 (0.186) data 0.105 (0.106) loss_x loss_x 0.4109 (0.5535) acc_x 87.5000 (85.9821) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1144
clean true:1142
clean false:2
clean_rate:0.9982517482517482
noisy true:160
noisy false:296
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 456
epoch [118/200] batch [5/35] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.6226 (0.4930) acc_x 84.3750 (88.7500) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/35] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.3447 (0.4534) acc_x 90.6250 (87.5000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/35] time 0.269 (0.194) data 0.083 (0.106) loss_x loss_x 0.4250 (0.4753) acc_x 90.6250 (87.9167) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/35] time 0.161 (0.186) data 0.085 (0.101) loss_x loss_x 0.2754 (0.4868) acc_x 87.5000 (86.7188) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/35] time 0.181 (0.183) data 0.105 (0.099) loss_x loss_x 1.1318 (0.5367) acc_x 71.8750 (86.0000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/35] time 0.188 (0.183) data 0.111 (0.100) loss_x loss_x 0.4744 (0.5324) acc_x 87.5000 (86.1458) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [35/35] time 0.192 (0.184) data 0.116 (0.102) loss_x loss_x 0.9170 (0.5301) acc_x 71.8750 (85.8929) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1108
clean false:2
clean_rate:0.9981981981981982
noisy true:150
noisy false:340
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [119/200] batch [5/34] time 0.181 (0.194) data 0.104 (0.118) loss_x loss_x 0.6870 (0.4652) acc_x 81.2500 (88.1250) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/34] time 0.185 (0.190) data 0.109 (0.114) loss_x loss_x 0.2443 (0.4516) acc_x 93.7500 (86.5625) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/34] time 0.189 (0.188) data 0.113 (0.112) loss_x loss_x 0.4231 (0.4707) acc_x 81.2500 (87.0833) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/34] time 0.158 (0.183) data 0.082 (0.107) loss_x loss_x 0.5005 (0.4582) acc_x 81.2500 (87.6562) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/34] time 0.182 (0.193) data 0.106 (0.107) loss_x loss_x 0.3477 (0.4892) acc_x 87.5000 (86.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/34] time 0.184 (0.192) data 0.106 (0.109) loss_x loss_x 0.5967 (0.4823) acc_x 87.5000 (86.8750) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 322
confident_label rate tensor(0.7031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1125
clean true:1124
clean false:1
clean_rate:0.9991111111111111
noisy true:154
noisy false:321
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 475
epoch [120/200] batch [5/35] time 0.246 (0.203) data 0.170 (0.127) loss_x loss_x 0.5503 (0.4096) acc_x 87.5000 (88.7500) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [10/35] time 0.169 (0.186) data 0.093 (0.109) loss_x loss_x 0.3779 (0.4405) acc_x 87.5000 (87.8125) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/35] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5225 (0.5458) acc_x 84.3750 (85.2083) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/35] time 0.179 (0.184) data 0.103 (0.107) loss_x loss_x 0.6572 (0.5222) acc_x 84.3750 (86.0938) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/35] time 0.182 (0.188) data 0.105 (0.107) loss_x loss_x 0.2598 (0.4960) acc_x 87.5000 (86.3750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/35] time 0.183 (0.188) data 0.107 (0.107) loss_x loss_x 0.5220 (0.4878) acc_x 87.5000 (86.9792) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [35/35] time 0.180 (0.186) data 0.104 (0.106) loss_x loss_x 0.6626 (0.4893) acc_x 81.2500 (86.6964) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1109
clean false:1
clean_rate:0.9990990990990991
noisy true:160
noisy false:330
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [121/200] batch [5/34] time 0.167 (0.174) data 0.090 (0.098) loss_x loss_x 0.2192 (0.4538) acc_x 96.8750 (87.5000) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/34] time 0.185 (0.186) data 0.095 (0.099) loss_x loss_x 0.7070 (0.4511) acc_x 84.3750 (87.5000) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/34] time 0.195 (0.187) data 0.119 (0.104) loss_x loss_x 0.3325 (0.4377) acc_x 90.6250 (87.2917) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/34] time 0.196 (0.185) data 0.120 (0.104) loss_x loss_x 0.4165 (0.4569) acc_x 87.5000 (87.1875) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/34] time 0.168 (0.184) data 0.092 (0.103) loss_x loss_x 0.6870 (0.4989) acc_x 84.3750 (86.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/34] time 0.188 (0.187) data 0.111 (0.104) loss_x loss_x 0.2639 (0.5029) acc_x 96.8750 (86.5625) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1114
clean false:0
clean_rate:1.0
noisy true:153
noisy false:333
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [122/200] batch [5/34] time 0.203 (0.221) data 0.127 (0.123) loss_x loss_x 1.0713 (0.6674) acc_x 71.8750 (81.8750) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [10/34] time 0.186 (0.200) data 0.109 (0.112) loss_x loss_x 0.3438 (0.5781) acc_x 90.6250 (84.6875) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/34] time 0.177 (0.193) data 0.100 (0.109) loss_x loss_x 0.5518 (0.5869) acc_x 84.3750 (83.9583) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/34] time 0.202 (0.190) data 0.126 (0.108) loss_x loss_x 0.5635 (0.5790) acc_x 90.6250 (83.9062) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/34] time 0.169 (0.188) data 0.093 (0.107) loss_x loss_x 0.6548 (0.6013) acc_x 78.1250 (83.7500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/34] time 0.267 (0.192) data 0.120 (0.109) loss_x loss_x 0.3586 (0.5835) acc_x 87.5000 (84.1667) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.6950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1112
clean true:1110
clean false:2
clean_rate:0.9982014388489209
noisy true:147
noisy false:341
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 488
epoch [123/200] batch [5/34] time 0.168 (0.173) data 0.092 (0.096) loss_x loss_x 0.8071 (0.5311) acc_x 81.2500 (88.1250) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/34] time 0.166 (0.169) data 0.089 (0.093) loss_x loss_x 0.5908 (0.5392) acc_x 90.6250 (89.3750) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/34] time 0.180 (0.174) data 0.104 (0.098) loss_x loss_x 1.1934 (0.5955) acc_x 81.2500 (87.9167) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/34] time 0.291 (0.184) data 0.105 (0.101) loss_x loss_x 0.4248 (0.5697) acc_x 93.7500 (87.8125) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/34] time 0.188 (0.185) data 0.111 (0.103) loss_x loss_x 0.3643 (0.5477) acc_x 90.6250 (88.0000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/34] time 0.169 (0.183) data 0.093 (0.102) loss_x loss_x 0.7798 (0.5715) acc_x 75.0000 (86.9792) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1110
clean false:0
clean_rate:1.0
noisy true:155
noisy false:335
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [124/200] batch [5/34] time 0.199 (0.181) data 0.122 (0.104) loss_x loss_x 0.6084 (0.5992) acc_x 84.3750 (84.3750) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/34] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4128 (0.4851) acc_x 90.6250 (87.8125) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/34] time 0.251 (0.189) data 0.105 (0.107) loss_x loss_x 0.5552 (0.4758) acc_x 84.3750 (87.0833) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/34] time 0.185 (0.189) data 0.109 (0.108) loss_x loss_x 0.7383 (0.5079) acc_x 78.1250 (85.7812) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/34] time 0.184 (0.189) data 0.108 (0.109) loss_x loss_x 0.3091 (0.4860) acc_x 90.6250 (86.5000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/34] time 0.185 (0.189) data 0.109 (0.109) loss_x loss_x 0.6943 (0.5044) acc_x 90.6250 (86.3542) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1106
clean false:1
clean_rate:0.999096657633243
noisy true:152
noisy false:341
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [125/200] batch [5/34] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.3647 (0.4989) acc_x 93.7500 (88.1250) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/34] time 0.175 (0.177) data 0.097 (0.100) loss_x loss_x 0.5864 (0.5417) acc_x 84.3750 (88.4375) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/34] time 0.164 (0.183) data 0.087 (0.098) loss_x loss_x 0.5903 (0.5216) acc_x 84.3750 (87.7083) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/34] time 0.178 (0.184) data 0.101 (0.101) loss_x loss_x 0.6675 (0.5194) acc_x 84.3750 (87.3438) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/34] time 0.178 (0.182) data 0.101 (0.101) loss_x loss_x 0.8462 (0.5086) acc_x 75.0000 (87.5000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/34] time 0.216 (0.186) data 0.139 (0.102) loss_x loss_x 0.4924 (0.5215) acc_x 81.2500 (86.8750) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.7181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1149
clean true:1147
clean false:2
clean_rate:0.9982593559617058
noisy true:144
noisy false:307
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 451
epoch [126/200] batch [5/35] time 0.183 (0.179) data 0.106 (0.103) loss_x loss_x 0.3394 (0.5104) acc_x 87.5000 (83.7500) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/35] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.4519 (0.4836) acc_x 87.5000 (85.0000) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/35] time 0.173 (0.184) data 0.095 (0.107) loss_x loss_x 0.3794 (0.4651) acc_x 93.7500 (86.6667) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/35] time 0.185 (0.182) data 0.108 (0.106) loss_x loss_x 0.2517 (0.4661) acc_x 93.7500 (86.7188) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/35] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.3337 (0.4982) acc_x 87.5000 (86.0000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/35] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.7964 (0.5164) acc_x 81.2500 (86.1458) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [35/35] time 0.194 (0.184) data 0.117 (0.107) loss_x loss_x 0.8760 (0.5653) acc_x 78.1250 (85.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.7050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1128
clean true:1128
clean false:0
clean_rate:1.0
noisy true:157
noisy false:315
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 472
epoch [127/200] batch [5/35] time 0.172 (0.165) data 0.095 (0.088) loss_x loss_x 0.3333 (0.4166) acc_x 90.6250 (88.1250) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/35] time 0.179 (0.171) data 0.103 (0.095) loss_x loss_x 0.3557 (0.4123) acc_x 90.6250 (89.3750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/35] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.4277 (0.4783) acc_x 87.5000 (87.0833) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/35] time 0.298 (0.180) data 0.112 (0.098) loss_x loss_x 0.7749 (0.4712) acc_x 81.2500 (86.8750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/35] time 0.162 (0.177) data 0.086 (0.096) loss_x loss_x 0.5586 (0.4649) acc_x 81.2500 (87.1250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/35] time 0.188 (0.176) data 0.111 (0.095) loss_x loss_x 0.7505 (0.4834) acc_x 84.3750 (86.6667) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [35/35] time 0.185 (0.177) data 0.108 (0.097) loss_x loss_x 0.5474 (0.4913) acc_x 81.2500 (86.4286) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 312
confident_label rate tensor(0.7125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1140
clean true:1140
clean false:0
clean_rate:1.0
noisy true:148
noisy false:312
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 460
epoch [128/200] batch [5/35] time 0.191 (0.186) data 0.115 (0.110) loss_x loss_x 0.6108 (0.4535) acc_x 84.3750 (87.5000) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/35] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.2690 (0.4907) acc_x 93.7500 (87.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/35] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.7485 (0.5916) acc_x 84.3750 (86.0417) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/35] time 0.164 (0.182) data 0.088 (0.105) loss_x loss_x 1.1514 (0.6095) acc_x 75.0000 (84.8438) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/35] time 0.164 (0.178) data 0.087 (0.102) loss_x loss_x 0.2625 (0.5645) acc_x 93.7500 (86.0000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/35] time 0.170 (0.176) data 0.094 (0.100) loss_x loss_x 0.3608 (0.5646) acc_x 90.6250 (86.1458) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [35/35] time 0.167 (0.179) data 0.090 (0.099) loss_x loss_x 0.3550 (0.5470) acc_x 96.8750 (86.6071) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 302
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1144
clean false:1
clean_rate:0.9991266375545852
noisy true:154
noisy false:301
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [129/200] batch [5/35] time 0.180 (0.170) data 0.104 (0.094) loss_x loss_x 0.1428 (0.4591) acc_x 96.8750 (90.0000) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/35] time 0.183 (0.176) data 0.107 (0.100) loss_x loss_x 0.3567 (0.4586) acc_x 87.5000 (87.8125) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/35] time 0.191 (0.176) data 0.114 (0.099) loss_x loss_x 0.9956 (0.5115) acc_x 71.8750 (86.6667) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/35] time 0.178 (0.181) data 0.101 (0.101) loss_x loss_x 0.0692 (0.4773) acc_x 100.0000 (87.8125) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/35] time 0.175 (0.181) data 0.099 (0.102) loss_x loss_x 0.5068 (0.5096) acc_x 87.5000 (87.1250) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/35] time 0.160 (0.182) data 0.083 (0.101) loss_x loss_x 1.0400 (0.5187) acc_x 78.1250 (86.8750) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [35/35] time 0.187 (0.181) data 0.111 (0.101) loss_x loss_x 0.6782 (0.5145) acc_x 81.2500 (86.7857) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:150
noisy false:347
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [130/200] batch [5/34] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.8359 (0.6499) acc_x 75.0000 (83.1250) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/34] time 0.176 (0.182) data 0.100 (0.106) loss_x loss_x 0.5669 (0.5690) acc_x 81.2500 (84.0625) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/34] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.3635 (0.5537) acc_x 90.6250 (84.1667) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/34] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.3501 (0.5328) acc_x 87.5000 (85.0000) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/34] time 0.182 (0.177) data 0.104 (0.101) loss_x loss_x 0.6362 (0.5406) acc_x 75.0000 (84.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/34] time 0.183 (0.185) data 0.107 (0.103) loss_x loss_x 0.6328 (0.5489) acc_x 81.2500 (83.9583) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1111
clean false:3
clean_rate:0.9973070017953322
noisy true:148
noisy false:338
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [131/200] batch [5/34] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.8032 (0.5457) acc_x 75.0000 (85.6250) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/34] time 0.167 (0.179) data 0.090 (0.103) loss_x loss_x 0.3799 (0.4975) acc_x 93.7500 (86.8750) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/34] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.8906 (0.5455) acc_x 75.0000 (85.6250) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/34] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 0.2573 (0.5338) acc_x 93.7500 (85.9375) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/34] time 0.191 (0.176) data 0.115 (0.099) loss_x loss_x 0.5122 (0.5443) acc_x 87.5000 (85.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/34] time 0.180 (0.175) data 0.103 (0.099) loss_x loss_x 0.4790 (0.5176) acc_x 87.5000 (86.0417) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1154
clean true:1152
clean false:2
clean_rate:0.9982668977469671
noisy true:150
noisy false:296
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 446
epoch [132/200] batch [5/36] time 0.171 (0.202) data 0.095 (0.098) loss_x loss_x 0.5225 (0.6992) acc_x 84.3750 (82.5000) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [10/36] time 0.186 (0.194) data 0.109 (0.104) loss_x loss_x 0.6309 (0.6094) acc_x 81.2500 (83.7500) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [15/36] time 0.174 (0.192) data 0.097 (0.106) loss_x loss_x 0.5151 (0.5666) acc_x 78.1250 (84.3750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/36] time 0.163 (0.188) data 0.087 (0.104) loss_x loss_x 0.5737 (0.5405) acc_x 84.3750 (85.0000) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [25/36] time 0.179 (0.183) data 0.101 (0.101) loss_x loss_x 0.5117 (0.5422) acc_x 87.5000 (84.5000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [30/36] time 0.173 (0.182) data 0.097 (0.101) loss_x loss_x 0.5811 (0.5417) acc_x 90.6250 (84.6875) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [35/36] time 0.191 (0.181) data 0.115 (0.100) loss_x loss_x 0.6328 (0.5338) acc_x 81.2500 (84.8214) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1135
clean false:0
clean_rate:1.0
noisy true:154
noisy false:311
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [133/200] batch [5/35] time 0.209 (0.201) data 0.133 (0.124) loss_x loss_x 0.6670 (0.5261) acc_x 87.5000 (88.1250) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [10/35] time 0.179 (0.187) data 0.101 (0.110) loss_x loss_x 0.3059 (0.4392) acc_x 93.7500 (89.0625) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/35] time 0.173 (0.186) data 0.096 (0.109) loss_x loss_x 0.8447 (0.4974) acc_x 78.1250 (87.7083) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/35] time 0.277 (0.190) data 0.110 (0.106) loss_x loss_x 0.7310 (0.5035) acc_x 81.2500 (87.0312) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/35] time 0.189 (0.189) data 0.113 (0.107) loss_x loss_x 1.0879 (0.5396) acc_x 75.0000 (86.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/35] time 0.185 (0.191) data 0.109 (0.110) loss_x loss_x 0.6294 (0.5567) acc_x 87.5000 (86.0417) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [35/35] time 0.163 (0.188) data 0.087 (0.107) loss_x loss_x 0.7949 (0.5490) acc_x 81.2500 (86.1607) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.7188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1150
clean true:1150
clean false:0
clean_rate:1.0
noisy true:151
noisy false:299
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 450
epoch [134/200] batch [5/35] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.4087 (0.3861) acc_x 87.5000 (88.7500) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/35] time 0.163 (0.170) data 0.087 (0.094) loss_x loss_x 0.5654 (0.5194) acc_x 84.3750 (85.9375) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/35] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.8281 (0.5867) acc_x 75.0000 (84.5833) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/35] time 0.160 (0.183) data 0.083 (0.095) loss_x loss_x 0.3911 (0.5752) acc_x 87.5000 (84.6875) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/35] time 0.168 (0.180) data 0.091 (0.094) loss_x loss_x 0.5615 (0.5730) acc_x 84.3750 (84.6250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/35] time 0.183 (0.179) data 0.107 (0.095) loss_x loss_x 0.3054 (0.5584) acc_x 84.3750 (85.0000) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [35/35] time 0.186 (0.180) data 0.109 (0.097) loss_x loss_x 0.6328 (0.5514) acc_x 81.2500 (84.7321) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1143
clean true:1141
clean false:2
clean_rate:0.9982502187226596
noisy true:161
noisy false:296
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 457
epoch [135/200] batch [5/35] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.6025 (0.5580) acc_x 78.1250 (83.7500) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/35] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3501 (0.5342) acc_x 93.7500 (85.6250) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/35] time 0.184 (0.185) data 0.109 (0.109) loss_x loss_x 0.4890 (0.5284) acc_x 87.5000 (86.8750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/35] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.6025 (0.5230) acc_x 84.3750 (87.1875) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/35] time 0.188 (0.182) data 0.111 (0.106) loss_x loss_x 0.3477 (0.4988) acc_x 90.6250 (87.5000) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/35] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.4026 (0.4825) acc_x 87.5000 (87.8125) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [35/35] time 0.216 (0.182) data 0.138 (0.106) loss_x loss_x 0.2798 (0.4638) acc_x 90.6250 (88.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.7069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1131
clean true:1131
clean false:0
clean_rate:1.0
noisy true:159
noisy false:310
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 469
epoch [136/200] batch [5/35] time 0.190 (0.184) data 0.114 (0.108) loss_x loss_x 0.8462 (0.5390) acc_x 81.2500 (85.0000) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/35] time 0.176 (0.182) data 0.099 (0.105) loss_x loss_x 0.8442 (0.5427) acc_x 81.2500 (85.9375) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/35] time 0.188 (0.185) data 0.112 (0.108) loss_x loss_x 0.3733 (0.5295) acc_x 81.2500 (86.2500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/35] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6426 (0.4956) acc_x 81.2500 (87.0312) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/35] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.2188 (0.4927) acc_x 100.0000 (87.2500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/35] time 0.169 (0.181) data 0.092 (0.105) loss_x loss_x 0.6978 (0.4992) acc_x 78.1250 (87.0833) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [35/35] time 0.188 (0.181) data 0.111 (0.105) loss_x loss_x 0.8188 (0.5284) acc_x 75.0000 (86.5179) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1113
clean true:1111
clean false:2
clean_rate:0.9982030548068284
noisy true:147
noisy false:340
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 487
epoch [137/200] batch [5/34] time 0.186 (0.187) data 0.109 (0.111) loss_x loss_x 0.2715 (0.4958) acc_x 90.6250 (85.6250) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/34] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.8901 (0.6145) acc_x 78.1250 (84.0625) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/34] time 0.283 (0.188) data 0.098 (0.104) loss_x loss_x 0.8711 (0.6143) acc_x 75.0000 (83.1250) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/34] time 0.161 (0.186) data 0.085 (0.103) loss_x loss_x 0.4238 (0.5850) acc_x 87.5000 (84.2188) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/34] time 0.180 (0.185) data 0.103 (0.103) loss_x loss_x 0.3733 (0.5430) acc_x 90.6250 (85.3750) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/34] time 0.179 (0.183) data 0.103 (0.102) loss_x loss_x 0.8804 (0.5457) acc_x 78.1250 (85.4167) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.7131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1141
clean true:1140
clean false:1
clean_rate:0.9991235758106923
noisy true:151
noisy false:308
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 459
epoch [138/200] batch [5/35] time 0.166 (0.171) data 0.090 (0.094) loss_x loss_x 0.3552 (0.6596) acc_x 87.5000 (83.7500) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/35] time 0.162 (0.166) data 0.086 (0.089) loss_x loss_x 0.5801 (0.5799) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/35] time 0.165 (0.174) data 0.089 (0.098) loss_x loss_x 0.4927 (0.5450) acc_x 87.5000 (85.2083) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/35] time 0.168 (0.172) data 0.091 (0.096) loss_x loss_x 0.2939 (0.5171) acc_x 90.6250 (86.4062) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/35] time 0.188 (0.181) data 0.112 (0.097) loss_x loss_x 0.3118 (0.5127) acc_x 90.6250 (86.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/35] time 0.185 (0.182) data 0.108 (0.099) loss_x loss_x 0.3069 (0.5205) acc_x 90.6250 (86.1458) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [35/35] time 0.167 (0.181) data 0.091 (0.099) loss_x loss_x 0.6729 (0.5059) acc_x 81.2500 (86.4286) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.7056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:143
noisy false:328
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 471
epoch [139/200] batch [5/35] time 0.185 (0.207) data 0.108 (0.108) loss_x loss_x 0.6577 (0.6542) acc_x 81.2500 (80.6250) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [10/35] time 0.187 (0.197) data 0.111 (0.109) loss_x loss_x 0.6265 (0.6637) acc_x 78.1250 (81.5625) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/35] time 0.187 (0.197) data 0.110 (0.113) loss_x loss_x 0.4661 (0.5626) acc_x 90.6250 (84.7917) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/35] time 0.191 (0.195) data 0.114 (0.113) loss_x loss_x 0.5459 (0.5340) acc_x 87.5000 (86.0938) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/35] time 0.191 (0.194) data 0.114 (0.113) loss_x loss_x 0.6538 (0.5673) acc_x 75.0000 (85.0000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/35] time 0.204 (0.192) data 0.128 (0.112) loss_x loss_x 0.6533 (0.5715) acc_x 75.0000 (84.5833) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [35/35] time 0.166 (0.191) data 0.090 (0.111) loss_x loss_x 0.6431 (0.5771) acc_x 84.3750 (84.7321) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 313
confident_label rate tensor(0.7081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1133
clean true:1132
clean false:1
clean_rate:0.999117387466902
noisy true:155
noisy false:312
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 467
epoch [140/200] batch [5/35] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.6572 (0.5922) acc_x 84.3750 (84.3750) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/35] time 0.186 (0.177) data 0.110 (0.100) loss_x loss_x 0.4888 (0.5827) acc_x 84.3750 (83.7500) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/35] time 0.181 (0.179) data 0.105 (0.103) loss_x loss_x 0.4724 (0.5365) acc_x 84.3750 (84.1667) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/35] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.9653 (0.5952) acc_x 71.8750 (82.9688) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/35] time 0.168 (0.177) data 0.091 (0.101) loss_x loss_x 0.5464 (0.5637) acc_x 84.3750 (83.8750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/35] time 0.163 (0.175) data 0.087 (0.099) loss_x loss_x 0.5933 (0.5775) acc_x 81.2500 (83.8542) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [35/35] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.6401 (0.5797) acc_x 87.5000 (84.1071) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1148
clean true:1147
clean false:1
clean_rate:0.9991289198606271
noisy true:155
noisy false:297
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 452
epoch [141/200] batch [5/35] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.2927 (0.4044) acc_x 93.7500 (90.0000) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/35] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.6143 (0.4905) acc_x 75.0000 (86.5625) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/35] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.6323 (0.4739) acc_x 81.2500 (86.4583) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/35] time 0.163 (0.179) data 0.087 (0.102) loss_x loss_x 0.6504 (0.4632) acc_x 81.2500 (86.8750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/35] time 0.159 (0.175) data 0.083 (0.099) loss_x loss_x 0.2236 (0.4832) acc_x 93.7500 (87.2500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/35] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.7002 (0.5263) acc_x 81.2500 (86.4583) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [35/35] time 0.161 (0.176) data 0.084 (0.100) loss_x loss_x 0.4409 (0.5300) acc_x 84.3750 (85.9821) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1124
clean true:1123
clean false:1
clean_rate:0.9991103202846975
noisy true:154
noisy false:322
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 476
epoch [142/200] batch [5/35] time 0.170 (0.181) data 0.094 (0.105) loss_x loss_x 0.4270 (0.5432) acc_x 90.6250 (85.6250) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/35] time 0.163 (0.171) data 0.087 (0.095) loss_x loss_x 1.0039 (0.6540) acc_x 78.1250 (84.0625) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/35] time 0.161 (0.167) data 0.084 (0.091) loss_x loss_x 0.3792 (0.6153) acc_x 90.6250 (84.1667) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/35] time 0.159 (0.165) data 0.083 (0.089) loss_x loss_x 0.6309 (0.6057) acc_x 81.2500 (84.2188) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/35] time 0.164 (0.164) data 0.088 (0.088) loss_x loss_x 0.6021 (0.6063) acc_x 84.3750 (84.2500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/35] time 0.163 (0.164) data 0.087 (0.088) loss_x loss_x 0.5596 (0.6175) acc_x 90.6250 (83.5417) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [35/35] time 0.159 (0.164) data 0.083 (0.087) loss_x loss_x 0.4414 (0.5839) acc_x 90.6250 (84.2857) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.7088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1134
clean true:1132
clean false:2
clean_rate:0.9982363315696648
noisy true:158
noisy false:308
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 466
epoch [143/200] batch [5/35] time 0.236 (0.204) data 0.083 (0.084) loss_x loss_x 0.3179 (0.4675) acc_x 90.6250 (86.2500) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [10/35] time 0.184 (0.185) data 0.106 (0.086) loss_x loss_x 0.5620 (0.4405) acc_x 87.5000 (87.5000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/35] time 0.163 (0.179) data 0.086 (0.088) loss_x loss_x 0.4067 (0.4782) acc_x 90.6250 (86.8750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/35] time 0.156 (0.175) data 0.080 (0.087) loss_x loss_x 0.4753 (0.4600) acc_x 78.1250 (87.0312) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/35] time 0.166 (0.172) data 0.089 (0.087) loss_x loss_x 0.4768 (0.4613) acc_x 84.3750 (87.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/35] time 0.159 (0.170) data 0.083 (0.086) loss_x loss_x 0.6479 (0.4629) acc_x 81.2500 (87.5000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [35/35] time 0.160 (0.169) data 0.083 (0.086) loss_x loss_x 0.7764 (0.4729) acc_x 78.1250 (87.4107) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1141
clean true:1140
clean false:1
clean_rate:0.9991235758106923
noisy true:144
noisy false:315
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 459
epoch [144/200] batch [5/35] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.4409 (0.5376) acc_x 84.3750 (85.6250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/35] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.4275 (0.5135) acc_x 90.6250 (86.8750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/35] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.3494 (0.5075) acc_x 87.5000 (87.0833) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/35] time 0.163 (0.160) data 0.087 (0.083) loss_x loss_x 0.4065 (0.5031) acc_x 90.6250 (87.3438) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/35] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.4080 (0.4892) acc_x 84.3750 (87.2500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/35] time 0.161 (0.160) data 0.083 (0.083) loss_x loss_x 0.5962 (0.5056) acc_x 81.2500 (86.4583) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [35/35] time 0.157 (0.163) data 0.080 (0.083) loss_x loss_x 0.4775 (0.5198) acc_x 87.5000 (86.2500) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1119
clean false:0
clean_rate:1.0
noisy true:148
noisy false:333
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [145/200] batch [5/34] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.6387 (0.6260) acc_x 84.3750 (80.0000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/34] time 0.163 (0.161) data 0.086 (0.084) loss_x loss_x 0.4021 (0.6016) acc_x 87.5000 (82.1875) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/34] time 0.160 (0.160) data 0.083 (0.084) loss_x loss_x 0.5762 (0.5779) acc_x 81.2500 (83.3333) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/34] time 0.162 (0.161) data 0.086 (0.084) loss_x loss_x 0.2639 (0.5541) acc_x 93.7500 (84.0625) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/34] time 0.164 (0.161) data 0.087 (0.084) loss_x loss_x 0.3069 (0.5329) acc_x 93.7500 (85.0000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/34] time 0.164 (0.161) data 0.087 (0.084) loss_x loss_x 0.5352 (0.5151) acc_x 84.3750 (85.7292) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1107
clean false:0
clean_rate:1.0
noisy true:143
noisy false:350
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [146/200] batch [5/34] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.2871 (0.4212) acc_x 84.3750 (88.7500) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/34] time 0.160 (0.161) data 0.083 (0.085) loss_x loss_x 0.4578 (0.4843) acc_x 87.5000 (88.7500) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/34] time 0.158 (0.162) data 0.082 (0.085) loss_x loss_x 0.4045 (0.4733) acc_x 84.3750 (88.3333) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/34] time 0.159 (0.161) data 0.083 (0.084) loss_x loss_x 0.6689 (0.4577) acc_x 84.3750 (88.4375) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/34] time 0.163 (0.161) data 0.087 (0.084) loss_x loss_x 0.4136 (0.4883) acc_x 90.6250 (87.5000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/34] time 0.157 (0.161) data 0.080 (0.084) loss_x loss_x 0.5879 (0.5069) acc_x 84.3750 (87.0833) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:146
noisy false:322
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 468
epoch [147/200] batch [5/35] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.5234 (0.5212) acc_x 87.5000 (84.3750) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/35] time 0.182 (0.180) data 0.105 (0.104) loss_x loss_x 0.3069 (0.4442) acc_x 87.5000 (86.5625) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/35] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.3853 (0.4444) acc_x 90.6250 (87.0833) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/35] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.2913 (0.4760) acc_x 93.7500 (87.0312) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/35] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.7935 (0.4779) acc_x 75.0000 (86.5000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/35] time 0.186 (0.181) data 0.108 (0.104) loss_x loss_x 0.7998 (0.4914) acc_x 75.0000 (86.0417) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [35/35] time 0.160 (0.178) data 0.084 (0.101) loss_x loss_x 0.8530 (0.5134) acc_x 78.1250 (85.7143) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:153
noisy false:326
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [148/200] batch [5/35] time 0.159 (0.160) data 0.082 (0.084) loss_x loss_x 0.7153 (0.5582) acc_x 84.3750 (84.3750) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/35] time 0.272 (0.172) data 0.085 (0.083) loss_x loss_x 0.7876 (0.5357) acc_x 71.8750 (84.3750) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/35] time 0.160 (0.168) data 0.084 (0.083) loss_x loss_x 0.1727 (0.5005) acc_x 96.8750 (86.0417) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/35] time 0.185 (0.168) data 0.109 (0.086) loss_x loss_x 0.5278 (0.5068) acc_x 93.7500 (86.7188) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/35] time 0.184 (0.171) data 0.108 (0.090) loss_x loss_x 0.5293 (0.5386) acc_x 84.3750 (85.8750) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/35] time 0.184 (0.173) data 0.108 (0.093) loss_x loss_x 0.6885 (0.5481) acc_x 90.6250 (85.9375) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [35/35] time 0.186 (0.175) data 0.110 (0.095) loss_x loss_x 0.6284 (0.5478) acc_x 84.3750 (85.9821) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1147
clean true:1146
clean false:1
clean_rate:0.999128160418483
noisy true:147
noisy false:306
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 453
epoch [149/200] batch [5/35] time 0.164 (0.163) data 0.087 (0.087) loss_x loss_x 0.5615 (0.5126) acc_x 90.6250 (87.5000) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/35] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 0.4207 (0.4844) acc_x 90.6250 (88.1250) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/35] time 0.158 (0.162) data 0.082 (0.085) loss_x loss_x 0.5137 (0.4779) acc_x 84.3750 (87.7083) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/35] time 0.164 (0.161) data 0.087 (0.085) loss_x loss_x 0.5742 (0.4933) acc_x 81.2500 (87.1875) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/35] time 0.185 (0.166) data 0.085 (0.085) loss_x loss_x 0.4280 (0.4949) acc_x 90.6250 (86.8750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/35] time 0.161 (0.166) data 0.084 (0.085) loss_x loss_x 0.2876 (0.4845) acc_x 93.7500 (87.1875) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [35/35] time 0.155 (0.165) data 0.078 (0.085) loss_x loss_x 0.7148 (0.4775) acc_x 81.2500 (87.6786) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1117
clean false:3
clean_rate:0.9973214285714286
noisy true:154
noisy false:326
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [150/200] batch [5/35] time 0.157 (0.188) data 0.081 (0.082) loss_x loss_x 0.3240 (0.5479) acc_x 90.6250 (88.1250) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/35] time 0.155 (0.173) data 0.079 (0.082) loss_x loss_x 1.2109 (0.6735) acc_x 71.8750 (84.0625) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/35] time 0.161 (0.169) data 0.085 (0.082) loss_x loss_x 0.4412 (0.5888) acc_x 78.1250 (84.5833) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/35] time 0.158 (0.166) data 0.081 (0.082) loss_x loss_x 0.5752 (0.5770) acc_x 87.5000 (85.6250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/35] time 0.165 (0.165) data 0.087 (0.083) loss_x loss_x 0.4895 (0.5489) acc_x 90.6250 (86.3750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/35] time 0.279 (0.169) data 0.092 (0.083) loss_x loss_x 0.5659 (0.5409) acc_x 84.3750 (86.1458) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [35/35] time 0.160 (0.168) data 0.083 (0.084) loss_x loss_x 0.2800 (0.5169) acc_x 93.7500 (86.4286) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1145
clean false:0
clean_rate:1.0
noisy true:148
noisy false:307
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [151/200] batch [5/35] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.6826 (0.7073) acc_x 84.3750 (80.6250) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/35] time 0.175 (0.163) data 0.099 (0.086) loss_x loss_x 0.4690 (0.6639) acc_x 87.5000 (81.5625) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/35] time 0.183 (0.167) data 0.106 (0.090) loss_x loss_x 0.4185 (0.6107) acc_x 87.5000 (83.9583) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/35] time 0.157 (0.169) data 0.080 (0.092) loss_x loss_x 0.4321 (0.5896) acc_x 87.5000 (84.6875) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/35] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 0.9272 (0.5838) acc_x 78.1250 (85.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/35] time 0.161 (0.169) data 0.085 (0.092) loss_x loss_x 0.3152 (0.5665) acc_x 90.6250 (85.8333) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [35/35] time 0.163 (0.168) data 0.086 (0.091) loss_x loss_x 0.8159 (0.5846) acc_x 87.5000 (85.8036) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.7125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1140
clean true:1140
clean false:0
clean_rate:1.0
noisy true:152
noisy false:308
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 460
epoch [152/200] batch [5/35] time 0.154 (0.192) data 0.077 (0.079) loss_x loss_x 0.9067 (0.5555) acc_x 75.0000 (84.3750) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/35] time 0.156 (0.174) data 0.079 (0.079) loss_x loss_x 0.4492 (0.5155) acc_x 84.3750 (84.6875) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/35] time 0.156 (0.168) data 0.080 (0.079) loss_x loss_x 0.2688 (0.5141) acc_x 90.6250 (85.0000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/35] time 0.156 (0.164) data 0.079 (0.079) loss_x loss_x 0.8594 (0.5207) acc_x 81.2500 (85.7812) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/35] time 0.156 (0.162) data 0.079 (0.079) loss_x loss_x 0.3313 (0.5264) acc_x 87.5000 (85.7500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/35] time 0.155 (0.161) data 0.078 (0.079) loss_x loss_x 0.7520 (0.5163) acc_x 84.3750 (86.5625) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [35/35] time 0.155 (0.160) data 0.079 (0.079) loss_x loss_x 0.8345 (0.5236) acc_x 81.2500 (86.6071) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.6987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1118
clean true:1117
clean false:1
clean_rate:0.9991055456171736
noisy true:155
noisy false:327
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 482
epoch [153/200] batch [5/34] time 0.158 (0.160) data 0.082 (0.083) loss_x loss_x 0.6333 (0.4627) acc_x 84.3750 (88.1250) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/34] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.2576 (0.3770) acc_x 90.6250 (89.6875) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/34] time 0.157 (0.159) data 0.081 (0.082) loss_x loss_x 0.2390 (0.4098) acc_x 93.7500 (89.5833) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/34] time 0.265 (0.170) data 0.080 (0.082) loss_x loss_x 0.5703 (0.4194) acc_x 81.2500 (89.6875) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/34] time 0.159 (0.167) data 0.082 (0.082) loss_x loss_x 0.3132 (0.4193) acc_x 81.2500 (89.3750) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/34] time 0.160 (0.166) data 0.083 (0.082) loss_x loss_x 0.5283 (0.4592) acc_x 81.2500 (88.4375) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.7169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1147
clean true:1146
clean false:1
clean_rate:0.999128160418483
noisy true:154
noisy false:299
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 453
epoch [154/200] batch [5/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.5498 (0.4763) acc_x 78.1250 (87.5000) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/35] time 0.163 (0.159) data 0.086 (0.083) loss_x loss_x 0.3003 (0.5105) acc_x 90.6250 (86.5625) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/35] time 0.160 (0.165) data 0.083 (0.083) loss_x loss_x 0.5684 (0.4648) acc_x 78.1250 (86.6667) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/35] time 0.160 (0.164) data 0.084 (0.083) loss_x loss_x 0.7734 (0.4827) acc_x 84.3750 (87.1875) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/35] time 0.157 (0.163) data 0.081 (0.083) loss_x loss_x 0.5078 (0.4811) acc_x 87.5000 (87.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/35] time 0.156 (0.162) data 0.080 (0.083) loss_x loss_x 0.9907 (0.4974) acc_x 84.3750 (87.8125) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [35/35] time 0.160 (0.164) data 0.083 (0.082) loss_x loss_x 0.4390 (0.4931) acc_x 93.7500 (87.9464) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:155
noisy false:324
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [155/200] batch [5/35] time 0.155 (0.176) data 0.079 (0.082) loss_x loss_x 0.5972 (0.3971) acc_x 81.2500 (88.7500) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/35] time 0.161 (0.167) data 0.085 (0.082) loss_x loss_x 0.2170 (0.3949) acc_x 90.6250 (87.1875) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/35] time 0.159 (0.166) data 0.082 (0.083) loss_x loss_x 0.4917 (0.4498) acc_x 93.7500 (87.0833) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/35] time 0.224 (0.167) data 0.082 (0.083) loss_x loss_x 0.4663 (0.4888) acc_x 90.6250 (86.5625) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/35] time 0.160 (0.165) data 0.083 (0.083) loss_x loss_x 0.4375 (0.4797) acc_x 87.5000 (86.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/35] time 0.160 (0.164) data 0.084 (0.083) loss_x loss_x 0.3962 (0.4864) acc_x 93.7500 (86.3542) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [35/35] time 0.162 (0.164) data 0.086 (0.083) loss_x loss_x 0.6548 (0.4724) acc_x 81.2500 (86.8750) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 297
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1144
clean false:1
clean_rate:0.9991266375545852
noisy true:159
noisy false:296
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [156/200] batch [5/35] time 0.157 (0.157) data 0.081 (0.081) loss_x loss_x 0.4541 (0.5563) acc_x 84.3750 (85.0000) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/35] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.3350 (0.5708) acc_x 93.7500 (86.5625) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/35] time 0.156 (0.158) data 0.079 (0.082) loss_x loss_x 0.5576 (0.5218) acc_x 84.3750 (87.2917) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/35] time 0.156 (0.158) data 0.080 (0.082) loss_x loss_x 0.2866 (0.5170) acc_x 93.7500 (86.8750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/35] time 0.162 (0.163) data 0.085 (0.082) loss_x loss_x 0.3032 (0.4993) acc_x 93.7500 (87.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/35] time 0.156 (0.162) data 0.080 (0.082) loss_x loss_x 0.5425 (0.5247) acc_x 87.5000 (86.6667) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [35/35] time 0.155 (0.162) data 0.078 (0.081) loss_x loss_x 0.6558 (0.5274) acc_x 81.2500 (86.6071) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 301
confident_label rate tensor(0.7181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1149
clean true:1148
clean false:1
clean_rate:0.999129677980853
noisy true:151
noisy false:300
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 451
epoch [157/200] batch [5/35] time 0.158 (0.159) data 0.082 (0.082) loss_x loss_x 0.6934 (0.5862) acc_x 81.2500 (85.0000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/35] time 0.154 (0.158) data 0.077 (0.081) loss_x loss_x 0.5278 (0.5935) acc_x 84.3750 (84.6875) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/35] time 0.154 (0.158) data 0.078 (0.081) loss_x loss_x 0.7246 (0.6468) acc_x 81.2500 (83.5417) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/35] time 0.160 (0.158) data 0.084 (0.081) loss_x loss_x 0.5298 (0.6551) acc_x 78.1250 (82.8125) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/35] time 0.160 (0.158) data 0.084 (0.081) loss_x loss_x 0.2097 (0.6213) acc_x 96.8750 (83.7500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/35] time 0.157 (0.158) data 0.081 (0.081) loss_x loss_x 0.4580 (0.5862) acc_x 90.6250 (84.8958) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [35/35] time 0.156 (0.162) data 0.080 (0.081) loss_x loss_x 0.6147 (0.5755) acc_x 84.3750 (85.0893) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.7206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1153
clean true:1151
clean false:2
clean_rate:0.9982653946227233
noisy true:150
noisy false:297
after delete: len(clean_dataset) 1153
after delete: len(noisy_dataset) 447
epoch [158/200] batch [5/36] time 0.242 (0.187) data 0.080 (0.081) loss_x loss_x 0.3921 (0.5227) acc_x 93.7500 (86.2500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/36] time 0.156 (0.172) data 0.079 (0.080) loss_x loss_x 0.6494 (0.5026) acc_x 78.1250 (86.5625) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/36] time 0.155 (0.167) data 0.078 (0.081) loss_x loss_x 0.2333 (0.5179) acc_x 96.8750 (86.0417) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/36] time 0.152 (0.164) data 0.075 (0.080) loss_x loss_x 0.2401 (0.4972) acc_x 93.7500 (86.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/36] time 0.154 (0.163) data 0.078 (0.080) loss_x loss_x 0.8486 (0.5518) acc_x 81.2500 (85.8750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/36] time 0.157 (0.165) data 0.081 (0.080) loss_x loss_x 0.3696 (0.5540) acc_x 93.7500 (85.5208) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [35/36] time 0.157 (0.164) data 0.081 (0.080) loss_x loss_x 0.6221 (0.5645) acc_x 78.1250 (85.0000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:153
noisy false:310
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 463
epoch [159/200] batch [5/35] time 0.157 (0.158) data 0.080 (0.082) loss_x loss_x 0.7822 (0.7114) acc_x 84.3750 (84.3750) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/35] time 0.202 (0.162) data 0.085 (0.081) loss_x loss_x 0.3340 (0.6495) acc_x 87.5000 (85.0000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/35] time 0.158 (0.171) data 0.082 (0.083) loss_x loss_x 0.5601 (0.5961) acc_x 84.3750 (86.0417) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/35] time 0.159 (0.168) data 0.082 (0.083) loss_x loss_x 0.4182 (0.5461) acc_x 90.6250 (87.5000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/35] time 0.159 (0.166) data 0.082 (0.083) loss_x loss_x 0.7202 (0.5475) acc_x 81.2500 (86.7500) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/35] time 0.156 (0.165) data 0.080 (0.083) loss_x loss_x 0.6362 (0.5377) acc_x 87.5000 (86.5625) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [35/35] time 0.156 (0.164) data 0.080 (0.082) loss_x loss_x 0.7363 (0.5361) acc_x 81.2500 (86.6964) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1135
clean false:0
clean_rate:1.0
noisy true:154
noisy false:311
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [160/200] batch [5/35] time 0.182 (0.168) data 0.106 (0.092) loss_x loss_x 0.8530 (0.7453) acc_x 65.6250 (79.3750) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/35] time 0.158 (0.165) data 0.082 (0.088) loss_x loss_x 0.6606 (0.6924) acc_x 78.1250 (80.9375) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/35] time 0.159 (0.163) data 0.083 (0.086) loss_x loss_x 0.7725 (0.6298) acc_x 81.2500 (82.2917) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/35] time 0.157 (0.161) data 0.081 (0.085) loss_x loss_x 0.3577 (0.5931) acc_x 87.5000 (83.7500) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/35] time 0.155 (0.160) data 0.078 (0.084) loss_x loss_x 0.6353 (0.5907) acc_x 71.8750 (83.1250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/35] time 0.160 (0.166) data 0.084 (0.084) loss_x loss_x 0.3950 (0.6045) acc_x 93.7500 (83.2292) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [35/35] time 0.159 (0.165) data 0.082 (0.084) loss_x loss_x 0.3132 (0.5756) acc_x 90.6250 (83.9286) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:144
noisy false:339
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [161/200] batch [5/34] time 0.158 (0.159) data 0.082 (0.082) loss_x loss_x 0.5698 (0.5307) acc_x 87.5000 (88.7500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/34] time 0.163 (0.159) data 0.086 (0.083) loss_x loss_x 0.1647 (0.4531) acc_x 96.8750 (89.0625) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/34] time 0.162 (0.159) data 0.085 (0.083) loss_x loss_x 0.3430 (0.4496) acc_x 90.6250 (87.9167) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/34] time 0.157 (0.159) data 0.081 (0.083) loss_x loss_x 1.0469 (0.4631) acc_x 68.7500 (87.6562) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/34] time 0.162 (0.159) data 0.085 (0.083) loss_x loss_x 0.4768 (0.4601) acc_x 87.5000 (87.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/34] time 0.160 (0.159) data 0.083 (0.083) loss_x loss_x 0.5571 (0.4520) acc_x 84.3750 (87.8125) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1134
clean false:1
clean_rate:0.9991189427312775
noisy true:158
noisy false:307
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [162/200] batch [5/35] time 0.157 (0.159) data 0.081 (0.083) loss_x loss_x 0.4331 (0.4063) acc_x 90.6250 (88.1250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/35] time 0.266 (0.171) data 0.080 (0.082) loss_x loss_x 0.2246 (0.3740) acc_x 96.8750 (90.3125) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/35] time 0.156 (0.167) data 0.080 (0.082) loss_x loss_x 0.7148 (0.4763) acc_x 84.3750 (88.1250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/35] time 0.156 (0.164) data 0.079 (0.082) loss_x loss_x 0.9565 (0.5166) acc_x 71.8750 (86.5625) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/35] time 0.160 (0.163) data 0.083 (0.082) loss_x loss_x 0.4558 (0.5051) acc_x 87.5000 (86.6250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/35] time 0.158 (0.162) data 0.082 (0.082) loss_x loss_x 0.4316 (0.5097) acc_x 90.6250 (87.0833) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [35/35] time 0.161 (0.162) data 0.084 (0.081) loss_x loss_x 0.6704 (0.5125) acc_x 75.0000 (86.8750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 291
confident_label rate tensor(0.7219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1155
clean true:1155
clean false:0
clean_rate:1.0
noisy true:154
noisy false:291
after delete: len(clean_dataset) 1155
after delete: len(noisy_dataset) 445
epoch [163/200] batch [5/36] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.8462 (0.6173) acc_x 71.8750 (83.1250) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/36] time 0.159 (0.159) data 0.083 (0.083) loss_x loss_x 0.8691 (0.5756) acc_x 75.0000 (84.0625) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/36] time 0.157 (0.158) data 0.081 (0.082) loss_x loss_x 0.9824 (0.5973) acc_x 75.0000 (83.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/36] time 0.154 (0.158) data 0.078 (0.082) loss_x loss_x 0.4514 (0.5742) acc_x 90.6250 (84.5312) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/36] time 0.162 (0.159) data 0.085 (0.083) loss_x loss_x 0.6294 (0.5272) acc_x 90.6250 (86.2500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/36] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.4993 (0.5099) acc_x 84.3750 (86.7708) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [35/36] time 0.157 (0.159) data 0.081 (0.082) loss_x loss_x 0.5332 (0.5000) acc_x 90.6250 (87.1429) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1131
clean true:1130
clean false:1
clean_rate:0.9991158267020336
noisy true:146
noisy false:323
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 469
epoch [164/200] batch [5/35] time 0.158 (0.156) data 0.082 (0.079) loss_x loss_x 0.9595 (0.5825) acc_x 78.1250 (85.6250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/35] time 0.154 (0.156) data 0.078 (0.079) loss_x loss_x 0.6641 (0.5953) acc_x 87.5000 (86.8750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/35] time 0.153 (0.156) data 0.076 (0.079) loss_x loss_x 0.3799 (0.5529) acc_x 90.6250 (87.2917) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/35] time 0.155 (0.156) data 0.079 (0.079) loss_x loss_x 0.7065 (0.5477) acc_x 81.2500 (86.5625) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/35] time 0.154 (0.156) data 0.077 (0.079) loss_x loss_x 0.5132 (0.5664) acc_x 87.5000 (86.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/35] time 0.154 (0.156) data 0.077 (0.079) loss_x loss_x 0.3796 (0.5501) acc_x 87.5000 (86.2500) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [35/35] time 0.154 (0.155) data 0.078 (0.079) loss_x loss_x 0.4355 (0.5500) acc_x 87.5000 (86.1607) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1114
clean false:0
clean_rate:1.0
noisy true:148
noisy false:338
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [165/200] batch [5/34] time 0.159 (0.159) data 0.083 (0.083) loss_x loss_x 0.3328 (0.5954) acc_x 93.7500 (86.8750) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/34] time 0.157 (0.158) data 0.081 (0.082) loss_x loss_x 0.1929 (0.5641) acc_x 100.0000 (87.5000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/34] time 0.157 (0.158) data 0.080 (0.082) loss_x loss_x 0.7095 (0.5758) acc_x 84.3750 (85.8333) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/34] time 0.161 (0.158) data 0.085 (0.082) loss_x loss_x 0.7783 (0.5878) acc_x 78.1250 (85.1562) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/34] time 0.158 (0.158) data 0.081 (0.082) loss_x loss_x 0.5234 (0.5659) acc_x 87.5000 (85.6250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/34] time 0.266 (0.164) data 0.079 (0.081) loss_x loss_x 0.9102 (0.5715) acc_x 81.2500 (85.5208) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.7019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1123
clean true:1122
clean false:1
clean_rate:0.9991095280498664
noisy true:148
noisy false:329
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 477
epoch [166/200] batch [5/35] time 0.158 (0.178) data 0.082 (0.080) loss_x loss_x 0.3987 (0.5309) acc_x 84.3750 (85.0000) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/35] time 0.152 (0.168) data 0.076 (0.080) loss_x loss_x 0.5347 (0.5324) acc_x 84.3750 (85.0000) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/35] time 0.153 (0.163) data 0.077 (0.080) loss_x loss_x 0.8745 (0.5844) acc_x 71.8750 (84.3750) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/35] time 0.156 (0.162) data 0.080 (0.080) loss_x loss_x 0.5713 (0.5689) acc_x 81.2500 (84.0625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/35] time 0.160 (0.166) data 0.084 (0.081) loss_x loss_x 0.4048 (0.5366) acc_x 81.2500 (84.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/35] time 0.154 (0.164) data 0.078 (0.081) loss_x loss_x 0.4578 (0.5318) acc_x 90.6250 (85.3125) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [35/35] time 0.158 (0.163) data 0.082 (0.081) loss_x loss_x 0.4382 (0.5275) acc_x 90.6250 (85.8036) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.7063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1130
clean true:1129
clean false:1
clean_rate:0.9991150442477876
noisy true:157
noisy false:313
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 470
epoch [167/200] batch [5/35] time 0.156 (0.156) data 0.079 (0.080) loss_x loss_x 0.5283 (0.5383) acc_x 87.5000 (86.2500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/35] time 0.159 (0.157) data 0.082 (0.081) loss_x loss_x 0.5381 (0.5024) acc_x 81.2500 (86.2500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/35] time 0.152 (0.157) data 0.076 (0.081) loss_x loss_x 0.2034 (0.5166) acc_x 100.0000 (86.4583) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/35] time 0.156 (0.157) data 0.081 (0.080) loss_x loss_x 0.4375 (0.5260) acc_x 93.7500 (86.4062) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/35] time 0.211 (0.162) data 0.082 (0.081) loss_x loss_x 0.2703 (0.5000) acc_x 93.7500 (87.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/35] time 0.154 (0.162) data 0.078 (0.081) loss_x loss_x 0.4033 (0.4965) acc_x 90.6250 (87.1875) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [35/35] time 0.158 (0.161) data 0.082 (0.081) loss_x loss_x 0.3455 (0.4966) acc_x 96.8750 (87.5000) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.7031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1125
clean true:1125
clean false:0
clean_rate:1.0
noisy true:149
noisy false:326
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 475
epoch [168/200] batch [5/35] time 0.158 (0.157) data 0.081 (0.081) loss_x loss_x 0.4338 (0.5227) acc_x 90.6250 (86.8750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/35] time 0.154 (0.157) data 0.079 (0.081) loss_x loss_x 0.5352 (0.5933) acc_x 81.2500 (85.0000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/35] time 0.155 (0.157) data 0.078 (0.081) loss_x loss_x 0.4810 (0.5896) acc_x 90.6250 (86.2500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/35] time 0.154 (0.167) data 0.078 (0.080) loss_x loss_x 0.3118 (0.5782) acc_x 93.7500 (85.7812) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/35] time 0.156 (0.165) data 0.079 (0.080) loss_x loss_x 0.6001 (0.5393) acc_x 81.2500 (86.6250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/35] time 0.154 (0.163) data 0.077 (0.080) loss_x loss_x 0.6543 (0.5434) acc_x 81.2500 (86.3542) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [35/35] time 0.158 (0.162) data 0.081 (0.080) loss_x loss_x 0.6392 (0.5296) acc_x 87.5000 (86.3393) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.7025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1124
clean true:1124
clean false:0
clean_rate:1.0
noisy true:149
noisy false:327
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 476
epoch [169/200] batch [5/35] time 0.157 (0.158) data 0.080 (0.082) loss_x loss_x 0.3140 (0.5720) acc_x 93.7500 (83.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/35] time 0.157 (0.158) data 0.082 (0.081) loss_x loss_x 0.2194 (0.4663) acc_x 93.7500 (86.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/35] time 0.158 (0.159) data 0.082 (0.083) loss_x loss_x 0.8926 (0.5392) acc_x 84.3750 (86.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/35] time 0.157 (0.164) data 0.080 (0.082) loss_x loss_x 0.3599 (0.5370) acc_x 93.7500 (87.1875) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/35] time 0.157 (0.163) data 0.081 (0.082) loss_x loss_x 0.1840 (0.5511) acc_x 93.7500 (86.3750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/35] time 0.158 (0.162) data 0.081 (0.082) loss_x loss_x 0.3032 (0.5364) acc_x 93.7500 (86.7708) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [35/35] time 0.163 (0.164) data 0.080 (0.082) loss_x loss_x 0.5449 (0.5408) acc_x 87.5000 (86.4286) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1136
clean true:1136
clean false:0
clean_rate:1.0
noisy true:153
noisy false:311
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 464
epoch [170/200] batch [5/35] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.4880 (0.4901) acc_x 90.6250 (88.7500) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/35] time 0.155 (0.156) data 0.078 (0.080) loss_x loss_x 0.4321 (0.5750) acc_x 90.6250 (85.6250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/35] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.6021 (0.5483) acc_x 75.0000 (85.0000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/35] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.2385 (0.5284) acc_x 93.7500 (85.6250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/35] time 0.158 (0.163) data 0.081 (0.081) loss_x loss_x 0.6421 (0.5452) acc_x 87.5000 (85.2500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/35] time 0.158 (0.162) data 0.082 (0.080) loss_x loss_x 0.6279 (0.5372) acc_x 84.3750 (85.4167) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [35/35] time 0.157 (0.161) data 0.081 (0.081) loss_x loss_x 0.4878 (0.5563) acc_x 93.7500 (85.2679) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:151
noisy false:341
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 492
epoch [171/200] batch [5/34] time 0.157 (0.157) data 0.080 (0.081) loss_x loss_x 0.4524 (0.4362) acc_x 87.5000 (89.3750) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/34] time 0.159 (0.157) data 0.082 (0.080) loss_x loss_x 0.5894 (0.4648) acc_x 81.2500 (88.4375) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/34] time 0.265 (0.164) data 0.080 (0.080) loss_x loss_x 0.5117 (0.4509) acc_x 81.2500 (88.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/34] time 0.160 (0.168) data 0.084 (0.081) loss_x loss_x 0.3230 (0.4436) acc_x 90.6250 (87.9688) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/34] time 0.156 (0.166) data 0.079 (0.081) loss_x loss_x 0.3943 (0.4519) acc_x 90.6250 (88.1250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/34] time 0.159 (0.165) data 0.082 (0.081) loss_x loss_x 0.5137 (0.4663) acc_x 81.2500 (87.7083) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.7119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1139
clean true:1139
clean false:0
clean_rate:1.0
noisy true:156
noisy false:305
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 461
epoch [172/200] batch [5/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.4158 (0.5001) acc_x 87.5000 (86.8750) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/35] time 0.158 (0.158) data 0.082 (0.082) loss_x loss_x 0.2173 (0.4668) acc_x 96.8750 (88.1250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/35] time 0.156 (0.159) data 0.080 (0.082) loss_x loss_x 1.0850 (0.5146) acc_x 65.6250 (86.4583) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/35] time 0.154 (0.158) data 0.078 (0.082) loss_x loss_x 0.4800 (0.5154) acc_x 84.3750 (86.0938) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/35] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.6128 (0.5021) acc_x 84.3750 (86.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/35] time 0.154 (0.158) data 0.077 (0.082) loss_x loss_x 0.6152 (0.5162) acc_x 87.5000 (86.7708) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [35/35] time 0.155 (0.158) data 0.079 (0.081) loss_x loss_x 0.6401 (0.5259) acc_x 81.2500 (86.5179) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1154
clean true:1153
clean false:1
clean_rate:0.9991334488734835
noisy true:149
noisy false:297
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 446
epoch [173/200] batch [5/36] time 0.158 (0.159) data 0.082 (0.082) loss_x loss_x 1.0449 (0.5897) acc_x 81.2500 (84.3750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/36] time 0.157 (0.158) data 0.081 (0.082) loss_x loss_x 0.4639 (0.5473) acc_x 90.6250 (85.9375) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/36] time 0.157 (0.158) data 0.080 (0.082) loss_x loss_x 0.5176 (0.5710) acc_x 78.1250 (84.3750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/36] time 0.157 (0.158) data 0.081 (0.081) loss_x loss_x 0.3669 (0.5517) acc_x 93.7500 (85.3125) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/36] time 0.162 (0.158) data 0.086 (0.082) loss_x loss_x 0.2085 (0.5472) acc_x 96.8750 (86.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/36] time 0.154 (0.158) data 0.077 (0.082) loss_x loss_x 0.4609 (0.5357) acc_x 90.6250 (86.3542) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [35/36] time 0.160 (0.158) data 0.083 (0.082) loss_x loss_x 0.3772 (0.5383) acc_x 90.6250 (86.3393) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1119
clean false:1
clean_rate:0.9991071428571429
noisy true:152
noisy false:328
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [174/200] batch [5/35] time 0.157 (0.155) data 0.080 (0.078) loss_x loss_x 0.3843 (0.5700) acc_x 90.6250 (86.8750) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/35] time 0.162 (0.156) data 0.085 (0.080) loss_x loss_x 0.1768 (0.4454) acc_x 93.7500 (88.7500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/35] time 0.158 (0.157) data 0.081 (0.081) loss_x loss_x 0.9766 (0.4670) acc_x 71.8750 (88.1250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/35] time 0.156 (0.157) data 0.079 (0.081) loss_x loss_x 0.3198 (0.4541) acc_x 96.8750 (88.4375) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/35] time 0.160 (0.157) data 0.084 (0.081) loss_x loss_x 0.3647 (0.4490) acc_x 87.5000 (88.5000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/35] time 0.159 (0.158) data 0.083 (0.081) loss_x loss_x 1.4922 (0.5170) acc_x 78.1250 (87.2917) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [35/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.8477 (0.5385) acc_x 78.1250 (86.9643) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.7019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1123
clean true:1123
clean false:0
clean_rate:1.0
noisy true:150
noisy false:327
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 477
epoch [175/200] batch [5/35] time 0.154 (0.154) data 0.078 (0.078) loss_x loss_x 0.4497 (0.4994) acc_x 87.5000 (86.2500) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/35] time 0.158 (0.156) data 0.082 (0.079) loss_x loss_x 0.3164 (0.3920) acc_x 87.5000 (88.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/35] time 0.157 (0.156) data 0.081 (0.080) loss_x loss_x 0.4016 (0.4244) acc_x 87.5000 (87.9167) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/35] time 0.164 (0.157) data 0.087 (0.080) loss_x loss_x 0.4714 (0.4789) acc_x 87.5000 (87.3438) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/35] time 0.162 (0.158) data 0.086 (0.081) loss_x loss_x 0.5757 (0.5082) acc_x 84.3750 (86.3750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/35] time 0.157 (0.158) data 0.081 (0.081) loss_x loss_x 0.2246 (0.5016) acc_x 90.6250 (85.9375) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [35/35] time 0.159 (0.162) data 0.082 (0.081) loss_x loss_x 0.5474 (0.5227) acc_x 87.5000 (85.5357) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1141
clean true:1139
clean false:2
clean_rate:0.9982471516213848
noisy true:145
noisy false:314
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 459
epoch [176/200] batch [5/35] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.2974 (0.4571) acc_x 84.3750 (88.1250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/35] time 0.156 (0.157) data 0.079 (0.081) loss_x loss_x 0.2499 (0.4396) acc_x 93.7500 (88.1250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/35] time 0.158 (0.168) data 0.082 (0.081) loss_x loss_x 0.1727 (0.4959) acc_x 96.8750 (87.0833) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/35] time 0.155 (0.166) data 0.079 (0.081) loss_x loss_x 0.5356 (0.4668) acc_x 87.5000 (87.8125) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/35] time 0.157 (0.164) data 0.081 (0.082) loss_x loss_x 0.4551 (0.4551) acc_x 90.6250 (88.1250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/35] time 0.157 (0.163) data 0.082 (0.081) loss_x loss_x 0.7061 (0.4731) acc_x 84.3750 (87.6042) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [35/35] time 0.163 (0.162) data 0.086 (0.082) loss_x loss_x 0.4414 (0.5173) acc_x 90.6250 (86.1607) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 311
confident_label rate tensor(0.7138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1142
clean true:1142
clean false:0
clean_rate:1.0
noisy true:147
noisy false:311
after delete: len(clean_dataset) 1142
after delete: len(noisy_dataset) 458
epoch [177/200] batch [5/35] time 0.157 (0.156) data 0.081 (0.080) loss_x loss_x 0.7778 (0.5503) acc_x 78.1250 (83.7500) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/35] time 0.177 (0.172) data 0.101 (0.082) loss_x loss_x 0.2971 (0.5248) acc_x 93.7500 (85.3125) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/35] time 0.156 (0.167) data 0.080 (0.081) loss_x loss_x 0.6025 (0.5018) acc_x 87.5000 (86.2500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/35] time 0.158 (0.165) data 0.081 (0.081) loss_x loss_x 0.4165 (0.4955) acc_x 87.5000 (86.2500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/35] time 0.156 (0.163) data 0.079 (0.081) loss_x loss_x 0.6108 (0.5458) acc_x 87.5000 (85.0000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/35] time 0.162 (0.166) data 0.085 (0.081) loss_x loss_x 0.9556 (0.5402) acc_x 78.1250 (85.4167) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [35/35] time 0.157 (0.165) data 0.081 (0.081) loss_x loss_x 0.9170 (0.5430) acc_x 78.1250 (85.3571) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.7131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1141
clean true:1141
clean false:0
clean_rate:1.0
noisy true:150
noisy false:309
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 459
epoch [178/200] batch [5/35] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.7378 (0.4679) acc_x 84.3750 (89.3750) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/35] time 0.156 (0.158) data 0.081 (0.082) loss_x loss_x 0.2949 (0.5225) acc_x 93.7500 (88.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/35] time 0.158 (0.157) data 0.083 (0.081) loss_x loss_x 0.3223 (0.4650) acc_x 93.7500 (90.0000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/35] time 0.158 (0.157) data 0.082 (0.081) loss_x loss_x 0.5068 (0.4915) acc_x 87.5000 (88.9062) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/35] time 0.156 (0.157) data 0.081 (0.081) loss_x loss_x 0.4133 (0.5000) acc_x 90.6250 (88.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/35] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.1229 (0.4863) acc_x 96.8750 (88.4375) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [35/35] time 0.220 (0.163) data 0.085 (0.082) loss_x loss_x 0.5522 (0.4955) acc_x 87.5000 (88.1250) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1144
clean false:1
clean_rate:0.9991266375545852
noisy true:151
noisy false:304
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [179/200] batch [5/35] time 0.155 (0.159) data 0.079 (0.083) loss_x loss_x 0.3379 (0.3511) acc_x 93.7500 (92.5000) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/35] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.3721 (0.3841) acc_x 81.2500 (90.0000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/35] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.2852 (0.4032) acc_x 93.7500 (89.1667) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/35] time 0.162 (0.159) data 0.086 (0.083) loss_x loss_x 0.6089 (0.4457) acc_x 84.3750 (87.8125) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/35] time 0.270 (0.164) data 0.083 (0.082) loss_x loss_x 0.4424 (0.4571) acc_x 90.6250 (87.0000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/35] time 0.155 (0.162) data 0.079 (0.082) loss_x loss_x 0.8906 (0.4991) acc_x 75.0000 (85.8333) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [35/35] time 0.166 (0.163) data 0.090 (0.083) loss_x loss_x 0.9150 (0.5052) acc_x 78.1250 (85.9821) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.7075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:161
noisy false:307
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 468
epoch [180/200] batch [5/35] time 0.154 (0.156) data 0.078 (0.080) loss_x loss_x 0.3936 (0.3750) acc_x 93.7500 (90.6250) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/35] time 0.161 (0.158) data 0.084 (0.082) loss_x loss_x 0.4041 (0.3996) acc_x 90.6250 (90.6250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.9023 (0.4977) acc_x 75.0000 (87.9167) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/35] time 0.218 (0.161) data 0.079 (0.081) loss_x loss_x 0.3120 (0.4857) acc_x 90.6250 (88.2812) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/35] time 0.154 (0.161) data 0.078 (0.081) loss_x loss_x 0.4104 (0.4923) acc_x 93.7500 (88.0000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/35] time 0.158 (0.161) data 0.082 (0.082) loss_x loss_x 0.4165 (0.5015) acc_x 96.8750 (87.6042) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [35/35] time 0.159 (0.161) data 0.083 (0.082) loss_x loss_x 0.3027 (0.5042) acc_x 93.7500 (87.8571) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1151
clean true:1148
clean false:3
clean_rate:0.9973935708079931
noisy true:154
noisy false:295
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 449
epoch [181/200] batch [5/35] time 0.157 (0.157) data 0.081 (0.081) loss_x loss_x 0.7036 (0.6086) acc_x 81.2500 (84.3750) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/35] time 0.156 (0.157) data 0.080 (0.081) loss_x loss_x 0.1599 (0.5542) acc_x 100.0000 (87.1875) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/35] time 0.158 (0.158) data 0.082 (0.081) loss_x loss_x 0.6519 (0.6351) acc_x 84.3750 (85.0000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/35] time 0.257 (0.168) data 0.081 (0.081) loss_x loss_x 0.5396 (0.5810) acc_x 87.5000 (86.2500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/35] time 0.158 (0.166) data 0.082 (0.082) loss_x loss_x 0.4910 (0.5782) acc_x 87.5000 (85.6250) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/35] time 0.159 (0.165) data 0.083 (0.082) loss_x loss_x 1.0127 (0.5711) acc_x 78.1250 (85.7292) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [35/35] time 0.160 (0.164) data 0.083 (0.082) loss_x loss_x 0.3708 (0.5519) acc_x 87.5000 (85.9821) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1107
clean false:0
clean_rate:1.0
noisy true:146
noisy false:347
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [182/200] batch [5/34] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.3469 (0.4519) acc_x 90.6250 (85.0000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/34] time 0.158 (0.158) data 0.082 (0.081) loss_x loss_x 0.4990 (0.4487) acc_x 90.6250 (86.2500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/34] time 0.160 (0.158) data 0.084 (0.082) loss_x loss_x 0.5068 (0.4854) acc_x 87.5000 (86.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/34] time 0.159 (0.159) data 0.083 (0.083) loss_x loss_x 0.9502 (0.5477) acc_x 71.8750 (85.9375) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/34] time 0.157 (0.159) data 0.081 (0.082) loss_x loss_x 0.3357 (0.5158) acc_x 90.6250 (86.8750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/34] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.4927 (0.5037) acc_x 87.5000 (86.8750) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1138
clean true:1138
clean false:0
clean_rate:1.0
noisy true:155
noisy false:307
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 462
epoch [183/200] batch [5/35] time 0.267 (0.202) data 0.082 (0.082) loss_x loss_x 0.5200 (0.5161) acc_x 87.5000 (88.1250) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [10/35] time 0.156 (0.180) data 0.079 (0.082) loss_x loss_x 1.1865 (0.5688) acc_x 71.8750 (85.6250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/35] time 0.161 (0.173) data 0.084 (0.082) loss_x loss_x 0.3215 (0.5612) acc_x 87.5000 (86.0417) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/35] time 0.157 (0.169) data 0.080 (0.082) loss_x loss_x 0.8232 (0.5287) acc_x 81.2500 (86.4062) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/35] time 0.156 (0.168) data 0.080 (0.083) loss_x loss_x 0.5298 (0.5323) acc_x 81.2500 (85.7500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/35] time 0.160 (0.166) data 0.083 (0.083) loss_x loss_x 0.2305 (0.5277) acc_x 96.8750 (85.8333) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [35/35] time 0.159 (0.165) data 0.083 (0.083) loss_x loss_x 0.4807 (0.5187) acc_x 90.6250 (86.2500) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.6987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1118
clean true:1118
clean false:0
clean_rate:1.0
noisy true:154
noisy false:328
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 482
epoch [184/200] batch [5/34] time 0.156 (0.157) data 0.080 (0.080) loss_x loss_x 0.4207 (0.5556) acc_x 90.6250 (83.7500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/34] time 0.270 (0.178) data 0.084 (0.081) loss_x loss_x 0.4158 (0.5508) acc_x 84.3750 (83.7500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/34] time 0.160 (0.172) data 0.083 (0.082) loss_x loss_x 0.1453 (0.5242) acc_x 93.7500 (84.7917) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/34] time 0.158 (0.169) data 0.081 (0.082) loss_x loss_x 0.5039 (0.5094) acc_x 87.5000 (85.4688) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/34] time 0.154 (0.167) data 0.078 (0.082) loss_x loss_x 0.7246 (0.5435) acc_x 87.5000 (85.1250) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/34] time 0.158 (0.165) data 0.082 (0.082) loss_x loss_x 0.7471 (0.5362) acc_x 87.5000 (85.7292) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 286
confident_label rate tensor(0.7262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1162
clean true:1162
clean false:0
clean_rate:1.0
noisy true:152
noisy false:286
after delete: len(clean_dataset) 1162
after delete: len(noisy_dataset) 438
epoch [185/200] batch [5/36] time 0.159 (0.199) data 0.083 (0.082) loss_x loss_x 0.3015 (0.6932) acc_x 90.6250 (84.3750) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [10/36] time 0.158 (0.178) data 0.082 (0.081) loss_x loss_x 0.4902 (0.6172) acc_x 90.6250 (85.9375) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/36] time 0.155 (0.171) data 0.079 (0.081) loss_x loss_x 0.4705 (0.6083) acc_x 87.5000 (85.2083) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/36] time 0.154 (0.168) data 0.078 (0.081) loss_x loss_x 1.3838 (0.6518) acc_x 71.8750 (83.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/36] time 0.159 (0.166) data 0.083 (0.081) loss_x loss_x 0.7847 (0.6219) acc_x 78.1250 (83.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/36] time 0.157 (0.164) data 0.081 (0.081) loss_x loss_x 0.6768 (0.5876) acc_x 84.3750 (84.8958) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [35/36] time 0.157 (0.168) data 0.081 (0.081) loss_x loss_x 0.3171 (0.5569) acc_x 90.6250 (85.5357) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.7119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1139
clean true:1139
clean false:0
clean_rate:1.0
noisy true:153
noisy false:308
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 461
epoch [186/200] batch [5/35] time 0.157 (0.157) data 0.081 (0.081) loss_x loss_x 0.5210 (0.5989) acc_x 90.6250 (85.0000) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/35] time 0.158 (0.158) data 0.082 (0.081) loss_x loss_x 0.6265 (0.5781) acc_x 78.1250 (85.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.8911 (0.5963) acc_x 81.2500 (85.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/35] time 0.166 (0.163) data 0.079 (0.081) loss_x loss_x 0.3757 (0.5643) acc_x 87.5000 (85.7812) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/35] time 0.161 (0.163) data 0.085 (0.081) loss_x loss_x 0.1904 (0.5546) acc_x 93.7500 (86.0000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/35] time 0.161 (0.162) data 0.084 (0.081) loss_x loss_x 0.1538 (0.5526) acc_x 96.8750 (86.1458) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [35/35] time 0.159 (0.162) data 0.083 (0.082) loss_x loss_x 0.6313 (0.5595) acc_x 81.2500 (85.4464) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 301
confident_label rate tensor(0.7194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1151
clean true:1149
clean false:2
clean_rate:0.998262380538662
noisy true:150
noisy false:299
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 449
epoch [187/200] batch [5/35] time 0.160 (0.158) data 0.083 (0.082) loss_x loss_x 0.4121 (0.5729) acc_x 84.3750 (83.7500) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/35] time 0.158 (0.158) data 0.082 (0.082) loss_x loss_x 0.3616 (0.5567) acc_x 90.6250 (84.3750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/35] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.2573 (0.5236) acc_x 93.7500 (85.2083) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/35] time 0.156 (0.158) data 0.080 (0.082) loss_x loss_x 0.3193 (0.5286) acc_x 93.7500 (85.6250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/35] time 0.158 (0.158) data 0.082 (0.082) loss_x loss_x 1.1035 (0.5708) acc_x 78.1250 (85.1250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/35] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.9546 (0.5605) acc_x 78.1250 (85.5208) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [35/35] time 0.161 (0.158) data 0.085 (0.082) loss_x loss_x 0.6309 (0.5523) acc_x 84.3750 (85.8036) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 296
confident_label rate tensor(0.7188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1150
clean true:1149
clean false:1
clean_rate:0.9991304347826087
noisy true:155
noisy false:295
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 450
epoch [188/200] batch [5/35] time 0.156 (0.160) data 0.080 (0.084) loss_x loss_x 0.6602 (0.6119) acc_x 87.5000 (81.8750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/35] time 0.156 (0.159) data 0.080 (0.083) loss_x loss_x 0.4175 (0.5671) acc_x 87.5000 (83.7500) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/35] time 0.159 (0.158) data 0.082 (0.082) loss_x loss_x 0.6855 (0.5778) acc_x 81.2500 (84.1667) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/35] time 0.161 (0.158) data 0.084 (0.082) loss_x loss_x 0.4380 (0.5589) acc_x 87.5000 (85.0000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/35] time 0.157 (0.158) data 0.081 (0.082) loss_x loss_x 0.8086 (0.5413) acc_x 75.0000 (85.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/35] time 0.155 (0.158) data 0.079 (0.082) loss_x loss_x 0.2600 (0.5265) acc_x 90.6250 (85.8333) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [35/35] time 0.157 (0.158) data 0.081 (0.082) loss_x loss_x 0.3914 (0.5466) acc_x 93.7500 (85.6250) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 296
confident_label rate tensor(0.7200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1152
clean true:1150
clean false:2
clean_rate:0.9982638888888888
noisy true:154
noisy false:294
after delete: len(clean_dataset) 1152
after delete: len(noisy_dataset) 448
epoch [189/200] batch [5/36] time 0.158 (0.157) data 0.081 (0.081) loss_x loss_x 0.6211 (0.5614) acc_x 84.3750 (85.6250) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/36] time 0.164 (0.159) data 0.088 (0.082) loss_x loss_x 0.6089 (0.5219) acc_x 84.3750 (85.9375) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/36] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.2549 (0.5246) acc_x 93.7500 (86.0417) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/36] time 0.154 (0.158) data 0.078 (0.082) loss_x loss_x 0.6030 (0.5327) acc_x 87.5000 (85.7812) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/36] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.3372 (0.5073) acc_x 90.6250 (86.7500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/36] time 0.154 (0.158) data 0.078 (0.081) loss_x loss_x 0.4492 (0.5155) acc_x 90.6250 (86.4583) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [35/36] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.1759 (0.5067) acc_x 93.7500 (86.6964) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 289
confident_label rate tensor(0.7225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1156
clean true:1155
clean false:1
clean_rate:0.9991349480968859
noisy true:156
noisy false:288
after delete: len(clean_dataset) 1156
after delete: len(noisy_dataset) 444
epoch [190/200] batch [5/36] time 0.165 (0.201) data 0.089 (0.084) loss_x loss_x 0.4260 (0.6445) acc_x 87.5000 (84.3750) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/36] time 0.159 (0.179) data 0.082 (0.083) loss_x loss_x 0.3403 (0.5557) acc_x 87.5000 (86.2500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/36] time 0.163 (0.173) data 0.086 (0.083) loss_x loss_x 0.3945 (0.5216) acc_x 90.6250 (86.0417) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/36] time 0.153 (0.169) data 0.077 (0.083) loss_x loss_x 0.8657 (0.5087) acc_x 78.1250 (86.7188) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/36] time 0.159 (0.167) data 0.083 (0.082) loss_x loss_x 0.3081 (0.4900) acc_x 93.7500 (87.2500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/36] time 0.159 (0.170) data 0.082 (0.082) loss_x loss_x 0.3113 (0.4757) acc_x 93.7500 (87.6042) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [35/36] time 0.156 (0.168) data 0.080 (0.082) loss_x loss_x 0.7061 (0.4923) acc_x 78.1250 (86.7857) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1124
clean true:1124
clean false:0
clean_rate:1.0
noisy true:152
noisy false:324
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 476
epoch [191/200] batch [5/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.5557 (0.6818) acc_x 90.6250 (80.0000) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/35] time 0.156 (0.158) data 0.080 (0.082) loss_x loss_x 0.3062 (0.5447) acc_x 93.7500 (84.0625) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/35] time 0.213 (0.170) data 0.083 (0.082) loss_x loss_x 0.2747 (0.5283) acc_x 93.7500 (84.7917) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/35] time 0.162 (0.167) data 0.085 (0.082) loss_x loss_x 0.2277 (0.4963) acc_x 93.7500 (86.2500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/35] time 0.158 (0.165) data 0.081 (0.082) loss_x loss_x 0.9014 (0.5344) acc_x 81.2500 (85.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/35] time 0.161 (0.166) data 0.085 (0.083) loss_x loss_x 1.0342 (0.5299) acc_x 81.2500 (86.0417) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [35/35] time 0.161 (0.164) data 0.084 (0.083) loss_x loss_x 0.2661 (0.5200) acc_x 93.7500 (85.8929) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.7175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1148
clean true:1147
clean false:1
clean_rate:0.9991289198606271
noisy true:144
noisy false:308
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 452
epoch [192/200] batch [5/35] time 0.152 (0.157) data 0.075 (0.080) loss_x loss_x 0.4795 (0.6128) acc_x 87.5000 (81.8750) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/35] time 0.158 (0.157) data 0.081 (0.081) loss_x loss_x 0.3369 (0.5707) acc_x 87.5000 (83.4375) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/35] time 0.153 (0.157) data 0.076 (0.081) loss_x loss_x 0.7144 (0.6215) acc_x 78.1250 (82.9167) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/35] time 0.155 (0.157) data 0.079 (0.080) loss_x loss_x 0.5317 (0.5980) acc_x 90.6250 (84.5312) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/35] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.5156 (0.5805) acc_x 81.2500 (84.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/35] time 0.158 (0.157) data 0.081 (0.081) loss_x loss_x 0.5527 (0.5632) acc_x 84.3750 (85.1042) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [35/35] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.9902 (0.5611) acc_x 81.2500 (85.5357) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.7056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:142
noisy false:329
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 471
epoch [193/200] batch [5/35] time 0.159 (0.157) data 0.082 (0.081) loss_x loss_x 0.4604 (0.5670) acc_x 90.6250 (85.6250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/35] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.3765 (0.5420) acc_x 90.6250 (87.1875) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/35] time 0.156 (0.157) data 0.079 (0.081) loss_x loss_x 0.5825 (0.6075) acc_x 81.2500 (84.7917) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/35] time 0.155 (0.158) data 0.079 (0.081) loss_x loss_x 0.7822 (0.6073) acc_x 81.2500 (84.6875) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/35] time 0.160 (0.158) data 0.083 (0.082) loss_x loss_x 0.5234 (0.5991) acc_x 87.5000 (85.0000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/35] time 0.156 (0.158) data 0.080 (0.082) loss_x loss_x 0.6426 (0.5665) acc_x 78.1250 (85.5208) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [35/35] time 0.162 (0.158) data 0.085 (0.082) loss_x loss_x 0.5239 (0.5592) acc_x 81.2500 (85.4464) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:153
noisy false:326
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [194/200] batch [5/35] time 0.157 (0.158) data 0.081 (0.082) loss_x loss_x 0.7017 (0.5278) acc_x 78.1250 (85.0000) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/35] time 0.160 (0.158) data 0.084 (0.082) loss_x loss_x 0.9570 (0.5430) acc_x 81.2500 (85.3125) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/35] time 0.158 (0.158) data 0.082 (0.082) loss_x loss_x 0.8057 (0.5807) acc_x 81.2500 (84.1667) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/35] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.7598 (0.5523) acc_x 78.1250 (85.3125) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/35] time 0.158 (0.159) data 0.082 (0.082) loss_x loss_x 0.4646 (0.5615) acc_x 87.5000 (85.0000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/35] time 0.162 (0.159) data 0.086 (0.082) loss_x loss_x 0.9272 (0.5661) acc_x 81.2500 (84.7917) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [35/35] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.3374 (0.5391) acc_x 90.6250 (85.5357) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 294
confident_label rate tensor(0.7194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1151
clean true:1150
clean false:1
clean_rate:0.9991311902693311
noisy true:156
noisy false:293
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 449
epoch [195/200] batch [5/35] time 0.267 (0.181) data 0.082 (0.083) loss_x loss_x 0.5576 (0.6190) acc_x 87.5000 (85.6250) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/35] time 0.157 (0.172) data 0.081 (0.082) loss_x loss_x 0.8311 (0.5939) acc_x 78.1250 (85.6250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/35] time 0.157 (0.168) data 0.080 (0.082) loss_x loss_x 0.4175 (0.5633) acc_x 87.5000 (85.8333) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/35] time 0.158 (0.165) data 0.081 (0.082) loss_x loss_x 0.3069 (0.5556) acc_x 87.5000 (85.9375) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/35] time 0.158 (0.163) data 0.081 (0.081) loss_x loss_x 1.1670 (0.5897) acc_x 78.1250 (85.5000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/35] time 0.158 (0.162) data 0.082 (0.081) loss_x loss_x 0.8154 (0.5846) acc_x 78.1250 (85.2083) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [35/35] time 0.160 (0.161) data 0.084 (0.081) loss_x loss_x 0.3667 (0.5496) acc_x 90.6250 (86.1607) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1104
clean true:1104
clean false:0
clean_rate:1.0
noisy true:157
noisy false:339
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 496
epoch [196/200] batch [5/34] time 0.155 (0.158) data 0.078 (0.081) loss_x loss_x 0.3606 (0.3448) acc_x 90.6250 (90.0000) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/34] time 0.156 (0.158) data 0.079 (0.082) loss_x loss_x 0.4124 (0.3910) acc_x 90.6250 (90.0000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/34] time 0.162 (0.159) data 0.086 (0.082) loss_x loss_x 0.3828 (0.4120) acc_x 87.5000 (88.7500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/34] time 0.159 (0.159) data 0.083 (0.083) loss_x loss_x 0.6572 (0.4471) acc_x 81.2500 (87.9688) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/34] time 0.158 (0.159) data 0.082 (0.083) loss_x loss_x 0.5898 (0.4619) acc_x 84.3750 (87.7500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/34] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.6548 (0.4737) acc_x 84.3750 (87.0833) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.7169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1147
clean true:1146
clean false:1
clean_rate:0.999128160418483
noisy true:148
noisy false:305
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 453
epoch [197/200] batch [5/35] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.4128 (0.5731) acc_x 90.6250 (86.2500) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/35] time 0.158 (0.158) data 0.081 (0.082) loss_x loss_x 0.2137 (0.5121) acc_x 96.8750 (87.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/35] time 0.159 (0.158) data 0.083 (0.082) loss_x loss_x 0.4026 (0.4673) acc_x 90.6250 (88.7500) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/35] time 0.157 (0.158) data 0.080 (0.082) loss_x loss_x 0.7046 (0.5179) acc_x 87.5000 (87.1875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/35] time 0.161 (0.163) data 0.084 (0.082) loss_x loss_x 0.6025 (0.5177) acc_x 87.5000 (87.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/35] time 0.157 (0.162) data 0.080 (0.082) loss_x loss_x 0.4517 (0.4936) acc_x 87.5000 (87.6042) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [35/35] time 0.157 (0.162) data 0.081 (0.082) loss_x loss_x 0.9224 (0.4997) acc_x 81.2500 (87.5893) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.7144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1143
clean true:1141
clean false:2
clean_rate:0.9982502187226596
noisy true:145
noisy false:312
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 457
epoch [198/200] batch [5/35] time 0.153 (0.156) data 0.077 (0.079) loss_x loss_x 0.5566 (0.5483) acc_x 87.5000 (84.3750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/35] time 0.157 (0.167) data 0.080 (0.079) loss_x loss_x 0.2715 (0.5996) acc_x 90.6250 (83.7500) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/35] time 0.158 (0.163) data 0.081 (0.079) loss_x loss_x 0.8428 (0.5832) acc_x 75.0000 (83.5417) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/35] time 0.158 (0.161) data 0.081 (0.079) loss_x loss_x 0.9238 (0.5423) acc_x 78.1250 (85.3125) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/35] time 0.155 (0.160) data 0.079 (0.080) loss_x loss_x 0.6113 (0.5485) acc_x 87.5000 (85.6250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/35] time 0.160 (0.160) data 0.084 (0.080) loss_x loss_x 0.3962 (0.5195) acc_x 93.7500 (86.4583) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [35/35] time 0.159 (0.160) data 0.082 (0.080) loss_x loss_x 0.5815 (0.5395) acc_x 90.6250 (85.8929) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1134
clean true:1134
clean false:0
clean_rate:1.0
noisy true:159
noisy false:307
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 466
epoch [199/200] batch [5/35] time 0.272 (0.194) data 0.100 (0.098) loss_x loss_x 0.3074 (0.4232) acc_x 96.8750 (90.0000) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [10/35] time 0.179 (0.196) data 0.103 (0.100) loss_x loss_x 0.4670 (0.4685) acc_x 87.5000 (89.3750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/35] time 0.184 (0.191) data 0.107 (0.102) loss_x loss_x 0.9014 (0.4972) acc_x 78.1250 (87.9167) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/35] time 0.178 (0.188) data 0.101 (0.102) loss_x loss_x 0.4380 (0.4892) acc_x 90.6250 (87.9688) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/35] time 0.156 (0.182) data 0.080 (0.098) loss_x loss_x 0.3979 (0.4770) acc_x 87.5000 (87.8750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/35] time 0.156 (0.178) data 0.079 (0.095) loss_x loss_x 0.7251 (0.5019) acc_x 84.3750 (87.9167) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [35/35] time 0.154 (0.175) data 0.078 (0.093) loss_x loss_x 0.7114 (0.5025) acc_x 75.0000 (87.3214) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.7063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1130
clean true:1130
clean false:0
clean_rate:1.0
noisy true:155
noisy false:315
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 470
epoch [200/200] batch [5/35] time 0.162 (0.160) data 0.085 (0.084) loss_x loss_x 0.2310 (0.4125) acc_x 93.7500 (86.2500) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/35] time 0.161 (0.159) data 0.084 (0.083) loss_x loss_x 0.4812 (0.4968) acc_x 87.5000 (86.5625) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/35] time 0.265 (0.171) data 0.079 (0.082) loss_x loss_x 0.6064 (0.4620) acc_x 84.3750 (87.9167) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/35] time 0.159 (0.168) data 0.082 (0.082) loss_x loss_x 0.3372 (0.4903) acc_x 87.5000 (86.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/35] time 0.158 (0.166) data 0.081 (0.082) loss_x loss_x 0.4846 (0.4834) acc_x 87.5000 (87.0000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/35] time 0.159 (0.164) data 0.082 (0.082) loss_x loss_x 0.4705 (0.4931) acc_x 90.6250 (87.2917) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [35/35] time 0.160 (0.164) data 0.083 (0.082) loss_x loss_x 0.4211 (0.4860) acc_x 87.5000 (87.2321) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,251
* accuracy: 91.3%
* error: 8.7%
* macro_f1: 87.5%
Elapsed: 0:48:33
