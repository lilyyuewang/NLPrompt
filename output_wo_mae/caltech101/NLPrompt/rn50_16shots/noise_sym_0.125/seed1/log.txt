***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:661
clean false:1
clean_rate:0.9984894259818731
noisy true:94
noisy false:844
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [1/200] batch [5/20] time 0.183 (0.187) data 0.106 (0.091) loss_x loss_x 2.5664 (2.7547) acc_x 71.8750 (64.3750) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [10/20] time 0.168 (0.184) data 0.090 (0.097) loss_x loss_x 2.0820 (2.6574) acc_x 65.6250 (62.8125) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [15/20] time 0.168 (0.184) data 0.091 (0.101) loss_x loss_x 1.6006 (2.4628) acc_x 81.2500 (65.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [20/20] time 0.166 (0.180) data 0.089 (0.098) loss_x loss_x 1.7500 (2.2838) acc_x 65.6250 (66.5625) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 679
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:799
clean false:3
clean_rate:0.9962593516209476
noisy true:122
noisy false:676
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [2/200] batch [5/25] time 0.165 (0.160) data 0.088 (0.084) loss_x loss_x 1.0029 (1.3988) acc_x 71.8750 (66.8750) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [10/25] time 0.175 (0.167) data 0.098 (0.090) loss_x loss_x 0.9585 (1.2648) acc_x 78.1250 (69.6875) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [15/25] time 0.187 (0.173) data 0.109 (0.097) loss_x loss_x 1.1387 (1.1532) acc_x 78.1250 (72.0833) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [20/25] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.7480 (1.0793) acc_x 78.1250 (72.5000) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [25/25] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.9971 (1.0576) acc_x 68.7500 (73.0000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 539
confident_label rate tensor(0.5769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 923
clean true:922
clean false:1
clean_rate:0.9989165763813651
noisy true:139
noisy false:538
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 677
epoch [3/200] batch [5/28] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 1.1689 (1.1049) acc_x 68.7500 (71.8750) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/28] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.6055 (0.9628) acc_x 81.2500 (75.0000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/28] time 0.164 (0.178) data 0.087 (0.101) loss_x loss_x 1.4512 (0.9401) acc_x 71.8750 (76.4583) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/28] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.5635 (0.8443) acc_x 78.1250 (78.1250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/28] time 0.169 (0.175) data 0.093 (0.098) loss_x loss_x 0.7212 (0.8534) acc_x 84.3750 (77.3750) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 524
confident_label rate tensor(0.5856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 937
clean true:937
clean false:0
clean_rate:1.0
noisy true:139
noisy false:524
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 663
epoch [4/200] batch [5/29] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 1.0352 (0.9066) acc_x 81.2500 (76.2500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/29] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 1.0215 (0.9081) acc_x 75.0000 (77.8125) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/29] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.6929 (0.8500) acc_x 81.2500 (78.9583) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/29] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 1.3730 (0.8803) acc_x 71.8750 (78.4375) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/29] time 0.165 (0.171) data 0.089 (0.094) loss_x loss_x 1.1240 (0.8929) acc_x 68.7500 (78.0000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.6031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 965
clean true:965
clean false:0
clean_rate:1.0
noisy true:154
noisy false:481
after delete: len(clean_dataset) 965
after delete: len(noisy_dataset) 635
epoch [5/200] batch [5/30] time 0.179 (0.177) data 0.102 (0.100) loss_x loss_x 0.6851 (0.8077) acc_x 81.2500 (80.0000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/30] time 0.166 (0.173) data 0.088 (0.096) loss_x loss_x 0.5474 (0.9048) acc_x 81.2500 (77.5000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/30] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.7754 (0.8231) acc_x 84.3750 (80.0000) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/30] time 0.189 (0.173) data 0.113 (0.096) loss_x loss_x 0.5918 (0.7835) acc_x 71.8750 (79.6875) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/30] time 0.219 (0.177) data 0.142 (0.100) loss_x loss_x 0.7798 (0.7714) acc_x 81.2500 (80.0000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [30/30] time 0.194 (0.179) data 0.118 (0.102) loss_x loss_x 0.9517 (0.7828) acc_x 81.2500 (79.5833) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.6019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 963
clean true:961
clean false:2
clean_rate:0.9979231568016614
noisy true:143
noisy false:494
after delete: len(clean_dataset) 963
after delete: len(noisy_dataset) 637
epoch [6/200] batch [5/30] time 0.157 (0.155) data 0.079 (0.078) loss_x loss_x 0.7217 (0.8373) acc_x 87.5000 (76.8750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/30] time 0.159 (0.157) data 0.082 (0.080) loss_x loss_x 0.7905 (0.8257) acc_x 90.6250 (79.3750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/30] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.5840 (0.8258) acc_x 84.3750 (79.3750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/30] time 0.200 (0.161) data 0.123 (0.084) loss_x loss_x 1.1943 (0.8226) acc_x 75.0000 (78.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/30] time 0.168 (0.165) data 0.091 (0.088) loss_x loss_x 0.5889 (0.7981) acc_x 81.2500 (79.5000) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [30/30] time 0.167 (0.166) data 0.090 (0.089) loss_x loss_x 0.5698 (0.8163) acc_x 81.2500 (78.4375) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 499
confident_label rate tensor(0.6025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 964
clean true:961
clean false:3
clean_rate:0.9968879668049793
noisy true:140
noisy false:496
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 636
epoch [7/200] batch [5/30] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.9785 (0.8038) acc_x 78.1250 (78.1250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/30] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.9165 (0.8042) acc_x 68.7500 (75.9375) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/30] time 0.191 (0.179) data 0.114 (0.102) loss_x loss_x 0.5815 (0.7940) acc_x 90.6250 (77.9167) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/30] time 0.158 (0.174) data 0.081 (0.097) loss_x loss_x 0.7998 (0.8156) acc_x 71.8750 (77.6562) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/30] time 0.159 (0.171) data 0.082 (0.094) loss_x loss_x 0.4277 (0.8279) acc_x 84.3750 (77.7500) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [30/30] time 0.164 (0.170) data 0.086 (0.093) loss_x loss_x 0.8506 (0.8288) acc_x 81.2500 (78.3333) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.6100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 976
clean true:975
clean false:1
clean_rate:0.9989754098360656
noisy true:142
noisy false:482
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 624
epoch [8/200] batch [5/30] time 0.188 (0.177) data 0.111 (0.101) loss_x loss_x 0.6729 (0.7511) acc_x 81.2500 (80.0000) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/30] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.5991 (0.7451) acc_x 84.3750 (80.9375) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/30] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 1.2715 (0.8734) acc_x 62.5000 (77.2917) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/30] time 0.189 (0.183) data 0.112 (0.106) loss_x loss_x 0.7632 (0.8320) acc_x 75.0000 (78.2812) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/30] time 0.165 (0.182) data 0.089 (0.105) loss_x loss_x 0.5435 (0.8076) acc_x 84.3750 (78.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [30/30] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.6108 (0.8216) acc_x 81.2500 (78.2292) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.6244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 999
clean true:999
clean false:0
clean_rate:1.0
noisy true:154
noisy false:447
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 601
epoch [9/200] batch [5/31] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6401 (0.7757) acc_x 81.2500 (80.0000) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/31] time 0.174 (0.181) data 0.098 (0.103) loss_x loss_x 0.8257 (0.8178) acc_x 81.2500 (78.1250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/31] time 0.165 (0.180) data 0.089 (0.103) loss_x loss_x 0.6958 (0.8106) acc_x 78.1250 (78.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/31] time 0.171 (0.179) data 0.095 (0.102) loss_x loss_x 0.4741 (0.7785) acc_x 81.2500 (78.9062) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/31] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.6494 (0.7576) acc_x 84.3750 (80.3750) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/31] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.4304 (0.7736) acc_x 90.6250 (79.6875) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.6094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 975
clean true:975
clean false:0
clean_rate:1.0
noisy true:143
noisy false:482
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 625
epoch [10/200] batch [5/30] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 1.0742 (0.7645) acc_x 68.7500 (78.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/30] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.5288 (0.7457) acc_x 87.5000 (80.0000) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/30] time 0.189 (0.177) data 0.112 (0.100) loss_x loss_x 0.1742 (0.7600) acc_x 96.8750 (79.7917) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/30] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.7095 (0.7532) acc_x 84.3750 (79.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/30] time 0.196 (0.179) data 0.119 (0.102) loss_x loss_x 0.9287 (0.7423) acc_x 68.7500 (79.0000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [30/30] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.8140 (0.7202) acc_x 81.2500 (80.0000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.6231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 997
clean true:996
clean false:1
clean_rate:0.9989969909729187
noisy true:152
noisy false:451
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 603
epoch [11/200] batch [5/31] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.7222 (0.9202) acc_x 87.5000 (79.3750) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/31] time 0.184 (0.171) data 0.108 (0.093) loss_x loss_x 0.8164 (0.8834) acc_x 81.2500 (79.3750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/31] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 1.2100 (0.8876) acc_x 71.8750 (78.9583) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/31] time 0.198 (0.175) data 0.121 (0.098) loss_x loss_x 0.8628 (0.8511) acc_x 78.1250 (79.8438) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/31] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.8706 (0.8397) acc_x 78.1250 (79.1250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/31] time 0.187 (0.179) data 0.110 (0.103) loss_x loss_x 1.2520 (0.8364) acc_x 65.6250 (78.7500) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1014
clean true:1013
clean false:1
clean_rate:0.9990138067061144
noisy true:151
noisy false:435
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 586
epoch [12/200] batch [5/31] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.5820 (0.8156) acc_x 87.5000 (78.7500) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/31] time 0.168 (0.164) data 0.091 (0.087) loss_x loss_x 1.0127 (0.8843) acc_x 75.0000 (76.5625) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/31] time 0.216 (0.170) data 0.139 (0.093) loss_x loss_x 0.9375 (0.8677) acc_x 68.7500 (77.0833) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/31] time 0.218 (0.174) data 0.141 (0.097) loss_x loss_x 0.7188 (0.8519) acc_x 78.1250 (77.5000) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/31] time 0.175 (0.175) data 0.098 (0.098) loss_x loss_x 0.8877 (0.8504) acc_x 81.2500 (77.3750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/31] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.9019 (0.8176) acc_x 84.3750 (78.5417) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.6262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1002
clean true:1002
clean false:0
clean_rate:1.0
noisy true:150
noisy false:448
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 598
epoch [13/200] batch [5/31] time 0.179 (0.189) data 0.102 (0.112) loss_x loss_x 0.5088 (0.6746) acc_x 87.5000 (81.2500) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/31] time 0.158 (0.183) data 0.081 (0.105) loss_x loss_x 0.8457 (0.7427) acc_x 84.3750 (81.2500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/31] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 1.2217 (0.7701) acc_x 71.8750 (80.8333) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/31] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.7026 (0.7740) acc_x 81.2500 (80.6250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/31] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 1.1484 (0.7839) acc_x 78.1250 (80.7500) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [30/31] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.8408 (0.7875) acc_x 71.8750 (79.5833) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.6106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 977
clean true:976
clean false:1
clean_rate:0.9989764585465711
noisy true:156
noisy false:467
after delete: len(clean_dataset) 977
after delete: len(noisy_dataset) 623
epoch [14/200] batch [5/30] time 0.168 (0.167) data 0.090 (0.091) loss_x loss_x 0.8262 (0.8571) acc_x 78.1250 (80.6250) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/30] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 1.1631 (0.8125) acc_x 71.8750 (80.9375) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/30] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.4619 (0.7660) acc_x 75.0000 (80.2083) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/30] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.9365 (0.7572) acc_x 75.0000 (80.4688) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/30] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.5010 (0.7406) acc_x 84.3750 (80.6250) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [30/30] time 0.156 (0.174) data 0.079 (0.097) loss_x loss_x 0.4124 (0.7212) acc_x 84.3750 (80.8333) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.6356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1017
clean true:1017
clean false:0
clean_rate:1.0
noisy true:144
noisy false:439
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 583
epoch [15/200] batch [5/31] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.9272 (0.6006) acc_x 75.0000 (85.0000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/31] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.5781 (0.6728) acc_x 90.6250 (83.7500) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/31] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.7852 (0.7088) acc_x 75.0000 (81.0417) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/31] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.5210 (0.7072) acc_x 81.2500 (80.6250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/31] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.9312 (0.7248) acc_x 75.0000 (80.3750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [30/31] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.7925 (0.7405) acc_x 68.7500 (79.8958) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.6331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1013
clean true:1013
clean false:0
clean_rate:1.0
noisy true:147
noisy false:440
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 587
epoch [16/200] batch [5/31] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.3811 (0.7761) acc_x 87.5000 (78.1250) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [10/31] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.7334 (0.7894) acc_x 75.0000 (76.8750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/31] time 0.158 (0.181) data 0.081 (0.104) loss_x loss_x 0.6567 (0.7514) acc_x 81.2500 (78.5417) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/31] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.6372 (0.7267) acc_x 81.2500 (78.7500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/31] time 0.174 (0.180) data 0.098 (0.103) loss_x loss_x 0.8359 (0.6909) acc_x 75.0000 (80.1250) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/31] time 0.208 (0.181) data 0.130 (0.104) loss_x loss_x 0.8169 (0.7388) acc_x 78.1250 (79.2708) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.6325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1012
clean true:1011
clean false:1
clean_rate:0.9990118577075099
noisy true:146
noisy false:442
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 588
epoch [17/200] batch [5/31] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.8853 (0.8366) acc_x 71.8750 (74.3750) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/31] time 0.158 (0.171) data 0.082 (0.094) loss_x loss_x 0.7930 (0.7912) acc_x 78.1250 (77.8125) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/31] time 0.200 (0.173) data 0.123 (0.096) loss_x loss_x 0.6875 (0.7611) acc_x 78.1250 (78.1250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/31] time 0.187 (0.177) data 0.111 (0.100) loss_x loss_x 0.4980 (0.6946) acc_x 84.3750 (80.4688) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/31] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.6382 (0.7284) acc_x 81.2500 (79.7500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [30/31] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 1.0605 (0.7420) acc_x 68.7500 (79.8958) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.6344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1015
clean true:1014
clean false:1
clean_rate:0.9990147783251232
noisy true:147
noisy false:438
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 585
epoch [18/200] batch [5/31] time 0.172 (0.184) data 0.095 (0.107) loss_x loss_x 0.6606 (0.6354) acc_x 78.1250 (80.0000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/31] time 0.164 (0.180) data 0.087 (0.103) loss_x loss_x 0.6001 (0.6140) acc_x 81.2500 (82.5000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/31] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.9839 (0.6282) acc_x 68.7500 (82.2917) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/31] time 0.178 (0.176) data 0.102 (0.099) loss_x loss_x 0.7583 (0.6538) acc_x 81.2500 (81.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/31] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.1934 (0.6828) acc_x 96.8750 (80.7500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [30/31] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.8350 (0.7083) acc_x 81.2500 (80.2083) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.6538, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1046
clean true:1045
clean false:1
clean_rate:0.9990439770554493
noisy true:147
noisy false:407
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 554
epoch [19/200] batch [5/32] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.9980 (0.7586) acc_x 75.0000 (75.6250) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/32] time 0.161 (0.160) data 0.084 (0.082) loss_x loss_x 0.4270 (0.7903) acc_x 90.6250 (76.2500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/32] time 0.193 (0.171) data 0.116 (0.094) loss_x loss_x 0.6494 (0.8026) acc_x 84.3750 (77.0833) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/32] time 0.183 (0.172) data 0.107 (0.095) loss_x loss_x 0.7061 (0.7860) acc_x 84.3750 (77.5000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/32] time 0.185 (0.176) data 0.109 (0.099) loss_x loss_x 0.6763 (0.7458) acc_x 84.3750 (79.2500) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [30/32] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.5151 (0.7389) acc_x 81.2500 (79.4792) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.6319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1011
clean true:1011
clean false:0
clean_rate:1.0
noisy true:147
noisy false:442
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 589
epoch [20/200] batch [5/31] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.6143 (0.5432) acc_x 84.3750 (87.5000) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/31] time 0.158 (0.171) data 0.081 (0.094) loss_x loss_x 0.2969 (0.5874) acc_x 93.7500 (84.3750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/31] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 1.1689 (0.6310) acc_x 75.0000 (82.7083) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/31] time 0.173 (0.167) data 0.095 (0.090) loss_x loss_x 0.6880 (0.6482) acc_x 87.5000 (83.1250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/31] time 0.185 (0.168) data 0.108 (0.091) loss_x loss_x 0.7568 (0.6966) acc_x 78.1250 (81.8750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/31] time 0.188 (0.171) data 0.111 (0.094) loss_x loss_x 0.5483 (0.6985) acc_x 90.6250 (81.8750) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.6406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1025
clean true:1025
clean false:0
clean_rate:1.0
noisy true:154
noisy false:421
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 575
epoch [21/200] batch [5/32] time 0.192 (0.176) data 0.115 (0.099) loss_x loss_x 0.4368 (0.7590) acc_x 87.5000 (81.2500) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/32] time 0.190 (0.181) data 0.113 (0.104) loss_x loss_x 0.6592 (0.6734) acc_x 84.3750 (81.8750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/32] time 0.160 (0.183) data 0.083 (0.106) loss_x loss_x 1.1260 (0.7464) acc_x 62.5000 (80.8333) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/32] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.6724 (0.6955) acc_x 81.2500 (82.0312) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/32] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.3347 (0.6977) acc_x 87.5000 (81.7500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [30/32] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.5732 (0.6920) acc_x 84.3750 (81.7708) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.6488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1038
clean true:1038
clean false:0
clean_rate:1.0
noisy true:156
noisy false:406
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 562
epoch [22/200] batch [5/32] time 0.190 (0.191) data 0.113 (0.114) loss_x loss_x 0.3584 (0.7315) acc_x 90.6250 (78.1250) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/32] time 0.181 (0.189) data 0.104 (0.111) loss_x loss_x 0.5337 (0.6913) acc_x 90.6250 (81.5625) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/32] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.4207 (0.6458) acc_x 87.5000 (82.7083) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/32] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.3984 (0.6841) acc_x 87.5000 (82.0312) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/32] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5884 (0.6705) acc_x 90.6250 (82.5000) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [30/32] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.8486 (0.6780) acc_x 78.1250 (82.1875) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.6456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1033
clean true:1033
clean false:0
clean_rate:1.0
noisy true:155
noisy false:412
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 567
epoch [23/200] batch [5/32] time 0.177 (0.186) data 0.100 (0.110) loss_x loss_x 0.9980 (0.7340) acc_x 71.8750 (81.2500) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/32] time 0.200 (0.186) data 0.124 (0.109) loss_x loss_x 0.3909 (0.7745) acc_x 90.6250 (81.2500) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/32] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.4795 (0.7406) acc_x 90.6250 (81.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/32] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.5571 (0.7558) acc_x 90.6250 (81.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/32] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.1808 (0.7267) acc_x 96.8750 (82.0000) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/32] time 0.161 (0.178) data 0.085 (0.102) loss_x loss_x 0.4397 (0.6949) acc_x 87.5000 (82.0833) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.6438, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1030
clean true:1030
clean false:0
clean_rate:1.0
noisy true:145
noisy false:425
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 570
epoch [24/200] batch [5/32] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 0.5664 (0.7236) acc_x 84.3750 (81.8750) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/32] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.5400 (0.6358) acc_x 81.2500 (83.4375) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/32] time 0.171 (0.169) data 0.094 (0.092) loss_x loss_x 0.7500 (0.6799) acc_x 87.5000 (83.1250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/32] time 0.190 (0.171) data 0.113 (0.094) loss_x loss_x 0.4521 (0.6696) acc_x 93.7500 (82.6562) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/32] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.9097 (0.6875) acc_x 68.7500 (81.8750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [30/32] time 0.165 (0.173) data 0.089 (0.096) loss_x loss_x 0.4507 (0.7002) acc_x 81.2500 (81.8750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.6400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1024
clean true:1023
clean false:1
clean_rate:0.9990234375
noisy true:155
noisy false:421
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 576
epoch [25/200] batch [5/32] time 0.191 (0.174) data 0.114 (0.097) loss_x loss_x 0.5493 (0.6159) acc_x 90.6250 (86.8750) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/32] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 1.1211 (0.7944) acc_x 78.1250 (82.8125) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/32] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 0.4895 (0.7317) acc_x 87.5000 (83.1250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/32] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.7085 (0.7331) acc_x 81.2500 (82.3438) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/32] time 0.175 (0.170) data 0.098 (0.093) loss_x loss_x 0.7192 (0.7097) acc_x 78.1250 (82.2500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/32] time 0.188 (0.173) data 0.111 (0.095) loss_x loss_x 0.7207 (0.7020) acc_x 78.1250 (82.3958) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.6531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1045
clean true:1044
clean false:1
clean_rate:0.999043062200957
noisy true:145
noisy false:410
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 555
epoch [26/200] batch [5/32] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.8662 (0.6834) acc_x 78.1250 (81.2500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/32] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.5142 (0.7046) acc_x 84.3750 (80.3125) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/32] time 0.241 (0.191) data 0.164 (0.114) loss_x loss_x 0.5967 (0.7009) acc_x 81.2500 (80.8333) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/32] time 0.177 (0.189) data 0.100 (0.112) loss_x loss_x 0.5620 (0.7086) acc_x 90.6250 (80.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/32] time 0.170 (0.185) data 0.092 (0.108) loss_x loss_x 0.8682 (0.7425) acc_x 78.1250 (79.6250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [30/32] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 0.4602 (0.7661) acc_x 87.5000 (79.5833) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.6500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1040
clean true:1040
clean false:0
clean_rate:1.0
noisy true:146
noisy false:414
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 560
epoch [27/200] batch [5/32] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7622 (0.7320) acc_x 81.2500 (81.8750) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/32] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 1.1113 (0.6771) acc_x 71.8750 (83.7500) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/32] time 0.159 (0.180) data 0.083 (0.103) loss_x loss_x 0.7603 (0.6718) acc_x 75.0000 (83.1250) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/32] time 0.170 (0.180) data 0.092 (0.103) loss_x loss_x 0.6353 (0.6843) acc_x 84.3750 (82.1875) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/32] time 0.155 (0.178) data 0.079 (0.101) loss_x loss_x 1.1680 (0.7037) acc_x 68.7500 (81.0000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [30/32] time 0.188 (0.180) data 0.111 (0.102) loss_x loss_x 0.8574 (0.6936) acc_x 81.2500 (81.6667) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.6450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1032
clean true:1032
clean false:0
clean_rate:1.0
noisy true:149
noisy false:419
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 568
epoch [28/200] batch [5/32] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.8262 (0.8677) acc_x 75.0000 (76.2500) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/32] time 0.161 (0.180) data 0.085 (0.104) loss_x loss_x 0.6538 (0.7714) acc_x 75.0000 (79.0625) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/32] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.6929 (0.7963) acc_x 71.8750 (78.3333) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/32] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.8218 (0.7455) acc_x 75.0000 (79.6875) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/32] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.6797 (0.6969) acc_x 84.3750 (81.2500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/32] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.8008 (0.7029) acc_x 78.1250 (80.9375) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.6450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1032
clean true:1032
clean false:0
clean_rate:1.0
noisy true:146
noisy false:422
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 568
epoch [29/200] batch [5/32] time 0.160 (0.167) data 0.083 (0.090) loss_x loss_x 0.7222 (0.6454) acc_x 81.2500 (80.0000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/32] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.6455 (0.7315) acc_x 87.5000 (78.1250) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/32] time 0.159 (0.175) data 0.083 (0.098) loss_x loss_x 1.0576 (0.7886) acc_x 75.0000 (78.7500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/32] time 0.190 (0.176) data 0.113 (0.099) loss_x loss_x 0.4365 (0.7091) acc_x 87.5000 (80.6250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/32] time 0.155 (0.176) data 0.079 (0.099) loss_x loss_x 1.0254 (0.7160) acc_x 68.7500 (80.3750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [30/32] time 0.159 (0.173) data 0.083 (0.097) loss_x loss_x 0.5811 (0.6959) acc_x 87.5000 (81.1458) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.6531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1045
clean true:1045
clean false:0
clean_rate:1.0
noisy true:144
noisy false:411
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 555
epoch [30/200] batch [5/32] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.6113 (0.7583) acc_x 84.3750 (78.7500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/32] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.4067 (0.7431) acc_x 87.5000 (81.8750) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/32] time 0.195 (0.177) data 0.118 (0.100) loss_x loss_x 0.9238 (0.6918) acc_x 78.1250 (82.9167) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/32] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.7583 (0.7405) acc_x 84.3750 (82.1875) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/32] time 0.198 (0.179) data 0.121 (0.102) loss_x loss_x 0.7710 (0.7500) acc_x 78.1250 (81.2500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/32] time 0.190 (0.179) data 0.112 (0.102) loss_x loss_x 0.4556 (0.7424) acc_x 93.7500 (81.1458) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1042
clean true:1042
clean false:0
clean_rate:1.0
noisy true:143
noisy false:415
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 558
epoch [31/200] batch [5/32] time 0.189 (0.174) data 0.112 (0.097) loss_x loss_x 0.8442 (0.8714) acc_x 78.1250 (78.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/32] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.5830 (0.7912) acc_x 84.3750 (80.0000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/32] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.7783 (0.7163) acc_x 75.0000 (81.8750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/32] time 0.168 (0.178) data 0.091 (0.102) loss_x loss_x 0.9756 (0.7110) acc_x 68.7500 (80.9375) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/32] time 0.167 (0.175) data 0.090 (0.099) loss_x loss_x 0.2983 (0.6891) acc_x 93.7500 (81.1250) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [30/32] time 0.190 (0.177) data 0.113 (0.100) loss_x loss_x 0.5034 (0.6793) acc_x 84.3750 (81.8750) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.6325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1012
clean true:1012
clean false:0
clean_rate:1.0
noisy true:147
noisy false:441
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 588
epoch [32/200] batch [5/31] time 0.170 (0.169) data 0.093 (0.092) loss_x loss_x 0.8511 (0.7742) acc_x 78.1250 (77.5000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/31] time 0.187 (0.173) data 0.111 (0.096) loss_x loss_x 0.3706 (0.6771) acc_x 90.6250 (81.5625) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/31] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.4348 (0.6357) acc_x 87.5000 (82.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/31] time 0.181 (0.178) data 0.105 (0.101) loss_x loss_x 1.0312 (0.6697) acc_x 78.1250 (82.1875) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/31] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.4060 (0.6124) acc_x 87.5000 (83.1250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [30/31] time 0.179 (0.179) data 0.101 (0.103) loss_x loss_x 0.9038 (0.6472) acc_x 65.6250 (82.0833) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.6519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1043
clean true:1043
clean false:0
clean_rate:1.0
noisy true:150
noisy false:407
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 557
epoch [33/200] batch [5/32] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.7905 (0.7382) acc_x 71.8750 (80.6250) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/32] time 0.158 (0.162) data 0.081 (0.085) loss_x loss_x 1.0430 (0.6494) acc_x 71.8750 (82.8125) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/32] time 0.183 (0.162) data 0.106 (0.085) loss_x loss_x 0.7100 (0.6367) acc_x 81.2500 (83.7500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/32] time 0.186 (0.164) data 0.109 (0.087) loss_x loss_x 0.4890 (0.6536) acc_x 81.2500 (83.2812) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [25/32] time 0.184 (0.167) data 0.108 (0.090) loss_x loss_x 0.4727 (0.6708) acc_x 87.5000 (82.3750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/32] time 0.164 (0.167) data 0.087 (0.090) loss_x loss_x 0.4656 (0.6358) acc_x 90.6250 (82.8125) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.6562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1050
clean true:1048
clean false:2
clean_rate:0.9980952380952381
noisy true:142
noisy false:408
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 550
epoch [34/200] batch [5/32] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7046 (0.5977) acc_x 75.0000 (87.5000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/32] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 1.2705 (0.7762) acc_x 78.1250 (81.5625) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/32] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.7334 (0.8000) acc_x 84.3750 (79.5833) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/32] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.6353 (0.7527) acc_x 78.1250 (80.7812) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/32] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 1.0449 (0.7715) acc_x 75.0000 (80.6250) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [30/32] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6011 (0.7356) acc_x 81.2500 (81.3542) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.6594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1055
clean true:1055
clean false:0
clean_rate:1.0
noisy true:148
noisy false:397
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 545
epoch [35/200] batch [5/32] time 0.173 (0.165) data 0.096 (0.088) loss_x loss_x 0.7930 (0.6951) acc_x 81.2500 (82.5000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/32] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.6230 (0.6444) acc_x 87.5000 (82.8125) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/32] time 0.158 (0.174) data 0.081 (0.097) loss_x loss_x 1.0254 (0.6894) acc_x 71.8750 (81.6667) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/32] time 0.173 (0.173) data 0.097 (0.096) loss_x loss_x 0.6621 (0.7457) acc_x 84.3750 (80.7812) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/32] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.9146 (0.7420) acc_x 71.8750 (80.2500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/32] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 0.6406 (0.7367) acc_x 81.2500 (80.0000) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.6737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1078
clean true:1078
clean false:0
clean_rate:1.0
noisy true:143
noisy false:379
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 522
epoch [36/200] batch [5/33] time 0.190 (0.185) data 0.113 (0.108) loss_x loss_x 0.7534 (0.6209) acc_x 78.1250 (81.2500) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/33] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6802 (0.6869) acc_x 78.1250 (80.3125) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/33] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.2856 (0.6398) acc_x 93.7500 (82.0833) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/33] time 0.210 (0.187) data 0.133 (0.110) loss_x loss_x 0.7065 (0.6477) acc_x 84.3750 (82.3438) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/33] time 0.207 (0.193) data 0.131 (0.116) loss_x loss_x 1.1807 (0.6739) acc_x 84.3750 (82.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/33] time 0.185 (0.194) data 0.109 (0.117) loss_x loss_x 1.0117 (0.6665) acc_x 81.2500 (83.1250) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1054
clean true:1052
clean false:2
clean_rate:0.9981024667931688
noisy true:151
noisy false:395
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 546
epoch [37/200] batch [5/32] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.7876 (0.8270) acc_x 78.1250 (76.8750) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/32] time 0.170 (0.181) data 0.093 (0.105) loss_x loss_x 0.8682 (0.9405) acc_x 71.8750 (73.4375) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/32] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.8940 (0.9076) acc_x 81.2500 (75.8333) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/32] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.3872 (0.8230) acc_x 96.8750 (77.6562) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/32] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.6655 (0.7857) acc_x 84.3750 (78.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/32] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.6855 (0.7896) acc_x 81.2500 (78.5417) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.6519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1043
clean true:1043
clean false:0
clean_rate:1.0
noisy true:147
noisy false:410
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 557
epoch [38/200] batch [5/32] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.5840 (0.7318) acc_x 81.2500 (81.2500) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/32] time 0.161 (0.170) data 0.083 (0.093) loss_x loss_x 0.9272 (0.7228) acc_x 71.8750 (80.6250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/32] time 0.192 (0.174) data 0.115 (0.096) loss_x loss_x 0.5640 (0.6519) acc_x 81.2500 (82.9167) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/32] time 0.187 (0.175) data 0.110 (0.098) loss_x loss_x 0.4336 (0.6408) acc_x 84.3750 (83.1250) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/32] time 0.187 (0.177) data 0.110 (0.099) loss_x loss_x 1.1719 (0.6415) acc_x 75.0000 (83.2500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/32] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.5337 (0.6456) acc_x 84.3750 (83.1250) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.6488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1038
clean true:1037
clean false:1
clean_rate:0.9990366088631984
noisy true:147
noisy false:415
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 562
epoch [39/200] batch [5/32] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.3440 (0.6202) acc_x 96.8750 (83.1250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/32] time 0.186 (0.180) data 0.108 (0.103) loss_x loss_x 0.7163 (0.6981) acc_x 78.1250 (82.8125) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/32] time 0.178 (0.180) data 0.100 (0.103) loss_x loss_x 0.7085 (0.6448) acc_x 84.3750 (82.9167) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/32] time 0.206 (0.184) data 0.129 (0.106) loss_x loss_x 0.6274 (0.6188) acc_x 75.0000 (83.4375) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/32] time 0.173 (0.182) data 0.096 (0.105) loss_x loss_x 0.7852 (0.6275) acc_x 71.8750 (82.3750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/32] time 0.192 (0.183) data 0.115 (0.105) loss_x loss_x 0.3333 (0.6536) acc_x 84.3750 (81.8750) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.6600, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1056
clean true:1056
clean false:0
clean_rate:1.0
noisy true:151
noisy false:393
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 544
epoch [40/200] batch [5/33] time 0.187 (0.184) data 0.110 (0.106) loss_x loss_x 0.2357 (0.5985) acc_x 96.8750 (86.2500) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/33] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.4788 (0.5839) acc_x 90.6250 (85.0000) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/33] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.5708 (0.6017) acc_x 84.3750 (83.9583) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/33] time 0.195 (0.176) data 0.118 (0.099) loss_x loss_x 0.9106 (0.5866) acc_x 71.8750 (83.9062) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/33] time 0.156 (0.179) data 0.079 (0.101) loss_x loss_x 0.7827 (0.5960) acc_x 84.3750 (84.1250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [30/33] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.9858 (0.6266) acc_x 65.6250 (83.1250) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1058
clean true:1057
clean false:1
clean_rate:0.999054820415879
noisy true:150
noisy false:392
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 542
epoch [41/200] batch [5/33] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.2076 (0.6358) acc_x 90.6250 (81.2500) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/33] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.7437 (0.7265) acc_x 87.5000 (81.8750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/33] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.7861 (0.7280) acc_x 75.0000 (80.8333) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/33] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.4421 (0.7246) acc_x 87.5000 (79.8438) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/33] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.4639 (0.7136) acc_x 87.5000 (81.0000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/33] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.3440 (0.7182) acc_x 93.7500 (81.1458) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.6394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1023
clean true:1023
clean false:0
clean_rate:1.0
noisy true:161
noisy false:416
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 577
epoch [42/200] batch [5/31] time 0.171 (0.184) data 0.094 (0.107) loss_x loss_x 0.3987 (0.6206) acc_x 90.6250 (85.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/31] time 0.166 (0.181) data 0.089 (0.104) loss_x loss_x 0.3743 (0.6278) acc_x 90.6250 (84.3750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/31] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.5581 (0.6543) acc_x 90.6250 (82.7083) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/31] time 0.187 (0.183) data 0.111 (0.106) loss_x loss_x 0.5952 (0.6316) acc_x 78.1250 (83.2812) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/31] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.7368 (0.6362) acc_x 81.2500 (83.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/31] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 0.4055 (0.6381) acc_x 84.3750 (83.0208) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1058
clean true:1058
clean false:0
clean_rate:1.0
noisy true:145
noisy false:397
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 542
epoch [43/200] batch [5/33] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.3391 (0.6896) acc_x 93.7500 (81.8750) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/33] time 0.169 (0.181) data 0.092 (0.105) loss_x loss_x 0.7075 (0.6145) acc_x 81.2500 (84.0625) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/33] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.8525 (0.6361) acc_x 78.1250 (83.5417) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/33] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.8999 (0.6802) acc_x 81.2500 (82.6562) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/33] time 0.171 (0.180) data 0.093 (0.103) loss_x loss_x 0.5190 (0.6623) acc_x 87.5000 (83.5000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/33] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.3721 (0.6948) acc_x 84.3750 (82.3958) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.6631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1061
clean true:1060
clean false:1
clean_rate:0.9990574929311969
noisy true:145
noisy false:394
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 539
epoch [44/200] batch [5/33] time 0.189 (0.181) data 0.112 (0.105) loss_x loss_x 0.4834 (0.5359) acc_x 84.3750 (84.3750) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/33] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.3848 (0.5588) acc_x 90.6250 (85.3125) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/33] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.6499 (0.6132) acc_x 84.3750 (83.7500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/33] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.4458 (0.5801) acc_x 90.6250 (84.5312) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/33] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.5156 (0.6447) acc_x 84.3750 (83.1250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/33] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.6089 (0.6313) acc_x 81.2500 (83.3333) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1054
clean true:1054
clean false:0
clean_rate:1.0
noisy true:154
noisy false:392
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 546
epoch [45/200] batch [5/32] time 0.175 (0.171) data 0.099 (0.095) loss_x loss_x 0.5391 (0.6646) acc_x 87.5000 (82.5000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/32] time 0.161 (0.170) data 0.083 (0.094) loss_x loss_x 0.7378 (0.6942) acc_x 78.1250 (80.6250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/32] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.6050 (0.6321) acc_x 84.3750 (82.9167) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/32] time 0.180 (0.172) data 0.102 (0.095) loss_x loss_x 0.4922 (0.6404) acc_x 81.2500 (82.9688) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/32] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.8770 (0.6539) acc_x 78.1250 (82.7500) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/32] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 1.0244 (0.6737) acc_x 71.8750 (82.7083) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1058
clean true:1058
clean false:0
clean_rate:1.0
noisy true:147
noisy false:395
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 542
epoch [46/200] batch [5/33] time 0.186 (0.183) data 0.108 (0.107) loss_x loss_x 0.6191 (0.6171) acc_x 87.5000 (88.7500) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/33] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.7710 (0.6161) acc_x 81.2500 (85.9375) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/33] time 0.159 (0.178) data 0.083 (0.101) loss_x loss_x 0.6616 (0.6099) acc_x 87.5000 (86.0417) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/33] time 0.188 (0.179) data 0.111 (0.103) loss_x loss_x 0.5522 (0.6150) acc_x 87.5000 (85.9375) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/33] time 0.174 (0.182) data 0.098 (0.106) loss_x loss_x 0.4189 (0.6158) acc_x 87.5000 (85.2500) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/33] time 0.179 (0.182) data 0.102 (0.106) loss_x loss_x 0.8569 (0.6136) acc_x 78.1250 (84.8958) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.6619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1059
clean true:1059
clean false:0
clean_rate:1.0
noisy true:157
noisy false:384
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 541
epoch [47/200] batch [5/33] time 0.180 (0.182) data 0.103 (0.104) loss_x loss_x 0.3066 (0.5385) acc_x 90.6250 (87.5000) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/33] time 0.224 (0.186) data 0.147 (0.109) loss_x loss_x 0.8169 (0.6679) acc_x 81.2500 (83.4375) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/33] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.9004 (0.6617) acc_x 81.2500 (83.3333) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/33] time 0.207 (0.180) data 0.130 (0.104) loss_x loss_x 0.6260 (0.6454) acc_x 84.3750 (82.9688) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/33] time 0.162 (0.180) data 0.085 (0.103) loss_x loss_x 1.0869 (0.6728) acc_x 68.7500 (81.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/33] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 1.2119 (0.6804) acc_x 71.8750 (80.9375) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.6644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1063
clean true:1063
clean false:0
clean_rate:1.0
noisy true:158
noisy false:379
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 537
epoch [48/200] batch [5/33] time 0.161 (0.161) data 0.083 (0.084) loss_x loss_x 1.0840 (0.7381) acc_x 65.6250 (78.7500) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/33] time 0.162 (0.161) data 0.084 (0.083) loss_x loss_x 0.6450 (0.7106) acc_x 81.2500 (80.3125) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/33] time 0.176 (0.164) data 0.098 (0.087) loss_x loss_x 0.8086 (0.7112) acc_x 75.0000 (80.4167) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/33] time 0.166 (0.165) data 0.088 (0.088) loss_x loss_x 0.6255 (0.6897) acc_x 87.5000 (81.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/33] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.3396 (0.6407) acc_x 87.5000 (82.3750) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/33] time 0.161 (0.169) data 0.085 (0.092) loss_x loss_x 0.3711 (0.6428) acc_x 87.5000 (82.2917) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.6712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1074
clean true:1074
clean false:0
clean_rate:1.0
noisy true:152
noisy false:374
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 526
epoch [49/200] batch [5/33] time 0.179 (0.186) data 0.102 (0.109) loss_x loss_x 0.3772 (0.5263) acc_x 87.5000 (85.0000) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/33] time 0.159 (0.181) data 0.082 (0.104) loss_x loss_x 0.6357 (0.6141) acc_x 78.1250 (82.5000) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/33] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.4504 (0.6221) acc_x 87.5000 (82.9167) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/33] time 0.167 (0.171) data 0.090 (0.094) loss_x loss_x 0.7085 (0.6277) acc_x 81.2500 (82.3438) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/33] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.3577 (0.6214) acc_x 81.2500 (81.8750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/33] time 0.158 (0.168) data 0.081 (0.090) loss_x loss_x 0.8857 (0.6515) acc_x 81.2500 (81.6667) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.6694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1071
clean true:1070
clean false:1
clean_rate:0.9990662931839402
noisy true:149
noisy false:380
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 529
epoch [50/200] batch [5/33] time 0.163 (0.181) data 0.086 (0.103) loss_x loss_x 1.0625 (0.9303) acc_x 78.1250 (81.2500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/33] time 0.180 (0.181) data 0.103 (0.103) loss_x loss_x 0.4285 (0.7325) acc_x 84.3750 (82.5000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/33] time 0.163 (0.180) data 0.087 (0.103) loss_x loss_x 0.3262 (0.6557) acc_x 87.5000 (83.7500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/33] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.6616 (0.6713) acc_x 78.1250 (82.5000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/33] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.8096 (0.6925) acc_x 75.0000 (81.7500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/33] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.9043 (0.7110) acc_x 78.1250 (81.5625) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1058
clean true:1058
clean false:0
clean_rate:1.0
noisy true:151
noisy false:391
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 542
epoch [51/200] batch [5/33] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.7500 (0.6844) acc_x 81.2500 (81.2500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/33] time 0.172 (0.177) data 0.095 (0.101) loss_x loss_x 0.3638 (0.6162) acc_x 90.6250 (83.7500) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/33] time 0.194 (0.181) data 0.117 (0.105) loss_x loss_x 0.5825 (0.6271) acc_x 84.3750 (83.9583) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/33] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.9561 (0.6591) acc_x 78.1250 (82.9688) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/33] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6694 (0.6365) acc_x 84.3750 (84.0000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/33] time 0.188 (0.186) data 0.112 (0.109) loss_x loss_x 0.5913 (0.6432) acc_x 81.2500 (83.2292) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.6669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1067
clean true:1067
clean false:0
clean_rate:1.0
noisy true:164
noisy false:369
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 533
epoch [52/200] batch [5/33] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.6729 (0.6890) acc_x 78.1250 (81.8750) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/33] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.5791 (0.6155) acc_x 84.3750 (83.7500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/33] time 0.202 (0.179) data 0.125 (0.102) loss_x loss_x 0.7314 (0.6841) acc_x 84.3750 (82.9167) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/33] time 0.182 (0.179) data 0.105 (0.101) loss_x loss_x 0.5435 (0.6572) acc_x 84.3750 (83.2812) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/33] time 0.177 (0.177) data 0.100 (0.100) loss_x loss_x 0.5596 (0.6407) acc_x 84.3750 (82.7500) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/33] time 0.187 (0.179) data 0.109 (0.102) loss_x loss_x 0.6157 (0.6385) acc_x 75.0000 (82.1875) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1094
clean true:1094
clean false:0
clean_rate:1.0
noisy true:149
noisy false:357
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 506
epoch [53/200] batch [5/34] time 0.160 (0.193) data 0.083 (0.116) loss_x loss_x 0.8218 (0.6367) acc_x 81.2500 (83.7500) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/34] time 0.166 (0.181) data 0.089 (0.104) loss_x loss_x 0.6846 (0.6024) acc_x 87.5000 (84.6875) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/34] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.6562 (0.6048) acc_x 81.2500 (83.7500) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/34] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.7803 (0.6221) acc_x 81.2500 (83.5938) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/34] time 0.175 (0.175) data 0.099 (0.098) loss_x loss_x 0.6763 (0.6439) acc_x 81.2500 (83.5000) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/34] time 0.176 (0.174) data 0.100 (0.097) loss_x loss_x 0.6650 (0.6498) acc_x 81.2500 (83.6458) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.6631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1061
clean true:1061
clean false:0
clean_rate:1.0
noisy true:152
noisy false:387
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 539
epoch [54/200] batch [5/33] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.4917 (0.7011) acc_x 78.1250 (78.7500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/33] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.6465 (0.6407) acc_x 84.3750 (81.8750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/33] time 0.186 (0.163) data 0.109 (0.086) loss_x loss_x 0.3474 (0.6142) acc_x 87.5000 (83.1250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/33] time 0.166 (0.170) data 0.088 (0.093) loss_x loss_x 0.6030 (0.6138) acc_x 84.3750 (83.4375) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/33] time 0.184 (0.170) data 0.107 (0.093) loss_x loss_x 0.6074 (0.6208) acc_x 84.3750 (83.5000) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/33] time 0.185 (0.171) data 0.107 (0.094) loss_x loss_x 0.8364 (0.6332) acc_x 81.2500 (82.8125) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.6675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1068
clean true:1067
clean false:1
clean_rate:0.9990636704119851
noisy true:146
noisy false:386
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 532
epoch [55/200] batch [5/33] time 0.176 (0.167) data 0.099 (0.090) loss_x loss_x 0.3142 (0.4854) acc_x 90.6250 (83.1250) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/33] time 0.157 (0.165) data 0.080 (0.088) loss_x loss_x 0.3167 (0.4966) acc_x 93.7500 (86.8750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/33] time 0.156 (0.162) data 0.079 (0.085) loss_x loss_x 0.3472 (0.5035) acc_x 90.6250 (86.6667) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/33] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 1.0244 (0.5417) acc_x 78.1250 (85.3125) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/33] time 0.184 (0.162) data 0.107 (0.086) loss_x loss_x 1.1104 (0.5842) acc_x 71.8750 (83.8750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/33] time 0.182 (0.166) data 0.105 (0.089) loss_x loss_x 0.4507 (0.5964) acc_x 87.5000 (83.4375) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.6869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:142
noisy false:359
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 501
epoch [56/200] batch [5/34] time 0.225 (0.199) data 0.148 (0.122) loss_x loss_x 0.8887 (0.6042) acc_x 71.8750 (83.1250) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/34] time 0.189 (0.191) data 0.112 (0.115) loss_x loss_x 0.5171 (0.7067) acc_x 87.5000 (82.8125) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/34] time 0.220 (0.195) data 0.144 (0.118) loss_x loss_x 0.7686 (0.6723) acc_x 75.0000 (82.9167) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/34] time 0.184 (0.192) data 0.106 (0.115) loss_x loss_x 0.8379 (0.6816) acc_x 78.1250 (82.8125) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/34] time 0.183 (0.190) data 0.106 (0.113) loss_x loss_x 0.3799 (0.6706) acc_x 90.6250 (83.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/34] time 0.181 (0.189) data 0.104 (0.112) loss_x loss_x 0.3848 (0.6569) acc_x 90.6250 (83.7500) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.6756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1081
clean true:1081
clean false:0
clean_rate:1.0
noisy true:144
noisy false:375
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 519
epoch [57/200] batch [5/33] time 0.189 (0.173) data 0.112 (0.096) loss_x loss_x 0.4172 (0.6342) acc_x 87.5000 (83.1250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/33] time 0.209 (0.184) data 0.132 (0.107) loss_x loss_x 0.4707 (0.6176) acc_x 81.2500 (82.1875) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/33] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 1.0059 (0.6571) acc_x 84.3750 (82.2917) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/33] time 0.191 (0.181) data 0.114 (0.104) loss_x loss_x 0.4495 (0.6526) acc_x 93.7500 (82.8125) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/33] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.6470 (0.6126) acc_x 87.5000 (84.2500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/33] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.6597 (0.6124) acc_x 87.5000 (84.5833) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1049
clean true:1049
clean false:0
clean_rate:1.0
noisy true:155
noisy false:396
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 551
epoch [58/200] batch [5/32] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.6553 (0.7233) acc_x 78.1250 (82.5000) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/32] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.3262 (0.6036) acc_x 90.6250 (84.3750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/32] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.6299 (0.6240) acc_x 78.1250 (84.1667) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/32] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.8257 (0.6175) acc_x 71.8750 (83.9062) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/32] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.6733 (0.6342) acc_x 84.3750 (83.8750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/32] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.4966 (0.6406) acc_x 84.3750 (84.1667) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.6631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1061
clean true:1061
clean false:0
clean_rate:1.0
noisy true:155
noisy false:384
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 539
epoch [59/200] batch [5/33] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.6865 (0.6859) acc_x 84.3750 (81.8750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/33] time 0.230 (0.180) data 0.153 (0.102) loss_x loss_x 0.4297 (0.7555) acc_x 87.5000 (78.7500) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/33] time 0.176 (0.188) data 0.098 (0.111) loss_x loss_x 0.6870 (0.6950) acc_x 78.1250 (80.0000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/33] time 0.157 (0.185) data 0.080 (0.108) loss_x loss_x 1.7559 (0.6900) acc_x 65.6250 (81.2500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/33] time 0.174 (0.183) data 0.097 (0.106) loss_x loss_x 0.4463 (0.6466) acc_x 93.7500 (83.0000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/33] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.6348 (0.6563) acc_x 84.3750 (82.2917) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.6794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1087
clean true:1086
clean false:1
clean_rate:0.9990800367985281
noisy true:146
noisy false:367
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 513
epoch [60/200] batch [5/33] time 0.235 (0.178) data 0.158 (0.101) loss_x loss_x 0.3462 (0.6588) acc_x 87.5000 (83.7500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/33] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.2686 (0.7155) acc_x 65.6250 (81.2500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/33] time 0.173 (0.185) data 0.095 (0.108) loss_x loss_x 0.4163 (0.6596) acc_x 93.7500 (83.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/33] time 0.187 (0.187) data 0.111 (0.110) loss_x loss_x 0.6885 (0.6394) acc_x 75.0000 (82.9688) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/33] time 0.178 (0.187) data 0.101 (0.110) loss_x loss_x 0.8643 (0.6661) acc_x 81.2500 (83.0000) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/33] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.5635 (0.6711) acc_x 90.6250 (82.8125) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.6731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1077
clean true:1077
clean false:0
clean_rate:1.0
noisy true:136
noisy false:387
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 523
epoch [61/200] batch [5/33] time 0.157 (0.159) data 0.081 (0.082) loss_x loss_x 0.8916 (0.7275) acc_x 75.0000 (81.8750) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/33] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 1.0664 (0.7353) acc_x 71.8750 (80.6250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/33] time 0.160 (0.159) data 0.082 (0.082) loss_x loss_x 0.6812 (0.7573) acc_x 78.1250 (79.5833) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/33] time 0.182 (0.171) data 0.106 (0.094) loss_x loss_x 0.3611 (0.7371) acc_x 93.7500 (80.6250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/33] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.7358 (0.7292) acc_x 81.2500 (80.7500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/33] time 0.220 (0.179) data 0.143 (0.102) loss_x loss_x 0.2595 (0.6890) acc_x 90.6250 (81.6667) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:151
noisy false:346
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [62/200] batch [5/34] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4844 (0.6715) acc_x 84.3750 (80.6250) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/34] time 0.176 (0.183) data 0.099 (0.106) loss_x loss_x 0.7554 (0.6257) acc_x 84.3750 (83.1250) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/34] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5366 (0.6188) acc_x 87.5000 (83.5417) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/34] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 1.1992 (0.5992) acc_x 71.8750 (84.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/34] time 0.156 (0.174) data 0.079 (0.097) loss_x loss_x 1.2930 (0.6477) acc_x 71.8750 (84.0000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/34] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.7949 (0.6436) acc_x 75.0000 (83.7500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.6650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1064
clean true:1064
clean false:0
clean_rate:1.0
noisy true:152
noisy false:384
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 536
epoch [63/200] batch [5/33] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.5430 (0.6859) acc_x 87.5000 (81.2500) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/33] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.2617 (0.5944) acc_x 96.8750 (83.4375) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/33] time 0.202 (0.187) data 0.125 (0.110) loss_x loss_x 0.5884 (0.6345) acc_x 84.3750 (82.9167) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/33] time 0.165 (0.183) data 0.088 (0.106) loss_x loss_x 0.8457 (0.6121) acc_x 75.0000 (83.1250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/33] time 0.159 (0.178) data 0.082 (0.102) loss_x loss_x 0.7036 (0.6462) acc_x 84.3750 (82.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/33] time 0.156 (0.175) data 0.080 (0.098) loss_x loss_x 0.6821 (0.6620) acc_x 84.3750 (82.8125) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.6725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1076
clean true:1075
clean false:1
clean_rate:0.9990706319702602
noisy true:153
noisy false:371
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 524
epoch [64/200] batch [5/33] time 0.171 (0.166) data 0.095 (0.089) loss_x loss_x 0.8374 (0.7662) acc_x 71.8750 (80.0000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/33] time 0.165 (0.167) data 0.088 (0.091) loss_x loss_x 0.5186 (0.6668) acc_x 87.5000 (83.1250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/33] time 0.178 (0.169) data 0.101 (0.092) loss_x loss_x 0.5894 (0.6824) acc_x 81.2500 (82.7083) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/33] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.3418 (0.6318) acc_x 93.7500 (84.2188) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/33] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.6333 (0.6000) acc_x 87.5000 (85.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/33] time 0.166 (0.180) data 0.089 (0.104) loss_x loss_x 0.6436 (0.6211) acc_x 81.2500 (84.1667) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.6794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1087
clean true:1086
clean false:1
clean_rate:0.9990800367985281
noisy true:150
noisy false:363
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 513
epoch [65/200] batch [5/33] time 0.187 (0.172) data 0.110 (0.095) loss_x loss_x 0.5317 (0.5843) acc_x 90.6250 (83.1250) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/33] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.4805 (0.5457) acc_x 81.2500 (83.7500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/33] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.6509 (0.5833) acc_x 78.1250 (82.5000) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/33] time 0.183 (0.176) data 0.105 (0.099) loss_x loss_x 0.5225 (0.5891) acc_x 90.6250 (82.6562) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/33] time 0.192 (0.177) data 0.114 (0.100) loss_x loss_x 0.6304 (0.6066) acc_x 87.5000 (83.3750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/33] time 0.189 (0.180) data 0.111 (0.103) loss_x loss_x 0.3372 (0.5868) acc_x 90.6250 (84.0625) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1105
clean true:1105
clean false:0
clean_rate:1.0
noisy true:158
noisy false:337
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 495
epoch [66/200] batch [5/34] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.7559 (0.8374) acc_x 78.1250 (80.6250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/34] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.8125 (0.8045) acc_x 75.0000 (78.4375) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/34] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5503 (0.7719) acc_x 84.3750 (79.1667) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/34] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.5962 (0.7446) acc_x 90.6250 (80.3125) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/34] time 0.165 (0.181) data 0.088 (0.104) loss_x loss_x 0.2805 (0.7148) acc_x 90.6250 (81.0000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/34] time 0.171 (0.178) data 0.094 (0.102) loss_x loss_x 0.4697 (0.7215) acc_x 84.3750 (80.8333) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.6781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1085
clean true:1085
clean false:0
clean_rate:1.0
noisy true:149
noisy false:366
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 515
epoch [67/200] batch [5/33] time 0.178 (0.169) data 0.101 (0.091) loss_x loss_x 0.2903 (0.5546) acc_x 93.7500 (85.6250) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/33] time 0.179 (0.171) data 0.102 (0.094) loss_x loss_x 0.8975 (0.7069) acc_x 78.1250 (81.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/33] time 0.199 (0.174) data 0.121 (0.097) loss_x loss_x 0.8818 (0.7043) acc_x 78.1250 (82.0833) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/33] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.3057 (0.6217) acc_x 87.5000 (84.0625) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/33] time 0.202 (0.180) data 0.126 (0.103) loss_x loss_x 0.3149 (0.5872) acc_x 90.6250 (84.8750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/33] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.9897 (0.5981) acc_x 71.8750 (84.7917) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.6750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1080
clean true:1080
clean false:0
clean_rate:1.0
noisy true:147
noisy false:373
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 520
epoch [68/200] batch [5/33] time 0.161 (0.175) data 0.084 (0.098) loss_x loss_x 0.6235 (0.6628) acc_x 81.2500 (80.6250) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [10/33] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.7485 (0.6662) acc_x 78.1250 (80.9375) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/33] time 0.158 (0.165) data 0.081 (0.088) loss_x loss_x 0.3337 (0.6367) acc_x 90.6250 (81.8750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/33] time 0.160 (0.164) data 0.083 (0.086) loss_x loss_x 0.5220 (0.5729) acc_x 84.3750 (83.5938) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/33] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.6226 (0.5602) acc_x 90.6250 (84.5000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/33] time 0.173 (0.165) data 0.095 (0.088) loss_x loss_x 0.4602 (0.5855) acc_x 84.3750 (83.6458) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.6837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1094
clean true:1094
clean false:0
clean_rate:1.0
noisy true:150
noisy false:356
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 506
epoch [69/200] batch [5/34] time 0.176 (0.167) data 0.098 (0.090) loss_x loss_x 0.9785 (0.7499) acc_x 75.0000 (81.8750) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/34] time 0.166 (0.167) data 0.089 (0.090) loss_x loss_x 0.8022 (0.7629) acc_x 81.2500 (80.9375) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/34] time 0.183 (0.169) data 0.106 (0.092) loss_x loss_x 0.2441 (0.7133) acc_x 96.8750 (81.8750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/34] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.2839 (0.6709) acc_x 93.7500 (82.6562) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/34] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.4041 (0.6305) acc_x 90.6250 (83.0000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/34] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.9521 (0.6455) acc_x 75.0000 (82.6042) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.6825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1092
clean true:1092
clean false:0
clean_rate:1.0
noisy true:150
noisy false:358
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 508
epoch [70/200] batch [5/34] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.5825 (0.7878) acc_x 81.2500 (78.7500) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/34] time 0.175 (0.184) data 0.099 (0.108) loss_x loss_x 1.0127 (0.6284) acc_x 78.1250 (83.4375) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/34] time 0.180 (0.180) data 0.102 (0.103) loss_x loss_x 0.9829 (0.6289) acc_x 75.0000 (83.3333) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/34] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.5776 (0.6641) acc_x 84.3750 (82.3438) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/34] time 0.176 (0.178) data 0.100 (0.101) loss_x loss_x 0.5830 (0.6688) acc_x 81.2500 (82.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/34] time 0.191 (0.178) data 0.114 (0.101) loss_x loss_x 0.3323 (0.6798) acc_x 93.7500 (82.5000) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.6719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1075
clean true:1075
clean false:0
clean_rate:1.0
noisy true:142
noisy false:383
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 525
epoch [71/200] batch [5/33] time 0.184 (0.192) data 0.106 (0.115) loss_x loss_x 0.7856 (0.7377) acc_x 81.2500 (83.1250) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/33] time 0.189 (0.189) data 0.112 (0.112) loss_x loss_x 0.3701 (0.6708) acc_x 87.5000 (83.1250) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/33] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.5010 (0.7261) acc_x 84.3750 (80.4167) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/33] time 0.192 (0.186) data 0.115 (0.109) loss_x loss_x 0.6694 (0.7269) acc_x 78.1250 (80.4688) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/33] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.5151 (0.6762) acc_x 87.5000 (81.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/33] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.7778 (0.6620) acc_x 84.3750 (82.3958) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.6737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1078
clean true:1077
clean false:1
clean_rate:0.9990723562152134
noisy true:150
noisy false:372
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 522
epoch [72/200] batch [5/33] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.8535 (0.6073) acc_x 81.2500 (85.0000) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/33] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.7520 (0.6087) acc_x 84.3750 (83.7500) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/33] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.6216 (0.5928) acc_x 81.2500 (83.9583) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/33] time 0.165 (0.179) data 0.088 (0.102) loss_x loss_x 0.3940 (0.6170) acc_x 87.5000 (82.5000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/33] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.4985 (0.6077) acc_x 81.2500 (83.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/33] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.5283 (0.6057) acc_x 84.3750 (83.0208) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.6687, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1070
clean true:1070
clean false:0
clean_rate:1.0
noisy true:145
noisy false:385
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 530
epoch [73/200] batch [5/33] time 0.160 (0.170) data 0.084 (0.093) loss_x loss_x 0.3259 (0.3797) acc_x 87.5000 (88.1250) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/33] time 0.159 (0.165) data 0.083 (0.088) loss_x loss_x 0.5552 (0.5044) acc_x 78.1250 (84.6875) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/33] time 0.178 (0.165) data 0.101 (0.088) loss_x loss_x 0.3743 (0.5092) acc_x 90.6250 (84.3750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/33] time 0.158 (0.166) data 0.081 (0.089) loss_x loss_x 0.8169 (0.5251) acc_x 81.2500 (85.1562) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/33] time 0.182 (0.168) data 0.105 (0.091) loss_x loss_x 0.5332 (0.5692) acc_x 87.5000 (84.6250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/33] time 0.189 (0.170) data 0.111 (0.093) loss_x loss_x 0.5918 (0.5541) acc_x 84.3750 (84.7917) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.6794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1087
clean true:1087
clean false:0
clean_rate:1.0
noisy true:150
noisy false:363
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 513
epoch [74/200] batch [5/33] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.4512 (0.5213) acc_x 87.5000 (87.5000) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/33] time 0.178 (0.187) data 0.101 (0.110) loss_x loss_x 0.4248 (0.6078) acc_x 90.6250 (84.3750) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/33] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.5796 (0.6330) acc_x 87.5000 (83.9583) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/33] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.5596 (0.6237) acc_x 84.3750 (84.3750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/33] time 0.205 (0.175) data 0.128 (0.098) loss_x loss_x 0.5859 (0.6216) acc_x 87.5000 (84.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/33] time 0.191 (0.178) data 0.114 (0.101) loss_x loss_x 0.5332 (0.6363) acc_x 78.1250 (83.3333) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.6756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1081
clean true:1081
clean false:0
clean_rate:1.0
noisy true:146
noisy false:373
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 519
epoch [75/200] batch [5/33] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.5342 (0.6671) acc_x 81.2500 (81.8750) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/33] time 0.179 (0.176) data 0.103 (0.100) loss_x loss_x 0.8237 (0.6645) acc_x 81.2500 (82.5000) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/33] time 0.185 (0.178) data 0.108 (0.102) loss_x loss_x 0.4814 (0.6414) acc_x 78.1250 (82.5000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/33] time 0.156 (0.176) data 0.079 (0.100) loss_x loss_x 0.6265 (0.6330) acc_x 78.1250 (82.5000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/33] time 0.162 (0.174) data 0.084 (0.097) loss_x loss_x 0.3088 (0.5986) acc_x 87.5000 (83.6250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/33] time 0.183 (0.174) data 0.107 (0.097) loss_x loss_x 0.1884 (0.5804) acc_x 96.8750 (84.3750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1102
clean true:1102
clean false:0
clean_rate:1.0
noisy true:146
noisy false:352
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 498
epoch [76/200] batch [5/34] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.3042 (0.5808) acc_x 93.7500 (85.0000) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/34] time 0.157 (0.182) data 0.081 (0.105) loss_x loss_x 0.7529 (0.6062) acc_x 81.2500 (82.8125) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/34] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.3103 (0.5930) acc_x 90.6250 (83.5417) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/34] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.6748 (0.6053) acc_x 78.1250 (83.4375) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/34] time 0.161 (0.179) data 0.084 (0.102) loss_x loss_x 0.5635 (0.6116) acc_x 84.3750 (83.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/34] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.3677 (0.6061) acc_x 90.6250 (83.6458) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1091
clean true:1091
clean false:0
clean_rate:1.0
noisy true:145
noisy false:364
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 509
epoch [77/200] batch [5/34] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 1.1895 (0.6215) acc_x 68.7500 (84.3750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/34] time 0.174 (0.183) data 0.095 (0.106) loss_x loss_x 0.7798 (0.6277) acc_x 87.5000 (84.6875) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/34] time 0.176 (0.179) data 0.099 (0.101) loss_x loss_x 0.6670 (0.6599) acc_x 84.3750 (83.5417) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/34] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.6831 (0.6229) acc_x 81.2500 (83.9062) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/34] time 0.162 (0.179) data 0.085 (0.102) loss_x loss_x 0.7700 (0.6465) acc_x 75.0000 (82.7500) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/34] time 0.189 (0.180) data 0.112 (0.102) loss_x loss_x 0.6880 (0.6530) acc_x 84.3750 (82.3958) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.6781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1085
clean true:1085
clean false:0
clean_rate:1.0
noisy true:142
noisy false:373
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 515
epoch [78/200] batch [5/33] time 0.194 (0.189) data 0.116 (0.111) loss_x loss_x 0.3750 (0.4951) acc_x 93.7500 (86.8750) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/33] time 0.172 (0.191) data 0.095 (0.113) loss_x loss_x 0.3335 (0.4352) acc_x 87.5000 (87.5000) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/33] time 0.174 (0.185) data 0.097 (0.108) loss_x loss_x 0.3245 (0.4859) acc_x 90.6250 (86.8750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/33] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.6943 (0.5036) acc_x 78.1250 (85.4688) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/33] time 0.173 (0.181) data 0.095 (0.104) loss_x loss_x 0.9629 (0.5274) acc_x 65.6250 (84.8750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/33] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.4226 (0.5284) acc_x 84.3750 (84.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.6787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1086
clean true:1085
clean false:1
clean_rate:0.9990791896869244
noisy true:141
noisy false:373
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 514
epoch [79/200] batch [5/33] time 0.167 (0.171) data 0.090 (0.093) loss_x loss_x 0.4167 (0.7011) acc_x 90.6250 (83.1250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/33] time 0.167 (0.168) data 0.091 (0.091) loss_x loss_x 0.5049 (0.5929) acc_x 87.5000 (85.0000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/33] time 0.172 (0.170) data 0.095 (0.093) loss_x loss_x 0.6831 (0.5958) acc_x 81.2500 (84.5833) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/33] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.4265 (0.6150) acc_x 81.2500 (83.7500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/33] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.5752 (0.6121) acc_x 87.5000 (84.2500) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/33] time 0.199 (0.175) data 0.122 (0.098) loss_x loss_x 0.5356 (0.5951) acc_x 87.5000 (84.4792) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.6769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1083
clean true:1083
clean false:0
clean_rate:1.0
noisy true:146
noisy false:371
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 517
epoch [80/200] batch [5/33] time 0.167 (0.184) data 0.090 (0.107) loss_x loss_x 0.9014 (0.5054) acc_x 78.1250 (87.5000) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/33] time 0.162 (0.180) data 0.085 (0.103) loss_x loss_x 0.4268 (0.4716) acc_x 84.3750 (88.7500) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/33] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.2993 (0.4821) acc_x 93.7500 (87.9167) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/33] time 0.155 (0.177) data 0.079 (0.100) loss_x loss_x 0.9463 (0.5699) acc_x 75.0000 (85.4688) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/33] time 0.187 (0.178) data 0.110 (0.101) loss_x loss_x 0.7686 (0.5982) acc_x 81.2500 (85.2500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/33] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.5630 (0.6181) acc_x 90.6250 (84.5833) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.6744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1079
clean true:1079
clean false:0
clean_rate:1.0
noisy true:152
noisy false:369
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 521
epoch [81/200] batch [5/33] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 0.6309 (0.5064) acc_x 81.2500 (86.8750) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/33] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.6519 (0.4823) acc_x 75.0000 (85.6250) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/33] time 0.213 (0.192) data 0.136 (0.115) loss_x loss_x 0.6592 (0.5330) acc_x 81.2500 (84.5833) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/33] time 0.159 (0.187) data 0.082 (0.110) loss_x loss_x 0.7822 (0.5814) acc_x 71.8750 (83.5938) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/33] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.4460 (0.5730) acc_x 87.5000 (84.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/33] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.4878 (0.5663) acc_x 78.1250 (83.6458) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.6781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:148
noisy false:367
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 515
epoch [82/200] batch [5/33] time 0.182 (0.185) data 0.106 (0.107) loss_x loss_x 1.0391 (0.6625) acc_x 75.0000 (85.0000) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/33] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.6841 (0.5612) acc_x 81.2500 (86.8750) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/33] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.5815 (0.5939) acc_x 81.2500 (84.5833) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/33] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.4954 (0.5902) acc_x 90.6250 (84.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/33] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.4541 (0.5780) acc_x 87.5000 (84.6250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/33] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.8198 (0.6077) acc_x 78.1250 (83.9583) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.6756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1081
clean true:1081
clean false:0
clean_rate:1.0
noisy true:149
noisy false:370
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 519
epoch [83/200] batch [5/33] time 0.158 (0.167) data 0.081 (0.090) loss_x loss_x 0.2961 (0.4884) acc_x 93.7500 (90.0000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/33] time 0.162 (0.163) data 0.084 (0.086) loss_x loss_x 0.2944 (0.4929) acc_x 93.7500 (89.3750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/33] time 0.163 (0.162) data 0.086 (0.085) loss_x loss_x 0.3875 (0.4654) acc_x 90.6250 (89.1667) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/33] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.8809 (0.5226) acc_x 78.1250 (86.7188) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/33] time 0.182 (0.168) data 0.106 (0.091) loss_x loss_x 0.6372 (0.5034) acc_x 81.2500 (87.5000) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/33] time 0.176 (0.169) data 0.100 (0.092) loss_x loss_x 0.5225 (0.5157) acc_x 84.3750 (86.7708) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1102
clean true:1102
clean false:0
clean_rate:1.0
noisy true:150
noisy false:348
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 498
epoch [84/200] batch [5/34] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.3660 (0.7442) acc_x 90.6250 (81.2500) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/34] time 0.178 (0.168) data 0.101 (0.091) loss_x loss_x 0.2778 (0.6089) acc_x 93.7500 (85.0000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/34] time 0.173 (0.170) data 0.096 (0.092) loss_x loss_x 0.4202 (0.6234) acc_x 90.6250 (83.7500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/34] time 0.171 (0.172) data 0.093 (0.095) loss_x loss_x 0.2491 (0.6287) acc_x 93.7500 (83.4375) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/34] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.4712 (0.6002) acc_x 90.6250 (84.0000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/34] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.5591 (0.5912) acc_x 78.1250 (83.5417) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:147
noisy false:352
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 499
epoch [85/200] batch [5/34] time 0.185 (0.189) data 0.107 (0.112) loss_x loss_x 0.6064 (0.5707) acc_x 84.3750 (82.5000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/34] time 0.181 (0.188) data 0.105 (0.111) loss_x loss_x 1.0537 (0.6273) acc_x 65.6250 (82.5000) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/34] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.4736 (0.6321) acc_x 90.6250 (83.3333) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/34] time 0.168 (0.187) data 0.091 (0.110) loss_x loss_x 0.3279 (0.6009) acc_x 84.3750 (84.2188) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/34] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.3499 (0.5856) acc_x 90.6250 (85.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/34] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.7539 (0.5933) acc_x 81.2500 (84.3750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.6731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1077
clean true:1077
clean false:0
clean_rate:1.0
noisy true:151
noisy false:372
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 523
epoch [86/200] batch [5/33] time 0.168 (0.194) data 0.091 (0.118) loss_x loss_x 0.7808 (0.6241) acc_x 81.2500 (83.1250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/33] time 0.190 (0.192) data 0.113 (0.115) loss_x loss_x 0.7998 (0.6467) acc_x 81.2500 (82.8125) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/33] time 0.178 (0.189) data 0.101 (0.112) loss_x loss_x 0.3643 (0.5930) acc_x 84.3750 (82.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/33] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.4524 (0.5743) acc_x 90.6250 (83.2812) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/33] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.3774 (0.5610) acc_x 90.6250 (83.8750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/33] time 0.173 (0.185) data 0.097 (0.108) loss_x loss_x 0.6919 (0.5771) acc_x 84.3750 (83.5417) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1095
clean true:1095
clean false:0
clean_rate:1.0
noisy true:156
noisy false:349
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 505
epoch [87/200] batch [5/34] time 0.176 (0.173) data 0.100 (0.096) loss_x loss_x 0.5010 (0.6911) acc_x 78.1250 (83.7500) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/34] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.4163 (0.5800) acc_x 90.6250 (86.2500) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/34] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.2883 (0.5787) acc_x 87.5000 (85.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/34] time 0.173 (0.171) data 0.096 (0.094) loss_x loss_x 0.5107 (0.5773) acc_x 90.6250 (85.6250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/34] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.9082 (0.5664) acc_x 71.8750 (85.5000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/34] time 0.167 (0.176) data 0.091 (0.098) loss_x loss_x 0.8979 (0.5587) acc_x 75.0000 (85.4167) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:143
noisy false:348
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 491
epoch [88/200] batch [5/34] time 0.154 (0.159) data 0.077 (0.081) loss_x loss_x 0.6353 (0.5724) acc_x 84.3750 (82.5000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/34] time 0.182 (0.170) data 0.106 (0.093) loss_x loss_x 0.6689 (0.5328) acc_x 87.5000 (85.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/34] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.5186 (0.5650) acc_x 84.3750 (84.3750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/34] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.6406 (0.5456) acc_x 84.3750 (85.4688) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/34] time 0.166 (0.179) data 0.089 (0.102) loss_x loss_x 0.8257 (0.5473) acc_x 75.0000 (85.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/34] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.3911 (0.5429) acc_x 90.6250 (85.8333) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:143
noisy false:337
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [89/200] batch [5/35] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.5317 (0.5568) acc_x 90.6250 (88.1250) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/35] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.3125 (0.5301) acc_x 90.6250 (86.8750) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/35] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.4944 (0.5542) acc_x 90.6250 (85.6250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/35] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.5576 (0.5488) acc_x 78.1250 (84.5312) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/35] time 0.199 (0.185) data 0.122 (0.108) loss_x loss_x 1.2119 (0.5748) acc_x 71.8750 (84.0000) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/35] time 0.189 (0.183) data 0.112 (0.106) loss_x loss_x 0.5342 (0.5782) acc_x 87.5000 (83.9583) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [35/35] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.3372 (0.6070) acc_x 96.8750 (83.9286) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1102
clean true:1102
clean false:0
clean_rate:1.0
noisy true:155
noisy false:343
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 498
epoch [90/200] batch [5/34] time 0.184 (0.196) data 0.107 (0.119) loss_x loss_x 0.3267 (0.5627) acc_x 87.5000 (85.0000) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/34] time 0.188 (0.193) data 0.111 (0.116) loss_x loss_x 0.3767 (0.5871) acc_x 90.6250 (86.5625) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/34] time 0.161 (0.183) data 0.084 (0.106) loss_x loss_x 0.2783 (0.5419) acc_x 93.7500 (87.0833) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/34] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.6138 (0.5482) acc_x 78.1250 (86.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/34] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 0.1871 (0.5383) acc_x 87.5000 (86.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/34] time 0.157 (0.179) data 0.080 (0.102) loss_x loss_x 0.8843 (0.5669) acc_x 75.0000 (85.7292) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.6737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1078
clean true:1078
clean false:0
clean_rate:1.0
noisy true:154
noisy false:368
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 522
epoch [91/200] batch [5/33] time 0.171 (0.180) data 0.093 (0.103) loss_x loss_x 0.2106 (0.5376) acc_x 96.8750 (84.3750) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/33] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.4546 (0.5561) acc_x 87.5000 (83.1250) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/33] time 0.158 (0.180) data 0.082 (0.103) loss_x loss_x 0.5767 (0.5644) acc_x 78.1250 (83.1250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/33] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.5791 (0.5315) acc_x 87.5000 (84.6875) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/33] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.7764 (0.5525) acc_x 84.3750 (84.6250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/33] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.7993 (0.5832) acc_x 84.3750 (84.3750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:155
noisy false:328
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [92/200] batch [5/34] time 0.163 (0.184) data 0.087 (0.107) loss_x loss_x 0.3245 (0.5762) acc_x 93.7500 (84.3750) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/34] time 0.173 (0.174) data 0.096 (0.098) loss_x loss_x 0.4470 (0.6364) acc_x 84.3750 (82.1875) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/34] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.7368 (0.5857) acc_x 78.1250 (83.9583) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/34] time 0.194 (0.183) data 0.117 (0.106) loss_x loss_x 0.6411 (0.6172) acc_x 87.5000 (83.2812) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/34] time 0.180 (0.182) data 0.102 (0.105) loss_x loss_x 1.0010 (0.6213) acc_x 81.2500 (83.8750) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/34] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4695 (0.5951) acc_x 87.5000 (84.3750) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1129
clean true:1129
clean false:0
clean_rate:1.0
noisy true:147
noisy false:324
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 471
epoch [93/200] batch [5/35] time 0.163 (0.178) data 0.086 (0.101) loss_x loss_x 0.7793 (0.5423) acc_x 78.1250 (83.1250) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/35] time 0.196 (0.177) data 0.120 (0.100) loss_x loss_x 0.5762 (0.6073) acc_x 84.3750 (83.7500) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/35] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.9814 (0.6285) acc_x 62.5000 (82.0833) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/35] time 0.176 (0.174) data 0.098 (0.097) loss_x loss_x 0.5249 (0.6041) acc_x 84.3750 (82.6562) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/35] time 0.171 (0.173) data 0.094 (0.095) loss_x loss_x 0.4932 (0.6305) acc_x 93.7500 (82.3750) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/35] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.6318 (0.6331) acc_x 84.3750 (82.2917) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [35/35] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.3540 (0.6171) acc_x 90.6250 (82.9464) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:154
noisy false:347
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 501
epoch [94/200] batch [5/34] time 0.197 (0.172) data 0.119 (0.095) loss_x loss_x 0.8560 (0.5805) acc_x 78.1250 (85.0000) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/34] time 0.192 (0.197) data 0.115 (0.120) loss_x loss_x 0.6265 (0.5804) acc_x 84.3750 (84.3750) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/34] time 0.185 (0.194) data 0.108 (0.117) loss_x loss_x 0.8682 (0.6146) acc_x 75.0000 (83.7500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/34] time 0.173 (0.190) data 0.096 (0.113) loss_x loss_x 0.3838 (0.5760) acc_x 87.5000 (85.0000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/34] time 0.179 (0.186) data 0.101 (0.109) loss_x loss_x 0.8179 (0.5653) acc_x 78.1250 (85.1250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/34] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.4683 (0.5804) acc_x 84.3750 (84.5833) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:140
noisy false:357
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [95/200] batch [5/34] time 0.156 (0.160) data 0.080 (0.083) loss_x loss_x 0.3110 (0.6680) acc_x 90.6250 (83.1250) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/34] time 0.158 (0.160) data 0.080 (0.083) loss_x loss_x 0.6440 (0.6378) acc_x 71.8750 (81.8750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/34] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.6304 (0.6543) acc_x 81.2500 (81.2500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/34] time 0.175 (0.161) data 0.099 (0.085) loss_x loss_x 0.5229 (0.6202) acc_x 87.5000 (82.5000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/34] time 0.175 (0.169) data 0.097 (0.092) loss_x loss_x 1.1553 (0.6124) acc_x 68.7500 (82.5000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/34] time 0.162 (0.170) data 0.084 (0.093) loss_x loss_x 0.6802 (0.6075) acc_x 78.1250 (82.2917) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:150
noisy false:323
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [96/200] batch [5/35] time 0.191 (0.184) data 0.114 (0.107) loss_x loss_x 0.2842 (0.6068) acc_x 93.7500 (85.6250) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/35] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7974 (0.6056) acc_x 78.1250 (84.0625) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/35] time 0.173 (0.183) data 0.096 (0.106) loss_x loss_x 0.2930 (0.6251) acc_x 93.7500 (82.7083) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/35] time 0.157 (0.178) data 0.080 (0.101) loss_x loss_x 0.5864 (0.6217) acc_x 81.2500 (82.8125) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/35] time 0.157 (0.174) data 0.080 (0.097) loss_x loss_x 0.7031 (0.6404) acc_x 81.2500 (82.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/35] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.7305 (0.6625) acc_x 81.2500 (81.8750) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [35/35] time 0.189 (0.171) data 0.112 (0.094) loss_x loss_x 0.6035 (0.6564) acc_x 81.2500 (81.6964) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1114
clean false:0
clean_rate:1.0
noisy true:147
noisy false:339
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [97/200] batch [5/34] time 0.163 (0.170) data 0.087 (0.094) loss_x loss_x 1.0020 (0.6319) acc_x 68.7500 (80.6250) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/34] time 0.190 (0.175) data 0.113 (0.098) loss_x loss_x 0.5488 (0.5797) acc_x 87.5000 (83.4375) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/34] time 0.161 (0.175) data 0.085 (0.098) loss_x loss_x 0.9844 (0.6625) acc_x 81.2500 (81.0417) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/34] time 0.174 (0.174) data 0.096 (0.097) loss_x loss_x 0.5742 (0.6530) acc_x 87.5000 (82.1875) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/34] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.4946 (0.6199) acc_x 90.6250 (83.2500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/34] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.6406 (0.5921) acc_x 84.3750 (84.2708) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1101
clean true:1101
clean false:0
clean_rate:1.0
noisy true:149
noisy false:350
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 499
epoch [98/200] batch [5/34] time 0.178 (0.183) data 0.102 (0.106) loss_x loss_x 0.4197 (0.5048) acc_x 81.2500 (83.7500) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/34] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.6187 (0.5807) acc_x 84.3750 (83.4375) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/34] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.6538 (0.5892) acc_x 84.3750 (83.3333) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/34] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.6890 (0.6239) acc_x 87.5000 (83.4375) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/34] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.6479 (0.5762) acc_x 90.6250 (85.0000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/34] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.5298 (0.5597) acc_x 87.5000 (84.8958) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1091
clean true:1091
clean false:0
clean_rate:1.0
noisy true:152
noisy false:357
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 509
epoch [99/200] batch [5/34] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.7993 (0.6528) acc_x 84.3750 (86.2500) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/34] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.3757 (0.6158) acc_x 90.6250 (87.1875) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/34] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.7388 (0.6050) acc_x 81.2500 (86.2500) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/34] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.2126 (0.6012) acc_x 93.7500 (86.0938) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/34] time 0.180 (0.187) data 0.103 (0.110) loss_x loss_x 0.6089 (0.6056) acc_x 78.1250 (85.5000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/34] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.8667 (0.6100) acc_x 78.1250 (84.8958) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1113
clean false:1
clean_rate:0.9991023339317774
noisy true:152
noisy false:334
all clean rate:  [0.9984894259818731, 0.9962593516209476, 0.9989165763813651, 1.0, 1.0, 0.9979231568016614, 0.9968879668049793, 0.9989754098360656, 1.0, 1.0, 0.9989969909729187, 0.9990138067061144, 1.0, 0.9989764585465711, 1.0, 1.0, 0.9990118577075099, 0.9990147783251232, 0.9990439770554493, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9990234375, 0.999043062200957, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9980952380952381, 1.0, 1.0, 0.9981024667931688, 1.0, 0.9990366088631984, 1.0, 0.999054820415879, 1.0, 1.0, 0.9990574929311969, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9990662931839402, 1.0, 1.0, 1.0, 1.0, 0.9990636704119851, 1.0, 1.0, 1.0, 1.0, 0.9990800367985281, 1.0, 1.0, 1.0, 0.9990706319702602, 0.9990800367985281, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9990723562152134, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9990791896869244, 1.0, 1.0, 0.9990783410138249, 1.0, 1.0, 0.9990917347865577, 1.0, 1.0, 0.9990982867448152, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9991023339317774]
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [100/200] batch [5/34] time 0.157 (0.170) data 0.080 (0.093) loss_x loss_x 0.5425 (0.4641) acc_x 84.3750 (87.5000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/34] time 0.175 (0.169) data 0.098 (0.092) loss_x loss_x 0.4937 (0.4454) acc_x 90.6250 (87.8125) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/34] time 0.192 (0.175) data 0.115 (0.098) loss_x loss_x 0.8652 (0.4915) acc_x 75.0000 (85.8333) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/34] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 1.0371 (0.5046) acc_x 75.0000 (85.7812) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/34] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 1.0000 (0.5493) acc_x 71.8750 (84.3750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/34] time 0.228 (0.183) data 0.152 (0.106) loss_x loss_x 0.3286 (0.5495) acc_x 93.7500 (84.2708) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1114
clean false:0
clean_rate:1.0
noisy true:152
noisy false:334
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [101/200] batch [5/34] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.7607 (0.6610) acc_x 78.1250 (80.6250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/34] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.9497 (0.6120) acc_x 81.2500 (82.8125) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/34] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.5415 (0.5883) acc_x 84.3750 (83.5417) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/34] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.7144 (0.5637) acc_x 84.3750 (84.2188) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/34] time 0.177 (0.177) data 0.100 (0.100) loss_x loss_x 0.7886 (0.5738) acc_x 78.1250 (83.8750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/34] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.3640 (0.5753) acc_x 93.7500 (84.1667) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.6781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1085
clean true:1084
clean false:1
clean_rate:0.9990783410138249
noisy true:149
noisy false:366
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 515
epoch [102/200] batch [5/33] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.6221 (0.6234) acc_x 81.2500 (81.8750) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/33] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.6548 (0.5732) acc_x 84.3750 (83.4375) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/33] time 0.188 (0.166) data 0.111 (0.089) loss_x loss_x 0.5576 (0.5202) acc_x 90.6250 (85.4167) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/33] time 0.173 (0.167) data 0.094 (0.090) loss_x loss_x 0.9624 (0.5675) acc_x 75.0000 (84.6875) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/33] time 0.183 (0.169) data 0.106 (0.092) loss_x loss_x 0.9336 (0.5801) acc_x 81.2500 (84.5000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/33] time 0.193 (0.172) data 0.116 (0.095) loss_x loss_x 0.6025 (0.5565) acc_x 87.5000 (85.2083) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1101
clean true:1101
clean false:0
clean_rate:1.0
noisy true:152
noisy false:347
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 499
epoch [103/200] batch [5/34] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.4661 (0.5401) acc_x 90.6250 (85.0000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/34] time 0.163 (0.180) data 0.086 (0.103) loss_x loss_x 0.6050 (0.5428) acc_x 84.3750 (85.3125) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/34] time 0.161 (0.173) data 0.084 (0.097) loss_x loss_x 0.4536 (0.5366) acc_x 90.6250 (85.8333) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/34] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 1.0498 (0.5821) acc_x 81.2500 (85.3125) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/34] time 0.176 (0.169) data 0.099 (0.092) loss_x loss_x 0.8613 (0.6012) acc_x 71.8750 (84.0000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/34] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 0.4934 (0.6057) acc_x 84.3750 (83.7500) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1119
clean false:0
clean_rate:1.0
noisy true:149
noisy false:332
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [104/200] batch [5/34] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.6182 (0.4302) acc_x 90.6250 (88.1250) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/34] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 0.5742 (0.5669) acc_x 87.5000 (84.6875) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/34] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.3567 (0.5736) acc_x 87.5000 (84.3750) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/34] time 0.162 (0.180) data 0.085 (0.103) loss_x loss_x 0.4468 (0.5479) acc_x 90.6250 (85.3125) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/34] time 0.158 (0.176) data 0.081 (0.099) loss_x loss_x 0.7188 (0.5877) acc_x 81.2500 (84.5000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/34] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.6748 (0.5786) acc_x 84.3750 (84.6875) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1118
clean true:1117
clean false:1
clean_rate:0.9991055456171736
noisy true:148
noisy false:334
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 482
epoch [105/200] batch [5/34] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.5991 (0.5678) acc_x 87.5000 (87.5000) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/34] time 0.189 (0.179) data 0.113 (0.102) loss_x loss_x 0.3286 (0.5685) acc_x 93.7500 (86.5625) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/34] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.5049 (0.5797) acc_x 84.3750 (85.6250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/34] time 0.199 (0.183) data 0.122 (0.106) loss_x loss_x 0.4185 (0.5883) acc_x 93.7500 (85.7812) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/34] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.5850 (0.5980) acc_x 90.6250 (86.1250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/34] time 0.166 (0.180) data 0.089 (0.103) loss_x loss_x 0.6328 (0.6063) acc_x 87.5000 (85.4167) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1098
clean true:1098
clean false:0
clean_rate:1.0
noisy true:145
noisy false:357
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 502
epoch [106/200] batch [5/34] time 0.201 (0.179) data 0.125 (0.102) loss_x loss_x 0.9634 (0.8220) acc_x 81.2500 (80.6250) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/34] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.6426 (0.6714) acc_x 90.6250 (83.4375) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/34] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5449 (0.6877) acc_x 78.1250 (82.7083) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/34] time 0.210 (0.185) data 0.134 (0.108) loss_x loss_x 0.4087 (0.6219) acc_x 90.6250 (84.3750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/34] time 0.195 (0.187) data 0.118 (0.110) loss_x loss_x 0.7583 (0.6182) acc_x 71.8750 (83.7500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/34] time 0.190 (0.187) data 0.113 (0.110) loss_x loss_x 0.6548 (0.5860) acc_x 84.3750 (84.8958) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1110
clean true:1110
clean false:0
clean_rate:1.0
noisy true:139
noisy false:351
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 490
epoch [107/200] batch [5/34] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.6772 (0.6887) acc_x 84.3750 (82.5000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/34] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.3188 (0.5526) acc_x 87.5000 (85.0000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/34] time 0.183 (0.187) data 0.105 (0.110) loss_x loss_x 0.7598 (0.5545) acc_x 81.2500 (85.2083) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/34] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.4507 (0.5489) acc_x 87.5000 (85.3125) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/34] time 0.174 (0.187) data 0.097 (0.110) loss_x loss_x 0.4548 (0.5348) acc_x 84.3750 (85.2500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/34] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.2012 (0.5042) acc_x 93.7500 (85.7292) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1103
clean true:1103
clean false:0
clean_rate:1.0
noisy true:153
noisy false:344
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 497
epoch [108/200] batch [5/34] time 0.181 (0.193) data 0.105 (0.116) loss_x loss_x 0.5586 (0.4567) acc_x 84.3750 (86.2500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/34] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.5264 (0.5266) acc_x 87.5000 (82.8125) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/34] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.6436 (0.5677) acc_x 84.3750 (83.5417) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/34] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 0.3167 (0.5214) acc_x 87.5000 (85.1562) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/34] time 0.188 (0.186) data 0.112 (0.109) loss_x loss_x 0.7700 (0.5002) acc_x 75.0000 (85.8750) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/34] time 0.193 (0.186) data 0.117 (0.109) loss_x loss_x 0.5845 (0.4994) acc_x 84.3750 (85.5208) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1104
clean true:1104
clean false:0
clean_rate:1.0
noisy true:145
noisy false:351
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 496
epoch [109/200] batch [5/34] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.0842 (0.5131) acc_x 96.8750 (86.8750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/34] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.4023 (0.5311) acc_x 90.6250 (86.8750) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/34] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.6372 (0.5414) acc_x 84.3750 (86.8750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/34] time 0.166 (0.180) data 0.089 (0.103) loss_x loss_x 0.1582 (0.5392) acc_x 96.8750 (86.7188) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/34] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.4065 (0.5375) acc_x 87.5000 (86.3750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/34] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.7070 (0.5642) acc_x 81.2500 (85.4167) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1134
clean true:1133
clean false:1
clean_rate:0.9991181657848325
noisy true:143
noisy false:323
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 466
epoch [110/200] batch [5/35] time 0.161 (0.167) data 0.084 (0.090) loss_x loss_x 0.7563 (0.5265) acc_x 87.5000 (87.5000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/35] time 0.190 (0.166) data 0.113 (0.089) loss_x loss_x 1.2412 (0.6558) acc_x 71.8750 (85.0000) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/35] time 0.180 (0.172) data 0.103 (0.094) loss_x loss_x 0.4434 (0.6312) acc_x 84.3750 (84.7917) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/35] time 0.186 (0.175) data 0.110 (0.098) loss_x loss_x 0.3965 (0.5888) acc_x 93.7500 (85.6250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/35] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.3721 (0.5899) acc_x 90.6250 (86.1250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/35] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.9746 (0.6070) acc_x 78.1250 (85.5208) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [35/35] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.3169 (0.5879) acc_x 93.7500 (85.7143) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:159
noisy false:321
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [111/200] batch [5/35] time 0.158 (0.173) data 0.081 (0.096) loss_x loss_x 0.4648 (0.6799) acc_x 90.6250 (83.1250) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/35] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.5410 (0.5704) acc_x 93.7500 (85.9375) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/35] time 0.159 (0.165) data 0.083 (0.088) loss_x loss_x 0.4409 (0.5586) acc_x 84.3750 (85.6250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/35] time 0.160 (0.164) data 0.083 (0.087) loss_x loss_x 0.6138 (0.5443) acc_x 84.3750 (85.7812) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/35] time 0.165 (0.163) data 0.088 (0.086) loss_x loss_x 0.6851 (0.5346) acc_x 81.2500 (85.8750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/35] time 0.188 (0.165) data 0.111 (0.088) loss_x loss_x 0.4011 (0.5355) acc_x 90.6250 (85.8333) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [35/35] time 0.164 (0.167) data 0.086 (0.090) loss_x loss_x 0.7803 (0.5582) acc_x 87.5000 (85.5357) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.6969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1115
clean true:1115
clean false:0
clean_rate:1.0
noisy true:155
noisy false:330
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 485
epoch [112/200] batch [5/34] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.5430 (0.6109) acc_x 81.2500 (81.8750) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/34] time 0.163 (0.183) data 0.086 (0.106) loss_x loss_x 0.5718 (0.6410) acc_x 84.3750 (81.2500) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/34] time 0.172 (0.182) data 0.094 (0.105) loss_x loss_x 0.4150 (0.6393) acc_x 87.5000 (81.2500) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/34] time 0.214 (0.187) data 0.137 (0.110) loss_x loss_x 0.8535 (0.6566) acc_x 84.3750 (82.0312) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/34] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.1267 (0.6408) acc_x 100.0000 (83.0000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/34] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.2888 (0.6426) acc_x 93.7500 (83.0208) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:148
noisy false:335
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [113/200] batch [5/34] time 0.180 (0.168) data 0.102 (0.091) loss_x loss_x 0.8657 (0.6732) acc_x 78.1250 (82.5000) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/34] time 0.165 (0.173) data 0.089 (0.096) loss_x loss_x 0.3728 (0.6211) acc_x 90.6250 (83.7500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/34] time 0.177 (0.174) data 0.099 (0.097) loss_x loss_x 0.5137 (0.6137) acc_x 84.3750 (82.9167) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/34] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.3069 (0.5839) acc_x 87.5000 (83.7500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/34] time 0.189 (0.175) data 0.112 (0.098) loss_x loss_x 0.3765 (0.5799) acc_x 90.6250 (84.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/34] time 0.168 (0.176) data 0.092 (0.099) loss_x loss_x 0.7905 (0.5899) acc_x 81.2500 (84.2708) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:145
noisy false:347
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 492
epoch [114/200] batch [5/34] time 0.202 (0.172) data 0.126 (0.095) loss_x loss_x 0.9819 (0.6439) acc_x 71.8750 (82.5000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/34] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.4697 (0.4938) acc_x 87.5000 (86.8750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/34] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.5137 (0.5406) acc_x 87.5000 (85.0000) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/34] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.5303 (0.5546) acc_x 93.7500 (85.6250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/34] time 0.161 (0.182) data 0.085 (0.105) loss_x loss_x 0.6318 (0.5790) acc_x 81.2500 (84.8750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/34] time 0.175 (0.181) data 0.097 (0.104) loss_x loss_x 0.6777 (0.5989) acc_x 84.3750 (84.5833) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1134
clean true:1133
clean false:1
clean_rate:0.9991181657848325
noisy true:151
noisy false:315
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 466
epoch [115/200] batch [5/35] time 0.185 (0.197) data 0.108 (0.120) loss_x loss_x 0.2734 (0.4497) acc_x 90.6250 (86.8750) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/35] time 0.185 (0.191) data 0.109 (0.114) loss_x loss_x 0.5547 (0.5646) acc_x 84.3750 (84.6875) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/35] time 0.187 (0.197) data 0.111 (0.120) loss_x loss_x 0.4624 (0.5391) acc_x 87.5000 (85.0000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/35] time 0.188 (0.193) data 0.110 (0.116) loss_x loss_x 0.7578 (0.5375) acc_x 81.2500 (85.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/35] time 0.182 (0.191) data 0.106 (0.114) loss_x loss_x 0.6987 (0.5539) acc_x 84.3750 (84.3750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/35] time 0.197 (0.191) data 0.120 (0.114) loss_x loss_x 0.7803 (0.5622) acc_x 78.1250 (84.5833) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [35/35] time 0.177 (0.191) data 0.100 (0.114) loss_x loss_x 0.8833 (0.5688) acc_x 78.1250 (84.2857) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1107
clean false:0
clean_rate:1.0
noisy true:152
noisy false:341
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [116/200] batch [5/34] time 0.186 (0.191) data 0.109 (0.114) loss_x loss_x 0.1814 (0.3507) acc_x 96.8750 (91.2500) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/34] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.5952 (0.4713) acc_x 84.3750 (88.7500) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/34] time 0.181 (0.187) data 0.104 (0.110) loss_x loss_x 0.6084 (0.5111) acc_x 90.6250 (87.7083) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/34] time 0.179 (0.187) data 0.102 (0.110) loss_x loss_x 1.0762 (0.5477) acc_x 71.8750 (86.5625) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/34] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.5317 (0.5208) acc_x 81.2500 (86.6250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/34] time 0.168 (0.185) data 0.091 (0.108) loss_x loss_x 0.5513 (0.5162) acc_x 93.7500 (86.8750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1122
clean false:0
clean_rate:1.0
noisy true:155
noisy false:323
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [117/200] batch [5/35] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 0.4080 (0.5411) acc_x 84.3750 (85.0000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/35] time 0.161 (0.179) data 0.084 (0.102) loss_x loss_x 0.3115 (0.5681) acc_x 90.6250 (85.6250) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/35] time 0.162 (0.173) data 0.086 (0.096) loss_x loss_x 0.6636 (0.5273) acc_x 84.3750 (86.2500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/35] time 0.250 (0.175) data 0.174 (0.098) loss_x loss_x 0.3979 (0.5949) acc_x 87.5000 (84.6875) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/35] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.3477 (0.5488) acc_x 93.7500 (86.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/35] time 0.181 (0.178) data 0.104 (0.102) loss_x loss_x 0.5483 (0.5648) acc_x 84.3750 (85.6250) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [35/35] time 0.211 (0.181) data 0.134 (0.104) loss_x loss_x 0.2058 (0.5649) acc_x 96.8750 (85.7143) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1137
clean true:1137
clean false:0
clean_rate:1.0
noisy true:156
noisy false:307
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 463
epoch [118/200] batch [5/35] time 0.200 (0.200) data 0.124 (0.123) loss_x loss_x 0.3640 (0.4620) acc_x 84.3750 (86.2500) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/35] time 0.188 (0.196) data 0.112 (0.120) loss_x loss_x 0.4041 (0.4974) acc_x 84.3750 (85.6250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/35] time 0.183 (0.191) data 0.106 (0.115) loss_x loss_x 0.7041 (0.4802) acc_x 84.3750 (86.0417) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/35] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 0.8828 (0.5266) acc_x 81.2500 (85.3125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/35] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.5791 (0.5022) acc_x 81.2500 (86.0000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/35] time 0.212 (0.188) data 0.135 (0.111) loss_x loss_x 0.4087 (0.4932) acc_x 93.7500 (86.3542) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [35/35] time 0.198 (0.187) data 0.121 (0.110) loss_x loss_x 0.6855 (0.4838) acc_x 75.0000 (86.3393) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1120
clean false:2
clean_rate:0.9982174688057041
noisy true:153
noisy false:325
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [119/200] batch [5/35] time 0.177 (0.181) data 0.101 (0.104) loss_x loss_x 1.0605 (0.5840) acc_x 75.0000 (83.7500) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/35] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.8931 (0.6216) acc_x 75.0000 (83.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/35] time 0.160 (0.176) data 0.084 (0.099) loss_x loss_x 0.6538 (0.6677) acc_x 84.3750 (82.9167) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/35] time 0.170 (0.177) data 0.093 (0.101) loss_x loss_x 0.6826 (0.6075) acc_x 78.1250 (83.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/35] time 0.157 (0.176) data 0.080 (0.099) loss_x loss_x 0.1313 (0.5862) acc_x 100.0000 (84.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/35] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.2032 (0.5865) acc_x 93.7500 (85.1042) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [35/35] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.7832 (0.5972) acc_x 81.2500 (85.2679) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 304
confident_label rate tensor(0.7113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1138
clean true:1138
clean false:0
clean_rate:1.0
noisy true:158
noisy false:304
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 462
epoch [120/200] batch [5/35] time 0.186 (0.183) data 0.108 (0.106) loss_x loss_x 0.6997 (0.5575) acc_x 78.1250 (86.2500) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/35] time 0.189 (0.184) data 0.113 (0.107) loss_x loss_x 1.1240 (0.5829) acc_x 71.8750 (85.0000) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/35] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.5991 (0.6132) acc_x 84.3750 (84.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/35] time 0.186 (0.189) data 0.109 (0.112) loss_x loss_x 0.6392 (0.5975) acc_x 87.5000 (85.1562) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/35] time 0.174 (0.187) data 0.097 (0.111) loss_x loss_x 1.1104 (0.6358) acc_x 65.6250 (83.6250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/35] time 0.167 (0.187) data 0.090 (0.111) loss_x loss_x 0.4597 (0.6061) acc_x 84.3750 (83.9583) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [35/35] time 0.176 (0.187) data 0.100 (0.110) loss_x loss_x 0.6528 (0.6013) acc_x 81.2500 (84.3750) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1122
clean false:0
clean_rate:1.0
noisy true:150
noisy false:328
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [121/200] batch [5/35] time 0.185 (0.190) data 0.107 (0.112) loss_x loss_x 0.4548 (0.4916) acc_x 87.5000 (88.1250) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/35] time 0.162 (0.184) data 0.085 (0.107) loss_x loss_x 0.6553 (0.5171) acc_x 78.1250 (86.8750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/35] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 0.3608 (0.5268) acc_x 87.5000 (86.8750) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/35] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.4773 (0.5369) acc_x 87.5000 (86.4062) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/35] time 0.172 (0.177) data 0.094 (0.100) loss_x loss_x 0.5088 (0.5288) acc_x 84.3750 (85.8750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/35] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.4058 (0.5297) acc_x 87.5000 (86.0417) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [35/35] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 0.7100 (0.5295) acc_x 81.2500 (85.9821) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:150
noisy false:331
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [122/200] batch [5/34] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.6504 (0.5776) acc_x 87.5000 (85.6250) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/34] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.2319 (0.5208) acc_x 90.6250 (85.6250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/34] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6309 (0.5126) acc_x 84.3750 (86.6667) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/34] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.7681 (0.5505) acc_x 75.0000 (85.0000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/34] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4700 (0.5446) acc_x 90.6250 (85.6250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/34] time 0.191 (0.184) data 0.113 (0.107) loss_x loss_x 0.3599 (0.5225) acc_x 90.6250 (85.8333) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:156
noisy false:317
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [123/200] batch [5/35] time 0.161 (0.162) data 0.084 (0.084) loss_x loss_x 0.3743 (0.5415) acc_x 93.7500 (85.0000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/35] time 0.192 (0.172) data 0.115 (0.095) loss_x loss_x 0.3979 (0.5774) acc_x 87.5000 (84.0625) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/35] time 0.244 (0.179) data 0.167 (0.102) loss_x loss_x 0.1818 (0.5645) acc_x 93.7500 (85.2083) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/35] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.3438 (0.5507) acc_x 84.3750 (84.8438) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/35] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.6660 (0.5188) acc_x 75.0000 (85.6250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/35] time 0.198 (0.179) data 0.121 (0.102) loss_x loss_x 0.4539 (0.5137) acc_x 84.3750 (85.6250) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [35/35] time 0.181 (0.179) data 0.103 (0.102) loss_x loss_x 0.6987 (0.5143) acc_x 87.5000 (85.8929) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1099
clean true:1099
clean false:0
clean_rate:1.0
noisy true:144
noisy false:357
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 501
epoch [124/200] batch [5/34] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.3892 (0.5339) acc_x 87.5000 (87.5000) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/34] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.4011 (0.5068) acc_x 84.3750 (86.5625) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/34] time 0.189 (0.170) data 0.112 (0.093) loss_x loss_x 0.7383 (0.5242) acc_x 81.2500 (85.4167) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/34] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 0.5176 (0.5582) acc_x 87.5000 (84.6875) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/34] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.2476 (0.5277) acc_x 96.8750 (85.5000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/34] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.3184 (0.4994) acc_x 93.7500 (86.5625) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:156
noisy false:335
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 491
epoch [125/200] batch [5/34] time 0.182 (0.188) data 0.105 (0.112) loss_x loss_x 0.4338 (0.5508) acc_x 87.5000 (83.7500) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/34] time 0.163 (0.184) data 0.086 (0.107) loss_x loss_x 0.3464 (0.4794) acc_x 90.6250 (86.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/34] time 0.156 (0.176) data 0.079 (0.099) loss_x loss_x 0.6138 (0.5446) acc_x 78.1250 (85.0000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/34] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.3298 (0.5264) acc_x 90.6250 (85.1562) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/34] time 0.157 (0.170) data 0.081 (0.093) loss_x loss_x 0.6724 (0.5162) acc_x 78.1250 (85.2500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/34] time 0.163 (0.169) data 0.087 (0.092) loss_x loss_x 0.3745 (0.5229) acc_x 84.3750 (85.0000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1095
clean true:1095
clean false:0
clean_rate:1.0
noisy true:148
noisy false:357
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 505
epoch [126/200] batch [5/34] time 0.190 (0.177) data 0.113 (0.100) loss_x loss_x 0.6675 (0.4376) acc_x 84.3750 (89.3750) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/34] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.4473 (0.4652) acc_x 84.3750 (87.8125) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/34] time 0.225 (0.189) data 0.148 (0.112) loss_x loss_x 0.4470 (0.4930) acc_x 81.2500 (86.8750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/34] time 0.182 (0.189) data 0.105 (0.112) loss_x loss_x 0.6123 (0.5168) acc_x 75.0000 (85.7812) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/34] time 0.159 (0.186) data 0.082 (0.110) loss_x loss_x 0.6597 (0.4990) acc_x 81.2500 (86.8750) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/34] time 0.160 (0.182) data 0.083 (0.105) loss_x loss_x 0.4131 (0.5235) acc_x 87.5000 (86.1458) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.7050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1128
clean true:1128
clean false:0
clean_rate:1.0
noisy true:151
noisy false:321
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 472
epoch [127/200] batch [5/35] time 0.165 (0.190) data 0.088 (0.113) loss_x loss_x 0.4324 (0.5852) acc_x 87.5000 (83.7500) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/35] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.8335 (0.6369) acc_x 78.1250 (83.7500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/35] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.7158 (0.6274) acc_x 81.2500 (83.3333) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/35] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.9268 (0.6113) acc_x 81.2500 (84.2188) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/35] time 0.197 (0.188) data 0.119 (0.111) loss_x loss_x 0.7432 (0.6283) acc_x 75.0000 (83.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/35] time 0.194 (0.188) data 0.117 (0.111) loss_x loss_x 0.5620 (0.6182) acc_x 87.5000 (84.1667) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [35/35] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.4009 (0.6217) acc_x 90.6250 (83.7500) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 328
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1119
clean false:1
clean_rate:0.9991071428571429
noisy true:153
noisy false:327
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [128/200] batch [5/35] time 0.172 (0.192) data 0.095 (0.115) loss_x loss_x 0.9268 (0.7681) acc_x 81.2500 (80.6250) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/35] time 0.180 (0.187) data 0.103 (0.109) loss_x loss_x 0.5806 (0.7114) acc_x 87.5000 (80.3125) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/35] time 0.207 (0.187) data 0.130 (0.110) loss_x loss_x 0.4880 (0.6890) acc_x 87.5000 (81.2500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/35] time 0.171 (0.183) data 0.095 (0.106) loss_x loss_x 0.5483 (0.6528) acc_x 84.3750 (82.0312) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/35] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7656 (0.6211) acc_x 81.2500 (83.1250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/35] time 0.160 (0.181) data 0.083 (0.104) loss_x loss_x 0.4417 (0.6422) acc_x 84.3750 (82.7083) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [35/35] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.3059 (0.6283) acc_x 84.3750 (82.8571) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1136
clean true:1135
clean false:1
clean_rate:0.9991197183098591
noisy true:142
noisy false:322
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 464
epoch [129/200] batch [5/35] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.3066 (0.4554) acc_x 96.8750 (89.3750) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/35] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.3455 (0.5563) acc_x 93.7500 (87.1875) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/35] time 0.177 (0.175) data 0.101 (0.097) loss_x loss_x 0.2400 (0.5637) acc_x 93.7500 (85.8333) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/35] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.4434 (0.6293) acc_x 93.7500 (84.0625) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/35] time 0.184 (0.172) data 0.107 (0.095) loss_x loss_x 0.4861 (0.5923) acc_x 87.5000 (85.2500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/35] time 0.186 (0.173) data 0.109 (0.096) loss_x loss_x 0.3782 (0.5758) acc_x 87.5000 (85.6250) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [35/35] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.5195 (0.5678) acc_x 84.3750 (85.4464) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:151
noisy false:330
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [130/200] batch [5/34] time 0.186 (0.190) data 0.110 (0.113) loss_x loss_x 0.4968 (0.6343) acc_x 87.5000 (82.5000) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/34] time 0.171 (0.186) data 0.094 (0.109) loss_x loss_x 0.3228 (0.5591) acc_x 90.6250 (85.0000) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/34] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.2112 (0.4970) acc_x 93.7500 (86.6667) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/34] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.7964 (0.5517) acc_x 81.2500 (85.7812) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/34] time 0.171 (0.181) data 0.094 (0.104) loss_x loss_x 0.1704 (0.5529) acc_x 96.8750 (86.0000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/34] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.6118 (0.5728) acc_x 90.6250 (86.0417) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.7156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1145
clean true:1145
clean false:0
clean_rate:1.0
noisy true:156
noisy false:299
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 455
epoch [131/200] batch [5/35] time 0.163 (0.167) data 0.086 (0.090) loss_x loss_x 0.2737 (0.5228) acc_x 96.8750 (86.2500) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/35] time 0.185 (0.172) data 0.107 (0.095) loss_x loss_x 0.7251 (0.5294) acc_x 81.2500 (85.6250) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/35] time 0.188 (0.178) data 0.112 (0.101) loss_x loss_x 0.4590 (0.5139) acc_x 84.3750 (85.8333) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/35] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.6309 (0.5829) acc_x 81.2500 (84.6875) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/35] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.5205 (0.5854) acc_x 84.3750 (84.3750) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/35] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 0.6616 (0.5962) acc_x 81.2500 (83.7500) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [35/35] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.5020 (0.5860) acc_x 90.6250 (84.1071) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:143
noisy false:338
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [132/200] batch [5/34] time 0.177 (0.171) data 0.100 (0.093) loss_x loss_x 0.4377 (0.5798) acc_x 87.5000 (84.3750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/34] time 0.159 (0.167) data 0.081 (0.090) loss_x loss_x 0.5146 (0.5373) acc_x 84.3750 (85.0000) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/34] time 0.161 (0.165) data 0.084 (0.087) loss_x loss_x 0.3506 (0.4910) acc_x 90.6250 (86.4583) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/34] time 0.160 (0.164) data 0.084 (0.086) loss_x loss_x 1.0947 (0.4977) acc_x 81.2500 (86.2500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/34] time 0.189 (0.168) data 0.111 (0.091) loss_x loss_x 0.2344 (0.5042) acc_x 96.8750 (86.3750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/34] time 0.184 (0.171) data 0.106 (0.094) loss_x loss_x 0.9531 (0.5122) acc_x 75.0000 (85.8333) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.6919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1107
clean true:1107
clean false:0
clean_rate:1.0
noisy true:156
noisy false:337
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 493
epoch [133/200] batch [5/34] time 0.193 (0.185) data 0.116 (0.108) loss_x loss_x 0.9849 (0.5528) acc_x 81.2500 (88.1250) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/34] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.4163 (0.5914) acc_x 90.6250 (85.9375) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/34] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.5117 (0.5731) acc_x 87.5000 (85.6250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/34] time 0.185 (0.186) data 0.109 (0.108) loss_x loss_x 0.6157 (0.5770) acc_x 87.5000 (85.6250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/34] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.3174 (0.5582) acc_x 87.5000 (85.7500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/34] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.7876 (0.5652) acc_x 71.8750 (85.5208) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.7019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1123
clean true:1123
clean false:0
clean_rate:1.0
noisy true:150
noisy false:327
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 477
epoch [134/200] batch [5/35] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.8560 (0.5492) acc_x 78.1250 (87.5000) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/35] time 0.175 (0.185) data 0.098 (0.108) loss_x loss_x 0.5386 (0.5268) acc_x 87.5000 (87.8125) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/35] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 0.3416 (0.4844) acc_x 87.5000 (86.8750) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/35] time 0.166 (0.185) data 0.089 (0.108) loss_x loss_x 0.9067 (0.5389) acc_x 71.8750 (85.3125) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/35] time 0.177 (0.185) data 0.101 (0.108) loss_x loss_x 0.5933 (0.5236) acc_x 81.2500 (85.6250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/35] time 0.161 (0.184) data 0.085 (0.107) loss_x loss_x 0.4531 (0.5638) acc_x 87.5000 (84.7917) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [35/35] time 0.162 (0.181) data 0.085 (0.104) loss_x loss_x 0.2214 (0.5393) acc_x 93.7500 (85.5357) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.7125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1140
clean true:1140
clean false:0
clean_rate:1.0
noisy true:154
noisy false:306
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 460
epoch [135/200] batch [5/35] time 0.195 (0.188) data 0.118 (0.110) loss_x loss_x 0.3987 (0.5410) acc_x 93.7500 (86.8750) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/35] time 0.187 (0.189) data 0.110 (0.112) loss_x loss_x 0.2859 (0.4856) acc_x 90.6250 (87.5000) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/35] time 0.169 (0.184) data 0.092 (0.107) loss_x loss_x 0.3618 (0.5044) acc_x 90.6250 (86.6667) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/35] time 0.169 (0.181) data 0.092 (0.104) loss_x loss_x 0.3296 (0.4884) acc_x 90.6250 (87.0312) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/35] time 0.214 (0.182) data 0.137 (0.105) loss_x loss_x 0.9619 (0.5035) acc_x 84.3750 (86.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/35] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.3389 (0.5317) acc_x 87.5000 (86.0417) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [35/35] time 0.175 (0.179) data 0.099 (0.102) loss_x loss_x 0.5615 (0.5499) acc_x 87.5000 (85.4464) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 281
confident_label rate tensor(0.7275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1164
clean true:1164
clean false:0
clean_rate:1.0
noisy true:155
noisy false:281
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 436
epoch [136/200] batch [5/36] time 0.176 (0.190) data 0.099 (0.112) loss_x loss_x 0.4177 (0.4976) acc_x 90.6250 (86.2500) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/36] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.3296 (0.5163) acc_x 93.7500 (85.6250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/36] time 0.196 (0.187) data 0.119 (0.110) loss_x loss_x 0.6367 (0.5488) acc_x 81.2500 (85.8333) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/36] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.3977 (0.5302) acc_x 87.5000 (86.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/36] time 0.163 (0.183) data 0.085 (0.106) loss_x loss_x 0.7280 (0.5564) acc_x 75.0000 (85.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [30/36] time 0.166 (0.181) data 0.089 (0.104) loss_x loss_x 0.4700 (0.5428) acc_x 84.3750 (85.7292) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [35/36] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.2766 (0.5367) acc_x 87.5000 (85.9821) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.7075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1132
clean true:1132
clean false:0
clean_rate:1.0
noisy true:153
noisy false:315
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 468
epoch [137/200] batch [5/35] time 0.162 (0.170) data 0.085 (0.092) loss_x loss_x 0.6987 (0.4765) acc_x 84.3750 (85.0000) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/35] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.6001 (0.5100) acc_x 84.3750 (84.3750) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/35] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.5503 (0.4852) acc_x 81.2500 (85.2083) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/35] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6104 (0.4791) acc_x 81.2500 (86.4062) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/35] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.3069 (0.5033) acc_x 93.7500 (86.7500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/35] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.6519 (0.5033) acc_x 78.1250 (86.2500) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [35/35] time 0.200 (0.182) data 0.123 (0.105) loss_x loss_x 1.0371 (0.5211) acc_x 84.3750 (85.9821) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1122
clean false:0
clean_rate:1.0
noisy true:160
noisy false:318
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [138/200] batch [5/35] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.6934 (0.6337) acc_x 81.2500 (81.2500) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/35] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.3113 (0.5746) acc_x 90.6250 (83.7500) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/35] time 0.177 (0.174) data 0.100 (0.097) loss_x loss_x 1.0850 (0.6403) acc_x 75.0000 (82.7083) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/35] time 0.168 (0.173) data 0.091 (0.095) loss_x loss_x 0.5415 (0.6546) acc_x 84.3750 (82.3438) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/35] time 0.214 (0.176) data 0.137 (0.098) loss_x loss_x 1.1504 (0.6589) acc_x 71.8750 (82.1250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/35] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.3945 (0.6363) acc_x 90.6250 (82.9167) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [35/35] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.4817 (0.6215) acc_x 84.3750 (83.1250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 318
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1126
clean false:1
clean_rate:0.9991126885536823
noisy true:156
noisy false:317
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [139/200] batch [5/35] time 0.184 (0.174) data 0.108 (0.097) loss_x loss_x 0.7197 (0.5839) acc_x 81.2500 (85.6250) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/35] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.3547 (0.5334) acc_x 90.6250 (86.8750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/35] time 0.197 (0.183) data 0.120 (0.106) loss_x loss_x 0.3286 (0.5080) acc_x 93.7500 (87.7083) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/35] time 0.175 (0.181) data 0.099 (0.104) loss_x loss_x 0.5322 (0.5272) acc_x 84.3750 (87.1875) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/35] time 0.190 (0.182) data 0.112 (0.105) loss_x loss_x 0.5542 (0.5251) acc_x 87.5000 (86.5000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/35] time 0.195 (0.183) data 0.118 (0.105) loss_x loss_x 0.5737 (0.5266) acc_x 84.3750 (86.4583) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [35/35] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.4500 (0.5283) acc_x 78.1250 (86.2500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.6987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1118
clean true:1116
clean false:2
clean_rate:0.998211091234347
noisy true:141
noisy false:341
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 482
epoch [140/200] batch [5/34] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.3923 (0.4782) acc_x 87.5000 (87.5000) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/34] time 0.184 (0.193) data 0.106 (0.116) loss_x loss_x 0.6694 (0.5706) acc_x 84.3750 (83.4375) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/34] time 0.176 (0.190) data 0.099 (0.113) loss_x loss_x 0.7334 (0.6430) acc_x 84.3750 (81.0417) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/34] time 0.196 (0.188) data 0.120 (0.111) loss_x loss_x 0.2354 (0.6247) acc_x 87.5000 (81.5625) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/34] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.7622 (0.6087) acc_x 81.2500 (82.3750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/34] time 0.188 (0.185) data 0.110 (0.109) loss_x loss_x 0.3232 (0.5859) acc_x 90.6250 (83.0208) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 321
confident_label rate tensor(0.7100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1136
clean true:1136
clean false:0
clean_rate:1.0
noisy true:143
noisy false:321
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 464
epoch [141/200] batch [5/35] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.4873 (0.4950) acc_x 90.6250 (86.8750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/35] time 0.167 (0.160) data 0.090 (0.083) loss_x loss_x 0.3718 (0.5420) acc_x 90.6250 (85.3125) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/35] time 0.183 (0.162) data 0.106 (0.085) loss_x loss_x 0.5918 (0.5374) acc_x 87.5000 (86.2500) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/35] time 0.163 (0.164) data 0.086 (0.087) loss_x loss_x 0.4446 (0.5234) acc_x 96.8750 (87.0312) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/35] time 0.159 (0.165) data 0.082 (0.088) loss_x loss_x 0.3950 (0.5329) acc_x 90.6250 (86.7500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/35] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 0.6602 (0.5097) acc_x 84.3750 (87.1875) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [35/35] time 0.175 (0.168) data 0.098 (0.091) loss_x loss_x 0.6958 (0.5332) acc_x 81.2500 (86.9643) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.6975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1116
clean true:1116
clean false:0
clean_rate:1.0
noisy true:146
noisy false:338
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 484
epoch [142/200] batch [5/34] time 0.193 (0.185) data 0.116 (0.108) loss_x loss_x 0.8433 (0.7539) acc_x 71.8750 (80.0000) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/34] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 0.5767 (0.5948) acc_x 84.3750 (84.3750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/34] time 0.163 (0.171) data 0.086 (0.094) loss_x loss_x 0.4167 (0.6224) acc_x 84.3750 (82.2917) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/34] time 0.194 (0.172) data 0.117 (0.095) loss_x loss_x 0.4470 (0.5643) acc_x 84.3750 (83.9062) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/34] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.7266 (0.5737) acc_x 90.6250 (84.1250) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/34] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.6553 (0.5878) acc_x 84.3750 (84.3750) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.7081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1133
clean true:1133
clean false:0
clean_rate:1.0
noisy true:147
noisy false:320
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 467
epoch [143/200] batch [5/35] time 0.177 (0.181) data 0.099 (0.104) loss_x loss_x 0.4241 (0.5395) acc_x 90.6250 (85.6250) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [10/35] time 0.193 (0.183) data 0.114 (0.106) loss_x loss_x 0.4038 (0.5467) acc_x 93.7500 (85.6250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/35] time 0.164 (0.180) data 0.087 (0.103) loss_x loss_x 0.4172 (0.5379) acc_x 90.6250 (85.6250) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/35] time 0.162 (0.176) data 0.084 (0.098) loss_x loss_x 0.2888 (0.5067) acc_x 90.6250 (87.3438) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/35] time 0.158 (0.173) data 0.081 (0.095) loss_x loss_x 0.9023 (0.5111) acc_x 78.1250 (87.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/35] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.3684 (0.5164) acc_x 87.5000 (87.1875) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [35/35] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 0.3938 (0.5099) acc_x 90.6250 (87.3214) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:159
noisy false:320
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [144/200] batch [5/35] time 0.185 (0.198) data 0.107 (0.121) loss_x loss_x 0.3643 (0.6305) acc_x 93.7500 (83.7500) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/35] time 0.179 (0.188) data 0.102 (0.111) loss_x loss_x 0.6113 (0.5669) acc_x 87.5000 (84.6875) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/35] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.2654 (0.4736) acc_x 96.8750 (87.0833) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/35] time 0.168 (0.183) data 0.091 (0.106) loss_x loss_x 0.4360 (0.4658) acc_x 81.2500 (87.1875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/35] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.5874 (0.4709) acc_x 87.5000 (87.0000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/35] time 0.160 (0.179) data 0.082 (0.102) loss_x loss_x 0.5889 (0.4972) acc_x 87.5000 (86.5625) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [35/35] time 0.159 (0.178) data 0.082 (0.100) loss_x loss_x 0.8833 (0.5042) acc_x 78.1250 (86.1607) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.7056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1129
clean true:1127
clean false:2
clean_rate:0.9982285208148804
noisy true:147
noisy false:324
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 471
epoch [145/200] batch [5/35] time 0.184 (0.203) data 0.108 (0.126) loss_x loss_x 0.7900 (0.5288) acc_x 81.2500 (84.3750) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [10/35] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.7148 (0.5964) acc_x 81.2500 (84.0625) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/35] time 0.164 (0.185) data 0.086 (0.108) loss_x loss_x 0.5884 (0.5785) acc_x 78.1250 (84.1667) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/35] time 0.196 (0.187) data 0.119 (0.110) loss_x loss_x 0.5200 (0.5658) acc_x 90.6250 (85.1562) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/35] time 0.191 (0.186) data 0.114 (0.109) loss_x loss_x 0.6060 (0.5562) acc_x 87.5000 (85.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/35] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.5776 (0.5655) acc_x 81.2500 (84.7917) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [35/35] time 0.162 (0.181) data 0.085 (0.104) loss_x loss_x 0.2025 (0.5548) acc_x 93.7500 (85.0893) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1116
clean false:1
clean_rate:0.999104744852283
noisy true:158
noisy false:325
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [146/200] batch [5/34] time 0.186 (0.197) data 0.108 (0.120) loss_x loss_x 0.4675 (0.6397) acc_x 93.7500 (85.6250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/34] time 0.168 (0.190) data 0.091 (0.113) loss_x loss_x 0.5327 (0.5728) acc_x 81.2500 (86.5625) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/34] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4658 (0.5775) acc_x 84.3750 (86.0417) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/34] time 0.195 (0.189) data 0.117 (0.111) loss_x loss_x 0.9150 (0.6027) acc_x 75.0000 (84.8438) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/34] time 0.194 (0.187) data 0.117 (0.109) loss_x loss_x 0.3943 (0.6124) acc_x 90.6250 (84.5000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/34] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.2700 (0.5784) acc_x 90.6250 (85.4167) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.7031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1125
clean true:1125
clean false:0
clean_rate:1.0
noisy true:155
noisy false:320
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 475
epoch [147/200] batch [5/35] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.2473 (0.4315) acc_x 93.7500 (88.1250) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/35] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.8125 (0.5478) acc_x 71.8750 (84.0625) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/35] time 0.177 (0.185) data 0.100 (0.108) loss_x loss_x 0.2625 (0.5412) acc_x 93.7500 (84.7917) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/35] time 0.159 (0.186) data 0.082 (0.109) loss_x loss_x 1.1094 (0.5699) acc_x 75.0000 (85.1562) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/35] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.8516 (0.5856) acc_x 68.7500 (84.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/35] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.2069 (0.5536) acc_x 96.8750 (85.3125) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [35/35] time 0.156 (0.182) data 0.080 (0.105) loss_x loss_x 0.5420 (0.5551) acc_x 87.5000 (85.0000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1114
clean false:0
clean_rate:1.0
noisy true:144
noisy false:342
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [148/200] batch [5/34] time 0.165 (0.176) data 0.087 (0.098) loss_x loss_x 0.4304 (0.5384) acc_x 90.6250 (83.7500) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/34] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.4368 (0.5430) acc_x 87.5000 (84.6875) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/34] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3420 (0.5344) acc_x 93.7500 (85.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/34] time 0.158 (0.182) data 0.081 (0.105) loss_x loss_x 0.9385 (0.5854) acc_x 87.5000 (84.6875) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/34] time 0.163 (0.182) data 0.086 (0.104) loss_x loss_x 0.5166 (0.6172) acc_x 90.6250 (84.6250) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/34] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.6807 (0.6327) acc_x 84.3750 (84.1667) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1113
clean true:1113
clean false:0
clean_rate:1.0
noisy true:152
noisy false:335
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 487
epoch [149/200] batch [5/34] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.3921 (0.4681) acc_x 90.6250 (88.1250) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/34] time 0.164 (0.163) data 0.086 (0.085) loss_x loss_x 0.8457 (0.5714) acc_x 78.1250 (85.9375) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/34] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.6108 (0.5508) acc_x 78.1250 (86.2500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/34] time 0.169 (0.173) data 0.092 (0.095) loss_x loss_x 0.7930 (0.5563) acc_x 81.2500 (85.7812) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/34] time 0.181 (0.173) data 0.103 (0.096) loss_x loss_x 0.8403 (0.5776) acc_x 78.1250 (85.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/34] time 0.189 (0.174) data 0.112 (0.097) loss_x loss_x 0.3464 (0.5638) acc_x 87.5000 (85.1042) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:148
noisy false:325
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [150/200] batch [5/35] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.4844 (0.4817) acc_x 87.5000 (89.3750) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/35] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.9507 (0.6761) acc_x 75.0000 (83.1250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/35] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.4775 (0.6409) acc_x 90.6250 (83.9583) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/35] time 0.160 (0.172) data 0.082 (0.095) loss_x loss_x 0.8271 (0.6351) acc_x 71.8750 (83.7500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/35] time 0.161 (0.170) data 0.084 (0.092) loss_x loss_x 0.8682 (0.6312) acc_x 81.2500 (84.1250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/35] time 0.164 (0.168) data 0.086 (0.091) loss_x loss_x 0.6509 (0.6000) acc_x 84.3750 (84.8958) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [35/35] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 0.6890 (0.5952) acc_x 78.1250 (84.9107) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:156
noisy false:338
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 494
epoch [151/200] batch [5/34] time 0.181 (0.177) data 0.104 (0.099) loss_x loss_x 0.4294 (0.5792) acc_x 90.6250 (83.7500) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/34] time 0.180 (0.181) data 0.101 (0.104) loss_x loss_x 0.5859 (0.5438) acc_x 84.3750 (85.3125) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/34] time 0.170 (0.181) data 0.093 (0.103) loss_x loss_x 0.4429 (0.5069) acc_x 90.6250 (86.2500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/34] time 0.186 (0.180) data 0.108 (0.102) loss_x loss_x 0.2382 (0.5042) acc_x 96.8750 (85.9375) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/34] time 0.187 (0.179) data 0.111 (0.102) loss_x loss_x 0.3950 (0.5038) acc_x 87.5000 (85.7500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/34] time 0.187 (0.179) data 0.110 (0.102) loss_x loss_x 0.7344 (0.5354) acc_x 84.3750 (85.4167) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1125
clean true:1125
clean false:0
clean_rate:1.0
noisy true:151
noisy false:324
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 475
epoch [152/200] batch [5/35] time 0.193 (0.187) data 0.116 (0.110) loss_x loss_x 0.3770 (0.4476) acc_x 90.6250 (87.5000) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/35] time 0.184 (0.191) data 0.108 (0.114) loss_x loss_x 0.1970 (0.4467) acc_x 90.6250 (87.5000) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/35] time 0.170 (0.187) data 0.092 (0.110) loss_x loss_x 0.4561 (0.4571) acc_x 84.3750 (86.8750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/35] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7114 (0.4547) acc_x 78.1250 (86.8750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/35] time 0.173 (0.185) data 0.096 (0.108) loss_x loss_x 0.4673 (0.4921) acc_x 93.7500 (86.7500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/35] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.4966 (0.4986) acc_x 90.6250 (86.9792) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [35/35] time 0.185 (0.187) data 0.108 (0.109) loss_x loss_x 0.4082 (0.4844) acc_x 93.7500 (87.3214) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1106
clean true:1105
clean false:1
clean_rate:0.9990958408679927
noisy true:148
noisy false:346
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 494
epoch [153/200] batch [5/34] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.3364 (0.5034) acc_x 87.5000 (86.2500) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/34] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.7227 (0.5248) acc_x 75.0000 (85.0000) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/34] time 0.174 (0.175) data 0.097 (0.097) loss_x loss_x 0.3418 (0.5219) acc_x 90.6250 (85.6250) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/34] time 0.193 (0.177) data 0.116 (0.100) loss_x loss_x 0.3752 (0.5067) acc_x 87.5000 (85.9375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/34] time 0.190 (0.179) data 0.113 (0.102) loss_x loss_x 0.3003 (0.4922) acc_x 93.7500 (86.7500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/34] time 0.190 (0.184) data 0.113 (0.106) loss_x loss_x 0.7573 (0.5043) acc_x 75.0000 (86.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1140
clean true:1140
clean false:0
clean_rate:1.0
noisy true:153
noisy false:307
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 460
epoch [154/200] batch [5/35] time 0.200 (0.205) data 0.123 (0.128) loss_x loss_x 0.5420 (0.5055) acc_x 81.2500 (86.2500) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [10/35] time 0.182 (0.195) data 0.105 (0.118) loss_x loss_x 0.5605 (0.5425) acc_x 81.2500 (84.6875) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/35] time 0.166 (0.187) data 0.089 (0.110) loss_x loss_x 0.2932 (0.5585) acc_x 93.7500 (85.8333) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/35] time 0.161 (0.183) data 0.083 (0.106) loss_x loss_x 1.1709 (0.5833) acc_x 62.5000 (84.5312) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/35] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.4285 (0.5571) acc_x 84.3750 (84.8750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/35] time 0.162 (0.179) data 0.085 (0.102) loss_x loss_x 0.3093 (0.5260) acc_x 93.7500 (85.5208) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [35/35] time 0.189 (0.181) data 0.113 (0.104) loss_x loss_x 0.6499 (0.5497) acc_x 81.2500 (85.3571) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.7044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1127
clean true:1127
clean false:0
clean_rate:1.0
noisy true:156
noisy false:317
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 473
epoch [155/200] batch [5/35] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.5547 (0.4756) acc_x 84.3750 (87.5000) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/35] time 0.172 (0.166) data 0.094 (0.089) loss_x loss_x 0.6108 (0.5720) acc_x 87.5000 (85.3125) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/35] time 0.161 (0.171) data 0.084 (0.094) loss_x loss_x 0.3169 (0.5302) acc_x 90.6250 (86.4583) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/35] time 0.190 (0.174) data 0.113 (0.097) loss_x loss_x 0.4768 (0.5429) acc_x 84.3750 (85.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/35] time 0.199 (0.182) data 0.122 (0.104) loss_x loss_x 0.3894 (0.5381) acc_x 87.5000 (85.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/35] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 0.5220 (0.5368) acc_x 81.2500 (85.6250) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [35/35] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.4321 (0.5348) acc_x 87.5000 (85.9821) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.7106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1137
clean true:1137
clean false:0
clean_rate:1.0
noisy true:153
noisy false:310
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 463
epoch [156/200] batch [5/35] time 0.173 (0.171) data 0.094 (0.093) loss_x loss_x 0.2639 (0.6027) acc_x 93.7500 (84.3750) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/35] time 0.163 (0.172) data 0.086 (0.094) loss_x loss_x 0.3289 (0.5304) acc_x 90.6250 (84.6875) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/35] time 0.168 (0.169) data 0.091 (0.092) loss_x loss_x 0.4980 (0.4976) acc_x 84.3750 (85.8333) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/35] time 0.154 (0.167) data 0.077 (0.089) loss_x loss_x 0.3984 (0.5246) acc_x 93.7500 (85.6250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/35] time 0.217 (0.172) data 0.140 (0.095) loss_x loss_x 0.7764 (0.5478) acc_x 78.1250 (84.8750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/35] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.5439 (0.5468) acc_x 84.3750 (84.3750) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [35/35] time 0.179 (0.176) data 0.102 (0.098) loss_x loss_x 1.1953 (0.5610) acc_x 71.8750 (84.3750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:148
noisy false:335
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [157/200] batch [5/34] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.6714 (0.5993) acc_x 84.3750 (85.0000) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/34] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 0.4685 (0.5264) acc_x 90.6250 (86.8750) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/34] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 0.2361 (0.4744) acc_x 96.8750 (87.2917) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/34] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.3242 (0.4956) acc_x 87.5000 (86.7188) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/34] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.9980 (0.5525) acc_x 71.8750 (85.8750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/34] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.7300 (0.5644) acc_x 84.3750 (85.9375) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 320
confident_label rate tensor(0.7100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1136
clean true:1136
clean false:0
clean_rate:1.0
noisy true:144
noisy false:320
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 464
epoch [158/200] batch [5/35] time 0.189 (0.178) data 0.112 (0.100) loss_x loss_x 0.2639 (0.5460) acc_x 93.7500 (86.8750) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/35] time 0.193 (0.177) data 0.116 (0.100) loss_x loss_x 0.3948 (0.5705) acc_x 90.6250 (86.2500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/35] time 0.167 (0.185) data 0.090 (0.108) loss_x loss_x 0.6230 (0.5686) acc_x 90.6250 (87.0833) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/35] time 0.175 (0.181) data 0.099 (0.104) loss_x loss_x 0.7363 (0.5457) acc_x 84.3750 (87.0312) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/35] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.5112 (0.5462) acc_x 90.6250 (87.6250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/35] time 0.211 (0.181) data 0.134 (0.104) loss_x loss_x 0.5444 (0.5603) acc_x 81.2500 (86.7708) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [35/35] time 0.159 (0.180) data 0.082 (0.103) loss_x loss_x 0.7510 (0.5606) acc_x 75.0000 (86.6964) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1135
clean false:0
clean_rate:1.0
noisy true:155
noisy false:310
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [159/200] batch [5/35] time 0.190 (0.186) data 0.111 (0.109) loss_x loss_x 0.5801 (0.4536) acc_x 81.2500 (86.8750) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/35] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.6064 (0.5161) acc_x 90.6250 (86.5625) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/35] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.3306 (0.4720) acc_x 93.7500 (88.5417) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/35] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.6216 (0.4937) acc_x 84.3750 (87.6562) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/35] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.5068 (0.5175) acc_x 84.3750 (86.8750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/35] time 0.206 (0.181) data 0.128 (0.104) loss_x loss_x 0.5161 (0.4998) acc_x 81.2500 (87.0833) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [35/35] time 0.171 (0.180) data 0.095 (0.103) loss_x loss_x 0.7368 (0.5045) acc_x 81.2500 (87.0536) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.6981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1117
clean true:1117
clean false:0
clean_rate:1.0
noisy true:151
noisy false:332
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 483
epoch [160/200] batch [5/34] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.3682 (0.3903) acc_x 87.5000 (88.7500) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/34] time 0.164 (0.178) data 0.087 (0.101) loss_x loss_x 0.5757 (0.4124) acc_x 81.2500 (88.1250) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/34] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.8511 (0.4410) acc_x 81.2500 (87.5000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/34] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.6875 (0.4405) acc_x 84.3750 (88.1250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/34] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.6465 (0.4682) acc_x 84.3750 (87.0000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/34] time 0.221 (0.180) data 0.144 (0.103) loss_x loss_x 0.9238 (0.4838) acc_x 84.3750 (87.1875) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.7100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1136
clean true:1136
clean false:0
clean_rate:1.0
noisy true:149
noisy false:315
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 464
epoch [161/200] batch [5/35] time 0.175 (0.165) data 0.098 (0.088) loss_x loss_x 0.5308 (0.5682) acc_x 78.1250 (83.7500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/35] time 0.197 (0.178) data 0.120 (0.101) loss_x loss_x 0.4319 (0.5546) acc_x 84.3750 (85.0000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/35] time 0.183 (0.177) data 0.107 (0.100) loss_x loss_x 0.4705 (0.5524) acc_x 90.6250 (84.5833) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/35] time 0.187 (0.177) data 0.111 (0.100) loss_x loss_x 0.7446 (0.5466) acc_x 84.3750 (84.6875) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/35] time 0.169 (0.177) data 0.093 (0.100) loss_x loss_x 0.6626 (0.5299) acc_x 84.3750 (85.6250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/35] time 0.167 (0.176) data 0.089 (0.099) loss_x loss_x 0.3545 (0.5272) acc_x 93.7500 (86.2500) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [35/35] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.6509 (0.5375) acc_x 90.6250 (86.3393) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.7025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1124
clean true:1124
clean false:0
clean_rate:1.0
noisy true:152
noisy false:324
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 476
epoch [162/200] batch [5/35] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.6519 (0.5662) acc_x 87.5000 (86.8750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/35] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.6055 (0.5589) acc_x 81.2500 (86.2500) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/35] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.5151 (0.5615) acc_x 84.3750 (84.3750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/35] time 0.167 (0.162) data 0.090 (0.085) loss_x loss_x 0.2068 (0.5716) acc_x 93.7500 (84.6875) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/35] time 0.195 (0.163) data 0.118 (0.086) loss_x loss_x 0.2698 (0.5627) acc_x 93.7500 (84.5000) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/35] time 0.159 (0.165) data 0.082 (0.088) loss_x loss_x 0.8628 (0.5617) acc_x 84.3750 (85.1042) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [35/35] time 0.168 (0.166) data 0.091 (0.089) loss_x loss_x 0.2832 (0.5596) acc_x 93.7500 (85.2679) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.7138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1142
clean true:1141
clean false:1
clean_rate:0.999124343257443
noisy true:149
noisy false:309
after delete: len(clean_dataset) 1142
after delete: len(noisy_dataset) 458
epoch [163/200] batch [5/35] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.1814 (0.4121) acc_x 100.0000 (91.2500) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/35] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.9849 (0.5095) acc_x 71.8750 (86.2500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/35] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.4602 (0.5543) acc_x 90.6250 (85.6250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/35] time 0.198 (0.184) data 0.121 (0.107) loss_x loss_x 0.3831 (0.5214) acc_x 90.6250 (85.9375) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/35] time 0.160 (0.182) data 0.083 (0.105) loss_x loss_x 0.3081 (0.5056) acc_x 96.8750 (86.8750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/35] time 0.161 (0.178) data 0.083 (0.101) loss_x loss_x 0.3879 (0.4930) acc_x 93.7500 (87.2917) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [35/35] time 0.162 (0.176) data 0.085 (0.098) loss_x loss_x 1.0986 (0.5146) acc_x 81.2500 (86.7857) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.7131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1141
clean true:1141
clean false:0
clean_rate:1.0
noisy true:153
noisy false:306
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 459
epoch [164/200] batch [5/35] time 0.192 (0.178) data 0.116 (0.101) loss_x loss_x 0.4062 (0.4311) acc_x 87.5000 (90.0000) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/35] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.3855 (0.4897) acc_x 93.7500 (87.5000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/35] time 0.189 (0.183) data 0.112 (0.106) loss_x loss_x 0.4746 (0.5278) acc_x 84.3750 (86.0417) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/35] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.7773 (0.5402) acc_x 75.0000 (85.6250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/35] time 0.180 (0.184) data 0.102 (0.107) loss_x loss_x 0.3518 (0.5177) acc_x 87.5000 (86.3750) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/35] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 0.4578 (0.5359) acc_x 78.1250 (85.8333) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [35/35] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.8789 (0.5560) acc_x 84.3750 (85.6250) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1114
clean true:1113
clean false:1
clean_rate:0.9991023339317774
noisy true:138
noisy false:348
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 486
epoch [165/200] batch [5/34] time 0.209 (0.180) data 0.133 (0.103) loss_x loss_x 0.4790 (0.4326) acc_x 90.6250 (88.1250) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/34] time 0.189 (0.183) data 0.112 (0.106) loss_x loss_x 0.5957 (0.4850) acc_x 90.6250 (86.2500) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/34] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.2448 (0.5274) acc_x 93.7500 (85.4167) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/34] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.4189 (0.4944) acc_x 84.3750 (86.2500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/34] time 0.190 (0.180) data 0.113 (0.103) loss_x loss_x 0.3723 (0.4917) acc_x 87.5000 (86.2500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/34] time 0.186 (0.181) data 0.110 (0.104) loss_x loss_x 0.5415 (0.5290) acc_x 87.5000 (85.8333) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.7031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1125
clean true:1124
clean false:1
clean_rate:0.9991111111111111
noisy true:149
noisy false:326
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 475
epoch [166/200] batch [5/35] time 0.170 (0.186) data 0.093 (0.110) loss_x loss_x 0.6367 (0.5423) acc_x 81.2500 (85.6250) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/35] time 0.163 (0.179) data 0.085 (0.102) loss_x loss_x 0.7070 (0.6162) acc_x 75.0000 (82.8125) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/35] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.6226 (0.6567) acc_x 87.5000 (83.1250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/35] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.1854 (0.6170) acc_x 93.7500 (84.3750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/35] time 0.179 (0.176) data 0.102 (0.100) loss_x loss_x 0.1571 (0.6105) acc_x 96.8750 (84.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/35] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.4043 (0.5872) acc_x 87.5000 (85.1042) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [35/35] time 0.194 (0.178) data 0.118 (0.101) loss_x loss_x 0.9507 (0.5818) acc_x 71.8750 (85.0000) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 303
confident_label rate tensor(0.7150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1144
clean true:1144
clean false:0
clean_rate:1.0
noisy true:153
noisy false:303
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 456
epoch [167/200] batch [5/35] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.3557 (0.3809) acc_x 90.6250 (90.6250) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/35] time 0.178 (0.186) data 0.100 (0.109) loss_x loss_x 0.5645 (0.5418) acc_x 87.5000 (87.1875) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/35] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.2654 (0.5274) acc_x 90.6250 (87.0833) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/35] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.5830 (0.5368) acc_x 87.5000 (86.5625) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/35] time 0.166 (0.183) data 0.088 (0.106) loss_x loss_x 0.2358 (0.5301) acc_x 90.6250 (86.5000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/35] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 0.4321 (0.5244) acc_x 87.5000 (86.9792) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [35/35] time 0.191 (0.181) data 0.114 (0.104) loss_x loss_x 0.4480 (0.5244) acc_x 87.5000 (86.9643) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.7000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:151
noisy false:329
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 480
epoch [168/200] batch [5/35] time 0.161 (0.164) data 0.084 (0.086) loss_x loss_x 0.4050 (0.6329) acc_x 87.5000 (81.2500) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/35] time 0.195 (0.177) data 0.118 (0.100) loss_x loss_x 0.8101 (0.5306) acc_x 81.2500 (85.3125) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/35] time 0.192 (0.181) data 0.114 (0.104) loss_x loss_x 0.3074 (0.5054) acc_x 93.7500 (86.4583) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/35] time 0.157 (0.179) data 0.081 (0.102) loss_x loss_x 0.2329 (0.4979) acc_x 93.7500 (87.1875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/35] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.4587 (0.5170) acc_x 84.3750 (86.3750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/35] time 0.168 (0.178) data 0.090 (0.101) loss_x loss_x 0.6689 (0.5153) acc_x 81.2500 (86.7708) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [35/35] time 0.197 (0.180) data 0.117 (0.103) loss_x loss_x 0.2576 (0.5075) acc_x 93.7500 (86.8750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1126
clean true:1126
clean false:0
clean_rate:1.0
noisy true:151
noisy false:323
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 474
epoch [169/200] batch [5/35] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.8525 (0.6777) acc_x 81.2500 (82.5000) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/35] time 0.162 (0.170) data 0.084 (0.093) loss_x loss_x 0.9287 (0.6623) acc_x 78.1250 (83.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/35] time 0.186 (0.171) data 0.108 (0.094) loss_x loss_x 0.3628 (0.5947) acc_x 90.6250 (85.0000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/35] time 0.189 (0.173) data 0.112 (0.096) loss_x loss_x 0.4182 (0.5437) acc_x 93.7500 (86.7188) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/35] time 0.198 (0.176) data 0.120 (0.099) loss_x loss_x 0.6602 (0.5739) acc_x 81.2500 (85.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/35] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 0.6606 (0.5652) acc_x 78.1250 (85.0000) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [35/35] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.5405 (0.5487) acc_x 84.3750 (85.6250) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 309
confident_label rate tensor(0.7188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1150
clean true:1150
clean false:0
clean_rate:1.0
noisy true:141
noisy false:309
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 450
epoch [170/200] batch [5/35] time 0.193 (0.177) data 0.116 (0.100) loss_x loss_x 1.1582 (0.4961) acc_x 75.0000 (86.8750) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [10/35] time 0.188 (0.181) data 0.111 (0.103) loss_x loss_x 0.6064 (0.5007) acc_x 87.5000 (87.1875) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/35] time 0.156 (0.179) data 0.079 (0.101) loss_x loss_x 0.5835 (0.4944) acc_x 87.5000 (87.0833) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/35] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.5908 (0.5205) acc_x 84.3750 (86.0938) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/35] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.3179 (0.5086) acc_x 90.6250 (86.1250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/35] time 0.167 (0.170) data 0.090 (0.093) loss_x loss_x 0.2810 (0.5006) acc_x 93.7500 (86.3542) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [35/35] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.3523 (0.5047) acc_x 93.7500 (86.0714) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.7037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1126
clean true:1126
clean false:0
clean_rate:1.0
noisy true:141
noisy false:333
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 474
epoch [171/200] batch [5/35] time 0.167 (0.171) data 0.090 (0.094) loss_x loss_x 0.2588 (0.3940) acc_x 93.7500 (88.7500) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/35] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 1.1191 (0.5479) acc_x 78.1250 (84.6875) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/35] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.4756 (0.5340) acc_x 84.3750 (84.7917) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/35] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 0.2141 (0.4989) acc_x 93.7500 (86.2500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/35] time 0.167 (0.174) data 0.090 (0.098) loss_x loss_x 0.4766 (0.5018) acc_x 87.5000 (86.2500) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/35] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.3662 (0.4983) acc_x 93.7500 (86.6667) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [35/35] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 1.0117 (0.5420) acc_x 81.2500 (85.8929) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:143
noisy false:336
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [172/200] batch [5/35] time 0.181 (0.187) data 0.105 (0.110) loss_x loss_x 0.4524 (0.4510) acc_x 93.7500 (88.7500) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/35] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.6152 (0.6146) acc_x 81.2500 (83.1250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/35] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.4707 (0.5724) acc_x 87.5000 (85.0000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/35] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 1.0479 (0.6141) acc_x 75.0000 (84.0625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/35] time 0.173 (0.185) data 0.096 (0.108) loss_x loss_x 0.3457 (0.6248) acc_x 90.6250 (84.0000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/35] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6396 (0.5902) acc_x 81.2500 (84.7917) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [35/35] time 0.201 (0.185) data 0.125 (0.108) loss_x loss_x 0.3113 (0.5820) acc_x 93.7500 (85.3571) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.6969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1115
clean true:1115
clean false:0
clean_rate:1.0
noisy true:153
noisy false:332
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 485
epoch [173/200] batch [5/34] time 0.172 (0.188) data 0.095 (0.111) loss_x loss_x 0.2839 (0.6557) acc_x 90.6250 (82.5000) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [10/34] time 0.193 (0.186) data 0.116 (0.109) loss_x loss_x 1.0703 (0.6074) acc_x 78.1250 (84.3750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/34] time 0.180 (0.187) data 0.103 (0.110) loss_x loss_x 0.7778 (0.6154) acc_x 81.2500 (85.0000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/34] time 0.181 (0.187) data 0.104 (0.110) loss_x loss_x 0.9863 (0.5946) acc_x 75.0000 (85.1562) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/34] time 0.164 (0.182) data 0.088 (0.105) loss_x loss_x 0.2917 (0.5689) acc_x 87.5000 (85.1250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/34] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.4629 (0.5544) acc_x 87.5000 (85.5208) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1134
clean false:1
clean_rate:0.9991189427312775
noisy true:150
noisy false:315
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [174/200] batch [5/35] time 0.177 (0.181) data 0.099 (0.104) loss_x loss_x 0.3804 (0.4499) acc_x 87.5000 (86.2500) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/35] time 0.163 (0.177) data 0.085 (0.099) loss_x loss_x 0.5991 (0.5129) acc_x 81.2500 (86.5625) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/35] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.7251 (0.5556) acc_x 84.3750 (85.4167) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/35] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.6387 (0.5802) acc_x 84.3750 (85.4688) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/35] time 0.179 (0.177) data 0.103 (0.100) loss_x loss_x 0.6035 (0.5472) acc_x 84.3750 (85.8750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/35] time 0.163 (0.178) data 0.086 (0.101) loss_x loss_x 0.4929 (0.5205) acc_x 90.6250 (86.4583) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [35/35] time 0.170 (0.176) data 0.094 (0.099) loss_x loss_x 0.6348 (0.5062) acc_x 81.2500 (86.7857) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 307
confident_label rate tensor(0.7175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1148
clean true:1147
clean false:1
clean_rate:0.9991289198606271
noisy true:146
noisy false:306
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 452
epoch [175/200] batch [5/35] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.4021 (0.4546) acc_x 90.6250 (87.5000) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/35] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.3340 (0.4964) acc_x 90.6250 (87.8125) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/35] time 0.179 (0.177) data 0.102 (0.100) loss_x loss_x 0.3755 (0.4774) acc_x 93.7500 (88.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/35] time 0.161 (0.176) data 0.085 (0.099) loss_x loss_x 0.6689 (0.4783) acc_x 81.2500 (88.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/35] time 0.161 (0.173) data 0.085 (0.096) loss_x loss_x 0.5278 (0.4611) acc_x 84.3750 (88.7500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/35] time 0.159 (0.171) data 0.082 (0.094) loss_x loss_x 0.4583 (0.4752) acc_x 84.3750 (87.9167) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [35/35] time 0.164 (0.171) data 0.086 (0.094) loss_x loss_x 0.5918 (0.4987) acc_x 81.2500 (87.3214) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 299
confident_label rate tensor(0.7125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1140
clean true:1140
clean false:0
clean_rate:1.0
noisy true:161
noisy false:299
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 460
epoch [176/200] batch [5/35] time 0.186 (0.187) data 0.109 (0.111) loss_x loss_x 0.4082 (0.5248) acc_x 90.6250 (86.2500) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/35] time 0.239 (0.190) data 0.162 (0.114) loss_x loss_x 1.0635 (0.6358) acc_x 71.8750 (82.5000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/35] time 0.189 (0.189) data 0.112 (0.112) loss_x loss_x 0.7642 (0.5942) acc_x 81.2500 (84.5833) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/35] time 0.170 (0.186) data 0.093 (0.109) loss_x loss_x 0.5381 (0.5764) acc_x 84.3750 (85.0000) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/35] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.5259 (0.5555) acc_x 87.5000 (85.2500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/35] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 1.1064 (0.5783) acc_x 78.1250 (85.1042) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [35/35] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.4829 (0.5665) acc_x 90.6250 (85.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1133
clean true:1133
clean false:0
clean_rate:1.0
noisy true:151
noisy false:316
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 467
epoch [177/200] batch [5/35] time 0.160 (0.182) data 0.084 (0.105) loss_x loss_x 0.3269 (0.4215) acc_x 93.7500 (88.7500) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/35] time 0.169 (0.174) data 0.091 (0.097) loss_x loss_x 0.3838 (0.5014) acc_x 87.5000 (85.9375) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/35] time 0.185 (0.176) data 0.108 (0.098) loss_x loss_x 0.7451 (0.5475) acc_x 81.2500 (85.8333) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/35] time 0.185 (0.178) data 0.107 (0.101) loss_x loss_x 0.7378 (0.5417) acc_x 81.2500 (86.0938) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/35] time 0.191 (0.180) data 0.113 (0.103) loss_x loss_x 0.8149 (0.5660) acc_x 78.1250 (84.7500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/35] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.6382 (0.5455) acc_x 84.3750 (85.6250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [35/35] time 0.189 (0.179) data 0.110 (0.102) loss_x loss_x 0.3252 (0.5322) acc_x 93.7500 (86.3393) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.7019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1123
clean true:1123
clean false:0
clean_rate:1.0
noisy true:154
noisy false:323
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 477
epoch [178/200] batch [5/35] time 0.187 (0.193) data 0.109 (0.116) loss_x loss_x 0.5166 (0.4202) acc_x 87.5000 (86.8750) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/35] time 0.179 (0.186) data 0.102 (0.109) loss_x loss_x 0.3291 (0.4344) acc_x 90.6250 (87.5000) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/35] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4531 (0.4045) acc_x 84.3750 (88.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/35] time 0.169 (0.183) data 0.091 (0.106) loss_x loss_x 0.7002 (0.5090) acc_x 87.5000 (86.0938) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/35] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 0.8677 (0.5106) acc_x 75.0000 (86.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/35] time 0.175 (0.179) data 0.097 (0.101) loss_x loss_x 0.5830 (0.5174) acc_x 87.5000 (86.1458) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [35/35] time 0.166 (0.181) data 0.089 (0.104) loss_x loss_x 0.2935 (0.5225) acc_x 93.7500 (85.8036) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 286
confident_label rate tensor(0.7225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1156
clean true:1156
clean false:0
clean_rate:1.0
noisy true:158
noisy false:286
after delete: len(clean_dataset) 1156
after delete: len(noisy_dataset) 444
epoch [179/200] batch [5/36] time 0.172 (0.189) data 0.095 (0.111) loss_x loss_x 0.7217 (0.5007) acc_x 81.2500 (87.5000) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/36] time 0.167 (0.183) data 0.090 (0.106) loss_x loss_x 0.5396 (0.5433) acc_x 81.2500 (85.9375) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/36] time 0.182 (0.181) data 0.104 (0.103) loss_x loss_x 0.6392 (0.5579) acc_x 78.1250 (85.8333) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/36] time 0.173 (0.181) data 0.097 (0.103) loss_x loss_x 0.6118 (0.5714) acc_x 78.1250 (85.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/36] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.3013 (0.5651) acc_x 93.7500 (85.6250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/36] time 0.230 (0.182) data 0.153 (0.105) loss_x loss_x 0.5708 (0.5366) acc_x 90.6250 (86.5625) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [35/36] time 0.193 (0.184) data 0.117 (0.107) loss_x loss_x 0.6309 (0.5342) acc_x 84.3750 (86.6964) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.6975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1116
clean true:1116
clean false:0
clean_rate:1.0
noisy true:151
noisy false:333
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 484
epoch [180/200] batch [5/34] time 0.166 (0.171) data 0.089 (0.094) loss_x loss_x 0.3313 (0.5313) acc_x 87.5000 (85.0000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/34] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.5215 (0.4753) acc_x 87.5000 (86.2500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/34] time 0.192 (0.166) data 0.115 (0.089) loss_x loss_x 0.7456 (0.5463) acc_x 81.2500 (85.2083) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/34] time 0.194 (0.170) data 0.117 (0.093) loss_x loss_x 0.3318 (0.5235) acc_x 87.5000 (85.1562) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/34] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.7305 (0.5037) acc_x 81.2500 (85.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/34] time 0.197 (0.174) data 0.120 (0.097) loss_x loss_x 0.2888 (0.4817) acc_x 93.7500 (86.5625) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 298
confident_label rate tensor(0.7181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1149
clean true:1149
clean false:0
clean_rate:1.0
noisy true:153
noisy false:298
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 451
epoch [181/200] batch [5/35] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.4583 (0.6790) acc_x 90.6250 (82.5000) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/35] time 0.182 (0.180) data 0.104 (0.103) loss_x loss_x 0.6143 (0.5784) acc_x 87.5000 (85.3125) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/35] time 0.159 (0.177) data 0.083 (0.100) loss_x loss_x 0.6597 (0.5721) acc_x 84.3750 (85.2083) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/35] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.5552 (0.5550) acc_x 81.2500 (85.7812) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/35] time 0.159 (0.171) data 0.082 (0.094) loss_x loss_x 0.2544 (0.5203) acc_x 93.7500 (87.0000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/35] time 0.158 (0.169) data 0.081 (0.092) loss_x loss_x 0.4783 (0.5251) acc_x 87.5000 (86.8750) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [35/35] time 0.161 (0.168) data 0.083 (0.091) loss_x loss_x 0.4043 (0.5149) acc_x 90.6250 (86.9643) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 337
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:142
noisy false:336
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [182/200] batch [5/35] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6606 (0.6275) acc_x 87.5000 (84.3750) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/35] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.4670 (0.6267) acc_x 84.3750 (83.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/35] time 0.251 (0.190) data 0.174 (0.112) loss_x loss_x 0.2413 (0.5534) acc_x 93.7500 (86.2500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/35] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.5591 (0.5297) acc_x 87.5000 (86.5625) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/35] time 0.190 (0.186) data 0.112 (0.109) loss_x loss_x 0.3833 (0.5261) acc_x 87.5000 (86.6250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/35] time 0.232 (0.188) data 0.155 (0.111) loss_x loss_x 0.4976 (0.5306) acc_x 84.3750 (86.1458) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [35/35] time 0.156 (0.188) data 0.079 (0.111) loss_x loss_x 0.5820 (0.5196) acc_x 87.5000 (86.4286) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 303
confident_label rate tensor(0.7138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1142
clean true:1141
clean false:1
clean_rate:0.999124343257443
noisy true:156
noisy false:302
after delete: len(clean_dataset) 1142
after delete: len(noisy_dataset) 458
epoch [183/200] batch [5/35] time 0.178 (0.179) data 0.100 (0.102) loss_x loss_x 0.2152 (0.5010) acc_x 93.7500 (83.7500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/35] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.4651 (0.5244) acc_x 87.5000 (84.6875) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/35] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.6157 (0.5656) acc_x 78.1250 (83.9583) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/35] time 0.188 (0.183) data 0.110 (0.106) loss_x loss_x 0.5308 (0.5475) acc_x 87.5000 (84.2188) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/35] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.3455 (0.5335) acc_x 90.6250 (85.2500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/35] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.7700 (0.5351) acc_x 81.2500 (85.6250) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [35/35] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.4856 (0.5399) acc_x 87.5000 (85.8036) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 288
confident_label rate tensor(0.7262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1162
clean true:1162
clean false:0
clean_rate:1.0
noisy true:150
noisy false:288
after delete: len(clean_dataset) 1162
after delete: len(noisy_dataset) 438
epoch [184/200] batch [5/36] time 0.255 (0.226) data 0.178 (0.149) loss_x loss_x 0.4104 (0.6597) acc_x 87.5000 (83.1250) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [10/36] time 0.186 (0.219) data 0.109 (0.142) loss_x loss_x 0.5415 (0.5702) acc_x 90.6250 (85.6250) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [15/36] time 0.190 (0.208) data 0.111 (0.131) loss_x loss_x 0.4915 (0.5471) acc_x 90.6250 (85.8333) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [20/36] time 0.187 (0.203) data 0.110 (0.126) loss_x loss_x 0.5806 (0.5406) acc_x 81.2500 (86.2500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [25/36] time 0.180 (0.199) data 0.103 (0.122) loss_x loss_x 0.5186 (0.5440) acc_x 84.3750 (86.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/36] time 0.176 (0.197) data 0.100 (0.120) loss_x loss_x 0.5479 (0.5388) acc_x 90.6250 (86.4583) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [35/36] time 0.181 (0.195) data 0.105 (0.118) loss_x loss_x 0.5933 (0.5657) acc_x 87.5000 (86.2500) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 315
confident_label rate tensor(0.7094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1135
clean true:1135
clean false:0
clean_rate:1.0
noisy true:150
noisy false:315
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 465
epoch [185/200] batch [5/35] time 0.164 (0.162) data 0.087 (0.085) loss_x loss_x 0.0853 (0.3264) acc_x 100.0000 (90.6250) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/35] time 0.159 (0.161) data 0.082 (0.085) loss_x loss_x 0.4851 (0.5177) acc_x 81.2500 (85.0000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/35] time 0.165 (0.162) data 0.088 (0.085) loss_x loss_x 0.5830 (0.5024) acc_x 81.2500 (85.2083) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/35] time 0.160 (0.162) data 0.084 (0.085) loss_x loss_x 0.5117 (0.4841) acc_x 81.2500 (85.4688) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/35] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.8716 (0.4975) acc_x 84.3750 (85.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/35] time 0.157 (0.163) data 0.079 (0.086) loss_x loss_x 0.3552 (0.4975) acc_x 90.6250 (85.9375) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [35/35] time 0.161 (0.163) data 0.083 (0.086) loss_x loss_x 0.5024 (0.5175) acc_x 87.5000 (85.5357) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 317
confident_label rate tensor(0.7075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1132
clean true:1132
clean false:0
clean_rate:1.0
noisy true:151
noisy false:317
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 468
epoch [186/200] batch [5/35] time 0.159 (0.162) data 0.082 (0.085) loss_x loss_x 0.4395 (0.5274) acc_x 84.3750 (85.0000) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/35] time 0.162 (0.162) data 0.086 (0.085) loss_x loss_x 0.5356 (0.5545) acc_x 87.5000 (85.6250) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/35] time 0.157 (0.160) data 0.081 (0.083) loss_x loss_x 0.5825 (0.5482) acc_x 81.2500 (85.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/35] time 0.162 (0.160) data 0.085 (0.083) loss_x loss_x 0.7114 (0.5596) acc_x 78.1250 (85.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/35] time 0.162 (0.160) data 0.086 (0.084) loss_x loss_x 0.2396 (0.5249) acc_x 96.8750 (86.3750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/35] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.7427 (0.5438) acc_x 84.3750 (85.9375) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [35/35] time 0.158 (0.160) data 0.080 (0.083) loss_x loss_x 0.6548 (0.5420) acc_x 84.3750 (86.2500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 306
confident_label rate tensor(0.7138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1142
clean true:1142
clean false:0
clean_rate:1.0
noisy true:152
noisy false:306
after delete: len(clean_dataset) 1142
after delete: len(noisy_dataset) 458
epoch [187/200] batch [5/35] time 0.159 (0.161) data 0.082 (0.083) loss_x loss_x 0.2433 (0.4948) acc_x 93.7500 (87.5000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/35] time 0.167 (0.161) data 0.090 (0.084) loss_x loss_x 0.7466 (0.5769) acc_x 81.2500 (85.0000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/35] time 0.174 (0.165) data 0.097 (0.088) loss_x loss_x 0.5015 (0.5192) acc_x 84.3750 (86.4583) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/35] time 0.157 (0.164) data 0.080 (0.087) loss_x loss_x 0.2028 (0.5351) acc_x 96.8750 (86.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/35] time 0.161 (0.163) data 0.083 (0.087) loss_x loss_x 0.4402 (0.5257) acc_x 87.5000 (86.6250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/35] time 0.156 (0.163) data 0.079 (0.086) loss_x loss_x 0.9751 (0.5345) acc_x 75.0000 (86.2500) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [35/35] time 0.156 (0.162) data 0.079 (0.085) loss_x loss_x 0.2903 (0.5166) acc_x 90.6250 (86.7857) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 310
confident_label rate tensor(0.7113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1138
clean true:1138
clean false:0
clean_rate:1.0
noisy true:152
noisy false:310
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 462
epoch [188/200] batch [5/35] time 0.157 (0.163) data 0.080 (0.086) loss_x loss_x 0.4097 (0.4773) acc_x 84.3750 (86.8750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/35] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.4812 (0.5225) acc_x 84.3750 (85.6250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/35] time 0.162 (0.161) data 0.085 (0.085) loss_x loss_x 0.7671 (0.5369) acc_x 75.0000 (85.6250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/35] time 0.159 (0.162) data 0.082 (0.085) loss_x loss_x 0.7583 (0.5441) acc_x 84.3750 (84.8438) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/35] time 0.160 (0.161) data 0.084 (0.084) loss_x loss_x 0.9761 (0.5732) acc_x 81.2500 (84.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/35] time 0.163 (0.161) data 0.086 (0.084) loss_x loss_x 0.5337 (0.5744) acc_x 78.1250 (84.1667) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [35/35] time 0.157 (0.161) data 0.080 (0.084) loss_x loss_x 0.4939 (0.5555) acc_x 87.5000 (84.4643) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 305
confident_label rate tensor(0.7169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1147
clean true:1147
clean false:0
clean_rate:1.0
noisy true:148
noisy false:305
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 453
epoch [189/200] batch [5/35] time 0.166 (0.181) data 0.089 (0.105) loss_x loss_x 0.2191 (0.5123) acc_x 93.7500 (88.7500) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/35] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.3831 (0.5007) acc_x 96.8750 (88.7500) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/35] time 0.182 (0.171) data 0.104 (0.094) loss_x loss_x 0.2524 (0.5212) acc_x 96.8750 (87.9167) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/35] time 0.162 (0.171) data 0.086 (0.094) loss_x loss_x 0.7705 (0.5323) acc_x 84.3750 (87.6562) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/35] time 0.158 (0.169) data 0.081 (0.092) loss_x loss_x 0.9048 (0.5376) acc_x 75.0000 (86.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/35] time 0.160 (0.167) data 0.083 (0.090) loss_x loss_x 0.8657 (0.5655) acc_x 84.3750 (85.8333) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [35/35] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.4211 (0.5517) acc_x 87.5000 (85.8036) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:154
noisy false:325
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 479
epoch [190/200] batch [5/35] time 0.167 (0.167) data 0.090 (0.090) loss_x loss_x 0.3682 (0.4415) acc_x 90.6250 (88.7500) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/35] time 0.181 (0.171) data 0.103 (0.094) loss_x loss_x 0.5454 (0.5455) acc_x 81.2500 (85.3125) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/35] time 0.172 (0.172) data 0.094 (0.095) loss_x loss_x 0.7236 (0.5349) acc_x 78.1250 (86.0417) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/35] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.8774 (0.5142) acc_x 65.6250 (85.6250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/35] time 0.164 (0.169) data 0.086 (0.092) loss_x loss_x 0.3823 (0.4990) acc_x 87.5000 (85.7500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/35] time 0.157 (0.168) data 0.081 (0.091) loss_x loss_x 0.4143 (0.4942) acc_x 84.3750 (85.9375) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [35/35] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 0.4839 (0.5124) acc_x 87.5000 (85.5357) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 312
confident_label rate tensor(0.7088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1134
clean true:1134
clean false:0
clean_rate:1.0
noisy true:154
noisy false:312
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 466
epoch [191/200] batch [5/35] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.7290 (0.4962) acc_x 90.6250 (88.7500) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/35] time 0.162 (0.162) data 0.085 (0.084) loss_x loss_x 0.4331 (0.5396) acc_x 84.3750 (85.6250) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/35] time 0.161 (0.162) data 0.084 (0.084) loss_x loss_x 0.4875 (0.5146) acc_x 87.5000 (85.8333) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/35] time 0.165 (0.162) data 0.087 (0.085) loss_x loss_x 0.4263 (0.5340) acc_x 90.6250 (85.4688) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/35] time 0.160 (0.162) data 0.082 (0.084) loss_x loss_x 0.8081 (0.5322) acc_x 71.8750 (85.1250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/35] time 0.163 (0.162) data 0.085 (0.085) loss_x loss_x 0.2311 (0.5167) acc_x 96.8750 (85.6250) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [35/35] time 0.161 (0.162) data 0.083 (0.084) loss_x loss_x 0.3621 (0.5022) acc_x 93.7500 (86.2500) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.7012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:145
noisy false:333
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 478
epoch [192/200] batch [5/35] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.4546 (0.4755) acc_x 87.5000 (87.5000) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/35] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.7197 (0.5002) acc_x 81.2500 (85.9375) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/35] time 0.161 (0.161) data 0.084 (0.083) loss_x loss_x 0.4016 (0.5124) acc_x 90.6250 (85.8333) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/35] time 0.177 (0.166) data 0.099 (0.089) loss_x loss_x 0.8638 (0.5004) acc_x 78.1250 (86.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/35] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.4346 (0.4991) acc_x 93.7500 (87.0000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/35] time 0.156 (0.165) data 0.078 (0.088) loss_x loss_x 0.3013 (0.4817) acc_x 90.6250 (87.3958) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [35/35] time 0.155 (0.164) data 0.078 (0.087) loss_x loss_x 1.2021 (0.5225) acc_x 78.1250 (86.5179) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 330
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1119
clean false:0
clean_rate:1.0
noisy true:151
noisy false:330
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [193/200] batch [5/34] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.4468 (0.4444) acc_x 84.3750 (88.1250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/34] time 0.163 (0.162) data 0.085 (0.084) loss_x loss_x 0.2786 (0.3944) acc_x 90.6250 (89.3750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/34] time 0.163 (0.162) data 0.086 (0.084) loss_x loss_x 0.4902 (0.4689) acc_x 90.6250 (87.5000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/34] time 0.160 (0.162) data 0.083 (0.084) loss_x loss_x 0.7388 (0.4765) acc_x 81.2500 (87.6562) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/34] time 0.157 (0.162) data 0.079 (0.084) loss_x loss_x 0.5273 (0.4895) acc_x 81.2500 (86.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/34] time 0.162 (0.161) data 0.085 (0.084) loss_x loss_x 1.2432 (0.5170) acc_x 81.2500 (86.4583) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.7037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1126
clean true:1125
clean false:1
clean_rate:0.9991119005328597
noisy true:150
noisy false:324
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 474
epoch [194/200] batch [5/35] time 0.159 (0.161) data 0.083 (0.084) loss_x loss_x 0.6602 (0.7501) acc_x 81.2500 (83.7500) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/35] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.3894 (0.6573) acc_x 93.7500 (85.0000) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/35] time 0.160 (0.160) data 0.083 (0.084) loss_x loss_x 0.3489 (0.5507) acc_x 93.7500 (87.0833) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/35] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.3325 (0.5255) acc_x 90.6250 (87.3438) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/35] time 0.157 (0.160) data 0.080 (0.083) loss_x loss_x 0.3948 (0.5412) acc_x 87.5000 (87.0000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/35] time 0.164 (0.160) data 0.087 (0.083) loss_x loss_x 0.7285 (0.5598) acc_x 78.1250 (86.2500) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [35/35] time 0.180 (0.160) data 0.103 (0.084) loss_x loss_x 0.4126 (0.5555) acc_x 84.3750 (85.6250) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.7050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1128
clean true:1128
clean false:0
clean_rate:1.0
noisy true:143
noisy false:329
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 472
epoch [195/200] batch [5/35] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.5210 (0.4619) acc_x 87.5000 (90.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/35] time 0.165 (0.160) data 0.088 (0.083) loss_x loss_x 0.8086 (0.5511) acc_x 78.1250 (87.1875) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/35] time 0.162 (0.160) data 0.084 (0.083) loss_x loss_x 1.0361 (0.5922) acc_x 68.7500 (86.0417) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/35] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.2169 (0.5367) acc_x 93.7500 (86.7188) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/35] time 0.179 (0.161) data 0.102 (0.084) loss_x loss_x 0.8110 (0.5491) acc_x 84.3750 (86.7500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/35] time 0.162 (0.164) data 0.085 (0.087) loss_x loss_x 0.2688 (0.5479) acc_x 90.6250 (86.5625) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [35/35] time 0.164 (0.163) data 0.088 (0.086) loss_x loss_x 0.6274 (0.5470) acc_x 78.1250 (86.1607) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.6812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1090
clean true:1089
clean false:1
clean_rate:0.9990825688073395
noisy true:144
noisy false:366
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 510
epoch [196/200] batch [5/34] time 0.158 (0.159) data 0.080 (0.082) loss_x loss_x 0.4368 (0.4199) acc_x 90.6250 (88.1250) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/34] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.5322 (0.5013) acc_x 84.3750 (85.6250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/34] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.3611 (0.4991) acc_x 93.7500 (85.8333) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/34] time 0.159 (0.160) data 0.081 (0.083) loss_x loss_x 0.6567 (0.4947) acc_x 81.2500 (85.4688) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/34] time 0.160 (0.160) data 0.083 (0.082) loss_x loss_x 0.2986 (0.4661) acc_x 96.8750 (87.1250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/34] time 0.161 (0.160) data 0.084 (0.082) loss_x loss_x 0.9116 (0.5004) acc_x 75.0000 (86.2500) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 316
confident_label rate tensor(0.7075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:153
noisy false:315
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 468
epoch [197/200] batch [5/35] time 0.156 (0.158) data 0.078 (0.080) loss_x loss_x 0.3059 (0.6976) acc_x 93.7500 (85.0000) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/35] time 0.161 (0.159) data 0.083 (0.082) loss_x loss_x 0.6055 (0.6030) acc_x 84.3750 (85.6250) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/35] time 0.158 (0.159) data 0.080 (0.082) loss_x loss_x 0.6963 (0.5938) acc_x 84.3750 (85.0000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/35] time 0.159 (0.159) data 0.082 (0.081) loss_x loss_x 0.4351 (0.5923) acc_x 87.5000 (84.6875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/35] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.6626 (0.5873) acc_x 81.2500 (84.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/35] time 0.157 (0.159) data 0.079 (0.082) loss_x loss_x 0.4802 (0.5632) acc_x 84.3750 (84.7917) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [35/35] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.6743 (0.5539) acc_x 84.3750 (85.1786) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 325
confident_label rate tensor(0.6994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1119
clean true:1117
clean false:2
clean_rate:0.998212689901698
noisy true:158
noisy false:323
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 481
epoch [198/200] batch [5/34] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.3054 (0.5745) acc_x 93.7500 (88.7500) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/34] time 0.156 (0.161) data 0.079 (0.084) loss_x loss_x 0.5430 (0.6072) acc_x 81.2500 (84.6875) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/34] time 0.154 (0.160) data 0.077 (0.083) loss_x loss_x 0.8979 (0.6523) acc_x 78.1250 (82.7083) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/34] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.2607 (0.6430) acc_x 93.7500 (82.3438) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/34] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.4761 (0.6142) acc_x 90.6250 (83.1250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/34] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.5815 (0.6005) acc_x 90.6250 (84.1667) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:156
noisy false:343
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 499
epoch [199/200] batch [5/34] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.4629 (0.5783) acc_x 87.5000 (85.6250) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/34] time 0.156 (0.156) data 0.079 (0.079) loss_x loss_x 0.1543 (0.5257) acc_x 96.8750 (86.5625) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/34] time 0.158 (0.156) data 0.081 (0.079) loss_x loss_x 0.4141 (0.5138) acc_x 90.6250 (85.6250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/34] time 0.158 (0.157) data 0.080 (0.080) loss_x loss_x 0.5005 (0.4884) acc_x 87.5000 (86.5625) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/34] time 0.153 (0.156) data 0.076 (0.079) loss_x loss_x 0.7080 (0.5305) acc_x 81.2500 (86.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/34] time 0.159 (0.157) data 0.081 (0.080) loss_x loss_x 0.3108 (0.5297) acc_x 90.6250 (86.2500) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 300
confident_label rate tensor(0.7169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 1147
clean true:1147
clean false:0
clean_rate:1.0
noisy true:153
noisy false:300
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 453
epoch [200/200] batch [5/35] time 0.161 (0.162) data 0.083 (0.085) loss_x loss_x 0.6445 (0.6546) acc_x 90.6250 (83.1250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/35] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.2976 (0.5161) acc_x 90.6250 (85.6250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/35] time 0.156 (0.160) data 0.079 (0.083) loss_x loss_x 0.9185 (0.5300) acc_x 75.0000 (85.4167) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/35] time 0.163 (0.160) data 0.086 (0.083) loss_x loss_x 0.3672 (0.5193) acc_x 93.7500 (85.9375) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/35] time 0.170 (0.161) data 0.093 (0.084) loss_x loss_x 0.2656 (0.4964) acc_x 96.8750 (86.6250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/35] time 0.156 (0.161) data 0.079 (0.083) loss_x loss_x 0.3716 (0.4865) acc_x 93.7500 (87.0833) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [35/35] time 0.154 (0.160) data 0.077 (0.083) loss_x loss_x 0.5830 (0.5039) acc_x 84.3750 (86.6964) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,251
* accuracy: 91.3%
* error: 8.7%
* macro_f1: 87.2%
Elapsed: 0:48:26
