***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 847
confident_label rate tensor(0.2987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 478
clean true:469
clean false:9
clean_rate:0.9811715481171548
noisy true:284
noisy false:838
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1122
epoch [1/200] batch [5/14] time 0.175 (0.199) data 0.098 (0.103) loss_x loss_x 2.5547 (2.6871) acc_x 56.2500 (61.2500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/14] time 0.179 (0.187) data 0.102 (0.101) loss_x loss_x 2.1719 (2.5125) acc_x 65.6250 (64.6875) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 722
confident_label rate tensor(0.3481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 557
clean true:551
clean false:6
clean_rate:0.9892280071813285
noisy true:327
noisy false:716
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1043
epoch [2/200] batch [5/17] time 0.184 (0.173) data 0.107 (0.097) loss_x loss_x 0.6440 (1.1638) acc_x 78.1250 (69.3750) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/17] time 0.159 (0.169) data 0.081 (0.092) loss_x loss_x 1.3350 (1.1249) acc_x 68.7500 (72.5000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/17] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.7759 (1.0555) acc_x 84.3750 (74.3750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 538
confident_label rate tensor(0.4244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 679
clean true:675
clean false:4
clean_rate:0.9941089837997055
noisy true:387
noisy false:534
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 921
epoch [3/200] batch [5/21] time 0.161 (0.161) data 0.085 (0.084) loss_x loss_x 0.8887 (1.1034) acc_x 78.1250 (73.1250) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/21] time 0.161 (0.161) data 0.085 (0.084) loss_x loss_x 1.2988 (0.9644) acc_x 62.5000 (74.3750) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/21] time 0.166 (0.164) data 0.090 (0.088) loss_x loss_x 1.5264 (0.9824) acc_x 59.3750 (73.9583) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [20/21] time 0.199 (0.167) data 0.121 (0.091) loss_x loss_x 1.1416 (0.9526) acc_x 75.0000 (74.6875) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 521
confident_label rate tensor(0.4312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 690
clean true:685
clean false:5
clean_rate:0.9927536231884058
noisy true:394
noisy false:516
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 910
epoch [4/200] batch [5/21] time 0.158 (0.176) data 0.082 (0.099) loss_x loss_x 1.0039 (0.9329) acc_x 75.0000 (76.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/21] time 0.159 (0.167) data 0.082 (0.091) loss_x loss_x 1.3594 (0.9397) acc_x 75.0000 (77.1875) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/21] time 0.159 (0.164) data 0.082 (0.087) loss_x loss_x 1.1133 (0.9063) acc_x 62.5000 (77.2917) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [20/21] time 0.165 (0.166) data 0.088 (0.089) loss_x loss_x 0.9771 (0.9034) acc_x 75.0000 (76.8750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 524
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 692
clean true:688
clean false:4
clean_rate:0.9942196531791907
noisy true:388
noisy false:520
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 908
epoch [5/200] batch [5/21] time 0.180 (0.174) data 0.104 (0.097) loss_x loss_x 1.1465 (0.8587) acc_x 71.8750 (78.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/21] time 0.193 (0.178) data 0.116 (0.101) loss_x loss_x 0.9316 (0.8330) acc_x 78.1250 (80.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/21] time 0.185 (0.180) data 0.107 (0.103) loss_x loss_x 1.4229 (0.8488) acc_x 59.3750 (78.5417) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/21] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.7690 (0.8167) acc_x 84.3750 (79.5312) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 513
confident_label rate tensor(0.4300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 688
clean true:682
clean false:6
clean_rate:0.9912790697674418
noisy true:405
noisy false:507
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 912
epoch [6/200] batch [5/21] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.7349 (1.0390) acc_x 78.1250 (73.7500) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/21] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 1.0098 (0.9328) acc_x 75.0000 (75.0000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/21] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.8623 (0.8813) acc_x 75.0000 (76.0417) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/21] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.6196 (0.8576) acc_x 84.3750 (77.1875) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 506
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 694
clean true:689
clean false:5
clean_rate:0.9927953890489913
noisy true:405
noisy false:501
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 906
epoch [7/200] batch [5/21] time 0.160 (0.174) data 0.082 (0.097) loss_x loss_x 0.6880 (0.7601) acc_x 81.2500 (80.0000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/21] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.6831 (0.8075) acc_x 75.0000 (76.5625) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/21] time 0.170 (0.179) data 0.094 (0.102) loss_x loss_x 0.4319 (0.7848) acc_x 84.3750 (76.8750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/21] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 1.0879 (0.8041) acc_x 65.6250 (75.7812) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.4356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 697
clean true:695
clean false:2
clean_rate:0.9971305595408895
noisy true:423
noisy false:480
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 903
epoch [8/200] batch [5/21] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.5474 (0.5589) acc_x 81.2500 (83.7500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/21] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.6123 (0.6958) acc_x 84.3750 (80.6250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/21] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.7793 (0.7112) acc_x 84.3750 (80.6250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/21] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.4412 (0.7452) acc_x 87.5000 (79.6875) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.4569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 731
clean true:724
clean false:7
clean_rate:0.9904240766073872
noisy true:415
noisy false:454
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 869
epoch [9/200] batch [5/22] time 0.167 (0.176) data 0.090 (0.099) loss_x loss_x 0.9922 (0.7050) acc_x 81.2500 (81.8750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/22] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.6182 (0.7970) acc_x 81.2500 (80.0000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/22] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.5508 (0.8195) acc_x 84.3750 (79.7917) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/22] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.7607 (0.8062) acc_x 81.2500 (80.3125) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 701
clean true:695
clean false:6
clean_rate:0.9914407988587732
noisy true:411
noisy false:488
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 899
epoch [10/200] batch [5/21] time 0.174 (0.182) data 0.096 (0.105) loss_x loss_x 0.5576 (0.6171) acc_x 81.2500 (82.5000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/21] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 1.1758 (0.6874) acc_x 68.7500 (80.9375) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/21] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 1.3223 (0.7271) acc_x 62.5000 (80.0000) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/21] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.9590 (0.7539) acc_x 68.7500 (79.0625) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 499
confident_label rate tensor(0.4300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 688
clean true:683
clean false:5
clean_rate:0.9927325581395349
noisy true:418
noisy false:494
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 912
epoch [11/200] batch [5/21] time 0.173 (0.167) data 0.097 (0.090) loss_x loss_x 0.3979 (0.6197) acc_x 87.5000 (85.0000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/21] time 0.208 (0.176) data 0.132 (0.100) loss_x loss_x 0.8833 (0.7029) acc_x 78.1250 (81.2500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/21] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.5825 (0.7091) acc_x 87.5000 (80.8333) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/21] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.6138 (0.7243) acc_x 84.3750 (80.3125) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.4606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 737
clean true:736
clean false:1
clean_rate:0.9986431478968792
noisy true:419
noisy false:444
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 863
epoch [12/200] batch [5/23] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.7568 (0.6655) acc_x 71.8750 (81.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/23] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.3684 (0.6764) acc_x 90.6250 (80.6250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/23] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.8188 (0.6885) acc_x 81.2500 (80.6250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/23] time 0.171 (0.174) data 0.093 (0.097) loss_x loss_x 0.5386 (0.7061) acc_x 81.2500 (80.1562) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.4644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 743
clean true:738
clean false:5
clean_rate:0.9932705248990579
noisy true:421
noisy false:436
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 857
epoch [13/200] batch [5/23] time 0.168 (0.172) data 0.091 (0.094) loss_x loss_x 0.7808 (0.6253) acc_x 81.2500 (83.7500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/23] time 0.175 (0.185) data 0.099 (0.108) loss_x loss_x 1.2041 (0.7731) acc_x 65.6250 (80.3125) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/23] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.7695 (0.7584) acc_x 78.1250 (80.2083) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/23] time 0.186 (0.181) data 0.108 (0.104) loss_x loss_x 0.7378 (0.7654) acc_x 75.0000 (79.3750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.4500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 720
clean true:717
clean false:3
clean_rate:0.9958333333333333
noisy true:418
noisy false:462
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 880
epoch [14/200] batch [5/22] time 0.161 (0.161) data 0.083 (0.084) loss_x loss_x 0.9248 (0.7549) acc_x 81.2500 (81.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/22] time 0.209 (0.168) data 0.133 (0.091) loss_x loss_x 0.4060 (0.7852) acc_x 90.6250 (78.7500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/22] time 0.190 (0.175) data 0.114 (0.099) loss_x loss_x 1.2070 (0.8200) acc_x 68.7500 (77.9167) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/22] time 0.197 (0.177) data 0.121 (0.100) loss_x loss_x 0.9404 (0.8291) acc_x 81.2500 (78.2812) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.4481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 717
clean true:711
clean false:6
clean_rate:0.9916317991631799
noisy true:425
noisy false:458
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 883
epoch [15/200] batch [5/22] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.7231 (0.8463) acc_x 78.1250 (76.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/22] time 0.181 (0.171) data 0.104 (0.094) loss_x loss_x 0.5220 (0.7781) acc_x 81.2500 (78.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/22] time 0.189 (0.178) data 0.111 (0.101) loss_x loss_x 0.9741 (0.7812) acc_x 75.0000 (78.1250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/22] time 0.183 (0.177) data 0.105 (0.100) loss_x loss_x 0.6099 (0.7822) acc_x 78.1250 (77.8125) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.4450, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 712
clean true:704
clean false:8
clean_rate:0.9887640449438202
noisy true:409
noisy false:479
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 888
epoch [16/200] batch [5/22] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.8569 (0.6813) acc_x 81.2500 (81.2500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/22] time 0.184 (0.169) data 0.108 (0.092) loss_x loss_x 0.5176 (0.6905) acc_x 87.5000 (81.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/22] time 0.182 (0.175) data 0.104 (0.099) loss_x loss_x 1.0830 (0.7383) acc_x 75.0000 (79.7917) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/22] time 0.161 (0.174) data 0.085 (0.097) loss_x loss_x 0.7578 (0.7339) acc_x 81.2500 (80.3125) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 724
clean true:722
clean false:2
clean_rate:0.9972375690607734
noisy true:428
noisy false:448
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 876
epoch [17/200] batch [5/22] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.3364 (0.5764) acc_x 87.5000 (82.5000) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/22] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.5239 (0.6078) acc_x 75.0000 (81.8750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/22] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.6870 (0.6316) acc_x 78.1250 (81.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/22] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.6943 (0.6486) acc_x 84.3750 (80.7812) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 762
clean true:757
clean false:5
clean_rate:0.9934383202099738
noisy true:430
noisy false:408
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 838
epoch [18/200] batch [5/23] time 0.169 (0.174) data 0.091 (0.097) loss_x loss_x 0.4146 (1.0294) acc_x 93.7500 (76.2500) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/23] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.7061 (0.9197) acc_x 78.1250 (77.1875) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/23] time 0.188 (0.174) data 0.111 (0.097) loss_x loss_x 0.6914 (0.8611) acc_x 84.3750 (78.5417) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/23] time 0.161 (0.172) data 0.083 (0.095) loss_x loss_x 0.6182 (0.8221) acc_x 90.6250 (79.5312) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.4587, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 734
clean true:730
clean false:4
clean_rate:0.9945504087193461
noisy true:427
noisy false:439
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 866
epoch [19/200] batch [5/22] time 0.169 (0.169) data 0.091 (0.092) loss_x loss_x 0.8545 (0.8064) acc_x 84.3750 (78.1250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/22] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.5415 (0.7212) acc_x 87.5000 (80.6250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/22] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.3826 (0.6654) acc_x 87.5000 (81.0417) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/22] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 1.2715 (0.7288) acc_x 68.7500 (79.6875) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.4750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 760
clean true:753
clean false:7
clean_rate:0.9907894736842106
noisy true:413
noisy false:427
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 840
epoch [20/200] batch [5/23] time 0.168 (0.199) data 0.091 (0.121) loss_x loss_x 1.3945 (0.9237) acc_x 78.1250 (80.6250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/23] time 0.187 (0.190) data 0.110 (0.113) loss_x loss_x 0.9756 (0.7954) acc_x 71.8750 (80.6250) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/23] time 0.161 (0.180) data 0.083 (0.103) loss_x loss_x 0.7827 (0.8136) acc_x 75.0000 (79.3750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/23] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.6875 (0.7993) acc_x 81.2500 (79.6875) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.4644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 743
clean true:739
clean false:4
clean_rate:0.9946164199192463
noisy true:426
noisy false:431
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 857
epoch [21/200] batch [5/23] time 0.182 (0.192) data 0.105 (0.115) loss_x loss_x 0.9019 (0.8097) acc_x 75.0000 (79.3750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/23] time 0.163 (0.191) data 0.085 (0.114) loss_x loss_x 0.9194 (0.8154) acc_x 84.3750 (80.0000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/23] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.9761 (0.8170) acc_x 78.1250 (79.5833) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/23] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 0.4653 (0.7696) acc_x 81.2500 (80.1562) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.4625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 740
clean true:734
clean false:6
clean_rate:0.9918918918918919
noisy true:423
noisy false:437
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 860
epoch [22/200] batch [5/23] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.5000 (0.4857) acc_x 87.5000 (86.2500) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/23] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.2891 (0.5323) acc_x 93.7500 (86.5625) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/23] time 0.193 (0.179) data 0.116 (0.102) loss_x loss_x 0.7637 (0.6248) acc_x 84.3750 (84.5833) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/23] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.9180 (0.6685) acc_x 75.0000 (83.4375) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.4794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 767
clean true:761
clean false:6
clean_rate:0.9921773142112125
noisy true:418
noisy false:415
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 833
epoch [23/200] batch [5/23] time 0.181 (0.166) data 0.104 (0.089) loss_x loss_x 0.8169 (0.6627) acc_x 84.3750 (84.3750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/23] time 0.176 (0.172) data 0.100 (0.095) loss_x loss_x 0.7432 (0.6868) acc_x 84.3750 (81.2500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/23] time 0.186 (0.174) data 0.110 (0.097) loss_x loss_x 0.8662 (0.6388) acc_x 81.2500 (83.3333) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/23] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 1.1240 (0.7101) acc_x 71.8750 (81.5625) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.4625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 740
clean true:736
clean false:4
clean_rate:0.9945945945945946
noisy true:416
noisy false:444
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 860
epoch [24/200] batch [5/23] time 0.183 (0.192) data 0.106 (0.115) loss_x loss_x 0.6069 (0.6295) acc_x 87.5000 (83.7500) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/23] time 0.173 (0.183) data 0.096 (0.106) loss_x loss_x 0.2871 (0.6037) acc_x 90.6250 (84.6875) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/23] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.5059 (0.6304) acc_x 90.6250 (83.9583) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/23] time 0.177 (0.177) data 0.101 (0.101) loss_x loss_x 0.4829 (0.5952) acc_x 87.5000 (84.6875) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.4612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 738
clean true:735
clean false:3
clean_rate:0.9959349593495935
noisy true:433
noisy false:429
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 862
epoch [25/200] batch [5/23] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.3533 (0.5734) acc_x 93.7500 (85.6250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/23] time 0.193 (0.180) data 0.116 (0.103) loss_x loss_x 0.9282 (0.6437) acc_x 78.1250 (82.5000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/23] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 1.0527 (0.6523) acc_x 68.7500 (80.6250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/23] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.6387 (0.6598) acc_x 84.3750 (80.9375) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.4700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 752
clean true:745
clean false:7
clean_rate:0.9906914893617021
noisy true:434
noisy false:414
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 848
epoch [26/200] batch [5/23] time 0.175 (0.166) data 0.098 (0.088) loss_x loss_x 0.3997 (0.7643) acc_x 81.2500 (79.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/23] time 0.189 (0.171) data 0.112 (0.094) loss_x loss_x 0.7886 (0.7843) acc_x 81.2500 (78.4375) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/23] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 0.6958 (0.7763) acc_x 84.3750 (78.7500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/23] time 0.166 (0.171) data 0.090 (0.094) loss_x loss_x 0.8652 (0.7610) acc_x 81.2500 (80.0000) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.4750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 760
clean true:757
clean false:3
clean_rate:0.9960526315789474
noisy true:418
noisy false:422
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 840
epoch [27/200] batch [5/23] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.8193 (0.8193) acc_x 75.0000 (76.8750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/23] time 0.174 (0.176) data 0.097 (0.098) loss_x loss_x 0.9551 (0.7932) acc_x 71.8750 (78.7500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/23] time 0.161 (0.173) data 0.084 (0.095) loss_x loss_x 0.6572 (0.7296) acc_x 75.0000 (80.2083) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/23] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.7622 (0.7174) acc_x 84.3750 (80.7812) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 749
clean true:742
clean false:7
clean_rate:0.9906542056074766
noisy true:427
noisy false:424
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 851
epoch [28/200] batch [5/23] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.9512 (0.9142) acc_x 75.0000 (72.5000) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/23] time 0.224 (0.192) data 0.147 (0.115) loss_x loss_x 0.5166 (0.7729) acc_x 84.3750 (78.1250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/23] time 0.168 (0.186) data 0.091 (0.109) loss_x loss_x 0.6953 (0.7284) acc_x 75.0000 (79.5833) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/23] time 0.173 (0.183) data 0.097 (0.106) loss_x loss_x 0.6924 (0.7236) acc_x 78.1250 (79.8438) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 747
clean true:741
clean false:6
clean_rate:0.9919678714859438
noisy true:429
noisy false:424
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 853
epoch [29/200] batch [5/23] time 0.173 (0.174) data 0.096 (0.096) loss_x loss_x 1.1602 (0.8099) acc_x 71.8750 (79.3750) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/23] time 0.172 (0.180) data 0.094 (0.103) loss_x loss_x 0.6182 (0.7822) acc_x 78.1250 (78.7500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/23] time 0.170 (0.177) data 0.092 (0.099) loss_x loss_x 0.6904 (0.7187) acc_x 81.2500 (80.0000) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/23] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.7021 (0.7307) acc_x 81.2500 (79.8438) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 749
clean true:742
clean false:7
clean_rate:0.9906542056074766
noisy true:414
noisy false:437
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 851
epoch [30/200] batch [5/23] time 0.171 (0.174) data 0.093 (0.096) loss_x loss_x 1.2617 (0.8127) acc_x 65.6250 (75.6250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/23] time 0.185 (0.178) data 0.108 (0.100) loss_x loss_x 0.5391 (0.6905) acc_x 84.3750 (78.7500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/23] time 0.167 (0.176) data 0.090 (0.098) loss_x loss_x 0.9019 (0.6702) acc_x 78.1250 (79.5833) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/23] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.8193 (0.6979) acc_x 78.1250 (79.3750) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:767
clean false:5
clean_rate:0.9935233160621761
noisy true:426
noisy false:402
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [31/200] batch [5/24] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.9443 (0.8895) acc_x 75.0000 (78.7500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/24] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.5811 (0.7489) acc_x 90.6250 (80.9375) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/24] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.8022 (0.7559) acc_x 84.3750 (81.6667) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/24] time 0.157 (0.172) data 0.081 (0.095) loss_x loss_x 0.8730 (0.7367) acc_x 78.1250 (81.2500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.4775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 764
clean true:757
clean false:7
clean_rate:0.9908376963350786
noisy true:419
noisy false:417
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 836
epoch [32/200] batch [5/23] time 0.161 (0.164) data 0.084 (0.087) loss_x loss_x 0.7891 (0.6401) acc_x 75.0000 (84.3750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/23] time 0.169 (0.166) data 0.092 (0.089) loss_x loss_x 0.6738 (0.7187) acc_x 87.5000 (81.5625) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/23] time 0.183 (0.169) data 0.106 (0.092) loss_x loss_x 0.8745 (0.7976) acc_x 84.3750 (79.5833) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/23] time 0.197 (0.169) data 0.120 (0.092) loss_x loss_x 0.6348 (0.7771) acc_x 75.0000 (79.2188) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 768
clean true:759
clean false:9
clean_rate:0.98828125
noisy true:428
noisy false:404
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 832
epoch [33/200] batch [5/24] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 0.2260 (0.6302) acc_x 93.7500 (83.7500) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/24] time 0.185 (0.179) data 0.108 (0.103) loss_x loss_x 0.4380 (0.6713) acc_x 90.6250 (83.4375) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/24] time 0.177 (0.180) data 0.101 (0.103) loss_x loss_x 0.7456 (0.6990) acc_x 81.2500 (82.7083) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/24] time 0.166 (0.180) data 0.089 (0.103) loss_x loss_x 0.2842 (0.6626) acc_x 90.6250 (83.4375) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.4762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 762
clean true:756
clean false:6
clean_rate:0.9921259842519685
noisy true:438
noisy false:400
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 838
epoch [34/200] batch [5/23] time 0.165 (0.163) data 0.087 (0.086) loss_x loss_x 0.5854 (0.6682) acc_x 84.3750 (83.7500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/23] time 0.184 (0.179) data 0.106 (0.101) loss_x loss_x 0.6782 (0.6219) acc_x 84.3750 (85.3125) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/23] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.8145 (0.7301) acc_x 81.2500 (81.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/23] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.7222 (0.6795) acc_x 84.3750 (83.5938) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.4700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 752
clean true:746
clean false:6
clean_rate:0.9920212765957447
noisy true:415
noisy false:433
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 848
epoch [35/200] batch [5/23] time 0.196 (0.181) data 0.119 (0.104) loss_x loss_x 0.4375 (0.6500) acc_x 87.5000 (83.7500) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/23] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.5161 (0.6837) acc_x 81.2500 (81.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/23] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.7295 (0.6432) acc_x 81.2500 (83.1250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/23] time 0.223 (0.188) data 0.146 (0.111) loss_x loss_x 0.2140 (0.6379) acc_x 93.7500 (83.9062) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.4750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 760
clean true:756
clean false:4
clean_rate:0.9947368421052631
noisy true:424
noisy false:416
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 840
epoch [36/200] batch [5/23] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.8691 (0.6798) acc_x 71.8750 (81.8750) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/23] time 0.163 (0.175) data 0.085 (0.098) loss_x loss_x 0.4292 (0.7083) acc_x 90.6250 (82.5000) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/23] time 0.169 (0.174) data 0.091 (0.097) loss_x loss_x 0.5513 (0.7056) acc_x 78.1250 (81.0417) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/23] time 0.164 (0.175) data 0.086 (0.097) loss_x loss_x 0.6992 (0.7197) acc_x 81.2500 (80.9375) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.4731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 757
clean true:755
clean false:2
clean_rate:0.9973579920739762
noisy true:410
noisy false:433
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 843
epoch [37/200] batch [5/23] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.4709 (0.8138) acc_x 87.5000 (79.3750) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/23] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.3613 (0.7055) acc_x 93.7500 (83.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/23] time 0.166 (0.174) data 0.090 (0.097) loss_x loss_x 0.9224 (0.7333) acc_x 71.8750 (81.4583) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/23] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.9453 (0.7297) acc_x 81.2500 (81.2500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.4800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 768
clean true:763
clean false:5
clean_rate:0.9934895833333334
noisy true:431
noisy false:401
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 832
epoch [38/200] batch [5/24] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.9917 (0.8779) acc_x 71.8750 (76.8750) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/24] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.5225 (0.7104) acc_x 87.5000 (81.2500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/24] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.8984 (0.6949) acc_x 75.0000 (81.2500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/24] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.2084 (0.6857) acc_x 93.7500 (81.5625) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.4875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 780
clean true:774
clean false:6
clean_rate:0.9923076923076923
noisy true:417
noisy false:403
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 820
epoch [39/200] batch [5/24] time 0.163 (0.167) data 0.086 (0.089) loss_x loss_x 0.5918 (0.6039) acc_x 87.5000 (83.7500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/24] time 0.168 (0.170) data 0.091 (0.092) loss_x loss_x 0.8501 (0.6208) acc_x 81.2500 (84.3750) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/24] time 0.167 (0.175) data 0.088 (0.097) loss_x loss_x 0.7832 (0.6469) acc_x 81.2500 (83.1250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/24] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.9341 (0.6380) acc_x 75.0000 (83.1250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.4644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 743
clean true:737
clean false:6
clean_rate:0.9919246298788694
noisy true:420
noisy false:437
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 857
epoch [40/200] batch [5/23] time 0.176 (0.182) data 0.099 (0.105) loss_x loss_x 1.7461 (0.7984) acc_x 62.5000 (81.8750) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/23] time 0.172 (0.183) data 0.095 (0.105) loss_x loss_x 0.5391 (0.6812) acc_x 81.2500 (82.1875) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/23] time 0.197 (0.184) data 0.119 (0.107) loss_x loss_x 0.2585 (0.6316) acc_x 93.7500 (83.3333) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/23] time 0.189 (0.185) data 0.112 (0.107) loss_x loss_x 0.6875 (0.6324) acc_x 84.3750 (83.4375) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.4744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 759
clean true:754
clean false:5
clean_rate:0.9934123847167325
noisy true:429
noisy false:412
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 841
epoch [41/200] batch [5/23] time 0.180 (0.186) data 0.102 (0.108) loss_x loss_x 0.3892 (0.5877) acc_x 87.5000 (81.8750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/23] time 0.177 (0.187) data 0.100 (0.110) loss_x loss_x 0.9541 (0.6918) acc_x 81.2500 (81.2500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/23] time 0.169 (0.184) data 0.092 (0.106) loss_x loss_x 0.3816 (0.6329) acc_x 93.7500 (84.1667) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/23] time 0.169 (0.181) data 0.092 (0.103) loss_x loss_x 0.9521 (0.6929) acc_x 71.8750 (81.8750) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.4750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 760
clean true:751
clean false:9
clean_rate:0.9881578947368421
noisy true:428
noisy false:412
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 840
epoch [42/200] batch [5/23] time 0.176 (0.180) data 0.098 (0.102) loss_x loss_x 0.4839 (0.4813) acc_x 87.5000 (87.5000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/23] time 0.157 (0.184) data 0.080 (0.107) loss_x loss_x 0.6226 (0.5702) acc_x 84.3750 (84.6875) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/23] time 0.189 (0.186) data 0.111 (0.108) loss_x loss_x 0.6636 (0.6163) acc_x 84.3750 (83.7500) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/23] time 0.216 (0.187) data 0.138 (0.110) loss_x loss_x 0.5752 (0.6280) acc_x 90.6250 (84.0625) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.4787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 766
clean true:758
clean false:8
clean_rate:0.9895561357702349
noisy true:433
noisy false:401
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 834
epoch [43/200] batch [5/23] time 0.203 (0.187) data 0.126 (0.110) loss_x loss_x 0.5391 (0.5729) acc_x 81.2500 (80.6250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/23] time 0.172 (0.180) data 0.094 (0.103) loss_x loss_x 1.3115 (0.6060) acc_x 62.5000 (81.2500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/23] time 0.172 (0.179) data 0.096 (0.102) loss_x loss_x 0.6235 (0.6201) acc_x 84.3750 (81.4583) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/23] time 0.174 (0.179) data 0.097 (0.103) loss_x loss_x 0.4297 (0.5976) acc_x 90.6250 (82.6562) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:768
clean false:7
clean_rate:0.9909677419354839
noisy true:432
noisy false:393
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [44/200] batch [5/24] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.7065 (0.6945) acc_x 81.2500 (81.2500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/24] time 0.172 (0.166) data 0.094 (0.089) loss_x loss_x 0.2976 (0.6186) acc_x 93.7500 (82.8125) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/24] time 0.178 (0.169) data 0.100 (0.092) loss_x loss_x 0.2991 (0.6225) acc_x 87.5000 (82.9167) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/24] time 0.172 (0.170) data 0.094 (0.093) loss_x loss_x 0.4419 (0.6151) acc_x 90.6250 (83.2812) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.4694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 751
clean true:745
clean false:6
clean_rate:0.9920106524633822
noisy true:420
noisy false:429
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 849
epoch [45/200] batch [5/23] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.2466 (0.5863) acc_x 96.8750 (85.0000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/23] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.6118 (0.6051) acc_x 87.5000 (85.0000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/23] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.9937 (0.6467) acc_x 78.1250 (83.9583) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/23] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 0.6025 (0.6273) acc_x 84.3750 (84.6875) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.4769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 763
clean true:758
clean false:5
clean_rate:0.9934469200524246
noisy true:427
noisy false:410
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 837
epoch [46/200] batch [5/23] time 0.199 (0.192) data 0.122 (0.115) loss_x loss_x 0.7988 (0.5851) acc_x 81.2500 (86.2500) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/23] time 0.173 (0.185) data 0.095 (0.108) loss_x loss_x 0.4680 (0.4805) acc_x 87.5000 (86.8750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/23] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.5200 (0.5232) acc_x 87.5000 (85.8333) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/23] time 0.182 (0.178) data 0.104 (0.101) loss_x loss_x 0.6299 (0.5859) acc_x 81.2500 (84.6875) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.4862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 778
clean true:769
clean false:9
clean_rate:0.9884318766066839
noisy true:425
noisy false:397
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 822
epoch [47/200] batch [5/24] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 0.7891 (0.6632) acc_x 71.8750 (83.7500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/24] time 0.166 (0.169) data 0.089 (0.092) loss_x loss_x 0.4756 (0.5531) acc_x 84.3750 (84.3750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/24] time 0.170 (0.169) data 0.094 (0.092) loss_x loss_x 0.5903 (0.5294) acc_x 78.1250 (84.7917) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/24] time 0.162 (0.168) data 0.086 (0.091) loss_x loss_x 0.6191 (0.5876) acc_x 87.5000 (83.4375) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 773
clean true:768
clean false:5
clean_rate:0.9935316946959897
noisy true:430
noisy false:397
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 827
epoch [48/200] batch [5/24] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.7651 (0.6867) acc_x 78.1250 (82.5000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/24] time 0.174 (0.183) data 0.096 (0.106) loss_x loss_x 0.4834 (0.6483) acc_x 84.3750 (83.7500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/24] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.7695 (0.6293) acc_x 84.3750 (83.7500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/24] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.5845 (0.6517) acc_x 87.5000 (83.7500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.4731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 757
clean true:749
clean false:8
clean_rate:0.9894319682959049
noisy true:439
noisy false:404
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 843
epoch [49/200] batch [5/23] time 0.181 (0.182) data 0.103 (0.105) loss_x loss_x 0.3699 (0.6382) acc_x 84.3750 (83.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/23] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.4656 (0.6465) acc_x 78.1250 (82.1875) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/23] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.7593 (0.6412) acc_x 84.3750 (82.7083) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/23] time 0.157 (0.176) data 0.080 (0.099) loss_x loss_x 0.7227 (0.6189) acc_x 84.3750 (83.7500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:768
clean false:7
clean_rate:0.9909677419354839
noisy true:422
noisy false:403
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [50/200] batch [5/24] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.5205 (0.5543) acc_x 84.3750 (85.6250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/24] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.4668 (0.5975) acc_x 90.6250 (85.0000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/24] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.4712 (0.6021) acc_x 93.7500 (84.7917) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/24] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.5991 (0.6368) acc_x 81.2500 (83.7500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 793
clean true:787
clean false:6
clean_rate:0.9924337957124842
noisy true:429
noisy false:378
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 807
epoch [51/200] batch [5/24] time 0.165 (0.184) data 0.088 (0.108) loss_x loss_x 0.6372 (0.6406) acc_x 84.3750 (83.7500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/24] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.6792 (0.5929) acc_x 81.2500 (84.6875) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/24] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 0.6987 (0.6682) acc_x 81.2500 (82.7083) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/24] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.5601 (0.6869) acc_x 84.3750 (82.3438) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 759
clean true:757
clean false:2
clean_rate:0.997364953886693
noisy true:430
noisy false:411
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 841
epoch [52/200] batch [5/23] time 0.213 (0.217) data 0.136 (0.140) loss_x loss_x 0.4963 (0.6249) acc_x 87.5000 (82.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/23] time 0.194 (0.206) data 0.118 (0.129) loss_x loss_x 0.5801 (0.6165) acc_x 87.5000 (83.1250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/23] time 0.181 (0.196) data 0.104 (0.119) loss_x loss_x 0.4934 (0.5939) acc_x 84.3750 (84.1667) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/23] time 0.220 (0.195) data 0.143 (0.118) loss_x loss_x 0.7373 (0.5997) acc_x 81.2500 (84.0625) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:778
clean false:5
clean_rate:0.9936143039591315
noisy true:422
noisy false:395
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [53/200] batch [5/24] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.5381 (0.4951) acc_x 87.5000 (87.5000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/24] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5181 (0.4401) acc_x 84.3750 (87.8125) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/24] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.3542 (0.4921) acc_x 90.6250 (86.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/24] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.9219 (0.5534) acc_x 75.0000 (85.1562) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.4762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 762
clean true:757
clean false:5
clean_rate:0.9934383202099738
noisy true:433
noisy false:405
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 838
epoch [54/200] batch [5/23] time 0.180 (0.180) data 0.104 (0.102) loss_x loss_x 0.6367 (0.6131) acc_x 81.2500 (85.0000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/23] time 0.168 (0.175) data 0.091 (0.097) loss_x loss_x 0.3518 (0.7112) acc_x 93.7500 (82.1875) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/23] time 0.174 (0.175) data 0.098 (0.097) loss_x loss_x 0.2871 (0.5958) acc_x 87.5000 (84.7917) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/23] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.7007 (0.6079) acc_x 81.2500 (84.2188) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 780
clean true:772
clean false:8
clean_rate:0.9897435897435898
noisy true:415
noisy false:405
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 820
epoch [55/200] batch [5/24] time 0.171 (0.172) data 0.094 (0.096) loss_x loss_x 0.5869 (0.5179) acc_x 87.5000 (85.0000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/24] time 0.180 (0.172) data 0.103 (0.095) loss_x loss_x 0.7095 (0.5799) acc_x 81.2500 (84.6875) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/24] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 1.1113 (0.6078) acc_x 78.1250 (84.3750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/24] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.9692 (0.6041) acc_x 75.0000 (84.2188) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 774
clean true:771
clean false:3
clean_rate:0.9961240310077519
noisy true:431
noisy false:395
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 826
epoch [56/200] batch [5/24] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.4917 (0.5875) acc_x 81.2500 (84.3750) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/24] time 0.175 (0.174) data 0.099 (0.097) loss_x loss_x 0.4441 (0.6084) acc_x 81.2500 (83.1250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/24] time 0.176 (0.173) data 0.100 (0.096) loss_x loss_x 0.3508 (0.5839) acc_x 87.5000 (83.7500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/24] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.2349 (0.5847) acc_x 93.7500 (84.6875) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 786
clean true:779
clean false:7
clean_rate:0.9910941475826972
noisy true:434
noisy false:380
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 814
epoch [57/200] batch [5/24] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.5752 (0.6615) acc_x 78.1250 (81.8750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/24] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.9409 (0.6260) acc_x 78.1250 (83.1250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/24] time 0.234 (0.183) data 0.157 (0.106) loss_x loss_x 0.6567 (0.6752) acc_x 75.0000 (81.4583) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/24] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.4009 (0.6900) acc_x 90.6250 (81.2500) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.4919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 787
clean true:780
clean false:7
clean_rate:0.9911054637865311
noisy true:416
noisy false:397
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 813
epoch [58/200] batch [5/24] time 0.179 (0.179) data 0.101 (0.101) loss_x loss_x 0.4189 (0.8522) acc_x 93.7500 (76.8750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/24] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.3352 (0.7140) acc_x 90.6250 (80.0000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/24] time 0.199 (0.175) data 0.121 (0.098) loss_x loss_x 0.2096 (0.6389) acc_x 90.6250 (81.8750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/24] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.4878 (0.6585) acc_x 93.7500 (82.3438) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:778
clean false:5
clean_rate:0.9936143039591315
noisy true:421
noisy false:396
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [59/200] batch [5/24] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.5825 (0.6627) acc_x 87.5000 (82.5000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/24] time 0.176 (0.172) data 0.100 (0.095) loss_x loss_x 0.6392 (0.6704) acc_x 81.2500 (82.5000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/24] time 0.167 (0.171) data 0.090 (0.095) loss_x loss_x 0.3337 (0.6545) acc_x 93.7500 (82.9167) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/24] time 0.166 (0.170) data 0.090 (0.093) loss_x loss_x 0.4751 (0.6324) acc_x 78.1250 (82.9688) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:790
clean false:5
clean_rate:0.9937106918238994
noisy true:440
noisy false:365
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [60/200] batch [5/24] time 0.177 (0.174) data 0.100 (0.097) loss_x loss_x 0.7349 (0.5310) acc_x 84.3750 (85.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/24] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.8242 (0.5350) acc_x 78.1250 (85.6250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/24] time 0.171 (0.171) data 0.093 (0.094) loss_x loss_x 0.8818 (0.5827) acc_x 68.7500 (83.7500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/24] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.5337 (0.6531) acc_x 84.3750 (82.6562) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 758
clean true:753
clean false:5
clean_rate:0.9934036939313984
noisy true:431
noisy false:411
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 842
epoch [61/200] batch [5/23] time 0.164 (0.173) data 0.087 (0.096) loss_x loss_x 0.6240 (0.6542) acc_x 78.1250 (81.8750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/23] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.7368 (0.6811) acc_x 78.1250 (81.2500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/23] time 0.213 (0.175) data 0.136 (0.099) loss_x loss_x 0.9668 (0.6958) acc_x 81.2500 (81.8750) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/23] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.7124 (0.6780) acc_x 75.0000 (82.1875) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.4887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 782
clean true:775
clean false:7
clean_rate:0.9910485933503836
noisy true:420
noisy false:398
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 818
epoch [62/200] batch [5/24] time 0.190 (0.177) data 0.112 (0.098) loss_x loss_x 0.5586 (0.6015) acc_x 90.6250 (87.5000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/24] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.7139 (0.5266) acc_x 78.1250 (87.5000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/24] time 0.191 (0.179) data 0.114 (0.101) loss_x loss_x 0.5469 (0.5388) acc_x 84.3750 (87.2917) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/24] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 1.0635 (0.5759) acc_x 71.8750 (86.2500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 779
clean true:773
clean false:6
clean_rate:0.9922978177150192
noisy true:432
noisy false:389
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 821
epoch [63/200] batch [5/24] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 0.4841 (0.5691) acc_x 87.5000 (85.0000) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/24] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.5063 (0.5497) acc_x 81.2500 (84.6875) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/24] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.7192 (0.6007) acc_x 84.3750 (84.1667) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/24] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.8794 (0.6174) acc_x 75.0000 (83.9062) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 792
clean true:785
clean false:7
clean_rate:0.9911616161616161
noisy true:426
noisy false:382
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 808
epoch [64/200] batch [5/24] time 0.179 (0.192) data 0.102 (0.114) loss_x loss_x 0.5933 (0.6724) acc_x 84.3750 (84.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/24] time 0.181 (0.192) data 0.104 (0.115) loss_x loss_x 0.4502 (0.5834) acc_x 84.3750 (83.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/24] time 0.168 (0.187) data 0.091 (0.110) loss_x loss_x 0.4475 (0.5971) acc_x 84.3750 (83.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/24] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.2286 (0.5543) acc_x 93.7500 (84.5312) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 787
clean true:782
clean false:5
clean_rate:0.9936467598475223
noisy true:421
noisy false:392
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 813
epoch [65/200] batch [5/24] time 0.180 (0.171) data 0.103 (0.094) loss_x loss_x 0.5781 (0.5637) acc_x 81.2500 (86.2500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/24] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.7764 (0.6175) acc_x 75.0000 (82.8125) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/24] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.3838 (0.6125) acc_x 87.5000 (83.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/24] time 0.161 (0.177) data 0.084 (0.099) loss_x loss_x 0.3975 (0.5942) acc_x 84.3750 (83.7500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 792
clean true:787
clean false:5
clean_rate:0.9936868686868687
noisy true:419
noisy false:389
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 808
epoch [66/200] batch [5/24] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.4712 (0.6358) acc_x 84.3750 (81.2500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/24] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 0.3364 (0.5974) acc_x 90.6250 (83.7500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/24] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.5586 (0.6130) acc_x 84.3750 (83.7500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/24] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.7881 (0.6067) acc_x 78.1250 (83.7500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 782
clean true:773
clean false:9
clean_rate:0.9884910485933504
noisy true:427
noisy false:391
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 818
epoch [67/200] batch [5/24] time 0.219 (0.210) data 0.142 (0.132) loss_x loss_x 1.0479 (0.8275) acc_x 75.0000 (79.3750) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/24] time 0.194 (0.207) data 0.117 (0.129) loss_x loss_x 0.7002 (0.7137) acc_x 78.1250 (80.3125) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/24] time 0.168 (0.196) data 0.090 (0.118) loss_x loss_x 0.9004 (0.6904) acc_x 81.2500 (80.6250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/24] time 0.189 (0.198) data 0.111 (0.120) loss_x loss_x 1.0547 (0.6560) acc_x 71.8750 (81.8750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:783
clean false:8
clean_rate:0.9898862199747156
noisy true:430
noisy false:379
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [68/200] batch [5/24] time 0.182 (0.166) data 0.105 (0.089) loss_x loss_x 0.8394 (0.6917) acc_x 81.2500 (85.0000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/24] time 0.170 (0.169) data 0.092 (0.092) loss_x loss_x 0.9282 (0.6984) acc_x 75.0000 (82.1875) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/24] time 0.191 (0.172) data 0.114 (0.095) loss_x loss_x 0.6465 (0.6782) acc_x 78.1250 (82.2917) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/24] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.4011 (0.6451) acc_x 90.6250 (82.6562) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.4887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 782
clean true:773
clean false:9
clean_rate:0.9884910485933504
noisy true:428
noisy false:390
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 818
epoch [69/200] batch [5/24] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.3035 (0.5335) acc_x 87.5000 (87.5000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/24] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.2646 (0.4954) acc_x 90.6250 (86.5625) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/24] time 0.157 (0.164) data 0.080 (0.087) loss_x loss_x 0.7314 (0.5366) acc_x 78.1250 (85.2083) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/24] time 0.205 (0.167) data 0.127 (0.090) loss_x loss_x 0.3389 (0.5483) acc_x 93.7500 (85.4688) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 774
clean true:768
clean false:6
clean_rate:0.9922480620155039
noisy true:418
noisy false:408
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 826
epoch [70/200] batch [5/24] time 0.177 (0.181) data 0.101 (0.104) loss_x loss_x 0.8633 (0.6896) acc_x 75.0000 (77.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/24] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.4839 (0.6392) acc_x 84.3750 (79.0625) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/24] time 0.161 (0.168) data 0.084 (0.091) loss_x loss_x 0.4744 (0.6288) acc_x 90.6250 (81.4583) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/24] time 0.161 (0.166) data 0.084 (0.089) loss_x loss_x 0.5020 (0.6213) acc_x 93.7500 (82.3438) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 779
clean true:775
clean false:4
clean_rate:0.9948652118100129
noisy true:443
noisy false:378
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 821
epoch [71/200] batch [5/24] time 0.174 (0.177) data 0.097 (0.099) loss_x loss_x 0.4563 (0.5082) acc_x 84.3750 (85.0000) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/24] time 0.196 (0.179) data 0.119 (0.102) loss_x loss_x 0.4097 (0.5448) acc_x 81.2500 (85.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/24] time 0.183 (0.177) data 0.105 (0.100) loss_x loss_x 0.5391 (0.5682) acc_x 81.2500 (85.0000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/24] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.6499 (0.5731) acc_x 87.5000 (85.4688) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.4906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 785
clean true:778
clean false:7
clean_rate:0.9910828025477707
noisy true:418
noisy false:397
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 815
epoch [72/200] batch [5/24] time 0.173 (0.170) data 0.096 (0.093) loss_x loss_x 0.2178 (0.6144) acc_x 90.6250 (83.7500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/24] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.6509 (0.6744) acc_x 84.3750 (83.7500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/24] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.4307 (0.6761) acc_x 84.3750 (84.5833) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/24] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.5254 (0.6655) acc_x 87.5000 (84.3750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:766
clean false:9
clean_rate:0.9883870967741936
noisy true:433
noisy false:392
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [73/200] batch [5/24] time 0.194 (0.174) data 0.116 (0.096) loss_x loss_x 0.5581 (0.8874) acc_x 87.5000 (80.0000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/24] time 0.175 (0.176) data 0.099 (0.099) loss_x loss_x 0.5283 (0.7068) acc_x 84.3750 (82.8125) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/24] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.7686 (0.7064) acc_x 81.2500 (82.2917) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/24] time 0.192 (0.181) data 0.114 (0.104) loss_x loss_x 0.2998 (0.6547) acc_x 93.7500 (83.7500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.4881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 781
clean true:772
clean false:9
clean_rate:0.9884763124199744
noisy true:432
noisy false:387
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 819
epoch [74/200] batch [5/24] time 0.217 (0.184) data 0.141 (0.107) loss_x loss_x 0.2727 (0.7121) acc_x 90.6250 (82.5000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/24] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.4321 (0.6528) acc_x 84.3750 (82.8125) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/24] time 0.172 (0.178) data 0.095 (0.102) loss_x loss_x 0.4739 (0.6327) acc_x 90.6250 (84.1667) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/24] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.4583 (0.6213) acc_x 84.3750 (83.4375) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:766
clean false:6
clean_rate:0.9922279792746114
noisy true:432
noisy false:396
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [75/200] batch [5/24] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9048 (0.7882) acc_x 78.1250 (80.6250) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/24] time 0.173 (0.181) data 0.097 (0.104) loss_x loss_x 0.8057 (0.7924) acc_x 78.1250 (80.0000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/24] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.5557 (0.7441) acc_x 84.3750 (80.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/24] time 0.187 (0.178) data 0.110 (0.101) loss_x loss_x 0.7822 (0.7164) acc_x 75.0000 (80.9375) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.4900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 784
clean true:776
clean false:8
clean_rate:0.9897959183673469
noisy true:413
noisy false:403
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 816
epoch [76/200] batch [5/24] time 0.169 (0.167) data 0.092 (0.090) loss_x loss_x 0.5640 (0.5781) acc_x 87.5000 (85.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/24] time 0.163 (0.165) data 0.086 (0.088) loss_x loss_x 0.6030 (0.5803) acc_x 75.0000 (83.7500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/24] time 0.164 (0.169) data 0.087 (0.092) loss_x loss_x 0.9326 (0.6315) acc_x 78.1250 (81.6667) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/24] time 0.165 (0.168) data 0.089 (0.091) loss_x loss_x 0.9419 (0.6450) acc_x 75.0000 (81.5625) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 794
clean true:790
clean false:4
clean_rate:0.9949622166246851
noisy true:419
noisy false:387
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 806
epoch [77/200] batch [5/24] time 0.180 (0.182) data 0.103 (0.104) loss_x loss_x 0.5225 (0.6044) acc_x 84.3750 (82.5000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/24] time 0.164 (0.186) data 0.088 (0.109) loss_x loss_x 0.7158 (0.5742) acc_x 81.2500 (83.4375) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/24] time 0.176 (0.182) data 0.100 (0.105) loss_x loss_x 0.4485 (0.5368) acc_x 93.7500 (84.1667) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/24] time 0.194 (0.182) data 0.116 (0.105) loss_x loss_x 0.5503 (0.5804) acc_x 87.5000 (83.9062) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 797
clean true:787
clean false:10
clean_rate:0.9874529485570891
noisy true:427
noisy false:376
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 803
epoch [78/200] batch [5/24] time 0.156 (0.157) data 0.079 (0.081) loss_x loss_x 0.3914 (0.6391) acc_x 87.5000 (87.5000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/24] time 0.171 (0.160) data 0.094 (0.084) loss_x loss_x 0.8018 (0.6236) acc_x 81.2500 (85.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/24] time 0.175 (0.164) data 0.098 (0.087) loss_x loss_x 0.7212 (0.6072) acc_x 81.2500 (85.0000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/24] time 0.190 (0.171) data 0.114 (0.094) loss_x loss_x 0.3552 (0.6087) acc_x 87.5000 (84.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 790
clean true:780
clean false:10
clean_rate:0.9873417721518988
noisy true:430
noisy false:380
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 810
epoch [79/200] batch [5/24] time 0.163 (0.162) data 0.087 (0.085) loss_x loss_x 0.6465 (0.7295) acc_x 81.2500 (82.5000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/24] time 0.166 (0.166) data 0.090 (0.089) loss_x loss_x 0.6704 (0.7257) acc_x 84.3750 (82.1875) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/24] time 0.183 (0.172) data 0.107 (0.095) loss_x loss_x 0.3704 (0.6406) acc_x 84.3750 (84.1667) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/24] time 0.202 (0.176) data 0.126 (0.099) loss_x loss_x 0.4124 (0.6149) acc_x 87.5000 (84.5312) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:786
clean false:9
clean_rate:0.9886792452830189
noisy true:417
noisy false:388
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [80/200] batch [5/24] time 0.183 (0.188) data 0.105 (0.111) loss_x loss_x 0.5967 (0.5392) acc_x 90.6250 (88.1250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/24] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.8340 (0.5775) acc_x 78.1250 (86.2500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/24] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.3772 (0.5808) acc_x 90.6250 (86.4583) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/24] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.4556 (0.5577) acc_x 84.3750 (86.4062) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 787
clean true:780
clean false:7
clean_rate:0.9911054637865311
noisy true:431
noisy false:382
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 813
epoch [81/200] batch [5/24] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.8672 (0.4954) acc_x 78.1250 (85.6250) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/24] time 0.159 (0.171) data 0.082 (0.095) loss_x loss_x 0.4143 (0.5006) acc_x 93.7500 (86.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/24] time 0.176 (0.170) data 0.099 (0.093) loss_x loss_x 1.2256 (0.5754) acc_x 71.8750 (85.0000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/24] time 0.201 (0.173) data 0.125 (0.096) loss_x loss_x 0.4277 (0.5891) acc_x 93.7500 (84.8438) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 774
clean true:767
clean false:7
clean_rate:0.9909560723514211
noisy true:435
noisy false:391
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 826
epoch [82/200] batch [5/24] time 0.190 (0.176) data 0.112 (0.099) loss_x loss_x 0.7954 (0.6310) acc_x 78.1250 (83.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/24] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.6724 (0.5840) acc_x 84.3750 (84.6875) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/24] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.1484 (0.5567) acc_x 96.8750 (85.6250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/24] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.6753 (0.5574) acc_x 81.2500 (85.4688) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 799
clean true:790
clean false:9
clean_rate:0.9887359198998749
noisy true:416
noisy false:385
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 801
epoch [83/200] batch [5/24] time 0.188 (0.190) data 0.112 (0.113) loss_x loss_x 0.7925 (0.6898) acc_x 84.3750 (81.8750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/24] time 0.170 (0.186) data 0.093 (0.109) loss_x loss_x 1.1953 (0.6879) acc_x 71.8750 (82.5000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/24] time 0.170 (0.181) data 0.093 (0.105) loss_x loss_x 0.2610 (0.6260) acc_x 93.7500 (84.1667) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/24] time 0.171 (0.181) data 0.095 (0.104) loss_x loss_x 0.5693 (0.6312) acc_x 81.2500 (83.9062) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:804
clean false:6
clean_rate:0.9925925925925926
noisy true:428
noisy false:362
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [84/200] batch [5/25] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.3027 (0.4655) acc_x 87.5000 (87.5000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/25] time 0.159 (0.176) data 0.082 (0.099) loss_x loss_x 0.7764 (0.5535) acc_x 75.0000 (84.3750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/25] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.6138 (0.5675) acc_x 84.3750 (84.7917) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/25] time 0.190 (0.174) data 0.113 (0.097) loss_x loss_x 0.9375 (0.5749) acc_x 78.1250 (85.3125) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [25/25] time 0.160 (0.172) data 0.082 (0.095) loss_x loss_x 0.6899 (0.6115) acc_x 81.2500 (84.2500) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:786
clean false:10
clean_rate:0.9874371859296482
noisy true:429
noisy false:375
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [85/200] batch [5/24] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 1.0703 (0.6829) acc_x 65.6250 (80.6250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/24] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.8496 (0.6099) acc_x 78.1250 (83.1250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/24] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.8599 (0.6360) acc_x 75.0000 (82.0833) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/24] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.8540 (0.6488) acc_x 78.1250 (82.3438) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.4912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 786
clean true:778
clean false:8
clean_rate:0.989821882951654
noisy true:412
noisy false:402
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 814
epoch [86/200] batch [5/24] time 0.190 (0.177) data 0.113 (0.100) loss_x loss_x 0.6504 (0.6602) acc_x 87.5000 (83.1250) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/24] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.5322 (0.6287) acc_x 87.5000 (82.8125) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/24] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.7788 (0.6781) acc_x 78.1250 (82.0833) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/24] time 0.194 (0.180) data 0.118 (0.103) loss_x loss_x 0.8828 (0.7050) acc_x 75.0000 (81.8750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:788
clean false:8
clean_rate:0.9899497487437185
noisy true:425
noisy false:379
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [87/200] batch [5/24] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.8018 (0.6305) acc_x 75.0000 (82.5000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/24] time 0.190 (0.182) data 0.113 (0.105) loss_x loss_x 0.5391 (0.5727) acc_x 84.3750 (85.0000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/24] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 1.0039 (0.5793) acc_x 84.3750 (86.2500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/24] time 0.167 (0.183) data 0.090 (0.106) loss_x loss_x 0.6147 (0.5837) acc_x 87.5000 (86.5625) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 800
clean true:790
clean false:10
clean_rate:0.9875
noisy true:431
noisy false:369
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 800
epoch [88/200] batch [5/25] time 0.195 (0.188) data 0.119 (0.111) loss_x loss_x 0.4109 (0.6091) acc_x 84.3750 (85.0000) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/25] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.4011 (0.5768) acc_x 87.5000 (85.9375) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/25] time 0.191 (0.179) data 0.114 (0.103) loss_x loss_x 0.4141 (0.6028) acc_x 87.5000 (85.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/25] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.5103 (0.6191) acc_x 87.5000 (85.0000) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [25/25] time 0.168 (0.177) data 0.091 (0.101) loss_x loss_x 0.5210 (0.6133) acc_x 81.2500 (84.7500) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 792
clean true:783
clean false:9
clean_rate:0.9886363636363636
noisy true:425
noisy false:383
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 808
epoch [89/200] batch [5/24] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.7505 (0.6348) acc_x 78.1250 (81.8750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/24] time 0.194 (0.182) data 0.118 (0.105) loss_x loss_x 0.7568 (0.5923) acc_x 78.1250 (83.4375) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/24] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.7173 (0.5805) acc_x 75.0000 (84.5833) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/24] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.7520 (0.5951) acc_x 81.2500 (84.0625) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.4869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 779
clean true:771
clean false:8
clean_rate:0.9897304236200257
noisy true:411
noisy false:410
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 821
epoch [90/200] batch [5/24] time 0.169 (0.179) data 0.093 (0.102) loss_x loss_x 0.6885 (0.5958) acc_x 84.3750 (86.8750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/24] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.7334 (0.5559) acc_x 75.0000 (87.1875) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/24] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.2673 (0.5551) acc_x 90.6250 (86.6667) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/24] time 0.174 (0.183) data 0.096 (0.106) loss_x loss_x 1.1113 (0.6054) acc_x 65.6250 (85.6250) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 794
clean true:787
clean false:7
clean_rate:0.9911838790931989
noisy true:419
noisy false:387
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 806
epoch [91/200] batch [5/24] time 0.162 (0.165) data 0.085 (0.088) loss_x loss_x 0.4958 (0.4508) acc_x 90.6250 (88.7500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/24] time 0.180 (0.167) data 0.103 (0.091) loss_x loss_x 0.4670 (0.5538) acc_x 81.2500 (85.3125) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/24] time 0.185 (0.170) data 0.109 (0.093) loss_x loss_x 0.6382 (0.5562) acc_x 81.2500 (85.8333) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/24] time 0.182 (0.170) data 0.105 (0.093) loss_x loss_x 0.5034 (0.5882) acc_x 90.6250 (85.0000) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 804
clean true:796
clean false:8
clean_rate:0.9900497512437811
noisy true:434
noisy false:362
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 796
epoch [92/200] batch [5/25] time 0.183 (0.190) data 0.105 (0.113) loss_x loss_x 0.5981 (0.6910) acc_x 78.1250 (80.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/25] time 0.158 (0.189) data 0.081 (0.112) loss_x loss_x 0.4575 (0.6707) acc_x 90.6250 (82.5000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/25] time 0.163 (0.181) data 0.086 (0.104) loss_x loss_x 0.6499 (0.6570) acc_x 87.5000 (83.1250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/25] time 0.162 (0.176) data 0.085 (0.099) loss_x loss_x 0.4148 (0.6139) acc_x 93.7500 (84.3750) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [25/25] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.6807 (0.6163) acc_x 87.5000 (84.5000) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 806
clean true:797
clean false:9
clean_rate:0.988833746898263
noisy true:416
noisy false:378
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 794
epoch [93/200] batch [5/25] time 0.166 (0.167) data 0.089 (0.090) loss_x loss_x 0.3765 (0.3998) acc_x 90.6250 (88.1250) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/25] time 0.184 (0.168) data 0.106 (0.091) loss_x loss_x 0.5029 (0.4986) acc_x 87.5000 (87.8125) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/25] time 0.192 (0.172) data 0.115 (0.095) loss_x loss_x 0.3342 (0.5385) acc_x 87.5000 (86.6667) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/25] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.4260 (0.5374) acc_x 90.6250 (86.4062) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [25/25] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.5034 (0.5571) acc_x 90.6250 (86.0000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.5075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 812
clean true:805
clean false:7
clean_rate:0.9913793103448276
noisy true:416
noisy false:372
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 788
epoch [94/200] batch [5/25] time 0.176 (0.171) data 0.098 (0.094) loss_x loss_x 0.1331 (0.4935) acc_x 96.8750 (86.8750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/25] time 0.184 (0.174) data 0.108 (0.097) loss_x loss_x 0.5986 (0.5938) acc_x 84.3750 (82.8125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/25] time 0.190 (0.177) data 0.113 (0.100) loss_x loss_x 0.3843 (0.5963) acc_x 90.6250 (84.1667) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/25] time 0.159 (0.176) data 0.081 (0.100) loss_x loss_x 0.6860 (0.5931) acc_x 84.3750 (83.9062) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [25/25] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.5200 (0.5947) acc_x 87.5000 (84.2500) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:789
clean false:6
clean_rate:0.9924528301886792
noisy true:428
noisy false:377
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [95/200] batch [5/24] time 0.187 (0.175) data 0.111 (0.098) loss_x loss_x 0.3381 (0.4517) acc_x 90.6250 (86.8750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/24] time 0.183 (0.179) data 0.106 (0.103) loss_x loss_x 0.3435 (0.5152) acc_x 90.6250 (86.2500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/24] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.2793 (0.5089) acc_x 90.6250 (85.6250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/24] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.5342 (0.4788) acc_x 84.3750 (86.7188) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.4781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 765
clean true:757
clean false:8
clean_rate:0.9895424836601308
noisy true:431
noisy false:404
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 835
epoch [96/200] batch [5/23] time 0.193 (0.187) data 0.116 (0.111) loss_x loss_x 0.6880 (0.5563) acc_x 87.5000 (86.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/23] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.7998 (0.5955) acc_x 81.2500 (85.3125) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/23] time 0.218 (0.182) data 0.141 (0.105) loss_x loss_x 0.5864 (0.5691) acc_x 87.5000 (86.0417) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/23] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.2346 (0.5715) acc_x 93.7500 (85.3125) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:809
clean false:7
clean_rate:0.991421568627451
noisy true:434
noisy false:350
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [97/200] batch [5/25] time 0.165 (0.174) data 0.088 (0.096) loss_x loss_x 0.3936 (0.6070) acc_x 90.6250 (81.2500) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/25] time 0.204 (0.184) data 0.127 (0.107) loss_x loss_x 0.3474 (0.6470) acc_x 90.6250 (81.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/25] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.4966 (0.6530) acc_x 90.6250 (82.2917) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/25] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 0.3584 (0.6603) acc_x 90.6250 (82.6562) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [25/25] time 0.190 (0.189) data 0.114 (0.112) loss_x loss_x 0.2092 (0.6352) acc_x 96.8750 (83.1250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:805
clean false:10
clean_rate:0.9877300613496932
noisy true:424
noisy false:361
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [98/200] batch [5/25] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.4880 (0.4737) acc_x 90.6250 (88.1250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/25] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.5132 (0.5119) acc_x 87.5000 (87.5000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/25] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.3853 (0.5580) acc_x 87.5000 (85.8333) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/25] time 0.172 (0.184) data 0.095 (0.106) loss_x loss_x 1.0781 (0.5958) acc_x 78.1250 (85.9375) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [25/25] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 1.4434 (0.6664) acc_x 68.7500 (84.3750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:800
clean false:7
clean_rate:0.9913258983890955
noisy true:426
noisy false:367
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [99/200] batch [5/25] time 0.161 (0.169) data 0.084 (0.093) loss_x loss_x 0.6060 (0.5324) acc_x 84.3750 (85.0000) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/25] time 0.177 (0.178) data 0.100 (0.102) loss_x loss_x 0.9722 (0.5843) acc_x 75.0000 (84.6875) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/25] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.4041 (0.5477) acc_x 90.6250 (86.0417) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/25] time 0.184 (0.173) data 0.108 (0.096) loss_x loss_x 0.8301 (0.5938) acc_x 81.2500 (85.7812) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [25/25] time 0.178 (0.174) data 0.101 (0.098) loss_x loss_x 0.5425 (0.5683) acc_x 87.5000 (86.2500) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:809
clean false:10
clean_rate:0.9877899877899878
noisy true:428
noisy false:353
all clean rate:  [0.9811715481171548, 0.9892280071813285, 0.9941089837997055, 0.9927536231884058, 0.9942196531791907, 0.9912790697674418, 0.9927953890489913, 0.9971305595408895, 0.9904240766073872, 0.9914407988587732, 0.9927325581395349, 0.9986431478968792, 0.9932705248990579, 0.9958333333333333, 0.9916317991631799, 0.9887640449438202, 0.9972375690607734, 0.9934383202099738, 0.9945504087193461, 0.9907894736842106, 0.9946164199192463, 0.9918918918918919, 0.9921773142112125, 0.9945945945945946, 0.9959349593495935, 0.9906914893617021, 0.9960526315789474, 0.9906542056074766, 0.9919678714859438, 0.9906542056074766, 0.9935233160621761, 0.9908376963350786, 0.98828125, 0.9921259842519685, 0.9920212765957447, 0.9947368421052631, 0.9973579920739762, 0.9934895833333334, 0.9923076923076923, 0.9919246298788694, 0.9934123847167325, 0.9881578947368421, 0.9895561357702349, 0.9909677419354839, 0.9920106524633822, 0.9934469200524246, 0.9884318766066839, 0.9935316946959897, 0.9894319682959049, 0.9909677419354839, 0.9924337957124842, 0.997364953886693, 0.9936143039591315, 0.9934383202099738, 0.9897435897435898, 0.9961240310077519, 0.9910941475826972, 0.9911054637865311, 0.9936143039591315, 0.9937106918238994, 0.9934036939313984, 0.9910485933503836, 0.9922978177150192, 0.9911616161616161, 0.9936467598475223, 0.9936868686868687, 0.9884910485933504, 0.9898862199747156, 0.9884910485933504, 0.9922480620155039, 0.9948652118100129, 0.9910828025477707, 0.9883870967741936, 0.9884763124199744, 0.9922279792746114, 0.9897959183673469, 0.9949622166246851, 0.9874529485570891, 0.9873417721518988, 0.9886792452830189, 0.9911054637865311, 0.9909560723514211, 0.9887359198998749, 0.9925925925925926, 0.9874371859296482, 0.989821882951654, 0.9899497487437185, 0.9875, 0.9886363636363636, 0.9897304236200257, 0.9911838790931989, 0.9900497512437811, 0.988833746898263, 0.9913793103448276, 0.9924528301886792, 0.9895424836601308, 0.991421568627451, 0.9877300613496932, 0.9913258983890955, 0.9877899877899878]
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [100/200] batch [5/25] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 0.8960 (0.7249) acc_x 71.8750 (81.8750) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/25] time 0.182 (0.170) data 0.105 (0.094) loss_x loss_x 0.2505 (0.5763) acc_x 93.7500 (85.0000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/25] time 0.178 (0.172) data 0.102 (0.095) loss_x loss_x 0.7349 (0.5992) acc_x 84.3750 (83.9583) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/25] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.9082 (0.6092) acc_x 78.1250 (83.1250) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [25/25] time 0.203 (0.177) data 0.126 (0.100) loss_x loss_x 0.8618 (0.5993) acc_x 84.3750 (84.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 804
clean true:797
clean false:7
clean_rate:0.9912935323383084
noisy true:433
noisy false:363
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 796
epoch [101/200] batch [5/25] time 0.170 (0.179) data 0.094 (0.102) loss_x loss_x 0.5029 (0.5224) acc_x 84.3750 (87.5000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/25] time 0.177 (0.180) data 0.099 (0.103) loss_x loss_x 0.5645 (0.5237) acc_x 84.3750 (85.6250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/25] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.6426 (0.5571) acc_x 78.1250 (85.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/25] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.5674 (0.5472) acc_x 81.2500 (85.1562) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [25/25] time 0.158 (0.173) data 0.081 (0.096) loss_x loss_x 0.5430 (0.5230) acc_x 84.3750 (85.7500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:791
clean false:12
clean_rate:0.9850560398505604
noisy true:410
noisy false:387
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [102/200] batch [5/25] time 0.180 (0.173) data 0.104 (0.097) loss_x loss_x 0.9453 (0.5873) acc_x 78.1250 (86.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/25] time 0.205 (0.176) data 0.128 (0.099) loss_x loss_x 0.8589 (0.6493) acc_x 71.8750 (85.3125) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/25] time 0.199 (0.180) data 0.122 (0.103) loss_x loss_x 0.4087 (0.6092) acc_x 87.5000 (85.8333) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/25] time 0.175 (0.180) data 0.099 (0.103) loss_x loss_x 1.0029 (0.6370) acc_x 68.7500 (84.3750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [25/25] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.5347 (0.6185) acc_x 81.2500 (84.8750) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:787
clean false:9
clean_rate:0.9886934673366834
noisy true:424
noisy false:380
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [103/200] batch [5/24] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.4365 (0.5607) acc_x 90.6250 (88.1250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/24] time 0.181 (0.189) data 0.105 (0.112) loss_x loss_x 0.2800 (0.5190) acc_x 96.8750 (87.8125) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/24] time 0.179 (0.187) data 0.103 (0.110) loss_x loss_x 0.6855 (0.5382) acc_x 87.5000 (86.8750) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/24] time 0.172 (0.186) data 0.095 (0.109) loss_x loss_x 0.8511 (0.5627) acc_x 78.1250 (86.0938) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:781
clean false:10
clean_rate:0.9873577749683944
noisy true:429
noisy false:380
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [104/200] batch [5/24] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5952 (0.7385) acc_x 81.2500 (77.5000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/24] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.1360 (0.6154) acc_x 96.8750 (81.2500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/24] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4844 (0.6223) acc_x 90.6250 (83.3333) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/24] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.6753 (0.6112) acc_x 84.3750 (83.5938) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:797
clean false:11
clean_rate:0.9863861386138614
noisy true:437
noisy false:355
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [105/200] batch [5/25] time 0.182 (0.197) data 0.105 (0.119) loss_x loss_x 0.6035 (0.7323) acc_x 84.3750 (78.1250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/25] time 0.176 (0.189) data 0.099 (0.111) loss_x loss_x 0.4558 (0.6606) acc_x 87.5000 (81.8750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/25] time 0.176 (0.186) data 0.099 (0.109) loss_x loss_x 0.4773 (0.6252) acc_x 93.7500 (83.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/25] time 0.164 (0.180) data 0.088 (0.103) loss_x loss_x 0.6660 (0.6343) acc_x 87.5000 (83.7500) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [25/25] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.5854 (0.6280) acc_x 81.2500 (83.6250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:802
clean false:7
clean_rate:0.9913473423980222
noisy true:437
noisy false:354
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [106/200] batch [5/25] time 0.166 (0.171) data 0.089 (0.094) loss_x loss_x 0.5493 (0.5931) acc_x 84.3750 (83.1250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/25] time 0.161 (0.170) data 0.083 (0.093) loss_x loss_x 0.6255 (0.5475) acc_x 90.6250 (85.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/25] time 0.171 (0.169) data 0.094 (0.092) loss_x loss_x 0.8057 (0.5697) acc_x 78.1250 (84.5833) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/25] time 0.177 (0.172) data 0.099 (0.095) loss_x loss_x 0.5288 (0.6006) acc_x 84.3750 (82.9688) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [25/25] time 0.167 (0.172) data 0.090 (0.095) loss_x loss_x 0.4600 (0.5899) acc_x 90.6250 (83.0000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 790
clean true:782
clean false:8
clean_rate:0.9898734177215189
noisy true:438
noisy false:372
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 810
epoch [107/200] batch [5/24] time 0.197 (0.179) data 0.120 (0.101) loss_x loss_x 0.4702 (0.3849) acc_x 87.5000 (88.7500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/24] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.5776 (0.4742) acc_x 90.6250 (88.1250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/24] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.8833 (0.5117) acc_x 78.1250 (86.4583) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/24] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.4580 (0.4883) acc_x 87.5000 (86.5625) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:788
clean false:7
clean_rate:0.9911949685534591
noisy true:443
noisy false:362
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [108/200] batch [5/24] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.2220 (0.5915) acc_x 90.6250 (83.1250) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/24] time 0.173 (0.167) data 0.096 (0.090) loss_x loss_x 0.7427 (0.6305) acc_x 75.0000 (80.9375) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/24] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.3308 (0.6491) acc_x 90.6250 (81.2500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/24] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.9922 (0.6576) acc_x 68.7500 (81.4062) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:807
clean false:10
clean_rate:0.9877600979192166
noisy true:431
noisy false:352
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [109/200] batch [5/25] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 0.6143 (0.6325) acc_x 87.5000 (82.5000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/25] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.7744 (0.6130) acc_x 78.1250 (83.4375) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/25] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.3066 (0.6168) acc_x 93.7500 (83.9583) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/25] time 0.184 (0.171) data 0.107 (0.094) loss_x loss_x 0.6880 (0.6265) acc_x 84.3750 (84.0625) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [25/25] time 0.180 (0.172) data 0.104 (0.095) loss_x loss_x 1.1758 (0.6321) acc_x 65.6250 (83.1250) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:808
clean false:7
clean_rate:0.9914110429447853
noisy true:439
noisy false:346
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [110/200] batch [5/25] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.5918 (0.5908) acc_x 84.3750 (86.8750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/25] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.4688 (0.6050) acc_x 84.3750 (84.6875) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/25] time 0.175 (0.178) data 0.098 (0.102) loss_x loss_x 0.5029 (0.5805) acc_x 87.5000 (85.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/25] time 0.162 (0.176) data 0.084 (0.099) loss_x loss_x 0.6582 (0.6223) acc_x 84.3750 (84.2188) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [25/25] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.2712 (0.5930) acc_x 96.8750 (85.1250) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:792
clean false:11
clean_rate:0.9863013698630136
noisy true:425
noisy false:372
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [111/200] batch [5/25] time 0.169 (0.175) data 0.091 (0.098) loss_x loss_x 0.3079 (0.5437) acc_x 90.6250 (85.0000) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/25] time 0.184 (0.174) data 0.108 (0.097) loss_x loss_x 0.7607 (0.6456) acc_x 71.8750 (81.2500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/25] time 0.186 (0.177) data 0.108 (0.100) loss_x loss_x 0.5229 (0.6153) acc_x 87.5000 (82.7083) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/25] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.5693 (0.5871) acc_x 84.3750 (83.4375) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [25/25] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.2959 (0.5575) acc_x 90.6250 (84.1250) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:804
clean false:11
clean_rate:0.9865030674846625
noisy true:427
noisy false:358
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [112/200] batch [5/25] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 0.7627 (0.6086) acc_x 81.2500 (83.1250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/25] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.7227 (0.6013) acc_x 75.0000 (83.4375) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/25] time 0.215 (0.177) data 0.138 (0.100) loss_x loss_x 0.4771 (0.5543) acc_x 96.8750 (85.2083) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/25] time 0.187 (0.179) data 0.110 (0.102) loss_x loss_x 0.2529 (0.5258) acc_x 96.8750 (85.9375) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [25/25] time 0.180 (0.177) data 0.103 (0.101) loss_x loss_x 0.4915 (0.5642) acc_x 84.3750 (85.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 799
clean true:790
clean false:9
clean_rate:0.9887359198998749
noisy true:438
noisy false:363
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 801
epoch [113/200] batch [5/24] time 0.211 (0.215) data 0.134 (0.138) loss_x loss_x 0.5093 (0.4933) acc_x 87.5000 (88.7500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/24] time 0.175 (0.205) data 0.098 (0.128) loss_x loss_x 1.1230 (0.6040) acc_x 68.7500 (84.6875) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/24] time 0.196 (0.203) data 0.120 (0.127) loss_x loss_x 0.2876 (0.5551) acc_x 96.8750 (86.6667) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/24] time 0.190 (0.201) data 0.113 (0.124) loss_x loss_x 0.5508 (0.5638) acc_x 81.2500 (85.6250) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 806
clean true:799
clean false:7
clean_rate:0.9913151364764268
noisy true:430
noisy false:364
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 794
epoch [114/200] batch [5/25] time 0.192 (0.212) data 0.115 (0.135) loss_x loss_x 0.6582 (0.6387) acc_x 81.2500 (82.5000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/25] time 0.193 (0.200) data 0.117 (0.124) loss_x loss_x 0.6069 (0.6479) acc_x 81.2500 (82.8125) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/25] time 0.193 (0.196) data 0.117 (0.119) loss_x loss_x 0.4602 (0.6257) acc_x 87.5000 (83.5417) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/25] time 0.197 (0.194) data 0.121 (0.117) loss_x loss_x 0.2651 (0.6097) acc_x 90.6250 (83.5938) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [25/25] time 0.193 (0.193) data 0.116 (0.117) loss_x loss_x 0.4817 (0.6133) acc_x 87.5000 (83.2500) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 786
clean true:777
clean false:9
clean_rate:0.9885496183206107
noisy true:436
noisy false:378
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 814
epoch [115/200] batch [5/24] time 0.181 (0.191) data 0.105 (0.114) loss_x loss_x 0.2661 (0.4746) acc_x 96.8750 (90.0000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/24] time 0.191 (0.187) data 0.114 (0.110) loss_x loss_x 0.4534 (0.4927) acc_x 87.5000 (89.0625) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/24] time 0.176 (0.183) data 0.097 (0.106) loss_x loss_x 0.4421 (0.4951) acc_x 90.6250 (88.5417) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/24] time 0.190 (0.184) data 0.114 (0.107) loss_x loss_x 0.3982 (0.5656) acc_x 81.2500 (85.7812) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:819
clean false:8
clean_rate:0.9903264812575574
noisy true:428
noisy false:345
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [116/200] batch [5/25] time 0.171 (0.177) data 0.093 (0.100) loss_x loss_x 0.5137 (0.5510) acc_x 87.5000 (82.5000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/25] time 0.171 (0.179) data 0.095 (0.102) loss_x loss_x 0.2627 (0.5168) acc_x 93.7500 (84.0625) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/25] time 0.196 (0.181) data 0.119 (0.104) loss_x loss_x 0.6367 (0.5584) acc_x 78.1250 (83.7500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/25] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.3513 (0.5719) acc_x 90.6250 (83.4375) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [25/25] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.8984 (0.5889) acc_x 75.0000 (83.3750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:804
clean false:10
clean_rate:0.9877149877149877
noisy true:445
noisy false:341
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [117/200] batch [5/25] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.3408 (0.5300) acc_x 93.7500 (90.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/25] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.4373 (0.5139) acc_x 93.7500 (88.4375) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/25] time 0.206 (0.179) data 0.129 (0.103) loss_x loss_x 0.5049 (0.5403) acc_x 84.3750 (87.2917) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/25] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.4407 (0.5150) acc_x 87.5000 (86.4062) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [25/25] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.3030 (0.5287) acc_x 93.7500 (86.5000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:815
clean false:10
clean_rate:0.9878787878787879
noisy true:431
noisy false:344
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [118/200] batch [5/25] time 0.175 (0.176) data 0.097 (0.099) loss_x loss_x 0.6313 (0.5744) acc_x 81.2500 (84.3750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/25] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.8740 (0.5333) acc_x 78.1250 (86.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/25] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 0.8413 (0.5983) acc_x 75.0000 (83.7500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/25] time 0.198 (0.179) data 0.121 (0.102) loss_x loss_x 0.6714 (0.6354) acc_x 87.5000 (83.2812) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [25/25] time 0.193 (0.180) data 0.116 (0.103) loss_x loss_x 0.8760 (0.6611) acc_x 84.3750 (82.7500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 790
clean true:784
clean false:6
clean_rate:0.9924050632911392
noisy true:439
noisy false:371
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 810
epoch [119/200] batch [5/24] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.1189 (0.4821) acc_x 100.0000 (88.1250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/24] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.5679 (0.5122) acc_x 90.6250 (87.1875) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/24] time 0.182 (0.175) data 0.104 (0.099) loss_x loss_x 0.5903 (0.5030) acc_x 87.5000 (87.7083) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/24] time 0.177 (0.176) data 0.099 (0.099) loss_x loss_x 0.1676 (0.4859) acc_x 93.7500 (87.1875) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:785
clean false:6
clean_rate:0.9924146649810367
noisy true:431
noisy false:378
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [120/200] batch [5/24] time 0.188 (0.186) data 0.111 (0.110) loss_x loss_x 0.3271 (0.4273) acc_x 93.7500 (90.6250) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/24] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.4385 (0.4933) acc_x 87.5000 (88.1250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/24] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.2505 (0.5219) acc_x 90.6250 (87.0833) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/24] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.4150 (0.5423) acc_x 87.5000 (85.9375) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 785
clean true:779
clean false:6
clean_rate:0.9923566878980892
noisy true:443
noisy false:372
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 815
epoch [121/200] batch [5/24] time 0.190 (0.193) data 0.113 (0.117) loss_x loss_x 0.1726 (0.4375) acc_x 96.8750 (91.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/24] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.1124 (0.4508) acc_x 96.8750 (89.0625) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/24] time 0.161 (0.182) data 0.083 (0.105) loss_x loss_x 0.4241 (0.4939) acc_x 90.6250 (88.3333) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/24] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.4526 (0.5586) acc_x 87.5000 (86.5625) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:799
clean false:6
clean_rate:0.9925465838509316
noisy true:445
noisy false:350
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [122/200] batch [5/25] time 0.178 (0.179) data 0.101 (0.101) loss_x loss_x 0.2578 (0.5416) acc_x 96.8750 (86.8750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/25] time 0.176 (0.179) data 0.099 (0.101) loss_x loss_x 0.6948 (0.5283) acc_x 78.1250 (86.5625) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/25] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.4006 (0.5807) acc_x 87.5000 (85.2083) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/25] time 0.182 (0.178) data 0.105 (0.100) loss_x loss_x 0.5054 (0.5634) acc_x 84.3750 (85.4688) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [25/25] time 0.167 (0.178) data 0.089 (0.101) loss_x loss_x 0.6660 (0.5373) acc_x 81.2500 (85.8750) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:798
clean false:9
clean_rate:0.9888475836431226
noisy true:423
noisy false:370
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [123/200] batch [5/25] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.5854 (0.4727) acc_x 81.2500 (88.1250) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/25] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.3008 (0.4880) acc_x 93.7500 (87.5000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/25] time 0.165 (0.182) data 0.088 (0.105) loss_x loss_x 0.9678 (0.5273) acc_x 78.1250 (86.6667) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/25] time 0.197 (0.182) data 0.120 (0.105) loss_x loss_x 0.7402 (0.5371) acc_x 78.1250 (86.0938) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [25/25] time 0.164 (0.180) data 0.087 (0.103) loss_x loss_x 0.6299 (0.5329) acc_x 87.5000 (86.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:805
clean false:6
clean_rate:0.9926017262638718
noisy true:441
noisy false:348
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [124/200] batch [5/25] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.6792 (0.5407) acc_x 81.2500 (85.6250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/25] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.5234 (0.5645) acc_x 84.3750 (84.0625) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/25] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 0.5430 (0.5527) acc_x 84.3750 (85.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/25] time 0.213 (0.179) data 0.136 (0.102) loss_x loss_x 0.4678 (0.5423) acc_x 93.7500 (85.1562) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [25/25] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.4424 (0.5578) acc_x 81.2500 (84.8750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:801
clean false:7
clean_rate:0.9913366336633663
noisy true:422
noisy false:370
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [125/200] batch [5/25] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.5430 (0.4706) acc_x 90.6250 (87.5000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/25] time 0.173 (0.191) data 0.096 (0.114) loss_x loss_x 0.2725 (0.4862) acc_x 93.7500 (87.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/25] time 0.182 (0.193) data 0.105 (0.116) loss_x loss_x 0.6533 (0.4808) acc_x 78.1250 (85.8333) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/25] time 0.208 (0.196) data 0.131 (0.119) loss_x loss_x 0.3474 (0.5175) acc_x 93.7500 (85.6250) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [25/25] time 0.173 (0.194) data 0.095 (0.117) loss_x loss_x 0.3777 (0.4812) acc_x 90.6250 (86.3750) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:807
clean false:10
clean_rate:0.9877600979192166
noisy true:440
noisy false:343
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [126/200] batch [5/25] time 0.199 (0.172) data 0.122 (0.095) loss_x loss_x 0.5005 (0.6942) acc_x 87.5000 (81.2500) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/25] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.8452 (0.6550) acc_x 75.0000 (82.5000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/25] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.4949 (0.5994) acc_x 87.5000 (83.5417) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/25] time 0.183 (0.180) data 0.105 (0.103) loss_x loss_x 0.4890 (0.5987) acc_x 87.5000 (84.0625) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [25/25] time 0.166 (0.182) data 0.088 (0.105) loss_x loss_x 0.8853 (0.5957) acc_x 71.8750 (84.0000) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:803
clean false:6
clean_rate:0.992583436341162
noisy true:432
noisy false:359
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [127/200] batch [5/25] time 0.196 (0.192) data 0.120 (0.115) loss_x loss_x 0.1510 (0.3962) acc_x 96.8750 (92.5000) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/25] time 0.185 (0.188) data 0.107 (0.111) loss_x loss_x 0.6895 (0.4740) acc_x 81.2500 (88.1250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/25] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.1451 (0.5076) acc_x 100.0000 (87.5000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/25] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.7119 (0.5044) acc_x 84.3750 (87.0312) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [25/25] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.5791 (0.5346) acc_x 87.5000 (86.5000) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.5231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 837
clean true:830
clean false:7
clean_rate:0.991636798088411
noisy true:431
noisy false:332
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 763
epoch [128/200] batch [5/26] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.8145 (0.5942) acc_x 81.2500 (85.0000) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/26] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.3535 (0.5570) acc_x 93.7500 (85.6250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/26] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3833 (0.5779) acc_x 93.7500 (85.6250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/26] time 0.190 (0.183) data 0.113 (0.107) loss_x loss_x 0.4038 (0.5974) acc_x 90.6250 (85.0000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/26] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6758 (0.6096) acc_x 87.5000 (84.2500) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:809
clean false:10
clean_rate:0.9877899877899878
noisy true:423
noisy false:358
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [129/200] batch [5/25] time 0.160 (0.164) data 0.084 (0.088) loss_x loss_x 0.4692 (0.7100) acc_x 84.3750 (80.6250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/25] time 0.179 (0.169) data 0.103 (0.092) loss_x loss_x 0.4883 (0.6220) acc_x 90.6250 (83.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/25] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.8745 (0.5945) acc_x 78.1250 (83.5417) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/25] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.2971 (0.6007) acc_x 93.7500 (84.0625) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [25/25] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.7349 (0.6110) acc_x 84.3750 (84.1250) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:806
clean false:8
clean_rate:0.9901719901719902
noisy true:419
noisy false:367
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [130/200] batch [5/25] time 0.189 (0.187) data 0.112 (0.109) loss_x loss_x 0.5117 (0.4548) acc_x 84.3750 (88.1250) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/25] time 0.191 (0.186) data 0.114 (0.109) loss_x loss_x 0.4465 (0.5056) acc_x 84.3750 (86.5625) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/25] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.8574 (0.6066) acc_x 75.0000 (83.7500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/25] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.6006 (0.5739) acc_x 81.2500 (83.9062) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [25/25] time 0.160 (0.181) data 0.084 (0.104) loss_x loss_x 0.5605 (0.5971) acc_x 90.6250 (84.1250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:800
clean false:10
clean_rate:0.9876543209876543
noisy true:418
noisy false:372
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [131/200] batch [5/25] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.8965 (0.4916) acc_x 78.1250 (87.5000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/25] time 0.193 (0.190) data 0.116 (0.113) loss_x loss_x 0.3213 (0.5644) acc_x 96.8750 (85.9375) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/25] time 0.172 (0.188) data 0.095 (0.110) loss_x loss_x 0.2273 (0.5745) acc_x 93.7500 (85.6250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/25] time 0.212 (0.187) data 0.135 (0.110) loss_x loss_x 0.9785 (0.5969) acc_x 78.1250 (85.1562) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [25/25] time 0.186 (0.188) data 0.109 (0.110) loss_x loss_x 0.4290 (0.5639) acc_x 93.7500 (85.8750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 794
clean true:785
clean false:9
clean_rate:0.9886649874055415
noisy true:429
noisy false:377
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 806
epoch [132/200] batch [5/24] time 0.192 (0.190) data 0.115 (0.113) loss_x loss_x 0.3765 (0.5321) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/24] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.6660 (0.5965) acc_x 84.3750 (86.5625) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/24] time 0.172 (0.184) data 0.095 (0.107) loss_x loss_x 0.5771 (0.5670) acc_x 81.2500 (86.2500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/24] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.8301 (0.5625) acc_x 65.6250 (85.4688) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.5194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 831
clean true:818
clean false:13
clean_rate:0.9843561973525873
noisy true:435
noisy false:334
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 769
epoch [133/200] batch [5/25] time 0.168 (0.180) data 0.091 (0.104) loss_x loss_x 0.6963 (0.4882) acc_x 81.2500 (87.5000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/25] time 0.217 (0.186) data 0.140 (0.109) loss_x loss_x 0.3799 (0.6375) acc_x 90.6250 (85.3125) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/25] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 1.0127 (0.6014) acc_x 78.1250 (86.0417) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/25] time 0.193 (0.187) data 0.116 (0.110) loss_x loss_x 0.6323 (0.5750) acc_x 81.2500 (86.5625) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [25/25] time 0.221 (0.188) data 0.144 (0.111) loss_x loss_x 0.4570 (0.5600) acc_x 84.3750 (86.5000) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:811
clean false:8
clean_rate:0.9902319902319903
noisy true:447
noisy false:334
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [134/200] batch [5/25] time 0.190 (0.193) data 0.113 (0.117) loss_x loss_x 0.6519 (0.5251) acc_x 81.2500 (87.5000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/25] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.6426 (0.5439) acc_x 78.1250 (86.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/25] time 0.250 (0.191) data 0.174 (0.114) loss_x loss_x 0.2827 (0.5890) acc_x 96.8750 (84.5833) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/25] time 0.178 (0.189) data 0.101 (0.112) loss_x loss_x 0.4080 (0.5910) acc_x 90.6250 (83.9062) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [25/25] time 0.204 (0.188) data 0.127 (0.111) loss_x loss_x 0.4109 (0.5638) acc_x 90.6250 (84.8750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 801
clean true:791
clean false:10
clean_rate:0.9875156054931336
noisy true:429
noisy false:370
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 799
epoch [135/200] batch [5/25] time 0.180 (0.193) data 0.103 (0.116) loss_x loss_x 0.8516 (0.5569) acc_x 75.0000 (83.7500) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/25] time 0.188 (0.190) data 0.111 (0.113) loss_x loss_x 0.6763 (0.5486) acc_x 84.3750 (84.0625) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/25] time 0.170 (0.189) data 0.093 (0.112) loss_x loss_x 0.7124 (0.6043) acc_x 81.2500 (83.5417) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/25] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.4543 (0.6083) acc_x 87.5000 (83.5938) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [25/25] time 0.175 (0.189) data 0.098 (0.112) loss_x loss_x 0.6855 (0.5942) acc_x 81.2500 (84.0000) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:801
clean false:8
clean_rate:0.9901112484548825
noisy true:449
noisy false:342
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [136/200] batch [5/25] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.3169 (0.7008) acc_x 90.6250 (83.1250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/25] time 0.263 (0.193) data 0.186 (0.117) loss_x loss_x 0.5288 (0.6577) acc_x 84.3750 (84.6875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/25] time 0.202 (0.198) data 0.125 (0.121) loss_x loss_x 0.3035 (0.5316) acc_x 90.6250 (87.5000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/25] time 0.183 (0.200) data 0.106 (0.123) loss_x loss_x 0.7773 (0.5369) acc_x 78.1250 (86.5625) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [25/25] time 0.165 (0.195) data 0.088 (0.119) loss_x loss_x 0.5259 (0.5068) acc_x 84.3750 (87.0000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:800
clean false:13
clean_rate:0.984009840098401
noisy true:422
noisy false:365
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [137/200] batch [5/25] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.7358 (0.5729) acc_x 84.3750 (86.8750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/25] time 0.193 (0.177) data 0.116 (0.100) loss_x loss_x 0.8389 (0.6242) acc_x 78.1250 (85.9375) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/25] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.3682 (0.5897) acc_x 87.5000 (86.0417) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/25] time 0.191 (0.182) data 0.114 (0.105) loss_x loss_x 0.3684 (0.5905) acc_x 84.3750 (85.4688) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [25/25] time 0.196 (0.182) data 0.119 (0.106) loss_x loss_x 0.4612 (0.5477) acc_x 84.3750 (86.5000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 820
clean true:813
clean false:7
clean_rate:0.9914634146341463
noisy true:425
noisy false:355
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 780
epoch [138/200] batch [5/25] time 0.204 (0.188) data 0.127 (0.111) loss_x loss_x 0.2307 (0.5255) acc_x 90.6250 (88.7500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/25] time 0.168 (0.181) data 0.090 (0.104) loss_x loss_x 0.3328 (0.4850) acc_x 84.3750 (87.8125) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/25] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.3494 (0.4897) acc_x 90.6250 (87.2917) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/25] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.3992 (0.4872) acc_x 90.6250 (86.8750) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [25/25] time 0.192 (0.180) data 0.114 (0.103) loss_x loss_x 0.5015 (0.4615) acc_x 90.6250 (87.6250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:805
clean false:10
clean_rate:0.9877300613496932
noisy true:431
noisy false:354
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [139/200] batch [5/25] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 0.6436 (0.5620) acc_x 81.2500 (86.2500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/25] time 0.172 (0.172) data 0.095 (0.094) loss_x loss_x 0.4329 (0.5157) acc_x 90.6250 (87.1875) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/25] time 0.164 (0.171) data 0.087 (0.094) loss_x loss_x 0.3201 (0.5148) acc_x 93.7500 (86.8750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/25] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.2881 (0.4945) acc_x 93.7500 (86.8750) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [25/25] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.7539 (0.5112) acc_x 84.3750 (86.5000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:807
clean false:8
clean_rate:0.9901840490797545
noisy true:422
noisy false:363
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [140/200] batch [5/25] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.5073 (0.5873) acc_x 84.3750 (85.0000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/25] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.3347 (0.6268) acc_x 87.5000 (83.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/25] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.2332 (0.5750) acc_x 96.8750 (85.6250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/25] time 0.189 (0.183) data 0.112 (0.106) loss_x loss_x 0.6543 (0.5824) acc_x 84.3750 (85.1562) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [25/25] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.7422 (0.5685) acc_x 84.3750 (85.3750) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:808
clean false:11
clean_rate:0.9865689865689866
noisy true:425
noisy false:356
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [141/200] batch [5/25] time 0.171 (0.177) data 0.093 (0.099) loss_x loss_x 0.4277 (0.4515) acc_x 87.5000 (89.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/25] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.3774 (0.4932) acc_x 96.8750 (87.8125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/25] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.6431 (0.5785) acc_x 78.1250 (84.7917) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/25] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.5767 (0.5188) acc_x 81.2500 (86.4062) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [25/25] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.9175 (0.5621) acc_x 78.1250 (85.1250) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:819
clean false:6
clean_rate:0.9927272727272727
noisy true:442
noisy false:333
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [142/200] batch [5/25] time 0.178 (0.169) data 0.101 (0.092) loss_x loss_x 0.3601 (0.5871) acc_x 87.5000 (86.2500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/25] time 0.172 (0.173) data 0.094 (0.096) loss_x loss_x 0.8145 (0.6279) acc_x 75.0000 (84.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/25] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.5347 (0.6133) acc_x 81.2500 (84.7917) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/25] time 0.192 (0.176) data 0.115 (0.099) loss_x loss_x 0.8130 (0.5870) acc_x 84.3750 (85.9375) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [25/25] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.6597 (0.6105) acc_x 81.2500 (85.3750) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.5112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 818
clean true:811
clean false:7
clean_rate:0.991442542787286
noisy true:423
noisy false:359
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 782
epoch [143/200] batch [5/25] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 0.7832 (0.6266) acc_x 81.2500 (84.3750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/25] time 0.161 (0.168) data 0.084 (0.091) loss_x loss_x 0.7002 (0.5815) acc_x 84.3750 (86.2500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/25] time 0.179 (0.170) data 0.102 (0.093) loss_x loss_x 0.4497 (0.5936) acc_x 87.5000 (84.5833) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/25] time 0.177 (0.173) data 0.101 (0.096) loss_x loss_x 0.6187 (0.5777) acc_x 81.2500 (84.3750) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [25/25] time 0.187 (0.175) data 0.110 (0.098) loss_x loss_x 0.4966 (0.5849) acc_x 90.6250 (84.1250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 829
clean true:818
clean false:11
clean_rate:0.9867310012062727
noisy true:434
noisy false:337
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 771
epoch [144/200] batch [5/25] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.5972 (0.6282) acc_x 81.2500 (86.8750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/25] time 0.196 (0.185) data 0.119 (0.107) loss_x loss_x 0.8950 (0.5852) acc_x 71.8750 (86.8750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/25] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.9175 (0.6342) acc_x 71.8750 (84.7917) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/25] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.6567 (0.6556) acc_x 84.3750 (84.6875) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [25/25] time 0.189 (0.180) data 0.112 (0.102) loss_x loss_x 0.5566 (0.6510) acc_x 84.3750 (84.2500) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:813
clean false:8
clean_rate:0.9902557856272838
noisy true:428
noisy false:351
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [145/200] batch [5/25] time 0.195 (0.194) data 0.118 (0.117) loss_x loss_x 0.1219 (0.5449) acc_x 96.8750 (84.3750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/25] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.3040 (0.4474) acc_x 87.5000 (88.1250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/25] time 0.200 (0.188) data 0.123 (0.111) loss_x loss_x 0.7119 (0.4551) acc_x 84.3750 (87.9167) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/25] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.7705 (0.4769) acc_x 81.2500 (87.0312) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [25/25] time 0.180 (0.188) data 0.104 (0.111) loss_x loss_x 0.4326 (0.4847) acc_x 84.3750 (86.8750) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 339
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:817
clean false:7
clean_rate:0.991504854368932
noisy true:444
noisy false:332
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [146/200] batch [5/25] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.8281 (0.5559) acc_x 81.2500 (86.8750) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/25] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.5957 (0.6074) acc_x 87.5000 (84.0625) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/25] time 0.184 (0.181) data 0.108 (0.104) loss_x loss_x 0.3381 (0.5744) acc_x 90.6250 (85.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/25] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4475 (0.5852) acc_x 84.3750 (84.5312) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [25/25] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.6729 (0.5874) acc_x 87.5000 (84.5000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:818
clean false:6
clean_rate:0.9927184466019418
noisy true:425
noisy false:351
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [147/200] batch [5/25] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4202 (0.6255) acc_x 84.3750 (83.7500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/25] time 0.222 (0.192) data 0.145 (0.115) loss_x loss_x 0.5137 (0.5739) acc_x 84.3750 (83.4375) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/25] time 0.181 (0.190) data 0.104 (0.113) loss_x loss_x 0.5669 (0.5501) acc_x 87.5000 (83.5417) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/25] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.3418 (0.5361) acc_x 93.7500 (84.8438) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [25/25] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.4302 (0.5747) acc_x 84.3750 (84.2500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:794
clean false:8
clean_rate:0.9900249376558603
noisy true:437
noisy false:361
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [148/200] batch [5/25] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 1.0479 (0.6909) acc_x 75.0000 (83.1250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/25] time 0.156 (0.175) data 0.079 (0.098) loss_x loss_x 0.5391 (0.5534) acc_x 84.3750 (85.9375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/25] time 0.184 (0.175) data 0.108 (0.098) loss_x loss_x 0.4771 (0.5463) acc_x 90.6250 (86.2500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/25] time 0.158 (0.176) data 0.081 (0.099) loss_x loss_x 0.4778 (0.5395) acc_x 87.5000 (85.9375) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [25/25] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.5869 (0.5471) acc_x 84.3750 (85.6250) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:798
clean false:10
clean_rate:0.9876237623762376
noisy true:426
noisy false:366
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [149/200] batch [5/25] time 0.183 (0.192) data 0.106 (0.115) loss_x loss_x 0.5586 (0.3969) acc_x 84.3750 (89.3750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/25] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.3755 (0.4504) acc_x 93.7500 (87.8125) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/25] time 0.188 (0.187) data 0.110 (0.110) loss_x loss_x 0.1483 (0.4509) acc_x 96.8750 (87.2917) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/25] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.5952 (0.4718) acc_x 81.2500 (86.5625) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [25/25] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.5708 (0.4793) acc_x 84.3750 (86.2500) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:822
clean false:8
clean_rate:0.9903614457831326
noisy true:434
noisy false:336
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [150/200] batch [5/25] time 0.184 (0.189) data 0.107 (0.111) loss_x loss_x 1.0498 (0.7615) acc_x 81.2500 (81.2500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/25] time 0.180 (0.188) data 0.103 (0.111) loss_x loss_x 0.7192 (0.6645) acc_x 81.2500 (83.4375) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/25] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.4893 (0.5957) acc_x 84.3750 (84.7917) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/25] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.2107 (0.5693) acc_x 96.8750 (84.6875) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [25/25] time 0.232 (0.184) data 0.154 (0.107) loss_x loss_x 0.4424 (0.5591) acc_x 87.5000 (84.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5213, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 834
clean true:826
clean false:8
clean_rate:0.9904076738609112
noisy true:439
noisy false:327
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 766
epoch [151/200] batch [5/26] time 0.176 (0.162) data 0.098 (0.085) loss_x loss_x 0.5981 (0.5670) acc_x 84.3750 (87.5000) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/26] time 0.161 (0.166) data 0.084 (0.089) loss_x loss_x 0.8716 (0.6098) acc_x 81.2500 (85.3125) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/26] time 0.184 (0.169) data 0.107 (0.092) loss_x loss_x 0.5015 (0.5876) acc_x 90.6250 (85.6250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/26] time 0.184 (0.173) data 0.106 (0.096) loss_x loss_x 0.6670 (0.6005) acc_x 84.3750 (85.3125) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/26] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.2732 (0.5850) acc_x 93.7500 (85.6250) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 836
clean true:829
clean false:7
clean_rate:0.9916267942583732
noisy true:435
noisy false:329
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 764
epoch [152/200] batch [5/26] time 0.178 (0.176) data 0.101 (0.100) loss_x loss_x 0.5044 (0.5033) acc_x 87.5000 (88.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/26] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.3198 (0.5231) acc_x 93.7500 (87.1875) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/26] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 0.4368 (0.5266) acc_x 87.5000 (86.2500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/26] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.3201 (0.5195) acc_x 93.7500 (86.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/26] time 0.177 (0.172) data 0.100 (0.095) loss_x loss_x 0.5884 (0.5323) acc_x 90.6250 (86.8750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:817
clean false:10
clean_rate:0.9879081015719468
noisy true:447
noisy false:326
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [153/200] batch [5/25] time 0.166 (0.171) data 0.089 (0.094) loss_x loss_x 0.4114 (0.4821) acc_x 87.5000 (85.0000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/25] time 0.183 (0.173) data 0.105 (0.096) loss_x loss_x 0.5918 (0.5687) acc_x 87.5000 (85.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/25] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.7280 (0.5623) acc_x 78.1250 (84.7917) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/25] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.3264 (0.5585) acc_x 90.6250 (84.5312) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [25/25] time 0.190 (0.184) data 0.112 (0.108) loss_x loss_x 0.7773 (0.5487) acc_x 78.1250 (85.0000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:813
clean false:9
clean_rate:0.9890510948905109
noisy true:436
noisy false:342
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [154/200] batch [5/25] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.7148 (0.5697) acc_x 87.5000 (86.2500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/25] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.4624 (0.4951) acc_x 84.3750 (86.5625) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/25] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.3914 (0.4887) acc_x 87.5000 (86.6667) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/25] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.6025 (0.5094) acc_x 81.2500 (85.7812) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [25/25] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.4556 (0.5259) acc_x 93.7500 (86.0000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:794
clean false:13
clean_rate:0.9838909541511772
noisy true:431
noisy false:362
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [155/200] batch [5/25] time 0.197 (0.182) data 0.120 (0.104) loss_x loss_x 0.4041 (0.5345) acc_x 90.6250 (86.2500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/25] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.6729 (0.6112) acc_x 84.3750 (83.7500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/25] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4958 (0.6223) acc_x 87.5000 (83.5417) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/25] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.8535 (0.6387) acc_x 84.3750 (82.8125) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [25/25] time 0.171 (0.181) data 0.094 (0.104) loss_x loss_x 0.6738 (0.6268) acc_x 84.3750 (83.5000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:806
clean false:9
clean_rate:0.9889570552147239
noisy true:431
noisy false:354
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [156/200] batch [5/25] time 0.176 (0.183) data 0.098 (0.106) loss_x loss_x 0.5967 (0.5372) acc_x 87.5000 (86.2500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/25] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.3850 (0.5033) acc_x 90.6250 (86.2500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/25] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.3906 (0.5148) acc_x 93.7500 (86.0417) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/25] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.6577 (0.5787) acc_x 78.1250 (84.2188) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [25/25] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.7036 (0.5667) acc_x 84.3750 (84.7500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:787
clean false:8
clean_rate:0.989937106918239
noisy true:438
noisy false:367
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [157/200] batch [5/24] time 0.190 (0.185) data 0.112 (0.108) loss_x loss_x 0.1144 (0.3803) acc_x 100.0000 (91.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/24] time 0.187 (0.186) data 0.111 (0.109) loss_x loss_x 0.5273 (0.4735) acc_x 81.2500 (86.8750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/24] time 0.183 (0.188) data 0.105 (0.111) loss_x loss_x 0.5088 (0.4587) acc_x 87.5000 (87.5000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/24] time 0.166 (0.186) data 0.090 (0.109) loss_x loss_x 0.7607 (0.5025) acc_x 78.1250 (86.8750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.5075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 812
clean true:806
clean false:6
clean_rate:0.9926108374384236
noisy true:445
noisy false:343
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 788
epoch [158/200] batch [5/25] time 0.201 (0.208) data 0.124 (0.131) loss_x loss_x 0.3064 (0.5536) acc_x 90.6250 (87.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/25] time 0.184 (0.198) data 0.108 (0.121) loss_x loss_x 0.2561 (0.5130) acc_x 93.7500 (86.5625) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/25] time 0.183 (0.191) data 0.107 (0.115) loss_x loss_x 0.0826 (0.4842) acc_x 100.0000 (87.5000) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/25] time 0.184 (0.192) data 0.106 (0.115) loss_x loss_x 0.6587 (0.5080) acc_x 87.5000 (86.8750) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [25/25] time 0.182 (0.192) data 0.105 (0.115) loss_x loss_x 0.8022 (0.5410) acc_x 78.1250 (86.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.5256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 841
clean true:830
clean false:11
clean_rate:0.9869203329369798
noisy true:436
noisy false:323
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 759
epoch [159/200] batch [5/26] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.1656 (0.5132) acc_x 96.8750 (86.8750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/26] time 0.163 (0.179) data 0.085 (0.102) loss_x loss_x 0.7812 (0.5507) acc_x 81.2500 (86.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/26] time 0.177 (0.178) data 0.099 (0.101) loss_x loss_x 0.9282 (0.5714) acc_x 84.3750 (86.0417) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/26] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.5449 (0.5994) acc_x 87.5000 (85.7812) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/26] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.5625 (0.5873) acc_x 87.5000 (86.1250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:816
clean false:9
clean_rate:0.9890909090909091
noisy true:431
noisy false:344
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [160/200] batch [5/25] time 0.165 (0.184) data 0.088 (0.107) loss_x loss_x 0.5781 (0.4287) acc_x 84.3750 (90.6250) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/25] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.9658 (0.5373) acc_x 68.7500 (86.8750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/25] time 0.189 (0.178) data 0.113 (0.101) loss_x loss_x 0.8774 (0.5947) acc_x 81.2500 (85.4167) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/25] time 0.197 (0.181) data 0.120 (0.104) loss_x loss_x 0.6113 (0.6329) acc_x 84.3750 (84.5312) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [25/25] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.1285 (0.6094) acc_x 100.0000 (85.5000) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:803
clean false:13
clean_rate:0.9840686274509803
noisy true:416
noisy false:368
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [161/200] batch [5/25] time 0.183 (0.175) data 0.105 (0.098) loss_x loss_x 0.3745 (0.4315) acc_x 93.7500 (90.6250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/25] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.5869 (0.4783) acc_x 87.5000 (89.3750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/25] time 0.235 (0.185) data 0.159 (0.108) loss_x loss_x 0.7969 (0.5137) acc_x 71.8750 (87.7083) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/25] time 0.168 (0.184) data 0.092 (0.107) loss_x loss_x 0.5942 (0.5159) acc_x 84.3750 (87.3438) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [25/25] time 0.211 (0.184) data 0.134 (0.107) loss_x loss_x 0.3286 (0.5275) acc_x 93.7500 (87.0000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:816
clean false:10
clean_rate:0.9878934624697336
noisy true:444
noisy false:330
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [162/200] batch [5/25] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.3445 (0.4024) acc_x 90.6250 (88.7500) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/25] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.5693 (0.5646) acc_x 84.3750 (85.3125) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/25] time 0.175 (0.181) data 0.097 (0.104) loss_x loss_x 0.4043 (0.5290) acc_x 87.5000 (86.2500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/25] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.5186 (0.5392) acc_x 87.5000 (85.9375) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [25/25] time 0.179 (0.182) data 0.102 (0.104) loss_x loss_x 0.5659 (0.5436) acc_x 84.3750 (85.5000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:805
clean false:8
clean_rate:0.990159901599016
noisy true:452
noisy false:335
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [163/200] batch [5/25] time 0.197 (0.191) data 0.120 (0.114) loss_x loss_x 0.2522 (0.4361) acc_x 93.7500 (90.0000) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/25] time 0.202 (0.187) data 0.126 (0.110) loss_x loss_x 0.2944 (0.5261) acc_x 93.7500 (87.8125) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/25] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.3567 (0.5485) acc_x 87.5000 (86.4583) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/25] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.3196 (0.5123) acc_x 90.6250 (87.5000) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [25/25] time 0.166 (0.181) data 0.089 (0.104) loss_x loss_x 0.5771 (0.4862) acc_x 87.5000 (88.1250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.5225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 836
clean true:824
clean false:12
clean_rate:0.9856459330143541
noisy true:427
noisy false:337
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 764
epoch [164/200] batch [5/26] time 0.162 (0.179) data 0.086 (0.102) loss_x loss_x 0.4036 (0.6048) acc_x 93.7500 (86.8750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/26] time 0.199 (0.187) data 0.123 (0.110) loss_x loss_x 0.4668 (0.6009) acc_x 87.5000 (85.6250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/26] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.5781 (0.6650) acc_x 87.5000 (83.9583) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/26] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.1354 (0.6233) acc_x 96.8750 (84.0625) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/26] time 0.170 (0.184) data 0.094 (0.107) loss_x loss_x 0.6270 (0.6144) acc_x 81.2500 (84.5000) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 836
clean true:826
clean false:10
clean_rate:0.9880382775119617
noisy true:423
noisy false:341
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 764
epoch [165/200] batch [5/26] time 0.187 (0.205) data 0.110 (0.128) loss_x loss_x 1.0566 (0.5892) acc_x 78.1250 (85.6250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/26] time 0.165 (0.192) data 0.089 (0.115) loss_x loss_x 0.6509 (0.6394) acc_x 84.3750 (84.3750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/26] time 0.169 (0.185) data 0.092 (0.108) loss_x loss_x 0.5713 (0.5631) acc_x 81.2500 (86.2500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/26] time 0.168 (0.183) data 0.092 (0.106) loss_x loss_x 0.8169 (0.5556) acc_x 75.0000 (85.3125) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/26] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.2866 (0.5180) acc_x 93.7500 (86.7500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:799
clean false:8
clean_rate:0.990086741016109
noisy true:438
noisy false:355
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [166/200] batch [5/25] time 0.172 (0.188) data 0.095 (0.111) loss_x loss_x 0.3340 (0.4865) acc_x 93.7500 (88.1250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/25] time 0.171 (0.178) data 0.093 (0.101) loss_x loss_x 0.7490 (0.5512) acc_x 87.5000 (86.5625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/25] time 0.247 (0.183) data 0.170 (0.106) loss_x loss_x 0.4978 (0.5605) acc_x 87.5000 (85.6250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/25] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.4309 (0.5372) acc_x 87.5000 (85.9375) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [25/25] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.5449 (0.5314) acc_x 90.6250 (86.3750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:819
clean false:11
clean_rate:0.9867469879518073
noisy true:446
noisy false:324
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [167/200] batch [5/25] time 0.181 (0.170) data 0.103 (0.093) loss_x loss_x 0.3955 (0.5418) acc_x 90.6250 (86.2500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/25] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.6987 (0.5429) acc_x 84.3750 (85.3125) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/25] time 0.183 (0.176) data 0.105 (0.099) loss_x loss_x 0.4741 (0.5327) acc_x 90.6250 (85.4167) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/25] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.4768 (0.5247) acc_x 87.5000 (85.6250) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [25/25] time 0.202 (0.178) data 0.126 (0.101) loss_x loss_x 0.3027 (0.5133) acc_x 87.5000 (85.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:800
clean false:10
clean_rate:0.9876543209876543
noisy true:446
noisy false:344
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [168/200] batch [5/25] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.5957 (0.5351) acc_x 81.2500 (87.5000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/25] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.3218 (0.4180) acc_x 90.6250 (89.0625) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/25] time 0.173 (0.177) data 0.097 (0.100) loss_x loss_x 0.7266 (0.4819) acc_x 84.3750 (88.1250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/25] time 0.203 (0.179) data 0.125 (0.102) loss_x loss_x 0.8535 (0.5209) acc_x 75.0000 (87.1875) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [25/25] time 0.187 (0.182) data 0.109 (0.105) loss_x loss_x 0.3599 (0.5141) acc_x 90.6250 (87.1250) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 839
clean true:829
clean false:10
clean_rate:0.9880810488676997
noisy true:436
noisy false:325
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 761
epoch [169/200] batch [5/26] time 0.189 (0.183) data 0.112 (0.106) loss_x loss_x 0.6406 (0.5974) acc_x 84.3750 (84.3750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/26] time 0.174 (0.182) data 0.097 (0.105) loss_x loss_x 0.3179 (0.5556) acc_x 93.7500 (85.6250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/26] time 0.189 (0.180) data 0.112 (0.103) loss_x loss_x 0.5762 (0.5730) acc_x 87.5000 (85.2083) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/26] time 0.158 (0.180) data 0.081 (0.103) loss_x loss_x 0.6670 (0.5597) acc_x 84.3750 (85.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/26] time 0.168 (0.180) data 0.092 (0.104) loss_x loss_x 0.7070 (0.5916) acc_x 84.3750 (84.6250) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:799
clean false:9
clean_rate:0.9888613861386139
noisy true:441
noisy false:351
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [170/200] batch [5/25] time 0.179 (0.178) data 0.101 (0.101) loss_x loss_x 0.2920 (0.5424) acc_x 87.5000 (80.6250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/25] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.2300 (0.5389) acc_x 93.7500 (82.5000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/25] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.7041 (0.5413) acc_x 84.3750 (84.1667) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/25] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.4360 (0.5307) acc_x 90.6250 (84.8438) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [25/25] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.5391 (0.5393) acc_x 87.5000 (85.1250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 823
clean true:812
clean false:11
clean_rate:0.9866342648845686
noisy true:435
noisy false:342
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 777
epoch [171/200] batch [5/25] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4336 (0.4022) acc_x 87.5000 (88.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/25] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.3521 (0.4778) acc_x 90.6250 (86.5625) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/25] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.7119 (0.5555) acc_x 84.3750 (85.2083) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/25] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 0.9004 (0.6004) acc_x 65.6250 (83.1250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [25/25] time 0.194 (0.183) data 0.118 (0.106) loss_x loss_x 0.1797 (0.5682) acc_x 96.8750 (84.1250) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:805
clean false:10
clean_rate:0.9877300613496932
noisy true:423
noisy false:362
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [172/200] batch [5/25] time 0.186 (0.192) data 0.108 (0.115) loss_x loss_x 0.2419 (0.4192) acc_x 96.8750 (90.0000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/25] time 0.171 (0.190) data 0.094 (0.113) loss_x loss_x 0.3660 (0.4464) acc_x 90.6250 (87.8125) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/25] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.3044 (0.4696) acc_x 93.7500 (87.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/25] time 0.172 (0.185) data 0.096 (0.109) loss_x loss_x 0.5659 (0.5074) acc_x 81.2500 (86.7188) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [25/25] time 0.171 (0.185) data 0.094 (0.108) loss_x loss_x 0.5459 (0.5108) acc_x 87.5000 (86.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:805
clean false:11
clean_rate:0.9865196078431373
noisy true:441
noisy false:343
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [173/200] batch [5/25] time 0.173 (0.174) data 0.096 (0.098) loss_x loss_x 0.6133 (0.6104) acc_x 87.5000 (84.3750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/25] time 0.177 (0.179) data 0.101 (0.102) loss_x loss_x 0.5698 (0.5758) acc_x 78.1250 (84.3750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/25] time 0.176 (0.179) data 0.100 (0.102) loss_x loss_x 0.5269 (0.5874) acc_x 84.3750 (83.3333) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/25] time 0.188 (0.180) data 0.110 (0.103) loss_x loss_x 0.9214 (0.5835) acc_x 81.2500 (83.9062) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [25/25] time 0.187 (0.181) data 0.111 (0.104) loss_x loss_x 0.5137 (0.5671) acc_x 84.3750 (84.2500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:818
clean false:6
clean_rate:0.9927184466019418
noisy true:442
noisy false:334
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [174/200] batch [5/25] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.2032 (0.3626) acc_x 96.8750 (91.2500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/25] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.4248 (0.3917) acc_x 87.5000 (90.3125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/25] time 0.194 (0.183) data 0.117 (0.106) loss_x loss_x 0.6353 (0.4664) acc_x 81.2500 (87.9167) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/25] time 0.190 (0.186) data 0.112 (0.109) loss_x loss_x 0.5693 (0.5121) acc_x 81.2500 (86.8750) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [25/25] time 0.166 (0.186) data 0.089 (0.109) loss_x loss_x 0.3813 (0.5247) acc_x 84.3750 (86.3750) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:802
clean false:6
clean_rate:0.9925742574257426
noisy true:430
noisy false:362
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [175/200] batch [5/25] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.6621 (0.4798) acc_x 78.1250 (88.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/25] time 0.165 (0.185) data 0.089 (0.108) loss_x loss_x 0.4329 (0.5092) acc_x 93.7500 (88.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/25] time 0.182 (0.182) data 0.104 (0.104) loss_x loss_x 0.3987 (0.4914) acc_x 87.5000 (87.2917) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/25] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.3389 (0.4967) acc_x 87.5000 (87.3438) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [25/25] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.3523 (0.4864) acc_x 90.6250 (87.5000) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:814
clean false:12
clean_rate:0.9854721549636803
noisy true:424
noisy false:350
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [176/200] batch [5/25] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.4578 (0.5111) acc_x 81.2500 (86.8750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/25] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.6255 (0.5666) acc_x 78.1250 (85.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/25] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.4172 (0.5667) acc_x 87.5000 (85.6250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/25] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.5854 (0.5658) acc_x 84.3750 (85.0000) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [25/25] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.9990 (0.5485) acc_x 71.8750 (85.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:814
clean false:10
clean_rate:0.9878640776699029
noisy true:411
noisy false:365
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [177/200] batch [5/25] time 0.165 (0.187) data 0.087 (0.110) loss_x loss_x 0.3892 (0.4499) acc_x 96.8750 (90.0000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/25] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.5088 (0.4415) acc_x 84.3750 (90.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/25] time 0.170 (0.187) data 0.094 (0.110) loss_x loss_x 0.5005 (0.4796) acc_x 87.5000 (88.7500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/25] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 0.9893 (0.5289) acc_x 78.1250 (87.3438) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [25/25] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.5591 (0.5139) acc_x 87.5000 (87.8750) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:815
clean false:10
clean_rate:0.9878787878787879
noisy true:423
noisy false:352
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [178/200] batch [5/25] time 0.165 (0.183) data 0.088 (0.106) loss_x loss_x 0.8398 (0.6956) acc_x 87.5000 (84.3750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/25] time 0.165 (0.181) data 0.087 (0.104) loss_x loss_x 0.2725 (0.6050) acc_x 96.8750 (85.9375) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/25] time 0.166 (0.180) data 0.089 (0.103) loss_x loss_x 0.4893 (0.5956) acc_x 84.3750 (85.2083) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/25] time 0.189 (0.182) data 0.112 (0.105) loss_x loss_x 0.4041 (0.5621) acc_x 81.2500 (85.1562) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [25/25] time 0.196 (0.184) data 0.120 (0.107) loss_x loss_x 0.5430 (0.5392) acc_x 90.6250 (86.0000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 806
clean true:797
clean false:9
clean_rate:0.988833746898263
noisy true:431
noisy false:363
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 794
epoch [179/200] batch [5/25] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.8140 (0.6464) acc_x 78.1250 (82.5000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/25] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.5181 (0.6188) acc_x 87.5000 (82.8125) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/25] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.2693 (0.5700) acc_x 93.7500 (84.5833) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/25] time 0.169 (0.183) data 0.092 (0.106) loss_x loss_x 0.5176 (0.6200) acc_x 84.3750 (84.0625) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [25/25] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.2008 (0.5858) acc_x 96.8750 (85.0000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:822
clean false:8
clean_rate:0.9903614457831326
noisy true:434
noisy false:336
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [180/200] batch [5/25] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.2490 (0.5257) acc_x 93.7500 (88.7500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/25] time 0.160 (0.164) data 0.084 (0.087) loss_x loss_x 0.4927 (0.4356) acc_x 90.6250 (90.9375) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/25] time 0.156 (0.162) data 0.079 (0.085) loss_x loss_x 0.3765 (0.4604) acc_x 93.7500 (89.3750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/25] time 0.160 (0.161) data 0.084 (0.085) loss_x loss_x 0.4194 (0.4590) acc_x 87.5000 (88.5938) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [25/25] time 0.157 (0.161) data 0.081 (0.085) loss_x loss_x 0.6616 (0.4861) acc_x 81.2500 (87.5000) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.5112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 818
clean true:808
clean false:10
clean_rate:0.9877750611246944
noisy true:423
noisy false:359
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 782
epoch [181/200] batch [5/25] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.5996 (0.4602) acc_x 81.2500 (86.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/25] time 0.175 (0.162) data 0.099 (0.085) loss_x loss_x 0.2764 (0.4842) acc_x 90.6250 (86.5625) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/25] time 0.183 (0.165) data 0.106 (0.089) loss_x loss_x 0.2134 (0.4711) acc_x 93.7500 (86.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/25] time 0.161 (0.164) data 0.084 (0.087) loss_x loss_x 0.3984 (0.4540) acc_x 87.5000 (87.5000) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [25/25] time 0.160 (0.163) data 0.084 (0.087) loss_x loss_x 0.4565 (0.4902) acc_x 84.3750 (86.5000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:811
clean false:11
clean_rate:0.98661800486618
noisy true:434
noisy false:344
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [182/200] batch [5/25] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.7666 (0.6182) acc_x 71.8750 (84.3750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/25] time 0.160 (0.161) data 0.084 (0.084) loss_x loss_x 0.7954 (0.6227) acc_x 84.3750 (84.3750) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/25] time 0.162 (0.161) data 0.085 (0.084) loss_x loss_x 0.3054 (0.5885) acc_x 90.6250 (84.7917) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/25] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.3806 (0.5588) acc_x 87.5000 (85.1562) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [25/25] time 0.164 (0.161) data 0.087 (0.084) loss_x loss_x 0.5918 (0.5374) acc_x 87.5000 (86.5000) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:803
clean false:8
clean_rate:0.9901356350184957
noisy true:422
noisy false:367
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [183/200] batch [5/25] time 0.160 (0.162) data 0.084 (0.086) loss_x loss_x 0.3359 (0.5169) acc_x 90.6250 (88.7500) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/25] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.4495 (0.5123) acc_x 87.5000 (85.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/25] time 0.157 (0.165) data 0.080 (0.088) loss_x loss_x 0.7261 (0.6190) acc_x 81.2500 (83.9583) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/25] time 0.165 (0.165) data 0.088 (0.087) loss_x loss_x 1.1318 (0.6162) acc_x 75.0000 (84.2188) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [25/25] time 0.160 (0.164) data 0.083 (0.087) loss_x loss_x 0.7568 (0.5914) acc_x 75.0000 (84.1250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:783
clean false:8
clean_rate:0.9898862199747156
noisy true:429
noisy false:380
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [184/200] batch [5/24] time 0.158 (0.162) data 0.081 (0.084) loss_x loss_x 0.5928 (0.5722) acc_x 87.5000 (86.2500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/24] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.5469 (0.5871) acc_x 84.3750 (84.3750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/24] time 0.162 (0.161) data 0.085 (0.084) loss_x loss_x 0.5938 (0.5394) acc_x 81.2500 (85.8333) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/24] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.1768 (0.5014) acc_x 93.7500 (86.8750) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:819
clean false:11
clean_rate:0.9867469879518073
noisy true:414
noisy false:356
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [185/200] batch [5/25] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.8916 (0.7382) acc_x 78.1250 (83.1250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/25] time 0.156 (0.160) data 0.080 (0.083) loss_x loss_x 0.7095 (0.6632) acc_x 75.0000 (82.8125) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/25] time 0.161 (0.159) data 0.084 (0.083) loss_x loss_x 0.5830 (0.6026) acc_x 84.3750 (83.9583) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/25] time 0.164 (0.160) data 0.086 (0.083) loss_x loss_x 0.3403 (0.5675) acc_x 84.3750 (83.9062) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [25/25] time 0.184 (0.161) data 0.107 (0.084) loss_x loss_x 0.7905 (0.5842) acc_x 78.1250 (84.0000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:803
clean false:10
clean_rate:0.9876998769987699
noisy true:429
noisy false:358
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [186/200] batch [5/25] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.6675 (0.4572) acc_x 78.1250 (85.0000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/25] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.3542 (0.5052) acc_x 84.3750 (84.6875) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/25] time 0.158 (0.159) data 0.082 (0.083) loss_x loss_x 1.1240 (0.5427) acc_x 75.0000 (84.5833) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/25] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.4258 (0.5363) acc_x 93.7500 (85.3125) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [25/25] time 0.185 (0.161) data 0.108 (0.084) loss_x loss_x 0.6436 (0.5405) acc_x 84.3750 (85.3750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.5181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 829
clean true:823
clean false:6
clean_rate:0.9927623642943305
noisy true:445
noisy false:326
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 771
epoch [187/200] batch [5/25] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.6255 (0.5755) acc_x 87.5000 (86.8750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/25] time 0.163 (0.163) data 0.085 (0.086) loss_x loss_x 0.7876 (0.5307) acc_x 81.2500 (87.8125) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/25] time 0.162 (0.163) data 0.085 (0.085) loss_x loss_x 0.5508 (0.5131) acc_x 87.5000 (88.1250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/25] time 0.168 (0.163) data 0.092 (0.086) loss_x loss_x 0.3386 (0.4772) acc_x 93.7500 (88.9062) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [25/25] time 0.164 (0.162) data 0.087 (0.085) loss_x loss_x 0.5410 (0.4883) acc_x 84.3750 (88.3750) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:798
clean false:9
clean_rate:0.9888475836431226
noisy true:434
noisy false:359
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [188/200] batch [5/25] time 0.160 (0.163) data 0.084 (0.086) loss_x loss_x 0.3562 (0.4285) acc_x 93.7500 (90.0000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/25] time 0.160 (0.161) data 0.084 (0.085) loss_x loss_x 0.2576 (0.4178) acc_x 93.7500 (89.6875) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/25] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.5601 (0.5066) acc_x 84.3750 (86.8750) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/25] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.6748 (0.5175) acc_x 81.2500 (86.0938) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [25/25] time 0.161 (0.161) data 0.084 (0.085) loss_x loss_x 0.3398 (0.5324) acc_x 90.6250 (86.0000) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 829
clean true:820
clean false:9
clean_rate:0.9891435464414958
noisy true:427
noisy false:344
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 771
epoch [189/200] batch [5/25] time 0.159 (0.157) data 0.082 (0.080) loss_x loss_x 0.5654 (0.5652) acc_x 84.3750 (85.6250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/25] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.5396 (0.5371) acc_x 78.1250 (85.0000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/25] time 0.157 (0.158) data 0.081 (0.080) loss_x loss_x 0.3267 (0.4765) acc_x 90.6250 (86.6667) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/25] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.5347 (0.4741) acc_x 81.2500 (86.7188) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [25/25] time 0.154 (0.157) data 0.077 (0.080) loss_x loss_x 0.2961 (0.4611) acc_x 93.7500 (87.1250) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:814
clean false:8
clean_rate:0.9902676399026764
noisy true:427
noisy false:351
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [190/200] batch [5/25] time 0.161 (0.157) data 0.084 (0.080) loss_x loss_x 0.2747 (0.5461) acc_x 87.5000 (84.3750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/25] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.4683 (0.5661) acc_x 87.5000 (84.3750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/25] time 0.159 (0.157) data 0.082 (0.080) loss_x loss_x 0.3533 (0.5378) acc_x 93.7500 (86.0417) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/25] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.5132 (0.5574) acc_x 78.1250 (85.3125) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [25/25] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.6353 (0.5556) acc_x 78.1250 (85.2500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:805
clean false:10
clean_rate:0.9877300613496932
noisy true:434
noisy false:351
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [191/200] batch [5/25] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.8662 (0.5105) acc_x 78.1250 (85.6250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/25] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.4219 (0.5473) acc_x 87.5000 (86.2500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/25] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.2018 (0.5089) acc_x 96.8750 (87.2917) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/25] time 0.159 (0.157) data 0.082 (0.080) loss_x loss_x 0.8330 (0.5509) acc_x 81.2500 (87.0312) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [25/25] time 0.161 (0.157) data 0.085 (0.080) loss_x loss_x 0.3857 (0.5474) acc_x 87.5000 (87.0000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:817
clean false:8
clean_rate:0.9903030303030304
noisy true:429
noisy false:346
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [192/200] batch [5/25] time 0.156 (0.159) data 0.078 (0.082) loss_x loss_x 0.5601 (0.5051) acc_x 78.1250 (83.7500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/25] time 0.155 (0.158) data 0.077 (0.081) loss_x loss_x 0.7549 (0.5038) acc_x 78.1250 (86.2500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/25] time 0.159 (0.157) data 0.082 (0.080) loss_x loss_x 0.9243 (0.5700) acc_x 81.2500 (84.7917) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/25] time 0.155 (0.158) data 0.078 (0.080) loss_x loss_x 0.3962 (0.5593) acc_x 90.6250 (85.3125) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [25/25] time 0.158 (0.158) data 0.080 (0.080) loss_x loss_x 0.1357 (0.5110) acc_x 100.0000 (86.6250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:802
clean false:9
clean_rate:0.9889025893958077
noisy true:441
noisy false:348
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [193/200] batch [5/25] time 0.166 (0.160) data 0.089 (0.083) loss_x loss_x 0.3418 (0.5278) acc_x 93.7500 (86.8750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/25] time 0.159 (0.159) data 0.082 (0.081) loss_x loss_x 0.1923 (0.5384) acc_x 96.8750 (87.1875) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/25] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.7891 (0.5523) acc_x 87.5000 (87.2917) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/25] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.3850 (0.5516) acc_x 90.6250 (87.0312) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [25/25] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.4329 (0.5371) acc_x 90.6250 (86.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.5200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 832
clean true:824
clean false:8
clean_rate:0.9903846153846154
noisy true:432
noisy false:336
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 768
epoch [194/200] batch [5/26] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.8169 (0.8276) acc_x 75.0000 (81.2500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/26] time 0.160 (0.157) data 0.083 (0.080) loss_x loss_x 0.3320 (0.6048) acc_x 93.7500 (86.2500) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/26] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.5078 (0.6231) acc_x 87.5000 (83.9583) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/26] time 0.155 (0.157) data 0.078 (0.080) loss_x loss_x 0.6240 (0.6002) acc_x 81.2500 (84.0625) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [25/26] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.4946 (0.6061) acc_x 81.2500 (83.8750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:814
clean false:7
clean_rate:0.9914738124238733
noisy true:427
noisy false:352
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [195/200] batch [5/25] time 0.162 (0.160) data 0.085 (0.083) loss_x loss_x 0.2400 (0.4583) acc_x 93.7500 (90.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/25] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.5195 (0.5055) acc_x 84.3750 (87.8125) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/25] time 0.160 (0.159) data 0.083 (0.081) loss_x loss_x 0.2266 (0.4824) acc_x 93.7500 (88.3333) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/25] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.5640 (0.5399) acc_x 90.6250 (87.0312) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [25/25] time 0.162 (0.158) data 0.085 (0.081) loss_x loss_x 0.4561 (0.5536) acc_x 87.5000 (86.6250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:804
clean false:10
clean_rate:0.9877149877149877
noisy true:455
noisy false:331
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [196/200] batch [5/25] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.4331 (0.5157) acc_x 87.5000 (86.8750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/25] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.6118 (0.5088) acc_x 81.2500 (85.9375) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/25] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.5391 (0.5597) acc_x 81.2500 (84.7917) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/25] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.4124 (0.5306) acc_x 90.6250 (86.0938) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [25/25] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.1614 (0.5082) acc_x 93.7500 (86.8750) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 833
clean true:826
clean false:7
clean_rate:0.9915966386554622
noisy true:432
noisy false:335
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 767
epoch [197/200] batch [5/26] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.3374 (0.4378) acc_x 87.5000 (89.3750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/26] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.3862 (0.4966) acc_x 84.3750 (87.1875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/26] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.2351 (0.5282) acc_x 93.7500 (85.8333) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/26] time 0.162 (0.157) data 0.085 (0.080) loss_x loss_x 0.3000 (0.5259) acc_x 90.6250 (85.6250) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [25/26] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.5684 (0.5376) acc_x 90.6250 (85.5000) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:814
clean false:8
clean_rate:0.9902676399026764
noisy true:432
noisy false:346
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [198/200] batch [5/25] time 0.156 (0.158) data 0.079 (0.080) loss_x loss_x 0.6143 (0.6176) acc_x 81.2500 (84.3750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/25] time 0.164 (0.159) data 0.087 (0.082) loss_x loss_x 0.5781 (0.5132) acc_x 84.3750 (87.5000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/25] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.2747 (0.5163) acc_x 93.7500 (86.4583) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/25] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.3032 (0.5232) acc_x 90.6250 (86.0938) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [25/25] time 0.159 (0.158) data 0.081 (0.081) loss_x loss_x 0.8760 (0.5644) acc_x 75.0000 (85.0000) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:813
clean false:12
clean_rate:0.9854545454545455
noisy true:442
noisy false:333
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [199/200] batch [5/25] time 0.155 (0.157) data 0.078 (0.080) loss_x loss_x 0.7729 (0.6007) acc_x 78.1250 (86.8750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/25] time 0.157 (0.157) data 0.079 (0.080) loss_x loss_x 0.7456 (0.5891) acc_x 84.3750 (85.3125) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/25] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.5757 (0.5917) acc_x 78.1250 (85.0000) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/25] time 0.159 (0.158) data 0.082 (0.080) loss_x loss_x 0.2397 (0.5570) acc_x 90.6250 (85.9375) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [25/25] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.2979 (0.5561) acc_x 87.5000 (85.7500) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 832
clean true:825
clean false:7
clean_rate:0.9915865384615384
noisy true:416
noisy false:352
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 768
epoch [200/200] batch [5/26] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.4216 (0.3866) acc_x 87.5000 (90.0000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/26] time 0.155 (0.158) data 0.078 (0.082) loss_x loss_x 0.4202 (0.5896) acc_x 84.3750 (84.3750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/26] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.4290 (0.5844) acc_x 90.6250 (84.5833) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/26] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.6743 (0.5378) acc_x 84.3750 (85.7812) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [25/26] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.4106 (0.5167) acc_x 87.5000 (86.2500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,230
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 86.4%
Elapsed: 0:43:13
