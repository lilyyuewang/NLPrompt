***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:469
clean false:2
clean_rate:0.9957537154989384
noisy true:286
noisy false:843
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [1/200] batch [5/14] time 0.208 (0.203) data 0.131 (0.110) loss_x loss_x 2.6328 (2.7961) acc_x 65.6250 (64.3750) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/14] time 0.191 (0.200) data 0.116 (0.115) loss_x loss_x 2.2637 (2.5725) acc_x 68.7500 (67.1875) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 703
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 558
clean true:554
clean false:4
clean_rate:0.992831541218638
noisy true:343
noisy false:699
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1042
epoch [2/200] batch [5/17] time 0.162 (0.163) data 0.085 (0.086) loss_x loss_x 0.9922 (1.4459) acc_x 68.7500 (63.7500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/17] time 0.180 (0.168) data 0.104 (0.091) loss_x loss_x 0.6655 (1.1453) acc_x 78.1250 (69.6875) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/17] time 0.163 (0.171) data 0.087 (0.095) loss_x loss_x 0.6333 (1.0926) acc_x 81.2500 (71.8750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 550
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:652
clean false:1
clean_rate:0.998468606431853
noisy true:398
noisy false:549
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [3/200] batch [5/20] time 0.180 (0.181) data 0.104 (0.106) loss_x loss_x 0.7554 (0.8768) acc_x 81.2500 (76.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/20] time 0.279 (0.186) data 0.094 (0.099) loss_x loss_x 0.9141 (0.8953) acc_x 78.1250 (77.1875) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/20] time 0.170 (0.182) data 0.094 (0.098) loss_x loss_x 1.5762 (0.9268) acc_x 56.2500 (75.4167) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [20/20] time 0.165 (0.177) data 0.089 (0.096) loss_x loss_x 0.9492 (0.8772) acc_x 71.8750 (77.0312) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:667
clean false:2
clean_rate:0.9970104633781763
noisy true:410
noisy false:521
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [4/200] batch [5/20] time 0.222 (0.190) data 0.146 (0.114) loss_x loss_x 1.2578 (0.8005) acc_x 75.0000 (79.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/20] time 0.183 (0.191) data 0.106 (0.110) loss_x loss_x 0.4316 (0.7747) acc_x 87.5000 (78.4375) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/20] time 0.179 (0.188) data 0.103 (0.109) loss_x loss_x 1.1406 (0.8319) acc_x 71.8750 (77.9167) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [20/20] time 0.181 (0.188) data 0.105 (0.110) loss_x loss_x 0.9814 (0.8475) acc_x 75.0000 (77.8125) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 518
confident_label rate tensor(0.4300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 688
clean true:684
clean false:4
clean_rate:0.9941860465116279
noisy true:398
noisy false:514
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 912
epoch [5/200] batch [5/21] time 0.186 (0.211) data 0.110 (0.106) loss_x loss_x 0.6748 (1.0121) acc_x 84.3750 (77.5000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/21] time 0.181 (0.198) data 0.106 (0.107) loss_x loss_x 0.3853 (0.9476) acc_x 84.3750 (77.5000) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/21] time 0.184 (0.196) data 0.108 (0.110) loss_x loss_x 0.5742 (0.8989) acc_x 87.5000 (79.1667) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/21] time 0.207 (0.193) data 0.131 (0.109) loss_x loss_x 1.1406 (0.8784) acc_x 59.3750 (78.1250) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 507
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 705
clean true:700
clean false:5
clean_rate:0.9929078014184397
noisy true:393
noisy false:502
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 895
epoch [6/200] batch [5/22] time 0.183 (0.187) data 0.106 (0.111) loss_x loss_x 1.0615 (0.8077) acc_x 71.8750 (75.6250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/22] time 0.186 (0.186) data 0.110 (0.110) loss_x loss_x 0.9556 (0.7644) acc_x 78.1250 (78.1250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/22] time 0.160 (0.183) data 0.083 (0.106) loss_x loss_x 0.4292 (0.7241) acc_x 84.3750 (79.3750) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/22] time 0.163 (0.178) data 0.086 (0.101) loss_x loss_x 0.6660 (0.7407) acc_x 81.2500 (79.8438) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 498
confident_label rate tensor(0.4312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 690
clean true:684
clean false:6
clean_rate:0.991304347826087
noisy true:418
noisy false:492
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 910
epoch [7/200] batch [5/21] time 0.158 (0.177) data 0.081 (0.101) loss_x loss_x 0.8833 (1.0070) acc_x 78.1250 (71.2500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/21] time 0.170 (0.174) data 0.094 (0.097) loss_x loss_x 0.9380 (0.9798) acc_x 71.8750 (72.8125) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/21] time 0.176 (0.177) data 0.100 (0.101) loss_x loss_x 0.4561 (0.8961) acc_x 87.5000 (75.0000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/21] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.5596 (0.8476) acc_x 84.3750 (77.0312) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 521
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:667
clean false:1
clean_rate:0.9985029940119761
noisy true:412
noisy false:520
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [8/200] batch [5/20] time 0.178 (0.177) data 0.102 (0.100) loss_x loss_x 1.1406 (0.8020) acc_x 71.8750 (78.7500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/20] time 0.164 (0.194) data 0.088 (0.098) loss_x loss_x 0.8345 (0.8119) acc_x 78.1250 (78.4375) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/20] time 0.166 (0.188) data 0.090 (0.098) loss_x loss_x 0.6528 (0.7818) acc_x 84.3750 (78.9583) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [20/20] time 0.162 (0.181) data 0.086 (0.095) loss_x loss_x 1.2051 (0.8305) acc_x 71.8750 (78.5938) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 700
clean true:698
clean false:2
clean_rate:0.9971428571428571
noisy true:412
noisy false:488
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 900
epoch [9/200] batch [5/21] time 0.199 (0.193) data 0.123 (0.116) loss_x loss_x 0.8081 (0.7235) acc_x 78.1250 (78.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/21] time 0.222 (0.192) data 0.113 (0.112) loss_x loss_x 0.8389 (0.7709) acc_x 81.2500 (78.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/21] time 0.182 (0.196) data 0.106 (0.111) loss_x loss_x 0.6021 (0.7746) acc_x 84.3750 (78.9583) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/21] time 0.163 (0.189) data 0.087 (0.107) loss_x loss_x 1.1377 (0.7801) acc_x 71.8750 (79.0625) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.4444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 711
clean true:710
clean false:1
clean_rate:0.9985935302390999
noisy true:411
noisy false:478
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 889
epoch [10/200] batch [5/22] time 0.168 (0.176) data 0.092 (0.099) loss_x loss_x 0.9038 (0.7859) acc_x 84.3750 (82.5000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/22] time 0.178 (0.177) data 0.102 (0.101) loss_x loss_x 0.8159 (0.7292) acc_x 78.1250 (80.6250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/22] time 0.185 (0.182) data 0.108 (0.106) loss_x loss_x 1.3125 (0.7999) acc_x 65.6250 (78.9583) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/22] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.8481 (0.8055) acc_x 75.0000 (79.2188) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.4425, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 708
clean true:706
clean false:2
clean_rate:0.9971751412429378
noisy true:417
noisy false:475
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 892
epoch [11/200] batch [5/22] time 0.170 (0.168) data 0.094 (0.092) loss_x loss_x 0.9575 (0.8208) acc_x 78.1250 (79.3750) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/22] time 0.167 (0.173) data 0.091 (0.097) loss_x loss_x 0.5244 (0.7583) acc_x 87.5000 (80.0000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/22] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.8032 (0.7332) acc_x 84.3750 (82.0833) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/22] time 0.173 (0.171) data 0.096 (0.095) loss_x loss_x 0.5913 (0.7304) acc_x 78.1250 (80.9375) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.4569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 731
clean true:727
clean false:4
clean_rate:0.9945280437756497
noisy true:416
noisy false:453
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 869
epoch [12/200] batch [5/22] time 0.191 (0.186) data 0.115 (0.110) loss_x loss_x 0.8550 (0.7199) acc_x 68.7500 (81.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/22] time 0.178 (0.188) data 0.102 (0.111) loss_x loss_x 1.0605 (0.8406) acc_x 81.2500 (78.4375) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/22] time 0.188 (0.188) data 0.112 (0.112) loss_x loss_x 0.3230 (0.7542) acc_x 87.5000 (80.8333) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/22] time 0.184 (0.187) data 0.108 (0.111) loss_x loss_x 0.7163 (0.7370) acc_x 78.1250 (80.7812) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 691
clean true:688
clean false:3
clean_rate:0.9956584659913169
noisy true:417
noisy false:492
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 909
epoch [13/200] batch [5/21] time 0.202 (0.188) data 0.125 (0.112) loss_x loss_x 0.5264 (0.9560) acc_x 81.2500 (73.7500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/21] time 0.190 (0.184) data 0.113 (0.108) loss_x loss_x 0.5918 (0.8225) acc_x 87.5000 (77.5000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/21] time 0.200 (0.181) data 0.124 (0.104) loss_x loss_x 0.4634 (0.8762) acc_x 81.2500 (77.2917) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/21] time 0.177 (0.180) data 0.101 (0.104) loss_x loss_x 0.3606 (0.8763) acc_x 90.6250 (77.6562) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 714
clean true:713
clean false:1
clean_rate:0.9985994397759104
noisy true:430
noisy false:456
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 886
epoch [14/200] batch [5/22] time 0.170 (0.174) data 0.094 (0.098) loss_x loss_x 0.5474 (0.6837) acc_x 90.6250 (83.1250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/22] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.6284 (0.7451) acc_x 81.2500 (80.3125) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/22] time 0.169 (0.187) data 0.093 (0.097) loss_x loss_x 0.8828 (0.7038) acc_x 75.0000 (81.4583) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/22] time 0.168 (0.183) data 0.092 (0.096) loss_x loss_x 0.3367 (0.6874) acc_x 90.6250 (82.3438) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.4487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 718
clean true:716
clean false:2
clean_rate:0.9972144846796658
noisy true:424
noisy false:458
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 882
epoch [15/200] batch [5/22] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.5776 (0.7355) acc_x 90.6250 (81.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/22] time 0.168 (0.170) data 0.092 (0.094) loss_x loss_x 0.7954 (0.8135) acc_x 81.2500 (79.3750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/22] time 0.176 (0.174) data 0.100 (0.098) loss_x loss_x 0.8091 (0.7971) acc_x 68.7500 (78.5417) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/22] time 0.178 (0.175) data 0.102 (0.099) loss_x loss_x 0.2366 (0.7825) acc_x 93.7500 (78.2812) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.4556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 729
clean true:725
clean false:4
clean_rate:0.9945130315500685
noisy true:406
noisy false:465
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 871
epoch [16/200] batch [5/22] time 0.176 (0.185) data 0.100 (0.109) loss_x loss_x 0.6357 (0.6849) acc_x 87.5000 (82.5000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/22] time 0.187 (0.191) data 0.111 (0.115) loss_x loss_x 0.4399 (0.6821) acc_x 93.7500 (81.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/22] time 0.185 (0.193) data 0.109 (0.117) loss_x loss_x 0.8271 (0.7014) acc_x 78.1250 (82.2917) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/22] time 0.185 (0.192) data 0.108 (0.116) loss_x loss_x 0.8120 (0.7367) acc_x 75.0000 (80.7812) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.4475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 716
clean true:714
clean false:2
clean_rate:0.9972067039106145
noisy true:413
noisy false:471
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 884
epoch [17/200] batch [5/22] time 0.189 (0.203) data 0.094 (0.101) loss_x loss_x 0.6519 (0.7312) acc_x 87.5000 (79.3750) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/22] time 0.170 (0.186) data 0.092 (0.096) loss_x loss_x 0.8789 (0.6922) acc_x 71.8750 (80.9375) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/22] time 0.198 (0.185) data 0.121 (0.100) loss_x loss_x 0.4973 (0.6309) acc_x 81.2500 (82.2917) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/22] time 0.178 (0.185) data 0.102 (0.101) loss_x loss_x 1.3057 (0.6790) acc_x 65.6250 (81.2500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.4506, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 721
clean true:719
clean false:2
clean_rate:0.9972260748959778
noisy true:428
noisy false:451
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 879
epoch [18/200] batch [5/22] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.3540 (0.5071) acc_x 90.6250 (86.8750) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/22] time 0.174 (0.185) data 0.097 (0.109) loss_x loss_x 0.3760 (0.6229) acc_x 87.5000 (83.4375) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/22] time 0.179 (0.188) data 0.102 (0.106) loss_x loss_x 1.0479 (0.6504) acc_x 65.6250 (82.0833) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/22] time 0.177 (0.184) data 0.101 (0.103) loss_x loss_x 0.6035 (0.6740) acc_x 84.3750 (81.8750) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.4650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 744
clean true:740
clean false:4
clean_rate:0.9946236559139785
noisy true:406
noisy false:450
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 856
epoch [19/200] batch [5/23] time 0.178 (0.175) data 0.102 (0.099) loss_x loss_x 0.3748 (0.6428) acc_x 90.6250 (82.5000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/23] time 0.172 (0.179) data 0.094 (0.103) loss_x loss_x 0.8296 (0.8147) acc_x 81.2500 (78.1250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/23] time 0.219 (0.182) data 0.143 (0.105) loss_x loss_x 0.5591 (0.7279) acc_x 84.3750 (80.2083) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/23] time 0.183 (0.189) data 0.107 (0.107) loss_x loss_x 0.9487 (0.6836) acc_x 78.1250 (81.7188) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.4650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 744
clean true:740
clean false:4
clean_rate:0.9946236559139785
noisy true:434
noisy false:422
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 856
epoch [20/200] batch [5/23] time 0.164 (0.175) data 0.088 (0.098) loss_x loss_x 0.7236 (0.7395) acc_x 87.5000 (82.5000) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/23] time 0.180 (0.173) data 0.104 (0.097) loss_x loss_x 0.8350 (0.6827) acc_x 78.1250 (81.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/23] time 0.167 (0.174) data 0.091 (0.098) loss_x loss_x 0.5151 (0.7257) acc_x 81.2500 (80.4167) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/23] time 0.167 (0.172) data 0.090 (0.096) loss_x loss_x 0.7329 (0.7334) acc_x 84.3750 (81.2500) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 714
clean true:712
clean false:2
clean_rate:0.9971988795518207
noisy true:423
noisy false:463
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 886
epoch [21/200] batch [5/22] time 0.181 (0.179) data 0.104 (0.103) loss_x loss_x 0.7974 (0.7567) acc_x 81.2500 (80.0000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/22] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.8999 (0.8625) acc_x 81.2500 (79.3750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/22] time 0.230 (0.186) data 0.154 (0.110) loss_x loss_x 0.3271 (0.7433) acc_x 87.5000 (81.4583) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/22] time 0.175 (0.186) data 0.099 (0.110) loss_x loss_x 0.4463 (0.7109) acc_x 84.3750 (81.8750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.4656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 745
clean true:741
clean false:4
clean_rate:0.9946308724832215
noisy true:430
noisy false:425
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 855
epoch [22/200] batch [5/23] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4014 (0.6379) acc_x 87.5000 (80.0000) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/23] time 0.183 (0.187) data 0.106 (0.111) loss_x loss_x 0.6226 (0.7377) acc_x 84.3750 (80.0000) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/23] time 0.190 (0.191) data 0.114 (0.114) loss_x loss_x 0.6470 (0.7325) acc_x 87.5000 (81.2500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/23] time 0.169 (0.188) data 0.092 (0.111) loss_x loss_x 0.6353 (0.7551) acc_x 78.1250 (80.1562) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.4612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 738
clean true:733
clean false:5
clean_rate:0.9932249322493225
noisy true:442
noisy false:420
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 862
epoch [23/200] batch [5/23] time 0.160 (0.183) data 0.084 (0.107) loss_x loss_x 0.5786 (0.6265) acc_x 81.2500 (80.0000) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/23] time 0.176 (0.175) data 0.099 (0.099) loss_x loss_x 0.7769 (0.7311) acc_x 75.0000 (78.7500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/23] time 0.179 (0.176) data 0.103 (0.100) loss_x loss_x 0.5356 (0.7203) acc_x 81.2500 (80.2083) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/23] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.5928 (0.7192) acc_x 81.2500 (80.4688) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.4562, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 730
clean true:727
clean false:3
clean_rate:0.9958904109589041
noisy true:417
noisy false:453
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 870
epoch [24/200] batch [5/22] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.7861 (0.5416) acc_x 81.2500 (87.5000) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/22] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.5215 (0.5241) acc_x 87.5000 (86.2500) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/22] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.4438 (0.5570) acc_x 87.5000 (85.4167) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/22] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.8804 (0.6122) acc_x 78.1250 (83.2812) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.4569, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 731
clean true:729
clean false:2
clean_rate:0.9972640218878249
noisy true:438
noisy false:431
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 869
epoch [25/200] batch [5/22] time 0.182 (0.223) data 0.106 (0.119) loss_x loss_x 0.7446 (0.7913) acc_x 78.1250 (78.7500) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/22] time 0.169 (0.201) data 0.092 (0.111) loss_x loss_x 0.6157 (0.6890) acc_x 87.5000 (81.8750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/22] time 0.176 (0.190) data 0.099 (0.105) loss_x loss_x 0.4048 (0.6971) acc_x 87.5000 (82.0833) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/22] time 0.176 (0.186) data 0.100 (0.102) loss_x loss_x 0.7607 (0.7213) acc_x 87.5000 (82.3438) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 758
clean true:756
clean false:2
clean_rate:0.9973614775725593
noisy true:433
noisy false:409
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 842
epoch [26/200] batch [5/23] time 0.164 (0.171) data 0.087 (0.094) loss_x loss_x 0.2115 (0.5403) acc_x 96.8750 (86.2500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/23] time 0.164 (0.169) data 0.088 (0.093) loss_x loss_x 0.4648 (0.4931) acc_x 87.5000 (86.5625) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/23] time 0.177 (0.171) data 0.101 (0.094) loss_x loss_x 0.3801 (0.6052) acc_x 84.3750 (83.1250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/23] time 0.161 (0.171) data 0.084 (0.095) loss_x loss_x 0.3838 (0.5805) acc_x 90.6250 (83.5938) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.4612, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 738
clean true:736
clean false:2
clean_rate:0.997289972899729
noisy true:444
noisy false:418
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 862
epoch [27/200] batch [5/23] time 0.185 (0.193) data 0.109 (0.117) loss_x loss_x 0.7725 (0.6668) acc_x 78.1250 (83.1250) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/23] time 0.182 (0.188) data 0.105 (0.112) loss_x loss_x 0.8848 (0.7099) acc_x 81.2500 (81.5625) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/23] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.4102 (0.6918) acc_x 87.5000 (82.5000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/23] time 0.175 (0.184) data 0.099 (0.108) loss_x loss_x 0.5186 (0.6586) acc_x 81.2500 (82.8125) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.4637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 742
clean true:739
clean false:3
clean_rate:0.9959568733153639
noisy true:432
noisy false:426
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 858
epoch [28/200] batch [5/23] time 0.168 (0.178) data 0.091 (0.102) loss_x loss_x 0.7515 (0.7015) acc_x 71.8750 (81.2500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/23] time 0.160 (0.179) data 0.083 (0.103) loss_x loss_x 0.6411 (0.6606) acc_x 81.2500 (82.8125) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/23] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.3948 (0.6670) acc_x 84.3750 (82.7083) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/23] time 0.172 (0.177) data 0.096 (0.101) loss_x loss_x 0.6851 (0.6179) acc_x 81.2500 (83.7500) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.4631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 741
clean true:736
clean false:5
clean_rate:0.9932523616734144
noisy true:412
noisy false:447
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 859
epoch [29/200] batch [5/23] time 0.192 (0.201) data 0.116 (0.125) loss_x loss_x 0.3767 (0.6669) acc_x 87.5000 (82.5000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/23] time 0.178 (0.192) data 0.102 (0.116) loss_x loss_x 0.5796 (0.7187) acc_x 81.2500 (81.2500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/23] time 0.159 (0.183) data 0.082 (0.107) loss_x loss_x 0.7383 (0.7319) acc_x 81.2500 (81.2500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/23] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.6514 (0.7476) acc_x 84.3750 (80.6250) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.4762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 762
clean true:759
clean false:3
clean_rate:0.9960629921259843
noisy true:419
noisy false:419
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 838
epoch [30/200] batch [5/23] time 0.168 (0.183) data 0.091 (0.106) loss_x loss_x 0.5376 (0.6187) acc_x 87.5000 (84.3750) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/23] time 0.174 (0.184) data 0.098 (0.108) loss_x loss_x 0.7095 (0.6713) acc_x 81.2500 (83.7500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/23] time 0.170 (0.184) data 0.094 (0.107) loss_x loss_x 0.9561 (0.6915) acc_x 71.8750 (83.1250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/23] time 0.272 (0.190) data 0.085 (0.106) loss_x loss_x 0.6577 (0.6903) acc_x 87.5000 (83.5938) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.4775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 764
clean true:761
clean false:3
clean_rate:0.9960732984293194
noisy true:427
noisy false:409
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 836
epoch [31/200] batch [5/23] time 0.179 (0.178) data 0.103 (0.102) loss_x loss_x 0.6963 (0.6763) acc_x 84.3750 (81.8750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/23] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.4050 (0.7648) acc_x 93.7500 (80.0000) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/23] time 0.185 (0.182) data 0.108 (0.106) loss_x loss_x 0.5474 (0.7084) acc_x 81.2500 (81.2500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/23] time 0.169 (0.182) data 0.093 (0.106) loss_x loss_x 0.8638 (0.6960) acc_x 78.1250 (81.5625) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.4581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 733
clean true:730
clean false:3
clean_rate:0.9959072305593452
noisy true:413
noisy false:454
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 867
epoch [32/200] batch [5/22] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.8789 (0.7493) acc_x 78.1250 (80.6250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/22] time 0.172 (0.176) data 0.096 (0.100) loss_x loss_x 0.7251 (0.6935) acc_x 84.3750 (83.1250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/22] time 0.191 (0.178) data 0.115 (0.101) loss_x loss_x 0.8916 (0.6644) acc_x 71.8750 (83.3333) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/22] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 1.0361 (0.7157) acc_x 75.0000 (82.3438) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.4719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 755
clean true:752
clean false:3
clean_rate:0.9960264900662251
noisy true:432
noisy false:413
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 845
epoch [33/200] batch [5/23] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4858 (0.5817) acc_x 78.1250 (82.5000) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/23] time 0.164 (0.178) data 0.088 (0.101) loss_x loss_x 0.5947 (0.6013) acc_x 84.3750 (84.0625) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/23] time 0.170 (0.176) data 0.092 (0.099) loss_x loss_x 0.6704 (0.5771) acc_x 78.1250 (84.7917) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/23] time 0.163 (0.180) data 0.087 (0.098) loss_x loss_x 0.2434 (0.5843) acc_x 96.8750 (84.6875) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.4637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 742
clean true:741
clean false:1
clean_rate:0.9986522911051213
noisy true:437
noisy false:421
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 858
epoch [34/200] batch [5/23] time 0.187 (0.205) data 0.112 (0.129) loss_x loss_x 0.2330 (0.3813) acc_x 96.8750 (90.6250) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/23] time 0.209 (0.201) data 0.133 (0.125) loss_x loss_x 0.5122 (0.5210) acc_x 84.3750 (86.2500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/23] time 0.166 (0.194) data 0.090 (0.118) loss_x loss_x 0.5942 (0.5268) acc_x 90.6250 (87.2917) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/23] time 0.189 (0.191) data 0.113 (0.115) loss_x loss_x 0.8960 (0.5678) acc_x 81.2500 (86.2500) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.4656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 745
clean true:743
clean false:2
clean_rate:0.9973154362416108
noisy true:413
noisy false:442
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 855
epoch [35/200] batch [5/23] time 0.172 (0.181) data 0.096 (0.105) loss_x loss_x 0.7661 (0.6603) acc_x 81.2500 (83.1250) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/23] time 0.190 (0.178) data 0.113 (0.102) loss_x loss_x 0.8086 (0.7128) acc_x 81.2500 (81.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/23] time 0.198 (0.187) data 0.122 (0.103) loss_x loss_x 0.8706 (0.7268) acc_x 81.2500 (81.4583) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/23] time 0.192 (0.188) data 0.116 (0.106) loss_x loss_x 0.7568 (0.7196) acc_x 81.2500 (81.2500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.4694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 751
clean true:747
clean false:4
clean_rate:0.9946737683089214
noisy true:435
noisy false:414
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 849
epoch [36/200] batch [5/23] time 0.168 (0.171) data 0.091 (0.095) loss_x loss_x 0.3921 (0.5564) acc_x 87.5000 (87.5000) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/23] time 0.186 (0.173) data 0.110 (0.097) loss_x loss_x 0.7422 (0.6003) acc_x 71.8750 (84.0625) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/23] time 0.232 (0.180) data 0.156 (0.104) loss_x loss_x 0.2771 (0.5996) acc_x 93.7500 (83.9583) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/23] time 0.201 (0.185) data 0.097 (0.102) loss_x loss_x 0.3376 (0.6308) acc_x 93.7500 (83.4375) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.4787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 766
clean true:760
clean false:6
clean_rate:0.9921671018276762
noisy true:426
noisy false:408
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 834
epoch [37/200] batch [5/23] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 0.7334 (0.6719) acc_x 81.2500 (82.5000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/23] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.6714 (0.6828) acc_x 81.2500 (82.8125) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/23] time 0.168 (0.176) data 0.090 (0.099) loss_x loss_x 1.5664 (0.7190) acc_x 65.6250 (81.8750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/23] time 0.214 (0.184) data 0.091 (0.099) loss_x loss_x 0.4553 (0.7053) acc_x 90.6250 (82.9688) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.4744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 759
clean true:757
clean false:2
clean_rate:0.997364953886693
noisy true:426
noisy false:415
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 841
epoch [38/200] batch [5/23] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.7202 (0.7787) acc_x 90.6250 (82.5000) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/23] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.5513 (0.6277) acc_x 81.2500 (83.7500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/23] time 0.205 (0.185) data 0.128 (0.108) loss_x loss_x 0.6250 (0.6320) acc_x 87.5000 (83.3333) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/23] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.9624 (0.6783) acc_x 81.2500 (82.1875) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 773
clean true:770
clean false:3
clean_rate:0.9961190168175937
noisy true:423
noisy false:404
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 827
epoch [39/200] batch [5/24] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.5557 (0.5945) acc_x 78.1250 (81.8750) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/24] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.4629 (0.6410) acc_x 81.2500 (82.1875) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/24] time 0.187 (0.183) data 0.110 (0.107) loss_x loss_x 0.8784 (0.6839) acc_x 75.0000 (80.8333) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/24] time 0.178 (0.184) data 0.102 (0.108) loss_x loss_x 0.5435 (0.6781) acc_x 81.2500 (80.9375) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 768
clean true:762
clean false:6
clean_rate:0.9921875
noisy true:431
noisy false:401
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 832
epoch [40/200] batch [5/24] time 0.171 (0.200) data 0.095 (0.102) loss_x loss_x 0.7485 (0.7160) acc_x 84.3750 (86.2500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/24] time 0.174 (0.184) data 0.098 (0.097) loss_x loss_x 0.2496 (0.6774) acc_x 93.7500 (84.0625) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/24] time 0.180 (0.178) data 0.104 (0.095) loss_x loss_x 0.4934 (0.6469) acc_x 84.3750 (83.7500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/24] time 0.176 (0.175) data 0.100 (0.093) loss_x loss_x 0.4966 (0.6967) acc_x 87.5000 (83.2812) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:771
clean false:4
clean_rate:0.9948387096774194
noisy true:432
noisy false:393
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [41/200] batch [5/24] time 0.192 (0.189) data 0.116 (0.113) loss_x loss_x 0.4688 (0.5693) acc_x 87.5000 (86.2500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/24] time 0.187 (0.189) data 0.111 (0.113) loss_x loss_x 1.0850 (0.5808) acc_x 71.8750 (84.3750) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/24] time 0.177 (0.187) data 0.100 (0.110) loss_x loss_x 0.6465 (0.5991) acc_x 81.2500 (84.1667) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/24] time 0.188 (0.185) data 0.112 (0.109) loss_x loss_x 0.9209 (0.6040) acc_x 78.1250 (84.6875) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 766
clean true:766
clean false:0
clean_rate:1.0
noisy true:431
noisy false:403
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 834
epoch [42/200] batch [5/23] time 0.184 (0.215) data 0.107 (0.106) loss_x loss_x 0.3606 (0.6390) acc_x 87.5000 (83.1250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/23] time 0.179 (0.198) data 0.103 (0.105) loss_x loss_x 0.9756 (0.6740) acc_x 78.1250 (81.2500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/23] time 0.182 (0.193) data 0.105 (0.105) loss_x loss_x 0.9727 (0.7114) acc_x 71.8750 (80.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/23] time 0.188 (0.191) data 0.111 (0.106) loss_x loss_x 0.9658 (0.6501) acc_x 65.6250 (81.5625) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 773
clean true:769
clean false:4
clean_rate:0.9948253557567918
noisy true:430
noisy false:397
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 827
epoch [43/200] batch [5/24] time 0.158 (0.214) data 0.081 (0.115) loss_x loss_x 0.6167 (0.4632) acc_x 84.3750 (90.0000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/24] time 0.171 (0.189) data 0.095 (0.102) loss_x loss_x 1.0605 (0.5413) acc_x 75.0000 (87.1875) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/24] time 0.165 (0.183) data 0.089 (0.099) loss_x loss_x 1.1426 (0.6044) acc_x 75.0000 (85.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/24] time 0.164 (0.177) data 0.087 (0.095) loss_x loss_x 0.3848 (0.5915) acc_x 87.5000 (85.3125) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 760
clean true:758
clean false:2
clean_rate:0.9973684210526316
noisy true:448
noisy false:392
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 840
epoch [44/200] batch [5/23] time 0.212 (0.189) data 0.136 (0.113) loss_x loss_x 1.0137 (0.8037) acc_x 81.2500 (79.3750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/23] time 0.181 (0.190) data 0.105 (0.114) loss_x loss_x 0.6548 (0.7976) acc_x 78.1250 (79.6875) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/23] time 0.180 (0.189) data 0.104 (0.113) loss_x loss_x 0.6079 (0.7486) acc_x 84.3750 (81.0417) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/23] time 0.164 (0.196) data 0.087 (0.112) loss_x loss_x 0.7983 (0.7376) acc_x 87.5000 (81.4062) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 763
clean true:762
clean false:1
clean_rate:0.9986893840104849
noisy true:435
noisy false:402
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 837
epoch [45/200] batch [5/23] time 0.169 (0.205) data 0.093 (0.100) loss_x loss_x 0.7705 (0.5907) acc_x 81.2500 (83.1250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/23] time 0.177 (0.195) data 0.101 (0.104) loss_x loss_x 0.8247 (0.6522) acc_x 81.2500 (84.0625) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/23] time 0.200 (0.196) data 0.124 (0.110) loss_x loss_x 0.3660 (0.6436) acc_x 93.7500 (84.7917) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/23] time 0.184 (0.196) data 0.108 (0.112) loss_x loss_x 0.4353 (0.6023) acc_x 90.6250 (85.9375) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:766
clean false:6
clean_rate:0.9922279792746114
noisy true:404
noisy false:424
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [46/200] batch [5/24] time 0.177 (0.200) data 0.101 (0.101) loss_x loss_x 0.7847 (0.7778) acc_x 78.1250 (78.7500) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/24] time 0.168 (0.188) data 0.091 (0.100) loss_x loss_x 1.4395 (0.9180) acc_x 71.8750 (77.8125) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/24] time 0.171 (0.183) data 0.094 (0.099) loss_x loss_x 1.2646 (0.8168) acc_x 75.0000 (80.8333) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/24] time 0.207 (0.185) data 0.131 (0.102) loss_x loss_x 0.6089 (0.7778) acc_x 87.5000 (81.2500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.4625, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 740
clean true:738
clean false:2
clean_rate:0.9972972972972973
noisy true:439
noisy false:421
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 860
epoch [47/200] batch [5/23] time 0.168 (0.170) data 0.091 (0.094) loss_x loss_x 0.4958 (0.5178) acc_x 87.5000 (88.1250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/23] time 0.173 (0.181) data 0.096 (0.094) loss_x loss_x 0.1802 (0.5387) acc_x 93.7500 (86.8750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/23] time 0.167 (0.178) data 0.090 (0.094) loss_x loss_x 1.2178 (0.6339) acc_x 71.8750 (84.7917) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/23] time 0.194 (0.177) data 0.117 (0.095) loss_x loss_x 0.2656 (0.6426) acc_x 93.7500 (84.0625) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.4756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 761
clean true:757
clean false:4
clean_rate:0.9947437582128777
noisy true:435
noisy false:404
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 839
epoch [48/200] batch [5/23] time 0.172 (0.188) data 0.096 (0.112) loss_x loss_x 0.7178 (0.6467) acc_x 81.2500 (82.5000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/23] time 0.180 (0.197) data 0.104 (0.110) loss_x loss_x 1.1719 (0.6314) acc_x 71.8750 (83.1250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/23] time 0.167 (0.189) data 0.091 (0.106) loss_x loss_x 0.3157 (0.6291) acc_x 90.6250 (83.3333) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/23] time 0.173 (0.185) data 0.097 (0.103) loss_x loss_x 0.8145 (0.6362) acc_x 81.2500 (82.5000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 770
clean true:766
clean false:4
clean_rate:0.9948051948051948
noisy true:433
noisy false:397
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 830
epoch [49/200] batch [5/24] time 0.210 (0.188) data 0.134 (0.112) loss_x loss_x 0.3079 (0.5110) acc_x 90.6250 (88.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/24] time 0.179 (0.187) data 0.103 (0.111) loss_x loss_x 0.4773 (0.5119) acc_x 87.5000 (86.5625) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/24] time 0.294 (0.195) data 0.108 (0.112) loss_x loss_x 0.4927 (0.5376) acc_x 87.5000 (86.4583) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/24] time 0.183 (0.200) data 0.107 (0.118) loss_x loss_x 0.6460 (0.5704) acc_x 81.2500 (86.0938) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.4656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 745
clean true:742
clean false:3
clean_rate:0.9959731543624161
noisy true:432
noisy false:423
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 855
epoch [50/200] batch [5/23] time 0.176 (0.191) data 0.100 (0.115) loss_x loss_x 0.3254 (0.5856) acc_x 93.7500 (85.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/23] time 0.171 (0.187) data 0.093 (0.111) loss_x loss_x 0.7212 (0.6194) acc_x 81.2500 (83.1250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/23] time 0.190 (0.187) data 0.114 (0.110) loss_x loss_x 0.3750 (0.5744) acc_x 90.6250 (85.0000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/23] time 0.173 (0.186) data 0.097 (0.109) loss_x loss_x 0.4739 (0.5646) acc_x 90.6250 (85.4688) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 791
clean true:789
clean false:2
clean_rate:0.9974715549936789
noisy true:425
noisy false:384
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 809
epoch [51/200] batch [5/24] time 0.176 (0.174) data 0.100 (0.098) loss_x loss_x 0.6660 (0.4929) acc_x 87.5000 (86.2500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/24] time 0.174 (0.175) data 0.098 (0.099) loss_x loss_x 0.8535 (0.5685) acc_x 75.0000 (84.0625) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/24] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.9580 (0.6209) acc_x 78.1250 (83.3333) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/24] time 0.168 (0.178) data 0.091 (0.102) loss_x loss_x 0.8228 (0.6595) acc_x 71.8750 (81.5625) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:769
clean false:3
clean_rate:0.9961139896373057
noisy true:451
noisy false:377
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [52/200] batch [5/24] time 0.188 (0.187) data 0.112 (0.110) loss_x loss_x 0.7163 (0.7821) acc_x 81.2500 (80.6250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/24] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.6958 (0.6794) acc_x 78.1250 (82.1875) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/24] time 0.172 (0.179) data 0.096 (0.103) loss_x loss_x 1.0156 (0.6708) acc_x 81.2500 (82.9167) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/24] time 0.188 (0.179) data 0.112 (0.103) loss_x loss_x 0.3391 (0.6202) acc_x 87.5000 (83.7500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:772
clean false:3
clean_rate:0.9961290322580645
noisy true:432
noisy false:393
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [53/200] batch [5/24] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.8438 (0.5719) acc_x 81.2500 (88.1250) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/24] time 0.175 (0.174) data 0.099 (0.097) loss_x loss_x 0.6704 (0.5757) acc_x 87.5000 (86.8750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/24] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 0.5654 (0.6858) acc_x 81.2500 (84.1667) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/24] time 0.174 (0.175) data 0.098 (0.098) loss_x loss_x 0.3191 (0.6668) acc_x 90.6250 (84.2188) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 775
clean true:771
clean false:4
clean_rate:0.9948387096774194
noisy true:440
noisy false:385
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 825
epoch [54/200] batch [5/24] time 0.161 (0.161) data 0.085 (0.084) loss_x loss_x 0.6094 (0.6121) acc_x 84.3750 (83.7500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/24] time 0.171 (0.164) data 0.095 (0.088) loss_x loss_x 0.7319 (0.6190) acc_x 84.3750 (83.1250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/24] time 0.182 (0.168) data 0.106 (0.092) loss_x loss_x 0.8193 (0.6126) acc_x 78.1250 (82.9167) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/24] time 0.167 (0.171) data 0.090 (0.094) loss_x loss_x 1.2588 (0.6649) acc_x 68.7500 (82.1875) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:791
clean false:4
clean_rate:0.9949685534591195
noisy true:431
noisy false:374
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [55/200] batch [5/24] time 0.162 (0.189) data 0.084 (0.112) loss_x loss_x 0.3037 (0.4460) acc_x 90.6250 (89.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/24] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.4651 (0.6131) acc_x 87.5000 (84.0625) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/24] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.9341 (0.6065) acc_x 78.1250 (83.7500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/24] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.6733 (0.6282) acc_x 84.3750 (82.6562) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 776
clean true:772
clean false:4
clean_rate:0.9948453608247423
noisy true:430
noisy false:394
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 824
epoch [56/200] batch [5/24] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.5522 (0.5574) acc_x 87.5000 (82.5000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/24] time 0.172 (0.178) data 0.096 (0.102) loss_x loss_x 0.3926 (0.5243) acc_x 87.5000 (84.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/24] time 0.168 (0.181) data 0.092 (0.104) loss_x loss_x 0.6699 (0.5095) acc_x 84.3750 (85.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/24] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.6138 (0.5747) acc_x 84.3750 (84.5312) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:792
clean false:3
clean_rate:0.9962264150943396
noisy true:424
noisy false:381
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [57/200] batch [5/24] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.5083 (0.4550) acc_x 87.5000 (87.5000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/24] time 0.175 (0.181) data 0.098 (0.105) loss_x loss_x 0.7095 (0.5927) acc_x 84.3750 (85.9375) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/24] time 0.161 (0.185) data 0.084 (0.099) loss_x loss_x 0.5728 (0.6393) acc_x 93.7500 (86.0417) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/24] time 0.175 (0.180) data 0.097 (0.096) loss_x loss_x 0.4521 (0.6037) acc_x 87.5000 (85.4688) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:778
clean false:5
clean_rate:0.9936143039591315
noisy true:440
noisy false:377
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [58/200] batch [5/24] time 0.193 (0.175) data 0.099 (0.095) loss_x loss_x 0.5864 (0.5838) acc_x 84.3750 (85.0000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/24] time 0.177 (0.195) data 0.101 (0.106) loss_x loss_x 0.7393 (0.5617) acc_x 78.1250 (84.3750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/24] time 0.172 (0.187) data 0.096 (0.102) loss_x loss_x 1.1006 (0.6476) acc_x 75.0000 (81.8750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/24] time 0.164 (0.183) data 0.087 (0.101) loss_x loss_x 0.2769 (0.6100) acc_x 90.6250 (83.1250) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:799
clean false:4
clean_rate:0.9950186799501868
noisy true:418
noisy false:379
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [59/200] batch [5/25] time 0.162 (0.170) data 0.086 (0.094) loss_x loss_x 0.3010 (0.5000) acc_x 90.6250 (88.7500) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/25] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.7559 (0.6375) acc_x 75.0000 (84.0625) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/25] time 0.172 (0.178) data 0.095 (0.095) loss_x loss_x 0.4915 (0.6338) acc_x 93.7500 (83.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/25] time 0.162 (0.175) data 0.086 (0.093) loss_x loss_x 0.6274 (0.6283) acc_x 84.3750 (84.0625) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [25/25] time 0.203 (0.176) data 0.126 (0.095) loss_x loss_x 1.1094 (0.6470) acc_x 78.1250 (83.7500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 787
clean true:783
clean false:4
clean_rate:0.9949174078780177
noisy true:435
noisy false:378
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 813
epoch [60/200] batch [5/24] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.4438 (0.5415) acc_x 84.3750 (88.1250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/24] time 0.159 (0.169) data 0.082 (0.093) loss_x loss_x 0.9800 (0.5988) acc_x 71.8750 (85.6250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/24] time 0.190 (0.172) data 0.114 (0.096) loss_x loss_x 0.3530 (0.5539) acc_x 90.6250 (86.4583) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/24] time 0.208 (0.178) data 0.131 (0.096) loss_x loss_x 0.3293 (0.5642) acc_x 90.6250 (86.0938) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 795
clean true:791
clean false:4
clean_rate:0.9949685534591195
noisy true:433
noisy false:372
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 805
epoch [61/200] batch [5/24] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.4832 (0.6298) acc_x 90.6250 (88.7500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/24] time 0.195 (0.186) data 0.119 (0.110) loss_x loss_x 0.4319 (0.6050) acc_x 90.6250 (86.5625) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/24] time 0.162 (0.182) data 0.086 (0.106) loss_x loss_x 0.7036 (0.6150) acc_x 75.0000 (83.9583) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/24] time 0.165 (0.178) data 0.088 (0.102) loss_x loss_x 0.5684 (0.6475) acc_x 87.5000 (83.7500) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 758
clean true:754
clean false:4
clean_rate:0.9947229551451188
noisy true:441
noisy false:401
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 842
epoch [62/200] batch [5/23] time 0.187 (0.171) data 0.111 (0.095) loss_x loss_x 0.7358 (0.5271) acc_x 78.1250 (86.8750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/23] time 0.170 (0.175) data 0.094 (0.099) loss_x loss_x 0.5439 (0.5621) acc_x 84.3750 (84.6875) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/23] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.3662 (0.5176) acc_x 93.7500 (86.2500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/23] time 0.177 (0.176) data 0.102 (0.100) loss_x loss_x 0.7026 (0.5681) acc_x 78.1250 (85.0000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 787
clean true:785
clean false:2
clean_rate:0.9974587039390089
noisy true:439
noisy false:374
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 813
epoch [63/200] batch [5/24] time 0.175 (0.173) data 0.099 (0.097) loss_x loss_x 0.5439 (0.6723) acc_x 81.2500 (80.6250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/24] time 0.169 (0.175) data 0.093 (0.099) loss_x loss_x 0.5361 (0.6633) acc_x 87.5000 (82.5000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/24] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.5229 (0.6404) acc_x 87.5000 (83.3333) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/24] time 0.291 (0.189) data 0.106 (0.107) loss_x loss_x 0.2319 (0.6068) acc_x 96.8750 (84.2188) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 781
clean true:779
clean false:2
clean_rate:0.9974391805377721
noisy true:432
noisy false:387
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 819
epoch [64/200] batch [5/24] time 0.175 (0.176) data 0.099 (0.099) loss_x loss_x 0.4861 (0.5907) acc_x 84.3750 (82.5000) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/24] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 0.5146 (0.6002) acc_x 90.6250 (84.3750) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/24] time 0.196 (0.174) data 0.119 (0.098) loss_x loss_x 0.8208 (0.6553) acc_x 75.0000 (82.2917) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/24] time 0.186 (0.177) data 0.110 (0.100) loss_x loss_x 0.4431 (0.6659) acc_x 90.6250 (82.5000) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 799
clean true:792
clean false:7
clean_rate:0.9912390488110138
noisy true:432
noisy false:369
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 801
epoch [65/200] batch [5/24] time 0.167 (0.178) data 0.091 (0.102) loss_x loss_x 0.4814 (0.4934) acc_x 78.1250 (85.6250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/24] time 0.175 (0.175) data 0.099 (0.098) loss_x loss_x 0.4041 (0.5419) acc_x 87.5000 (85.0000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/24] time 0.167 (0.173) data 0.091 (0.097) loss_x loss_x 0.7515 (0.6160) acc_x 75.0000 (83.9583) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/24] time 0.188 (0.174) data 0.112 (0.098) loss_x loss_x 0.6772 (0.6825) acc_x 84.3750 (83.1250) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 765
clean true:763
clean false:2
clean_rate:0.9973856209150327
noisy true:437
noisy false:398
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 835
epoch [66/200] batch [5/23] time 0.172 (0.173) data 0.096 (0.097) loss_x loss_x 0.4058 (0.5833) acc_x 84.3750 (83.7500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/23] time 0.171 (0.185) data 0.094 (0.098) loss_x loss_x 0.5918 (0.6615) acc_x 81.2500 (82.5000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/23] time 0.184 (0.186) data 0.108 (0.103) loss_x loss_x 0.5205 (0.6372) acc_x 87.5000 (83.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/23] time 0.182 (0.184) data 0.105 (0.102) loss_x loss_x 0.8481 (0.6180) acc_x 78.1250 (83.5938) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 808
clean true:805
clean false:3
clean_rate:0.9962871287128713
noisy true:432
noisy false:360
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 792
epoch [67/200] batch [5/25] time 0.181 (0.221) data 0.104 (0.122) loss_x loss_x 0.9834 (0.6841) acc_x 81.2500 (82.5000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/25] time 0.207 (0.209) data 0.130 (0.122) loss_x loss_x 0.5205 (0.6279) acc_x 84.3750 (83.7500) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/25] time 0.180 (0.200) data 0.103 (0.117) loss_x loss_x 0.4302 (0.6099) acc_x 81.2500 (83.7500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/25] time 0.179 (0.205) data 0.102 (0.113) loss_x loss_x 0.5342 (0.6033) acc_x 81.2500 (83.9062) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/25] time 0.175 (0.197) data 0.098 (0.109) loss_x loss_x 0.5396 (0.5648) acc_x 84.3750 (84.7500) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:770
clean false:2
clean_rate:0.9974093264248705
noisy true:438
noisy false:390
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [68/200] batch [5/24] time 0.181 (0.199) data 0.105 (0.115) loss_x loss_x 0.7202 (0.6123) acc_x 81.2500 (82.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/24] time 0.186 (0.191) data 0.109 (0.111) loss_x loss_x 0.2844 (0.6208) acc_x 93.7500 (82.8125) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/24] time 0.167 (0.185) data 0.091 (0.106) loss_x loss_x 0.3181 (0.6001) acc_x 87.5000 (83.3333) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/24] time 0.171 (0.183) data 0.094 (0.105) loss_x loss_x 0.6748 (0.5936) acc_x 84.3750 (83.7500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 798
clean true:791
clean false:7
clean_rate:0.9912280701754386
noisy true:421
noisy false:381
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 802
epoch [69/200] batch [5/24] time 0.173 (0.180) data 0.097 (0.104) loss_x loss_x 0.3806 (0.4964) acc_x 87.5000 (87.5000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/24] time 0.281 (0.195) data 0.095 (0.102) loss_x loss_x 0.6724 (0.5292) acc_x 78.1250 (84.6875) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/24] time 0.187 (0.191) data 0.111 (0.104) loss_x loss_x 0.5591 (0.5852) acc_x 90.6250 (84.7917) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/24] time 0.180 (0.189) data 0.103 (0.104) loss_x loss_x 0.5542 (0.5543) acc_x 84.3750 (85.1562) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 772
clean true:769
clean false:3
clean_rate:0.9961139896373057
noisy true:430
noisy false:398
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 828
epoch [70/200] batch [5/24] time 0.179 (0.191) data 0.103 (0.114) loss_x loss_x 0.4404 (0.5839) acc_x 93.7500 (84.3750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/24] time 0.179 (0.189) data 0.103 (0.113) loss_x loss_x 0.5659 (0.5216) acc_x 81.2500 (85.3125) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/24] time 0.186 (0.188) data 0.110 (0.112) loss_x loss_x 0.6772 (0.5462) acc_x 78.1250 (85.2083) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/24] time 0.190 (0.188) data 0.114 (0.112) loss_x loss_x 0.7090 (0.5422) acc_x 78.1250 (85.4688) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.4956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 793
clean true:787
clean false:6
clean_rate:0.9924337957124842
noisy true:417
noisy false:390
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 807
epoch [71/200] batch [5/24] time 0.172 (0.173) data 0.096 (0.097) loss_x loss_x 0.5962 (0.6740) acc_x 78.1250 (80.6250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/24] time 0.170 (0.171) data 0.094 (0.095) loss_x loss_x 0.8999 (0.6456) acc_x 78.1250 (84.0625) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/24] time 0.165 (0.180) data 0.089 (0.097) loss_x loss_x 0.6353 (0.6107) acc_x 81.2500 (84.3750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/24] time 0.181 (0.180) data 0.105 (0.099) loss_x loss_x 0.4250 (0.6256) acc_x 90.6250 (83.9062) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.4875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 780
clean true:775
clean false:5
clean_rate:0.9935897435897436
noisy true:421
noisy false:399
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 820
epoch [72/200] batch [5/24] time 0.205 (0.195) data 0.129 (0.119) loss_x loss_x 0.2257 (0.4731) acc_x 96.8750 (90.0000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/24] time 0.198 (0.191) data 0.122 (0.115) loss_x loss_x 0.7178 (0.5897) acc_x 78.1250 (85.9375) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/24] time 0.167 (0.185) data 0.091 (0.109) loss_x loss_x 0.6533 (0.6531) acc_x 78.1250 (83.9583) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/24] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.4028 (0.6072) acc_x 87.5000 (84.6875) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 794
clean true:792
clean false:2
clean_rate:0.9974811083123426
noisy true:425
noisy false:381
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 806
epoch [73/200] batch [5/24] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.7490 (0.6614) acc_x 78.1250 (83.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/24] time 0.170 (0.174) data 0.094 (0.098) loss_x loss_x 0.6914 (0.6184) acc_x 81.2500 (84.0625) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/24] time 0.203 (0.189) data 0.126 (0.100) loss_x loss_x 0.8164 (0.6229) acc_x 81.2500 (84.3750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/24] time 0.171 (0.188) data 0.094 (0.101) loss_x loss_x 0.3464 (0.6162) acc_x 84.3750 (83.9062) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 799
clean true:796
clean false:3
clean_rate:0.9962453066332916
noisy true:417
noisy false:384
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 801
epoch [74/200] batch [5/24] time 0.165 (0.168) data 0.086 (0.091) loss_x loss_x 0.2419 (0.6598) acc_x 93.7500 (83.7500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/24] time 0.173 (0.197) data 0.096 (0.100) loss_x loss_x 0.2827 (0.5505) acc_x 87.5000 (85.9375) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/24] time 0.175 (0.190) data 0.099 (0.100) loss_x loss_x 0.9570 (0.5806) acc_x 81.2500 (85.6250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/24] time 0.182 (0.186) data 0.105 (0.099) loss_x loss_x 0.2289 (0.5581) acc_x 96.8750 (85.9375) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 797
clean true:792
clean false:5
clean_rate:0.9937264742785445
noisy true:444
noisy false:359
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 803
epoch [75/200] batch [5/24] time 0.160 (0.158) data 0.084 (0.082) loss_x loss_x 0.1929 (0.4854) acc_x 96.8750 (86.8750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/24] time 0.161 (0.162) data 0.086 (0.086) loss_x loss_x 0.4658 (0.4961) acc_x 81.2500 (85.3125) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/24] time 0.181 (0.164) data 0.105 (0.088) loss_x loss_x 0.7192 (0.4920) acc_x 81.2500 (85.8333) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/24] time 0.186 (0.170) data 0.110 (0.093) loss_x loss_x 0.7529 (0.5332) acc_x 84.3750 (85.3125) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:779
clean false:4
clean_rate:0.9948914431673053
noisy true:422
noisy false:395
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [76/200] batch [5/24] time 0.167 (0.172) data 0.090 (0.096) loss_x loss_x 0.2800 (0.4819) acc_x 90.6250 (86.8750) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/24] time 0.181 (0.172) data 0.105 (0.095) loss_x loss_x 0.1793 (0.5150) acc_x 93.7500 (87.1875) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/24] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.2164 (0.4755) acc_x 93.7500 (87.5000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/24] time 0.185 (0.177) data 0.108 (0.101) loss_x loss_x 1.0752 (0.5446) acc_x 84.3750 (86.4062) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 784
clean true:777
clean false:7
clean_rate:0.9910714285714286
noisy true:423
noisy false:393
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 816
epoch [77/200] batch [5/24] time 0.175 (0.177) data 0.099 (0.100) loss_x loss_x 0.3059 (0.4059) acc_x 90.6250 (88.1250) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/24] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.2891 (0.5736) acc_x 96.8750 (85.9375) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/24] time 0.176 (0.179) data 0.100 (0.102) loss_x loss_x 0.4949 (0.6419) acc_x 87.5000 (84.5833) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/24] time 0.166 (0.179) data 0.090 (0.103) loss_x loss_x 0.6660 (0.6925) acc_x 84.3750 (84.2188) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 786
clean true:783
clean false:3
clean_rate:0.9961832061068703
noisy true:427
noisy false:387
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 814
epoch [78/200] batch [5/24] time 0.177 (0.179) data 0.101 (0.102) loss_x loss_x 0.4517 (0.5491) acc_x 84.3750 (83.1250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/24] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.3015 (0.5700) acc_x 90.6250 (84.0625) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/24] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.3486 (0.5094) acc_x 87.5000 (85.8333) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/24] time 0.177 (0.182) data 0.101 (0.106) loss_x loss_x 0.4761 (0.5148) acc_x 87.5000 (85.9375) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 798
clean true:794
clean false:4
clean_rate:0.9949874686716792
noisy true:426
noisy false:376
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 802
epoch [79/200] batch [5/24] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.5220 (0.4977) acc_x 84.3750 (87.5000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/24] time 0.270 (0.183) data 0.111 (0.099) loss_x loss_x 0.4028 (0.5562) acc_x 87.5000 (86.2500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/24] time 0.164 (0.181) data 0.087 (0.097) loss_x loss_x 0.5264 (0.5734) acc_x 81.2500 (85.0000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/24] time 0.167 (0.182) data 0.091 (0.099) loss_x loss_x 0.5488 (0.6016) acc_x 81.2500 (84.2188) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 782
clean true:778
clean false:4
clean_rate:0.9948849104859335
noisy true:433
noisy false:385
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 818
epoch [80/200] batch [5/24] time 0.168 (0.186) data 0.092 (0.109) loss_x loss_x 0.2739 (0.4947) acc_x 90.6250 (86.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/24] time 0.165 (0.177) data 0.088 (0.101) loss_x loss_x 0.6235 (0.5576) acc_x 84.3750 (85.3125) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/24] time 0.200 (0.179) data 0.124 (0.102) loss_x loss_x 0.5713 (0.5680) acc_x 87.5000 (85.4167) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/24] time 0.280 (0.182) data 0.094 (0.099) loss_x loss_x 0.5132 (0.5825) acc_x 87.5000 (85.1562) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:779
clean false:4
clean_rate:0.9948914431673053
noisy true:445
noisy false:372
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [81/200] batch [5/24] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.7236 (0.5169) acc_x 87.5000 (87.5000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/24] time 0.160 (0.172) data 0.084 (0.096) loss_x loss_x 1.0908 (0.6148) acc_x 78.1250 (84.6875) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/24] time 0.164 (0.169) data 0.088 (0.093) loss_x loss_x 0.8071 (0.6206) acc_x 84.3750 (83.9583) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/24] time 0.183 (0.170) data 0.107 (0.093) loss_x loss_x 0.6606 (0.6222) acc_x 75.0000 (83.7500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 788
clean true:782
clean false:6
clean_rate:0.9923857868020305
noisy true:436
noisy false:376
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 812
epoch [82/200] batch [5/24] time 0.189 (0.191) data 0.113 (0.115) loss_x loss_x 0.7866 (0.6344) acc_x 81.2500 (83.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/24] time 0.184 (0.192) data 0.108 (0.116) loss_x loss_x 0.8906 (0.6394) acc_x 75.0000 (83.7500) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/24] time 0.182 (0.195) data 0.106 (0.119) loss_x loss_x 0.4299 (0.6257) acc_x 87.5000 (83.3333) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/24] time 0.177 (0.195) data 0.100 (0.118) loss_x loss_x 0.9199 (0.6381) acc_x 68.7500 (82.8125) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 812
clean true:804
clean false:8
clean_rate:0.9901477832512315
noisy true:443
noisy false:345
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 788
epoch [83/200] batch [5/25] time 0.158 (0.166) data 0.082 (0.090) loss_x loss_x 0.5918 (0.6440) acc_x 84.3750 (81.8750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/25] time 0.180 (0.172) data 0.104 (0.095) loss_x loss_x 0.6899 (0.5974) acc_x 75.0000 (82.5000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/25] time 0.169 (0.171) data 0.093 (0.095) loss_x loss_x 0.6011 (0.6005) acc_x 78.1250 (82.5000) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/25] time 0.180 (0.171) data 0.103 (0.095) loss_x loss_x 0.4099 (0.5800) acc_x 90.6250 (83.5938) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [25/25] time 0.170 (0.172) data 0.094 (0.095) loss_x loss_x 0.4236 (0.5918) acc_x 90.6250 (83.5000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:794
clean false:2
clean_rate:0.9974874371859297
noisy true:437
noisy false:367
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [84/200] batch [5/24] time 0.278 (0.216) data 0.092 (0.096) loss_x loss_x 0.7627 (0.4820) acc_x 81.2500 (88.1250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/24] time 0.168 (0.190) data 0.092 (0.092) loss_x loss_x 0.4138 (0.5288) acc_x 84.3750 (86.2500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/24] time 0.185 (0.193) data 0.109 (0.102) loss_x loss_x 0.5415 (0.5500) acc_x 81.2500 (85.4167) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/24] time 0.161 (0.193) data 0.085 (0.106) loss_x loss_x 0.2128 (0.5623) acc_x 93.7500 (85.0000) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 779
clean true:774
clean false:5
clean_rate:0.993581514762516
noisy true:419
noisy false:402
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 821
epoch [85/200] batch [5/24] time 0.169 (0.174) data 0.092 (0.098) loss_x loss_x 0.8271 (0.6698) acc_x 81.2500 (86.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/24] time 0.178 (0.173) data 0.101 (0.097) loss_x loss_x 0.6416 (0.5767) acc_x 78.1250 (87.5000) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/24] time 0.177 (0.185) data 0.101 (0.097) loss_x loss_x 0.6509 (0.5859) acc_x 87.5000 (87.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/24] time 0.169 (0.187) data 0.092 (0.101) loss_x loss_x 0.4788 (0.5984) acc_x 90.6250 (86.8750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 788
clean true:784
clean false:4
clean_rate:0.9949238578680203
noisy true:433
noisy false:379
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 812
epoch [86/200] batch [5/24] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.3943 (0.4884) acc_x 90.6250 (86.8750) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/24] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.2776 (0.4567) acc_x 93.7500 (87.8125) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/24] time 0.166 (0.179) data 0.090 (0.103) loss_x loss_x 0.4375 (0.4832) acc_x 90.6250 (87.2917) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/24] time 0.192 (0.185) data 0.116 (0.101) loss_x loss_x 0.6392 (0.4752) acc_x 81.2500 (87.1875) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 781
clean true:778
clean false:3
clean_rate:0.9961587708066582
noisy true:458
noisy false:361
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 819
epoch [87/200] batch [5/24] time 0.189 (0.186) data 0.112 (0.109) loss_x loss_x 0.8638 (0.5258) acc_x 81.2500 (85.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/24] time 0.196 (0.186) data 0.120 (0.109) loss_x loss_x 0.3298 (0.5249) acc_x 96.8750 (85.9375) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/24] time 0.184 (0.187) data 0.107 (0.111) loss_x loss_x 0.5513 (0.5117) acc_x 84.3750 (86.2500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/24] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.9014 (0.5307) acc_x 68.7500 (85.0000) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 804
clean true:799
clean false:5
clean_rate:0.9937810945273632
noisy true:427
noisy false:369
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 796
epoch [88/200] batch [5/25] time 0.171 (0.210) data 0.095 (0.100) loss_x loss_x 0.6035 (0.5775) acc_x 87.5000 (85.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/25] time 0.171 (0.191) data 0.094 (0.097) loss_x loss_x 0.2791 (0.5337) acc_x 84.3750 (84.3750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/25] time 0.195 (0.188) data 0.119 (0.100) loss_x loss_x 0.7930 (0.5459) acc_x 75.0000 (84.1667) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/25] time 0.171 (0.187) data 0.095 (0.102) loss_x loss_x 0.6089 (0.5545) acc_x 84.3750 (84.0625) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [25/25] time 0.171 (0.184) data 0.095 (0.101) loss_x loss_x 0.7842 (0.5675) acc_x 71.8750 (84.2500) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:804
clean false:5
clean_rate:0.9938195302843016
noisy true:433
noisy false:358
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [89/200] batch [5/25] time 0.185 (0.182) data 0.108 (0.106) loss_x loss_x 0.6147 (0.6471) acc_x 84.3750 (85.6250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/25] time 0.164 (0.177) data 0.087 (0.100) loss_x loss_x 0.6685 (0.6439) acc_x 84.3750 (83.7500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/25] time 0.160 (0.176) data 0.084 (0.099) loss_x loss_x 0.2905 (0.5977) acc_x 90.6250 (84.1667) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/25] time 0.192 (0.177) data 0.116 (0.101) loss_x loss_x 0.3154 (0.5803) acc_x 96.8750 (85.0000) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [25/25] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.2102 (0.5699) acc_x 93.7500 (84.7500) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:809
clean false:6
clean_rate:0.992638036809816
noisy true:430
noisy false:355
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [90/200] batch [5/25] time 0.204 (0.192) data 0.128 (0.116) loss_x loss_x 0.8779 (0.5608) acc_x 71.8750 (83.1250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/25] time 0.169 (0.184) data 0.093 (0.107) loss_x loss_x 0.5322 (0.5394) acc_x 87.5000 (85.0000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/25] time 0.170 (0.187) data 0.094 (0.103) loss_x loss_x 0.4114 (0.5611) acc_x 87.5000 (84.5833) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/25] time 0.184 (0.186) data 0.106 (0.103) loss_x loss_x 0.6353 (0.6110) acc_x 87.5000 (84.5312) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [25/25] time 0.171 (0.183) data 0.094 (0.102) loss_x loss_x 0.9854 (0.6326) acc_x 71.8750 (83.8750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:790
clean false:6
clean_rate:0.992462311557789
noisy true:437
noisy false:367
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [91/200] batch [5/24] time 0.171 (0.180) data 0.095 (0.104) loss_x loss_x 0.1316 (0.6901) acc_x 100.0000 (83.7500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/24] time 0.177 (0.176) data 0.100 (0.100) loss_x loss_x 0.4314 (0.6473) acc_x 87.5000 (83.1250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/24] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.6392 (0.6423) acc_x 81.2500 (83.5417) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/24] time 0.227 (0.188) data 0.150 (0.104) loss_x loss_x 0.8511 (0.6225) acc_x 78.1250 (84.0625) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 793
clean true:790
clean false:3
clean_rate:0.9962168978562421
noisy true:413
noisy false:394
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 807
epoch [92/200] batch [5/24] time 0.164 (0.183) data 0.088 (0.106) loss_x loss_x 0.9082 (0.6076) acc_x 81.2500 (88.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/24] time 0.169 (0.176) data 0.093 (0.100) loss_x loss_x 0.5117 (0.6427) acc_x 84.3750 (86.2500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/24] time 0.202 (0.178) data 0.126 (0.102) loss_x loss_x 0.4866 (0.5829) acc_x 87.5000 (87.0833) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/24] time 0.166 (0.178) data 0.090 (0.102) loss_x loss_x 0.3203 (0.5984) acc_x 87.5000 (85.3125) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 804
clean true:802
clean false:2
clean_rate:0.9975124378109452
noisy true:435
noisy false:361
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 796
epoch [93/200] batch [5/25] time 0.169 (0.181) data 0.092 (0.103) loss_x loss_x 0.6309 (0.6017) acc_x 84.3750 (84.3750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/25] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.4263 (0.5228) acc_x 90.6250 (86.2500) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/25] time 0.175 (0.177) data 0.099 (0.100) loss_x loss_x 0.9570 (0.5913) acc_x 65.6250 (84.3750) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/25] time 0.205 (0.186) data 0.130 (0.104) loss_x loss_x 0.4170 (0.6171) acc_x 87.5000 (83.1250) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [25/25] time 0.185 (0.187) data 0.108 (0.107) loss_x loss_x 0.2400 (0.5999) acc_x 90.6250 (83.6250) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:806
clean false:1
clean_rate:0.9987608426270136
noisy true:441
noisy false:352
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [94/200] batch [5/25] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.7793 (0.5544) acc_x 87.5000 (88.1250) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/25] time 0.187 (0.183) data 0.110 (0.096) loss_x loss_x 0.4775 (0.5520) acc_x 93.7500 (88.4375) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/25] time 0.178 (0.182) data 0.101 (0.099) loss_x loss_x 0.5459 (0.5540) acc_x 84.3750 (88.1250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/25] time 0.172 (0.182) data 0.096 (0.100) loss_x loss_x 0.5210 (0.5602) acc_x 90.6250 (87.5000) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [25/25] time 0.216 (0.185) data 0.140 (0.101) loss_x loss_x 0.6802 (0.5516) acc_x 78.1250 (87.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:802
clean false:5
clean_rate:0.9938042131350682
noisy true:431
noisy false:362
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [95/200] batch [5/25] time 0.192 (0.180) data 0.116 (0.104) loss_x loss_x 0.7793 (0.5808) acc_x 75.0000 (81.8750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/25] time 0.171 (0.184) data 0.092 (0.107) loss_x loss_x 1.4580 (0.6875) acc_x 71.8750 (80.6250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/25] time 0.171 (0.182) data 0.095 (0.105) loss_x loss_x 0.6831 (0.6841) acc_x 78.1250 (81.0417) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/25] time 0.164 (0.179) data 0.088 (0.102) loss_x loss_x 0.8242 (0.6291) acc_x 81.2500 (82.9688) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [25/25] time 0.168 (0.177) data 0.092 (0.101) loss_x loss_x 0.6113 (0.6046) acc_x 84.3750 (83.8750) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:810
clean false:1
clean_rate:0.998766954377312
noisy true:434
noisy false:355
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [96/200] batch [5/25] time 0.204 (0.195) data 0.128 (0.119) loss_x loss_x 0.8413 (0.7005) acc_x 81.2500 (82.5000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/25] time 0.171 (0.186) data 0.095 (0.110) loss_x loss_x 0.5679 (0.6471) acc_x 87.5000 (84.3750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/25] time 0.180 (0.188) data 0.103 (0.112) loss_x loss_x 0.2603 (0.6379) acc_x 87.5000 (83.3333) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/25] time 0.216 (0.188) data 0.140 (0.111) loss_x loss_x 0.4792 (0.6378) acc_x 87.5000 (82.9688) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [25/25] time 0.173 (0.186) data 0.097 (0.110) loss_x loss_x 0.6602 (0.6021) acc_x 84.3750 (83.7500) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:826
clean false:4
clean_rate:0.9951807228915662
noisy true:447
noisy false:323
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [97/200] batch [5/25] time 0.170 (0.171) data 0.094 (0.095) loss_x loss_x 0.6499 (0.5782) acc_x 81.2500 (84.3750) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/25] time 0.172 (0.170) data 0.096 (0.094) loss_x loss_x 0.6899 (0.6362) acc_x 81.2500 (83.4375) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/25] time 0.175 (0.171) data 0.098 (0.094) loss_x loss_x 0.5674 (0.5895) acc_x 81.2500 (84.3750) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/25] time 0.267 (0.179) data 0.107 (0.097) loss_x loss_x 0.7129 (0.6358) acc_x 84.3750 (84.2188) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [25/25] time 0.178 (0.178) data 0.101 (0.097) loss_x loss_x 0.4717 (0.6420) acc_x 90.6250 (84.2500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:809
clean false:5
clean_rate:0.9938574938574939
noisy true:435
noisy false:351
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [98/200] batch [5/25] time 0.197 (0.189) data 0.121 (0.112) loss_x loss_x 0.6470 (0.6380) acc_x 84.3750 (83.1250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/25] time 0.179 (0.182) data 0.102 (0.106) loss_x loss_x 0.4404 (0.7360) acc_x 87.5000 (80.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/25] time 0.176 (0.180) data 0.100 (0.104) loss_x loss_x 0.5410 (0.6983) acc_x 78.1250 (80.8333) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/25] time 0.173 (0.177) data 0.097 (0.101) loss_x loss_x 0.6118 (0.6537) acc_x 81.2500 (82.3438) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [25/25] time 0.182 (0.178) data 0.105 (0.102) loss_x loss_x 0.6338 (0.6493) acc_x 87.5000 (82.7500) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:805
clean false:6
clean_rate:0.9926017262638718
noisy true:433
noisy false:356
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [99/200] batch [5/25] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.8926 (0.5154) acc_x 75.0000 (84.3750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/25] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.9888 (0.5398) acc_x 78.1250 (85.9375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/25] time 0.292 (0.192) data 0.107 (0.108) loss_x loss_x 0.7075 (0.5548) acc_x 81.2500 (85.2083) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/25] time 0.171 (0.188) data 0.094 (0.107) loss_x loss_x 1.0537 (0.5867) acc_x 75.0000 (83.9062) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [25/25] time 0.174 (0.187) data 0.097 (0.106) loss_x loss_x 0.9106 (0.6030) acc_x 84.3750 (84.3750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:798
clean false:4
clean_rate:0.9950124688279302
noisy true:425
noisy false:373
all clean rate:  [0.9957537154989384, 0.992831541218638, 0.998468606431853, 0.9970104633781763, 0.9941860465116279, 0.9929078014184397, 0.991304347826087, 0.9985029940119761, 0.9971428571428571, 0.9985935302390999, 0.9971751412429378, 0.9945280437756497, 0.9956584659913169, 0.9985994397759104, 0.9972144846796658, 0.9945130315500685, 0.9972067039106145, 0.9972260748959778, 0.9946236559139785, 0.9946236559139785, 0.9971988795518207, 0.9946308724832215, 0.9932249322493225, 0.9958904109589041, 0.9972640218878249, 0.9973614775725593, 0.997289972899729, 0.9959568733153639, 0.9932523616734144, 0.9960629921259843, 0.9960732984293194, 0.9959072305593452, 0.9960264900662251, 0.9986522911051213, 0.9973154362416108, 0.9946737683089214, 0.9921671018276762, 0.997364953886693, 0.9961190168175937, 0.9921875, 0.9948387096774194, 1.0, 0.9948253557567918, 0.9973684210526316, 0.9986893840104849, 0.9922279792746114, 0.9972972972972973, 0.9947437582128777, 0.9948051948051948, 0.9959731543624161, 0.9974715549936789, 0.9961139896373057, 0.9961290322580645, 0.9948387096774194, 0.9949685534591195, 0.9948453608247423, 0.9962264150943396, 0.9936143039591315, 0.9950186799501868, 0.9949174078780177, 0.9949685534591195, 0.9947229551451188, 0.9974587039390089, 0.9974391805377721, 0.9912390488110138, 0.9973856209150327, 0.9962871287128713, 0.9974093264248705, 0.9912280701754386, 0.9961139896373057, 0.9924337957124842, 0.9935897435897436, 0.9974811083123426, 0.9962453066332916, 0.9937264742785445, 0.9948914431673053, 0.9910714285714286, 0.9961832061068703, 0.9949874686716792, 0.9948849104859335, 0.9948914431673053, 0.9923857868020305, 0.9901477832512315, 0.9974874371859297, 0.993581514762516, 0.9949238578680203, 0.9961587708066582, 0.9937810945273632, 0.9938195302843016, 0.992638036809816, 0.992462311557789, 0.9962168978562421, 0.9975124378109452, 0.9987608426270136, 0.9938042131350682, 0.998766954377312, 0.9951807228915662, 0.9938574938574939, 0.9926017262638718, 0.9950124688279302]
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [100/200] batch [5/25] time 0.166 (0.189) data 0.090 (0.113) loss_x loss_x 0.3442 (0.4636) acc_x 87.5000 (85.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/25] time 0.172 (0.198) data 0.095 (0.111) loss_x loss_x 0.6133 (0.4852) acc_x 78.1250 (85.3125) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/25] time 0.165 (0.191) data 0.089 (0.108) loss_x loss_x 1.3047 (0.5352) acc_x 68.7500 (85.4167) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/25] time 0.166 (0.186) data 0.089 (0.104) loss_x loss_x 0.5508 (0.5458) acc_x 84.3750 (85.4688) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [25/25] time 0.177 (0.184) data 0.101 (0.103) loss_x loss_x 0.2000 (0.5289) acc_x 96.8750 (86.0000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 800
clean true:794
clean false:6
clean_rate:0.9925
noisy true:421
noisy false:379
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 800
epoch [101/200] batch [5/25] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 0.7866 (0.5125) acc_x 84.3750 (85.6250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/25] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 0.5283 (0.5456) acc_x 87.5000 (84.6875) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/25] time 0.187 (0.183) data 0.111 (0.106) loss_x loss_x 0.1831 (0.5088) acc_x 93.7500 (85.8333) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/25] time 0.164 (0.182) data 0.087 (0.105) loss_x loss_x 0.4219 (0.5473) acc_x 90.6250 (84.3750) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [25/25] time 0.163 (0.180) data 0.087 (0.104) loss_x loss_x 0.2671 (0.5530) acc_x 90.6250 (84.3750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:796
clean false:6
clean_rate:0.9925187032418953
noisy true:416
noisy false:382
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [102/200] batch [5/25] time 0.161 (0.175) data 0.084 (0.097) loss_x loss_x 0.2969 (0.4704) acc_x 90.6250 (87.5000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/25] time 0.189 (0.175) data 0.112 (0.098) loss_x loss_x 0.6299 (0.5527) acc_x 84.3750 (86.5625) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/25] time 0.270 (0.185) data 0.103 (0.101) loss_x loss_x 0.7539 (0.5724) acc_x 84.3750 (85.6250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/25] time 0.168 (0.181) data 0.091 (0.100) loss_x loss_x 0.7070 (0.5583) acc_x 84.3750 (86.0938) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [25/25] time 0.172 (0.182) data 0.095 (0.101) loss_x loss_x 0.7788 (0.5969) acc_x 75.0000 (84.8750) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:796
clean false:6
clean_rate:0.9925187032418953
noisy true:447
noisy false:351
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [103/200] batch [5/25] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.7461 (0.6068) acc_x 75.0000 (83.7500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/25] time 0.184 (0.185) data 0.106 (0.090) loss_x loss_x 0.9355 (0.6195) acc_x 81.2500 (84.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/25] time 0.190 (0.183) data 0.113 (0.095) loss_x loss_x 0.5942 (0.6167) acc_x 84.3750 (84.3750) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/25] time 0.165 (0.180) data 0.088 (0.095) loss_x loss_x 0.4758 (0.6215) acc_x 87.5000 (83.9062) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [25/25] time 0.160 (0.180) data 0.083 (0.096) loss_x loss_x 0.3420 (0.5701) acc_x 90.6250 (85.2500) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:808
clean false:3
clean_rate:0.9963008631319359
noisy true:417
noisy false:372
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [104/200] batch [5/25] time 0.185 (0.203) data 0.108 (0.126) loss_x loss_x 0.3301 (0.4649) acc_x 93.7500 (87.5000) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/25] time 0.190 (0.194) data 0.113 (0.117) loss_x loss_x 0.5566 (0.5474) acc_x 81.2500 (85.3125) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/25] time 0.180 (0.191) data 0.103 (0.114) loss_x loss_x 0.6396 (0.5430) acc_x 84.3750 (85.4167) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/25] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.5288 (0.5250) acc_x 87.5000 (85.9375) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [25/25] time 0.188 (0.195) data 0.112 (0.113) loss_x loss_x 0.7510 (0.5247) acc_x 68.7500 (85.3750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:813
clean false:4
clean_rate:0.9951040391676866
noisy true:437
noisy false:346
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [105/200] batch [5/25] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.1565 (0.4176) acc_x 96.8750 (88.7500) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/25] time 0.216 (0.182) data 0.089 (0.094) loss_x loss_x 0.9136 (0.5319) acc_x 90.6250 (87.8125) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/25] time 0.187 (0.181) data 0.111 (0.098) loss_x loss_x 0.6387 (0.5858) acc_x 84.3750 (86.0417) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/25] time 0.185 (0.183) data 0.108 (0.101) loss_x loss_x 0.4541 (0.5923) acc_x 87.5000 (85.4688) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [25/25] time 0.164 (0.185) data 0.088 (0.100) loss_x loss_x 0.6904 (0.6144) acc_x 81.2500 (84.3750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 801
clean true:798
clean false:3
clean_rate:0.9962546816479401
noisy true:429
noisy false:370
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 799
epoch [106/200] batch [5/25] time 0.159 (0.165) data 0.083 (0.088) loss_x loss_x 0.6660 (0.5169) acc_x 84.3750 (86.8750) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/25] time 0.186 (0.172) data 0.110 (0.096) loss_x loss_x 0.6079 (0.5272) acc_x 84.3750 (85.9375) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/25] time 0.179 (0.175) data 0.103 (0.099) loss_x loss_x 0.3604 (0.5398) acc_x 90.6250 (85.4167) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/25] time 0.180 (0.184) data 0.104 (0.101) loss_x loss_x 0.3208 (0.5300) acc_x 87.5000 (85.1562) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [25/25] time 0.180 (0.183) data 0.104 (0.102) loss_x loss_x 0.7676 (0.5305) acc_x 81.2500 (85.3750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:809
clean false:4
clean_rate:0.995079950799508
noisy true:420
noisy false:367
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [107/200] batch [5/25] time 0.198 (0.168) data 0.122 (0.091) loss_x loss_x 0.2908 (0.4260) acc_x 90.6250 (89.3750) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/25] time 0.184 (0.176) data 0.107 (0.100) loss_x loss_x 0.5923 (0.5045) acc_x 87.5000 (87.1875) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/25] time 0.266 (0.185) data 0.104 (0.103) loss_x loss_x 0.3340 (0.4502) acc_x 87.5000 (88.1250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/25] time 0.214 (0.192) data 0.137 (0.106) loss_x loss_x 0.5034 (0.4930) acc_x 87.5000 (87.5000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [25/25] time 0.215 (0.196) data 0.139 (0.112) loss_x loss_x 0.5508 (0.4905) acc_x 81.2500 (87.0000) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:807
clean false:3
clean_rate:0.9962962962962963
noisy true:445
noisy false:345
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [108/200] batch [5/25] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.5161 (0.5203) acc_x 90.6250 (87.5000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/25] time 0.207 (0.186) data 0.111 (0.107) loss_x loss_x 0.4060 (0.5333) acc_x 87.5000 (87.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/25] time 0.187 (0.190) data 0.111 (0.108) loss_x loss_x 0.5503 (0.5448) acc_x 78.1250 (86.4583) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/25] time 0.183 (0.190) data 0.106 (0.109) loss_x loss_x 0.8560 (0.5390) acc_x 75.0000 (86.0938) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [25/25] time 0.184 (0.188) data 0.106 (0.108) loss_x loss_x 0.9590 (0.5863) acc_x 78.1250 (85.2500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 801
clean true:797
clean false:4
clean_rate:0.9950062421972534
noisy true:444
noisy false:355
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 799
epoch [109/200] batch [5/25] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.1532 (0.4465) acc_x 100.0000 (88.1250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/25] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.6069 (0.4969) acc_x 81.2500 (85.6250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/25] time 0.163 (0.182) data 0.086 (0.098) loss_x loss_x 0.5327 (0.5174) acc_x 84.3750 (85.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/25] time 0.211 (0.183) data 0.135 (0.101) loss_x loss_x 0.7695 (0.5428) acc_x 87.5000 (84.3750) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [25/25] time 0.201 (0.182) data 0.125 (0.101) loss_x loss_x 1.0146 (0.5380) acc_x 68.7500 (84.8750) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 806
clean true:801
clean false:5
clean_rate:0.9937965260545906
noisy true:428
noisy false:366
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 794
epoch [110/200] batch [5/25] time 0.185 (0.178) data 0.108 (0.102) loss_x loss_x 0.7754 (0.6497) acc_x 81.2500 (84.3750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/25] time 0.195 (0.178) data 0.118 (0.101) loss_x loss_x 0.4751 (0.5663) acc_x 87.5000 (83.1250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/25] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.8413 (0.5912) acc_x 81.2500 (83.9583) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/25] time 0.156 (0.176) data 0.080 (0.100) loss_x loss_x 1.0430 (0.6275) acc_x 68.7500 (83.4375) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [25/25] time 0.179 (0.175) data 0.103 (0.099) loss_x loss_x 0.4697 (0.6349) acc_x 84.3750 (83.2500) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:817
clean false:5
clean_rate:0.9939172749391727
noisy true:413
noisy false:365
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [111/200] batch [5/25] time 0.168 (0.172) data 0.092 (0.096) loss_x loss_x 0.4602 (0.4766) acc_x 87.5000 (88.1250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/25] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.4905 (0.5588) acc_x 90.6250 (86.5625) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/25] time 0.175 (0.182) data 0.098 (0.106) loss_x loss_x 0.2338 (0.5391) acc_x 90.6250 (85.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/25] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.5581 (0.5431) acc_x 81.2500 (85.7812) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [25/25] time 0.162 (0.180) data 0.085 (0.104) loss_x loss_x 0.3181 (0.5353) acc_x 90.6250 (85.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:811
clean false:5
clean_rate:0.9938725490196079
noisy true:424
noisy false:360
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [112/200] batch [5/25] time 0.168 (0.173) data 0.091 (0.097) loss_x loss_x 0.7100 (0.5410) acc_x 81.2500 (85.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/25] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.3728 (0.5010) acc_x 93.7500 (86.2500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/25] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.3667 (0.5051) acc_x 90.6250 (86.8750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/25] time 0.182 (0.173) data 0.106 (0.097) loss_x loss_x 0.6860 (0.5074) acc_x 84.3750 (87.0312) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [25/25] time 0.189 (0.175) data 0.112 (0.099) loss_x loss_x 0.2206 (0.5142) acc_x 93.7500 (86.6250) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 800
clean true:794
clean false:6
clean_rate:0.9925
noisy true:426
noisy false:374
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 800
epoch [113/200] batch [5/25] time 0.192 (0.185) data 0.116 (0.108) loss_x loss_x 0.6714 (0.6211) acc_x 81.2500 (84.3750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/25] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.6855 (0.5510) acc_x 87.5000 (86.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/25] time 0.165 (0.182) data 0.089 (0.106) loss_x loss_x 0.9985 (0.5218) acc_x 71.8750 (87.2917) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/25] time 0.176 (0.182) data 0.100 (0.106) loss_x loss_x 0.7451 (0.5581) acc_x 93.7500 (86.5625) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [25/25] time 0.173 (0.181) data 0.096 (0.105) loss_x loss_x 0.7437 (0.5623) acc_x 84.3750 (86.2500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:820
clean false:4
clean_rate:0.9951456310679612
noisy true:434
noisy false:342
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [114/200] batch [5/25] time 0.157 (0.170) data 0.081 (0.093) loss_x loss_x 0.7261 (0.5250) acc_x 78.1250 (87.5000) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/25] time 0.186 (0.169) data 0.109 (0.093) loss_x loss_x 1.0957 (0.6099) acc_x 75.0000 (84.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/25] time 0.277 (0.184) data 0.091 (0.093) loss_x loss_x 0.2676 (0.5943) acc_x 93.7500 (85.0000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/25] time 0.187 (0.182) data 0.110 (0.095) loss_x loss_x 0.3926 (0.5688) acc_x 93.7500 (85.4688) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [25/25] time 0.170 (0.183) data 0.094 (0.097) loss_x loss_x 0.6719 (0.5655) acc_x 81.2500 (85.1250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:803
clean false:6
clean_rate:0.992583436341162
noisy true:427
noisy false:364
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [115/200] batch [5/25] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.4395 (0.3927) acc_x 87.5000 (88.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/25] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.5010 (0.4975) acc_x 90.6250 (87.1875) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/25] time 0.197 (0.185) data 0.121 (0.108) loss_x loss_x 0.5610 (0.4822) acc_x 81.2500 (87.5000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/25] time 0.295 (0.190) data 0.109 (0.108) loss_x loss_x 0.8203 (0.5292) acc_x 75.0000 (85.7812) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [25/25] time 0.181 (0.189) data 0.105 (0.108) loss_x loss_x 0.8491 (0.5372) acc_x 84.3750 (86.1250) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:803
clean false:4
clean_rate:0.9950433705080545
noisy true:444
noisy false:349
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [116/200] batch [5/25] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.8672 (0.4771) acc_x 78.1250 (90.0000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/25] time 0.198 (0.177) data 0.122 (0.100) loss_x loss_x 0.2230 (0.5043) acc_x 90.6250 (87.5000) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/25] time 0.190 (0.178) data 0.114 (0.102) loss_x loss_x 0.8560 (0.5692) acc_x 81.2500 (86.6667) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/25] time 0.191 (0.186) data 0.115 (0.110) loss_x loss_x 0.4004 (0.5737) acc_x 90.6250 (86.7188) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [25/25] time 0.195 (0.191) data 0.119 (0.110) loss_x loss_x 0.9072 (0.5667) acc_x 75.0000 (86.3750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:802
clean false:5
clean_rate:0.9938042131350682
noisy true:441
noisy false:352
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [117/200] batch [5/25] time 0.166 (0.174) data 0.089 (0.098) loss_x loss_x 0.4592 (0.3453) acc_x 93.7500 (91.8750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/25] time 0.179 (0.172) data 0.103 (0.096) loss_x loss_x 0.6309 (0.4881) acc_x 81.2500 (87.8125) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/25] time 0.176 (0.173) data 0.100 (0.097) loss_x loss_x 0.9639 (0.5248) acc_x 78.1250 (86.8750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/25] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.2695 (0.5164) acc_x 96.8750 (87.6562) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [25/25] time 0.185 (0.175) data 0.109 (0.099) loss_x loss_x 0.4199 (0.5034) acc_x 87.5000 (87.7500) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:821
clean false:5
clean_rate:0.9939467312348669
noisy true:426
noisy false:348
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [118/200] batch [5/25] time 0.173 (0.183) data 0.097 (0.107) loss_x loss_x 0.4111 (0.4766) acc_x 93.7500 (90.0000) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/25] time 0.202 (0.188) data 0.126 (0.111) loss_x loss_x 0.2703 (0.5193) acc_x 90.6250 (87.1875) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/25] time 0.168 (0.185) data 0.091 (0.108) loss_x loss_x 0.8169 (0.4722) acc_x 75.0000 (88.1250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/25] time 0.194 (0.183) data 0.117 (0.106) loss_x loss_x 0.3921 (0.5197) acc_x 87.5000 (86.0938) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [25/25] time 0.168 (0.182) data 0.091 (0.106) loss_x loss_x 0.2098 (0.5324) acc_x 93.7500 (85.8750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 801
clean true:797
clean false:4
clean_rate:0.9950062421972534
noisy true:425
noisy false:374
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 799
epoch [119/200] batch [5/25] time 0.298 (0.205) data 0.112 (0.107) loss_x loss_x 0.4185 (0.5699) acc_x 90.6250 (84.3750) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/25] time 0.182 (0.193) data 0.106 (0.105) loss_x loss_x 0.5073 (0.5442) acc_x 84.3750 (84.6875) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/25] time 0.185 (0.189) data 0.109 (0.105) loss_x loss_x 0.4131 (0.5678) acc_x 81.2500 (84.7917) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/25] time 0.200 (0.189) data 0.123 (0.107) loss_x loss_x 0.7129 (0.5646) acc_x 84.3750 (84.8438) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [25/25] time 0.213 (0.189) data 0.137 (0.109) loss_x loss_x 0.5884 (0.5863) acc_x 84.3750 (83.8750) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 796
clean true:789
clean false:7
clean_rate:0.9912060301507538
noisy true:428
noisy false:376
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 804
epoch [120/200] batch [5/24] time 0.167 (0.168) data 0.091 (0.092) loss_x loss_x 0.4622 (0.5311) acc_x 90.6250 (87.5000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/24] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.3418 (0.4452) acc_x 90.6250 (89.3750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/24] time 0.179 (0.175) data 0.102 (0.099) loss_x loss_x 0.6011 (0.5221) acc_x 84.3750 (87.7083) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/24] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.1808 (0.4969) acc_x 96.8750 (87.9688) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 799
clean true:796
clean false:3
clean_rate:0.9962453066332916
noisy true:427
noisy false:374
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 801
epoch [121/200] batch [5/24] time 0.169 (0.200) data 0.093 (0.094) loss_x loss_x 0.5967 (0.6163) acc_x 81.2500 (83.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/24] time 0.172 (0.185) data 0.095 (0.094) loss_x loss_x 0.4814 (0.5222) acc_x 81.2500 (85.3125) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/24] time 0.174 (0.180) data 0.097 (0.094) loss_x loss_x 0.8037 (0.5915) acc_x 78.1250 (84.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/24] time 0.212 (0.183) data 0.136 (0.099) loss_x loss_x 0.7788 (0.6024) acc_x 75.0000 (84.0625) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 821
clean true:816
clean false:5
clean_rate:0.9939098660170523
noisy true:442
noisy false:337
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 779
epoch [122/200] batch [5/25] time 0.227 (0.236) data 0.151 (0.116) loss_x loss_x 0.7510 (0.4723) acc_x 87.5000 (88.1250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/25] time 0.197 (0.211) data 0.121 (0.113) loss_x loss_x 0.4731 (0.4399) acc_x 81.2500 (88.4375) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/25] time 0.179 (0.203) data 0.103 (0.112) loss_x loss_x 0.4460 (0.4651) acc_x 81.2500 (87.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/25] time 0.162 (0.197) data 0.086 (0.109) loss_x loss_x 0.6592 (0.5252) acc_x 78.1250 (85.6250) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [25/25] time 0.161 (0.190) data 0.085 (0.104) loss_x loss_x 0.6655 (0.5332) acc_x 78.1250 (85.7500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 350
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:808
clean false:3
clean_rate:0.9963008631319359
noisy true:442
noisy false:347
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [123/200] batch [5/25] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.4500 (0.6936) acc_x 87.5000 (84.3750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/25] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.2482 (0.5658) acc_x 90.6250 (85.9375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/25] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.6973 (0.5857) acc_x 84.3750 (85.4167) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/25] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.3098 (0.5426) acc_x 90.6250 (87.0312) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [25/25] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.4363 (0.5342) acc_x 87.5000 (87.0000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:802
clean false:5
clean_rate:0.9938042131350682
noisy true:446
noisy false:347
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [124/200] batch [5/25] time 0.178 (0.185) data 0.102 (0.109) loss_x loss_x 0.3660 (0.4754) acc_x 90.6250 (87.5000) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/25] time 0.179 (0.187) data 0.103 (0.110) loss_x loss_x 0.4219 (0.5003) acc_x 87.5000 (87.5000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/25] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.7505 (0.5252) acc_x 81.2500 (87.0833) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/25] time 0.178 (0.188) data 0.101 (0.104) loss_x loss_x 0.5728 (0.5384) acc_x 81.2500 (86.7188) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [25/25] time 0.168 (0.187) data 0.092 (0.104) loss_x loss_x 0.2413 (0.5512) acc_x 90.6250 (86.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:819
clean false:5
clean_rate:0.9939320388349514
noisy true:448
noisy false:328
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [125/200] batch [5/25] time 0.169 (0.199) data 0.092 (0.123) loss_x loss_x 0.6191 (0.6275) acc_x 87.5000 (86.8750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/25] time 0.189 (0.187) data 0.098 (0.109) loss_x loss_x 0.4753 (0.6177) acc_x 90.6250 (85.6250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/25] time 0.173 (0.193) data 0.096 (0.109) loss_x loss_x 0.2046 (0.5434) acc_x 93.7500 (86.2500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/25] time 0.160 (0.186) data 0.083 (0.103) loss_x loss_x 0.3179 (0.5324) acc_x 90.6250 (85.9375) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [25/25] time 0.158 (0.182) data 0.082 (0.100) loss_x loss_x 0.9390 (0.5354) acc_x 81.2500 (86.6250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 811
clean true:808
clean false:3
clean_rate:0.9963008631319359
noisy true:439
noisy false:350
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 789
epoch [126/200] batch [5/25] time 0.178 (0.220) data 0.101 (0.122) loss_x loss_x 0.4126 (0.5600) acc_x 90.6250 (86.2500) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/25] time 0.202 (0.203) data 0.125 (0.115) loss_x loss_x 0.9189 (0.5680) acc_x 75.0000 (86.2500) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/25] time 0.182 (0.200) data 0.106 (0.116) loss_x loss_x 0.2034 (0.5297) acc_x 96.8750 (86.6667) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/25] time 0.168 (0.195) data 0.091 (0.113) loss_x loss_x 0.6240 (0.5181) acc_x 81.2500 (86.8750) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [25/25] time 0.262 (0.193) data 0.080 (0.108) loss_x loss_x 0.6313 (0.5204) acc_x 84.3750 (86.2500) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 812
clean true:804
clean false:8
clean_rate:0.9901477832512315
noisy true:448
noisy false:340
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 788
epoch [127/200] batch [5/25] time 0.167 (0.190) data 0.091 (0.113) loss_x loss_x 0.7119 (0.6318) acc_x 87.5000 (86.2500) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/25] time 0.280 (0.192) data 0.098 (0.105) loss_x loss_x 0.7720 (0.5829) acc_x 81.2500 (84.6875) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/25] time 0.182 (0.196) data 0.105 (0.105) loss_x loss_x 0.7871 (0.5885) acc_x 84.3750 (85.0000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/25] time 0.180 (0.190) data 0.103 (0.103) loss_x loss_x 0.7129 (0.6032) acc_x 78.1250 (85.0000) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [25/25] time 0.183 (0.189) data 0.106 (0.103) loss_x loss_x 0.4170 (0.6005) acc_x 87.5000 (84.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:798
clean false:4
clean_rate:0.9950124688279302
noisy true:437
noisy false:361
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [128/200] batch [5/25] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 0.5620 (0.6632) acc_x 84.3750 (80.6250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/25] time 0.163 (0.173) data 0.087 (0.096) loss_x loss_x 0.4961 (0.6214) acc_x 87.5000 (82.1875) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/25] time 0.172 (0.172) data 0.095 (0.096) loss_x loss_x 0.6118 (0.6065) acc_x 78.1250 (81.4583) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/25] time 0.201 (0.175) data 0.125 (0.099) loss_x loss_x 0.3596 (0.5586) acc_x 96.8750 (83.7500) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [25/25] time 0.182 (0.177) data 0.106 (0.101) loss_x loss_x 0.6929 (0.5606) acc_x 81.2500 (84.3750) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.5100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 816
clean true:812
clean false:4
clean_rate:0.9950980392156863
noisy true:445
noisy false:339
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 784
epoch [129/200] batch [5/25] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.6255 (0.5508) acc_x 71.8750 (83.1250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/25] time 0.168 (0.175) data 0.092 (0.099) loss_x loss_x 0.6650 (0.5760) acc_x 81.2500 (83.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/25] time 0.174 (0.177) data 0.098 (0.100) loss_x loss_x 0.6538 (0.5528) acc_x 84.3750 (84.1667) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/25] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.5405 (0.5386) acc_x 78.1250 (84.8438) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [25/25] time 0.180 (0.177) data 0.104 (0.101) loss_x loss_x 0.4944 (0.5598) acc_x 90.6250 (84.8750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:798
clean false:7
clean_rate:0.991304347826087
noisy true:423
noisy false:372
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [130/200] batch [5/25] time 0.180 (0.172) data 0.103 (0.096) loss_x loss_x 0.5073 (0.5317) acc_x 81.2500 (86.2500) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/25] time 0.174 (0.172) data 0.096 (0.096) loss_x loss_x 0.4768 (0.5544) acc_x 84.3750 (86.5625) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/25] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.2808 (0.5508) acc_x 90.6250 (86.6667) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/25] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.3970 (0.5513) acc_x 93.7500 (86.4062) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [25/25] time 0.187 (0.175) data 0.111 (0.098) loss_x loss_x 0.7515 (0.5548) acc_x 84.3750 (86.5000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 327
confident_label rate tensor(0.5219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 835
clean true:832
clean false:3
clean_rate:0.9964071856287425
noisy true:441
noisy false:324
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 765
epoch [131/200] batch [5/26] time 0.200 (0.197) data 0.123 (0.121) loss_x loss_x 0.3420 (0.5195) acc_x 90.6250 (88.7500) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/26] time 0.184 (0.194) data 0.108 (0.118) loss_x loss_x 0.2209 (0.5571) acc_x 96.8750 (86.8750) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/26] time 0.183 (0.191) data 0.107 (0.115) loss_x loss_x 0.4319 (0.5671) acc_x 84.3750 (86.2500) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/26] time 0.237 (0.210) data 0.161 (0.125) loss_x loss_x 0.2351 (0.5508) acc_x 93.7500 (86.5625) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/26] time 0.222 (0.208) data 0.146 (0.125) loss_x loss_x 0.2388 (0.5344) acc_x 93.7500 (86.3750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 798
clean true:795
clean false:3
clean_rate:0.9962406015037594
noisy true:457
noisy false:345
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 802
epoch [132/200] batch [5/24] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.4197 (0.7773) acc_x 93.7500 (83.7500) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/24] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.5210 (0.6152) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/24] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 0.5518 (0.6027) acc_x 84.3750 (86.2500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/24] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.6558 (0.5840) acc_x 84.3750 (87.1875) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:815
clean false:2
clean_rate:0.9975520195838433
noisy true:444
noisy false:339
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [133/200] batch [5/25] time 0.168 (0.180) data 0.092 (0.104) loss_x loss_x 0.7124 (0.7174) acc_x 81.2500 (83.1250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/25] time 0.177 (0.179) data 0.100 (0.103) loss_x loss_x 0.5991 (0.6667) acc_x 84.3750 (83.4375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/25] time 0.172 (0.179) data 0.096 (0.103) loss_x loss_x 0.5190 (0.6045) acc_x 87.5000 (85.8333) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/25] time 0.271 (0.183) data 0.100 (0.101) loss_x loss_x 0.5557 (0.5802) acc_x 84.3750 (85.6250) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [25/25] time 0.189 (0.183) data 0.112 (0.102) loss_x loss_x 0.4651 (0.5631) acc_x 90.6250 (86.3750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:824
clean false:3
clean_rate:0.9963724304715841
noisy true:435
noisy false:338
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [134/200] batch [5/25] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.7598 (0.6515) acc_x 78.1250 (81.8750) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/25] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.2279 (0.5953) acc_x 93.7500 (84.0625) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/25] time 0.177 (0.177) data 0.100 (0.101) loss_x loss_x 0.8223 (0.6119) acc_x 84.3750 (83.9583) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/25] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.6973 (0.6050) acc_x 75.0000 (83.9062) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [25/25] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.8452 (0.5581) acc_x 81.2500 (85.3750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 833
clean true:830
clean false:3
clean_rate:0.9963985594237695
noisy true:435
noisy false:332
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 767
epoch [135/200] batch [5/26] time 0.192 (0.192) data 0.115 (0.116) loss_x loss_x 1.1328 (0.6964) acc_x 65.6250 (81.2500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/26] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 1.0215 (0.6292) acc_x 71.8750 (82.8125) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/26] time 0.177 (0.184) data 0.101 (0.108) loss_x loss_x 0.5679 (0.5960) acc_x 84.3750 (83.1250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/26] time 0.190 (0.184) data 0.114 (0.108) loss_x loss_x 0.6743 (0.5835) acc_x 78.1250 (83.2812) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/26] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 0.5552 (0.5715) acc_x 87.5000 (84.3750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:814
clean false:5
clean_rate:0.9938949938949939
noisy true:435
noisy false:346
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [136/200] batch [5/25] time 0.170 (0.175) data 0.094 (0.099) loss_x loss_x 0.7910 (0.5241) acc_x 71.8750 (86.2500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/25] time 0.164 (0.171) data 0.088 (0.095) loss_x loss_x 0.8423 (0.6169) acc_x 78.1250 (82.5000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/25] time 0.189 (0.176) data 0.112 (0.100) loss_x loss_x 0.6436 (0.6404) acc_x 84.3750 (82.5000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/25] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.6367 (0.6055) acc_x 81.2500 (82.9688) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [25/25] time 0.285 (0.186) data 0.100 (0.106) loss_x loss_x 0.6787 (0.5826) acc_x 81.2500 (83.5000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:802
clean false:3
clean_rate:0.9962732919254659
noisy true:435
noisy false:360
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [137/200] batch [5/25] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.3464 (0.4555) acc_x 93.7500 (89.3750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/25] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.1255 (0.4693) acc_x 96.8750 (88.7500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/25] time 0.186 (0.194) data 0.108 (0.110) loss_x loss_x 0.6846 (0.4706) acc_x 71.8750 (87.7083) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/25] time 0.182 (0.199) data 0.106 (0.118) loss_x loss_x 0.5454 (0.4913) acc_x 78.1250 (85.4688) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [25/25] time 0.175 (0.197) data 0.098 (0.117) loss_x loss_x 1.0098 (0.5130) acc_x 75.0000 (85.1250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:809
clean false:4
clean_rate:0.995079950799508
noisy true:434
noisy false:353
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [138/200] batch [5/25] time 0.170 (0.179) data 0.094 (0.103) loss_x loss_x 0.6172 (0.5919) acc_x 84.3750 (85.6250) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/25] time 0.169 (0.184) data 0.092 (0.108) loss_x loss_x 0.6533 (0.5123) acc_x 81.2500 (87.8125) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/25] time 0.221 (0.196) data 0.145 (0.112) loss_x loss_x 0.2939 (0.4917) acc_x 84.3750 (87.7083) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/25] time 0.182 (0.194) data 0.105 (0.112) loss_x loss_x 0.8521 (0.5081) acc_x 75.0000 (87.3438) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [25/25] time 0.194 (0.193) data 0.117 (0.112) loss_x loss_x 0.6260 (0.4961) acc_x 87.5000 (87.8750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 829
clean true:823
clean false:6
clean_rate:0.9927623642943305
noisy true:441
noisy false:330
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 771
epoch [139/200] batch [5/25] time 0.177 (0.180) data 0.101 (0.104) loss_x loss_x 0.5493 (0.5947) acc_x 75.0000 (83.7500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/25] time 0.199 (0.178) data 0.123 (0.102) loss_x loss_x 0.4800 (0.5122) acc_x 87.5000 (85.3125) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/25] time 0.283 (0.195) data 0.134 (0.107) loss_x loss_x 0.2537 (0.4942) acc_x 90.6250 (85.8333) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/25] time 0.160 (0.193) data 0.084 (0.108) loss_x loss_x 0.6523 (0.5655) acc_x 81.2500 (83.9062) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [25/25] time 0.160 (0.188) data 0.083 (0.105) loss_x loss_x 0.2422 (0.5722) acc_x 96.8750 (84.5000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.5125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 820
clean true:813
clean false:7
clean_rate:0.9914634146341463
noisy true:440
noisy false:340
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 780
epoch [140/200] batch [5/25] time 0.204 (0.195) data 0.128 (0.118) loss_x loss_x 0.8721 (0.6775) acc_x 75.0000 (81.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/25] time 0.197 (0.200) data 0.121 (0.123) loss_x loss_x 0.4331 (0.6487) acc_x 81.2500 (81.8750) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/25] time 0.166 (0.203) data 0.090 (0.119) loss_x loss_x 0.4529 (0.5928) acc_x 87.5000 (83.5417) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/25] time 0.161 (0.193) data 0.085 (0.111) loss_x loss_x 0.3679 (0.5878) acc_x 87.5000 (84.0625) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [25/25] time 0.163 (0.188) data 0.087 (0.108) loss_x loss_x 0.9121 (0.5820) acc_x 84.3750 (84.6250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:800
clean false:5
clean_rate:0.9937888198757764
noisy true:443
noisy false:352
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [141/200] batch [5/25] time 0.170 (0.182) data 0.094 (0.106) loss_x loss_x 0.4802 (0.4668) acc_x 87.5000 (89.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/25] time 0.164 (0.174) data 0.088 (0.098) loss_x loss_x 0.9023 (0.5490) acc_x 71.8750 (86.2500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/25] time 0.168 (0.171) data 0.092 (0.095) loss_x loss_x 0.4719 (0.5692) acc_x 87.5000 (85.8333) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/25] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.5073 (0.5483) acc_x 84.3750 (85.6250) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [25/25] time 0.178 (0.174) data 0.101 (0.098) loss_x loss_x 0.5171 (0.5438) acc_x 84.3750 (86.2500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:814
clean false:10
clean_rate:0.9878640776699029
noisy true:419
noisy false:357
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [142/200] batch [5/25] time 0.173 (0.175) data 0.095 (0.097) loss_x loss_x 0.3130 (0.6609) acc_x 87.5000 (81.2500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/25] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 0.3406 (0.5125) acc_x 90.6250 (86.5625) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/25] time 0.167 (0.179) data 0.090 (0.102) loss_x loss_x 0.4556 (0.5346) acc_x 87.5000 (87.2917) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/25] time 0.164 (0.179) data 0.086 (0.102) loss_x loss_x 0.5601 (0.5190) acc_x 90.6250 (87.3438) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [25/25] time 0.174 (0.177) data 0.096 (0.100) loss_x loss_x 0.8721 (0.5285) acc_x 78.1250 (86.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 314
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 848
clean true:843
clean false:5
clean_rate:0.9941037735849056
noisy true:443
noisy false:309
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 752
epoch [143/200] batch [5/26] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.3108 (0.4442) acc_x 93.7500 (88.7500) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/26] time 0.165 (0.174) data 0.089 (0.097) loss_x loss_x 0.3123 (0.4360) acc_x 90.6250 (88.4375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/26] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.7871 (0.4711) acc_x 84.3750 (87.9167) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/26] time 0.163 (0.168) data 0.087 (0.091) loss_x loss_x 0.2947 (0.4673) acc_x 93.7500 (88.2812) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/26] time 0.167 (0.166) data 0.090 (0.090) loss_x loss_x 0.5522 (0.4708) acc_x 84.3750 (88.0000) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:825
clean false:2
clean_rate:0.9975816203143894
noisy true:410
noisy false:363
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [144/200] batch [5/25] time 0.179 (0.180) data 0.103 (0.100) loss_x loss_x 0.7231 (0.5354) acc_x 81.2500 (85.0000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/25] time 0.176 (0.177) data 0.099 (0.099) loss_x loss_x 0.5308 (0.4604) acc_x 78.1250 (85.6250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/25] time 0.179 (0.178) data 0.103 (0.100) loss_x loss_x 0.5049 (0.5048) acc_x 90.6250 (85.8333) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/25] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.4167 (0.5226) acc_x 87.5000 (85.7812) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [25/25] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.6890 (0.5526) acc_x 81.2500 (84.8750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:819
clean false:7
clean_rate:0.9915254237288136
noisy true:433
noisy false:341
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [145/200] batch [5/25] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.3210 (0.5788) acc_x 90.6250 (85.6250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/25] time 0.182 (0.180) data 0.105 (0.102) loss_x loss_x 0.6221 (0.5452) acc_x 78.1250 (85.9375) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/25] time 0.165 (0.181) data 0.088 (0.104) loss_x loss_x 0.8677 (0.5885) acc_x 81.2500 (84.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/25] time 0.180 (0.180) data 0.103 (0.102) loss_x loss_x 0.4219 (0.5538) acc_x 90.6250 (85.4688) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [25/25] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.6323 (0.5533) acc_x 84.3750 (85.5000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:811
clean false:4
clean_rate:0.9950920245398773
noisy true:427
noisy false:358
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [146/200] batch [5/25] time 0.168 (0.167) data 0.091 (0.090) loss_x loss_x 0.9336 (0.5542) acc_x 84.3750 (87.5000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/25] time 0.194 (0.176) data 0.118 (0.099) loss_x loss_x 0.4563 (0.5408) acc_x 90.6250 (86.8750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/25] time 0.176 (0.187) data 0.097 (0.103) loss_x loss_x 0.6069 (0.5203) acc_x 81.2500 (87.2917) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/25] time 0.167 (0.184) data 0.090 (0.102) loss_x loss_x 0.5420 (0.5209) acc_x 84.3750 (87.3438) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [25/25] time 0.159 (0.180) data 0.082 (0.099) loss_x loss_x 0.7144 (0.5248) acc_x 87.5000 (87.1250) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:818
clean false:7
clean_rate:0.9915151515151515
noisy true:447
noisy false:328
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [147/200] batch [5/25] time 0.188 (0.189) data 0.112 (0.113) loss_x loss_x 0.6104 (0.7813) acc_x 81.2500 (81.2500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/25] time 0.174 (0.182) data 0.098 (0.106) loss_x loss_x 0.5801 (0.7176) acc_x 84.3750 (81.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/25] time 0.298 (0.188) data 0.114 (0.105) loss_x loss_x 0.9380 (0.7126) acc_x 78.1250 (81.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/25] time 0.181 (0.185) data 0.105 (0.103) loss_x loss_x 0.4626 (0.6832) acc_x 87.5000 (81.4062) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [25/25] time 0.195 (0.186) data 0.118 (0.105) loss_x loss_x 0.6582 (0.6376) acc_x 81.2500 (82.7500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:804
clean false:5
clean_rate:0.9938195302843016
noisy true:441
noisy false:350
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [148/200] batch [5/25] time 0.163 (0.161) data 0.087 (0.085) loss_x loss_x 0.4143 (0.4526) acc_x 87.5000 (88.1250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/25] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 0.4895 (0.5404) acc_x 93.7500 (88.1250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/25] time 0.158 (0.161) data 0.082 (0.085) loss_x loss_x 0.5439 (0.5442) acc_x 90.6250 (87.5000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/25] time 0.166 (0.164) data 0.089 (0.087) loss_x loss_x 0.3235 (0.5166) acc_x 93.7500 (87.3438) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [25/25] time 0.184 (0.166) data 0.108 (0.089) loss_x loss_x 0.4187 (0.5331) acc_x 90.6250 (87.0000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 334
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:811
clean false:4
clean_rate:0.9950920245398773
noisy true:455
noisy false:330
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [149/200] batch [5/25] time 0.288 (0.196) data 0.102 (0.095) loss_x loss_x 0.7568 (0.5646) acc_x 71.8750 (85.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/25] time 0.209 (0.207) data 0.132 (0.109) loss_x loss_x 0.7124 (0.5698) acc_x 81.2500 (83.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/25] time 0.179 (0.200) data 0.101 (0.109) loss_x loss_x 0.3489 (0.5277) acc_x 87.5000 (84.5833) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/25] time 0.173 (0.192) data 0.097 (0.105) loss_x loss_x 0.4858 (0.4816) acc_x 84.3750 (86.0938) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [25/25] time 0.174 (0.189) data 0.097 (0.103) loss_x loss_x 0.5103 (0.5360) acc_x 84.3750 (85.3750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 783
clean true:778
clean false:5
clean_rate:0.9936143039591315
noisy true:431
noisy false:386
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 817
epoch [150/200] batch [5/24] time 0.210 (0.191) data 0.134 (0.115) loss_x loss_x 0.6313 (0.4709) acc_x 84.3750 (88.1250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/24] time 0.192 (0.193) data 0.115 (0.117) loss_x loss_x 0.4944 (0.5039) acc_x 87.5000 (87.8125) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/24] time 0.191 (0.191) data 0.114 (0.114) loss_x loss_x 0.9624 (0.5426) acc_x 75.0000 (86.0417) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/24] time 0.176 (0.188) data 0.099 (0.111) loss_x loss_x 0.5342 (0.5205) acc_x 81.2500 (86.4062) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:813
clean false:4
clean_rate:0.9951040391676866
noisy true:441
noisy false:342
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [151/200] batch [5/25] time 0.159 (0.172) data 0.080 (0.095) loss_x loss_x 0.2559 (0.6029) acc_x 90.6250 (86.8750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/25] time 0.183 (0.197) data 0.106 (0.109) loss_x loss_x 0.5000 (0.5276) acc_x 87.5000 (87.1875) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/25] time 0.185 (0.191) data 0.109 (0.107) loss_x loss_x 0.2600 (0.5039) acc_x 93.7500 (87.9167) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/25] time 0.206 (0.189) data 0.129 (0.107) loss_x loss_x 0.4253 (0.4894) acc_x 93.7500 (88.7500) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [25/25] time 0.164 (0.189) data 0.086 (0.108) loss_x loss_x 0.3923 (0.4943) acc_x 87.5000 (88.1250) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:823
clean false:3
clean_rate:0.9963680387409201
noisy true:429
noisy false:345
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [152/200] batch [5/25] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.5073 (0.4938) acc_x 90.6250 (88.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/25] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 0.3015 (0.4695) acc_x 93.7500 (87.5000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/25] time 0.166 (0.194) data 0.089 (0.104) loss_x loss_x 0.5420 (0.4846) acc_x 81.2500 (86.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/25] time 0.169 (0.191) data 0.091 (0.105) loss_x loss_x 0.5815 (0.4765) acc_x 87.5000 (87.5000) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [25/25] time 0.198 (0.190) data 0.121 (0.106) loss_x loss_x 0.3298 (0.4708) acc_x 93.7500 (88.1250) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.5200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 832
clean true:827
clean false:5
clean_rate:0.9939903846153846
noisy true:441
noisy false:327
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 768
epoch [153/200] batch [5/26] time 0.157 (0.160) data 0.081 (0.084) loss_x loss_x 0.5312 (0.4736) acc_x 81.2500 (86.8750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/26] time 0.161 (0.171) data 0.083 (0.083) loss_x loss_x 0.4629 (0.4905) acc_x 87.5000 (87.5000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/26] time 0.164 (0.168) data 0.088 (0.084) loss_x loss_x 0.5718 (0.5301) acc_x 87.5000 (86.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/26] time 0.177 (0.171) data 0.101 (0.088) loss_x loss_x 0.7505 (0.5661) acc_x 81.2500 (85.1562) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/26] time 0.184 (0.171) data 0.107 (0.090) loss_x loss_x 0.7485 (0.5802) acc_x 81.2500 (84.6250) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 802
clean true:796
clean false:6
clean_rate:0.9925187032418953
noisy true:442
noisy false:356
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 798
epoch [154/200] batch [5/25] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 0.3613 (0.5694) acc_x 93.7500 (85.6250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/25] time 0.192 (0.183) data 0.115 (0.106) loss_x loss_x 0.3931 (0.5517) acc_x 90.6250 (85.6250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/25] time 0.279 (0.188) data 0.093 (0.104) loss_x loss_x 0.7754 (0.5201) acc_x 84.3750 (87.2917) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/25] time 0.163 (0.184) data 0.086 (0.101) loss_x loss_x 0.5679 (0.5111) acc_x 84.3750 (87.0312) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [25/25] time 0.251 (0.184) data 0.175 (0.102) loss_x loss_x 0.6704 (0.5236) acc_x 84.3750 (86.8750) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 342
confident_label rate tensor(0.5181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 829
clean true:825
clean false:4
clean_rate:0.9951749095295537
noisy true:433
noisy false:338
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 771
epoch [155/200] batch [5/25] time 0.189 (0.179) data 0.113 (0.102) loss_x loss_x 0.8721 (0.5920) acc_x 78.1250 (85.0000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/25] time 0.174 (0.177) data 0.096 (0.100) loss_x loss_x 0.8179 (0.5502) acc_x 78.1250 (85.9375) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/25] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.5376 (0.5636) acc_x 84.3750 (85.0000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/25] time 0.171 (0.181) data 0.095 (0.105) loss_x loss_x 0.5444 (0.5450) acc_x 84.3750 (85.4688) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [25/25] time 0.197 (0.183) data 0.119 (0.106) loss_x loss_x 0.1984 (0.5156) acc_x 93.7500 (86.3750) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 333
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:820
clean false:5
clean_rate:0.9939393939393939
noisy true:447
noisy false:328
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [156/200] batch [5/25] time 0.187 (0.172) data 0.111 (0.094) loss_x loss_x 0.4341 (0.5317) acc_x 87.5000 (85.0000) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/25] time 0.188 (0.175) data 0.111 (0.098) loss_x loss_x 0.5991 (0.5571) acc_x 84.3750 (84.0625) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/25] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.2090 (0.5371) acc_x 90.6250 (85.0000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/25] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.3044 (0.5252) acc_x 90.6250 (85.7812) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [25/25] time 0.158 (0.176) data 0.082 (0.099) loss_x loss_x 0.0759 (0.5034) acc_x 100.0000 (86.8750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 806
clean true:800
clean false:6
clean_rate:0.9925558312655087
noisy true:439
noisy false:355
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 794
epoch [157/200] batch [5/25] time 0.176 (0.190) data 0.100 (0.114) loss_x loss_x 0.3977 (0.5395) acc_x 93.7500 (86.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/25] time 0.172 (0.184) data 0.096 (0.107) loss_x loss_x 0.5933 (0.5200) acc_x 81.2500 (86.5625) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/25] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.7446 (0.5275) acc_x 75.0000 (85.8333) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/25] time 0.174 (0.184) data 0.098 (0.103) loss_x loss_x 0.9980 (0.5450) acc_x 78.1250 (85.4688) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [25/25] time 0.200 (0.185) data 0.124 (0.105) loss_x loss_x 0.9062 (0.5660) acc_x 78.1250 (84.8750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:810
clean false:4
clean_rate:0.995085995085995
noisy true:438
noisy false:348
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [158/200] batch [5/25] time 0.166 (0.178) data 0.090 (0.101) loss_x loss_x 0.7588 (0.6032) acc_x 81.2500 (86.2500) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/25] time 0.157 (0.170) data 0.080 (0.093) loss_x loss_x 0.6333 (0.6653) acc_x 84.3750 (84.0625) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/25] time 0.248 (0.172) data 0.171 (0.096) loss_x loss_x 0.3359 (0.6522) acc_x 90.6250 (84.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/25] time 0.177 (0.174) data 0.101 (0.097) loss_x loss_x 0.4021 (0.6249) acc_x 81.2500 (84.5312) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [25/25] time 0.182 (0.174) data 0.106 (0.097) loss_x loss_x 0.1587 (0.6056) acc_x 93.7500 (84.6250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.5144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 823
clean true:818
clean false:5
clean_rate:0.9939246658566221
noisy true:430
noisy false:347
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 777
epoch [159/200] batch [5/25] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.4810 (0.4809) acc_x 90.6250 (88.7500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/25] time 0.178 (0.184) data 0.102 (0.107) loss_x loss_x 0.2671 (0.4939) acc_x 96.8750 (87.8125) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/25] time 0.172 (0.180) data 0.095 (0.104) loss_x loss_x 0.1436 (0.5140) acc_x 96.8750 (86.6667) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/25] time 0.194 (0.180) data 0.114 (0.103) loss_x loss_x 0.5293 (0.5365) acc_x 87.5000 (86.0938) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [25/25] time 0.173 (0.179) data 0.097 (0.102) loss_x loss_x 0.3235 (0.5137) acc_x 93.7500 (86.7500) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:821
clean false:4
clean_rate:0.9951515151515151
noisy true:439
noisy false:336
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [160/200] batch [5/25] time 0.183 (0.214) data 0.106 (0.109) loss_x loss_x 0.5117 (0.4820) acc_x 87.5000 (86.2500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/25] time 0.188 (0.200) data 0.111 (0.109) loss_x loss_x 0.4475 (0.4656) acc_x 87.5000 (87.5000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/25] time 0.167 (0.191) data 0.090 (0.104) loss_x loss_x 0.7861 (0.5916) acc_x 81.2500 (85.0000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/25] time 0.168 (0.186) data 0.090 (0.102) loss_x loss_x 0.5835 (0.5858) acc_x 90.6250 (85.1562) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [25/25] time 0.170 (0.184) data 0.094 (0.102) loss_x loss_x 0.2563 (0.5555) acc_x 96.8750 (85.7500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 810
clean true:805
clean false:5
clean_rate:0.9938271604938271
noisy true:423
noisy false:367
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 790
epoch [161/200] batch [5/25] time 0.161 (0.191) data 0.084 (0.088) loss_x loss_x 0.8125 (0.6162) acc_x 71.8750 (81.2500) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/25] time 0.181 (0.188) data 0.105 (0.098) loss_x loss_x 0.4663 (0.5509) acc_x 84.3750 (83.4375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/25] time 0.174 (0.184) data 0.096 (0.098) loss_x loss_x 0.4431 (0.5844) acc_x 84.3750 (82.5000) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/25] time 0.174 (0.179) data 0.097 (0.096) loss_x loss_x 0.5430 (0.5367) acc_x 87.5000 (84.0625) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [25/25] time 0.192 (0.178) data 0.116 (0.096) loss_x loss_x 0.3442 (0.5381) acc_x 90.6250 (84.3750) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 326
confident_label rate tensor(0.5238, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 838
clean true:833
clean false:5
clean_rate:0.9940334128878282
noisy true:441
noisy false:321
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 762
epoch [162/200] batch [5/26] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.4634 (0.5135) acc_x 93.7500 (85.6250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/26] time 0.157 (0.161) data 0.080 (0.085) loss_x loss_x 0.6147 (0.5520) acc_x 81.2500 (84.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/26] time 0.190 (0.170) data 0.113 (0.086) loss_x loss_x 0.6606 (0.5746) acc_x 75.0000 (84.7917) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/26] time 0.196 (0.180) data 0.119 (0.098) loss_x loss_x 0.6704 (0.6057) acc_x 90.6250 (84.3750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/26] time 0.200 (0.178) data 0.123 (0.097) loss_x loss_x 0.5718 (0.5750) acc_x 81.2500 (85.0000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:813
clean false:6
clean_rate:0.9926739926739927
noisy true:435
noisy false:346
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [163/200] batch [5/25] time 0.179 (0.174) data 0.103 (0.098) loss_x loss_x 0.8491 (0.6358) acc_x 81.2500 (83.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/25] time 0.177 (0.176) data 0.101 (0.100) loss_x loss_x 0.4541 (0.5609) acc_x 90.6250 (86.5625) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/25] time 0.170 (0.185) data 0.094 (0.102) loss_x loss_x 0.5537 (0.5583) acc_x 87.5000 (86.8750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/25] time 0.162 (0.181) data 0.085 (0.099) loss_x loss_x 0.5435 (0.5457) acc_x 81.2500 (86.7188) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [25/25] time 0.158 (0.176) data 0.081 (0.096) loss_x loss_x 0.4150 (0.5284) acc_x 90.6250 (87.0000) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 335
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:818
clean false:4
clean_rate:0.9951338199513382
noisy true:447
noisy false:331
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [164/200] batch [5/25] time 0.169 (0.165) data 0.092 (0.088) loss_x loss_x 0.6250 (0.5897) acc_x 78.1250 (85.0000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/25] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.4272 (0.5457) acc_x 87.5000 (85.9375) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/25] time 0.168 (0.181) data 0.091 (0.098) loss_x loss_x 0.3999 (0.5597) acc_x 87.5000 (84.7917) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/25] time 0.163 (0.176) data 0.086 (0.094) loss_x loss_x 0.6304 (0.5477) acc_x 81.2500 (85.3125) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [25/25] time 0.186 (0.175) data 0.109 (0.095) loss_x loss_x 0.5664 (0.5631) acc_x 81.2500 (85.1250) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 815
clean true:813
clean false:2
clean_rate:0.9975460122699387
noisy true:439
noisy false:346
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 785
epoch [165/200] batch [5/25] time 0.197 (0.184) data 0.121 (0.108) loss_x loss_x 0.5757 (0.4990) acc_x 84.3750 (88.7500) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/25] time 0.188 (0.183) data 0.110 (0.107) loss_x loss_x 0.5825 (0.5307) acc_x 84.3750 (85.9375) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/25] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.5566 (0.5323) acc_x 90.6250 (86.6667) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/25] time 0.167 (0.183) data 0.090 (0.106) loss_x loss_x 0.5967 (0.5198) acc_x 81.2500 (86.2500) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [25/25] time 0.162 (0.183) data 0.085 (0.106) loss_x loss_x 0.3882 (0.4904) acc_x 90.6250 (86.7500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5263, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 842
clean true:836
clean false:6
clean_rate:0.9928741092636579
noisy true:440
noisy false:318
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 758
epoch [166/200] batch [5/26] time 0.172 (0.184) data 0.096 (0.107) loss_x loss_x 0.3408 (0.5225) acc_x 84.3750 (85.0000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/26] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 0.4360 (0.5039) acc_x 84.3750 (85.3125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/26] time 0.165 (0.174) data 0.088 (0.097) loss_x loss_x 0.6226 (0.5157) acc_x 81.2500 (84.5833) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/26] time 0.166 (0.171) data 0.090 (0.095) loss_x loss_x 0.6392 (0.5044) acc_x 84.3750 (85.3125) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/26] time 0.176 (0.172) data 0.098 (0.095) loss_x loss_x 0.5923 (0.5075) acc_x 81.2500 (85.1250) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:809
clean false:4
clean_rate:0.995079950799508
noisy true:438
noisy false:349
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [167/200] batch [5/25] time 0.182 (0.208) data 0.106 (0.098) loss_x loss_x 0.8838 (0.6500) acc_x 81.2500 (81.8750) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/25] time 0.163 (0.193) data 0.086 (0.099) loss_x loss_x 0.1522 (0.5458) acc_x 96.8750 (85.0000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/25] time 0.197 (0.188) data 0.120 (0.100) loss_x loss_x 0.4502 (0.5470) acc_x 87.5000 (85.4167) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/25] time 0.186 (0.189) data 0.109 (0.104) loss_x loss_x 0.9302 (0.5619) acc_x 84.3750 (85.6250) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [25/25] time 0.186 (0.190) data 0.110 (0.106) loss_x loss_x 0.3235 (0.5344) acc_x 90.6250 (86.0000) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.5125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 820
clean true:814
clean false:6
clean_rate:0.9926829268292683
noisy true:429
noisy false:351
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 780
epoch [168/200] batch [5/25] time 0.183 (0.185) data 0.106 (0.109) loss_x loss_x 0.3865 (0.5665) acc_x 90.6250 (85.6250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/25] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.8135 (0.5904) acc_x 84.3750 (84.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/25] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.2351 (0.5200) acc_x 90.6250 (85.6250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/25] time 0.175 (0.179) data 0.098 (0.103) loss_x loss_x 0.7324 (0.5379) acc_x 81.2500 (85.7812) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [25/25] time 0.188 (0.180) data 0.112 (0.103) loss_x loss_x 0.6011 (0.5492) acc_x 87.5000 (85.5000) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 351
confident_label rate tensor(0.5144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 823
clean true:816
clean false:7
clean_rate:0.991494532199271
noisy true:433
noisy false:344
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 777
epoch [169/200] batch [5/25] time 0.169 (0.187) data 0.091 (0.110) loss_x loss_x 0.6973 (0.5073) acc_x 84.3750 (87.5000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/25] time 0.171 (0.185) data 0.094 (0.108) loss_x loss_x 0.1788 (0.4568) acc_x 96.8750 (88.7500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/25] time 0.163 (0.182) data 0.086 (0.105) loss_x loss_x 0.4578 (0.4612) acc_x 90.6250 (88.7500) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/25] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.8911 (0.4989) acc_x 78.1250 (87.9688) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [25/25] time 0.180 (0.186) data 0.103 (0.105) loss_x loss_x 0.7349 (0.5162) acc_x 81.2500 (87.5000) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 343
confident_label rate tensor(0.5188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 830
clean true:822
clean false:8
clean_rate:0.9903614457831326
noisy true:435
noisy false:335
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 770
epoch [170/200] batch [5/25] time 0.207 (0.184) data 0.109 (0.086) loss_x loss_x 0.8774 (0.4913) acc_x 78.1250 (88.7500) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/25] time 0.158 (0.174) data 0.082 (0.088) loss_x loss_x 0.5649 (0.5173) acc_x 87.5000 (87.1875) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/25] time 0.159 (0.182) data 0.081 (0.098) loss_x loss_x 0.5464 (0.5139) acc_x 84.3750 (87.0833) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/25] time 0.158 (0.182) data 0.081 (0.100) loss_x loss_x 0.4109 (0.4761) acc_x 90.6250 (88.1250) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [25/25] time 0.222 (0.184) data 0.145 (0.103) loss_x loss_x 0.5312 (0.4923) acc_x 81.2500 (87.6250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 331
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:839
clean false:6
clean_rate:0.9928994082840237
noisy true:430
noisy false:325
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [171/200] batch [5/26] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.4985 (0.4921) acc_x 87.5000 (87.5000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/26] time 0.188 (0.185) data 0.112 (0.108) loss_x loss_x 0.5806 (0.5316) acc_x 87.5000 (86.2500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/26] time 0.272 (0.187) data 0.089 (0.102) loss_x loss_x 0.4084 (0.5104) acc_x 84.3750 (86.4583) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/26] time 0.188 (0.190) data 0.112 (0.104) loss_x loss_x 0.4368 (0.5131) acc_x 87.5000 (86.0938) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/26] time 0.184 (0.189) data 0.107 (0.105) loss_x loss_x 0.4302 (0.5174) acc_x 84.3750 (85.7500) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 809
clean true:806
clean false:3
clean_rate:0.9962917181705809
noisy true:440
noisy false:351
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 791
epoch [172/200] batch [5/25] time 0.176 (0.184) data 0.097 (0.107) loss_x loss_x 0.4026 (0.5271) acc_x 90.6250 (85.6250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/25] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.4646 (0.5398) acc_x 90.6250 (85.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/25] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.2788 (0.5608) acc_x 93.7500 (86.0417) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/25] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.6841 (0.5627) acc_x 81.2500 (85.9375) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [25/25] time 0.170 (0.189) data 0.093 (0.104) loss_x loss_x 0.6860 (0.5692) acc_x 81.2500 (85.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 798
clean true:792
clean false:6
clean_rate:0.9924812030075187
noisy true:436
noisy false:366
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 802
epoch [173/200] batch [5/24] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.6128 (0.4194) acc_x 78.1250 (88.7500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/24] time 0.171 (0.171) data 0.093 (0.094) loss_x loss_x 0.4856 (0.4617) acc_x 87.5000 (86.8750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/24] time 0.179 (0.171) data 0.103 (0.094) loss_x loss_x 0.6152 (0.4654) acc_x 78.1250 (87.0833) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/24] time 0.191 (0.174) data 0.115 (0.097) loss_x loss_x 0.3728 (0.4702) acc_x 90.6250 (87.0312) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 323
confident_label rate tensor(0.5244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 839
clean true:836
clean false:3
clean_rate:0.9964243146603099
noisy true:441
noisy false:320
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 761
epoch [174/200] batch [5/26] time 0.162 (0.162) data 0.086 (0.085) loss_x loss_x 0.5229 (0.5137) acc_x 84.3750 (86.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/26] time 0.183 (0.181) data 0.107 (0.093) loss_x loss_x 0.6724 (0.4747) acc_x 84.3750 (87.1875) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/26] time 0.173 (0.180) data 0.097 (0.096) loss_x loss_x 0.4954 (0.5034) acc_x 87.5000 (87.0833) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/26] time 0.162 (0.178) data 0.085 (0.095) loss_x loss_x 0.5142 (0.5147) acc_x 87.5000 (86.7188) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/26] time 0.166 (0.176) data 0.089 (0.095) loss_x loss_x 0.4241 (0.5358) acc_x 78.1250 (85.7500) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:817
clean false:5
clean_rate:0.9939172749391727
noisy true:422
noisy false:356
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [175/200] batch [5/25] time 0.181 (0.176) data 0.103 (0.099) loss_x loss_x 0.3357 (0.4830) acc_x 93.7500 (87.5000) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/25] time 0.167 (0.191) data 0.090 (0.103) loss_x loss_x 0.5825 (0.4995) acc_x 81.2500 (86.8750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/25] time 0.172 (0.184) data 0.095 (0.099) loss_x loss_x 0.7646 (0.5677) acc_x 71.8750 (84.5833) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/25] time 0.163 (0.178) data 0.086 (0.096) loss_x loss_x 0.5400 (0.5792) acc_x 84.3750 (84.2188) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [25/25] time 0.162 (0.175) data 0.085 (0.094) loss_x loss_x 0.5615 (0.5769) acc_x 84.3750 (84.7500) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 805
clean true:801
clean false:4
clean_rate:0.9950310559006211
noisy true:435
noisy false:360
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 795
epoch [176/200] batch [5/25] time 0.172 (0.187) data 0.096 (0.110) loss_x loss_x 0.4355 (0.3755) acc_x 84.3750 (88.7500) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/25] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.4963 (0.4180) acc_x 90.6250 (89.0625) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/25] time 0.187 (0.181) data 0.111 (0.105) loss_x loss_x 0.4524 (0.4541) acc_x 84.3750 (87.9167) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/25] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.6597 (0.4827) acc_x 93.7500 (87.6562) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [25/25] time 0.174 (0.187) data 0.097 (0.104) loss_x loss_x 0.4634 (0.4960) acc_x 87.5000 (87.1250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:814
clean false:8
clean_rate:0.9902676399026764
noisy true:430
noisy false:348
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [177/200] batch [5/25] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.6113 (0.4573) acc_x 87.5000 (90.0000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/25] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.7505 (0.4425) acc_x 84.3750 (90.6250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/25] time 0.187 (0.186) data 0.111 (0.102) loss_x loss_x 0.1434 (0.4715) acc_x 100.0000 (89.7917) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/25] time 0.184 (0.181) data 0.108 (0.099) loss_x loss_x 0.4478 (0.4944) acc_x 87.5000 (88.5938) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [25/25] time 0.205 (0.183) data 0.129 (0.102) loss_x loss_x 0.2886 (0.4929) acc_x 93.7500 (88.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:803
clean false:4
clean_rate:0.9950433705080545
noisy true:444
noisy false:349
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [178/200] batch [5/25] time 0.161 (0.164) data 0.084 (0.088) loss_x loss_x 0.2720 (0.6349) acc_x 93.7500 (83.7500) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/25] time 0.167 (0.174) data 0.090 (0.087) loss_x loss_x 0.3457 (0.5044) acc_x 90.6250 (86.8750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/25] time 0.175 (0.170) data 0.099 (0.086) loss_x loss_x 0.4277 (0.5111) acc_x 90.6250 (87.0833) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/25] time 0.164 (0.171) data 0.087 (0.089) loss_x loss_x 0.5479 (0.5198) acc_x 81.2500 (86.5625) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [25/25] time 0.275 (0.177) data 0.093 (0.092) loss_x loss_x 0.6865 (0.5224) acc_x 84.3750 (86.3750) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:819
clean false:7
clean_rate:0.9915254237288136
noisy true:433
noisy false:341
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [179/200] batch [5/25] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.4397 (0.5355) acc_x 84.3750 (85.0000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/25] time 0.191 (0.181) data 0.114 (0.104) loss_x loss_x 0.4587 (0.6132) acc_x 90.6250 (82.8125) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/25] time 0.181 (0.189) data 0.104 (0.105) loss_x loss_x 0.6001 (0.5592) acc_x 81.2500 (85.0000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/25] time 0.163 (0.187) data 0.087 (0.105) loss_x loss_x 0.2939 (0.5444) acc_x 93.7500 (85.3125) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [25/25] time 0.163 (0.182) data 0.086 (0.101) loss_x loss_x 0.3130 (0.5267) acc_x 90.6250 (86.0000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.5119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 819
clean true:814
clean false:5
clean_rate:0.9938949938949939
noisy true:439
noisy false:342
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 781
epoch [180/200] batch [5/25] time 0.182 (0.174) data 0.106 (0.096) loss_x loss_x 0.7017 (0.5875) acc_x 81.2500 (85.6250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/25] time 0.190 (0.178) data 0.114 (0.101) loss_x loss_x 0.2944 (0.5478) acc_x 93.7500 (85.9375) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/25] time 0.176 (0.184) data 0.099 (0.107) loss_x loss_x 0.5205 (0.5264) acc_x 81.2500 (85.2083) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/25] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.9771 (0.5575) acc_x 81.2500 (85.1562) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [25/25] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 0.4927 (0.5461) acc_x 84.3750 (85.8750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 332
confident_label rate tensor(0.5219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 835
clean true:830
clean false:5
clean_rate:0.9940119760479041
noisy true:438
noisy false:327
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 765
epoch [181/200] batch [5/26] time 0.159 (0.171) data 0.082 (0.094) loss_x loss_x 0.4355 (0.6166) acc_x 84.3750 (84.3750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/26] time 0.168 (0.170) data 0.091 (0.093) loss_x loss_x 0.2878 (0.5710) acc_x 87.5000 (84.6875) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/26] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.4670 (0.5005) acc_x 84.3750 (85.4167) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/26] time 0.172 (0.171) data 0.095 (0.094) loss_x loss_x 0.4590 (0.4882) acc_x 87.5000 (85.7812) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/26] time 0.174 (0.176) data 0.098 (0.095) loss_x loss_x 0.5933 (0.4810) acc_x 84.3750 (86.1250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 832
clean true:829
clean false:3
clean_rate:0.9963942307692307
noisy true:430
noisy false:338
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 768
epoch [182/200] batch [5/26] time 0.162 (0.167) data 0.085 (0.091) loss_x loss_x 0.6118 (0.5999) acc_x 78.1250 (81.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/26] time 0.160 (0.184) data 0.083 (0.087) loss_x loss_x 0.6372 (0.6065) acc_x 78.1250 (82.8125) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/26] time 0.157 (0.175) data 0.081 (0.085) loss_x loss_x 0.6777 (0.5875) acc_x 84.3750 (83.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/26] time 0.180 (0.175) data 0.103 (0.088) loss_x loss_x 0.4971 (0.5664) acc_x 84.3750 (84.3750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/26] time 0.187 (0.180) data 0.110 (0.095) loss_x loss_x 0.4446 (0.5428) acc_x 87.5000 (85.6250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 308
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 853
clean true:848
clean false:5
clean_rate:0.9941383352872216
noisy true:444
noisy false:303
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 747
epoch [183/200] batch [5/26] time 0.182 (0.201) data 0.105 (0.101) loss_x loss_x 0.3237 (0.5585) acc_x 93.7500 (85.6250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/26] time 0.184 (0.192) data 0.107 (0.104) loss_x loss_x 0.7632 (0.6037) acc_x 78.1250 (84.3750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/26] time 0.194 (0.187) data 0.117 (0.103) loss_x loss_x 0.3706 (0.5997) acc_x 93.7500 (85.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/26] time 0.173 (0.185) data 0.095 (0.103) loss_x loss_x 0.4404 (0.6107) acc_x 87.5000 (86.0938) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/26] time 0.158 (0.180) data 0.081 (0.099) loss_x loss_x 0.3020 (0.5888) acc_x 87.5000 (86.1250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 338
confident_label rate tensor(0.5163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 826
clean true:820
clean false:6
clean_rate:0.9927360774818402
noisy true:442
noisy false:332
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 774
epoch [184/200] batch [5/25] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.7866 (0.4207) acc_x 75.0000 (89.3750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/25] time 0.191 (0.179) data 0.115 (0.102) loss_x loss_x 0.4836 (0.5341) acc_x 90.6250 (86.5625) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/25] time 0.188 (0.191) data 0.111 (0.103) loss_x loss_x 0.3777 (0.5181) acc_x 93.7500 (86.6667) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/25] time 0.215 (0.192) data 0.138 (0.107) loss_x loss_x 0.4568 (0.5354) acc_x 87.5000 (86.7188) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [25/25] time 0.167 (0.187) data 0.091 (0.104) loss_x loss_x 0.5972 (0.5054) acc_x 84.3750 (87.5000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:821
clean false:4
clean_rate:0.9951515151515151
noisy true:438
noisy false:337
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [185/200] batch [5/25] time 0.175 (0.176) data 0.098 (0.100) loss_x loss_x 0.7285 (0.7445) acc_x 87.5000 (83.1250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/25] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.3503 (0.6314) acc_x 90.6250 (83.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/25] time 0.172 (0.178) data 0.092 (0.101) loss_x loss_x 0.4321 (0.5926) acc_x 90.6250 (84.7917) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/25] time 0.180 (0.176) data 0.104 (0.100) loss_x loss_x 0.7061 (0.6070) acc_x 75.0000 (84.2188) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [25/25] time 0.301 (0.185) data 0.111 (0.102) loss_x loss_x 0.3633 (0.5780) acc_x 90.6250 (84.8750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 807
clean true:801
clean false:6
clean_rate:0.9925650557620818
noisy true:431
noisy false:362
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 793
epoch [186/200] batch [5/25] time 0.250 (0.182) data 0.173 (0.105) loss_x loss_x 0.6787 (0.5039) acc_x 93.7500 (87.5000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/25] time 0.175 (0.178) data 0.098 (0.102) loss_x loss_x 0.8833 (0.5193) acc_x 68.7500 (86.5625) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/25] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.3259 (0.5127) acc_x 87.5000 (86.0417) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/25] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4502 (0.5516) acc_x 84.3750 (85.9375) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [25/25] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.4839 (0.5281) acc_x 84.3750 (86.1250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 319
confident_label rate tensor(0.5275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 844
clean true:838
clean false:6
clean_rate:0.9928909952606635
noisy true:443
noisy false:313
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 756
epoch [187/200] batch [5/26] time 0.162 (0.175) data 0.086 (0.098) loss_x loss_x 0.3289 (0.4062) acc_x 93.7500 (88.1250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/26] time 0.161 (0.166) data 0.085 (0.089) loss_x loss_x 0.5317 (0.5110) acc_x 90.6250 (86.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/26] time 0.161 (0.164) data 0.085 (0.087) loss_x loss_x 0.4941 (0.4738) acc_x 87.5000 (87.2917) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/26] time 0.164 (0.163) data 0.088 (0.086) loss_x loss_x 0.4854 (0.4782) acc_x 90.6250 (87.9688) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [25/26] time 0.161 (0.162) data 0.084 (0.086) loss_x loss_x 0.4014 (0.4966) acc_x 93.7500 (87.2500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 803
clean true:799
clean false:4
clean_rate:0.9950186799501868
noisy true:434
noisy false:363
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 797
epoch [188/200] batch [5/25] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.3423 (0.4849) acc_x 90.6250 (87.5000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/25] time 0.186 (0.178) data 0.110 (0.101) loss_x loss_x 0.4265 (0.4454) acc_x 87.5000 (87.5000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/25] time 0.189 (0.182) data 0.112 (0.105) loss_x loss_x 0.5010 (0.4532) acc_x 87.5000 (88.3333) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/25] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.2233 (0.4665) acc_x 93.7500 (86.8750) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [25/25] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.3792 (0.4735) acc_x 90.6250 (86.8750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.5075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 812
clean true:806
clean false:6
clean_rate:0.9926108374384236
noisy true:441
noisy false:347
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 788
epoch [189/200] batch [5/25] time 0.189 (0.187) data 0.112 (0.110) loss_x loss_x 0.5928 (0.4431) acc_x 81.2500 (89.3750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/25] time 0.162 (0.180) data 0.084 (0.103) loss_x loss_x 0.1412 (0.4381) acc_x 100.0000 (90.0000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/25] time 0.185 (0.178) data 0.109 (0.101) loss_x loss_x 0.4822 (0.4862) acc_x 87.5000 (88.5417) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/25] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.6772 (0.5135) acc_x 78.1250 (87.9688) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [25/25] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.7324 (0.5486) acc_x 84.3750 (87.0000) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 814
clean true:808
clean false:6
clean_rate:0.9926289926289926
noisy true:424
noisy false:362
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 786
epoch [190/200] batch [5/25] time 0.166 (0.167) data 0.089 (0.089) loss_x loss_x 0.4421 (0.5653) acc_x 93.7500 (87.5000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/25] time 0.202 (0.169) data 0.124 (0.092) loss_x loss_x 0.6812 (0.5695) acc_x 90.6250 (85.9375) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/25] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.6714 (0.6109) acc_x 84.3750 (84.5833) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/25] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.6533 (0.6009) acc_x 78.1250 (84.3750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [25/25] time 0.178 (0.177) data 0.102 (0.100) loss_x loss_x 0.4565 (0.5624) acc_x 84.3750 (85.2500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 349
confident_label rate tensor(0.5144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 823
clean true:818
clean false:5
clean_rate:0.9939246658566221
noisy true:433
noisy false:344
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 777
epoch [191/200] batch [5/25] time 0.194 (0.182) data 0.117 (0.104) loss_x loss_x 0.9487 (0.5878) acc_x 75.0000 (83.1250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/25] time 0.195 (0.196) data 0.115 (0.108) loss_x loss_x 0.7734 (0.6245) acc_x 71.8750 (82.8125) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/25] time 0.178 (0.189) data 0.102 (0.104) loss_x loss_x 0.6396 (0.6497) acc_x 78.1250 (82.7083) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/25] time 0.158 (0.182) data 0.082 (0.099) loss_x loss_x 0.2477 (0.6026) acc_x 93.7500 (83.9062) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [25/25] time 0.159 (0.179) data 0.082 (0.097) loss_x loss_x 0.8003 (0.6343) acc_x 87.5000 (83.3750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 336
confident_label rate tensor(0.5169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 827
clean true:822
clean false:5
clean_rate:0.9939540507859734
noisy true:442
noisy false:331
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 773
epoch [192/200] batch [5/25] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.3264 (0.5339) acc_x 93.7500 (84.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/25] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.3418 (0.5303) acc_x 84.3750 (85.6250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/25] time 0.295 (0.199) data 0.117 (0.108) loss_x loss_x 0.7373 (0.5315) acc_x 75.0000 (85.4167) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/25] time 0.186 (0.195) data 0.110 (0.107) loss_x loss_x 0.6182 (0.5201) acc_x 81.2500 (85.3125) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [25/25] time 0.174 (0.192) data 0.097 (0.107) loss_x loss_x 0.4993 (0.5421) acc_x 87.5000 (84.6250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5238, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 838
clean true:833
clean false:5
clean_rate:0.9940334128878282
noisy true:427
noisy false:335
after delete: len(clean_dataset) 838
after delete: len(noisy_dataset) 762
epoch [193/200] batch [5/26] time 0.180 (0.211) data 0.103 (0.134) loss_x loss_x 0.1597 (0.4221) acc_x 100.0000 (89.3750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/26] time 0.211 (0.199) data 0.134 (0.121) loss_x loss_x 1.1064 (0.5059) acc_x 65.6250 (85.9375) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/26] time 0.164 (0.190) data 0.087 (0.113) loss_x loss_x 0.6001 (0.5154) acc_x 87.5000 (85.6250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/26] time 0.183 (0.194) data 0.106 (0.109) loss_x loss_x 0.5732 (0.5245) acc_x 81.2500 (85.7812) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/26] time 0.164 (0.188) data 0.087 (0.105) loss_x loss_x 0.4275 (0.5538) acc_x 90.6250 (85.1250) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.5081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 813
clean true:806
clean false:7
clean_rate:0.991389913899139
noisy true:440
noisy false:347
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 787
epoch [194/200] batch [5/25] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.6133 (0.6201) acc_x 81.2500 (83.1250) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/25] time 0.186 (0.178) data 0.110 (0.089) loss_x loss_x 0.4165 (0.5667) acc_x 87.5000 (84.3750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/25] time 0.184 (0.178) data 0.106 (0.093) loss_x loss_x 0.4478 (0.5590) acc_x 90.6250 (85.2083) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/25] time 0.170 (0.178) data 0.093 (0.095) loss_x loss_x 0.1959 (0.5647) acc_x 100.0000 (85.6250) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [25/25] time 0.173 (0.178) data 0.096 (0.096) loss_x loss_x 0.4697 (0.5431) acc_x 81.2500 (85.6250) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 340
confident_label rate tensor(0.5150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 824
clean true:817
clean false:7
clean_rate:0.991504854368932
noisy true:443
noisy false:333
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 776
epoch [195/200] batch [5/25] time 0.174 (0.200) data 0.096 (0.122) loss_x loss_x 0.3713 (0.4651) acc_x 87.5000 (84.3750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/25] time 0.195 (0.190) data 0.119 (0.113) loss_x loss_x 0.4146 (0.5120) acc_x 84.3750 (84.3750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/25] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.4619 (0.4802) acc_x 84.3750 (86.4583) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/25] time 0.172 (0.191) data 0.088 (0.106) loss_x loss_x 0.8818 (0.5586) acc_x 78.1250 (84.8438) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [25/25] time 0.160 (0.185) data 0.083 (0.102) loss_x loss_x 0.3767 (0.5617) acc_x 93.7500 (85.0000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 324
confident_label rate tensor(0.5281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 845
clean true:840
clean false:5
clean_rate:0.9940828402366864
noisy true:436
noisy false:319
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 755
epoch [196/200] batch [5/26] time 0.177 (0.185) data 0.100 (0.108) loss_x loss_x 0.8516 (0.4917) acc_x 75.0000 (85.0000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/26] time 0.194 (0.188) data 0.116 (0.111) loss_x loss_x 0.8994 (0.5290) acc_x 90.6250 (85.9375) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/26] time 0.169 (0.183) data 0.093 (0.107) loss_x loss_x 0.5503 (0.5532) acc_x 84.3750 (85.8333) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/26] time 0.205 (0.190) data 0.129 (0.107) loss_x loss_x 0.6221 (0.5568) acc_x 84.3750 (86.0938) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/26] time 0.181 (0.189) data 0.104 (0.107) loss_x loss_x 0.4812 (0.5727) acc_x 87.5000 (85.6250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 344
confident_label rate tensor(0.5206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 833
clean true:828
clean false:5
clean_rate:0.9939975990396158
noisy true:428
noisy false:339
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 767
epoch [197/200] batch [5/26] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.3992 (0.4795) acc_x 87.5000 (87.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/26] time 0.191 (0.188) data 0.114 (0.111) loss_x loss_x 0.3428 (0.4799) acc_x 93.7500 (87.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/26] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4573 (0.5379) acc_x 90.6250 (86.0417) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/26] time 0.181 (0.189) data 0.104 (0.106) loss_x loss_x 0.3501 (0.5925) acc_x 90.6250 (85.1562) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/26] time 0.195 (0.191) data 0.118 (0.109) loss_x loss_x 0.2837 (0.5627) acc_x 96.8750 (85.8750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 345
confident_label rate tensor(0.5106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 817
clean true:812
clean false:5
clean_rate:0.9938800489596084
noisy true:443
noisy false:340
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 783
epoch [198/200] batch [5/25] time 0.188 (0.180) data 0.112 (0.103) loss_x loss_x 0.1407 (0.4683) acc_x 96.8750 (90.6250) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/25] time 0.159 (0.175) data 0.081 (0.098) loss_x loss_x 0.3186 (0.4953) acc_x 87.5000 (87.8125) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/25] time 0.179 (0.174) data 0.103 (0.097) loss_x loss_x 0.3799 (0.5010) acc_x 87.5000 (86.8750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/25] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.6963 (0.5365) acc_x 84.3750 (85.9375) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [25/25] time 0.163 (0.175) data 0.086 (0.098) loss_x loss_x 0.5386 (0.5379) acc_x 87.5000 (86.3750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 352
confident_label rate tensor(0.5138, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 822
clean true:817
clean false:5
clean_rate:0.9939172749391727
noisy true:431
noisy false:347
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 778
epoch [199/200] batch [5/25] time 0.256 (0.208) data 0.159 (0.112) loss_x loss_x 0.1804 (0.4494) acc_x 96.8750 (90.6250) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/25] time 0.154 (0.201) data 0.078 (0.115) loss_x loss_x 1.0264 (0.5850) acc_x 81.2500 (86.8750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/25] time 0.163 (0.187) data 0.087 (0.104) loss_x loss_x 0.7808 (0.5716) acc_x 78.1250 (86.4583) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/25] time 0.157 (0.180) data 0.080 (0.099) loss_x loss_x 0.6616 (0.5678) acc_x 84.3750 (85.9375) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [25/25] time 0.158 (0.176) data 0.081 (0.096) loss_x loss_x 0.5283 (0.5536) acc_x 84.3750 (86.3750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 329
confident_label rate tensor(0.5156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 825
clean true:822
clean false:3
clean_rate:0.9963636363636363
noisy true:449
noisy false:326
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 775
epoch [200/200] batch [5/25] time 0.180 (0.172) data 0.104 (0.095) loss_x loss_x 0.6343 (0.5188) acc_x 87.5000 (86.8750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/25] time 0.184 (0.191) data 0.106 (0.103) loss_x loss_x 0.8262 (0.5799) acc_x 81.2500 (85.6250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/25] time 0.187 (0.185) data 0.110 (0.101) loss_x loss_x 0.4795 (0.5673) acc_x 90.6250 (85.6250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/25] time 0.170 (0.185) data 0.092 (0.102) loss_x loss_x 0.2854 (0.5223) acc_x 87.5000 (86.5625) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [25/25] time 0.210 (0.185) data 0.133 (0.103) loss_x loss_x 0.4302 (0.5461) acc_x 93.7500 (86.0000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,226
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 86.3%
Elapsed: 0:44:41
