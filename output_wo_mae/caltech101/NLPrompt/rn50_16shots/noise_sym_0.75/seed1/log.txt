***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 846
confident_label rate tensor(0.1156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 185
clean true:178
clean false:7
clean_rate:0.9621621621621622
noisy true:576
noisy false:839
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 1415
epoch [1/200] batch [5/5] time 0.192 (0.217) data 0.116 (0.123) loss_x loss_x 2.9883 (2.8113) acc_x 53.1250 (56.8750) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 786
confident_label rate tensor(0.1319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 211
clean true:205
clean false:6
clean_rate:0.9715639810426541
noisy true:609
noisy false:780
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 1389
epoch [2/200] batch [5/6] time 0.164 (0.171) data 0.087 (0.095) loss_x loss_x 1.0420 (1.4969) acc_x 78.1250 (67.5000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 571
confident_label rate tensor(0.1556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 249
clean true:247
clean false:2
clean_rate:0.9919678714859438
noisy true:782
noisy false:569
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 1351
epoch [3/200] batch [5/7] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 1.0010 (0.8273) acc_x 78.1250 (81.8750) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 562
confident_label rate tensor(0.1662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 266
clean true:262
clean false:4
clean_rate:0.9849624060150376
noisy true:776
noisy false:558
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 1334
epoch [4/200] batch [5/8] time 0.167 (0.170) data 0.090 (0.093) loss_x loss_x 0.9668 (0.8425) acc_x 71.8750 (76.2500) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 533
confident_label rate tensor(0.1700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 272
clean true:270
clean false:2
clean_rate:0.9926470588235294
noisy true:797
noisy false:531
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 1328
epoch [5/200] batch [5/8] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.7114 (0.8886) acc_x 81.2500 (78.1250) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.1719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 275
clean true:272
clean false:3
clean_rate:0.9890909090909091
noisy true:805
noisy false:520
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 1325
epoch [6/200] batch [5/8] time 0.193 (0.188) data 0.116 (0.112) loss_x loss_x 1.0615 (0.7635) acc_x 65.6250 (78.1250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.1750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 280
clean true:277
clean false:3
clean_rate:0.9892857142857143
noisy true:821
noisy false:499
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 1320
epoch [7/200] batch [5/8] time 0.182 (0.185) data 0.105 (0.109) loss_x loss_x 0.5039 (0.7720) acc_x 90.6250 (78.7500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 508
confident_label rate tensor(0.1787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 286
clean true:279
clean false:7
clean_rate:0.9755244755244755
noisy true:813
noisy false:501
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 1314
epoch [8/200] batch [5/8] time 0.172 (0.178) data 0.096 (0.102) loss_x loss_x 0.7061 (0.7672) acc_x 81.2500 (80.6250) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 513
confident_label rate tensor(0.1794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 287
clean true:280
clean false:7
clean_rate:0.975609756097561
noisy true:807
noisy false:506
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 1313
epoch [9/200] batch [5/8] time 0.191 (0.177) data 0.114 (0.101) loss_x loss_x 1.1572 (1.0930) acc_x 71.8750 (73.1250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.1688, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 270
clean true:267
clean false:3
clean_rate:0.9888888888888889
noisy true:831
noisy false:499
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 1330
epoch [10/200] batch [5/8] time 0.183 (0.200) data 0.106 (0.124) loss_x loss_x 1.0137 (0.7717) acc_x 75.0000 (82.5000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.1806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 289
clean true:281
clean false:8
clean_rate:0.972318339100346
noisy true:846
noisy false:465
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 1311
epoch [11/200] batch [5/9] time 0.177 (0.197) data 0.100 (0.120) loss_x loss_x 0.7144 (1.1271) acc_x 78.1250 (68.7500) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.1812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 290
clean true:284
clean false:6
clean_rate:0.9793103448275862
noisy true:814
noisy false:496
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1310
epoch [12/200] batch [5/9] time 0.181 (0.184) data 0.104 (0.108) loss_x loss_x 1.0713 (0.9236) acc_x 75.0000 (76.8750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.1775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 284
clean true:278
clean false:6
clean_rate:0.9788732394366197
noisy true:826
noisy false:490
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 1316
epoch [13/200] batch [5/8] time 0.178 (0.181) data 0.102 (0.105) loss_x loss_x 0.9136 (0.7598) acc_x 68.7500 (80.0000) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.1800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 288
clean true:284
clean false:4
clean_rate:0.9861111111111112
noisy true:839
noisy false:473
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 1312
epoch [14/200] batch [5/9] time 0.164 (0.166) data 0.087 (0.089) loss_x loss_x 0.5908 (0.6444) acc_x 81.2500 (84.3750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.1787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 286
clean true:282
clean false:4
clean_rate:0.986013986013986
noisy true:825
noisy false:489
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 1314
epoch [15/200] batch [5/8] time 0.160 (0.166) data 0.083 (0.090) loss_x loss_x 0.6489 (0.8472) acc_x 84.3750 (78.7500) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 500
confident_label rate tensor(0.1819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 291
clean true:283
clean false:8
clean_rate:0.9725085910652921
noisy true:817
noisy false:492
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 1309
epoch [16/200] batch [5/9] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 1.0742 (0.8545) acc_x 71.8750 (75.6250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 499
confident_label rate tensor(0.1800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 288
clean true:282
clean false:6
clean_rate:0.9791666666666666
noisy true:819
noisy false:493
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 1312
epoch [17/200] batch [5/9] time 0.184 (0.194) data 0.108 (0.118) loss_x loss_x 0.1731 (0.6515) acc_x 96.8750 (86.2500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.1769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 283
clean true:279
clean false:4
clean_rate:0.9858657243816255
noisy true:828
noisy false:489
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1317
epoch [18/200] batch [5/8] time 0.193 (0.189) data 0.117 (0.113) loss_x loss_x 1.2930 (0.8271) acc_x 71.8750 (76.2500) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 498
confident_label rate tensor(0.1762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 282
clean true:278
clean false:4
clean_rate:0.9858156028368794
noisy true:824
noisy false:494
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1318
epoch [19/200] batch [5/8] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.6499 (0.8040) acc_x 75.0000 (78.1250) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.1819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 291
clean true:288
clean false:3
clean_rate:0.9896907216494846
noisy true:856
noisy false:453
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 1309
epoch [20/200] batch [5/9] time 0.193 (0.188) data 0.117 (0.112) loss_x loss_x 0.4016 (0.6407) acc_x 93.7500 (85.6250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 503
confident_label rate tensor(0.1831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 293
clean true:288
clean false:5
clean_rate:0.9829351535836177
noisy true:809
noisy false:498
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1307
epoch [21/200] batch [5/9] time 0.160 (0.159) data 0.083 (0.083) loss_x loss_x 0.5811 (0.6911) acc_x 90.6250 (81.8750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 509
confident_label rate tensor(0.1781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 285
clean true:276
clean false:9
clean_rate:0.968421052631579
noisy true:815
noisy false:500
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1315
epoch [22/200] batch [5/8] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 1.1406 (0.8347) acc_x 68.7500 (76.2500) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.1856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 297
clean true:293
clean false:4
clean_rate:0.9865319865319865
noisy true:812
noisy false:491
after delete: len(clean_dataset) 297
after delete: len(noisy_dataset) 1303
epoch [23/200] batch [5/9] time 0.171 (0.177) data 0.095 (0.100) loss_x loss_x 1.0615 (0.8135) acc_x 71.8750 (76.8750) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.1831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 293
clean true:289
clean false:4
clean_rate:0.9863481228668942
noisy true:838
noisy false:469
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1307
epoch [24/200] batch [5/9] time 0.181 (0.171) data 0.104 (0.094) loss_x loss_x 0.7153 (0.7072) acc_x 81.2500 (82.5000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.1931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 309
clean true:303
clean false:6
clean_rate:0.9805825242718447
noisy true:833
noisy false:458
after delete: len(clean_dataset) 309
after delete: len(noisy_dataset) 1291
epoch [25/200] batch [5/9] time 0.176 (0.180) data 0.099 (0.104) loss_x loss_x 1.0547 (0.9333) acc_x 78.1250 (81.2500) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.1875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 300
clean true:295
clean false:5
clean_rate:0.9833333333333333
noisy true:820
noisy false:480
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 1300
epoch [26/200] batch [5/9] time 0.167 (0.176) data 0.090 (0.100) loss_x loss_x 0.6421 (0.7329) acc_x 84.3750 (79.3750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.1887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 302
clean true:298
clean false:4
clean_rate:0.9867549668874173
noisy true:820
noisy false:478
after delete: len(clean_dataset) 302
after delete: len(noisy_dataset) 1298
epoch [27/200] batch [5/9] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5825 (0.9666) acc_x 87.5000 (75.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.1837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 294
clean true:290
clean false:4
clean_rate:0.9863945578231292
noisy true:846
noisy false:460
after delete: len(clean_dataset) 294
after delete: len(noisy_dataset) 1306
epoch [28/200] batch [5/9] time 0.163 (0.173) data 0.087 (0.097) loss_x loss_x 0.8193 (0.7788) acc_x 71.8750 (80.0000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.1937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 310
clean true:308
clean false:2
clean_rate:0.9935483870967742
noisy true:818
noisy false:472
after delete: len(clean_dataset) 310
after delete: len(noisy_dataset) 1290
epoch [29/200] batch [5/9] time 0.165 (0.178) data 0.087 (0.102) loss_x loss_x 1.0996 (0.7463) acc_x 78.1250 (83.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 299
clean true:296
clean false:3
clean_rate:0.9899665551839465
noisy true:825
noisy false:476
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 1301
epoch [30/200] batch [5/9] time 0.186 (0.178) data 0.109 (0.102) loss_x loss_x 0.6533 (0.7210) acc_x 84.3750 (81.2500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.1912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 306
clean true:298
clean false:8
clean_rate:0.9738562091503268
noisy true:825
noisy false:469
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 1294
epoch [31/200] batch [5/9] time 0.160 (0.173) data 0.084 (0.097) loss_x loss_x 0.8203 (0.9585) acc_x 81.2500 (78.7500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 511
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:308
clean false:6
clean_rate:0.9808917197452229
noisy true:781
noisy false:505
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [32/200] batch [5/9] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.7017 (0.8623) acc_x 78.1250 (77.5000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.1912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 306
clean true:302
clean false:4
clean_rate:0.9869281045751634
noisy true:813
noisy false:481
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 1294
epoch [33/200] batch [5/9] time 0.191 (0.180) data 0.114 (0.103) loss_x loss_x 1.0049 (0.5868) acc_x 78.1250 (83.1250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.1881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 301
clean true:297
clean false:4
clean_rate:0.9867109634551495
noisy true:850
noisy false:449
after delete: len(clean_dataset) 301
after delete: len(noisy_dataset) 1299
epoch [34/200] batch [5/9] time 0.176 (0.179) data 0.100 (0.102) loss_x loss_x 0.7441 (0.7997) acc_x 81.2500 (80.6250) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.1931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 309
clean true:303
clean false:6
clean_rate:0.9805825242718447
noisy true:842
noisy false:449
after delete: len(clean_dataset) 309
after delete: len(noisy_dataset) 1291
epoch [35/200] batch [5/9] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 1.0674 (0.8680) acc_x 71.8750 (80.0000) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.1919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 307
clean true:305
clean false:2
clean_rate:0.993485342019544
noisy true:826
noisy false:467
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 1293
epoch [36/200] batch [5/9] time 0.162 (0.173) data 0.086 (0.097) loss_x loss_x 0.8232 (0.7421) acc_x 81.2500 (82.5000) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.1956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 313
clean true:305
clean false:8
clean_rate:0.9744408945686901
noisy true:816
noisy false:471
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1287
epoch [37/200] batch [5/9] time 0.172 (0.166) data 0.096 (0.089) loss_x loss_x 0.5610 (0.8123) acc_x 84.3750 (81.2500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.1906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 305
clean true:300
clean false:5
clean_rate:0.9836065573770492
noisy true:803
noisy false:492
after delete: len(clean_dataset) 305
after delete: len(noisy_dataset) 1295
epoch [38/200] batch [5/9] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.7666 (0.7698) acc_x 81.2500 (81.8750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.1812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 290
clean true:286
clean false:4
clean_rate:0.9862068965517241
noisy true:821
noisy false:489
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1310
epoch [39/200] batch [5/9] time 0.197 (0.196) data 0.121 (0.119) loss_x loss_x 0.7466 (0.7606) acc_x 81.2500 (78.1250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.1863, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 298
clean true:289
clean false:9
clean_rate:0.9697986577181208
noisy true:822
noisy false:480
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 1302
epoch [40/200] batch [5/9] time 0.212 (0.196) data 0.136 (0.120) loss_x loss_x 0.5459 (0.6515) acc_x 84.3750 (83.7500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 318
clean true:316
clean false:2
clean_rate:0.9937106918238994
noisy true:848
noisy false:434
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1282
epoch [41/200] batch [5/9] time 0.164 (0.182) data 0.087 (0.105) loss_x loss_x 1.3799 (0.7618) acc_x 62.5000 (81.8750) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 299
clean true:292
clean false:7
clean_rate:0.9765886287625418
noisy true:814
noisy false:487
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 1301
epoch [42/200] batch [5/9] time 0.169 (0.179) data 0.093 (0.103) loss_x loss_x 0.6196 (0.7932) acc_x 81.2500 (78.7500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 318
clean true:314
clean false:4
clean_rate:0.9874213836477987
noisy true:812
noisy false:470
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1282
epoch [43/200] batch [5/9] time 0.179 (0.179) data 0.103 (0.103) loss_x loss_x 0.8232 (0.8220) acc_x 78.1250 (77.5000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.2013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 322
clean true:319
clean false:3
clean_rate:0.9906832298136646
noisy true:845
noisy false:433
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1278
epoch [44/200] batch [5/10] time 0.170 (0.185) data 0.094 (0.109) loss_x loss_x 0.9053 (0.7259) acc_x 75.0000 (81.8750) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [10/10] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.5737 (0.7911) acc_x 90.6250 (80.0000) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.1975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 316
clean true:311
clean false:5
clean_rate:0.9841772151898734
noisy true:824
noisy false:460
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1284
epoch [45/200] batch [5/9] time 0.176 (0.172) data 0.099 (0.096) loss_x loss_x 0.5791 (0.7217) acc_x 84.3750 (81.2500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.1975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 316
clean true:309
clean false:7
clean_rate:0.9778481012658228
noisy true:834
noisy false:450
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1284
epoch [46/200] batch [5/9] time 0.189 (0.191) data 0.112 (0.114) loss_x loss_x 0.4646 (0.5191) acc_x 90.6250 (89.3750) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:307
clean false:7
clean_rate:0.9777070063694268
noisy true:817
noisy false:469
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [47/200] batch [5/9] time 0.176 (0.190) data 0.099 (0.114) loss_x loss_x 1.1699 (0.8415) acc_x 68.7500 (80.6250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.1931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 309
clean true:304
clean false:5
clean_rate:0.9838187702265372
noisy true:816
noisy false:475
after delete: len(clean_dataset) 309
after delete: len(noisy_dataset) 1291
epoch [48/200] batch [5/9] time 0.191 (0.180) data 0.115 (0.103) loss_x loss_x 0.7021 (0.7167) acc_x 84.3750 (80.0000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:310
clean false:4
clean_rate:0.9872611464968153
noisy true:854
noisy false:432
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [49/200] batch [5/9] time 0.180 (0.189) data 0.104 (0.113) loss_x loss_x 0.7158 (0.7149) acc_x 81.2500 (81.8750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.1937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 310
clean true:303
clean false:7
clean_rate:0.9774193548387097
noisy true:821
noisy false:469
after delete: len(clean_dataset) 310
after delete: len(noisy_dataset) 1290
epoch [50/200] batch [5/9] time 0.187 (0.181) data 0.110 (0.105) loss_x loss_x 0.3254 (0.5792) acc_x 96.8750 (85.6250) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.1925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 308
clean true:302
clean false:6
clean_rate:0.9805194805194806
noisy true:825
noisy false:467
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 1292
epoch [51/200] batch [5/9] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 0.3904 (0.7228) acc_x 90.6250 (80.0000) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:305
clean false:9
clean_rate:0.9713375796178344
noisy true:838
noisy false:448
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [52/200] batch [5/9] time 0.172 (0.170) data 0.095 (0.093) loss_x loss_x 0.5171 (0.6190) acc_x 90.6250 (84.3750) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 326
clean true:314
clean false:12
clean_rate:0.9631901840490797
noisy true:829
noisy false:445
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1274
epoch [53/200] batch [5/10] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.5288 (0.5337) acc_x 90.6250 (87.5000) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [10/10] time 0.187 (0.180) data 0.110 (0.104) loss_x loss_x 0.5225 (0.6152) acc_x 87.5000 (85.3125) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 299
clean true:288
clean false:11
clean_rate:0.9632107023411371
noisy true:835
noisy false:466
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 1301
epoch [54/200] batch [5/9] time 0.197 (0.191) data 0.121 (0.115) loss_x loss_x 0.4998 (0.5758) acc_x 87.5000 (86.8750) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 318
clean true:312
clean false:6
clean_rate:0.9811320754716981
noisy true:819
noisy false:463
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1282
epoch [55/200] batch [5/9] time 0.166 (0.180) data 0.089 (0.103) loss_x loss_x 0.5020 (0.8277) acc_x 87.5000 (79.3750) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.1900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 304
clean true:295
clean false:9
clean_rate:0.9703947368421053
noisy true:823
noisy false:473
after delete: len(clean_dataset) 304
after delete: len(noisy_dataset) 1296
epoch [56/200] batch [5/9] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.8340 (0.7885) acc_x 84.3750 (80.6250) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 322
clean true:314
clean false:8
clean_rate:0.9751552795031055
noisy true:818
noisy false:460
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1278
epoch [57/200] batch [5/10] time 0.174 (0.169) data 0.097 (0.093) loss_x loss_x 0.7241 (0.5660) acc_x 81.2500 (83.7500) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [10/10] time 0.160 (0.178) data 0.084 (0.101) loss_x loss_x 1.4697 (0.6520) acc_x 62.5000 (83.1250) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 321
clean true:315
clean false:6
clean_rate:0.9813084112149533
noisy true:829
noisy false:450
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1279
epoch [58/200] batch [5/10] time 0.158 (0.170) data 0.081 (0.094) loss_x loss_x 0.7109 (0.7859) acc_x 84.3750 (80.0000) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [10/10] time 0.160 (0.167) data 0.084 (0.091) loss_x loss_x 1.1123 (0.6911) acc_x 68.7500 (82.5000) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.1994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 319
clean true:311
clean false:8
clean_rate:0.9749216300940439
noisy true:842
noisy false:439
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 1281
epoch [59/200] batch [5/9] time 0.189 (0.199) data 0.113 (0.123) loss_x loss_x 0.7251 (0.7123) acc_x 81.2500 (81.2500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:330
clean false:10
clean_rate:0.9705882352941176
noisy true:821
noisy false:439
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [60/200] batch [5/10] time 0.168 (0.173) data 0.090 (0.097) loss_x loss_x 0.6870 (0.6474) acc_x 75.0000 (82.5000) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [10/10] time 0.176 (0.174) data 0.100 (0.097) loss_x loss_x 0.6826 (0.6585) acc_x 75.0000 (81.8750) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.1994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 319
clean true:313
clean false:6
clean_rate:0.9811912225705329
noisy true:837
noisy false:444
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 1281
epoch [61/200] batch [5/9] time 0.166 (0.178) data 0.090 (0.102) loss_x loss_x 0.6802 (0.5856) acc_x 87.5000 (85.6250) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 318
clean true:307
clean false:11
clean_rate:0.9654088050314465
noisy true:828
noisy false:454
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1282
epoch [62/200] batch [5/9] time 0.171 (0.171) data 0.095 (0.094) loss_x loss_x 0.6099 (0.6276) acc_x 81.2500 (84.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.2062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 330
clean true:319
clean false:11
clean_rate:0.9666666666666667
noisy true:844
noisy false:426
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1270
epoch [63/200] batch [5/10] time 0.208 (0.180) data 0.132 (0.104) loss_x loss_x 0.4402 (0.7027) acc_x 90.6250 (83.7500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [10/10] time 0.156 (0.173) data 0.080 (0.097) loss_x loss_x 0.4978 (0.6371) acc_x 90.6250 (84.3750) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 324
clean true:316
clean false:8
clean_rate:0.9753086419753086
noisy true:842
noisy false:434
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1276
epoch [64/200] batch [5/10] time 0.174 (0.180) data 0.098 (0.103) loss_x loss_x 0.7295 (0.6182) acc_x 75.0000 (83.7500) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [10/10] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.3975 (0.5590) acc_x 87.5000 (85.3125) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 317
clean true:305
clean false:12
clean_rate:0.9621451104100947
noisy true:819
noisy false:464
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1283
epoch [65/200] batch [5/9] time 0.192 (0.180) data 0.116 (0.104) loss_x loss_x 1.2988 (0.7737) acc_x 65.6250 (76.2500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 318
clean true:309
clean false:9
clean_rate:0.9716981132075472
noisy true:795
noisy false:487
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1282
epoch [66/200] batch [5/9] time 0.169 (0.168) data 0.093 (0.092) loss_x loss_x 0.7524 (0.6064) acc_x 87.5000 (85.0000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.2069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 331
clean true:321
clean false:10
clean_rate:0.9697885196374623
noisy true:803
noisy false:466
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1269
epoch [67/200] batch [5/10] time 0.177 (0.191) data 0.099 (0.115) loss_x loss_x 0.4216 (0.5467) acc_x 87.5000 (85.6250) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [10/10] time 0.164 (0.184) data 0.088 (0.107) loss_x loss_x 0.5928 (0.5448) acc_x 84.3750 (84.6875) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 329
clean true:321
clean false:8
clean_rate:0.9756838905775076
noisy true:824
noisy false:447
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1271
epoch [68/200] batch [5/10] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.5806 (0.6095) acc_x 81.2500 (84.3750) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [10/10] time 0.162 (0.179) data 0.086 (0.102) loss_x loss_x 0.4744 (0.6638) acc_x 87.5000 (83.1250) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.2069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 331
clean true:320
clean false:11
clean_rate:0.9667673716012085
noisy true:828
noisy false:441
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1269
epoch [69/200] batch [5/10] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.6030 (0.5910) acc_x 84.3750 (85.0000) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [10/10] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.5850 (0.7090) acc_x 84.3750 (82.5000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 331
clean true:323
clean false:8
clean_rate:0.9758308157099698
noisy true:795
noisy false:474
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1269
epoch [70/200] batch [5/10] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.9121 (0.8375) acc_x 68.7500 (76.8750) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [10/10] time 0.156 (0.182) data 0.080 (0.105) loss_x loss_x 0.5703 (0.7511) acc_x 84.3750 (78.4375) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 333
clean true:327
clean false:6
clean_rate:0.9819819819819819
noisy true:815
noisy false:452
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1267
epoch [71/200] batch [5/10] time 0.174 (0.187) data 0.097 (0.110) loss_x loss_x 0.4604 (0.6914) acc_x 84.3750 (81.2500) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [10/10] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 0.3760 (0.6020) acc_x 90.6250 (84.3750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:308
clean false:6
clean_rate:0.9808917197452229
noisy true:843
noisy false:443
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [72/200] batch [5/9] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.2910 (0.4703) acc_x 96.8750 (89.3750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:326
clean false:9
clean_rate:0.9731343283582089
noisy true:834
noisy false:431
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [73/200] batch [5/10] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.4612 (0.6512) acc_x 90.6250 (83.1250) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [10/10] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.8345 (0.6770) acc_x 78.1250 (81.2500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 328
clean true:321
clean false:7
clean_rate:0.9786585365853658
noisy true:848
noisy false:424
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1272
epoch [74/200] batch [5/10] time 0.176 (0.172) data 0.098 (0.095) loss_x loss_x 0.8071 (0.7454) acc_x 78.1250 (83.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [10/10] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.3738 (0.6462) acc_x 93.7500 (85.0000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 324
clean true:315
clean false:9
clean_rate:0.9722222222222222
noisy true:820
noisy false:456
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1276
epoch [75/200] batch [5/10] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.3904 (0.7188) acc_x 87.5000 (80.0000) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [10/10] time 0.160 (0.176) data 0.084 (0.099) loss_x loss_x 0.4639 (0.6324) acc_x 93.7500 (82.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.2100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 336
clean true:331
clean false:5
clean_rate:0.9851190476190477
noisy true:816
noisy false:448
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1264
epoch [76/200] batch [5/10] time 0.164 (0.185) data 0.087 (0.108) loss_x loss_x 0.9424 (0.6033) acc_x 75.0000 (85.0000) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [10/10] time 0.176 (0.185) data 0.099 (0.108) loss_x loss_x 0.8281 (0.5965) acc_x 78.1250 (85.3125) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 332
clean true:324
clean false:8
clean_rate:0.9759036144578314
noisy true:816
noisy false:452
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1268
epoch [77/200] batch [5/10] time 0.172 (0.188) data 0.096 (0.112) loss_x loss_x 0.5200 (0.7394) acc_x 84.3750 (79.3750) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [10/10] time 0.179 (0.184) data 0.103 (0.107) loss_x loss_x 0.9087 (0.6812) acc_x 87.5000 (82.5000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 324
clean true:316
clean false:8
clean_rate:0.9753086419753086
noisy true:800
noisy false:476
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1276
epoch [78/200] batch [5/10] time 0.176 (0.174) data 0.099 (0.098) loss_x loss_x 0.8989 (0.6328) acc_x 78.1250 (81.8750) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [10/10] time 0.176 (0.171) data 0.099 (0.095) loss_x loss_x 0.5781 (0.6448) acc_x 81.2500 (81.2500) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 328
clean true:322
clean false:6
clean_rate:0.9817073170731707
noisy true:803
noisy false:469
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1272
epoch [79/200] batch [5/10] time 0.179 (0.174) data 0.102 (0.097) loss_x loss_x 0.6855 (0.6795) acc_x 81.2500 (83.7500) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [10/10] time 0.159 (0.179) data 0.083 (0.102) loss_x loss_x 0.5366 (0.8021) acc_x 90.6250 (81.2500) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 328
clean true:322
clean false:6
clean_rate:0.9817073170731707
noisy true:811
noisy false:461
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1272
epoch [80/200] batch [5/10] time 0.187 (0.182) data 0.110 (0.106) loss_x loss_x 0.6777 (0.6503) acc_x 84.3750 (84.3750) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [10/10] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 0.6079 (0.6041) acc_x 81.2500 (85.3125) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 330
clean true:320
clean false:10
clean_rate:0.9696969696969697
noisy true:806
noisy false:464
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1270
epoch [81/200] batch [5/10] time 0.179 (0.204) data 0.103 (0.128) loss_x loss_x 0.3599 (0.4963) acc_x 93.7500 (88.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/10] time 0.182 (0.193) data 0.106 (0.117) loss_x loss_x 0.2876 (0.4220) acc_x 90.6250 (89.0625) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 324
clean true:317
clean false:7
clean_rate:0.9783950617283951
noisy true:798
noisy false:478
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1276
epoch [82/200] batch [5/10] time 0.160 (0.160) data 0.083 (0.084) loss_x loss_x 0.3281 (0.4101) acc_x 90.6250 (88.7500) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [10/10] time 0.159 (0.162) data 0.082 (0.086) loss_x loss_x 0.6001 (0.5636) acc_x 78.1250 (85.9375) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 326
clean true:315
clean false:11
clean_rate:0.9662576687116564
noisy true:815
noisy false:459
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1274
epoch [83/200] batch [5/10] time 0.177 (0.173) data 0.101 (0.096) loss_x loss_x 0.7114 (0.6341) acc_x 87.5000 (86.2500) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [10/10] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.3801 (0.6490) acc_x 81.2500 (83.7500) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:325
clean false:10
clean_rate:0.9701492537313433
noisy true:813
noisy false:452
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [84/200] batch [5/10] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.4827 (0.6534) acc_x 87.5000 (84.3750) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [10/10] time 0.178 (0.170) data 0.102 (0.094) loss_x loss_x 0.3584 (0.5996) acc_x 93.7500 (84.3750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:336
clean false:8
clean_rate:0.9767441860465116
noisy true:824
noisy false:432
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [85/200] batch [5/10] time 0.241 (0.232) data 0.165 (0.155) loss_x loss_x 0.0378 (0.4345) acc_x 100.0000 (88.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/10] time 0.167 (0.213) data 0.089 (0.136) loss_x loss_x 0.7207 (0.4888) acc_x 78.1250 (85.3125) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 339
clean true:328
clean false:11
clean_rate:0.967551622418879
noisy true:813
noisy false:448
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1261
epoch [86/200] batch [5/10] time 0.179 (0.181) data 0.102 (0.105) loss_x loss_x 0.7383 (0.5083) acc_x 81.2500 (86.2500) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [10/10] time 0.178 (0.178) data 0.102 (0.101) loss_x loss_x 0.4504 (0.5903) acc_x 87.5000 (85.3125) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:325
clean false:9
clean_rate:0.9730538922155688
noisy true:808
noisy false:458
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [87/200] batch [5/10] time 0.203 (0.175) data 0.127 (0.098) loss_x loss_x 1.1201 (0.6823) acc_x 71.8750 (84.3750) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [10/10] time 0.207 (0.178) data 0.130 (0.102) loss_x loss_x 0.7017 (0.6718) acc_x 84.3750 (83.4375) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:331
clean false:12
clean_rate:0.9650145772594753
noisy true:809
noisy false:448
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [88/200] batch [5/10] time 0.171 (0.173) data 0.095 (0.096) loss_x loss_x 0.4287 (0.5319) acc_x 90.6250 (85.6250) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [10/10] time 0.191 (0.170) data 0.114 (0.093) loss_x loss_x 1.3525 (0.6240) acc_x 62.5000 (84.0625) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:339
clean false:12
clean_rate:0.9658119658119658
noisy true:791
noisy false:458
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [89/200] batch [5/10] time 0.182 (0.185) data 0.104 (0.108) loss_x loss_x 0.2440 (0.6559) acc_x 93.7500 (85.0000) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [10/10] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.6514 (0.5845) acc_x 81.2500 (85.3125) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 341
clean true:330
clean false:11
clean_rate:0.967741935483871
noisy true:805
noisy false:454
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1259
epoch [90/200] batch [5/10] time 0.180 (0.169) data 0.102 (0.092) loss_x loss_x 0.4729 (0.6329) acc_x 87.5000 (82.5000) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [10/10] time 0.192 (0.173) data 0.115 (0.096) loss_x loss_x 0.5645 (0.6160) acc_x 84.3750 (84.0625) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 333
clean true:325
clean false:8
clean_rate:0.975975975975976
noisy true:811
noisy false:456
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1267
epoch [91/200] batch [5/10] time 0.185 (0.187) data 0.108 (0.111) loss_x loss_x 0.7920 (0.6976) acc_x 78.1250 (83.1250) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [10/10] time 0.161 (0.180) data 0.084 (0.104) loss_x loss_x 0.7378 (0.6235) acc_x 81.2500 (85.0000) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:336
clean false:6
clean_rate:0.9824561403508771
noisy true:807
noisy false:451
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [92/200] batch [5/10] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 1.0225 (0.6521) acc_x 71.8750 (84.3750) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [10/10] time 0.161 (0.182) data 0.084 (0.106) loss_x loss_x 0.2155 (0.5446) acc_x 90.6250 (85.6250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 328
clean true:318
clean false:10
clean_rate:0.9695121951219512
noisy true:807
noisy false:465
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1272
epoch [93/200] batch [5/10] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.6294 (0.5315) acc_x 81.2500 (86.8750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [10/10] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.4089 (0.6156) acc_x 93.7500 (85.9375) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 329
clean true:320
clean false:9
clean_rate:0.9726443768996961
noisy true:807
noisy false:464
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1271
epoch [94/200] batch [5/10] time 0.166 (0.174) data 0.089 (0.098) loss_x loss_x 0.4697 (0.5347) acc_x 90.6250 (87.5000) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [10/10] time 0.183 (0.177) data 0.107 (0.101) loss_x loss_x 0.6880 (0.5182) acc_x 90.6250 (88.7500) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:328
clean false:12
clean_rate:0.9647058823529412
noisy true:799
noisy false:461
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [95/200] batch [5/10] time 0.169 (0.172) data 0.092 (0.096) loss_x loss_x 0.2291 (0.7156) acc_x 96.8750 (84.3750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [10/10] time 0.169 (0.167) data 0.093 (0.091) loss_x loss_x 0.7515 (0.7323) acc_x 81.2500 (83.4375) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:333
clean false:7
clean_rate:0.9794117647058823
noisy true:823
noisy false:437
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [96/200] batch [5/10] time 0.184 (0.193) data 0.108 (0.116) loss_x loss_x 0.2468 (0.4882) acc_x 93.7500 (89.3750) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [10/10] time 0.187 (0.194) data 0.111 (0.118) loss_x loss_x 0.3345 (0.5815) acc_x 93.7500 (86.5625) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:333
clean false:7
clean_rate:0.9794117647058823
noisy true:803
noisy false:457
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [97/200] batch [5/10] time 0.174 (0.165) data 0.096 (0.088) loss_x loss_x 0.2018 (0.5457) acc_x 100.0000 (88.7500) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [10/10] time 0.175 (0.167) data 0.098 (0.090) loss_x loss_x 0.4631 (0.5535) acc_x 90.6250 (87.1875) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 349
clean true:338
clean false:11
clean_rate:0.9684813753581661
noisy true:802
noisy false:449
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1251
epoch [98/200] batch [5/10] time 0.176 (0.178) data 0.098 (0.100) loss_x loss_x 0.4861 (0.6152) acc_x 90.6250 (86.2500) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [10/10] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.5791 (0.6104) acc_x 78.1250 (86.2500) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.2031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 325
clean true:315
clean false:10
clean_rate:0.9692307692307692
noisy true:783
noisy false:492
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 1275
epoch [99/200] batch [5/10] time 0.185 (0.177) data 0.109 (0.100) loss_x loss_x 0.7241 (0.6474) acc_x 78.1250 (83.1250) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [10/10] time 0.186 (0.181) data 0.110 (0.104) loss_x loss_x 0.6572 (0.6366) acc_x 84.3750 (83.7500) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:332
clean false:10
clean_rate:0.9707602339181286
noisy true:823
noisy false:435
all clean rate:  [0.9621621621621622, 0.9715639810426541, 0.9919678714859438, 0.9849624060150376, 0.9926470588235294, 0.9890909090909091, 0.9892857142857143, 0.9755244755244755, 0.975609756097561, 0.9888888888888889, 0.972318339100346, 0.9793103448275862, 0.9788732394366197, 0.9861111111111112, 0.986013986013986, 0.9725085910652921, 0.9791666666666666, 0.9858657243816255, 0.9858156028368794, 0.9896907216494846, 0.9829351535836177, 0.968421052631579, 0.9865319865319865, 0.9863481228668942, 0.9805825242718447, 0.9833333333333333, 0.9867549668874173, 0.9863945578231292, 0.9935483870967742, 0.9899665551839465, 0.9738562091503268, 0.9808917197452229, 0.9869281045751634, 0.9867109634551495, 0.9805825242718447, 0.993485342019544, 0.9744408945686901, 0.9836065573770492, 0.9862068965517241, 0.9697986577181208, 0.9937106918238994, 0.9765886287625418, 0.9874213836477987, 0.9906832298136646, 0.9841772151898734, 0.9778481012658228, 0.9777070063694268, 0.9838187702265372, 0.9872611464968153, 0.9774193548387097, 0.9805194805194806, 0.9713375796178344, 0.9631901840490797, 0.9632107023411371, 0.9811320754716981, 0.9703947368421053, 0.9751552795031055, 0.9813084112149533, 0.9749216300940439, 0.9705882352941176, 0.9811912225705329, 0.9654088050314465, 0.9666666666666667, 0.9753086419753086, 0.9621451104100947, 0.9716981132075472, 0.9697885196374623, 0.9756838905775076, 0.9667673716012085, 0.9758308157099698, 0.9819819819819819, 0.9808917197452229, 0.9731343283582089, 0.9786585365853658, 0.9722222222222222, 0.9851190476190477, 0.9759036144578314, 0.9753086419753086, 0.9817073170731707, 0.9817073170731707, 0.9696969696969697, 0.9783950617283951, 0.9662576687116564, 0.9701492537313433, 0.9767441860465116, 0.967551622418879, 0.9730538922155688, 0.9650145772594753, 0.9658119658119658, 0.967741935483871, 0.975975975975976, 0.9824561403508771, 0.9695121951219512, 0.9726443768996961, 0.9647058823529412, 0.9794117647058823, 0.9794117647058823, 0.9684813753581661, 0.9692307692307692, 0.9707602339181286]
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [100/200] batch [5/10] time 0.185 (0.188) data 0.108 (0.112) loss_x loss_x 0.6948 (0.5840) acc_x 81.2500 (83.7500) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [10/10] time 0.175 (0.186) data 0.099 (0.110) loss_x loss_x 0.5781 (0.5729) acc_x 87.5000 (85.6250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.2119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 339
clean true:327
clean false:12
clean_rate:0.9646017699115044
noisy true:795
noisy false:466
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1261
epoch [101/200] batch [5/10] time 0.169 (0.178) data 0.093 (0.102) loss_x loss_x 0.3049 (0.3775) acc_x 87.5000 (88.7500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [10/10] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.6743 (0.4579) acc_x 81.2500 (88.1250) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:329
clean false:11
clean_rate:0.9676470588235294
noisy true:812
noisy false:448
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [102/200] batch [5/10] time 0.168 (0.191) data 0.091 (0.115) loss_x loss_x 0.3921 (0.6262) acc_x 87.5000 (84.3750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [10/10] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.4553 (0.5417) acc_x 87.5000 (85.6250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:323
clean false:11
clean_rate:0.9670658682634731
noisy true:812
noisy false:454
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [103/200] batch [5/10] time 0.168 (0.184) data 0.092 (0.108) loss_x loss_x 0.4753 (0.4820) acc_x 90.6250 (88.7500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [10/10] time 0.159 (0.176) data 0.083 (0.099) loss_x loss_x 0.8574 (0.5301) acc_x 78.1250 (87.5000) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:328
clean false:7
clean_rate:0.9791044776119403
noisy true:804
noisy false:461
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [104/200] batch [5/10] time 0.183 (0.185) data 0.105 (0.109) loss_x loss_x 0.4758 (0.4323) acc_x 81.2500 (88.7500) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [10/10] time 0.174 (0.183) data 0.097 (0.106) loss_x loss_x 0.3567 (0.4405) acc_x 87.5000 (88.1250) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:334
clean false:11
clean_rate:0.9681159420289855
noisy true:810
noisy false:445
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [105/200] batch [5/10] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 0.1643 (0.5642) acc_x 93.7500 (86.8750) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [10/10] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.6309 (0.6339) acc_x 81.2500 (84.0625) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:324
clean false:10
clean_rate:0.9700598802395209
noisy true:817
noisy false:449
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [106/200] batch [5/10] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.4087 (0.4720) acc_x 90.6250 (86.2500) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [10/10] time 0.189 (0.175) data 0.112 (0.099) loss_x loss_x 0.3162 (0.5426) acc_x 93.7500 (85.6250) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 347
clean true:338
clean false:9
clean_rate:0.9740634005763689
noisy true:816
noisy false:437
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1253
epoch [107/200] batch [5/10] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.8672 (0.5135) acc_x 71.8750 (87.5000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [10/10] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.7036 (0.6229) acc_x 75.0000 (84.0625) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:331
clean false:7
clean_rate:0.9792899408284024
noisy true:822
noisy false:440
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [108/200] batch [5/10] time 0.207 (0.181) data 0.130 (0.104) loss_x loss_x 0.4661 (0.6526) acc_x 90.6250 (86.2500) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [10/10] time 0.168 (0.181) data 0.092 (0.104) loss_x loss_x 0.4507 (0.6187) acc_x 87.5000 (85.0000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 339
clean true:328
clean false:11
clean_rate:0.967551622418879
noisy true:813
noisy false:448
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1261
epoch [109/200] batch [5/10] time 0.181 (0.189) data 0.104 (0.112) loss_x loss_x 0.5439 (0.5891) acc_x 84.3750 (86.2500) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [10/10] time 0.181 (0.190) data 0.105 (0.113) loss_x loss_x 0.7637 (0.5477) acc_x 81.2500 (87.1875) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 341
clean true:323
clean false:18
clean_rate:0.9472140762463344
noisy true:815
noisy false:444
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1259
epoch [110/200] batch [5/10] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.3936 (0.4531) acc_x 84.3750 (88.7500) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [10/10] time 0.198 (0.186) data 0.121 (0.109) loss_x loss_x 0.5337 (0.5664) acc_x 81.2500 (85.9375) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.2075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 332
clean true:323
clean false:9
clean_rate:0.9728915662650602
noisy true:816
noisy false:452
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1268
epoch [111/200] batch [5/10] time 0.162 (0.180) data 0.086 (0.104) loss_x loss_x 0.4465 (0.5058) acc_x 87.5000 (85.6250) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [10/10] time 0.187 (0.176) data 0.111 (0.099) loss_x loss_x 0.7524 (0.5375) acc_x 78.1250 (84.6875) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:323
clean false:11
clean_rate:0.9670658682634731
noisy true:842
noisy false:424
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [112/200] batch [5/10] time 0.181 (0.188) data 0.105 (0.111) loss_x loss_x 0.5654 (0.4558) acc_x 81.2500 (87.5000) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [10/10] time 0.216 (0.183) data 0.139 (0.107) loss_x loss_x 0.3308 (0.4529) acc_x 87.5000 (86.5625) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:333
clean false:7
clean_rate:0.9794117647058823
noisy true:803
noisy false:457
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [113/200] batch [5/10] time 0.168 (0.175) data 0.092 (0.098) loss_x loss_x 0.5586 (0.5440) acc_x 78.1250 (85.0000) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [10/10] time 0.172 (0.179) data 0.096 (0.103) loss_x loss_x 0.2766 (0.4951) acc_x 93.7500 (86.5625) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 336
clean true:328
clean false:8
clean_rate:0.9761904761904762
noisy true:817
noisy false:447
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1264
epoch [114/200] batch [5/10] time 0.174 (0.176) data 0.098 (0.101) loss_x loss_x 0.1759 (0.3326) acc_x 96.8750 (92.5000) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [10/10] time 0.170 (0.175) data 0.094 (0.099) loss_x loss_x 0.2834 (0.4517) acc_x 96.8750 (89.6875) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:326
clean false:8
clean_rate:0.9760479041916168
noisy true:780
noisy false:486
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [115/200] batch [5/10] time 0.177 (0.165) data 0.101 (0.088) loss_x loss_x 0.5581 (0.5119) acc_x 81.2500 (86.8750) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [10/10] time 0.174 (0.170) data 0.097 (0.094) loss_x loss_x 0.6250 (0.4877) acc_x 90.6250 (86.8750) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:343
clean false:9
clean_rate:0.9744318181818182
noisy true:816
noisy false:432
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [116/200] batch [5/11] time 0.175 (0.187) data 0.098 (0.110) loss_x loss_x 0.2886 (0.4374) acc_x 93.7500 (90.6250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/11] time 0.190 (0.181) data 0.113 (0.104) loss_x loss_x 0.3928 (0.5053) acc_x 90.6250 (87.1875) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:339
clean false:13
clean_rate:0.9630681818181818
noisy true:804
noisy false:444
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [117/200] batch [5/11] time 0.206 (0.179) data 0.129 (0.102) loss_x loss_x 0.6543 (0.5927) acc_x 90.6250 (87.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/11] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.1963 (0.5369) acc_x 96.8750 (87.8125) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:332
clean false:8
clean_rate:0.9764705882352941
noisy true:781
noisy false:479
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [118/200] batch [5/10] time 0.172 (0.182) data 0.096 (0.106) loss_x loss_x 0.4883 (0.5454) acc_x 90.6250 (85.6250) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [10/10] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.8628 (0.5384) acc_x 81.2500 (86.8750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:341
clean false:11
clean_rate:0.96875
noisy true:824
noisy false:424
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [119/200] batch [5/11] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.5674 (0.4695) acc_x 84.3750 (90.0000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/11] time 0.168 (0.175) data 0.091 (0.099) loss_x loss_x 0.7246 (0.5379) acc_x 84.3750 (87.5000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:339
clean false:13
clean_rate:0.9630681818181818
noisy true:787
noisy false:461
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [120/200] batch [5/11] time 0.165 (0.174) data 0.089 (0.097) loss_x loss_x 0.2661 (0.5841) acc_x 93.7500 (86.2500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/11] time 0.166 (0.178) data 0.090 (0.101) loss_x loss_x 0.5283 (0.6144) acc_x 87.5000 (86.2500) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:331
clean false:13
clean_rate:0.9622093023255814
noisy true:790
noisy false:466
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [121/200] batch [5/10] time 0.179 (0.185) data 0.103 (0.108) loss_x loss_x 0.4519 (0.4915) acc_x 90.6250 (86.2500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [10/10] time 0.163 (0.179) data 0.086 (0.102) loss_x loss_x 0.2537 (0.4692) acc_x 96.8750 (88.1250) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 355
clean true:342
clean false:13
clean_rate:0.9633802816901409
noisy true:804
noisy false:441
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1245
epoch [122/200] batch [5/11] time 0.171 (0.177) data 0.094 (0.101) loss_x loss_x 0.5542 (0.6326) acc_x 81.2500 (83.7500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/11] time 0.175 (0.176) data 0.099 (0.099) loss_x loss_x 0.3589 (0.5532) acc_x 90.6250 (85.0000) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.2231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 357
clean true:346
clean false:11
clean_rate:0.969187675070028
noisy true:821
noisy false:422
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1243
epoch [123/200] batch [5/11] time 0.187 (0.173) data 0.109 (0.096) loss_x loss_x 0.3779 (0.5272) acc_x 93.7500 (88.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/11] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.6748 (0.5827) acc_x 81.2500 (85.0000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:336
clean false:9
clean_rate:0.9739130434782609
noisy true:804
noisy false:451
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [124/200] batch [5/10] time 0.177 (0.188) data 0.100 (0.112) loss_x loss_x 0.3306 (0.5425) acc_x 90.6250 (83.7500) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [10/10] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.3052 (0.5400) acc_x 90.6250 (85.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:333
clean false:9
clean_rate:0.9736842105263158
noisy true:788
noisy false:470
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [125/200] batch [5/10] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4968 (0.6173) acc_x 87.5000 (83.1250) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [10/10] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 1.0713 (0.6441) acc_x 75.0000 (82.1875) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:331
clean false:12
clean_rate:0.9650145772594753
noisy true:806
noisy false:451
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [126/200] batch [5/10] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.1371 (0.4975) acc_x 100.0000 (90.6250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [10/10] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.4612 (0.5545) acc_x 87.5000 (88.4375) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.2231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 357
clean true:345
clean false:12
clean_rate:0.9663865546218487
noisy true:779
noisy false:464
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1243
epoch [127/200] batch [5/11] time 0.163 (0.166) data 0.087 (0.089) loss_x loss_x 0.3428 (0.5228) acc_x 93.7500 (86.2500) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [10/11] time 0.164 (0.165) data 0.088 (0.089) loss_x loss_x 0.3975 (0.5096) acc_x 93.7500 (87.1875) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:339
clean false:9
clean_rate:0.9741379310344828
noisy true:794
noisy false:458
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [128/200] batch [5/10] time 0.195 (0.185) data 0.118 (0.108) loss_x loss_x 0.4880 (0.2638) acc_x 90.6250 (95.0000) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [10/10] time 0.179 (0.186) data 0.103 (0.110) loss_x loss_x 0.7441 (0.4292) acc_x 81.2500 (89.6875) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:332
clean false:12
clean_rate:0.9651162790697675
noisy true:783
noisy false:473
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [129/200] batch [5/10] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.5293 (0.4390) acc_x 84.3750 (89.3750) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [10/10] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.5967 (0.4408) acc_x 78.1250 (87.8125) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:336
clean false:7
clean_rate:0.9795918367346939
noisy true:789
noisy false:468
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [130/200] batch [5/10] time 0.166 (0.167) data 0.090 (0.091) loss_x loss_x 0.4514 (0.4292) acc_x 90.6250 (89.3750) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [10/10] time 0.163 (0.168) data 0.087 (0.092) loss_x loss_x 0.4539 (0.4383) acc_x 84.3750 (89.3750) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 340
clean true:331
clean false:9
clean_rate:0.9735294117647059
noisy true:801
noisy false:459
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1260
epoch [131/200] batch [5/10] time 0.169 (0.176) data 0.093 (0.100) loss_x loss_x 0.5371 (0.5626) acc_x 84.3750 (88.1250) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [10/10] time 0.166 (0.168) data 0.089 (0.091) loss_x loss_x 0.6895 (0.6109) acc_x 81.2500 (86.2500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 347
clean true:333
clean false:14
clean_rate:0.9596541786743515
noisy true:799
noisy false:454
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1253
epoch [132/200] batch [5/10] time 0.203 (0.181) data 0.127 (0.104) loss_x loss_x 0.8770 (0.4882) acc_x 81.2500 (87.5000) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [10/10] time 0.172 (0.185) data 0.095 (0.109) loss_x loss_x 0.7495 (0.5214) acc_x 78.1250 (85.3125) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:344
clean false:7
clean_rate:0.98005698005698
noisy true:789
noisy false:460
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [133/200] batch [5/10] time 0.163 (0.192) data 0.086 (0.115) loss_x loss_x 0.5317 (0.4820) acc_x 84.3750 (87.5000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [10/10] time 0.169 (0.182) data 0.092 (0.106) loss_x loss_x 0.1925 (0.4471) acc_x 93.7500 (88.4375) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:333
clean false:9
clean_rate:0.9736842105263158
noisy true:801
noisy false:457
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [134/200] batch [5/10] time 0.168 (0.165) data 0.091 (0.089) loss_x loss_x 0.6128 (0.5288) acc_x 87.5000 (88.7500) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [10/10] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.5703 (0.5529) acc_x 90.6250 (86.8750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:333
clean false:15
clean_rate:0.9568965517241379
noisy true:798
noisy false:454
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [135/200] batch [5/10] time 0.190 (0.182) data 0.113 (0.105) loss_x loss_x 0.3398 (0.5680) acc_x 90.6250 (87.5000) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [10/10] time 0.173 (0.184) data 0.097 (0.107) loss_x loss_x 0.5503 (0.5706) acc_x 84.3750 (86.8750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:343
clean false:9
clean_rate:0.9744318181818182
noisy true:813
noisy false:435
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [136/200] batch [5/11] time 0.177 (0.172) data 0.101 (0.095) loss_x loss_x 0.5791 (0.6050) acc_x 84.3750 (84.3750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/11] time 0.177 (0.177) data 0.100 (0.101) loss_x loss_x 0.4182 (0.5447) acc_x 84.3750 (85.0000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:327
clean false:7
clean_rate:0.9790419161676647
noisy true:807
noisy false:459
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [137/200] batch [5/10] time 0.173 (0.179) data 0.096 (0.103) loss_x loss_x 0.2479 (0.5265) acc_x 93.7500 (87.5000) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [10/10] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.4705 (0.5390) acc_x 87.5000 (85.6250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:341
clean false:10
clean_rate:0.9715099715099715
noisy true:786
noisy false:463
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [138/200] batch [5/10] time 0.184 (0.173) data 0.105 (0.096) loss_x loss_x 0.6436 (0.4304) acc_x 81.2500 (86.2500) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [10/10] time 0.190 (0.176) data 0.114 (0.099) loss_x loss_x 0.2423 (0.4325) acc_x 93.7500 (87.5000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 355
clean true:341
clean false:14
clean_rate:0.9605633802816902
noisy true:795
noisy false:450
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1245
epoch [139/200] batch [5/11] time 0.167 (0.177) data 0.090 (0.099) loss_x loss_x 0.9663 (0.4930) acc_x 75.0000 (88.1250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/11] time 0.227 (0.181) data 0.151 (0.104) loss_x loss_x 0.3186 (0.5165) acc_x 93.7500 (86.8750) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 355
clean true:342
clean false:13
clean_rate:0.9633802816901409
noisy true:826
noisy false:419
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1245
epoch [140/200] batch [5/11] time 0.189 (0.188) data 0.113 (0.112) loss_x loss_x 0.8140 (0.5032) acc_x 78.1250 (85.0000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/11] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.4229 (0.4843) acc_x 90.6250 (86.5625) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 347
clean true:341
clean false:6
clean_rate:0.9827089337175793
noisy true:807
noisy false:446
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1253
epoch [141/200] batch [5/10] time 0.158 (0.166) data 0.082 (0.090) loss_x loss_x 0.7920 (0.5156) acc_x 81.2500 (88.7500) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [10/10] time 0.199 (0.171) data 0.123 (0.095) loss_x loss_x 0.5098 (0.5216) acc_x 84.3750 (87.5000) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.2275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 364
clean true:349
clean false:15
clean_rate:0.9587912087912088
noisy true:825
noisy false:411
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1236
epoch [142/200] batch [5/11] time 0.158 (0.180) data 0.081 (0.104) loss_x loss_x 0.8438 (0.5706) acc_x 81.2500 (85.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/11] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.4370 (0.5725) acc_x 87.5000 (87.1875) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:344
clean false:10
clean_rate:0.9717514124293786
noisy true:826
noisy false:420
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [143/200] batch [5/11] time 0.182 (0.169) data 0.106 (0.092) loss_x loss_x 0.3875 (0.4659) acc_x 87.5000 (87.5000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/11] time 0.185 (0.171) data 0.109 (0.094) loss_x loss_x 0.3796 (0.4353) acc_x 87.5000 (89.0625) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:331
clean false:7
clean_rate:0.9792899408284024
noisy true:813
noisy false:449
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [144/200] batch [5/10] time 0.174 (0.182) data 0.096 (0.105) loss_x loss_x 0.2394 (0.3620) acc_x 93.7500 (91.8750) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [10/10] time 0.186 (0.180) data 0.109 (0.104) loss_x loss_x 0.4114 (0.4221) acc_x 90.6250 (89.6875) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 333
clean true:328
clean false:5
clean_rate:0.984984984984985
noisy true:808
noisy false:459
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1267
epoch [145/200] batch [5/10] time 0.167 (0.195) data 0.091 (0.119) loss_x loss_x 0.2263 (0.5468) acc_x 93.7500 (86.8750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [10/10] time 0.186 (0.195) data 0.109 (0.118) loss_x loss_x 0.1523 (0.4514) acc_x 96.8750 (89.6875) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:345
clean false:6
clean_rate:0.9829059829059829
noisy true:809
noisy false:440
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [146/200] batch [5/10] time 0.191 (0.185) data 0.115 (0.109) loss_x loss_x 0.3081 (0.3990) acc_x 90.6250 (88.7500) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [10/10] time 0.249 (0.192) data 0.173 (0.116) loss_x loss_x 0.3086 (0.4243) acc_x 90.6250 (87.5000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:343
clean false:10
clean_rate:0.9716713881019831
noisy true:814
noisy false:433
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [147/200] batch [5/11] time 0.193 (0.190) data 0.116 (0.114) loss_x loss_x 0.2783 (0.6410) acc_x 90.6250 (83.7500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/11] time 0.185 (0.188) data 0.108 (0.112) loss_x loss_x 0.6089 (0.6210) acc_x 78.1250 (83.1250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:337
clean false:6
clean_rate:0.9825072886297376
noisy true:781
noisy false:476
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [148/200] batch [5/10] time 0.171 (0.182) data 0.095 (0.105) loss_x loss_x 0.3979 (0.4325) acc_x 90.6250 (89.3750) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [10/10] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.2030 (0.4272) acc_x 96.8750 (90.0000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:343
clean false:10
clean_rate:0.9716713881019831
noisy true:772
noisy false:475
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [149/200] batch [5/11] time 0.179 (0.171) data 0.103 (0.095) loss_x loss_x 0.4358 (0.4627) acc_x 93.7500 (90.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/11] time 0.181 (0.172) data 0.104 (0.096) loss_x loss_x 0.5107 (0.4596) acc_x 81.2500 (88.7500) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 349
clean true:338
clean false:11
clean_rate:0.9684813753581661
noisy true:806
noisy false:445
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1251
epoch [150/200] batch [5/10] time 0.163 (0.179) data 0.087 (0.103) loss_x loss_x 0.4424 (0.5929) acc_x 84.3750 (83.7500) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [10/10] time 0.172 (0.175) data 0.095 (0.099) loss_x loss_x 0.4517 (0.5094) acc_x 87.5000 (85.9375) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:343
clean false:10
clean_rate:0.9716713881019831
noisy true:809
noisy false:438
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [151/200] batch [5/11] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.4128 (0.5376) acc_x 84.3750 (85.0000) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/11] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.5840 (0.5076) acc_x 87.5000 (86.2500) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:341
clean false:13
clean_rate:0.963276836158192
noisy true:814
noisy false:432
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [152/200] batch [5/11] time 0.197 (0.180) data 0.121 (0.104) loss_x loss_x 0.7295 (0.4334) acc_x 81.2500 (88.7500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/11] time 0.169 (0.178) data 0.091 (0.102) loss_x loss_x 0.7412 (0.4416) acc_x 81.2500 (88.4375) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:343
clean false:9
clean_rate:0.9744318181818182
noisy true:818
noisy false:430
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [153/200] batch [5/11] time 0.197 (0.191) data 0.120 (0.114) loss_x loss_x 0.8218 (0.6295) acc_x 81.2500 (86.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/11] time 0.164 (0.190) data 0.088 (0.113) loss_x loss_x 0.4031 (0.5513) acc_x 90.6250 (86.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:351
clean false:7
clean_rate:0.9804469273743017
noisy true:817
noisy false:425
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [154/200] batch [5/11] time 0.166 (0.170) data 0.089 (0.094) loss_x loss_x 0.3442 (0.4035) acc_x 93.7500 (91.2500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/11] time 0.183 (0.170) data 0.107 (0.094) loss_x loss_x 0.3933 (0.3837) acc_x 87.5000 (90.6250) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 350
clean true:342
clean false:8
clean_rate:0.9771428571428571
noisy true:803
noisy false:447
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1250
epoch [155/200] batch [5/10] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.5020 (0.3976) acc_x 87.5000 (87.5000) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [10/10] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5581 (0.4599) acc_x 87.5000 (87.5000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:339
clean false:14
clean_rate:0.9603399433427762
noisy true:803
noisy false:444
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [156/200] batch [5/11] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.5010 (0.5622) acc_x 84.3750 (82.5000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/11] time 0.162 (0.175) data 0.086 (0.098) loss_x loss_x 0.5513 (0.5547) acc_x 90.6250 (84.6875) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 352
clean true:340
clean false:12
clean_rate:0.9659090909090909
noisy true:810
noisy false:438
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1248
epoch [157/200] batch [5/11] time 0.182 (0.188) data 0.106 (0.112) loss_x loss_x 0.4204 (0.4361) acc_x 90.6250 (90.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/11] time 0.159 (0.180) data 0.082 (0.103) loss_x loss_x 1.1250 (0.5201) acc_x 71.8750 (87.5000) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 359
clean true:347
clean false:12
clean_rate:0.9665738161559888
noisy true:814
noisy false:427
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1241
epoch [158/200] batch [5/11] time 0.170 (0.194) data 0.094 (0.117) loss_x loss_x 0.3352 (0.4958) acc_x 90.6250 (86.2500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/11] time 0.184 (0.190) data 0.107 (0.114) loss_x loss_x 0.5835 (0.5040) acc_x 84.3750 (86.5625) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:334
clean false:9
clean_rate:0.9737609329446064
noisy true:804
noisy false:453
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [159/200] batch [5/10] time 0.184 (0.187) data 0.107 (0.111) loss_x loss_x 0.3899 (0.4291) acc_x 90.6250 (88.1250) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [10/10] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.6094 (0.4354) acc_x 93.7500 (90.3125) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:331
clean false:14
clean_rate:0.9594202898550724
noisy true:776
noisy false:479
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [160/200] batch [5/10] time 0.191 (0.183) data 0.114 (0.106) loss_x loss_x 0.3191 (0.6286) acc_x 93.7500 (88.1250) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [10/10] time 0.215 (0.188) data 0.139 (0.111) loss_x loss_x 0.3752 (0.5669) acc_x 84.3750 (87.1875) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.2075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 332
clean true:325
clean false:7
clean_rate:0.9789156626506024
noisy true:794
noisy false:474
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1268
epoch [161/200] batch [5/10] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.3567 (0.4459) acc_x 90.6250 (89.3750) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [10/10] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.6328 (0.4713) acc_x 84.3750 (87.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 362
clean true:348
clean false:14
clean_rate:0.9613259668508287
noisy true:806
noisy false:432
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1238
epoch [162/200] batch [5/11] time 0.172 (0.169) data 0.096 (0.092) loss_x loss_x 0.1919 (0.5524) acc_x 100.0000 (90.6250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/11] time 0.179 (0.175) data 0.103 (0.099) loss_x loss_x 0.4517 (0.5317) acc_x 93.7500 (89.0625) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:336
clean false:12
clean_rate:0.9655172413793104
noisy true:811
noisy false:441
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [163/200] batch [5/10] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.3730 (0.4418) acc_x 93.7500 (90.0000) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [10/10] time 0.175 (0.177) data 0.099 (0.100) loss_x loss_x 0.6289 (0.4466) acc_x 87.5000 (90.9375) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:334
clean false:14
clean_rate:0.9597701149425287
noisy true:808
noisy false:444
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [164/200] batch [5/10] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.7402 (0.4729) acc_x 87.5000 (91.2500) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [10/10] time 0.176 (0.177) data 0.098 (0.100) loss_x loss_x 0.3599 (0.4849) acc_x 90.6250 (88.1250) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:331
clean false:11
clean_rate:0.9678362573099415
noisy true:795
noisy false:463
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [165/200] batch [5/10] time 0.158 (0.164) data 0.082 (0.088) loss_x loss_x 0.8667 (0.5417) acc_x 71.8750 (85.6250) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [10/10] time 0.158 (0.162) data 0.082 (0.086) loss_x loss_x 0.4307 (0.5371) acc_x 90.6250 (85.3125) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:338
clean false:10
clean_rate:0.9712643678160919
noisy true:801
noisy false:451
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [166/200] batch [5/10] time 0.191 (0.174) data 0.114 (0.098) loss_x loss_x 0.4695 (0.4841) acc_x 87.5000 (88.1250) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [10/10] time 0.195 (0.181) data 0.118 (0.105) loss_x loss_x 0.4219 (0.4587) acc_x 87.5000 (89.0625) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 349
clean true:340
clean false:9
clean_rate:0.9742120343839542
noisy true:812
noisy false:439
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1251
epoch [167/200] batch [5/10] time 0.170 (0.171) data 0.092 (0.094) loss_x loss_x 0.1958 (0.3358) acc_x 93.7500 (88.1250) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [10/10] time 0.185 (0.173) data 0.109 (0.097) loss_x loss_x 0.4888 (0.3739) acc_x 87.5000 (88.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.2262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 362
clean true:350
clean false:12
clean_rate:0.9668508287292817
noisy true:819
noisy false:419
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1238
epoch [168/200] batch [5/11] time 0.181 (0.184) data 0.104 (0.108) loss_x loss_x 0.4456 (0.5502) acc_x 84.3750 (83.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/11] time 0.175 (0.180) data 0.099 (0.104) loss_x loss_x 0.4973 (0.5223) acc_x 87.5000 (85.9375) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 355
clean true:345
clean false:10
clean_rate:0.971830985915493
noisy true:796
noisy false:449
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1245
epoch [169/200] batch [5/11] time 0.183 (0.176) data 0.106 (0.100) loss_x loss_x 0.3318 (0.4379) acc_x 93.7500 (93.7500) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/11] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.7456 (0.4244) acc_x 84.3750 (91.5625) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 349
clean true:337
clean false:12
clean_rate:0.9656160458452722
noisy true:799
noisy false:452
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1251
epoch [170/200] batch [5/10] time 0.186 (0.170) data 0.110 (0.093) loss_x loss_x 0.3311 (0.4547) acc_x 93.7500 (90.6250) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [10/10] time 0.164 (0.172) data 0.088 (0.095) loss_x loss_x 0.7866 (0.5431) acc_x 81.2500 (86.5625) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:341
clean false:13
clean_rate:0.963276836158192
noisy true:800
noisy false:446
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [171/200] batch [5/11] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.4021 (0.5445) acc_x 93.7500 (85.6250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/11] time 0.195 (0.179) data 0.119 (0.103) loss_x loss_x 0.4575 (0.4605) acc_x 84.3750 (87.5000) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 346
clean true:338
clean false:8
clean_rate:0.976878612716763
noisy true:800
noisy false:454
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1254
epoch [172/200] batch [5/10] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.3303 (0.4401) acc_x 90.6250 (88.1250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [10/10] time 0.155 (0.181) data 0.078 (0.105) loss_x loss_x 0.9756 (0.5312) acc_x 81.2500 (86.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:347
clean false:14
clean_rate:0.961218836565097
noisy true:786
noisy false:453
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [173/200] batch [5/11] time 0.188 (0.175) data 0.111 (0.098) loss_x loss_x 0.4573 (0.6386) acc_x 87.5000 (82.5000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/11] time 0.187 (0.180) data 0.111 (0.103) loss_x loss_x 0.4602 (0.5198) acc_x 87.5000 (85.0000) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 349
clean true:337
clean false:12
clean_rate:0.9656160458452722
noisy true:787
noisy false:464
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1251
epoch [174/200] batch [5/10] time 0.174 (0.182) data 0.097 (0.106) loss_x loss_x 0.2808 (0.4678) acc_x 90.6250 (86.2500) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [10/10] time 0.175 (0.182) data 0.097 (0.105) loss_x loss_x 0.4229 (0.4616) acc_x 90.6250 (87.1875) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.2225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 356
clean true:341
clean false:15
clean_rate:0.9578651685393258
noisy true:781
noisy false:463
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1244
epoch [175/200] batch [5/11] time 0.176 (0.191) data 0.099 (0.115) loss_x loss_x 0.6021 (0.5779) acc_x 84.3750 (85.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/11] time 0.159 (0.183) data 0.083 (0.106) loss_x loss_x 0.5537 (0.5058) acc_x 87.5000 (86.5625) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:345
clean false:9
clean_rate:0.9745762711864406
noisy true:804
noisy false:442
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [176/200] batch [5/11] time 0.161 (0.164) data 0.084 (0.088) loss_x loss_x 0.7637 (0.6923) acc_x 84.3750 (84.3750) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [10/11] time 0.190 (0.170) data 0.113 (0.093) loss_x loss_x 0.4021 (0.6321) acc_x 84.3750 (83.7500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:336
clean false:12
clean_rate:0.9655172413793104
noisy true:773
noisy false:479
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [177/200] batch [5/10] time 0.204 (0.206) data 0.128 (0.129) loss_x loss_x 0.4297 (0.5178) acc_x 93.7500 (90.6250) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/10] time 0.188 (0.200) data 0.112 (0.123) loss_x loss_x 0.2480 (0.4874) acc_x 93.7500 (90.0000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 505
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:325
clean false:13
clean_rate:0.9615384615384616
noisy true:770
noisy false:492
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [178/200] batch [5/10] time 0.198 (0.177) data 0.122 (0.100) loss_x loss_x 0.5220 (0.5256) acc_x 87.5000 (86.8750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [10/10] time 0.207 (0.180) data 0.130 (0.103) loss_x loss_x 0.6558 (0.5200) acc_x 81.2500 (87.1875) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 359
clean true:345
clean false:14
clean_rate:0.9610027855153204
noisy true:770
noisy false:471
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1241
epoch [179/200] batch [5/11] time 0.161 (0.185) data 0.084 (0.108) loss_x loss_x 0.3625 (0.4883) acc_x 93.7500 (89.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/11] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.5610 (0.5467) acc_x 87.5000 (87.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:343
clean false:11
clean_rate:0.9689265536723164
noisy true:785
noisy false:461
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [180/200] batch [5/11] time 0.163 (0.168) data 0.086 (0.091) loss_x loss_x 0.3040 (0.5631) acc_x 96.8750 (85.6250) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/11] time 0.159 (0.164) data 0.081 (0.087) loss_x loss_x 0.4839 (0.4849) acc_x 90.6250 (87.5000) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:337
clean false:11
clean_rate:0.9683908045977011
noisy true:803
noisy false:449
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [181/200] batch [5/10] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.6855 (0.4779) acc_x 84.3750 (87.5000) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [10/10] time 0.186 (0.189) data 0.110 (0.113) loss_x loss_x 0.3191 (0.4909) acc_x 93.7500 (86.8750) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:326
clean false:12
clean_rate:0.9644970414201184
noisy true:791
noisy false:471
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [182/200] batch [5/10] time 0.161 (0.171) data 0.085 (0.094) loss_x loss_x 0.4172 (0.4349) acc_x 90.6250 (90.0000) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [10/10] time 0.179 (0.172) data 0.103 (0.096) loss_x loss_x 0.2759 (0.4864) acc_x 93.7500 (88.7500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:338
clean false:10
clean_rate:0.9712643678160919
noisy true:812
noisy false:440
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [183/200] batch [5/10] time 0.170 (0.187) data 0.094 (0.111) loss_x loss_x 0.3601 (0.3340) acc_x 90.6250 (91.8750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [10/10] time 0.168 (0.186) data 0.091 (0.110) loss_x loss_x 0.3357 (0.3852) acc_x 87.5000 (90.0000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:330
clean false:13
clean_rate:0.9620991253644315
noisy true:796
noisy false:461
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [184/200] batch [5/10] time 0.172 (0.175) data 0.096 (0.099) loss_x loss_x 0.4346 (0.3831) acc_x 90.6250 (90.6250) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [10/10] time 0.181 (0.176) data 0.104 (0.100) loss_x loss_x 0.7344 (0.4881) acc_x 81.2500 (87.5000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.2244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 359
clean true:350
clean false:9
clean_rate:0.9749303621169917
noisy true:798
noisy false:443
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1241
epoch [185/200] batch [5/11] time 0.208 (0.187) data 0.131 (0.110) loss_x loss_x 0.5708 (0.5275) acc_x 90.6250 (86.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/11] time 0.197 (0.190) data 0.119 (0.113) loss_x loss_x 0.2620 (0.5003) acc_x 93.7500 (86.2500) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 350
clean true:340
clean false:10
clean_rate:0.9714285714285714
noisy true:785
noisy false:465
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1250
epoch [186/200] batch [5/10] time 0.178 (0.190) data 0.101 (0.113) loss_x loss_x 0.5361 (0.4140) acc_x 90.6250 (89.3750) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [10/10] time 0.192 (0.186) data 0.116 (0.110) loss_x loss_x 0.5913 (0.4522) acc_x 84.3750 (87.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 368
clean true:355
clean false:13
clean_rate:0.9646739130434783
noisy true:806
noisy false:426
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1232
epoch [187/200] batch [5/11] time 0.180 (0.182) data 0.104 (0.104) loss_x loss_x 0.3745 (0.4731) acc_x 84.3750 (87.5000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/11] time 0.173 (0.177) data 0.096 (0.100) loss_x loss_x 0.8271 (0.5347) acc_x 87.5000 (88.4375) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 347
clean true:337
clean false:10
clean_rate:0.9711815561959655
noisy true:794
noisy false:459
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1253
epoch [188/200] batch [5/10] time 0.212 (0.186) data 0.134 (0.110) loss_x loss_x 0.3733 (0.4474) acc_x 87.5000 (87.5000) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [10/10] time 0.178 (0.193) data 0.101 (0.116) loss_x loss_x 0.2191 (0.4648) acc_x 96.8750 (87.5000) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:336
clean false:15
clean_rate:0.9572649572649573
noisy true:780
noisy false:469
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [189/200] batch [5/10] time 0.158 (0.160) data 0.082 (0.083) loss_x loss_x 0.8506 (0.5789) acc_x 87.5000 (86.8750) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [10/10] time 0.176 (0.170) data 0.100 (0.093) loss_x loss_x 0.3557 (0.5569) acc_x 93.7500 (87.5000) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:333
clean false:12
clean_rate:0.9652173913043478
noisy true:790
noisy false:465
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [190/200] batch [5/10] time 0.252 (0.193) data 0.176 (0.116) loss_x loss_x 0.3899 (0.5045) acc_x 93.7500 (88.7500) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [10/10] time 0.180 (0.190) data 0.104 (0.113) loss_x loss_x 0.5596 (0.4573) acc_x 84.3750 (88.1250) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.2250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 360
clean true:348
clean false:12
clean_rate:0.9666666666666667
noisy true:791
noisy false:449
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1240
epoch [191/200] batch [5/11] time 0.167 (0.176) data 0.090 (0.099) loss_x loss_x 0.5317 (0.4736) acc_x 87.5000 (87.5000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/11] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.5073 (0.5062) acc_x 90.6250 (87.5000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 346
clean true:339
clean false:7
clean_rate:0.9797687861271677
noisy true:811
noisy false:443
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1254
epoch [192/200] batch [5/10] time 0.165 (0.177) data 0.089 (0.100) loss_x loss_x 0.6489 (0.4617) acc_x 75.0000 (87.5000) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [10/10] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.2358 (0.4141) acc_x 93.7500 (88.7500) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 357
clean true:347
clean false:10
clean_rate:0.9719887955182073
noisy true:780
noisy false:463
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1243
epoch [193/200] batch [5/11] time 0.172 (0.179) data 0.096 (0.102) loss_x loss_x 0.5020 (0.4644) acc_x 93.7500 (88.7500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/11] time 0.174 (0.177) data 0.098 (0.101) loss_x loss_x 0.5493 (0.5306) acc_x 84.3750 (86.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 362
clean true:348
clean false:14
clean_rate:0.9613259668508287
noisy true:782
noisy false:456
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1238
epoch [194/200] batch [5/11] time 0.194 (0.182) data 0.117 (0.106) loss_x loss_x 0.6113 (0.4381) acc_x 84.3750 (88.7500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/11] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 0.3306 (0.4941) acc_x 90.6250 (86.5625) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:339
clean false:14
clean_rate:0.9603399433427762
noisy true:782
noisy false:465
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [195/200] batch [5/11] time 0.199 (0.193) data 0.123 (0.117) loss_x loss_x 0.7417 (0.5342) acc_x 81.2500 (86.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/11] time 0.186 (0.190) data 0.110 (0.114) loss_x loss_x 0.4854 (0.4594) acc_x 90.6250 (88.4375) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:342
clean false:16
clean_rate:0.9553072625698324
noisy true:798
noisy false:444
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [196/200] batch [5/11] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.3489 (0.2894) acc_x 87.5000 (91.2500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/11] time 0.166 (0.185) data 0.090 (0.108) loss_x loss_x 0.2188 (0.3732) acc_x 90.6250 (89.3750) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 336
clean true:323
clean false:13
clean_rate:0.9613095238095238
noisy true:813
noisy false:451
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1264
epoch [197/200] batch [5/10] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.2791 (0.5223) acc_x 90.6250 (90.0000) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [10/10] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.6323 (0.5183) acc_x 75.0000 (86.8750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:339
clean false:12
clean_rate:0.9658119658119658
noisy true:796
noisy false:453
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [198/200] batch [5/10] time 0.193 (0.200) data 0.116 (0.124) loss_x loss_x 0.7090 (0.6319) acc_x 84.3750 (84.3750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/10] time 0.184 (0.192) data 0.108 (0.116) loss_x loss_x 0.2369 (0.5315) acc_x 93.7500 (86.2500) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 360
clean true:346
clean false:14
clean_rate:0.9611111111111111
noisy true:788
noisy false:452
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1240
epoch [199/200] batch [5/11] time 0.192 (0.181) data 0.116 (0.105) loss_x loss_x 0.5591 (0.5043) acc_x 93.7500 (87.5000) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/11] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.7402 (0.5221) acc_x 81.2500 (87.5000) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.2119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 339
clean true:328
clean false:11
clean_rate:0.967551622418879
noisy true:794
noisy false:467
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1261
epoch [200/200] batch [5/10] time 0.193 (0.187) data 0.116 (0.110) loss_x loss_x 0.5078 (0.4943) acc_x 84.3750 (86.2500) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [10/10] time 0.178 (0.182) data 0.101 (0.105) loss_x loss_x 0.5327 (0.5097) acc_x 87.5000 (88.1250) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,093
* accuracy: 84.9%
* error: 15.1%
* macro_f1: 79.6%
Elapsed: 0:35:13
