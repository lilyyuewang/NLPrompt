***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 846
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:373
clean false:5
clean_rate:0.9867724867724867
noisy true:381
noisy false:841
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [1/200] batch [5/11] time 0.241 (0.260) data 0.118 (0.117) loss_x loss_x 2.7266 (2.8031) acc_x 53.1250 (53.7500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/11] time 0.240 (0.255) data 0.117 (0.122) loss_x loss_x 2.3477 (2.5902) acc_x 71.8750 (62.1875) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 709
confident_label rate tensor(0.2862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 458
clean true:452
clean false:6
clean_rate:0.9868995633187773
noisy true:439
noisy false:703
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1142
epoch [2/200] batch [5/14] time 0.223 (0.226) data 0.099 (0.101) loss_x loss_x 1.5068 (1.3784) acc_x 59.3750 (68.1250) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/14] time 0.267 (0.232) data 0.142 (0.107) loss_x loss_x 0.6899 (1.2102) acc_x 78.1250 (70.0000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 580
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:499
clean false:6
clean_rate:0.9881188118811881
noisy true:521
noisy false:574
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [3/200] batch [5/15] time 0.236 (0.227) data 0.110 (0.112) loss_x loss_x 0.9766 (1.0743) acc_x 81.2500 (74.3750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/15] time 0.228 (0.227) data 0.104 (0.108) loss_x loss_x 0.7710 (1.0288) acc_x 78.1250 (75.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/15] time 0.193 (0.224) data 0.117 (0.106) loss_x loss_x 0.6616 (0.9948) acc_x 75.0000 (74.5833) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 545
confident_label rate tensor(0.3325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 532
clean true:526
clean false:6
clean_rate:0.9887218045112782
noisy true:529
noisy false:539
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1068
epoch [4/200] batch [5/16] time 0.260 (0.230) data 0.136 (0.109) loss_x loss_x 0.6421 (0.8510) acc_x 78.1250 (79.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/16] time 0.232 (0.230) data 0.106 (0.108) loss_x loss_x 0.8335 (0.8719) acc_x 87.5000 (78.7500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/16] time 0.229 (0.230) data 0.103 (0.108) loss_x loss_x 0.7788 (0.8657) acc_x 78.1250 (78.1250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 507
confident_label rate tensor(0.3475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 556
clean true:551
clean false:5
clean_rate:0.9910071942446043
noisy true:542
noisy false:502
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1044
epoch [5/200] batch [5/17] time 0.230 (0.238) data 0.107 (0.114) loss_x loss_x 0.9233 (0.7211) acc_x 81.2500 (83.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/17] time 0.172 (0.219) data 0.093 (0.109) loss_x loss_x 0.9429 (0.8794) acc_x 84.3750 (80.9375) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/17] time 0.239 (0.223) data 0.115 (0.107) loss_x loss_x 0.7046 (0.8064) acc_x 81.2500 (81.4583) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 517
confident_label rate tensor(0.3487, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 558
clean true:554
clean false:4
clean_rate:0.992831541218638
noisy true:529
noisy false:513
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1042
epoch [6/200] batch [5/17] time 0.229 (0.225) data 0.106 (0.117) loss_x loss_x 0.8413 (0.8517) acc_x 75.0000 (76.8750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/17] time 0.216 (0.224) data 0.094 (0.108) loss_x loss_x 1.4395 (0.9189) acc_x 59.3750 (75.3125) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/17] time 0.235 (0.226) data 0.112 (0.108) loss_x loss_x 0.8052 (0.8376) acc_x 81.2500 (78.1250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.3500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 560
clean true:554
clean false:6
clean_rate:0.9892857142857143
noisy true:550
noisy false:490
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1040
epoch [7/200] batch [5/17] time 0.218 (0.227) data 0.096 (0.104) loss_x loss_x 0.8032 (0.6478) acc_x 71.8750 (80.6250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/17] time 0.222 (0.224) data 0.100 (0.100) loss_x loss_x 0.8057 (0.7361) acc_x 75.0000 (77.1875) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/17] time 0.226 (0.225) data 0.104 (0.101) loss_x loss_x 0.6802 (0.7898) acc_x 87.5000 (78.1250) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 503
confident_label rate tensor(0.3519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 563
clean true:562
clean false:1
clean_rate:0.9982238010657194
noisy true:535
noisy false:502
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1037
epoch [8/200] batch [5/17] time 0.222 (0.226) data 0.099 (0.104) loss_x loss_x 1.3701 (0.7087) acc_x 71.8750 (84.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/17] time 0.253 (0.231) data 0.129 (0.107) loss_x loss_x 0.6841 (0.7688) acc_x 78.1250 (81.2500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/17] time 0.211 (0.229) data 0.090 (0.106) loss_x loss_x 1.0762 (0.8676) acc_x 65.6250 (78.1250) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.3637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 582
clean true:579
clean false:3
clean_rate:0.9948453608247423
noisy true:540
noisy false:478
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1018
epoch [9/200] batch [5/18] time 0.206 (0.202) data 0.088 (0.099) loss_x loss_x 1.0039 (0.8133) acc_x 75.0000 (79.3750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/18] time 0.219 (0.212) data 0.095 (0.098) loss_x loss_x 0.5698 (0.8574) acc_x 84.3750 (76.5625) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/18] time 0.216 (0.213) data 0.093 (0.096) loss_x loss_x 1.0107 (0.8214) acc_x 71.8750 (77.7083) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.3594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 575
clean true:568
clean false:7
clean_rate:0.9878260869565217
noisy true:548
noisy false:477
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1025
epoch [10/200] batch [5/17] time 0.212 (0.218) data 0.087 (0.094) loss_x loss_x 0.8154 (0.8857) acc_x 78.1250 (76.8750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/17] time 0.231 (0.222) data 0.116 (0.099) loss_x loss_x 0.6831 (0.8610) acc_x 81.2500 (77.1875) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/17] time 0.239 (0.230) data 0.112 (0.107) loss_x loss_x 0.6997 (0.8203) acc_x 75.0000 (77.7083) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.3637, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 582
clean true:580
clean false:2
clean_rate:0.9965635738831615
noisy true:558
noisy false:460
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1018
epoch [11/200] batch [5/18] time 0.238 (0.208) data 0.112 (0.106) loss_x loss_x 0.4326 (0.7249) acc_x 90.6250 (81.2500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/18] time 0.234 (0.220) data 0.112 (0.107) loss_x loss_x 1.0293 (0.7826) acc_x 81.2500 (80.6250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/18] time 0.231 (0.227) data 0.107 (0.110) loss_x loss_x 0.8403 (0.7926) acc_x 75.0000 (79.3750) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.3606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 577
clean true:573
clean false:4
clean_rate:0.9930675909878682
noisy true:548
noisy false:475
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1023
epoch [12/200] batch [5/18] time 0.205 (0.211) data 0.080 (0.092) loss_x loss_x 0.8828 (0.7376) acc_x 75.0000 (80.6250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/18] time 0.214 (0.215) data 0.089 (0.094) loss_x loss_x 0.8662 (0.7622) acc_x 78.1250 (80.0000) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/18] time 0.230 (0.227) data 0.108 (0.104) loss_x loss_x 0.6567 (0.7639) acc_x 78.1250 (79.1667) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.3550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 568
clean true:566
clean false:2
clean_rate:0.9964788732394366
noisy true:549
noisy false:483
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1032
epoch [13/200] batch [5/17] time 0.230 (0.234) data 0.104 (0.112) loss_x loss_x 0.4529 (0.8492) acc_x 87.5000 (75.6250) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/17] time 0.221 (0.230) data 0.098 (0.106) loss_x loss_x 1.0645 (0.7592) acc_x 71.8750 (78.1250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/17] time 0.215 (0.227) data 0.091 (0.103) loss_x loss_x 0.8076 (0.7901) acc_x 84.3750 (78.7500) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 500
confident_label rate tensor(0.3531, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 565
clean true:563
clean false:2
clean_rate:0.9964601769911504
noisy true:537
noisy false:498
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1035
epoch [14/200] batch [5/17] time 0.225 (0.232) data 0.102 (0.116) loss_x loss_x 0.6704 (0.8193) acc_x 75.0000 (77.5000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/17] time 0.231 (0.226) data 0.108 (0.107) loss_x loss_x 0.6157 (0.7366) acc_x 78.1250 (78.7500) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/17] time 0.225 (0.231) data 0.103 (0.111) loss_x loss_x 0.8892 (0.7596) acc_x 71.8750 (77.9167) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.3525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 564
clean true:559
clean false:5
clean_rate:0.9911347517730497
noisy true:557
noisy false:479
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1036
epoch [15/200] batch [5/17] time 0.240 (0.236) data 0.119 (0.113) loss_x loss_x 0.9097 (0.8236) acc_x 71.8750 (78.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/17] time 0.231 (0.235) data 0.104 (0.112) loss_x loss_x 1.3535 (0.8464) acc_x 62.5000 (77.5000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/17] time 0.247 (0.232) data 0.108 (0.114) loss_x loss_x 0.6943 (0.8681) acc_x 78.1250 (76.4583) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.3525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 564
clean true:558
clean false:6
clean_rate:0.9893617021276596
noisy true:540
noisy false:496
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1036
epoch [16/200] batch [5/17] time 0.186 (0.238) data 0.109 (0.123) loss_x loss_x 0.9932 (0.9160) acc_x 81.2500 (76.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/17] time 0.241 (0.231) data 0.117 (0.117) loss_x loss_x 0.3557 (0.8460) acc_x 90.6250 (78.1250) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/17] time 0.227 (0.226) data 0.100 (0.108) loss_x loss_x 0.6016 (0.7779) acc_x 90.6250 (80.0000) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 592
clean true:583
clean false:9
clean_rate:0.9847972972972973
noisy true:539
noisy false:469
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1008
epoch [17/200] batch [5/18] time 0.230 (0.243) data 0.106 (0.120) loss_x loss_x 0.5391 (0.7116) acc_x 87.5000 (81.2500) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/18] time 0.239 (0.237) data 0.116 (0.114) loss_x loss_x 0.8628 (0.7783) acc_x 71.8750 (78.7500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/18] time 0.304 (0.236) data 0.167 (0.115) loss_x loss_x 0.6074 (0.7732) acc_x 81.2500 (79.7917) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 603
clean true:600
clean false:3
clean_rate:0.9950248756218906
noisy true:550
noisy false:447
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 997
epoch [18/200] batch [5/18] time 0.216 (0.221) data 0.090 (0.095) loss_x loss_x 0.3389 (0.7406) acc_x 93.7500 (81.2500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/18] time 0.228 (0.228) data 0.105 (0.102) loss_x loss_x 1.0391 (0.7240) acc_x 65.6250 (79.6875) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/18] time 0.234 (0.229) data 0.111 (0.104) loss_x loss_x 1.0059 (0.7549) acc_x 75.0000 (79.5833) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.3650, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 584
clean true:580
clean false:4
clean_rate:0.9931506849315068
noisy true:565
noisy false:451
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1016
epoch [19/200] batch [5/18] time 0.231 (0.223) data 0.106 (0.098) loss_x loss_x 0.6777 (0.8383) acc_x 75.0000 (76.8750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/18] time 0.236 (0.225) data 0.111 (0.100) loss_x loss_x 1.0146 (0.8047) acc_x 78.1250 (78.1250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/18] time 0.235 (0.228) data 0.109 (0.103) loss_x loss_x 0.7969 (0.8275) acc_x 75.0000 (77.7083) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 609
clean true:606
clean false:3
clean_rate:0.9950738916256158
noisy true:561
noisy false:430
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 991
epoch [20/200] batch [5/19] time 0.221 (0.247) data 0.097 (0.124) loss_x loss_x 1.0078 (0.7702) acc_x 71.8750 (80.6250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/19] time 0.227 (0.237) data 0.103 (0.112) loss_x loss_x 0.6714 (0.8396) acc_x 84.3750 (79.6875) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/19] time 0.226 (0.232) data 0.103 (0.108) loss_x loss_x 0.7446 (0.8429) acc_x 84.3750 (78.5417) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 600
clean true:596
clean false:4
clean_rate:0.9933333333333333
noisy true:561
noisy false:439
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1000
epoch [21/200] batch [5/18] time 0.212 (0.235) data 0.088 (0.111) loss_x loss_x 1.0137 (0.8222) acc_x 65.6250 (75.0000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/18] time 0.228 (0.228) data 0.102 (0.104) loss_x loss_x 0.5093 (0.7073) acc_x 84.3750 (79.6875) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/18] time 0.212 (0.227) data 0.091 (0.102) loss_x loss_x 0.8003 (0.7825) acc_x 84.3750 (78.9583) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 596
clean true:592
clean false:4
clean_rate:0.9932885906040269
noisy true:555
noisy false:449
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1004
epoch [22/200] batch [5/18] time 0.237 (0.233) data 0.113 (0.108) loss_x loss_x 0.5425 (0.7553) acc_x 84.3750 (79.3750) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/18] time 0.233 (0.234) data 0.107 (0.108) loss_x loss_x 0.7812 (0.8567) acc_x 84.3750 (75.9375) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/18] time 0.247 (0.233) data 0.121 (0.107) loss_x loss_x 0.2676 (0.8443) acc_x 93.7500 (77.7083) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.3594, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 575
clean true:574
clean false:1
clean_rate:0.9982608695652174
noisy true:562
noisy false:463
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1025
epoch [23/200] batch [5/17] time 0.213 (0.228) data 0.136 (0.113) loss_x loss_x 0.3518 (0.7723) acc_x 87.5000 (80.0000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/17] time 0.242 (0.221) data 0.120 (0.111) loss_x loss_x 0.7925 (0.7730) acc_x 81.2500 (80.3125) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/17] time 0.213 (0.224) data 0.089 (0.109) loss_x loss_x 0.8491 (0.7385) acc_x 81.2500 (81.2500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 604
clean true:599
clean false:5
clean_rate:0.9917218543046358
noisy true:574
noisy false:422
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 996
epoch [24/200] batch [5/18] time 0.184 (0.217) data 0.108 (0.113) loss_x loss_x 0.6445 (0.7104) acc_x 81.2500 (82.5000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/18] time 0.239 (0.226) data 0.115 (0.111) loss_x loss_x 0.6011 (0.7001) acc_x 81.2500 (81.2500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/18] time 0.221 (0.227) data 0.097 (0.109) loss_x loss_x 0.8755 (0.7058) acc_x 84.3750 (82.2917) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 591
clean true:590
clean false:1
clean_rate:0.9983079526226735
noisy true:566
noisy false:443
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1009
epoch [25/200] batch [5/18] time 0.220 (0.215) data 0.099 (0.097) loss_x loss_x 0.6616 (0.5737) acc_x 81.2500 (83.1250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/18] time 0.215 (0.218) data 0.092 (0.097) loss_x loss_x 0.7227 (0.5808) acc_x 81.2500 (83.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/18] time 0.221 (0.220) data 0.100 (0.099) loss_x loss_x 0.5386 (0.5730) acc_x 84.3750 (83.9583) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.3662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 586
clean true:581
clean false:5
clean_rate:0.9914675767918089
noisy true:568
noisy false:446
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1014
epoch [26/200] batch [5/18] time 0.232 (0.228) data 0.109 (0.112) loss_x loss_x 0.4609 (0.5517) acc_x 84.3750 (84.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/18] time 0.227 (0.229) data 0.104 (0.109) loss_x loss_x 0.6538 (0.6025) acc_x 78.1250 (82.8125) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/18] time 0.234 (0.231) data 0.106 (0.110) loss_x loss_x 0.6133 (0.6424) acc_x 81.2500 (82.0833) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 600
clean true:593
clean false:7
clean_rate:0.9883333333333333
noisy true:559
noisy false:441
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1000
epoch [27/200] batch [5/18] time 0.238 (0.207) data 0.115 (0.108) loss_x loss_x 0.4314 (0.6758) acc_x 84.3750 (81.8750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/18] time 0.228 (0.220) data 0.104 (0.108) loss_x loss_x 0.8647 (0.6727) acc_x 81.2500 (81.5625) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/18] time 0.230 (0.224) data 0.106 (0.108) loss_x loss_x 0.4504 (0.7636) acc_x 81.2500 (79.7917) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 599
clean true:595
clean false:4
clean_rate:0.993322203672788
noisy true:563
noisy false:438
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1001
epoch [28/200] batch [5/18] time 0.231 (0.225) data 0.105 (0.100) loss_x loss_x 0.9072 (0.8506) acc_x 78.1250 (75.0000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/18] time 0.208 (0.227) data 0.083 (0.102) loss_x loss_x 0.7686 (0.7402) acc_x 75.0000 (78.1250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/18] time 0.227 (0.225) data 0.099 (0.099) loss_x loss_x 0.3516 (0.6609) acc_x 93.7500 (80.8333) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 592
clean true:589
clean false:3
clean_rate:0.9949324324324325
noisy true:591
noisy false:417
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1008
epoch [29/200] batch [5/18] time 0.234 (0.203) data 0.111 (0.102) loss_x loss_x 0.8618 (0.7638) acc_x 75.0000 (81.2500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/18] time 0.229 (0.216) data 0.105 (0.104) loss_x loss_x 0.5894 (0.7476) acc_x 87.5000 (82.1875) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/18] time 0.227 (0.221) data 0.107 (0.105) loss_x loss_x 0.7178 (0.7199) acc_x 84.3750 (83.3333) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 599
clean true:599
clean false:0
clean_rate:1.0
noisy true:584
noisy false:417
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1001
epoch [30/200] batch [5/18] time 0.242 (0.241) data 0.118 (0.117) loss_x loss_x 0.3745 (0.3945) acc_x 90.6250 (91.2500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/18] time 0.228 (0.236) data 0.106 (0.113) loss_x loss_x 1.1816 (0.5478) acc_x 78.1250 (87.1875) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/18] time 0.181 (0.228) data 0.105 (0.108) loss_x loss_x 0.6724 (0.5801) acc_x 87.5000 (85.8333) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 596
clean true:593
clean false:3
clean_rate:0.9949664429530202
noisy true:557
noisy false:447
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1004
epoch [31/200] batch [5/18] time 0.230 (0.240) data 0.105 (0.115) loss_x loss_x 0.5967 (0.6824) acc_x 87.5000 (82.5000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/18] time 0.231 (0.236) data 0.106 (0.111) loss_x loss_x 1.0244 (0.7474) acc_x 81.2500 (82.5000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/18] time 0.245 (0.236) data 0.118 (0.112) loss_x loss_x 0.7036 (0.7152) acc_x 81.2500 (81.8750) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 599
clean true:596
clean false:3
clean_rate:0.994991652754591
noisy true:588
noisy false:413
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1001
epoch [32/200] batch [5/18] time 0.233 (0.242) data 0.108 (0.118) loss_x loss_x 0.5259 (0.6224) acc_x 90.6250 (81.8750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/18] time 0.227 (0.236) data 0.102 (0.112) loss_x loss_x 0.8228 (0.6559) acc_x 78.1250 (81.5625) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/18] time 0.210 (0.232) data 0.088 (0.108) loss_x loss_x 0.7085 (0.6848) acc_x 84.3750 (81.0417) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 601
clean true:597
clean false:4
clean_rate:0.9933444259567388
noisy true:579
noisy false:420
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 999
epoch [33/200] batch [5/18] time 0.230 (0.229) data 0.104 (0.104) loss_x loss_x 0.6748 (0.7794) acc_x 84.3750 (80.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/18] time 0.233 (0.232) data 0.112 (0.108) loss_x loss_x 0.7466 (0.7670) acc_x 87.5000 (80.0000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/18] time 0.225 (0.228) data 0.102 (0.108) loss_x loss_x 0.8584 (0.7599) acc_x 65.6250 (79.3750) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 627
clean true:621
clean false:6
clean_rate:0.9904306220095693
noisy true:561
noisy false:412
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 973
epoch [34/200] batch [5/19] time 0.223 (0.239) data 0.099 (0.114) loss_x loss_x 0.4075 (0.7042) acc_x 90.6250 (81.2500) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/19] time 0.227 (0.234) data 0.098 (0.108) loss_x loss_x 0.7290 (0.7579) acc_x 78.1250 (80.3125) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/19] time 0.232 (0.234) data 0.108 (0.108) loss_x loss_x 0.3921 (0.7420) acc_x 90.6250 (80.4167) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 604
clean true:601
clean false:3
clean_rate:0.9950331125827815
noisy true:554
noisy false:442
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 996
epoch [35/200] batch [5/18] time 0.246 (0.247) data 0.124 (0.122) loss_x loss_x 0.4495 (0.7739) acc_x 87.5000 (79.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/18] time 0.230 (0.239) data 0.104 (0.114) loss_x loss_x 0.5879 (0.6617) acc_x 78.1250 (81.5625) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/18] time 0.227 (0.233) data 0.105 (0.112) loss_x loss_x 0.7705 (0.6774) acc_x 78.1250 (81.4583) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 608
clean true:606
clean false:2
clean_rate:0.9967105263157895
noisy true:555
noisy false:437
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 992
epoch [36/200] batch [5/19] time 0.218 (0.228) data 0.095 (0.109) loss_x loss_x 0.8721 (0.5407) acc_x 78.1250 (85.0000) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/19] time 0.250 (0.233) data 0.123 (0.111) loss_x loss_x 0.4487 (0.5750) acc_x 84.3750 (83.1250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/19] time 0.214 (0.228) data 0.090 (0.105) loss_x loss_x 0.5088 (0.5803) acc_x 84.3750 (83.1250) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 583
clean true:581
clean false:2
clean_rate:0.9965694682675815
noisy true:581
noisy false:436
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1017
epoch [37/200] batch [5/18] time 0.226 (0.223) data 0.103 (0.100) loss_x loss_x 0.7095 (0.8400) acc_x 81.2500 (77.5000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/18] time 0.221 (0.225) data 0.100 (0.102) loss_x loss_x 0.3687 (0.7288) acc_x 87.5000 (79.6875) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/18] time 0.202 (0.222) data 0.112 (0.101) loss_x loss_x 0.3098 (0.6940) acc_x 93.7500 (81.6667) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 607
clean true:601
clean false:6
clean_rate:0.9901153212520593
noisy true:569
noisy false:424
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 993
epoch [38/200] batch [5/18] time 0.230 (0.239) data 0.107 (0.120) loss_x loss_x 0.6274 (0.7259) acc_x 75.0000 (81.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/18] time 0.232 (0.235) data 0.110 (0.114) loss_x loss_x 0.7241 (0.7512) acc_x 81.2500 (81.2500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/18] time 0.225 (0.232) data 0.103 (0.110) loss_x loss_x 0.4810 (0.7545) acc_x 84.3750 (80.8333) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 601
clean true:597
clean false:4
clean_rate:0.9933444259567388
noisy true:574
noisy false:425
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 999
epoch [39/200] batch [5/18] time 0.229 (0.231) data 0.105 (0.107) loss_x loss_x 0.7793 (0.5794) acc_x 84.3750 (86.2500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/18] time 0.229 (0.229) data 0.107 (0.106) loss_x loss_x 0.9707 (0.6167) acc_x 90.6250 (85.3125) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/18] time 0.228 (0.230) data 0.103 (0.106) loss_x loss_x 0.9194 (0.5676) acc_x 81.2500 (87.0833) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 597
clean true:595
clean false:2
clean_rate:0.9966499162479062
noisy true:571
noisy false:432
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1003
epoch [40/200] batch [5/18] time 0.211 (0.215) data 0.086 (0.090) loss_x loss_x 0.6768 (0.6401) acc_x 81.2500 (84.3750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/18] time 0.228 (0.218) data 0.103 (0.093) loss_x loss_x 0.6362 (0.7161) acc_x 87.5000 (82.8125) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/18] time 0.232 (0.218) data 0.104 (0.094) loss_x loss_x 0.3442 (0.6945) acc_x 90.6250 (82.2917) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 600
clean true:594
clean false:6
clean_rate:0.99
noisy true:559
noisy false:441
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1000
epoch [41/200] batch [5/18] time 0.236 (0.235) data 0.111 (0.109) loss_x loss_x 1.0127 (0.7027) acc_x 71.8750 (81.8750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/18] time 0.225 (0.226) data 0.103 (0.103) loss_x loss_x 0.4043 (0.6636) acc_x 87.5000 (83.1250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/18] time 0.215 (0.225) data 0.092 (0.101) loss_x loss_x 0.3171 (0.6242) acc_x 93.7500 (83.9583) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 597
clean true:594
clean false:3
clean_rate:0.9949748743718593
noisy true:560
noisy false:443
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1003
epoch [42/200] batch [5/18] time 0.260 (0.248) data 0.134 (0.122) loss_x loss_x 0.5288 (0.5640) acc_x 84.3750 (84.3750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/18] time 0.221 (0.238) data 0.095 (0.112) loss_x loss_x 0.7759 (0.5951) acc_x 78.1250 (83.4375) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/18] time 0.225 (0.234) data 0.098 (0.108) loss_x loss_x 0.5049 (0.5871) acc_x 90.6250 (84.5833) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 608
clean true:606
clean false:2
clean_rate:0.9967105263157895
noisy true:560
noisy false:432
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 992
epoch [43/200] batch [5/19] time 0.210 (0.235) data 0.085 (0.111) loss_x loss_x 0.7300 (0.8403) acc_x 81.2500 (76.8750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/19] time 0.233 (0.236) data 0.109 (0.112) loss_x loss_x 0.8276 (0.7528) acc_x 81.2500 (79.3750) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/19] time 0.241 (0.232) data 0.106 (0.112) loss_x loss_x 0.5444 (0.7167) acc_x 84.3750 (81.0417) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 601
clean true:599
clean false:2
clean_rate:0.9966722129783694
noisy true:557
noisy false:442
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 999
epoch [44/200] batch [5/18] time 0.231 (0.236) data 0.107 (0.110) loss_x loss_x 0.5010 (0.5445) acc_x 84.3750 (86.2500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/18] time 0.233 (0.235) data 0.109 (0.110) loss_x loss_x 0.5508 (0.5745) acc_x 87.5000 (86.2500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/18] time 0.302 (0.238) data 0.177 (0.114) loss_x loss_x 0.7993 (0.5925) acc_x 81.2500 (85.6250) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 599
clean true:595
clean false:4
clean_rate:0.993322203672788
noisy true:565
noisy false:436
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1001
epoch [45/200] batch [5/18] time 0.231 (0.254) data 0.107 (0.130) loss_x loss_x 0.7197 (0.6647) acc_x 81.2500 (83.1250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/18] time 0.227 (0.241) data 0.105 (0.118) loss_x loss_x 0.4514 (0.6203) acc_x 90.6250 (84.3750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/18] time 0.208 (0.235) data 0.084 (0.111) loss_x loss_x 1.0957 (0.6477) acc_x 75.0000 (83.3333) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.3875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 620
clean true:619
clean false:1
clean_rate:0.9983870967741936
noisy true:558
noisy false:422
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 980
epoch [46/200] batch [5/19] time 0.228 (0.219) data 0.103 (0.101) loss_x loss_x 0.5815 (0.5042) acc_x 78.1250 (81.8750) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/19] time 0.232 (0.223) data 0.108 (0.102) loss_x loss_x 0.9067 (0.5624) acc_x 71.8750 (81.5625) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/19] time 0.228 (0.225) data 0.107 (0.104) loss_x loss_x 0.6787 (0.6213) acc_x 84.3750 (81.2500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 603
clean true:599
clean false:4
clean_rate:0.9933665008291874
noisy true:565
noisy false:432
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 997
epoch [47/200] batch [5/18] time 0.256 (0.236) data 0.131 (0.112) loss_x loss_x 0.7173 (0.6788) acc_x 81.2500 (79.3750) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/18] time 0.232 (0.233) data 0.105 (0.109) loss_x loss_x 0.6748 (0.7107) acc_x 84.3750 (78.1250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/18] time 0.231 (0.233) data 0.105 (0.108) loss_x loss_x 0.4602 (0.6423) acc_x 90.6250 (81.4583) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:625
clean false:6
clean_rate:0.9904912836767037
noisy true:571
noisy false:398
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [48/200] batch [5/19] time 0.229 (0.233) data 0.103 (0.108) loss_x loss_x 0.7100 (0.8244) acc_x 78.1250 (77.5000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/19] time 0.227 (0.232) data 0.105 (0.107) loss_x loss_x 0.5396 (0.7064) acc_x 84.3750 (81.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/19] time 0.179 (0.229) data 0.103 (0.108) loss_x loss_x 0.6602 (0.6930) acc_x 81.2500 (80.8333) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 621
clean true:618
clean false:3
clean_rate:0.9951690821256038
noisy true:576
noisy false:403
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 979
epoch [49/200] batch [5/19] time 0.226 (0.228) data 0.103 (0.104) loss_x loss_x 0.8164 (0.5610) acc_x 78.1250 (85.6250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/19] time 0.211 (0.229) data 0.087 (0.106) loss_x loss_x 0.8071 (0.5732) acc_x 78.1250 (85.0000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/19] time 0.233 (0.228) data 0.109 (0.105) loss_x loss_x 0.5146 (0.6264) acc_x 78.1250 (83.5417) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:620
clean false:4
clean_rate:0.9935897435897436
noisy true:549
noisy false:427
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [50/200] batch [5/19] time 0.215 (0.221) data 0.091 (0.099) loss_x loss_x 0.5176 (0.6360) acc_x 90.6250 (83.1250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/19] time 0.264 (0.225) data 0.138 (0.102) loss_x loss_x 0.7803 (0.6113) acc_x 81.2500 (83.4375) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/19] time 0.249 (0.227) data 0.121 (0.103) loss_x loss_x 0.9937 (0.6968) acc_x 68.7500 (81.0417) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 617
clean true:613
clean false:4
clean_rate:0.993517017828201
noisy true:566
noisy false:417
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 983
epoch [51/200] batch [5/19] time 0.233 (0.237) data 0.109 (0.113) loss_x loss_x 0.8638 (0.6042) acc_x 84.3750 (86.2500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/19] time 0.218 (0.231) data 0.095 (0.107) loss_x loss_x 0.6357 (0.6806) acc_x 81.2500 (82.1875) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/19] time 0.216 (0.229) data 0.091 (0.105) loss_x loss_x 1.1582 (0.7510) acc_x 71.8750 (80.6250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 605
clean true:601
clean false:4
clean_rate:0.9933884297520661
noisy true:561
noisy false:434
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 995
epoch [52/200] batch [5/18] time 0.227 (0.260) data 0.105 (0.132) loss_x loss_x 0.2827 (0.5126) acc_x 90.6250 (85.6250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/18] time 0.228 (0.258) data 0.103 (0.132) loss_x loss_x 0.8311 (0.6323) acc_x 81.2500 (82.1875) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/18] time 0.171 (0.244) data 0.090 (0.122) loss_x loss_x 0.6543 (0.6495) acc_x 71.8750 (81.0417) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 605
clean true:601
clean false:4
clean_rate:0.9933884297520661
noisy true:589
noisy false:406
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 995
epoch [53/200] batch [5/18] time 0.212 (0.229) data 0.089 (0.105) loss_x loss_x 0.7686 (0.8086) acc_x 81.2500 (79.3750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/18] time 0.226 (0.228) data 0.105 (0.105) loss_x loss_x 0.9209 (0.7248) acc_x 78.1250 (81.2500) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/18] time 0.225 (0.227) data 0.102 (0.104) loss_x loss_x 1.0010 (0.7146) acc_x 71.8750 (80.4167) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.3931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 629
clean true:626
clean false:3
clean_rate:0.9952305246422893
noisy true:582
noisy false:389
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 971
epoch [54/200] batch [5/19] time 0.218 (0.230) data 0.093 (0.105) loss_x loss_x 0.8682 (0.6860) acc_x 78.1250 (81.2500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/19] time 0.184 (0.217) data 0.108 (0.104) loss_x loss_x 0.7026 (0.6756) acc_x 75.0000 (81.5625) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/19] time 0.217 (0.227) data 0.095 (0.107) loss_x loss_x 0.4507 (0.6158) acc_x 90.6250 (82.9167) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 611
clean true:608
clean false:3
clean_rate:0.9950900163666121
noisy true:556
noisy false:433
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 989
epoch [55/200] batch [5/19] time 0.229 (0.259) data 0.106 (0.127) loss_x loss_x 0.3342 (0.5464) acc_x 84.3750 (84.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/19] time 0.228 (0.246) data 0.103 (0.118) loss_x loss_x 1.0352 (0.6192) acc_x 75.0000 (84.3750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/19] time 0.242 (0.243) data 0.119 (0.116) loss_x loss_x 0.6006 (0.5703) acc_x 84.3750 (85.6250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 607
clean true:603
clean false:4
clean_rate:0.9934102141680395
noisy true:571
noisy false:422
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 993
epoch [56/200] batch [5/18] time 0.220 (0.228) data 0.093 (0.109) loss_x loss_x 0.5386 (0.6916) acc_x 87.5000 (81.8750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/18] time 0.230 (0.228) data 0.107 (0.107) loss_x loss_x 0.2881 (0.6092) acc_x 87.5000 (83.7500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/18] time 0.234 (0.230) data 0.110 (0.108) loss_x loss_x 0.4597 (0.6138) acc_x 87.5000 (83.9583) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.3912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 626
clean true:622
clean false:4
clean_rate:0.9936102236421726
noisy true:577
noisy false:397
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 974
epoch [57/200] batch [5/19] time 0.220 (0.221) data 0.093 (0.096) loss_x loss_x 0.5327 (0.6095) acc_x 84.3750 (83.7500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/19] time 0.265 (0.229) data 0.141 (0.105) loss_x loss_x 0.4224 (0.6523) acc_x 87.5000 (83.4375) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/19] time 0.238 (0.228) data 0.113 (0.104) loss_x loss_x 0.5747 (0.6655) acc_x 84.3750 (83.3333) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:625
clean false:6
clean_rate:0.9904912836767037
noisy true:558
noisy false:411
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [58/200] batch [5/19] time 0.252 (0.228) data 0.127 (0.104) loss_x loss_x 0.9551 (0.7417) acc_x 75.0000 (80.6250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/19] time 0.213 (0.229) data 0.089 (0.103) loss_x loss_x 0.5122 (0.8205) acc_x 84.3750 (79.3750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/19] time 0.171 (0.221) data 0.094 (0.102) loss_x loss_x 0.7627 (0.7486) acc_x 78.1250 (81.2500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 623
clean true:620
clean false:3
clean_rate:0.9951845906902087
noisy true:559
noisy false:418
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 977
epoch [59/200] batch [5/19] time 0.216 (0.223) data 0.089 (0.097) loss_x loss_x 0.6265 (0.6916) acc_x 78.1250 (80.6250) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/19] time 0.227 (0.226) data 0.102 (0.101) loss_x loss_x 0.2196 (0.6423) acc_x 100.0000 (82.8125) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/19] time 0.221 (0.226) data 0.095 (0.101) loss_x loss_x 0.5269 (0.6574) acc_x 84.3750 (82.9167) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.3912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 626
clean true:623
clean false:3
clean_rate:0.9952076677316294
noisy true:579
noisy false:395
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 974
epoch [60/200] batch [5/19] time 0.224 (0.224) data 0.100 (0.098) loss_x loss_x 0.9961 (0.6646) acc_x 78.1250 (85.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/19] time 0.218 (0.226) data 0.093 (0.101) loss_x loss_x 0.5464 (0.6510) acc_x 81.2500 (83.4375) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/19] time 0.231 (0.227) data 0.105 (0.102) loss_x loss_x 0.3123 (0.6652) acc_x 90.6250 (82.7083) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 616
clean true:614
clean false:2
clean_rate:0.9967532467532467
noisy true:570
noisy false:414
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 984
epoch [61/200] batch [5/19] time 0.212 (0.219) data 0.086 (0.095) loss_x loss_x 0.7031 (0.6078) acc_x 78.1250 (83.1250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/19] time 0.205 (0.219) data 0.105 (0.100) loss_x loss_x 0.9077 (0.6130) acc_x 78.1250 (84.0625) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/19] time 0.231 (0.223) data 0.108 (0.102) loss_x loss_x 0.8032 (0.6016) acc_x 78.1250 (84.1667) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.4006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 641
clean true:637
clean false:4
clean_rate:0.9937597503900156
noisy true:545
noisy false:414
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 959
epoch [62/200] batch [5/20] time 0.236 (0.240) data 0.109 (0.116) loss_x loss_x 0.4368 (0.5500) acc_x 90.6250 (86.8750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/20] time 0.229 (0.220) data 0.106 (0.105) loss_x loss_x 0.3635 (0.5682) acc_x 87.5000 (86.2500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/20] time 0.226 (0.219) data 0.103 (0.102) loss_x loss_x 0.8457 (0.6189) acc_x 84.3750 (85.6250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/20] time 0.213 (0.219) data 0.091 (0.100) loss_x loss_x 0.5869 (0.5850) acc_x 87.5000 (86.4062) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:635
clean false:3
clean_rate:0.9952978056426333
noisy true:595
noisy false:367
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [63/200] batch [5/19] time 0.226 (0.225) data 0.104 (0.106) loss_x loss_x 0.8560 (0.5908) acc_x 84.3750 (84.3750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/19] time 0.214 (0.230) data 0.088 (0.109) loss_x loss_x 0.5039 (0.6175) acc_x 87.5000 (84.3750) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/19] time 0.230 (0.228) data 0.106 (0.105) loss_x loss_x 1.0293 (0.6339) acc_x 71.8750 (83.3333) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 619
clean true:615
clean false:4
clean_rate:0.9935379644588045
noisy true:565
noisy false:416
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 981
epoch [64/200] batch [5/19] time 0.242 (0.238) data 0.118 (0.115) loss_x loss_x 0.6445 (0.3763) acc_x 78.1250 (88.7500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/19] time 0.218 (0.232) data 0.093 (0.108) loss_x loss_x 0.3787 (0.4581) acc_x 84.3750 (86.5625) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/19] time 0.238 (0.230) data 0.114 (0.106) loss_x loss_x 0.6816 (0.4896) acc_x 84.3750 (86.6667) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 615
clean true:612
clean false:3
clean_rate:0.9951219512195122
noisy true:570
noisy false:415
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 985
epoch [65/200] batch [5/19] time 0.213 (0.211) data 0.091 (0.102) loss_x loss_x 0.6333 (0.4836) acc_x 75.0000 (83.1250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/19] time 0.225 (0.217) data 0.102 (0.101) loss_x loss_x 0.5391 (0.5154) acc_x 84.3750 (84.3750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/19] time 0.230 (0.220) data 0.102 (0.101) loss_x loss_x 0.4958 (0.5479) acc_x 87.5000 (84.3750) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:617
clean false:7
clean_rate:0.9887820512820513
noisy true:575
noisy false:401
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [66/200] batch [5/19] time 0.208 (0.199) data 0.085 (0.095) loss_x loss_x 0.3586 (0.5212) acc_x 90.6250 (86.2500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/19] time 0.215 (0.204) data 0.092 (0.090) loss_x loss_x 0.8325 (0.6528) acc_x 81.2500 (84.3750) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/19] time 0.219 (0.210) data 0.098 (0.094) loss_x loss_x 0.3372 (0.6512) acc_x 90.6250 (84.1667) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.3931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 629
clean true:626
clean false:3
clean_rate:0.9952305246422893
noisy true:570
noisy false:401
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 971
epoch [67/200] batch [5/19] time 0.230 (0.225) data 0.105 (0.097) loss_x loss_x 0.9551 (0.6806) acc_x 84.3750 (82.5000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/19] time 0.221 (0.223) data 0.097 (0.098) loss_x loss_x 0.5674 (0.6608) acc_x 90.6250 (83.7500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/19] time 0.227 (0.224) data 0.103 (0.098) loss_x loss_x 0.6650 (0.6414) acc_x 84.3750 (83.1250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.3894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 623
clean true:619
clean false:4
clean_rate:0.9935794542536116
noisy true:567
noisy false:410
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 977
epoch [68/200] batch [5/19] time 0.232 (0.235) data 0.108 (0.110) loss_x loss_x 1.0254 (0.5825) acc_x 75.0000 (84.3750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/19] time 0.234 (0.235) data 0.108 (0.110) loss_x loss_x 0.5107 (0.5493) acc_x 84.3750 (85.3125) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/19] time 0.205 (0.233) data 0.102 (0.109) loss_x loss_x 1.0273 (0.6091) acc_x 62.5000 (82.9167) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 627
clean true:616
clean false:11
clean_rate:0.9824561403508771
noisy true:563
noisy false:410
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 973
epoch [69/200] batch [5/19] time 0.228 (0.223) data 0.103 (0.099) loss_x loss_x 0.6592 (0.7481) acc_x 78.1250 (78.1250) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/19] time 0.241 (0.225) data 0.116 (0.100) loss_x loss_x 0.7881 (0.8027) acc_x 78.1250 (77.5000) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/19] time 0.223 (0.223) data 0.100 (0.099) loss_x loss_x 1.3037 (0.7721) acc_x 65.6250 (78.3333) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 629
clean true:627
clean false:2
clean_rate:0.9968203497615262
noisy true:553
noisy false:418
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 971
epoch [70/200] batch [5/19] time 0.241 (0.227) data 0.120 (0.111) loss_x loss_x 0.4836 (0.4977) acc_x 84.3750 (85.6250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/19] time 0.246 (0.234) data 0.122 (0.114) loss_x loss_x 0.5532 (0.5030) acc_x 81.2500 (85.3125) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/19] time 0.232 (0.230) data 0.110 (0.109) loss_x loss_x 0.5615 (0.5613) acc_x 87.5000 (85.0000) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:635
clean false:3
clean_rate:0.9952978056426333
noisy true:567
noisy false:395
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [71/200] batch [5/19] time 0.229 (0.239) data 0.107 (0.114) loss_x loss_x 0.7485 (0.6684) acc_x 78.1250 (80.6250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/19] time 0.234 (0.236) data 0.110 (0.111) loss_x loss_x 0.9473 (0.7117) acc_x 75.0000 (81.5625) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/19] time 0.219 (0.237) data 0.097 (0.113) loss_x loss_x 0.7041 (0.7342) acc_x 81.2500 (80.6250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 628
clean true:625
clean false:3
clean_rate:0.9952229299363057
noisy true:582
noisy false:390
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 972
epoch [72/200] batch [5/19] time 0.215 (0.220) data 0.091 (0.101) loss_x loss_x 0.7876 (0.6570) acc_x 81.2500 (83.7500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/19] time 0.265 (0.226) data 0.140 (0.104) loss_x loss_x 1.0029 (0.7278) acc_x 78.1250 (80.9375) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/19] time 0.237 (0.227) data 0.114 (0.105) loss_x loss_x 0.8057 (0.7329) acc_x 81.2500 (81.6667) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 628
clean true:624
clean false:4
clean_rate:0.9936305732484076
noisy true:580
noisy false:392
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 972
epoch [73/200] batch [5/19] time 0.243 (0.223) data 0.120 (0.118) loss_x loss_x 0.8037 (0.7056) acc_x 78.1250 (85.0000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/19] time 0.224 (0.231) data 0.102 (0.118) loss_x loss_x 0.7012 (0.6239) acc_x 75.0000 (84.3750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/19] time 0.232 (0.231) data 0.106 (0.115) loss_x loss_x 0.7720 (0.5909) acc_x 78.1250 (85.2083) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.3950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 632
clean true:629
clean false:3
clean_rate:0.995253164556962
noisy true:583
noisy false:385
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 968
epoch [74/200] batch [5/19] time 0.248 (0.229) data 0.126 (0.112) loss_x loss_x 0.5928 (0.6251) acc_x 78.1250 (83.1250) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/19] time 0.230 (0.229) data 0.104 (0.109) loss_x loss_x 0.2993 (0.6324) acc_x 93.7500 (84.6875) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/19] time 0.272 (0.229) data 0.105 (0.108) loss_x loss_x 0.8550 (0.6248) acc_x 75.0000 (84.3750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.3950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 632
clean true:628
clean false:4
clean_rate:0.9936708860759493
noisy true:569
noisy false:399
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 968
epoch [75/200] batch [5/19] time 0.219 (0.224) data 0.094 (0.106) loss_x loss_x 0.5122 (0.5845) acc_x 93.7500 (86.2500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/19] time 0.234 (0.223) data 0.110 (0.102) loss_x loss_x 0.4766 (0.6120) acc_x 87.5000 (85.3125) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/19] time 0.219 (0.224) data 0.092 (0.102) loss_x loss_x 1.2539 (0.6511) acc_x 68.7500 (83.7500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:630
clean false:8
clean_rate:0.987460815047022
noisy true:572
noisy false:390
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [76/200] batch [5/19] time 0.235 (0.235) data 0.112 (0.112) loss_x loss_x 0.6528 (0.4641) acc_x 87.5000 (88.1250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/19] time 0.229 (0.240) data 0.106 (0.119) loss_x loss_x 0.4827 (0.5799) acc_x 87.5000 (86.2500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/19] time 0.246 (0.237) data 0.123 (0.115) loss_x loss_x 0.6885 (0.5846) acc_x 78.1250 (85.4167) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 637
clean true:634
clean false:3
clean_rate:0.9952904238618524
noisy true:554
noisy false:409
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 963
epoch [77/200] batch [5/19] time 0.227 (0.246) data 0.102 (0.120) loss_x loss_x 0.7271 (0.6362) acc_x 84.3750 (83.7500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/19] time 0.216 (0.237) data 0.092 (0.112) loss_x loss_x 0.5107 (0.5735) acc_x 87.5000 (85.6250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/19] time 0.232 (0.236) data 0.105 (0.111) loss_x loss_x 0.7822 (0.5316) acc_x 84.3750 (86.8750) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 645
clean true:637
clean false:8
clean_rate:0.9875968992248062
noisy true:565
noisy false:390
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 955
epoch [78/200] batch [5/20] time 0.212 (0.203) data 0.089 (0.098) loss_x loss_x 0.2155 (0.5217) acc_x 96.8750 (86.2500) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/20] time 0.232 (0.215) data 0.106 (0.100) loss_x loss_x 1.0420 (0.5870) acc_x 68.7500 (86.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/20] time 0.224 (0.218) data 0.104 (0.101) loss_x loss_x 0.3066 (0.5959) acc_x 90.6250 (86.2500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/20] time 0.240 (0.220) data 0.114 (0.101) loss_x loss_x 0.6396 (0.6350) acc_x 84.3750 (85.1562) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 619
clean true:615
clean false:4
clean_rate:0.9935379644588045
noisy true:576
noisy false:405
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 981
epoch [79/200] batch [5/19] time 0.232 (0.232) data 0.104 (0.107) loss_x loss_x 0.7173 (0.6804) acc_x 84.3750 (80.6250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/19] time 0.214 (0.231) data 0.090 (0.107) loss_x loss_x 0.4089 (0.5653) acc_x 87.5000 (84.3750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/19] time 0.221 (0.229) data 0.095 (0.104) loss_x loss_x 0.4009 (0.5321) acc_x 90.6250 (84.7917) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 626
clean true:623
clean false:3
clean_rate:0.9952076677316294
noisy true:559
noisy false:415
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 974
epoch [80/200] batch [5/19] time 0.228 (0.240) data 0.107 (0.116) loss_x loss_x 0.6880 (0.4875) acc_x 84.3750 (87.5000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/19] time 0.229 (0.237) data 0.106 (0.113) loss_x loss_x 0.3235 (0.4803) acc_x 96.8750 (88.1250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/19] time 0.229 (0.233) data 0.103 (0.111) loss_x loss_x 0.7920 (0.5758) acc_x 81.2500 (85.2083) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 626
clean true:622
clean false:4
clean_rate:0.9936102236421726
noisy true:576
noisy false:398
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 974
epoch [81/200] batch [5/19] time 0.226 (0.227) data 0.104 (0.116) loss_x loss_x 0.5737 (0.4647) acc_x 84.3750 (90.0000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/19] time 0.235 (0.229) data 0.111 (0.112) loss_x loss_x 0.6001 (0.5170) acc_x 90.6250 (87.8125) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/19] time 0.232 (0.230) data 0.103 (0.110) loss_x loss_x 0.3882 (0.5693) acc_x 90.6250 (86.0417) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:621
clean false:3
clean_rate:0.9951923076923077
noisy true:584
noisy false:392
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [82/200] batch [5/19] time 0.234 (0.247) data 0.111 (0.122) loss_x loss_x 0.4568 (0.5214) acc_x 87.5000 (85.6250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/19] time 0.236 (0.243) data 0.108 (0.118) loss_x loss_x 0.8545 (0.5752) acc_x 71.8750 (84.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/19] time 0.235 (0.242) data 0.113 (0.117) loss_x loss_x 0.5312 (0.5461) acc_x 87.5000 (85.4167) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:633
clean false:3
clean_rate:0.9952830188679245
noisy true:576
noisy false:388
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [83/200] batch [5/19] time 0.269 (0.239) data 0.146 (0.116) loss_x loss_x 0.4243 (0.6565) acc_x 81.2500 (82.5000) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/19] time 0.223 (0.234) data 0.098 (0.111) loss_x loss_x 0.4490 (0.5608) acc_x 90.6250 (85.3125) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/19] time 0.234 (0.234) data 0.112 (0.111) loss_x loss_x 0.5156 (0.5895) acc_x 90.6250 (84.7917) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:633
clean false:3
clean_rate:0.9952830188679245
noisy true:556
noisy false:408
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [84/200] batch [5/19] time 0.232 (0.235) data 0.107 (0.110) loss_x loss_x 0.7036 (0.5842) acc_x 81.2500 (84.3750) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/19] time 0.230 (0.236) data 0.107 (0.111) loss_x loss_x 0.6206 (0.5667) acc_x 84.3750 (84.6875) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/19] time 0.245 (0.234) data 0.121 (0.110) loss_x loss_x 0.5542 (0.5622) acc_x 81.2500 (85.2083) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.3931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 629
clean true:626
clean false:3
clean_rate:0.9952305246422893
noisy true:583
noisy false:388
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 971
epoch [85/200] batch [5/19] time 0.209 (0.236) data 0.086 (0.113) loss_x loss_x 0.8848 (0.7352) acc_x 78.1250 (83.7500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/19] time 0.224 (0.230) data 0.100 (0.106) loss_x loss_x 0.6445 (0.6819) acc_x 81.2500 (84.0625) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/19] time 0.208 (0.226) data 0.085 (0.102) loss_x loss_x 0.7520 (0.6276) acc_x 87.5000 (85.6250) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:631
clean false:5
clean_rate:0.9921383647798742
noisy true:568
noisy false:396
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [86/200] batch [5/19] time 0.233 (0.242) data 0.107 (0.119) loss_x loss_x 0.4412 (0.7323) acc_x 87.5000 (81.8750) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/19] time 0.183 (0.233) data 0.107 (0.114) loss_x loss_x 1.0322 (0.6991) acc_x 81.2500 (83.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/19] time 0.232 (0.230) data 0.110 (0.112) loss_x loss_x 0.1945 (0.6594) acc_x 93.7500 (83.3333) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 639
clean true:635
clean false:4
clean_rate:0.9937402190923318
noisy true:556
noisy false:405
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 961
epoch [87/200] batch [5/19] time 0.216 (0.227) data 0.092 (0.101) loss_x loss_x 0.3428 (0.5440) acc_x 90.6250 (87.5000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/19] time 0.177 (0.215) data 0.100 (0.100) loss_x loss_x 0.5786 (0.5857) acc_x 90.6250 (86.2500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/19] time 0.228 (0.220) data 0.105 (0.103) loss_x loss_x 0.6904 (0.6040) acc_x 84.3750 (85.0000) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.3962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 634
clean true:628
clean false:6
clean_rate:0.9905362776025236
noisy true:572
noisy false:394
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 966
epoch [88/200] batch [5/19] time 0.226 (0.229) data 0.105 (0.106) loss_x loss_x 0.7769 (0.5290) acc_x 84.3750 (88.1250) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/19] time 0.232 (0.230) data 0.108 (0.107) loss_x loss_x 0.2423 (0.5366) acc_x 93.7500 (88.4375) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/19] time 0.216 (0.230) data 0.089 (0.106) loss_x loss_x 0.4919 (0.5722) acc_x 87.5000 (87.2917) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:623
clean false:1
clean_rate:0.9983974358974359
noisy true:575
noisy false:401
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [89/200] batch [5/19] time 0.187 (0.221) data 0.110 (0.107) loss_x loss_x 0.3860 (0.4965) acc_x 90.6250 (85.0000) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/19] time 0.243 (0.229) data 0.118 (0.110) loss_x loss_x 0.5015 (0.4989) acc_x 81.2500 (85.9375) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/19] time 0.240 (0.231) data 0.117 (0.110) loss_x loss_x 0.1962 (0.5114) acc_x 96.8750 (85.6250) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:648
clean false:5
clean_rate:0.9923430321592649
noisy true:571
noisy false:376
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [90/200] batch [5/20] time 0.248 (0.240) data 0.124 (0.128) loss_x loss_x 0.3845 (0.6607) acc_x 90.6250 (86.2500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/20] time 0.230 (0.236) data 0.106 (0.118) loss_x loss_x 0.6401 (0.6168) acc_x 87.5000 (85.6250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/20] time 0.230 (0.234) data 0.105 (0.114) loss_x loss_x 0.6050 (0.7126) acc_x 84.3750 (83.9583) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/20] time 0.240 (0.234) data 0.114 (0.113) loss_x loss_x 0.6704 (0.6837) acc_x 78.1250 (83.5938) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:642
clean false:6
clean_rate:0.9907407407407407
noisy true:574
noisy false:378
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [91/200] batch [5/20] time 0.228 (0.230) data 0.104 (0.106) loss_x loss_x 0.8730 (0.6402) acc_x 78.1250 (85.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/20] time 0.230 (0.231) data 0.107 (0.108) loss_x loss_x 1.0078 (0.6964) acc_x 68.7500 (80.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/20] time 0.231 (0.232) data 0.104 (0.108) loss_x loss_x 0.7451 (0.7155) acc_x 78.1250 (80.8333) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/20] time 0.190 (0.228) data 0.113 (0.109) loss_x loss_x 0.6509 (0.6716) acc_x 75.0000 (81.4062) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:626
clean false:5
clean_rate:0.9920760697305864
noisy true:575
noisy false:394
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [92/200] batch [5/19] time 0.228 (0.237) data 0.103 (0.114) loss_x loss_x 0.8560 (0.6556) acc_x 78.1250 (83.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/19] time 0.228 (0.235) data 0.105 (0.111) loss_x loss_x 0.4829 (0.6403) acc_x 93.7500 (83.4375) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/19] time 0.224 (0.231) data 0.099 (0.108) loss_x loss_x 0.9053 (0.6636) acc_x 75.0000 (83.1250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.3994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 639
clean true:637
clean false:2
clean_rate:0.9968701095461658
noisy true:562
noisy false:399
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 961
epoch [93/200] batch [5/19] time 0.234 (0.228) data 0.107 (0.114) loss_x loss_x 0.5107 (0.4788) acc_x 87.5000 (86.8750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/19] time 0.229 (0.229) data 0.107 (0.110) loss_x loss_x 0.2939 (0.4594) acc_x 96.8750 (87.5000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/19] time 0.225 (0.230) data 0.103 (0.110) loss_x loss_x 1.0830 (0.5630) acc_x 78.1250 (85.0000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:636
clean false:2
clean_rate:0.9968652037617555
noisy true:574
noisy false:388
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [94/200] batch [5/19] time 0.227 (0.228) data 0.103 (0.105) loss_x loss_x 0.4326 (0.4511) acc_x 93.7500 (88.1250) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/19] time 0.253 (0.233) data 0.130 (0.110) loss_x loss_x 0.6250 (0.5686) acc_x 84.3750 (85.6250) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/19] time 0.227 (0.234) data 0.107 (0.111) loss_x loss_x 0.5820 (0.6007) acc_x 78.1250 (83.5417) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:645
clean false:4
clean_rate:0.9938366718027735
noisy true:565
noisy false:386
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [95/200] batch [5/20] time 0.199 (0.235) data 0.112 (0.117) loss_x loss_x 0.7476 (0.5961) acc_x 81.2500 (84.3750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/20] time 0.244 (0.222) data 0.120 (0.106) loss_x loss_x 1.0742 (0.6354) acc_x 71.8750 (82.1875) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/20] time 0.220 (0.221) data 0.097 (0.104) loss_x loss_x 0.7891 (0.6430) acc_x 81.2500 (82.7083) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/20] time 0.223 (0.222) data 0.101 (0.102) loss_x loss_x 0.6172 (0.6371) acc_x 81.2500 (82.5000) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 635
clean true:630
clean false:5
clean_rate:0.9921259842519685
noisy true:562
noisy false:403
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 965
epoch [96/200] batch [5/19] time 0.249 (0.255) data 0.124 (0.130) loss_x loss_x 0.2196 (0.6142) acc_x 96.8750 (81.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/19] time 0.232 (0.243) data 0.107 (0.118) loss_x loss_x 0.2605 (0.6802) acc_x 90.6250 (81.2500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/19] time 0.223 (0.230) data 0.099 (0.113) loss_x loss_x 0.4390 (0.6617) acc_x 87.5000 (82.5000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:642
clean false:6
clean_rate:0.9907407407407407
noisy true:542
noisy false:410
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [97/200] batch [5/20] time 0.225 (0.239) data 0.102 (0.114) loss_x loss_x 0.4258 (0.3843) acc_x 90.6250 (89.3750) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/20] time 0.252 (0.240) data 0.125 (0.115) loss_x loss_x 0.8584 (0.5270) acc_x 78.1250 (85.3125) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/20] time 0.236 (0.238) data 0.111 (0.112) loss_x loss_x 0.6948 (0.5659) acc_x 81.2500 (84.1667) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/20] time 0.220 (0.233) data 0.094 (0.107) loss_x loss_x 0.4895 (0.6167) acc_x 90.6250 (83.9062) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 651
clean true:644
clean false:7
clean_rate:0.989247311827957
noisy true:553
noisy false:396
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 949
epoch [98/200] batch [5/20] time 0.233 (0.229) data 0.109 (0.105) loss_x loss_x 0.5620 (0.6934) acc_x 84.3750 (81.8750) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/20] time 0.238 (0.233) data 0.113 (0.109) loss_x loss_x 0.4385 (0.6580) acc_x 87.5000 (82.8125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/20] time 0.252 (0.233) data 0.129 (0.109) loss_x loss_x 0.7344 (0.6106) acc_x 78.1250 (84.1667) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/20] time 0.229 (0.234) data 0.105 (0.110) loss_x loss_x 0.5947 (0.6070) acc_x 90.6250 (85.0000) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:644
clean false:3
clean_rate:0.9953632148377125
noisy true:575
noisy false:378
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [99/200] batch [5/20] time 0.235 (0.236) data 0.111 (0.113) loss_x loss_x 0.4375 (0.5727) acc_x 87.5000 (85.0000) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/20] time 0.299 (0.240) data 0.175 (0.117) loss_x loss_x 0.4983 (0.5229) acc_x 87.5000 (85.9375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/20] time 0.239 (0.241) data 0.114 (0.117) loss_x loss_x 0.3457 (0.4840) acc_x 87.5000 (86.8750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/20] time 0.232 (0.239) data 0.106 (0.115) loss_x loss_x 0.7124 (0.4864) acc_x 87.5000 (86.8750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:644
clean false:6
clean_rate:0.9907692307692307
noisy true:581
noisy false:369
all clean rate:  [0.9867724867724867, 0.9868995633187773, 0.9881188118811881, 0.9887218045112782, 0.9910071942446043, 0.992831541218638, 0.9892857142857143, 0.9982238010657194, 0.9948453608247423, 0.9878260869565217, 0.9965635738831615, 0.9930675909878682, 0.9964788732394366, 0.9964601769911504, 0.9911347517730497, 0.9893617021276596, 0.9847972972972973, 0.9950248756218906, 0.9931506849315068, 0.9950738916256158, 0.9933333333333333, 0.9932885906040269, 0.9982608695652174, 0.9917218543046358, 0.9983079526226735, 0.9914675767918089, 0.9883333333333333, 0.993322203672788, 0.9949324324324325, 1.0, 0.9949664429530202, 0.994991652754591, 0.9933444259567388, 0.9904306220095693, 0.9950331125827815, 0.9967105263157895, 0.9965694682675815, 0.9901153212520593, 0.9933444259567388, 0.9966499162479062, 0.99, 0.9949748743718593, 0.9967105263157895, 0.9966722129783694, 0.993322203672788, 0.9983870967741936, 0.9933665008291874, 0.9904912836767037, 0.9951690821256038, 0.9935897435897436, 0.993517017828201, 0.9933884297520661, 0.9933884297520661, 0.9952305246422893, 0.9950900163666121, 0.9934102141680395, 0.9936102236421726, 0.9904912836767037, 0.9951845906902087, 0.9952076677316294, 0.9967532467532467, 0.9937597503900156, 0.9952978056426333, 0.9935379644588045, 0.9951219512195122, 0.9887820512820513, 0.9952305246422893, 0.9935794542536116, 0.9824561403508771, 0.9968203497615262, 0.9952978056426333, 0.9952229299363057, 0.9936305732484076, 0.995253164556962, 0.9936708860759493, 0.987460815047022, 0.9952904238618524, 0.9875968992248062, 0.9935379644588045, 0.9952076677316294, 0.9936102236421726, 0.9951923076923077, 0.9952830188679245, 0.9952830188679245, 0.9952305246422893, 0.9921383647798742, 0.9937402190923318, 0.9905362776025236, 0.9983974358974359, 0.9923430321592649, 0.9907407407407407, 0.9920760697305864, 0.9968701095461658, 0.9968652037617555, 0.9938366718027735, 0.9921259842519685, 0.9907407407407407, 0.989247311827957, 0.9953632148377125, 0.9907692307692307]
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [100/200] batch [5/20] time 0.231 (0.225) data 0.105 (0.098) loss_x loss_x 0.2578 (0.5649) acc_x 96.8750 (87.5000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/20] time 0.219 (0.224) data 0.093 (0.098) loss_x loss_x 0.6709 (0.5218) acc_x 75.0000 (85.9375) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/20] time 0.231 (0.214) data 0.101 (0.097) loss_x loss_x 0.4661 (0.6087) acc_x 84.3750 (85.2083) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/20] time 0.267 (0.217) data 0.143 (0.099) loss_x loss_x 0.1890 (0.5586) acc_x 93.7500 (86.0938) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:643
clean false:4
clean_rate:0.9938176197836167
noisy true:573
noisy false:380
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [101/200] batch [5/20] time 0.225 (0.229) data 0.095 (0.102) loss_x loss_x 0.7729 (0.7519) acc_x 87.5000 (82.5000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/20] time 0.220 (0.235) data 0.097 (0.109) loss_x loss_x 0.7070 (0.6756) acc_x 84.3750 (83.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/20] time 0.218 (0.231) data 0.092 (0.105) loss_x loss_x 0.8062 (0.6342) acc_x 81.2500 (85.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/20] time 0.179 (0.227) data 0.103 (0.107) loss_x loss_x 0.3928 (0.6395) acc_x 90.6250 (84.6875) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 645
clean true:639
clean false:6
clean_rate:0.9906976744186047
noisy true:560
noisy false:395
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 955
epoch [102/200] batch [5/20] time 0.229 (0.224) data 0.106 (0.112) loss_x loss_x 1.0215 (0.8129) acc_x 75.0000 (77.5000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/20] time 0.245 (0.230) data 0.119 (0.111) loss_x loss_x 0.4980 (0.7152) acc_x 87.5000 (81.8750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/20] time 0.230 (0.230) data 0.105 (0.110) loss_x loss_x 0.2361 (0.6796) acc_x 87.5000 (83.5417) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/20] time 0.236 (0.232) data 0.113 (0.111) loss_x loss_x 0.4485 (0.6771) acc_x 87.5000 (83.1250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.3981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 637
clean true:634
clean false:3
clean_rate:0.9952904238618524
noisy true:575
noisy false:388
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 963
epoch [103/200] batch [5/19] time 0.221 (0.228) data 0.093 (0.102) loss_x loss_x 0.2583 (0.7474) acc_x 96.8750 (84.3750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/19] time 0.244 (0.232) data 0.115 (0.106) loss_x loss_x 0.3701 (0.6618) acc_x 90.6250 (83.7500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/19] time 0.213 (0.229) data 0.088 (0.103) loss_x loss_x 1.0020 (0.6440) acc_x 71.8750 (83.5417) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:655
clean false:6
clean_rate:0.9909228441754917
noisy true:580
noisy false:359
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [104/200] batch [5/20] time 0.230 (0.242) data 0.108 (0.116) loss_x loss_x 0.7026 (0.5487) acc_x 84.3750 (88.1250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/20] time 0.234 (0.240) data 0.107 (0.114) loss_x loss_x 0.4648 (0.4946) acc_x 84.3750 (86.8750) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/20] time 0.189 (0.232) data 0.111 (0.114) loss_x loss_x 0.3208 (0.4785) acc_x 93.7500 (88.1250) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/20] time 0.229 (0.233) data 0.106 (0.112) loss_x loss_x 0.7612 (0.4927) acc_x 75.0000 (87.1875) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:641
clean false:2
clean_rate:0.9968895800933126
noisy true:600
noisy false:357
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [105/200] batch [5/20] time 0.238 (0.232) data 0.118 (0.108) loss_x loss_x 0.7578 (0.7344) acc_x 68.7500 (79.3750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/20] time 0.239 (0.232) data 0.115 (0.108) loss_x loss_x 0.8413 (0.6609) acc_x 81.2500 (82.8125) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/20] time 0.232 (0.233) data 0.111 (0.109) loss_x loss_x 0.4778 (0.6558) acc_x 84.3750 (83.3333) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/20] time 0.232 (0.230) data 0.107 (0.108) loss_x loss_x 0.3154 (0.6202) acc_x 93.7500 (84.3750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:645
clean false:5
clean_rate:0.9923076923076923
noisy true:571
noisy false:379
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [106/200] batch [5/20] time 0.246 (0.239) data 0.121 (0.114) loss_x loss_x 0.5859 (0.5079) acc_x 87.5000 (87.5000) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/20] time 0.224 (0.233) data 0.100 (0.109) loss_x loss_x 0.8945 (0.6247) acc_x 75.0000 (84.0625) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/20] time 0.226 (0.230) data 0.103 (0.110) loss_x loss_x 0.5811 (0.5879) acc_x 87.5000 (85.0000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/20] time 0.230 (0.228) data 0.105 (0.106) loss_x loss_x 0.4424 (0.6031) acc_x 90.6250 (85.0000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:649
clean false:5
clean_rate:0.9923547400611621
noisy true:559
noisy false:387
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [107/200] batch [5/20] time 0.191 (0.225) data 0.108 (0.108) loss_x loss_x 0.7524 (0.5846) acc_x 81.2500 (85.6250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/20] time 0.213 (0.210) data 0.090 (0.100) loss_x loss_x 0.5967 (0.5723) acc_x 87.5000 (85.3125) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/20] time 0.239 (0.217) data 0.113 (0.102) loss_x loss_x 0.7920 (0.6120) acc_x 78.1250 (85.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/20] time 0.232 (0.219) data 0.109 (0.102) loss_x loss_x 0.1520 (0.6056) acc_x 96.8750 (85.3125) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:646
clean false:4
clean_rate:0.9938461538461538
noisy true:562
noisy false:388
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [108/200] batch [5/20] time 0.190 (0.230) data 0.113 (0.124) loss_x loss_x 0.5879 (0.5615) acc_x 87.5000 (85.0000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/20] time 0.237 (0.234) data 0.114 (0.117) loss_x loss_x 0.3010 (0.4891) acc_x 96.8750 (87.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/20] time 0.242 (0.236) data 0.119 (0.117) loss_x loss_x 0.7695 (0.5491) acc_x 81.2500 (86.2500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/20] time 0.231 (0.239) data 0.107 (0.118) loss_x loss_x 0.3589 (0.5446) acc_x 87.5000 (86.2500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:644
clean false:4
clean_rate:0.9938271604938271
noisy true:561
noisy false:391
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [109/200] batch [5/20] time 0.232 (0.232) data 0.110 (0.109) loss_x loss_x 0.6523 (0.6455) acc_x 84.3750 (83.7500) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/20] time 0.245 (0.231) data 0.120 (0.108) loss_x loss_x 0.6958 (0.5540) acc_x 81.2500 (85.3125) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/20] time 0.210 (0.228) data 0.088 (0.105) loss_x loss_x 1.1387 (0.5914) acc_x 65.6250 (84.3750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/20] time 0.253 (0.233) data 0.128 (0.110) loss_x loss_x 0.6426 (0.5998) acc_x 84.3750 (85.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:646
clean false:1
clean_rate:0.9984544049459042
noisy true:582
noisy false:371
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [110/200] batch [5/20] time 0.234 (0.247) data 0.113 (0.124) loss_x loss_x 0.6270 (0.5080) acc_x 78.1250 (86.8750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/20] time 0.242 (0.240) data 0.119 (0.116) loss_x loss_x 0.6592 (0.5291) acc_x 81.2500 (86.8750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/20] time 0.220 (0.235) data 0.097 (0.111) loss_x loss_x 0.8970 (0.5690) acc_x 81.2500 (85.4167) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/20] time 0.235 (0.233) data 0.109 (0.109) loss_x loss_x 0.2983 (0.5187) acc_x 93.7500 (86.0938) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:639
clean false:4
clean_rate:0.9937791601866252
noisy true:564
noisy false:393
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [111/200] batch [5/20] time 0.226 (0.212) data 0.101 (0.087) loss_x loss_x 0.4705 (0.5734) acc_x 90.6250 (86.2500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/20] time 0.215 (0.223) data 0.092 (0.099) loss_x loss_x 0.5654 (0.5227) acc_x 81.2500 (85.9375) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/20] time 0.250 (0.225) data 0.124 (0.100) loss_x loss_x 0.4539 (0.5870) acc_x 84.3750 (85.0000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/20] time 0.226 (0.225) data 0.103 (0.100) loss_x loss_x 0.4409 (0.5548) acc_x 87.5000 (85.3125) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 644
clean true:640
clean false:4
clean_rate:0.9937888198757764
noisy true:576
noisy false:380
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 956
epoch [112/200] batch [5/20] time 0.247 (0.229) data 0.120 (0.105) loss_x loss_x 0.3823 (0.7234) acc_x 87.5000 (81.8750) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/20] time 0.212 (0.226) data 0.087 (0.102) loss_x loss_x 0.6826 (0.6197) acc_x 84.3750 (83.4375) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/20] time 0.228 (0.229) data 0.106 (0.105) loss_x loss_x 0.4246 (0.5334) acc_x 84.3750 (85.6250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/20] time 0.186 (0.225) data 0.109 (0.106) loss_x loss_x 0.6392 (0.5075) acc_x 87.5000 (86.8750) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 651
clean true:649
clean false:2
clean_rate:0.9969278033794163
noisy true:563
noisy false:386
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 949
epoch [113/200] batch [5/20] time 0.235 (0.236) data 0.108 (0.109) loss_x loss_x 0.6587 (0.5708) acc_x 84.3750 (83.1250) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/20] time 0.189 (0.224) data 0.111 (0.112) loss_x loss_x 0.5088 (0.4748) acc_x 84.3750 (85.9375) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/20] time 0.227 (0.228) data 0.104 (0.111) loss_x loss_x 0.8306 (0.4877) acc_x 81.2500 (87.2917) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/20] time 0.230 (0.230) data 0.108 (0.111) loss_x loss_x 0.6040 (0.5410) acc_x 75.0000 (85.4688) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:659
clean false:5
clean_rate:0.9924698795180723
noisy true:556
noisy false:380
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [114/200] batch [5/20] time 0.225 (0.242) data 0.101 (0.117) loss_x loss_x 0.6729 (0.4378) acc_x 81.2500 (86.8750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/20] time 0.238 (0.235) data 0.112 (0.110) loss_x loss_x 0.5200 (0.4600) acc_x 84.3750 (87.5000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/20] time 0.222 (0.233) data 0.098 (0.108) loss_x loss_x 0.4351 (0.4973) acc_x 87.5000 (87.0833) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/20] time 0.214 (0.230) data 0.091 (0.106) loss_x loss_x 0.9023 (0.5341) acc_x 78.1250 (85.4688) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:647
clean false:6
clean_rate:0.9908116385911179
noisy true:584
noisy false:363
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [115/200] batch [5/20] time 0.215 (0.224) data 0.090 (0.100) loss_x loss_x 0.4270 (0.5842) acc_x 90.6250 (83.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/20] time 0.233 (0.229) data 0.109 (0.105) loss_x loss_x 0.1566 (0.5666) acc_x 96.8750 (84.3750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/20] time 0.231 (0.230) data 0.106 (0.106) loss_x loss_x 0.5078 (0.5392) acc_x 90.6250 (85.6250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/20] time 0.226 (0.229) data 0.103 (0.105) loss_x loss_x 0.5674 (0.5740) acc_x 81.2500 (85.0000) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 347
confident_label rate tensor(0.4194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 671
clean true:665
clean false:6
clean_rate:0.9910581222056631
noisy true:588
noisy false:341
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 929
epoch [116/200] batch [5/20] time 0.235 (0.234) data 0.112 (0.110) loss_x loss_x 0.3655 (0.5041) acc_x 84.3750 (85.0000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/20] time 0.219 (0.232) data 0.093 (0.109) loss_x loss_x 0.6211 (0.5304) acc_x 78.1250 (84.6875) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/20] time 0.241 (0.232) data 0.117 (0.108) loss_x loss_x 0.7876 (0.5282) acc_x 78.1250 (84.7917) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/20] time 0.223 (0.227) data 0.099 (0.107) loss_x loss_x 0.8086 (0.5692) acc_x 75.0000 (83.7500) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:639
clean false:3
clean_rate:0.9953271028037384
noisy true:583
noisy false:375
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [117/200] batch [5/20] time 0.219 (0.227) data 0.094 (0.103) loss_x loss_x 0.3860 (0.4678) acc_x 93.7500 (89.3750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/20] time 0.221 (0.224) data 0.096 (0.098) loss_x loss_x 0.4758 (0.4481) acc_x 90.6250 (89.0625) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/20] time 0.248 (0.229) data 0.121 (0.104) loss_x loss_x 0.6807 (0.4824) acc_x 84.3750 (87.7083) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/20] time 0.243 (0.230) data 0.119 (0.105) loss_x loss_x 0.5186 (0.4753) acc_x 84.3750 (87.6562) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:647
clean false:6
clean_rate:0.9908116385911179
noisy true:578
noisy false:369
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [118/200] batch [5/20] time 0.249 (0.239) data 0.122 (0.110) loss_x loss_x 0.6567 (0.4754) acc_x 84.3750 (86.8750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/20] time 0.220 (0.228) data 0.095 (0.101) loss_x loss_x 0.3481 (0.4478) acc_x 93.7500 (88.4375) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/20] time 0.232 (0.231) data 0.108 (0.106) loss_x loss_x 0.5732 (0.5287) acc_x 84.3750 (87.5000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/20] time 0.232 (0.232) data 0.108 (0.107) loss_x loss_x 0.3542 (0.5597) acc_x 90.6250 (86.5625) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:647
clean false:5
clean_rate:0.9923312883435583
noisy true:571
noisy false:377
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [119/200] batch [5/20] time 0.210 (0.223) data 0.082 (0.101) loss_x loss_x 1.0381 (0.6309) acc_x 71.8750 (83.7500) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/20] time 0.223 (0.222) data 0.100 (0.098) loss_x loss_x 0.7178 (0.5640) acc_x 90.6250 (86.2500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/20] time 0.232 (0.226) data 0.106 (0.102) loss_x loss_x 0.6050 (0.5809) acc_x 81.2500 (84.3750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/20] time 0.194 (0.224) data 0.117 (0.104) loss_x loss_x 0.3547 (0.5644) acc_x 96.8750 (85.0000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:650
clean false:5
clean_rate:0.9923664122137404
noisy true:574
noisy false:371
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [120/200] batch [5/20] time 0.231 (0.231) data 0.109 (0.107) loss_x loss_x 0.3665 (0.4434) acc_x 84.3750 (86.8750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/20] time 0.280 (0.242) data 0.157 (0.117) loss_x loss_x 0.5703 (0.4995) acc_x 84.3750 (86.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/20] time 0.182 (0.234) data 0.106 (0.112) loss_x loss_x 0.8574 (0.5305) acc_x 84.3750 (85.6250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/20] time 0.231 (0.231) data 0.105 (0.111) loss_x loss_x 0.3308 (0.5171) acc_x 93.7500 (85.7812) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:660
clean false:4
clean_rate:0.9939759036144579
noisy true:580
noisy false:356
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [121/200] batch [5/20] time 0.213 (0.229) data 0.088 (0.104) loss_x loss_x 0.9033 (0.6143) acc_x 78.1250 (86.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/20] time 0.213 (0.223) data 0.086 (0.098) loss_x loss_x 0.5264 (0.5625) acc_x 87.5000 (87.8125) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/20] time 0.237 (0.227) data 0.110 (0.102) loss_x loss_x 0.4424 (0.5752) acc_x 87.5000 (86.0417) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/20] time 0.253 (0.232) data 0.128 (0.106) loss_x loss_x 0.3135 (0.5646) acc_x 96.8750 (85.7812) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:639
clean false:4
clean_rate:0.9937791601866252
noisy true:570
noisy false:387
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [122/200] batch [5/20] time 0.245 (0.231) data 0.116 (0.106) loss_x loss_x 0.7788 (0.5597) acc_x 71.8750 (83.1250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/20] time 0.232 (0.229) data 0.108 (0.105) loss_x loss_x 0.6030 (0.4978) acc_x 84.3750 (86.5625) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/20] time 0.237 (0.230) data 0.113 (0.105) loss_x loss_x 0.5747 (0.4944) acc_x 87.5000 (87.0833) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/20] time 0.219 (0.229) data 0.094 (0.104) loss_x loss_x 0.7456 (0.5280) acc_x 87.5000 (87.0312) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:658
clean false:4
clean_rate:0.9939577039274925
noisy true:555
noisy false:383
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [123/200] batch [5/20] time 0.212 (0.228) data 0.090 (0.104) loss_x loss_x 0.4233 (0.6549) acc_x 87.5000 (86.2500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/20] time 0.274 (0.234) data 0.152 (0.110) loss_x loss_x 0.6187 (0.6189) acc_x 81.2500 (83.7500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/20] time 0.244 (0.235) data 0.121 (0.111) loss_x loss_x 0.8154 (0.6022) acc_x 78.1250 (83.9583) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/20] time 0.220 (0.236) data 0.098 (0.112) loss_x loss_x 0.3069 (0.6297) acc_x 87.5000 (83.5938) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:640
clean false:3
clean_rate:0.995334370139969
noisy true:573
noisy false:384
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [124/200] batch [5/20] time 0.236 (0.235) data 0.111 (0.112) loss_x loss_x 0.3313 (0.5396) acc_x 84.3750 (85.6250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/20] time 0.233 (0.237) data 0.108 (0.113) loss_x loss_x 0.3721 (0.5021) acc_x 90.6250 (87.1875) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/20] time 0.235 (0.241) data 0.113 (0.118) loss_x loss_x 0.4949 (0.6006) acc_x 90.6250 (85.8333) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/20] time 0.218 (0.240) data 0.095 (0.117) loss_x loss_x 0.2852 (0.5934) acc_x 93.7500 (85.4688) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:666
clean false:4
clean_rate:0.9940298507462687
noisy true:576
noisy false:354
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [125/200] batch [5/20] time 0.222 (0.235) data 0.099 (0.111) loss_x loss_x 0.4275 (0.6070) acc_x 87.5000 (86.8750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/20] time 0.222 (0.229) data 0.111 (0.106) loss_x loss_x 0.3464 (0.6346) acc_x 87.5000 (82.8125) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/20] time 0.231 (0.224) data 0.109 (0.104) loss_x loss_x 0.6636 (0.6312) acc_x 78.1250 (82.9167) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/20] time 0.217 (0.226) data 0.091 (0.105) loss_x loss_x 0.7598 (0.6054) acc_x 81.2500 (83.4375) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:639
clean false:4
clean_rate:0.9937791601866252
noisy true:578
noisy false:379
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [126/200] batch [5/20] time 0.183 (0.236) data 0.106 (0.120) loss_x loss_x 0.9580 (0.4889) acc_x 75.0000 (86.8750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/20] time 0.235 (0.226) data 0.111 (0.115) loss_x loss_x 0.4897 (0.5504) acc_x 84.3750 (85.9375) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/20] time 0.237 (0.225) data 0.115 (0.110) loss_x loss_x 0.2798 (0.5342) acc_x 96.8750 (86.4583) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/20] time 0.245 (0.226) data 0.121 (0.109) loss_x loss_x 0.8057 (0.5262) acc_x 78.1250 (86.4062) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:649
clean false:5
clean_rate:0.9923547400611621
noisy true:562
noisy false:384
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [127/200] batch [5/20] time 0.231 (0.231) data 0.109 (0.108) loss_x loss_x 0.6387 (0.4405) acc_x 84.3750 (88.1250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/20] time 0.207 (0.224) data 0.083 (0.107) loss_x loss_x 0.7202 (0.5283) acc_x 81.2500 (86.2500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/20] time 0.231 (0.232) data 0.107 (0.113) loss_x loss_x 0.5186 (0.4858) acc_x 81.2500 (86.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/20] time 0.233 (0.232) data 0.109 (0.112) loss_x loss_x 0.4224 (0.4877) acc_x 81.2500 (86.7188) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:645
clean false:3
clean_rate:0.9953703703703703
noisy true:566
noisy false:386
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [128/200] batch [5/20] time 0.231 (0.254) data 0.109 (0.131) loss_x loss_x 0.5088 (0.4227) acc_x 87.5000 (88.7500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/20] time 0.225 (0.240) data 0.101 (0.116) loss_x loss_x 0.9141 (0.4594) acc_x 81.2500 (88.1250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/20] time 0.233 (0.235) data 0.110 (0.111) loss_x loss_x 0.5127 (0.4993) acc_x 90.6250 (87.0833) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/20] time 0.228 (0.235) data 0.103 (0.111) loss_x loss_x 0.3062 (0.4893) acc_x 87.5000 (86.5625) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:656
clean false:5
clean_rate:0.9924357034795764
noisy true:555
noisy false:384
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [129/200] batch [5/20] time 0.252 (0.261) data 0.130 (0.136) loss_x loss_x 0.5972 (0.7381) acc_x 87.5000 (81.2500) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/20] time 0.223 (0.246) data 0.099 (0.121) loss_x loss_x 0.9082 (0.7125) acc_x 81.2500 (82.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/20] time 0.239 (0.240) data 0.110 (0.116) loss_x loss_x 0.6162 (0.6908) acc_x 81.2500 (82.7083) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/20] time 0.217 (0.234) data 0.090 (0.113) loss_x loss_x 0.7769 (0.6549) acc_x 84.3750 (83.5938) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.3956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 633
clean true:630
clean false:3
clean_rate:0.995260663507109
noisy true:578
noisy false:389
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 967
epoch [130/200] batch [5/19] time 0.237 (0.241) data 0.113 (0.113) loss_x loss_x 0.6567 (0.5206) acc_x 84.3750 (84.3750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/19] time 0.235 (0.237) data 0.112 (0.111) loss_x loss_x 0.4966 (0.5054) acc_x 87.5000 (85.3125) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/19] time 0.229 (0.234) data 0.108 (0.110) loss_x loss_x 0.7686 (0.5215) acc_x 84.3750 (85.6250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:652
clean false:6
clean_rate:0.9908814589665653
noisy true:566
noisy false:376
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [131/200] batch [5/20] time 0.237 (0.245) data 0.109 (0.119) loss_x loss_x 0.3469 (0.4034) acc_x 93.7500 (90.0000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/20] time 0.269 (0.247) data 0.142 (0.122) loss_x loss_x 0.5166 (0.4689) acc_x 81.2500 (88.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/20] time 0.231 (0.245) data 0.107 (0.119) loss_x loss_x 0.5972 (0.4819) acc_x 87.5000 (87.9167) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/20] time 0.249 (0.237) data 0.108 (0.117) loss_x loss_x 0.4875 (0.4857) acc_x 84.3750 (87.6562) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:645
clean false:5
clean_rate:0.9923076923076923
noisy true:570
noisy false:380
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [132/200] batch [5/20] time 0.240 (0.227) data 0.117 (0.114) loss_x loss_x 0.4490 (0.5112) acc_x 90.6250 (86.8750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/20] time 0.244 (0.231) data 0.120 (0.112) loss_x loss_x 0.7061 (0.6734) acc_x 84.3750 (83.4375) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/20] time 0.200 (0.230) data 0.122 (0.112) loss_x loss_x 0.6782 (0.6736) acc_x 84.3750 (83.5417) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/20] time 0.232 (0.231) data 0.107 (0.111) loss_x loss_x 0.9502 (0.6649) acc_x 71.8750 (83.2812) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:647
clean false:5
clean_rate:0.9923312883435583
noisy true:578
noisy false:370
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [133/200] batch [5/20] time 0.228 (0.279) data 0.104 (0.158) loss_x loss_x 0.9663 (0.6236) acc_x 75.0000 (82.5000) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/20] time 0.255 (0.276) data 0.132 (0.153) loss_x loss_x 0.7920 (0.5415) acc_x 81.2500 (85.3125) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/20] time 0.229 (0.263) data 0.108 (0.140) loss_x loss_x 0.5283 (0.5103) acc_x 87.5000 (85.6250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/20] time 0.236 (0.256) data 0.110 (0.133) loss_x loss_x 0.1720 (0.5530) acc_x 96.8750 (86.2500) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.4144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 663
clean true:658
clean false:5
clean_rate:0.9924585218702866
noisy true:582
noisy false:355
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 937
epoch [134/200] batch [5/20] time 0.261 (0.239) data 0.135 (0.113) loss_x loss_x 1.0537 (0.5459) acc_x 78.1250 (87.5000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/20] time 0.262 (0.240) data 0.138 (0.115) loss_x loss_x 0.5366 (0.5771) acc_x 87.5000 (86.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/20] time 0.240 (0.244) data 0.116 (0.119) loss_x loss_x 0.3152 (0.5845) acc_x 87.5000 (84.7917) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/20] time 0.226 (0.242) data 0.104 (0.117) loss_x loss_x 0.9746 (0.6109) acc_x 81.2500 (83.7500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:635
clean false:1
clean_rate:0.9984276729559748
noisy true:568
noisy false:396
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [135/200] batch [5/19] time 0.236 (0.228) data 0.113 (0.121) loss_x loss_x 0.6875 (0.5907) acc_x 84.3750 (83.7500) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/19] time 0.235 (0.230) data 0.110 (0.114) loss_x loss_x 0.3208 (0.5534) acc_x 90.6250 (85.3125) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/19] time 0.254 (0.234) data 0.130 (0.115) loss_x loss_x 0.4136 (0.5175) acc_x 87.5000 (86.0417) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 659
clean true:654
clean false:5
clean_rate:0.992412746585736
noisy true:583
noisy false:358
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 941
epoch [136/200] batch [5/20] time 0.254 (0.258) data 0.129 (0.134) loss_x loss_x 0.2932 (0.4536) acc_x 93.7500 (88.1250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/20] time 0.240 (0.255) data 0.117 (0.131) loss_x loss_x 0.8271 (0.5034) acc_x 84.3750 (86.8750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/20] time 0.235 (0.250) data 0.111 (0.126) loss_x loss_x 0.3372 (0.4831) acc_x 87.5000 (86.2500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/20] time 0.246 (0.247) data 0.122 (0.123) loss_x loss_x 0.5566 (0.4932) acc_x 96.8750 (87.1875) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:634
clean false:4
clean_rate:0.9937304075235109
noisy true:578
noisy false:384
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [137/200] batch [5/19] time 0.226 (0.235) data 0.104 (0.110) loss_x loss_x 0.2820 (0.4873) acc_x 93.7500 (88.1250) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/19] time 0.228 (0.230) data 0.106 (0.106) loss_x loss_x 0.4299 (0.5135) acc_x 87.5000 (87.1875) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/19] time 0.246 (0.230) data 0.124 (0.106) loss_x loss_x 0.3071 (0.4958) acc_x 87.5000 (86.2500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:640
clean false:3
clean_rate:0.995334370139969
noisy true:583
noisy false:374
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [138/200] batch [5/20] time 0.229 (0.239) data 0.105 (0.114) loss_x loss_x 0.5254 (0.4473) acc_x 84.3750 (86.2500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/20] time 0.222 (0.235) data 0.096 (0.109) loss_x loss_x 0.4854 (0.4564) acc_x 87.5000 (87.5000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/20] time 0.259 (0.233) data 0.136 (0.109) loss_x loss_x 0.7891 (0.5043) acc_x 78.1250 (86.2500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/20] time 0.234 (0.236) data 0.110 (0.112) loss_x loss_x 0.5020 (0.4876) acc_x 84.3750 (86.8750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:651
clean false:3
clean_rate:0.9954128440366973
noisy true:560
noisy false:386
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [139/200] batch [5/20] time 0.233 (0.239) data 0.108 (0.115) loss_x loss_x 0.7124 (0.6055) acc_x 78.1250 (83.1250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/20] time 0.270 (0.239) data 0.144 (0.115) loss_x loss_x 0.2009 (0.5692) acc_x 93.7500 (83.7500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/20] time 0.228 (0.237) data 0.108 (0.113) loss_x loss_x 0.4717 (0.5254) acc_x 84.3750 (85.6250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/20] time 0.282 (0.235) data 0.157 (0.114) loss_x loss_x 0.7036 (0.5921) acc_x 81.2500 (84.0625) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:649
clean false:5
clean_rate:0.9923547400611621
noisy true:564
noisy false:382
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [140/200] batch [5/20] time 0.232 (0.239) data 0.108 (0.115) loss_x loss_x 0.3440 (0.4727) acc_x 93.7500 (87.5000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/20] time 0.243 (0.227) data 0.111 (0.110) loss_x loss_x 0.6367 (0.5614) acc_x 84.3750 (85.6250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/20] time 0.233 (0.231) data 0.109 (0.111) loss_x loss_x 0.5366 (0.5240) acc_x 81.2500 (86.6667) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/20] time 0.239 (0.232) data 0.112 (0.110) loss_x loss_x 0.5879 (0.5327) acc_x 90.6250 (87.3438) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:644
clean false:3
clean_rate:0.9953632148377125
noisy true:576
noisy false:377
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [141/200] batch [5/20] time 0.253 (0.239) data 0.129 (0.113) loss_x loss_x 0.3904 (0.3379) acc_x 87.5000 (89.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/20] time 0.228 (0.245) data 0.104 (0.120) loss_x loss_x 0.7432 (0.4704) acc_x 81.2500 (87.8125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/20] time 0.228 (0.242) data 0.103 (0.117) loss_x loss_x 0.6719 (0.4815) acc_x 78.1250 (86.8750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/20] time 0.238 (0.240) data 0.109 (0.115) loss_x loss_x 0.5273 (0.5055) acc_x 84.3750 (86.7188) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:659
clean false:7
clean_rate:0.9894894894894894
noisy true:580
noisy false:354
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [142/200] batch [5/20] time 0.246 (0.231) data 0.111 (0.114) loss_x loss_x 0.5547 (0.5772) acc_x 81.2500 (86.2500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/20] time 0.214 (0.225) data 0.086 (0.103) loss_x loss_x 0.4380 (0.4688) acc_x 87.5000 (87.8125) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/20] time 0.225 (0.225) data 0.098 (0.103) loss_x loss_x 0.9272 (0.5302) acc_x 81.2500 (87.2917) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/20] time 0.233 (0.227) data 0.110 (0.104) loss_x loss_x 0.2617 (0.5233) acc_x 90.6250 (87.0312) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:646
clean false:3
clean_rate:0.9953775038520801
noisy true:578
noisy false:373
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [143/200] batch [5/20] time 0.243 (0.246) data 0.117 (0.121) loss_x loss_x 0.4839 (0.4263) acc_x 90.6250 (89.3750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/20] time 0.275 (0.243) data 0.147 (0.117) loss_x loss_x 0.4160 (0.4256) acc_x 81.2500 (88.4375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/20] time 0.237 (0.240) data 0.113 (0.114) loss_x loss_x 0.3818 (0.4526) acc_x 87.5000 (87.7083) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/20] time 0.212 (0.234) data 0.089 (0.113) loss_x loss_x 0.6948 (0.4674) acc_x 78.1250 (86.5625) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 361
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:654
clean false:4
clean_rate:0.993920972644377
noisy true:585
noisy false:357
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [144/200] batch [5/20] time 0.285 (0.256) data 0.163 (0.132) loss_x loss_x 0.6753 (0.5474) acc_x 81.2500 (83.7500) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/20] time 0.235 (0.249) data 0.108 (0.124) loss_x loss_x 0.3010 (0.5624) acc_x 87.5000 (84.0625) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/20] time 0.224 (0.242) data 0.099 (0.117) loss_x loss_x 0.4875 (0.5709) acc_x 90.6250 (84.3750) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/20] time 0.243 (0.240) data 0.118 (0.115) loss_x loss_x 0.5415 (0.5670) acc_x 84.3750 (84.2188) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 660
clean true:657
clean false:3
clean_rate:0.9954545454545455
noisy true:570
noisy false:370
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 940
epoch [145/200] batch [5/20] time 0.222 (0.238) data 0.098 (0.113) loss_x loss_x 0.7070 (0.4812) acc_x 81.2500 (88.1250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/20] time 0.228 (0.234) data 0.106 (0.109) loss_x loss_x 0.4023 (0.4677) acc_x 90.6250 (87.1875) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/20] time 0.237 (0.233) data 0.112 (0.109) loss_x loss_x 0.4314 (0.4647) acc_x 87.5000 (87.0833) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/20] time 0.226 (0.231) data 0.102 (0.106) loss_x loss_x 0.4282 (0.4760) acc_x 87.5000 (86.7188) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:662
clean false:4
clean_rate:0.993993993993994
noisy true:572
noisy false:362
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [146/200] batch [5/20] time 0.233 (0.244) data 0.108 (0.119) loss_x loss_x 0.3694 (0.6389) acc_x 93.7500 (83.7500) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/20] time 0.231 (0.239) data 0.107 (0.114) loss_x loss_x 0.4121 (0.5477) acc_x 93.7500 (87.1875) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/20] time 0.217 (0.235) data 0.091 (0.110) loss_x loss_x 0.5996 (0.5464) acc_x 78.1250 (86.4583) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/20] time 0.238 (0.233) data 0.113 (0.108) loss_x loss_x 0.7124 (0.5588) acc_x 78.1250 (86.2500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 678
clean true:673
clean false:5
clean_rate:0.9926253687315634
noisy true:560
noisy false:362
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 922
epoch [147/200] batch [5/21] time 0.262 (0.217) data 0.101 (0.104) loss_x loss_x 0.6558 (0.5392) acc_x 87.5000 (87.5000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/21] time 0.223 (0.220) data 0.097 (0.101) loss_x loss_x 0.9453 (0.6784) acc_x 71.8750 (83.1250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/21] time 0.233 (0.225) data 0.108 (0.105) loss_x loss_x 0.4802 (0.5848) acc_x 84.3750 (85.4167) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/21] time 0.180 (0.223) data 0.093 (0.104) loss_x loss_x 1.2598 (0.6022) acc_x 71.8750 (85.0000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:660
clean false:6
clean_rate:0.990990990990991
noisy true:580
noisy false:354
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [148/200] batch [5/20] time 0.249 (0.234) data 0.122 (0.108) loss_x loss_x 0.5054 (0.4659) acc_x 84.3750 (85.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/20] time 0.176 (0.219) data 0.099 (0.103) loss_x loss_x 0.5410 (0.5010) acc_x 87.5000 (86.5625) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/20] time 0.225 (0.221) data 0.101 (0.101) loss_x loss_x 0.4136 (0.4343) acc_x 93.7500 (88.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/20] time 0.246 (0.223) data 0.125 (0.103) loss_x loss_x 0.7388 (0.4737) acc_x 84.3750 (87.9688) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:659
clean false:3
clean_rate:0.9954682779456193
noisy true:573
noisy false:365
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [149/200] batch [5/20] time 0.234 (0.235) data 0.108 (0.109) loss_x loss_x 1.0078 (0.5368) acc_x 71.8750 (85.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/20] time 0.246 (0.231) data 0.121 (0.106) loss_x loss_x 0.2856 (0.5375) acc_x 93.7500 (85.9375) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/20] time 0.253 (0.234) data 0.128 (0.109) loss_x loss_x 0.4580 (0.5689) acc_x 90.6250 (85.2083) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/20] time 0.232 (0.232) data 0.103 (0.107) loss_x loss_x 0.6870 (0.5937) acc_x 75.0000 (83.5938) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:643
clean false:6
clean_rate:0.9907550077041603
noisy true:568
noisy false:383
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [150/200] batch [5/20] time 0.246 (0.244) data 0.122 (0.118) loss_x loss_x 0.3225 (0.4717) acc_x 93.7500 (85.6250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/20] time 0.221 (0.237) data 0.095 (0.112) loss_x loss_x 0.7832 (0.4824) acc_x 78.1250 (85.3125) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/20] time 0.244 (0.238) data 0.118 (0.112) loss_x loss_x 0.1493 (0.4742) acc_x 93.7500 (86.0417) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/20] time 0.220 (0.236) data 0.095 (0.111) loss_x loss_x 0.6304 (0.4844) acc_x 90.6250 (86.5625) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 660
clean true:653
clean false:7
clean_rate:0.9893939393939394
noisy true:572
noisy false:368
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 940
epoch [151/200] batch [5/20] time 0.246 (0.236) data 0.122 (0.112) loss_x loss_x 0.4680 (0.3935) acc_x 90.6250 (91.2500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/20] time 0.240 (0.235) data 0.117 (0.110) loss_x loss_x 0.8042 (0.4247) acc_x 71.8750 (88.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/20] time 0.219 (0.234) data 0.095 (0.110) loss_x loss_x 0.4346 (0.4608) acc_x 87.5000 (87.7083) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/20] time 0.215 (0.232) data 0.091 (0.107) loss_x loss_x 0.4458 (0.4818) acc_x 84.3750 (87.1875) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:665
clean false:5
clean_rate:0.9925373134328358
noisy true:573
noisy false:357
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [152/200] batch [5/20] time 0.233 (0.241) data 0.110 (0.117) loss_x loss_x 0.2151 (0.4359) acc_x 100.0000 (89.3750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/20] time 0.229 (0.237) data 0.105 (0.112) loss_x loss_x 0.5078 (0.4855) acc_x 81.2500 (87.1875) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/20] time 0.236 (0.239) data 0.112 (0.115) loss_x loss_x 0.5947 (0.5608) acc_x 84.3750 (85.8333) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/20] time 0.248 (0.237) data 0.122 (0.112) loss_x loss_x 0.4688 (0.5314) acc_x 87.5000 (86.4062) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.4250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 680
clean true:674
clean false:6
clean_rate:0.9911764705882353
noisy true:571
noisy false:349
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 920
epoch [153/200] batch [5/21] time 0.232 (0.234) data 0.106 (0.108) loss_x loss_x 0.1587 (0.4961) acc_x 96.8750 (85.0000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/21] time 0.227 (0.231) data 0.103 (0.106) loss_x loss_x 0.6152 (0.4929) acc_x 87.5000 (86.8750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/21] time 0.230 (0.235) data 0.108 (0.109) loss_x loss_x 0.6162 (0.4676) acc_x 84.3750 (88.5417) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/21] time 0.230 (0.234) data 0.105 (0.109) loss_x loss_x 0.5405 (0.5036) acc_x 84.3750 (86.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.3981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 637
clean true:632
clean false:5
clean_rate:0.9921507064364207
noisy true:574
noisy false:389
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 963
epoch [154/200] batch [5/19] time 0.232 (0.234) data 0.106 (0.110) loss_x loss_x 0.3701 (0.3835) acc_x 90.6250 (89.3750) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/19] time 0.224 (0.235) data 0.099 (0.110) loss_x loss_x 0.6567 (0.4913) acc_x 81.2500 (85.9375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/19] time 0.234 (0.238) data 0.109 (0.113) loss_x loss_x 0.5781 (0.5254) acc_x 87.5000 (85.8333) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 360
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:658
clean false:6
clean_rate:0.9909638554216867
noisy true:582
noisy false:354
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [155/200] batch [5/20] time 0.252 (0.250) data 0.125 (0.126) loss_x loss_x 0.4890 (0.4306) acc_x 90.6250 (91.8750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/20] time 0.262 (0.247) data 0.140 (0.122) loss_x loss_x 1.0547 (0.6114) acc_x 71.8750 (86.8750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/20] time 0.232 (0.244) data 0.110 (0.119) loss_x loss_x 0.5039 (0.5932) acc_x 84.3750 (86.4583) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/20] time 0.231 (0.241) data 0.109 (0.117) loss_x loss_x 0.4470 (0.5816) acc_x 90.6250 (87.1875) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:639
clean false:4
clean_rate:0.9937791601866252
noisy true:574
noisy false:383
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [156/200] batch [5/20] time 0.252 (0.267) data 0.128 (0.142) loss_x loss_x 0.4065 (0.4570) acc_x 90.6250 (86.2500) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/20] time 0.231 (0.256) data 0.106 (0.131) loss_x loss_x 0.6138 (0.4890) acc_x 87.5000 (87.1875) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/20] time 0.229 (0.248) data 0.107 (0.123) loss_x loss_x 0.5654 (0.4799) acc_x 84.3750 (87.2917) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/20] time 0.220 (0.237) data 0.094 (0.117) loss_x loss_x 0.4419 (0.4995) acc_x 87.5000 (87.1875) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:648
clean false:5
clean_rate:0.9923430321592649
noisy true:566
noisy false:381
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [157/200] batch [5/20] time 0.162 (0.208) data 0.084 (0.095) loss_x loss_x 0.5835 (0.5095) acc_x 81.2500 (85.0000) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/20] time 0.229 (0.217) data 0.106 (0.103) loss_x loss_x 0.4631 (0.5258) acc_x 84.3750 (85.0000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/20] time 0.234 (0.222) data 0.111 (0.105) loss_x loss_x 0.3909 (0.4976) acc_x 81.2500 (85.8333) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/20] time 0.222 (0.226) data 0.099 (0.107) loss_x loss_x 0.6455 (0.5453) acc_x 84.3750 (84.6875) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:646
clean false:4
clean_rate:0.9938461538461538
noisy true:568
noisy false:382
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [158/200] batch [5/20] time 0.208 (0.214) data 0.083 (0.083) loss_x loss_x 0.3721 (0.4909) acc_x 90.6250 (84.3750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/20] time 0.210 (0.212) data 0.085 (0.084) loss_x loss_x 0.2759 (0.5067) acc_x 93.7500 (84.6875) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/20] time 0.203 (0.211) data 0.081 (0.084) loss_x loss_x 0.3848 (0.4937) acc_x 93.7500 (85.6250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/20] time 0.208 (0.210) data 0.083 (0.084) loss_x loss_x 0.3716 (0.5333) acc_x 87.5000 (85.1562) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:663
clean false:5
clean_rate:0.9925149700598802
noisy true:566
noisy false:366
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [159/200] batch [5/20] time 0.209 (0.190) data 0.085 (0.084) loss_x loss_x 0.2391 (0.4011) acc_x 93.7500 (90.0000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/20] time 0.213 (0.201) data 0.088 (0.086) loss_x loss_x 0.2957 (0.5583) acc_x 93.7500 (86.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/20] time 0.232 (0.207) data 0.107 (0.089) loss_x loss_x 0.5425 (0.5629) acc_x 81.2500 (85.4167) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/20] time 0.233 (0.211) data 0.107 (0.093) loss_x loss_x 0.4014 (0.5314) acc_x 90.6250 (85.9375) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 356
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:663
clean false:4
clean_rate:0.9940029985007496
noisy true:581
noisy false:352
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [160/200] batch [5/20] time 0.214 (0.211) data 0.090 (0.087) loss_x loss_x 0.3735 (0.6246) acc_x 90.6250 (85.6250) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/20] time 0.211 (0.211) data 0.084 (0.086) loss_x loss_x 0.9028 (0.6357) acc_x 75.0000 (84.6875) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/20] time 0.213 (0.210) data 0.083 (0.085) loss_x loss_x 0.4719 (0.6066) acc_x 93.7500 (85.2083) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/20] time 0.210 (0.208) data 0.085 (0.084) loss_x loss_x 0.5073 (0.6112) acc_x 81.2500 (84.8438) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 665
clean true:660
clean false:5
clean_rate:0.9924812030075187
noisy true:568
noisy false:367
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 935
epoch [161/200] batch [5/20] time 0.206 (0.214) data 0.081 (0.088) loss_x loss_x 0.9551 (0.5785) acc_x 68.7500 (84.3750) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/20] time 0.206 (0.211) data 0.082 (0.085) loss_x loss_x 0.3115 (0.4890) acc_x 93.7500 (87.8125) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/20] time 0.210 (0.210) data 0.085 (0.085) loss_x loss_x 0.2311 (0.4973) acc_x 93.7500 (88.1250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/20] time 0.186 (0.208) data 0.085 (0.085) loss_x loss_x 0.6514 (0.4936) acc_x 81.2500 (88.1250) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:650
clean false:3
clean_rate:0.9954058192955589
noisy true:581
noisy false:366
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [162/200] batch [5/20] time 0.211 (0.217) data 0.087 (0.092) loss_x loss_x 0.4087 (0.4838) acc_x 90.6250 (90.0000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/20] time 0.209 (0.214) data 0.083 (0.089) loss_x loss_x 0.4158 (0.5385) acc_x 90.6250 (87.5000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/20] time 0.215 (0.213) data 0.084 (0.087) loss_x loss_x 0.3560 (0.5608) acc_x 93.7500 (87.7083) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/20] time 0.213 (0.213) data 0.085 (0.086) loss_x loss_x 0.3711 (0.5210) acc_x 87.5000 (88.4375) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:653
clean false:5
clean_rate:0.9924012158054711
noisy true:575
noisy false:367
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [163/200] batch [5/20] time 0.231 (0.229) data 0.108 (0.106) loss_x loss_x 0.5054 (0.4322) acc_x 84.3750 (88.1250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/20] time 0.209 (0.227) data 0.082 (0.103) loss_x loss_x 0.6221 (0.4868) acc_x 87.5000 (86.8750) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/20] time 0.230 (0.225) data 0.107 (0.102) loss_x loss_x 0.6680 (0.4393) acc_x 84.3750 (88.3333) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/20] time 0.226 (0.226) data 0.104 (0.103) loss_x loss_x 1.0010 (0.4975) acc_x 75.0000 (86.8750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 665
clean true:656
clean false:9
clean_rate:0.9864661654135338
noisy true:577
noisy false:358
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 935
epoch [164/200] batch [5/20] time 0.205 (0.209) data 0.084 (0.083) loss_x loss_x 0.3518 (0.6097) acc_x 90.6250 (85.6250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/20] time 0.207 (0.209) data 0.083 (0.084) loss_x loss_x 0.8174 (0.6749) acc_x 71.8750 (82.8125) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/20] time 0.208 (0.210) data 0.084 (0.084) loss_x loss_x 0.4634 (0.5970) acc_x 84.3750 (83.9583) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/20] time 0.208 (0.209) data 0.082 (0.084) loss_x loss_x 0.6880 (0.6059) acc_x 84.3750 (84.5312) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.3994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 639
clean true:636
clean false:3
clean_rate:0.9953051643192489
noisy true:576
noisy false:385
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 961
epoch [165/200] batch [5/19] time 0.203 (0.207) data 0.081 (0.083) loss_x loss_x 0.4551 (0.5138) acc_x 78.1250 (85.0000) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/19] time 0.212 (0.211) data 0.084 (0.086) loss_x loss_x 0.8315 (0.5504) acc_x 78.1250 (85.3125) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/19] time 0.215 (0.211) data 0.090 (0.086) loss_x loss_x 0.5200 (0.5616) acc_x 87.5000 (85.4167) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 341
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 673
clean true:669
clean false:4
clean_rate:0.9940564635958395
noisy true:590
noisy false:337
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 927
epoch [166/200] batch [5/21] time 0.212 (0.208) data 0.087 (0.083) loss_x loss_x 0.5405 (0.6420) acc_x 81.2500 (83.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/21] time 0.209 (0.210) data 0.083 (0.084) loss_x loss_x 0.6313 (0.5459) acc_x 84.3750 (86.5625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/21] time 0.214 (0.210) data 0.088 (0.084) loss_x loss_x 0.5483 (0.6005) acc_x 87.5000 (85.4167) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/21] time 0.210 (0.210) data 0.084 (0.084) loss_x loss_x 0.4294 (0.5817) acc_x 90.6250 (86.0938) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:654
clean false:4
clean_rate:0.993920972644377
noisy true:592
noisy false:350
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [167/200] batch [5/20] time 0.204 (0.223) data 0.081 (0.097) loss_x loss_x 0.5967 (0.5181) acc_x 84.3750 (85.0000) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/20] time 0.208 (0.216) data 0.085 (0.091) loss_x loss_x 0.5781 (0.5305) acc_x 90.6250 (86.5625) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/20] time 0.208 (0.213) data 0.084 (0.089) loss_x loss_x 0.8472 (0.4830) acc_x 81.2500 (88.3333) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/20] time 0.211 (0.212) data 0.087 (0.088) loss_x loss_x 0.1982 (0.5079) acc_x 90.6250 (86.7188) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 645
clean true:640
clean false:5
clean_rate:0.9922480620155039
noisy true:580
noisy false:375
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 955
epoch [168/200] batch [5/20] time 0.209 (0.209) data 0.084 (0.085) loss_x loss_x 0.3635 (0.5559) acc_x 96.8750 (87.5000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/20] time 0.208 (0.209) data 0.081 (0.083) loss_x loss_x 0.4165 (0.5347) acc_x 87.5000 (86.5625) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/20] time 0.206 (0.209) data 0.081 (0.083) loss_x loss_x 0.4058 (0.4845) acc_x 90.6250 (87.5000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/20] time 0.205 (0.208) data 0.082 (0.083) loss_x loss_x 1.0693 (0.5567) acc_x 68.7500 (85.6250) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:636
clean false:4
clean_rate:0.99375
noisy true:576
noisy false:384
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [169/200] batch [5/20] time 0.211 (0.212) data 0.087 (0.087) loss_x loss_x 0.3225 (0.5702) acc_x 90.6250 (86.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/20] time 0.203 (0.210) data 0.080 (0.086) loss_x loss_x 0.5464 (0.5119) acc_x 81.2500 (85.9375) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/20] time 0.208 (0.209) data 0.085 (0.085) loss_x loss_x 1.0264 (0.5417) acc_x 81.2500 (85.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/20] time 0.205 (0.209) data 0.077 (0.084) loss_x loss_x 0.9648 (0.5531) acc_x 78.1250 (85.4688) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 671
clean true:663
clean false:8
clean_rate:0.9880774962742176
noisy true:574
noisy false:355
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 929
epoch [170/200] batch [5/20] time 0.210 (0.210) data 0.085 (0.085) loss_x loss_x 0.9858 (0.6948) acc_x 81.2500 (84.3750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/20] time 0.206 (0.209) data 0.079 (0.084) loss_x loss_x 0.9575 (0.5651) acc_x 78.1250 (87.8125) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/20] time 0.213 (0.210) data 0.089 (0.084) loss_x loss_x 0.7373 (0.6178) acc_x 84.3750 (86.0417) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/20] time 0.211 (0.209) data 0.085 (0.084) loss_x loss_x 0.7690 (0.6154) acc_x 78.1250 (85.3125) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:657
clean false:7
clean_rate:0.9894578313253012
noisy true:578
noisy false:358
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [171/200] batch [5/20] time 0.217 (0.212) data 0.091 (0.087) loss_x loss_x 0.5737 (0.5284) acc_x 87.5000 (86.2500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/20] time 0.159 (0.201) data 0.082 (0.085) loss_x loss_x 0.7637 (0.6638) acc_x 78.1250 (83.7500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/20] time 0.210 (0.207) data 0.085 (0.085) loss_x loss_x 0.6362 (0.6294) acc_x 78.1250 (83.5417) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/20] time 0.208 (0.207) data 0.083 (0.084) loss_x loss_x 0.5518 (0.5826) acc_x 81.2500 (84.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.4212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 674
clean true:668
clean false:6
clean_rate:0.9910979228486647
noisy true:558
noisy false:368
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 926
epoch [172/200] batch [5/21] time 0.201 (0.203) data 0.077 (0.079) loss_x loss_x 0.7651 (0.7238) acc_x 78.1250 (83.7500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/21] time 0.205 (0.201) data 0.080 (0.080) loss_x loss_x 0.4336 (0.5934) acc_x 90.6250 (85.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/21] time 0.201 (0.202) data 0.078 (0.079) loss_x loss_x 0.6636 (0.6141) acc_x 84.3750 (85.8333) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/21] time 0.209 (0.203) data 0.078 (0.079) loss_x loss_x 0.3743 (0.5939) acc_x 84.3750 (85.4688) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:663
clean false:6
clean_rate:0.9910313901345291
noisy true:571
noisy false:360
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [173/200] batch [5/20] time 0.206 (0.204) data 0.081 (0.079) loss_x loss_x 0.3848 (0.4850) acc_x 93.7500 (87.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/20] time 0.207 (0.204) data 0.084 (0.080) loss_x loss_x 0.3237 (0.5181) acc_x 90.6250 (87.8125) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/20] time 0.202 (0.205) data 0.076 (0.079) loss_x loss_x 0.4241 (0.5061) acc_x 90.6250 (87.7083) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/20] time 0.201 (0.204) data 0.078 (0.079) loss_x loss_x 0.6006 (0.5118) acc_x 87.5000 (87.9688) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:638
clean false:4
clean_rate:0.9937694704049844
noisy true:561
noisy false:397
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [174/200] batch [5/20] time 0.208 (0.205) data 0.083 (0.080) loss_x loss_x 0.2551 (0.4961) acc_x 93.7500 (87.5000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/20] time 0.201 (0.203) data 0.078 (0.079) loss_x loss_x 0.7100 (0.5415) acc_x 71.8750 (85.3125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/20] time 0.199 (0.203) data 0.075 (0.079) loss_x loss_x 0.3621 (0.5348) acc_x 87.5000 (86.2500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/20] time 0.215 (0.203) data 0.091 (0.080) loss_x loss_x 0.4351 (0.5032) acc_x 90.6250 (86.8750) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:652
clean false:2
clean_rate:0.9969418960244648
noisy true:594
noisy false:352
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [175/200] batch [5/20] time 0.204 (0.205) data 0.081 (0.079) loss_x loss_x 0.2498 (0.3688) acc_x 93.7500 (91.8750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/20] time 0.203 (0.204) data 0.077 (0.079) loss_x loss_x 0.5005 (0.4468) acc_x 90.6250 (90.3125) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/20] time 0.202 (0.204) data 0.077 (0.079) loss_x loss_x 0.4243 (0.4569) acc_x 78.1250 (88.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/20] time 0.204 (0.204) data 0.079 (0.079) loss_x loss_x 0.4092 (0.4957) acc_x 90.6250 (87.0312) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:654
clean false:4
clean_rate:0.993920972644377
noisy true:565
noisy false:377
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [176/200] batch [5/20] time 0.202 (0.208) data 0.078 (0.079) loss_x loss_x 0.5825 (0.6953) acc_x 87.5000 (82.5000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/20] time 0.205 (0.207) data 0.080 (0.079) loss_x loss_x 0.3599 (0.5961) acc_x 84.3750 (83.1250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/20] time 0.208 (0.206) data 0.080 (0.079) loss_x loss_x 0.6763 (0.5868) acc_x 81.2500 (83.7500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/20] time 0.203 (0.205) data 0.078 (0.079) loss_x loss_x 0.2449 (0.5818) acc_x 93.7500 (85.0000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 678
clean true:674
clean false:4
clean_rate:0.9941002949852508
noisy true:559
noisy false:363
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 922
epoch [177/200] batch [5/21] time 0.206 (0.205) data 0.078 (0.080) loss_x loss_x 0.3899 (0.4962) acc_x 87.5000 (86.2500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/21] time 0.204 (0.205) data 0.079 (0.080) loss_x loss_x 0.6909 (0.5104) acc_x 75.0000 (85.6250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/21] time 0.206 (0.201) data 0.083 (0.080) loss_x loss_x 0.2610 (0.4894) acc_x 96.8750 (87.0833) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/21] time 0.207 (0.202) data 0.081 (0.080) loss_x loss_x 0.5752 (0.5063) acc_x 84.3750 (87.0312) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:662
clean false:2
clean_rate:0.9969879518072289
noisy true:579
noisy false:357
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [178/200] batch [5/20] time 0.202 (0.198) data 0.076 (0.079) loss_x loss_x 0.5327 (0.4511) acc_x 87.5000 (87.5000) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/20] time 0.201 (0.201) data 0.077 (0.079) loss_x loss_x 0.5181 (0.4959) acc_x 87.5000 (86.8750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/20] time 0.202 (0.203) data 0.078 (0.080) loss_x loss_x 0.5854 (0.5490) acc_x 84.3750 (85.4167) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/20] time 0.207 (0.204) data 0.080 (0.080) loss_x loss_x 0.5703 (0.5395) acc_x 87.5000 (85.4688) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:654
clean false:1
clean_rate:0.9984732824427481
noisy true:581
noisy false:364
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [179/200] batch [5/20] time 0.202 (0.191) data 0.077 (0.078) loss_x loss_x 0.6772 (0.5008) acc_x 78.1250 (86.8750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/20] time 0.208 (0.199) data 0.078 (0.078) loss_x loss_x 0.7666 (0.5065) acc_x 81.2500 (87.1875) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/20] time 0.209 (0.202) data 0.081 (0.079) loss_x loss_x 0.4724 (0.5227) acc_x 90.6250 (86.6667) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/20] time 0.207 (0.203) data 0.081 (0.079) loss_x loss_x 0.5137 (0.5411) acc_x 81.2500 (85.7812) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 665
clean true:660
clean false:5
clean_rate:0.9924812030075187
noisy true:576
noisy false:359
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 935
epoch [180/200] batch [5/20] time 0.201 (0.204) data 0.077 (0.079) loss_x loss_x 0.7383 (0.5867) acc_x 78.1250 (84.3750) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/20] time 0.205 (0.203) data 0.081 (0.079) loss_x loss_x 0.8794 (0.5927) acc_x 81.2500 (83.7500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/20] time 0.199 (0.202) data 0.077 (0.079) loss_x loss_x 0.7529 (0.6034) acc_x 81.2500 (83.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/20] time 0.202 (0.200) data 0.079 (0.079) loss_x loss_x 0.3982 (0.5583) acc_x 87.5000 (84.8438) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.4156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 665
clean true:661
clean false:4
clean_rate:0.9939849624060151
noisy true:560
noisy false:375
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 935
epoch [181/200] batch [5/20] time 0.212 (0.207) data 0.087 (0.079) loss_x loss_x 0.6313 (0.5690) acc_x 84.3750 (81.2500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/20] time 0.203 (0.207) data 0.078 (0.079) loss_x loss_x 0.4355 (0.5631) acc_x 90.6250 (83.4375) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/20] time 0.204 (0.206) data 0.079 (0.079) loss_x loss_x 0.2708 (0.5219) acc_x 93.7500 (85.0000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/20] time 0.206 (0.205) data 0.081 (0.079) loss_x loss_x 0.5312 (0.4940) acc_x 87.5000 (85.9375) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:661
clean false:6
clean_rate:0.9910044977511244
noisy true:577
noisy false:356
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [182/200] batch [5/20] time 0.202 (0.203) data 0.078 (0.079) loss_x loss_x 0.2646 (0.4916) acc_x 96.8750 (85.6250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/20] time 0.208 (0.205) data 0.081 (0.079) loss_x loss_x 0.2629 (0.5164) acc_x 96.8750 (85.6250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/20] time 0.203 (0.206) data 0.076 (0.079) loss_x loss_x 0.4678 (0.5193) acc_x 87.5000 (85.6250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/20] time 0.205 (0.206) data 0.078 (0.079) loss_x loss_x 0.8398 (0.5064) acc_x 84.3750 (86.5625) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 656
clean true:650
clean false:6
clean_rate:0.9908536585365854
noisy true:587
noisy false:357
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 944
epoch [183/200] batch [5/20] time 0.210 (0.207) data 0.084 (0.081) loss_x loss_x 0.3379 (0.5031) acc_x 93.7500 (86.8750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/20] time 0.202 (0.204) data 0.077 (0.080) loss_x loss_x 0.2266 (0.5176) acc_x 93.7500 (86.5625) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/20] time 0.198 (0.204) data 0.075 (0.079) loss_x loss_x 0.3792 (0.5707) acc_x 87.5000 (85.6250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/20] time 0.202 (0.204) data 0.079 (0.079) loss_x loss_x 0.3467 (0.5513) acc_x 87.5000 (86.7188) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:659
clean false:7
clean_rate:0.9894894894894894
noisy true:554
noisy false:380
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [184/200] batch [5/20] time 0.204 (0.202) data 0.080 (0.081) loss_x loss_x 0.2056 (0.4199) acc_x 100.0000 (89.3750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/20] time 0.202 (0.203) data 0.077 (0.080) loss_x loss_x 0.5312 (0.4819) acc_x 81.2500 (87.8125) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/20] time 0.207 (0.198) data 0.081 (0.080) loss_x loss_x 0.7529 (0.5322) acc_x 84.3750 (86.6667) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [20/20] time 0.208 (0.200) data 0.079 (0.080) loss_x loss_x 1.2109 (0.5755) acc_x 81.2500 (86.5625) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:642
clean false:5
clean_rate:0.9922720247295209
noisy true:581
noisy false:372
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [185/200] batch [5/20] time 0.209 (0.205) data 0.082 (0.079) loss_x loss_x 0.4353 (0.3745) acc_x 87.5000 (90.0000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/20] time 0.206 (0.205) data 0.081 (0.079) loss_x loss_x 0.1225 (0.3501) acc_x 96.8750 (90.3125) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/20] time 0.203 (0.204) data 0.077 (0.079) loss_x loss_x 0.3569 (0.3739) acc_x 90.6250 (89.5833) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/20] time 0.203 (0.205) data 0.079 (0.079) loss_x loss_x 0.6143 (0.4145) acc_x 81.2500 (88.5938) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 657
clean true:652
clean false:5
clean_rate:0.9923896499238964
noisy true:577
noisy false:366
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 943
epoch [186/200] batch [5/20] time 0.206 (0.207) data 0.081 (0.081) loss_x loss_x 0.2568 (0.4165) acc_x 90.6250 (88.1250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/20] time 0.206 (0.206) data 0.077 (0.080) loss_x loss_x 0.4883 (0.4478) acc_x 90.6250 (88.4375) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/20] time 0.203 (0.206) data 0.079 (0.080) loss_x loss_x 0.6738 (0.4816) acc_x 90.6250 (88.1250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/20] time 0.206 (0.206) data 0.082 (0.080) loss_x loss_x 0.4089 (0.4859) acc_x 84.3750 (87.8125) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:646
clean false:4
clean_rate:0.9938461538461538
noisy true:581
noisy false:369
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [187/200] batch [5/20] time 0.206 (0.193) data 0.082 (0.080) loss_x loss_x 0.3022 (0.3588) acc_x 87.5000 (90.0000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/20] time 0.203 (0.198) data 0.079 (0.080) loss_x loss_x 0.2048 (0.3725) acc_x 87.5000 (90.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/20] time 0.205 (0.200) data 0.080 (0.080) loss_x loss_x 0.3503 (0.4627) acc_x 93.7500 (88.7500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/20] time 0.204 (0.201) data 0.079 (0.080) loss_x loss_x 0.4238 (0.5057) acc_x 84.3750 (87.3438) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:651
clean false:7
clean_rate:0.9893617021276596
noisy true:568
noisy false:374
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [188/200] batch [5/20] time 0.204 (0.204) data 0.079 (0.079) loss_x loss_x 1.0244 (0.7454) acc_x 75.0000 (79.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/20] time 0.208 (0.204) data 0.081 (0.079) loss_x loss_x 0.8994 (0.6492) acc_x 71.8750 (81.5625) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/20] time 0.205 (0.204) data 0.080 (0.079) loss_x loss_x 0.6533 (0.6183) acc_x 75.0000 (81.8750) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/20] time 0.203 (0.204) data 0.080 (0.079) loss_x loss_x 0.9580 (0.6147) acc_x 75.0000 (82.5000) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:649
clean false:4
clean_rate:0.9938744257274119
noisy true:562
noisy false:385
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [189/200] batch [5/20] time 0.201 (0.203) data 0.078 (0.079) loss_x loss_x 0.6123 (0.6572) acc_x 87.5000 (83.1250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/20] time 0.206 (0.205) data 0.078 (0.079) loss_x loss_x 0.4460 (0.6027) acc_x 84.3750 (84.3750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/20] time 0.208 (0.205) data 0.082 (0.079) loss_x loss_x 0.3171 (0.5653) acc_x 93.7500 (85.6250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/20] time 0.207 (0.205) data 0.078 (0.079) loss_x loss_x 0.3213 (0.5306) acc_x 90.6250 (85.9375) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:657
clean false:7
clean_rate:0.9894578313253012
noisy true:577
noisy false:359
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [190/200] batch [5/20] time 0.205 (0.203) data 0.081 (0.080) loss_x loss_x 0.2622 (0.5135) acc_x 96.8750 (87.5000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/20] time 0.206 (0.204) data 0.080 (0.079) loss_x loss_x 0.1780 (0.4878) acc_x 100.0000 (88.1250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/20] time 0.205 (0.204) data 0.078 (0.079) loss_x loss_x 0.5640 (0.4903) acc_x 81.2500 (87.0833) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/20] time 0.204 (0.204) data 0.078 (0.079) loss_x loss_x 0.5562 (0.4653) acc_x 87.5000 (87.9688) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:662
clean false:5
clean_rate:0.992503748125937
noisy true:580
noisy false:353
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [191/200] batch [5/20] time 0.202 (0.204) data 0.076 (0.079) loss_x loss_x 0.4238 (0.5293) acc_x 81.2500 (83.1250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/20] time 0.204 (0.204) data 0.079 (0.079) loss_x loss_x 0.7500 (0.5700) acc_x 87.5000 (84.3750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/20] time 0.204 (0.204) data 0.079 (0.079) loss_x loss_x 0.4619 (0.5433) acc_x 90.6250 (85.2083) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/20] time 0.207 (0.205) data 0.080 (0.079) loss_x loss_x 0.6040 (0.5461) acc_x 84.3750 (84.6875) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:661
clean false:1
clean_rate:0.9984894259818731
noisy true:548
noisy false:390
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [192/200] batch [5/20] time 0.200 (0.191) data 0.078 (0.079) loss_x loss_x 0.6147 (0.5942) acc_x 87.5000 (85.0000) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/20] time 0.205 (0.197) data 0.080 (0.078) loss_x loss_x 0.4106 (0.4863) acc_x 93.7500 (88.4375) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/20] time 0.201 (0.199) data 0.077 (0.079) loss_x loss_x 0.7349 (0.4872) acc_x 78.1250 (87.9167) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [20/20] time 0.204 (0.201) data 0.079 (0.079) loss_x loss_x 0.3982 (0.4690) acc_x 90.6250 (88.4375) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:665
clean false:2
clean_rate:0.9970014992503748
noisy true:554
noisy false:379
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [193/200] batch [5/20] time 0.206 (0.204) data 0.078 (0.078) loss_x loss_x 0.4575 (0.4880) acc_x 84.3750 (85.6250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/20] time 0.204 (0.204) data 0.079 (0.078) loss_x loss_x 0.4104 (0.5670) acc_x 87.5000 (85.3125) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/20] time 0.204 (0.204) data 0.076 (0.078) loss_x loss_x 1.0488 (0.6082) acc_x 78.1250 (84.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/20] time 0.201 (0.204) data 0.076 (0.078) loss_x loss_x 0.9717 (0.6210) acc_x 75.0000 (84.2188) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:643
clean false:4
clean_rate:0.9938176197836167
noisy true:560
noisy false:393
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [194/200] batch [5/20] time 0.209 (0.203) data 0.079 (0.079) loss_x loss_x 0.9346 (0.5761) acc_x 68.7500 (84.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/20] time 0.204 (0.203) data 0.081 (0.078) loss_x loss_x 0.3384 (0.5386) acc_x 90.6250 (85.6250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/20] time 0.206 (0.203) data 0.080 (0.079) loss_x loss_x 0.4617 (0.5049) acc_x 87.5000 (86.6667) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/20] time 0.205 (0.203) data 0.079 (0.079) loss_x loss_x 0.5771 (0.5011) acc_x 81.2500 (86.4062) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:662
clean false:6
clean_rate:0.9910179640718563
noisy true:569
noisy false:363
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [195/200] batch [5/20] time 0.208 (0.207) data 0.081 (0.080) loss_x loss_x 0.5723 (0.5121) acc_x 81.2500 (87.5000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/20] time 0.206 (0.206) data 0.080 (0.079) loss_x loss_x 0.5190 (0.6243) acc_x 84.3750 (85.0000) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/20] time 0.200 (0.207) data 0.076 (0.082) loss_x loss_x 0.9878 (0.6441) acc_x 71.8750 (84.1667) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/20] time 0.202 (0.206) data 0.079 (0.081) loss_x loss_x 0.4924 (0.5720) acc_x 84.3750 (85.6250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 682
clean true:675
clean false:7
clean_rate:0.9897360703812317
noisy true:555
noisy false:363
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 918
epoch [196/200] batch [5/21] time 0.208 (0.207) data 0.078 (0.079) loss_x loss_x 0.5527 (0.5700) acc_x 84.3750 (86.2500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/21] time 0.208 (0.208) data 0.079 (0.080) loss_x loss_x 0.4443 (0.5395) acc_x 81.2500 (84.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/21] time 0.157 (0.200) data 0.081 (0.079) loss_x loss_x 0.1896 (0.5452) acc_x 93.7500 (84.5833) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/21] time 0.209 (0.201) data 0.079 (0.080) loss_x loss_x 0.4138 (0.5526) acc_x 84.3750 (85.0000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:662
clean false:4
clean_rate:0.993993993993994
noisy true:556
noisy false:378
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [197/200] batch [5/20] time 0.212 (0.207) data 0.089 (0.081) loss_x loss_x 0.2786 (0.3588) acc_x 93.7500 (90.0000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/20] time 0.207 (0.206) data 0.080 (0.080) loss_x loss_x 0.1956 (0.4321) acc_x 96.8750 (88.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/20] time 0.200 (0.205) data 0.078 (0.080) loss_x loss_x 0.5522 (0.4800) acc_x 87.5000 (87.9167) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/20] time 0.207 (0.205) data 0.083 (0.079) loss_x loss_x 0.3704 (0.4865) acc_x 93.7500 (88.2812) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 364
confident_label rate tensor(0.4194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 671
clean true:665
clean false:6
clean_rate:0.9910581222056631
noisy true:571
noisy false:358
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 929
epoch [198/200] batch [5/20] time 0.208 (0.207) data 0.081 (0.080) loss_x loss_x 0.4246 (0.5706) acc_x 90.6250 (86.2500) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/20] time 0.208 (0.208) data 0.078 (0.080) loss_x loss_x 0.6958 (0.5824) acc_x 90.6250 (85.0000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/20] time 0.202 (0.207) data 0.078 (0.080) loss_x loss_x 0.4224 (0.5592) acc_x 90.6250 (86.6667) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/20] time 0.203 (0.206) data 0.077 (0.079) loss_x loss_x 0.3906 (0.5508) acc_x 90.6250 (86.7188) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:664
clean false:2
clean_rate:0.996996996996997
noisy true:570
noisy false:364
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [199/200] batch [5/20] time 0.207 (0.205) data 0.079 (0.079) loss_x loss_x 0.4417 (0.4797) acc_x 84.3750 (85.0000) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/20] time 0.206 (0.205) data 0.081 (0.079) loss_x loss_x 0.6621 (0.5336) acc_x 84.3750 (85.6250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/20] time 0.204 (0.205) data 0.078 (0.079) loss_x loss_x 0.3176 (0.4987) acc_x 90.6250 (86.4583) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/20] time 0.204 (0.205) data 0.080 (0.079) loss_x loss_x 0.4275 (0.4916) acc_x 90.6250 (86.5625) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.4244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 679
clean true:675
clean false:4
clean_rate:0.9941089837997055
noisy true:579
noisy false:342
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 921
epoch [200/200] batch [5/21] time 0.203 (0.205) data 0.078 (0.078) loss_x loss_x 0.2467 (0.6651) acc_x 90.6250 (85.0000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/21] time 0.206 (0.203) data 0.077 (0.078) loss_x loss_x 0.6831 (0.6110) acc_x 84.3750 (85.0000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/21] time 0.184 (0.203) data 0.083 (0.079) loss_x loss_x 0.4463 (0.5834) acc_x 93.7500 (85.4167) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/21] time 0.207 (0.203) data 0.078 (0.079) loss_x loss_x 0.3533 (0.5093) acc_x 93.7500 (87.6562) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,231
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 86.4%
Elapsed: 0:56:00
