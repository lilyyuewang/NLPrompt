***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.2400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 384
clean true:374
clean false:10
clean_rate:0.9739583333333334
noisy true:381
noisy false:835
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1216
epoch [1/200] batch [5/12] time 0.190 (0.204) data 0.113 (0.109) loss_x loss_x 2.6719 (2.6535) acc_x 56.2500 (64.3750) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/12] time 0.162 (0.197) data 0.086 (0.111) loss_x loss_x 2.5391 (2.6309) acc_x 65.6250 (62.8125) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 738
confident_label rate tensor(0.2706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 433
clean true:422
clean false:11
clean_rate:0.9745958429561201
noisy true:440
noisy false:727
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1167
epoch [2/200] batch [5/13] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.7842 (1.2703) acc_x 78.1250 (70.6250) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/13] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.7300 (1.1148) acc_x 78.1250 (73.1250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 552
confident_label rate tensor(0.3319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 531
clean true:527
clean false:4
clean_rate:0.992467043314501
noisy true:521
noisy false:548
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1069
epoch [3/200] batch [5/16] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.6548 (0.9393) acc_x 84.3750 (76.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/16] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.3074 (0.8773) acc_x 96.8750 (78.1250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/16] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.7534 (0.8456) acc_x 84.3750 (78.9583) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 531
confident_label rate tensor(0.3413, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 546
clean true:539
clean false:7
clean_rate:0.9871794871794872
noisy true:530
noisy false:524
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1054
epoch [4/200] batch [5/17] time 0.211 (0.189) data 0.135 (0.113) loss_x loss_x 0.8496 (0.8561) acc_x 75.0000 (76.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/17] time 0.182 (0.190) data 0.105 (0.114) loss_x loss_x 0.6182 (0.6851) acc_x 81.2500 (80.9375) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/17] time 0.260 (0.193) data 0.183 (0.116) loss_x loss_x 0.7070 (0.7412) acc_x 78.1250 (79.7917) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 528
confident_label rate tensor(0.3475, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 556
clean true:552
clean false:4
clean_rate:0.9928057553956835
noisy true:520
noisy false:524
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1044
epoch [5/200] batch [5/17] time 0.178 (0.180) data 0.101 (0.104) loss_x loss_x 0.9722 (0.9239) acc_x 71.8750 (74.3750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/17] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.5884 (0.9471) acc_x 81.2500 (75.3125) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/17] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 1.1709 (0.9395) acc_x 75.0000 (76.0417) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 507
confident_label rate tensor(0.3500, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 560
clean true:555
clean false:5
clean_rate:0.9910714285714286
noisy true:538
noisy false:502
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1040
epoch [6/200] batch [5/17] time 0.187 (0.178) data 0.110 (0.102) loss_x loss_x 0.4050 (0.6276) acc_x 90.6250 (82.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/17] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.5776 (0.7615) acc_x 78.1250 (77.8125) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/17] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.5259 (0.7631) acc_x 90.6250 (78.3333) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.3519, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 563
clean true:557
clean false:6
clean_rate:0.9893428063943162
noisy true:541
noisy false:496
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1037
epoch [7/200] batch [5/17] time 0.180 (0.185) data 0.104 (0.109) loss_x loss_x 1.2305 (0.8586) acc_x 75.0000 (81.2500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/17] time 0.191 (0.185) data 0.114 (0.108) loss_x loss_x 0.6367 (0.8083) acc_x 84.3750 (80.9375) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/17] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.9985 (0.8053) acc_x 68.7500 (79.7917) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.3537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 566
clean true:558
clean false:8
clean_rate:0.9858657243816255
noisy true:570
noisy false:464
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1034
epoch [8/200] batch [5/17] time 0.179 (0.177) data 0.103 (0.101) loss_x loss_x 1.5908 (1.0424) acc_x 59.3750 (75.6250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/17] time 0.184 (0.177) data 0.108 (0.101) loss_x loss_x 1.1387 (0.9127) acc_x 71.8750 (78.4375) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/17] time 0.184 (0.176) data 0.108 (0.100) loss_x loss_x 0.6382 (0.8848) acc_x 81.2500 (77.9167) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.3587, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 574
clean true:564
clean false:10
clean_rate:0.9825783972125436
noisy true:551
noisy false:475
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1026
epoch [9/200] batch [5/17] time 0.184 (0.184) data 0.108 (0.109) loss_x loss_x 0.7354 (0.7450) acc_x 78.1250 (79.3750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/17] time 0.169 (0.183) data 0.092 (0.107) loss_x loss_x 0.5850 (0.8395) acc_x 81.2500 (76.8750) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/17] time 0.183 (0.180) data 0.106 (0.104) loss_x loss_x 1.0957 (0.8415) acc_x 71.8750 (77.5000) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.3675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 588
clean true:582
clean false:6
clean_rate:0.9897959183673469
noisy true:551
noisy false:461
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1012
epoch [10/200] batch [5/18] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3181 (0.8135) acc_x 93.7500 (76.2500) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/18] time 0.183 (0.182) data 0.105 (0.106) loss_x loss_x 0.5996 (0.7565) acc_x 87.5000 (78.4375) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/18] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.9355 (0.7813) acc_x 81.2500 (78.3333) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.3525, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 564
clean true:559
clean false:5
clean_rate:0.9911347517730497
noisy true:551
noisy false:485
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1036
epoch [11/200] batch [5/17] time 0.177 (0.180) data 0.101 (0.104) loss_x loss_x 0.7998 (0.8843) acc_x 75.0000 (76.2500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/17] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 0.8164 (0.7709) acc_x 78.1250 (77.8125) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/17] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.8994 (0.7857) acc_x 78.1250 (77.7083) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 583
clean true:575
clean false:8
clean_rate:0.9862778730703259
noisy true:547
noisy false:470
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1017
epoch [12/200] batch [5/18] time 0.158 (0.159) data 0.083 (0.083) loss_x loss_x 0.8618 (0.6115) acc_x 78.1250 (84.3750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/18] time 0.183 (0.166) data 0.106 (0.090) loss_x loss_x 0.5957 (0.6614) acc_x 84.3750 (81.2500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/18] time 0.184 (0.172) data 0.108 (0.095) loss_x loss_x 0.8926 (0.7392) acc_x 81.2500 (79.1667) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 590
clean true:584
clean false:6
clean_rate:0.9898305084745763
noisy true:563
noisy false:447
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1010
epoch [13/200] batch [5/18] time 0.182 (0.181) data 0.107 (0.105) loss_x loss_x 0.9331 (0.8177) acc_x 71.8750 (74.3750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/18] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.7476 (0.6770) acc_x 78.1250 (79.3750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/18] time 0.158 (0.179) data 0.081 (0.103) loss_x loss_x 0.5928 (0.6824) acc_x 78.1250 (79.7917) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.3581, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 573
clean true:569
clean false:4
clean_rate:0.9930191972076788
noisy true:579
noisy false:448
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1027
epoch [14/200] batch [5/17] time 0.178 (0.180) data 0.102 (0.104) loss_x loss_x 1.4834 (1.0302) acc_x 65.6250 (72.5000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/17] time 0.183 (0.176) data 0.108 (0.099) loss_x loss_x 0.5093 (0.7728) acc_x 90.6250 (80.3125) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/17] time 0.179 (0.178) data 0.103 (0.102) loss_x loss_x 0.8594 (0.8032) acc_x 75.0000 (78.7500) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 605
clean true:600
clean false:5
clean_rate:0.9917355371900827
noisy true:556
noisy false:439
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 995
epoch [15/200] batch [5/18] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4553 (0.6312) acc_x 87.5000 (81.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/18] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 1.2705 (0.7778) acc_x 75.0000 (79.6875) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/18] time 0.185 (0.184) data 0.110 (0.108) loss_x loss_x 0.6543 (0.8068) acc_x 75.0000 (77.5000) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.3537, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 566
clean true:561
clean false:5
clean_rate:0.991166077738516
noisy true:554
noisy false:480
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1034
epoch [16/200] batch [5/17] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.3511 (0.5492) acc_x 90.6250 (85.0000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/17] time 0.229 (0.188) data 0.152 (0.112) loss_x loss_x 0.7930 (0.7409) acc_x 78.1250 (79.3750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/17] time 0.182 (0.186) data 0.104 (0.110) loss_x loss_x 0.4209 (0.7145) acc_x 87.5000 (80.4167) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.3556, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 569
clean true:563
clean false:6
clean_rate:0.9894551845342706
noisy true:563
noisy false:468
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1031
epoch [17/200] batch [5/17] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.5488 (0.7899) acc_x 81.2500 (76.8750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/17] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.8584 (0.6940) acc_x 81.2500 (80.9375) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/17] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.5215 (0.7000) acc_x 81.2500 (81.0417) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 607
clean true:600
clean false:7
clean_rate:0.9884678747940692
noisy true:556
noisy false:437
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 993
epoch [18/200] batch [5/18] time 0.191 (0.185) data 0.114 (0.108) loss_x loss_x 0.5854 (0.7117) acc_x 84.3750 (80.6250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/18] time 0.175 (0.180) data 0.099 (0.103) loss_x loss_x 0.7476 (0.6884) acc_x 84.3750 (81.5625) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/18] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.8174 (0.7034) acc_x 71.8750 (80.4167) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.3606, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 577
clean true:569
clean false:8
clean_rate:0.9861351819757366
noisy true:557
noisy false:466
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1023
epoch [19/200] batch [5/18] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.4519 (0.5056) acc_x 87.5000 (87.5000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/18] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.8867 (0.6135) acc_x 78.1250 (84.3750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/18] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.7280 (0.6774) acc_x 84.3750 (82.0833) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 595
clean true:587
clean false:8
clean_rate:0.9865546218487395
noisy true:557
noisy false:448
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1005
epoch [20/200] batch [5/18] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 1.0186 (0.7735) acc_x 62.5000 (79.3750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/18] time 0.182 (0.174) data 0.106 (0.097) loss_x loss_x 0.6982 (0.6994) acc_x 84.3750 (82.1875) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/18] time 0.194 (0.178) data 0.117 (0.101) loss_x loss_x 0.7539 (0.7504) acc_x 84.3750 (81.8750) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.3656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 585
clean true:580
clean false:5
clean_rate:0.9914529914529915
noisy true:555
noisy false:460
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1015
epoch [21/200] batch [5/18] time 0.190 (0.171) data 0.114 (0.094) loss_x loss_x 0.5449 (0.5981) acc_x 84.3750 (84.3750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/18] time 0.178 (0.174) data 0.102 (0.097) loss_x loss_x 0.5947 (0.6420) acc_x 84.3750 (84.6875) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/18] time 0.167 (0.173) data 0.091 (0.097) loss_x loss_x 1.0449 (0.6566) acc_x 78.1250 (84.3750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.3675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 588
clean true:581
clean false:7
clean_rate:0.9880952380952381
noisy true:573
noisy false:439
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1012
epoch [22/200] batch [5/18] time 0.192 (0.190) data 0.116 (0.114) loss_x loss_x 0.5000 (0.6763) acc_x 78.1250 (74.3750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/18] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 1.2080 (0.7605) acc_x 68.7500 (77.8125) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/18] time 0.182 (0.185) data 0.107 (0.109) loss_x loss_x 0.8618 (0.7739) acc_x 81.2500 (78.5417) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 596
clean true:588
clean false:8
clean_rate:0.9865771812080537
noisy true:564
noisy false:440
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1004
epoch [23/200] batch [5/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6284 (0.6694) acc_x 84.3750 (82.5000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/18] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.7310 (0.7245) acc_x 78.1250 (80.0000) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/18] time 0.164 (0.179) data 0.088 (0.102) loss_x loss_x 0.3921 (0.7469) acc_x 87.5000 (80.0000) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.3662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 586
clean true:579
clean false:7
clean_rate:0.9880546075085325
noisy true:550
noisy false:464
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1014
epoch [24/200] batch [5/18] time 0.191 (0.177) data 0.115 (0.101) loss_x loss_x 0.5044 (0.7174) acc_x 81.2500 (80.0000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/18] time 0.167 (0.176) data 0.091 (0.100) loss_x loss_x 0.7930 (0.7115) acc_x 78.1250 (80.3125) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/18] time 0.171 (0.175) data 0.095 (0.099) loss_x loss_x 1.0322 (0.7540) acc_x 78.1250 (80.2083) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 594
clean true:584
clean false:10
clean_rate:0.9831649831649831
noisy true:555
noisy false:451
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1006
epoch [25/200] batch [5/18] time 0.180 (0.174) data 0.104 (0.097) loss_x loss_x 0.7856 (0.7540) acc_x 84.3750 (81.8750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/18] time 0.174 (0.178) data 0.097 (0.102) loss_x loss_x 0.6538 (0.7954) acc_x 87.5000 (81.8750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/18] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 1.1748 (0.8313) acc_x 65.6250 (80.2083) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 591
clean true:584
clean false:7
clean_rate:0.988155668358714
noisy true:568
noisy false:441
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1009
epoch [26/200] batch [5/18] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.8818 (0.6599) acc_x 78.1250 (80.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/18] time 0.176 (0.182) data 0.100 (0.105) loss_x loss_x 1.3096 (0.7103) acc_x 65.6250 (80.0000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/18] time 0.179 (0.181) data 0.102 (0.105) loss_x loss_x 0.7002 (0.7083) acc_x 78.1250 (79.5833) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 604
clean true:597
clean false:7
clean_rate:0.9884105960264901
noisy true:559
noisy false:437
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 996
epoch [27/200] batch [5/18] time 0.158 (0.165) data 0.082 (0.089) loss_x loss_x 0.7476 (0.6604) acc_x 81.2500 (80.6250) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/18] time 0.162 (0.161) data 0.086 (0.085) loss_x loss_x 0.4570 (0.5381) acc_x 87.5000 (84.6875) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/18] time 0.168 (0.162) data 0.092 (0.085) loss_x loss_x 0.7432 (0.6005) acc_x 71.8750 (84.1667) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.3706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 593
clean true:587
clean false:6
clean_rate:0.9898819561551433
noisy true:549
noisy false:458
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1007
epoch [28/200] batch [5/18] time 0.187 (0.184) data 0.111 (0.107) loss_x loss_x 0.5161 (0.5898) acc_x 93.7500 (86.8750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/18] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.4219 (0.5784) acc_x 87.5000 (85.9375) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/18] time 0.181 (0.188) data 0.105 (0.111) loss_x loss_x 0.8970 (0.6621) acc_x 75.0000 (82.5000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 619
clean true:609
clean false:10
clean_rate:0.9838449111470113
noisy true:561
noisy false:420
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 981
epoch [29/200] batch [5/19] time 0.189 (0.183) data 0.113 (0.107) loss_x loss_x 0.8867 (0.8162) acc_x 78.1250 (81.2500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/19] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.9458 (0.8911) acc_x 71.8750 (78.4375) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/19] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.6235 (0.8268) acc_x 84.3750 (79.7917) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 618
clean true:611
clean false:7
clean_rate:0.988673139158576
noisy true:556
noisy false:426
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 982
epoch [30/200] batch [5/19] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.8447 (0.6109) acc_x 78.1250 (81.2500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/19] time 0.187 (0.170) data 0.111 (0.094) loss_x loss_x 0.5522 (0.7127) acc_x 84.3750 (80.6250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/19] time 0.182 (0.175) data 0.106 (0.099) loss_x loss_x 0.6558 (0.6684) acc_x 87.5000 (82.2917) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 601
clean true:593
clean false:8
clean_rate:0.9866888519134775
noisy true:577
noisy false:422
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 999
epoch [31/200] batch [5/18] time 0.161 (0.160) data 0.085 (0.084) loss_x loss_x 1.3340 (0.7110) acc_x 65.6250 (83.1250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/18] time 0.158 (0.165) data 0.081 (0.088) loss_x loss_x 0.6914 (0.7463) acc_x 78.1250 (79.0625) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/18] time 0.191 (0.172) data 0.115 (0.095) loss_x loss_x 0.6831 (0.7518) acc_x 84.3750 (80.2083) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 614
clean true:608
clean false:6
clean_rate:0.990228013029316
noisy true:574
noisy false:412
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 986
epoch [32/200] batch [5/19] time 0.180 (0.163) data 0.103 (0.087) loss_x loss_x 0.4526 (0.6232) acc_x 90.6250 (85.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/19] time 0.161 (0.162) data 0.085 (0.086) loss_x loss_x 0.6719 (0.5875) acc_x 75.0000 (84.0625) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/19] time 0.157 (0.161) data 0.081 (0.085) loss_x loss_x 1.1104 (0.6038) acc_x 81.2500 (84.1667) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 598
clean true:590
clean false:8
clean_rate:0.9866220735785953
noisy true:575
noisy false:427
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1002
epoch [33/200] batch [5/18] time 0.181 (0.171) data 0.105 (0.094) loss_x loss_x 0.8223 (0.7007) acc_x 75.0000 (79.3750) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/18] time 0.176 (0.175) data 0.098 (0.098) loss_x loss_x 0.9492 (0.7911) acc_x 78.1250 (79.3750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/18] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.6880 (0.7766) acc_x 84.3750 (80.8333) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 609
clean true:605
clean false:4
clean_rate:0.993431855500821
noisy true:552
noisy false:439
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 991
epoch [34/200] batch [5/19] time 0.183 (0.189) data 0.107 (0.113) loss_x loss_x 0.7974 (0.8701) acc_x 81.2500 (75.6250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/19] time 0.188 (0.186) data 0.112 (0.110) loss_x loss_x 0.9697 (0.7603) acc_x 75.0000 (77.5000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/19] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.1661 (0.7404) acc_x 96.8750 (79.1667) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 608
clean true:603
clean false:5
clean_rate:0.9917763157894737
noisy true:558
noisy false:434
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 992
epoch [35/200] batch [5/19] time 0.158 (0.175) data 0.082 (0.098) loss_x loss_x 0.5371 (0.4694) acc_x 87.5000 (86.2500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/19] time 0.182 (0.176) data 0.106 (0.100) loss_x loss_x 0.6650 (0.5688) acc_x 75.0000 (83.1250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/19] time 0.184 (0.176) data 0.108 (0.100) loss_x loss_x 0.7300 (0.6657) acc_x 81.2500 (81.4583) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 599
clean true:593
clean false:6
clean_rate:0.989983305509182
noisy true:562
noisy false:439
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1001
epoch [36/200] batch [5/18] time 0.182 (0.179) data 0.107 (0.102) loss_x loss_x 0.7480 (0.7338) acc_x 78.1250 (78.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/18] time 0.178 (0.177) data 0.102 (0.101) loss_x loss_x 0.7007 (0.7371) acc_x 78.1250 (79.0625) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/18] time 0.180 (0.178) data 0.104 (0.102) loss_x loss_x 0.6289 (0.7681) acc_x 78.1250 (78.3333) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.3706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 593
clean true:588
clean false:5
clean_rate:0.9915682967959528
noisy true:565
noisy false:442
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1007
epoch [37/200] batch [5/18] time 0.177 (0.181) data 0.100 (0.105) loss_x loss_x 1.4453 (0.6585) acc_x 71.8750 (85.0000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/18] time 0.196 (0.184) data 0.120 (0.108) loss_x loss_x 0.5156 (0.7060) acc_x 84.3750 (83.1250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/18] time 0.232 (0.182) data 0.157 (0.106) loss_x loss_x 0.7715 (0.7243) acc_x 78.1250 (82.7083) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 613
clean true:604
clean false:9
clean_rate:0.9853181076672104
noisy true:560
noisy false:427
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 987
epoch [38/200] batch [5/19] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.4905 (0.5205) acc_x 84.3750 (87.5000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/19] time 0.168 (0.175) data 0.092 (0.099) loss_x loss_x 0.7090 (0.6661) acc_x 87.5000 (83.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/19] time 0.164 (0.174) data 0.088 (0.098) loss_x loss_x 0.5127 (0.6544) acc_x 84.3750 (82.7083) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 609
clean true:602
clean false:7
clean_rate:0.9885057471264368
noisy true:556
noisy false:435
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 991
epoch [39/200] batch [5/19] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.8970 (0.7632) acc_x 78.1250 (80.6250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/19] time 0.177 (0.183) data 0.102 (0.107) loss_x loss_x 0.9478 (0.6621) acc_x 65.6250 (81.8750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/19] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 1.1846 (0.7345) acc_x 75.0000 (80.8333) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 603
clean true:600
clean false:3
clean_rate:0.9950248756218906
noisy true:565
noisy false:432
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 997
epoch [40/200] batch [5/18] time 0.159 (0.184) data 0.083 (0.108) loss_x loss_x 0.4468 (0.5579) acc_x 90.6250 (85.0000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/18] time 0.217 (0.184) data 0.141 (0.108) loss_x loss_x 0.4683 (0.5795) acc_x 90.6250 (84.6875) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/18] time 0.172 (0.185) data 0.096 (0.109) loss_x loss_x 0.7114 (0.6073) acc_x 75.0000 (83.3333) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 600
clean true:594
clean false:6
clean_rate:0.99
noisy true:567
noisy false:433
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1000
epoch [41/200] batch [5/18] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.6021 (0.6377) acc_x 84.3750 (84.3750) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/18] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 1.2432 (0.8861) acc_x 65.6250 (77.8125) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/18] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 1.1680 (0.8407) acc_x 71.8750 (78.5417) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 613
clean true:607
clean false:6
clean_rate:0.9902120717781403
noisy true:557
noisy false:430
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 987
epoch [42/200] batch [5/19] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.4863 (0.5346) acc_x 87.5000 (80.6250) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/19] time 0.182 (0.175) data 0.106 (0.098) loss_x loss_x 0.8750 (0.5558) acc_x 75.0000 (82.1875) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/19] time 0.182 (0.177) data 0.105 (0.101) loss_x loss_x 0.8950 (0.6218) acc_x 81.2500 (81.8750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 613
clean true:606
clean false:7
clean_rate:0.9885807504078303
noisy true:570
noisy false:417
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 987
epoch [43/200] batch [5/19] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.5854 (0.5834) acc_x 81.2500 (82.5000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/19] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.9995 (0.6600) acc_x 75.0000 (80.9375) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/19] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.5068 (0.6537) acc_x 87.5000 (82.7083) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.3844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 615
clean true:602
clean false:13
clean_rate:0.9788617886178862
noisy true:555
noisy false:430
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 985
epoch [44/200] batch [5/19] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.5513 (0.6784) acc_x 84.3750 (83.7500) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/19] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.6826 (0.7548) acc_x 78.1250 (81.2500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/19] time 0.157 (0.179) data 0.081 (0.103) loss_x loss_x 0.5483 (0.7184) acc_x 87.5000 (82.2917) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 628
clean true:614
clean false:14
clean_rate:0.9777070063694268
noisy true:547
noisy false:425
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 972
epoch [45/200] batch [5/19] time 0.183 (0.171) data 0.106 (0.095) loss_x loss_x 0.7847 (0.7427) acc_x 84.3750 (81.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/19] time 0.180 (0.174) data 0.104 (0.098) loss_x loss_x 0.3340 (0.6054) acc_x 93.7500 (84.0625) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/19] time 0.172 (0.177) data 0.095 (0.101) loss_x loss_x 0.4607 (0.5660) acc_x 90.6250 (85.6250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.3844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 615
clean true:610
clean false:5
clean_rate:0.991869918699187
noisy true:552
noisy false:433
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 985
epoch [46/200] batch [5/19] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.6426 (0.6962) acc_x 84.3750 (81.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/19] time 0.180 (0.182) data 0.105 (0.106) loss_x loss_x 0.5962 (0.6171) acc_x 81.2500 (82.8125) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/19] time 0.195 (0.184) data 0.119 (0.108) loss_x loss_x 0.4282 (0.5894) acc_x 84.3750 (83.9583) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:633
clean false:7
clean_rate:0.9890625
noisy true:546
noisy false:414
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [47/200] batch [5/20] time 0.182 (0.177) data 0.106 (0.101) loss_x loss_x 0.7866 (0.7479) acc_x 78.1250 (79.3750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/20] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.3438 (0.6784) acc_x 87.5000 (80.9375) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/20] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.7017 (0.7028) acc_x 81.2500 (79.5833) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [20/20] time 0.184 (0.188) data 0.108 (0.111) loss_x loss_x 0.5938 (0.7109) acc_x 81.2500 (79.6875) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.3844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 615
clean true:607
clean false:8
clean_rate:0.9869918699186991
noisy true:555
noisy false:430
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 985
epoch [48/200] batch [5/19] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7627 (0.6372) acc_x 81.2500 (83.7500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/19] time 0.168 (0.182) data 0.092 (0.106) loss_x loss_x 0.6860 (0.7214) acc_x 81.2500 (81.5625) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/19] time 0.175 (0.180) data 0.099 (0.104) loss_x loss_x 0.7271 (0.7034) acc_x 75.0000 (81.6667) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 608
clean true:603
clean false:5
clean_rate:0.9917763157894737
noisy true:573
noisy false:419
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 992
epoch [49/200] batch [5/19] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.3286 (0.5181) acc_x 87.5000 (86.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/19] time 0.202 (0.185) data 0.125 (0.109) loss_x loss_x 0.6909 (0.5203) acc_x 81.2500 (87.8125) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/19] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.7124 (0.6139) acc_x 81.2500 (85.0000) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 600
clean true:591
clean false:9
clean_rate:0.985
noisy true:562
noisy false:438
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1000
epoch [50/200] batch [5/18] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 0.3691 (0.6616) acc_x 96.8750 (83.1250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/18] time 0.161 (0.172) data 0.084 (0.096) loss_x loss_x 0.6113 (0.6597) acc_x 84.3750 (82.8125) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/18] time 0.184 (0.171) data 0.108 (0.094) loss_x loss_x 0.4438 (0.6603) acc_x 87.5000 (82.7083) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 623
clean true:615
clean false:8
clean_rate:0.9871589085072231
noisy true:573
noisy false:404
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 977
epoch [51/200] batch [5/19] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.7075 (0.6662) acc_x 78.1250 (82.5000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/19] time 0.180 (0.184) data 0.103 (0.108) loss_x loss_x 0.7397 (0.6961) acc_x 78.1250 (82.1875) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/19] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.5322 (0.6596) acc_x 78.1250 (83.1250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.3819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 611
clean true:603
clean false:8
clean_rate:0.9869067103109657
noisy true:548
noisy false:441
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 989
epoch [52/200] batch [5/19] time 0.177 (0.180) data 0.100 (0.104) loss_x loss_x 0.4851 (0.6065) acc_x 90.6250 (86.2500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/19] time 0.205 (0.184) data 0.128 (0.108) loss_x loss_x 0.9385 (0.5833) acc_x 78.1250 (85.3125) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/19] time 0.160 (0.179) data 0.084 (0.102) loss_x loss_x 0.6479 (0.5571) acc_x 78.1250 (84.7917) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.3912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 626
clean true:619
clean false:7
clean_rate:0.9888178913738019
noisy true:578
noisy false:396
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 974
epoch [53/200] batch [5/19] time 0.183 (0.188) data 0.107 (0.112) loss_x loss_x 0.6938 (0.6034) acc_x 84.3750 (85.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/19] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.3394 (0.5970) acc_x 87.5000 (85.3125) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/19] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.6128 (0.5478) acc_x 71.8750 (85.4167) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 626
clean true:617
clean false:9
clean_rate:0.9856230031948882
noisy true:559
noisy false:415
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 974
epoch [54/200] batch [5/19] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5732 (0.6018) acc_x 87.5000 (83.7500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/19] time 0.181 (0.185) data 0.106 (0.108) loss_x loss_x 0.8057 (0.6188) acc_x 81.2500 (84.0625) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/19] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.5874 (0.6119) acc_x 81.2500 (83.7500) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.3819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 611
clean true:604
clean false:7
clean_rate:0.9885433715220949
noisy true:558
noisy false:431
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 989
epoch [55/200] batch [5/19] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.5215 (0.5487) acc_x 81.2500 (81.2500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/19] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.5630 (0.5522) acc_x 84.3750 (83.4375) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/19] time 0.220 (0.189) data 0.144 (0.113) loss_x loss_x 0.4348 (0.5822) acc_x 84.3750 (82.9167) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3894, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 623
clean true:614
clean false:9
clean_rate:0.985553772070626
noisy true:557
noisy false:420
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 977
epoch [56/200] batch [5/19] time 0.184 (0.171) data 0.108 (0.094) loss_x loss_x 0.5591 (0.4785) acc_x 87.5000 (87.5000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/19] time 0.173 (0.174) data 0.095 (0.098) loss_x loss_x 0.4836 (0.5435) acc_x 84.3750 (85.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/19] time 0.166 (0.178) data 0.090 (0.101) loss_x loss_x 1.1816 (0.6182) acc_x 75.0000 (83.5417) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 633
clean true:625
clean false:8
clean_rate:0.9873617693522907
noisy true:563
noisy false:404
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 967
epoch [57/200] batch [5/19] time 0.157 (0.163) data 0.081 (0.087) loss_x loss_x 0.9150 (0.7386) acc_x 75.0000 (80.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/19] time 0.167 (0.167) data 0.091 (0.091) loss_x loss_x 0.7183 (0.6768) acc_x 75.0000 (81.8750) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/19] time 0.159 (0.168) data 0.083 (0.092) loss_x loss_x 0.5918 (0.6678) acc_x 81.2500 (82.7083) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 606
clean true:601
clean false:5
clean_rate:0.9917491749174917
noisy true:546
noisy false:448
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 994
epoch [58/200] batch [5/18] time 0.182 (0.188) data 0.106 (0.112) loss_x loss_x 0.8145 (0.5544) acc_x 81.2500 (84.3750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/18] time 0.184 (0.186) data 0.107 (0.110) loss_x loss_x 0.6157 (0.7011) acc_x 78.1250 (80.0000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/18] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5640 (0.6852) acc_x 84.3750 (81.4583) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 621
clean true:612
clean false:9
clean_rate:0.9855072463768116
noisy true:562
noisy false:417
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 979
epoch [59/200] batch [5/19] time 0.183 (0.183) data 0.107 (0.108) loss_x loss_x 0.9492 (0.7225) acc_x 78.1250 (82.5000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/19] time 0.187 (0.183) data 0.111 (0.107) loss_x loss_x 0.7231 (0.6281) acc_x 81.2500 (85.3125) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/19] time 0.182 (0.180) data 0.106 (0.104) loss_x loss_x 0.8032 (0.6250) acc_x 81.2500 (85.4167) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:613
clean false:11
clean_rate:0.9823717948717948
noisy true:575
noisy false:401
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [60/200] batch [5/19] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.6660 (0.7646) acc_x 75.0000 (76.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/19] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.7939 (0.7643) acc_x 81.2500 (78.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/19] time 0.165 (0.180) data 0.089 (0.103) loss_x loss_x 0.3975 (0.7453) acc_x 84.3750 (79.5833) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 630
clean true:618
clean false:12
clean_rate:0.9809523809523809
noisy true:546
noisy false:424
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 970
epoch [61/200] batch [5/19] time 0.219 (0.203) data 0.142 (0.127) loss_x loss_x 0.5142 (0.8278) acc_x 84.3750 (81.2500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/19] time 0.181 (0.197) data 0.106 (0.121) loss_x loss_x 0.9360 (0.7797) acc_x 71.8750 (79.6875) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/19] time 0.183 (0.192) data 0.105 (0.115) loss_x loss_x 0.5664 (0.7189) acc_x 81.2500 (80.8333) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 641
clean true:632
clean false:9
clean_rate:0.9859594383775351
noisy true:577
noisy false:382
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 959
epoch [62/200] batch [5/20] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.4714 (0.4798) acc_x 90.6250 (89.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/20] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.4675 (0.5963) acc_x 87.5000 (85.3125) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/20] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.8784 (0.6331) acc_x 75.0000 (84.3750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [20/20] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.6313 (0.6555) acc_x 84.3750 (83.4375) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 622
clean true:614
clean false:8
clean_rate:0.9871382636655949
noisy true:565
noisy false:413
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 978
epoch [63/200] batch [5/19] time 0.183 (0.169) data 0.105 (0.093) loss_x loss_x 0.5342 (0.5909) acc_x 84.3750 (83.7500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/19] time 0.181 (0.174) data 0.105 (0.098) loss_x loss_x 0.4077 (0.5312) acc_x 87.5000 (85.0000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/19] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.6221 (0.5684) acc_x 81.2500 (84.1667) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.3862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 618
clean true:613
clean false:5
clean_rate:0.9919093851132686
noisy true:577
noisy false:405
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 982
epoch [64/200] batch [5/19] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.7080 (0.6072) acc_x 71.8750 (81.2500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/19] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.8364 (0.6671) acc_x 81.2500 (80.6250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/19] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.5635 (0.6521) acc_x 84.3750 (82.2917) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 632
clean true:620
clean false:12
clean_rate:0.9810126582278481
noisy true:563
noisy false:405
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 968
epoch [65/200] batch [5/19] time 0.178 (0.182) data 0.100 (0.105) loss_x loss_x 0.7900 (0.6798) acc_x 84.3750 (84.3750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/19] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.4463 (0.6208) acc_x 87.5000 (85.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/19] time 0.187 (0.183) data 0.109 (0.106) loss_x loss_x 0.4133 (0.6202) acc_x 90.6250 (84.3750) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:617
clean false:7
clean_rate:0.9887820512820513
noisy true:567
noisy false:409
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [66/200] batch [5/19] time 0.195 (0.193) data 0.119 (0.116) loss_x loss_x 0.4958 (0.6597) acc_x 87.5000 (83.1250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/19] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.6265 (0.6652) acc_x 75.0000 (81.5625) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/19] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.8887 (0.6099) acc_x 81.2500 (83.3333) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 624
clean true:613
clean false:11
clean_rate:0.9823717948717948
noisy true:546
noisy false:430
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 976
epoch [67/200] batch [5/19] time 0.170 (0.179) data 0.092 (0.102) loss_x loss_x 1.2217 (0.6859) acc_x 62.5000 (81.2500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/19] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 1.0586 (0.6464) acc_x 87.5000 (84.3750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/19] time 0.188 (0.175) data 0.111 (0.098) loss_x loss_x 0.4285 (0.6373) acc_x 87.5000 (84.7917) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.3850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 616
clean true:608
clean false:8
clean_rate:0.987012987012987
noisy true:555
noisy false:429
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 984
epoch [68/200] batch [5/19] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.7041 (0.7421) acc_x 81.2500 (81.8750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/19] time 0.182 (0.191) data 0.105 (0.115) loss_x loss_x 0.6255 (0.7518) acc_x 81.2500 (81.2500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/19] time 0.182 (0.189) data 0.106 (0.112) loss_x loss_x 0.5713 (0.7022) acc_x 84.3750 (81.8750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.3950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 632
clean true:620
clean false:12
clean_rate:0.9810126582278481
noisy true:575
noisy false:393
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 968
epoch [69/200] batch [5/19] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.8145 (0.7797) acc_x 81.2500 (78.7500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/19] time 0.182 (0.180) data 0.105 (0.104) loss_x loss_x 0.4180 (0.6545) acc_x 87.5000 (83.4375) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/19] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.3298 (0.6165) acc_x 87.5000 (83.9583) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 641
clean true:633
clean false:8
clean_rate:0.9875195007800313
noisy true:564
noisy false:395
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 959
epoch [70/200] batch [5/20] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.6445 (0.7541) acc_x 84.3750 (81.8750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/20] time 0.160 (0.159) data 0.084 (0.082) loss_x loss_x 0.4487 (0.6583) acc_x 84.3750 (83.4375) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/20] time 0.163 (0.160) data 0.086 (0.083) loss_x loss_x 0.3894 (0.6798) acc_x 90.6250 (82.5000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [20/20] time 0.184 (0.162) data 0.108 (0.085) loss_x loss_x 0.5771 (0.6454) acc_x 84.3750 (83.5938) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 634
clean true:622
clean false:12
clean_rate:0.9810725552050473
noisy true:557
noisy false:409
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 966
epoch [71/200] batch [5/19] time 0.162 (0.165) data 0.086 (0.089) loss_x loss_x 0.5981 (0.6041) acc_x 87.5000 (85.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/19] time 0.178 (0.169) data 0.102 (0.093) loss_x loss_x 0.5952 (0.6352) acc_x 87.5000 (82.8125) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/19] time 0.162 (0.174) data 0.085 (0.098) loss_x loss_x 0.3201 (0.5775) acc_x 93.7500 (84.3750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 628
clean true:617
clean false:11
clean_rate:0.982484076433121
noisy true:556
noisy false:416
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 972
epoch [72/200] batch [5/19] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.8442 (0.5615) acc_x 71.8750 (81.2500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/19] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6416 (0.6388) acc_x 84.3750 (81.2500) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/19] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6396 (0.6762) acc_x 84.3750 (81.4583) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:632
clean false:8
clean_rate:0.9875
noisy true:562
noisy false:398
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [73/200] batch [5/20] time 0.180 (0.183) data 0.103 (0.107) loss_x loss_x 0.4604 (0.5133) acc_x 93.7500 (89.3750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/20] time 0.184 (0.179) data 0.107 (0.103) loss_x loss_x 0.7046 (0.5945) acc_x 84.3750 (85.6250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/20] time 0.183 (0.181) data 0.108 (0.104) loss_x loss_x 0.8130 (0.6425) acc_x 81.2500 (84.1667) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [20/20] time 0.181 (0.181) data 0.104 (0.105) loss_x loss_x 0.8364 (0.6615) acc_x 75.0000 (83.9062) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:640
clean false:10
clean_rate:0.9846153846153847
noisy true:572
noisy false:378
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [74/200] batch [5/20] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.5552 (0.5707) acc_x 84.3750 (87.5000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/20] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2554 (0.5643) acc_x 96.8750 (86.5625) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/20] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.7871 (0.6768) acc_x 68.7500 (83.3333) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [20/20] time 0.181 (0.184) data 0.106 (0.107) loss_x loss_x 0.8896 (0.6878) acc_x 81.2500 (82.6562) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:624
clean false:7
clean_rate:0.9889064976228209
noisy true:576
noisy false:393
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [75/200] batch [5/19] time 0.179 (0.180) data 0.103 (0.104) loss_x loss_x 0.8115 (0.6565) acc_x 78.1250 (82.5000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/19] time 0.242 (0.194) data 0.165 (0.118) loss_x loss_x 0.8169 (0.6560) acc_x 78.1250 (82.1875) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/19] time 0.199 (0.189) data 0.123 (0.112) loss_x loss_x 0.3418 (0.5984) acc_x 93.7500 (83.9583) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:622
clean false:9
clean_rate:0.9857369255150554
noisy true:564
noisy false:405
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [76/200] batch [5/19] time 0.185 (0.194) data 0.109 (0.118) loss_x loss_x 0.4873 (0.4960) acc_x 93.7500 (86.8750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/19] time 0.185 (0.191) data 0.109 (0.114) loss_x loss_x 0.5254 (0.5694) acc_x 87.5000 (86.5625) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/19] time 0.178 (0.188) data 0.102 (0.111) loss_x loss_x 0.5088 (0.5498) acc_x 87.5000 (86.4583) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:634
clean false:8
clean_rate:0.9875389408099688
noisy true:583
noisy false:375
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [77/200] batch [5/20] time 0.164 (0.172) data 0.088 (0.095) loss_x loss_x 0.8135 (0.7149) acc_x 81.2500 (81.8750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/20] time 0.176 (0.173) data 0.100 (0.096) loss_x loss_x 0.6416 (0.6296) acc_x 81.2500 (84.6875) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/20] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.7065 (0.6163) acc_x 78.1250 (83.5417) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [20/20] time 0.182 (0.177) data 0.106 (0.101) loss_x loss_x 0.7002 (0.6182) acc_x 81.2500 (83.7500) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.3850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 616
clean true:611
clean false:5
clean_rate:0.9918831168831169
noisy true:597
noisy false:387
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 984
epoch [78/200] batch [5/19] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.7290 (0.5216) acc_x 78.1250 (86.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/19] time 0.211 (0.183) data 0.135 (0.106) loss_x loss_x 0.4192 (0.5389) acc_x 90.6250 (85.0000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/19] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.6074 (0.5081) acc_x 81.2500 (85.6250) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:634
clean false:9
clean_rate:0.9860031104199067
noisy true:573
noisy false:384
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [79/200] batch [5/20] time 0.185 (0.189) data 0.109 (0.113) loss_x loss_x 0.6592 (0.6252) acc_x 81.2500 (82.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/20] time 0.191 (0.187) data 0.114 (0.111) loss_x loss_x 0.3167 (0.6395) acc_x 87.5000 (83.1250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/20] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.9692 (0.6985) acc_x 78.1250 (82.7083) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [20/20] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.5308 (0.6707) acc_x 81.2500 (82.8125) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.3962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 634
clean true:631
clean false:3
clean_rate:0.9952681388012619
noisy true:587
noisy false:379
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 966
epoch [80/200] batch [5/19] time 0.187 (0.188) data 0.110 (0.112) loss_x loss_x 0.4001 (0.5930) acc_x 87.5000 (83.1250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/19] time 0.170 (0.182) data 0.094 (0.106) loss_x loss_x 0.5264 (0.6496) acc_x 87.5000 (82.1875) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/19] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.6069 (0.6295) acc_x 87.5000 (82.9167) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.4006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 641
clean true:631
clean false:10
clean_rate:0.984399375975039
noisy true:555
noisy false:404
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 959
epoch [81/200] batch [5/20] time 0.164 (0.161) data 0.088 (0.085) loss_x loss_x 0.4800 (0.6048) acc_x 87.5000 (85.6250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/20] time 0.210 (0.167) data 0.134 (0.091) loss_x loss_x 0.5786 (0.6528) acc_x 84.3750 (83.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/20] time 0.166 (0.167) data 0.090 (0.091) loss_x loss_x 0.5103 (0.6293) acc_x 90.6250 (84.3750) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [20/20] time 0.159 (0.166) data 0.083 (0.090) loss_x loss_x 0.9639 (0.6357) acc_x 71.8750 (83.7500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:632
clean false:8
clean_rate:0.9875
noisy true:582
noisy false:378
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [82/200] batch [5/20] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 0.3149 (0.4727) acc_x 90.6250 (85.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/20] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.3872 (0.5540) acc_x 93.7500 (86.2500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/20] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.5581 (0.5956) acc_x 84.3750 (84.7917) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [20/20] time 0.185 (0.182) data 0.110 (0.106) loss_x loss_x 0.3257 (0.6077) acc_x 93.7500 (84.8438) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:642
clean false:10
clean_rate:0.9846625766871165
noisy true:583
noisy false:365
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [83/200] batch [5/20] time 0.182 (0.191) data 0.106 (0.114) loss_x loss_x 0.3430 (0.6648) acc_x 90.6250 (83.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/20] time 0.163 (0.182) data 0.087 (0.106) loss_x loss_x 0.7446 (0.6692) acc_x 84.3750 (82.1875) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/20] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.6182 (0.6551) acc_x 84.3750 (81.6667) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [20/20] time 0.178 (0.180) data 0.102 (0.104) loss_x loss_x 0.4590 (0.6049) acc_x 87.5000 (83.4375) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:641
clean false:9
clean_rate:0.9861538461538462
noisy true:581
noisy false:369
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [84/200] batch [5/20] time 0.194 (0.189) data 0.118 (0.113) loss_x loss_x 0.7212 (0.5208) acc_x 81.2500 (86.2500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/20] time 0.161 (0.183) data 0.084 (0.107) loss_x loss_x 0.4077 (0.5400) acc_x 93.7500 (86.5625) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/20] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.6733 (0.5962) acc_x 90.6250 (86.2500) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [20/20] time 0.182 (0.176) data 0.106 (0.100) loss_x loss_x 0.3191 (0.5926) acc_x 87.5000 (86.2500) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.3994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 639
clean true:631
clean false:8
clean_rate:0.9874804381846636
noisy true:570
noisy false:391
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 961
epoch [85/200] batch [5/19] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.3804 (0.6583) acc_x 84.3750 (85.0000) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/19] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.3093 (0.5516) acc_x 93.7500 (87.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/19] time 0.161 (0.177) data 0.085 (0.100) loss_x loss_x 0.2795 (0.5047) acc_x 90.6250 (87.2917) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:625
clean false:11
clean_rate:0.9827044025157232
noisy true:566
noisy false:398
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [86/200] batch [5/19] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.1368 (0.5536) acc_x 96.8750 (83.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/19] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 1.3613 (0.6684) acc_x 68.7500 (81.5625) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/19] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 1.1094 (0.6824) acc_x 78.1250 (81.2500) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 392
confident_label rate tensor(0.3919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 627
clean true:621
clean false:6
clean_rate:0.9904306220095693
noisy true:587
noisy false:386
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 973
epoch [87/200] batch [5/19] time 0.185 (0.196) data 0.109 (0.120) loss_x loss_x 0.3936 (0.5661) acc_x 84.3750 (81.8750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/19] time 0.181 (0.189) data 0.105 (0.113) loss_x loss_x 0.4646 (0.6220) acc_x 93.7500 (80.9375) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/19] time 0.182 (0.187) data 0.106 (0.111) loss_x loss_x 0.9136 (0.6157) acc_x 78.1250 (81.2500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:634
clean false:8
clean_rate:0.9875389408099688
noisy true:576
noisy false:382
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [88/200] batch [5/20] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.5757 (0.6153) acc_x 84.3750 (83.7500) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/20] time 0.224 (0.188) data 0.148 (0.112) loss_x loss_x 0.6743 (0.6169) acc_x 87.5000 (84.6875) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/20] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.6963 (0.5971) acc_x 75.0000 (83.7500) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [20/20] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.8110 (0.6240) acc_x 78.1250 (83.5938) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:630
clean false:10
clean_rate:0.984375
noisy true:568
noisy false:392
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [89/200] batch [5/20] time 0.181 (0.194) data 0.104 (0.118) loss_x loss_x 0.5918 (0.6174) acc_x 78.1250 (81.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/20] time 0.188 (0.189) data 0.112 (0.112) loss_x loss_x 0.4578 (0.5962) acc_x 90.6250 (83.4375) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/20] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.4648 (0.6229) acc_x 84.3750 (82.9167) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [20/20] time 0.178 (0.186) data 0.102 (0.109) loss_x loss_x 0.8896 (0.6642) acc_x 81.2500 (82.6562) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:644
clean false:9
clean_rate:0.9862174578866769
noisy true:585
noisy false:362
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [90/200] batch [5/20] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.7676 (0.7188) acc_x 78.1250 (81.8750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/20] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.8506 (0.7374) acc_x 71.8750 (80.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/20] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.7285 (0.7463) acc_x 81.2500 (80.4167) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [20/20] time 0.185 (0.184) data 0.110 (0.108) loss_x loss_x 0.4382 (0.7211) acc_x 90.6250 (81.2500) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:635
clean false:13
clean_rate:0.9799382716049383
noisy true:575
noisy false:377
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [91/200] batch [5/20] time 0.168 (0.174) data 0.092 (0.098) loss_x loss_x 0.2769 (0.5433) acc_x 87.5000 (86.2500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/20] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 1.2012 (0.5934) acc_x 78.1250 (85.6250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/20] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.6284 (0.6041) acc_x 81.2500 (85.2083) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [20/20] time 0.187 (0.184) data 0.111 (0.107) loss_x loss_x 0.9819 (0.6011) acc_x 65.6250 (84.6875) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 633
clean true:622
clean false:11
clean_rate:0.9826224328593997
noisy true:570
noisy false:397
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 967
epoch [92/200] batch [5/19] time 0.162 (0.182) data 0.086 (0.105) loss_x loss_x 0.3179 (0.6497) acc_x 93.7500 (86.2500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/19] time 0.160 (0.171) data 0.084 (0.095) loss_x loss_x 0.3464 (0.6397) acc_x 93.7500 (86.5625) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/19] time 0.179 (0.173) data 0.103 (0.097) loss_x loss_x 0.6885 (0.6468) acc_x 81.2500 (84.5833) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 633
clean true:623
clean false:10
clean_rate:0.9842022116903634
noisy true:553
noisy false:414
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 967
epoch [93/200] batch [5/19] time 0.185 (0.184) data 0.109 (0.108) loss_x loss_x 0.9463 (0.7653) acc_x 68.7500 (76.8750) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/19] time 0.187 (0.184) data 0.111 (0.108) loss_x loss_x 0.2145 (0.6410) acc_x 93.7500 (80.6250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/19] time 0.189 (0.184) data 0.113 (0.108) loss_x loss_x 1.0264 (0.6439) acc_x 81.2500 (82.2917) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:642
clean false:7
clean_rate:0.9892141756548536
noisy true:553
noisy false:398
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [94/200] batch [5/20] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.5923 (0.6205) acc_x 87.5000 (83.7500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/20] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.5693 (0.5924) acc_x 90.6250 (85.6250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/20] time 0.175 (0.180) data 0.100 (0.103) loss_x loss_x 0.7036 (0.6507) acc_x 84.3750 (84.3750) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [20/20] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.3950 (0.6562) acc_x 87.5000 (83.5938) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 634
clean true:627
clean false:7
clean_rate:0.9889589905362776
noisy true:558
noisy false:408
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 966
epoch [95/200] batch [5/19] time 0.183 (0.185) data 0.106 (0.109) loss_x loss_x 0.5610 (0.4607) acc_x 87.5000 (86.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/19] time 0.180 (0.190) data 0.104 (0.113) loss_x loss_x 0.4470 (0.4660) acc_x 90.6250 (86.8750) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/19] time 0.173 (0.185) data 0.096 (0.108) loss_x loss_x 0.7725 (0.5328) acc_x 81.2500 (86.0417) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 384
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 651
clean true:642
clean false:9
clean_rate:0.9861751152073732
noisy true:574
noisy false:375
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 949
epoch [96/200] batch [5/20] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.5112 (0.5858) acc_x 81.2500 (85.0000) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/20] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.2084 (0.5720) acc_x 93.7500 (85.3125) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/20] time 0.176 (0.184) data 0.100 (0.107) loss_x loss_x 0.6099 (0.5768) acc_x 78.1250 (83.9583) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [20/20] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 0.7695 (0.5768) acc_x 78.1250 (84.0625) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:641
clean false:13
clean_rate:0.9801223241590215
noisy true:552
noisy false:394
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [97/200] batch [5/20] time 0.184 (0.166) data 0.108 (0.090) loss_x loss_x 0.8237 (0.5594) acc_x 75.0000 (85.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/20] time 0.161 (0.165) data 0.085 (0.089) loss_x loss_x 0.6084 (0.6435) acc_x 84.3750 (84.0625) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/20] time 0.176 (0.165) data 0.099 (0.089) loss_x loss_x 0.4084 (0.6230) acc_x 90.6250 (85.4167) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [20/20] time 0.209 (0.171) data 0.133 (0.094) loss_x loss_x 0.4905 (0.6196) acc_x 84.3750 (85.1562) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:630
clean false:8
clean_rate:0.987460815047022
noisy true:570
noisy false:392
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [98/200] batch [5/19] time 0.164 (0.181) data 0.088 (0.105) loss_x loss_x 0.5171 (0.5695) acc_x 87.5000 (81.2500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/19] time 0.158 (0.173) data 0.082 (0.097) loss_x loss_x 0.9941 (0.6548) acc_x 78.1250 (81.8750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/19] time 0.156 (0.169) data 0.080 (0.093) loss_x loss_x 0.5796 (0.6308) acc_x 87.5000 (82.9167) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 651
clean true:645
clean false:6
clean_rate:0.9907834101382489
noisy true:559
noisy false:390
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 949
epoch [99/200] batch [5/20] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.2817 (0.7080) acc_x 90.6250 (81.8750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/20] time 0.178 (0.181) data 0.100 (0.104) loss_x loss_x 0.9800 (0.6569) acc_x 68.7500 (83.4375) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/20] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.3318 (0.5990) acc_x 93.7500 (85.6250) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [20/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.7686 (0.5908) acc_x 81.2500 (85.6250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:634
clean false:6
clean_rate:0.990625
noisy true:567
noisy false:393
all clean rate:  [0.9739583333333334, 0.9745958429561201, 0.992467043314501, 0.9871794871794872, 0.9928057553956835, 0.9910714285714286, 0.9893428063943162, 0.9858657243816255, 0.9825783972125436, 0.9897959183673469, 0.9911347517730497, 0.9862778730703259, 0.9898305084745763, 0.9930191972076788, 0.9917355371900827, 0.991166077738516, 0.9894551845342706, 0.9884678747940692, 0.9861351819757366, 0.9865546218487395, 0.9914529914529915, 0.9880952380952381, 0.9865771812080537, 0.9880546075085325, 0.9831649831649831, 0.988155668358714, 0.9884105960264901, 0.9898819561551433, 0.9838449111470113, 0.988673139158576, 0.9866888519134775, 0.990228013029316, 0.9866220735785953, 0.993431855500821, 0.9917763157894737, 0.989983305509182, 0.9915682967959528, 0.9853181076672104, 0.9885057471264368, 0.9950248756218906, 0.99, 0.9902120717781403, 0.9885807504078303, 0.9788617886178862, 0.9777070063694268, 0.991869918699187, 0.9890625, 0.9869918699186991, 0.9917763157894737, 0.985, 0.9871589085072231, 0.9869067103109657, 0.9888178913738019, 0.9856230031948882, 0.9885433715220949, 0.985553772070626, 0.9873617693522907, 0.9917491749174917, 0.9855072463768116, 0.9823717948717948, 0.9809523809523809, 0.9859594383775351, 0.9871382636655949, 0.9919093851132686, 0.9810126582278481, 0.9887820512820513, 0.9823717948717948, 0.987012987012987, 0.9810126582278481, 0.9875195007800313, 0.9810725552050473, 0.982484076433121, 0.9875, 0.9846153846153847, 0.9889064976228209, 0.9857369255150554, 0.9875389408099688, 0.9918831168831169, 0.9860031104199067, 0.9952681388012619, 0.984399375975039, 0.9875, 0.9846625766871165, 0.9861538461538462, 0.9874804381846636, 0.9827044025157232, 0.9904306220095693, 0.9875389408099688, 0.984375, 0.9862174578866769, 0.9799382716049383, 0.9826224328593997, 0.9842022116903634, 0.9892141756548536, 0.9889589905362776, 0.9861751152073732, 0.9801223241590215, 0.987460815047022, 0.9907834101382489, 0.990625]
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [100/200] batch [5/20] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.4773 (0.5690) acc_x 90.6250 (86.2500) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/20] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 1.0254 (0.5904) acc_x 81.2500 (87.1875) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/20] time 0.186 (0.183) data 0.110 (0.107) loss_x loss_x 0.5435 (0.5739) acc_x 81.2500 (85.6250) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [20/20] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.3020 (0.5449) acc_x 87.5000 (85.6250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:637
clean false:10
clean_rate:0.9845440494590417
noisy true:551
noisy false:402
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [101/200] batch [5/20] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.6562 (0.6924) acc_x 78.1250 (81.8750) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/20] time 0.169 (0.173) data 0.093 (0.097) loss_x loss_x 0.2281 (0.5360) acc_x 90.6250 (85.9375) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/20] time 0.186 (0.175) data 0.110 (0.098) loss_x loss_x 0.2883 (0.4711) acc_x 90.6250 (87.5000) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [20/20] time 0.181 (0.177) data 0.105 (0.101) loss_x loss_x 1.0566 (0.5359) acc_x 68.7500 (85.7812) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:650
clean false:4
clean_rate:0.9938837920489296
noisy true:575
noisy false:371
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [102/200] batch [5/20] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.3259 (0.6347) acc_x 87.5000 (83.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/20] time 0.179 (0.188) data 0.103 (0.111) loss_x loss_x 0.5200 (0.6470) acc_x 84.3750 (83.1250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/20] time 0.198 (0.187) data 0.121 (0.111) loss_x loss_x 0.6299 (0.6361) acc_x 78.1250 (82.2917) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [20/20] time 0.182 (0.189) data 0.106 (0.113) loss_x loss_x 0.5879 (0.6109) acc_x 84.3750 (83.2812) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:640
clean false:10
clean_rate:0.9846153846153847
noisy true:594
noisy false:356
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [103/200] batch [5/20] time 0.201 (0.186) data 0.124 (0.110) loss_x loss_x 0.4932 (0.5439) acc_x 90.6250 (84.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/20] time 0.179 (0.188) data 0.104 (0.112) loss_x loss_x 0.2520 (0.4818) acc_x 93.7500 (86.8750) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/20] time 0.184 (0.186) data 0.107 (0.110) loss_x loss_x 0.4573 (0.4912) acc_x 81.2500 (86.0417) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [20/20] time 0.181 (0.188) data 0.105 (0.112) loss_x loss_x 0.4824 (0.5260) acc_x 87.5000 (85.1562) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:630
clean false:6
clean_rate:0.9905660377358491
noisy true:570
noisy false:394
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [104/200] batch [5/19] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.9263 (0.7518) acc_x 78.1250 (80.0000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/19] time 0.211 (0.185) data 0.135 (0.109) loss_x loss_x 0.6465 (0.6853) acc_x 81.2500 (79.6875) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/19] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.6504 (0.6656) acc_x 87.5000 (80.8333) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:646
clean false:7
clean_rate:0.9892802450229708
noisy true:569
noisy false:378
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [105/200] batch [5/20] time 0.185 (0.191) data 0.108 (0.115) loss_x loss_x 0.4702 (0.4768) acc_x 87.5000 (87.5000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/20] time 0.160 (0.184) data 0.084 (0.108) loss_x loss_x 1.1270 (0.6560) acc_x 75.0000 (83.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/20] time 0.156 (0.176) data 0.080 (0.100) loss_x loss_x 0.4458 (0.6177) acc_x 81.2500 (84.1667) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [20/20] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.6064 (0.5853) acc_x 84.3750 (85.6250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:642
clean false:8
clean_rate:0.9876923076923076
noisy true:557
noisy false:393
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [106/200] batch [5/20] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.3972 (0.5426) acc_x 93.7500 (85.6250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/20] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.9297 (0.5806) acc_x 75.0000 (84.6875) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/20] time 0.186 (0.188) data 0.110 (0.111) loss_x loss_x 0.8398 (0.5975) acc_x 81.2500 (83.7500) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [20/20] time 0.182 (0.191) data 0.106 (0.115) loss_x loss_x 0.5137 (0.5929) acc_x 93.7500 (85.1562) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:643
clean false:11
clean_rate:0.9831804281345565
noisy true:555
noisy false:391
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [107/200] batch [5/20] time 0.173 (0.201) data 0.097 (0.125) loss_x loss_x 0.6714 (0.4519) acc_x 81.2500 (86.8750) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/20] time 0.196 (0.188) data 0.120 (0.112) loss_x loss_x 0.6284 (0.4894) acc_x 84.3750 (85.9375) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/20] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.7222 (0.5199) acc_x 81.2500 (85.2083) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [20/20] time 0.180 (0.186) data 0.104 (0.110) loss_x loss_x 0.4922 (0.5430) acc_x 90.6250 (84.2188) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:641
clean false:7
clean_rate:0.9891975308641975
noisy true:562
noisy false:390
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [108/200] batch [5/20] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 0.2988 (0.5098) acc_x 93.7500 (86.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/20] time 0.183 (0.179) data 0.107 (0.103) loss_x loss_x 0.6187 (0.5253) acc_x 81.2500 (85.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/20] time 0.202 (0.182) data 0.126 (0.106) loss_x loss_x 0.2798 (0.5800) acc_x 90.6250 (85.8333) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [20/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.3750 (0.6035) acc_x 87.5000 (84.8438) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 631
clean true:624
clean false:7
clean_rate:0.9889064976228209
noisy true:570
noisy false:399
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 969
epoch [109/200] batch [5/19] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.4434 (0.6328) acc_x 84.3750 (85.0000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/19] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 0.8213 (0.6256) acc_x 84.3750 (86.2500) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/19] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.2057 (0.5500) acc_x 96.8750 (87.5000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:641
clean false:6
clean_rate:0.990726429675425
noisy true:576
noisy false:377
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [110/200] batch [5/20] time 0.169 (0.189) data 0.093 (0.112) loss_x loss_x 0.3945 (0.5085) acc_x 87.5000 (84.3750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/20] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.2654 (0.4961) acc_x 90.6250 (86.2500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/20] time 0.166 (0.180) data 0.089 (0.104) loss_x loss_x 0.3501 (0.4941) acc_x 90.6250 (86.2500) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [20/20] time 0.159 (0.176) data 0.083 (0.099) loss_x loss_x 0.5054 (0.5132) acc_x 81.2500 (85.6250) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:633
clean false:10
clean_rate:0.9844479004665629
noisy true:580
noisy false:377
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [111/200] batch [5/20] time 0.188 (0.199) data 0.112 (0.123) loss_x loss_x 0.5210 (0.5127) acc_x 87.5000 (85.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/20] time 0.181 (0.194) data 0.105 (0.118) loss_x loss_x 0.6958 (0.5965) acc_x 71.8750 (82.1875) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/20] time 0.191 (0.191) data 0.115 (0.115) loss_x loss_x 0.3979 (0.6620) acc_x 90.6250 (81.0417) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [20/20] time 0.193 (0.188) data 0.117 (0.112) loss_x loss_x 0.5068 (0.6440) acc_x 90.6250 (82.1875) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:655
clean false:9
clean_rate:0.9864457831325302
noisy true:582
noisy false:354
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [112/200] batch [5/20] time 0.158 (0.180) data 0.082 (0.104) loss_x loss_x 0.3879 (0.6341) acc_x 87.5000 (83.1250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/20] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.4832 (0.5982) acc_x 84.3750 (83.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/20] time 0.184 (0.176) data 0.108 (0.100) loss_x loss_x 0.3125 (0.5684) acc_x 90.6250 (84.5833) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [20/20] time 0.199 (0.182) data 0.123 (0.106) loss_x loss_x 0.4277 (0.5943) acc_x 87.5000 (83.4375) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 640
clean true:631
clean false:9
clean_rate:0.9859375
noisy true:569
noisy false:391
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 960
epoch [113/200] batch [5/20] time 0.185 (0.197) data 0.107 (0.121) loss_x loss_x 0.3347 (0.5683) acc_x 90.6250 (85.6250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/20] time 0.164 (0.183) data 0.088 (0.107) loss_x loss_x 0.8315 (0.6175) acc_x 78.1250 (84.6875) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/20] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 1.0010 (0.6205) acc_x 78.1250 (84.3750) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [20/20] time 0.166 (0.178) data 0.090 (0.102) loss_x loss_x 0.5464 (0.6151) acc_x 84.3750 (84.2188) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:656
clean false:13
clean_rate:0.9805680119581465
noisy true:549
noisy false:382
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [114/200] batch [5/20] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.6860 (0.7180) acc_x 78.1250 (80.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/20] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.9136 (0.6784) acc_x 81.2500 (83.1250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/20] time 0.181 (0.179) data 0.105 (0.103) loss_x loss_x 0.4705 (0.6469) acc_x 87.5000 (84.5833) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [20/20] time 0.208 (0.181) data 0.131 (0.104) loss_x loss_x 0.9624 (0.6672) acc_x 78.1250 (83.5938) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:659
clean false:9
clean_rate:0.9865269461077845
noisy true:584
noisy false:348
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [115/200] batch [5/20] time 0.171 (0.181) data 0.094 (0.105) loss_x loss_x 0.8477 (0.4855) acc_x 81.2500 (86.8750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/20] time 0.194 (0.180) data 0.118 (0.103) loss_x loss_x 0.4841 (0.5443) acc_x 90.6250 (85.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/20] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.4375 (0.5572) acc_x 90.6250 (85.8333) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [20/20] time 0.166 (0.182) data 0.090 (0.105) loss_x loss_x 0.9604 (0.5723) acc_x 75.0000 (84.6875) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 647
clean true:635
clean false:12
clean_rate:0.98145285935085
noisy true:567
noisy false:386
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 953
epoch [116/200] batch [5/20] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 0.7529 (0.7812) acc_x 75.0000 (76.8750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/20] time 0.161 (0.165) data 0.085 (0.088) loss_x loss_x 0.5215 (0.6889) acc_x 90.6250 (81.5625) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/20] time 0.185 (0.167) data 0.109 (0.090) loss_x loss_x 0.9106 (0.6706) acc_x 75.0000 (82.2917) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [20/20] time 0.187 (0.172) data 0.110 (0.095) loss_x loss_x 0.4082 (0.6413) acc_x 90.6250 (83.2812) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:649
clean false:12
clean_rate:0.9818456883509834
noisy true:605
noisy false:334
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [117/200] batch [5/20] time 0.189 (0.185) data 0.112 (0.109) loss_x loss_x 0.4812 (0.7107) acc_x 81.2500 (80.0000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/20] time 0.182 (0.190) data 0.106 (0.113) loss_x loss_x 0.9619 (0.6650) acc_x 78.1250 (81.8750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/20] time 0.180 (0.186) data 0.104 (0.110) loss_x loss_x 1.1768 (0.6646) acc_x 71.8750 (82.2917) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [20/20] time 0.162 (0.181) data 0.086 (0.104) loss_x loss_x 0.6299 (0.6659) acc_x 84.3750 (82.5000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 358
confident_label rate tensor(0.4156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 665
clean true:657
clean false:8
clean_rate:0.98796992481203
noisy true:585
noisy false:350
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 935
epoch [118/200] batch [5/20] time 0.159 (0.173) data 0.082 (0.097) loss_x loss_x 0.8096 (0.5333) acc_x 81.2500 (88.1250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/20] time 0.193 (0.177) data 0.117 (0.101) loss_x loss_x 0.7100 (0.5132) acc_x 78.1250 (87.1875) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/20] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 0.7319 (0.5372) acc_x 81.2500 (85.6250) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [20/20] time 0.188 (0.178) data 0.112 (0.101) loss_x loss_x 0.4504 (0.5307) acc_x 93.7500 (85.7812) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:654
clean false:13
clean_rate:0.9805097451274363
noisy true:568
noisy false:365
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [119/200] batch [5/20] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.5854 (0.6080) acc_x 84.3750 (84.3750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/20] time 0.180 (0.183) data 0.103 (0.107) loss_x loss_x 0.1855 (0.5825) acc_x 96.8750 (85.0000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/20] time 0.163 (0.177) data 0.087 (0.101) loss_x loss_x 0.9941 (0.6511) acc_x 71.8750 (83.9583) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [20/20] time 0.161 (0.174) data 0.085 (0.098) loss_x loss_x 0.5449 (0.6650) acc_x 87.5000 (83.4375) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 645
clean true:639
clean false:6
clean_rate:0.9906976744186047
noisy true:580
noisy false:375
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 955
epoch [120/200] batch [5/20] time 0.186 (0.176) data 0.110 (0.100) loss_x loss_x 0.6484 (0.6974) acc_x 81.2500 (81.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/20] time 0.191 (0.182) data 0.114 (0.105) loss_x loss_x 0.5557 (0.6581) acc_x 87.5000 (82.1875) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/20] time 0.187 (0.186) data 0.111 (0.109) loss_x loss_x 0.6021 (0.6807) acc_x 87.5000 (83.3333) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [20/20] time 0.182 (0.186) data 0.106 (0.110) loss_x loss_x 0.5454 (0.6104) acc_x 87.5000 (84.6875) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:642
clean false:11
clean_rate:0.9831546707503829
noisy true:558
noisy false:389
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [121/200] batch [5/20] time 0.186 (0.208) data 0.110 (0.132) loss_x loss_x 0.8882 (0.6208) acc_x 75.0000 (81.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/20] time 0.167 (0.192) data 0.091 (0.115) loss_x loss_x 0.6743 (0.6477) acc_x 78.1250 (83.1250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/20] time 0.174 (0.188) data 0.098 (0.111) loss_x loss_x 0.3477 (0.6473) acc_x 90.6250 (83.5417) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [20/20] time 0.204 (0.186) data 0.128 (0.110) loss_x loss_x 0.2634 (0.6559) acc_x 93.7500 (84.0625) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.3975, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 636
clean true:632
clean false:4
clean_rate:0.9937106918238994
noisy true:563
noisy false:401
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 964
epoch [122/200] batch [5/19] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.3093 (0.5113) acc_x 96.8750 (87.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/19] time 0.184 (0.189) data 0.108 (0.113) loss_x loss_x 0.6162 (0.5253) acc_x 78.1250 (85.6250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/19] time 0.184 (0.187) data 0.109 (0.111) loss_x loss_x 0.5923 (0.4946) acc_x 81.2500 (86.6667) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 667
clean true:659
clean false:8
clean_rate:0.9880059970014993
noisy true:573
noisy false:360
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 933
epoch [123/200] batch [5/20] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.8252 (0.5017) acc_x 81.2500 (87.5000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/20] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.6543 (0.5329) acc_x 84.3750 (85.6250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/20] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.6855 (0.5177) acc_x 78.1250 (86.2500) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [20/20] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.3933 (0.5249) acc_x 90.6250 (86.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:633
clean false:9
clean_rate:0.985981308411215
noisy true:562
noisy false:396
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [124/200] batch [5/20] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.6792 (0.4972) acc_x 84.3750 (86.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/20] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.3542 (0.4859) acc_x 90.6250 (86.8750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/20] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.3906 (0.4547) acc_x 90.6250 (87.9167) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [20/20] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.6621 (0.4822) acc_x 84.3750 (87.3438) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:647
clean false:8
clean_rate:0.9877862595419847
noisy true:574
noisy false:371
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [125/200] batch [5/20] time 0.216 (0.192) data 0.139 (0.116) loss_x loss_x 0.7920 (0.5868) acc_x 78.1250 (85.6250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/20] time 0.184 (0.188) data 0.107 (0.112) loss_x loss_x 0.3862 (0.5882) acc_x 90.6250 (85.3125) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [15/20] time 0.168 (0.189) data 0.090 (0.112) loss_x loss_x 0.5181 (0.5310) acc_x 81.2500 (86.4583) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [20/20] time 0.178 (0.187) data 0.102 (0.110) loss_x loss_x 0.6123 (0.5278) acc_x 84.3750 (86.7188) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:649
clean false:9
clean_rate:0.986322188449848
noisy true:562
noisy false:380
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [126/200] batch [5/20] time 0.234 (0.214) data 0.158 (0.137) loss_x loss_x 0.7280 (0.4810) acc_x 81.2500 (88.1250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/20] time 0.202 (0.200) data 0.125 (0.123) loss_x loss_x 0.3823 (0.5277) acc_x 90.6250 (86.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/20] time 0.183 (0.200) data 0.107 (0.124) loss_x loss_x 0.3135 (0.5215) acc_x 90.6250 (86.0417) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/20] time 0.184 (0.196) data 0.108 (0.119) loss_x loss_x 0.5801 (0.5037) acc_x 90.6250 (87.3438) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:639
clean false:11
clean_rate:0.9830769230769231
noisy true:554
noisy false:396
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [127/200] batch [5/20] time 0.170 (0.169) data 0.093 (0.093) loss_x loss_x 0.1810 (0.5932) acc_x 96.8750 (85.0000) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/20] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.9795 (0.6546) acc_x 78.1250 (85.6250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/20] time 0.171 (0.176) data 0.095 (0.099) loss_x loss_x 0.2189 (0.5806) acc_x 90.6250 (86.0417) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [20/20] time 0.171 (0.178) data 0.094 (0.102) loss_x loss_x 0.2886 (0.5760) acc_x 90.6250 (85.7812) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 656
clean true:642
clean false:14
clean_rate:0.9786585365853658
noisy true:576
noisy false:368
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 944
epoch [128/200] batch [5/20] time 0.175 (0.190) data 0.099 (0.114) loss_x loss_x 0.8062 (0.5832) acc_x 84.3750 (90.0000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/20] time 0.179 (0.185) data 0.103 (0.108) loss_x loss_x 0.6387 (0.6394) acc_x 84.3750 (86.8750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/20] time 0.175 (0.179) data 0.099 (0.103) loss_x loss_x 0.9785 (0.6343) acc_x 68.7500 (85.0000) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [20/20] time 0.190 (0.182) data 0.114 (0.106) loss_x loss_x 0.8193 (0.6396) acc_x 81.2500 (84.6875) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:657
clean false:12
clean_rate:0.9820627802690582
noisy true:574
noisy false:357
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [129/200] batch [5/20] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.9834 (0.4904) acc_x 78.1250 (85.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/20] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 0.2627 (0.5123) acc_x 93.7500 (83.4375) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/20] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.4783 (0.5165) acc_x 90.6250 (85.2083) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [20/20] time 0.195 (0.184) data 0.118 (0.108) loss_x loss_x 0.8374 (0.5333) acc_x 78.1250 (84.5312) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:645
clean false:7
clean_rate:0.9892638036809815
noisy true:567
noisy false:381
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [130/200] batch [5/20] time 0.184 (0.165) data 0.107 (0.089) loss_x loss_x 0.3784 (0.3960) acc_x 87.5000 (88.7500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/20] time 0.179 (0.168) data 0.103 (0.092) loss_x loss_x 0.3906 (0.4263) acc_x 90.6250 (87.8125) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/20] time 0.168 (0.170) data 0.092 (0.094) loss_x loss_x 0.7983 (0.4889) acc_x 84.3750 (86.6667) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [20/20] time 0.203 (0.174) data 0.127 (0.097) loss_x loss_x 0.4958 (0.4943) acc_x 87.5000 (86.7188) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 651
clean true:641
clean false:10
clean_rate:0.9846390168970814
noisy true:579
noisy false:370
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 949
epoch [131/200] batch [5/20] time 0.161 (0.184) data 0.084 (0.108) loss_x loss_x 0.8813 (0.5786) acc_x 84.3750 (85.6250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/20] time 0.165 (0.175) data 0.089 (0.098) loss_x loss_x 0.5840 (0.5736) acc_x 81.2500 (85.3125) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/20] time 0.187 (0.178) data 0.111 (0.102) loss_x loss_x 0.9854 (0.5680) acc_x 81.2500 (86.0417) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [20/20] time 0.183 (0.179) data 0.107 (0.103) loss_x loss_x 0.4170 (0.5394) acc_x 90.6250 (86.7188) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:630
clean false:12
clean_rate:0.9813084112149533
noisy true:567
noisy false:391
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [132/200] batch [5/20] time 0.188 (0.191) data 0.112 (0.115) loss_x loss_x 0.5044 (0.4406) acc_x 87.5000 (88.7500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/20] time 0.180 (0.188) data 0.104 (0.112) loss_x loss_x 0.5957 (0.5721) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/20] time 0.201 (0.191) data 0.125 (0.115) loss_x loss_x 0.5776 (0.5593) acc_x 84.3750 (86.6667) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [20/20] time 0.196 (0.190) data 0.120 (0.114) loss_x loss_x 0.7065 (0.5338) acc_x 75.0000 (87.0312) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:642
clean false:8
clean_rate:0.9876923076923076
noisy true:577
noisy false:373
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [133/200] batch [5/20] time 0.183 (0.192) data 0.107 (0.115) loss_x loss_x 0.9297 (0.4717) acc_x 78.1250 (88.7500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/20] time 0.227 (0.196) data 0.151 (0.119) loss_x loss_x 0.5444 (0.5347) acc_x 81.2500 (86.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/20] time 0.184 (0.193) data 0.107 (0.116) loss_x loss_x 0.4705 (0.5074) acc_x 87.5000 (86.8750) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [20/20] time 0.175 (0.189) data 0.098 (0.113) loss_x loss_x 0.6978 (0.5615) acc_x 84.3750 (85.7812) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 368
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:651
clean false:7
clean_rate:0.9893617021276596
noisy true:581
noisy false:361
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [134/200] batch [5/20] time 0.195 (0.187) data 0.118 (0.111) loss_x loss_x 0.4604 (0.6192) acc_x 87.5000 (85.0000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/20] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.5132 (0.6615) acc_x 93.7500 (85.9375) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/20] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.4153 (0.6149) acc_x 84.3750 (85.4167) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [20/20] time 0.190 (0.184) data 0.114 (0.107) loss_x loss_x 0.4131 (0.5982) acc_x 87.5000 (85.6250) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 659
clean true:650
clean false:9
clean_rate:0.9863429438543247
noisy true:568
noisy false:373
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 941
epoch [135/200] batch [5/20] time 0.220 (0.201) data 0.143 (0.124) loss_x loss_x 0.3838 (0.5562) acc_x 93.7500 (86.2500) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/20] time 0.175 (0.187) data 0.098 (0.110) loss_x loss_x 0.8818 (0.5603) acc_x 75.0000 (84.6875) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/20] time 0.171 (0.186) data 0.094 (0.110) loss_x loss_x 0.3521 (0.5513) acc_x 93.7500 (84.7917) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [20/20] time 0.173 (0.182) data 0.097 (0.106) loss_x loss_x 0.4250 (0.5418) acc_x 90.6250 (85.1562) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.4100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 656
clean true:646
clean false:10
clean_rate:0.9847560975609756
noisy true:575
noisy false:369
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 944
epoch [136/200] batch [5/20] time 0.155 (0.175) data 0.079 (0.099) loss_x loss_x 0.6196 (0.5419) acc_x 84.3750 (86.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/20] time 0.169 (0.170) data 0.093 (0.094) loss_x loss_x 0.6533 (0.5694) acc_x 81.2500 (85.6250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/20] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.5972 (0.5830) acc_x 90.6250 (85.4167) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [20/20] time 0.207 (0.178) data 0.130 (0.101) loss_x loss_x 0.6816 (0.6085) acc_x 78.1250 (84.3750) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:649
clean false:6
clean_rate:0.9908396946564886
noisy true:584
noisy false:361
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [137/200] batch [5/20] time 0.201 (0.188) data 0.125 (0.112) loss_x loss_x 0.6870 (0.5611) acc_x 81.2500 (81.2500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/20] time 0.174 (0.184) data 0.098 (0.107) loss_x loss_x 0.3572 (0.5039) acc_x 90.6250 (84.3750) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/20] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.2031 (0.4678) acc_x 96.8750 (86.4583) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [20/20] time 0.163 (0.176) data 0.087 (0.099) loss_x loss_x 0.1932 (0.4486) acc_x 93.7500 (87.3438) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:639
clean false:10
clean_rate:0.9845916795069337
noisy true:557
noisy false:394
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [138/200] batch [5/20] time 0.190 (0.188) data 0.114 (0.112) loss_x loss_x 0.5396 (0.5843) acc_x 87.5000 (83.7500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/20] time 0.204 (0.188) data 0.128 (0.112) loss_x loss_x 0.5483 (0.5202) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/20] time 0.186 (0.186) data 0.109 (0.110) loss_x loss_x 0.5635 (0.5649) acc_x 78.1250 (83.9583) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [20/20] time 0.168 (0.185) data 0.091 (0.109) loss_x loss_x 0.4944 (0.5978) acc_x 87.5000 (83.5938) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 400
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 642
clean true:631
clean false:11
clean_rate:0.9828660436137072
noisy true:569
noisy false:389
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 958
epoch [139/200] batch [5/20] time 0.198 (0.187) data 0.122 (0.111) loss_x loss_x 0.2534 (0.4646) acc_x 93.7500 (89.3750) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/20] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.5542 (0.5648) acc_x 84.3750 (86.5625) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/20] time 0.175 (0.184) data 0.099 (0.107) loss_x loss_x 0.8687 (0.6064) acc_x 75.0000 (85.4167) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [20/20] time 0.185 (0.187) data 0.109 (0.111) loss_x loss_x 0.3315 (0.5573) acc_x 90.6250 (85.7812) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 645
clean true:639
clean false:6
clean_rate:0.9906976744186047
noisy true:581
noisy false:374
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 955
epoch [140/200] batch [5/20] time 0.191 (0.186) data 0.115 (0.110) loss_x loss_x 0.2998 (0.6145) acc_x 93.7500 (85.6250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/20] time 0.179 (0.184) data 0.103 (0.108) loss_x loss_x 0.3982 (0.5565) acc_x 84.3750 (85.6250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/20] time 0.192 (0.188) data 0.116 (0.112) loss_x loss_x 0.4390 (0.5903) acc_x 81.2500 (83.9583) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [20/20] time 0.187 (0.187) data 0.111 (0.111) loss_x loss_x 0.4099 (0.5805) acc_x 87.5000 (84.3750) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:647
clean false:6
clean_rate:0.9908116385911179
noisy true:577
noisy false:370
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [141/200] batch [5/20] time 0.168 (0.173) data 0.092 (0.097) loss_x loss_x 0.6777 (0.5760) acc_x 90.6250 (86.8750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/20] time 0.175 (0.172) data 0.099 (0.096) loss_x loss_x 0.7681 (0.6186) acc_x 84.3750 (85.6250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/20] time 0.170 (0.174) data 0.093 (0.098) loss_x loss_x 0.2690 (0.5706) acc_x 96.8750 (86.4583) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [20/20] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 0.3469 (0.5525) acc_x 93.7500 (86.8750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 371
confident_label rate tensor(0.4125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 660
clean true:650
clean false:10
clean_rate:0.9848484848484849
noisy true:579
noisy false:361
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 940
epoch [142/200] batch [5/20] time 0.170 (0.176) data 0.094 (0.099) loss_x loss_x 0.3687 (0.4915) acc_x 87.5000 (89.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/20] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.5405 (0.5398) acc_x 90.6250 (87.5000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/20] time 0.186 (0.178) data 0.110 (0.102) loss_x loss_x 0.4944 (0.4901) acc_x 87.5000 (87.9167) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [20/20] time 0.177 (0.178) data 0.100 (0.102) loss_x loss_x 0.9194 (0.5397) acc_x 81.2500 (86.5625) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:638
clean false:5
clean_rate:0.9922239502332815
noisy true:583
noisy false:374
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [143/200] batch [5/20] time 0.187 (0.192) data 0.111 (0.116) loss_x loss_x 0.4905 (0.5651) acc_x 87.5000 (84.3750) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/20] time 0.187 (0.189) data 0.109 (0.113) loss_x loss_x 0.6890 (0.5807) acc_x 81.2500 (84.3750) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/20] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.4448 (0.5547) acc_x 90.6250 (85.8333) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [20/20] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.5356 (0.5345) acc_x 87.5000 (86.7188) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 366
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 673
clean true:659
clean false:14
clean_rate:0.9791976225854383
noisy true:575
noisy false:352
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 927
epoch [144/200] batch [5/21] time 0.194 (0.183) data 0.117 (0.106) loss_x loss_x 0.6201 (0.6196) acc_x 81.2500 (81.8750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/21] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.4163 (0.5969) acc_x 93.7500 (84.0625) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/21] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.2413 (0.5314) acc_x 96.8750 (84.7917) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/21] time 0.164 (0.177) data 0.088 (0.100) loss_x loss_x 1.2734 (0.5874) acc_x 71.8750 (83.4375) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:643
clean false:12
clean_rate:0.981679389312977
noisy true:588
noisy false:357
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [145/200] batch [5/20] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 0.5513 (0.5141) acc_x 90.6250 (86.2500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/20] time 0.191 (0.181) data 0.115 (0.105) loss_x loss_x 0.5830 (0.5954) acc_x 84.3750 (84.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.6245 (0.5493) acc_x 87.5000 (85.8333) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [20/20] time 0.237 (0.189) data 0.161 (0.113) loss_x loss_x 0.7979 (0.5469) acc_x 78.1250 (85.4688) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 657
clean true:646
clean false:11
clean_rate:0.9832572298325722
noisy true:556
noisy false:387
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 943
epoch [146/200] batch [5/20] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.3438 (0.5097) acc_x 90.6250 (86.8750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/20] time 0.182 (0.186) data 0.105 (0.110) loss_x loss_x 0.5415 (0.6149) acc_x 90.6250 (84.0625) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/20] time 0.211 (0.190) data 0.135 (0.113) loss_x loss_x 0.2925 (0.6481) acc_x 93.7500 (84.3750) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [20/20] time 0.208 (0.192) data 0.132 (0.116) loss_x loss_x 0.4495 (0.6447) acc_x 84.3750 (84.0625) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:645
clean false:7
clean_rate:0.9892638036809815
noisy true:570
noisy false:378
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [147/200] batch [5/20] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.6318 (0.5500) acc_x 78.1250 (86.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/20] time 0.220 (0.192) data 0.144 (0.115) loss_x loss_x 0.8296 (0.6149) acc_x 71.8750 (85.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/20] time 0.193 (0.185) data 0.116 (0.108) loss_x loss_x 0.4158 (0.6565) acc_x 93.7500 (84.7917) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [20/20] time 0.172 (0.181) data 0.096 (0.105) loss_x loss_x 0.9487 (0.6595) acc_x 81.2500 (85.3125) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:647
clean false:7
clean_rate:0.9892966360856269
noisy true:552
noisy false:394
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [148/200] batch [5/20] time 0.163 (0.169) data 0.087 (0.092) loss_x loss_x 0.6680 (0.6299) acc_x 84.3750 (79.3750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/20] time 0.168 (0.166) data 0.092 (0.090) loss_x loss_x 0.7227 (0.5542) acc_x 75.0000 (83.1250) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/20] time 0.169 (0.167) data 0.093 (0.091) loss_x loss_x 0.3113 (0.5265) acc_x 90.6250 (83.9583) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [20/20] time 0.223 (0.173) data 0.147 (0.097) loss_x loss_x 0.2590 (0.5440) acc_x 87.5000 (84.3750) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 651
clean true:644
clean false:7
clean_rate:0.989247311827957
noisy true:543
noisy false:406
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 949
epoch [149/200] batch [5/20] time 0.157 (0.166) data 0.081 (0.089) loss_x loss_x 1.1895 (0.7340) acc_x 71.8750 (80.6250) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/20] time 0.179 (0.171) data 0.102 (0.094) loss_x loss_x 0.3442 (0.5743) acc_x 93.7500 (85.3125) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [15/20] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.2288 (0.5763) acc_x 93.7500 (85.6250) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [20/20] time 0.160 (0.176) data 0.084 (0.099) loss_x loss_x 0.3066 (0.5320) acc_x 90.6250 (86.4062) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 374
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:654
clean false:12
clean_rate:0.9819819819819819
noisy true:572
noisy false:362
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [150/200] batch [5/20] time 0.177 (0.183) data 0.100 (0.107) loss_x loss_x 0.5508 (0.4354) acc_x 81.2500 (88.7500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/20] time 0.191 (0.180) data 0.114 (0.104) loss_x loss_x 0.5181 (0.5116) acc_x 93.7500 (88.1250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/20] time 0.171 (0.176) data 0.095 (0.099) loss_x loss_x 0.2981 (0.5744) acc_x 96.8750 (86.2500) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [20/20] time 0.170 (0.173) data 0.094 (0.097) loss_x loss_x 0.8682 (0.5988) acc_x 84.3750 (85.3125) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 362
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:650
clean false:11
clean_rate:0.983358547655068
noisy true:588
noisy false:351
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [151/200] batch [5/20] time 0.187 (0.197) data 0.111 (0.120) loss_x loss_x 0.9341 (0.5169) acc_x 81.2500 (88.1250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/20] time 0.168 (0.191) data 0.091 (0.114) loss_x loss_x 0.9805 (0.6481) acc_x 84.3750 (85.3125) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/20] time 0.171 (0.184) data 0.095 (0.107) loss_x loss_x 0.7700 (0.6384) acc_x 81.2500 (85.0000) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [20/20] time 0.165 (0.179) data 0.089 (0.102) loss_x loss_x 0.7310 (0.6403) acc_x 78.1250 (84.3750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:643
clean false:6
clean_rate:0.9907550077041603
noisy true:570
noisy false:381
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [152/200] batch [5/20] time 0.185 (0.190) data 0.109 (0.113) loss_x loss_x 0.2744 (0.4061) acc_x 96.8750 (90.6250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/20] time 0.196 (0.191) data 0.120 (0.114) loss_x loss_x 0.1851 (0.3846) acc_x 96.8750 (91.2500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/20] time 0.175 (0.185) data 0.098 (0.108) loss_x loss_x 0.6333 (0.4383) acc_x 84.3750 (89.7917) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [20/20] time 0.158 (0.181) data 0.081 (0.105) loss_x loss_x 0.5566 (0.4779) acc_x 87.5000 (88.4375) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:644
clean false:10
clean_rate:0.9847094801223242
noisy true:581
noisy false:365
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [153/200] batch [5/20] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.6943 (0.4932) acc_x 81.2500 (88.1250) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/20] time 0.167 (0.178) data 0.091 (0.102) loss_x loss_x 0.9219 (0.5358) acc_x 71.8750 (85.6250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/20] time 0.176 (0.176) data 0.100 (0.100) loss_x loss_x 0.5400 (0.5515) acc_x 87.5000 (85.4167) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [20/20] time 0.157 (0.177) data 0.081 (0.101) loss_x loss_x 0.4138 (0.5371) acc_x 93.7500 (85.9375) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:662
clean false:8
clean_rate:0.9880597014925373
noisy true:569
noisy false:361
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [154/200] batch [5/20] time 0.190 (0.200) data 0.114 (0.124) loss_x loss_x 0.3379 (0.3610) acc_x 87.5000 (90.0000) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/20] time 0.183 (0.193) data 0.107 (0.116) loss_x loss_x 0.3110 (0.4616) acc_x 93.7500 (88.4375) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/20] time 0.183 (0.190) data 0.106 (0.114) loss_x loss_x 0.5171 (0.4440) acc_x 84.3750 (89.1667) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [20/20] time 0.172 (0.189) data 0.095 (0.113) loss_x loss_x 0.5093 (0.4524) acc_x 81.2500 (88.2812) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:643
clean false:9
clean_rate:0.9861963190184049
noisy true:559
noisy false:389
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [155/200] batch [5/20] time 0.200 (0.181) data 0.124 (0.104) loss_x loss_x 0.5464 (0.6288) acc_x 90.6250 (85.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/20] time 0.181 (0.180) data 0.105 (0.103) loss_x loss_x 0.4792 (0.5210) acc_x 90.6250 (88.4375) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/20] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 0.3901 (0.5441) acc_x 84.3750 (87.5000) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [20/20] time 0.174 (0.180) data 0.097 (0.104) loss_x loss_x 0.7051 (0.5561) acc_x 78.1250 (86.5625) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:644
clean false:11
clean_rate:0.983206106870229
noisy true:561
noisy false:384
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [156/200] batch [5/20] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.2019 (0.4676) acc_x 96.8750 (87.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/20] time 0.167 (0.174) data 0.091 (0.097) loss_x loss_x 0.4131 (0.5089) acc_x 90.6250 (85.6250) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/20] time 0.179 (0.173) data 0.103 (0.097) loss_x loss_x 0.5957 (0.5188) acc_x 84.3750 (85.0000) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [20/20] time 0.165 (0.173) data 0.089 (0.097) loss_x loss_x 0.5386 (0.5078) acc_x 84.3750 (85.4688) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 357
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:662
clean false:8
clean_rate:0.9880597014925373
noisy true:581
noisy false:349
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [157/200] batch [5/20] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.9980 (0.6506) acc_x 78.1250 (83.7500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/20] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.5723 (0.6042) acc_x 84.3750 (85.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/20] time 0.172 (0.174) data 0.095 (0.098) loss_x loss_x 0.7788 (0.6219) acc_x 78.1250 (85.0000) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [20/20] time 0.169 (0.173) data 0.093 (0.096) loss_x loss_x 0.4939 (0.5926) acc_x 81.2500 (84.6875) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.4119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 659
clean true:646
clean false:13
clean_rate:0.9802731411229135
noisy true:564
noisy false:377
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 941
epoch [158/200] batch [5/20] time 0.160 (0.182) data 0.083 (0.105) loss_x loss_x 0.5127 (0.5925) acc_x 78.1250 (82.5000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/20] time 0.165 (0.177) data 0.089 (0.101) loss_x loss_x 0.4656 (0.6037) acc_x 90.6250 (84.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/20] time 0.161 (0.172) data 0.085 (0.096) loss_x loss_x 0.4297 (0.6160) acc_x 90.6250 (84.5833) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [20/20] time 0.174 (0.171) data 0.098 (0.095) loss_x loss_x 0.4233 (0.6297) acc_x 87.5000 (83.9062) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 649
clean true:640
clean false:9
clean_rate:0.9861325115562404
noisy true:573
noisy false:378
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 951
epoch [159/200] batch [5/20] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.5840 (0.5512) acc_x 87.5000 (85.6250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/20] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.8174 (0.5974) acc_x 78.1250 (84.6875) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/20] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.4607 (0.5415) acc_x 90.6250 (87.0833) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [20/20] time 0.188 (0.183) data 0.112 (0.107) loss_x loss_x 0.2766 (0.5399) acc_x 96.8750 (87.0312) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:658
clean false:8
clean_rate:0.987987987987988
noisy true:569
noisy false:365
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [160/200] batch [5/20] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.4675 (0.6130) acc_x 90.6250 (86.8750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/20] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.9136 (0.5591) acc_x 81.2500 (86.8750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/20] time 0.174 (0.183) data 0.097 (0.107) loss_x loss_x 0.6714 (0.5532) acc_x 81.2500 (87.0833) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [20/20] time 0.200 (0.180) data 0.124 (0.104) loss_x loss_x 0.4094 (0.5375) acc_x 87.5000 (87.1875) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:658
clean false:10
clean_rate:0.9850299401197605
noisy true:559
noisy false:373
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [161/200] batch [5/20] time 0.171 (0.182) data 0.095 (0.105) loss_x loss_x 0.3616 (0.4714) acc_x 90.6250 (88.1250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/20] time 0.164 (0.174) data 0.088 (0.097) loss_x loss_x 0.5576 (0.4512) acc_x 87.5000 (89.0625) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/20] time 0.168 (0.172) data 0.092 (0.095) loss_x loss_x 0.4167 (0.4123) acc_x 87.5000 (88.9583) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [20/20] time 0.175 (0.173) data 0.098 (0.097) loss_x loss_x 0.9053 (0.4771) acc_x 87.5000 (87.6562) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:661
clean false:9
clean_rate:0.9865671641791045
noisy true:576
noisy false:354
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [162/200] batch [5/20] time 0.165 (0.167) data 0.088 (0.090) loss_x loss_x 0.3342 (0.4019) acc_x 87.5000 (89.3750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/20] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.4480 (0.4374) acc_x 87.5000 (88.7500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/20] time 0.170 (0.175) data 0.094 (0.099) loss_x loss_x 0.8140 (0.4619) acc_x 84.3750 (88.3333) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [20/20] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.4956 (0.4619) acc_x 90.6250 (87.8125) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 373
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:650
clean false:12
clean_rate:0.9818731117824774
noisy true:577
noisy false:361
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [163/200] batch [5/20] time 0.175 (0.168) data 0.099 (0.092) loss_x loss_x 0.4902 (0.5667) acc_x 78.1250 (83.7500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/20] time 0.161 (0.166) data 0.084 (0.090) loss_x loss_x 0.4773 (0.5479) acc_x 90.6250 (86.5625) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/20] time 0.174 (0.168) data 0.098 (0.091) loss_x loss_x 0.5029 (0.4968) acc_x 90.6250 (87.9167) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [20/20] time 0.176 (0.169) data 0.099 (0.092) loss_x loss_x 0.3059 (0.5229) acc_x 87.5000 (86.5625) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:654
clean false:12
clean_rate:0.9819819819819819
noisy true:581
noisy false:353
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [164/200] batch [5/20] time 0.171 (0.178) data 0.095 (0.101) loss_x loss_x 0.8965 (0.6328) acc_x 78.1250 (85.6250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/20] time 0.191 (0.185) data 0.115 (0.109) loss_x loss_x 0.4043 (0.5964) acc_x 90.6250 (86.5625) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/20] time 0.165 (0.181) data 0.089 (0.105) loss_x loss_x 0.3259 (0.5557) acc_x 87.5000 (87.0833) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [20/20] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.8042 (0.5649) acc_x 90.6250 (87.0312) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 376
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:654
clean false:8
clean_rate:0.9879154078549849
noisy true:570
noisy false:368
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [165/200] batch [5/20] time 0.171 (0.179) data 0.095 (0.102) loss_x loss_x 0.8252 (0.7525) acc_x 84.3750 (83.1250) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/20] time 0.180 (0.175) data 0.103 (0.099) loss_x loss_x 0.2937 (0.5643) acc_x 93.7500 (86.2500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/20] time 0.169 (0.176) data 0.093 (0.099) loss_x loss_x 0.5176 (0.5386) acc_x 78.1250 (86.4583) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [20/20] time 0.163 (0.173) data 0.087 (0.097) loss_x loss_x 0.9336 (0.5328) acc_x 65.6250 (86.2500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 387
confident_label rate tensor(0.3987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 638
clean true:632
clean false:6
clean_rate:0.9905956112852664
noisy true:581
noisy false:381
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 962
epoch [166/200] batch [5/19] time 0.164 (0.187) data 0.087 (0.110) loss_x loss_x 0.5474 (0.6506) acc_x 78.1250 (81.2500) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/19] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 0.9761 (0.5704) acc_x 71.8750 (83.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/19] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.2666 (0.4877) acc_x 96.8750 (86.8750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 394
confident_label rate tensor(0.4038, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 646
clean true:633
clean false:13
clean_rate:0.9798761609907121
noisy true:573
noisy false:381
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 954
epoch [167/200] batch [5/20] time 0.173 (0.174) data 0.097 (0.098) loss_x loss_x 0.9409 (0.8068) acc_x 71.8750 (79.3750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/20] time 0.169 (0.176) data 0.093 (0.099) loss_x loss_x 0.2108 (0.6197) acc_x 90.6250 (84.3750) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/20] time 0.160 (0.174) data 0.084 (0.098) loss_x loss_x 0.5366 (0.5953) acc_x 81.2500 (85.4167) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [20/20] time 0.186 (0.177) data 0.109 (0.101) loss_x loss_x 0.8237 (0.6052) acc_x 84.3750 (85.7812) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 663
clean true:651
clean false:12
clean_rate:0.9819004524886877
noisy true:566
noisy false:371
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 937
epoch [168/200] batch [5/20] time 0.186 (0.194) data 0.110 (0.118) loss_x loss_x 0.8657 (0.6367) acc_x 75.0000 (82.5000) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/20] time 0.186 (0.188) data 0.110 (0.112) loss_x loss_x 0.8940 (0.6584) acc_x 71.8750 (81.8750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/20] time 0.181 (0.186) data 0.104 (0.110) loss_x loss_x 0.6343 (0.6223) acc_x 84.3750 (83.7500) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [20/20] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.6421 (0.6124) acc_x 84.3750 (84.0625) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 381
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:653
clean false:8
clean_rate:0.9878971255673222
noisy true:566
noisy false:373
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [169/200] batch [5/20] time 0.187 (0.182) data 0.111 (0.106) loss_x loss_x 0.4739 (0.3580) acc_x 84.3750 (88.7500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/20] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.3174 (0.3801) acc_x 90.6250 (89.3750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/20] time 0.173 (0.189) data 0.097 (0.112) loss_x loss_x 0.3809 (0.4396) acc_x 87.5000 (88.1250) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [20/20] time 0.171 (0.187) data 0.095 (0.111) loss_x loss_x 0.6450 (0.4713) acc_x 87.5000 (87.9688) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 377
confident_label rate tensor(0.4125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 660
clean true:647
clean false:13
clean_rate:0.9803030303030303
noisy true:576
noisy false:364
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 940
epoch [170/200] batch [5/20] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.3008 (0.6064) acc_x 90.6250 (86.8750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/20] time 0.177 (0.185) data 0.100 (0.109) loss_x loss_x 0.5181 (0.5999) acc_x 84.3750 (84.6875) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/20] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.5234 (0.5956) acc_x 90.6250 (85.4167) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [20/20] time 0.189 (0.182) data 0.112 (0.106) loss_x loss_x 0.2057 (0.5992) acc_x 96.8750 (85.7812) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 648
clean true:639
clean false:9
clean_rate:0.9861111111111112
noisy true:578
noisy false:374
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 952
epoch [171/200] batch [5/20] time 0.182 (0.177) data 0.105 (0.101) loss_x loss_x 0.7583 (0.5042) acc_x 78.1250 (86.8750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/20] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.4197 (0.5125) acc_x 90.6250 (87.1875) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/20] time 0.173 (0.174) data 0.097 (0.098) loss_x loss_x 0.4402 (0.5431) acc_x 87.5000 (86.0417) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [20/20] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.5425 (0.5876) acc_x 84.3750 (84.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 367
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:657
clean false:13
clean_rate:0.9805970149253731
noisy true:576
noisy false:354
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [172/200] batch [5/20] time 0.186 (0.183) data 0.111 (0.107) loss_x loss_x 0.9502 (0.6096) acc_x 75.0000 (83.7500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/20] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.2983 (0.6259) acc_x 90.6250 (83.4375) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/20] time 0.187 (0.185) data 0.111 (0.109) loss_x loss_x 0.3093 (0.5755) acc_x 87.5000 (83.7500) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [20/20] time 0.188 (0.185) data 0.112 (0.109) loss_x loss_x 0.6821 (0.5955) acc_x 81.2500 (83.2812) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 348
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:661
clean false:8
clean_rate:0.9880418535127056
noisy true:591
noisy false:340
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [173/200] batch [5/20] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 0.6162 (0.5517) acc_x 87.5000 (87.5000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/20] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.8823 (0.5798) acc_x 78.1250 (85.9375) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/20] time 0.179 (0.183) data 0.103 (0.107) loss_x loss_x 1.3320 (0.5856) acc_x 65.6250 (85.8333) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [20/20] time 0.184 (0.184) data 0.109 (0.108) loss_x loss_x 0.5620 (0.5979) acc_x 87.5000 (86.0938) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 378
confident_label rate tensor(0.4175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 668
clean true:655
clean false:13
clean_rate:0.9805389221556886
noisy true:567
noisy false:365
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 932
epoch [174/200] batch [5/20] time 0.162 (0.188) data 0.086 (0.112) loss_x loss_x 0.2379 (0.5201) acc_x 93.7500 (86.8750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/20] time 0.182 (0.185) data 0.105 (0.109) loss_x loss_x 0.4404 (0.4831) acc_x 87.5000 (88.1250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/20] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.7651 (0.4917) acc_x 71.8750 (87.7083) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [20/20] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.3792 (0.5447) acc_x 93.7500 (87.1875) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 372
confident_label rate tensor(0.4231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 677
clean true:663
clean false:14
clean_rate:0.9793205317577548
noisy true:565
noisy false:358
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 923
epoch [175/200] batch [5/21] time 0.198 (0.198) data 0.121 (0.122) loss_x loss_x 0.9907 (0.6843) acc_x 84.3750 (83.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/21] time 0.187 (0.190) data 0.111 (0.114) loss_x loss_x 0.7295 (0.6690) acc_x 78.1250 (83.1250) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/21] time 0.163 (0.185) data 0.085 (0.109) loss_x loss_x 0.6250 (0.6418) acc_x 84.3750 (83.3333) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/21] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.5200 (0.6136) acc_x 78.1250 (83.4375) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 346
confident_label rate tensor(0.4194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 671
clean true:660
clean false:11
clean_rate:0.9836065573770492
noisy true:594
noisy false:335
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 929
epoch [176/200] batch [5/20] time 0.191 (0.184) data 0.115 (0.108) loss_x loss_x 0.2405 (0.6715) acc_x 90.6250 (81.8750) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/20] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.4390 (0.5938) acc_x 90.6250 (83.4375) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/20] time 0.169 (0.180) data 0.093 (0.103) loss_x loss_x 0.4553 (0.5413) acc_x 90.6250 (85.8333) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [20/20] time 0.163 (0.177) data 0.087 (0.101) loss_x loss_x 0.7163 (0.5597) acc_x 78.1250 (85.7812) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 375
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 673
clean true:661
clean false:12
clean_rate:0.9821693907875185
noisy true:564
noisy false:363
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 927
epoch [177/200] batch [5/21] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 0.7402 (0.6711) acc_x 84.3750 (86.2500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/21] time 0.178 (0.178) data 0.101 (0.102) loss_x loss_x 0.6880 (0.6098) acc_x 81.2500 (85.3125) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/21] time 0.164 (0.175) data 0.087 (0.099) loss_x loss_x 0.4014 (0.5498) acc_x 87.5000 (86.0417) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/21] time 0.166 (0.173) data 0.090 (0.096) loss_x loss_x 0.2893 (0.5216) acc_x 93.7500 (86.5625) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:654
clean false:12
clean_rate:0.9819819819819819
noisy true:564
noisy false:370
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [178/200] batch [5/20] time 0.186 (0.185) data 0.110 (0.109) loss_x loss_x 0.5171 (0.5980) acc_x 87.5000 (86.8750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/20] time 0.159 (0.178) data 0.081 (0.101) loss_x loss_x 0.2192 (0.4532) acc_x 93.7500 (90.0000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/20] time 0.189 (0.180) data 0.112 (0.103) loss_x loss_x 0.3147 (0.4576) acc_x 87.5000 (89.3750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [20/20] time 0.177 (0.178) data 0.101 (0.101) loss_x loss_x 0.5889 (0.4748) acc_x 84.3750 (88.2812) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:654
clean false:12
clean_rate:0.9819819819819819
noisy true:564
noisy false:370
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [179/200] batch [5/20] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.5332 (0.6315) acc_x 81.2500 (84.3750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/20] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 0.9341 (0.5899) acc_x 84.3750 (85.9375) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/20] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6230 (0.6156) acc_x 81.2500 (85.0000) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [20/20] time 0.211 (0.185) data 0.134 (0.108) loss_x loss_x 0.3730 (0.5953) acc_x 90.6250 (85.6250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 633
clean true:622
clean false:11
clean_rate:0.9826224328593997
noisy true:569
noisy false:398
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 967
epoch [180/200] batch [5/19] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.6138 (0.5642) acc_x 87.5000 (83.7500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/19] time 0.178 (0.179) data 0.102 (0.103) loss_x loss_x 0.3579 (0.6015) acc_x 93.7500 (85.3125) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/19] time 0.181 (0.179) data 0.105 (0.103) loss_x loss_x 0.7275 (0.6029) acc_x 84.3750 (85.4167) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:655
clean false:7
clean_rate:0.9894259818731118
noisy true:586
noisy false:352
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [181/200] batch [5/20] time 0.199 (0.184) data 0.123 (0.107) loss_x loss_x 0.8955 (0.6257) acc_x 81.2500 (83.7500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/20] time 0.194 (0.179) data 0.118 (0.103) loss_x loss_x 0.9243 (0.5311) acc_x 75.0000 (85.3125) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/20] time 0.255 (0.184) data 0.179 (0.107) loss_x loss_x 0.4045 (0.5568) acc_x 87.5000 (84.5833) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [20/20] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.4995 (0.4969) acc_x 81.2500 (86.0938) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 655
clean true:648
clean false:7
clean_rate:0.9893129770992366
noisy true:566
noisy false:379
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 945
epoch [182/200] batch [5/20] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6929 (0.5256) acc_x 81.2500 (86.2500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.5645 (0.5062) acc_x 90.6250 (87.1875) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/20] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.9102 (0.5054) acc_x 75.0000 (87.5000) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [20/20] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.2974 (0.4893) acc_x 93.7500 (87.9688) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 650
clean true:639
clean false:11
clean_rate:0.9830769230769231
noisy true:581
noisy false:369
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 950
epoch [183/200] batch [5/20] time 0.207 (0.187) data 0.130 (0.111) loss_x loss_x 0.6777 (0.4525) acc_x 84.3750 (88.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/20] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.9141 (0.4484) acc_x 75.0000 (88.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/20] time 0.196 (0.182) data 0.120 (0.106) loss_x loss_x 0.5127 (0.4838) acc_x 81.2500 (87.5000) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [20/20] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.5298 (0.5045) acc_x 81.2500 (86.5625) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 658
clean true:646
clean false:12
clean_rate:0.9817629179331308
noisy true:568
noisy false:374
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 942
epoch [184/200] batch [5/20] time 0.185 (0.182) data 0.107 (0.105) loss_x loss_x 0.3684 (0.5731) acc_x 93.7500 (85.0000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/20] time 0.195 (0.182) data 0.120 (0.105) loss_x loss_x 0.1815 (0.4825) acc_x 96.8750 (87.1875) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.1182 (0.5576) acc_x 78.1250 (85.6250) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [20/20] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.5391 (0.5922) acc_x 90.6250 (85.0000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 662
clean true:647
clean false:15
clean_rate:0.9773413897280967
noisy true:562
noisy false:376
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 938
epoch [185/200] batch [5/20] time 0.168 (0.206) data 0.091 (0.129) loss_x loss_x 0.8833 (0.5215) acc_x 84.3750 (87.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/20] time 0.185 (0.193) data 0.108 (0.116) loss_x loss_x 1.1133 (0.6375) acc_x 71.8750 (85.3125) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/20] time 0.172 (0.186) data 0.094 (0.109) loss_x loss_x 0.3887 (0.6093) acc_x 87.5000 (85.2083) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [20/20] time 0.172 (0.188) data 0.095 (0.111) loss_x loss_x 0.9634 (0.5980) acc_x 87.5000 (85.6250) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 353
confident_label rate tensor(0.4150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 664
clean true:656
clean false:8
clean_rate:0.9879518072289156
noisy true:591
noisy false:345
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 936
epoch [186/200] batch [5/20] time 0.187 (0.178) data 0.111 (0.102) loss_x loss_x 0.5107 (0.6566) acc_x 87.5000 (80.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/20] time 0.162 (0.174) data 0.086 (0.098) loss_x loss_x 0.9839 (0.6087) acc_x 65.6250 (81.8750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/20] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.3787 (0.5596) acc_x 87.5000 (83.1250) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [20/20] time 0.178 (0.179) data 0.101 (0.103) loss_x loss_x 0.5723 (0.5468) acc_x 87.5000 (84.0625) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.4019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 643
clean true:634
clean false:9
clean_rate:0.9860031104199067
noisy true:567
noisy false:390
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 957
epoch [187/200] batch [5/20] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.8252 (0.5819) acc_x 78.1250 (86.8750) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/20] time 0.186 (0.185) data 0.110 (0.109) loss_x loss_x 0.3633 (0.5462) acc_x 93.7500 (86.8750) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/20] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.4185 (0.4856) acc_x 93.7500 (88.1250) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [20/20] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.4866 (0.4910) acc_x 87.5000 (87.6562) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 365
confident_label rate tensor(0.4231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 677
clean true:664
clean false:13
clean_rate:0.9807976366322009
noisy true:571
noisy false:352
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 923
epoch [188/200] batch [5/21] time 0.172 (0.177) data 0.096 (0.100) loss_x loss_x 0.3774 (0.4898) acc_x 87.5000 (85.0000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/21] time 0.179 (0.175) data 0.101 (0.098) loss_x loss_x 0.4443 (0.4808) acc_x 87.5000 (85.9375) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/21] time 0.159 (0.171) data 0.082 (0.094) loss_x loss_x 0.4712 (0.5513) acc_x 90.6250 (85.2083) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/21] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.6416 (0.5402) acc_x 81.2500 (84.6875) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 385
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:654
clean false:12
clean_rate:0.9819819819819819
noisy true:561
noisy false:373
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [189/200] batch [5/20] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.4690 (0.4225) acc_x 84.3750 (90.0000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/20] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.6157 (0.5316) acc_x 84.3750 (86.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/20] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.4302 (0.5270) acc_x 78.1250 (86.4583) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [20/20] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6167 (0.5658) acc_x 87.5000 (86.4062) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 656
clean true:646
clean false:10
clean_rate:0.9847560975609756
noisy true:584
noisy false:360
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 944
epoch [190/200] batch [5/20] time 0.162 (0.188) data 0.086 (0.112) loss_x loss_x 0.7188 (0.5799) acc_x 90.6250 (88.1250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/20] time 0.165 (0.183) data 0.088 (0.107) loss_x loss_x 0.3179 (0.5826) acc_x 93.7500 (86.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/20] time 0.187 (0.182) data 0.111 (0.106) loss_x loss_x 0.1808 (0.5486) acc_x 93.7500 (86.8750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [20/20] time 0.186 (0.180) data 0.110 (0.104) loss_x loss_x 0.1273 (0.5054) acc_x 100.0000 (87.8125) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 359
confident_label rate tensor(0.4125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 660
clean true:653
clean false:7
clean_rate:0.9893939393939394
noisy true:588
noisy false:352
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 940
epoch [191/200] batch [5/20] time 0.167 (0.170) data 0.091 (0.094) loss_x loss_x 0.2837 (0.5531) acc_x 90.6250 (85.0000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/20] time 0.186 (0.168) data 0.110 (0.092) loss_x loss_x 0.5337 (0.5397) acc_x 84.3750 (85.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/20] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.1841 (0.5757) acc_x 96.8750 (85.6250) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [20/20] time 0.183 (0.176) data 0.106 (0.100) loss_x loss_x 0.5581 (0.5790) acc_x 78.1250 (85.1562) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 386
confident_label rate tensor(0.4038, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 646
clean true:639
clean false:7
clean_rate:0.9891640866873065
noisy true:575
noisy false:379
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 954
epoch [192/200] batch [5/20] time 0.159 (0.164) data 0.083 (0.087) loss_x loss_x 0.4810 (0.3701) acc_x 90.6250 (90.6250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/20] time 0.162 (0.162) data 0.086 (0.086) loss_x loss_x 0.2957 (0.3869) acc_x 93.7500 (90.3125) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/20] time 0.185 (0.166) data 0.108 (0.090) loss_x loss_x 0.5776 (0.4258) acc_x 81.2500 (88.9583) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [20/20] time 0.161 (0.167) data 0.084 (0.090) loss_x loss_x 0.4275 (0.4715) acc_x 87.5000 (87.6562) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 363
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 652
clean true:644
clean false:8
clean_rate:0.9877300613496932
noisy true:593
noisy false:355
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 948
epoch [193/200] batch [5/20] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 0.4060 (0.6461) acc_x 93.7500 (84.3750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/20] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.3096 (0.5992) acc_x 93.7500 (85.6250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/20] time 0.159 (0.179) data 0.082 (0.102) loss_x loss_x 0.6807 (0.5861) acc_x 81.2500 (85.4167) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [20/20] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.3052 (0.5708) acc_x 93.7500 (85.9375) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 369
confident_label rate tensor(0.4294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 687
clean true:669
clean false:18
clean_rate:0.9737991266375546
noisy true:562
noisy false:351
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 913
epoch [194/200] batch [5/21] time 0.166 (0.163) data 0.090 (0.086) loss_x loss_x 0.6348 (0.5359) acc_x 84.3750 (85.0000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/21] time 0.163 (0.163) data 0.086 (0.086) loss_x loss_x 0.5566 (0.4916) acc_x 78.1250 (85.6250) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/21] time 0.174 (0.166) data 0.097 (0.089) loss_x loss_x 0.4512 (0.4905) acc_x 90.6250 (86.2500) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [20/21] time 0.158 (0.166) data 0.082 (0.090) loss_x loss_x 0.6680 (0.5417) acc_x 81.2500 (85.3125) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 354
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 666
clean true:659
clean false:7
clean_rate:0.9894894894894894
noisy true:587
noisy false:347
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 934
epoch [195/200] batch [5/20] time 0.164 (0.160) data 0.086 (0.084) loss_x loss_x 0.5254 (0.6111) acc_x 90.6250 (86.2500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/20] time 0.186 (0.164) data 0.109 (0.087) loss_x loss_x 0.4856 (0.5842) acc_x 87.5000 (85.3125) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/20] time 0.157 (0.165) data 0.081 (0.088) loss_x loss_x 0.3755 (0.5942) acc_x 90.6250 (84.3750) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [20/20] time 0.158 (0.164) data 0.082 (0.087) loss_x loss_x 0.3032 (0.5766) acc_x 90.6250 (84.3750) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 370
confident_label rate tensor(0.4181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 669
clean true:657
clean false:12
clean_rate:0.9820627802690582
noisy true:573
noisy false:358
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 931
epoch [196/200] batch [5/20] time 0.159 (0.159) data 0.083 (0.083) loss_x loss_x 0.2854 (0.4698) acc_x 87.5000 (84.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/20] time 0.157 (0.160) data 0.081 (0.083) loss_x loss_x 0.4268 (0.4263) acc_x 90.6250 (86.5625) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/20] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.4456 (0.4593) acc_x 87.5000 (87.2917) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [20/20] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.6284 (0.4901) acc_x 84.3750 (87.5000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.4131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 661
clean true:647
clean false:14
clean_rate:0.9788199697428139
noisy true:560
noisy false:379
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 939
epoch [197/200] batch [5/20] time 0.159 (0.164) data 0.083 (0.087) loss_x loss_x 1.0664 (0.5576) acc_x 78.1250 (86.2500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/20] time 0.159 (0.162) data 0.082 (0.085) loss_x loss_x 0.5747 (0.5965) acc_x 84.3750 (85.3125) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/20] time 0.161 (0.161) data 0.085 (0.085) loss_x loss_x 0.4285 (0.5995) acc_x 87.5000 (85.0000) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [20/20] time 0.164 (0.161) data 0.088 (0.084) loss_x loss_x 0.7847 (0.5961) acc_x 71.8750 (84.5312) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 355
confident_label rate tensor(0.4187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 670
clean true:659
clean false:11
clean_rate:0.9835820895522388
noisy true:586
noisy false:344
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 930
epoch [198/200] batch [5/20] time 0.157 (0.159) data 0.080 (0.083) loss_x loss_x 0.4426 (0.4466) acc_x 90.6250 (88.7500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/20] time 0.159 (0.159) data 0.083 (0.083) loss_x loss_x 0.5146 (0.4957) acc_x 90.6250 (87.1875) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/20] time 0.159 (0.160) data 0.081 (0.083) loss_x loss_x 0.7729 (0.5071) acc_x 81.2500 (87.2917) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [20/20] time 0.161 (0.160) data 0.085 (0.083) loss_x loss_x 0.5205 (0.5100) acc_x 81.2500 (87.3438) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 379
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 654
clean true:642
clean false:12
clean_rate:0.981651376146789
noisy true:579
noisy false:367
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 946
epoch [199/200] batch [5/20] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.3599 (0.6647) acc_x 93.7500 (81.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/20] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.3667 (0.5402) acc_x 87.5000 (84.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/20] time 0.183 (0.177) data 0.107 (0.100) loss_x loss_x 0.4631 (0.5085) acc_x 87.5000 (84.1667) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [20/20] time 0.165 (0.176) data 0.089 (0.100) loss_x loss_x 0.2466 (0.5085) acc_x 96.8750 (84.5312) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.4081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 653
clean true:643
clean false:10
clean_rate:0.9846860643185299
noisy true:566
noisy false:381
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 947
epoch [200/200] batch [5/20] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.5288 (0.4234) acc_x 87.5000 (89.3750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/20] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 0.5142 (0.4260) acc_x 87.5000 (88.4375) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/20] time 0.159 (0.167) data 0.082 (0.089) loss_x loss_x 0.5859 (0.4391) acc_x 87.5000 (88.3333) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [20/20] time 0.165 (0.166) data 0.088 (0.089) loss_x loss_x 0.9150 (0.4883) acc_x 75.0000 (87.1875) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,224
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 86.1%
Elapsed: 0:40:46
