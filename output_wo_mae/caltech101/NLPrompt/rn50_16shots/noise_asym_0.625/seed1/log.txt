***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.1806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 289
clean true:279
clean false:10
clean_rate:0.9653979238754326
noisy true:476
noisy false:835
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 1311
epoch [1/200] batch [5/9] time 0.166 (0.209) data 0.090 (0.111) loss_x loss_x 2.6172 (2.5973) acc_x 59.3750 (67.5000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 779
confident_label rate tensor(0.1956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 313
clean true:303
clean false:10
clean_rate:0.9680511182108626
noisy true:518
noisy false:769
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1287
epoch [2/200] batch [5/9] time 0.172 (0.195) data 0.096 (0.096) loss_x loss_x 0.8926 (1.2174) acc_x 81.2500 (73.1250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 588
confident_label rate tensor(0.2444, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 391
clean true:381
clean false:10
clean_rate:0.9744245524296675
noisy true:631
noisy false:578
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1209
epoch [3/200] batch [5/12] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.9116 (1.0601) acc_x 75.0000 (75.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/12] time 0.206 (0.181) data 0.129 (0.105) loss_x loss_x 1.0723 (0.9908) acc_x 71.8750 (76.2500) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 536
confident_label rate tensor(0.2456, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 393
clean true:389
clean false:4
clean_rate:0.989821882951654
noisy true:675
noisy false:532
after delete: len(clean_dataset) 393
after delete: len(noisy_dataset) 1207
epoch [4/200] batch [5/12] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.9053 (0.9027) acc_x 78.1250 (78.7500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/12] time 0.195 (0.182) data 0.119 (0.106) loss_x loss_x 0.5488 (0.9045) acc_x 81.2500 (77.5000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 548
confident_label rate tensor(0.2469, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 395
clean true:389
clean false:6
clean_rate:0.9848101265822785
noisy true:663
noisy false:542
after delete: len(clean_dataset) 395
after delete: len(noisy_dataset) 1205
epoch [5/200] batch [5/12] time 0.162 (0.190) data 0.086 (0.092) loss_x loss_x 0.4224 (0.7344) acc_x 81.2500 (80.6250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/12] time 0.156 (0.174) data 0.080 (0.086) loss_x loss_x 0.6875 (0.8123) acc_x 84.3750 (79.0625) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 540
confident_label rate tensor(0.2550, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 408
clean true:401
clean false:7
clean_rate:0.9828431372549019
noisy true:659
noisy false:533
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1192
epoch [6/200] batch [5/12] time 0.182 (0.197) data 0.106 (0.098) loss_x loss_x 0.9263 (0.8125) acc_x 68.7500 (80.6250) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/12] time 0.180 (0.189) data 0.103 (0.102) loss_x loss_x 0.9609 (0.7825) acc_x 78.1250 (80.9375) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 440
clean true:432
clean false:8
clean_rate:0.9818181818181818
noisy true:697
noisy false:463
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1160
epoch [7/200] batch [5/13] time 0.160 (0.176) data 0.084 (0.099) loss_x loss_x 1.0869 (0.9149) acc_x 71.8750 (79.3750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/13] time 0.183 (0.170) data 0.106 (0.094) loss_x loss_x 0.6558 (0.8452) acc_x 78.1250 (80.0000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 504
confident_label rate tensor(0.2631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 421
clean true:415
clean false:6
clean_rate:0.9857482185273159
noisy true:681
noisy false:498
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1179
epoch [8/200] batch [5/13] time 0.190 (0.180) data 0.113 (0.104) loss_x loss_x 0.8560 (0.9753) acc_x 71.8750 (73.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/13] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 0.6904 (0.9776) acc_x 84.3750 (75.0000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.2631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 421
clean true:413
clean false:8
clean_rate:0.9809976247030879
noisy true:694
noisy false:485
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1179
epoch [9/200] batch [5/13] time 0.192 (0.206) data 0.107 (0.106) loss_x loss_x 1.0518 (0.7795) acc_x 75.0000 (82.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/13] time 0.168 (0.199) data 0.092 (0.111) loss_x loss_x 0.8037 (0.6910) acc_x 78.1250 (83.7500) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 492
confident_label rate tensor(0.2719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 435
clean true:429
clean false:6
clean_rate:0.9862068965517241
noisy true:679
noisy false:486
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1165
epoch [10/200] batch [5/13] time 0.176 (0.183) data 0.100 (0.107) loss_x loss_x 0.8789 (0.7721) acc_x 75.0000 (78.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/13] time 0.182 (0.181) data 0.107 (0.106) loss_x loss_x 0.9814 (0.7989) acc_x 71.8750 (78.1250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 439
clean true:430
clean false:9
clean_rate:0.979498861047836
noisy true:690
noisy false:471
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1161
epoch [11/200] batch [5/13] time 0.184 (0.176) data 0.108 (0.100) loss_x loss_x 0.6548 (0.9208) acc_x 84.3750 (78.1250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/13] time 0.186 (0.187) data 0.110 (0.111) loss_x loss_x 1.1514 (0.9209) acc_x 71.8750 (76.2500) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 425
clean true:420
clean false:5
clean_rate:0.9882352941176471
noisy true:698
noisy false:477
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1175
epoch [12/200] batch [5/13] time 0.181 (0.175) data 0.105 (0.099) loss_x loss_x 0.7339 (0.9762) acc_x 87.5000 (76.2500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/13] time 0.179 (0.179) data 0.103 (0.102) loss_x loss_x 0.8262 (0.8554) acc_x 78.1250 (76.8750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 501
confident_label rate tensor(0.2662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 426
clean true:417
clean false:9
clean_rate:0.9788732394366197
noisy true:682
noisy false:492
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1174
epoch [13/200] batch [5/13] time 0.182 (0.214) data 0.106 (0.105) loss_x loss_x 0.4519 (0.7298) acc_x 87.5000 (80.6250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/13] time 0.163 (0.194) data 0.086 (0.102) loss_x loss_x 0.9165 (0.9274) acc_x 78.1250 (75.0000) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.2662, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 426
clean true:413
clean false:13
clean_rate:0.9694835680751174
noisy true:694
noisy false:480
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1174
epoch [14/200] batch [5/13] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 1.1016 (0.8508) acc_x 71.8750 (80.6250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/13] time 0.180 (0.180) data 0.104 (0.104) loss_x loss_x 0.7109 (0.8590) acc_x 78.1250 (79.0625) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 511
confident_label rate tensor(0.2575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 412
clean true:401
clean false:11
clean_rate:0.9733009708737864
noisy true:688
noisy false:500
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1188
epoch [15/200] batch [5/12] time 0.170 (0.196) data 0.094 (0.084) loss_x loss_x 1.1465 (0.7766) acc_x 62.5000 (79.3750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/12] time 0.194 (0.189) data 0.118 (0.095) loss_x loss_x 0.9341 (0.8211) acc_x 71.8750 (78.1250) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 508
confident_label rate tensor(0.2644, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 423
clean true:415
clean false:8
clean_rate:0.9810874704491725
noisy true:677
noisy false:500
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1177
epoch [16/200] batch [5/13] time 0.159 (0.177) data 0.083 (0.101) loss_x loss_x 0.9067 (0.8124) acc_x 87.5000 (81.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/13] time 0.164 (0.185) data 0.087 (0.094) loss_x loss_x 1.0361 (0.8348) acc_x 71.8750 (79.0625) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 428
clean true:417
clean false:11
clean_rate:0.9742990654205608
noisy true:703
noisy false:469
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1172
epoch [17/200] batch [5/13] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.5625 (0.8172) acc_x 84.3750 (78.1250) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/13] time 0.296 (0.192) data 0.111 (0.104) loss_x loss_x 0.6099 (0.7749) acc_x 87.5000 (79.0625) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 488
confident_label rate tensor(0.2725, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 436
clean true:423
clean false:13
clean_rate:0.9701834862385321
noisy true:689
noisy false:475
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1164
epoch [18/200] batch [5/13] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.7002 (0.8709) acc_x 81.2500 (76.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/13] time 0.286 (0.200) data 0.100 (0.106) loss_x loss_x 0.6997 (0.8527) acc_x 78.1250 (80.6250) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.2694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 431
clean true:420
clean false:11
clean_rate:0.974477958236659
noisy true:691
noisy false:478
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1169
epoch [19/200] batch [5/13] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.7861 (0.8136) acc_x 84.3750 (81.2500) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/13] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.8823 (0.8112) acc_x 78.1250 (81.5625) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 451
clean true:438
clean false:13
clean_rate:0.9711751662971175
noisy true:699
noisy false:450
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1149
epoch [20/200] batch [5/14] time 0.189 (0.169) data 0.113 (0.093) loss_x loss_x 1.5547 (0.9809) acc_x 56.2500 (72.5000) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/14] time 0.174 (0.175) data 0.099 (0.099) loss_x loss_x 0.4573 (0.8474) acc_x 87.5000 (76.2500) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 460
clean true:449
clean false:11
clean_rate:0.9760869565217392
noisy true:686
noisy false:454
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1140
epoch [21/200] batch [5/14] time 0.169 (0.181) data 0.093 (0.105) loss_x loss_x 0.7920 (0.8541) acc_x 78.1250 (76.8750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/14] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.5801 (0.8720) acc_x 75.0000 (76.5625) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 433
clean true:421
clean false:12
clean_rate:0.9722863741339491
noisy true:688
noisy false:479
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1167
epoch [22/200] batch [5/13] time 0.159 (0.175) data 0.083 (0.098) loss_x loss_x 0.4587 (0.6474) acc_x 84.3750 (83.1250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/13] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.6030 (0.6660) acc_x 84.3750 (82.1875) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2750, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 440
clean true:430
clean false:10
clean_rate:0.9772727272727273
noisy true:697
noisy false:463
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1160
epoch [23/200] batch [5/13] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.5327 (0.6309) acc_x 87.5000 (81.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/13] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.4766 (0.6303) acc_x 90.6250 (82.1875) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 453
clean true:440
clean false:13
clean_rate:0.9713024282560706
noisy true:689
noisy false:458
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1147
epoch [24/200] batch [5/14] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.6860 (0.8024) acc_x 81.2500 (78.1250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/14] time 0.181 (0.190) data 0.105 (0.105) loss_x loss_x 1.5029 (0.7589) acc_x 62.5000 (79.6875) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 488
confident_label rate tensor(0.2719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 435
clean true:423
clean false:12
clean_rate:0.9724137931034482
noisy true:689
noisy false:476
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1165
epoch [25/200] batch [5/13] time 0.201 (0.180) data 0.125 (0.104) loss_x loss_x 0.8574 (0.8623) acc_x 75.0000 (78.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/13] time 0.183 (0.181) data 0.108 (0.105) loss_x loss_x 0.5249 (0.7876) acc_x 87.5000 (78.7500) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2719, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 435
clean true:427
clean false:8
clean_rate:0.9816091954022989
noisy true:703
noisy false:462
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1165
epoch [26/200] batch [5/13] time 0.183 (0.203) data 0.106 (0.109) loss_x loss_x 0.3235 (0.4798) acc_x 84.3750 (86.2500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/13] time 0.173 (0.187) data 0.096 (0.102) loss_x loss_x 0.6167 (0.6326) acc_x 87.5000 (83.1250) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 444
clean true:434
clean false:10
clean_rate:0.9774774774774775
noisy true:700
noisy false:456
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1156
epoch [27/200] batch [5/13] time 0.180 (0.190) data 0.103 (0.114) loss_x loss_x 0.6616 (0.6824) acc_x 84.3750 (81.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/13] time 0.181 (0.185) data 0.105 (0.109) loss_x loss_x 0.6187 (0.7054) acc_x 78.1250 (80.6250) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 446
clean true:431
clean false:15
clean_rate:0.9663677130044843
noisy true:693
noisy false:461
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1154
epoch [28/200] batch [5/13] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.6489 (0.8645) acc_x 75.0000 (76.8750) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/13] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.3879 (0.7886) acc_x 87.5000 (80.3125) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 447
clean true:435
clean false:12
clean_rate:0.9731543624161074
noisy true:686
noisy false:467
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1153
epoch [29/200] batch [5/13] time 0.169 (0.184) data 0.093 (0.107) loss_x loss_x 0.6040 (0.7360) acc_x 81.2500 (83.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/13] time 0.179 (0.187) data 0.103 (0.111) loss_x loss_x 0.3472 (0.6673) acc_x 87.5000 (83.4375) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.2875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 460
clean true:446
clean false:14
clean_rate:0.9695652173913043
noisy true:702
noisy false:438
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1140
epoch [30/200] batch [5/14] time 0.167 (0.182) data 0.090 (0.105) loss_x loss_x 0.5962 (0.7320) acc_x 81.2500 (79.3750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/14] time 0.169 (0.179) data 0.093 (0.103) loss_x loss_x 0.5811 (0.7603) acc_x 78.1250 (78.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:431
clean false:12
clean_rate:0.9729119638826185
noisy true:698
noisy false:459
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [31/200] batch [5/13] time 0.190 (0.211) data 0.114 (0.106) loss_x loss_x 0.5132 (0.7985) acc_x 78.1250 (72.5000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/13] time 0.179 (0.199) data 0.104 (0.109) loss_x loss_x 0.8936 (0.7600) acc_x 71.8750 (76.2500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.2900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 464
clean true:454
clean false:10
clean_rate:0.978448275862069
noisy true:713
noisy false:423
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1136
epoch [32/200] batch [5/14] time 0.157 (0.182) data 0.082 (0.105) loss_x loss_x 0.8633 (0.7718) acc_x 78.1250 (78.1250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/14] time 0.269 (0.183) data 0.083 (0.095) loss_x loss_x 1.1455 (0.7381) acc_x 71.8750 (80.0000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 454
clean true:438
clean false:16
clean_rate:0.9647577092511013
noisy true:694
noisy false:452
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1146
epoch [33/200] batch [5/14] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.7773 (0.8636) acc_x 84.3750 (76.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/14] time 0.177 (0.180) data 0.102 (0.104) loss_x loss_x 0.7114 (0.7280) acc_x 78.1250 (79.3750) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 450
clean true:438
clean false:12
clean_rate:0.9733333333333334
noisy true:699
noisy false:451
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1150
epoch [34/200] batch [5/14] time 0.177 (0.178) data 0.101 (0.102) loss_x loss_x 0.5098 (0.7356) acc_x 87.5000 (84.3750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/14] time 0.178 (0.178) data 0.101 (0.102) loss_x loss_x 0.9346 (0.6908) acc_x 81.2500 (82.8125) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 454
clean true:446
clean false:8
clean_rate:0.9823788546255506
noisy true:696
noisy false:450
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1146
epoch [35/200] batch [5/14] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 0.8599 (0.8025) acc_x 71.8750 (81.2500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/14] time 0.188 (0.182) data 0.112 (0.105) loss_x loss_x 0.4348 (0.7484) acc_x 84.3750 (79.6875) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.2869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 459
clean true:450
clean false:9
clean_rate:0.9803921568627451
noisy true:697
noisy false:444
after delete: len(clean_dataset) 459
after delete: len(noisy_dataset) 1141
epoch [36/200] batch [5/14] time 0.176 (0.193) data 0.099 (0.095) loss_x loss_x 0.7168 (0.6747) acc_x 87.5000 (83.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/14] time 0.181 (0.187) data 0.105 (0.100) loss_x loss_x 0.6543 (0.6574) acc_x 87.5000 (82.5000) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2763, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 442
clean true:430
clean false:12
clean_rate:0.9728506787330317
noisy true:690
noisy false:468
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1158
epoch [37/200] batch [5/13] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.9697 (0.7926) acc_x 78.1250 (77.5000) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/13] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.8135 (0.6731) acc_x 78.1250 (80.9375) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 464
clean true:450
clean false:14
clean_rate:0.9698275862068966
noisy true:695
noisy false:441
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1136
epoch [38/200] batch [5/14] time 0.165 (0.163) data 0.089 (0.087) loss_x loss_x 0.8223 (0.6619) acc_x 78.1250 (82.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/14] time 0.175 (0.168) data 0.099 (0.092) loss_x loss_x 0.4268 (0.6540) acc_x 90.6250 (83.1250) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.2831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 453
clean true:441
clean false:12
clean_rate:0.9735099337748344
noisy true:678
noisy false:469
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1147
epoch [39/200] batch [5/14] time 0.169 (0.186) data 0.092 (0.110) loss_x loss_x 0.3884 (0.8673) acc_x 90.6250 (78.7500) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/14] time 0.167 (0.182) data 0.091 (0.105) loss_x loss_x 0.5654 (0.8493) acc_x 87.5000 (78.1250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 461
clean true:448
clean false:13
clean_rate:0.9718004338394793
noisy true:695
noisy false:444
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1139
epoch [40/200] batch [5/14] time 0.189 (0.183) data 0.113 (0.107) loss_x loss_x 0.3589 (0.6584) acc_x 90.6250 (86.2500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/14] time 0.180 (0.195) data 0.105 (0.105) loss_x loss_x 0.8457 (0.7063) acc_x 75.0000 (82.5000) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 474
clean true:461
clean false:13
clean_rate:0.9725738396624473
noisy true:700
noisy false:426
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1126
epoch [41/200] batch [5/14] time 0.183 (0.198) data 0.106 (0.100) loss_x loss_x 0.9028 (0.8485) acc_x 75.0000 (80.6250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/14] time 0.177 (0.188) data 0.101 (0.101) loss_x loss_x 0.9775 (0.8049) acc_x 75.0000 (79.6875) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 457
clean true:446
clean false:11
clean_rate:0.975929978118162
noisy true:675
noisy false:468
after delete: len(clean_dataset) 457
after delete: len(noisy_dataset) 1143
epoch [42/200] batch [5/14] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.5059 (0.6268) acc_x 84.3750 (84.3750) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/14] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.8662 (0.6191) acc_x 75.0000 (83.4375) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 457
clean true:442
clean false:15
clean_rate:0.9671772428884027
noisy true:699
noisy false:444
after delete: len(clean_dataset) 457
after delete: len(noisy_dataset) 1143
epoch [43/200] batch [5/14] time 0.280 (0.198) data 0.095 (0.100) loss_x loss_x 0.7725 (0.7068) acc_x 81.2500 (85.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/14] time 0.179 (0.193) data 0.103 (0.105) loss_x loss_x 0.8472 (0.7107) acc_x 78.1250 (83.7500) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.2781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 445
clean true:434
clean false:11
clean_rate:0.9752808988764045
noisy true:683
noisy false:472
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1155
epoch [44/200] batch [5/13] time 0.189 (0.198) data 0.112 (0.121) loss_x loss_x 1.0596 (0.8822) acc_x 81.2500 (76.2500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/13] time 0.182 (0.189) data 0.106 (0.113) loss_x loss_x 0.7417 (0.7591) acc_x 78.1250 (80.3125) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2850, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 456
clean true:444
clean false:12
clean_rate:0.9736842105263158
noisy true:694
noisy false:450
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1144
epoch [45/200] batch [5/14] time 0.164 (0.160) data 0.088 (0.084) loss_x loss_x 0.7388 (0.6547) acc_x 81.2500 (81.2500) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/14] time 0.214 (0.167) data 0.137 (0.091) loss_x loss_x 0.5146 (0.7435) acc_x 87.5000 (81.2500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:453
clean false:15
clean_rate:0.967948717948718
noisy true:688
noisy false:444
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [46/200] batch [5/14] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.5303 (0.6076) acc_x 84.3750 (86.8750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/14] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.7061 (0.6137) acc_x 87.5000 (86.5625) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 470
clean true:455
clean false:15
clean_rate:0.9680851063829787
noisy true:698
noisy false:432
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1130
epoch [47/200] batch [5/14] time 0.180 (0.192) data 0.104 (0.115) loss_x loss_x 0.3750 (0.5796) acc_x 84.3750 (84.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/14] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.6113 (0.6046) acc_x 81.2500 (85.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.2875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 460
clean true:451
clean false:9
clean_rate:0.9804347826086957
noisy true:712
noisy false:428
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1140
epoch [48/200] batch [5/14] time 0.178 (0.189) data 0.102 (0.113) loss_x loss_x 0.5439 (0.7771) acc_x 87.5000 (80.6250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/14] time 0.171 (0.187) data 0.095 (0.110) loss_x loss_x 0.7998 (0.6791) acc_x 84.3750 (83.7500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 462
clean true:445
clean false:17
clean_rate:0.9632034632034632
noisy true:709
noisy false:429
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1138
epoch [49/200] batch [5/14] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.6069 (0.6360) acc_x 87.5000 (82.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/14] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 1.0195 (0.6817) acc_x 78.1250 (81.8750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:456
clean false:15
clean_rate:0.9681528662420382
noisy true:721
noisy false:408
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [50/200] batch [5/14] time 0.154 (0.158) data 0.078 (0.082) loss_x loss_x 0.5640 (0.5556) acc_x 81.2500 (85.6250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/14] time 0.158 (0.159) data 0.081 (0.083) loss_x loss_x 1.4121 (0.6582) acc_x 75.0000 (82.8125) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.2931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 469
clean true:456
clean false:13
clean_rate:0.9722814498933902
noisy true:708
noisy false:423
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 1131
epoch [51/200] batch [5/14] time 0.178 (0.182) data 0.102 (0.106) loss_x loss_x 0.4858 (0.6493) acc_x 87.5000 (79.3750) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/14] time 0.181 (0.184) data 0.106 (0.109) loss_x loss_x 0.7095 (0.6238) acc_x 84.3750 (81.8750) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 451
clean true:438
clean false:13
clean_rate:0.9711751662971175
noisy true:666
noisy false:483
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1149
epoch [52/200] batch [5/14] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.7266 (0.6452) acc_x 81.2500 (83.1250) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/14] time 0.161 (0.173) data 0.084 (0.097) loss_x loss_x 0.3809 (0.5243) acc_x 87.5000 (86.5625) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.2887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 462
clean true:453
clean false:9
clean_rate:0.9805194805194806
noisy true:733
noisy false:405
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1138
epoch [53/200] batch [5/14] time 0.179 (0.172) data 0.103 (0.096) loss_x loss_x 0.3794 (0.5620) acc_x 81.2500 (81.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/14] time 0.179 (0.172) data 0.102 (0.096) loss_x loss_x 1.0254 (0.7498) acc_x 71.8750 (78.4375) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.2862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 458
clean true:445
clean false:13
clean_rate:0.9716157205240175
noisy true:725
noisy false:417
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1142
epoch [54/200] batch [5/14] time 0.190 (0.184) data 0.113 (0.108) loss_x loss_x 0.6128 (0.5485) acc_x 81.2500 (81.2500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/14] time 0.180 (0.177) data 0.104 (0.101) loss_x loss_x 0.6387 (0.6013) acc_x 81.2500 (81.8750) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:459
clean false:12
clean_rate:0.9745222929936306
noisy true:689
noisy false:440
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [55/200] batch [5/14] time 0.166 (0.180) data 0.089 (0.104) loss_x loss_x 0.4570 (0.5731) acc_x 87.5000 (82.5000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/14] time 0.179 (0.179) data 0.103 (0.102) loss_x loss_x 0.6191 (0.6135) acc_x 78.1250 (81.8750) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.2887, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 462
clean true:449
clean false:13
clean_rate:0.9718614718614719
noisy true:702
noisy false:436
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1138
epoch [56/200] batch [5/14] time 0.163 (0.172) data 0.087 (0.095) loss_x loss_x 0.6133 (0.4873) acc_x 84.3750 (88.7500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/14] time 0.167 (0.167) data 0.091 (0.091) loss_x loss_x 0.9897 (0.6020) acc_x 81.2500 (86.2500) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:474
clean false:11
clean_rate:0.977319587628866
noisy true:698
noisy false:417
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [57/200] batch [5/15] time 0.202 (0.185) data 0.103 (0.104) loss_x loss_x 0.4888 (0.7631) acc_x 87.5000 (80.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/15] time 0.181 (0.197) data 0.106 (0.107) loss_x loss_x 0.6489 (0.6852) acc_x 84.3750 (82.1875) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [15/15] time 0.164 (0.189) data 0.088 (0.104) loss_x loss_x 0.4004 (0.6762) acc_x 90.6250 (81.8750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 464
clean true:450
clean false:14
clean_rate:0.9698275862068966
noisy true:704
noisy false:432
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1136
epoch [58/200] batch [5/14] time 0.177 (0.180) data 0.101 (0.104) loss_x loss_x 0.6890 (0.6001) acc_x 75.0000 (81.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/14] time 0.174 (0.184) data 0.084 (0.095) loss_x loss_x 0.5239 (0.6079) acc_x 81.2500 (82.1875) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:479
clean false:17
clean_rate:0.9657258064516129
noisy true:712
noisy false:392
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [59/200] batch [5/15] time 0.180 (0.171) data 0.103 (0.095) loss_x loss_x 0.9971 (0.7444) acc_x 78.1250 (79.3750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/15] time 0.177 (0.170) data 0.101 (0.094) loss_x loss_x 0.8760 (0.7823) acc_x 75.0000 (79.0625) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [15/15] time 0.182 (0.175) data 0.103 (0.098) loss_x loss_x 0.7959 (0.7465) acc_x 84.3750 (81.2500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 467
clean true:453
clean false:14
clean_rate:0.9700214132762313
noisy true:693
noisy false:440
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1133
epoch [60/200] batch [5/14] time 0.167 (0.167) data 0.091 (0.090) loss_x loss_x 0.3789 (0.6129) acc_x 93.7500 (83.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/14] time 0.190 (0.173) data 0.113 (0.097) loss_x loss_x 0.2827 (0.6875) acc_x 90.6250 (82.8125) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 467
clean true:456
clean false:11
clean_rate:0.9764453961456103
noisy true:676
noisy false:457
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1133
epoch [61/200] batch [5/14] time 0.292 (0.202) data 0.106 (0.103) loss_x loss_x 0.8179 (0.6278) acc_x 84.3750 (84.3750) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/14] time 0.181 (0.190) data 0.104 (0.102) loss_x loss_x 1.0771 (0.7014) acc_x 78.1250 (82.5000) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 483
clean true:466
clean false:17
clean_rate:0.9648033126293996
noisy true:671
noisy false:446
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1117
epoch [62/200] batch [5/15] time 0.193 (0.184) data 0.117 (0.107) loss_x loss_x 1.1396 (0.5669) acc_x 71.8750 (86.2500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/15] time 0.172 (0.185) data 0.095 (0.109) loss_x loss_x 0.6187 (0.6601) acc_x 78.1250 (83.4375) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [15/15] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.7051 (0.6215) acc_x 78.1250 (84.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2987, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 478
clean true:457
clean false:21
clean_rate:0.9560669456066946
noisy true:681
noisy false:441
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1122
epoch [63/200] batch [5/14] time 0.172 (0.187) data 0.096 (0.088) loss_x loss_x 0.6812 (0.6610) acc_x 84.3750 (83.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/14] time 0.196 (0.184) data 0.120 (0.097) loss_x loss_x 0.8232 (0.6159) acc_x 84.3750 (84.3750) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 490
clean true:473
clean false:17
clean_rate:0.9653061224489796
noisy true:681
noisy false:429
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1110
epoch [64/200] batch [5/15] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.3262 (0.5005) acc_x 93.7500 (88.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/15] time 0.179 (0.174) data 0.103 (0.098) loss_x loss_x 0.4009 (0.5553) acc_x 87.5000 (86.2500) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [15/15] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.4482 (0.6291) acc_x 87.5000 (84.5833) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 483
clean true:470
clean false:13
clean_rate:0.9730848861283644
noisy true:708
noisy false:409
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1117
epoch [65/200] batch [5/15] time 0.200 (0.185) data 0.124 (0.109) loss_x loss_x 0.5464 (0.6533) acc_x 90.6250 (82.5000) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/15] time 0.227 (0.187) data 0.151 (0.110) loss_x loss_x 0.5654 (0.6544) acc_x 81.2500 (80.6250) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [15/15] time 0.179 (0.192) data 0.103 (0.116) loss_x loss_x 0.3054 (0.6116) acc_x 93.7500 (81.8750) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:466
clean false:13
clean_rate:0.9728601252609603
noisy true:694
noisy false:427
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [66/200] batch [5/14] time 0.155 (0.157) data 0.078 (0.080) loss_x loss_x 0.7949 (0.6468) acc_x 75.0000 (83.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/14] time 0.221 (0.177) data 0.145 (0.100) loss_x loss_x 0.8320 (0.6219) acc_x 78.1250 (84.0625) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 466
clean true:448
clean false:18
clean_rate:0.9613733905579399
noisy true:692
noisy false:442
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1134
epoch [67/200] batch [5/14] time 0.181 (0.196) data 0.105 (0.120) loss_x loss_x 0.5488 (0.7927) acc_x 84.3750 (83.7500) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/14] time 0.206 (0.202) data 0.104 (0.112) loss_x loss_x 0.8472 (0.7459) acc_x 78.1250 (81.8750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:483
clean false:13
clean_rate:0.9737903225806451
noisy true:700
noisy false:404
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [68/200] batch [5/15] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.6260 (0.6665) acc_x 87.5000 (83.7500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/15] time 0.319 (0.194) data 0.135 (0.107) loss_x loss_x 0.7256 (0.6074) acc_x 78.1250 (84.3750) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [15/15] time 0.173 (0.186) data 0.096 (0.102) loss_x loss_x 0.8789 (0.6397) acc_x 81.2500 (83.9583) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.2981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 477
clean true:466
clean false:11
clean_rate:0.9769392033542977
noisy true:708
noisy false:415
after delete: len(clean_dataset) 477
after delete: len(noisy_dataset) 1123
epoch [69/200] batch [5/14] time 0.184 (0.185) data 0.109 (0.109) loss_x loss_x 0.7056 (0.6851) acc_x 81.2500 (84.3750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/14] time 0.175 (0.199) data 0.099 (0.106) loss_x loss_x 0.8042 (0.6890) acc_x 75.0000 (81.8750) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 486
clean true:472
clean false:14
clean_rate:0.9711934156378601
noisy true:699
noisy false:415
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1114
epoch [70/200] batch [5/15] time 0.182 (0.172) data 0.106 (0.095) loss_x loss_x 0.4197 (0.5338) acc_x 90.6250 (83.1250) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/15] time 0.158 (0.170) data 0.081 (0.093) loss_x loss_x 0.5220 (0.5393) acc_x 84.3750 (82.5000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [15/15] time 0.181 (0.173) data 0.105 (0.096) loss_x loss_x 1.1318 (0.5845) acc_x 75.0000 (82.7083) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.3012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 482
clean true:467
clean false:15
clean_rate:0.9688796680497925
noisy true:687
noisy false:431
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1118
epoch [71/200] batch [5/15] time 0.167 (0.170) data 0.091 (0.094) loss_x loss_x 0.4917 (0.6586) acc_x 84.3750 (81.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/15] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.4744 (0.6822) acc_x 90.6250 (81.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [15/15] time 0.180 (0.179) data 0.104 (0.102) loss_x loss_x 0.4741 (0.6204) acc_x 84.3750 (83.5417) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:475
clean false:13
clean_rate:0.9733606557377049
noisy true:692
noisy false:420
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [72/200] batch [5/15] time 0.157 (0.183) data 0.081 (0.084) loss_x loss_x 0.9453 (0.5521) acc_x 78.1250 (84.3750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/15] time 0.176 (0.175) data 0.100 (0.087) loss_x loss_x 0.6470 (0.7171) acc_x 84.3750 (80.3125) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [15/15] time 0.177 (0.174) data 0.101 (0.090) loss_x loss_x 0.4441 (0.7142) acc_x 87.5000 (79.5833) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 490
clean true:474
clean false:16
clean_rate:0.9673469387755103
noisy true:684
noisy false:426
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1110
epoch [73/200] batch [5/15] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.4849 (0.5050) acc_x 84.3750 (83.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/15] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.8037 (0.6079) acc_x 78.1250 (82.5000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [15/15] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.4973 (0.5848) acc_x 87.5000 (83.5417) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.3012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 482
clean true:462
clean false:20
clean_rate:0.9585062240663901
noisy true:691
noisy false:427
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1118
epoch [74/200] batch [5/15] time 0.189 (0.194) data 0.113 (0.118) loss_x loss_x 0.4141 (0.6830) acc_x 90.6250 (81.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/15] time 0.199 (0.194) data 0.122 (0.115) loss_x loss_x 0.5024 (0.6138) acc_x 81.2500 (83.1250) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [15/15] time 0.171 (0.190) data 0.095 (0.112) loss_x loss_x 0.5615 (0.6208) acc_x 81.2500 (83.3333) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:469
clean false:16
clean_rate:0.9670103092783505
noisy true:679
noisy false:436
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [75/200] batch [5/15] time 0.160 (0.178) data 0.084 (0.101) loss_x loss_x 0.4287 (0.6613) acc_x 93.7500 (85.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/15] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.8828 (0.6283) acc_x 78.1250 (85.9375) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [15/15] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7056 (0.6777) acc_x 81.2500 (84.5833) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.3037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 486
clean true:470
clean false:16
clean_rate:0.9670781893004116
noisy true:691
noisy false:423
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1114
epoch [76/200] batch [5/15] time 0.180 (0.201) data 0.104 (0.098) loss_x loss_x 0.6270 (0.5827) acc_x 78.1250 (83.1250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/15] time 0.184 (0.191) data 0.108 (0.101) loss_x loss_x 0.4629 (0.6652) acc_x 90.6250 (80.9375) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [15/15] time 0.177 (0.185) data 0.100 (0.100) loss_x loss_x 1.0391 (0.6715) acc_x 75.0000 (82.0833) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:471
clean false:17
clean_rate:0.9651639344262295
noisy true:685
noisy false:427
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [77/200] batch [5/15] time 0.294 (0.214) data 0.111 (0.109) loss_x loss_x 1.0107 (0.7131) acc_x 78.1250 (83.1250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/15] time 0.209 (0.200) data 0.133 (0.110) loss_x loss_x 0.4407 (0.7324) acc_x 87.5000 (80.9375) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/15] time 0.180 (0.193) data 0.104 (0.108) loss_x loss_x 1.0947 (0.7773) acc_x 68.7500 (80.0000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:464
clean false:15
clean_rate:0.9686847599164927
noisy true:697
noisy false:424
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [78/200] batch [5/14] time 0.192 (0.170) data 0.116 (0.094) loss_x loss_x 0.8003 (0.6623) acc_x 78.1250 (84.3750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/14] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.6982 (0.6310) acc_x 84.3750 (85.3125) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:456
clean false:12
clean_rate:0.9743589743589743
noisy true:688
noisy false:444
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [79/200] batch [5/14] time 0.218 (0.192) data 0.142 (0.115) loss_x loss_x 0.5674 (0.5942) acc_x 84.3750 (84.3750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/14] time 0.193 (0.194) data 0.117 (0.118) loss_x loss_x 0.7461 (0.6108) acc_x 84.3750 (85.0000) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.3012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 482
clean true:468
clean false:14
clean_rate:0.970954356846473
noisy true:670
noisy false:448
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1118
epoch [80/200] batch [5/15] time 0.196 (0.216) data 0.121 (0.106) loss_x loss_x 0.3765 (0.5605) acc_x 87.5000 (85.0000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/15] time 0.180 (0.201) data 0.102 (0.108) loss_x loss_x 0.6235 (0.6373) acc_x 81.2500 (83.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/15] time 0.177 (0.193) data 0.100 (0.105) loss_x loss_x 0.5767 (0.6200) acc_x 84.3750 (83.3333) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:477
clean false:15
clean_rate:0.9695121951219512
noisy true:683
noisy false:425
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [81/200] batch [5/15] time 0.229 (0.184) data 0.153 (0.107) loss_x loss_x 0.5942 (0.4997) acc_x 84.3750 (86.2500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/15] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.5991 (0.4814) acc_x 87.5000 (87.5000) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [15/15] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.9805 (0.5280) acc_x 84.3750 (86.8750) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 470
clean true:456
clean false:14
clean_rate:0.9702127659574468
noisy true:682
noisy false:448
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1130
epoch [82/200] batch [5/14] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5972 (0.5763) acc_x 84.3750 (86.2500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/14] time 0.188 (0.183) data 0.112 (0.107) loss_x loss_x 0.4702 (0.5786) acc_x 84.3750 (86.2500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:471
clean false:17
clean_rate:0.9651639344262295
noisy true:698
noisy false:414
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [83/200] batch [5/15] time 0.158 (0.170) data 0.082 (0.094) loss_x loss_x 0.6567 (0.6709) acc_x 84.3750 (85.6250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/15] time 0.177 (0.173) data 0.101 (0.096) loss_x loss_x 0.7124 (0.6110) acc_x 84.3750 (86.5625) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [15/15] time 0.160 (0.172) data 0.083 (0.096) loss_x loss_x 1.0508 (0.7139) acc_x 78.1250 (83.9583) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 482
clean true:468
clean false:14
clean_rate:0.970954356846473
noisy true:682
noisy false:436
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1118
epoch [84/200] batch [5/15] time 0.213 (0.189) data 0.137 (0.113) loss_x loss_x 1.2783 (0.5712) acc_x 71.8750 (87.5000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/15] time 0.191 (0.194) data 0.115 (0.107) loss_x loss_x 0.2776 (0.5798) acc_x 93.7500 (86.5625) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [15/15] time 0.181 (0.190) data 0.105 (0.107) loss_x loss_x 0.6699 (0.5879) acc_x 78.1250 (85.6250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:466
clean false:13
clean_rate:0.9728601252609603
noisy true:684
noisy false:437
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [85/200] batch [5/14] time 0.163 (0.165) data 0.087 (0.089) loss_x loss_x 0.3613 (0.5081) acc_x 87.5000 (86.2500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/14] time 0.156 (0.182) data 0.079 (0.091) loss_x loss_x 0.6196 (0.5807) acc_x 81.2500 (85.0000) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 464
clean true:454
clean false:10
clean_rate:0.978448275862069
noisy true:690
noisy false:446
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1136
epoch [86/200] batch [5/14] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.6621 (0.7554) acc_x 78.1250 (78.1250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/14] time 0.179 (0.177) data 0.103 (0.101) loss_x loss_x 0.7275 (0.7162) acc_x 78.1250 (79.6875) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.3037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 486
clean true:473
clean false:13
clean_rate:0.9732510288065843
noisy true:671
noisy false:443
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1114
epoch [87/200] batch [5/15] time 0.291 (0.204) data 0.104 (0.106) loss_x loss_x 0.2510 (0.4737) acc_x 93.7500 (86.2500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/15] time 0.183 (0.193) data 0.107 (0.106) loss_x loss_x 0.6206 (0.4703) acc_x 84.3750 (86.8750) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [15/15] time 0.183 (0.190) data 0.106 (0.106) loss_x loss_x 0.4834 (0.4839) acc_x 84.3750 (87.5000) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:471
clean false:14
clean_rate:0.9711340206185567
noisy true:682
noisy false:433
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [88/200] batch [5/15] time 0.162 (0.177) data 0.086 (0.100) loss_x loss_x 0.4099 (0.4181) acc_x 84.3750 (90.0000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/15] time 0.159 (0.170) data 0.082 (0.094) loss_x loss_x 1.0117 (0.4859) acc_x 75.0000 (87.8125) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [15/15] time 0.179 (0.174) data 0.103 (0.098) loss_x loss_x 0.9868 (0.5983) acc_x 75.0000 (85.4167) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 490
clean true:477
clean false:13
clean_rate:0.9734693877551021
noisy true:701
noisy false:409
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1110
epoch [89/200] batch [5/15] time 0.159 (0.166) data 0.083 (0.090) loss_x loss_x 0.3259 (0.6437) acc_x 90.6250 (82.5000) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/15] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.2549 (0.5448) acc_x 93.7500 (86.2500) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [15/15] time 0.177 (0.178) data 0.101 (0.102) loss_x loss_x 0.6772 (0.5870) acc_x 84.3750 (85.0000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 495
clean true:485
clean false:10
clean_rate:0.9797979797979798
noisy true:683
noisy false:422
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1105
epoch [90/200] batch [5/15] time 0.198 (0.184) data 0.122 (0.108) loss_x loss_x 0.5142 (0.5556) acc_x 81.2500 (83.7500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/15] time 0.187 (0.191) data 0.112 (0.115) loss_x loss_x 0.4209 (0.6637) acc_x 90.6250 (81.5625) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [15/15] time 0.185 (0.188) data 0.110 (0.112) loss_x loss_x 0.8433 (0.6188) acc_x 84.3750 (83.5417) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:491
clean false:14
clean_rate:0.9722772277227723
noisy true:692
noisy false:403
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [91/200] batch [5/15] time 0.184 (0.190) data 0.108 (0.114) loss_x loss_x 0.4336 (0.5464) acc_x 90.6250 (88.7500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/15] time 0.175 (0.194) data 0.099 (0.106) loss_x loss_x 0.3411 (0.5110) acc_x 90.6250 (88.4375) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [15/15] time 0.203 (0.192) data 0.127 (0.108) loss_x loss_x 0.7925 (0.5650) acc_x 84.3750 (86.4583) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:476
clean false:16
clean_rate:0.967479674796748
noisy true:680
noisy false:428
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [92/200] batch [5/15] time 0.177 (0.192) data 0.101 (0.116) loss_x loss_x 0.9980 (0.7016) acc_x 71.8750 (81.2500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/15] time 0.172 (0.180) data 0.096 (0.103) loss_x loss_x 0.5547 (0.5766) acc_x 87.5000 (84.3750) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [15/15] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.9790 (0.6694) acc_x 81.2500 (82.9167) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:464
clean false:15
clean_rate:0.9686847599164927
noisy true:685
noisy false:436
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [93/200] batch [5/14] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8667 (0.5896) acc_x 90.6250 (87.5000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/14] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.5884 (0.5411) acc_x 93.7500 (87.8125) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:472
clean false:13
clean_rate:0.9731958762886598
noisy true:707
noisy false:408
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [94/200] batch [5/15] time 0.160 (0.189) data 0.083 (0.084) loss_x loss_x 0.4839 (0.5462) acc_x 90.6250 (85.6250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/15] time 0.194 (0.177) data 0.119 (0.087) loss_x loss_x 0.4775 (0.5490) acc_x 84.3750 (85.3125) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [15/15] time 0.171 (0.176) data 0.095 (0.090) loss_x loss_x 0.4343 (0.5609) acc_x 87.5000 (85.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:485
clean false:13
clean_rate:0.9738955823293173
noisy true:686
noisy false:416
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [95/200] batch [5/15] time 0.159 (0.169) data 0.083 (0.093) loss_x loss_x 0.4712 (0.7627) acc_x 87.5000 (83.1250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/15] time 0.165 (0.171) data 0.089 (0.095) loss_x loss_x 0.6343 (0.7012) acc_x 84.3750 (84.6875) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [15/15] time 0.159 (0.167) data 0.082 (0.091) loss_x loss_x 0.6675 (0.7128) acc_x 84.3750 (83.9583) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.3025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 484
clean true:469
clean false:15
clean_rate:0.96900826446281
noisy true:675
noisy false:441
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1116
epoch [96/200] batch [5/15] time 0.181 (0.211) data 0.104 (0.100) loss_x loss_x 0.5854 (0.6330) acc_x 78.1250 (81.2500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/15] time 0.178 (0.198) data 0.101 (0.104) loss_x loss_x 0.8193 (0.6921) acc_x 75.0000 (80.6250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [15/15] time 0.210 (0.198) data 0.116 (0.105) loss_x loss_x 0.4731 (0.6690) acc_x 90.6250 (82.2917) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:483
clean false:15
clean_rate:0.9698795180722891
noisy true:667
noisy false:435
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [97/200] batch [5/15] time 0.182 (0.217) data 0.106 (0.113) loss_x loss_x 0.9771 (0.6477) acc_x 81.2500 (85.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/15] time 0.192 (0.200) data 0.115 (0.110) loss_x loss_x 0.4587 (0.5504) acc_x 84.3750 (86.5625) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/15] time 0.188 (0.198) data 0.112 (0.113) loss_x loss_x 0.8389 (0.6084) acc_x 81.2500 (84.1667) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 474
clean true:463
clean false:11
clean_rate:0.9767932489451476
noisy true:673
noisy false:453
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1126
epoch [98/200] batch [5/14] time 0.227 (0.193) data 0.150 (0.117) loss_x loss_x 0.3245 (0.4046) acc_x 90.6250 (88.7500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/14] time 0.184 (0.192) data 0.108 (0.116) loss_x loss_x 0.8232 (0.5153) acc_x 78.1250 (85.6250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:477
clean false:17
clean_rate:0.9655870445344129
noisy true:690
noisy false:416
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [99/200] batch [5/15] time 0.164 (0.173) data 0.087 (0.097) loss_x loss_x 0.3760 (0.5414) acc_x 90.6250 (85.0000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/15] time 0.162 (0.167) data 0.086 (0.090) loss_x loss_x 0.5581 (0.5322) acc_x 81.2500 (85.6250) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [15/15] time 0.161 (0.179) data 0.085 (0.089) loss_x loss_x 0.6846 (0.5599) acc_x 78.1250 (85.0000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:479
clean false:15
clean_rate:0.9696356275303644
noisy true:693
noisy false:413
all clean rate:  [0.9653979238754326, 0.9680511182108626, 0.9744245524296675, 0.989821882951654, 0.9848101265822785, 0.9828431372549019, 0.9818181818181818, 0.9857482185273159, 0.9809976247030879, 0.9862068965517241, 0.979498861047836, 0.9882352941176471, 0.9788732394366197, 0.9694835680751174, 0.9733009708737864, 0.9810874704491725, 0.9742990654205608, 0.9701834862385321, 0.974477958236659, 0.9711751662971175, 0.9760869565217392, 0.9722863741339491, 0.9772727272727273, 0.9713024282560706, 0.9724137931034482, 0.9816091954022989, 0.9774774774774775, 0.9663677130044843, 0.9731543624161074, 0.9695652173913043, 0.9729119638826185, 0.978448275862069, 0.9647577092511013, 0.9733333333333334, 0.9823788546255506, 0.9803921568627451, 0.9728506787330317, 0.9698275862068966, 0.9735099337748344, 0.9718004338394793, 0.9725738396624473, 0.975929978118162, 0.9671772428884027, 0.9752808988764045, 0.9736842105263158, 0.967948717948718, 0.9680851063829787, 0.9804347826086957, 0.9632034632034632, 0.9681528662420382, 0.9722814498933902, 0.9711751662971175, 0.9805194805194806, 0.9716157205240175, 0.9745222929936306, 0.9718614718614719, 0.977319587628866, 0.9698275862068966, 0.9657258064516129, 0.9700214132762313, 0.9764453961456103, 0.9648033126293996, 0.9560669456066946, 0.9653061224489796, 0.9730848861283644, 0.9728601252609603, 0.9613733905579399, 0.9737903225806451, 0.9769392033542977, 0.9711934156378601, 0.9688796680497925, 0.9733606557377049, 0.9673469387755103, 0.9585062240663901, 0.9670103092783505, 0.9670781893004116, 0.9651639344262295, 0.9686847599164927, 0.9743589743589743, 0.970954356846473, 0.9695121951219512, 0.9702127659574468, 0.9651639344262295, 0.970954356846473, 0.9728601252609603, 0.978448275862069, 0.9732510288065843, 0.9711340206185567, 0.9734693877551021, 0.9797979797979798, 0.9722772277227723, 0.967479674796748, 0.9686847599164927, 0.9731958762886598, 0.9738955823293173, 0.96900826446281, 0.9698795180722891, 0.9767932489451476, 0.9655870445344129, 0.9696356275303644]
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [100/200] batch [5/15] time 0.190 (0.174) data 0.114 (0.097) loss_x loss_x 0.6143 (0.6455) acc_x 78.1250 (79.3750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/15] time 0.184 (0.177) data 0.108 (0.101) loss_x loss_x 0.5967 (0.5787) acc_x 87.5000 (83.7500) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [15/15] time 0.170 (0.184) data 0.094 (0.100) loss_x loss_x 0.7222 (0.5996) acc_x 84.3750 (83.9583) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 502
clean true:484
clean false:18
clean_rate:0.9641434262948207
noisy true:683
noisy false:415
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1098
epoch [101/200] batch [5/15] time 0.185 (0.178) data 0.109 (0.102) loss_x loss_x 0.8022 (0.6498) acc_x 84.3750 (82.5000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/15] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.9180 (0.7050) acc_x 75.0000 (80.9375) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [15/15] time 0.278 (0.181) data 0.093 (0.097) loss_x loss_x 0.7866 (0.6748) acc_x 84.3750 (82.5000) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 502
clean true:485
clean false:17
clean_rate:0.9661354581673307
noisy true:679
noisy false:419
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1098
epoch [102/200] batch [5/15] time 0.158 (0.171) data 0.082 (0.094) loss_x loss_x 0.6484 (0.6410) acc_x 84.3750 (83.7500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/15] time 0.184 (0.178) data 0.108 (0.101) loss_x loss_x 0.9307 (0.6898) acc_x 71.8750 (82.1875) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [15/15] time 0.179 (0.181) data 0.103 (0.104) loss_x loss_x 0.5747 (0.6452) acc_x 90.6250 (83.9583) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 495
clean true:481
clean false:14
clean_rate:0.9717171717171718
noisy true:688
noisy false:417
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1105
epoch [103/200] batch [5/15] time 0.158 (0.158) data 0.082 (0.082) loss_x loss_x 0.6860 (0.5966) acc_x 81.2500 (83.1250) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/15] time 0.163 (0.169) data 0.085 (0.083) loss_x loss_x 0.4839 (0.6604) acc_x 90.6250 (83.1250) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [15/15] time 0.156 (0.166) data 0.080 (0.082) loss_x loss_x 0.8003 (0.7163) acc_x 81.2500 (82.0833) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:480
clean false:14
clean_rate:0.97165991902834
noisy true:699
noisy false:407
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [104/200] batch [5/15] time 0.183 (0.188) data 0.107 (0.111) loss_x loss_x 0.2130 (0.4211) acc_x 93.7500 (88.7500) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/15] time 0.216 (0.199) data 0.139 (0.112) loss_x loss_x 0.8433 (0.4754) acc_x 75.0000 (86.5625) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [15/15] time 0.186 (0.193) data 0.110 (0.109) loss_x loss_x 0.5571 (0.5105) acc_x 90.6250 (86.2500) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 487
clean true:473
clean false:14
clean_rate:0.971252566735113
noisy true:692
noisy false:421
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1113
epoch [105/200] batch [5/15] time 0.163 (0.162) data 0.087 (0.086) loss_x loss_x 1.0166 (0.6461) acc_x 68.7500 (80.6250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/15] time 0.170 (0.178) data 0.094 (0.090) loss_x loss_x 0.7544 (0.6688) acc_x 81.2500 (82.1875) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [15/15] time 0.182 (0.178) data 0.105 (0.094) loss_x loss_x 0.6030 (0.6158) acc_x 90.6250 (85.2083) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:495
clean false:14
clean_rate:0.9724950884086444
noisy true:677
noisy false:414
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [106/200] batch [5/15] time 0.180 (0.220) data 0.104 (0.108) loss_x loss_x 0.7788 (0.6986) acc_x 75.0000 (83.7500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/15] time 0.162 (0.197) data 0.085 (0.103) loss_x loss_x 0.6729 (0.7415) acc_x 84.3750 (82.5000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [15/15] time 0.170 (0.187) data 0.094 (0.099) loss_x loss_x 0.5259 (0.6642) acc_x 84.3750 (83.5417) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:495
clean false:18
clean_rate:0.9649122807017544
noisy true:695
noisy false:392
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [107/200] batch [5/16] time 0.169 (0.187) data 0.092 (0.111) loss_x loss_x 0.6499 (0.6055) acc_x 81.2500 (82.5000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/16] time 0.186 (0.189) data 0.109 (0.113) loss_x loss_x 0.7886 (0.6728) acc_x 78.1250 (81.8750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/16] time 0.172 (0.184) data 0.095 (0.108) loss_x loss_x 0.7671 (0.6673) acc_x 81.2500 (82.9167) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:498
clean false:16
clean_rate:0.9688715953307393
noisy true:689
noisy false:397
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [108/200] batch [5/16] time 0.157 (0.162) data 0.081 (0.085) loss_x loss_x 0.3850 (0.5237) acc_x 87.5000 (87.5000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/16] time 0.269 (0.172) data 0.083 (0.084) loss_x loss_x 0.4683 (0.5744) acc_x 87.5000 (85.9375) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/16] time 0.171 (0.179) data 0.095 (0.096) loss_x loss_x 0.5161 (0.5947) acc_x 84.3750 (85.0000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.3025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 484
clean true:470
clean false:14
clean_rate:0.9710743801652892
noisy true:703
noisy false:413
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1116
epoch [109/200] batch [5/15] time 0.194 (0.188) data 0.118 (0.112) loss_x loss_x 0.6260 (0.6273) acc_x 90.6250 (83.7500) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/15] time 0.184 (0.205) data 0.108 (0.118) loss_x loss_x 0.6177 (0.5627) acc_x 81.2500 (84.6875) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/15] time 0.184 (0.197) data 0.107 (0.114) loss_x loss_x 0.3916 (0.5625) acc_x 84.3750 (85.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:497
clean false:12
clean_rate:0.9764243614931237
noisy true:688
noisy false:403
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [110/200] batch [5/15] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.8159 (0.6872) acc_x 78.1250 (81.2500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/15] time 0.181 (0.193) data 0.105 (0.106) loss_x loss_x 0.4290 (0.5943) acc_x 90.6250 (85.0000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [15/15] time 0.181 (0.190) data 0.104 (0.106) loss_x loss_x 0.5093 (0.5541) acc_x 87.5000 (86.2500) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:477
clean false:20
clean_rate:0.959758551307847
noisy true:672
noisy false:431
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [111/200] batch [5/15] time 0.182 (0.166) data 0.106 (0.089) loss_x loss_x 0.4155 (0.5394) acc_x 90.6250 (85.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/15] time 0.218 (0.183) data 0.142 (0.096) loss_x loss_x 0.5259 (0.5292) acc_x 87.5000 (85.3125) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [15/15] time 0.175 (0.184) data 0.099 (0.100) loss_x loss_x 0.6479 (0.5277) acc_x 81.2500 (84.5833) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:481
clean false:17
clean_rate:0.9658634538152611
noisy true:676
noisy false:426
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [112/200] batch [5/15] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.4087 (0.4981) acc_x 93.7500 (89.3750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/15] time 0.157 (0.159) data 0.080 (0.083) loss_x loss_x 0.6909 (0.5089) acc_x 78.1250 (87.8125) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [15/15] time 0.157 (0.159) data 0.082 (0.083) loss_x loss_x 0.4863 (0.5794) acc_x 84.3750 (86.0417) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:486
clean false:14
clean_rate:0.972
noisy true:694
noisy false:406
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [113/200] batch [5/15] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.9136 (0.7648) acc_x 84.3750 (83.1250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/15] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.3643 (0.6695) acc_x 84.3750 (83.7500) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [15/15] time 0.185 (0.188) data 0.108 (0.105) loss_x loss_x 0.7368 (0.6579) acc_x 78.1250 (82.9167) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 487
clean true:469
clean false:18
clean_rate:0.9630390143737166
noisy true:711
noisy false:402
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1113
epoch [114/200] batch [5/15] time 0.194 (0.187) data 0.118 (0.111) loss_x loss_x 0.4502 (0.4889) acc_x 87.5000 (86.8750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/15] time 0.182 (0.186) data 0.106 (0.111) loss_x loss_x 0.4919 (0.4595) acc_x 87.5000 (87.8125) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [15/15] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.4285 (0.5020) acc_x 93.7500 (86.8750) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:486
clean false:14
clean_rate:0.972
noisy true:673
noisy false:427
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [115/200] batch [5/15] time 0.191 (0.198) data 0.114 (0.100) loss_x loss_x 0.5068 (0.4325) acc_x 84.3750 (87.5000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/15] time 0.180 (0.186) data 0.104 (0.099) loss_x loss_x 0.5811 (0.4348) acc_x 81.2500 (87.1875) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [15/15] time 0.171 (0.182) data 0.094 (0.098) loss_x loss_x 0.6641 (0.4760) acc_x 75.0000 (86.0417) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:483
clean false:16
clean_rate:0.9679358717434869
noisy true:660
noisy false:441
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [116/200] batch [5/15] time 0.159 (0.158) data 0.083 (0.081) loss_x loss_x 0.4507 (0.5396) acc_x 87.5000 (85.0000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/15] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.4377 (0.4635) acc_x 90.6250 (87.1875) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [15/15] time 0.272 (0.176) data 0.099 (0.093) loss_x loss_x 0.8726 (0.5291) acc_x 81.2500 (86.4583) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:479
clean false:15
clean_rate:0.9696356275303644
noisy true:704
noisy false:402
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [117/200] batch [5/15] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.4778 (0.4314) acc_x 90.6250 (88.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/15] time 0.188 (0.194) data 0.111 (0.106) loss_x loss_x 0.8481 (0.5735) acc_x 81.2500 (85.0000) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [15/15] time 0.180 (0.189) data 0.104 (0.105) loss_x loss_x 0.5981 (0.5469) acc_x 87.5000 (85.8333) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:487
clean false:13
clean_rate:0.974
noisy true:671
noisy false:429
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [118/200] batch [5/15] time 0.171 (0.163) data 0.095 (0.087) loss_x loss_x 0.5220 (0.6576) acc_x 84.3750 (80.6250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/15] time 0.183 (0.171) data 0.108 (0.095) loss_x loss_x 0.4319 (0.5971) acc_x 87.5000 (83.1250) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [15/15] time 0.185 (0.183) data 0.108 (0.100) loss_x loss_x 1.1074 (0.6014) acc_x 81.2500 (84.1667) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.3044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 487
clean true:472
clean false:15
clean_rate:0.9691991786447639
noisy true:670
noisy false:443
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1113
epoch [119/200] batch [5/15] time 0.174 (0.181) data 0.097 (0.105) loss_x loss_x 0.5020 (0.5522) acc_x 87.5000 (88.1250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/15] time 0.192 (0.179) data 0.116 (0.102) loss_x loss_x 0.3760 (0.5781) acc_x 87.5000 (86.8750) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [15/15] time 0.188 (0.192) data 0.111 (0.104) loss_x loss_x 0.4358 (0.5705) acc_x 90.6250 (86.4583) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:483
clean false:16
clean_rate:0.9679358717434869
noisy true:663
noisy false:438
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [120/200] batch [5/15] time 0.181 (0.173) data 0.105 (0.097) loss_x loss_x 0.7212 (0.6157) acc_x 81.2500 (83.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/15] time 0.187 (0.173) data 0.111 (0.097) loss_x loss_x 0.2715 (0.5851) acc_x 87.5000 (84.6875) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [15/15] time 0.183 (0.183) data 0.106 (0.100) loss_x loss_x 0.8286 (0.5789) acc_x 87.5000 (84.5833) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 501
clean true:487
clean false:14
clean_rate:0.9720558882235529
noisy true:682
noisy false:417
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1099
epoch [121/200] batch [5/15] time 0.158 (0.160) data 0.082 (0.083) loss_x loss_x 0.7812 (0.6806) acc_x 84.3750 (85.0000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/15] time 0.157 (0.173) data 0.080 (0.083) loss_x loss_x 0.6206 (0.6216) acc_x 84.3750 (86.8750) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [15/15] time 0.165 (0.169) data 0.088 (0.083) loss_x loss_x 0.4722 (0.5959) acc_x 93.7500 (87.5000) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 495
clean true:480
clean false:15
clean_rate:0.9696969696969697
noisy true:660
noisy false:445
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1105
epoch [122/200] batch [5/15] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.4380 (0.5947) acc_x 84.3750 (80.6250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/15] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.2240 (0.5637) acc_x 96.8750 (82.5000) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [15/15] time 0.185 (0.193) data 0.109 (0.106) loss_x loss_x 0.7090 (0.5930) acc_x 87.5000 (83.9583) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 506
clean true:491
clean false:15
clean_rate:0.9703557312252964
noisy true:691
noisy false:403
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1094
epoch [123/200] batch [5/15] time 0.170 (0.184) data 0.093 (0.107) loss_x loss_x 0.4690 (0.6724) acc_x 87.5000 (83.7500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/15] time 0.190 (0.183) data 0.113 (0.107) loss_x loss_x 0.4519 (0.5932) acc_x 84.3750 (84.6875) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [15/15] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.8828 (0.6402) acc_x 78.1250 (84.3750) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:489
clean false:15
clean_rate:0.9702380952380952
noisy true:686
noisy false:410
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [124/200] batch [5/15] time 0.199 (0.196) data 0.123 (0.119) loss_x loss_x 0.1501 (0.5453) acc_x 93.7500 (85.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/15] time 0.187 (0.191) data 0.110 (0.115) loss_x loss_x 0.3662 (0.5115) acc_x 90.6250 (86.5625) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [15/15] time 0.180 (0.195) data 0.103 (0.112) loss_x loss_x 0.9277 (0.5599) acc_x 81.2500 (85.8333) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:488
clean false:9
clean_rate:0.9818913480885312
noisy true:691
noisy false:412
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [125/200] batch [5/15] time 0.171 (0.192) data 0.095 (0.115) loss_x loss_x 0.6162 (0.5724) acc_x 81.2500 (86.8750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/15] time 0.193 (0.183) data 0.117 (0.107) loss_x loss_x 0.4238 (0.5159) acc_x 90.6250 (87.8125) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [15/15] time 0.183 (0.187) data 0.107 (0.104) loss_x loss_x 0.5332 (0.5417) acc_x 81.2500 (85.8333) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 506
clean true:491
clean false:15
clean_rate:0.9703557312252964
noisy true:679
noisy false:415
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1094
epoch [126/200] batch [5/15] time 0.196 (0.185) data 0.104 (0.105) loss_x loss_x 0.8750 (0.5323) acc_x 78.1250 (85.6250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/15] time 0.176 (0.194) data 0.099 (0.105) loss_x loss_x 0.4312 (0.5627) acc_x 90.6250 (85.6250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [15/15] time 0.187 (0.195) data 0.110 (0.110) loss_x loss_x 0.7021 (0.6431) acc_x 84.3750 (84.7917) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 495
clean true:480
clean false:15
clean_rate:0.9696969696969697
noisy true:664
noisy false:441
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1105
epoch [127/200] batch [5/15] time 0.160 (0.168) data 0.083 (0.092) loss_x loss_x 0.6875 (0.6834) acc_x 81.2500 (81.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/15] time 0.176 (0.169) data 0.100 (0.092) loss_x loss_x 0.3477 (0.6321) acc_x 93.7500 (84.3750) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [15/15] time 0.212 (0.175) data 0.136 (0.098) loss_x loss_x 0.6772 (0.6098) acc_x 81.2500 (85.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:491
clean false:16
clean_rate:0.9684418145956607
noisy true:696
noisy false:397
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [128/200] batch [5/15] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9429 (0.5786) acc_x 78.1250 (86.2500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/15] time 0.182 (0.189) data 0.105 (0.113) loss_x loss_x 0.9800 (0.6127) acc_x 78.1250 (84.3750) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [15/15] time 0.177 (0.185) data 0.101 (0.109) loss_x loss_x 0.7271 (0.6384) acc_x 78.1250 (83.5417) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:492
clean false:19
clean_rate:0.9628180039138943
noisy true:675
noisy false:414
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [129/200] batch [5/15] time 0.185 (0.192) data 0.109 (0.115) loss_x loss_x 0.6567 (0.5699) acc_x 87.5000 (85.6250) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/15] time 0.187 (0.187) data 0.111 (0.111) loss_x loss_x 0.5903 (0.4706) acc_x 84.3750 (88.7500) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [15/15] time 0.181 (0.191) data 0.104 (0.115) loss_x loss_x 0.9443 (0.5646) acc_x 78.1250 (85.2083) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 489
clean true:476
clean false:13
clean_rate:0.9734151329243353
noisy true:694
noisy false:417
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1111
epoch [130/200] batch [5/15] time 0.158 (0.159) data 0.082 (0.082) loss_x loss_x 0.2244 (0.4386) acc_x 96.8750 (88.7500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/15] time 0.178 (0.178) data 0.101 (0.094) loss_x loss_x 1.1650 (0.6006) acc_x 71.8750 (84.0625) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [15/15] time 0.162 (0.176) data 0.085 (0.094) loss_x loss_x 0.3599 (0.5918) acc_x 87.5000 (85.6250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:481
clean false:16
clean_rate:0.9678068410462777
noisy true:674
noisy false:429
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [131/200] batch [5/15] time 0.163 (0.167) data 0.087 (0.090) loss_x loss_x 0.6372 (0.6672) acc_x 84.3750 (84.3750) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/15] time 0.185 (0.170) data 0.108 (0.093) loss_x loss_x 0.5625 (0.6217) acc_x 78.1250 (84.0625) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [15/15] time 0.155 (0.170) data 0.078 (0.093) loss_x loss_x 0.3464 (0.5517) acc_x 90.6250 (85.2083) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:490
clean false:13
clean_rate:0.974155069582505
noisy true:690
noisy false:407
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [132/200] batch [5/15] time 0.199 (0.201) data 0.123 (0.124) loss_x loss_x 0.4678 (0.6336) acc_x 78.1250 (83.1250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/15] time 0.177 (0.203) data 0.101 (0.115) loss_x loss_x 0.5840 (0.6182) acc_x 87.5000 (83.4375) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/15] time 0.171 (0.196) data 0.095 (0.112) loss_x loss_x 0.1848 (0.5715) acc_x 100.0000 (85.0000) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 493
clean true:476
clean false:17
clean_rate:0.9655172413793104
noisy true:674
noisy false:433
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1107
epoch [133/200] batch [5/15] time 0.208 (0.199) data 0.132 (0.123) loss_x loss_x 0.2891 (0.5549) acc_x 96.8750 (85.0000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/15] time 0.183 (0.191) data 0.106 (0.114) loss_x loss_x 0.6157 (0.5194) acc_x 78.1250 (85.0000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [15/15] time 0.188 (0.191) data 0.110 (0.114) loss_x loss_x 0.3809 (0.5353) acc_x 93.7500 (86.0417) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:483
clean false:13
clean_rate:0.9737903225806451
noisy true:715
noisy false:389
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [134/200] batch [5/15] time 0.170 (0.174) data 0.094 (0.098) loss_x loss_x 0.3660 (0.6370) acc_x 87.5000 (81.2500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/15] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.5723 (0.5481) acc_x 87.5000 (84.3750) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [15/15] time 0.208 (0.176) data 0.104 (0.098) loss_x loss_x 0.6240 (0.5356) acc_x 78.1250 (84.5833) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:485
clean false:15
clean_rate:0.97
noisy true:709
noisy false:391
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [135/200] batch [5/15] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.6724 (0.4453) acc_x 81.2500 (88.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/15] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.4731 (0.5725) acc_x 84.3750 (85.6250) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [15/15] time 0.218 (0.190) data 0.129 (0.112) loss_x loss_x 0.3884 (0.5059) acc_x 90.6250 (86.8750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:495
clean false:14
clean_rate:0.9724950884086444
noisy true:671
noisy false:420
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [136/200] batch [5/15] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.6533 (0.4599) acc_x 84.3750 (89.3750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/15] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.6621 (0.4672) acc_x 84.3750 (88.1250) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [15/15] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.8364 (0.5090) acc_x 78.1250 (86.6667) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 508
clean true:495
clean false:13
clean_rate:0.9744094488188977
noisy true:659
noisy false:433
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1092
epoch [137/200] batch [5/15] time 0.184 (0.193) data 0.107 (0.116) loss_x loss_x 0.6851 (0.5339) acc_x 81.2500 (86.8750) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/15] time 0.185 (0.189) data 0.108 (0.113) loss_x loss_x 0.6372 (0.6492) acc_x 87.5000 (84.6875) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [15/15] time 0.203 (0.190) data 0.106 (0.112) loss_x loss_x 0.5464 (0.6547) acc_x 84.3750 (83.1250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:495
clean false:18
clean_rate:0.9649122807017544
noisy true:699
noisy false:388
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [138/200] batch [5/16] time 0.161 (0.186) data 0.084 (0.110) loss_x loss_x 0.5454 (0.5809) acc_x 81.2500 (85.0000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/16] time 0.171 (0.177) data 0.095 (0.101) loss_x loss_x 0.7358 (0.6071) acc_x 84.3750 (84.3750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/16] time 0.210 (0.178) data 0.133 (0.102) loss_x loss_x 0.9429 (0.6442) acc_x 78.1250 (83.3333) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:487
clean false:16
clean_rate:0.9681908548707754
noisy true:677
noisy false:420
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [139/200] batch [5/15] time 0.173 (0.181) data 0.097 (0.105) loss_x loss_x 0.6230 (0.4332) acc_x 81.2500 (88.7500) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/15] time 0.160 (0.191) data 0.084 (0.104) loss_x loss_x 0.4536 (0.3846) acc_x 90.6250 (90.6250) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [15/15] time 0.183 (0.187) data 0.106 (0.104) loss_x loss_x 0.4241 (0.4862) acc_x 93.7500 (88.7500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 490
clean true:474
clean false:16
clean_rate:0.9673469387755103
noisy true:679
noisy false:431
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1110
epoch [140/200] batch [5/15] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.6279 (0.6527) acc_x 84.3750 (86.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/15] time 0.278 (0.200) data 0.113 (0.105) loss_x loss_x 0.6743 (0.6310) acc_x 84.3750 (86.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/15] time 0.184 (0.196) data 0.108 (0.108) loss_x loss_x 0.3076 (0.5502) acc_x 93.7500 (87.0833) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:484
clean false:19
clean_rate:0.9622266401590457
noisy true:683
noisy false:414
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [141/200] batch [5/15] time 0.164 (0.173) data 0.088 (0.097) loss_x loss_x 0.4902 (0.4883) acc_x 84.3750 (85.0000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/15] time 0.194 (0.195) data 0.119 (0.108) loss_x loss_x 0.5898 (0.6422) acc_x 84.3750 (83.7500) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [15/15] time 0.182 (0.192) data 0.105 (0.108) loss_x loss_x 0.5166 (0.6358) acc_x 87.5000 (84.5833) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:488
clean false:17
clean_rate:0.9663366336633663
noisy true:680
noisy false:415
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [142/200] batch [5/15] time 0.182 (0.192) data 0.105 (0.116) loss_x loss_x 0.5850 (0.4983) acc_x 87.5000 (88.7500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/15] time 0.181 (0.193) data 0.105 (0.117) loss_x loss_x 1.2061 (0.5752) acc_x 71.8750 (85.6250) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [15/15] time 0.173 (0.199) data 0.097 (0.112) loss_x loss_x 0.8218 (0.5613) acc_x 75.0000 (85.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 502
clean true:489
clean false:13
clean_rate:0.9741035856573705
noisy true:687
noisy false:411
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1098
epoch [143/200] batch [5/15] time 0.184 (0.212) data 0.107 (0.101) loss_x loss_x 0.3406 (0.4566) acc_x 93.7500 (88.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/15] time 0.179 (0.197) data 0.103 (0.104) loss_x loss_x 0.8911 (0.5741) acc_x 75.0000 (85.3125) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [15/15] time 0.182 (0.193) data 0.106 (0.105) loss_x loss_x 0.6475 (0.5853) acc_x 84.3750 (85.0000) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:496
clean false:15
clean_rate:0.9706457925636007
noisy true:700
noisy false:389
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [144/200] batch [5/15] time 0.193 (0.201) data 0.117 (0.125) loss_x loss_x 0.4478 (0.5734) acc_x 84.3750 (82.5000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/15] time 0.181 (0.193) data 0.103 (0.116) loss_x loss_x 0.5054 (0.5867) acc_x 78.1250 (83.4375) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [15/15] time 0.188 (0.189) data 0.111 (0.113) loss_x loss_x 0.7207 (0.6310) acc_x 84.3750 (82.5000) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:497
clean false:14
clean_rate:0.9726027397260274
noisy true:686
noisy false:403
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [145/200] batch [5/15] time 0.162 (0.160) data 0.086 (0.084) loss_x loss_x 0.3513 (0.6729) acc_x 90.6250 (85.0000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/15] time 0.160 (0.160) data 0.084 (0.084) loss_x loss_x 0.3337 (0.5397) acc_x 87.5000 (87.1875) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [15/15] time 0.157 (0.159) data 0.080 (0.083) loss_x loss_x 0.6704 (0.6213) acc_x 87.5000 (84.7917) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:494
clean false:19
clean_rate:0.9629629629629629
noisy true:685
noisy false:402
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [146/200] batch [5/16] time 0.186 (0.199) data 0.111 (0.123) loss_x loss_x 0.2078 (0.4923) acc_x 93.7500 (88.7500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/16] time 0.180 (0.207) data 0.103 (0.119) loss_x loss_x 0.1812 (0.4364) acc_x 96.8750 (90.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/16] time 0.174 (0.199) data 0.098 (0.115) loss_x loss_x 0.6445 (0.4867) acc_x 78.1250 (87.5000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:492
clean false:15
clean_rate:0.9704142011834319
noisy true:687
noisy false:406
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [147/200] batch [5/15] time 0.168 (0.177) data 0.092 (0.100) loss_x loss_x 0.6021 (0.6303) acc_x 84.3750 (85.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/15] time 0.170 (0.174) data 0.094 (0.098) loss_x loss_x 0.6338 (0.5782) acc_x 84.3750 (85.6250) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [15/15] time 0.184 (0.180) data 0.107 (0.104) loss_x loss_x 0.4143 (0.5522) acc_x 93.7500 (86.2500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:479
clean false:13
clean_rate:0.9735772357723578
noisy true:670
noisy false:438
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [148/200] batch [5/15] time 0.180 (0.169) data 0.104 (0.093) loss_x loss_x 0.3577 (0.4632) acc_x 90.6250 (90.0000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/15] time 0.189 (0.175) data 0.113 (0.099) loss_x loss_x 0.9160 (0.6067) acc_x 75.0000 (85.3125) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [15/15] time 0.185 (0.185) data 0.108 (0.101) loss_x loss_x 0.6694 (0.6125) acc_x 87.5000 (85.4167) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:479
clean false:17
clean_rate:0.9657258064516129
noisy true:670
noisy false:434
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [149/200] batch [5/15] time 0.193 (0.183) data 0.103 (0.104) loss_x loss_x 0.8335 (0.5390) acc_x 78.1250 (84.3750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/15] time 0.180 (0.191) data 0.104 (0.108) loss_x loss_x 0.8799 (0.6383) acc_x 81.2500 (83.7500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [15/15] time 0.180 (0.188) data 0.104 (0.107) loss_x loss_x 0.6206 (0.6218) acc_x 81.2500 (83.3333) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:504
clean false:19
clean_rate:0.9636711281070746
noisy true:683
noisy false:394
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [150/200] batch [5/16] time 0.189 (0.187) data 0.113 (0.111) loss_x loss_x 0.8403 (0.5502) acc_x 81.2500 (86.2500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/16] time 0.180 (0.184) data 0.103 (0.108) loss_x loss_x 0.5332 (0.6081) acc_x 84.3750 (84.3750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/16] time 0.179 (0.198) data 0.103 (0.107) loss_x loss_x 0.5073 (0.5967) acc_x 78.1250 (84.3750) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 434
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 508
clean true:493
clean false:15
clean_rate:0.9704724409448819
noisy true:673
noisy false:419
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1092
epoch [151/200] batch [5/15] time 0.176 (0.184) data 0.100 (0.108) loss_x loss_x 0.3276 (0.5144) acc_x 90.6250 (85.6250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/15] time 0.186 (0.184) data 0.108 (0.108) loss_x loss_x 0.4680 (0.6195) acc_x 87.5000 (85.9375) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [15/15] time 0.184 (0.190) data 0.108 (0.108) loss_x loss_x 0.4927 (0.5696) acc_x 84.3750 (85.6250) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:492
clean false:17
clean_rate:0.9666011787819253
noisy true:681
noisy false:410
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [152/200] batch [5/15] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.5762 (0.6164) acc_x 87.5000 (85.0000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/15] time 0.183 (0.201) data 0.107 (0.107) loss_x loss_x 0.5073 (0.5456) acc_x 81.2500 (85.6250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/15] time 0.181 (0.195) data 0.104 (0.107) loss_x loss_x 0.4187 (0.5247) acc_x 90.6250 (86.2500) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 517
clean true:495
clean false:22
clean_rate:0.9574468085106383
noisy true:684
noisy false:399
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1083
epoch [153/200] batch [5/16] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.9893 (0.6970) acc_x 78.1250 (81.2500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/16] time 0.183 (0.198) data 0.107 (0.106) loss_x loss_x 0.9678 (0.6719) acc_x 68.7500 (82.1875) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/16] time 0.192 (0.193) data 0.115 (0.106) loss_x loss_x 0.7817 (0.6288) acc_x 75.0000 (82.9167) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 517
clean true:493
clean false:24
clean_rate:0.9535783365570599
noisy true:682
noisy false:401
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1083
epoch [154/200] batch [5/16] time 0.180 (0.173) data 0.102 (0.095) loss_x loss_x 0.3923 (0.5922) acc_x 93.7500 (84.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/16] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.2839 (0.5746) acc_x 87.5000 (84.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/16] time 0.192 (0.185) data 0.115 (0.101) loss_x loss_x 0.4854 (0.5388) acc_x 90.6250 (86.2500) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 501
clean true:482
clean false:19
clean_rate:0.9620758483033932
noisy true:695
noisy false:404
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1099
epoch [155/200] batch [5/15] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.4102 (0.5134) acc_x 90.6250 (88.1250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/15] time 0.269 (0.186) data 0.082 (0.098) loss_x loss_x 0.2883 (0.4731) acc_x 93.7500 (88.7500) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [15/15] time 0.180 (0.179) data 0.104 (0.095) loss_x loss_x 0.4099 (0.4505) acc_x 93.7500 (89.5833) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 526
clean true:508
clean false:18
clean_rate:0.9657794676806084
noisy true:671
noisy false:403
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1074
epoch [156/200] batch [5/16] time 0.198 (0.184) data 0.121 (0.107) loss_x loss_x 0.3105 (0.5394) acc_x 96.8750 (87.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/16] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.4824 (0.5016) acc_x 87.5000 (87.8125) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/16] time 0.190 (0.186) data 0.114 (0.109) loss_x loss_x 0.3564 (0.5084) acc_x 90.6250 (88.1250) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 515
clean true:499
clean false:16
clean_rate:0.9689320388349515
noisy true:693
noisy false:392
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1085
epoch [157/200] batch [5/16] time 0.230 (0.201) data 0.154 (0.125) loss_x loss_x 0.6484 (0.5825) acc_x 84.3750 (86.2500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/16] time 0.186 (0.200) data 0.110 (0.124) loss_x loss_x 0.2676 (0.5316) acc_x 93.7500 (87.8125) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/16] time 0.179 (0.200) data 0.103 (0.124) loss_x loss_x 1.3906 (0.5598) acc_x 75.0000 (87.0833) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:483
clean false:21
clean_rate:0.9583333333333334
noisy true:666
noisy false:430
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [158/200] batch [5/15] time 0.184 (0.218) data 0.108 (0.120) loss_x loss_x 0.9438 (0.4913) acc_x 81.2500 (88.1250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/15] time 0.191 (0.203) data 0.115 (0.116) loss_x loss_x 0.5645 (0.4622) acc_x 84.3750 (88.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/15] time 0.169 (0.197) data 0.091 (0.113) loss_x loss_x 0.3040 (0.4751) acc_x 96.8750 (88.9583) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:499
clean false:24
clean_rate:0.9541108986615678
noisy true:686
noisy false:391
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [159/200] batch [5/16] time 0.229 (0.183) data 0.097 (0.095) loss_x loss_x 0.5859 (0.5254) acc_x 84.3750 (86.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/16] time 0.185 (0.181) data 0.109 (0.099) loss_x loss_x 0.3276 (0.5041) acc_x 87.5000 (85.9375) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/16] time 0.174 (0.182) data 0.098 (0.102) loss_x loss_x 0.7681 (0.5106) acc_x 78.1250 (86.8750) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:491
clean false:20
clean_rate:0.9608610567514677
noisy true:680
noisy false:409
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [160/200] batch [5/15] time 0.179 (0.192) data 0.104 (0.103) loss_x loss_x 0.9702 (0.7745) acc_x 71.8750 (82.5000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/15] time 0.164 (0.183) data 0.087 (0.100) loss_x loss_x 0.3562 (0.6459) acc_x 90.6250 (84.6875) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [15/15] time 0.209 (0.187) data 0.132 (0.107) loss_x loss_x 0.4990 (0.6463) acc_x 90.6250 (84.7917) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 526
clean true:508
clean false:18
clean_rate:0.9657794676806084
noisy true:674
noisy false:400
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1074
epoch [161/200] batch [5/16] time 0.183 (0.169) data 0.106 (0.093) loss_x loss_x 0.5015 (0.6318) acc_x 87.5000 (83.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/16] time 0.183 (0.188) data 0.107 (0.100) loss_x loss_x 0.5161 (0.5713) acc_x 81.2500 (85.6250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/16] time 0.163 (0.181) data 0.087 (0.098) loss_x loss_x 0.8472 (0.5595) acc_x 84.3750 (85.8333) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:494
clean false:17
clean_rate:0.9667318982387475
noisy true:669
noisy false:420
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [162/200] batch [5/15] time 0.197 (0.186) data 0.121 (0.110) loss_x loss_x 0.7993 (0.4881) acc_x 81.2500 (88.1250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/15] time 0.177 (0.187) data 0.100 (0.111) loss_x loss_x 0.5371 (0.4519) acc_x 84.3750 (89.0625) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [15/15] time 0.160 (0.180) data 0.084 (0.103) loss_x loss_x 0.3521 (0.4465) acc_x 90.6250 (89.3750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:487
clean false:17
clean_rate:0.9662698412698413
noisy true:702
noisy false:394
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [163/200] batch [5/15] time 0.185 (0.174) data 0.109 (0.097) loss_x loss_x 0.6826 (0.4874) acc_x 78.1250 (85.6250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/15] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.3625 (0.4658) acc_x 87.5000 (87.1875) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [15/15] time 0.164 (0.177) data 0.088 (0.100) loss_x loss_x 0.5610 (0.4987) acc_x 81.2500 (86.0417) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:480
clean false:20
clean_rate:0.96
noisy true:684
noisy false:416
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [164/200] batch [5/15] time 0.174 (0.209) data 0.098 (0.099) loss_x loss_x 0.4685 (0.5474) acc_x 87.5000 (85.0000) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/15] time 0.165 (0.188) data 0.089 (0.094) loss_x loss_x 0.3806 (0.5288) acc_x 90.6250 (87.8125) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [15/15] time 0.165 (0.182) data 0.089 (0.094) loss_x loss_x 0.6260 (0.5476) acc_x 87.5000 (87.2917) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 515
clean true:499
clean false:16
clean_rate:0.9689320388349515
noisy true:669
noisy false:416
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1085
epoch [165/200] batch [5/16] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.5420 (0.5088) acc_x 87.5000 (84.3750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/16] time 0.179 (0.174) data 0.102 (0.098) loss_x loss_x 0.5039 (0.5445) acc_x 87.5000 (84.3750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/16] time 0.192 (0.180) data 0.116 (0.103) loss_x loss_x 0.6465 (0.5012) acc_x 81.2500 (86.2500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:494
clean false:17
clean_rate:0.9667318982387475
noisy true:678
noisy false:411
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [166/200] batch [5/15] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.4504 (0.6763) acc_x 93.7500 (85.6250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/15] time 0.158 (0.160) data 0.081 (0.084) loss_x loss_x 0.5005 (0.5990) acc_x 93.7500 (85.6250) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [15/15] time 0.158 (0.160) data 0.082 (0.083) loss_x loss_x 0.3660 (0.5372) acc_x 93.7500 (87.0833) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:483
clean false:16
clean_rate:0.9679358717434869
noisy true:677
noisy false:424
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [167/200] batch [5/15] time 0.173 (0.169) data 0.097 (0.093) loss_x loss_x 0.2871 (0.6009) acc_x 93.7500 (83.1250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/15] time 0.185 (0.190) data 0.108 (0.105) loss_x loss_x 0.6987 (0.6368) acc_x 81.2500 (83.1250) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [15/15] time 0.190 (0.189) data 0.114 (0.106) loss_x loss_x 0.6279 (0.6192) acc_x 87.5000 (83.5417) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3306, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 529
clean true:504
clean false:25
clean_rate:0.9527410207939508
noisy true:681
noisy false:390
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1071
epoch [168/200] batch [5/16] time 0.212 (0.185) data 0.135 (0.109) loss_x loss_x 0.7573 (0.7285) acc_x 87.5000 (81.8750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/16] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.5854 (0.6866) acc_x 90.6250 (82.8125) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/16] time 0.178 (0.187) data 0.101 (0.111) loss_x loss_x 0.4214 (0.6025) acc_x 90.6250 (84.5833) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:485
clean false:19
clean_rate:0.9623015873015873
noisy true:666
noisy false:430
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [169/200] batch [5/15] time 0.185 (0.176) data 0.109 (0.099) loss_x loss_x 0.2327 (0.4241) acc_x 84.3750 (87.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/15] time 0.173 (0.177) data 0.097 (0.100) loss_x loss_x 0.6372 (0.4998) acc_x 78.1250 (85.6250) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [15/15] time 0.183 (0.177) data 0.106 (0.101) loss_x loss_x 0.8608 (0.5362) acc_x 68.7500 (84.7917) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:492
clean false:19
clean_rate:0.9628180039138943
noisy true:688
noisy false:401
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [170/200] batch [5/15] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.4583 (0.5354) acc_x 87.5000 (86.2500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/15] time 0.181 (0.197) data 0.105 (0.106) loss_x loss_x 0.5771 (0.5448) acc_x 87.5000 (86.2500) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [15/15] time 0.187 (0.192) data 0.108 (0.106) loss_x loss_x 0.9141 (0.5350) acc_x 75.0000 (86.4583) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 489
clean true:473
clean false:16
clean_rate:0.967280163599182
noisy true:677
noisy false:434
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1111
epoch [171/200] batch [5/15] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.2622 (0.4559) acc_x 87.5000 (87.5000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/15] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.3853 (0.4251) acc_x 90.6250 (87.8125) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [15/15] time 0.158 (0.181) data 0.082 (0.099) loss_x loss_x 0.3223 (0.4636) acc_x 93.7500 (87.7083) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 502
clean true:485
clean false:17
clean_rate:0.9661354581673307
noisy true:680
noisy false:418
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1098
epoch [172/200] batch [5/15] time 0.174 (0.186) data 0.098 (0.110) loss_x loss_x 0.3223 (0.4906) acc_x 93.7500 (87.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/15] time 0.184 (0.181) data 0.108 (0.105) loss_x loss_x 0.5195 (0.4845) acc_x 87.5000 (88.1250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [15/15] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.7949 (0.5180) acc_x 75.0000 (86.4583) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:489
clean false:16
clean_rate:0.9683168316831683
noisy true:681
noisy false:414
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [173/200] batch [5/15] time 0.185 (0.177) data 0.109 (0.101) loss_x loss_x 0.4861 (0.5424) acc_x 87.5000 (87.5000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/15] time 0.181 (0.180) data 0.105 (0.104) loss_x loss_x 0.5391 (0.5314) acc_x 84.3750 (86.5625) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [15/15] time 0.290 (0.189) data 0.105 (0.106) loss_x loss_x 0.5332 (0.5461) acc_x 87.5000 (86.2500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:492
clean false:22
clean_rate:0.9571984435797666
noisy true:680
noisy false:406
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [174/200] batch [5/16] time 0.208 (0.187) data 0.133 (0.111) loss_x loss_x 0.6777 (0.5148) acc_x 87.5000 (88.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/16] time 0.241 (0.190) data 0.120 (0.109) loss_x loss_x 0.4944 (0.5487) acc_x 87.5000 (85.6250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/16] time 0.175 (0.195) data 0.099 (0.109) loss_x loss_x 0.0924 (0.5426) acc_x 100.0000 (85.2083) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 441
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:471
clean false:21
clean_rate:0.9573170731707317
noisy true:688
noisy false:420
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [175/200] batch [5/15] time 0.160 (0.160) data 0.084 (0.083) loss_x loss_x 0.3091 (0.4070) acc_x 90.6250 (87.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/15] time 0.165 (0.160) data 0.089 (0.084) loss_x loss_x 0.4558 (0.5392) acc_x 96.8750 (86.5625) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [15/15] time 0.215 (0.174) data 0.138 (0.090) loss_x loss_x 0.6523 (0.5411) acc_x 81.2500 (85.4167) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.3250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 520
clean true:497
clean false:23
clean_rate:0.9557692307692308
noisy true:659
noisy false:421
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1080
epoch [176/200] batch [5/16] time 0.287 (0.217) data 0.122 (0.122) loss_x loss_x 0.6431 (0.7372) acc_x 84.3750 (86.2500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/16] time 0.217 (0.210) data 0.141 (0.119) loss_x loss_x 1.0518 (0.7086) acc_x 75.0000 (84.6875) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/16] time 0.226 (0.212) data 0.150 (0.126) loss_x loss_x 0.1970 (0.6857) acc_x 93.7500 (84.7917) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:503
clean false:20
clean_rate:0.9617590822179732
noisy true:664
noisy false:413
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [177/200] batch [5/16] time 0.194 (0.183) data 0.117 (0.107) loss_x loss_x 0.5649 (0.6383) acc_x 84.3750 (85.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/16] time 0.199 (0.197) data 0.122 (0.110) loss_x loss_x 0.5195 (0.5896) acc_x 84.3750 (84.6875) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/16] time 0.215 (0.198) data 0.139 (0.115) loss_x loss_x 0.5630 (0.5452) acc_x 87.5000 (85.6250) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:478
clean false:18
clean_rate:0.9637096774193549
noisy true:695
noisy false:409
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [178/200] batch [5/15] time 0.194 (0.182) data 0.118 (0.106) loss_x loss_x 0.4192 (0.4986) acc_x 93.7500 (85.6250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/15] time 0.175 (0.182) data 0.099 (0.105) loss_x loss_x 0.6846 (0.4809) acc_x 78.1250 (86.8750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [15/15] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.3770 (0.4751) acc_x 87.5000 (86.4583) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:494
clean false:15
clean_rate:0.9705304518664047
noisy true:674
noisy false:417
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [179/200] batch [5/15] time 0.160 (0.184) data 0.084 (0.085) loss_x loss_x 0.6646 (0.6705) acc_x 81.2500 (84.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/15] time 0.231 (0.191) data 0.155 (0.103) loss_x loss_x 0.7383 (0.6320) acc_x 81.2500 (84.3750) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [15/15] time 0.157 (0.186) data 0.081 (0.102) loss_x loss_x 0.5840 (0.6229) acc_x 84.3750 (83.1250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:504
clean false:19
clean_rate:0.9636711281070746
noisy true:668
noisy false:409
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [180/200] batch [5/16] time 0.166 (0.199) data 0.090 (0.123) loss_x loss_x 0.5093 (0.5941) acc_x 90.6250 (85.6250) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/16] time 0.188 (0.192) data 0.112 (0.116) loss_x loss_x 0.5635 (0.5585) acc_x 87.5000 (86.5625) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/16] time 0.156 (0.182) data 0.080 (0.106) loss_x loss_x 0.9302 (0.5875) acc_x 81.2500 (85.6250) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 518
clean true:495
clean false:23
clean_rate:0.9555984555984556
noisy true:670
noisy false:412
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1082
epoch [181/200] batch [5/16] time 0.185 (0.224) data 0.109 (0.114) loss_x loss_x 0.4473 (0.5435) acc_x 84.3750 (86.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/16] time 0.188 (0.205) data 0.112 (0.112) loss_x loss_x 0.8101 (0.5857) acc_x 78.1250 (86.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/16] time 0.184 (0.198) data 0.108 (0.111) loss_x loss_x 0.3215 (0.5648) acc_x 90.6250 (85.6250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:487
clean false:18
clean_rate:0.9643564356435643
noisy true:690
noisy false:405
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [182/200] batch [5/15] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 0.5659 (0.5040) acc_x 87.5000 (90.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/15] time 0.220 (0.199) data 0.144 (0.123) loss_x loss_x 0.2693 (0.5326) acc_x 90.6250 (87.8125) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [15/15] time 0.197 (0.215) data 0.121 (0.131) loss_x loss_x 0.4351 (0.5148) acc_x 93.7500 (87.7083) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:483
clean false:20
clean_rate:0.9602385685884692
noisy true:643
noisy false:454
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [183/200] batch [5/15] time 0.159 (0.168) data 0.082 (0.092) loss_x loss_x 0.5620 (0.5628) acc_x 87.5000 (85.0000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/15] time 0.160 (0.173) data 0.083 (0.097) loss_x loss_x 0.2288 (0.4624) acc_x 93.7500 (88.1250) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [15/15] time 0.187 (0.173) data 0.111 (0.096) loss_x loss_x 1.0439 (0.5247) acc_x 65.6250 (86.4583) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.3275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 524
clean true:505
clean false:19
clean_rate:0.9637404580152672
noisy true:658
noisy false:418
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1076
epoch [184/200] batch [5/16] time 0.185 (0.220) data 0.108 (0.105) loss_x loss_x 0.5000 (0.5864) acc_x 90.6250 (81.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/16] time 0.184 (0.195) data 0.108 (0.100) loss_x loss_x 0.4194 (0.5902) acc_x 93.7500 (84.0625) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/16] time 0.161 (0.188) data 0.085 (0.099) loss_x loss_x 1.0068 (0.5759) acc_x 75.0000 (84.3750) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 521
clean true:507
clean false:14
clean_rate:0.9731285988483686
noisy true:690
noisy false:389
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 1079
epoch [185/200] batch [5/16] time 0.177 (0.181) data 0.100 (0.105) loss_x loss_x 0.7163 (0.5307) acc_x 78.1250 (85.0000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/16] time 0.193 (0.181) data 0.117 (0.105) loss_x loss_x 0.6313 (0.5404) acc_x 87.5000 (86.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/16] time 0.161 (0.184) data 0.085 (0.104) loss_x loss_x 0.3923 (0.5281) acc_x 90.6250 (87.7083) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 502
clean true:485
clean false:17
clean_rate:0.9661354581673307
noisy true:685
noisy false:413
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1098
epoch [186/200] batch [5/15] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.4402 (0.3952) acc_x 87.5000 (90.0000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/15] time 0.173 (0.179) data 0.097 (0.103) loss_x loss_x 0.3435 (0.4095) acc_x 90.6250 (89.6875) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [15/15] time 0.183 (0.191) data 0.107 (0.108) loss_x loss_x 0.8037 (0.5015) acc_x 87.5000 (87.2917) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 517
clean true:494
clean false:23
clean_rate:0.9555125725338491
noisy true:670
noisy false:413
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1083
epoch [187/200] batch [5/16] time 0.179 (0.175) data 0.102 (0.099) loss_x loss_x 0.2842 (0.5265) acc_x 90.6250 (86.2500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/16] time 0.162 (0.175) data 0.086 (0.099) loss_x loss_x 0.4646 (0.5687) acc_x 84.3750 (83.7500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/16] time 0.163 (0.185) data 0.087 (0.101) loss_x loss_x 0.3047 (0.5739) acc_x 87.5000 (83.7500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 526
clean true:503
clean false:23
clean_rate:0.9562737642585551
noisy true:675
noisy false:399
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1074
epoch [188/200] batch [5/16] time 0.179 (0.172) data 0.103 (0.096) loss_x loss_x 0.3396 (0.5229) acc_x 93.7500 (90.6250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/16] time 0.192 (0.182) data 0.116 (0.106) loss_x loss_x 0.2529 (0.5303) acc_x 96.8750 (90.9375) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/16] time 0.189 (0.192) data 0.112 (0.108) loss_x loss_x 0.3462 (0.5029) acc_x 93.7500 (90.4167) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 512
clean true:495
clean false:17
clean_rate:0.966796875
noisy true:669
noisy false:419
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1088
epoch [189/200] batch [5/16] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.3623 (0.5627) acc_x 90.6250 (86.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/16] time 0.163 (0.173) data 0.087 (0.097) loss_x loss_x 0.5723 (0.6196) acc_x 87.5000 (85.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/16] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.6934 (0.5716) acc_x 81.2500 (85.8333) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 522
clean true:503
clean false:19
clean_rate:0.9636015325670498
noisy true:671
noisy false:407
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1078
epoch [190/200] batch [5/16] time 0.161 (0.161) data 0.085 (0.084) loss_x loss_x 0.3086 (0.3442) acc_x 90.6250 (88.1250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/16] time 0.161 (0.172) data 0.084 (0.084) loss_x loss_x 0.7246 (0.5988) acc_x 78.1250 (82.5000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/16] time 0.161 (0.172) data 0.085 (0.088) loss_x loss_x 0.3044 (0.6361) acc_x 96.8750 (84.1667) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 506
clean true:489
clean false:17
clean_rate:0.9664031620553359
noisy true:661
noisy false:433
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1094
epoch [191/200] batch [5/15] time 0.190 (0.185) data 0.113 (0.109) loss_x loss_x 0.2720 (0.5572) acc_x 96.8750 (84.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/15] time 0.223 (0.195) data 0.132 (0.107) loss_x loss_x 0.5098 (0.5632) acc_x 87.5000 (85.3125) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [15/15] time 0.157 (0.187) data 0.081 (0.102) loss_x loss_x 0.6646 (0.5739) acc_x 78.1250 (84.3750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 517
clean true:495
clean false:22
clean_rate:0.9574468085106383
noisy true:677
noisy false:406
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1083
epoch [192/200] batch [5/16] time 0.227 (0.184) data 0.090 (0.095) loss_x loss_x 0.5293 (0.6277) acc_x 84.3750 (83.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/16] time 0.191 (0.195) data 0.115 (0.101) loss_x loss_x 0.3682 (0.5489) acc_x 87.5000 (84.3750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/16] time 0.198 (0.192) data 0.122 (0.104) loss_x loss_x 0.5562 (0.5437) acc_x 81.2500 (84.7917) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 512
clean true:496
clean false:16
clean_rate:0.96875
noisy true:682
noisy false:406
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1088
epoch [193/200] batch [5/16] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.3552 (0.5499) acc_x 87.5000 (86.2500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/16] time 0.175 (0.178) data 0.098 (0.102) loss_x loss_x 0.7344 (0.6317) acc_x 81.2500 (84.6875) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/16] time 0.192 (0.181) data 0.116 (0.105) loss_x loss_x 0.7285 (0.6205) acc_x 78.1250 (85.0000) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:506
clean false:17
clean_rate:0.9674952198852772
noisy true:682
noisy false:395
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [194/200] batch [5/16] time 0.191 (0.188) data 0.115 (0.112) loss_x loss_x 0.4570 (0.5380) acc_x 81.2500 (81.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/16] time 0.184 (0.191) data 0.108 (0.115) loss_x loss_x 0.2125 (0.5045) acc_x 93.7500 (85.3125) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/16] time 0.191 (0.191) data 0.115 (0.114) loss_x loss_x 0.4832 (0.5399) acc_x 90.6250 (85.4167) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:482
clean false:21
clean_rate:0.9582504970178927
noisy true:661
noisy false:436
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [195/200] batch [5/15] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.6147 (0.6187) acc_x 87.5000 (83.7500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/15] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.4324 (0.5992) acc_x 84.3750 (85.3125) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [15/15] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.4216 (0.5513) acc_x 84.3750 (86.0417) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 399
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 518
clean true:503
clean false:15
clean_rate:0.971042471042471
noisy true:698
noisy false:384
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1082
epoch [196/200] batch [5/16] time 0.198 (0.174) data 0.122 (0.098) loss_x loss_x 0.7256 (0.5162) acc_x 81.2500 (84.3750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/16] time 0.159 (0.184) data 0.083 (0.107) loss_x loss_x 0.1141 (0.4786) acc_x 96.8750 (85.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/16] time 0.156 (0.175) data 0.079 (0.099) loss_x loss_x 0.8750 (0.4618) acc_x 81.2500 (87.2917) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:490
clean false:17
clean_rate:0.9664694280078896
noisy true:689
noisy false:404
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [197/200] batch [5/15] time 0.183 (0.224) data 0.107 (0.126) loss_x loss_x 0.3098 (0.4913) acc_x 96.8750 (87.5000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/15] time 0.199 (0.206) data 0.123 (0.119) loss_x loss_x 0.2998 (0.4622) acc_x 87.5000 (88.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/15] time 0.178 (0.196) data 0.102 (0.112) loss_x loss_x 0.5664 (0.5402) acc_x 75.0000 (86.4583) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 510
clean true:493
clean false:17
clean_rate:0.9666666666666667
noisy true:681
noisy false:409
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1090
epoch [198/200] batch [5/15] time 0.176 (0.171) data 0.092 (0.093) loss_x loss_x 0.4966 (0.5594) acc_x 87.5000 (85.6250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/15] time 0.184 (0.187) data 0.108 (0.099) loss_x loss_x 0.2285 (0.6398) acc_x 93.7500 (86.5625) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [15/15] time 0.160 (0.184) data 0.084 (0.100) loss_x loss_x 0.4556 (0.5968) acc_x 90.6250 (86.6667) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:498
clean false:18
clean_rate:0.9651162790697675
noisy true:686
noisy false:398
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [199/200] batch [5/16] time 0.167 (0.181) data 0.090 (0.105) loss_x loss_x 0.3257 (0.5385) acc_x 93.7500 (85.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/16] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.4409 (0.5321) acc_x 87.5000 (85.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/16] time 0.161 (0.176) data 0.084 (0.100) loss_x loss_x 0.3938 (0.4996) acc_x 84.3750 (85.4167) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 512
clean true:496
clean false:16
clean_rate:0.96875
noisy true:689
noisy false:399
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1088
epoch [200/200] batch [5/16] time 0.162 (0.175) data 0.085 (0.099) loss_x loss_x 0.4556 (0.7154) acc_x 90.6250 (82.5000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/16] time 0.159 (0.167) data 0.083 (0.091) loss_x loss_x 0.5542 (0.6457) acc_x 81.2500 (82.5000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/16] time 0.222 (0.169) data 0.081 (0.088) loss_x loss_x 0.6494 (0.6392) acc_x 87.5000 (82.9167) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,171
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 82.4%
Elapsed: 0:38:43
