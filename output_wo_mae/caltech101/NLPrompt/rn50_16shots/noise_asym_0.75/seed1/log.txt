***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.1181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 189
clean true:179
clean false:10
clean_rate:0.9470899470899471
noisy true:576
noisy false:835
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 1411
epoch [1/200] batch [5/5] time 0.224 (0.247) data 0.100 (0.105) loss_x loss_x 2.2715 (2.7188) acc_x 71.8750 (58.7500) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 830
confident_label rate tensor(0.1275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 204
clean true:191
clean false:13
clean_rate:0.9362745098039216
noisy true:579
noisy false:817
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 1396
epoch [2/200] batch [5/6] time 0.204 (0.219) data 0.082 (0.102) loss_x loss_x 0.9565 (1.3154) acc_x 75.0000 (68.1250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 590
confident_label rate tensor(0.1631, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 261
clean true:254
clean false:7
clean_rate:0.9731800766283525
noisy true:756
noisy false:583
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 1339
epoch [3/200] batch [5/8] time 0.216 (0.221) data 0.092 (0.096) loss_x loss_x 1.2324 (1.1374) acc_x 71.8750 (74.3750) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 550
confident_label rate tensor(0.1731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 277
clean true:268
clean false:9
clean_rate:0.9675090252707581
noisy true:782
noisy false:541
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 1323
epoch [4/200] batch [5/8] time 0.218 (0.224) data 0.091 (0.100) loss_x loss_x 1.0283 (0.8960) acc_x 62.5000 (75.6250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 546
confident_label rate tensor(0.1762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 282
clean true:272
clean false:10
clean_rate:0.9645390070921985
noisy true:782
noisy false:536
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1318
epoch [5/200] batch [5/8] time 0.245 (0.219) data 0.122 (0.110) loss_x loss_x 1.1211 (1.0427) acc_x 68.7500 (74.3750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.1781, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 285
clean true:275
clean false:10
clean_rate:0.9649122807017544
noisy true:823
noisy false:492
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1315
epoch [6/200] batch [5/8] time 0.216 (0.193) data 0.095 (0.085) loss_x loss_x 0.6167 (1.0762) acc_x 84.3750 (73.1250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 509
confident_label rate tensor(0.1769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 283
clean true:275
clean false:8
clean_rate:0.9717314487632509
noisy true:816
noisy false:501
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1317
epoch [7/200] batch [5/8] time 0.213 (0.218) data 0.091 (0.093) loss_x loss_x 0.6865 (0.8016) acc_x 78.1250 (75.0000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 534
confident_label rate tensor(0.1762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 282
clean true:270
clean false:12
clean_rate:0.9574468085106383
noisy true:796
noisy false:522
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1318
epoch [8/200] batch [5/8] time 0.219 (0.232) data 0.096 (0.117) loss_x loss_x 0.9087 (0.8388) acc_x 71.8750 (75.6250) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 512
confident_label rate tensor(0.1806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 289
clean true:280
clean false:9
clean_rate:0.9688581314878892
noisy true:808
noisy false:503
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 1311
epoch [9/200] batch [5/9] time 0.221 (0.231) data 0.097 (0.101) loss_x loss_x 0.8218 (0.8916) acc_x 78.1250 (75.0000) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 486
confident_label rate tensor(0.1762, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 282
clean true:275
clean false:7
clean_rate:0.975177304964539
noisy true:839
noisy false:479
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1318
epoch [10/200] batch [5/8] time 0.208 (0.220) data 0.086 (0.100) loss_x loss_x 0.7944 (0.6804) acc_x 78.1250 (82.5000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 508
confident_label rate tensor(0.1812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 290
clean true:279
clean false:11
clean_rate:0.9620689655172414
noisy true:813
noisy false:497
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1310
epoch [11/200] batch [5/9] time 0.204 (0.222) data 0.081 (0.098) loss_x loss_x 0.6089 (0.8460) acc_x 71.8750 (75.6250) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 504
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 299
clean true:288
clean false:11
clean_rate:0.9632107023411371
noisy true:808
noisy false:493
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 1301
epoch [12/200] batch [5/9] time 0.235 (0.227) data 0.110 (0.100) loss_x loss_x 0.6108 (0.8039) acc_x 84.3750 (79.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.1912, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 306
clean true:297
clean false:9
clean_rate:0.9705882352941176
noisy true:848
noisy false:446
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 1294
epoch [13/200] batch [5/9] time 0.228 (0.226) data 0.104 (0.103) loss_x loss_x 1.1270 (0.9230) acc_x 65.6250 (74.3750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.1819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 291
clean true:279
clean false:12
clean_rate:0.9587628865979382
noisy true:834
noisy false:475
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 1309
epoch [14/200] batch [5/9] time 0.214 (0.231) data 0.089 (0.099) loss_x loss_x 1.0488 (0.8268) acc_x 71.8750 (77.5000) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.1844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 295
clean true:284
clean false:11
clean_rate:0.9627118644067797
noisy true:827
noisy false:478
after delete: len(clean_dataset) 295
after delete: len(noisy_dataset) 1305
epoch [15/200] batch [5/9] time 0.211 (0.216) data 0.085 (0.092) loss_x loss_x 1.0635 (1.0559) acc_x 71.8750 (74.3750) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.1950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 312
clean true:297
clean false:15
clean_rate:0.9519230769230769
noisy true:835
noisy false:453
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1288
epoch [16/200] batch [5/9] time 0.225 (0.222) data 0.099 (0.099) loss_x loss_x 0.6162 (0.8476) acc_x 84.3750 (81.2500) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 317
clean true:305
clean false:12
clean_rate:0.9621451104100947
noisy true:827
noisy false:456
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1283
epoch [17/200] batch [5/9] time 0.234 (0.216) data 0.109 (0.110) loss_x loss_x 0.7305 (0.6756) acc_x 81.2500 (81.8750) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.1856, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 297
clean true:284
clean false:13
clean_rate:0.9562289562289562
noisy true:819
noisy false:484
after delete: len(clean_dataset) 297
after delete: len(noisy_dataset) 1303
epoch [18/200] batch [5/9] time 0.227 (0.219) data 0.105 (0.103) loss_x loss_x 0.5669 (0.6985) acc_x 87.5000 (83.1250) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 507
confident_label rate tensor(0.1825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 292
clean true:281
clean false:11
clean_rate:0.9623287671232876
noisy true:812
noisy false:496
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 1308
epoch [19/200] batch [5/9] time 0.220 (0.225) data 0.095 (0.100) loss_x loss_x 0.5698 (0.7547) acc_x 84.3750 (83.7500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.1956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 313
clean true:295
clean false:18
clean_rate:0.9424920127795527
noisy true:822
noisy false:465
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1287
epoch [20/200] batch [5/9] time 0.214 (0.238) data 0.090 (0.115) loss_x loss_x 1.1826 (0.7666) acc_x 68.7500 (77.5000) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.1863, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 298
clean true:285
clean false:13
clean_rate:0.9563758389261745
noisy true:825
noisy false:477
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 1302
epoch [21/200] batch [5/9] time 0.220 (0.221) data 0.097 (0.095) loss_x loss_x 0.5815 (0.7188) acc_x 90.6250 (80.0000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.1950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 312
clean true:297
clean false:15
clean_rate:0.9519230769230769
noisy true:834
noisy false:454
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1288
epoch [22/200] batch [5/9] time 0.238 (0.226) data 0.116 (0.103) loss_x loss_x 0.4854 (0.6836) acc_x 84.3750 (80.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 325
clean true:309
clean false:16
clean_rate:0.9507692307692308
noisy true:800
noisy false:475
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 1275
epoch [23/200] batch [5/10] time 0.251 (0.224) data 0.127 (0.119) loss_x loss_x 0.7861 (0.7559) acc_x 81.2500 (83.7500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/10] time 0.216 (0.227) data 0.092 (0.112) loss_x loss_x 0.8901 (0.7935) acc_x 75.0000 (81.2500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.1956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 313
clean true:298
clean false:15
clean_rate:0.952076677316294
noisy true:819
noisy false:468
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1287
epoch [24/200] batch [5/9] time 0.209 (0.209) data 0.086 (0.103) loss_x loss_x 0.2825 (0.6267) acc_x 87.5000 (80.6250) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.1825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 292
clean true:279
clean false:13
clean_rate:0.9554794520547946
noisy true:824
noisy false:484
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 1308
epoch [25/200] batch [5/9] time 0.204 (0.210) data 0.082 (0.088) loss_x loss_x 0.8672 (0.6701) acc_x 75.0000 (83.1250) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.2000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 320
clean true:305
clean false:15
clean_rate:0.953125
noisy true:846
noisy false:434
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1280
epoch [26/200] batch [5/10] time 0.236 (0.221) data 0.112 (0.097) loss_x loss_x 0.4714 (0.6638) acc_x 84.3750 (78.7500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/10] time 0.225 (0.226) data 0.099 (0.101) loss_x loss_x 0.6436 (0.7413) acc_x 81.2500 (76.5625) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 323
clean true:306
clean false:17
clean_rate:0.9473684210526315
noisy true:819
noisy false:458
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 1277
epoch [27/200] batch [5/10] time 0.248 (0.233) data 0.125 (0.110) loss_x loss_x 0.8555 (0.7907) acc_x 84.3750 (82.5000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/10] time 0.247 (0.232) data 0.123 (0.109) loss_x loss_x 0.4807 (0.8493) acc_x 87.5000 (79.3750) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.1937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 310
clean true:291
clean false:19
clean_rate:0.9387096774193548
noisy true:828
noisy false:462
after delete: len(clean_dataset) 310
after delete: len(noisy_dataset) 1290
epoch [28/200] batch [5/9] time 0.222 (0.225) data 0.098 (0.102) loss_x loss_x 0.6953 (0.5670) acc_x 87.5000 (86.8750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.2037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 326
clean true:309
clean false:17
clean_rate:0.9478527607361963
noisy true:830
noisy false:444
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1274
epoch [29/200] batch [5/10] time 0.211 (0.211) data 0.087 (0.097) loss_x loss_x 0.5654 (0.6466) acc_x 84.3750 (84.3750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/10] time 0.208 (0.216) data 0.083 (0.097) loss_x loss_x 0.7915 (0.6557) acc_x 78.1250 (83.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.1950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 312
clean true:296
clean false:16
clean_rate:0.9487179487179487
noisy true:811
noisy false:477
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1288
epoch [30/200] batch [5/9] time 0.218 (0.213) data 0.091 (0.098) loss_x loss_x 0.9229 (0.8105) acc_x 78.1250 (80.0000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.1956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 313
clean true:300
clean false:13
clean_rate:0.9584664536741214
noisy true:828
noisy false:459
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1287
epoch [31/200] batch [5/9] time 0.223 (0.221) data 0.098 (0.095) loss_x loss_x 0.3174 (0.6497) acc_x 84.3750 (81.2500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 323
clean true:305
clean false:18
clean_rate:0.9442724458204335
noisy true:818
noisy false:459
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 1277
epoch [32/200] batch [5/10] time 0.233 (0.230) data 0.112 (0.104) loss_x loss_x 0.5986 (0.6881) acc_x 81.2500 (81.8750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/10] time 0.232 (0.230) data 0.109 (0.106) loss_x loss_x 0.2629 (0.6281) acc_x 96.8750 (84.6875) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 333
clean true:315
clean false:18
clean_rate:0.9459459459459459
noisy true:819
noisy false:448
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1267
epoch [33/200] batch [5/10] time 0.209 (0.218) data 0.084 (0.099) loss_x loss_x 0.4922 (0.5688) acc_x 84.3750 (83.1250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/10] time 0.210 (0.218) data 0.088 (0.096) loss_x loss_x 0.7109 (0.7328) acc_x 81.2500 (80.6250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 327
clean true:313
clean false:14
clean_rate:0.9571865443425076
noisy true:848
noisy false:425
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1273
epoch [34/200] batch [5/10] time 0.219 (0.235) data 0.098 (0.110) loss_x loss_x 0.9224 (0.7512) acc_x 81.2500 (81.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/10] time 0.229 (0.225) data 0.106 (0.107) loss_x loss_x 0.3960 (0.6979) acc_x 93.7500 (82.8125) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 321
clean true:307
clean false:14
clean_rate:0.956386292834891
noisy true:809
noisy false:470
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1279
epoch [35/200] batch [5/10] time 0.164 (0.216) data 0.087 (0.101) loss_x loss_x 0.3633 (0.5394) acc_x 90.6250 (88.7500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/10] time 0.234 (0.212) data 0.109 (0.101) loss_x loss_x 0.6177 (0.7001) acc_x 87.5000 (82.8125) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2062, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 330
clean true:313
clean false:17
clean_rate:0.9484848484848485
noisy true:815
noisy false:455
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1270
epoch [36/200] batch [5/10] time 0.198 (0.238) data 0.081 (0.116) loss_x loss_x 0.4592 (0.7297) acc_x 90.6250 (78.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/10] time 0.235 (0.223) data 0.111 (0.107) loss_x loss_x 0.4919 (0.7020) acc_x 90.6250 (81.8750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 331
clean true:316
clean false:15
clean_rate:0.9546827794561934
noisy true:830
noisy false:439
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1269
epoch [37/200] batch [5/10] time 0.231 (0.231) data 0.110 (0.109) loss_x loss_x 0.8643 (0.5821) acc_x 68.7500 (83.1250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/10] time 0.225 (0.229) data 0.105 (0.107) loss_x loss_x 0.7705 (0.7209) acc_x 87.5000 (80.6250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 327
clean true:313
clean false:14
clean_rate:0.9571865443425076
noisy true:805
noisy false:468
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1273
epoch [38/200] batch [5/10] time 0.224 (0.215) data 0.101 (0.096) loss_x loss_x 0.5093 (0.5431) acc_x 84.3750 (87.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/10] time 0.238 (0.223) data 0.116 (0.102) loss_x loss_x 0.5459 (0.6582) acc_x 84.3750 (85.3125) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 328
clean true:310
clean false:18
clean_rate:0.9451219512195121
noisy true:827
noisy false:445
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1272
epoch [39/200] batch [5/10] time 0.216 (0.223) data 0.093 (0.099) loss_x loss_x 0.6650 (0.8992) acc_x 84.3750 (76.2500) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/10] time 0.222 (0.210) data 0.102 (0.094) loss_x loss_x 0.6743 (0.8805) acc_x 84.3750 (78.4375) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 507
confident_label rate tensor(0.1950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 312
clean true:298
clean false:14
clean_rate:0.9551282051282052
noisy true:795
noisy false:493
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1288
epoch [40/200] batch [5/9] time 0.221 (0.195) data 0.101 (0.097) loss_x loss_x 0.6499 (0.5788) acc_x 84.3750 (84.3750) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.1931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 309
clean true:291
clean false:18
clean_rate:0.941747572815534
noisy true:833
noisy false:458
after delete: len(clean_dataset) 309
after delete: len(noisy_dataset) 1291
epoch [41/200] batch [5/9] time 0.237 (0.232) data 0.109 (0.107) loss_x loss_x 0.5264 (0.7312) acc_x 87.5000 (81.8750) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.1925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 308
clean true:294
clean false:14
clean_rate:0.9545454545454546
noisy true:810
noisy false:482
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 1292
epoch [42/200] batch [5/9] time 0.229 (0.253) data 0.106 (0.128) loss_x loss_x 0.3315 (0.4359) acc_x 93.7500 (86.2500) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.1969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 315
clean true:298
clean false:17
clean_rate:0.946031746031746
noisy true:805
noisy false:480
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 1285
epoch [43/200] batch [5/9] time 0.230 (0.231) data 0.107 (0.107) loss_x loss_x 0.2822 (0.6036) acc_x 93.7500 (84.3750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 327
clean true:311
clean false:16
clean_rate:0.9510703363914373
noisy true:815
noisy false:458
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1273
epoch [44/200] batch [5/10] time 0.227 (0.232) data 0.104 (0.110) loss_x loss_x 0.4644 (0.4414) acc_x 87.5000 (85.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/10] time 0.238 (0.234) data 0.109 (0.110) loss_x loss_x 0.8076 (0.5617) acc_x 78.1250 (83.4375) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:313
clean false:22
clean_rate:0.9343283582089552
noisy true:796
noisy false:469
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [45/200] batch [5/10] time 0.229 (0.235) data 0.106 (0.110) loss_x loss_x 0.2729 (0.6054) acc_x 93.7500 (81.8750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/10] time 0.158 (0.220) data 0.081 (0.105) loss_x loss_x 0.7544 (0.7703) acc_x 81.2500 (81.2500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 335
clean true:317
clean false:18
clean_rate:0.9462686567164179
noisy true:818
noisy false:447
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1265
epoch [46/200] batch [5/10] time 0.239 (0.237) data 0.115 (0.110) loss_x loss_x 0.4919 (0.5226) acc_x 87.5000 (88.1250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/10] time 0.227 (0.235) data 0.104 (0.110) loss_x loss_x 1.0674 (0.6860) acc_x 68.7500 (83.1250) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.2075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 332
clean true:319
clean false:13
clean_rate:0.9608433734939759
noisy true:800
noisy false:468
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1268
epoch [47/200] batch [5/10] time 0.222 (0.226) data 0.098 (0.102) loss_x loss_x 0.3682 (0.7764) acc_x 87.5000 (80.6250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/10] time 0.214 (0.223) data 0.103 (0.101) loss_x loss_x 0.9155 (0.7198) acc_x 78.1250 (81.2500) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2044, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 327
clean true:307
clean false:20
clean_rate:0.9388379204892966
noisy true:813
noisy false:460
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1273
epoch [48/200] batch [5/10] time 0.246 (0.229) data 0.122 (0.107) loss_x loss_x 0.7466 (0.8276) acc_x 84.3750 (82.5000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/10] time 0.239 (0.231) data 0.115 (0.109) loss_x loss_x 0.5015 (0.6767) acc_x 84.3750 (84.3750) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2069, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 331
clean true:309
clean false:22
clean_rate:0.9335347432024169
noisy true:821
noisy false:448
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1269
epoch [49/200] batch [5/10] time 0.231 (0.225) data 0.107 (0.100) loss_x loss_x 0.4209 (0.5323) acc_x 90.6250 (87.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/10] time 0.219 (0.224) data 0.094 (0.099) loss_x loss_x 0.6538 (0.6181) acc_x 78.1250 (84.3750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 339
clean true:319
clean false:20
clean_rate:0.9410029498525073
noisy true:824
noisy false:437
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1261
epoch [50/200] batch [5/10] time 0.239 (0.242) data 0.117 (0.118) loss_x loss_x 0.4951 (0.6517) acc_x 93.7500 (81.8750) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/10] time 0.233 (0.240) data 0.106 (0.116) loss_x loss_x 0.9297 (0.6287) acc_x 75.0000 (83.4375) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 314
clean true:297
clean false:17
clean_rate:0.945859872611465
noisy true:812
noisy false:474
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 1286
epoch [51/200] batch [5/9] time 0.221 (0.231) data 0.099 (0.102) loss_x loss_x 1.5322 (0.8160) acc_x 68.7500 (82.5000) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 461
confident_label rate tensor(0.2037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 326
clean true:306
clean false:20
clean_rate:0.9386503067484663
noisy true:833
noisy false:441
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1274
epoch [52/200] batch [5/10] time 0.225 (0.232) data 0.103 (0.109) loss_x loss_x 0.8584 (0.6390) acc_x 78.1250 (85.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/10] time 0.173 (0.221) data 0.096 (0.106) loss_x loss_x 0.4644 (0.6437) acc_x 84.3750 (82.5000) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:318
clean false:20
clean_rate:0.9408284023668639
noisy true:802
noisy false:460
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [53/200] batch [5/10] time 0.260 (0.259) data 0.137 (0.137) loss_x loss_x 0.9033 (0.6907) acc_x 81.2500 (81.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/10] time 0.199 (0.249) data 0.123 (0.132) loss_x loss_x 0.9302 (0.5713) acc_x 81.2500 (85.3125) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:317
clean false:21
clean_rate:0.9378698224852071
noisy true:828
noisy false:434
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [54/200] batch [5/10] time 0.243 (0.251) data 0.120 (0.126) loss_x loss_x 0.7144 (0.5516) acc_x 81.2500 (86.8750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/10] time 0.227 (0.241) data 0.103 (0.117) loss_x loss_x 0.7812 (0.6360) acc_x 84.3750 (85.0000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 504
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 324
clean true:304
clean false:20
clean_rate:0.9382716049382716
noisy true:792
noisy false:484
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1276
epoch [55/200] batch [5/10] time 0.218 (0.211) data 0.091 (0.106) loss_x loss_x 1.2109 (0.8092) acc_x 65.6250 (80.6250) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/10] time 0.233 (0.226) data 0.108 (0.111) loss_x loss_x 0.4668 (0.6855) acc_x 87.5000 (81.8750) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2087, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 334
clean true:316
clean false:18
clean_rate:0.9461077844311377
noisy true:818
noisy false:448
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1266
epoch [56/200] batch [5/10] time 0.220 (0.223) data 0.096 (0.108) loss_x loss_x 0.4868 (0.6044) acc_x 90.6250 (85.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/10] time 0.210 (0.218) data 0.088 (0.099) loss_x loss_x 0.5698 (0.6469) acc_x 84.3750 (84.6875) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:322
clean false:20
clean_rate:0.9415204678362573
noisy true:813
noisy false:445
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [57/200] batch [5/10] time 0.223 (0.223) data 0.099 (0.098) loss_x loss_x 0.8042 (0.9050) acc_x 87.5000 (80.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/10] time 0.271 (0.230) data 0.148 (0.106) loss_x loss_x 0.6553 (0.7655) acc_x 78.1250 (79.6875) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.2131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 341
clean true:321
clean false:20
clean_rate:0.9413489736070382
noisy true:810
noisy false:449
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1259
epoch [58/200] batch [5/10] time 0.247 (0.228) data 0.125 (0.105) loss_x loss_x 0.6328 (0.6118) acc_x 84.3750 (83.7500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/10] time 0.236 (0.228) data 0.115 (0.105) loss_x loss_x 0.3135 (0.6800) acc_x 90.6250 (81.2500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:321
clean false:21
clean_rate:0.9385964912280702
noisy true:808
noisy false:450
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [59/200] batch [5/10] time 0.229 (0.227) data 0.109 (0.107) loss_x loss_x 0.4082 (0.6979) acc_x 87.5000 (78.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/10] time 0.256 (0.234) data 0.133 (0.112) loss_x loss_x 0.7397 (0.6710) acc_x 81.2500 (80.6250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 333
clean true:312
clean false:21
clean_rate:0.9369369369369369
noisy true:814
noisy false:453
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1267
epoch [60/200] batch [5/10] time 0.258 (0.258) data 0.134 (0.135) loss_x loss_x 0.3171 (0.5042) acc_x 93.7500 (84.3750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/10] time 0.180 (0.243) data 0.104 (0.124) loss_x loss_x 0.5112 (0.5442) acc_x 81.2500 (85.0000) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 326
clean true:308
clean false:18
clean_rate:0.9447852760736196
noisy true:830
noisy false:444
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1274
epoch [61/200] batch [5/10] time 0.208 (0.236) data 0.082 (0.112) loss_x loss_x 0.6621 (0.6293) acc_x 87.5000 (82.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/10] time 0.204 (0.221) data 0.079 (0.104) loss_x loss_x 0.7275 (0.5876) acc_x 81.2500 (85.6250) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:323
clean false:21
clean_rate:0.938953488372093
noisy true:827
noisy false:429
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [62/200] batch [5/10] time 0.217 (0.211) data 0.094 (0.097) loss_x loss_x 0.5439 (0.5207) acc_x 84.3750 (85.0000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/10] time 0.230 (0.214) data 0.109 (0.097) loss_x loss_x 0.4272 (0.5236) acc_x 93.7500 (86.5625) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:322
clean false:21
clean_rate:0.9387755102040817
noisy true:800
noisy false:457
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [63/200] batch [5/10] time 0.229 (0.224) data 0.107 (0.100) loss_x loss_x 1.0391 (0.7741) acc_x 71.8750 (78.7500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/10] time 0.218 (0.224) data 0.092 (0.101) loss_x loss_x 0.8984 (0.7841) acc_x 81.2500 (80.3125) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:318
clean false:27
clean_rate:0.9217391304347826
noisy true:793
noisy false:462
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [64/200] batch [5/10] time 0.247 (0.238) data 0.121 (0.113) loss_x loss_x 0.2566 (0.5932) acc_x 96.8750 (87.5000) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/10] time 0.233 (0.236) data 0.108 (0.111) loss_x loss_x 0.6528 (0.6707) acc_x 90.6250 (85.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 342
clean true:320
clean false:22
clean_rate:0.935672514619883
noisy true:808
noisy false:450
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1258
epoch [65/200] batch [5/10] time 0.249 (0.218) data 0.125 (0.095) loss_x loss_x 0.7139 (0.6114) acc_x 75.0000 (85.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/10] time 0.215 (0.222) data 0.091 (0.099) loss_x loss_x 0.8022 (0.6279) acc_x 81.2500 (85.0000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:333
clean false:28
clean_rate:0.9224376731301939
noisy true:784
noisy false:455
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [66/200] batch [5/11] time 0.218 (0.219) data 0.093 (0.094) loss_x loss_x 0.5161 (0.7652) acc_x 90.6250 (83.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/11] time 0.294 (0.228) data 0.170 (0.103) loss_x loss_x 0.3843 (0.6680) acc_x 90.6250 (84.6875) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:319
clean false:19
clean_rate:0.9437869822485208
noisy true:815
noisy false:447
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [67/200] batch [5/10] time 0.229 (0.235) data 0.104 (0.112) loss_x loss_x 0.3921 (0.5785) acc_x 87.5000 (84.3750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/10] time 0.220 (0.233) data 0.095 (0.109) loss_x loss_x 0.3823 (0.5839) acc_x 90.6250 (84.3750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.2225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 356
clean true:331
clean false:25
clean_rate:0.9297752808988764
noisy true:839
noisy false:405
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1244
epoch [68/200] batch [5/11] time 0.203 (0.221) data 0.082 (0.098) loss_x loss_x 0.8203 (0.7265) acc_x 78.1250 (81.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/11] time 0.223 (0.222) data 0.095 (0.097) loss_x loss_x 0.4763 (0.6048) acc_x 90.6250 (83.4375) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:316
clean false:27
clean_rate:0.9212827988338192
noisy true:805
noisy false:452
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [69/200] batch [5/10] time 0.218 (0.206) data 0.095 (0.098) loss_x loss_x 0.8906 (0.8063) acc_x 78.1250 (79.3750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/10] time 0.236 (0.215) data 0.111 (0.100) loss_x loss_x 0.4932 (0.7534) acc_x 81.2500 (80.0000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:332
clean false:22
clean_rate:0.9378531073446328
noisy true:794
noisy false:452
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [70/200] batch [5/11] time 0.215 (0.221) data 0.091 (0.097) loss_x loss_x 0.4004 (0.6332) acc_x 87.5000 (83.7500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/11] time 0.217 (0.227) data 0.091 (0.103) loss_x loss_x 0.8071 (0.6072) acc_x 78.1250 (84.6875) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 339
clean true:320
clean false:19
clean_rate:0.943952802359882
noisy true:814
noisy false:447
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1261
epoch [71/200] batch [5/10] time 0.233 (0.228) data 0.108 (0.103) loss_x loss_x 1.0215 (0.7824) acc_x 75.0000 (81.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/10] time 0.227 (0.229) data 0.105 (0.105) loss_x loss_x 0.4470 (0.6740) acc_x 93.7500 (83.4375) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 493
confident_label rate tensor(0.2112, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 338
clean true:312
clean false:26
clean_rate:0.9230769230769231
noisy true:795
noisy false:467
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1262
epoch [72/200] batch [5/10] time 0.228 (0.250) data 0.105 (0.127) loss_x loss_x 0.7876 (0.5922) acc_x 78.1250 (83.1250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/10] time 0.217 (0.235) data 0.094 (0.113) loss_x loss_x 0.8218 (0.6600) acc_x 81.2500 (83.1250) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 346
clean true:322
clean false:24
clean_rate:0.930635838150289
noisy true:801
noisy false:453
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1254
epoch [73/200] batch [5/10] time 0.221 (0.235) data 0.095 (0.110) loss_x loss_x 0.4060 (0.5905) acc_x 90.6250 (85.6250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/10] time 0.214 (0.230) data 0.091 (0.106) loss_x loss_x 1.0117 (0.6460) acc_x 78.1250 (85.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:321
clean false:30
clean_rate:0.9145299145299145
noisy true:799
noisy false:450
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [74/200] batch [5/10] time 0.248 (0.222) data 0.121 (0.108) loss_x loss_x 0.5879 (0.6740) acc_x 81.2500 (78.7500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/10] time 0.209 (0.225) data 0.085 (0.105) loss_x loss_x 0.4731 (0.6570) acc_x 81.2500 (81.5625) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 341
clean true:316
clean false:25
clean_rate:0.9266862170087976
noisy true:816
noisy false:443
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1259
epoch [75/200] batch [5/10] time 0.230 (0.231) data 0.105 (0.107) loss_x loss_x 0.4229 (0.7464) acc_x 87.5000 (79.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/10] time 0.234 (0.232) data 0.105 (0.107) loss_x loss_x 0.6597 (0.7086) acc_x 84.3750 (81.5625) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 447
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:322
clean false:26
clean_rate:0.9252873563218391
noisy true:831
noisy false:421
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [76/200] batch [5/10] time 0.214 (0.225) data 0.089 (0.101) loss_x loss_x 0.7461 (0.5875) acc_x 84.3750 (85.6250) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/10] time 0.236 (0.230) data 0.113 (0.105) loss_x loss_x 0.4434 (0.6246) acc_x 84.3750 (84.3750) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:325
clean false:23
clean_rate:0.9339080459770115
noisy true:809
noisy false:443
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [77/200] batch [5/10] time 0.234 (0.232) data 0.111 (0.107) loss_x loss_x 0.5103 (0.6098) acc_x 87.5000 (82.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/10] time 0.234 (0.231) data 0.107 (0.107) loss_x loss_x 0.6357 (0.6027) acc_x 84.3750 (84.0625) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 356
clean true:325
clean false:31
clean_rate:0.9129213483146067
noisy true:807
noisy false:437
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1244
epoch [78/200] batch [5/11] time 0.226 (0.220) data 0.102 (0.098) loss_x loss_x 0.8706 (0.7275) acc_x 78.1250 (82.5000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/11] time 0.233 (0.232) data 0.112 (0.109) loss_x loss_x 0.5693 (0.6645) acc_x 90.6250 (83.1250) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:318
clean false:26
clean_rate:0.9244186046511628
noisy true:797
noisy false:459
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [79/200] batch [5/10] time 0.219 (0.232) data 0.093 (0.108) loss_x loss_x 0.5181 (0.7452) acc_x 78.1250 (80.6250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/10] time 0.213 (0.228) data 0.089 (0.103) loss_x loss_x 0.4785 (0.7239) acc_x 90.6250 (80.9375) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.2081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 333
clean true:312
clean false:21
clean_rate:0.9369369369369369
noisy true:805
noisy false:462
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1267
epoch [80/200] batch [5/10] time 0.217 (0.226) data 0.093 (0.101) loss_x loss_x 0.8384 (0.7500) acc_x 68.7500 (78.1250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/10] time 0.222 (0.226) data 0.100 (0.102) loss_x loss_x 0.3330 (0.6635) acc_x 90.6250 (80.9375) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:319
clean false:26
clean_rate:0.9246376811594202
noisy true:791
noisy false:464
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [81/200] batch [5/10] time 0.158 (0.205) data 0.081 (0.100) loss_x loss_x 0.7832 (0.6186) acc_x 81.2500 (83.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/10] time 0.213 (0.211) data 0.089 (0.099) loss_x loss_x 0.7334 (0.5884) acc_x 84.3750 (85.3125) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 347
clean true:324
clean false:23
clean_rate:0.9337175792507204
noisy true:823
noisy false:430
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1253
epoch [82/200] batch [5/10] time 0.212 (0.235) data 0.089 (0.111) loss_x loss_x 0.5757 (0.6265) acc_x 84.3750 (85.0000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/10] time 0.230 (0.229) data 0.106 (0.104) loss_x loss_x 0.5654 (0.5213) acc_x 87.5000 (87.8125) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 346
clean true:322
clean false:24
clean_rate:0.930635838150289
noisy true:805
noisy false:449
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1254
epoch [83/200] batch [5/10] time 0.224 (0.243) data 0.103 (0.119) loss_x loss_x 0.5688 (0.4640) acc_x 87.5000 (89.3750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/10] time 0.226 (0.235) data 0.101 (0.111) loss_x loss_x 0.5552 (0.5252) acc_x 81.2500 (85.9375) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 348
clean true:326
clean false:22
clean_rate:0.9367816091954023
noisy true:811
noisy false:441
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1252
epoch [84/200] batch [5/10] time 0.221 (0.228) data 0.096 (0.102) loss_x loss_x 0.3696 (0.6038) acc_x 87.5000 (83.7500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/10] time 0.231 (0.231) data 0.109 (0.106) loss_x loss_x 0.6895 (0.6069) acc_x 75.0000 (83.1250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.2075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 332
clean true:306
clean false:26
clean_rate:0.9216867469879518
noisy true:799
noisy false:469
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1268
epoch [85/200] batch [5/10] time 0.242 (0.239) data 0.116 (0.110) loss_x loss_x 0.6436 (0.6375) acc_x 78.1250 (83.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/10] time 0.231 (0.233) data 0.108 (0.106) loss_x loss_x 0.7427 (0.6482) acc_x 81.2500 (83.7500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 341
clean true:320
clean false:21
clean_rate:0.9384164222873901
noisy true:801
noisy false:458
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1259
epoch [86/200] batch [5/10] time 0.164 (0.185) data 0.083 (0.088) loss_x loss_x 0.4795 (0.4035) acc_x 93.7500 (86.8750) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [10/10] time 0.219 (0.204) data 0.094 (0.093) loss_x loss_x 0.4321 (0.4285) acc_x 87.5000 (88.1250) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 513
confident_label rate tensor(0.2144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 343
clean true:317
clean false:26
clean_rate:0.924198250728863
noisy true:770
noisy false:487
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1257
epoch [87/200] batch [5/10] time 0.235 (0.238) data 0.111 (0.113) loss_x loss_x 0.4058 (0.5256) acc_x 84.3750 (84.3750) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/10] time 0.181 (0.225) data 0.102 (0.109) loss_x loss_x 0.3135 (0.4923) acc_x 93.7500 (85.6250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 345
clean true:320
clean false:25
clean_rate:0.927536231884058
noisy true:822
noisy false:433
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1255
epoch [88/200] batch [5/10] time 0.236 (0.233) data 0.112 (0.107) loss_x loss_x 0.5884 (0.5404) acc_x 84.3750 (85.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/10] time 0.232 (0.233) data 0.106 (0.108) loss_x loss_x 0.5562 (0.6092) acc_x 84.3750 (84.0625) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:341
clean false:22
clean_rate:0.9393939393939394
noisy true:805
noisy false:432
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [89/200] batch [5/11] time 0.282 (0.262) data 0.158 (0.142) loss_x loss_x 0.1930 (0.3760) acc_x 93.7500 (89.3750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/11] time 0.232 (0.253) data 0.108 (0.131) loss_x loss_x 0.5107 (0.5773) acc_x 84.3750 (84.6875) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 350
clean true:327
clean false:23
clean_rate:0.9342857142857143
noisy true:841
noisy false:409
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1250
epoch [90/200] batch [5/10] time 0.182 (0.209) data 0.106 (0.103) loss_x loss_x 0.3223 (0.5182) acc_x 93.7500 (86.8750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/10] time 0.229 (0.223) data 0.107 (0.108) loss_x loss_x 0.3367 (0.5638) acc_x 90.6250 (84.6875) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 351
clean true:324
clean false:27
clean_rate:0.9230769230769231
noisy true:785
noisy false:464
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1249
epoch [91/200] batch [5/10] time 0.221 (0.229) data 0.095 (0.107) loss_x loss_x 0.6074 (0.6426) acc_x 90.6250 (86.2500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/10] time 0.219 (0.226) data 0.095 (0.103) loss_x loss_x 0.8540 (0.5738) acc_x 78.1250 (86.5625) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 346
clean true:320
clean false:26
clean_rate:0.9248554913294798
noisy true:814
noisy false:440
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1254
epoch [92/200] batch [5/10] time 0.227 (0.220) data 0.103 (0.107) loss_x loss_x 0.5708 (0.5308) acc_x 87.5000 (86.8750) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/10] time 0.229 (0.219) data 0.108 (0.102) loss_x loss_x 0.3960 (0.5011) acc_x 87.5000 (87.1875) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 350
clean true:322
clean false:28
clean_rate:0.92
noisy true:789
noisy false:461
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1250
epoch [93/200] batch [5/10] time 0.243 (0.213) data 0.109 (0.106) loss_x loss_x 0.3855 (0.3942) acc_x 87.5000 (87.5000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/10] time 0.225 (0.218) data 0.102 (0.103) loss_x loss_x 0.8301 (0.4734) acc_x 78.1250 (87.1875) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:328
clean false:30
clean_rate:0.9162011173184358
noisy true:806
noisy false:436
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [94/200] batch [5/11] time 0.233 (0.233) data 0.109 (0.120) loss_x loss_x 0.6187 (0.4074) acc_x 81.2500 (90.0000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/11] time 0.231 (0.232) data 0.108 (0.113) loss_x loss_x 0.5425 (0.5081) acc_x 90.6250 (87.5000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:338
clean false:25
clean_rate:0.931129476584022
noisy true:780
noisy false:457
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [95/200] batch [5/11] time 0.231 (0.240) data 0.109 (0.117) loss_x loss_x 0.3518 (0.6794) acc_x 87.5000 (85.0000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/11] time 0.220 (0.235) data 0.103 (0.112) loss_x loss_x 0.6367 (0.6826) acc_x 87.5000 (84.3750) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:329
clean false:25
clean_rate:0.9293785310734464
noisy true:797
noisy false:449
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [96/200] batch [5/11] time 0.221 (0.223) data 0.101 (0.110) loss_x loss_x 0.3953 (0.6579) acc_x 90.6250 (85.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/11] time 0.231 (0.227) data 0.106 (0.108) loss_x loss_x 0.5713 (0.5994) acc_x 78.1250 (85.3125) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:328
clean false:26
clean_rate:0.9265536723163842
noisy true:826
noisy false:420
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [97/200] batch [5/11] time 0.213 (0.227) data 0.090 (0.102) loss_x loss_x 0.8013 (0.7231) acc_x 84.3750 (83.1250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/11] time 0.260 (0.228) data 0.136 (0.103) loss_x loss_x 0.6284 (0.6392) acc_x 81.2500 (84.3750) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 341
clean true:316
clean false:25
clean_rate:0.9266862170087976
noisy true:805
noisy false:454
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1259
epoch [98/200] batch [5/10] time 0.177 (0.211) data 0.101 (0.107) loss_x loss_x 0.6992 (0.6386) acc_x 81.2500 (85.6250) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/10] time 0.238 (0.227) data 0.114 (0.109) loss_x loss_x 0.2322 (0.5681) acc_x 93.7500 (85.6250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 365
clean true:337
clean false:28
clean_rate:0.9232876712328767
noisy true:805
noisy false:430
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1235
epoch [99/200] batch [5/11] time 0.234 (0.223) data 0.112 (0.100) loss_x loss_x 0.2646 (0.4358) acc_x 90.6250 (86.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/11] time 0.210 (0.220) data 0.088 (0.097) loss_x loss_x 1.2236 (0.5081) acc_x 75.0000 (86.8750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 344
clean true:319
clean false:25
clean_rate:0.9273255813953488
noisy true:815
noisy false:441
all clean rate:  [0.9470899470899471, 0.9362745098039216, 0.9731800766283525, 0.9675090252707581, 0.9645390070921985, 0.9649122807017544, 0.9717314487632509, 0.9574468085106383, 0.9688581314878892, 0.975177304964539, 0.9620689655172414, 0.9632107023411371, 0.9705882352941176, 0.9587628865979382, 0.9627118644067797, 0.9519230769230769, 0.9621451104100947, 0.9562289562289562, 0.9623287671232876, 0.9424920127795527, 0.9563758389261745, 0.9519230769230769, 0.9507692307692308, 0.952076677316294, 0.9554794520547946, 0.953125, 0.9473684210526315, 0.9387096774193548, 0.9478527607361963, 0.9487179487179487, 0.9584664536741214, 0.9442724458204335, 0.9459459459459459, 0.9571865443425076, 0.956386292834891, 0.9484848484848485, 0.9546827794561934, 0.9571865443425076, 0.9451219512195121, 0.9551282051282052, 0.941747572815534, 0.9545454545454546, 0.946031746031746, 0.9510703363914373, 0.9343283582089552, 0.9462686567164179, 0.9608433734939759, 0.9388379204892966, 0.9335347432024169, 0.9410029498525073, 0.945859872611465, 0.9386503067484663, 0.9408284023668639, 0.9378698224852071, 0.9382716049382716, 0.9461077844311377, 0.9415204678362573, 0.9413489736070382, 0.9385964912280702, 0.9369369369369369, 0.9447852760736196, 0.938953488372093, 0.9387755102040817, 0.9217391304347826, 0.935672514619883, 0.9224376731301939, 0.9437869822485208, 0.9297752808988764, 0.9212827988338192, 0.9378531073446328, 0.943952802359882, 0.9230769230769231, 0.930635838150289, 0.9145299145299145, 0.9266862170087976, 0.9252873563218391, 0.9339080459770115, 0.9129213483146067, 0.9244186046511628, 0.9369369369369369, 0.9246376811594202, 0.9337175792507204, 0.930635838150289, 0.9367816091954023, 0.9216867469879518, 0.9384164222873901, 0.924198250728863, 0.927536231884058, 0.9393939393939394, 0.9342857142857143, 0.9230769230769231, 0.9248554913294798, 0.92, 0.9162011173184358, 0.931129476584022, 0.9293785310734464, 0.9265536723163842, 0.9266862170087976, 0.9232876712328767, 0.9273255813953488]
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1256
epoch [100/200] batch [5/10] time 0.234 (0.229) data 0.111 (0.105) loss_x loss_x 0.7642 (0.6731) acc_x 84.3750 (82.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/10] time 0.222 (0.231) data 0.100 (0.108) loss_x loss_x 0.4692 (0.6322) acc_x 90.6250 (83.4375) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:323
clean false:31
clean_rate:0.9124293785310734
noisy true:822
noisy false:424
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [101/200] batch [5/11] time 0.213 (0.230) data 0.088 (0.106) loss_x loss_x 0.5430 (0.5353) acc_x 93.7500 (86.2500) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/11] time 0.232 (0.233) data 0.109 (0.109) loss_x loss_x 0.5806 (0.5051) acc_x 75.0000 (85.6250) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:331
clean false:30
clean_rate:0.9168975069252078
noisy true:812
noisy false:427
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [102/200] batch [5/11] time 0.219 (0.224) data 0.094 (0.105) loss_x loss_x 0.9360 (0.8525) acc_x 71.8750 (79.3750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/11] time 0.224 (0.224) data 0.104 (0.102) loss_x loss_x 0.9780 (0.7395) acc_x 68.7500 (80.9375) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 496
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 379
clean true:339
clean false:40
clean_rate:0.8944591029023746
noisy true:765
noisy false:456
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1221
epoch [103/200] batch [5/11] time 0.159 (0.204) data 0.083 (0.099) loss_x loss_x 0.4314 (0.7083) acc_x 90.6250 (83.7500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/11] time 0.205 (0.207) data 0.083 (0.094) loss_x loss_x 0.4822 (0.6619) acc_x 84.3750 (82.8125) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 368
clean true:335
clean false:33
clean_rate:0.9103260869565217
noisy true:781
noisy false:451
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1232
epoch [104/200] batch [5/11] time 0.235 (0.236) data 0.111 (0.110) loss_x loss_x 0.4985 (0.5645) acc_x 84.3750 (86.2500) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/11] time 0.238 (0.238) data 0.111 (0.113) loss_x loss_x 0.9009 (0.5249) acc_x 81.2500 (87.1875) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 366
clean true:330
clean false:36
clean_rate:0.9016393442622951
noisy true:780
noisy false:454
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1234
epoch [105/200] batch [5/11] time 0.221 (0.221) data 0.097 (0.098) loss_x loss_x 0.1416 (0.3132) acc_x 100.0000 (92.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/11] time 0.217 (0.223) data 0.096 (0.099) loss_x loss_x 0.5981 (0.5182) acc_x 87.5000 (86.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:322
clean false:31
clean_rate:0.9121813031161473
noisy true:788
noisy false:459
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [106/200] batch [5/11] time 0.224 (0.237) data 0.104 (0.115) loss_x loss_x 0.6440 (0.5361) acc_x 90.6250 (85.6250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/11] time 0.195 (0.231) data 0.109 (0.113) loss_x loss_x 0.5830 (0.5483) acc_x 84.3750 (84.6875) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:322
clean false:32
clean_rate:0.9096045197740112
noisy true:788
noisy false:458
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [107/200] batch [5/11] time 0.207 (0.209) data 0.084 (0.094) loss_x loss_x 0.8218 (0.8397) acc_x 71.8750 (80.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/11] time 0.233 (0.219) data 0.112 (0.099) loss_x loss_x 0.3933 (0.6894) acc_x 90.6250 (83.7500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 498
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 353
clean true:317
clean false:36
clean_rate:0.8980169971671388
noisy true:785
noisy false:462
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1247
epoch [108/200] batch [5/11] time 0.240 (0.236) data 0.117 (0.113) loss_x loss_x 0.8008 (0.6106) acc_x 71.8750 (81.2500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/11] time 0.209 (0.225) data 0.083 (0.108) loss_x loss_x 0.4663 (0.5817) acc_x 90.6250 (83.1250) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 354
clean true:319
clean false:35
clean_rate:0.9011299435028248
noisy true:791
noisy false:455
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1246
epoch [109/200] batch [5/11] time 0.217 (0.229) data 0.094 (0.101) loss_x loss_x 0.4529 (0.4915) acc_x 90.6250 (88.7500) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/11] time 0.220 (0.226) data 0.096 (0.100) loss_x loss_x 0.4885 (0.5359) acc_x 90.6250 (86.5625) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:321
clean false:37
clean_rate:0.8966480446927374
noisy true:794
noisy false:448
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [110/200] batch [5/11] time 0.249 (0.257) data 0.123 (0.132) loss_x loss_x 0.2310 (0.6210) acc_x 96.8750 (83.1250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/11] time 0.235 (0.245) data 0.109 (0.119) loss_x loss_x 0.3552 (0.6302) acc_x 90.6250 (84.0625) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.2250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 360
clean true:325
clean false:35
clean_rate:0.9027777777777778
noisy true:786
noisy false:454
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1240
epoch [111/200] batch [5/11] time 0.208 (0.218) data 0.083 (0.094) loss_x loss_x 0.5249 (0.6225) acc_x 81.2500 (82.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/11] time 0.233 (0.225) data 0.109 (0.100) loss_x loss_x 0.6372 (0.6125) acc_x 84.3750 (85.9375) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 362
clean true:334
clean false:28
clean_rate:0.9226519337016574
noisy true:794
noisy false:444
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1238
epoch [112/200] batch [5/11] time 0.239 (0.234) data 0.114 (0.118) loss_x loss_x 0.5356 (0.4630) acc_x 87.5000 (90.6250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/11] time 0.254 (0.238) data 0.129 (0.118) loss_x loss_x 0.3318 (0.5279) acc_x 90.6250 (86.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 360
clean true:328
clean false:32
clean_rate:0.9111111111111111
noisy true:802
noisy false:438
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1240
epoch [113/200] batch [5/11] time 0.233 (0.245) data 0.110 (0.123) loss_x loss_x 0.7529 (0.6233) acc_x 78.1250 (80.0000) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/11] time 0.232 (0.238) data 0.107 (0.115) loss_x loss_x 0.4878 (0.5463) acc_x 84.3750 (83.7500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 483
confident_label rate tensor(0.2306, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 369
clean true:334
clean false:35
clean_rate:0.9051490514905149
noisy true:783
noisy false:448
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1231
epoch [114/200] batch [5/11] time 0.235 (0.237) data 0.108 (0.111) loss_x loss_x 0.3250 (0.4577) acc_x 93.7500 (88.1250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/11] time 0.231 (0.231) data 0.107 (0.106) loss_x loss_x 0.4639 (0.4730) acc_x 87.5000 (87.5000) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 485
confident_label rate tensor(0.2244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 359
clean true:331
clean false:28
clean_rate:0.9220055710306406
noisy true:784
noisy false:457
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1241
epoch [115/200] batch [5/11] time 0.229 (0.215) data 0.105 (0.096) loss_x loss_x 0.6123 (0.5655) acc_x 84.3750 (86.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/11] time 0.241 (0.221) data 0.117 (0.099) loss_x loss_x 0.1450 (0.4742) acc_x 96.8750 (88.7500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:344
clean false:30
clean_rate:0.9197860962566845
noisy true:811
noisy false:415
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [116/200] batch [5/11] time 0.217 (0.216) data 0.094 (0.105) loss_x loss_x 0.5303 (0.5138) acc_x 84.3750 (86.8750) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/11] time 0.226 (0.224) data 0.104 (0.107) loss_x loss_x 0.5181 (0.5395) acc_x 90.6250 (85.9375) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 364
clean true:330
clean false:34
clean_rate:0.9065934065934066
noisy true:805
noisy false:431
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1236
epoch [117/200] batch [5/11] time 0.232 (0.234) data 0.110 (0.112) loss_x loss_x 0.4111 (0.5342) acc_x 84.3750 (85.0000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/11] time 0.238 (0.233) data 0.114 (0.110) loss_x loss_x 0.6577 (0.5147) acc_x 78.1250 (85.0000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:326
clean false:32
clean_rate:0.9106145251396648
noisy true:797
noisy false:445
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [118/200] batch [5/11] time 0.230 (0.220) data 0.105 (0.105) loss_x loss_x 0.3789 (0.5948) acc_x 93.7500 (87.5000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/11] time 0.229 (0.226) data 0.105 (0.107) loss_x loss_x 0.7114 (0.6324) acc_x 78.1250 (85.3125) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 346
clean true:323
clean false:23
clean_rate:0.9335260115606936
noisy true:783
noisy false:471
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1254
epoch [119/200] batch [5/10] time 0.221 (0.220) data 0.096 (0.105) loss_x loss_x 0.5767 (0.5280) acc_x 93.7500 (87.5000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/10] time 0.217 (0.219) data 0.094 (0.100) loss_x loss_x 0.4736 (0.5613) acc_x 81.2500 (85.6250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 365
clean true:329
clean false:36
clean_rate:0.9013698630136986
noisy true:803
noisy false:432
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1235
epoch [120/200] batch [5/11] time 0.233 (0.231) data 0.108 (0.115) loss_x loss_x 0.4285 (0.6863) acc_x 87.5000 (83.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/11] time 0.209 (0.228) data 0.086 (0.107) loss_x loss_x 0.2756 (0.6627) acc_x 93.7500 (84.0625) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 446
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:336
clean false:27
clean_rate:0.9256198347107438
noisy true:818
noisy false:419
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [121/200] batch [5/11] time 0.231 (0.229) data 0.105 (0.111) loss_x loss_x 0.5078 (0.4704) acc_x 90.6250 (86.8750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/11] time 0.237 (0.234) data 0.112 (0.113) loss_x loss_x 0.8057 (0.5187) acc_x 84.3750 (87.1875) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:329
clean false:29
clean_rate:0.9189944134078212
noisy true:796
noisy false:446
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [122/200] batch [5/11] time 0.247 (0.242) data 0.123 (0.118) loss_x loss_x 0.4619 (0.5305) acc_x 87.5000 (86.2500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/11] time 0.232 (0.237) data 0.107 (0.112) loss_x loss_x 0.5825 (0.5668) acc_x 81.2500 (85.0000) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:335
clean false:32
clean_rate:0.9128065395095368
noisy true:796
noisy false:437
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [123/200] batch [5/11] time 0.226 (0.230) data 0.103 (0.107) loss_x loss_x 0.5015 (0.4344) acc_x 81.2500 (90.0000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/11] time 0.208 (0.218) data 0.085 (0.104) loss_x loss_x 1.0674 (0.5599) acc_x 81.2500 (88.1250) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:329
clean false:32
clean_rate:0.9113573407202216
noisy true:798
noisy false:441
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [124/200] batch [5/11] time 0.228 (0.241) data 0.102 (0.116) loss_x loss_x 1.0430 (0.6349) acc_x 68.7500 (84.3750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/11] time 0.232 (0.245) data 0.108 (0.120) loss_x loss_x 0.8667 (0.5530) acc_x 71.8750 (85.3125) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 372
clean true:340
clean false:32
clean_rate:0.9139784946236559
noisy true:795
noisy false:433
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1228
epoch [125/200] batch [5/11] time 0.231 (0.234) data 0.106 (0.111) loss_x loss_x 0.4341 (0.4923) acc_x 90.6250 (87.5000) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/11] time 0.234 (0.228) data 0.110 (0.112) loss_x loss_x 0.3523 (0.5843) acc_x 87.5000 (85.0000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:326
clean false:32
clean_rate:0.9106145251396648
noisy true:803
noisy false:439
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [126/200] batch [5/11] time 0.225 (0.231) data 0.100 (0.106) loss_x loss_x 0.4128 (0.4721) acc_x 90.6250 (86.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/11] time 0.218 (0.231) data 0.094 (0.106) loss_x loss_x 0.9658 (0.5612) acc_x 78.1250 (85.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 364
clean true:333
clean false:31
clean_rate:0.9148351648351648
noisy true:812
noisy false:424
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1236
epoch [127/200] batch [5/11] time 0.212 (0.224) data 0.091 (0.102) loss_x loss_x 0.6968 (0.4466) acc_x 81.2500 (88.1250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/11] time 0.211 (0.223) data 0.085 (0.099) loss_x loss_x 0.5850 (0.4804) acc_x 84.3750 (86.8750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 480
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 383
clean true:349
clean false:34
clean_rate:0.9112271540469974
noisy true:771
noisy false:446
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1217
epoch [128/200] batch [5/11] time 0.200 (0.216) data 0.088 (0.103) loss_x loss_x 0.9009 (0.6847) acc_x 81.2500 (83.1250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/11] time 0.213 (0.222) data 0.092 (0.104) loss_x loss_x 0.6577 (0.6280) acc_x 81.2500 (83.7500) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:333
clean false:40
clean_rate:0.8927613941018767
noisy true:799
noisy false:428
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [129/200] batch [5/11] time 0.264 (0.235) data 0.140 (0.108) loss_x loss_x 1.3662 (0.7137) acc_x 87.5000 (87.5000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/11] time 0.222 (0.231) data 0.098 (0.104) loss_x loss_x 0.3491 (0.6233) acc_x 96.8750 (87.5000) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 497
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:328
clean false:33
clean_rate:0.9085872576177285
noisy true:775
noisy false:464
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [130/200] batch [5/11] time 0.232 (0.261) data 0.110 (0.136) loss_x loss_x 0.5264 (0.6446) acc_x 84.3750 (83.1250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/11] time 0.269 (0.257) data 0.145 (0.132) loss_x loss_x 0.5049 (0.6886) acc_x 90.6250 (84.0625) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:344
clean false:29
clean_rate:0.9222520107238605
noisy true:791
noisy false:436
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [131/200] batch [5/11] time 0.231 (0.244) data 0.106 (0.120) loss_x loss_x 0.4548 (0.4241) acc_x 87.5000 (91.2500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/11] time 0.228 (0.241) data 0.101 (0.117) loss_x loss_x 0.3442 (0.5083) acc_x 90.6250 (87.1875) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:328
clean false:33
clean_rate:0.9085872576177285
noisy true:813
noisy false:426
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [132/200] batch [5/11] time 0.212 (0.220) data 0.085 (0.093) loss_x loss_x 0.8984 (0.5089) acc_x 84.3750 (89.3750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/11] time 0.230 (0.225) data 0.104 (0.098) loss_x loss_x 0.4746 (0.5248) acc_x 93.7500 (87.8125) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:334
clean false:29
clean_rate:0.9201101928374655
noisy true:794
noisy false:443
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [133/200] batch [5/11] time 0.299 (0.261) data 0.175 (0.142) loss_x loss_x 0.3840 (0.5087) acc_x 90.6250 (89.3750) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/11] time 0.233 (0.256) data 0.108 (0.134) loss_x loss_x 0.8872 (0.4857) acc_x 71.8750 (86.8750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 523
confident_label rate tensor(0.2225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 356
clean true:321
clean false:35
clean_rate:0.901685393258427
noisy true:756
noisy false:488
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1244
epoch [134/200] batch [5/11] time 0.305 (0.258) data 0.182 (0.144) loss_x loss_x 0.6079 (0.6814) acc_x 81.2500 (85.0000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/11] time 0.239 (0.246) data 0.115 (0.128) loss_x loss_x 0.3723 (0.6219) acc_x 90.6250 (84.0625) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 359
clean true:327
clean false:32
clean_rate:0.9108635097493036
noisy true:798
noisy false:443
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1241
epoch [135/200] batch [5/11] time 0.233 (0.226) data 0.109 (0.108) loss_x loss_x 0.4685 (0.5623) acc_x 87.5000 (85.0000) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/11] time 0.232 (0.230) data 0.106 (0.109) loss_x loss_x 0.6030 (0.5449) acc_x 81.2500 (86.2500) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.2231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 357
clean true:325
clean false:32
clean_rate:0.9103641456582633
noisy true:773
noisy false:470
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1243
epoch [136/200] batch [5/11] time 0.229 (0.233) data 0.106 (0.118) loss_x loss_x 0.3831 (0.5123) acc_x 87.5000 (86.8750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/11] time 0.250 (0.235) data 0.127 (0.115) loss_x loss_x 0.2964 (0.4882) acc_x 90.6250 (88.4375) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 370
clean true:337
clean false:33
clean_rate:0.9108108108108108
noisy true:798
noisy false:432
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1230
epoch [137/200] batch [5/11] time 0.230 (0.229) data 0.107 (0.106) loss_x loss_x 0.3921 (0.6556) acc_x 87.5000 (83.7500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/11] time 0.220 (0.226) data 0.093 (0.102) loss_x loss_x 0.3420 (0.5548) acc_x 93.7500 (85.9375) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 360
clean true:332
clean false:28
clean_rate:0.9222222222222223
noisy true:797
noisy false:443
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1240
epoch [138/200] batch [5/11] time 0.174 (0.252) data 0.098 (0.138) loss_x loss_x 0.4487 (0.5492) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/11] time 0.286 (0.250) data 0.162 (0.125) loss_x loss_x 0.6611 (0.4896) acc_x 84.3750 (86.2500) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:330
clean false:28
clean_rate:0.9217877094972067
noisy true:775
noisy false:467
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [139/200] batch [5/11] time 0.216 (0.222) data 0.091 (0.098) loss_x loss_x 1.0947 (0.5250) acc_x 78.1250 (88.1250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/11] time 0.232 (0.231) data 0.109 (0.107) loss_x loss_x 0.2462 (0.5854) acc_x 96.8750 (86.8750) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 513
confident_label rate tensor(0.2275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 364
clean true:331
clean false:33
clean_rate:0.9093406593406593
noisy true:756
noisy false:480
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1236
epoch [140/200] batch [5/11] time 0.254 (0.218) data 0.130 (0.111) loss_x loss_x 0.8662 (0.5321) acc_x 81.2500 (87.5000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/11] time 0.219 (0.232) data 0.097 (0.117) loss_x loss_x 0.3708 (0.5208) acc_x 93.7500 (87.8125) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 356
clean true:327
clean false:29
clean_rate:0.9185393258426966
noisy true:796
noisy false:448
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1244
epoch [141/200] batch [5/11] time 0.216 (0.242) data 0.093 (0.119) loss_x loss_x 0.5127 (0.5393) acc_x 90.6250 (88.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/11] time 0.183 (0.231) data 0.096 (0.111) loss_x loss_x 0.3079 (0.4437) acc_x 96.8750 (89.3750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 375
clean true:348
clean false:27
clean_rate:0.928
noisy true:804
noisy false:421
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1225
epoch [142/200] batch [5/11] time 0.231 (0.245) data 0.105 (0.128) loss_x loss_x 0.5264 (0.5922) acc_x 90.6250 (86.2500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/11] time 0.216 (0.234) data 0.089 (0.112) loss_x loss_x 0.5918 (0.5379) acc_x 87.5000 (87.5000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 492
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:332
clean false:31
clean_rate:0.9146005509641874
noisy true:776
noisy false:461
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [143/200] batch [5/11] time 0.226 (0.230) data 0.103 (0.107) loss_x loss_x 0.2651 (0.6249) acc_x 90.6250 (82.5000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/11] time 0.225 (0.232) data 0.103 (0.109) loss_x loss_x 0.8760 (0.6058) acc_x 75.0000 (83.4375) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 478
confident_label rate tensor(0.2287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 366
clean true:330
clean false:36
clean_rate:0.9016393442622951
noisy true:792
noisy false:442
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1234
epoch [144/200] batch [5/11] time 0.235 (0.231) data 0.111 (0.106) loss_x loss_x 0.4060 (0.6367) acc_x 87.5000 (83.7500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/11] time 0.219 (0.230) data 0.096 (0.105) loss_x loss_x 0.4492 (0.6232) acc_x 93.7500 (83.1250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 355
clean true:324
clean false:31
clean_rate:0.9126760563380282
noisy true:774
noisy false:471
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1245
epoch [145/200] batch [5/11] time 0.286 (0.241) data 0.163 (0.117) loss_x loss_x 0.3735 (0.3962) acc_x 90.6250 (91.2500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/11] time 0.231 (0.234) data 0.105 (0.109) loss_x loss_x 0.4341 (0.4871) acc_x 84.3750 (88.4375) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 362
clean true:332
clean false:30
clean_rate:0.9171270718232044
noisy true:778
noisy false:460
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1238
epoch [146/200] batch [5/11] time 0.210 (0.218) data 0.085 (0.094) loss_x loss_x 0.7661 (0.5313) acc_x 78.1250 (86.8750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/11] time 0.299 (0.228) data 0.175 (0.104) loss_x loss_x 1.0195 (0.6319) acc_x 78.1250 (84.3750) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 462
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:332
clean false:35
clean_rate:0.9046321525885559
noisy true:806
noisy false:427
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [147/200] batch [5/11] time 0.234 (0.241) data 0.109 (0.117) loss_x loss_x 0.5791 (0.5998) acc_x 87.5000 (88.7500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/11] time 0.289 (0.245) data 0.165 (0.120) loss_x loss_x 0.1666 (0.6753) acc_x 93.7500 (86.2500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 495
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:336
clean false:31
clean_rate:0.9155313351498637
noisy true:769
noisy false:464
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [148/200] batch [5/11] time 0.235 (0.245) data 0.107 (0.118) loss_x loss_x 0.3616 (0.6715) acc_x 90.6250 (86.2500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/11] time 0.219 (0.237) data 0.094 (0.111) loss_x loss_x 0.2737 (0.5360) acc_x 93.7500 (87.5000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 370
clean true:336
clean false:34
clean_rate:0.9081081081081082
noisy true:777
noisy false:453
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1230
epoch [149/200] batch [5/11] time 0.222 (0.240) data 0.096 (0.113) loss_x loss_x 0.5244 (0.4574) acc_x 87.5000 (89.3750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/11] time 0.225 (0.232) data 0.100 (0.106) loss_x loss_x 0.2588 (0.4986) acc_x 93.7500 (87.5000) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 371
clean true:334
clean false:37
clean_rate:0.9002695417789758
noisy true:787
noisy false:442
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1229
epoch [150/200] batch [5/11] time 0.226 (0.231) data 0.103 (0.105) loss_x loss_x 0.3513 (0.4910) acc_x 93.7500 (88.1250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/11] time 0.213 (0.223) data 0.088 (0.098) loss_x loss_x 0.8579 (0.5106) acc_x 78.1250 (87.5000) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 370
clean true:338
clean false:32
clean_rate:0.9135135135135135
noisy true:798
noisy false:432
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1230
epoch [151/200] batch [5/11] time 0.231 (0.242) data 0.103 (0.113) loss_x loss_x 0.5757 (0.5353) acc_x 81.2500 (86.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/11] time 0.214 (0.237) data 0.090 (0.110) loss_x loss_x 0.3982 (0.5423) acc_x 90.6250 (85.9375) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 472
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:334
clean false:39
clean_rate:0.8954423592493298
noisy true:794
noisy false:433
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [152/200] batch [5/11] time 0.225 (0.232) data 0.100 (0.108) loss_x loss_x 0.4470 (0.5374) acc_x 90.6250 (89.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/11] time 0.247 (0.233) data 0.126 (0.110) loss_x loss_x 0.2688 (0.5432) acc_x 93.7500 (88.1250) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2375, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 380
clean true:339
clean false:41
clean_rate:0.8921052631578947
noisy true:790
noisy false:430
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1220
epoch [153/200] batch [5/11] time 0.229 (0.235) data 0.104 (0.115) loss_x loss_x 0.5151 (0.4543) acc_x 90.6250 (87.5000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/11] time 0.238 (0.234) data 0.114 (0.112) loss_x loss_x 0.7617 (0.5708) acc_x 81.2500 (84.6875) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 365
clean true:326
clean false:39
clean_rate:0.8931506849315068
noisy true:783
noisy false:452
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1235
epoch [154/200] batch [5/11] time 0.228 (0.234) data 0.103 (0.108) loss_x loss_x 0.6821 (0.9025) acc_x 81.2500 (79.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/11] time 0.241 (0.232) data 0.111 (0.106) loss_x loss_x 0.2012 (0.6726) acc_x 93.7500 (84.0625) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:339
clean false:34
clean_rate:0.9088471849865952
noisy true:794
noisy false:433
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [155/200] batch [5/11] time 0.229 (0.232) data 0.106 (0.113) loss_x loss_x 0.3750 (0.5726) acc_x 87.5000 (86.2500) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/11] time 0.233 (0.232) data 0.110 (0.110) loss_x loss_x 0.9185 (0.6500) acc_x 78.1250 (84.6875) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 384
clean true:350
clean false:34
clean_rate:0.9114583333333334
noisy true:776
noisy false:440
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1216
epoch [156/200] batch [5/12] time 0.209 (0.229) data 0.085 (0.104) loss_x loss_x 0.3870 (0.4534) acc_x 93.7500 (91.2500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/12] time 0.179 (0.223) data 0.103 (0.103) loss_x loss_x 0.4519 (0.4623) acc_x 87.5000 (90.0000) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2406, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 385
clean true:348
clean false:37
clean_rate:0.9038961038961039
noisy true:784
noisy false:431
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1215
epoch [157/200] batch [5/12] time 0.233 (0.226) data 0.111 (0.108) loss_x loss_x 0.2296 (0.3187) acc_x 96.8750 (94.3750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/12] time 0.237 (0.227) data 0.111 (0.106) loss_x loss_x 0.7588 (0.4349) acc_x 84.3750 (90.3125) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 370
clean true:332
clean false:38
clean_rate:0.8972972972972973
noisy true:786
noisy false:444
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1230
epoch [158/200] batch [5/11] time 0.250 (0.234) data 0.127 (0.110) loss_x loss_x 0.9585 (0.4878) acc_x 75.0000 (86.2500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/11] time 0.232 (0.236) data 0.107 (0.112) loss_x loss_x 0.4792 (0.5985) acc_x 87.5000 (83.7500) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 505
confident_label rate tensor(0.2269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 363
clean true:324
clean false:39
clean_rate:0.8925619834710744
noisy true:771
noisy false:466
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1237
epoch [159/200] batch [5/11] time 0.229 (0.238) data 0.106 (0.111) loss_x loss_x 0.6562 (0.5766) acc_x 78.1250 (84.3750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/11] time 0.230 (0.234) data 0.109 (0.109) loss_x loss_x 0.7656 (0.5783) acc_x 84.3750 (85.0000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 502
confident_label rate tensor(0.2300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 368
clean true:334
clean false:34
clean_rate:0.907608695652174
noisy true:764
noisy false:468
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1232
epoch [160/200] batch [5/11] time 0.251 (0.236) data 0.124 (0.104) loss_x loss_x 0.6958 (0.4784) acc_x 84.3750 (90.0000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/11] time 0.259 (0.235) data 0.134 (0.107) loss_x loss_x 0.2214 (0.4624) acc_x 93.7500 (90.6250) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 375
clean true:340
clean false:35
clean_rate:0.9066666666666666
noisy true:806
noisy false:419
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1225
epoch [161/200] batch [5/11] time 0.226 (0.225) data 0.103 (0.105) loss_x loss_x 0.5400 (0.4357) acc_x 84.3750 (88.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/11] time 0.231 (0.227) data 0.108 (0.106) loss_x loss_x 0.1445 (0.4356) acc_x 96.8750 (87.1875) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 473
confident_label rate tensor(0.2356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 377
clean true:338
clean false:39
clean_rate:0.896551724137931
noisy true:789
noisy false:434
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1223
epoch [162/200] batch [5/11] time 0.234 (0.234) data 0.107 (0.108) loss_x loss_x 0.3440 (0.4473) acc_x 90.6250 (86.2500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/11] time 0.207 (0.222) data 0.083 (0.097) loss_x loss_x 0.6226 (0.4932) acc_x 81.2500 (85.9375) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2275, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 364
clean true:332
clean false:32
clean_rate:0.9120879120879121
noisy true:797
noisy false:439
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1236
epoch [163/200] batch [5/11] time 0.208 (0.208) data 0.085 (0.083) loss_x loss_x 0.8569 (0.7351) acc_x 81.2500 (80.6250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/11] time 0.208 (0.207) data 0.084 (0.083) loss_x loss_x 0.3594 (0.5582) acc_x 90.6250 (85.6250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:342
clean false:36
clean_rate:0.9047619047619048
noisy true:804
noisy false:418
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [164/200] batch [5/11] time 0.208 (0.216) data 0.081 (0.082) loss_x loss_x 0.5220 (0.6063) acc_x 90.6250 (85.6250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/11] time 0.207 (0.213) data 0.084 (0.084) loss_x loss_x 1.1377 (0.5902) acc_x 75.0000 (86.2500) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2306, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 369
clean true:333
clean false:36
clean_rate:0.9024390243902439
noisy true:793
noisy false:438
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1231
epoch [165/200] batch [5/11] time 0.211 (0.205) data 0.086 (0.084) loss_x loss_x 0.2198 (0.3983) acc_x 96.8750 (90.0000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/11] time 0.225 (0.215) data 0.100 (0.091) loss_x loss_x 0.4036 (0.4549) acc_x 87.5000 (88.4375) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:335
clean false:32
clean_rate:0.9128065395095368
noisy true:790
noisy false:443
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [166/200] batch [5/11] time 0.234 (0.225) data 0.109 (0.105) loss_x loss_x 0.2301 (0.3746) acc_x 93.7500 (89.3750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/11] time 0.233 (0.228) data 0.108 (0.106) loss_x loss_x 0.3115 (0.4405) acc_x 93.7500 (89.3750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2400, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 384
clean true:348
clean false:36
clean_rate:0.90625
noisy true:787
noisy false:429
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1216
epoch [167/200] batch [5/12] time 0.215 (0.218) data 0.089 (0.086) loss_x loss_x 0.6465 (0.6986) acc_x 87.5000 (81.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/12] time 0.201 (0.212) data 0.079 (0.084) loss_x loss_x 0.6001 (0.5328) acc_x 84.3750 (85.9375) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2325, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 372
clean true:339
clean false:33
clean_rate:0.9112903225806451
noisy true:787
noisy false:441
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1228
epoch [168/200] batch [5/11] time 0.216 (0.209) data 0.086 (0.083) loss_x loss_x 0.1879 (0.4014) acc_x 96.8750 (90.0000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/11] time 0.210 (0.208) data 0.086 (0.083) loss_x loss_x 0.3511 (0.4032) acc_x 90.6250 (90.6250) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.2319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 371
clean true:340
clean false:31
clean_rate:0.9164420485175202
noisy true:807
noisy false:422
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1229
epoch [169/200] batch [5/11] time 0.230 (0.229) data 0.106 (0.106) loss_x loss_x 0.7197 (0.4950) acc_x 84.3750 (88.7500) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/11] time 0.228 (0.227) data 0.104 (0.105) loss_x loss_x 0.4661 (0.5528) acc_x 87.5000 (86.8750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 481
confident_label rate tensor(0.2387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 382
clean true:342
clean false:40
clean_rate:0.8952879581151832
noisy true:777
noisy false:441
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1218
epoch [170/200] batch [5/11] time 0.203 (0.206) data 0.081 (0.083) loss_x loss_x 0.4290 (0.5990) acc_x 90.6250 (85.0000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/11] time 0.206 (0.206) data 0.082 (0.082) loss_x loss_x 0.7842 (0.6108) acc_x 78.1250 (84.6875) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 459
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 379
clean true:343
clean false:36
clean_rate:0.9050131926121372
noisy true:798
noisy false:423
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1221
epoch [171/200] batch [5/11] time 0.209 (0.208) data 0.083 (0.083) loss_x loss_x 0.2935 (0.5551) acc_x 93.7500 (87.5000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/11] time 0.210 (0.208) data 0.084 (0.083) loss_x loss_x 0.4607 (0.6267) acc_x 87.5000 (86.8750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.2300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 368
clean true:337
clean false:31
clean_rate:0.9157608695652174
noisy true:794
noisy false:438
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1232
epoch [172/200] batch [5/11] time 0.209 (0.207) data 0.084 (0.083) loss_x loss_x 0.6724 (0.4601) acc_x 78.1250 (87.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/11] time 0.205 (0.206) data 0.081 (0.082) loss_x loss_x 0.7041 (0.5689) acc_x 78.1250 (84.3750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:339
clean false:39
clean_rate:0.8968253968253969
noisy true:777
noisy false:445
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [173/200] batch [5/11] time 0.204 (0.206) data 0.080 (0.082) loss_x loss_x 0.9438 (0.4759) acc_x 81.2500 (88.1250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/11] time 0.211 (0.207) data 0.084 (0.082) loss_x loss_x 0.1451 (0.4607) acc_x 96.8750 (88.1250) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 375
clean true:332
clean false:43
clean_rate:0.8853333333333333
noisy true:781
noisy false:444
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1225
epoch [174/200] batch [5/11] time 0.209 (0.190) data 0.084 (0.082) loss_x loss_x 0.3247 (0.4972) acc_x 90.6250 (85.0000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/11] time 0.208 (0.198) data 0.084 (0.083) loss_x loss_x 0.3706 (0.4550) acc_x 93.7500 (87.1875) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 377
clean true:341
clean false:36
clean_rate:0.9045092838196287
noisy true:793
noisy false:430
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1223
epoch [175/200] batch [5/11] time 0.207 (0.208) data 0.082 (0.083) loss_x loss_x 0.6523 (0.6249) acc_x 84.3750 (85.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/11] time 0.206 (0.208) data 0.082 (0.083) loss_x loss_x 0.5820 (0.6204) acc_x 81.2500 (84.0625) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 499
confident_label rate tensor(0.2300, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 368
clean true:333
clean false:35
clean_rate:0.904891304347826
noisy true:768
noisy false:464
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1232
epoch [176/200] batch [5/11] time 0.206 (0.204) data 0.081 (0.083) loss_x loss_x 0.2190 (0.4394) acc_x 96.8750 (89.3750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/11] time 0.207 (0.205) data 0.082 (0.082) loss_x loss_x 0.8267 (0.5803) acc_x 75.0000 (85.0000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 488
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:330
clean false:31
clean_rate:0.9141274238227147
noisy true:782
noisy false:457
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [177/200] batch [5/11] time 0.204 (0.208) data 0.080 (0.084) loss_x loss_x 0.8066 (0.5548) acc_x 75.0000 (85.0000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/11] time 0.206 (0.209) data 0.081 (0.084) loss_x loss_x 0.2839 (0.5355) acc_x 93.7500 (86.5625) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:344
clean false:34
clean_rate:0.91005291005291
noisy true:779
noisy false:443
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [178/200] batch [5/11] time 0.206 (0.208) data 0.082 (0.081) loss_x loss_x 0.2559 (0.5616) acc_x 93.7500 (86.8750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/11] time 0.207 (0.207) data 0.083 (0.081) loss_x loss_x 0.5732 (0.5410) acc_x 84.3750 (86.8750) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 486
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:335
clean false:38
clean_rate:0.8981233243967829
noisy true:779
noisy false:448
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [179/200] batch [5/11] time 0.209 (0.208) data 0.083 (0.082) loss_x loss_x 1.0957 (0.6811) acc_x 81.2500 (82.5000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/11] time 0.208 (0.207) data 0.081 (0.082) loss_x loss_x 0.2441 (0.5508) acc_x 93.7500 (85.9375) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 475
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 358
clean true:324
clean false:34
clean_rate:0.9050279329608939
noisy true:801
noisy false:441
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1242
epoch [180/200] batch [5/11] time 0.209 (0.207) data 0.083 (0.083) loss_x loss_x 0.2103 (0.4034) acc_x 96.8750 (91.2500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/11] time 0.209 (0.208) data 0.084 (0.083) loss_x loss_x 0.5308 (0.4824) acc_x 84.3750 (89.3750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 498
confident_label rate tensor(0.2287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 366
clean true:332
clean false:34
clean_rate:0.907103825136612
noisy true:770
noisy false:464
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1234
epoch [181/200] batch [5/11] time 0.211 (0.209) data 0.085 (0.085) loss_x loss_x 0.6733 (0.3925) acc_x 84.3750 (91.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/11] time 0.211 (0.209) data 0.083 (0.083) loss_x loss_x 0.5127 (0.4878) acc_x 90.6250 (89.3750) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 492
confident_label rate tensor(0.2319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 371
clean true:334
clean false:37
clean_rate:0.9002695417789758
noisy true:774
noisy false:455
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1229
epoch [182/200] batch [5/11] time 0.210 (0.207) data 0.084 (0.082) loss_x loss_x 0.3770 (0.4971) acc_x 93.7500 (86.8750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/11] time 0.206 (0.207) data 0.081 (0.082) loss_x loss_x 0.5229 (0.4750) acc_x 84.3750 (87.8125) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 474
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:340
clean false:34
clean_rate:0.9090909090909091
noisy true:786
noisy false:440
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [183/200] batch [5/11] time 0.208 (0.212) data 0.085 (0.082) loss_x loss_x 0.3091 (0.5389) acc_x 96.8750 (88.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/11] time 0.211 (0.210) data 0.084 (0.083) loss_x loss_x 0.5977 (0.5026) acc_x 87.5000 (89.0625) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 467
confident_label rate tensor(0.2356, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 377
clean true:339
clean false:38
clean_rate:0.8992042440318302
noisy true:794
noisy false:429
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1223
epoch [184/200] batch [5/11] time 0.208 (0.209) data 0.085 (0.085) loss_x loss_x 0.3381 (0.5163) acc_x 93.7500 (86.8750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/11] time 0.203 (0.208) data 0.078 (0.083) loss_x loss_x 0.4841 (0.4682) acc_x 84.3750 (87.8125) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2387, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 382
clean true:345
clean false:37
clean_rate:0.9031413612565445
noisy true:797
noisy false:421
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1218
epoch [185/200] batch [5/11] time 0.246 (0.196) data 0.080 (0.082) loss_x loss_x 0.2632 (0.6633) acc_x 96.8750 (82.5000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/11] time 0.213 (0.202) data 0.086 (0.082) loss_x loss_x 0.6348 (0.5583) acc_x 84.3750 (84.6875) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:337
clean false:36
clean_rate:0.903485254691689
noisy true:784
noisy false:443
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [186/200] batch [5/11] time 0.158 (0.190) data 0.080 (0.083) loss_x loss_x 0.4749 (0.6324) acc_x 90.6250 (82.5000) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/11] time 0.208 (0.201) data 0.083 (0.083) loss_x loss_x 0.3083 (0.5288) acc_x 90.6250 (85.3125) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 494
confident_label rate tensor(0.2362, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 378
clean true:332
clean false:46
clean_rate:0.8783068783068783
noisy true:774
noisy false:448
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1222
epoch [187/200] batch [5/11] time 0.203 (0.206) data 0.083 (0.083) loss_x loss_x 1.0225 (0.6281) acc_x 75.0000 (85.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/11] time 0.209 (0.207) data 0.086 (0.083) loss_x loss_x 0.4399 (0.5726) acc_x 84.3750 (85.9375) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 487
confident_label rate tensor(0.2319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 371
clean true:339
clean false:32
clean_rate:0.9137466307277629
noisy true:774
noisy false:455
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1229
epoch [188/200] batch [5/11] time 0.206 (0.206) data 0.081 (0.082) loss_x loss_x 0.3604 (0.4660) acc_x 87.5000 (88.1250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/11] time 0.205 (0.206) data 0.081 (0.082) loss_x loss_x 0.5190 (0.4811) acc_x 84.3750 (87.8125) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 504
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 375
clean true:332
clean false:43
clean_rate:0.8853333333333333
noisy true:764
noisy false:461
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1225
epoch [189/200] batch [5/11] time 0.206 (0.199) data 0.085 (0.083) loss_x loss_x 0.5723 (0.4776) acc_x 81.2500 (85.6250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/11] time 0.208 (0.202) data 0.084 (0.082) loss_x loss_x 0.9194 (0.5936) acc_x 84.3750 (85.3125) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 490
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:332
clean false:42
clean_rate:0.8877005347593583
noisy true:778
noisy false:448
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [190/200] batch [5/11] time 0.203 (0.207) data 0.079 (0.083) loss_x loss_x 0.5835 (0.8723) acc_x 81.2500 (81.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/11] time 0.206 (0.206) data 0.083 (0.083) loss_x loss_x 0.4319 (0.6379) acc_x 93.7500 (86.5625) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:329
clean false:38
clean_rate:0.896457765667575
noisy true:787
noisy false:446
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [191/200] batch [5/11] time 0.205 (0.207) data 0.081 (0.082) loss_x loss_x 0.8154 (0.8122) acc_x 81.2500 (80.0000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/11] time 0.172 (0.198) data 0.086 (0.082) loss_x loss_x 0.6509 (0.6635) acc_x 71.8750 (82.8125) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 465
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 379
clean true:342
clean false:37
clean_rate:0.9023746701846965
noisy true:793
noisy false:428
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1221
epoch [192/200] batch [5/11] time 0.210 (0.209) data 0.084 (0.083) loss_x loss_x 0.4207 (0.5656) acc_x 93.7500 (85.0000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/11] time 0.207 (0.208) data 0.083 (0.082) loss_x loss_x 0.5283 (0.5614) acc_x 87.5000 (86.2500) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 505
confident_label rate tensor(0.2319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 371
clean true:333
clean false:38
clean_rate:0.8975741239892183
noisy true:762
noisy false:467
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1229
epoch [193/200] batch [5/11] time 0.208 (0.208) data 0.085 (0.083) loss_x loss_x 0.5781 (0.5770) acc_x 90.6250 (87.5000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/11] time 0.160 (0.203) data 0.084 (0.083) loss_x loss_x 0.5566 (0.5566) acc_x 84.3750 (86.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 484
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:338
clean false:36
clean_rate:0.9037433155080213
noisy true:778
noisy false:448
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [194/200] batch [5/11] time 0.210 (0.211) data 0.081 (0.083) loss_x loss_x 0.5459 (0.4042) acc_x 90.6250 (91.2500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/11] time 0.204 (0.208) data 0.080 (0.082) loss_x loss_x 0.7168 (0.4506) acc_x 84.3750 (89.6875) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 488
confident_label rate tensor(0.2319, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 371
clean true:337
clean false:34
clean_rate:0.9083557951482479
noisy true:775
noisy false:454
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1229
epoch [195/200] batch [5/11] time 0.206 (0.212) data 0.083 (0.084) loss_x loss_x 0.4951 (0.7095) acc_x 87.5000 (84.3750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/11] time 0.211 (0.210) data 0.089 (0.084) loss_x loss_x 0.5786 (0.6121) acc_x 87.5000 (85.3125) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 361
clean true:330
clean false:31
clean_rate:0.9141274238227147
noisy true:791
noisy false:448
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1239
epoch [196/200] batch [5/11] time 0.209 (0.209) data 0.084 (0.085) loss_x loss_x 0.7373 (0.5338) acc_x 84.3750 (86.2500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/11] time 0.205 (0.209) data 0.081 (0.084) loss_x loss_x 0.8804 (0.5159) acc_x 78.1250 (86.8750) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 471
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:338
clean false:36
clean_rate:0.9037433155080213
noisy true:791
noisy false:435
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [197/200] batch [5/11] time 0.206 (0.207) data 0.083 (0.083) loss_x loss_x 0.8599 (0.6446) acc_x 84.3750 (86.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/11] time 0.215 (0.209) data 0.087 (0.083) loss_x loss_x 0.6152 (0.5366) acc_x 81.2500 (87.1875) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 450
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:337
clean false:37
clean_rate:0.9010695187165776
noisy true:813
noisy false:413
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [198/200] batch [5/11] time 0.208 (0.206) data 0.083 (0.083) loss_x loss_x 0.4795 (0.5006) acc_x 87.5000 (87.5000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/11] time 0.208 (0.208) data 0.084 (0.083) loss_x loss_x 0.6523 (0.5664) acc_x 84.3750 (87.1875) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2381, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 381
clean true:343
clean false:38
clean_rate:0.9002624671916011
noisy true:791
noisy false:428
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1219
epoch [199/200] batch [5/11] time 0.207 (0.208) data 0.082 (0.082) loss_x loss_x 0.1525 (0.5898) acc_x 96.8750 (85.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/11] time 0.216 (0.208) data 0.086 (0.083) loss_x loss_x 0.5225 (0.6274) acc_x 87.5000 (84.0625) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 482
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 373
clean true:337
clean false:36
clean_rate:0.903485254691689
noisy true:781
noisy false:446
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1227
epoch [200/200] batch [5/11] time 0.207 (0.208) data 0.082 (0.083) loss_x loss_x 0.5405 (0.4430) acc_x 87.5000 (90.0000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/11] time 0.208 (0.208) data 0.082 (0.083) loss_x loss_x 0.3284 (0.4546) acc_x 93.7500 (90.6250) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,102
* accuracy: 85.3%
* error: 14.7%
* macro_f1: 79.5%
Elapsed: 0:47:52
