***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '100']
output_dir: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: Caltech101
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 100
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: Caltech101
Reading split from /home/convex/datasets/nlprompt/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/caltech-101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 4
Data loader size: 25
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      400
# test     2,465
---------  ----------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 845
confident_label rate tensor(0.1775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 284
clean true:279
clean false:5
clean_rate:0.9823943661971831
noisy true:476
noisy false:840
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 1316
epoch [1/200] batch [5/8] time 0.191 (0.203) data 0.114 (0.107) loss_x loss_x 2.7637 (2.6191) acc_x 59.3750 (65.6250) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 775
confident_label rate tensor(0.1919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 307
clean true:299
clean false:8
clean_rate:0.9739413680781759
noisy true:526
noisy false:767
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 1293
epoch [2/200] batch [5/9] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.8164 (1.3755) acc_x 78.1250 (72.5000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 619
confident_label rate tensor(0.2338, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 374
clean true:367
clean false:7
clean_rate:0.9812834224598931
noisy true:614
noisy false:612
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1226
epoch [3/200] batch [5/11] time 0.175 (0.188) data 0.098 (0.111) loss_x loss_x 0.9995 (1.0560) acc_x 78.1250 (75.6250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/11] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.8813 (0.9868) acc_x 75.0000 (77.5000) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 609
confident_label rate tensor(0.2294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 367
clean true:361
clean false:6
clean_rate:0.9836512261580381
noisy true:630
noisy false:603
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1233
epoch [4/200] batch [5/11] time 0.153 (0.163) data 0.076 (0.086) loss_x loss_x 0.9697 (1.0271) acc_x 75.0000 (73.7500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [10/11] time 0.179 (0.166) data 0.102 (0.089) loss_x loss_x 1.0889 (1.0002) acc_x 71.8750 (74.0625) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 567
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 398
clean true:391
clean false:7
clean_rate:0.9824120603015075
noisy true:642
noisy false:560
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1202
epoch [5/200] batch [5/12] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 1.1045 (1.0837) acc_x 75.0000 (73.1250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/12] time 0.156 (0.176) data 0.079 (0.099) loss_x loss_x 0.9253 (0.9094) acc_x 81.2500 (76.5625) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 527
confident_label rate tensor(0.2619, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 419
clean true:413
clean false:6
clean_rate:0.9856801909307876
noisy true:660
noisy false:521
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1181
epoch [6/200] batch [5/13] time 0.184 (0.206) data 0.107 (0.129) loss_x loss_x 1.2822 (0.8661) acc_x 65.6250 (78.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/13] time 0.169 (0.193) data 0.091 (0.116) loss_x loss_x 1.1055 (0.9116) acc_x 71.8750 (77.5000) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 508
confident_label rate tensor(0.2544, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 407
clean true:403
clean false:4
clean_rate:0.9901719901719902
noisy true:689
noisy false:504
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1193
epoch [7/200] batch [5/12] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.7393 (0.8799) acc_x 75.0000 (74.3750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/12] time 0.177 (0.186) data 0.099 (0.108) loss_x loss_x 0.7324 (0.8792) acc_x 81.2500 (74.6875) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 507
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 425
clean true:424
clean false:1
clean_rate:0.9976470588235294
noisy true:669
noisy false:506
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1175
epoch [8/200] batch [5/13] time 0.182 (0.181) data 0.104 (0.103) loss_x loss_x 0.5522 (0.7559) acc_x 90.6250 (80.6250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/13] time 0.165 (0.179) data 0.088 (0.101) loss_x loss_x 0.7627 (0.7756) acc_x 75.0000 (79.0625) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 501
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 397
clean true:390
clean false:7
clean_rate:0.982367758186398
noisy true:709
noisy false:494
after delete: len(clean_dataset) 397
after delete: len(noisy_dataset) 1203
epoch [9/200] batch [5/12] time 0.160 (0.169) data 0.083 (0.092) loss_x loss_x 0.7119 (0.7883) acc_x 84.3750 (80.0000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/12] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.6519 (0.7498) acc_x 84.3750 (80.3125) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 516
confident_label rate tensor(0.2669, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 427
clean true:421
clean false:6
clean_rate:0.9859484777517564
noisy true:663
noisy false:510
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1173
epoch [10/200] batch [5/13] time 0.170 (0.177) data 0.093 (0.099) loss_x loss_x 1.4023 (1.0062) acc_x 68.7500 (75.0000) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/13] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.5112 (0.9191) acc_x 87.5000 (75.9375) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 492
confident_label rate tensor(0.2687, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 430
clean true:427
clean false:3
clean_rate:0.9930232558139535
noisy true:681
noisy false:489
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1170
epoch [11/200] batch [5/13] time 0.177 (0.171) data 0.100 (0.094) loss_x loss_x 0.7290 (0.8187) acc_x 81.2500 (80.6250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/13] time 0.176 (0.179) data 0.100 (0.101) loss_x loss_x 0.5283 (0.7773) acc_x 84.3750 (81.5625) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 499
confident_label rate tensor(0.2575, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 412
clean true:408
clean false:4
clean_rate:0.9902912621359223
noisy true:693
noisy false:495
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1188
epoch [12/200] batch [5/12] time 0.161 (0.175) data 0.084 (0.098) loss_x loss_x 0.6313 (0.8710) acc_x 84.3750 (80.0000) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/12] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.8159 (0.8925) acc_x 75.0000 (77.5000) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 476
confident_label rate tensor(0.2763, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 442
clean true:436
clean false:6
clean_rate:0.9864253393665159
noisy true:688
noisy false:470
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1158
epoch [13/200] batch [5/13] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.8428 (0.8533) acc_x 75.0000 (76.8750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/13] time 0.159 (0.182) data 0.082 (0.105) loss_x loss_x 0.8877 (0.7939) acc_x 68.7500 (77.5000) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 428
clean true:419
clean false:9
clean_rate:0.9789719626168224
noisy true:726
noisy false:446
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1172
epoch [14/200] batch [5/13] time 0.175 (0.181) data 0.099 (0.104) loss_x loss_x 0.5586 (0.8103) acc_x 84.3750 (76.8750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/13] time 0.200 (0.180) data 0.123 (0.103) loss_x loss_x 0.3027 (0.7729) acc_x 90.6250 (77.5000) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 491
confident_label rate tensor(0.2744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 439
clean true:434
clean false:5
clean_rate:0.9886104783599089
noisy true:675
noisy false:486
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1161
epoch [15/200] batch [5/13] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.6909 (0.7644) acc_x 84.3750 (80.6250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/13] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.7319 (0.7260) acc_x 81.2500 (80.9375) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 466
confident_label rate tensor(0.2694, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 431
clean true:426
clean false:5
clean_rate:0.988399071925754
noisy true:708
noisy false:461
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1169
epoch [16/200] batch [5/13] time 0.161 (0.176) data 0.084 (0.098) loss_x loss_x 0.7896 (0.8085) acc_x 78.1250 (80.0000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/13] time 0.199 (0.182) data 0.121 (0.105) loss_x loss_x 0.5454 (0.7399) acc_x 87.5000 (83.4375) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 464
confident_label rate tensor(0.2706, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 433
clean true:425
clean false:8
clean_rate:0.9815242494226328
noisy true:711
noisy false:456
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1167
epoch [17/200] batch [5/13] time 0.175 (0.187) data 0.097 (0.110) loss_x loss_x 0.3782 (0.8849) acc_x 90.6250 (76.8750) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/13] time 0.166 (0.176) data 0.090 (0.098) loss_x loss_x 0.3918 (0.8864) acc_x 93.7500 (77.1875) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 469
confident_label rate tensor(0.2731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 437
clean true:432
clean false:5
clean_rate:0.988558352402746
noisy true:699
noisy false:464
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1163
epoch [18/200] batch [5/13] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.6626 (0.8373) acc_x 78.1250 (76.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/13] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.6060 (0.8261) acc_x 84.3750 (78.1250) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2712, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 434
clean true:431
clean false:3
clean_rate:0.9930875576036866
noisy true:690
noisy false:476
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1166
epoch [19/200] batch [5/13] time 0.177 (0.187) data 0.100 (0.110) loss_x loss_x 0.5312 (0.7370) acc_x 87.5000 (80.6250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/13] time 0.168 (0.185) data 0.091 (0.108) loss_x loss_x 0.8706 (0.6993) acc_x 71.8750 (81.5625) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 455
confident_label rate tensor(0.2825, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 452
clean true:445
clean false:7
clean_rate:0.9845132743362832
noisy true:700
noisy false:448
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1148
epoch [20/200] batch [5/14] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.5996 (0.6710) acc_x 84.3750 (85.6250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/14] time 0.156 (0.169) data 0.080 (0.092) loss_x loss_x 0.7148 (0.7429) acc_x 78.1250 (81.5625) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 489
confident_label rate tensor(0.2763, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 442
clean true:437
clean false:5
clean_rate:0.9886877828054299
noisy true:674
noisy false:484
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1158
epoch [21/200] batch [5/13] time 0.164 (0.169) data 0.086 (0.091) loss_x loss_x 0.8975 (0.8121) acc_x 81.2500 (79.3750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/13] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.9482 (0.7865) acc_x 78.1250 (80.0000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 477
confident_label rate tensor(0.2744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 439
clean true:433
clean false:6
clean_rate:0.9863325740318907
noisy true:690
noisy false:471
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1161
epoch [22/200] batch [5/13] time 0.188 (0.183) data 0.110 (0.105) loss_x loss_x 1.2764 (0.9243) acc_x 75.0000 (78.1250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/13] time 0.181 (0.183) data 0.103 (0.105) loss_x loss_x 0.6421 (0.7546) acc_x 84.3750 (80.0000) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 446
clean true:443
clean false:3
clean_rate:0.9932735426008968
noisy true:734
noisy false:420
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1154
epoch [23/200] batch [5/13] time 0.170 (0.179) data 0.092 (0.102) loss_x loss_x 0.8218 (0.5708) acc_x 75.0000 (85.6250) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/13] time 0.212 (0.184) data 0.135 (0.107) loss_x loss_x 1.2207 (0.7598) acc_x 68.7500 (80.9375) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 479
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 428
clean true:423
clean false:5
clean_rate:0.9883177570093458
noisy true:698
noisy false:474
after delete: len(clean_dataset) 428
after delete: len(noisy_dataset) 1172
epoch [24/200] batch [5/13] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 0.7544 (0.7644) acc_x 78.1250 (78.1250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/13] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.6470 (0.7610) acc_x 71.8750 (75.6250) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:459
clean false:9
clean_rate:0.9807692307692307
noisy true:692
noisy false:440
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [25/200] batch [5/14] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.8726 (0.8167) acc_x 84.3750 (79.3750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/14] time 0.167 (0.183) data 0.090 (0.106) loss_x loss_x 0.9766 (0.7539) acc_x 71.8750 (80.0000) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 456
confident_label rate tensor(0.2775, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 444
clean true:436
clean false:8
clean_rate:0.9819819819819819
noisy true:708
noisy false:448
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1156
epoch [26/200] batch [5/13] time 0.167 (0.182) data 0.090 (0.106) loss_x loss_x 0.3733 (0.6314) acc_x 87.5000 (84.3750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/13] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.8154 (0.8312) acc_x 81.2500 (81.2500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 470
confident_label rate tensor(0.2744, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 439
clean true:436
clean false:3
clean_rate:0.9931662870159453
noisy true:694
noisy false:467
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1161
epoch [27/200] batch [5/13] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 1.2324 (0.6805) acc_x 68.7500 (81.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/13] time 0.189 (0.184) data 0.113 (0.107) loss_x loss_x 0.6841 (0.6599) acc_x 75.0000 (81.5625) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 450
clean true:447
clean false:3
clean_rate:0.9933333333333333
noisy true:729
noisy false:421
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1150
epoch [28/200] batch [5/14] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.6470 (0.8103) acc_x 75.0000 (75.6250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/14] time 0.167 (0.178) data 0.089 (0.101) loss_x loss_x 0.5903 (0.7505) acc_x 78.1250 (77.1875) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 453
confident_label rate tensor(0.2831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 453
clean true:447
clean false:6
clean_rate:0.9867549668874173
noisy true:700
noisy false:447
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1147
epoch [29/200] batch [5/14] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 1.2051 (0.7050) acc_x 78.1250 (83.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/14] time 0.164 (0.172) data 0.087 (0.094) loss_x loss_x 0.5625 (0.6313) acc_x 87.5000 (84.0625) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.2769, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 443
clean true:438
clean false:5
clean_rate:0.9887133182844243
noisy true:711
noisy false:446
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1157
epoch [30/200] batch [5/13] time 0.194 (0.187) data 0.117 (0.110) loss_x loss_x 1.0830 (0.6872) acc_x 62.5000 (80.6250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/13] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.7319 (0.7099) acc_x 78.1250 (79.3750) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.2875, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 460
clean true:455
clean false:5
clean_rate:0.9891304347826086
noisy true:723
noisy false:417
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1140
epoch [31/200] batch [5/14] time 0.171 (0.184) data 0.094 (0.106) loss_x loss_x 0.6675 (0.8841) acc_x 84.3750 (75.6250) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/14] time 0.205 (0.183) data 0.128 (0.106) loss_x loss_x 0.6743 (0.7773) acc_x 81.2500 (79.6875) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 446
clean true:442
clean false:4
clean_rate:0.9910313901345291
noisy true:713
noisy false:441
after delete: len(clean_dataset) 446
after delete: len(noisy_dataset) 1154
epoch [32/200] batch [5/13] time 0.169 (0.159) data 0.092 (0.082) loss_x loss_x 0.5093 (0.6410) acc_x 87.5000 (85.0000) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/13] time 0.193 (0.169) data 0.115 (0.092) loss_x loss_x 0.4246 (0.7247) acc_x 90.6250 (81.8750) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 468
confident_label rate tensor(0.2738, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 438
clean true:435
clean false:3
clean_rate:0.9931506849315068
noisy true:697
noisy false:465
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1162
epoch [33/200] batch [5/13] time 0.160 (0.165) data 0.083 (0.088) loss_x loss_x 0.9551 (0.7907) acc_x 78.1250 (80.6250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/13] time 0.209 (0.171) data 0.132 (0.093) loss_x loss_x 0.6372 (0.7581) acc_x 87.5000 (81.2500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 449
clean true:442
clean false:7
clean_rate:0.9844097995545658
noisy true:722
noisy false:429
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1151
epoch [34/200] batch [5/14] time 0.181 (0.188) data 0.103 (0.110) loss_x loss_x 0.5308 (0.7131) acc_x 90.6250 (78.1250) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/14] time 0.168 (0.182) data 0.091 (0.104) loss_x loss_x 0.8257 (0.8241) acc_x 81.2500 (78.1250) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 463
confident_label rate tensor(0.2731, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 437
clean true:432
clean false:5
clean_rate:0.988558352402746
noisy true:705
noisy false:458
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1163
epoch [35/200] batch [5/13] time 0.177 (0.179) data 0.100 (0.101) loss_x loss_x 0.8789 (0.6952) acc_x 84.3750 (82.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/13] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.5195 (0.6914) acc_x 87.5000 (81.8750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 458
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 449
clean true:443
clean false:6
clean_rate:0.9866369710467706
noisy true:699
noisy false:452
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1151
epoch [36/200] batch [5/14] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.8281 (0.7863) acc_x 81.2500 (80.0000) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/14] time 0.166 (0.179) data 0.088 (0.102) loss_x loss_x 0.5498 (0.7353) acc_x 84.3750 (80.9375) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 451
clean true:448
clean false:3
clean_rate:0.9933481152993349
noisy true:707
noisy false:442
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1149
epoch [37/200] batch [5/14] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 1.3486 (0.7817) acc_x 78.1250 (81.2500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/14] time 0.182 (0.185) data 0.106 (0.107) loss_x loss_x 0.7451 (0.7392) acc_x 81.2500 (81.2500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 473
clean true:464
clean false:9
clean_rate:0.9809725158562368
noisy true:708
noisy false:419
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1127
epoch [38/200] batch [5/14] time 0.176 (0.181) data 0.100 (0.104) loss_x loss_x 0.9624 (0.8876) acc_x 78.1250 (78.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/14] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.3699 (0.7534) acc_x 93.7500 (80.9375) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2794, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 447
clean true:445
clean false:2
clean_rate:0.9955257270693513
noisy true:695
noisy false:458
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1153
epoch [39/200] batch [5/13] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.3823 (0.6793) acc_x 87.5000 (81.2500) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/13] time 0.202 (0.182) data 0.125 (0.105) loss_x loss_x 1.0156 (0.7226) acc_x 75.0000 (79.0625) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 457
confident_label rate tensor(0.2844, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 455
clean true:447
clean false:8
clean_rate:0.9824175824175824
noisy true:696
noisy false:449
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1145
epoch [40/200] batch [5/14] time 0.176 (0.168) data 0.099 (0.091) loss_x loss_x 1.3223 (0.9057) acc_x 59.3750 (75.6250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/14] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.8237 (0.8026) acc_x 81.2500 (79.0625) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.2931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 469
clean true:463
clean false:6
clean_rate:0.9872068230277186
noisy true:741
noisy false:390
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 1131
epoch [41/200] batch [5/14] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.8003 (0.7094) acc_x 78.1250 (78.1250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/14] time 0.174 (0.174) data 0.097 (0.096) loss_x loss_x 0.5381 (0.6198) acc_x 81.2500 (82.5000) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:463
clean false:5
clean_rate:0.9893162393162394
noisy true:707
noisy false:425
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [42/200] batch [5/14] time 0.173 (0.168) data 0.096 (0.091) loss_x loss_x 0.5693 (0.7001) acc_x 78.1250 (79.3750) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/14] time 0.181 (0.173) data 0.103 (0.096) loss_x loss_x 1.1455 (0.7239) acc_x 65.6250 (80.3125) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 448
confident_label rate tensor(0.2881, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 461
clean true:457
clean false:4
clean_rate:0.9913232104121475
noisy true:695
noisy false:444
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1139
epoch [43/200] batch [5/14] time 0.233 (0.200) data 0.157 (0.122) loss_x loss_x 0.6499 (0.5609) acc_x 81.2500 (84.3750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/14] time 0.187 (0.190) data 0.110 (0.112) loss_x loss_x 1.2373 (0.6712) acc_x 62.5000 (80.3125) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 445
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 454
clean true:446
clean false:8
clean_rate:0.9823788546255506
noisy true:709
noisy false:437
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1146
epoch [44/200] batch [5/14] time 0.174 (0.194) data 0.096 (0.117) loss_x loss_x 0.2937 (0.6895) acc_x 96.8750 (80.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/14] time 0.160 (0.186) data 0.083 (0.109) loss_x loss_x 0.6753 (0.6942) acc_x 81.2500 (83.1250) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.2869, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 459
clean true:457
clean false:2
clean_rate:0.9956427015250545
noisy true:710
noisy false:431
after delete: len(clean_dataset) 459
after delete: len(noisy_dataset) 1141
epoch [45/200] batch [5/14] time 0.156 (0.169) data 0.080 (0.092) loss_x loss_x 1.2197 (0.6233) acc_x 81.2500 (86.2500) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/14] time 0.181 (0.173) data 0.105 (0.096) loss_x loss_x 0.8267 (0.6480) acc_x 68.7500 (83.1250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:471
clean false:8
clean_rate:0.9832985386221295
noisy true:702
noisy false:419
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [46/200] batch [5/14] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.4692 (0.6749) acc_x 90.6250 (79.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/14] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.3340 (0.6181) acc_x 93.7500 (83.1250) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 449
confident_label rate tensor(0.2906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 465
clean true:455
clean false:10
clean_rate:0.978494623655914
noisy true:696
noisy false:439
after delete: len(clean_dataset) 465
after delete: len(noisy_dataset) 1135
epoch [47/200] batch [5/14] time 0.185 (0.173) data 0.108 (0.096) loss_x loss_x 0.6948 (0.8514) acc_x 81.2500 (77.5000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/14] time 0.190 (0.178) data 0.113 (0.101) loss_x loss_x 0.7173 (0.8449) acc_x 75.0000 (77.1875) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:463
clean false:5
clean_rate:0.9893162393162394
noisy true:697
noisy false:435
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [48/200] batch [5/14] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.5864 (0.6354) acc_x 84.3750 (81.8750) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/14] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.6323 (0.6660) acc_x 81.2500 (81.5625) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3006, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 481
clean true:472
clean false:9
clean_rate:0.9812889812889813
noisy true:698
noisy false:421
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1119
epoch [49/200] batch [5/15] time 0.164 (0.172) data 0.087 (0.094) loss_x loss_x 0.6855 (0.6860) acc_x 84.3750 (81.8750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/15] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.7412 (0.7344) acc_x 84.3750 (81.2500) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [15/15] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 1.1133 (0.7877) acc_x 71.8750 (80.2083) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.2962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 474
clean true:469
clean false:5
clean_rate:0.989451476793249
noisy true:714
noisy false:412
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1126
epoch [50/200] batch [5/14] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6045 (0.6979) acc_x 84.3750 (83.1250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/14] time 0.181 (0.180) data 0.103 (0.103) loss_x loss_x 0.7085 (0.6746) acc_x 81.2500 (83.4375) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.2969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 475
clean true:469
clean false:6
clean_rate:0.9873684210526316
noisy true:722
noisy false:403
after delete: len(clean_dataset) 475
after delete: len(noisy_dataset) 1125
epoch [51/200] batch [5/14] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.9658 (0.7074) acc_x 75.0000 (81.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/14] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.3386 (0.7397) acc_x 90.6250 (80.3125) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:486
clean false:8
clean_rate:0.9838056680161943
noisy true:696
noisy false:410
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [52/200] batch [5/15] time 0.170 (0.177) data 0.092 (0.099) loss_x loss_x 0.4182 (0.6443) acc_x 84.3750 (82.5000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/15] time 0.177 (0.175) data 0.099 (0.098) loss_x loss_x 0.9116 (0.7866) acc_x 84.3750 (80.0000) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [15/15] time 0.177 (0.178) data 0.100 (0.100) loss_x loss_x 0.9404 (0.8016) acc_x 81.2500 (80.2083) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 442
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:464
clean false:7
clean_rate:0.9851380042462845
noisy true:694
noisy false:435
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [53/200] batch [5/14] time 0.161 (0.171) data 0.083 (0.094) loss_x loss_x 0.7144 (0.6284) acc_x 84.3750 (83.1250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/14] time 0.169 (0.169) data 0.090 (0.091) loss_x loss_x 0.5181 (0.6045) acc_x 90.6250 (84.3750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 443
confident_label rate tensor(0.2831, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 453
clean true:447
clean false:6
clean_rate:0.9867549668874173
noisy true:710
noisy false:437
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1147
epoch [54/200] batch [5/14] time 0.179 (0.186) data 0.102 (0.108) loss_x loss_x 0.5190 (0.5291) acc_x 87.5000 (88.1250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/14] time 0.181 (0.182) data 0.103 (0.105) loss_x loss_x 0.3413 (0.5508) acc_x 90.6250 (85.6250) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.2931, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 469
clean true:463
clean false:6
clean_rate:0.9872068230277186
noisy true:700
noisy false:431
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 1131
epoch [55/200] batch [5/14] time 0.191 (0.182) data 0.113 (0.105) loss_x loss_x 0.7974 (0.7782) acc_x 84.3750 (81.2500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/14] time 0.179 (0.179) data 0.101 (0.101) loss_x loss_x 0.4917 (0.6875) acc_x 81.2500 (81.5625) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:463
clean false:5
clean_rate:0.9893162393162394
noisy true:721
noisy false:411
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [56/200] batch [5/14] time 0.172 (0.182) data 0.095 (0.106) loss_x loss_x 0.1974 (0.6528) acc_x 93.7500 (81.8750) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/14] time 0.177 (0.181) data 0.098 (0.104) loss_x loss_x 0.7188 (0.6338) acc_x 75.0000 (82.1875) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.2969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 475
clean true:467
clean false:8
clean_rate:0.9831578947368421
noisy true:705
noisy false:420
after delete: len(clean_dataset) 475
after delete: len(noisy_dataset) 1125
epoch [57/200] batch [5/14] time 0.175 (0.165) data 0.098 (0.088) loss_x loss_x 0.8267 (0.5653) acc_x 71.8750 (83.1250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/14] time 0.158 (0.170) data 0.080 (0.093) loss_x loss_x 0.4165 (0.6031) acc_x 90.6250 (83.7500) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3000, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 480
clean true:472
clean false:8
clean_rate:0.9833333333333333
noisy true:698
noisy false:422
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1120
epoch [58/200] batch [5/15] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.6025 (0.5203) acc_x 84.3750 (88.1250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/15] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.4958 (0.5323) acc_x 87.5000 (85.9375) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [15/15] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.7549 (0.6355) acc_x 81.2500 (83.7500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 454
confident_label rate tensor(0.2862, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 458
clean true:455
clean false:3
clean_rate:0.9934497816593887
noisy true:691
noisy false:451
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1142
epoch [59/200] batch [5/14] time 0.208 (0.197) data 0.131 (0.120) loss_x loss_x 0.7266 (0.7233) acc_x 78.1250 (80.6250) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/14] time 0.167 (0.185) data 0.090 (0.108) loss_x loss_x 0.6128 (0.6799) acc_x 81.2500 (80.0000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 473
clean true:466
clean false:7
clean_rate:0.985200845665962
noisy true:711
noisy false:416
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1127
epoch [60/200] batch [5/14] time 0.174 (0.175) data 0.095 (0.098) loss_x loss_x 0.5537 (0.6733) acc_x 84.3750 (82.5000) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/14] time 0.169 (0.181) data 0.092 (0.103) loss_x loss_x 0.8438 (0.6167) acc_x 78.1250 (84.6875) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 460
confident_label rate tensor(0.2925, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 468
clean true:464
clean false:4
clean_rate:0.9914529914529915
noisy true:676
noisy false:456
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1132
epoch [61/200] batch [5/14] time 0.187 (0.203) data 0.110 (0.126) loss_x loss_x 0.4976 (0.5829) acc_x 90.6250 (85.6250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/14] time 0.185 (0.192) data 0.106 (0.115) loss_x loss_x 0.6733 (0.6779) acc_x 78.1250 (83.4375) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 452
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:471
clean false:8
clean_rate:0.9832985386221295
noisy true:677
noisy false:444
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [62/200] batch [5/14] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.4990 (0.4112) acc_x 84.3750 (86.2500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/14] time 0.180 (0.172) data 0.103 (0.095) loss_x loss_x 0.8608 (0.5117) acc_x 75.0000 (85.3125) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.2962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 474
clean true:466
clean false:8
clean_rate:0.9831223628691983
noisy true:697
noisy false:429
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1126
epoch [63/200] batch [5/14] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.5386 (0.6847) acc_x 84.3750 (83.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/14] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.6069 (0.7147) acc_x 81.2500 (81.5625) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 470
clean true:461
clean false:9
clean_rate:0.9808510638297873
noisy true:710
noisy false:420
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1130
epoch [64/200] batch [5/14] time 0.190 (0.195) data 0.112 (0.118) loss_x loss_x 0.6406 (0.5275) acc_x 84.3750 (84.3750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/14] time 0.174 (0.182) data 0.096 (0.105) loss_x loss_x 0.6138 (0.5906) acc_x 84.3750 (85.0000) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 444
confident_label rate tensor(0.2906, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 465
clean true:459
clean false:6
clean_rate:0.9870967741935484
noisy true:697
noisy false:438
after delete: len(clean_dataset) 465
after delete: len(noisy_dataset) 1135
epoch [65/200] batch [5/14] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.7012 (0.5110) acc_x 81.2500 (85.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/14] time 0.168 (0.181) data 0.090 (0.104) loss_x loss_x 0.7905 (0.6712) acc_x 71.8750 (81.8750) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 437
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 483
clean true:474
clean false:9
clean_rate:0.9813664596273292
noisy true:689
noisy false:428
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1117
epoch [66/200] batch [5/15] time 0.170 (0.185) data 0.093 (0.108) loss_x loss_x 0.5566 (0.4509) acc_x 84.3750 (87.5000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/15] time 0.188 (0.189) data 0.111 (0.112) loss_x loss_x 0.7373 (0.5929) acc_x 81.2500 (83.1250) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [15/15] time 0.167 (0.184) data 0.090 (0.107) loss_x loss_x 0.6230 (0.6345) acc_x 87.5000 (81.6667) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:463
clean false:8
clean_rate:0.9830148619957537
noisy true:709
noisy false:420
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [67/200] batch [5/14] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.4319 (0.6176) acc_x 90.6250 (86.8750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/14] time 0.165 (0.176) data 0.087 (0.098) loss_x loss_x 0.5840 (0.6528) acc_x 84.3750 (85.9375) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 451
confident_label rate tensor(0.2900, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 464
clean true:458
clean false:6
clean_rate:0.9870689655172413
noisy true:691
noisy false:445
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1136
epoch [68/200] batch [5/14] time 0.162 (0.172) data 0.085 (0.095) loss_x loss_x 0.5713 (0.5846) acc_x 84.3750 (86.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/14] time 0.184 (0.174) data 0.107 (0.096) loss_x loss_x 0.8047 (0.6307) acc_x 81.2500 (84.6875) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.2919, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 467
clean true:460
clean false:7
clean_rate:0.9850107066381156
noisy true:709
noisy false:424
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1133
epoch [69/200] batch [5/14] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.7178 (0.6507) acc_x 75.0000 (81.2500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/14] time 0.177 (0.169) data 0.101 (0.092) loss_x loss_x 0.3762 (0.6004) acc_x 90.6250 (84.0625) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.2950, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 472
clean true:467
clean false:5
clean_rate:0.989406779661017
noisy true:714
noisy false:414
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1128
epoch [70/200] batch [5/14] time 0.167 (0.171) data 0.091 (0.093) loss_x loss_x 0.5903 (0.5837) acc_x 84.3750 (86.8750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/14] time 0.178 (0.174) data 0.101 (0.096) loss_x loss_x 0.7495 (0.5506) acc_x 81.2500 (87.1875) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:474
clean false:11
clean_rate:0.977319587628866
noisy true:701
noisy false:414
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [71/200] batch [5/15] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.7231 (0.6522) acc_x 78.1250 (82.5000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/15] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.7280 (0.6883) acc_x 81.2500 (82.1875) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [15/15] time 0.178 (0.177) data 0.101 (0.099) loss_x loss_x 0.3889 (0.6750) acc_x 93.7500 (82.5000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.2981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 477
clean true:471
clean false:6
clean_rate:0.9874213836477987
noisy true:701
noisy false:422
after delete: len(clean_dataset) 477
after delete: len(noisy_dataset) 1123
epoch [72/200] batch [5/14] time 0.171 (0.167) data 0.094 (0.090) loss_x loss_x 0.5864 (0.4825) acc_x 81.2500 (86.8750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/14] time 0.175 (0.170) data 0.099 (0.093) loss_x loss_x 0.5591 (0.6040) acc_x 84.3750 (84.6875) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:487
clean false:1
clean_rate:0.9979508196721312
noisy true:694
noisy false:418
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [73/200] batch [5/15] time 0.179 (0.167) data 0.102 (0.089) loss_x loss_x 0.5811 (0.5367) acc_x 78.1250 (82.5000) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/15] time 0.187 (0.175) data 0.109 (0.097) loss_x loss_x 0.3345 (0.5940) acc_x 90.6250 (81.8750) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [15/15] time 0.211 (0.177) data 0.133 (0.099) loss_x loss_x 0.7075 (0.6404) acc_x 84.3750 (81.2500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.2962, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 474
clean true:468
clean false:6
clean_rate:0.9873417721518988
noisy true:708
noisy false:418
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1126
epoch [74/200] batch [5/14] time 0.187 (0.194) data 0.109 (0.117) loss_x loss_x 0.2437 (0.5602) acc_x 96.8750 (83.7500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/14] time 0.186 (0.197) data 0.108 (0.120) loss_x loss_x 0.5771 (0.5192) acc_x 84.3750 (85.3125) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.2969, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 475
clean true:469
clean false:6
clean_rate:0.9873684210526316
noisy true:710
noisy false:415
after delete: len(clean_dataset) 475
after delete: len(noisy_dataset) 1125
epoch [75/200] batch [5/14] time 0.183 (0.185) data 0.107 (0.107) loss_x loss_x 0.4749 (0.5414) acc_x 84.3750 (85.6250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/14] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.6284 (0.7439) acc_x 87.5000 (80.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:476
clean false:9
clean_rate:0.9814432989690721
noisy true:720
noisy false:395
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [76/200] batch [5/15] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5117 (0.5970) acc_x 84.3750 (83.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/15] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.5303 (0.6187) acc_x 84.3750 (82.8125) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [15/15] time 0.188 (0.182) data 0.109 (0.104) loss_x loss_x 0.5166 (0.6085) acc_x 87.5000 (84.1667) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.3012, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 482
clean true:478
clean false:4
clean_rate:0.991701244813278
noisy true:699
noisy false:419
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1118
epoch [77/200] batch [5/15] time 0.174 (0.192) data 0.097 (0.115) loss_x loss_x 0.5044 (0.6685) acc_x 90.6250 (83.1250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/15] time 0.176 (0.185) data 0.099 (0.108) loss_x loss_x 0.5933 (0.7176) acc_x 81.2500 (81.5625) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [15/15] time 0.168 (0.182) data 0.091 (0.104) loss_x loss_x 0.8037 (0.6721) acc_x 84.3750 (82.5000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 484
clean true:475
clean false:9
clean_rate:0.981404958677686
noisy true:701
noisy false:415
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1116
epoch [78/200] batch [5/15] time 0.222 (0.194) data 0.145 (0.117) loss_x loss_x 0.6255 (0.5330) acc_x 78.1250 (85.0000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/15] time 0.200 (0.191) data 0.123 (0.114) loss_x loss_x 0.4302 (0.4845) acc_x 81.2500 (85.6250) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [15/15] time 0.163 (0.185) data 0.086 (0.107) loss_x loss_x 0.5806 (0.5697) acc_x 84.3750 (85.2083) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 483
clean true:476
clean false:7
clean_rate:0.9855072463768116
noisy true:693
noisy false:424
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1117
epoch [79/200] batch [5/15] time 0.169 (0.174) data 0.091 (0.097) loss_x loss_x 0.5088 (0.5451) acc_x 90.6250 (85.6250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/15] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.9858 (0.5876) acc_x 71.8750 (85.0000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [15/15] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.6133 (0.5930) acc_x 84.3750 (84.7917) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:476
clean false:9
clean_rate:0.9814432989690721
noisy true:705
noisy false:410
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [80/200] batch [5/15] time 0.173 (0.173) data 0.096 (0.095) loss_x loss_x 0.5269 (0.7336) acc_x 81.2500 (80.6250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/15] time 0.169 (0.173) data 0.092 (0.095) loss_x loss_x 0.2137 (0.6351) acc_x 96.8750 (84.0625) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [15/15] time 0.172 (0.173) data 0.094 (0.095) loss_x loss_x 0.3347 (0.5879) acc_x 90.6250 (86.0417) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 440
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:472
clean false:7
clean_rate:0.9853862212943633
noisy true:688
noisy false:433
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [81/200] batch [5/14] time 0.188 (0.193) data 0.110 (0.116) loss_x loss_x 0.4856 (0.6069) acc_x 90.6250 (83.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/14] time 0.157 (0.183) data 0.080 (0.106) loss_x loss_x 0.4568 (0.5887) acc_x 87.5000 (84.3750) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3025, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 484
clean true:476
clean false:8
clean_rate:0.9834710743801653
noisy true:711
noisy false:405
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1116
epoch [82/200] batch [5/15] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.6060 (0.5529) acc_x 84.3750 (86.2500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/15] time 0.170 (0.183) data 0.092 (0.106) loss_x loss_x 0.5889 (0.5609) acc_x 81.2500 (85.0000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [15/15] time 0.173 (0.178) data 0.096 (0.100) loss_x loss_x 0.4915 (0.5243) acc_x 84.3750 (85.2083) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.2981, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 477
clean true:469
clean false:8
clean_rate:0.9832285115303984
noisy true:702
noisy false:421
after delete: len(clean_dataset) 477
after delete: len(noisy_dataset) 1123
epoch [83/200] batch [5/14] time 0.186 (0.181) data 0.110 (0.104) loss_x loss_x 0.3972 (0.6751) acc_x 93.7500 (86.8750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/14] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.5122 (0.5670) acc_x 87.5000 (87.8125) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3037, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 486
clean true:478
clean false:8
clean_rate:0.9835390946502057
noisy true:691
noisy false:423
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1114
epoch [84/200] batch [5/15] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.5005 (0.7004) acc_x 90.6250 (82.5000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/15] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 1.0400 (0.7098) acc_x 68.7500 (81.8750) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [15/15] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.9868 (0.6761) acc_x 78.1250 (83.1250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:495
clean false:8
clean_rate:0.9840954274353877
noisy true:704
noisy false:393
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [85/200] batch [5/15] time 0.183 (0.177) data 0.105 (0.100) loss_x loss_x 0.6577 (0.7182) acc_x 87.5000 (81.2500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/15] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.9141 (0.6559) acc_x 84.3750 (83.1250) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [15/15] time 0.170 (0.179) data 0.092 (0.102) loss_x loss_x 1.0459 (0.6359) acc_x 75.0000 (84.1667) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.2944, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 471
clean true:461
clean false:10
clean_rate:0.9787685774946921
noisy true:700
noisy false:429
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1129
epoch [86/200] batch [5/14] time 0.159 (0.178) data 0.083 (0.101) loss_x loss_x 0.6436 (0.6070) acc_x 71.8750 (80.6250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/14] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 1.0059 (0.5655) acc_x 84.3750 (84.6875) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 439
confident_label rate tensor(0.3031, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 485
clean true:476
clean false:9
clean_rate:0.9814432989690721
noisy true:685
noisy false:430
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1115
epoch [87/200] batch [5/15] time 0.171 (0.183) data 0.092 (0.106) loss_x loss_x 1.0859 (0.7278) acc_x 81.2500 (85.6250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/15] time 0.173 (0.181) data 0.095 (0.104) loss_x loss_x 0.2925 (0.6452) acc_x 90.6250 (84.0625) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [15/15] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.4438 (0.6298) acc_x 96.8750 (84.1667) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:484
clean false:8
clean_rate:0.983739837398374
noisy true:704
noisy false:404
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [88/200] batch [5/15] time 0.180 (0.195) data 0.103 (0.117) loss_x loss_x 0.8125 (0.7339) acc_x 81.2500 (81.8750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/15] time 0.176 (0.187) data 0.099 (0.110) loss_x loss_x 0.3250 (0.6516) acc_x 93.7500 (83.7500) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [15/15] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.4207 (0.6617) acc_x 84.3750 (83.5417) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:493
clean false:12
clean_rate:0.9762376237623762
noisy true:682
noisy false:413
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [89/200] batch [5/15] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.5723 (0.7637) acc_x 90.6250 (81.8750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/15] time 0.185 (0.172) data 0.108 (0.095) loss_x loss_x 0.3721 (0.6190) acc_x 87.5000 (84.3750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [15/15] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.9092 (0.6835) acc_x 78.1250 (82.5000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 438
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:482
clean false:10
clean_rate:0.9796747967479674
noisy true:680
noisy false:428
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [90/200] batch [5/15] time 0.167 (0.171) data 0.089 (0.094) loss_x loss_x 0.3779 (0.6174) acc_x 90.6250 (85.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/15] time 0.173 (0.173) data 0.096 (0.095) loss_x loss_x 0.5469 (0.5363) acc_x 84.3750 (86.8750) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [15/15] time 0.175 (0.173) data 0.097 (0.095) loss_x loss_x 0.8252 (0.5896) acc_x 81.2500 (85.6250) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 432
confident_label rate tensor(0.3094, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 495
clean true:490
clean false:5
clean_rate:0.98989898989899
noisy true:678
noisy false:427
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1105
epoch [91/200] batch [5/15] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.4473 (0.4635) acc_x 87.5000 (85.6250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/15] time 0.180 (0.179) data 0.102 (0.101) loss_x loss_x 0.5020 (0.6368) acc_x 78.1250 (82.5000) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [15/15] time 0.221 (0.179) data 0.144 (0.102) loss_x loss_x 0.5308 (0.6808) acc_x 81.2500 (81.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 492
clean true:482
clean false:10
clean_rate:0.9796747967479674
noisy true:703
noisy false:405
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1108
epoch [92/200] batch [5/15] time 0.196 (0.191) data 0.120 (0.114) loss_x loss_x 0.6733 (0.4712) acc_x 84.3750 (90.0000) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/15] time 0.214 (0.194) data 0.137 (0.117) loss_x loss_x 0.7314 (0.5417) acc_x 78.1250 (87.1875) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [15/15] time 0.177 (0.186) data 0.100 (0.109) loss_x loss_x 0.7021 (0.5981) acc_x 78.1250 (85.2083) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.3219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 515
clean true:501
clean false:14
clean_rate:0.9728155339805825
noisy true:698
noisy false:387
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1085
epoch [93/200] batch [5/16] time 0.170 (0.182) data 0.093 (0.104) loss_x loss_x 0.5005 (0.6668) acc_x 87.5000 (82.5000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/16] time 0.164 (0.179) data 0.087 (0.102) loss_x loss_x 0.2468 (0.6073) acc_x 96.8750 (84.0625) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/16] time 0.166 (0.179) data 0.089 (0.101) loss_x loss_x 0.5596 (0.6166) acc_x 84.3750 (84.7917) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3056, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 489
clean true:481
clean false:8
clean_rate:0.983640081799591
noisy true:686
noisy false:425
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1111
epoch [94/200] batch [5/15] time 0.202 (0.199) data 0.126 (0.123) loss_x loss_x 0.8188 (0.7207) acc_x 78.1250 (82.5000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/15] time 0.181 (0.196) data 0.104 (0.119) loss_x loss_x 0.4543 (0.6529) acc_x 93.7500 (84.0625) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [15/15] time 0.178 (0.188) data 0.100 (0.111) loss_x loss_x 0.4292 (0.6597) acc_x 87.5000 (83.3333) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 493
clean true:483
clean false:10
clean_rate:0.9797160243407708
noisy true:692
noisy false:415
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1107
epoch [95/200] batch [5/15] time 0.189 (0.186) data 0.111 (0.109) loss_x loss_x 0.6147 (0.4896) acc_x 84.3750 (86.2500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/15] time 0.166 (0.184) data 0.089 (0.107) loss_x loss_x 0.7246 (0.5741) acc_x 78.1250 (83.4375) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [15/15] time 0.158 (0.177) data 0.081 (0.100) loss_x loss_x 0.5430 (0.5354) acc_x 81.2500 (84.3750) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:487
clean false:13
clean_rate:0.974
noisy true:693
noisy false:407
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [96/200] batch [5/15] time 0.170 (0.197) data 0.092 (0.119) loss_x loss_x 0.3999 (0.7025) acc_x 87.5000 (81.8750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/15] time 0.184 (0.188) data 0.106 (0.111) loss_x loss_x 0.4961 (0.6984) acc_x 90.6250 (80.6250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [15/15] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.8281 (0.6491) acc_x 81.2500 (82.7083) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:499
clean false:8
clean_rate:0.9842209072978304
noisy true:693
noisy false:400
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [97/200] batch [5/15] time 0.179 (0.177) data 0.101 (0.100) loss_x loss_x 0.5537 (0.4620) acc_x 84.3750 (88.7500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/15] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.8374 (0.6057) acc_x 87.5000 (85.3125) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [15/15] time 0.207 (0.184) data 0.130 (0.107) loss_x loss_x 0.7075 (0.6242) acc_x 78.1250 (84.7917) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:492
clean false:8
clean_rate:0.984
noisy true:697
noisy false:403
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [98/200] batch [5/15] time 0.169 (0.200) data 0.092 (0.123) loss_x loss_x 0.9458 (0.6955) acc_x 81.2500 (85.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/15] time 0.174 (0.189) data 0.097 (0.111) loss_x loss_x 0.5190 (0.6263) acc_x 78.1250 (86.2500) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [15/15] time 0.168 (0.184) data 0.091 (0.107) loss_x loss_x 0.7393 (0.6058) acc_x 87.5000 (86.4583) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 479
clean true:473
clean false:6
clean_rate:0.9874739039665971
noisy true:699
noisy false:422
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1121
epoch [99/200] batch [5/14] time 0.179 (0.183) data 0.102 (0.105) loss_x loss_x 0.5156 (0.5473) acc_x 90.6250 (86.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/14] time 0.164 (0.174) data 0.088 (0.097) loss_x loss_x 0.5732 (0.5098) acc_x 81.2500 (86.8750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 404
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:491
clean false:6
clean_rate:0.9879275653923542
noisy true:705
noisy false:398
all clean rate:  [0.9823943661971831, 0.9739413680781759, 0.9812834224598931, 0.9836512261580381, 0.9824120603015075, 0.9856801909307876, 0.9901719901719902, 0.9976470588235294, 0.982367758186398, 0.9859484777517564, 0.9930232558139535, 0.9902912621359223, 0.9864253393665159, 0.9789719626168224, 0.9886104783599089, 0.988399071925754, 0.9815242494226328, 0.988558352402746, 0.9930875576036866, 0.9845132743362832, 0.9886877828054299, 0.9863325740318907, 0.9932735426008968, 0.9883177570093458, 0.9807692307692307, 0.9819819819819819, 0.9931662870159453, 0.9933333333333333, 0.9867549668874173, 0.9887133182844243, 0.9891304347826086, 0.9910313901345291, 0.9931506849315068, 0.9844097995545658, 0.988558352402746, 0.9866369710467706, 0.9933481152993349, 0.9809725158562368, 0.9955257270693513, 0.9824175824175824, 0.9872068230277186, 0.9893162393162394, 0.9913232104121475, 0.9823788546255506, 0.9956427015250545, 0.9832985386221295, 0.978494623655914, 0.9893162393162394, 0.9812889812889813, 0.989451476793249, 0.9873684210526316, 0.9838056680161943, 0.9851380042462845, 0.9867549668874173, 0.9872068230277186, 0.9893162393162394, 0.9831578947368421, 0.9833333333333333, 0.9934497816593887, 0.985200845665962, 0.9914529914529915, 0.9832985386221295, 0.9831223628691983, 0.9808510638297873, 0.9870967741935484, 0.9813664596273292, 0.9830148619957537, 0.9870689655172413, 0.9850107066381156, 0.989406779661017, 0.977319587628866, 0.9874213836477987, 0.9979508196721312, 0.9873417721518988, 0.9873684210526316, 0.9814432989690721, 0.991701244813278, 0.981404958677686, 0.9855072463768116, 0.9814432989690721, 0.9853862212943633, 0.9834710743801653, 0.9832285115303984, 0.9835390946502057, 0.9840954274353877, 0.9787685774946921, 0.9814432989690721, 0.983739837398374, 0.9762376237623762, 0.9796747967479674, 0.98989898989899, 0.9796747967479674, 0.9728155339805825, 0.983640081799591, 0.9797160243407708, 0.974, 0.9842209072978304, 0.984, 0.9874739039665971, 0.9879275653923542]
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [100/200] batch [5/15] time 0.183 (0.189) data 0.106 (0.112) loss_x loss_x 0.3770 (0.4904) acc_x 93.7500 (88.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/15] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.5342 (0.4997) acc_x 84.3750 (87.5000) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [15/15] time 0.190 (0.189) data 0.111 (0.112) loss_x loss_x 0.5762 (0.5060) acc_x 87.5000 (87.0833) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:486
clean false:11
clean_rate:0.9778672032193159
noisy true:691
noisy false:412
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [101/200] batch [5/15] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.2318 (0.4606) acc_x 93.7500 (86.8750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/15] time 0.196 (0.186) data 0.120 (0.109) loss_x loss_x 0.6094 (0.5709) acc_x 81.2500 (85.3125) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [15/15] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.4648 (0.5445) acc_x 90.6250 (86.6667) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 427
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:479
clean false:9
clean_rate:0.9815573770491803
noisy true:694
noisy false:418
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [102/200] batch [5/15] time 0.177 (0.172) data 0.099 (0.095) loss_x loss_x 0.6123 (0.3975) acc_x 81.2500 (89.3750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/15] time 0.169 (0.169) data 0.089 (0.091) loss_x loss_x 0.2781 (0.4359) acc_x 93.7500 (88.1250) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [15/15] time 0.179 (0.168) data 0.103 (0.091) loss_x loss_x 0.5708 (0.4681) acc_x 84.3750 (87.5000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 420
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:502
clean false:5
clean_rate:0.9901380670611439
noisy true:678
noisy false:415
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [103/200] batch [5/15] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.6514 (0.5794) acc_x 81.2500 (86.2500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/15] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4143 (0.5993) acc_x 87.5000 (85.0000) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [15/15] time 0.188 (0.188) data 0.111 (0.110) loss_x loss_x 0.7720 (0.6082) acc_x 84.3750 (85.4167) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 428
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:482
clean false:6
clean_rate:0.9877049180327869
noisy true:690
noisy false:422
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [104/200] batch [5/15] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 0.6680 (0.5890) acc_x 81.2500 (85.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/15] time 0.229 (0.182) data 0.152 (0.105) loss_x loss_x 0.6284 (0.5786) acc_x 84.3750 (85.0000) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [15/15] time 0.173 (0.181) data 0.095 (0.104) loss_x loss_x 0.4824 (0.5670) acc_x 87.5000 (85.6250) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:493
clean false:7
clean_rate:0.986
noisy true:694
noisy false:406
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [105/200] batch [5/15] time 0.178 (0.197) data 0.100 (0.119) loss_x loss_x 0.5801 (0.4130) acc_x 81.2500 (88.1250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/15] time 0.179 (0.188) data 0.102 (0.110) loss_x loss_x 0.4980 (0.5137) acc_x 84.3750 (86.2500) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [15/15] time 0.169 (0.181) data 0.092 (0.104) loss_x loss_x 0.7241 (0.5539) acc_x 78.1250 (84.7917) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:490
clean false:7
clean_rate:0.9859154929577465
noisy true:698
noisy false:405
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [106/200] batch [5/15] time 0.171 (0.180) data 0.093 (0.103) loss_x loss_x 0.4121 (0.5287) acc_x 87.5000 (85.6250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/15] time 0.168 (0.176) data 0.090 (0.099) loss_x loss_x 0.3796 (0.5497) acc_x 90.6250 (86.2500) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [15/15] time 0.177 (0.176) data 0.100 (0.098) loss_x loss_x 0.4065 (0.5358) acc_x 87.5000 (86.8750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:494
clean false:9
clean_rate:0.9821073558648111
noisy true:690
noisy false:407
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [107/200] batch [5/15] time 0.181 (0.182) data 0.103 (0.105) loss_x loss_x 0.1578 (0.4710) acc_x 100.0000 (86.8750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/15] time 0.179 (0.183) data 0.101 (0.106) loss_x loss_x 0.6504 (0.5369) acc_x 90.6250 (86.2500) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [15/15] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 0.3684 (0.5848) acc_x 87.5000 (84.3750) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3050, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 488
clean true:483
clean false:5
clean_rate:0.9897540983606558
noisy true:701
noisy false:411
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1112
epoch [108/200] batch [5/15] time 0.167 (0.181) data 0.090 (0.104) loss_x loss_x 0.7368 (0.5401) acc_x 75.0000 (81.8750) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/15] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 1.0420 (0.6005) acc_x 84.3750 (83.1250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [15/15] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.6299 (0.6152) acc_x 84.3750 (82.5000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:495
clean false:5
clean_rate:0.99
noisy true:722
noisy false:378
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [109/200] batch [5/15] time 0.163 (0.175) data 0.086 (0.097) loss_x loss_x 0.3030 (0.5134) acc_x 93.7500 (85.6250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/15] time 0.199 (0.181) data 0.120 (0.104) loss_x loss_x 0.2163 (0.4184) acc_x 96.8750 (89.3750) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [15/15] time 0.213 (0.184) data 0.136 (0.107) loss_x loss_x 0.4980 (0.4340) acc_x 87.5000 (88.7500) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:491
clean false:8
clean_rate:0.9839679358717435
noisy true:698
noisy false:403
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [110/200] batch [5/15] time 0.177 (0.170) data 0.099 (0.093) loss_x loss_x 0.7393 (0.3859) acc_x 87.5000 (91.8750) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/15] time 0.205 (0.174) data 0.128 (0.097) loss_x loss_x 0.5464 (0.5248) acc_x 87.5000 (87.1875) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [15/15] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.4822 (0.5751) acc_x 84.3750 (85.2083) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:495
clean false:10
clean_rate:0.9801980198019802
noisy true:695
noisy false:400
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [111/200] batch [5/15] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.6685 (0.5683) acc_x 81.2500 (86.8750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/15] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.7671 (0.6027) acc_x 81.2500 (85.9375) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [15/15] time 0.179 (0.176) data 0.102 (0.099) loss_x loss_x 0.3738 (0.5942) acc_x 93.7500 (85.2083) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:493
clean false:7
clean_rate:0.986
noisy true:691
noisy false:409
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [112/200] batch [5/15] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.4875 (0.4831) acc_x 87.5000 (89.3750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/15] time 0.210 (0.188) data 0.133 (0.111) loss_x loss_x 0.8125 (0.5483) acc_x 81.2500 (87.1875) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [15/15] time 0.187 (0.188) data 0.111 (0.111) loss_x loss_x 0.7593 (0.5717) acc_x 81.2500 (86.4583) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:485
clean false:9
clean_rate:0.9817813765182186
noisy true:680
noisy false:426
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [113/200] batch [5/15] time 0.197 (0.182) data 0.121 (0.105) loss_x loss_x 0.4006 (0.4524) acc_x 96.8750 (89.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/15] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.5488 (0.5211) acc_x 81.2500 (86.2500) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [15/15] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.5166 (0.5433) acc_x 87.5000 (86.8750) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:496
clean false:8
clean_rate:0.9841269841269841
noisy true:690
noisy false:406
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [114/200] batch [5/15] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5806 (0.4432) acc_x 81.2500 (90.0000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/15] time 0.193 (0.183) data 0.115 (0.106) loss_x loss_x 0.6499 (0.4590) acc_x 90.6250 (89.3750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [15/15] time 0.213 (0.186) data 0.136 (0.109) loss_x loss_x 0.3623 (0.5049) acc_x 93.7500 (88.5417) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 490
clean true:481
clean false:9
clean_rate:0.9816326530612245
noisy true:713
noisy false:397
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1110
epoch [115/200] batch [5/15] time 0.189 (0.180) data 0.111 (0.102) loss_x loss_x 0.5122 (0.5581) acc_x 87.5000 (87.5000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/15] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.4382 (0.5114) acc_x 84.3750 (87.1875) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [15/15] time 0.178 (0.179) data 0.101 (0.101) loss_x loss_x 0.4314 (0.4923) acc_x 90.6250 (87.5000) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 418
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:489
clean false:11
clean_rate:0.978
noisy true:693
noisy false:407
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [116/200] batch [5/15] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.9556 (0.6062) acc_x 78.1250 (86.2500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/15] time 0.173 (0.180) data 0.097 (0.103) loss_x loss_x 0.6230 (0.5114) acc_x 84.3750 (87.1875) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [15/15] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.8057 (0.6564) acc_x 81.2500 (83.3333) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 429
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 501
clean true:490
clean false:11
clean_rate:0.9780439121756487
noisy true:681
noisy false:418
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1099
epoch [117/200] batch [5/15] time 0.229 (0.188) data 0.153 (0.111) loss_x loss_x 0.4158 (0.3664) acc_x 90.6250 (91.8750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/15] time 0.167 (0.185) data 0.090 (0.108) loss_x loss_x 0.7295 (0.5293) acc_x 84.3750 (86.8750) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [15/15] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.8374 (0.5932) acc_x 81.2500 (86.4583) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 515
clean true:505
clean false:10
clean_rate:0.9805825242718447
noisy true:684
noisy false:401
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1085
epoch [118/200] batch [5/16] time 0.186 (0.189) data 0.108 (0.112) loss_x loss_x 0.3330 (0.4775) acc_x 90.6250 (85.0000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/16] time 0.179 (0.189) data 0.103 (0.112) loss_x loss_x 0.6753 (0.5615) acc_x 84.3750 (85.0000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/16] time 0.199 (0.183) data 0.123 (0.106) loss_x loss_x 0.5039 (0.5577) acc_x 84.3750 (85.0000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 506
clean true:494
clean false:12
clean_rate:0.9762845849802372
noisy true:685
noisy false:409
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1094
epoch [119/200] batch [5/15] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.5625 (0.5571) acc_x 84.3750 (87.5000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/15] time 0.168 (0.178) data 0.090 (0.101) loss_x loss_x 0.7383 (0.4927) acc_x 71.8750 (86.8750) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [15/15] time 0.159 (0.172) data 0.082 (0.095) loss_x loss_x 0.7451 (0.5359) acc_x 87.5000 (85.6250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:493
clean false:6
clean_rate:0.9879759519038076
noisy true:686
noisy false:415
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [120/200] batch [5/15] time 0.215 (0.190) data 0.138 (0.114) loss_x loss_x 0.3845 (0.4803) acc_x 90.6250 (86.8750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/15] time 0.175 (0.194) data 0.098 (0.117) loss_x loss_x 0.4729 (0.4644) acc_x 93.7500 (87.1875) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [15/15] time 0.167 (0.188) data 0.089 (0.111) loss_x loss_x 0.4683 (0.4671) acc_x 90.6250 (86.6667) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 419
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:493
clean false:12
clean_rate:0.9762376237623762
noisy true:688
noisy false:407
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [121/200] batch [5/15] time 0.190 (0.191) data 0.113 (0.114) loss_x loss_x 0.2927 (0.4270) acc_x 90.6250 (91.8750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/15] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.4692 (0.5235) acc_x 90.6250 (88.4375) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [15/15] time 0.179 (0.188) data 0.102 (0.110) loss_x loss_x 0.9546 (0.6244) acc_x 78.1250 (85.4167) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 433
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:493
clean false:5
clean_rate:0.9899598393574297
noisy true:674
noisy false:428
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [122/200] batch [5/15] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.4785 (0.5746) acc_x 78.1250 (84.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/15] time 0.235 (0.187) data 0.158 (0.110) loss_x loss_x 0.5996 (0.4990) acc_x 87.5000 (86.2500) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [15/15] time 0.196 (0.189) data 0.119 (0.112) loss_x loss_x 0.6074 (0.4689) acc_x 87.5000 (87.7083) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 500
clean true:490
clean false:10
clean_rate:0.98
noisy true:693
noisy false:407
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1100
epoch [123/200] batch [5/15] time 0.188 (0.179) data 0.111 (0.101) loss_x loss_x 0.2227 (0.5586) acc_x 93.7500 (86.2500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/15] time 0.192 (0.182) data 0.115 (0.104) loss_x loss_x 0.4795 (0.5950) acc_x 90.6250 (86.2500) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [15/15] time 0.184 (0.181) data 0.106 (0.104) loss_x loss_x 0.7920 (0.5745) acc_x 81.2500 (87.5000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:502
clean false:7
clean_rate:0.9862475442043221
noisy true:683
noisy false:408
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [124/200] batch [5/15] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.5400 (0.7072) acc_x 87.5000 (81.2500) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/15] time 0.170 (0.181) data 0.094 (0.104) loss_x loss_x 0.6250 (0.6155) acc_x 84.3750 (84.3750) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [15/15] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5791 (0.6511) acc_x 78.1250 (83.1250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 410
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:498
clean false:9
clean_rate:0.9822485207100592
noisy true:692
noisy false:401
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [125/200] batch [5/15] time 0.185 (0.197) data 0.108 (0.120) loss_x loss_x 0.5269 (0.4474) acc_x 84.3750 (88.7500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/15] time 0.225 (0.193) data 0.148 (0.116) loss_x loss_x 0.6953 (0.5744) acc_x 90.6250 (86.2500) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [15/15] time 0.200 (0.185) data 0.123 (0.108) loss_x loss_x 0.8672 (0.6169) acc_x 71.8750 (84.5833) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 403
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:491
clean false:8
clean_rate:0.9839679358717435
noisy true:706
noisy false:395
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [126/200] batch [5/15] time 0.203 (0.177) data 0.126 (0.100) loss_x loss_x 0.3938 (0.5828) acc_x 90.6250 (85.6250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/15] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.5752 (0.5230) acc_x 84.3750 (86.8750) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [15/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4751 (0.5372) acc_x 93.7500 (86.4583) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 502
clean true:493
clean false:9
clean_rate:0.9820717131474104
noisy true:681
noisy false:417
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1098
epoch [127/200] batch [5/15] time 0.192 (0.190) data 0.115 (0.113) loss_x loss_x 0.4690 (0.3384) acc_x 84.3750 (91.8750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/15] time 0.208 (0.190) data 0.131 (0.113) loss_x loss_x 0.5137 (0.4316) acc_x 87.5000 (88.4375) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [15/15] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.4836 (0.4909) acc_x 84.3750 (86.6667) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 401
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:501
clean false:10
clean_rate:0.9804305283757339
noisy true:698
noisy false:391
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [128/200] batch [5/15] time 0.225 (0.201) data 0.147 (0.124) loss_x loss_x 0.7471 (0.6358) acc_x 78.1250 (83.7500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/15] time 0.205 (0.210) data 0.128 (0.132) loss_x loss_x 0.7075 (0.6483) acc_x 81.2500 (83.7500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/15] time 0.219 (0.213) data 0.141 (0.135) loss_x loss_x 0.6963 (0.6288) acc_x 78.1250 (84.1667) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:496
clean false:11
clean_rate:0.9783037475345168
noisy true:691
noisy false:402
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [129/200] batch [5/15] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.4485 (0.4599) acc_x 87.5000 (88.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/15] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.5205 (0.5151) acc_x 84.3750 (87.5000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [15/15] time 0.190 (0.171) data 0.113 (0.094) loss_x loss_x 0.6621 (0.5151) acc_x 87.5000 (87.5000) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 518
clean true:510
clean false:8
clean_rate:0.9845559845559846
noisy true:693
noisy false:389
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1082
epoch [130/200] batch [5/16] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.2673 (0.4568) acc_x 90.6250 (85.0000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/16] time 0.190 (0.173) data 0.114 (0.096) loss_x loss_x 0.6880 (0.5458) acc_x 81.2500 (84.6875) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/16] time 0.185 (0.177) data 0.107 (0.100) loss_x loss_x 0.8472 (0.5812) acc_x 78.1250 (84.3750) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 436
confident_label rate tensor(0.3081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 493
clean true:486
clean false:7
clean_rate:0.9858012170385395
noisy true:678
noisy false:429
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1107
epoch [131/200] batch [5/15] time 0.181 (0.173) data 0.102 (0.095) loss_x loss_x 0.2449 (0.4343) acc_x 96.8750 (90.0000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/15] time 0.161 (0.175) data 0.084 (0.097) loss_x loss_x 1.1738 (0.4329) acc_x 78.1250 (90.0000) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [15/15] time 0.174 (0.173) data 0.096 (0.095) loss_x loss_x 0.5381 (0.4573) acc_x 87.5000 (88.7500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 497
clean true:487
clean false:10
clean_rate:0.9798792756539235
noisy true:708
noisy false:395
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1103
epoch [132/200] batch [5/15] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 0.5010 (0.3937) acc_x 81.2500 (88.7500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/15] time 0.197 (0.180) data 0.120 (0.102) loss_x loss_x 0.5117 (0.4833) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [15/15] time 0.193 (0.180) data 0.115 (0.103) loss_x loss_x 0.7236 (0.5256) acc_x 81.2500 (86.4583) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 519
clean true:506
clean false:13
clean_rate:0.9749518304431599
noisy true:688
noisy false:393
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1081
epoch [133/200] batch [5/16] time 0.177 (0.180) data 0.099 (0.103) loss_x loss_x 0.4165 (0.7013) acc_x 84.3750 (80.0000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/16] time 0.186 (0.178) data 0.108 (0.101) loss_x loss_x 0.3025 (0.6397) acc_x 84.3750 (80.9375) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/16] time 0.181 (0.181) data 0.104 (0.103) loss_x loss_x 0.7495 (0.5812) acc_x 78.1250 (83.3333) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.3250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 520
clean true:511
clean false:9
clean_rate:0.9826923076923076
noisy true:696
noisy false:384
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1080
epoch [134/200] batch [5/16] time 0.163 (0.165) data 0.086 (0.088) loss_x loss_x 0.7651 (0.6975) acc_x 87.5000 (83.7500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/16] time 0.164 (0.165) data 0.087 (0.088) loss_x loss_x 0.7827 (0.5825) acc_x 75.0000 (85.0000) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [15/16] time 0.175 (0.166) data 0.098 (0.089) loss_x loss_x 0.2554 (0.5169) acc_x 90.6250 (85.6250) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:497
clean false:6
clean_rate:0.9880715705765407
noisy true:668
noisy false:429
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [135/200] batch [5/15] time 0.193 (0.186) data 0.116 (0.109) loss_x loss_x 0.4526 (0.4749) acc_x 87.5000 (88.1250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/15] time 0.178 (0.182) data 0.101 (0.105) loss_x loss_x 0.7764 (0.5409) acc_x 71.8750 (85.6250) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [15/15] time 0.180 (0.180) data 0.103 (0.104) loss_x loss_x 0.7998 (0.5299) acc_x 81.2500 (86.0417) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 435
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:486
clean false:10
clean_rate:0.9798387096774194
noisy true:679
noisy false:425
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [136/200] batch [5/15] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.6748 (0.4576) acc_x 81.2500 (86.8750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/15] time 0.188 (0.188) data 0.112 (0.111) loss_x loss_x 0.1942 (0.4313) acc_x 96.8750 (89.0625) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [15/15] time 0.187 (0.187) data 0.109 (0.110) loss_x loss_x 0.6680 (0.4782) acc_x 81.2500 (88.7500) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 426
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 496
clean true:484
clean false:12
clean_rate:0.9758064516129032
noisy true:690
noisy false:414
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1104
epoch [137/200] batch [5/15] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.7852 (0.4998) acc_x 81.2500 (89.3750) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/15] time 0.166 (0.181) data 0.088 (0.104) loss_x loss_x 0.5435 (0.4774) acc_x 84.3750 (89.0625) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [15/15] time 0.181 (0.182) data 0.102 (0.104) loss_x loss_x 1.1465 (0.5340) acc_x 65.6250 (86.4583) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 517
clean true:510
clean false:7
clean_rate:0.9864603481624759
noisy true:688
noisy false:395
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1083
epoch [138/200] batch [5/16] time 0.178 (0.172) data 0.100 (0.095) loss_x loss_x 1.1006 (0.6482) acc_x 87.5000 (86.2500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/16] time 0.171 (0.172) data 0.094 (0.095) loss_x loss_x 0.3062 (0.5698) acc_x 96.8750 (85.9375) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/16] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.9502 (0.6114) acc_x 84.3750 (85.2083) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:514
clean false:9
clean_rate:0.982791586998088
noisy true:677
noisy false:400
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [139/200] batch [5/16] time 0.184 (0.179) data 0.106 (0.102) loss_x loss_x 0.3428 (0.4969) acc_x 90.6250 (88.1250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/16] time 0.173 (0.176) data 0.097 (0.099) loss_x loss_x 0.1904 (0.5327) acc_x 96.8750 (87.5000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/16] time 0.189 (0.179) data 0.111 (0.102) loss_x loss_x 0.3628 (0.4862) acc_x 93.7500 (88.3333) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:490
clean false:8
clean_rate:0.9839357429718876
noisy true:702
noisy false:400
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [140/200] batch [5/15] time 0.181 (0.185) data 0.103 (0.108) loss_x loss_x 0.3096 (0.5444) acc_x 90.6250 (83.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/15] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.2808 (0.4937) acc_x 87.5000 (85.0000) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [15/15] time 0.187 (0.186) data 0.111 (0.109) loss_x loss_x 0.6377 (0.5441) acc_x 81.2500 (85.0000) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:500
clean false:14
clean_rate:0.9727626459143969
noisy true:698
noisy false:388
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [141/200] batch [5/16] time 0.168 (0.174) data 0.091 (0.096) loss_x loss_x 1.2031 (0.7289) acc_x 75.0000 (83.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/16] time 0.164 (0.169) data 0.087 (0.092) loss_x loss_x 0.7456 (0.6875) acc_x 87.5000 (81.8750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/16] time 0.162 (0.168) data 0.084 (0.091) loss_x loss_x 0.9692 (0.6373) acc_x 75.0000 (83.3333) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:501
clean false:10
clean_rate:0.9804305283757339
noisy true:697
noisy false:392
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [142/200] batch [5/15] time 0.188 (0.170) data 0.111 (0.092) loss_x loss_x 1.1855 (0.6803) acc_x 65.6250 (77.5000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/15] time 0.188 (0.177) data 0.111 (0.100) loss_x loss_x 0.6904 (0.6152) acc_x 84.3750 (81.5625) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [15/15] time 0.164 (0.176) data 0.087 (0.099) loss_x loss_x 0.7334 (0.6030) acc_x 84.3750 (83.3333) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3081, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 493
clean true:487
clean false:6
clean_rate:0.9878296146044625
noisy true:701
noisy false:406
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1107
epoch [143/200] batch [5/15] time 0.188 (0.186) data 0.111 (0.108) loss_x loss_x 0.7026 (0.4340) acc_x 87.5000 (90.6250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/15] time 0.188 (0.187) data 0.111 (0.109) loss_x loss_x 0.3486 (0.5028) acc_x 87.5000 (88.4375) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [15/15] time 0.184 (0.187) data 0.107 (0.109) loss_x loss_x 0.6685 (0.5750) acc_x 84.3750 (87.0833) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:488
clean false:10
clean_rate:0.9799196787148594
noisy true:681
noisy false:421
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [144/200] batch [5/15] time 0.172 (0.168) data 0.095 (0.090) loss_x loss_x 0.2278 (0.5027) acc_x 96.8750 (87.5000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/15] time 0.191 (0.176) data 0.113 (0.099) loss_x loss_x 0.6392 (0.5260) acc_x 87.5000 (86.5625) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [15/15] time 0.186 (0.178) data 0.108 (0.101) loss_x loss_x 0.5806 (0.5082) acc_x 84.3750 (87.0833) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 509
clean true:501
clean false:8
clean_rate:0.9842829076620825
noisy true:684
noisy false:407
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1091
epoch [145/200] batch [5/15] time 0.175 (0.184) data 0.098 (0.106) loss_x loss_x 1.1279 (0.6455) acc_x 81.2500 (82.5000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/15] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.3228 (0.5676) acc_x 90.6250 (84.0625) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [15/15] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.8730 (0.5550) acc_x 75.0000 (84.7917) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:497
clean false:7
clean_rate:0.9861111111111112
noisy true:696
noisy false:400
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [146/200] batch [5/15] time 0.198 (0.193) data 0.120 (0.116) loss_x loss_x 0.8262 (0.6776) acc_x 78.1250 (84.3750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/15] time 0.180 (0.188) data 0.103 (0.111) loss_x loss_x 0.5908 (0.6485) acc_x 75.0000 (83.1250) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [15/15] time 0.205 (0.189) data 0.128 (0.112) loss_x loss_x 0.6060 (0.6289) acc_x 84.3750 (82.9167) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:507
clean false:9
clean_rate:0.9825581395348837
noisy true:700
noisy false:384
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [147/200] batch [5/16] time 0.191 (0.195) data 0.113 (0.117) loss_x loss_x 0.6919 (0.4445) acc_x 78.1250 (86.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/16] time 0.172 (0.191) data 0.095 (0.114) loss_x loss_x 0.5571 (0.4992) acc_x 90.6250 (86.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/16] time 0.187 (0.186) data 0.110 (0.108) loss_x loss_x 0.1125 (0.4531) acc_x 100.0000 (87.7083) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 407
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 510
clean true:501
clean false:9
clean_rate:0.9823529411764705
noisy true:692
noisy false:398
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1090
epoch [148/200] batch [5/15] time 0.187 (0.184) data 0.109 (0.106) loss_x loss_x 0.6558 (0.5167) acc_x 84.3750 (86.8750) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/15] time 0.174 (0.181) data 0.097 (0.103) loss_x loss_x 0.4980 (0.4796) acc_x 84.3750 (86.5625) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [15/15] time 0.181 (0.181) data 0.103 (0.104) loss_x loss_x 0.7295 (0.4854) acc_x 84.3750 (86.2500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 408
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:498
clean false:9
clean_rate:0.9822485207100592
noisy true:694
noisy false:399
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [149/200] batch [5/15] time 0.183 (0.174) data 0.106 (0.096) loss_x loss_x 0.9146 (0.7467) acc_x 81.2500 (83.1250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/15] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.4126 (0.6646) acc_x 90.6250 (85.3125) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [15/15] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.4614 (0.6977) acc_x 87.5000 (83.9583) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 382
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:503
clean false:11
clean_rate:0.9785992217898832
noisy true:715
noisy false:371
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [150/200] batch [5/16] time 0.167 (0.176) data 0.090 (0.099) loss_x loss_x 0.7246 (0.4895) acc_x 78.1250 (86.2500) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/16] time 0.203 (0.178) data 0.126 (0.101) loss_x loss_x 0.3589 (0.5324) acc_x 93.7500 (85.3125) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/16] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.9590 (0.5485) acc_x 71.8750 (85.0000) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 405
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:495
clean false:9
clean_rate:0.9821428571428571
noisy true:700
noisy false:396
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [151/200] batch [5/15] time 0.208 (0.190) data 0.131 (0.113) loss_x loss_x 0.4001 (0.4013) acc_x 90.6250 (89.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/15] time 0.190 (0.188) data 0.113 (0.111) loss_x loss_x 0.7163 (0.5239) acc_x 81.2500 (86.2500) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [15/15] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 1.0518 (0.5381) acc_x 81.2500 (86.6667) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 380
confident_label rate tensor(0.3219, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 515
clean true:505
clean false:10
clean_rate:0.9805825242718447
noisy true:715
noisy false:370
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1085
epoch [152/200] batch [5/16] time 0.180 (0.182) data 0.101 (0.104) loss_x loss_x 0.2549 (0.4930) acc_x 96.8750 (88.7500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/16] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.3596 (0.4957) acc_x 87.5000 (87.5000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/16] time 0.185 (0.178) data 0.108 (0.100) loss_x loss_x 0.5723 (0.5166) acc_x 90.6250 (87.5000) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:503
clean false:11
clean_rate:0.9785992217898832
noisy true:675
noisy false:411
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [153/200] batch [5/16] time 0.176 (0.169) data 0.100 (0.092) loss_x loss_x 0.3271 (0.5923) acc_x 93.7500 (87.5000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/16] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.5288 (0.5776) acc_x 87.5000 (87.1875) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/16] time 0.172 (0.175) data 0.095 (0.097) loss_x loss_x 1.0547 (0.6291) acc_x 71.8750 (85.8333) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 430
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:488
clean false:10
clean_rate:0.9799196787148594
noisy true:682
noisy false:420
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [154/200] batch [5/15] time 0.169 (0.173) data 0.091 (0.095) loss_x loss_x 0.6665 (0.4906) acc_x 84.3750 (87.5000) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/15] time 0.188 (0.174) data 0.111 (0.096) loss_x loss_x 0.7959 (0.5667) acc_x 90.6250 (87.1875) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [15/15] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.4980 (0.6134) acc_x 87.5000 (85.0000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:501
clean false:12
clean_rate:0.9766081871345029
noisy true:697
noisy false:390
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [155/200] batch [5/16] time 0.162 (0.183) data 0.084 (0.106) loss_x loss_x 0.3794 (0.5119) acc_x 90.6250 (86.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/16] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.4893 (0.5159) acc_x 90.6250 (86.8750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/16] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.6182 (0.4892) acc_x 90.6250 (87.2917) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:495
clean false:12
clean_rate:0.9763313609467456
noisy true:690
noisy false:403
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [156/200] batch [5/15] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.3262 (0.6658) acc_x 93.7500 (84.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/15] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 1.1172 (0.6513) acc_x 78.1250 (85.6250) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [15/15] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.7295 (0.6427) acc_x 75.0000 (85.2083) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 501
clean true:496
clean false:5
clean_rate:0.9900199600798403
noisy true:679
noisy false:420
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1099
epoch [157/200] batch [5/15] time 0.177 (0.195) data 0.100 (0.118) loss_x loss_x 0.4006 (0.6121) acc_x 84.3750 (82.5000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/15] time 0.186 (0.191) data 0.109 (0.114) loss_x loss_x 0.3870 (0.5202) acc_x 87.5000 (85.3125) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [15/15] time 0.173 (0.185) data 0.096 (0.108) loss_x loss_x 0.4336 (0.5285) acc_x 90.6250 (86.2500) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 506
clean true:498
clean false:8
clean_rate:0.9841897233201581
noisy true:686
noisy false:408
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1094
epoch [158/200] batch [5/15] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.8457 (0.5786) acc_x 75.0000 (83.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/15] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 0.1946 (0.5105) acc_x 96.8750 (86.5625) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [15/15] time 0.188 (0.178) data 0.112 (0.101) loss_x loss_x 0.2717 (0.4707) acc_x 93.7500 (88.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 423
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 494
clean true:483
clean false:11
clean_rate:0.9777327935222672
noisy true:694
noisy false:412
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1106
epoch [159/200] batch [5/15] time 0.171 (0.181) data 0.093 (0.104) loss_x loss_x 0.2747 (0.3875) acc_x 93.7500 (90.0000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/15] time 0.167 (0.185) data 0.090 (0.107) loss_x loss_x 0.7651 (0.5256) acc_x 81.2500 (87.5000) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [15/15] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.2720 (0.4859) acc_x 93.7500 (89.3750) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 521
clean true:507
clean false:14
clean_rate:0.9731285988483686
noisy true:703
noisy false:376
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 1079
epoch [160/200] batch [5/16] time 0.174 (0.176) data 0.096 (0.098) loss_x loss_x 0.4641 (0.4017) acc_x 84.3750 (86.8750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/16] time 0.177 (0.174) data 0.099 (0.097) loss_x loss_x 0.5435 (0.4770) acc_x 90.6250 (86.2500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/16] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.9731 (0.5433) acc_x 78.1250 (86.2500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 391
confident_label rate tensor(0.3250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 520
clean true:511
clean false:9
clean_rate:0.9826923076923076
noisy true:698
noisy false:382
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1080
epoch [161/200] batch [5/16] time 0.188 (0.183) data 0.110 (0.106) loss_x loss_x 0.8438 (0.6700) acc_x 84.3750 (85.0000) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/16] time 0.232 (0.189) data 0.155 (0.112) loss_x loss_x 0.9185 (0.6276) acc_x 71.8750 (83.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/16] time 0.189 (0.188) data 0.111 (0.111) loss_x loss_x 0.4143 (0.5993) acc_x 90.6250 (83.9583) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 519
clean true:507
clean false:12
clean_rate:0.976878612716763
noisy true:680
noisy false:401
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1081
epoch [162/200] batch [5/16] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.6006 (0.5447) acc_x 84.3750 (85.0000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/16] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.8389 (0.5599) acc_x 75.0000 (84.3750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/16] time 0.171 (0.181) data 0.093 (0.104) loss_x loss_x 0.2964 (0.5604) acc_x 87.5000 (84.5833) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:510
clean false:6
clean_rate:0.9883720930232558
noisy true:684
noisy false:400
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [163/200] batch [5/16] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.5679 (0.7101) acc_x 84.3750 (81.2500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/16] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.4487 (0.6413) acc_x 90.6250 (83.4375) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/16] time 0.159 (0.182) data 0.082 (0.105) loss_x loss_x 1.0039 (0.5924) acc_x 71.8750 (84.7917) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 398
confident_label rate tensor(0.3244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 519
clean true:510
clean false:9
clean_rate:0.9826589595375722
noisy true:692
noisy false:389
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1081
epoch [164/200] batch [5/16] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 1.0332 (0.5365) acc_x 78.1250 (88.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/16] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.8130 (0.6667) acc_x 81.2500 (86.5625) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/16] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.2544 (0.5743) acc_x 90.6250 (87.0833) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 402
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 517
clean true:502
clean false:15
clean_rate:0.9709864603481625
noisy true:696
noisy false:387
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1083
epoch [165/200] batch [5/16] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.6431 (0.5408) acc_x 84.3750 (86.8750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/16] time 0.177 (0.178) data 0.101 (0.101) loss_x loss_x 0.5698 (0.5814) acc_x 90.6250 (87.1875) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/16] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.5576 (0.5749) acc_x 81.2500 (86.4583) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 393
confident_label rate tensor(0.3244, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 519
clean true:511
clean false:8
clean_rate:0.9845857418111753
noisy true:696
noisy false:385
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1081
epoch [166/200] batch [5/16] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7456 (0.6179) acc_x 84.3750 (85.0000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/16] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.7368 (0.6032) acc_x 87.5000 (86.2500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/16] time 0.173 (0.173) data 0.094 (0.096) loss_x loss_x 0.9663 (0.5745) acc_x 75.0000 (86.0417) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:506
clean false:10
clean_rate:0.9806201550387597
noisy true:683
noisy false:401
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [167/200] batch [5/16] time 0.162 (0.175) data 0.084 (0.098) loss_x loss_x 0.6777 (0.5759) acc_x 81.2500 (86.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/16] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.7622 (0.5653) acc_x 78.1250 (85.6250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/16] time 0.186 (0.178) data 0.108 (0.101) loss_x loss_x 0.4612 (0.5190) acc_x 93.7500 (86.8750) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:495
clean false:10
clean_rate:0.9801980198019802
noisy true:688
noisy false:407
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [168/200] batch [5/15] time 0.223 (0.178) data 0.145 (0.100) loss_x loss_x 0.3025 (0.4792) acc_x 93.7500 (88.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/15] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.4521 (0.5367) acc_x 90.6250 (85.6250) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [15/15] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.6831 (0.5005) acc_x 84.3750 (87.0833) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 414
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 508
clean true:498
clean false:10
clean_rate:0.9803149606299213
noisy true:688
noisy false:404
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1092
epoch [169/200] batch [5/15] time 0.191 (0.188) data 0.114 (0.111) loss_x loss_x 0.7681 (0.4023) acc_x 81.2500 (90.0000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/15] time 0.187 (0.190) data 0.111 (0.113) loss_x loss_x 0.4971 (0.4975) acc_x 87.5000 (87.5000) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [15/15] time 0.198 (0.190) data 0.119 (0.113) loss_x loss_x 0.4241 (0.4780) acc_x 90.6250 (88.5417) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:504
clean false:9
clean_rate:0.9824561403508771
noisy true:699
noisy false:388
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [170/200] batch [5/16] time 0.164 (0.170) data 0.085 (0.092) loss_x loss_x 0.5967 (0.4846) acc_x 84.3750 (88.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/16] time 0.167 (0.167) data 0.089 (0.089) loss_x loss_x 0.7085 (0.5173) acc_x 87.5000 (88.1250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/16] time 0.166 (0.166) data 0.088 (0.089) loss_x loss_x 0.6582 (0.5370) acc_x 81.2500 (87.5000) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 425
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 499
clean true:487
clean false:12
clean_rate:0.9759519038076152
noisy true:688
noisy false:413
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1101
epoch [171/200] batch [5/15] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.3862 (0.4260) acc_x 90.6250 (87.5000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/15] time 0.167 (0.184) data 0.090 (0.107) loss_x loss_x 0.3367 (0.4050) acc_x 93.7500 (89.0625) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [15/15] time 0.171 (0.180) data 0.094 (0.102) loss_x loss_x 0.4163 (0.4379) acc_x 90.6250 (88.5417) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:504
clean false:10
clean_rate:0.980544747081712
noisy true:684
noisy false:402
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [172/200] batch [5/16] time 0.188 (0.189) data 0.111 (0.112) loss_x loss_x 0.7319 (0.5179) acc_x 75.0000 (82.5000) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/16] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 0.6348 (0.5352) acc_x 87.5000 (84.6875) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/16] time 0.191 (0.187) data 0.114 (0.110) loss_x loss_x 0.1805 (0.4910) acc_x 100.0000 (86.6667) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.3287, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 526
clean true:516
clean false:10
clean_rate:0.9809885931558935
noisy true:696
noisy false:378
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1074
epoch [173/200] batch [5/16] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.5859 (0.4863) acc_x 84.3750 (88.1250) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/16] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8940 (0.5125) acc_x 75.0000 (87.1875) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/16] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.8896 (0.5390) acc_x 81.2500 (87.2917) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:499
clean false:8
clean_rate:0.9842209072978304
noisy true:690
noisy false:403
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [174/200] batch [5/15] time 0.186 (0.190) data 0.108 (0.113) loss_x loss_x 0.2046 (0.4188) acc_x 96.8750 (90.6250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/15] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.7974 (0.5412) acc_x 81.2500 (87.1875) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [15/15] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.5474 (0.5204) acc_x 84.3750 (86.6667) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 421
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:504
clean false:12
clean_rate:0.9767441860465116
noisy true:675
noisy false:409
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [175/200] batch [5/16] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.5640 (0.4332) acc_x 87.5000 (88.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/16] time 0.170 (0.183) data 0.093 (0.106) loss_x loss_x 0.1840 (0.4257) acc_x 93.7500 (89.6875) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/16] time 0.169 (0.179) data 0.092 (0.101) loss_x loss_x 0.7051 (0.4603) acc_x 81.2500 (88.5417) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 504
clean true:495
clean false:9
clean_rate:0.9821428571428571
noisy true:699
noisy false:397
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1096
epoch [176/200] batch [5/15] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.5400 (0.6687) acc_x 81.2500 (83.7500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/15] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.8643 (0.6406) acc_x 75.0000 (84.6875) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [15/15] time 0.165 (0.178) data 0.087 (0.101) loss_x loss_x 0.3586 (0.6238) acc_x 90.6250 (85.2083) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:508
clean false:8
clean_rate:0.9844961240310077
noisy true:680
noisy false:404
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [177/200] batch [5/16] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.5645 (0.5876) acc_x 90.6250 (85.6250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/16] time 0.167 (0.183) data 0.091 (0.106) loss_x loss_x 0.5815 (0.5524) acc_x 87.5000 (85.6250) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/16] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.4619 (0.5235) acc_x 84.3750 (86.2500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 390
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:496
clean false:9
clean_rate:0.9821782178217822
noisy true:714
noisy false:381
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [178/200] batch [5/15] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.6182 (0.4212) acc_x 87.5000 (92.5000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/15] time 0.162 (0.176) data 0.085 (0.099) loss_x loss_x 0.6846 (0.5457) acc_x 81.2500 (88.4375) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [15/15] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.4829 (0.5445) acc_x 84.3750 (87.5000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 413
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:512
clean false:11
clean_rate:0.9789674952198852
noisy true:675
noisy false:402
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [179/200] batch [5/16] time 0.164 (0.169) data 0.087 (0.092) loss_x loss_x 0.6938 (0.7265) acc_x 81.2500 (81.2500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/16] time 0.165 (0.168) data 0.088 (0.091) loss_x loss_x 0.3572 (0.5876) acc_x 87.5000 (85.3125) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/16] time 0.195 (0.176) data 0.118 (0.099) loss_x loss_x 0.5425 (0.5373) acc_x 87.5000 (86.0417) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 431
confident_label rate tensor(0.3169, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 507
clean true:495
clean false:12
clean_rate:0.9763313609467456
noisy true:674
noisy false:419
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1093
epoch [180/200] batch [5/15] time 0.165 (0.187) data 0.087 (0.110) loss_x loss_x 0.5786 (0.4788) acc_x 81.2500 (86.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/15] time 0.175 (0.186) data 0.098 (0.109) loss_x loss_x 0.5894 (0.5716) acc_x 87.5000 (85.9375) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [15/15] time 0.168 (0.186) data 0.091 (0.109) loss_x loss_x 0.4221 (0.5588) acc_x 90.6250 (86.6667) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:498
clean false:15
clean_rate:0.9707602339181286
noisy true:693
noisy false:394
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [181/200] batch [5/16] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.5215 (0.4702) acc_x 87.5000 (86.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/16] time 0.183 (0.191) data 0.107 (0.114) loss_x loss_x 0.4265 (0.5524) acc_x 90.6250 (86.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/16] time 0.185 (0.195) data 0.107 (0.118) loss_x loss_x 0.1838 (0.5467) acc_x 93.7500 (86.0417) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 412
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:507
clean false:7
clean_rate:0.9863813229571985
noisy true:681
noisy false:405
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [182/200] batch [5/16] time 0.173 (0.175) data 0.096 (0.097) loss_x loss_x 1.1113 (0.6313) acc_x 84.3750 (85.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/16] time 0.180 (0.174) data 0.102 (0.096) loss_x loss_x 0.5718 (0.5893) acc_x 78.1250 (83.4375) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/16] time 0.198 (0.188) data 0.119 (0.110) loss_x loss_x 0.4775 (0.5578) acc_x 90.6250 (85.0000) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 409
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:494
clean false:9
clean_rate:0.9821073558648111
noisy true:697
noisy false:400
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [183/200] batch [5/15] time 0.178 (0.180) data 0.102 (0.103) loss_x loss_x 0.3770 (0.5890) acc_x 93.7500 (85.6250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/15] time 0.163 (0.175) data 0.085 (0.098) loss_x loss_x 0.2712 (0.5253) acc_x 96.8750 (86.8750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [15/15] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.3325 (0.5090) acc_x 90.6250 (87.5000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 518
clean true:509
clean false:9
clean_rate:0.9826254826254827
noisy true:685
noisy false:397
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1082
epoch [184/200] batch [5/16] time 0.177 (0.193) data 0.100 (0.116) loss_x loss_x 0.4419 (0.3243) acc_x 90.6250 (93.7500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/16] time 0.180 (0.183) data 0.102 (0.106) loss_x loss_x 0.4207 (0.4638) acc_x 87.5000 (89.0625) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/16] time 0.184 (0.181) data 0.106 (0.104) loss_x loss_x 0.6914 (0.5150) acc_x 81.2500 (86.4583) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 395
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 527
clean true:519
clean false:8
clean_rate:0.9848197343453511
noisy true:686
noisy false:387
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1073
epoch [185/200] batch [5/16] time 0.182 (0.195) data 0.105 (0.117) loss_x loss_x 0.1384 (0.4336) acc_x 96.8750 (88.1250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/16] time 0.181 (0.194) data 0.105 (0.117) loss_x loss_x 0.4885 (0.4984) acc_x 90.6250 (86.2500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/16] time 0.197 (0.191) data 0.121 (0.114) loss_x loss_x 0.3796 (0.4893) acc_x 93.7500 (86.8750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 416
confident_label rate tensor(0.3200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 512
clean true:504
clean false:8
clean_rate:0.984375
noisy true:680
noisy false:408
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1088
epoch [186/200] batch [5/16] time 0.203 (0.209) data 0.126 (0.131) loss_x loss_x 0.8706 (0.5536) acc_x 81.2500 (88.1250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/16] time 0.205 (0.199) data 0.128 (0.122) loss_x loss_x 0.3562 (0.5167) acc_x 90.6250 (87.8125) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/16] time 0.189 (0.195) data 0.112 (0.118) loss_x loss_x 0.3420 (0.4866) acc_x 90.6250 (88.3333) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:504
clean false:9
clean_rate:0.9824561403508771
noisy true:699
noisy false:388
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [187/200] batch [5/16] time 0.164 (0.162) data 0.087 (0.085) loss_x loss_x 0.3772 (0.5767) acc_x 87.5000 (86.8750) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/16] time 0.180 (0.165) data 0.104 (0.088) loss_x loss_x 0.9106 (0.5526) acc_x 75.0000 (86.8750) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [15/16] time 0.184 (0.171) data 0.107 (0.094) loss_x loss_x 0.6387 (0.5257) acc_x 87.5000 (87.5000) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 498
clean true:490
clean false:8
clean_rate:0.9839357429718876
noisy true:693
noisy false:409
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1102
epoch [188/200] batch [5/15] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.7065 (0.5801) acc_x 84.3750 (88.1250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/15] time 0.162 (0.171) data 0.085 (0.093) loss_x loss_x 0.5923 (0.5074) acc_x 87.5000 (89.0625) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [15/15] time 0.158 (0.167) data 0.080 (0.089) loss_x loss_x 1.0254 (0.5070) acc_x 78.1250 (88.7500) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 415
confident_label rate tensor(0.3194, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 511
clean true:503
clean false:8
clean_rate:0.9843444227005871
noisy true:682
noisy false:407
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1089
epoch [189/200] batch [5/15] time 0.157 (0.159) data 0.079 (0.082) loss_x loss_x 0.9458 (0.5942) acc_x 84.3750 (88.1250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/15] time 0.179 (0.167) data 0.101 (0.089) loss_x loss_x 0.6157 (0.5486) acc_x 78.1250 (86.8750) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [15/15] time 0.176 (0.169) data 0.099 (0.091) loss_x loss_x 0.4387 (0.5252) acc_x 90.6250 (87.2917) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 396
confident_label rate tensor(0.3281, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 525
clean true:516
clean false:9
clean_rate:0.9828571428571429
noisy true:688
noisy false:387
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1075
epoch [190/200] batch [5/16] time 0.160 (0.161) data 0.083 (0.083) loss_x loss_x 0.6431 (0.4876) acc_x 84.3750 (86.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/16] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.3284 (0.5188) acc_x 87.5000 (86.2500) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [15/16] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.3643 (0.5274) acc_x 87.5000 (86.4583) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 424
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:496
clean false:7
clean_rate:0.9860834990059643
noisy true:680
noisy false:417
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [191/200] batch [5/15] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.4238 (0.4317) acc_x 90.6250 (89.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/15] time 0.156 (0.158) data 0.080 (0.081) loss_x loss_x 0.6094 (0.4713) acc_x 81.2500 (87.5000) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [15/15] time 0.157 (0.158) data 0.081 (0.081) loss_x loss_x 0.5171 (0.4646) acc_x 90.6250 (88.3333) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 422
confident_label rate tensor(0.3250, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 520
clean true:508
clean false:12
clean_rate:0.9769230769230769
noisy true:670
noisy false:410
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1080
epoch [192/200] batch [5/16] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.4102 (0.6390) acc_x 90.6250 (86.8750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/16] time 0.157 (0.161) data 0.080 (0.083) loss_x loss_x 0.6230 (0.5454) acc_x 84.3750 (88.1250) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [15/16] time 0.158 (0.160) data 0.082 (0.083) loss_x loss_x 0.6045 (0.5258) acc_x 84.3750 (88.3333) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 383
confident_label rate tensor(0.3206, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 513
clean true:503
clean false:10
clean_rate:0.9805068226120858
noisy true:714
noisy false:373
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1087
epoch [193/200] batch [5/16] time 0.164 (0.169) data 0.087 (0.091) loss_x loss_x 0.4551 (0.4525) acc_x 90.6250 (88.7500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/16] time 0.159 (0.164) data 0.081 (0.087) loss_x loss_x 0.7632 (0.5143) acc_x 78.1250 (85.9375) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [15/16] time 0.161 (0.163) data 0.084 (0.085) loss_x loss_x 0.5215 (0.5209) acc_x 90.6250 (86.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 397
confident_label rate tensor(0.3262, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 522
clean true:509
clean false:13
clean_rate:0.975095785440613
noisy true:694
noisy false:384
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1078
epoch [194/200] batch [5/16] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.5879 (0.5445) acc_x 84.3750 (90.0000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/16] time 0.182 (0.163) data 0.105 (0.087) loss_x loss_x 0.3909 (0.5641) acc_x 87.5000 (86.5625) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [15/16] time 0.169 (0.167) data 0.091 (0.090) loss_x loss_x 0.2411 (0.5403) acc_x 93.7500 (86.0417) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 388
confident_label rate tensor(0.3269, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 523
clean true:513
clean false:10
clean_rate:0.9808795411089866
noisy true:699
noisy false:378
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1077
epoch [195/200] batch [5/16] time 0.174 (0.161) data 0.097 (0.084) loss_x loss_x 0.9062 (0.5462) acc_x 78.1250 (86.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/16] time 0.182 (0.169) data 0.105 (0.092) loss_x loss_x 0.5688 (0.4967) acc_x 90.6250 (88.1250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/16] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.4629 (0.4923) acc_x 84.3750 (87.5000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3225, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 516
clean true:507
clean false:9
clean_rate:0.9825581395348837
noisy true:682
noisy false:402
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1084
epoch [196/200] batch [5/16] time 0.164 (0.166) data 0.087 (0.089) loss_x loss_x 0.7163 (0.5952) acc_x 81.2500 (83.1250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/16] time 0.160 (0.163) data 0.083 (0.086) loss_x loss_x 0.7012 (0.5893) acc_x 84.3750 (85.3125) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [15/16] time 0.158 (0.162) data 0.081 (0.085) loss_x loss_x 0.3909 (0.5469) acc_x 93.7500 (87.5000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 406
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 503
clean true:498
clean false:5
clean_rate:0.9900596421471173
noisy true:696
noisy false:401
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1097
epoch [197/200] batch [5/15] time 0.176 (0.176) data 0.098 (0.099) loss_x loss_x 0.4817 (0.3629) acc_x 84.3750 (91.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/15] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.6475 (0.4545) acc_x 78.1250 (88.4375) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [15/15] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.7891 (0.5234) acc_x 81.2500 (86.6667) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 411
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 514
clean true:507
clean false:7
clean_rate:0.9863813229571985
noisy true:682
noisy false:404
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1086
epoch [198/200] batch [5/16] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.6475 (0.4657) acc_x 81.2500 (88.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/16] time 0.154 (0.160) data 0.077 (0.083) loss_x loss_x 0.8726 (0.5471) acc_x 84.3750 (86.2500) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [15/16] time 0.160 (0.159) data 0.082 (0.083) loss_x loss_x 0.3369 (0.5472) acc_x 90.6250 (87.0833) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 389
confident_label rate tensor(0.3200, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 512
clean true:505
clean false:7
clean_rate:0.986328125
noisy true:706
noisy false:382
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1088
epoch [199/200] batch [5/16] time 0.163 (0.161) data 0.086 (0.084) loss_x loss_x 0.5459 (0.5908) acc_x 81.2500 (85.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/16] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.1483 (0.5154) acc_x 96.8750 (87.5000) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [15/16] time 0.160 (0.160) data 0.082 (0.083) loss_x loss_x 0.6465 (0.5213) acc_x 81.2500 (87.0833) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 100])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 100]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([100]), P.shape=torch.Size([1600, 100]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 100])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1600
before epoch:different number: 417
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1600
before: len of confident samples 505
clean true:498
clean false:7
clean_rate:0.9861386138613861
noisy true:685
noisy false:410
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1095
epoch [200/200] batch [5/15] time 0.166 (0.162) data 0.089 (0.085) loss_x loss_x 0.5962 (0.3679) acc_x 84.3750 (88.1250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/15] time 0.159 (0.162) data 0.082 (0.084) loss_x loss_x 0.3242 (0.4051) acc_x 90.6250 (88.1250) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [15/15] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.4429 (0.4327) acc_x 93.7500 (89.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/caltech101/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1600
after epoch: len(noisy dataset) 1600
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,465
* correct: 2,175
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 83.1%
Elapsed: 0:37:47
