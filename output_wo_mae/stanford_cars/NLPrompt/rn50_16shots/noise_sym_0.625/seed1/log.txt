***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.0737, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 231
clean true:217
clean false:14
clean_rate:0.9393939393939394
noisy true:348
noisy false:2557
after delete: len(clean_dataset) 231
after delete: len(noisy_dataset) 2905
epoch [1/200] batch [5/7] time 0.510 (0.525) data 0.380 (0.374) loss_x loss_x 2.6836 (3.0645) acc_x 50.0000 (42.5000) lr 1.0000e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2508
confident_label rate tensor(0.0781, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 245
clean true:234
clean false:11
clean_rate:0.9551020408163265
noisy true:394
noisy false:2497
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 2891
epoch [2/200] batch [5/7] time 0.506 (0.531) data 0.375 (0.398) loss_x loss_x 1.5244 (1.8678) acc_x 53.1250 (51.8750) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2068
confident_label rate tensor(0.1307, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 410
clean true:402
clean false:8
clean_rate:0.9804878048780488
noisy true:666
noisy false:2060
after delete: len(clean_dataset) 410
after delete: len(noisy_dataset) 2726
epoch [3/200] batch [5/12] time 0.424 (0.524) data 0.293 (0.393) loss_x loss_x 2.3691 (1.9350) acc_x 46.8750 (51.8750) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/12] time 0.475 (0.509) data 0.345 (0.379) loss_x loss_x 2.0039 (1.8130) acc_x 50.0000 (54.0625) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1952
confident_label rate tensor(0.1425, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 447
clean true:440
clean false:7
clean_rate:0.9843400447427293
noisy true:744
noisy false:1945
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 2689
epoch [4/200] batch [5/13] time 0.746 (0.572) data 0.616 (0.441) loss_x loss_x 1.6973 (1.8934) acc_x 59.3750 (50.6250) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/13] time 0.583 (0.529) data 0.452 (0.399) loss_x loss_x 1.3936 (1.6988) acc_x 65.6250 (55.9375) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1895
confident_label rate tensor(0.1502, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 471
clean true:461
clean false:10
clean_rate:0.9787685774946921
noisy true:780
noisy false:1885
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 2665
epoch [5/200] batch [5/14] time 0.391 (0.464) data 0.261 (0.334) loss_x loss_x 2.1191 (1.8062) acc_x 50.0000 (56.8750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/14] time 0.520 (0.481) data 0.390 (0.351) loss_x loss_x 1.4375 (1.7181) acc_x 59.3750 (57.5000) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1882
confident_label rate tensor(0.1496, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 469
clean true:464
clean false:5
clean_rate:0.9893390191897654
noisy true:790
noisy false:1877
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 2667
epoch [6/200] batch [5/14] time 0.513 (0.519) data 0.384 (0.389) loss_x loss_x 1.7051 (1.6277) acc_x 53.1250 (56.8750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/14] time 0.482 (0.512) data 0.352 (0.382) loss_x loss_x 1.4199 (1.6257) acc_x 68.7500 (58.1250) lr 1.9980e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1877
confident_label rate tensor(0.1480, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 464
clean true:454
clean false:10
clean_rate:0.978448275862069
noisy true:805
noisy false:1867
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 2672
epoch [7/200] batch [5/14] time 0.411 (0.532) data 0.280 (0.401) loss_x loss_x 1.2949 (1.4639) acc_x 59.3750 (59.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/14] time 0.562 (0.524) data 0.432 (0.394) loss_x loss_x 1.9209 (1.6042) acc_x 56.2500 (59.0625) lr 1.9969e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1857
confident_label rate tensor(0.1547, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 485
clean true:481
clean false:4
clean_rate:0.9917525773195877
noisy true:798
noisy false:1853
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 2651
epoch [8/200] batch [5/15] time 0.548 (0.456) data 0.417 (0.326) loss_x loss_x 1.5957 (1.5410) acc_x 65.6250 (62.5000) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/15] time 0.482 (0.490) data 0.351 (0.360) loss_x loss_x 1.8271 (1.6313) acc_x 46.8750 (61.8750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/15] time 0.766 (0.507) data 0.636 (0.377) loss_x loss_x 1.4727 (1.6365) acc_x 53.1250 (60.6250) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1854
confident_label rate tensor(0.1598, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 501
clean true:490
clean false:11
clean_rate:0.9780439121756487
noisy true:792
noisy false:1843
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 2635
epoch [9/200] batch [5/15] time 0.399 (0.470) data 0.268 (0.339) loss_x loss_x 1.4990 (1.5768) acc_x 59.3750 (56.8750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/15] time 0.418 (0.457) data 0.288 (0.326) loss_x loss_x 1.8506 (1.5353) acc_x 56.2500 (60.0000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/15] time 0.499 (0.501) data 0.368 (0.371) loss_x loss_x 1.9951 (1.5762) acc_x 50.0000 (59.3750) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1834
confident_label rate tensor(0.1623, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 509
clean true:502
clean false:7
clean_rate:0.9862475442043221
noisy true:800
noisy false:1827
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 2627
epoch [10/200] batch [5/15] time 0.639 (0.560) data 0.509 (0.430) loss_x loss_x 1.4141 (1.4973) acc_x 65.6250 (58.7500) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/15] time 0.389 (0.536) data 0.259 (0.405) loss_x loss_x 2.0840 (1.5911) acc_x 53.1250 (57.8125) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/15] time 0.657 (0.514) data 0.527 (0.383) loss_x loss_x 1.8174 (1.6690) acc_x 53.1250 (55.0000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.1601, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 502
clean true:493
clean false:9
clean_rate:0.9820717131474104
noisy true:848
noisy false:1786
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 2634
epoch [11/200] batch [5/15] time 0.676 (0.550) data 0.546 (0.419) loss_x loss_x 1.1904 (1.4846) acc_x 59.3750 (62.5000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/15] time 0.515 (0.510) data 0.385 (0.379) loss_x loss_x 1.2793 (1.5203) acc_x 62.5000 (62.1875) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/15] time 0.541 (0.494) data 0.410 (0.364) loss_x loss_x 1.6895 (1.5591) acc_x 65.6250 (62.0833) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.1598, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 501
clean true:494
clean false:7
clean_rate:0.9860279441117764
noisy true:827
noisy false:1808
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 2635
epoch [12/200] batch [5/15] time 0.395 (0.510) data 0.265 (0.380) loss_x loss_x 1.7295 (1.4937) acc_x 53.1250 (60.6250) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/15] time 0.611 (0.500) data 0.479 (0.370) loss_x loss_x 1.3662 (1.5257) acc_x 65.6250 (60.3125) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/15] time 0.394 (0.481) data 0.264 (0.351) loss_x loss_x 1.6113 (1.6187) acc_x 59.3750 (58.3333) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1853
confident_label rate tensor(0.1527, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 479
clean true:472
clean false:7
clean_rate:0.9853862212943633
noisy true:811
noisy false:1846
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 2657
epoch [13/200] batch [5/14] time 0.458 (0.486) data 0.327 (0.355) loss_x loss_x 1.4395 (1.2916) acc_x 59.3750 (65.0000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/14] time 0.356 (0.446) data 0.226 (0.315) loss_x loss_x 1.6055 (1.4628) acc_x 59.3750 (60.6250) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1846
confident_label rate tensor(0.1537, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 482
clean true:474
clean false:8
clean_rate:0.983402489626556
noisy true:816
noisy false:1838
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 2654
epoch [14/200] batch [5/15] time 0.407 (0.466) data 0.277 (0.335) loss_x loss_x 1.5469 (1.4971) acc_x 71.8750 (63.7500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/15] time 0.377 (0.479) data 0.246 (0.348) loss_x loss_x 2.1191 (1.6724) acc_x 53.1250 (59.6875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/15] time 0.430 (0.497) data 0.301 (0.367) loss_x loss_x 1.2461 (1.5888) acc_x 75.0000 (60.8333) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1838
confident_label rate tensor(0.1569, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 492
clean true:485
clean false:7
clean_rate:0.9857723577235772
noisy true:813
noisy false:1831
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 2644
epoch [15/200] batch [5/15] time 0.395 (0.434) data 0.264 (0.303) loss_x loss_x 1.4385 (1.4760) acc_x 56.2500 (63.1250) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/15] time 0.529 (0.475) data 0.399 (0.344) loss_x loss_x 1.5674 (1.4900) acc_x 62.5000 (62.1875) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/15] time 0.518 (0.492) data 0.387 (0.361) loss_x loss_x 0.8472 (1.4392) acc_x 78.1250 (63.3333) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1844
confident_label rate tensor(0.1614, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 506
clean true:497
clean false:9
clean_rate:0.9822134387351779
noisy true:795
noisy false:1835
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 2630
epoch [16/200] batch [5/15] time 0.689 (0.511) data 0.558 (0.380) loss_x loss_x 1.3057 (1.4576) acc_x 56.2500 (61.2500) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/15] time 0.501 (0.481) data 0.371 (0.350) loss_x loss_x 1.0430 (1.5155) acc_x 75.0000 (59.0625) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/15] time 0.589 (0.475) data 0.459 (0.345) loss_x loss_x 1.2617 (1.5297) acc_x 62.5000 (59.1667) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1826
confident_label rate tensor(0.1661, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 521
clean true:515
clean false:6
clean_rate:0.9884836852207294
noisy true:795
noisy false:1820
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 2615
epoch [17/200] batch [5/16] time 0.584 (0.477) data 0.453 (0.346) loss_x loss_x 1.8037 (1.4697) acc_x 50.0000 (60.6250) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/16] time 0.406 (0.470) data 0.275 (0.339) loss_x loss_x 1.4521 (1.4998) acc_x 53.1250 (60.3125) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/16] time 0.638 (0.484) data 0.507 (0.353) loss_x loss_x 2.8047 (1.5973) acc_x 46.8750 (60.8333) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1822
confident_label rate tensor(0.1614, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 506
clean true:502
clean false:4
clean_rate:0.9920948616600791
noisy true:812
noisy false:1818
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 2630
epoch [18/200] batch [5/15] time 0.588 (0.510) data 0.457 (0.379) loss_x loss_x 1.6621 (1.4908) acc_x 59.3750 (59.3750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/15] time 0.464 (0.499) data 0.333 (0.368) loss_x loss_x 1.4434 (1.5409) acc_x 59.3750 (57.1875) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/15] time 0.472 (0.490) data 0.342 (0.359) loss_x loss_x 1.8291 (1.6313) acc_x 56.2500 (58.7500) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1839
confident_label rate tensor(0.1591, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 499
clean true:483
clean false:16
clean_rate:0.9679358717434869
noisy true:814
noisy false:1823
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 2637
epoch [19/200] batch [5/15] time 0.426 (0.524) data 0.295 (0.392) loss_x loss_x 1.5557 (1.2529) acc_x 62.5000 (64.3750) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/15] time 0.404 (0.500) data 0.274 (0.369) loss_x loss_x 1.7812 (1.3836) acc_x 65.6250 (64.6875) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/15] time 0.607 (0.495) data 0.477 (0.365) loss_x loss_x 1.7480 (1.4885) acc_x 53.1250 (62.2917) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1816
confident_label rate tensor(0.1649, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 517
clean true:509
clean false:8
clean_rate:0.9845261121856866
noisy true:811
noisy false:1808
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 2619
epoch [20/200] batch [5/16] time 0.580 (0.525) data 0.451 (0.394) loss_x loss_x 1.4873 (1.5830) acc_x 53.1250 (61.8750) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/16] time 0.373 (0.498) data 0.241 (0.367) loss_x loss_x 1.6748 (1.5500) acc_x 56.2500 (61.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/16] time 0.461 (0.493) data 0.330 (0.362) loss_x loss_x 1.8936 (1.5502) acc_x 43.7500 (60.2083) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1905
confident_label rate tensor(0.1508, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 473
clean true:468
clean false:5
clean_rate:0.9894291754756871
noisy true:763
noisy false:1900
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 2663
epoch [21/200] batch [5/14] time 0.471 (0.454) data 0.341 (0.324) loss_x loss_x 1.4863 (1.3068) acc_x 59.3750 (65.0000) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/14] time 0.587 (0.451) data 0.458 (0.321) loss_x loss_x 1.7822 (1.5151) acc_x 59.3750 (61.8750) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1864
confident_label rate tensor(0.1543, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 484
clean true:480
clean false:4
clean_rate:0.9917355371900827
noisy true:792
noisy false:1860
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 2652
epoch [22/200] batch [5/15] time 0.379 (0.468) data 0.249 (0.337) loss_x loss_x 1.5254 (1.4219) acc_x 59.3750 (65.6250) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/15] time 0.546 (0.484) data 0.416 (0.353) loss_x loss_x 1.3203 (1.4023) acc_x 68.7500 (67.1875) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/15] time 0.467 (0.481) data 0.336 (0.350) loss_x loss_x 1.5566 (1.4714) acc_x 56.2500 (64.5833) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.1633, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 512
clean true:509
clean false:3
clean_rate:0.994140625
noisy true:810
noisy false:1814
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 2624
epoch [23/200] batch [5/16] time 0.720 (0.565) data 0.589 (0.434) loss_x loss_x 1.8281 (1.7637) acc_x 59.3750 (55.0000) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/16] time 0.406 (0.525) data 0.275 (0.395) loss_x loss_x 1.1475 (1.6322) acc_x 71.8750 (57.5000) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/16] time 0.357 (0.501) data 0.226 (0.370) loss_x loss_x 1.2656 (1.5924) acc_x 56.2500 (57.7083) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.1658, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 520
clean true:517
clean false:3
clean_rate:0.9942307692307693
noisy true:804
noisy false:1812
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 2616
epoch [24/200] batch [5/16] time 0.399 (0.477) data 0.267 (0.346) loss_x loss_x 1.4072 (1.5541) acc_x 59.3750 (62.5000) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/16] time 0.471 (0.467) data 0.339 (0.336) loss_x loss_x 1.8330 (1.5612) acc_x 46.8750 (59.3750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/16] time 0.401 (0.474) data 0.270 (0.343) loss_x loss_x 1.5146 (1.5410) acc_x 71.8750 (59.3750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1857
confident_label rate tensor(0.1572, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 493
clean true:488
clean false:5
clean_rate:0.9898580121703854
noisy true:791
noisy false:1852
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 2643
epoch [25/200] batch [5/15] time 0.498 (0.523) data 0.367 (0.391) loss_x loss_x 1.3428 (1.4715) acc_x 62.5000 (65.0000) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/15] time 0.448 (0.509) data 0.317 (0.377) loss_x loss_x 1.5176 (1.4824) acc_x 56.2500 (64.6875) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/15] time 0.422 (0.504) data 0.291 (0.372) loss_x loss_x 1.2500 (1.4271) acc_x 65.6250 (64.3750) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1788
confident_label rate tensor(0.1668, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 523
clean true:512
clean false:11
clean_rate:0.9789674952198852
noisy true:836
noisy false:1777
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 2613
epoch [26/200] batch [5/16] time 0.408 (0.470) data 0.277 (0.339) loss_x loss_x 1.4727 (1.6187) acc_x 53.1250 (53.7500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/16] time 0.433 (0.498) data 0.302 (0.367) loss_x loss_x 1.6797 (1.6059) acc_x 50.0000 (54.3750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/16] time 0.604 (0.513) data 0.473 (0.382) loss_x loss_x 1.3330 (1.5618) acc_x 68.7500 (57.2917) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.1649, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 517
clean true:512
clean false:5
clean_rate:0.9903288201160542
noisy true:806
noisy false:1813
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 2619
epoch [27/200] batch [5/16] time 0.411 (0.411) data 0.280 (0.280) loss_x loss_x 1.7588 (1.7287) acc_x 59.3750 (58.7500) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/16] time 0.456 (0.435) data 0.325 (0.304) loss_x loss_x 1.6084 (1.6187) acc_x 53.1250 (60.3125) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/16] time 0.482 (0.454) data 0.351 (0.323) loss_x loss_x 1.7354 (1.5206) acc_x 56.2500 (61.0417) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1855
confident_label rate tensor(0.1588, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 498
clean true:492
clean false:6
clean_rate:0.9879518072289156
noisy true:789
noisy false:1849
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 2638
epoch [28/200] batch [5/15] time 0.503 (0.526) data 0.371 (0.395) loss_x loss_x 1.4111 (1.6699) acc_x 62.5000 (58.1250) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/15] time 0.532 (0.513) data 0.401 (0.382) loss_x loss_x 1.5166 (1.5766) acc_x 62.5000 (59.6875) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/15] time 0.438 (0.491) data 0.308 (0.360) loss_x loss_x 1.6445 (1.5907) acc_x 50.0000 (58.7500) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1821
confident_label rate tensor(0.1645, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 516
clean true:510
clean false:6
clean_rate:0.9883720930232558
noisy true:805
noisy false:1815
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 2620
epoch [29/200] batch [5/16] time 0.602 (0.541) data 0.471 (0.409) loss_x loss_x 1.5869 (1.4732) acc_x 65.6250 (66.8750) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/16] time 0.529 (0.497) data 0.397 (0.366) loss_x loss_x 1.2949 (1.5204) acc_x 68.7500 (65.6250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/16] time 0.520 (0.494) data 0.390 (0.362) loss_x loss_x 1.4385 (1.4653) acc_x 56.2500 (64.7917) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1794
confident_label rate tensor(0.1661, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 521
clean true:514
clean false:7
clean_rate:0.9865642994241842
noisy true:828
noisy false:1787
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 2615
epoch [30/200] batch [5/16] time 0.446 (0.504) data 0.315 (0.372) loss_x loss_x 0.9658 (1.3670) acc_x 78.1250 (68.1250) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/16] time 0.437 (0.502) data 0.307 (0.371) loss_x loss_x 1.6240 (1.5586) acc_x 59.3750 (63.4375) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/16] time 0.572 (0.487) data 0.440 (0.356) loss_x loss_x 1.5732 (1.5354) acc_x 62.5000 (63.3333) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1793
confident_label rate tensor(0.1773, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 556
clean true:544
clean false:12
clean_rate:0.9784172661870504
noisy true:799
noisy false:1781
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 2580
epoch [31/200] batch [5/17] time 0.446 (0.515) data 0.315 (0.384) loss_x loss_x 1.3047 (1.6611) acc_x 56.2500 (57.5000) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/17] time 0.527 (0.495) data 0.397 (0.364) loss_x loss_x 1.0088 (1.6084) acc_x 75.0000 (59.3750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/17] time 0.478 (0.489) data 0.347 (0.359) loss_x loss_x 1.4678 (1.5486) acc_x 71.8750 (61.8750) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1809
confident_label rate tensor(0.1645, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 516
clean true:506
clean false:10
clean_rate:0.9806201550387597
noisy true:821
noisy false:1799
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 2620
epoch [32/200] batch [5/16] time 0.427 (0.489) data 0.296 (0.359) loss_x loss_x 1.6270 (1.4475) acc_x 50.0000 (60.0000) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/16] time 0.559 (0.502) data 0.428 (0.371) loss_x loss_x 1.3418 (1.5520) acc_x 56.2500 (56.5625) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/16] time 0.464 (0.489) data 0.333 (0.358) loss_x loss_x 1.0430 (1.4715) acc_x 71.8750 (59.5833) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1834
confident_label rate tensor(0.1680, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 527
clean true:518
clean false:9
clean_rate:0.9829222011385199
noisy true:784
noisy false:1825
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 2609
epoch [33/200] batch [5/16] time 0.358 (0.414) data 0.227 (0.283) loss_x loss_x 1.7207 (1.4719) acc_x 56.2500 (61.2500) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/16] time 0.491 (0.455) data 0.361 (0.324) loss_x loss_x 1.0713 (1.3699) acc_x 75.0000 (64.3750) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/16] time 0.556 (0.453) data 0.425 (0.322) loss_x loss_x 1.5703 (1.5164) acc_x 59.3750 (60.4167) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1822
confident_label rate tensor(0.1620, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 508
clean true:505
clean false:3
clean_rate:0.9940944881889764
noisy true:809
noisy false:1819
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 2628
epoch [34/200] batch [5/15] time 0.473 (0.472) data 0.343 (0.341) loss_x loss_x 2.0254 (1.5158) acc_x 56.2500 (61.8750) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/15] time 0.462 (0.493) data 0.331 (0.362) loss_x loss_x 1.0479 (1.5377) acc_x 68.7500 (61.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/15] time 0.470 (0.478) data 0.339 (0.347) loss_x loss_x 1.6436 (1.5343) acc_x 53.1250 (61.2500) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1792
confident_label rate tensor(0.1744, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 547
clean true:539
clean false:8
clean_rate:0.9853747714808044
noisy true:805
noisy false:1784
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 2589
epoch [35/200] batch [5/17] time 0.413 (0.497) data 0.282 (0.366) loss_x loss_x 2.0293 (1.3895) acc_x 50.0000 (63.1250) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/17] time 0.462 (0.493) data 0.331 (0.362) loss_x loss_x 1.4961 (1.4729) acc_x 53.1250 (60.3125) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/17] time 0.442 (0.502) data 0.311 (0.371) loss_x loss_x 2.2324 (1.5096) acc_x 43.7500 (59.3750) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.1665, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 522
clean true:517
clean false:5
clean_rate:0.9904214559386973
noisy true:802
noisy false:1812
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 2614
epoch [36/200] batch [5/16] time 0.490 (0.475) data 0.358 (0.343) loss_x loss_x 1.7520 (1.3893) acc_x 62.5000 (61.8750) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/16] time 0.475 (0.500) data 0.345 (0.368) loss_x loss_x 1.6982 (1.5000) acc_x 59.3750 (60.6250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/16] time 0.397 (0.499) data 0.266 (0.367) loss_x loss_x 1.9521 (1.5195) acc_x 56.2500 (61.0417) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1785
confident_label rate tensor(0.1735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 544
clean true:536
clean false:8
clean_rate:0.9852941176470589
noisy true:815
noisy false:1777
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 2592
epoch [37/200] batch [5/17] time 0.474 (0.461) data 0.343 (0.330) loss_x loss_x 1.7754 (1.4998) acc_x 56.2500 (58.7500) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/17] time 0.447 (0.480) data 0.315 (0.348) loss_x loss_x 1.5791 (1.5535) acc_x 65.6250 (59.0625) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/17] time 0.365 (0.489) data 0.233 (0.358) loss_x loss_x 1.6641 (1.5337) acc_x 59.3750 (58.1250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1788
confident_label rate tensor(0.1693, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 531
clean true:522
clean false:9
clean_rate:0.9830508474576272
noisy true:826
noisy false:1779
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 2605
epoch [38/200] batch [5/16] time 0.475 (0.487) data 0.345 (0.356) loss_x loss_x 1.2295 (1.2010) acc_x 71.8750 (66.2500) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/16] time 0.427 (0.476) data 0.296 (0.345) loss_x loss_x 1.3105 (1.3908) acc_x 62.5000 (62.1875) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/16] time 0.593 (0.489) data 0.462 (0.358) loss_x loss_x 1.2227 (1.4132) acc_x 65.6250 (62.2917) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1794
confident_label rate tensor(0.1732, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 543
clean true:537
clean false:6
clean_rate:0.988950276243094
noisy true:805
noisy false:1788
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 2593
epoch [39/200] batch [5/16] time 0.379 (0.426) data 0.249 (0.295) loss_x loss_x 1.3164 (1.3811) acc_x 56.2500 (58.1250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/16] time 0.597 (0.449) data 0.465 (0.319) loss_x loss_x 1.6270 (1.3729) acc_x 56.2500 (60.9375) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/16] time 0.514 (0.477) data 0.383 (0.346) loss_x loss_x 1.6279 (1.4299) acc_x 50.0000 (60.4167) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1831
confident_label rate tensor(0.1607, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 504
clean true:496
clean false:8
clean_rate:0.9841269841269841
noisy true:809
noisy false:1823
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 2632
epoch [40/200] batch [5/15] time 0.404 (0.462) data 0.273 (0.331) loss_x loss_x 1.1611 (1.4924) acc_x 59.3750 (62.5000) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/15] time 0.526 (0.462) data 0.396 (0.332) loss_x loss_x 1.4600 (1.4315) acc_x 56.2500 (62.5000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/15] time 0.780 (0.487) data 0.649 (0.357) loss_x loss_x 1.3496 (1.5065) acc_x 68.7500 (60.8333) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1765
confident_label rate tensor(0.1725, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 541
clean true:533
clean false:8
clean_rate:0.9852125693160814
noisy true:838
noisy false:1757
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 2595
epoch [41/200] batch [5/16] time 0.546 (0.460) data 0.415 (0.330) loss_x loss_x 1.5186 (1.3556) acc_x 62.5000 (67.5000) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/16] time 0.609 (0.476) data 0.478 (0.345) loss_x loss_x 1.6357 (1.4111) acc_x 56.2500 (64.6875) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/16] time 0.420 (0.468) data 0.289 (0.337) loss_x loss_x 1.2256 (1.3353) acc_x 68.7500 (64.7917) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.1747, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 548
clean true:541
clean false:7
clean_rate:0.9872262773722628
noisy true:838
noisy false:1750
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 2588
epoch [42/200] batch [5/17] time 0.572 (0.459) data 0.441 (0.328) loss_x loss_x 1.3535 (1.7145) acc_x 62.5000 (53.7500) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/17] time 0.391 (0.492) data 0.261 (0.360) loss_x loss_x 1.4297 (1.6319) acc_x 68.7500 (58.4375) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/17] time 0.472 (0.490) data 0.342 (0.359) loss_x loss_x 1.9121 (1.5908) acc_x 50.0000 (59.7917) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1778
confident_label rate tensor(0.1741, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 546
clean true:541
clean false:5
clean_rate:0.9908424908424909
noisy true:817
noisy false:1773
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 2590
epoch [43/200] batch [5/17] time 0.565 (0.491) data 0.433 (0.360) loss_x loss_x 1.6553 (1.5537) acc_x 65.6250 (55.6250) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/17] time 0.772 (0.484) data 0.641 (0.353) loss_x loss_x 1.7549 (1.6366) acc_x 40.6250 (54.6875) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/17] time 0.513 (0.485) data 0.383 (0.354) loss_x loss_x 1.2002 (1.5421) acc_x 68.7500 (57.7083) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1770
confident_label rate tensor(0.1716, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 538
clean true:531
clean false:7
clean_rate:0.9869888475836431
noisy true:835
noisy false:1763
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 2598
epoch [44/200] batch [5/16] time 0.335 (0.426) data 0.204 (0.296) loss_x loss_x 1.6104 (1.3937) acc_x 65.6250 (66.8750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/16] time 0.602 (0.452) data 0.471 (0.321) loss_x loss_x 1.3730 (1.4443) acc_x 53.1250 (64.3750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/16] time 0.596 (0.458) data 0.464 (0.327) loss_x loss_x 1.4785 (1.5378) acc_x 65.6250 (61.4583) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1802
confident_label rate tensor(0.1655, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 519
clean true:512
clean false:7
clean_rate:0.9865125240847784
noisy true:822
noisy false:1795
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 2617
epoch [45/200] batch [5/16] time 0.493 (0.443) data 0.362 (0.312) loss_x loss_x 1.6729 (1.6982) acc_x 43.7500 (50.6250) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/16] time 0.481 (0.468) data 0.349 (0.337) loss_x loss_x 1.5020 (1.6028) acc_x 50.0000 (54.0625) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/16] time 0.575 (0.496) data 0.445 (0.365) loss_x loss_x 1.1035 (1.5444) acc_x 62.5000 (55.4167) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1779
confident_label rate tensor(0.1706, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 535
clean true:530
clean false:5
clean_rate:0.9906542056074766
noisy true:827
noisy false:1774
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 2601
epoch [46/200] batch [5/16] time 0.804 (0.549) data 0.672 (0.418) loss_x loss_x 1.6172 (1.3643) acc_x 50.0000 (61.2500) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [10/16] time 0.408 (0.496) data 0.277 (0.365) loss_x loss_x 1.7021 (1.3854) acc_x 65.6250 (63.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/16] time 0.459 (0.490) data 0.328 (0.359) loss_x loss_x 1.1221 (1.3428) acc_x 65.6250 (63.7500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1758
confident_label rate tensor(0.1741, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 546
clean true:542
clean false:4
clean_rate:0.9926739926739927
noisy true:836
noisy false:1754
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 2590
epoch [47/200] batch [5/17] time 0.500 (0.461) data 0.369 (0.330) loss_x loss_x 1.3809 (1.3542) acc_x 56.2500 (64.3750) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/17] time 0.520 (0.498) data 0.389 (0.367) loss_x loss_x 1.4795 (1.4241) acc_x 62.5000 (62.8125) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/17] time 0.582 (0.495) data 0.452 (0.364) loss_x loss_x 1.1055 (1.3914) acc_x 65.6250 (63.9583) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1739
confident_label rate tensor(0.1783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 559
clean true:551
clean false:8
clean_rate:0.9856887298747764
noisy true:846
noisy false:1731
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 2577
epoch [48/200] batch [5/17] time 0.525 (0.497) data 0.394 (0.365) loss_x loss_x 1.5557 (1.4556) acc_x 56.2500 (61.8750) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/17] time 0.462 (0.493) data 0.331 (0.362) loss_x loss_x 1.5488 (1.5608) acc_x 46.8750 (56.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/17] time 0.386 (0.482) data 0.255 (0.351) loss_x loss_x 1.6113 (1.5377) acc_x 43.7500 (58.7500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.1700, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 533
clean true:525
clean false:8
clean_rate:0.9849906191369606
noisy true:852
noisy false:1751
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 2603
epoch [49/200] batch [5/16] time 0.494 (0.494) data 0.363 (0.364) loss_x loss_x 1.8486 (1.4969) acc_x 50.0000 (61.2500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/16] time 0.528 (0.484) data 0.397 (0.353) loss_x loss_x 1.4990 (1.4619) acc_x 59.3750 (61.5625) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/16] time 0.389 (0.470) data 0.258 (0.339) loss_x loss_x 1.3066 (1.3766) acc_x 71.8750 (64.3750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1737
confident_label rate tensor(0.1776, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 557
clean true:550
clean false:7
clean_rate:0.9874326750448833
noisy true:849
noisy false:1730
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 2579
epoch [50/200] batch [5/17] time 0.422 (0.435) data 0.291 (0.304) loss_x loss_x 1.8223 (1.5945) acc_x 62.5000 (63.7500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/17] time 0.385 (0.463) data 0.255 (0.332) loss_x loss_x 1.7275 (1.4653) acc_x 53.1250 (64.3750) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/17] time 0.593 (0.469) data 0.462 (0.339) loss_x loss_x 1.3984 (1.4180) acc_x 65.6250 (64.7917) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1782
confident_label rate tensor(0.1712, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 537
clean true:529
clean false:8
clean_rate:0.9851024208566108
noisy true:825
noisy false:1774
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 2599
epoch [51/200] batch [5/16] time 0.403 (0.452) data 0.273 (0.321) loss_x loss_x 1.5684 (1.3302) acc_x 59.3750 (67.5000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/16] time 0.558 (0.499) data 0.427 (0.368) loss_x loss_x 1.1367 (1.3114) acc_x 71.8750 (67.5000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/16] time 0.501 (0.504) data 0.371 (0.374) loss_x loss_x 2.0156 (1.3696) acc_x 56.2500 (66.2500) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1736
confident_label rate tensor(0.1821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 571
clean true:560
clean false:11
clean_rate:0.9807355516637478
noisy true:840
noisy false:1725
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 2565
epoch [52/200] batch [5/17] time 0.577 (0.486) data 0.446 (0.355) loss_x loss_x 1.2139 (1.2877) acc_x 81.2500 (70.0000) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/17] time 0.361 (0.481) data 0.230 (0.350) loss_x loss_x 0.9609 (1.3575) acc_x 78.1250 (67.5000) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/17] time 0.484 (0.487) data 0.353 (0.356) loss_x loss_x 1.8730 (1.3525) acc_x 43.7500 (67.2917) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1754
confident_label rate tensor(0.1760, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 552
clean true:545
clean false:7
clean_rate:0.9873188405797102
noisy true:837
noisy false:1747
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 2584
epoch [53/200] batch [5/17] time 0.462 (0.440) data 0.331 (0.309) loss_x loss_x 1.3906 (1.3867) acc_x 71.8750 (65.6250) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/17] time 0.342 (0.452) data 0.211 (0.321) loss_x loss_x 1.5869 (1.3705) acc_x 62.5000 (67.8125) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/17] time 0.455 (0.446) data 0.324 (0.315) loss_x loss_x 2.1914 (1.4971) acc_x 50.0000 (64.1667) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.1798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 564
clean true:551
clean false:13
clean_rate:0.9769503546099291
noisy true:819
noisy false:1753
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 2572
epoch [54/200] batch [5/17] time 0.384 (0.454) data 0.254 (0.324) loss_x loss_x 1.8359 (1.7314) acc_x 62.5000 (58.1250) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/17] time 0.506 (0.466) data 0.375 (0.335) loss_x loss_x 1.1543 (1.5656) acc_x 68.7500 (62.1875) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/17] time 0.603 (0.470) data 0.473 (0.339) loss_x loss_x 1.4404 (1.4862) acc_x 56.2500 (62.7083) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1796
confident_label rate tensor(0.1652, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 518
clean true:509
clean false:9
clean_rate:0.9826254826254827
noisy true:831
noisy false:1787
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 2618
epoch [55/200] batch [5/16] time 0.343 (0.468) data 0.213 (0.337) loss_x loss_x 2.0488 (1.5109) acc_x 50.0000 (64.3750) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/16] time 0.577 (0.480) data 0.447 (0.350) loss_x loss_x 1.0996 (1.3476) acc_x 71.8750 (68.1250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/16] time 0.398 (0.476) data 0.267 (0.345) loss_x loss_x 1.5410 (1.4098) acc_x 68.7500 (66.0417) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1721
confident_label rate tensor(0.1846, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 579
clean true:569
clean false:10
clean_rate:0.9827288428324698
noisy true:846
noisy false:1711
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 2557
epoch [56/200] batch [5/18] time 0.351 (0.433) data 0.220 (0.302) loss_x loss_x 2.0234 (1.6258) acc_x 53.1250 (59.3750) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/18] time 0.463 (0.441) data 0.333 (0.310) loss_x loss_x 1.4492 (1.5847) acc_x 56.2500 (59.0625) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/18] time 0.489 (0.452) data 0.359 (0.321) loss_x loss_x 1.5234 (1.5147) acc_x 68.7500 (61.2500) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.1792, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 562
clean true:554
clean false:8
clean_rate:0.9857651245551602
noisy true:815
noisy false:1759
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 2574
epoch [57/200] batch [5/17] time 0.434 (0.477) data 0.304 (0.346) loss_x loss_x 2.0352 (1.3527) acc_x 50.0000 (66.8750) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/17] time 0.524 (0.459) data 0.393 (0.328) loss_x loss_x 1.2197 (1.3482) acc_x 65.6250 (65.0000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/17] time 0.521 (0.473) data 0.390 (0.342) loss_x loss_x 2.3301 (1.4267) acc_x 53.1250 (63.9583) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1729
confident_label rate tensor(0.1827, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 573
clean true:564
clean false:9
clean_rate:0.9842931937172775
noisy true:843
noisy false:1720
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 2563
epoch [58/200] batch [5/17] time 0.441 (0.495) data 0.310 (0.364) loss_x loss_x 1.3203 (1.3752) acc_x 59.3750 (65.6250) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/17] time 0.505 (0.509) data 0.374 (0.377) loss_x loss_x 1.4297 (1.3667) acc_x 65.6250 (66.5625) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/17] time 0.489 (0.494) data 0.359 (0.363) loss_x loss_x 1.3096 (1.4788) acc_x 56.2500 (62.7083) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1749
confident_label rate tensor(0.1824, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 572
clean true:565
clean false:7
clean_rate:0.9877622377622378
noisy true:822
noisy false:1742
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 2564
epoch [59/200] batch [5/17] time 0.491 (0.475) data 0.360 (0.344) loss_x loss_x 0.6865 (1.4254) acc_x 84.3750 (64.3750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/17] time 0.562 (0.460) data 0.431 (0.329) loss_x loss_x 1.2139 (1.3335) acc_x 68.7500 (66.8750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/17] time 0.706 (0.468) data 0.575 (0.338) loss_x loss_x 1.6250 (1.3721) acc_x 56.2500 (66.2500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1737
confident_label rate tensor(0.1786, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 560
clean true:551
clean false:9
clean_rate:0.9839285714285714
noisy true:848
noisy false:1728
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 2576
epoch [60/200] batch [5/17] time 0.420 (0.458) data 0.290 (0.328) loss_x loss_x 1.7051 (1.2683) acc_x 65.6250 (68.7500) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/17] time 0.515 (0.475) data 0.385 (0.345) loss_x loss_x 1.2002 (1.2726) acc_x 68.7500 (66.8750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/17] time 0.569 (0.472) data 0.438 (0.341) loss_x loss_x 1.3086 (1.3235) acc_x 68.7500 (66.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1740
confident_label rate tensor(0.1767, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 554
clean true:546
clean false:8
clean_rate:0.9855595667870036
noisy true:850
noisy false:1732
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 2582
epoch [61/200] batch [5/17] time 0.444 (0.441) data 0.314 (0.311) loss_x loss_x 1.2529 (1.4574) acc_x 68.7500 (60.6250) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/17] time 0.475 (0.437) data 0.345 (0.306) loss_x loss_x 0.7734 (1.3076) acc_x 71.8750 (64.3750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/17] time 0.746 (0.463) data 0.615 (0.332) loss_x loss_x 1.1855 (1.3467) acc_x 59.3750 (63.5417) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1729
confident_label rate tensor(0.1808, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 567
clean true:555
clean false:12
clean_rate:0.9788359788359788
noisy true:852
noisy false:1717
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 2569
epoch [62/200] batch [5/17] time 0.410 (0.507) data 0.278 (0.376) loss_x loss_x 1.4805 (1.5764) acc_x 62.5000 (58.1250) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/17] time 0.411 (0.491) data 0.279 (0.360) loss_x loss_x 1.2256 (1.4199) acc_x 68.7500 (62.5000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/17] time 0.528 (0.493) data 0.397 (0.362) loss_x loss_x 1.0000 (1.4234) acc_x 75.0000 (63.5417) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.1846, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 579
clean true:572
clean false:7
clean_rate:0.9879101899827288
noisy true:829
noisy false:1728
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 2557
epoch [63/200] batch [5/18] time 0.514 (0.460) data 0.382 (0.328) loss_x loss_x 1.0928 (1.2822) acc_x 68.7500 (61.8750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/18] time 0.419 (0.478) data 0.289 (0.347) loss_x loss_x 1.4668 (1.3592) acc_x 65.6250 (62.8125) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/18] time 0.422 (0.465) data 0.290 (0.334) loss_x loss_x 1.0410 (1.3391) acc_x 81.2500 (65.0000) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1788
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 563
clean true:555
clean false:8
clean_rate:0.9857904085257548
noisy true:793
noisy false:1780
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 2573
epoch [64/200] batch [5/17] time 0.565 (0.512) data 0.434 (0.381) loss_x loss_x 1.0547 (1.2598) acc_x 71.8750 (65.0000) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [10/17] time 0.707 (0.497) data 0.576 (0.367) loss_x loss_x 1.6475 (1.3319) acc_x 65.6250 (65.6250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/17] time 0.506 (0.476) data 0.375 (0.345) loss_x loss_x 1.7256 (1.3610) acc_x 59.3750 (65.4167) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.1738, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 545
clean true:540
clean false:5
clean_rate:0.9908256880733946
noisy true:839
noisy false:1752
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 2591
epoch [65/200] batch [5/17] time 0.611 (0.441) data 0.481 (0.309) loss_x loss_x 0.8315 (1.2462) acc_x 78.1250 (68.7500) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/17] time 0.445 (0.470) data 0.314 (0.339) loss_x loss_x 1.4658 (1.3994) acc_x 56.2500 (64.3750) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/17] time 0.418 (0.476) data 0.286 (0.345) loss_x loss_x 1.2002 (1.3347) acc_x 65.6250 (65.4167) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1797
confident_label rate tensor(0.1744, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 547
clean true:542
clean false:5
clean_rate:0.9908592321755028
noisy true:797
noisy false:1792
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 2589
epoch [66/200] batch [5/17] time 0.419 (0.465) data 0.289 (0.334) loss_x loss_x 1.1309 (1.3959) acc_x 68.7500 (68.1250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/17] time 0.552 (0.476) data 0.421 (0.345) loss_x loss_x 1.3047 (1.3546) acc_x 68.7500 (66.5625) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/17] time 0.339 (0.478) data 0.207 (0.347) loss_x loss_x 1.5635 (1.3239) acc_x 56.2500 (66.2500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1769
confident_label rate tensor(0.1798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 564
clean true:556
clean false:8
clean_rate:0.9858156028368794
noisy true:811
noisy false:1761
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 2572
epoch [67/200] batch [5/17] time 0.549 (0.493) data 0.419 (0.362) loss_x loss_x 1.5488 (1.2886) acc_x 53.1250 (63.1250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/17] time 0.343 (0.461) data 0.212 (0.331) loss_x loss_x 1.3105 (1.3384) acc_x 65.6250 (63.7500) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/17] time 0.550 (0.477) data 0.420 (0.346) loss_x loss_x 1.3203 (1.2622) acc_x 68.7500 (65.2083) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1724
confident_label rate tensor(0.1798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 564
clean true:560
clean false:4
clean_rate:0.9929078014184397
noisy true:852
noisy false:1720
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 2572
epoch [68/200] batch [5/17] time 0.584 (0.529) data 0.453 (0.398) loss_x loss_x 1.4873 (1.4143) acc_x 68.7500 (68.1250) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [10/17] time 0.529 (0.504) data 0.399 (0.373) loss_x loss_x 1.4189 (1.3777) acc_x 65.6250 (65.0000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/17] time 0.415 (0.475) data 0.285 (0.345) loss_x loss_x 1.2520 (1.4258) acc_x 62.5000 (64.1667) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.1904, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 597
clean true:586
clean false:11
clean_rate:0.981574539363484
noisy true:835
noisy false:1704
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 2539
epoch [69/200] batch [5/18] time 0.461 (0.456) data 0.331 (0.326) loss_x loss_x 1.1826 (1.5549) acc_x 75.0000 (62.5000) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/18] time 0.486 (0.489) data 0.356 (0.358) loss_x loss_x 0.7495 (1.4772) acc_x 87.5000 (65.0000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/18] time 0.543 (0.490) data 0.412 (0.360) loss_x loss_x 1.2441 (1.4776) acc_x 71.8750 (65.0000) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1724
confident_label rate tensor(0.1910, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 599
clean true:593
clean false:6
clean_rate:0.989983305509182
noisy true:819
noisy false:1718
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 2537
epoch [70/200] batch [5/18] time 0.540 (0.476) data 0.408 (0.345) loss_x loss_x 1.5244 (1.2111) acc_x 62.5000 (68.7500) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [10/18] time 0.458 (0.471) data 0.327 (0.340) loss_x loss_x 1.5586 (1.2848) acc_x 56.2500 (68.1250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/18] time 0.516 (0.456) data 0.386 (0.325) loss_x loss_x 1.1787 (1.2449) acc_x 65.6250 (68.5417) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.1888, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 592
clean true:583
clean false:9
clean_rate:0.9847972972972973
noisy true:871
noisy false:1673
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 2544
epoch [71/200] batch [5/18] time 0.502 (0.475) data 0.370 (0.344) loss_x loss_x 0.8770 (1.2053) acc_x 71.8750 (71.2500) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [10/18] time 0.475 (0.462) data 0.345 (0.331) loss_x loss_x 1.5791 (1.4167) acc_x 68.7500 (66.8750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/18] time 0.514 (0.462) data 0.381 (0.331) loss_x loss_x 1.1416 (1.4074) acc_x 65.6250 (65.4167) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1722
confident_label rate tensor(0.1814, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 569
clean true:565
clean false:4
clean_rate:0.9929701230228472
noisy true:849
noisy false:1718
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 2567
epoch [72/200] batch [5/17] time 0.407 (0.492) data 0.277 (0.362) loss_x loss_x 1.7715 (1.4812) acc_x 43.7500 (59.3750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/17] time 0.376 (0.497) data 0.246 (0.367) loss_x loss_x 1.7803 (1.3899) acc_x 59.3750 (64.3750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/17] time 0.418 (0.486) data 0.287 (0.355) loss_x loss_x 1.1436 (1.4378) acc_x 68.7500 (63.3333) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.1776, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 557
clean true:551
clean false:6
clean_rate:0.9892280071813285
noisy true:841
noisy false:1738
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 2579
epoch [73/200] batch [5/17] time 0.478 (0.477) data 0.347 (0.347) loss_x loss_x 1.3145 (1.4660) acc_x 62.5000 (64.3750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/17] time 0.427 (0.460) data 0.296 (0.330) loss_x loss_x 1.3105 (1.4159) acc_x 65.6250 (65.0000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/17] time 0.441 (0.435) data 0.311 (0.305) loss_x loss_x 1.3320 (1.3881) acc_x 65.6250 (66.2500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.1849, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 580
clean true:572
clean false:8
clean_rate:0.9862068965517241
noisy true:849
noisy false:1707
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 2556
epoch [74/200] batch [5/18] time 0.364 (0.488) data 0.232 (0.357) loss_x loss_x 1.4111 (1.2050) acc_x 62.5000 (64.3750) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [10/18] time 0.386 (0.463) data 0.255 (0.332) loss_x loss_x 1.4092 (1.3578) acc_x 53.1250 (62.1875) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/18] time 0.388 (0.451) data 0.258 (0.320) loss_x loss_x 1.1982 (1.3586) acc_x 75.0000 (63.7500) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.1783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 559
clean true:552
clean false:7
clean_rate:0.9874776386404294
noisy true:836
noisy false:1741
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 2577
epoch [75/200] batch [5/17] time 0.371 (0.460) data 0.240 (0.328) loss_x loss_x 2.0020 (1.5148) acc_x 40.6250 (57.5000) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/17] time 0.429 (0.452) data 0.298 (0.322) loss_x loss_x 1.1807 (1.4143) acc_x 65.6250 (60.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/17] time 0.491 (0.450) data 0.360 (0.320) loss_x loss_x 0.8926 (1.3216) acc_x 90.6250 (65.0000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1707
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 586
clean true:576
clean false:10
clean_rate:0.9829351535836177
noisy true:853
noisy false:1697
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 2550
epoch [76/200] batch [5/18] time 0.477 (0.473) data 0.347 (0.343) loss_x loss_x 1.7617 (1.3802) acc_x 68.7500 (68.7500) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [10/18] time 0.558 (0.485) data 0.427 (0.354) loss_x loss_x 1.1963 (1.3807) acc_x 75.0000 (67.5000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/18] time 0.386 (0.458) data 0.256 (0.327) loss_x loss_x 2.0918 (1.4361) acc_x 50.0000 (65.4167) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.1859, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 583
clean true:576
clean false:7
clean_rate:0.9879931389365352
noisy true:816
noisy false:1737
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 2553
epoch [77/200] batch [5/18] time 0.508 (0.514) data 0.377 (0.382) loss_x loss_x 1.8398 (1.3398) acc_x 50.0000 (65.0000) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [10/18] time 0.416 (0.500) data 0.285 (0.369) loss_x loss_x 1.4121 (1.2754) acc_x 59.3750 (66.2500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/18] time 0.381 (0.490) data 0.250 (0.359) loss_x loss_x 1.5645 (1.4141) acc_x 56.2500 (63.1250) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1749
confident_label rate tensor(0.1811, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 568
clean true:562
clean false:6
clean_rate:0.9894366197183099
noisy true:825
noisy false:1743
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 2568
epoch [78/200] batch [5/17] time 0.457 (0.460) data 0.326 (0.329) loss_x loss_x 1.2783 (1.5006) acc_x 68.7500 (64.3750) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/17] time 0.406 (0.451) data 0.275 (0.320) loss_x loss_x 0.8242 (1.3648) acc_x 81.2500 (65.3125) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/17] time 0.463 (0.466) data 0.331 (0.335) loss_x loss_x 0.8975 (1.3883) acc_x 78.1250 (65.0000) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1736
confident_label rate tensor(0.1830, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 574
clean true:570
clean false:4
clean_rate:0.9930313588850174
noisy true:830
noisy false:1732
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 2562
epoch [79/200] batch [5/17] time 0.441 (0.535) data 0.310 (0.404) loss_x loss_x 0.9912 (1.2378) acc_x 78.1250 (68.7500) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [10/17] time 0.415 (0.501) data 0.285 (0.370) loss_x loss_x 1.5449 (1.2937) acc_x 53.1250 (66.5625) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/17] time 0.408 (0.503) data 0.278 (0.372) loss_x loss_x 1.0684 (1.3107) acc_x 75.0000 (67.2917) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.1929, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 605
clean true:595
clean false:10
clean_rate:0.9834710743801653
noisy true:876
noisy false:1655
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 2531
epoch [80/200] batch [5/18] time 0.487 (0.452) data 0.357 (0.322) loss_x loss_x 1.3779 (1.3533) acc_x 62.5000 (62.5000) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/18] time 0.378 (0.456) data 0.247 (0.326) loss_x loss_x 1.3838 (1.3675) acc_x 78.1250 (65.0000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/18] time 0.434 (0.462) data 0.304 (0.331) loss_x loss_x 1.8115 (1.3587) acc_x 56.2500 (65.4167) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.1856, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 582
clean true:575
clean false:7
clean_rate:0.9879725085910653
noisy true:830
noisy false:1724
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 2554
epoch [81/200] batch [5/18] time 0.451 (0.481) data 0.320 (0.350) loss_x loss_x 1.1416 (1.4005) acc_x 68.7500 (67.5000) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [10/18] time 0.343 (0.454) data 0.212 (0.323) loss_x loss_x 1.0234 (1.3909) acc_x 75.0000 (66.2500) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/18] time 0.628 (0.482) data 0.497 (0.351) loss_x loss_x 1.3330 (1.3571) acc_x 62.5000 (67.7083) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 586
clean true:580
clean false:6
clean_rate:0.9897610921501706
noisy true:825
noisy false:1725
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 2550
epoch [82/200] batch [5/18] time 0.358 (0.476) data 0.228 (0.345) loss_x loss_x 1.6025 (1.3170) acc_x 65.6250 (65.0000) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [10/18] time 0.512 (0.488) data 0.381 (0.357) loss_x loss_x 1.3994 (1.3007) acc_x 53.1250 (65.9375) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/18] time 0.394 (0.476) data 0.263 (0.345) loss_x loss_x 1.4678 (1.2766) acc_x 59.3750 (66.6667) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.1945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 610
clean true:597
clean false:13
clean_rate:0.978688524590164
noisy true:857
noisy false:1669
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 2526
epoch [83/200] batch [5/19] time 0.338 (0.446) data 0.207 (0.315) loss_x loss_x 0.8457 (1.2191) acc_x 84.3750 (69.3750) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [10/19] time 0.558 (0.467) data 0.428 (0.337) loss_x loss_x 1.2021 (1.2790) acc_x 65.6250 (68.1250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/19] time 0.422 (0.458) data 0.291 (0.327) loss_x loss_x 1.6523 (1.3356) acc_x 68.7500 (67.2917) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1739
confident_label rate tensor(0.1808, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 567
clean true:559
clean false:8
clean_rate:0.9858906525573192
noisy true:838
noisy false:1731
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 2569
epoch [84/200] batch [5/17] time 0.414 (0.482) data 0.284 (0.351) loss_x loss_x 1.2539 (1.3670) acc_x 75.0000 (70.0000) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/17] time 0.514 (0.512) data 0.382 (0.381) loss_x loss_x 1.6768 (1.3798) acc_x 53.1250 (66.2500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/17] time 0.557 (0.516) data 0.427 (0.385) loss_x loss_x 1.0459 (1.3170) acc_x 75.0000 (67.5000) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.1846, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 579
clean true:570
clean false:9
clean_rate:0.9844559585492227
noisy true:851
noisy false:1706
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 2557
epoch [85/200] batch [5/18] time 0.439 (0.424) data 0.306 (0.293) loss_x loss_x 1.9395 (1.5947) acc_x 59.3750 (63.1250) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/18] time 0.494 (0.468) data 0.364 (0.337) loss_x loss_x 1.0137 (1.2820) acc_x 71.8750 (69.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/18] time 0.476 (0.461) data 0.345 (0.330) loss_x loss_x 1.2207 (1.3016) acc_x 65.6250 (67.9167) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.1910, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 599
clean true:594
clean false:5
clean_rate:0.991652754590985
noisy true:790
noisy false:1747
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 2537
epoch [86/200] batch [5/18] time 0.526 (0.484) data 0.395 (0.352) loss_x loss_x 1.6006 (1.3998) acc_x 65.6250 (65.6250) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [10/18] time 0.346 (0.470) data 0.215 (0.338) loss_x loss_x 1.4131 (1.3086) acc_x 62.5000 (65.9375) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/18] time 0.448 (0.467) data 0.317 (0.336) loss_x loss_x 1.7930 (1.2991) acc_x 53.1250 (66.0417) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.1961, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 615
clean true:611
clean false:4
clean_rate:0.9934959349593496
noisy true:840
noisy false:1681
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 2521
epoch [87/200] batch [5/19] time 0.504 (0.470) data 0.373 (0.338) loss_x loss_x 1.3125 (1.2676) acc_x 59.3750 (66.8750) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/19] time 0.767 (0.494) data 0.637 (0.363) loss_x loss_x 1.5840 (1.3104) acc_x 75.0000 (68.1250) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/19] time 0.467 (0.482) data 0.336 (0.351) loss_x loss_x 1.6270 (1.2847) acc_x 56.2500 (67.5000) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.1881, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 590
clean true:583
clean false:7
clean_rate:0.988135593220339
noisy true:866
noisy false:1680
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 2546
epoch [88/200] batch [5/18] time 0.536 (0.473) data 0.405 (0.342) loss_x loss_x 1.2285 (1.2732) acc_x 65.6250 (65.6250) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [10/18] time 0.498 (0.461) data 0.367 (0.330) loss_x loss_x 2.1738 (1.3864) acc_x 46.8750 (64.0625) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/18] time 0.401 (0.485) data 0.271 (0.354) loss_x loss_x 0.9282 (1.3669) acc_x 78.1250 (65.0000) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1750
confident_label rate tensor(0.1821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 571
clean true:567
clean false:4
clean_rate:0.9929947460595446
noisy true:819
noisy false:1746
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 2565
epoch [89/200] batch [5/17] time 0.463 (0.460) data 0.331 (0.329) loss_x loss_x 1.6943 (1.4387) acc_x 59.3750 (65.6250) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/17] time 0.484 (0.474) data 0.354 (0.343) loss_x loss_x 1.1094 (1.2977) acc_x 62.5000 (66.8750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/17] time 0.550 (0.481) data 0.419 (0.350) loss_x loss_x 1.3750 (1.2563) acc_x 56.2500 (68.1250) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.1910, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 599
clean true:593
clean false:6
clean_rate:0.989983305509182
noisy true:861
noisy false:1676
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 2537
epoch [90/200] batch [5/18] time 0.448 (0.437) data 0.317 (0.306) loss_x loss_x 1.6689 (1.2370) acc_x 56.2500 (70.6250) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/18] time 0.491 (0.463) data 0.360 (0.332) loss_x loss_x 1.0537 (1.2444) acc_x 75.0000 (68.7500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/18] time 0.430 (0.471) data 0.299 (0.340) loss_x loss_x 1.0273 (1.2674) acc_x 65.6250 (67.9167) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1717
confident_label rate tensor(0.1849, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 580
clean true:571
clean false:9
clean_rate:0.9844827586206897
noisy true:848
noisy false:1708
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 2556
epoch [91/200] batch [5/18] time 0.365 (0.420) data 0.234 (0.289) loss_x loss_x 1.1279 (1.3557) acc_x 65.6250 (65.6250) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/18] time 0.529 (0.437) data 0.399 (0.306) loss_x loss_x 1.1875 (1.3302) acc_x 62.5000 (65.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/18] time 0.417 (0.449) data 0.286 (0.319) loss_x loss_x 1.3174 (1.3945) acc_x 62.5000 (64.7917) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.1824, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 572
clean true:561
clean false:11
clean_rate:0.9807692307692307
noisy true:850
noisy false:1714
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 2564
epoch [92/200] batch [5/17] time 0.539 (0.465) data 0.409 (0.334) loss_x loss_x 1.3359 (1.4072) acc_x 65.6250 (64.3750) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/17] time 0.440 (0.494) data 0.308 (0.363) loss_x loss_x 2.0098 (1.4717) acc_x 53.1250 (63.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/17] time 0.590 (0.485) data 0.459 (0.354) loss_x loss_x 0.7695 (1.3523) acc_x 87.5000 (67.2917) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1727
confident_label rate tensor(0.1891, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 593
clean true:584
clean false:9
clean_rate:0.984822934232715
noisy true:825
noisy false:1718
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 2543
epoch [93/200] batch [5/18] time 0.560 (0.527) data 0.430 (0.396) loss_x loss_x 1.2695 (1.5091) acc_x 56.2500 (64.3750) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [10/18] time 0.442 (0.503) data 0.311 (0.372) loss_x loss_x 1.4619 (1.4243) acc_x 62.5000 (65.9375) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/18] time 0.420 (0.513) data 0.289 (0.382) loss_x loss_x 0.8535 (1.3233) acc_x 75.0000 (68.1250) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.1926, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 604
clean true:593
clean false:11
clean_rate:0.9817880794701986
noisy true:843
noisy false:1689
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 2532
epoch [94/200] batch [5/18] time 0.512 (0.494) data 0.381 (0.363) loss_x loss_x 0.9048 (1.2512) acc_x 84.3750 (73.7500) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [10/18] time 0.398 (0.488) data 0.267 (0.357) loss_x loss_x 1.5381 (1.3798) acc_x 68.7500 (68.4375) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/18] time 0.456 (0.474) data 0.325 (0.343) loss_x loss_x 1.4551 (1.4426) acc_x 71.8750 (67.5000) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1672
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:611
clean false:12
clean_rate:0.9807383627608347
noisy true:853
noisy false:1660
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [95/200] batch [5/19] time 0.547 (0.515) data 0.416 (0.383) loss_x loss_x 1.2715 (1.3084) acc_x 62.5000 (65.0000) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [10/19] time 0.561 (0.517) data 0.430 (0.386) loss_x loss_x 1.1016 (1.2752) acc_x 62.5000 (66.2500) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/19] time 0.372 (0.499) data 0.242 (0.368) loss_x loss_x 1.2744 (1.3054) acc_x 75.0000 (66.0417) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1713
confident_label rate tensor(0.1891, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 593
clean true:584
clean false:9
clean_rate:0.984822934232715
noisy true:839
noisy false:1704
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 2543
epoch [96/200] batch [5/18] time 0.388 (0.410) data 0.257 (0.280) loss_x loss_x 1.6260 (1.4531) acc_x 62.5000 (63.7500) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/18] time 0.426 (0.427) data 0.295 (0.296) loss_x loss_x 1.0635 (1.3913) acc_x 68.7500 (64.0625) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/18] time 0.444 (0.438) data 0.314 (0.307) loss_x loss_x 1.3965 (1.3582) acc_x 68.7500 (66.2500) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.1843, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 578
clean true:570
clean false:8
clean_rate:0.986159169550173
noisy true:881
noisy false:1677
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 2558
epoch [97/200] batch [5/18] time 0.615 (0.499) data 0.484 (0.368) loss_x loss_x 1.7256 (1.5406) acc_x 56.2500 (60.0000) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [10/18] time 0.532 (0.494) data 0.400 (0.363) loss_x loss_x 0.8691 (1.3911) acc_x 78.1250 (63.7500) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/18] time 0.426 (0.489) data 0.296 (0.358) loss_x loss_x 1.0195 (1.3329) acc_x 78.1250 (66.6667) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.1939, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 608
clean true:598
clean false:10
clean_rate:0.9835526315789473
noisy true:863
noisy false:1665
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 2528
epoch [98/200] batch [5/19] time 0.549 (0.466) data 0.418 (0.335) loss_x loss_x 1.6689 (1.2606) acc_x 53.1250 (65.0000) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [10/19] time 0.567 (0.463) data 0.436 (0.332) loss_x loss_x 1.5771 (1.3052) acc_x 68.7500 (65.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/19] time 0.407 (0.461) data 0.277 (0.330) loss_x loss_x 1.4346 (1.3122) acc_x 65.6250 (65.6250) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1672
confident_label rate tensor(0.1974, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 619
clean true:612
clean false:7
clean_rate:0.9886914378029079
noisy true:852
noisy false:1665
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 2517
epoch [99/200] batch [5/19] time 0.509 (0.524) data 0.377 (0.392) loss_x loss_x 1.4648 (1.1287) acc_x 68.7500 (73.1250) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [10/19] time 0.460 (0.471) data 0.329 (0.340) loss_x loss_x 1.1709 (1.2913) acc_x 62.5000 (69.0625) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/19] time 0.479 (0.471) data 0.349 (0.340) loss_x loss_x 1.7568 (1.2772) acc_x 46.8750 (68.1250) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:603
clean false:10
clean_rate:0.9836867862969005
noisy true:849
noisy false:1674
all clean rate:  [0.9393939393939394, 0.9551020408163265, 0.9804878048780488, 0.9843400447427293, 0.9787685774946921, 0.9893390191897654, 0.978448275862069, 0.9917525773195877, 0.9780439121756487, 0.9862475442043221, 0.9820717131474104, 0.9860279441117764, 0.9853862212943633, 0.983402489626556, 0.9857723577235772, 0.9822134387351779, 0.9884836852207294, 0.9920948616600791, 0.9679358717434869, 0.9845261121856866, 0.9894291754756871, 0.9917355371900827, 0.994140625, 0.9942307692307693, 0.9898580121703854, 0.9789674952198852, 0.9903288201160542, 0.9879518072289156, 0.9883720930232558, 0.9865642994241842, 0.9784172661870504, 0.9806201550387597, 0.9829222011385199, 0.9940944881889764, 0.9853747714808044, 0.9904214559386973, 0.9852941176470589, 0.9830508474576272, 0.988950276243094, 0.9841269841269841, 0.9852125693160814, 0.9872262773722628, 0.9908424908424909, 0.9869888475836431, 0.9865125240847784, 0.9906542056074766, 0.9926739926739927, 0.9856887298747764, 0.9849906191369606, 0.9874326750448833, 0.9851024208566108, 0.9807355516637478, 0.9873188405797102, 0.9769503546099291, 0.9826254826254827, 0.9827288428324698, 0.9857651245551602, 0.9842931937172775, 0.9877622377622378, 0.9839285714285714, 0.9855595667870036, 0.9788359788359788, 0.9879101899827288, 0.9857904085257548, 0.9908256880733946, 0.9908592321755028, 0.9858156028368794, 0.9929078014184397, 0.981574539363484, 0.989983305509182, 0.9847972972972973, 0.9929701230228472, 0.9892280071813285, 0.9862068965517241, 0.9874776386404294, 0.9829351535836177, 0.9879931389365352, 0.9894366197183099, 0.9930313588850174, 0.9834710743801653, 0.9879725085910653, 0.9897610921501706, 0.978688524590164, 0.9858906525573192, 0.9844559585492227, 0.991652754590985, 0.9934959349593496, 0.988135593220339, 0.9929947460595446, 0.989983305509182, 0.9844827586206897, 0.9807692307692307, 0.984822934232715, 0.9817880794701986, 0.9807383627608347, 0.984822934232715, 0.986159169550173, 0.9835526315789473, 0.9886914378029079, 0.9836867862969005]
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [100/200] batch [5/19] time 0.429 (0.485) data 0.298 (0.354) loss_x loss_x 0.9419 (1.3179) acc_x 78.1250 (66.2500) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [10/19] time 0.428 (0.476) data 0.296 (0.345) loss_x loss_x 1.4229 (1.3003) acc_x 59.3750 (66.5625) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/19] time 0.511 (0.471) data 0.380 (0.340) loss_x loss_x 1.2832 (1.3613) acc_x 68.7500 (66.8750) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1688
confident_label rate tensor(0.1967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 617
clean true:603
clean false:14
clean_rate:0.9773095623987034
noisy true:845
noisy false:1674
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 2519
epoch [101/200] batch [5/19] time 0.385 (0.497) data 0.254 (0.365) loss_x loss_x 1.1348 (1.2125) acc_x 71.8750 (71.2500) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [10/19] time 0.491 (0.465) data 0.360 (0.334) loss_x loss_x 1.0664 (1.2573) acc_x 78.1250 (72.5000) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/19] time 0.490 (0.491) data 0.360 (0.360) loss_x loss_x 1.7725 (1.2816) acc_x 56.2500 (70.2083) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1698
confident_label rate tensor(0.1967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 617
clean true:609
clean false:8
clean_rate:0.9870340356564019
noisy true:829
noisy false:1690
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 2519
epoch [102/200] batch [5/19] time 0.440 (0.491) data 0.309 (0.361) loss_x loss_x 0.7671 (1.3905) acc_x 84.3750 (65.0000) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [10/19] time 0.468 (0.478) data 0.337 (0.347) loss_x loss_x 1.4160 (1.3792) acc_x 53.1250 (62.8125) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/19] time 0.466 (0.462) data 0.335 (0.331) loss_x loss_x 1.1943 (1.3301) acc_x 71.8750 (65.8333) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.1942, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 609
clean true:600
clean false:9
clean_rate:0.9852216748768473
noisy true:876
noisy false:1651
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 2527
epoch [103/200] batch [5/19] time 0.473 (0.451) data 0.341 (0.319) loss_x loss_x 1.5840 (1.3988) acc_x 59.3750 (67.5000) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [10/19] time 0.536 (0.445) data 0.406 (0.314) loss_x loss_x 1.2568 (1.3689) acc_x 75.0000 (68.1250) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/19] time 0.392 (0.472) data 0.261 (0.341) loss_x loss_x 1.9238 (1.3084) acc_x 46.8750 (67.7083) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1697
confident_label rate tensor(0.1945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 610
clean true:603
clean false:7
clean_rate:0.9885245901639345
noisy true:836
noisy false:1690
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 2526
epoch [104/200] batch [5/19] time 0.465 (0.470) data 0.334 (0.339) loss_x loss_x 1.6670 (1.3334) acc_x 56.2500 (66.8750) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [10/19] time 0.462 (0.480) data 0.331 (0.349) loss_x loss_x 1.3135 (1.3746) acc_x 56.2500 (65.3125) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/19] time 0.555 (0.500) data 0.424 (0.369) loss_x loss_x 2.0156 (1.4754) acc_x 50.0000 (62.5000) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.1952, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 612
clean true:601
clean false:11
clean_rate:0.9820261437908496
noisy true:848
noisy false:1676
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 2524
epoch [105/200] batch [5/19] time 0.439 (0.457) data 0.308 (0.326) loss_x loss_x 1.4199 (1.1122) acc_x 62.5000 (70.6250) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [10/19] time 0.569 (0.512) data 0.438 (0.381) loss_x loss_x 1.0859 (1.1383) acc_x 62.5000 (70.3125) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/19] time 0.458 (0.505) data 0.327 (0.374) loss_x loss_x 1.1875 (1.2309) acc_x 68.7500 (68.5417) lr 9.5289e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1673
confident_label rate tensor(0.1936, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 607
clean true:599
clean false:8
clean_rate:0.9868204283360791
noisy true:864
noisy false:1665
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 2529
epoch [106/200] batch [5/18] time 0.317 (0.438) data 0.186 (0.307) loss_x loss_x 1.4121 (1.4256) acc_x 75.0000 (67.5000) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/18] time 0.598 (0.446) data 0.467 (0.315) loss_x loss_x 1.1904 (1.3473) acc_x 71.8750 (67.1875) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [15/18] time 0.605 (0.465) data 0.475 (0.335) loss_x loss_x 1.2051 (1.3349) acc_x 62.5000 (67.2917) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.1983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 622
clean true:617
clean false:5
clean_rate:0.9919614147909968
noisy true:845
noisy false:1669
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 2514
epoch [107/200] batch [5/19] time 0.450 (0.468) data 0.318 (0.337) loss_x loss_x 1.4287 (1.2389) acc_x 75.0000 (67.5000) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [10/19] time 0.595 (0.488) data 0.464 (0.357) loss_x loss_x 1.9961 (1.3355) acc_x 62.5000 (67.8125) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/19] time 0.436 (0.474) data 0.305 (0.343) loss_x loss_x 1.5098 (1.3458) acc_x 56.2500 (66.2500) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1745
confident_label rate tensor(0.1920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 602
clean true:594
clean false:8
clean_rate:0.9867109634551495
noisy true:797
noisy false:1737
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 2534
epoch [108/200] batch [5/18] time 0.379 (0.488) data 0.249 (0.358) loss_x loss_x 1.2354 (1.2959) acc_x 75.0000 (68.7500) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [10/18] time 0.423 (0.483) data 0.293 (0.353) loss_x loss_x 1.3340 (1.3935) acc_x 71.8750 (67.8125) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/18] time 0.367 (0.475) data 0.237 (0.345) loss_x loss_x 1.3643 (1.4107) acc_x 68.7500 (66.6667) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:612
clean false:11
clean_rate:0.9823434991974318
noisy true:878
noisy false:1635
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [109/200] batch [5/19] time 0.417 (0.479) data 0.287 (0.348) loss_x loss_x 1.2646 (1.5662) acc_x 75.0000 (65.0000) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [10/19] time 0.355 (0.463) data 0.223 (0.332) loss_x loss_x 1.4189 (1.4485) acc_x 62.5000 (64.6875) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/19] time 0.505 (0.472) data 0.373 (0.341) loss_x loss_x 1.0439 (1.3822) acc_x 71.8750 (64.7917) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1701
confident_label rate tensor(0.1904, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 597
clean true:591
clean false:6
clean_rate:0.9899497487437185
noisy true:844
noisy false:1695
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 2539
epoch [110/200] batch [5/18] time 0.471 (0.447) data 0.341 (0.316) loss_x loss_x 1.3408 (1.2373) acc_x 65.6250 (71.8750) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/18] time 0.522 (0.477) data 0.392 (0.347) loss_x loss_x 1.1758 (1.2887) acc_x 62.5000 (68.4375) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/18] time 0.406 (0.479) data 0.275 (0.348) loss_x loss_x 1.3076 (1.2753) acc_x 68.7500 (69.1667) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:620
clean false:3
clean_rate:0.9951845906902087
noisy true:842
noisy false:1671
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [111/200] batch [5/19] time 0.467 (0.492) data 0.337 (0.362) loss_x loss_x 1.6846 (1.4834) acc_x 56.2500 (61.2500) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [10/19] time 0.716 (0.520) data 0.585 (0.389) loss_x loss_x 0.6265 (1.2556) acc_x 84.3750 (65.9375) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/19] time 0.408 (0.492) data 0.278 (0.361) loss_x loss_x 1.7168 (1.3451) acc_x 56.2500 (65.0000) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1655
confident_label rate tensor(0.1948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 611
clean true:607
clean false:4
clean_rate:0.9934533551554828
noisy true:874
noisy false:1651
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 2525
epoch [112/200] batch [5/19] time 0.418 (0.489) data 0.287 (0.358) loss_x loss_x 1.4131 (1.2746) acc_x 65.6250 (69.3750) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [10/19] time 0.439 (0.453) data 0.308 (0.323) loss_x loss_x 1.4385 (1.2864) acc_x 68.7500 (70.6250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/19] time 0.561 (0.462) data 0.430 (0.331) loss_x loss_x 0.7759 (1.2384) acc_x 84.3750 (71.6667) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1628
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:610
clean false:3
clean_rate:0.9951060358890701
noisy true:898
noisy false:1625
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [113/200] batch [5/19] time 0.541 (0.496) data 0.409 (0.365) loss_x loss_x 1.0605 (1.3170) acc_x 75.0000 (69.3750) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [10/19] time 0.521 (0.481) data 0.391 (0.350) loss_x loss_x 0.7944 (1.2583) acc_x 81.2500 (68.4375) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/19] time 0.507 (0.491) data 0.376 (0.360) loss_x loss_x 1.0068 (1.3190) acc_x 65.6250 (67.9167) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.1983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 622
clean true:614
clean false:8
clean_rate:0.9871382636655949
noisy true:841
noisy false:1673
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 2514
epoch [114/200] batch [5/19] time 0.466 (0.459) data 0.336 (0.329) loss_x loss_x 1.1807 (1.1367) acc_x 62.5000 (69.3750) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [10/19] time 0.465 (0.448) data 0.335 (0.318) loss_x loss_x 1.8301 (1.2778) acc_x 65.6250 (66.5625) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/19] time 0.619 (0.461) data 0.488 (0.330) loss_x loss_x 0.9971 (1.3071) acc_x 71.8750 (66.6667) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1655
confident_label rate tensor(0.1990, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 624
clean true:618
clean false:6
clean_rate:0.9903846153846154
noisy true:863
noisy false:1649
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 2512
epoch [115/200] batch [5/19] time 0.436 (0.429) data 0.304 (0.297) loss_x loss_x 1.4980 (1.3445) acc_x 59.3750 (66.8750) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [10/19] time 0.383 (0.453) data 0.252 (0.322) loss_x loss_x 1.3613 (1.4700) acc_x 71.8750 (64.6875) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/19] time 0.470 (0.464) data 0.339 (0.333) loss_x loss_x 1.2812 (1.3692) acc_x 62.5000 (65.8333) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1654
confident_label rate tensor(0.1958, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 614
clean true:607
clean false:7
clean_rate:0.988599348534202
noisy true:875
noisy false:1647
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 2522
epoch [116/200] batch [5/19] time 0.519 (0.490) data 0.389 (0.360) loss_x loss_x 1.0625 (1.0353) acc_x 75.0000 (75.6250) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [10/19] time 0.641 (0.482) data 0.510 (0.351) loss_x loss_x 1.0557 (1.0258) acc_x 71.8750 (75.3125) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/19] time 0.530 (0.475) data 0.400 (0.344) loss_x loss_x 1.4932 (1.1286) acc_x 53.1250 (71.0417) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.1964, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 616
clean true:609
clean false:7
clean_rate:0.9886363636363636
noisy true:852
noisy false:1668
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 2520
epoch [117/200] batch [5/19] time 0.461 (0.474) data 0.329 (0.343) loss_x loss_x 1.8506 (1.3896) acc_x 53.1250 (61.2500) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [10/19] time 0.549 (0.500) data 0.419 (0.369) loss_x loss_x 1.3535 (1.3984) acc_x 65.6250 (65.0000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/19] time 0.423 (0.491) data 0.292 (0.359) loss_x loss_x 1.0596 (1.3421) acc_x 71.8750 (64.5833) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.1926, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 604
clean true:595
clean false:9
clean_rate:0.9850993377483444
noisy true:862
noisy false:1670
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 2532
epoch [118/200] batch [5/18] time 0.449 (0.475) data 0.318 (0.345) loss_x loss_x 1.8438 (1.4269) acc_x 50.0000 (61.8750) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [10/18] time 0.529 (0.463) data 0.398 (0.332) loss_x loss_x 0.5918 (1.2378) acc_x 81.2500 (65.3125) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/18] time 0.424 (0.465) data 0.294 (0.334) loss_x loss_x 1.3838 (1.1939) acc_x 65.6250 (68.3333) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.1936, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 607
clean true:601
clean false:6
clean_rate:0.9901153212520593
noisy true:878
noisy false:1651
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 2529
epoch [119/200] batch [5/18] time 0.545 (0.507) data 0.414 (0.376) loss_x loss_x 0.9893 (1.1774) acc_x 75.0000 (71.8750) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [10/18] time 0.485 (0.470) data 0.355 (0.339) loss_x loss_x 1.0713 (1.2411) acc_x 81.2500 (71.8750) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/18] time 0.405 (0.458) data 0.274 (0.327) loss_x loss_x 1.3330 (1.2931) acc_x 65.6250 (70.0000) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1683
confident_label rate tensor(0.1872, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 587
clean true:582
clean false:5
clean_rate:0.9914821124361158
noisy true:871
noisy false:1678
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 2549
epoch [120/200] batch [5/18] time 0.415 (0.442) data 0.284 (0.311) loss_x loss_x 1.3008 (1.2979) acc_x 68.7500 (65.0000) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/18] time 0.541 (0.462) data 0.409 (0.331) loss_x loss_x 0.9795 (1.3432) acc_x 78.1250 (65.3125) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/18] time 0.725 (0.492) data 0.593 (0.361) loss_x loss_x 1.2734 (1.2590) acc_x 53.1250 (67.0833) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1664
confident_label rate tensor(0.1996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 626
clean true:620
clean false:6
clean_rate:0.9904153354632588
noisy true:852
noisy false:1658
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 2510
epoch [121/200] batch [5/19] time 0.511 (0.496) data 0.379 (0.365) loss_x loss_x 1.7354 (1.3202) acc_x 59.3750 (63.7500) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [10/19] time 0.420 (0.469) data 0.290 (0.338) loss_x loss_x 1.3682 (1.2950) acc_x 62.5000 (64.6875) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/19] time 0.443 (0.475) data 0.312 (0.344) loss_x loss_x 1.1963 (1.3274) acc_x 68.7500 (65.8333) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2006, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 629
clean true:617
clean false:12
clean_rate:0.9809220985691574
noisy true:869
noisy false:1638
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 2507
epoch [122/200] batch [5/19] time 0.392 (0.440) data 0.261 (0.308) loss_x loss_x 1.2432 (1.1373) acc_x 75.0000 (68.1250) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [10/19] time 0.408 (0.422) data 0.277 (0.291) loss_x loss_x 1.9326 (1.4123) acc_x 53.1250 (62.5000) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/19] time 0.395 (0.441) data 0.265 (0.310) loss_x loss_x 1.4639 (1.3854) acc_x 65.6250 (65.2083) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1655
confident_label rate tensor(0.1885, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 591
clean true:584
clean false:7
clean_rate:0.988155668358714
noisy true:897
noisy false:1648
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 2545
epoch [123/200] batch [5/18] time 0.447 (0.471) data 0.316 (0.340) loss_x loss_x 1.7461 (1.2549) acc_x 56.2500 (73.1250) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [10/18] time 0.422 (0.489) data 0.291 (0.358) loss_x loss_x 1.3125 (1.2236) acc_x 59.3750 (71.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/18] time 0.415 (0.482) data 0.285 (0.352) loss_x loss_x 1.2168 (1.2205) acc_x 68.7500 (70.8333) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.1948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 611
clean true:606
clean false:5
clean_rate:0.9918166939443536
noisy true:861
noisy false:1664
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 2525
epoch [124/200] batch [5/19] time 0.371 (0.454) data 0.239 (0.323) loss_x loss_x 1.6553 (1.4252) acc_x 62.5000 (65.6250) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [10/19] time 0.559 (0.484) data 0.428 (0.353) loss_x loss_x 0.8896 (1.2595) acc_x 68.7500 (70.0000) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/19] time 0.391 (0.477) data 0.260 (0.346) loss_x loss_x 1.2871 (1.2196) acc_x 68.7500 (70.2083) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.1999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 627
clean true:622
clean false:5
clean_rate:0.9920255183413078
noisy true:867
noisy false:1642
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 2509
epoch [125/200] batch [5/19] time 0.575 (0.460) data 0.444 (0.329) loss_x loss_x 1.4707 (1.2916) acc_x 59.3750 (65.6250) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [10/19] time 0.448 (0.484) data 0.318 (0.353) loss_x loss_x 1.0430 (1.3090) acc_x 78.1250 (66.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/19] time 0.641 (0.499) data 0.509 (0.368) loss_x loss_x 1.1826 (1.2986) acc_x 68.7500 (67.7083) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1619
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:628
clean false:7
clean_rate:0.988976377952756
noisy true:889
noisy false:1612
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [126/200] batch [5/19] time 0.589 (0.559) data 0.458 (0.427) loss_x loss_x 1.8643 (1.3524) acc_x 59.3750 (71.2500) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [10/19] time 0.398 (0.516) data 0.268 (0.385) loss_x loss_x 1.1719 (1.3100) acc_x 65.6250 (69.3750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/19] time 0.504 (0.504) data 0.373 (0.373) loss_x loss_x 0.6035 (1.2753) acc_x 87.5000 (68.3333) lr 6.3188e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1661
confident_label rate tensor(0.1936, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 607
clean true:602
clean false:5
clean_rate:0.9917627677100495
noisy true:873
noisy false:1656
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 2529
epoch [127/200] batch [5/18] time 0.435 (0.467) data 0.304 (0.336) loss_x loss_x 1.4385 (1.3451) acc_x 75.0000 (68.1250) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [10/18] time 0.519 (0.479) data 0.388 (0.348) loss_x loss_x 1.6680 (1.3626) acc_x 59.3750 (67.5000) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [15/18] time 0.494 (0.497) data 0.363 (0.366) loss_x loss_x 1.3721 (1.2945) acc_x 75.0000 (68.5417) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.1936, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 607
clean true:603
clean false:4
clean_rate:0.9934102141680395
noisy true:868
noisy false:1661
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 2529
epoch [128/200] batch [5/18] time 0.639 (0.544) data 0.508 (0.413) loss_x loss_x 1.6006 (1.1846) acc_x 59.3750 (68.7500) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [10/18] time 0.450 (0.509) data 0.320 (0.378) loss_x loss_x 1.2139 (1.2003) acc_x 68.7500 (68.4375) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/18] time 0.336 (0.477) data 0.206 (0.347) loss_x loss_x 1.9951 (1.3012) acc_x 50.0000 (66.0417) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:638
clean false:7
clean_rate:0.9891472868217054
noisy true:848
noisy false:1643
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [129/200] batch [5/20] time 0.435 (0.467) data 0.304 (0.337) loss_x loss_x 1.1328 (1.2629) acc_x 68.7500 (70.0000) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [10/20] time 0.389 (0.456) data 0.258 (0.326) loss_x loss_x 1.2070 (1.3445) acc_x 75.0000 (65.9375) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/20] time 0.489 (0.453) data 0.359 (0.322) loss_x loss_x 1.1123 (1.2885) acc_x 78.1250 (67.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/20] time 0.375 (0.469) data 0.244 (0.338) loss_x loss_x 2.0957 (1.2817) acc_x 50.0000 (67.3438) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.1958, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 614
clean true:604
clean false:10
clean_rate:0.9837133550488599
noisy true:867
noisy false:1655
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 2522
epoch [130/200] batch [5/19] time 0.424 (0.517) data 0.294 (0.386) loss_x loss_x 1.5918 (1.4023) acc_x 68.7500 (67.5000) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [10/19] time 0.396 (0.503) data 0.264 (0.372) loss_x loss_x 1.3252 (1.3677) acc_x 65.6250 (67.8125) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/19] time 0.542 (0.492) data 0.411 (0.361) loss_x loss_x 1.1436 (1.3264) acc_x 78.1250 (67.2917) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2009, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 630
clean true:617
clean false:13
clean_rate:0.9793650793650793
noisy true:842
noisy false:1664
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 2506
epoch [131/200] batch [5/19] time 0.386 (0.517) data 0.255 (0.386) loss_x loss_x 1.5059 (1.3043) acc_x 59.3750 (66.2500) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [10/19] time 0.581 (0.549) data 0.449 (0.418) loss_x loss_x 1.0850 (1.2791) acc_x 65.6250 (66.2500) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/19] time 0.447 (0.514) data 0.316 (0.383) loss_x loss_x 0.8579 (1.2424) acc_x 81.2500 (67.9167) lr 5.6006e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.1971, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 618
clean true:613
clean false:5
clean_rate:0.9919093851132686
noisy true:876
noisy false:1642
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 2518
epoch [132/200] batch [5/19] time 0.494 (0.486) data 0.362 (0.355) loss_x loss_x 1.2998 (1.1307) acc_x 68.7500 (71.8750) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [10/19] time 0.478 (0.472) data 0.348 (0.341) loss_x loss_x 0.9312 (1.1754) acc_x 81.2500 (71.8750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/19] time 0.472 (0.503) data 0.341 (0.372) loss_x loss_x 1.2549 (1.1581) acc_x 68.7500 (71.0417) lr 5.4601e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1617
confident_label rate tensor(0.2031, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 637
clean true:631
clean false:6
clean_rate:0.9905808477237049
noisy true:888
noisy false:1611
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 2499
epoch [133/200] batch [5/19] time 0.486 (0.481) data 0.355 (0.350) loss_x loss_x 1.4170 (1.4498) acc_x 75.0000 (70.0000) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [10/19] time 0.479 (0.489) data 0.349 (0.358) loss_x loss_x 1.0938 (1.3204) acc_x 68.7500 (71.5625) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/19] time 0.431 (0.502) data 0.301 (0.371) loss_x loss_x 1.2900 (1.2598) acc_x 68.7500 (71.8750) lr 5.3207e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:629
clean false:6
clean_rate:0.9905511811023622
noisy true:868
noisy false:1633
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [134/200] batch [5/19] time 0.474 (0.521) data 0.343 (0.390) loss_x loss_x 0.6167 (1.1452) acc_x 90.6250 (73.1250) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/19] time 0.592 (0.502) data 0.462 (0.371) loss_x loss_x 1.7500 (1.1688) acc_x 53.1250 (70.6250) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/19] time 0.582 (0.490) data 0.452 (0.359) loss_x loss_x 1.5186 (1.2923) acc_x 62.5000 (68.5417) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.1990, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 624
clean true:617
clean false:7
clean_rate:0.9887820512820513
noisy true:845
noisy false:1667
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 2512
epoch [135/200] batch [5/19] time 0.327 (0.432) data 0.195 (0.301) loss_x loss_x 1.3438 (1.4627) acc_x 75.0000 (68.7500) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [10/19] time 0.703 (0.497) data 0.572 (0.366) loss_x loss_x 1.8369 (1.4307) acc_x 59.3750 (66.8750) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/19] time 0.503 (0.495) data 0.372 (0.364) loss_x loss_x 0.8311 (1.3168) acc_x 81.2500 (67.5000) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1719
confident_label rate tensor(0.1952, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 612
clean true:602
clean false:10
clean_rate:0.9836601307189542
noisy true:815
noisy false:1709
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 2524
epoch [136/200] batch [5/19] time 0.486 (0.463) data 0.355 (0.332) loss_x loss_x 1.1406 (1.3943) acc_x 81.2500 (71.2500) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [10/19] time 0.526 (0.470) data 0.395 (0.339) loss_x loss_x 0.7925 (1.2256) acc_x 87.5000 (74.0625) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/19] time 0.615 (0.466) data 0.483 (0.335) loss_x loss_x 1.2676 (1.1990) acc_x 68.7500 (71.8750) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1658
confident_label rate tensor(0.1964, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 616
clean true:608
clean false:8
clean_rate:0.987012987012987
noisy true:870
noisy false:1650
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 2520
epoch [137/200] batch [5/19] time 0.421 (0.479) data 0.291 (0.348) loss_x loss_x 1.4746 (1.1557) acc_x 65.6250 (70.0000) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [10/19] time 0.470 (0.481) data 0.339 (0.351) loss_x loss_x 1.5215 (1.1912) acc_x 71.8750 (71.2500) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/19] time 0.404 (0.483) data 0.274 (0.352) loss_x loss_x 1.8496 (1.2926) acc_x 62.5000 (69.3750) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.1983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 622
clean true:614
clean false:8
clean_rate:0.9871382636655949
noisy true:852
noisy false:1662
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 2514
epoch [138/200] batch [5/19] time 0.413 (0.489) data 0.281 (0.358) loss_x loss_x 1.2881 (1.1301) acc_x 65.6250 (71.8750) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [10/19] time 0.475 (0.496) data 0.343 (0.365) loss_x loss_x 0.8521 (1.1480) acc_x 71.8750 (71.8750) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/19] time 0.451 (0.483) data 0.320 (0.351) loss_x loss_x 1.2061 (1.1927) acc_x 68.7500 (70.6250) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1664
confident_label rate tensor(0.1999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 627
clean true:616
clean false:11
clean_rate:0.9824561403508771
noisy true:856
noisy false:1653
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 2509
epoch [139/200] batch [5/19] time 0.541 (0.463) data 0.410 (0.333) loss_x loss_x 1.2285 (1.2650) acc_x 68.7500 (67.5000) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [10/19] time 0.445 (0.447) data 0.314 (0.316) loss_x loss_x 1.6289 (1.2776) acc_x 68.7500 (68.1250) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/19] time 0.433 (0.448) data 0.302 (0.317) loss_x loss_x 1.5117 (1.3102) acc_x 68.7500 (67.7083) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1667
confident_label rate tensor(0.2041, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 640
clean true:631
clean false:9
clean_rate:0.9859375
noisy true:838
noisy false:1658
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 2496
epoch [140/200] batch [5/20] time 0.507 (0.546) data 0.376 (0.415) loss_x loss_x 1.3740 (1.1742) acc_x 62.5000 (71.2500) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [10/20] time 0.426 (0.505) data 0.295 (0.374) loss_x loss_x 0.7437 (1.2811) acc_x 84.3750 (71.5625) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [15/20] time 0.444 (0.489) data 0.314 (0.358) loss_x loss_x 1.4453 (1.2410) acc_x 65.6250 (72.2917) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/20] time 0.435 (0.485) data 0.304 (0.353) loss_x loss_x 1.4893 (1.2916) acc_x 59.3750 (69.6875) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1661
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:618
clean false:5
clean_rate:0.9919743178170144
noisy true:857
noisy false:1656
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [141/200] batch [5/19] time 0.367 (0.395) data 0.235 (0.264) loss_x loss_x 1.4482 (1.1479) acc_x 62.5000 (71.8750) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/19] time 0.549 (0.463) data 0.417 (0.332) loss_x loss_x 1.3457 (1.1722) acc_x 75.0000 (72.8125) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/19] time 0.497 (0.461) data 0.366 (0.330) loss_x loss_x 0.9834 (1.1680) acc_x 81.2500 (72.9167) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.1961, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 615
clean true:606
clean false:9
clean_rate:0.9853658536585366
noisy true:870
noisy false:1651
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 2521
epoch [142/200] batch [5/19] time 0.498 (0.432) data 0.367 (0.301) loss_x loss_x 1.4561 (1.2973) acc_x 62.5000 (70.6250) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [10/19] time 0.494 (0.430) data 0.362 (0.298) loss_x loss_x 0.8901 (1.2662) acc_x 81.2500 (71.2500) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/19] time 0.516 (0.459) data 0.385 (0.328) loss_x loss_x 1.0527 (1.2748) acc_x 62.5000 (68.7500) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1706
confident_label rate tensor(0.1910, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 599
clean true:593
clean false:6
clean_rate:0.989983305509182
noisy true:837
noisy false:1700
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 2537
epoch [143/200] batch [5/18] time 0.557 (0.514) data 0.426 (0.383) loss_x loss_x 0.9922 (1.1742) acc_x 75.0000 (71.8750) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [10/18] time 0.384 (0.470) data 0.254 (0.339) loss_x loss_x 1.2793 (1.2508) acc_x 65.6250 (68.7500) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/18] time 0.409 (0.475) data 0.278 (0.344) loss_x loss_x 1.2041 (1.2658) acc_x 65.6250 (69.5833) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1663
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 634
clean true:624
clean false:10
clean_rate:0.9842271293375394
noisy true:849
noisy false:1653
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 2502
epoch [144/200] batch [5/19] time 0.508 (0.483) data 0.378 (0.352) loss_x loss_x 0.9448 (0.9132) acc_x 71.8750 (78.1250) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [10/19] time 0.449 (0.463) data 0.318 (0.332) loss_x loss_x 1.8818 (1.2721) acc_x 62.5000 (70.9375) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/19] time 0.657 (0.461) data 0.526 (0.330) loss_x loss_x 0.9116 (1.3406) acc_x 78.1250 (67.9167) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.2105, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 660
clean true:649
clean false:11
clean_rate:0.9833333333333333
noisy true:841
noisy false:1635
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 2476
epoch [145/200] batch [5/20] time 0.688 (0.502) data 0.558 (0.371) loss_x loss_x 0.8740 (1.3574) acc_x 78.1250 (68.1250) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [10/20] time 0.634 (0.522) data 0.502 (0.391) loss_x loss_x 0.9370 (1.2793) acc_x 78.1250 (70.0000) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [15/20] time 0.445 (0.509) data 0.314 (0.379) loss_x loss_x 1.5771 (1.3057) acc_x 68.7500 (69.7917) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/20] time 0.429 (0.496) data 0.297 (0.365) loss_x loss_x 1.2061 (1.2704) acc_x 71.8750 (70.0000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.2012, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 631
clean true:623
clean false:8
clean_rate:0.9873217115689382
noisy true:842
noisy false:1663
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 2505
epoch [146/200] batch [5/19] time 0.368 (0.436) data 0.237 (0.305) loss_x loss_x 1.4873 (1.2637) acc_x 53.1250 (65.0000) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [10/19] time 0.438 (0.435) data 0.307 (0.304) loss_x loss_x 1.3311 (1.3146) acc_x 78.1250 (67.8125) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/19] time 0.501 (0.466) data 0.371 (0.335) loss_x loss_x 1.3760 (1.2092) acc_x 68.7500 (70.8333) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.1993, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 625
clean true:614
clean false:11
clean_rate:0.9824
noisy true:840
noisy false:1671
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 2511
epoch [147/200] batch [5/19] time 0.536 (0.459) data 0.405 (0.328) loss_x loss_x 1.1475 (1.1462) acc_x 75.0000 (66.8750) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [10/19] time 0.437 (0.438) data 0.307 (0.307) loss_x loss_x 2.1758 (1.2157) acc_x 59.3750 (68.1250) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/19] time 0.431 (0.460) data 0.300 (0.329) loss_x loss_x 1.2520 (1.2262) acc_x 71.8750 (69.7917) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2006, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 629
clean true:625
clean false:4
clean_rate:0.9936406995230525
noisy true:851
noisy false:1656
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 2507
epoch [148/200] batch [5/19] time 0.474 (0.482) data 0.344 (0.351) loss_x loss_x 1.3740 (1.3662) acc_x 50.0000 (61.8750) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [10/19] time 0.511 (0.471) data 0.381 (0.341) loss_x loss_x 1.3760 (1.1807) acc_x 62.5000 (67.8125) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/19] time 0.410 (0.473) data 0.279 (0.342) loss_x loss_x 1.4033 (1.1760) acc_x 65.6250 (68.5417) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1690
confident_label rate tensor(0.1967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 617
clean true:609
clean false:8
clean_rate:0.9870340356564019
noisy true:837
noisy false:1682
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 2519
epoch [149/200] batch [5/19] time 0.538 (0.489) data 0.408 (0.359) loss_x loss_x 1.0957 (1.1391) acc_x 75.0000 (71.8750) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [10/19] time 0.405 (0.497) data 0.276 (0.367) loss_x loss_x 1.1523 (1.2148) acc_x 68.7500 (68.4375) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/19] time 0.389 (0.476) data 0.259 (0.345) loss_x loss_x 1.4043 (1.2309) acc_x 71.8750 (69.1667) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1631
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:627
clean false:8
clean_rate:0.9874015748031496
noisy true:878
noisy false:1623
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [150/200] batch [5/19] time 0.453 (0.473) data 0.322 (0.342) loss_x loss_x 0.6265 (0.9750) acc_x 84.3750 (74.3750) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [10/19] time 0.472 (0.478) data 0.342 (0.347) loss_x loss_x 1.3311 (1.0954) acc_x 59.3750 (70.6250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/19] time 0.596 (0.493) data 0.465 (0.363) loss_x loss_x 1.1621 (1.1567) acc_x 71.8750 (70.6250) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:615
clean false:8
clean_rate:0.9871589085072231
noisy true:856
noisy false:1657
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [151/200] batch [5/19] time 0.484 (0.441) data 0.353 (0.310) loss_x loss_x 1.1602 (1.2758) acc_x 75.0000 (69.3750) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [10/19] time 0.483 (0.456) data 0.352 (0.325) loss_x loss_x 1.3105 (1.2366) acc_x 62.5000 (68.7500) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/19] time 0.573 (0.479) data 0.442 (0.348) loss_x loss_x 1.5068 (1.1938) acc_x 53.1250 (68.5417) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 643
clean true:636
clean false:7
clean_rate:0.9891135303265941
noisy true:834
noisy false:1659
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 2493
epoch [152/200] batch [5/20] time 0.479 (0.508) data 0.349 (0.377) loss_x loss_x 1.2568 (1.2435) acc_x 75.0000 (65.0000) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [10/20] time 0.481 (0.489) data 0.351 (0.359) loss_x loss_x 1.0312 (1.2293) acc_x 68.7500 (66.2500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/20] time 0.483 (0.473) data 0.352 (0.343) loss_x loss_x 1.2012 (1.1892) acc_x 68.7500 (67.5000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/20] time 0.481 (0.474) data 0.350 (0.344) loss_x loss_x 1.4795 (1.1951) acc_x 53.1250 (67.6562) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:626
clean false:9
clean_rate:0.9858267716535433
noisy true:860
noisy false:1641
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [153/200] batch [5/19] time 0.531 (0.468) data 0.400 (0.337) loss_x loss_x 1.0840 (1.3900) acc_x 71.8750 (69.3750) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [10/19] time 0.410 (0.471) data 0.278 (0.340) loss_x loss_x 0.5879 (1.1884) acc_x 90.6250 (74.6875) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/19] time 0.411 (0.469) data 0.280 (0.338) loss_x loss_x 1.3789 (1.2404) acc_x 65.6250 (72.9167) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1614
confident_label rate tensor(0.2060, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 646
clean true:643
clean false:3
clean_rate:0.9953560371517027
noisy true:879
noisy false:1611
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 2490
epoch [154/200] batch [5/20] time 0.511 (0.457) data 0.380 (0.326) loss_x loss_x 1.3691 (1.1524) acc_x 65.6250 (69.3750) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [10/20] time 0.452 (0.464) data 0.321 (0.333) loss_x loss_x 1.5498 (1.2126) acc_x 68.7500 (69.6875) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/20] time 0.618 (0.484) data 0.487 (0.353) loss_x loss_x 0.9834 (1.1690) acc_x 78.1250 (70.2083) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/20] time 0.370 (0.474) data 0.240 (0.344) loss_x loss_x 1.0430 (1.1860) acc_x 75.0000 (69.8438) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.2031, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 637
clean true:632
clean false:5
clean_rate:0.9921507064364207
noisy true:865
noisy false:1634
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 2499
epoch [155/200] batch [5/19] time 0.419 (0.437) data 0.287 (0.306) loss_x loss_x 1.1104 (1.3475) acc_x 71.8750 (63.7500) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [10/19] time 0.412 (0.471) data 0.282 (0.341) loss_x loss_x 1.7588 (1.2594) acc_x 56.2500 (66.8750) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/19] time 0.410 (0.455) data 0.280 (0.324) loss_x loss_x 1.0166 (1.2430) acc_x 75.0000 (67.9167) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.2003, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 628
clean true:621
clean false:7
clean_rate:0.9888535031847133
noisy true:841
noisy false:1667
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 2508
epoch [156/200] batch [5/19] time 0.424 (0.428) data 0.294 (0.297) loss_x loss_x 0.6909 (1.0493) acc_x 78.1250 (75.6250) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/19] time 0.407 (0.420) data 0.275 (0.289) loss_x loss_x 0.5171 (1.0578) acc_x 90.6250 (77.5000) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/19] time 0.385 (0.450) data 0.255 (0.319) loss_x loss_x 0.9360 (1.1521) acc_x 71.8750 (74.5833) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1655
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 634
clean true:629
clean false:5
clean_rate:0.9921135646687698
noisy true:852
noisy false:1650
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 2502
epoch [157/200] batch [5/19] time 0.550 (0.508) data 0.420 (0.377) loss_x loss_x 1.4258 (1.2742) acc_x 62.5000 (71.8750) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [10/19] time 0.452 (0.478) data 0.321 (0.347) loss_x loss_x 1.1318 (1.2298) acc_x 71.8750 (69.6875) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/19] time 0.592 (0.477) data 0.460 (0.346) loss_x loss_x 1.2695 (1.2359) acc_x 75.0000 (70.4167) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 634
clean true:626
clean false:8
clean_rate:0.9873817034700315
noisy true:850
noisy false:1652
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 2502
epoch [158/200] batch [5/19] time 0.480 (0.478) data 0.348 (0.346) loss_x loss_x 1.4414 (1.2121) acc_x 68.7500 (72.5000) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [10/19] time 0.570 (0.469) data 0.439 (0.338) loss_x loss_x 0.9634 (1.2762) acc_x 78.1250 (72.1875) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/19] time 0.484 (0.470) data 0.353 (0.339) loss_x loss_x 1.4873 (1.2482) acc_x 59.3750 (71.4583) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1641
confident_label rate tensor(0.2047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 642
clean true:633
clean false:9
clean_rate:0.985981308411215
noisy true:862
noisy false:1632
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 2494
epoch [159/200] batch [5/20] time 0.566 (0.460) data 0.436 (0.330) loss_x loss_x 1.0771 (1.3760) acc_x 65.6250 (64.3750) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [10/20] time 0.503 (0.466) data 0.371 (0.335) loss_x loss_x 0.8115 (1.1963) acc_x 75.0000 (68.4375) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/20] time 0.458 (0.472) data 0.328 (0.341) loss_x loss_x 1.0518 (1.1491) acc_x 71.8750 (70.0000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/20] time 0.421 (0.470) data 0.289 (0.339) loss_x loss_x 1.3574 (1.2327) acc_x 62.5000 (68.9062) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1658
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 621
clean true:614
clean false:7
clean_rate:0.9887278582930756
noisy true:864
noisy false:1651
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 2515
epoch [160/200] batch [5/19] time 0.471 (0.430) data 0.340 (0.299) loss_x loss_x 1.2969 (1.1309) acc_x 65.6250 (72.5000) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [10/19] time 0.414 (0.424) data 0.283 (0.294) loss_x loss_x 1.1865 (1.1580) acc_x 71.8750 (72.1875) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/19] time 0.417 (0.452) data 0.287 (0.321) loss_x loss_x 1.3682 (1.1806) acc_x 75.0000 (71.6667) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:642
clean false:5
clean_rate:0.9922720247295209
noisy true:854
noisy false:1635
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [161/200] batch [5/20] time 0.497 (0.466) data 0.367 (0.335) loss_x loss_x 1.3301 (1.1083) acc_x 65.6250 (73.7500) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [10/20] time 0.587 (0.470) data 0.457 (0.340) loss_x loss_x 1.0537 (1.1162) acc_x 75.0000 (72.8125) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/20] time 0.447 (0.463) data 0.316 (0.332) loss_x loss_x 1.2178 (1.1733) acc_x 68.7500 (72.2917) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/20] time 0.345 (0.472) data 0.214 (0.342) loss_x loss_x 1.2637 (1.1843) acc_x 50.0000 (71.7188) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 656
clean true:645
clean false:11
clean_rate:0.9832317073170732
noisy true:814
noisy false:1666
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 2480
epoch [162/200] batch [5/20] time 0.524 (0.459) data 0.393 (0.328) loss_x loss_x 1.1982 (1.2270) acc_x 71.8750 (71.2500) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [10/20] time 0.437 (0.441) data 0.307 (0.310) loss_x loss_x 1.4268 (1.2983) acc_x 62.5000 (68.4375) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/20] time 0.377 (0.459) data 0.246 (0.329) loss_x loss_x 1.4775 (1.2793) acc_x 68.7500 (69.1667) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/20] time 0.410 (0.462) data 0.279 (0.331) loss_x loss_x 1.0752 (1.2487) acc_x 75.0000 (69.2188) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2009, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 630
clean true:620
clean false:10
clean_rate:0.9841269841269841
noisy true:859
noisy false:1647
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 2506
epoch [163/200] batch [5/19] time 0.423 (0.437) data 0.293 (0.306) loss_x loss_x 1.6465 (1.2355) acc_x 59.3750 (69.3750) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [10/19] time 0.424 (0.469) data 0.293 (0.338) loss_x loss_x 1.5283 (1.3008) acc_x 65.6250 (69.0625) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/19] time 0.408 (0.466) data 0.277 (0.335) loss_x loss_x 1.0742 (1.3486) acc_x 68.7500 (67.9167) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1622
confident_label rate tensor(0.2079, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 652
clean true:645
clean false:7
clean_rate:0.9892638036809815
noisy true:869
noisy false:1615
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 2484
epoch [164/200] batch [5/20] time 0.383 (0.459) data 0.252 (0.328) loss_x loss_x 1.1836 (1.2093) acc_x 75.0000 (68.7500) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [10/20] time 0.457 (0.459) data 0.327 (0.328) loss_x loss_x 1.1445 (1.2743) acc_x 71.8750 (68.7500) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/20] time 0.395 (0.450) data 0.264 (0.319) loss_x loss_x 1.0537 (1.2400) acc_x 75.0000 (70.8333) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/20] time 0.598 (0.469) data 0.467 (0.338) loss_x loss_x 1.8164 (1.2427) acc_x 65.6250 (71.4062) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1638
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:631
clean false:7
clean_rate:0.9890282131661442
noisy true:867
noisy false:1631
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [165/200] batch [5/19] time 0.475 (0.509) data 0.344 (0.378) loss_x loss_x 2.0547 (1.4686) acc_x 56.2500 (66.2500) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [10/19] time 0.438 (0.471) data 0.306 (0.340) loss_x loss_x 1.4717 (1.4326) acc_x 62.5000 (66.2500) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/19] time 0.538 (0.459) data 0.407 (0.328) loss_x loss_x 1.1182 (1.3384) acc_x 75.0000 (67.2917) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.2018, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 633
clean true:621
clean false:12
clean_rate:0.981042654028436
noisy true:820
noisy false:1683
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 2503
epoch [166/200] batch [5/19] time 0.376 (0.446) data 0.246 (0.316) loss_x loss_x 1.1426 (1.1743) acc_x 78.1250 (76.8750) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [10/19] time 0.435 (0.468) data 0.304 (0.337) loss_x loss_x 0.9541 (1.2714) acc_x 75.0000 (73.4375) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/19] time 0.431 (0.475) data 0.300 (0.344) loss_x loss_x 1.5352 (1.3018) acc_x 65.6250 (71.2500) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:606
clean false:7
clean_rate:0.9885807504078303
noisy true:845
noisy false:1678
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [167/200] batch [5/19] time 0.474 (0.486) data 0.344 (0.355) loss_x loss_x 1.5430 (1.3373) acc_x 62.5000 (61.2500) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [10/19] time 0.435 (0.455) data 0.303 (0.323) loss_x loss_x 1.3818 (1.2899) acc_x 68.7500 (64.3750) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/19] time 0.532 (0.468) data 0.401 (0.337) loss_x loss_x 1.3311 (1.2321) acc_x 68.7500 (67.5000) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.2066, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 648
clean true:636
clean false:12
clean_rate:0.9814814814814815
noisy true:866
noisy false:1622
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 2488
epoch [168/200] batch [5/20] time 0.473 (0.482) data 0.343 (0.352) loss_x loss_x 1.0068 (1.0701) acc_x 71.8750 (70.6250) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/20] time 0.488 (0.486) data 0.357 (0.355) loss_x loss_x 1.1211 (1.1709) acc_x 71.8750 (70.6250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/20] time 0.520 (0.482) data 0.390 (0.351) loss_x loss_x 1.3311 (1.2459) acc_x 71.8750 (69.7917) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/20] time 0.459 (0.474) data 0.328 (0.343) loss_x loss_x 1.1338 (1.2878) acc_x 68.7500 (69.5312) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.2018, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 633
clean true:622
clean false:11
clean_rate:0.9826224328593997
noisy true:830
noisy false:1673
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 2503
epoch [169/200] batch [5/19] time 0.388 (0.490) data 0.257 (0.359) loss_x loss_x 1.0039 (1.1893) acc_x 68.7500 (70.0000) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/19] time 0.447 (0.469) data 0.317 (0.338) loss_x loss_x 1.2666 (1.2910) acc_x 62.5000 (67.1875) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/19] time 0.492 (0.463) data 0.362 (0.333) loss_x loss_x 1.1553 (1.2572) acc_x 65.6250 (68.3333) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:636
clean false:9
clean_rate:0.986046511627907
noisy true:853
noisy false:1638
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [170/200] batch [5/20] time 0.438 (0.451) data 0.308 (0.320) loss_x loss_x 1.1133 (1.3047) acc_x 75.0000 (61.8750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/20] time 0.472 (0.455) data 0.341 (0.325) loss_x loss_x 1.3281 (1.3595) acc_x 71.8750 (62.5000) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/20] time 0.482 (0.477) data 0.351 (0.347) loss_x loss_x 1.1250 (1.3084) acc_x 56.2500 (63.1250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/20] time 0.408 (0.469) data 0.278 (0.338) loss_x loss_x 1.0371 (1.3308) acc_x 75.0000 (64.0625) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.2082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 653
clean true:644
clean false:9
clean_rate:0.9862174578866769
noisy true:846
noisy false:1637
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 2483
epoch [171/200] batch [5/20] time 0.529 (0.466) data 0.399 (0.335) loss_x loss_x 1.2285 (1.1420) acc_x 75.0000 (75.0000) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/20] time 0.392 (0.472) data 0.262 (0.341) loss_x loss_x 1.1211 (1.0588) acc_x 71.8750 (73.7500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/20] time 0.462 (0.472) data 0.331 (0.342) loss_x loss_x 1.3496 (1.1547) acc_x 65.6250 (70.4167) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/20] time 0.420 (0.469) data 0.290 (0.338) loss_x loss_x 1.1035 (1.1505) acc_x 78.1250 (70.6250) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1661
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:619
clean false:4
clean_rate:0.9935794542536116
noisy true:856
noisy false:1657
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [172/200] batch [5/19] time 0.345 (0.460) data 0.214 (0.329) loss_x loss_x 1.2100 (1.2595) acc_x 68.7500 (70.0000) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [10/19] time 0.460 (0.457) data 0.329 (0.326) loss_x loss_x 0.9316 (1.1907) acc_x 71.8750 (71.2500) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/19] time 0.619 (0.471) data 0.488 (0.340) loss_x loss_x 1.1191 (1.2326) acc_x 75.0000 (69.7917) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1628
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:641
clean false:6
clean_rate:0.990726429675425
noisy true:867
noisy false:1622
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [173/200] batch [5/20] time 0.527 (0.447) data 0.396 (0.316) loss_x loss_x 0.8857 (1.1561) acc_x 71.8750 (68.7500) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [10/20] time 0.485 (0.436) data 0.354 (0.305) loss_x loss_x 1.8125 (1.3451) acc_x 50.0000 (65.0000) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/20] time 0.412 (0.431) data 0.281 (0.300) loss_x loss_x 1.2422 (1.3409) acc_x 75.0000 (66.2500) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/20] time 0.590 (0.457) data 0.459 (0.326) loss_x loss_x 1.6387 (1.3355) acc_x 59.3750 (67.1875) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.1967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 617
clean true:610
clean false:7
clean_rate:0.9886547811993517
noisy true:842
noisy false:1677
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 2519
epoch [174/200] batch [5/19] time 0.484 (0.432) data 0.353 (0.301) loss_x loss_x 1.4990 (1.3729) acc_x 65.6250 (66.8750) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/19] time 0.492 (0.456) data 0.362 (0.325) loss_x loss_x 0.9399 (1.2997) acc_x 75.0000 (68.7500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/19] time 0.327 (0.441) data 0.197 (0.310) loss_x loss_x 1.5498 (1.2977) acc_x 53.1250 (67.5000) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.2085, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 654
clean true:648
clean false:6
clean_rate:0.9908256880733946
noisy true:902
noisy false:1580
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 2482
epoch [175/200] batch [5/20] time 0.496 (0.511) data 0.366 (0.380) loss_x loss_x 1.0664 (1.2160) acc_x 71.8750 (69.3750) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [10/20] time 0.520 (0.504) data 0.389 (0.374) loss_x loss_x 1.2295 (1.1266) acc_x 71.8750 (70.6250) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [15/20] time 0.450 (0.487) data 0.319 (0.356) loss_x loss_x 1.4697 (1.1129) acc_x 65.6250 (71.0417) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/20] time 0.386 (0.492) data 0.254 (0.361) loss_x loss_x 1.2188 (1.1616) acc_x 68.7500 (71.0938) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.2143, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 672
clean true:663
clean false:9
clean_rate:0.9866071428571429
noisy true:802
noisy false:1662
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 2464
epoch [176/200] batch [5/21] time 0.478 (0.495) data 0.347 (0.364) loss_x loss_x 1.5127 (1.1949) acc_x 62.5000 (70.6250) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [10/21] time 0.614 (0.482) data 0.484 (0.351) loss_x loss_x 1.1279 (1.2483) acc_x 68.7500 (70.3125) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [15/21] time 0.345 (0.466) data 0.213 (0.335) loss_x loss_x 0.9863 (1.1586) acc_x 65.6250 (72.0833) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/21] time 0.401 (0.473) data 0.269 (0.342) loss_x loss_x 1.6777 (1.2077) acc_x 56.2500 (70.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1630
confident_label rate tensor(0.2133, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 669
clean true:662
clean false:7
clean_rate:0.9895366218236173
noisy true:844
noisy false:1623
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 2467
epoch [177/200] batch [5/20] time 0.512 (0.441) data 0.381 (0.310) loss_x loss_x 1.3262 (1.2641) acc_x 59.3750 (68.7500) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [10/20] time 0.462 (0.471) data 0.331 (0.340) loss_x loss_x 1.5234 (1.1853) acc_x 59.3750 (67.8125) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/20] time 0.476 (0.465) data 0.345 (0.334) loss_x loss_x 1.7510 (1.2374) acc_x 53.1250 (67.5000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/20] time 0.413 (0.457) data 0.283 (0.326) loss_x loss_x 1.3896 (1.2529) acc_x 68.7500 (67.8125) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.2073, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 650
clean true:640
clean false:10
clean_rate:0.9846153846153847
noisy true:826
noisy false:1660
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 2486
epoch [178/200] batch [5/20] time 0.534 (0.481) data 0.403 (0.349) loss_x loss_x 1.2031 (1.1955) acc_x 56.2500 (66.2500) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/20] time 0.345 (0.541) data 0.215 (0.410) loss_x loss_x 0.9697 (1.1622) acc_x 81.2500 (70.9375) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [15/20] time 0.465 (0.492) data 0.335 (0.361) loss_x loss_x 1.4736 (1.2459) acc_x 68.7500 (70.2083) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/20] time 0.394 (0.482) data 0.264 (0.352) loss_x loss_x 1.0713 (1.2536) acc_x 68.7500 (69.2188) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.2079, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 652
clean true:645
clean false:7
clean_rate:0.9892638036809815
noisy true:856
noisy false:1628
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 2484
epoch [179/200] batch [5/20] time 0.480 (0.494) data 0.350 (0.363) loss_x loss_x 0.8418 (1.1329) acc_x 81.2500 (73.1250) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [10/20] time 0.445 (0.483) data 0.315 (0.352) loss_x loss_x 1.6846 (1.2265) acc_x 59.3750 (71.2500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/20] time 0.503 (0.478) data 0.372 (0.347) loss_x loss_x 1.1533 (1.2220) acc_x 71.8750 (71.6667) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/20] time 0.360 (0.462) data 0.230 (0.331) loss_x loss_x 1.4023 (1.1755) acc_x 59.3750 (72.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.1990, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 624
clean true:615
clean false:9
clean_rate:0.9855769230769231
noisy true:884
noisy false:1628
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 2512
epoch [180/200] batch [5/19] time 0.387 (0.475) data 0.256 (0.345) loss_x loss_x 1.2695 (1.3146) acc_x 65.6250 (63.7500) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/19] time 0.407 (0.467) data 0.277 (0.336) loss_x loss_x 1.3711 (1.3573) acc_x 68.7500 (67.1875) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/19] time 0.448 (0.464) data 0.317 (0.333) loss_x loss_x 1.4053 (1.2841) acc_x 65.6250 (68.3333) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1606
confident_label rate tensor(0.2085, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 654
clean true:646
clean false:8
clean_rate:0.9877675840978594
noisy true:884
noisy false:1598
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 2482
epoch [181/200] batch [5/20] time 0.544 (0.517) data 0.414 (0.386) loss_x loss_x 0.8804 (1.3138) acc_x 81.2500 (71.8750) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [10/20] time 0.480 (0.497) data 0.350 (0.366) loss_x loss_x 0.8511 (1.2681) acc_x 81.2500 (70.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/20] time 0.457 (0.490) data 0.326 (0.359) loss_x loss_x 1.5645 (1.2978) acc_x 62.5000 (67.7083) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/20] time 0.478 (0.483) data 0.348 (0.353) loss_x loss_x 1.5684 (1.3147) acc_x 65.6250 (67.6562) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1644
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 656
clean true:646
clean false:10
clean_rate:0.9847560975609756
noisy true:846
noisy false:1634
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 2480
epoch [182/200] batch [5/20] time 0.400 (0.444) data 0.269 (0.312) loss_x loss_x 1.3975 (1.3265) acc_x 68.7500 (69.3750) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [10/20] time 0.388 (0.447) data 0.257 (0.316) loss_x loss_x 1.5430 (1.2966) acc_x 68.7500 (70.6250) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/20] time 0.466 (0.455) data 0.335 (0.323) loss_x loss_x 1.8262 (1.2870) acc_x 53.1250 (70.4167) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/20] time 0.358 (0.458) data 0.227 (0.327) loss_x loss_x 0.9858 (1.2489) acc_x 81.2500 (70.9375) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.2038, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 639
clean true:633
clean false:6
clean_rate:0.9906103286384976
noisy true:822
noisy false:1675
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 2497
epoch [183/200] batch [5/19] time 0.710 (0.519) data 0.580 (0.388) loss_x loss_x 1.1699 (0.9868) acc_x 65.6250 (75.0000) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [10/19] time 0.457 (0.480) data 0.327 (0.350) loss_x loss_x 1.0713 (1.0612) acc_x 71.8750 (73.1250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/19] time 0.404 (0.460) data 0.273 (0.329) loss_x loss_x 1.1279 (1.0811) acc_x 68.7500 (73.3333) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1651
confident_label rate tensor(0.1952, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 612
clean true:605
clean false:7
clean_rate:0.988562091503268
noisy true:880
noisy false:1644
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 2524
epoch [184/200] batch [5/19] time 0.488 (0.480) data 0.357 (0.349) loss_x loss_x 0.9922 (1.1263) acc_x 78.1250 (71.8750) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [10/19] time 0.428 (0.483) data 0.297 (0.352) loss_x loss_x 1.1182 (1.1858) acc_x 68.7500 (70.3125) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/19] time 0.389 (0.459) data 0.258 (0.328) loss_x loss_x 1.0615 (1.2616) acc_x 78.1250 (70.0000) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.2073, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 650
clean true:641
clean false:9
clean_rate:0.9861538461538462
noisy true:875
noisy false:1611
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 2486
epoch [185/200] batch [5/20] time 0.523 (0.491) data 0.392 (0.360) loss_x loss_x 1.6084 (1.4129) acc_x 65.6250 (68.7500) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [10/20] time 0.563 (0.498) data 0.432 (0.367) loss_x loss_x 1.5361 (1.3870) acc_x 59.3750 (66.2500) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/20] time 0.343 (0.482) data 0.211 (0.351) loss_x loss_x 1.6768 (1.3404) acc_x 56.2500 (67.2917) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/20] time 0.371 (0.464) data 0.240 (0.332) loss_x loss_x 1.4844 (1.3202) acc_x 65.6250 (68.4375) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1612
confident_label rate tensor(0.2121, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 665
clean true:656
clean false:9
clean_rate:0.9864661654135338
noisy true:868
noisy false:1603
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 2471
epoch [186/200] batch [5/20] time 0.413 (0.442) data 0.282 (0.311) loss_x loss_x 1.0732 (1.2782) acc_x 78.1250 (70.6250) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [10/20] time 0.402 (0.441) data 0.271 (0.310) loss_x loss_x 1.2480 (1.3684) acc_x 65.6250 (69.3750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/20] time 0.466 (0.446) data 0.335 (0.315) loss_x loss_x 1.0645 (1.3444) acc_x 71.8750 (68.5417) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/20] time 0.467 (0.448) data 0.335 (0.317) loss_x loss_x 0.6699 (1.3589) acc_x 84.3750 (67.6562) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2031, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 637
clean true:631
clean false:6
clean_rate:0.9905808477237049
noisy true:855
noisy false:1644
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 2499
epoch [187/200] batch [5/19] time 0.476 (0.479) data 0.346 (0.348) loss_x loss_x 1.1631 (1.1760) acc_x 71.8750 (71.2500) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [10/19] time 0.461 (0.486) data 0.331 (0.355) loss_x loss_x 1.1211 (1.1302) acc_x 78.1250 (72.5000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/19] time 0.403 (0.471) data 0.272 (0.340) loss_x loss_x 1.0635 (1.1627) acc_x 65.6250 (71.6667) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.2070, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 649
clean true:640
clean false:9
clean_rate:0.9861325115562404
noisy true:873
noisy false:1614
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 2487
epoch [188/200] batch [5/20] time 0.520 (0.434) data 0.389 (0.303) loss_x loss_x 0.9604 (1.3291) acc_x 81.2500 (70.6250) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [10/20] time 0.553 (0.464) data 0.422 (0.334) loss_x loss_x 1.1475 (1.1947) acc_x 65.6250 (72.5000) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/20] time 0.334 (0.455) data 0.203 (0.324) loss_x loss_x 1.5000 (1.1852) acc_x 59.3750 (72.7083) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/20] time 0.377 (0.460) data 0.247 (0.329) loss_x loss_x 1.2012 (1.2318) acc_x 68.7500 (71.8750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:634
clean false:11
clean_rate:0.9829457364341085
noisy true:892
noisy false:1599
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [189/200] batch [5/20] time 0.400 (0.505) data 0.269 (0.374) loss_x loss_x 1.6074 (1.3800) acc_x 65.6250 (66.8750) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [10/20] time 0.517 (0.484) data 0.385 (0.352) loss_x loss_x 1.2832 (1.2042) acc_x 71.8750 (71.8750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/20] time 0.423 (0.453) data 0.292 (0.322) loss_x loss_x 1.6846 (1.2490) acc_x 56.2500 (69.7917) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/20] time 0.358 (0.447) data 0.227 (0.316) loss_x loss_x 1.2861 (1.2028) acc_x 65.6250 (70.4688) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1656
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 634
clean true:624
clean false:10
clean_rate:0.9842271293375394
noisy true:856
noisy false:1646
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 2502
epoch [190/200] batch [5/19] time 0.640 (0.492) data 0.509 (0.361) loss_x loss_x 1.9229 (1.2952) acc_x 59.3750 (68.7500) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/19] time 0.363 (0.476) data 0.233 (0.346) loss_x loss_x 1.2646 (1.2915) acc_x 75.0000 (67.8125) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/19] time 0.435 (0.466) data 0.303 (0.335) loss_x loss_x 0.7891 (1.1494) acc_x 78.1250 (72.2917) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.2009, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 630
clean true:618
clean false:12
clean_rate:0.9809523809523809
noisy true:883
noisy false:1623
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 2506
epoch [191/200] batch [5/19] time 0.367 (0.380) data 0.236 (0.250) loss_x loss_x 1.8066 (1.4159) acc_x 59.3750 (65.0000) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/19] time 0.481 (0.425) data 0.351 (0.294) loss_x loss_x 1.1943 (1.2779) acc_x 75.0000 (69.3750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/19] time 0.413 (0.425) data 0.282 (0.294) loss_x loss_x 0.8232 (1.1836) acc_x 84.3750 (71.8750) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1606
confident_label rate tensor(0.2066, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 648
clean true:640
clean false:8
clean_rate:0.9876543209876543
noisy true:890
noisy false:1598
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 2488
epoch [192/200] batch [5/20] time 0.351 (0.471) data 0.221 (0.341) loss_x loss_x 1.4023 (1.2741) acc_x 68.7500 (70.6250) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [10/20] time 0.548 (0.459) data 0.417 (0.329) loss_x loss_x 1.4883 (1.2333) acc_x 68.7500 (70.6250) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/20] time 0.563 (0.484) data 0.432 (0.353) loss_x loss_x 1.0215 (1.1893) acc_x 68.7500 (71.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/20] time 0.412 (0.468) data 0.282 (0.337) loss_x loss_x 1.4521 (1.1608) acc_x 68.7500 (72.6562) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1663
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:628
clean false:10
clean_rate:0.9843260188087775
noisy true:845
noisy false:1653
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [193/200] batch [5/19] time 0.337 (0.481) data 0.207 (0.351) loss_x loss_x 0.7896 (1.2218) acc_x 81.2500 (70.6250) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [10/19] time 0.416 (0.452) data 0.286 (0.322) loss_x loss_x 1.1270 (1.1357) acc_x 75.0000 (72.8125) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/19] time 0.468 (0.445) data 0.338 (0.315) loss_x loss_x 1.5459 (1.1737) acc_x 62.5000 (72.2917) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1656
confident_label rate tensor(0.1990, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 624
clean true:617
clean false:7
clean_rate:0.9887820512820513
noisy true:863
noisy false:1649
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 2512
epoch [194/200] batch [5/19] time 0.495 (0.480) data 0.364 (0.350) loss_x loss_x 1.4297 (1.2238) acc_x 68.7500 (71.2500) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [10/19] time 0.456 (0.480) data 0.326 (0.350) loss_x loss_x 1.0029 (1.2023) acc_x 75.0000 (72.8125) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/19] time 0.395 (0.455) data 0.265 (0.325) loss_x loss_x 0.9590 (1.1718) acc_x 81.2500 (73.5417) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1598
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 663
clean true:653
clean false:10
clean_rate:0.9849170437405732
noisy true:885
noisy false:1588
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 2473
epoch [195/200] batch [5/20] time 0.446 (0.434) data 0.315 (0.303) loss_x loss_x 0.8955 (1.1420) acc_x 81.2500 (72.5000) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [10/20] time 0.352 (0.430) data 0.222 (0.299) loss_x loss_x 1.2969 (1.1826) acc_x 68.7500 (71.8750) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/20] time 0.393 (0.432) data 0.262 (0.302) loss_x loss_x 1.5215 (1.2141) acc_x 68.7500 (72.0833) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/20] time 0.380 (0.435) data 0.250 (0.304) loss_x loss_x 1.3369 (1.1715) acc_x 65.6250 (73.1250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.1999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 627
clean true:623
clean false:4
clean_rate:0.9936204146730463
noisy true:856
noisy false:1653
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 2509
epoch [196/200] batch [5/19] time 0.432 (0.469) data 0.302 (0.338) loss_x loss_x 1.5264 (1.1273) acc_x 68.7500 (73.7500) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [10/19] time 0.511 (0.439) data 0.380 (0.309) loss_x loss_x 1.3740 (1.1082) acc_x 68.7500 (74.3750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/19] time 0.512 (0.447) data 0.381 (0.317) loss_x loss_x 0.7271 (1.0788) acc_x 81.2500 (74.5833) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.2076, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 651
clean true:642
clean false:9
clean_rate:0.9861751152073732
noisy true:841
noisy false:1644
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 2485
epoch [197/200] batch [5/20] time 0.329 (0.396) data 0.199 (0.266) loss_x loss_x 1.2930 (1.2668) acc_x 62.5000 (66.8750) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/20] time 0.459 (0.442) data 0.329 (0.312) loss_x loss_x 1.3184 (1.3003) acc_x 65.6250 (65.9375) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/20] time 0.423 (0.443) data 0.293 (0.312) loss_x loss_x 1.0078 (1.3019) acc_x 75.0000 (67.9167) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/20] time 0.443 (0.449) data 0.313 (0.319) loss_x loss_x 1.4463 (1.3389) acc_x 53.1250 (67.1875) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.1977, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 620
clean true:615
clean false:5
clean_rate:0.9919354838709677
noisy true:884
noisy false:1632
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 2516
epoch [198/200] batch [5/19] time 0.524 (0.442) data 0.393 (0.311) loss_x loss_x 1.4092 (1.2807) acc_x 56.2500 (69.3750) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [10/19] time 0.474 (0.465) data 0.343 (0.334) loss_x loss_x 1.4531 (1.2314) acc_x 68.7500 (71.8750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/19] time 0.471 (0.458) data 0.341 (0.327) loss_x loss_x 1.1875 (1.1325) acc_x 68.7500 (73.9583) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.2038, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 639
clean true:631
clean false:8
clean_rate:0.9874804381846636
noisy true:882
noisy false:1615
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 2497
epoch [199/200] batch [5/19] time 0.394 (0.429) data 0.264 (0.298) loss_x loss_x 1.2031 (1.1848) acc_x 68.7500 (70.6250) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/19] time 0.407 (0.435) data 0.276 (0.305) loss_x loss_x 1.3643 (1.2064) acc_x 62.5000 (70.0000) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/19] time 0.414 (0.438) data 0.283 (0.307) loss_x loss_x 1.4717 (1.2876) acc_x 65.6250 (67.7083) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:639
clean false:8
clean_rate:0.9876352395672334
noisy true:868
noisy false:1621
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [200/200] batch [5/20] time 0.497 (0.450) data 0.367 (0.320) loss_x loss_x 1.6396 (1.1268) acc_x 68.7500 (78.1250) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [10/20] time 0.425 (0.455) data 0.294 (0.325) loss_x loss_x 1.0898 (1.1647) acc_x 75.0000 (75.3125) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/20] time 0.368 (0.469) data 0.238 (0.339) loss_x loss_x 1.4678 (1.1600) acc_x 65.6250 (75.8333) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/20] time 0.566 (0.453) data 0.435 (0.322) loss_x loss_x 0.9731 (1.1275) acc_x 65.6250 (75.0000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 4,953
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 59.7%
Elapsed: 2:59:03
