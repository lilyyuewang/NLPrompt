***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.0705, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 221
clean true:154
clean false:67
clean_rate:0.6968325791855203
noisy true:411
noisy false:2504
after delete: len(clean_dataset) 221
after delete: len(noisy_dataset) 2915
epoch [1/200] batch [5/6] time 0.405 (0.448) data 0.274 (0.300) loss_x loss_x 2.9238 (3.1617) acc_x 37.5000 (28.7500) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2498
confident_label rate tensor(0.0702, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 220
clean true:150
clean false:70
clean_rate:0.6818181818181818
noisy true:488
noisy false:2428
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 2916
epoch [2/200] batch [5/6] time 0.512 (0.490) data 0.382 (0.360) loss_x loss_x 2.3652 (2.1348) acc_x 31.2500 (45.0000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2039
confident_label rate tensor(0.1097, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 344
clean true:265
clean false:79
clean_rate:0.7703488372093024
noisy true:832
noisy false:1960
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 2792
epoch [3/200] batch [5/10] time 0.469 (0.470) data 0.338 (0.339) loss_x loss_x 1.7607 (1.8420) acc_x 46.8750 (48.1250) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/10] time 0.456 (0.466) data 0.325 (0.335) loss_x loss_x 1.8389 (1.8813) acc_x 53.1250 (50.0000) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1942
confident_label rate tensor(0.1279, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 401
clean true:317
clean false:84
clean_rate:0.7905236907730673
noisy true:877
noisy false:1858
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 2735
epoch [4/200] batch [5/12] time 0.437 (0.445) data 0.307 (0.314) loss_x loss_x 1.8018 (1.7102) acc_x 46.8750 (53.1250) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/12] time 0.398 (0.457) data 0.268 (0.327) loss_x loss_x 1.3896 (1.6819) acc_x 62.5000 (55.0000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1911
confident_label rate tensor(0.1336, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 419
clean true:323
clean false:96
clean_rate:0.7708830548926014
noisy true:902
noisy false:1815
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 2717
epoch [5/200] batch [5/13] time 0.501 (0.485) data 0.372 (0.354) loss_x loss_x 1.6924 (1.8102) acc_x 56.2500 (50.6250) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/13] time 0.449 (0.455) data 0.319 (0.324) loss_x loss_x 1.8877 (1.8111) acc_x 50.0000 (50.0000) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1884
confident_label rate tensor(0.1330, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 417
clean true:310
clean false:107
clean_rate:0.7434052757793765
noisy true:942
noisy false:1777
after delete: len(clean_dataset) 417
after delete: len(noisy_dataset) 2719
epoch [6/200] batch [5/13] time 0.506 (0.447) data 0.376 (0.316) loss_x loss_x 1.2656 (1.6645) acc_x 68.7500 (56.8750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/13] time 0.497 (0.441) data 0.367 (0.311) loss_x loss_x 1.5850 (1.6712) acc_x 71.8750 (58.1250) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1883
confident_label rate tensor(0.1228, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 385
clean true:295
clean false:90
clean_rate:0.7662337662337663
noisy true:958
noisy false:1793
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 2751
epoch [7/200] batch [5/12] time 0.442 (0.504) data 0.312 (0.374) loss_x loss_x 1.3164 (1.5246) acc_x 56.2500 (56.2500) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/12] time 0.411 (0.498) data 0.281 (0.367) loss_x loss_x 1.4648 (1.3948) acc_x 68.7500 (60.0000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1919
confident_label rate tensor(0.1272, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 399
clean true:299
clean false:100
clean_rate:0.7493734335839599
noisy true:918
noisy false:1819
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 2737
epoch [8/200] batch [5/12] time 0.575 (0.459) data 0.444 (0.328) loss_x loss_x 1.3555 (1.6381) acc_x 68.7500 (58.1250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/12] time 0.402 (0.441) data 0.271 (0.310) loss_x loss_x 1.9453 (1.6967) acc_x 62.5000 (56.8750) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1879
confident_label rate tensor(0.1445, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 453
clean true:349
clean false:104
clean_rate:0.7704194260485652
noisy true:908
noisy false:1775
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 2683
epoch [9/200] batch [5/14] time 0.421 (0.488) data 0.290 (0.356) loss_x loss_x 1.4072 (1.5277) acc_x 56.2500 (58.1250) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/14] time 0.427 (0.463) data 0.296 (0.331) loss_x loss_x 1.3652 (1.5872) acc_x 59.3750 (56.8750) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1852
confident_label rate tensor(0.1333, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 418
clean true:318
clean false:100
clean_rate:0.7607655502392344
noisy true:966
noisy false:1752
after delete: len(clean_dataset) 418
after delete: len(noisy_dataset) 2718
epoch [10/200] batch [5/13] time 0.575 (0.487) data 0.444 (0.356) loss_x loss_x 1.4521 (1.6785) acc_x 56.2500 (53.1250) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/13] time 0.441 (0.498) data 0.309 (0.367) loss_x loss_x 2.2617 (1.7619) acc_x 34.3750 (50.0000) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1869
confident_label rate tensor(0.1403, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 440
clean true:351
clean false:89
clean_rate:0.7977272727272727
noisy true:916
noisy false:1780
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 2696
epoch [11/200] batch [5/13] time 0.527 (0.461) data 0.396 (0.330) loss_x loss_x 1.5400 (1.7748) acc_x 53.1250 (53.1250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/13] time 0.442 (0.456) data 0.312 (0.325) loss_x loss_x 2.1777 (1.7331) acc_x 50.0000 (56.8750) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1874
confident_label rate tensor(0.1327, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 416
clean true:308
clean false:108
clean_rate:0.7403846153846154
noisy true:954
noisy false:1766
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 2720
epoch [12/200] batch [5/13] time 0.422 (0.447) data 0.291 (0.316) loss_x loss_x 1.0146 (1.5793) acc_x 78.1250 (60.6250) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/13] time 0.600 (0.478) data 0.470 (0.348) loss_x loss_x 1.4785 (1.5368) acc_x 59.3750 (60.6250) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1852
confident_label rate tensor(0.1409, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 442
clean true:335
clean false:107
clean_rate:0.7579185520361991
noisy true:949
noisy false:1745
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 2694
epoch [13/200] batch [5/13] time 0.454 (0.396) data 0.323 (0.265) loss_x loss_x 1.3682 (1.6771) acc_x 59.3750 (57.5000) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/13] time 0.418 (0.424) data 0.287 (0.293) loss_x loss_x 2.0957 (1.8216) acc_x 40.6250 (52.8125) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1871
confident_label rate tensor(0.1502, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 471
clean true:348
clean false:123
clean_rate:0.7388535031847133
noisy true:917
noisy false:1748
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 2665
epoch [14/200] batch [5/14] time 0.457 (0.473) data 0.326 (0.342) loss_x loss_x 1.8711 (1.8604) acc_x 62.5000 (55.6250) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/14] time 0.517 (0.462) data 0.386 (0.331) loss_x loss_x 1.9922 (1.8570) acc_x 40.6250 (52.1875) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1845
confident_label rate tensor(0.1400, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 439
clean true:340
clean false:99
clean_rate:0.7744874715261959
noisy true:951
noisy false:1746
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 2697
epoch [15/200] batch [5/13] time 0.590 (0.474) data 0.460 (0.343) loss_x loss_x 1.6963 (1.5531) acc_x 59.3750 (58.1250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/13] time 0.533 (0.476) data 0.403 (0.345) loss_x loss_x 1.4355 (1.5243) acc_x 50.0000 (57.5000) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1909
confident_label rate tensor(0.1419, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 445
clean true:338
clean false:107
clean_rate:0.7595505617977528
noisy true:889
noisy false:1802
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 2691
epoch [16/200] batch [5/13] time 0.505 (0.454) data 0.374 (0.322) loss_x loss_x 1.5498 (1.7238) acc_x 62.5000 (54.3750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/13] time 0.368 (0.439) data 0.237 (0.307) loss_x loss_x 1.8906 (1.6707) acc_x 59.3750 (57.5000) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1898
confident_label rate tensor(0.1445, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 453
clean true:337
clean false:116
clean_rate:0.7439293598233996
noisy true:901
noisy false:1782
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 2683
epoch [17/200] batch [5/14] time 0.557 (0.513) data 0.427 (0.383) loss_x loss_x 1.2500 (1.5615) acc_x 59.3750 (60.0000) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/14] time 0.462 (0.464) data 0.330 (0.333) loss_x loss_x 2.2422 (1.6437) acc_x 46.8750 (59.0625) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1857
confident_label rate tensor(0.1416, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 444
clean true:332
clean false:112
clean_rate:0.7477477477477478
noisy true:947
noisy false:1745
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 2692
epoch [18/200] batch [5/13] time 0.467 (0.502) data 0.336 (0.371) loss_x loss_x 1.3809 (1.4100) acc_x 53.1250 (60.0000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/13] time 0.474 (0.467) data 0.343 (0.336) loss_x loss_x 1.3828 (1.5006) acc_x 56.2500 (58.7500) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1840
confident_label rate tensor(0.1381, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 433
clean true:333
clean false:100
clean_rate:0.76905311778291
noisy true:963
noisy false:1740
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 2703
epoch [19/200] batch [5/13] time 0.441 (0.447) data 0.310 (0.316) loss_x loss_x 1.3047 (1.4234) acc_x 65.6250 (61.8750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/13] time 0.520 (0.475) data 0.389 (0.344) loss_x loss_x 1.7861 (1.5298) acc_x 56.2500 (60.0000) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1866
confident_label rate tensor(0.1489, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 467
clean true:344
clean false:123
clean_rate:0.7366167023554604
noisy true:926
noisy false:1743
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 2669
epoch [20/200] batch [5/14] time 0.530 (0.488) data 0.399 (0.356) loss_x loss_x 1.3672 (1.7160) acc_x 59.3750 (52.5000) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/14] time 0.438 (0.464) data 0.308 (0.333) loss_x loss_x 1.7598 (1.7479) acc_x 46.8750 (50.9375) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1911
confident_label rate tensor(0.1483, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 465
clean true:335
clean false:130
clean_rate:0.7204301075268817
noisy true:890
noisy false:1781
after delete: len(clean_dataset) 465
after delete: len(noisy_dataset) 2671
epoch [21/200] batch [5/14] time 0.351 (0.459) data 0.220 (0.327) loss_x loss_x 1.9805 (1.7414) acc_x 43.7500 (53.7500) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/14] time 0.418 (0.461) data 0.288 (0.330) loss_x loss_x 1.1387 (1.6498) acc_x 65.6250 (57.5000) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1888
confident_label rate tensor(0.1314, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 412
clean true:317
clean false:95
clean_rate:0.7694174757281553
noisy true:931
noisy false:1793
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 2724
epoch [22/200] batch [5/12] time 0.413 (0.464) data 0.282 (0.333) loss_x loss_x 1.3955 (1.6785) acc_x 59.3750 (61.2500) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/12] time 0.523 (0.455) data 0.392 (0.324) loss_x loss_x 1.3828 (1.6541) acc_x 53.1250 (57.8125) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1845
confident_label rate tensor(0.1502, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 471
clean true:341
clean false:130
clean_rate:0.7239915074309978
noisy true:950
noisy false:1715
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 2665
epoch [23/200] batch [5/14] time 0.537 (0.457) data 0.405 (0.326) loss_x loss_x 1.3535 (1.3773) acc_x 56.2500 (56.8750) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/14] time 0.397 (0.442) data 0.266 (0.311) loss_x loss_x 1.7617 (1.4810) acc_x 46.8750 (57.1875) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1891
confident_label rate tensor(0.1432, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 449
clean true:330
clean false:119
clean_rate:0.734966592427617
noisy true:915
noisy false:1772
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 2687
epoch [24/200] batch [5/14] time 0.500 (0.493) data 0.369 (0.362) loss_x loss_x 1.5674 (2.1588) acc_x 62.5000 (46.8750) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/14] time 0.446 (0.466) data 0.315 (0.335) loss_x loss_x 1.5039 (1.7970) acc_x 71.8750 (56.5625) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1849
confident_label rate tensor(0.1409, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 442
clean true:336
clean false:106
clean_rate:0.7601809954751131
noisy true:951
noisy false:1743
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 2694
epoch [25/200] batch [5/13] time 0.405 (0.478) data 0.274 (0.347) loss_x loss_x 1.7705 (1.6068) acc_x 62.5000 (60.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/13] time 0.481 (0.470) data 0.350 (0.339) loss_x loss_x 1.0430 (1.5309) acc_x 78.1250 (60.6250) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1860
confident_label rate tensor(0.1505, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 472
clean true:348
clean false:124
clean_rate:0.7372881355932204
noisy true:928
noisy false:1736
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 2664
epoch [26/200] batch [5/14] time 0.527 (0.511) data 0.397 (0.380) loss_x loss_x 1.7207 (1.6240) acc_x 59.3750 (66.2500) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/14] time 0.593 (0.506) data 0.461 (0.375) loss_x loss_x 1.0742 (1.7113) acc_x 62.5000 (59.6875) lr 1.9298e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1870
confident_label rate tensor(0.1441, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 452
clean true:329
clean false:123
clean_rate:0.7278761061946902
noisy true:937
noisy false:1747
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 2684
epoch [27/200] batch [5/14] time 0.410 (0.485) data 0.279 (0.354) loss_x loss_x 1.9609 (1.6494) acc_x 50.0000 (57.5000) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/14] time 0.584 (0.473) data 0.454 (0.342) loss_x loss_x 1.3330 (1.4960) acc_x 75.0000 (60.3125) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1844
confident_label rate tensor(0.1483, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 465
clean true:350
clean false:115
clean_rate:0.7526881720430108
noisy true:942
noisy false:1729
after delete: len(clean_dataset) 465
after delete: len(noisy_dataset) 2671
epoch [28/200] batch [5/14] time 0.605 (0.493) data 0.475 (0.362) loss_x loss_x 1.7412 (1.7012) acc_x 62.5000 (59.3750) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/14] time 0.398 (0.485) data 0.268 (0.354) loss_x loss_x 1.1836 (1.5658) acc_x 62.5000 (59.0625) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1847
confident_label rate tensor(0.1515, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 475
clean true:339
clean false:136
clean_rate:0.7136842105263158
noisy true:950
noisy false:1711
after delete: len(clean_dataset) 475
after delete: len(noisy_dataset) 2661
epoch [29/200] batch [5/14] time 0.442 (0.451) data 0.310 (0.320) loss_x loss_x 1.5713 (1.7115) acc_x 56.2500 (55.6250) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/14] time 0.317 (0.431) data 0.185 (0.300) loss_x loss_x 2.0234 (1.6758) acc_x 46.8750 (57.8125) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1876
confident_label rate tensor(0.1441, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 452
clean true:327
clean false:125
clean_rate:0.7234513274336283
noisy true:933
noisy false:1751
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 2684
epoch [30/200] batch [5/14] time 0.439 (0.452) data 0.308 (0.321) loss_x loss_x 1.5332 (1.5832) acc_x 43.7500 (54.3750) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/14] time 0.724 (0.493) data 0.593 (0.362) loss_x loss_x 1.4668 (1.6147) acc_x 53.1250 (56.2500) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1865
confident_label rate tensor(0.1502, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 471
clean true:334
clean false:137
clean_rate:0.7091295116772823
noisy true:937
noisy false:1728
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 2665
epoch [31/200] batch [5/14] time 0.390 (0.465) data 0.258 (0.333) loss_x loss_x 1.3994 (1.4959) acc_x 68.7500 (59.3750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/14] time 0.373 (0.451) data 0.242 (0.320) loss_x loss_x 1.6035 (1.5572) acc_x 62.5000 (60.9375) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1862
confident_label rate tensor(0.1486, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 466
clean true:335
clean false:131
clean_rate:0.7188841201716738
noisy true:939
noisy false:1731
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 2670
epoch [32/200] batch [5/14] time 0.477 (0.407) data 0.345 (0.276) loss_x loss_x 1.2773 (1.4963) acc_x 59.3750 (55.6250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/14] time 0.474 (0.438) data 0.343 (0.307) loss_x loss_x 1.3691 (1.4355) acc_x 65.6250 (59.6875) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1855
confident_label rate tensor(0.1511, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 474
clean true:343
clean false:131
clean_rate:0.7236286919831224
noisy true:938
noisy false:1724
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 2662
epoch [33/200] batch [5/14] time 0.502 (0.453) data 0.370 (0.323) loss_x loss_x 2.0254 (1.3382) acc_x 46.8750 (61.2500) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/14] time 0.461 (0.481) data 0.329 (0.350) loss_x loss_x 2.0898 (1.5201) acc_x 53.1250 (60.0000) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1874
confident_label rate tensor(0.1435, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 450
clean true:330
clean false:120
clean_rate:0.7333333333333333
noisy true:932
noisy false:1754
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 2686
epoch [34/200] batch [5/14] time 0.482 (0.461) data 0.352 (0.330) loss_x loss_x 1.0918 (1.5423) acc_x 62.5000 (57.5000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/14] time 0.378 (0.479) data 0.246 (0.347) loss_x loss_x 1.4082 (1.5105) acc_x 59.3750 (60.3125) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1849
confident_label rate tensor(0.1582, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 496
clean true:357
clean false:139
clean_rate:0.719758064516129
noisy true:930
noisy false:1710
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 2640
epoch [35/200] batch [5/15] time 0.390 (0.420) data 0.259 (0.289) loss_x loss_x 1.5361 (1.3088) acc_x 53.1250 (61.8750) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/15] time 0.458 (0.448) data 0.327 (0.317) loss_x loss_x 2.7754 (1.4421) acc_x 53.1250 (61.5625) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/15] time 0.381 (0.438) data 0.250 (0.306) loss_x loss_x 1.5957 (1.4897) acc_x 59.3750 (60.2083) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1880
confident_label rate tensor(0.1547, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 485
clean true:359
clean false:126
clean_rate:0.7402061855670103
noisy true:897
noisy false:1754
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 2651
epoch [36/200] batch [5/15] time 0.360 (0.402) data 0.230 (0.272) loss_x loss_x 1.5273 (1.7387) acc_x 68.7500 (57.5000) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/15] time 0.402 (0.409) data 0.272 (0.279) loss_x loss_x 1.2373 (1.5432) acc_x 71.8750 (61.8750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/15] time 0.535 (0.439) data 0.403 (0.308) loss_x loss_x 1.5225 (1.5268) acc_x 62.5000 (61.2500) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1874
confident_label rate tensor(0.1547, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 485
clean true:350
clean false:135
clean_rate:0.7216494845360825
noisy true:912
noisy false:1739
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 2651
epoch [37/200] batch [5/15] time 0.602 (0.493) data 0.472 (0.363) loss_x loss_x 1.2490 (1.4799) acc_x 71.8750 (59.3750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/15] time 0.455 (0.458) data 0.323 (0.327) loss_x loss_x 1.7969 (1.5740) acc_x 50.0000 (56.2500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/15] time 0.501 (0.454) data 0.370 (0.323) loss_x loss_x 1.4873 (1.5299) acc_x 50.0000 (57.7083) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1849
confident_label rate tensor(0.1585, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 497
clean true:355
clean false:142
clean_rate:0.7142857142857143
noisy true:932
noisy false:1707
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 2639
epoch [38/200] batch [5/15] time 0.472 (0.490) data 0.342 (0.359) loss_x loss_x 2.2051 (1.6938) acc_x 40.6250 (54.3750) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/15] time 0.384 (0.455) data 0.253 (0.324) loss_x loss_x 1.4346 (1.5917) acc_x 56.2500 (56.5625) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/15] time 0.396 (0.443) data 0.265 (0.312) loss_x loss_x 1.5684 (1.5615) acc_x 62.5000 (57.7083) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1860
confident_label rate tensor(0.1572, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 493
clean true:368
clean false:125
clean_rate:0.7464503042596349
noisy true:908
noisy false:1735
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 2643
epoch [39/200] batch [5/15] time 0.397 (0.431) data 0.266 (0.300) loss_x loss_x 1.2666 (1.4627) acc_x 62.5000 (60.6250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/15] time 0.365 (0.430) data 0.234 (0.299) loss_x loss_x 1.6689 (1.5791) acc_x 62.5000 (61.8750) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/15] time 0.501 (0.466) data 0.369 (0.335) loss_x loss_x 1.2373 (1.5291) acc_x 65.6250 (61.2500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1825
confident_label rate tensor(0.1578, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 495
clean true:360
clean false:135
clean_rate:0.7272727272727273
noisy true:951
noisy false:1690
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 2641
epoch [40/200] batch [5/15] time 0.410 (0.480) data 0.279 (0.349) loss_x loss_x 1.8135 (1.4463) acc_x 46.8750 (58.7500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/15] time 0.423 (0.472) data 0.293 (0.341) loss_x loss_x 1.0283 (1.4536) acc_x 71.8750 (60.3125) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/15] time 0.447 (0.464) data 0.316 (0.333) loss_x loss_x 1.6729 (1.5583) acc_x 56.2500 (58.7500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1877
confident_label rate tensor(0.1496, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 469
clean true:332
clean false:137
clean_rate:0.7078891257995735
noisy true:927
noisy false:1740
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 2667
epoch [41/200] batch [5/14] time 0.535 (0.448) data 0.404 (0.317) loss_x loss_x 1.5771 (1.4828) acc_x 62.5000 (58.1250) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/14] time 0.363 (0.468) data 0.232 (0.337) loss_x loss_x 1.9189 (1.4432) acc_x 43.7500 (59.6875) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1894
confident_label rate tensor(0.1623, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 509
clean true:349
clean false:160
clean_rate:0.6856581532416502
noisy true:893
noisy false:1734
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 2627
epoch [42/200] batch [5/15] time 0.427 (0.502) data 0.296 (0.371) loss_x loss_x 1.7373 (1.6090) acc_x 53.1250 (55.6250) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/15] time 0.474 (0.450) data 0.343 (0.319) loss_x loss_x 1.4814 (1.5399) acc_x 59.3750 (59.6875) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/15] time 0.455 (0.458) data 0.324 (0.327) loss_x loss_x 1.2803 (1.5331) acc_x 71.8750 (61.8750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1847
confident_label rate tensor(0.1639, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 514
clean true:373
clean false:141
clean_rate:0.72568093385214
noisy true:916
noisy false:1706
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 2622
epoch [43/200] batch [5/16] time 0.591 (0.441) data 0.460 (0.310) loss_x loss_x 1.3486 (1.4111) acc_x 68.7500 (60.6250) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/16] time 0.365 (0.437) data 0.234 (0.306) loss_x loss_x 1.2646 (1.5021) acc_x 71.8750 (60.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/16] time 0.401 (0.440) data 0.270 (0.309) loss_x loss_x 1.7812 (1.5991) acc_x 62.5000 (59.7917) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1866
confident_label rate tensor(0.1591, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 499
clean true:353
clean false:146
clean_rate:0.7074148296593187
noisy true:917
noisy false:1720
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 2637
epoch [44/200] batch [5/15] time 0.407 (0.455) data 0.276 (0.324) loss_x loss_x 1.3799 (1.5844) acc_x 68.7500 (59.3750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/15] time 0.483 (0.499) data 0.352 (0.368) loss_x loss_x 1.3926 (1.5983) acc_x 62.5000 (60.9375) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/15] time 0.461 (0.486) data 0.331 (0.355) loss_x loss_x 1.6670 (1.5762) acc_x 65.6250 (61.6667) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1858
confident_label rate tensor(0.1629, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 511
clean true:369
clean false:142
clean_rate:0.7221135029354208
noisy true:909
noisy false:1716
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 2625
epoch [45/200] batch [5/15] time 0.352 (0.430) data 0.222 (0.300) loss_x loss_x 1.4062 (1.4031) acc_x 59.3750 (62.5000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/15] time 0.514 (0.461) data 0.383 (0.331) loss_x loss_x 1.8770 (1.5721) acc_x 59.3750 (62.1875) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/15] time 0.580 (0.477) data 0.449 (0.346) loss_x loss_x 1.2969 (1.5500) acc_x 71.8750 (60.6250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1862
confident_label rate tensor(0.1636, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 513
clean true:365
clean false:148
clean_rate:0.7115009746588694
noisy true:909
noisy false:1714
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 2623
epoch [46/200] batch [5/16] time 0.505 (0.460) data 0.374 (0.329) loss_x loss_x 1.2256 (1.6309) acc_x 56.2500 (55.6250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/16] time 0.465 (0.475) data 0.334 (0.344) loss_x loss_x 1.6416 (1.5937) acc_x 53.1250 (58.1250) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/16] time 0.431 (0.465) data 0.300 (0.334) loss_x loss_x 1.4434 (1.5901) acc_x 59.3750 (57.2917) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1857
confident_label rate tensor(0.1620, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 508
clean true:351
clean false:157
clean_rate:0.6909448818897638
noisy true:928
noisy false:1700
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 2628
epoch [47/200] batch [5/15] time 0.402 (0.408) data 0.272 (0.277) loss_x loss_x 1.0654 (1.2697) acc_x 65.6250 (65.0000) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/15] time 0.445 (0.437) data 0.314 (0.307) loss_x loss_x 1.5781 (1.4342) acc_x 59.3750 (60.6250) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/15] time 0.526 (0.458) data 0.395 (0.327) loss_x loss_x 1.7549 (1.4525) acc_x 59.3750 (60.4167) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1883
confident_label rate tensor(0.1527, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 479
clean true:342
clean false:137
clean_rate:0.7139874739039666
noisy true:911
noisy false:1746
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 2657
epoch [48/200] batch [5/14] time 0.383 (0.522) data 0.253 (0.391) loss_x loss_x 1.2236 (1.2193) acc_x 78.1250 (70.0000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/14] time 0.462 (0.500) data 0.331 (0.369) loss_x loss_x 1.7812 (1.3937) acc_x 46.8750 (65.3125) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1826
confident_label rate tensor(0.1645, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 516
clean true:370
clean false:146
clean_rate:0.7170542635658915
noisy true:940
noisy false:1680
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 2620
epoch [49/200] batch [5/16] time 0.643 (0.525) data 0.513 (0.394) loss_x loss_x 1.6133 (1.4674) acc_x 53.1250 (62.5000) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/16] time 0.389 (0.492) data 0.259 (0.362) loss_x loss_x 1.2275 (1.4686) acc_x 65.6250 (61.2500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/16] time 0.346 (0.464) data 0.215 (0.333) loss_x loss_x 1.6602 (1.4807) acc_x 56.2500 (61.2500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1820
confident_label rate tensor(0.1655, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 519
clean true:369
clean false:150
clean_rate:0.7109826589595376
noisy true:947
noisy false:1670
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 2617
epoch [50/200] batch [5/16] time 0.394 (0.464) data 0.263 (0.333) loss_x loss_x 1.4814 (1.5428) acc_x 59.3750 (58.1250) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/16] time 0.352 (0.459) data 0.221 (0.328) loss_x loss_x 0.9771 (1.4342) acc_x 75.0000 (61.5625) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/16] time 0.435 (0.465) data 0.304 (0.334) loss_x loss_x 1.9189 (1.5093) acc_x 50.0000 (60.0000) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1822
confident_label rate tensor(0.1601, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 502
clean true:353
clean false:149
clean_rate:0.703187250996016
noisy true:961
noisy false:1673
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 2634
epoch [51/200] batch [5/15] time 0.554 (0.466) data 0.423 (0.334) loss_x loss_x 1.8887 (1.4955) acc_x 53.1250 (61.8750) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/15] time 0.503 (0.479) data 0.371 (0.348) loss_x loss_x 1.5098 (1.3926) acc_x 62.5000 (66.2500) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/15] time 0.466 (0.479) data 0.334 (0.347) loss_x loss_x 1.5742 (1.4340) acc_x 68.7500 (66.0417) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1835
confident_label rate tensor(0.1617, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 507
clean true:352
clean false:155
clean_rate:0.6942800788954635
noisy true:949
noisy false:1680
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 2629
epoch [52/200] batch [5/15] time 0.388 (0.438) data 0.257 (0.307) loss_x loss_x 1.7295 (1.2947) acc_x 59.3750 (69.3750) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/15] time 0.594 (0.448) data 0.463 (0.317) loss_x loss_x 1.4121 (1.3085) acc_x 65.6250 (65.9375) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/15] time 0.514 (0.467) data 0.383 (0.336) loss_x loss_x 0.8721 (1.3536) acc_x 75.0000 (65.6250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1854
confident_label rate tensor(0.1601, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 502
clean true:349
clean false:153
clean_rate:0.6952191235059761
noisy true:933
noisy false:1701
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 2634
epoch [53/200] batch [5/15] time 0.449 (0.435) data 0.318 (0.304) loss_x loss_x 1.4834 (1.3891) acc_x 62.5000 (65.6250) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/15] time 0.412 (0.419) data 0.281 (0.289) loss_x loss_x 1.3252 (1.3288) acc_x 68.7500 (65.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/15] time 0.365 (0.429) data 0.233 (0.297) loss_x loss_x 1.6250 (1.4153) acc_x 56.2500 (63.1250) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1804
confident_label rate tensor(0.1693, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 531
clean true:369
clean false:162
clean_rate:0.6949152542372882
noisy true:963
noisy false:1642
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 2605
epoch [54/200] batch [5/16] time 0.457 (0.438) data 0.324 (0.307) loss_x loss_x 1.7148 (1.4084) acc_x 62.5000 (63.7500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/16] time 0.540 (0.481) data 0.409 (0.350) loss_x loss_x 1.8643 (1.4256) acc_x 62.5000 (64.6875) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/16] time 0.574 (0.483) data 0.443 (0.351) loss_x loss_x 1.4238 (1.4499) acc_x 62.5000 (63.3333) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1844
confident_label rate tensor(0.1639, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 514
clean true:367
clean false:147
clean_rate:0.7140077821011673
noisy true:925
noisy false:1697
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 2622
epoch [55/200] batch [5/16] time 0.515 (0.511) data 0.385 (0.380) loss_x loss_x 1.2480 (1.2686) acc_x 68.7500 (68.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/16] time 0.574 (0.504) data 0.443 (0.373) loss_x loss_x 1.0996 (1.1559) acc_x 78.1250 (72.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/16] time 0.417 (0.473) data 0.286 (0.342) loss_x loss_x 2.3887 (1.3558) acc_x 43.7500 (68.1250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1870
confident_label rate tensor(0.1684, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 528
clean true:365
clean false:163
clean_rate:0.6912878787878788
noisy true:901
noisy false:1707
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 2608
epoch [56/200] batch [5/16] time 0.382 (0.445) data 0.252 (0.315) loss_x loss_x 1.6367 (1.6129) acc_x 56.2500 (60.6250) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/16] time 0.496 (0.449) data 0.365 (0.318) loss_x loss_x 1.2861 (1.5346) acc_x 56.2500 (58.4375) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/16] time 0.372 (0.438) data 0.241 (0.307) loss_x loss_x 1.7061 (1.5555) acc_x 65.6250 (59.1667) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1839
confident_label rate tensor(0.1709, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 536
clean true:373
clean false:163
clean_rate:0.6958955223880597
noisy true:924
noisy false:1676
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 2600
epoch [57/200] batch [5/16] time 0.361 (0.411) data 0.230 (0.280) loss_x loss_x 1.0967 (1.3303) acc_x 68.7500 (65.6250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/16] time 0.511 (0.447) data 0.379 (0.316) loss_x loss_x 2.2070 (1.4243) acc_x 46.8750 (64.0625) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/16] time 0.441 (0.459) data 0.311 (0.328) loss_x loss_x 1.3926 (1.4080) acc_x 56.2500 (64.5833) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1873
confident_label rate tensor(0.1601, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 502
clean true:343
clean false:159
clean_rate:0.6832669322709163
noisy true:920
noisy false:1714
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 2634
epoch [58/200] batch [5/15] time 0.378 (0.472) data 0.247 (0.341) loss_x loss_x 1.3662 (1.7412) acc_x 62.5000 (52.5000) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/15] time 0.566 (0.465) data 0.434 (0.334) loss_x loss_x 1.5771 (1.5714) acc_x 62.5000 (58.7500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/15] time 0.335 (0.454) data 0.204 (0.323) loss_x loss_x 1.5273 (1.5229) acc_x 56.2500 (58.9583) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1892
confident_label rate tensor(0.1700, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 533
clean true:357
clean false:176
clean_rate:0.6697936210131332
noisy true:887
noisy false:1716
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 2603
epoch [59/200] batch [5/16] time 0.416 (0.438) data 0.286 (0.308) loss_x loss_x 1.3672 (1.2752) acc_x 59.3750 (65.6250) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/16] time 0.402 (0.447) data 0.271 (0.316) loss_x loss_x 1.7314 (1.3433) acc_x 65.6250 (66.2500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/16] time 0.375 (0.446) data 0.244 (0.315) loss_x loss_x 1.1016 (1.3357) acc_x 71.8750 (65.4167) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1877
confident_label rate tensor(0.1655, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 519
clean true:351
clean false:168
clean_rate:0.6763005780346821
noisy true:908
noisy false:1709
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 2617
epoch [60/200] batch [5/16] time 0.370 (0.441) data 0.238 (0.309) loss_x loss_x 1.3535 (1.4089) acc_x 62.5000 (65.6250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/16] time 0.390 (0.422) data 0.259 (0.290) loss_x loss_x 1.8311 (1.4661) acc_x 62.5000 (64.6875) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/16] time 0.441 (0.435) data 0.310 (0.304) loss_x loss_x 1.5146 (1.4062) acc_x 62.5000 (64.1667) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1871
confident_label rate tensor(0.1776, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 557
clean true:381
clean false:176
clean_rate:0.6840215439856373
noisy true:884
noisy false:1695
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 2579
epoch [61/200] batch [5/17] time 0.473 (0.455) data 0.342 (0.325) loss_x loss_x 1.1426 (1.3686) acc_x 71.8750 (61.8750) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/17] time 0.377 (0.475) data 0.246 (0.344) loss_x loss_x 1.5361 (1.3906) acc_x 59.3750 (61.5625) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/17] time 0.398 (0.464) data 0.267 (0.333) loss_x loss_x 1.9062 (1.4544) acc_x 53.1250 (60.2083) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1877
confident_label rate tensor(0.1661, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 521
clean true:349
clean false:172
clean_rate:0.6698656429942419
noisy true:910
noisy false:1705
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 2615
epoch [62/200] batch [5/16] time 0.451 (0.470) data 0.320 (0.339) loss_x loss_x 1.7852 (1.4383) acc_x 65.6250 (63.1250) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/16] time 0.402 (0.446) data 0.271 (0.315) loss_x loss_x 1.5137 (1.5512) acc_x 59.3750 (61.2500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/16] time 0.404 (0.436) data 0.272 (0.305) loss_x loss_x 1.5986 (1.5483) acc_x 46.8750 (60.0000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1888
confident_label rate tensor(0.1722, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 540
clean true:361
clean false:179
clean_rate:0.6685185185185185
noisy true:887
noisy false:1709
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 2596
epoch [63/200] batch [5/16] time 0.540 (0.457) data 0.409 (0.326) loss_x loss_x 1.1621 (1.4943) acc_x 71.8750 (58.7500) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/16] time 0.506 (0.454) data 0.376 (0.323) loss_x loss_x 1.2803 (1.4128) acc_x 71.8750 (62.1875) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/16] time 0.419 (0.449) data 0.289 (0.318) loss_x loss_x 1.7832 (1.4227) acc_x 40.6250 (61.6667) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1899
confident_label rate tensor(0.1703, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 534
clean true:344
clean false:190
clean_rate:0.6441947565543071
noisy true:893
noisy false:1709
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 2602
epoch [64/200] batch [5/16] time 0.361 (0.432) data 0.230 (0.301) loss_x loss_x 1.5977 (1.5865) acc_x 68.7500 (60.6250) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/16] time 0.538 (0.452) data 0.407 (0.321) loss_x loss_x 1.2021 (1.4383) acc_x 68.7500 (63.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/16] time 0.389 (0.446) data 0.257 (0.314) loss_x loss_x 1.1572 (1.4319) acc_x 71.8750 (63.7500) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1872
confident_label rate tensor(0.1636, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 513
clean true:350
clean false:163
clean_rate:0.682261208576998
noisy true:914
noisy false:1709
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 2623
epoch [65/200] batch [5/16] time 0.486 (0.437) data 0.355 (0.306) loss_x loss_x 1.3984 (1.4379) acc_x 59.3750 (58.7500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/16] time 0.463 (0.439) data 0.332 (0.308) loss_x loss_x 1.0234 (1.4275) acc_x 68.7500 (58.4375) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/16] time 0.635 (0.459) data 0.503 (0.328) loss_x loss_x 1.2783 (1.4092) acc_x 78.1250 (61.2500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1869
confident_label rate tensor(0.1757, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 551
clean true:364
clean false:187
clean_rate:0.6606170598911071
noisy true:903
noisy false:1682
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 2585
epoch [66/200] batch [5/17] time 0.449 (0.483) data 0.318 (0.352) loss_x loss_x 1.7422 (1.3280) acc_x 59.3750 (66.2500) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/17] time 0.392 (0.465) data 0.260 (0.334) loss_x loss_x 1.8008 (1.4571) acc_x 75.0000 (67.1875) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/17] time 0.418 (0.454) data 0.287 (0.323) loss_x loss_x 1.5811 (1.4612) acc_x 62.5000 (66.2500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1862
confident_label rate tensor(0.1738, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 545
clean true:364
clean false:181
clean_rate:0.6678899082568808
noisy true:910
noisy false:1681
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 2591
epoch [67/200] batch [5/17] time 0.675 (0.482) data 0.544 (0.352) loss_x loss_x 1.5947 (1.4988) acc_x 59.3750 (58.1250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/17] time 0.465 (0.467) data 0.334 (0.336) loss_x loss_x 1.2441 (1.4257) acc_x 65.6250 (63.4375) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/17] time 0.456 (0.470) data 0.324 (0.339) loss_x loss_x 1.4619 (1.4344) acc_x 75.0000 (64.5833) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1870
confident_label rate tensor(0.1735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 544
clean true:364
clean false:180
clean_rate:0.6691176470588235
noisy true:902
noisy false:1690
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 2592
epoch [68/200] batch [5/17] time 0.607 (0.463) data 0.476 (0.332) loss_x loss_x 1.0557 (1.2586) acc_x 68.7500 (68.7500) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/17] time 0.452 (0.473) data 0.322 (0.342) loss_x loss_x 1.5752 (1.3748) acc_x 56.2500 (63.7500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/17] time 0.377 (0.448) data 0.246 (0.317) loss_x loss_x 2.1230 (1.4521) acc_x 40.6250 (61.6667) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1885
confident_label rate tensor(0.1773, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 556
clean true:365
clean false:191
clean_rate:0.6564748201438849
noisy true:886
noisy false:1694
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 2580
epoch [69/200] batch [5/17] time 0.389 (0.410) data 0.259 (0.280) loss_x loss_x 1.7578 (1.5623) acc_x 59.3750 (61.8750) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/17] time 0.534 (0.439) data 0.403 (0.308) loss_x loss_x 1.4385 (1.4943) acc_x 62.5000 (62.5000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/17] time 0.477 (0.444) data 0.347 (0.313) loss_x loss_x 1.3584 (1.4206) acc_x 62.5000 (63.7500) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1867
confident_label rate tensor(0.1735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 544
clean true:377
clean false:167
clean_rate:0.6930147058823529
noisy true:892
noisy false:1700
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 2592
epoch [70/200] batch [5/17] time 0.399 (0.491) data 0.269 (0.360) loss_x loss_x 1.7275 (1.2636) acc_x 59.3750 (66.8750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/17] time 0.421 (0.460) data 0.289 (0.329) loss_x loss_x 1.1387 (1.2750) acc_x 75.0000 (66.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/17] time 0.444 (0.471) data 0.313 (0.340) loss_x loss_x 0.7710 (1.3014) acc_x 78.1250 (66.4583) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1845
confident_label rate tensor(0.1814, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 569
clean true:384
clean false:185
clean_rate:0.6748681898066784
noisy true:907
noisy false:1660
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 2567
epoch [71/200] batch [5/17] time 0.427 (0.417) data 0.296 (0.286) loss_x loss_x 0.8730 (1.3461) acc_x 71.8750 (61.8750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/17] time 0.471 (0.435) data 0.340 (0.304) loss_x loss_x 1.2773 (1.3764) acc_x 65.6250 (61.5625) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/17] time 0.595 (0.445) data 0.465 (0.314) loss_x loss_x 1.2021 (1.4080) acc_x 65.6250 (61.2500) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1836
confident_label rate tensor(0.1770, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 555
clean true:375
clean false:180
clean_rate:0.6756756756756757
noisy true:925
noisy false:1656
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 2581
epoch [72/200] batch [5/17] time 0.519 (0.452) data 0.389 (0.321) loss_x loss_x 1.5879 (1.1140) acc_x 62.5000 (70.6250) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/17] time 0.413 (0.491) data 0.282 (0.359) loss_x loss_x 1.2188 (1.2562) acc_x 68.7500 (68.1250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/17] time 0.422 (0.478) data 0.291 (0.346) loss_x loss_x 1.2783 (1.2737) acc_x 68.7500 (67.0833) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1875
confident_label rate tensor(0.1735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 544
clean true:352
clean false:192
clean_rate:0.6470588235294118
noisy true:909
noisy false:1683
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 2592
epoch [73/200] batch [5/17] time 0.586 (0.542) data 0.455 (0.411) loss_x loss_x 1.2148 (1.5064) acc_x 75.0000 (64.3750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [10/17] time 0.378 (0.490) data 0.246 (0.359) loss_x loss_x 1.4648 (1.3634) acc_x 56.2500 (67.5000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/17] time 0.423 (0.482) data 0.292 (0.351) loss_x loss_x 1.0479 (1.3222) acc_x 71.8750 (68.3333) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1864
confident_label rate tensor(0.1696, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 532
clean true:352
clean false:180
clean_rate:0.6616541353383458
noisy true:920
noisy false:1684
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 2604
epoch [74/200] batch [5/16] time 0.428 (0.493) data 0.297 (0.362) loss_x loss_x 1.3730 (1.1738) acc_x 68.7500 (69.3750) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/16] time 0.460 (0.477) data 0.329 (0.346) loss_x loss_x 1.2959 (1.3126) acc_x 68.7500 (65.9375) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/16] time 0.489 (0.461) data 0.359 (0.330) loss_x loss_x 1.2754 (1.3454) acc_x 62.5000 (65.4167) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1878
confident_label rate tensor(0.1827, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 573
clean true:383
clean false:190
clean_rate:0.6684118673647469
noisy true:875
noisy false:1688
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 2563
epoch [75/200] batch [5/17] time 0.551 (0.489) data 0.421 (0.359) loss_x loss_x 0.7437 (1.3257) acc_x 81.2500 (68.7500) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/17] time 0.424 (0.462) data 0.294 (0.332) loss_x loss_x 1.0986 (1.3239) acc_x 68.7500 (67.8125) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/17] time 0.371 (0.449) data 0.238 (0.318) loss_x loss_x 0.5908 (1.2929) acc_x 84.3750 (67.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1882
confident_label rate tensor(0.1757, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 551
clean true:364
clean false:187
clean_rate:0.6606170598911071
noisy true:890
noisy false:1695
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 2585
epoch [76/200] batch [5/17] time 0.435 (0.470) data 0.304 (0.339) loss_x loss_x 0.9062 (1.1961) acc_x 68.7500 (71.2500) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/17] time 0.420 (0.490) data 0.289 (0.359) loss_x loss_x 1.5176 (1.2762) acc_x 62.5000 (67.1875) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/17] time 0.462 (0.472) data 0.330 (0.341) loss_x loss_x 1.1240 (1.2770) acc_x 65.6250 (66.4583) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1866
confident_label rate tensor(0.1783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 559
clean true:376
clean false:183
clean_rate:0.6726296958855098
noisy true:894
noisy false:1683
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 2577
epoch [77/200] batch [5/17] time 0.592 (0.456) data 0.461 (0.326) loss_x loss_x 1.2773 (1.3516) acc_x 68.7500 (65.0000) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/17] time 0.387 (0.459) data 0.256 (0.329) loss_x loss_x 1.3184 (1.3566) acc_x 62.5000 (63.1250) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/17] time 0.518 (0.459) data 0.387 (0.328) loss_x loss_x 1.2207 (1.3934) acc_x 65.6250 (63.3333) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1882
confident_label rate tensor(0.1830, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 574
clean true:373
clean false:201
clean_rate:0.6498257839721254
noisy true:881
noisy false:1681
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 2562
epoch [78/200] batch [5/17] time 0.457 (0.453) data 0.326 (0.322) loss_x loss_x 1.4131 (1.4371) acc_x 65.6250 (68.7500) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/17] time 0.468 (0.471) data 0.336 (0.340) loss_x loss_x 1.0352 (1.3521) acc_x 71.8750 (65.9375) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/17] time 0.368 (0.454) data 0.237 (0.323) loss_x loss_x 1.5029 (1.3749) acc_x 53.1250 (64.3750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1910
confident_label rate tensor(0.1840, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 577
clean true:380
clean false:197
clean_rate:0.658578856152513
noisy true:846
noisy false:1713
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 2559
epoch [79/200] batch [5/18] time 0.455 (0.452) data 0.325 (0.322) loss_x loss_x 1.0830 (1.3180) acc_x 62.5000 (69.3750) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/18] time 0.378 (0.446) data 0.247 (0.315) loss_x loss_x 1.0801 (1.2405) acc_x 75.0000 (70.6250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/18] time 0.436 (0.452) data 0.305 (0.321) loss_x loss_x 1.4834 (1.2970) acc_x 65.6250 (68.5417) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1919
confident_label rate tensor(0.1751, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 549
clean true:359
clean false:190
clean_rate:0.6539162112932605
noisy true:858
noisy false:1729
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 2587
epoch [80/200] batch [5/17] time 0.407 (0.492) data 0.277 (0.361) loss_x loss_x 1.1367 (1.2580) acc_x 65.6250 (69.3750) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/17] time 0.458 (0.445) data 0.327 (0.314) loss_x loss_x 1.3213 (1.3464) acc_x 75.0000 (65.9375) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/17] time 0.460 (0.439) data 0.330 (0.309) loss_x loss_x 1.5010 (1.3694) acc_x 62.5000 (65.2083) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1843
confident_label rate tensor(0.1840, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 577
clean true:387
clean false:190
clean_rate:0.6707105719237435
noisy true:906
noisy false:1653
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 2559
epoch [81/200] batch [5/18] time 0.418 (0.458) data 0.287 (0.327) loss_x loss_x 1.0225 (1.3391) acc_x 71.8750 (66.2500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/18] time 0.385 (0.470) data 0.254 (0.339) loss_x loss_x 1.3994 (1.4421) acc_x 65.6250 (62.5000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/18] time 0.488 (0.475) data 0.358 (0.344) loss_x loss_x 1.5820 (1.4312) acc_x 59.3750 (61.8750) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1855
confident_label rate tensor(0.1888, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 592
clean true:391
clean false:201
clean_rate:0.660472972972973
noisy true:890
noisy false:1654
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 2544
epoch [82/200] batch [5/18] time 0.480 (0.435) data 0.349 (0.304) loss_x loss_x 1.3633 (1.6648) acc_x 59.3750 (57.5000) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/18] time 0.517 (0.456) data 0.384 (0.325) loss_x loss_x 1.6992 (1.4783) acc_x 56.2500 (62.8125) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/18] time 0.518 (0.452) data 0.386 (0.321) loss_x loss_x 1.6885 (1.5093) acc_x 71.8750 (62.0833) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1862
confident_label rate tensor(0.1865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 585
clean true:399
clean false:186
clean_rate:0.6820512820512821
noisy true:875
noisy false:1676
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 2551
epoch [83/200] batch [5/18] time 0.572 (0.444) data 0.441 (0.313) loss_x loss_x 1.2119 (1.3121) acc_x 71.8750 (68.1250) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/18] time 0.399 (0.456) data 0.268 (0.324) loss_x loss_x 1.8652 (1.3909) acc_x 50.0000 (65.9375) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/18] time 0.384 (0.444) data 0.254 (0.312) loss_x loss_x 1.5059 (1.3854) acc_x 62.5000 (66.6667) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1849
confident_label rate tensor(0.1827, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 573
clean true:380
clean false:193
clean_rate:0.6631762652705061
noisy true:907
noisy false:1656
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 2563
epoch [84/200] batch [5/17] time 0.680 (0.465) data 0.548 (0.334) loss_x loss_x 1.6641 (1.4165) acc_x 62.5000 (66.8750) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/17] time 0.478 (0.486) data 0.347 (0.355) loss_x loss_x 0.9863 (1.3061) acc_x 75.0000 (68.1250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/17] time 0.460 (0.475) data 0.330 (0.344) loss_x loss_x 1.2627 (1.3783) acc_x 65.6250 (66.8750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1910
confident_label rate tensor(0.1744, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 547
clean true:361
clean false:186
clean_rate:0.659963436928702
noisy true:865
noisy false:1724
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 2589
epoch [85/200] batch [5/17] time 0.380 (0.460) data 0.249 (0.329) loss_x loss_x 1.2480 (1.2873) acc_x 75.0000 (67.5000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/17] time 0.458 (0.430) data 0.328 (0.300) loss_x loss_x 1.0342 (1.3822) acc_x 71.8750 (63.4375) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/17] time 0.428 (0.434) data 0.298 (0.304) loss_x loss_x 2.1992 (1.4440) acc_x 53.1250 (62.9167) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1874
confident_label rate tensor(0.1760, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 552
clean true:363
clean false:189
clean_rate:0.657608695652174
noisy true:899
noisy false:1685
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 2584
epoch [86/200] batch [5/17] time 0.401 (0.420) data 0.271 (0.289) loss_x loss_x 1.0732 (1.2415) acc_x 65.6250 (65.6250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/17] time 0.455 (0.443) data 0.324 (0.312) loss_x loss_x 1.0635 (1.3084) acc_x 68.7500 (64.0625) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/17] time 0.484 (0.453) data 0.354 (0.322) loss_x loss_x 1.3242 (1.2594) acc_x 75.0000 (66.0417) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1883
confident_label rate tensor(0.1821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 571
clean true:371
clean false:200
clean_rate:0.649737302977233
noisy true:882
noisy false:1683
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 2565
epoch [87/200] batch [5/17] time 0.403 (0.479) data 0.273 (0.348) loss_x loss_x 1.1309 (1.1625) acc_x 62.5000 (70.0000) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/17] time 0.470 (0.460) data 0.339 (0.329) loss_x loss_x 1.4639 (1.2326) acc_x 56.2500 (67.8125) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/17] time 0.367 (0.457) data 0.236 (0.326) loss_x loss_x 1.5420 (1.2725) acc_x 56.2500 (66.6667) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1854
confident_label rate tensor(0.1878, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 589
clean true:388
clean false:201
clean_rate:0.6587436332767402
noisy true:894
noisy false:1653
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 2547
epoch [88/200] batch [5/18] time 0.538 (0.468) data 0.408 (0.337) loss_x loss_x 0.8877 (1.2086) acc_x 78.1250 (73.1250) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [10/18] time 0.436 (0.462) data 0.304 (0.331) loss_x loss_x 1.4434 (1.3316) acc_x 68.7500 (67.5000) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/18] time 0.484 (0.459) data 0.353 (0.327) loss_x loss_x 0.8999 (1.3019) acc_x 81.2500 (69.1667) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1858
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 594
clean true:375
clean false:219
clean_rate:0.6313131313131313
noisy true:903
noisy false:1639
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 2542
epoch [89/200] batch [5/18] time 0.389 (0.466) data 0.258 (0.335) loss_x loss_x 0.9312 (1.2204) acc_x 78.1250 (68.7500) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [10/18] time 0.459 (0.443) data 0.328 (0.313) loss_x loss_x 1.1270 (1.4419) acc_x 59.3750 (64.0625) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/18] time 0.490 (0.464) data 0.360 (0.333) loss_x loss_x 1.7734 (1.4967) acc_x 56.2500 (62.7083) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1822
confident_label rate tensor(0.1818, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 570
clean true:383
clean false:187
clean_rate:0.6719298245614035
noisy true:931
noisy false:1635
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 2566
epoch [90/200] batch [5/17] time 0.490 (0.409) data 0.359 (0.278) loss_x loss_x 1.1982 (1.3994) acc_x 65.6250 (63.1250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/17] time 0.393 (0.428) data 0.262 (0.297) loss_x loss_x 1.4043 (1.3808) acc_x 62.5000 (63.1250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/17] time 0.444 (0.433) data 0.313 (0.302) loss_x loss_x 1.1602 (1.3136) acc_x 62.5000 (64.1667) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1874
confident_label rate tensor(0.1862, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 584
clean true:393
clean false:191
clean_rate:0.672945205479452
noisy true:869
noisy false:1683
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 2552
epoch [91/200] batch [5/18] time 0.583 (0.493) data 0.452 (0.362) loss_x loss_x 0.9233 (1.1173) acc_x 75.0000 (71.8750) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [10/18] time 0.395 (0.448) data 0.263 (0.317) loss_x loss_x 1.8086 (1.2887) acc_x 50.0000 (66.2500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/18] time 0.438 (0.433) data 0.307 (0.302) loss_x loss_x 1.2275 (1.2741) acc_x 65.6250 (66.6667) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1864
confident_label rate tensor(0.1805, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 566
clean true:371
clean false:195
clean_rate:0.6554770318021201
noisy true:901
noisy false:1669
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 2570
epoch [92/200] batch [5/17] time 0.422 (0.463) data 0.291 (0.332) loss_x loss_x 1.1152 (1.4344) acc_x 68.7500 (68.1250) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/17] time 0.553 (0.495) data 0.422 (0.364) loss_x loss_x 1.0869 (1.3210) acc_x 65.6250 (65.9375) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/17] time 0.476 (0.483) data 0.345 (0.352) loss_x loss_x 0.7852 (1.3115) acc_x 68.7500 (65.4167) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1886
confident_label rate tensor(0.1789, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 561
clean true:371
clean false:190
clean_rate:0.661319073083779
noisy true:879
noisy false:1696
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 2575
epoch [93/200] batch [5/17] time 0.486 (0.438) data 0.355 (0.307) loss_x loss_x 1.5420 (1.3816) acc_x 62.5000 (66.8750) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/17] time 0.379 (0.442) data 0.248 (0.310) loss_x loss_x 1.5254 (1.3649) acc_x 65.6250 (67.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [15/17] time 0.372 (0.426) data 0.241 (0.295) loss_x loss_x 0.9507 (1.3302) acc_x 75.0000 (68.5417) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1891
confident_label rate tensor(0.1821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 571
clean true:361
clean false:210
clean_rate:0.6322241681260946
noisy true:884
noisy false:1681
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 2565
epoch [94/200] batch [5/17] time 0.372 (0.425) data 0.241 (0.294) loss_x loss_x 1.5430 (1.4188) acc_x 59.3750 (65.6250) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/17] time 0.402 (0.422) data 0.270 (0.291) loss_x loss_x 2.0996 (1.4922) acc_x 50.0000 (63.4375) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/17] time 0.384 (0.433) data 0.253 (0.302) loss_x loss_x 1.6973 (1.3812) acc_x 50.0000 (65.4167) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1871
confident_label rate tensor(0.1904, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 597
clean true:383
clean false:214
clean_rate:0.6415410385259631
noisy true:882
noisy false:1657
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 2539
epoch [95/200] batch [5/18] time 0.424 (0.465) data 0.294 (0.335) loss_x loss_x 1.7969 (1.6803) acc_x 56.2500 (56.2500) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [10/18] time 0.374 (0.463) data 0.242 (0.332) loss_x loss_x 1.2344 (1.4896) acc_x 71.8750 (62.8125) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/18] time 0.423 (0.468) data 0.291 (0.337) loss_x loss_x 1.4238 (1.4541) acc_x 65.6250 (63.5417) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1863
confident_label rate tensor(0.1818, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 570
clean true:369
clean false:201
clean_rate:0.6473684210526316
noisy true:904
noisy false:1662
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 2566
epoch [96/200] batch [5/17] time 0.537 (0.445) data 0.406 (0.315) loss_x loss_x 1.4121 (1.2116) acc_x 62.5000 (66.8750) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/17] time 0.443 (0.447) data 0.312 (0.316) loss_x loss_x 1.0586 (1.1611) acc_x 68.7500 (68.7500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/17] time 0.427 (0.459) data 0.296 (0.328) loss_x loss_x 1.5371 (1.2481) acc_x 59.3750 (66.4583) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1828
confident_label rate tensor(0.1881, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 590
clean true:391
clean false:199
clean_rate:0.6627118644067796
noisy true:917
noisy false:1629
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 2546
epoch [97/200] batch [5/18] time 0.384 (0.497) data 0.253 (0.365) loss_x loss_x 1.7178 (1.6512) acc_x 62.5000 (61.8750) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [10/18] time 0.443 (0.457) data 0.313 (0.326) loss_x loss_x 1.1748 (1.5168) acc_x 71.8750 (63.4375) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/18] time 0.454 (0.446) data 0.323 (0.315) loss_x loss_x 1.6475 (1.4972) acc_x 53.1250 (63.9583) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1867
confident_label rate tensor(0.1859, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 583
clean true:386
clean false:197
clean_rate:0.6620926243567753
noisy true:883
noisy false:1670
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 2553
epoch [98/200] batch [5/18] time 0.384 (0.452) data 0.253 (0.321) loss_x loss_x 0.9863 (1.2563) acc_x 65.6250 (65.6250) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/18] time 0.406 (0.457) data 0.275 (0.326) loss_x loss_x 1.6045 (1.4128) acc_x 62.5000 (65.6250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [15/18] time 0.384 (0.467) data 0.253 (0.336) loss_x loss_x 0.8037 (1.3291) acc_x 81.2500 (66.8750) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1873
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 594
clean true:384
clean false:210
clean_rate:0.6464646464646465
noisy true:879
noisy false:1663
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 2542
epoch [99/200] batch [5/18] time 0.515 (0.474) data 0.385 (0.343) loss_x loss_x 1.4824 (1.2040) acc_x 62.5000 (72.5000) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [10/18] time 0.426 (0.459) data 0.295 (0.328) loss_x loss_x 1.5137 (1.1657) acc_x 71.8750 (73.4375) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/18] time 0.572 (0.457) data 0.440 (0.326) loss_x loss_x 1.5801 (1.3068) acc_x 65.6250 (70.2083) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1867
confident_label rate tensor(0.1920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 602
clean true:390
clean false:212
clean_rate:0.6478405315614618
noisy true:879
noisy false:1655
all clean rate:  [0.6968325791855203, 0.6818181818181818, 0.7703488372093024, 0.7905236907730673, 0.7708830548926014, 0.7434052757793765, 0.7662337662337663, 0.7493734335839599, 0.7704194260485652, 0.7607655502392344, 0.7977272727272727, 0.7403846153846154, 0.7579185520361991, 0.7388535031847133, 0.7744874715261959, 0.7595505617977528, 0.7439293598233996, 0.7477477477477478, 0.76905311778291, 0.7366167023554604, 0.7204301075268817, 0.7694174757281553, 0.7239915074309978, 0.734966592427617, 0.7601809954751131, 0.7372881355932204, 0.7278761061946902, 0.7526881720430108, 0.7136842105263158, 0.7234513274336283, 0.7091295116772823, 0.7188841201716738, 0.7236286919831224, 0.7333333333333333, 0.719758064516129, 0.7402061855670103, 0.7216494845360825, 0.7142857142857143, 0.7464503042596349, 0.7272727272727273, 0.7078891257995735, 0.6856581532416502, 0.72568093385214, 0.7074148296593187, 0.7221135029354208, 0.7115009746588694, 0.6909448818897638, 0.7139874739039666, 0.7170542635658915, 0.7109826589595376, 0.703187250996016, 0.6942800788954635, 0.6952191235059761, 0.6949152542372882, 0.7140077821011673, 0.6912878787878788, 0.6958955223880597, 0.6832669322709163, 0.6697936210131332, 0.6763005780346821, 0.6840215439856373, 0.6698656429942419, 0.6685185185185185, 0.6441947565543071, 0.682261208576998, 0.6606170598911071, 0.6678899082568808, 0.6691176470588235, 0.6564748201438849, 0.6930147058823529, 0.6748681898066784, 0.6756756756756757, 0.6470588235294118, 0.6616541353383458, 0.6684118673647469, 0.6606170598911071, 0.6726296958855098, 0.6498257839721254, 0.658578856152513, 0.6539162112932605, 0.6707105719237435, 0.660472972972973, 0.6820512820512821, 0.6631762652705061, 0.659963436928702, 0.657608695652174, 0.649737302977233, 0.6587436332767402, 0.6313131313131313, 0.6719298245614035, 0.672945205479452, 0.6554770318021201, 0.661319073083779, 0.6322241681260946, 0.6415410385259631, 0.6473684210526316, 0.6627118644067796, 0.6620926243567753, 0.6464646464646465, 0.6478405315614618]
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 2534
epoch [100/200] batch [5/18] time 0.475 (0.456) data 0.344 (0.325) loss_x loss_x 0.9580 (1.3559) acc_x 68.7500 (61.8750) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/18] time 0.350 (0.448) data 0.219 (0.317) loss_x loss_x 1.1396 (1.2821) acc_x 71.8750 (65.9375) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [15/18] time 0.446 (0.450) data 0.315 (0.318) loss_x loss_x 1.0195 (1.3400) acc_x 68.7500 (65.0000) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1909
confident_label rate tensor(0.1805, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 566
clean true:357
clean false:209
clean_rate:0.6307420494699647
noisy true:870
noisy false:1700
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 2570
epoch [101/200] batch [5/17] time 0.457 (0.438) data 0.326 (0.307) loss_x loss_x 1.3164 (1.3650) acc_x 75.0000 (68.1250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/17] time 0.474 (0.442) data 0.344 (0.311) loss_x loss_x 1.7275 (1.2818) acc_x 56.2500 (69.0625) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/17] time 0.449 (0.438) data 0.318 (0.307) loss_x loss_x 0.9448 (1.3515) acc_x 68.7500 (66.8750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1919
confident_label rate tensor(0.1824, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 572
clean true:354
clean false:218
clean_rate:0.6188811188811189
noisy true:863
noisy false:1701
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 2564
epoch [102/200] batch [5/17] time 0.460 (0.497) data 0.329 (0.366) loss_x loss_x 1.2002 (1.0894) acc_x 68.7500 (73.1250) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/17] time 0.471 (0.509) data 0.340 (0.378) loss_x loss_x 1.0352 (1.0844) acc_x 71.8750 (71.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/17] time 0.474 (0.494) data 0.343 (0.362) loss_x loss_x 0.7646 (1.0715) acc_x 78.1250 (70.4167) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1877
confident_label rate tensor(0.1891, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 593
clean true:387
clean false:206
clean_rate:0.6526138279932546
noisy true:872
noisy false:1671
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 2543
epoch [103/200] batch [5/18] time 0.350 (0.431) data 0.220 (0.300) loss_x loss_x 1.1641 (1.2260) acc_x 68.7500 (71.2500) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/18] time 0.371 (0.431) data 0.241 (0.300) loss_x loss_x 1.3838 (1.1767) acc_x 53.1250 (68.7500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [15/18] time 0.396 (0.457) data 0.264 (0.326) loss_x loss_x 1.4082 (1.2559) acc_x 65.6250 (68.7500) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1890
confident_label rate tensor(0.1846, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 579
clean true:372
clean false:207
clean_rate:0.6424870466321243
noisy true:874
noisy false:1683
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 2557
epoch [104/200] batch [5/18] time 0.417 (0.469) data 0.286 (0.338) loss_x loss_x 1.3154 (1.1340) acc_x 71.8750 (73.1250) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [10/18] time 0.390 (0.461) data 0.259 (0.330) loss_x loss_x 1.5908 (1.2227) acc_x 71.8750 (70.0000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [15/18] time 0.456 (0.459) data 0.326 (0.328) loss_x loss_x 1.3975 (1.2104) acc_x 65.6250 (69.5833) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1838
confident_label rate tensor(0.1897, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 595
clean true:394
clean false:201
clean_rate:0.6621848739495798
noisy true:904
noisy false:1637
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 2541
epoch [105/200] batch [5/18] time 0.441 (0.430) data 0.310 (0.299) loss_x loss_x 1.5000 (1.3252) acc_x 71.8750 (67.5000) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/18] time 0.458 (0.458) data 0.326 (0.327) loss_x loss_x 1.2480 (1.4232) acc_x 71.8750 (63.1250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/18] time 0.477 (0.477) data 0.346 (0.346) loss_x loss_x 1.2920 (1.3327) acc_x 59.3750 (65.4167) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1853
confident_label rate tensor(0.1897, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 595
clean true:391
clean false:204
clean_rate:0.6571428571428571
noisy true:892
noisy false:1649
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 2541
epoch [106/200] batch [5/18] time 0.481 (0.492) data 0.350 (0.361) loss_x loss_x 0.8110 (1.3200) acc_x 65.6250 (62.5000) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [10/18] time 0.427 (0.455) data 0.297 (0.325) loss_x loss_x 1.6807 (1.3276) acc_x 62.5000 (64.0625) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [15/18] time 0.335 (0.456) data 0.203 (0.325) loss_x loss_x 1.4844 (1.3394) acc_x 56.2500 (62.9167) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1901
confident_label rate tensor(0.1920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 602
clean true:376
clean false:226
clean_rate:0.6245847176079734
noisy true:859
noisy false:1675
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 2534
epoch [107/200] batch [5/18] time 0.559 (0.464) data 0.428 (0.333) loss_x loss_x 1.0000 (1.0037) acc_x 81.2500 (76.8750) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [10/18] time 0.478 (0.445) data 0.347 (0.314) loss_x loss_x 1.4365 (1.1080) acc_x 68.7500 (73.7500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/18] time 0.451 (0.452) data 0.320 (0.321) loss_x loss_x 1.6582 (1.1674) acc_x 62.5000 (72.0833) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1879
confident_label rate tensor(0.1897, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 595
clean true:385
clean false:210
clean_rate:0.6470588235294118
noisy true:872
noisy false:1669
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 2541
epoch [108/200] batch [5/18] time 0.476 (0.471) data 0.345 (0.340) loss_x loss_x 0.8843 (1.2778) acc_x 75.0000 (68.7500) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [10/18] time 0.473 (0.477) data 0.341 (0.346) loss_x loss_x 1.2324 (1.1693) acc_x 71.8750 (70.9375) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/18] time 0.345 (0.451) data 0.215 (0.320) loss_x loss_x 1.3408 (1.1538) acc_x 65.6250 (70.4167) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1894
confident_label rate tensor(0.1872, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 587
clean true:376
clean false:211
clean_rate:0.6405451448040886
noisy true:866
noisy false:1683
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 2549
epoch [109/200] batch [5/18] time 0.553 (0.444) data 0.422 (0.313) loss_x loss_x 1.4756 (1.4988) acc_x 62.5000 (60.6250) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/18] time 0.511 (0.453) data 0.380 (0.322) loss_x loss_x 1.7139 (1.3348) acc_x 59.3750 (64.3750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/18] time 0.464 (0.446) data 0.332 (0.315) loss_x loss_x 0.9771 (1.3165) acc_x 68.7500 (64.1667) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1854
confident_label rate tensor(0.1945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 610
clean true:390
clean false:220
clean_rate:0.639344262295082
noisy true:892
noisy false:1634
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 2526
epoch [110/200] batch [5/19] time 0.397 (0.409) data 0.266 (0.278) loss_x loss_x 1.2119 (1.3855) acc_x 68.7500 (62.5000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/19] time 0.478 (0.426) data 0.346 (0.295) loss_x loss_x 1.0459 (1.3051) acc_x 75.0000 (67.5000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/19] time 0.509 (0.446) data 0.377 (0.315) loss_x loss_x 1.4170 (1.3316) acc_x 68.7500 (66.4583) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1916
confident_label rate tensor(0.1904, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 597
clean true:374
clean false:223
clean_rate:0.626465661641541
noisy true:846
noisy false:1693
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 2539
epoch [111/200] batch [5/18] time 0.353 (0.398) data 0.223 (0.268) loss_x loss_x 1.4014 (1.6400) acc_x 59.3750 (58.7500) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/18] time 0.572 (0.457) data 0.442 (0.326) loss_x loss_x 1.1240 (1.4593) acc_x 62.5000 (62.8125) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/18] time 0.619 (0.464) data 0.488 (0.333) loss_x loss_x 1.2559 (1.4387) acc_x 59.3750 (62.7083) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1895
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 586
clean true:362
clean false:224
clean_rate:0.6177474402730375
noisy true:879
noisy false:1671
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 2550
epoch [112/200] batch [5/18] time 0.482 (0.436) data 0.351 (0.305) loss_x loss_x 1.2383 (1.2492) acc_x 68.7500 (69.3750) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/18] time 0.523 (0.446) data 0.392 (0.315) loss_x loss_x 1.3779 (1.2011) acc_x 56.2500 (68.7500) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/18] time 0.505 (0.449) data 0.374 (0.318) loss_x loss_x 1.0059 (1.1477) acc_x 81.2500 (69.3750) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1907
confident_label rate tensor(0.1837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 576
clean true:361
clean false:215
clean_rate:0.6267361111111112
noisy true:868
noisy false:1692
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 2560
epoch [113/200] batch [5/18] time 0.435 (0.451) data 0.304 (0.320) loss_x loss_x 1.8369 (1.2656) acc_x 59.3750 (68.1250) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/18] time 0.323 (0.467) data 0.192 (0.336) loss_x loss_x 2.1309 (1.3459) acc_x 40.6250 (65.6250) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/18] time 0.654 (0.462) data 0.523 (0.331) loss_x loss_x 0.9839 (1.2700) acc_x 56.2500 (67.2917) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1877
confident_label rate tensor(0.1920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 602
clean true:385
clean false:217
clean_rate:0.6395348837209303
noisy true:874
noisy false:1660
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 2534
epoch [114/200] batch [5/18] time 0.450 (0.473) data 0.319 (0.342) loss_x loss_x 1.2891 (1.3144) acc_x 65.6250 (68.1250) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [10/18] time 0.505 (0.473) data 0.374 (0.341) loss_x loss_x 1.1309 (1.3651) acc_x 75.0000 (66.8750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/18] time 0.435 (0.453) data 0.304 (0.322) loss_x loss_x 1.2744 (1.2846) acc_x 65.6250 (68.1250) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1843
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 586
clean true:374
clean false:212
clean_rate:0.6382252559726962
noisy true:919
noisy false:1631
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 2550
epoch [115/200] batch [5/18] time 0.400 (0.467) data 0.270 (0.336) loss_x loss_x 1.3213 (1.1600) acc_x 75.0000 (75.0000) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [10/18] time 0.557 (0.471) data 0.426 (0.341) loss_x loss_x 1.3613 (1.1452) acc_x 62.5000 (73.1250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/18] time 0.458 (0.459) data 0.327 (0.328) loss_x loss_x 1.3848 (1.2253) acc_x 68.7500 (71.0417) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1898
confident_label rate tensor(0.1891, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 593
clean true:361
clean false:232
clean_rate:0.6087689713322091
noisy true:877
noisy false:1666
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 2543
epoch [116/200] batch [5/18] time 0.585 (0.458) data 0.454 (0.327) loss_x loss_x 1.3047 (1.2426) acc_x 65.6250 (68.1250) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/18] time 0.571 (0.452) data 0.441 (0.321) loss_x loss_x 1.4512 (1.2619) acc_x 62.5000 (68.4375) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/18] time 0.414 (0.438) data 0.284 (0.308) loss_x loss_x 1.4639 (1.2325) acc_x 65.6250 (69.5833) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1909
confident_label rate tensor(0.1971, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 618
clean true:389
clean false:229
clean_rate:0.6294498381877023
noisy true:838
noisy false:1680
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 2518
epoch [117/200] batch [5/19] time 0.405 (0.467) data 0.273 (0.336) loss_x loss_x 1.3857 (1.4891) acc_x 68.7500 (64.3750) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [10/19] time 0.525 (0.457) data 0.393 (0.326) loss_x loss_x 1.3770 (1.4202) acc_x 62.5000 (65.3125) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/19] time 0.364 (0.442) data 0.233 (0.310) loss_x loss_x 0.7549 (1.3563) acc_x 78.1250 (66.0417) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1902
confident_label rate tensor(0.1942, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 609
clean true:389
clean false:220
clean_rate:0.638752052545156
noisy true:845
noisy false:1682
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 2527
epoch [118/200] batch [5/19] time 0.416 (0.444) data 0.286 (0.313) loss_x loss_x 1.5215 (1.0020) acc_x 62.5000 (73.1250) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [10/19] time 0.518 (0.460) data 0.387 (0.329) loss_x loss_x 1.3096 (1.1882) acc_x 62.5000 (68.1250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/19] time 0.420 (0.468) data 0.289 (0.336) loss_x loss_x 0.4917 (1.1865) acc_x 90.6250 (69.1667) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1882
confident_label rate tensor(0.1983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 622
clean true:391
clean false:231
clean_rate:0.6286173633440515
noisy true:863
noisy false:1651
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 2514
epoch [119/200] batch [5/19] time 0.494 (0.449) data 0.363 (0.318) loss_x loss_x 1.0684 (1.0609) acc_x 71.8750 (75.0000) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [10/19] time 0.671 (0.468) data 0.541 (0.337) loss_x loss_x 1.3555 (1.2785) acc_x 59.3750 (65.6250) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/19] time 0.490 (0.465) data 0.359 (0.334) loss_x loss_x 1.2383 (1.3423) acc_x 68.7500 (65.4167) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1890
confident_label rate tensor(0.1920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 602
clean true:367
clean false:235
clean_rate:0.6096345514950167
noisy true:879
noisy false:1655
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 2534
epoch [120/200] batch [5/18] time 0.491 (0.481) data 0.360 (0.349) loss_x loss_x 1.1885 (1.0201) acc_x 71.8750 (75.6250) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [10/18] time 0.372 (0.464) data 0.241 (0.333) loss_x loss_x 1.4316 (1.0115) acc_x 56.2500 (73.4375) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/18] time 0.426 (0.478) data 0.295 (0.346) loss_x loss_x 1.3672 (1.1512) acc_x 56.2500 (68.9583) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1916
confident_label rate tensor(0.1888, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 592
clean true:368
clean false:224
clean_rate:0.6216216216216216
noisy true:852
noisy false:1692
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 2544
epoch [121/200] batch [5/18] time 0.471 (0.477) data 0.340 (0.346) loss_x loss_x 1.3799 (1.3189) acc_x 68.7500 (66.2500) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [10/18] time 0.386 (0.456) data 0.255 (0.325) loss_x loss_x 1.8467 (1.2862) acc_x 50.0000 (66.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/18] time 0.403 (0.458) data 0.272 (0.327) loss_x loss_x 1.2734 (1.2707) acc_x 71.8750 (66.2500) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1880
confident_label rate tensor(0.1916, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 601
clean true:389
clean false:212
clean_rate:0.6472545757071547
noisy true:867
noisy false:1668
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 2535
epoch [122/200] batch [5/18] time 0.382 (0.473) data 0.251 (0.341) loss_x loss_x 1.6758 (1.3621) acc_x 59.3750 (68.1250) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [10/18] time 0.384 (0.457) data 0.252 (0.326) loss_x loss_x 1.7500 (1.3249) acc_x 43.7500 (68.4375) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/18] time 0.380 (0.448) data 0.249 (0.317) loss_x loss_x 1.6855 (1.2963) acc_x 59.3750 (68.9583) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1913
confident_label rate tensor(0.1916, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 601
clean true:380
clean false:221
clean_rate:0.632279534109817
noisy true:843
noisy false:1692
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 2535
epoch [123/200] batch [5/18] time 0.411 (0.419) data 0.281 (0.288) loss_x loss_x 0.7627 (1.3623) acc_x 71.8750 (66.8750) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/18] time 0.433 (0.422) data 0.301 (0.291) loss_x loss_x 0.9531 (1.3075) acc_x 78.1250 (67.8125) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/18] time 0.381 (0.446) data 0.250 (0.315) loss_x loss_x 1.2871 (1.2971) acc_x 65.6250 (67.2917) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1903
confident_label rate tensor(0.1846, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 579
clean true:368
clean false:211
clean_rate:0.6355785837651122
noisy true:865
noisy false:1692
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 2557
epoch [124/200] batch [5/18] time 0.426 (0.479) data 0.295 (0.348) loss_x loss_x 1.7002 (1.1216) acc_x 50.0000 (70.0000) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [10/18] time 0.591 (0.465) data 0.461 (0.334) loss_x loss_x 1.2158 (1.1550) acc_x 68.7500 (66.8750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [15/18] time 0.388 (0.456) data 0.257 (0.325) loss_x loss_x 1.4248 (1.1500) acc_x 65.6250 (67.5000) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1917
confident_label rate tensor(0.1948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 611
clean true:372
clean false:239
clean_rate:0.6088379705400983
noisy true:847
noisy false:1678
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 2525
epoch [125/200] batch [5/19] time 0.367 (0.449) data 0.236 (0.318) loss_x loss_x 1.3994 (1.3477) acc_x 62.5000 (66.8750) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [10/19] time 0.392 (0.466) data 0.262 (0.335) loss_x loss_x 1.2500 (1.2500) acc_x 59.3750 (67.1875) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/19] time 0.488 (0.454) data 0.358 (0.323) loss_x loss_x 1.4990 (1.3554) acc_x 62.5000 (66.2500) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1870
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:384
clean false:229
clean_rate:0.6264274061990212
noisy true:882
noisy false:1641
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [126/200] batch [5/19] time 0.486 (0.410) data 0.355 (0.279) loss_x loss_x 1.2363 (1.3635) acc_x 68.7500 (68.1250) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/19] time 0.425 (0.414) data 0.294 (0.283) loss_x loss_x 0.5610 (1.2482) acc_x 84.3750 (70.9375) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/19] time 0.538 (0.423) data 0.407 (0.292) loss_x loss_x 1.1367 (1.2761) acc_x 62.5000 (69.3750) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1863
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 621
clean true:396
clean false:225
clean_rate:0.6376811594202898
noisy true:877
noisy false:1638
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 2515
epoch [127/200] batch [5/19] time 0.429 (0.463) data 0.299 (0.331) loss_x loss_x 1.0664 (1.1270) acc_x 65.6250 (70.6250) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [10/19] time 0.378 (0.453) data 0.247 (0.322) loss_x loss_x 1.5029 (1.1472) acc_x 59.3750 (71.2500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/19] time 0.489 (0.462) data 0.358 (0.331) loss_x loss_x 1.2998 (1.1883) acc_x 71.8750 (70.0000) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1900
confident_label rate tensor(0.1942, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 609
clean true:385
clean false:224
clean_rate:0.632183908045977
noisy true:851
noisy false:1676
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 2527
epoch [128/200] batch [5/19] time 0.535 (0.436) data 0.405 (0.305) loss_x loss_x 1.0303 (1.1603) acc_x 71.8750 (75.6250) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [10/19] time 0.497 (0.476) data 0.365 (0.345) loss_x loss_x 1.8320 (1.2260) acc_x 62.5000 (72.8125) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/19] time 0.403 (0.467) data 0.272 (0.336) loss_x loss_x 1.5254 (1.1880) acc_x 59.3750 (73.3333) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1892
confident_label rate tensor(0.1967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 617
clean true:385
clean false:232
clean_rate:0.6239870340356564
noisy true:859
noisy false:1660
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 2519
epoch [129/200] batch [5/19] time 0.494 (0.443) data 0.363 (0.312) loss_x loss_x 1.3672 (1.3873) acc_x 62.5000 (68.7500) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [10/19] time 0.459 (0.447) data 0.329 (0.316) loss_x loss_x 0.9912 (1.2973) acc_x 81.2500 (71.2500) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/19] time 0.475 (0.455) data 0.344 (0.324) loss_x loss_x 1.5000 (1.2270) acc_x 59.3750 (71.8750) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1911
confident_label rate tensor(0.1948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 611
clean true:380
clean false:231
clean_rate:0.6219312602291326
noisy true:845
noisy false:1680
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 2525
epoch [130/200] batch [5/19] time 0.410 (0.444) data 0.278 (0.312) loss_x loss_x 0.9297 (1.2812) acc_x 78.1250 (69.3750) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [10/19] time 0.454 (0.451) data 0.324 (0.320) loss_x loss_x 1.0273 (1.2077) acc_x 75.0000 (70.3125) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/19] time 0.448 (0.455) data 0.318 (0.324) loss_x loss_x 1.1445 (1.2531) acc_x 75.0000 (70.2083) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1918
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:389
clean false:249
clean_rate:0.609717868338558
noisy true:829
noisy false:1669
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [131/200] batch [5/19] time 0.411 (0.428) data 0.281 (0.296) loss_x loss_x 1.7207 (1.3320) acc_x 50.0000 (67.5000) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/19] time 0.434 (0.466) data 0.303 (0.335) loss_x loss_x 1.5029 (1.2822) acc_x 65.6250 (69.6875) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/19] time 0.544 (0.454) data 0.414 (0.323) loss_x loss_x 1.3877 (1.2346) acc_x 59.3750 (70.2083) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1899
confident_label rate tensor(0.1932, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 606
clean true:379
clean false:227
clean_rate:0.6254125412541254
noisy true:858
noisy false:1672
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 2530
epoch [132/200] batch [5/18] time 0.440 (0.454) data 0.309 (0.323) loss_x loss_x 1.1387 (1.2529) acc_x 68.7500 (67.5000) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/18] time 0.408 (0.430) data 0.277 (0.299) loss_x loss_x 1.2041 (1.2079) acc_x 65.6250 (69.6875) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/18] time 0.448 (0.440) data 0.318 (0.309) loss_x loss_x 0.9790 (1.1900) acc_x 75.0000 (70.2083) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1881
confident_label rate tensor(0.1999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 627
clean true:388
clean false:239
clean_rate:0.6188197767145136
noisy true:867
noisy false:1642
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 2509
epoch [133/200] batch [5/19] time 0.422 (0.518) data 0.290 (0.386) loss_x loss_x 0.7051 (1.1393) acc_x 81.2500 (66.8750) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [10/19] time 0.359 (0.475) data 0.228 (0.344) loss_x loss_x 1.5430 (1.2689) acc_x 62.5000 (66.8750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/19] time 0.428 (0.467) data 0.298 (0.337) loss_x loss_x 1.2871 (1.2467) acc_x 65.6250 (66.8750) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1896
confident_label rate tensor(0.1967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 617
clean true:387
clean false:230
clean_rate:0.6272285251215559
noisy true:853
noisy false:1666
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 2519
epoch [134/200] batch [5/19] time 0.547 (0.478) data 0.417 (0.347) loss_x loss_x 1.4297 (1.2549) acc_x 68.7500 (68.7500) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [10/19] time 0.399 (0.459) data 0.269 (0.328) loss_x loss_x 1.1602 (1.1658) acc_x 75.0000 (70.0000) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/19] time 0.411 (0.438) data 0.281 (0.307) loss_x loss_x 1.5352 (1.2038) acc_x 65.6250 (68.9583) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1891
confident_label rate tensor(0.2015, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 632
clean true:391
clean false:241
clean_rate:0.6186708860759493
noisy true:854
noisy false:1650
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 2504
epoch [135/200] batch [5/19] time 0.434 (0.435) data 0.303 (0.304) loss_x loss_x 0.8784 (1.1405) acc_x 84.3750 (71.8750) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [10/19] time 0.458 (0.435) data 0.327 (0.304) loss_x loss_x 0.7695 (1.0603) acc_x 78.1250 (73.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/19] time 0.528 (0.439) data 0.396 (0.308) loss_x loss_x 1.1650 (1.1599) acc_x 68.7500 (70.6250) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1915
confident_label rate tensor(0.1983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 622
clean true:393
clean false:229
clean_rate:0.6318327974276527
noisy true:828
noisy false:1686
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 2514
epoch [136/200] batch [5/19] time 0.400 (0.440) data 0.269 (0.309) loss_x loss_x 1.1035 (1.3252) acc_x 71.8750 (65.0000) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [10/19] time 0.420 (0.444) data 0.289 (0.313) loss_x loss_x 0.8613 (1.2992) acc_x 78.1250 (67.5000) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/19] time 0.443 (0.439) data 0.312 (0.307) loss_x loss_x 1.8711 (1.3730) acc_x 59.3750 (65.6250) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1898
confident_label rate tensor(0.2038, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 639
clean true:401
clean false:238
clean_rate:0.6275430359937402
noisy true:837
noisy false:1660
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 2497
epoch [137/200] batch [5/19] time 0.317 (0.407) data 0.187 (0.276) loss_x loss_x 1.1055 (1.3791) acc_x 75.0000 (66.8750) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/19] time 0.479 (0.453) data 0.348 (0.322) loss_x loss_x 1.7217 (1.3479) acc_x 53.1250 (65.6250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/19] time 0.731 (0.477) data 0.600 (0.346) loss_x loss_x 1.2227 (1.3128) acc_x 71.8750 (66.2500) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1894
confident_label rate tensor(0.1929, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 605
clean true:380
clean false:225
clean_rate:0.628099173553719
noisy true:862
noisy false:1669
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 2531
epoch [138/200] batch [5/18] time 0.404 (0.460) data 0.273 (0.329) loss_x loss_x 1.3750 (1.3768) acc_x 62.5000 (67.5000) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/18] time 0.554 (0.497) data 0.423 (0.367) loss_x loss_x 0.8052 (1.2868) acc_x 81.2500 (70.3125) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/18] time 0.625 (0.494) data 0.494 (0.363) loss_x loss_x 1.0615 (1.2276) acc_x 75.0000 (72.0833) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1939
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:379
clean false:244
clean_rate:0.608346709470305
noisy true:818
noisy false:1695
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [139/200] batch [5/19] time 0.606 (0.495) data 0.475 (0.364) loss_x loss_x 1.0859 (1.1707) acc_x 68.7500 (67.5000) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [10/19] time 0.536 (0.475) data 0.406 (0.345) loss_x loss_x 1.5264 (1.3215) acc_x 71.8750 (66.2500) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/19] time 0.471 (0.461) data 0.340 (0.330) loss_x loss_x 1.2568 (1.2745) acc_x 68.7500 (67.0833) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1907
confident_label rate tensor(0.1999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 627
clean true:386
clean false:241
clean_rate:0.6156299840510366
noisy true:843
noisy false:1666
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 2509
epoch [140/200] batch [5/19] time 0.378 (0.435) data 0.247 (0.304) loss_x loss_x 1.4561 (1.1021) acc_x 68.7500 (75.0000) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [10/19] time 0.470 (0.466) data 0.339 (0.335) loss_x loss_x 0.8486 (1.1008) acc_x 81.2500 (74.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/19] time 0.552 (0.477) data 0.421 (0.346) loss_x loss_x 0.8604 (1.0775) acc_x 84.3750 (75.4167) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1920
confident_label rate tensor(0.2009, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 630
clean true:374
clean false:256
clean_rate:0.5936507936507937
noisy true:842
noisy false:1664
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 2506
epoch [141/200] batch [5/19] time 0.454 (0.431) data 0.322 (0.300) loss_x loss_x 1.4209 (1.0990) acc_x 75.0000 (75.6250) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [10/19] time 0.499 (0.434) data 0.368 (0.303) loss_x loss_x 1.0596 (1.1691) acc_x 65.6250 (71.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/19] time 0.362 (0.447) data 0.231 (0.316) loss_x loss_x 1.3125 (1.2652) acc_x 68.7500 (68.9583) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1924
confident_label rate tensor(0.2031, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 637
clean true:386
clean false:251
clean_rate:0.6059654631083202
noisy true:826
noisy false:1673
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 2499
epoch [142/200] batch [5/19] time 0.404 (0.481) data 0.273 (0.350) loss_x loss_x 1.1670 (1.3684) acc_x 71.8750 (66.2500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [10/19] time 0.340 (0.453) data 0.209 (0.322) loss_x loss_x 1.4727 (1.3217) acc_x 56.2500 (66.5625) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/19] time 0.411 (0.435) data 0.280 (0.304) loss_x loss_x 2.3320 (1.3888) acc_x 59.3750 (65.6250) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1912
confident_label rate tensor(0.2127, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 667
clean true:398
clean false:269
clean_rate:0.5967016491754122
noisy true:826
noisy false:1643
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 2469
epoch [143/200] batch [5/20] time 0.514 (0.461) data 0.382 (0.329) loss_x loss_x 0.7007 (1.1776) acc_x 68.7500 (68.7500) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [10/20] time 0.406 (0.454) data 0.276 (0.323) loss_x loss_x 1.1855 (1.2285) acc_x 81.2500 (70.3125) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/20] time 0.396 (0.458) data 0.265 (0.327) loss_x loss_x 1.4141 (1.2186) acc_x 56.2500 (70.0000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/20] time 0.613 (0.467) data 0.482 (0.336) loss_x loss_x 1.2080 (1.2078) acc_x 71.8750 (70.1562) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1944
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:372
clean false:241
clean_rate:0.6068515497553018
noisy true:820
noisy false:1703
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [144/200] batch [5/19] time 0.616 (0.429) data 0.485 (0.298) loss_x loss_x 1.2344 (1.2643) acc_x 68.7500 (65.6250) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [10/19] time 0.465 (0.443) data 0.334 (0.312) loss_x loss_x 1.0840 (1.1844) acc_x 65.6250 (66.2500) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/19] time 0.456 (0.452) data 0.324 (0.321) loss_x loss_x 1.3428 (1.2268) acc_x 56.2500 (66.2500) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1899
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:386
clean false:261
clean_rate:0.5965996908809892
noisy true:851
noisy false:1638
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [145/200] batch [5/20] time 0.747 (0.462) data 0.616 (0.331) loss_x loss_x 1.1875 (1.2934) acc_x 68.7500 (66.2500) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [10/20] time 0.533 (0.453) data 0.403 (0.322) loss_x loss_x 1.4014 (1.2959) acc_x 59.3750 (65.3125) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/20] time 0.482 (0.466) data 0.351 (0.335) loss_x loss_x 2.1465 (1.4015) acc_x 56.2500 (65.4167) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/20] time 0.393 (0.455) data 0.262 (0.324) loss_x loss_x 1.2422 (1.3641) acc_x 65.6250 (65.9375) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1915
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:377
clean false:268
clean_rate:0.5844961240310077
noisy true:844
noisy false:1647
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [146/200] batch [5/20] time 0.445 (0.422) data 0.313 (0.291) loss_x loss_x 1.8838 (1.3087) acc_x 59.3750 (66.2500) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [10/20] time 0.545 (0.461) data 0.415 (0.330) loss_x loss_x 1.0166 (1.3544) acc_x 75.0000 (68.1250) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/20] time 0.351 (0.455) data 0.219 (0.325) loss_x loss_x 1.5801 (1.3621) acc_x 56.2500 (67.7083) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/20] time 0.511 (0.451) data 0.379 (0.320) loss_x loss_x 1.0674 (1.2879) acc_x 71.8750 (70.1562) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1924
confident_label rate tensor(0.2003, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 628
clean true:378
clean false:250
clean_rate:0.6019108280254777
noisy true:834
noisy false:1674
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 2508
epoch [147/200] batch [5/19] time 0.374 (0.417) data 0.244 (0.286) loss_x loss_x 1.4990 (1.0753) acc_x 53.1250 (72.5000) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/19] time 0.525 (0.424) data 0.394 (0.293) loss_x loss_x 1.2314 (1.2558) acc_x 71.8750 (71.2500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/19] time 0.602 (0.451) data 0.471 (0.320) loss_x loss_x 1.2939 (1.2449) acc_x 62.5000 (69.5833) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1920
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:381
clean false:257
clean_rate:0.5971786833855799
noisy true:835
noisy false:1663
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [148/200] batch [5/19] time 0.466 (0.432) data 0.335 (0.301) loss_x loss_x 1.1260 (1.0469) acc_x 59.3750 (68.1250) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [10/19] time 0.396 (0.447) data 0.266 (0.316) loss_x loss_x 1.0176 (1.0944) acc_x 71.8750 (69.3750) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/19] time 0.410 (0.440) data 0.280 (0.309) loss_x loss_x 1.2041 (1.1799) acc_x 75.0000 (67.9167) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1913
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 663
clean true:402
clean false:261
clean_rate:0.6063348416289592
noisy true:821
noisy false:1652
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 2473
epoch [149/200] batch [5/20] time 0.402 (0.458) data 0.270 (0.327) loss_x loss_x 1.0254 (1.0674) acc_x 68.7500 (70.0000) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [10/20] time 0.427 (0.462) data 0.296 (0.331) loss_x loss_x 1.5312 (1.2055) acc_x 62.5000 (67.8125) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/20] time 0.450 (0.459) data 0.319 (0.328) loss_x loss_x 1.4629 (1.1969) acc_x 59.3750 (68.1250) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/20] time 0.471 (0.459) data 0.340 (0.328) loss_x loss_x 1.1318 (1.2225) acc_x 62.5000 (67.8125) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1916
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:383
clean false:255
clean_rate:0.6003134796238244
noisy true:837
noisy false:1661
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [150/200] batch [5/19] time 0.611 (0.466) data 0.480 (0.335) loss_x loss_x 1.5596 (1.3581) acc_x 62.5000 (66.8750) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [10/19] time 0.415 (0.443) data 0.284 (0.312) loss_x loss_x 0.6738 (1.2425) acc_x 81.2500 (68.4375) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/19] time 0.640 (0.479) data 0.509 (0.348) loss_x loss_x 1.2852 (1.2290) acc_x 56.2500 (67.2917) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1917
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 634
clean true:379
clean false:255
clean_rate:0.5977917981072555
noisy true:840
noisy false:1662
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 2502
epoch [151/200] batch [5/19] time 0.418 (0.434) data 0.287 (0.303) loss_x loss_x 1.1777 (1.1861) acc_x 56.2500 (68.7500) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [10/19] time 0.427 (0.454) data 0.296 (0.323) loss_x loss_x 1.4170 (1.1361) acc_x 62.5000 (70.0000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/19] time 0.443 (0.465) data 0.312 (0.334) loss_x loss_x 0.7788 (1.1449) acc_x 84.3750 (69.7917) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1960
confident_label rate tensor(0.2012, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 631
clean true:383
clean false:248
clean_rate:0.606973058637084
noisy true:793
noisy false:1712
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 2505
epoch [152/200] batch [5/19] time 0.460 (0.493) data 0.330 (0.362) loss_x loss_x 1.3086 (1.1761) acc_x 75.0000 (73.1250) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [10/19] time 0.373 (0.454) data 0.242 (0.323) loss_x loss_x 0.8120 (1.2056) acc_x 78.1250 (72.1875) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/19] time 0.378 (0.448) data 0.248 (0.317) loss_x loss_x 1.1787 (1.2152) acc_x 62.5000 (71.8750) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1898
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:396
clean false:259
clean_rate:0.6045801526717557
noisy true:842
noisy false:1639
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [153/200] batch [5/20] time 0.418 (0.438) data 0.287 (0.307) loss_x loss_x 1.3838 (1.4852) acc_x 65.6250 (62.5000) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [10/20] time 0.523 (0.431) data 0.392 (0.300) loss_x loss_x 1.2744 (1.3438) acc_x 68.7500 (64.6875) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/20] time 0.418 (0.432) data 0.286 (0.301) loss_x loss_x 1.2012 (1.2775) acc_x 71.8750 (66.4583) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/20] time 0.418 (0.453) data 0.287 (0.322) loss_x loss_x 1.4619 (1.2576) acc_x 59.3750 (66.7188) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1929
confident_label rate tensor(0.2111, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 662
clean true:404
clean false:258
clean_rate:0.6102719033232629
noisy true:803
noisy false:1671
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 2474
epoch [154/200] batch [5/20] time 0.450 (0.450) data 0.319 (0.319) loss_x loss_x 0.7109 (1.2369) acc_x 87.5000 (71.8750) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [10/20] time 0.519 (0.473) data 0.388 (0.342) loss_x loss_x 1.0938 (1.2845) acc_x 65.6250 (69.3750) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/20] time 0.348 (0.465) data 0.217 (0.334) loss_x loss_x 1.3574 (1.2707) acc_x 68.7500 (70.6250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/20] time 0.452 (0.459) data 0.321 (0.328) loss_x loss_x 0.9478 (1.1807) acc_x 78.1250 (72.1875) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1918
confident_label rate tensor(0.1996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 626
clean true:376
clean false:250
clean_rate:0.6006389776357828
noisy true:842
noisy false:1668
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 2510
epoch [155/200] batch [5/19] time 0.525 (0.501) data 0.394 (0.370) loss_x loss_x 1.2822 (1.0546) acc_x 71.8750 (71.8750) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [10/19] time 0.386 (0.459) data 0.254 (0.328) loss_x loss_x 0.9331 (1.1068) acc_x 75.0000 (69.6875) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/19] time 0.485 (0.457) data 0.355 (0.326) loss_x loss_x 0.9492 (1.1150) acc_x 78.1250 (69.7917) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1948
confident_label rate tensor(0.2041, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 640
clean true:381
clean false:259
clean_rate:0.5953125
noisy true:807
noisy false:1689
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 2496
epoch [156/200] batch [5/20] time 0.432 (0.508) data 0.301 (0.378) loss_x loss_x 1.3203 (1.2094) acc_x 65.6250 (66.2500) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/20] time 0.404 (0.472) data 0.272 (0.341) loss_x loss_x 1.0176 (1.1911) acc_x 68.7500 (67.1875) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/20] time 0.552 (0.467) data 0.421 (0.336) loss_x loss_x 1.4980 (1.1917) acc_x 56.2500 (67.2917) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/20] time 0.367 (0.466) data 0.237 (0.335) loss_x loss_x 1.3857 (1.2375) acc_x 68.7500 (66.8750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1911
confident_label rate tensor(0.2095, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 657
clean true:387
clean false:270
clean_rate:0.589041095890411
noisy true:838
noisy false:1641
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 2479
epoch [157/200] batch [5/20] time 0.475 (0.480) data 0.342 (0.349) loss_x loss_x 1.0410 (1.2439) acc_x 71.8750 (67.5000) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [10/20] time 0.418 (0.454) data 0.288 (0.323) loss_x loss_x 1.1807 (1.1801) acc_x 68.7500 (68.1250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/20] time 0.445 (0.454) data 0.314 (0.323) loss_x loss_x 1.1504 (1.1780) acc_x 75.0000 (68.5417) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/20] time 0.579 (0.457) data 0.448 (0.326) loss_x loss_x 0.9141 (1.1457) acc_x 65.6250 (69.3750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1917
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 643
clean true:389
clean false:254
clean_rate:0.6049766718506998
noisy true:830
noisy false:1663
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 2493
epoch [158/200] batch [5/20] time 0.452 (0.502) data 0.321 (0.370) loss_x loss_x 1.1006 (1.2743) acc_x 78.1250 (65.6250) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/20] time 0.413 (0.473) data 0.282 (0.342) loss_x loss_x 1.3457 (1.2012) acc_x 59.3750 (67.1875) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/20] time 0.371 (0.460) data 0.240 (0.330) loss_x loss_x 0.8931 (1.1565) acc_x 78.1250 (68.3333) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/20] time 0.458 (0.454) data 0.326 (0.323) loss_x loss_x 1.5039 (1.2106) acc_x 62.5000 (66.7188) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1941
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:395
clean false:250
clean_rate:0.6124031007751938
noisy true:800
noisy false:1691
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [159/200] batch [5/20] time 0.494 (0.514) data 0.363 (0.383) loss_x loss_x 1.3428 (1.1644) acc_x 62.5000 (71.2500) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [10/20] time 0.468 (0.464) data 0.337 (0.333) loss_x loss_x 1.5762 (1.2429) acc_x 62.5000 (68.7500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/20] time 0.450 (0.460) data 0.319 (0.329) loss_x loss_x 1.3447 (1.2608) acc_x 65.6250 (68.1250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/20] time 0.433 (0.458) data 0.303 (0.327) loss_x loss_x 0.8457 (1.2300) acc_x 78.1250 (68.4375) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1908
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 663
clean true:402
clean false:261
clean_rate:0.6063348416289592
noisy true:826
noisy false:1647
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 2473
epoch [160/200] batch [5/20] time 0.454 (0.467) data 0.322 (0.336) loss_x loss_x 1.2490 (1.2130) acc_x 68.7500 (67.5000) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [10/20] time 0.495 (0.448) data 0.365 (0.317) loss_x loss_x 0.8462 (1.1404) acc_x 78.1250 (71.2500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/20] time 0.460 (0.451) data 0.330 (0.320) loss_x loss_x 0.7173 (1.2092) acc_x 84.3750 (70.8333) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/20] time 0.398 (0.446) data 0.267 (0.315) loss_x loss_x 1.4092 (1.2087) acc_x 62.5000 (70.4688) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1930
confident_label rate tensor(0.2012, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 631
clean true:383
clean false:248
clean_rate:0.606973058637084
noisy true:823
noisy false:1682
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 2505
epoch [161/200] batch [5/19] time 0.526 (0.497) data 0.395 (0.366) loss_x loss_x 1.3818 (1.0847) acc_x 62.5000 (72.5000) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [10/19] time 0.331 (0.476) data 0.200 (0.345) loss_x loss_x 1.1924 (1.1032) acc_x 81.2500 (73.4375) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/19] time 0.375 (0.458) data 0.245 (0.327) loss_x loss_x 1.0039 (1.1487) acc_x 71.8750 (71.4583) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1903
confident_label rate tensor(0.2127, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 667
clean true:403
clean false:264
clean_rate:0.6041979010494752
noisy true:830
noisy false:1639
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 2469
epoch [162/200] batch [5/20] time 0.391 (0.453) data 0.260 (0.322) loss_x loss_x 1.2988 (1.0765) acc_x 71.8750 (69.3750) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [10/20] time 0.469 (0.437) data 0.338 (0.305) loss_x loss_x 1.3418 (1.1645) acc_x 75.0000 (70.0000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/20] time 0.476 (0.438) data 0.344 (0.307) loss_x loss_x 1.5723 (1.2345) acc_x 68.7500 (68.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/20] time 0.497 (0.445) data 0.366 (0.314) loss_x loss_x 1.2285 (1.2246) acc_x 65.6250 (68.5938) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1941
confident_label rate tensor(0.2054, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 644
clean true:380
clean false:264
clean_rate:0.5900621118012422
noisy true:815
noisy false:1677
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 2492
epoch [163/200] batch [5/20] time 0.417 (0.425) data 0.286 (0.293) loss_x loss_x 0.5776 (1.1685) acc_x 87.5000 (73.1250) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [10/20] time 0.586 (0.445) data 0.455 (0.313) loss_x loss_x 1.2832 (1.1516) acc_x 71.8750 (72.5000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/20] time 0.463 (0.450) data 0.332 (0.319) loss_x loss_x 1.1943 (1.1813) acc_x 81.2500 (71.2500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/20] time 0.418 (0.451) data 0.287 (0.320) loss_x loss_x 1.0889 (1.1809) acc_x 65.6250 (70.4688) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1915
confident_label rate tensor(0.2076, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 651
clean true:385
clean false:266
clean_rate:0.5913978494623656
noisy true:836
noisy false:1649
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 2485
epoch [164/200] batch [5/20] time 0.504 (0.435) data 0.372 (0.303) loss_x loss_x 1.3799 (1.0809) acc_x 68.7500 (72.5000) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [10/20] time 0.400 (0.426) data 0.268 (0.294) loss_x loss_x 1.4727 (1.1181) acc_x 62.5000 (71.2500) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/20] time 0.475 (0.443) data 0.345 (0.311) loss_x loss_x 1.5244 (1.1983) acc_x 71.8750 (70.6250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/20] time 0.385 (0.444) data 0.254 (0.313) loss_x loss_x 1.3682 (1.2064) acc_x 59.3750 (70.3125) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1898
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:410
clean false:237
clean_rate:0.633693972179289
noisy true:828
noisy false:1661
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [165/200] batch [5/20] time 0.554 (0.466) data 0.423 (0.335) loss_x loss_x 1.2793 (1.1502) acc_x 71.8750 (71.8750) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [10/20] time 0.394 (0.449) data 0.264 (0.318) loss_x loss_x 1.9248 (1.2604) acc_x 53.1250 (69.0625) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/20] time 0.352 (0.434) data 0.222 (0.302) loss_x loss_x 1.4443 (1.2394) acc_x 59.3750 (68.9583) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/20] time 0.582 (0.436) data 0.452 (0.305) loss_x loss_x 0.7959 (1.2221) acc_x 87.5000 (68.5938) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1951
confident_label rate tensor(0.2095, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 657
clean true:389
clean false:268
clean_rate:0.5920852359208524
noisy true:796
noisy false:1683
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 2479
epoch [166/200] batch [5/20] time 0.440 (0.483) data 0.308 (0.352) loss_x loss_x 1.0078 (1.1016) acc_x 68.7500 (70.0000) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [10/20] time 0.432 (0.457) data 0.301 (0.326) loss_x loss_x 1.8379 (1.1814) acc_x 65.6250 (71.2500) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/20] time 0.462 (0.465) data 0.332 (0.334) loss_x loss_x 1.0859 (1.1832) acc_x 68.7500 (69.3750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/20] time 0.548 (0.460) data 0.417 (0.329) loss_x loss_x 0.9883 (1.1918) acc_x 68.7500 (68.4375) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1932
confident_label rate tensor(0.2044, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 641
clean true:389
clean false:252
clean_rate:0.6068642745709828
noisy true:815
noisy false:1680
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 2495
epoch [167/200] batch [5/20] time 0.350 (0.423) data 0.219 (0.292) loss_x loss_x 1.4463 (1.3611) acc_x 68.7500 (68.7500) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [10/20] time 0.447 (0.423) data 0.317 (0.292) loss_x loss_x 1.3516 (1.2189) acc_x 68.7500 (70.6250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/20] time 0.511 (0.444) data 0.380 (0.313) loss_x loss_x 0.8223 (1.2164) acc_x 71.8750 (69.1667) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/20] time 0.475 (0.446) data 0.344 (0.315) loss_x loss_x 1.0771 (1.1668) acc_x 62.5000 (70.0000) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1956
confident_label rate tensor(0.2015, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 632
clean true:386
clean false:246
clean_rate:0.6107594936708861
noisy true:794
noisy false:1710
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 2504
epoch [168/200] batch [5/19] time 0.586 (0.469) data 0.455 (0.338) loss_x loss_x 1.1406 (1.3373) acc_x 68.7500 (66.8750) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [10/19] time 0.510 (0.469) data 0.379 (0.338) loss_x loss_x 1.1348 (1.1623) acc_x 62.5000 (68.7500) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/19] time 0.422 (0.469) data 0.290 (0.338) loss_x loss_x 0.8784 (1.1809) acc_x 81.2500 (68.3333) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1935
confident_label rate tensor(0.2159, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 677
clean true:401
clean false:276
clean_rate:0.5923190546528804
noisy true:800
noisy false:1659
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 2459
epoch [169/200] batch [5/21] time 0.385 (0.416) data 0.254 (0.284) loss_x loss_x 1.4277 (1.1768) acc_x 75.0000 (75.0000) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/21] time 0.454 (0.467) data 0.323 (0.336) loss_x loss_x 1.0820 (1.1683) acc_x 65.6250 (71.5625) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [15/21] time 0.501 (0.461) data 0.370 (0.330) loss_x loss_x 1.5576 (1.1572) acc_x 56.2500 (70.6250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/21] time 0.446 (0.465) data 0.316 (0.334) loss_x loss_x 0.7979 (1.1691) acc_x 81.2500 (70.6250) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1919
confident_label rate tensor(0.2124, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 666
clean true:408
clean false:258
clean_rate:0.6126126126126126
noisy true:809
noisy false:1661
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 2470
epoch [170/200] batch [5/20] time 0.421 (0.438) data 0.290 (0.307) loss_x loss_x 0.9839 (1.1466) acc_x 84.3750 (72.5000) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/20] time 0.523 (0.447) data 0.393 (0.316) loss_x loss_x 1.0312 (1.1196) acc_x 75.0000 (72.8125) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/20] time 0.474 (0.475) data 0.344 (0.345) loss_x loss_x 1.1357 (1.1401) acc_x 62.5000 (71.8750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/20] time 0.428 (0.462) data 0.298 (0.332) loss_x loss_x 1.2383 (1.2248) acc_x 71.8750 (70.9375) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1944
confident_label rate tensor(0.2127, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 667
clean true:400
clean false:267
clean_rate:0.5997001499250375
noisy true:792
noisy false:1677
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 2469
epoch [171/200] batch [5/20] time 0.501 (0.467) data 0.370 (0.335) loss_x loss_x 1.2207 (1.0625) acc_x 78.1250 (73.1250) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [10/20] time 0.509 (0.463) data 0.378 (0.332) loss_x loss_x 1.6982 (1.1227) acc_x 68.7500 (72.8125) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/20] time 0.362 (0.454) data 0.231 (0.322) loss_x loss_x 0.7754 (1.0710) acc_x 81.2500 (74.1667) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/20] time 0.436 (0.455) data 0.304 (0.323) loss_x loss_x 0.9658 (1.0505) acc_x 84.3750 (75.0000) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1917
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 656
clean true:399
clean false:257
clean_rate:0.6082317073170732
noisy true:820
noisy false:1660
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 2480
epoch [172/200] batch [5/20] time 0.533 (0.491) data 0.402 (0.361) loss_x loss_x 1.1914 (1.1212) acc_x 68.7500 (73.1250) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [10/20] time 0.524 (0.458) data 0.393 (0.327) loss_x loss_x 1.4707 (1.1810) acc_x 68.7500 (70.9375) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/20] time 0.504 (0.459) data 0.373 (0.328) loss_x loss_x 0.8267 (1.1783) acc_x 81.2500 (71.8750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/20] time 0.458 (0.451) data 0.328 (0.320) loss_x loss_x 1.6396 (1.1862) acc_x 56.2500 (71.0938) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1924
confident_label rate tensor(0.2012, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 631
clean true:391
clean false:240
clean_rate:0.6196513470681458
noisy true:821
noisy false:1684
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 2505
epoch [173/200] batch [5/19] time 0.378 (0.467) data 0.247 (0.336) loss_x loss_x 1.2041 (1.0952) acc_x 68.7500 (71.2500) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [10/19] time 0.402 (0.436) data 0.272 (0.305) loss_x loss_x 1.3379 (1.1685) acc_x 68.7500 (71.8750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/19] time 0.498 (0.438) data 0.367 (0.307) loss_x loss_x 1.0723 (1.2003) acc_x 75.0000 (70.8333) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1951
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:393
clean false:254
clean_rate:0.60741885625966
noisy true:792
noisy false:1697
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [174/200] batch [5/20] time 0.356 (0.459) data 0.225 (0.328) loss_x loss_x 1.1523 (1.1783) acc_x 75.0000 (71.2500) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/20] time 0.339 (0.451) data 0.208 (0.320) loss_x loss_x 1.3320 (1.1691) acc_x 75.0000 (72.1875) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/20] time 0.448 (0.438) data 0.317 (0.307) loss_x loss_x 0.7280 (1.1054) acc_x 75.0000 (71.4583) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/20] time 0.344 (0.437) data 0.214 (0.306) loss_x loss_x 1.2090 (1.1302) acc_x 62.5000 (70.3125) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1923
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:391
clean false:264
clean_rate:0.5969465648854961
noisy true:822
noisy false:1659
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [175/200] batch [5/20] time 0.451 (0.475) data 0.320 (0.344) loss_x loss_x 1.7510 (1.4105) acc_x 50.0000 (64.3750) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [10/20] time 0.381 (0.471) data 0.250 (0.340) loss_x loss_x 0.9946 (1.2569) acc_x 71.8750 (69.0625) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/20] time 0.414 (0.459) data 0.283 (0.328) loss_x loss_x 0.7485 (1.2576) acc_x 78.1250 (67.0833) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/20] time 0.363 (0.444) data 0.232 (0.313) loss_x loss_x 1.6934 (1.2578) acc_x 62.5000 (67.6562) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1982
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:370
clean false:275
clean_rate:0.5736434108527132
noisy true:784
noisy false:1707
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [176/200] batch [5/20] time 0.495 (0.506) data 0.365 (0.376) loss_x loss_x 0.9780 (1.0263) acc_x 71.8750 (70.0000) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [10/20] time 0.482 (0.483) data 0.351 (0.352) loss_x loss_x 1.9229 (1.1160) acc_x 59.3750 (70.6250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/20] time 0.376 (0.453) data 0.246 (0.322) loss_x loss_x 1.5645 (1.1374) acc_x 59.3750 (71.2500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/20] time 0.408 (0.454) data 0.277 (0.323) loss_x loss_x 1.2080 (1.1644) acc_x 75.0000 (71.8750) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1921
confident_label rate tensor(0.2130, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 668
clean true:405
clean false:263
clean_rate:0.6062874251497006
noisy true:810
noisy false:1658
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 2468
epoch [177/200] batch [5/20] time 0.417 (0.436) data 0.286 (0.304) loss_x loss_x 1.0391 (1.1545) acc_x 62.5000 (70.0000) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [10/20] time 0.617 (0.442) data 0.487 (0.312) loss_x loss_x 1.3291 (1.0633) acc_x 78.1250 (73.1250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/20] time 0.487 (0.451) data 0.357 (0.320) loss_x loss_x 1.0674 (1.1252) acc_x 71.8750 (72.0833) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/20] time 0.463 (0.460) data 0.333 (0.329) loss_x loss_x 1.1445 (1.1375) acc_x 75.0000 (71.4062) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1888
confident_label rate tensor(0.2101, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 659
clean true:397
clean false:262
clean_rate:0.6024279210925645
noisy true:851
noisy false:1626
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 2477
epoch [178/200] batch [5/20] time 0.616 (0.476) data 0.486 (0.345) loss_x loss_x 0.7886 (1.0389) acc_x 84.3750 (74.3750) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/20] time 0.351 (0.448) data 0.220 (0.316) loss_x loss_x 1.1230 (1.0533) acc_x 68.7500 (73.4375) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/20] time 0.349 (0.454) data 0.218 (0.323) loss_x loss_x 1.0850 (1.0534) acc_x 71.8750 (73.3333) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/20] time 0.487 (0.466) data 0.357 (0.335) loss_x loss_x 1.4727 (1.0990) acc_x 46.8750 (71.7188) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1904
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 663
clean true:403
clean false:260
clean_rate:0.6078431372549019
noisy true:829
noisy false:1644
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 2473
epoch [179/200] batch [5/20] time 0.460 (0.453) data 0.329 (0.322) loss_x loss_x 1.0391 (1.2566) acc_x 71.8750 (69.3750) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [10/20] time 0.634 (0.495) data 0.503 (0.364) loss_x loss_x 1.5508 (1.1891) acc_x 62.5000 (71.5625) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/20] time 0.399 (0.472) data 0.269 (0.341) loss_x loss_x 1.1680 (1.1611) acc_x 62.5000 (71.2500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/20] time 0.385 (0.458) data 0.255 (0.327) loss_x loss_x 0.9668 (1.1437) acc_x 75.0000 (71.7188) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1913
confident_label rate tensor(0.2012, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 631
clean true:391
clean false:240
clean_rate:0.6196513470681458
noisy true:832
noisy false:1673
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 2505
epoch [180/200] batch [5/19] time 0.489 (0.460) data 0.358 (0.329) loss_x loss_x 1.1777 (1.1048) acc_x 68.7500 (77.5000) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/19] time 0.518 (0.440) data 0.387 (0.310) loss_x loss_x 1.5459 (1.1719) acc_x 62.5000 (73.7500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/19] time 0.533 (0.470) data 0.402 (0.339) loss_x loss_x 0.7441 (1.1822) acc_x 81.2500 (71.4583) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1939
confident_label rate tensor(0.2085, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 654
clean true:394
clean false:260
clean_rate:0.6024464831804281
noisy true:803
noisy false:1679
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 2482
epoch [181/200] batch [5/20] time 0.617 (0.493) data 0.486 (0.362) loss_x loss_x 0.8037 (1.2668) acc_x 84.3750 (71.8750) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [10/20] time 0.485 (0.490) data 0.355 (0.359) loss_x loss_x 1.0947 (1.2212) acc_x 75.0000 (71.5625) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/20] time 0.415 (0.469) data 0.284 (0.338) loss_x loss_x 1.2617 (1.1894) acc_x 75.0000 (72.2917) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/20] time 0.388 (0.460) data 0.257 (0.329) loss_x loss_x 1.1387 (1.1877) acc_x 78.1250 (71.2500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1925
confident_label rate tensor(0.2082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 653
clean true:391
clean false:262
clean_rate:0.5987748851454824
noisy true:820
noisy false:1663
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 2483
epoch [182/200] batch [5/20] time 0.433 (0.444) data 0.303 (0.313) loss_x loss_x 0.8237 (0.9870) acc_x 78.1250 (75.6250) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [10/20] time 0.511 (0.446) data 0.380 (0.315) loss_x loss_x 0.7534 (1.0262) acc_x 75.0000 (74.0625) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/20] time 0.408 (0.449) data 0.276 (0.318) loss_x loss_x 0.9478 (1.0297) acc_x 75.0000 (73.5417) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/20] time 0.431 (0.464) data 0.300 (0.333) loss_x loss_x 1.3096 (1.0858) acc_x 65.6250 (72.9688) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1937
confident_label rate tensor(0.2111, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 662
clean true:384
clean false:278
clean_rate:0.5800604229607251
noisy true:815
noisy false:1659
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 2474
epoch [183/200] batch [5/20] time 0.383 (0.425) data 0.252 (0.294) loss_x loss_x 1.0771 (1.0448) acc_x 68.7500 (71.8750) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [10/20] time 0.494 (0.437) data 0.362 (0.307) loss_x loss_x 1.7930 (1.2289) acc_x 56.2500 (69.6875) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/20] time 0.388 (0.440) data 0.258 (0.309) loss_x loss_x 0.6777 (1.1622) acc_x 87.5000 (71.6667) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/20] time 0.503 (0.451) data 0.372 (0.320) loss_x loss_x 1.5166 (1.1746) acc_x 75.0000 (72.1875) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1959
confident_label rate tensor(0.2038, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 639
clean true:374
clean false:265
clean_rate:0.5852895148669797
noisy true:803
noisy false:1694
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 2497
epoch [184/200] batch [5/19] time 0.421 (0.450) data 0.289 (0.319) loss_x loss_x 0.9331 (1.0987) acc_x 75.0000 (71.8750) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [10/19] time 0.367 (0.431) data 0.235 (0.300) loss_x loss_x 1.2158 (1.0542) acc_x 68.7500 (72.8125) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/19] time 0.458 (0.461) data 0.326 (0.330) loss_x loss_x 1.8789 (1.1451) acc_x 56.2500 (71.2500) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1953
confident_label rate tensor(0.2018, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 633
clean true:375
clean false:258
clean_rate:0.5924170616113744
noisy true:808
noisy false:1695
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 2503
epoch [185/200] batch [5/19] time 0.412 (0.424) data 0.282 (0.293) loss_x loss_x 1.3262 (1.1090) acc_x 59.3750 (66.8750) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/19] time 0.453 (0.412) data 0.321 (0.281) loss_x loss_x 1.1406 (1.1610) acc_x 62.5000 (67.8125) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/19] time 0.486 (0.417) data 0.355 (0.285) loss_x loss_x 0.6782 (1.1825) acc_x 78.1250 (67.0833) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1906
confident_label rate tensor(0.2105, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 660
clean true:409
clean false:251
clean_rate:0.6196969696969697
noisy true:821
noisy false:1655
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 2476
epoch [186/200] batch [5/20] time 0.581 (0.465) data 0.450 (0.334) loss_x loss_x 1.4707 (1.1873) acc_x 65.6250 (71.2500) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [10/20] time 0.397 (0.445) data 0.264 (0.314) loss_x loss_x 1.0078 (1.2082) acc_x 71.8750 (68.7500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/20] time 0.387 (0.444) data 0.256 (0.312) loss_x loss_x 1.5127 (1.2160) acc_x 71.8750 (70.2083) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/20] time 0.490 (0.439) data 0.359 (0.308) loss_x loss_x 1.1299 (1.1806) acc_x 68.7500 (70.9375) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1887
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 684
clean true:402
clean false:282
clean_rate:0.5877192982456141
noisy true:847
noisy false:1605
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 2452
epoch [187/200] batch [5/21] time 0.558 (0.462) data 0.427 (0.331) loss_x loss_x 0.6685 (0.9883) acc_x 90.6250 (75.6250) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [10/21] time 0.359 (0.477) data 0.228 (0.347) loss_x loss_x 1.0449 (1.0542) acc_x 75.0000 (75.0000) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [15/21] time 0.364 (0.472) data 0.233 (0.341) loss_x loss_x 1.1992 (0.9984) acc_x 68.7500 (76.6667) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/21] time 0.381 (0.452) data 0.251 (0.322) loss_x loss_x 1.3955 (1.0933) acc_x 71.8750 (74.0625) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1957
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 643
clean true:388
clean false:255
clean_rate:0.6034214618973561
noisy true:791
noisy false:1702
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 2493
epoch [188/200] batch [5/20] time 0.472 (0.440) data 0.341 (0.309) loss_x loss_x 0.7964 (1.0222) acc_x 78.1250 (71.8750) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [10/20] time 0.442 (0.443) data 0.311 (0.313) loss_x loss_x 1.2930 (1.0473) acc_x 68.7500 (74.0625) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/20] time 0.352 (0.457) data 0.220 (0.326) loss_x loss_x 1.4287 (1.1424) acc_x 62.5000 (70.6250) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/20] time 0.638 (0.459) data 0.506 (0.328) loss_x loss_x 0.7725 (1.0942) acc_x 84.3750 (71.7188) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1943
confident_label rate tensor(0.2184, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 685
clean true:395
clean false:290
clean_rate:0.5766423357664233
noisy true:798
noisy false:1653
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 2451
epoch [189/200] batch [5/21] time 0.472 (0.475) data 0.341 (0.344) loss_x loss_x 1.2607 (1.1294) acc_x 68.7500 (72.5000) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [10/21] time 0.326 (0.452) data 0.195 (0.321) loss_x loss_x 1.0215 (1.1278) acc_x 65.6250 (71.2500) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/21] time 0.430 (0.437) data 0.299 (0.307) loss_x loss_x 1.2793 (1.2147) acc_x 62.5000 (68.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/21] time 0.524 (0.456) data 0.393 (0.325) loss_x loss_x 1.5752 (1.1864) acc_x 68.7500 (70.7812) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1919
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:386
clean false:269
clean_rate:0.5893129770992367
noisy true:831
noisy false:1650
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [190/200] batch [5/20] time 0.403 (0.424) data 0.272 (0.293) loss_x loss_x 1.4189 (1.2902) acc_x 62.5000 (68.7500) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/20] time 0.491 (0.478) data 0.360 (0.347) loss_x loss_x 0.6909 (1.1402) acc_x 78.1250 (71.2500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/20] time 0.421 (0.461) data 0.290 (0.330) loss_x loss_x 1.1660 (1.1523) acc_x 71.8750 (71.4583) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/20] time 0.531 (0.459) data 0.400 (0.328) loss_x loss_x 1.1055 (1.1525) acc_x 68.7500 (70.7812) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1903
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 663
clean true:392
clean false:271
clean_rate:0.5912518853695324
noisy true:841
noisy false:1632
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 2473
epoch [191/200] batch [5/20] time 0.378 (0.429) data 0.246 (0.298) loss_x loss_x 1.9424 (1.4528) acc_x 65.6250 (65.6250) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [10/20] time 0.489 (0.462) data 0.358 (0.331) loss_x loss_x 1.0059 (1.2521) acc_x 65.6250 (68.4375) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/20] time 0.488 (0.452) data 0.357 (0.321) loss_x loss_x 1.0820 (1.2305) acc_x 71.8750 (69.1667) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/20] time 0.415 (0.439) data 0.284 (0.309) loss_x loss_x 1.0625 (1.1712) acc_x 78.1250 (71.4062) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1935
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:379
clean false:256
clean_rate:0.5968503937007874
noisy true:822
noisy false:1679
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [192/200] batch [5/19] time 0.485 (0.438) data 0.353 (0.307) loss_x loss_x 1.2402 (1.1614) acc_x 75.0000 (70.0000) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [10/19] time 0.546 (0.463) data 0.415 (0.332) loss_x loss_x 1.1123 (1.1202) acc_x 78.1250 (70.9375) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/19] time 0.453 (0.457) data 0.322 (0.326) loss_x loss_x 0.6147 (1.1257) acc_x 81.2500 (70.8333) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1966
confident_label rate tensor(0.2063, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 647
clean true:375
clean false:272
clean_rate:0.5795981452859351
noisy true:795
noisy false:1694
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 2489
epoch [193/200] batch [5/20] time 0.558 (0.496) data 0.427 (0.364) loss_x loss_x 1.0938 (1.1967) acc_x 78.1250 (73.7500) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [10/20] time 0.513 (0.480) data 0.383 (0.349) loss_x loss_x 1.4033 (1.1582) acc_x 65.6250 (71.2500) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/20] time 0.548 (0.470) data 0.417 (0.339) loss_x loss_x 1.1299 (1.1282) acc_x 65.6250 (72.0833) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/20] time 0.539 (0.465) data 0.409 (0.334) loss_x loss_x 1.1777 (1.1662) acc_x 75.0000 (72.0312) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1946
confident_label rate tensor(0.2095, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 657
clean true:390
clean false:267
clean_rate:0.593607305936073
noisy true:800
noisy false:1679
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 2479
epoch [194/200] batch [5/20] time 0.449 (0.439) data 0.318 (0.309) loss_x loss_x 1.1855 (1.2082) acc_x 71.8750 (73.1250) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [10/20] time 0.372 (0.435) data 0.241 (0.304) loss_x loss_x 0.7637 (1.1850) acc_x 84.3750 (72.1875) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/20] time 0.473 (0.441) data 0.342 (0.310) loss_x loss_x 0.7954 (1.1720) acc_x 78.1250 (71.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/20] time 0.499 (0.439) data 0.369 (0.308) loss_x loss_x 1.1475 (1.1910) acc_x 81.2500 (71.2500) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1922
confident_label rate tensor(0.2127, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 667
clean true:395
clean false:272
clean_rate:0.5922038980509745
noisy true:819
noisy false:1650
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 2469
epoch [195/200] batch [5/20] time 0.478 (0.432) data 0.347 (0.300) loss_x loss_x 1.1943 (1.2678) acc_x 62.5000 (66.8750) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [10/20] time 0.693 (0.493) data 0.562 (0.362) loss_x loss_x 0.9297 (1.2433) acc_x 71.8750 (68.4375) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/20] time 0.376 (0.468) data 0.244 (0.337) loss_x loss_x 1.0498 (1.2459) acc_x 71.8750 (68.5417) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/20] time 0.497 (0.465) data 0.367 (0.334) loss_x loss_x 1.2100 (1.2137) acc_x 65.6250 (68.5938) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1935
confident_label rate tensor(0.2060, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 646
clean true:380
clean false:266
clean_rate:0.5882352941176471
noisy true:821
noisy false:1669
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 2490
epoch [196/200] batch [5/20] time 0.615 (0.463) data 0.484 (0.332) loss_x loss_x 0.8569 (0.9673) acc_x 81.2500 (76.2500) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [10/20] time 0.470 (0.439) data 0.339 (0.308) loss_x loss_x 1.2363 (1.0916) acc_x 75.0000 (74.6875) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/20] time 0.485 (0.439) data 0.353 (0.307) loss_x loss_x 1.3096 (1.1293) acc_x 53.1250 (71.6667) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/20] time 0.353 (0.425) data 0.221 (0.294) loss_x loss_x 1.3750 (1.1983) acc_x 65.6250 (70.0000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1918
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 663
clean true:403
clean false:260
clean_rate:0.6078431372549019
noisy true:815
noisy false:1658
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 2473
epoch [197/200] batch [5/20] time 0.489 (0.439) data 0.358 (0.308) loss_x loss_x 1.2549 (1.0955) acc_x 68.7500 (72.5000) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [10/20] time 0.341 (0.431) data 0.211 (0.300) loss_x loss_x 1.0879 (1.0280) acc_x 71.8750 (74.3750) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/20] time 0.492 (0.453) data 0.360 (0.322) loss_x loss_x 0.9673 (1.0682) acc_x 75.0000 (73.1250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/20] time 0.463 (0.455) data 0.333 (0.324) loss_x loss_x 1.8867 (1.1441) acc_x 59.3750 (72.0312) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1950
confident_label rate tensor(0.2057, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 645
clean true:382
clean false:263
clean_rate:0.5922480620155038
noisy true:804
noisy false:1687
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 2491
epoch [198/200] batch [5/20] time 0.446 (0.419) data 0.315 (0.287) loss_x loss_x 0.6846 (0.9769) acc_x 90.6250 (77.5000) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [10/20] time 0.342 (0.434) data 0.211 (0.303) loss_x loss_x 0.9346 (1.0613) acc_x 75.0000 (74.3750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/20] time 0.450 (0.447) data 0.319 (0.316) loss_x loss_x 1.6787 (1.1020) acc_x 59.3750 (71.8750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/20] time 0.433 (0.455) data 0.303 (0.324) loss_x loss_x 1.3057 (1.1111) acc_x 62.5000 (70.9375) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1951
confident_label rate tensor(0.2050, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 643
clean true:390
clean false:253
clean_rate:0.6065318818040435
noisy true:795
noisy false:1698
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 2493
epoch [199/200] batch [5/20] time 0.391 (0.453) data 0.261 (0.322) loss_x loss_x 1.1738 (1.2604) acc_x 65.6250 (69.3750) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/20] time 0.452 (0.436) data 0.320 (0.305) loss_x loss_x 0.9404 (1.2321) acc_x 78.1250 (69.6875) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/20] time 0.472 (0.448) data 0.341 (0.317) loss_x loss_x 0.8623 (1.2086) acc_x 84.3750 (70.8333) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/20] time 0.394 (0.449) data 0.264 (0.318) loss_x loss_x 1.2334 (1.1981) acc_x 65.6250 (70.7812) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1940
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:385
clean false:250
clean_rate:0.6062992125984252
noisy true:811
noisy false:1690
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [200/200] batch [5/19] time 0.565 (0.529) data 0.434 (0.398) loss_x loss_x 1.2402 (1.1119) acc_x 68.7500 (70.6250) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [10/19] time 0.429 (0.507) data 0.299 (0.376) loss_x loss_x 1.2559 (1.2010) acc_x 75.0000 (70.0000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/19] time 0.347 (0.461) data 0.216 (0.330) loss_x loss_x 1.1240 (1.1396) acc_x 75.0000 (71.0417) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 3,821
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 45.5%
Elapsed: 2:54:48
