***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.25/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 430
clean true:429
clean false:1
clean_rate:0.9976744186046511
noisy true:136
noisy false:2570
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 2706
epoch [1/200] batch [5/13] time 0.440 (0.539) data 0.311 (0.388) loss_x loss_x 2.8848 (2.9379) acc_x 50.0000 (39.3750) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [10/13] time 0.353 (0.501) data 0.223 (0.361) loss_x loss_x 2.5000 (2.7627) acc_x 50.0000 (45.3125) lr 1.0000e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2362
confident_label rate tensor(0.1869, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 586
clean true:580
clean false:6
clean_rate:0.9897610921501706
noisy true:194
noisy false:2356
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 2550
epoch [2/200] batch [5/18] time 0.401 (0.465) data 0.271 (0.333) loss_x loss_x 2.0371 (1.9459) acc_x 56.2500 (57.5000) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [10/18] time 0.606 (0.488) data 0.476 (0.356) loss_x loss_x 1.5029 (1.8691) acc_x 65.6250 (56.2500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [15/18] time 0.544 (0.499) data 0.413 (0.367) loss_x loss_x 1.5088 (1.8472) acc_x 68.7500 (55.4167) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1976
confident_label rate tensor(0.2848, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 893
clean true:890
clean false:3
clean_rate:0.9966405375139977
noisy true:270
noisy false:1973
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 2243
epoch [3/200] batch [5/27] time 0.499 (0.538) data 0.368 (0.407) loss_x loss_x 1.8643 (1.8547) acc_x 56.2500 (53.7500) lr 1.9999e-03 eta 0:00:11
epoch [3/200] batch [10/27] time 0.400 (0.503) data 0.269 (0.372) loss_x loss_x 1.7920 (1.8188) acc_x 53.1250 (54.0625) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [15/27] time 0.445 (0.484) data 0.314 (0.353) loss_x loss_x 1.2305 (1.7666) acc_x 65.6250 (54.5833) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [20/27] time 0.425 (0.477) data 0.295 (0.346) loss_x loss_x 1.9277 (1.7520) acc_x 68.7500 (55.7812) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/27] time 0.363 (0.473) data 0.232 (0.342) loss_x loss_x 1.8223 (1.7195) acc_x 43.7500 (56.1250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1907
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 939
clean true:935
clean false:4
clean_rate:0.9957401490947817
noisy true:294
noisy false:1903
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 2197
epoch [4/200] batch [5/29] time 0.494 (0.557) data 0.361 (0.425) loss_x loss_x 2.0723 (1.7631) acc_x 53.1250 (56.2500) lr 1.9995e-03 eta 0:00:13
epoch [4/200] batch [10/29] time 0.604 (0.564) data 0.471 (0.432) loss_x loss_x 2.1465 (1.6813) acc_x 37.5000 (56.2500) lr 1.9995e-03 eta 0:00:10
epoch [4/200] batch [15/29] time 0.423 (0.532) data 0.293 (0.400) loss_x loss_x 1.5430 (1.6681) acc_x 56.2500 (57.0833) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [20/29] time 0.413 (0.516) data 0.282 (0.384) loss_x loss_x 1.3545 (1.7111) acc_x 56.2500 (56.0938) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [25/29] time 0.506 (0.507) data 0.376 (0.376) loss_x loss_x 1.6396 (1.7068) acc_x 59.3750 (55.8750) lr 1.9995e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1890
confident_label rate tensor(0.3058, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 959
clean true:959
clean false:0
clean_rate:1.0
noisy true:287
noisy false:1890
after delete: len(clean_dataset) 959
after delete: len(noisy_dataset) 2177
epoch [5/200] batch [5/29] time 0.542 (0.472) data 0.411 (0.342) loss_x loss_x 1.8779 (1.5379) acc_x 46.8750 (61.8750) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [10/29] time 0.474 (0.461) data 0.343 (0.331) loss_x loss_x 1.7832 (1.6157) acc_x 59.3750 (61.8750) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [15/29] time 0.443 (0.466) data 0.313 (0.336) loss_x loss_x 1.2627 (1.5992) acc_x 65.6250 (61.2500) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [20/29] time 0.367 (0.465) data 0.236 (0.334) loss_x loss_x 1.5693 (1.5530) acc_x 46.8750 (61.5625) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [25/29] time 0.445 (0.468) data 0.314 (0.338) loss_x loss_x 1.6768 (1.5497) acc_x 62.5000 (60.0000) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1881
confident_label rate tensor(0.2997, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 940
clean true:937
clean false:3
clean_rate:0.9968085106382979
noisy true:318
noisy false:1878
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 2196
epoch [6/200] batch [5/29] time 0.369 (0.495) data 0.238 (0.363) loss_x loss_x 1.9756 (1.5926) acc_x 53.1250 (55.6250) lr 1.9980e-03 eta 0:00:11
epoch [6/200] batch [10/29] time 0.422 (0.493) data 0.292 (0.363) loss_x loss_x 1.5469 (1.4462) acc_x 53.1250 (59.0625) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [15/29] time 0.562 (0.488) data 0.432 (0.358) loss_x loss_x 1.5518 (1.4285) acc_x 56.2500 (59.1667) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [20/29] time 0.428 (0.487) data 0.298 (0.357) loss_x loss_x 1.3486 (1.4739) acc_x 62.5000 (58.9062) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [25/29] time 0.407 (0.479) data 0.277 (0.349) loss_x loss_x 1.6250 (1.4792) acc_x 59.3750 (59.3750) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1925
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 921
clean true:917
clean false:4
clean_rate:0.995656894679696
noisy true:294
noisy false:1921
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 2215
epoch [7/200] batch [5/28] time 0.460 (0.498) data 0.330 (0.367) loss_x loss_x 1.6953 (1.3866) acc_x 62.5000 (58.1250) lr 1.9969e-03 eta 0:00:11
epoch [7/200] batch [10/28] time 0.453 (0.469) data 0.322 (0.338) loss_x loss_x 1.0146 (1.4209) acc_x 71.8750 (57.8125) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [15/28] time 0.429 (0.490) data 0.298 (0.359) loss_x loss_x 1.4795 (1.4808) acc_x 59.3750 (59.1667) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [20/28] time 0.559 (0.492) data 0.428 (0.361) loss_x loss_x 1.8145 (1.5522) acc_x 56.2500 (57.1875) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/28] time 0.372 (0.487) data 0.241 (0.356) loss_x loss_x 1.6816 (1.5437) acc_x 62.5000 (58.5000) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1807
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1007
clean true:1004
clean false:3
clean_rate:0.997020854021847
noisy true:325
noisy false:1804
after delete: len(clean_dataset) 1007
after delete: len(noisy_dataset) 2129
epoch [8/200] batch [5/31] time 0.490 (0.449) data 0.359 (0.318) loss_x loss_x 1.5186 (1.5598) acc_x 65.6250 (58.1250) lr 1.9956e-03 eta 0:00:11
epoch [8/200] batch [10/31] time 0.484 (0.443) data 0.353 (0.312) loss_x loss_x 1.5420 (1.5268) acc_x 68.7500 (60.9375) lr 1.9956e-03 eta 0:00:09
epoch [8/200] batch [15/31] time 0.482 (0.447) data 0.352 (0.317) loss_x loss_x 1.2988 (1.4888) acc_x 68.7500 (62.2917) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [20/31] time 0.401 (0.449) data 0.271 (0.318) loss_x loss_x 1.9473 (1.5187) acc_x 56.2500 (60.1562) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [25/31] time 0.435 (0.447) data 0.304 (0.317) loss_x loss_x 1.3643 (1.5240) acc_x 56.2500 (60.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/31] time 0.405 (0.450) data 0.274 (0.320) loss_x loss_x 1.0850 (1.5106) acc_x 71.8750 (61.0417) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1844
confident_label rate tensor(0.3182, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 998
clean true:995
clean false:3
clean_rate:0.996993987975952
noisy true:297
noisy false:1841
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 2138
epoch [9/200] batch [5/31] time 0.377 (0.486) data 0.247 (0.355) loss_x loss_x 1.8291 (1.6842) acc_x 56.2500 (57.5000) lr 1.9940e-03 eta 0:00:12
epoch [9/200] batch [10/31] time 0.463 (0.457) data 0.332 (0.326) loss_x loss_x 1.4189 (1.5184) acc_x 65.6250 (63.1250) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [15/31] time 0.451 (0.463) data 0.321 (0.332) loss_x loss_x 0.8989 (1.5070) acc_x 71.8750 (61.8750) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [20/31] time 0.536 (0.470) data 0.406 (0.340) loss_x loss_x 1.6621 (1.5697) acc_x 53.1250 (60.1562) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [25/31] time 0.456 (0.473) data 0.325 (0.343) loss_x loss_x 1.6777 (1.6029) acc_x 62.5000 (59.5000) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [30/31] time 0.714 (0.477) data 0.583 (0.347) loss_x loss_x 0.9336 (1.5547) acc_x 71.8750 (59.8958) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1816
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1013
clean true:1010
clean false:3
clean_rate:0.9970384995064165
noisy true:310
noisy false:1813
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 2123
epoch [10/200] batch [5/31] time 0.519 (0.463) data 0.387 (0.332) loss_x loss_x 1.9033 (1.7035) acc_x 50.0000 (53.7500) lr 1.9921e-03 eta 0:00:12
epoch [10/200] batch [10/31] time 0.483 (0.475) data 0.353 (0.344) loss_x loss_x 1.5771 (1.6027) acc_x 68.7500 (58.4375) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [15/31] time 0.730 (0.480) data 0.600 (0.349) loss_x loss_x 1.7070 (1.6683) acc_x 65.6250 (58.1250) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [20/31] time 0.381 (0.483) data 0.251 (0.352) loss_x loss_x 2.4277 (1.6649) acc_x 59.3750 (58.5938) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [25/31] time 0.430 (0.481) data 0.299 (0.351) loss_x loss_x 0.9033 (1.5842) acc_x 84.3750 (60.2500) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [30/31] time 0.512 (0.480) data 0.383 (0.350) loss_x loss_x 1.0273 (1.5558) acc_x 75.0000 (60.8333) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1846
confident_label rate tensor(0.3214, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1008
clean true:1004
clean false:4
clean_rate:0.996031746031746
noisy true:286
noisy false:1842
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 2128
epoch [11/200] batch [5/31] time 0.391 (0.447) data 0.260 (0.315) loss_x loss_x 1.6436 (1.4461) acc_x 65.6250 (61.2500) lr 1.9900e-03 eta 0:00:11
epoch [11/200] batch [10/31] time 0.486 (0.460) data 0.356 (0.329) loss_x loss_x 1.3438 (1.4491) acc_x 53.1250 (58.4375) lr 1.9900e-03 eta 0:00:09
epoch [11/200] batch [15/31] time 0.478 (0.468) data 0.347 (0.337) loss_x loss_x 1.5439 (1.4386) acc_x 68.7500 (60.2083) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [20/31] time 0.508 (0.469) data 0.377 (0.338) loss_x loss_x 1.9365 (1.4626) acc_x 34.3750 (58.9062) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [25/31] time 0.431 (0.465) data 0.300 (0.334) loss_x loss_x 1.3691 (1.4863) acc_x 62.5000 (58.8750) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [30/31] time 0.414 (0.465) data 0.283 (0.334) loss_x loss_x 1.5059 (1.4742) acc_x 56.2500 (59.0625) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1808
confident_label rate tensor(0.3173, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 995
clean true:995
clean false:0
clean_rate:1.0
noisy true:333
noisy false:1808
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 2141
epoch [12/200] batch [5/31] time 0.388 (0.433) data 0.257 (0.302) loss_x loss_x 1.3623 (1.3699) acc_x 50.0000 (60.6250) lr 1.9877e-03 eta 0:00:11
epoch [12/200] batch [10/31] time 0.446 (0.463) data 0.316 (0.332) loss_x loss_x 1.7617 (1.5044) acc_x 56.2500 (60.0000) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [15/31] time 0.727 (0.488) data 0.597 (0.358) loss_x loss_x 1.1650 (1.4715) acc_x 65.6250 (61.4583) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [20/31] time 0.474 (0.481) data 0.343 (0.350) loss_x loss_x 1.4287 (1.4749) acc_x 53.1250 (61.2500) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [25/31] time 0.416 (0.474) data 0.285 (0.343) loss_x loss_x 1.5166 (1.4934) acc_x 53.1250 (60.3750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [30/31] time 0.416 (0.469) data 0.285 (0.339) loss_x loss_x 0.9951 (1.4977) acc_x 68.7500 (61.0417) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1798
confident_label rate tensor(0.3240, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1016
clean true:1015
clean false:1
clean_rate:0.9990157480314961
noisy true:323
noisy false:1797
after delete: len(clean_dataset) 1016
after delete: len(noisy_dataset) 2120
epoch [13/200] batch [5/31] time 0.554 (0.482) data 0.423 (0.351) loss_x loss_x 1.6943 (1.5635) acc_x 65.6250 (58.7500) lr 1.9851e-03 eta 0:00:12
epoch [13/200] batch [10/31] time 0.519 (0.476) data 0.389 (0.345) loss_x loss_x 1.7607 (1.5894) acc_x 53.1250 (56.5625) lr 1.9851e-03 eta 0:00:10
epoch [13/200] batch [15/31] time 0.497 (0.467) data 0.367 (0.336) loss_x loss_x 1.4814 (1.5425) acc_x 65.6250 (59.1667) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [20/31] time 0.457 (0.459) data 0.327 (0.328) loss_x loss_x 1.3965 (1.5584) acc_x 71.8750 (59.0625) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [25/31] time 0.477 (0.458) data 0.347 (0.328) loss_x loss_x 1.3906 (1.5207) acc_x 75.0000 (60.1250) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [30/31] time 0.487 (0.457) data 0.356 (0.327) loss_x loss_x 1.4297 (1.4859) acc_x 68.7500 (61.0417) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.3291, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1032
clean true:1027
clean false:5
clean_rate:0.9951550387596899
noisy true:325
noisy false:1779
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 2104
epoch [14/200] batch [5/32] time 0.384 (0.442) data 0.253 (0.311) loss_x loss_x 1.9297 (1.5152) acc_x 62.5000 (60.0000) lr 1.9823e-03 eta 0:00:11
epoch [14/200] batch [10/32] time 0.478 (0.484) data 0.347 (0.354) loss_x loss_x 1.6484 (1.5837) acc_x 59.3750 (58.4375) lr 1.9823e-03 eta 0:00:10
epoch [14/200] batch [15/32] time 0.439 (0.489) data 0.309 (0.358) loss_x loss_x 1.4961 (1.5177) acc_x 65.6250 (60.4167) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [20/32] time 0.495 (0.484) data 0.365 (0.353) loss_x loss_x 1.2285 (1.5037) acc_x 68.7500 (60.3125) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [25/32] time 0.448 (0.480) data 0.318 (0.349) loss_x loss_x 1.0527 (1.4699) acc_x 71.8750 (61.1250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [30/32] time 0.421 (0.480) data 0.291 (0.349) loss_x loss_x 1.7363 (1.4704) acc_x 46.8750 (61.2500) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.3233, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1014
clean true:1012
clean false:2
clean_rate:0.9980276134122288
noisy true:309
noisy false:1813
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 2122
epoch [15/200] batch [5/31] time 0.455 (0.479) data 0.325 (0.349) loss_x loss_x 1.1621 (1.2512) acc_x 65.6250 (63.7500) lr 1.9792e-03 eta 0:00:12
epoch [15/200] batch [10/31] time 0.372 (0.461) data 0.242 (0.331) loss_x loss_x 2.3281 (1.5469) acc_x 53.1250 (59.0625) lr 1.9792e-03 eta 0:00:09
epoch [15/200] batch [15/31] time 0.399 (0.463) data 0.268 (0.333) loss_x loss_x 1.2461 (1.4129) acc_x 59.3750 (62.2917) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [20/31] time 0.493 (0.462) data 0.362 (0.332) loss_x loss_x 1.2061 (1.4503) acc_x 68.7500 (62.3438) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [25/31] time 0.612 (0.467) data 0.481 (0.336) loss_x loss_x 1.0713 (1.4729) acc_x 75.0000 (62.6250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [30/31] time 0.503 (0.471) data 0.373 (0.341) loss_x loss_x 1.2988 (1.4813) acc_x 59.3750 (61.9792) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.3265, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1024
clean true:1024
clean false:0
clean_rate:1.0
noisy true:326
noisy false:1786
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 2112
epoch [16/200] batch [5/32] time 0.528 (0.510) data 0.398 (0.380) loss_x loss_x 1.5811 (1.4508) acc_x 56.2500 (59.3750) lr 1.9759e-03 eta 0:00:13
epoch [16/200] batch [10/32] time 0.397 (0.488) data 0.267 (0.358) loss_x loss_x 1.4736 (1.4590) acc_x 65.6250 (61.8750) lr 1.9759e-03 eta 0:00:10
epoch [16/200] batch [15/32] time 0.388 (0.467) data 0.257 (0.337) loss_x loss_x 1.3994 (1.3968) acc_x 75.0000 (63.9583) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [20/32] time 0.460 (0.465) data 0.330 (0.335) loss_x loss_x 1.6982 (1.4564) acc_x 56.2500 (62.5000) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [25/32] time 0.490 (0.469) data 0.360 (0.338) loss_x loss_x 1.7422 (1.5194) acc_x 46.8750 (59.7500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [30/32] time 0.362 (0.467) data 0.231 (0.337) loss_x loss_x 1.6338 (1.4999) acc_x 56.2500 (60.3125) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1780
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1044
clean true:1040
clean false:4
clean_rate:0.9961685823754789
noisy true:316
noisy false:1776
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 2092
epoch [17/200] batch [5/32] time 0.478 (0.415) data 0.348 (0.285) loss_x loss_x 1.4814 (1.5299) acc_x 56.2500 (61.2500) lr 1.9724e-03 eta 0:00:11
epoch [17/200] batch [10/32] time 0.427 (0.428) data 0.297 (0.297) loss_x loss_x 1.4199 (1.5766) acc_x 59.3750 (61.2500) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [15/32] time 0.443 (0.440) data 0.313 (0.310) loss_x loss_x 1.4707 (1.6038) acc_x 68.7500 (61.0417) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [20/32] time 0.650 (0.448) data 0.520 (0.317) loss_x loss_x 1.4746 (1.5470) acc_x 53.1250 (60.4688) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [25/32] time 0.560 (0.461) data 0.430 (0.330) loss_x loss_x 1.2529 (1.5177) acc_x 62.5000 (61.1250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [30/32] time 0.561 (0.469) data 0.431 (0.339) loss_x loss_x 1.7236 (1.5308) acc_x 50.0000 (60.9375) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1825
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1017
clean true:1015
clean false:2
clean_rate:0.9980334316617503
noisy true:296
noisy false:1823
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 2119
epoch [18/200] batch [5/31] time 0.428 (0.445) data 0.298 (0.315) loss_x loss_x 1.8691 (1.6568) acc_x 43.7500 (55.0000) lr 1.9686e-03 eta 0:00:11
epoch [18/200] batch [10/31] time 0.367 (0.439) data 0.236 (0.309) loss_x loss_x 1.3418 (1.5179) acc_x 62.5000 (59.0625) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [15/31] time 0.560 (0.443) data 0.430 (0.313) loss_x loss_x 1.3066 (1.5796) acc_x 65.6250 (59.1667) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [20/31] time 0.516 (0.452) data 0.386 (0.321) loss_x loss_x 1.8213 (1.5613) acc_x 59.3750 (60.0000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [25/31] time 0.557 (0.460) data 0.427 (0.330) loss_x loss_x 1.3838 (1.5397) acc_x 68.7500 (60.1250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/31] time 0.510 (0.460) data 0.380 (0.330) loss_x loss_x 1.2490 (1.5006) acc_x 68.7500 (61.2500) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.3281, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1029
clean true:1024
clean false:5
clean_rate:0.9951409135082604
noisy true:294
noisy false:1813
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 2107
epoch [19/200] batch [5/32] time 0.419 (0.470) data 0.288 (0.339) loss_x loss_x 1.6455 (1.3625) acc_x 56.2500 (68.7500) lr 1.9646e-03 eta 0:00:12
epoch [19/200] batch [10/32] time 0.411 (0.447) data 0.281 (0.317) loss_x loss_x 1.7188 (1.3677) acc_x 56.2500 (64.0625) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [15/32] time 0.500 (0.452) data 0.370 (0.322) loss_x loss_x 1.5566 (1.4630) acc_x 50.0000 (61.4583) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [20/32] time 0.457 (0.452) data 0.326 (0.322) loss_x loss_x 1.1748 (1.4925) acc_x 71.8750 (61.0938) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [25/32] time 0.401 (0.457) data 0.270 (0.327) loss_x loss_x 1.2471 (1.4825) acc_x 75.0000 (62.5000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [30/32] time 0.406 (0.465) data 0.275 (0.335) loss_x loss_x 1.5938 (1.4637) acc_x 56.2500 (62.8125) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.3361, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1054
clean true:1053
clean false:1
clean_rate:0.9990512333965844
noisy true:327
noisy false:1755
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 2082
epoch [20/200] batch [5/32] time 0.375 (0.454) data 0.244 (0.323) loss_x loss_x 1.2021 (1.2941) acc_x 75.0000 (67.5000) lr 1.9603e-03 eta 0:00:12
epoch [20/200] batch [10/32] time 0.476 (0.457) data 0.346 (0.327) loss_x loss_x 1.5352 (1.3104) acc_x 50.0000 (65.0000) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [15/32] time 0.404 (0.460) data 0.274 (0.330) loss_x loss_x 1.8223 (1.3739) acc_x 56.2500 (65.0000) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [20/32] time 0.414 (0.458) data 0.284 (0.328) loss_x loss_x 1.2910 (1.4002) acc_x 65.6250 (64.0625) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [25/32] time 0.521 (0.453) data 0.390 (0.322) loss_x loss_x 1.3701 (1.4462) acc_x 65.6250 (63.1250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [30/32] time 0.376 (0.450) data 0.245 (0.320) loss_x loss_x 1.4131 (1.4180) acc_x 56.2500 (63.1250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1812
confident_label rate tensor(0.3291, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1032
clean true:1029
clean false:3
clean_rate:0.997093023255814
noisy true:295
noisy false:1809
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 2104
epoch [21/200] batch [5/32] time 0.564 (0.519) data 0.434 (0.388) loss_x loss_x 1.1426 (1.4711) acc_x 68.7500 (60.6250) lr 1.9558e-03 eta 0:00:14
epoch [21/200] batch [10/32] time 0.481 (0.492) data 0.351 (0.362) loss_x loss_x 1.4424 (1.4351) acc_x 65.6250 (62.1875) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [15/32] time 0.456 (0.490) data 0.326 (0.359) loss_x loss_x 1.7578 (1.4330) acc_x 56.2500 (62.9167) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [20/32] time 0.613 (0.489) data 0.483 (0.358) loss_x loss_x 1.6611 (1.4827) acc_x 46.8750 (61.0938) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [25/32] time 0.550 (0.491) data 0.419 (0.360) loss_x loss_x 1.1787 (1.4353) acc_x 68.7500 (62.1250) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [30/32] time 0.464 (0.489) data 0.333 (0.358) loss_x loss_x 1.3311 (1.4539) acc_x 65.6250 (61.4583) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1814
confident_label rate tensor(0.3240, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1016
clean true:1014
clean false:2
clean_rate:0.9980314960629921
noisy true:308
noisy false:1812
after delete: len(clean_dataset) 1016
after delete: len(noisy_dataset) 2120
epoch [22/200] batch [5/31] time 0.455 (0.449) data 0.324 (0.319) loss_x loss_x 1.2480 (1.3840) acc_x 71.8750 (65.6250) lr 1.9511e-03 eta 0:00:11
epoch [22/200] batch [10/31] time 0.415 (0.434) data 0.285 (0.303) loss_x loss_x 1.7070 (1.4499) acc_x 53.1250 (61.2500) lr 1.9511e-03 eta 0:00:09
epoch [22/200] batch [15/31] time 0.481 (0.456) data 0.350 (0.325) loss_x loss_x 1.1475 (1.5021) acc_x 65.6250 (61.2500) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [20/31] time 0.396 (0.457) data 0.264 (0.326) loss_x loss_x 1.3838 (1.4882) acc_x 62.5000 (62.1875) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [25/31] time 0.419 (0.470) data 0.288 (0.339) loss_x loss_x 1.3037 (1.5045) acc_x 62.5000 (61.5000) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/31] time 0.529 (0.488) data 0.398 (0.357) loss_x loss_x 1.0361 (1.5015) acc_x 78.1250 (61.9792) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1779
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1042
clean true:1040
clean false:2
clean_rate:0.9980806142034548
noisy true:317
noisy false:1777
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 2094
epoch [23/200] batch [5/32] time 0.368 (0.439) data 0.237 (0.308) loss_x loss_x 1.4482 (1.3391) acc_x 68.7500 (66.2500) lr 1.9461e-03 eta 0:00:11
epoch [23/200] batch [10/32] time 0.413 (0.437) data 0.282 (0.306) loss_x loss_x 1.6611 (1.4585) acc_x 65.6250 (64.6875) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [15/32] time 0.332 (0.440) data 0.201 (0.309) loss_x loss_x 1.4717 (1.4956) acc_x 62.5000 (63.3333) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [20/32] time 0.443 (0.455) data 0.313 (0.325) loss_x loss_x 1.4180 (1.5088) acc_x 59.3750 (61.8750) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [25/32] time 0.628 (0.456) data 0.498 (0.326) loss_x loss_x 1.5762 (1.5316) acc_x 68.7500 (62.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [30/32] time 0.409 (0.453) data 0.278 (0.323) loss_x loss_x 2.4551 (1.5777) acc_x 46.8750 (61.0417) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.3399, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1066
clean true:1064
clean false:2
clean_rate:0.99812382739212
noisy true:313
noisy false:1757
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 2070
epoch [24/200] batch [5/33] time 0.569 (0.457) data 0.439 (0.326) loss_x loss_x 1.6924 (1.3838) acc_x 59.3750 (62.5000) lr 1.9409e-03 eta 0:00:12
epoch [24/200] batch [10/33] time 0.466 (0.455) data 0.336 (0.324) loss_x loss_x 1.4795 (1.3768) acc_x 65.6250 (64.0625) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [15/33] time 0.430 (0.458) data 0.299 (0.328) loss_x loss_x 1.4512 (1.3753) acc_x 59.3750 (62.9167) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [20/33] time 0.677 (0.464) data 0.547 (0.333) loss_x loss_x 1.4121 (1.4013) acc_x 56.2500 (62.8125) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [25/33] time 0.458 (0.469) data 0.328 (0.339) loss_x loss_x 1.6504 (1.4400) acc_x 46.8750 (61.3750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [30/33] time 0.410 (0.470) data 0.280 (0.339) loss_x loss_x 1.0986 (1.4102) acc_x 68.7500 (62.0833) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.3390, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1063
clean true:1058
clean false:5
clean_rate:0.9952963311382879
noisy true:331
noisy false:1742
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 2073
epoch [25/200] batch [5/33] time 0.595 (0.504) data 0.464 (0.374) loss_x loss_x 1.2119 (1.4586) acc_x 62.5000 (68.7500) lr 1.9354e-03 eta 0:00:14
epoch [25/200] batch [10/33] time 0.376 (0.475) data 0.244 (0.344) loss_x loss_x 1.4863 (1.4658) acc_x 71.8750 (66.8750) lr 1.9354e-03 eta 0:00:10
epoch [25/200] batch [15/33] time 0.359 (0.482) data 0.228 (0.351) loss_x loss_x 1.8564 (1.4617) acc_x 56.2500 (66.6667) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [20/33] time 0.437 (0.485) data 0.306 (0.354) loss_x loss_x 1.4609 (1.4931) acc_x 65.6250 (65.3125) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [25/33] time 0.451 (0.480) data 0.319 (0.349) loss_x loss_x 1.4922 (1.4721) acc_x 65.6250 (65.5000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [30/33] time 0.509 (0.494) data 0.379 (0.363) loss_x loss_x 1.6670 (1.4759) acc_x 62.5000 (64.5833) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1056
clean false:2
clean_rate:0.998109640831758
noisy true:314
noisy false:1764
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [26/200] batch [5/33] time 0.494 (0.464) data 0.363 (0.332) loss_x loss_x 1.6133 (1.6715) acc_x 62.5000 (60.0000) lr 1.9298e-03 eta 0:00:12
epoch [26/200] batch [10/33] time 0.374 (0.471) data 0.243 (0.339) loss_x loss_x 1.8643 (1.5731) acc_x 46.8750 (59.6875) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [15/33] time 0.608 (0.487) data 0.477 (0.356) loss_x loss_x 1.5293 (1.5241) acc_x 62.5000 (60.8333) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [20/33] time 0.486 (0.489) data 0.355 (0.358) loss_x loss_x 1.3027 (1.4905) acc_x 78.1250 (62.9688) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [25/33] time 0.491 (0.480) data 0.360 (0.349) loss_x loss_x 1.1484 (1.4537) acc_x 75.0000 (63.0000) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [30/33] time 0.490 (0.478) data 0.359 (0.347) loss_x loss_x 1.3076 (1.4560) acc_x 68.7500 (62.2917) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.3562, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1117
clean true:1115
clean false:2
clean_rate:0.9982094897045658
noisy true:312
noisy false:1707
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 2019
epoch [27/200] batch [5/34] time 0.452 (0.438) data 0.322 (0.308) loss_x loss_x 1.1182 (1.1827) acc_x 71.8750 (66.2500) lr 1.9239e-03 eta 0:00:12
epoch [27/200] batch [10/34] time 0.545 (0.465) data 0.416 (0.335) loss_x loss_x 1.2793 (1.3389) acc_x 65.6250 (63.4375) lr 1.9239e-03 eta 0:00:11
epoch [27/200] batch [15/34] time 0.345 (0.446) data 0.215 (0.315) loss_x loss_x 1.3359 (1.3329) acc_x 65.6250 (64.7917) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [20/34] time 0.427 (0.466) data 0.296 (0.335) loss_x loss_x 1.3389 (1.4125) acc_x 71.8750 (63.2812) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [25/34] time 0.476 (0.462) data 0.345 (0.331) loss_x loss_x 1.7236 (1.4340) acc_x 50.0000 (63.2500) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [30/34] time 0.439 (0.461) data 0.308 (0.330) loss_x loss_x 1.0703 (1.4512) acc_x 71.8750 (63.2292) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1730
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1077
clean true:1073
clean false:4
clean_rate:0.9962859795728877
noisy true:333
noisy false:1726
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 2059
epoch [28/200] batch [5/33] time 0.479 (0.486) data 0.347 (0.355) loss_x loss_x 1.3740 (1.4834) acc_x 62.5000 (65.0000) lr 1.9178e-03 eta 0:00:13
epoch [28/200] batch [10/33] time 0.461 (0.491) data 0.330 (0.360) loss_x loss_x 1.5469 (1.7076) acc_x 56.2500 (58.7500) lr 1.9178e-03 eta 0:00:11
epoch [28/200] batch [15/33] time 0.513 (0.488) data 0.381 (0.356) loss_x loss_x 1.8750 (1.6483) acc_x 53.1250 (58.3333) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [20/33] time 0.618 (0.506) data 0.487 (0.374) loss_x loss_x 1.6201 (1.6071) acc_x 59.3750 (59.5312) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [25/33] time 0.407 (0.507) data 0.277 (0.376) loss_x loss_x 1.8711 (1.5919) acc_x 56.2500 (60.5000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [30/33] time 0.444 (0.504) data 0.314 (0.373) loss_x loss_x 1.5020 (1.5499) acc_x 53.1250 (61.0417) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1073
clean true:1072
clean false:1
clean_rate:0.9990680335507922
noisy true:321
noisy false:1742
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 2063
epoch [29/200] batch [5/33] time 0.340 (0.406) data 0.210 (0.276) loss_x loss_x 0.9248 (1.2115) acc_x 81.2500 (70.6250) lr 1.9114e-03 eta 0:00:11
epoch [29/200] batch [10/33] time 0.548 (0.424) data 0.418 (0.294) loss_x loss_x 1.3428 (1.2735) acc_x 68.7500 (67.1875) lr 1.9114e-03 eta 0:00:09
epoch [29/200] batch [15/33] time 0.464 (0.443) data 0.333 (0.313) loss_x loss_x 1.9580 (1.3509) acc_x 50.0000 (65.2083) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [20/33] time 0.428 (0.445) data 0.298 (0.314) loss_x loss_x 0.9727 (1.3449) acc_x 71.8750 (64.5312) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [25/33] time 0.373 (0.451) data 0.243 (0.321) loss_x loss_x 1.6943 (1.4239) acc_x 56.2500 (63.5000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [30/33] time 0.412 (0.449) data 0.282 (0.319) loss_x loss_x 1.0713 (1.4547) acc_x 71.8750 (62.6042) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1760
confident_label rate tensor(0.3396, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1065
clean true:1064
clean false:1
clean_rate:0.9990610328638497
noisy true:312
noisy false:1759
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 2071
epoch [30/200] batch [5/33] time 0.437 (0.440) data 0.307 (0.309) loss_x loss_x 1.2227 (1.5418) acc_x 65.6250 (61.8750) lr 1.9048e-03 eta 0:00:12
epoch [30/200] batch [10/33] time 0.492 (0.444) data 0.362 (0.314) loss_x loss_x 1.3477 (1.5600) acc_x 56.2500 (60.9375) lr 1.9048e-03 eta 0:00:10
epoch [30/200] batch [15/33] time 0.426 (0.454) data 0.296 (0.323) loss_x loss_x 1.3887 (1.4475) acc_x 56.2500 (63.3333) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [20/33] time 0.352 (0.443) data 0.222 (0.312) loss_x loss_x 0.8955 (1.4130) acc_x 78.1250 (64.6875) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [25/33] time 0.483 (0.452) data 0.353 (0.321) loss_x loss_x 2.0391 (1.4466) acc_x 53.1250 (64.5000) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [30/33] time 0.398 (0.455) data 0.267 (0.325) loss_x loss_x 1.2275 (1.4451) acc_x 59.3750 (64.0625) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.3386, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1062
clean true:1060
clean false:2
clean_rate:0.9981167608286252
noisy true:319
noisy false:1755
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 2074
epoch [31/200] batch [5/33] time 0.542 (0.432) data 0.412 (0.301) loss_x loss_x 1.2412 (1.3814) acc_x 59.3750 (61.8750) lr 1.8980e-03 eta 0:00:12
epoch [31/200] batch [10/33] time 0.563 (0.468) data 0.433 (0.337) loss_x loss_x 2.0879 (1.4518) acc_x 53.1250 (62.5000) lr 1.8980e-03 eta 0:00:10
epoch [31/200] batch [15/33] time 0.441 (0.474) data 0.310 (0.344) loss_x loss_x 1.8799 (1.4433) acc_x 56.2500 (62.7083) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [20/33] time 0.505 (0.461) data 0.375 (0.330) loss_x loss_x 1.7939 (1.4564) acc_x 65.6250 (62.9688) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [25/33] time 0.634 (0.467) data 0.502 (0.337) loss_x loss_x 1.2002 (1.4505) acc_x 65.6250 (63.0000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [30/33] time 0.355 (0.456) data 0.225 (0.326) loss_x loss_x 1.3291 (1.4267) acc_x 65.6250 (63.3333) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1733
confident_label rate tensor(0.3367, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1056
clean true:1054
clean false:2
clean_rate:0.9981060606060606
noisy true:349
noisy false:1731
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 2080
epoch [32/200] batch [5/33] time 0.455 (0.549) data 0.325 (0.419) loss_x loss_x 1.2285 (1.4170) acc_x 75.0000 (67.5000) lr 1.8910e-03 eta 0:00:15
epoch [32/200] batch [10/33] time 0.472 (0.501) data 0.342 (0.370) loss_x loss_x 2.1758 (1.5815) acc_x 65.6250 (62.8125) lr 1.8910e-03 eta 0:00:11
epoch [32/200] batch [15/33] time 0.370 (0.470) data 0.240 (0.339) loss_x loss_x 1.3809 (1.5066) acc_x 65.6250 (63.7500) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [20/33] time 0.373 (0.454) data 0.242 (0.324) loss_x loss_x 1.3623 (1.4680) acc_x 71.8750 (64.2188) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [25/33] time 0.441 (0.450) data 0.310 (0.320) loss_x loss_x 1.5479 (1.4246) acc_x 59.3750 (65.1250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [30/33] time 0.404 (0.455) data 0.273 (0.325) loss_x loss_x 1.1602 (1.3854) acc_x 62.5000 (65.5208) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:333
noisy false:1695
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 2028
epoch [33/200] batch [5/34] time 0.677 (0.518) data 0.547 (0.387) loss_x loss_x 1.4736 (1.5750) acc_x 59.3750 (59.3750) lr 1.8838e-03 eta 0:00:15
epoch [33/200] batch [10/34] time 0.519 (0.492) data 0.389 (0.361) loss_x loss_x 1.4238 (1.4448) acc_x 68.7500 (63.4375) lr 1.8838e-03 eta 0:00:11
epoch [33/200] batch [15/34] time 0.470 (0.485) data 0.340 (0.354) loss_x loss_x 1.4238 (1.4772) acc_x 68.7500 (63.1250) lr 1.8838e-03 eta 0:00:09
epoch [33/200] batch [20/34] time 0.406 (0.476) data 0.275 (0.346) loss_x loss_x 0.7446 (1.3953) acc_x 84.3750 (64.0625) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [25/34] time 0.575 (0.474) data 0.446 (0.343) loss_x loss_x 1.2646 (1.4088) acc_x 59.3750 (63.7500) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [30/34] time 0.384 (0.476) data 0.254 (0.346) loss_x loss_x 1.4121 (1.4022) acc_x 65.6250 (64.0625) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1689
confident_label rate tensor(0.3530, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1107
clean true:1105
clean false:2
clean_rate:0.998193315266486
noisy true:342
noisy false:1687
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 2029
epoch [34/200] batch [5/34] time 0.551 (0.481) data 0.420 (0.350) loss_x loss_x 1.7461 (1.5641) acc_x 53.1250 (56.2500) lr 1.8763e-03 eta 0:00:13
epoch [34/200] batch [10/34] time 0.612 (0.489) data 0.482 (0.358) loss_x loss_x 1.5117 (1.4934) acc_x 62.5000 (61.5625) lr 1.8763e-03 eta 0:00:11
epoch [34/200] batch [15/34] time 0.507 (0.486) data 0.377 (0.355) loss_x loss_x 1.6113 (1.4878) acc_x 53.1250 (62.7083) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [20/34] time 0.737 (0.508) data 0.607 (0.377) loss_x loss_x 1.8486 (1.5024) acc_x 50.0000 (63.1250) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [25/34] time 0.442 (0.491) data 0.311 (0.361) loss_x loss_x 1.1709 (1.4457) acc_x 68.7500 (63.8750) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [30/34] time 0.410 (0.482) data 0.279 (0.351) loss_x loss_x 1.4697 (1.4579) acc_x 50.0000 (63.4375) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1720
confident_label rate tensor(0.3463, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1086
clean true:1084
clean false:2
clean_rate:0.998158379373849
noisy true:332
noisy false:1718
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 2050
epoch [35/200] batch [5/33] time 0.522 (0.477) data 0.392 (0.346) loss_x loss_x 2.0449 (1.6492) acc_x 40.6250 (55.0000) lr 1.8686e-03 eta 0:00:13
epoch [35/200] batch [10/33] time 0.457 (0.490) data 0.326 (0.359) loss_x loss_x 0.8481 (1.5165) acc_x 75.0000 (60.6250) lr 1.8686e-03 eta 0:00:11
epoch [35/200] batch [15/33] time 0.547 (0.476) data 0.417 (0.345) loss_x loss_x 1.5352 (1.5452) acc_x 62.5000 (60.4167) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [20/33] time 0.487 (0.470) data 0.356 (0.339) loss_x loss_x 1.5527 (1.5709) acc_x 59.3750 (59.0625) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [25/33] time 0.459 (0.474) data 0.328 (0.343) loss_x loss_x 1.4902 (1.5315) acc_x 62.5000 (60.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [30/33] time 0.534 (0.476) data 0.404 (0.345) loss_x loss_x 1.5957 (1.4919) acc_x 68.7500 (61.8750) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.3508, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:335
noisy false:1701
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 2036
epoch [36/200] batch [5/34] time 0.469 (0.521) data 0.339 (0.391) loss_x loss_x 1.8418 (1.6793) acc_x 62.5000 (56.2500) lr 1.8607e-03 eta 0:00:15
epoch [36/200] batch [10/34] time 0.463 (0.508) data 0.333 (0.378) loss_x loss_x 1.2939 (1.4900) acc_x 71.8750 (60.9375) lr 1.8607e-03 eta 0:00:12
epoch [36/200] batch [15/34] time 0.385 (0.492) data 0.254 (0.362) loss_x loss_x 1.4424 (1.4278) acc_x 62.5000 (62.5000) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [20/34] time 0.421 (0.478) data 0.291 (0.348) loss_x loss_x 1.5889 (1.4061) acc_x 62.5000 (62.6562) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [25/34] time 0.426 (0.476) data 0.296 (0.346) loss_x loss_x 1.7354 (1.3890) acc_x 62.5000 (63.5000) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [30/34] time 0.495 (0.473) data 0.364 (0.342) loss_x loss_x 1.4473 (1.3904) acc_x 59.3750 (63.6458) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1714
confident_label rate tensor(0.3540, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1110
clean true:1106
clean false:4
clean_rate:0.9963963963963964
noisy true:316
noisy false:1710
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 2026
epoch [37/200] batch [5/34] time 0.405 (0.448) data 0.275 (0.318) loss_x loss_x 1.6250 (1.3775) acc_x 59.3750 (69.3750) lr 1.8526e-03 eta 0:00:12
epoch [37/200] batch [10/34] time 0.396 (0.451) data 0.267 (0.320) loss_x loss_x 1.6191 (1.4245) acc_x 53.1250 (65.0000) lr 1.8526e-03 eta 0:00:10
epoch [37/200] batch [15/34] time 0.443 (0.448) data 0.312 (0.318) loss_x loss_x 1.8750 (1.4604) acc_x 53.1250 (63.3333) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [20/34] time 0.402 (0.443) data 0.272 (0.313) loss_x loss_x 1.1748 (1.4913) acc_x 71.8750 (63.4375) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [25/34] time 0.525 (0.453) data 0.395 (0.323) loss_x loss_x 1.3936 (1.4529) acc_x 62.5000 (63.8750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [30/34] time 0.399 (0.454) data 0.269 (0.323) loss_x loss_x 1.5469 (1.4748) acc_x 56.2500 (63.3333) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1720
confident_label rate tensor(0.3492, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1095
clean true:1093
clean false:2
clean_rate:0.9981735159817352
noisy true:323
noisy false:1718
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 2041
epoch [38/200] batch [5/34] time 0.436 (0.497) data 0.306 (0.367) loss_x loss_x 1.2578 (1.4199) acc_x 62.5000 (61.2500) lr 1.8443e-03 eta 0:00:14
epoch [38/200] batch [10/34] time 0.464 (0.476) data 0.334 (0.345) loss_x loss_x 1.0098 (1.3473) acc_x 68.7500 (62.8125) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [15/34] time 0.436 (0.456) data 0.305 (0.326) loss_x loss_x 1.3467 (1.3422) acc_x 59.3750 (63.5417) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [20/34] time 0.548 (0.464) data 0.416 (0.334) loss_x loss_x 1.6641 (1.3496) acc_x 59.3750 (64.0625) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [25/34] time 0.367 (0.460) data 0.237 (0.329) loss_x loss_x 1.5234 (1.3841) acc_x 56.2500 (63.5000) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [30/34] time 0.379 (0.458) data 0.248 (0.328) loss_x loss_x 1.6250 (1.4094) acc_x 56.2500 (63.3333) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.3549, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1113
clean true:1113
clean false:0
clean_rate:1.0
noisy true:314
noisy false:1709
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 2023
epoch [39/200] batch [5/34] time 0.494 (0.483) data 0.362 (0.352) loss_x loss_x 1.3125 (1.2611) acc_x 65.6250 (66.2500) lr 1.8358e-03 eta 0:00:13
epoch [39/200] batch [10/34] time 0.583 (0.482) data 0.453 (0.351) loss_x loss_x 0.9204 (1.2638) acc_x 71.8750 (68.1250) lr 1.8358e-03 eta 0:00:11
epoch [39/200] batch [15/34] time 0.442 (0.486) data 0.312 (0.356) loss_x loss_x 1.1719 (1.2458) acc_x 62.5000 (67.2917) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [20/34] time 0.647 (0.479) data 0.517 (0.348) loss_x loss_x 1.4434 (1.2653) acc_x 53.1250 (66.5625) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [25/34] time 0.497 (0.476) data 0.366 (0.346) loss_x loss_x 1.2695 (1.3369) acc_x 68.7500 (65.5000) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [30/34] time 0.413 (0.472) data 0.282 (0.341) loss_x loss_x 1.3242 (1.3585) acc_x 59.3750 (64.5833) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.3587, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1125
clean true:1122
clean false:3
clean_rate:0.9973333333333333
noisy true:323
noisy false:1688
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 2011
epoch [40/200] batch [5/35] time 0.415 (0.417) data 0.285 (0.287) loss_x loss_x 1.3896 (1.4543) acc_x 43.7500 (58.1250) lr 1.8271e-03 eta 0:00:12
epoch [40/200] batch [10/35] time 0.339 (0.437) data 0.208 (0.307) loss_x loss_x 1.3789 (1.4169) acc_x 65.6250 (61.5625) lr 1.8271e-03 eta 0:00:10
epoch [40/200] batch [15/35] time 0.563 (0.441) data 0.433 (0.310) loss_x loss_x 1.6338 (1.3755) acc_x 62.5000 (62.0833) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [20/35] time 0.494 (0.456) data 0.364 (0.326) loss_x loss_x 1.4414 (1.3416) acc_x 65.6250 (62.6562) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [25/35] time 0.432 (0.461) data 0.301 (0.330) loss_x loss_x 1.4492 (1.3725) acc_x 59.3750 (62.1250) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [30/35] time 0.412 (0.463) data 0.282 (0.333) loss_x loss_x 1.7793 (1.4050) acc_x 56.2500 (61.4583) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [35/35] time 0.392 (0.460) data 0.261 (0.329) loss_x loss_x 1.6963 (1.4428) acc_x 50.0000 (60.6250) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.3584, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1124
clean true:1122
clean false:2
clean_rate:0.998220640569395
noisy true:335
noisy false:1677
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 2012
epoch [41/200] batch [5/35] time 0.447 (0.490) data 0.317 (0.360) loss_x loss_x 1.2783 (1.1797) acc_x 68.7500 (68.1250) lr 1.8181e-03 eta 0:00:14
epoch [41/200] batch [10/35] time 0.460 (0.474) data 0.329 (0.343) loss_x loss_x 1.7207 (1.3386) acc_x 62.5000 (65.3125) lr 1.8181e-03 eta 0:00:11
epoch [41/200] batch [15/35] time 0.471 (0.458) data 0.341 (0.328) loss_x loss_x 1.1699 (1.3560) acc_x 68.7500 (64.1667) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [20/35] time 0.472 (0.460) data 0.342 (0.330) loss_x loss_x 1.4531 (1.4051) acc_x 62.5000 (63.4375) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [25/35] time 0.458 (0.458) data 0.329 (0.328) loss_x loss_x 1.6172 (1.4526) acc_x 62.5000 (63.7500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [30/35] time 0.370 (0.467) data 0.239 (0.337) loss_x loss_x 1.4004 (1.4614) acc_x 68.7500 (63.6458) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [35/35] time 0.420 (0.465) data 0.289 (0.334) loss_x loss_x 1.4238 (1.4126) acc_x 65.6250 (64.7321) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1698
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1101
clean true:1099
clean false:2
clean_rate:0.9981834695731153
noisy true:339
noisy false:1696
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 2035
epoch [42/200] batch [5/34] time 0.418 (0.477) data 0.287 (0.346) loss_x loss_x 1.5879 (1.5957) acc_x 56.2500 (61.2500) lr 1.8090e-03 eta 0:00:13
epoch [42/200] batch [10/34] time 0.530 (0.495) data 0.399 (0.364) loss_x loss_x 1.0576 (1.3743) acc_x 71.8750 (65.6250) lr 1.8090e-03 eta 0:00:11
epoch [42/200] batch [15/34] time 0.533 (0.491) data 0.403 (0.361) loss_x loss_x 1.4824 (1.4020) acc_x 68.7500 (65.6250) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [20/34] time 0.604 (0.491) data 0.473 (0.360) loss_x loss_x 1.9053 (1.4130) acc_x 65.6250 (65.0000) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [25/34] time 0.382 (0.477) data 0.251 (0.346) loss_x loss_x 1.8359 (1.4091) acc_x 59.3750 (64.8750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [30/34] time 0.434 (0.476) data 0.304 (0.345) loss_x loss_x 1.5693 (1.3949) acc_x 46.8750 (64.5833) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1656
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1149
clean true:1148
clean false:1
clean_rate:0.999129677980853
noisy true:332
noisy false:1655
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 1987
epoch [43/200] batch [5/35] time 0.400 (0.456) data 0.269 (0.326) loss_x loss_x 1.4141 (1.3930) acc_x 68.7500 (65.6250) lr 1.7997e-03 eta 0:00:13
epoch [43/200] batch [10/35] time 0.478 (0.460) data 0.347 (0.329) loss_x loss_x 0.8833 (1.3234) acc_x 65.6250 (63.7500) lr 1.7997e-03 eta 0:00:11
epoch [43/200] batch [15/35] time 0.589 (0.464) data 0.459 (0.333) loss_x loss_x 1.5859 (1.3270) acc_x 56.2500 (62.5000) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [20/35] time 0.419 (0.458) data 0.289 (0.327) loss_x loss_x 1.3203 (1.3658) acc_x 65.6250 (62.8125) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [25/35] time 0.402 (0.454) data 0.272 (0.324) loss_x loss_x 1.3516 (1.2968) acc_x 56.2500 (64.7500) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [30/35] time 0.420 (0.463) data 0.290 (0.332) loss_x loss_x 1.8838 (1.3386) acc_x 59.3750 (64.4792) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [35/35] time 0.619 (0.464) data 0.489 (0.334) loss_x loss_x 1.8506 (1.3448) acc_x 59.3750 (64.3750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.3555, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1115
clean true:1114
clean false:1
clean_rate:0.9991031390134529
noisy true:327
noisy false:1694
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 2021
epoch [44/200] batch [5/34] time 0.524 (0.434) data 0.394 (0.304) loss_x loss_x 1.6426 (1.4904) acc_x 56.2500 (61.2500) lr 1.7902e-03 eta 0:00:12
epoch [44/200] batch [10/34] time 0.425 (0.427) data 0.294 (0.297) loss_x loss_x 1.3506 (1.4202) acc_x 65.6250 (62.1875) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [15/34] time 0.489 (0.446) data 0.359 (0.316) loss_x loss_x 1.3457 (1.4348) acc_x 62.5000 (61.8750) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [20/34] time 0.472 (0.449) data 0.341 (0.319) loss_x loss_x 1.7520 (1.4000) acc_x 53.1250 (63.5938) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [25/34] time 0.493 (0.458) data 0.363 (0.327) loss_x loss_x 1.6250 (1.4143) acc_x 59.3750 (63.5000) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [30/34] time 0.495 (0.459) data 0.365 (0.329) loss_x loss_x 1.8184 (1.4223) acc_x 65.6250 (63.5417) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1120
clean true:1119
clean false:1
clean_rate:0.9991071428571429
noisy true:336
noisy false:1680
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 2016
epoch [45/200] batch [5/35] time 0.416 (0.481) data 0.285 (0.351) loss_x loss_x 1.2861 (1.2172) acc_x 59.3750 (66.8750) lr 1.7804e-03 eta 0:00:14
epoch [45/200] batch [10/35] time 0.480 (0.458) data 0.349 (0.328) loss_x loss_x 1.5283 (1.4191) acc_x 53.1250 (63.7500) lr 1.7804e-03 eta 0:00:11
epoch [45/200] batch [15/35] time 0.375 (0.459) data 0.244 (0.329) loss_x loss_x 1.2891 (1.3907) acc_x 59.3750 (63.7500) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [20/35] time 0.460 (0.459) data 0.331 (0.329) loss_x loss_x 1.5850 (1.3792) acc_x 56.2500 (63.9062) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [25/35] time 0.527 (0.464) data 0.396 (0.334) loss_x loss_x 1.2812 (1.3858) acc_x 71.8750 (63.7500) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [30/35] time 0.514 (0.469) data 0.383 (0.339) loss_x loss_x 1.9102 (1.3760) acc_x 50.0000 (64.0625) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [35/35] time 0.517 (0.466) data 0.387 (0.336) loss_x loss_x 1.5049 (1.3651) acc_x 62.5000 (64.7321) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1145
clean true:1143
clean false:2
clean_rate:0.9982532751091703
noisy true:340
noisy false:1651
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 1991
epoch [46/200] batch [5/35] time 0.460 (0.458) data 0.329 (0.327) loss_x loss_x 1.0244 (1.4039) acc_x 71.8750 (65.0000) lr 1.7705e-03 eta 0:00:13
epoch [46/200] batch [10/35] time 0.587 (0.478) data 0.456 (0.347) loss_x loss_x 1.0693 (1.4122) acc_x 71.8750 (63.7500) lr 1.7705e-03 eta 0:00:11
epoch [46/200] batch [15/35] time 0.395 (0.459) data 0.265 (0.328) loss_x loss_x 1.5107 (1.3602) acc_x 56.2500 (64.7917) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [20/35] time 0.428 (0.463) data 0.297 (0.332) loss_x loss_x 1.8037 (1.3635) acc_x 50.0000 (65.0000) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [25/35] time 0.439 (0.459) data 0.308 (0.328) loss_x loss_x 0.7954 (1.3889) acc_x 78.1250 (64.3750) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [30/35] time 0.623 (0.466) data 0.493 (0.335) loss_x loss_x 1.2246 (1.3867) acc_x 68.7500 (64.3750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [35/35] time 0.480 (0.465) data 0.349 (0.334) loss_x loss_x 1.0615 (1.3581) acc_x 81.2500 (65.8036) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.3514, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1102
clean true:1102
clean false:0
clean_rate:1.0
noisy true:349
noisy false:1685
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 2034
epoch [47/200] batch [5/34] time 0.415 (0.496) data 0.285 (0.365) loss_x loss_x 1.3418 (1.3207) acc_x 65.6250 (66.2500) lr 1.7604e-03 eta 0:00:14
epoch [47/200] batch [10/34] time 0.422 (0.471) data 0.292 (0.341) loss_x loss_x 1.1602 (1.3241) acc_x 71.8750 (65.6250) lr 1.7604e-03 eta 0:00:11
epoch [47/200] batch [15/34] time 0.471 (0.497) data 0.341 (0.367) loss_x loss_x 1.1377 (1.3176) acc_x 68.7500 (64.5833) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [20/34] time 0.480 (0.480) data 0.350 (0.350) loss_x loss_x 1.7529 (1.3492) acc_x 50.0000 (64.6875) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [25/34] time 0.495 (0.478) data 0.365 (0.347) loss_x loss_x 1.7627 (1.3839) acc_x 43.7500 (63.6250) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [30/34] time 0.486 (0.480) data 0.355 (0.350) loss_x loss_x 1.5898 (1.3949) acc_x 40.6250 (62.5000) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.3654, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1146
clean true:1143
clean false:3
clean_rate:0.9973821989528796
noisy true:324
noisy false:1666
after delete: len(clean_dataset) 1146
after delete: len(noisy_dataset) 1990
epoch [48/200] batch [5/35] time 0.428 (0.438) data 0.298 (0.308) loss_x loss_x 1.4785 (1.3295) acc_x 65.6250 (68.1250) lr 1.7501e-03 eta 0:00:13
epoch [48/200] batch [10/35] time 0.665 (0.472) data 0.534 (0.342) loss_x loss_x 1.2861 (1.2896) acc_x 68.7500 (69.3750) lr 1.7501e-03 eta 0:00:11
epoch [48/200] batch [15/35] time 0.807 (0.488) data 0.678 (0.358) loss_x loss_x 1.1865 (1.2886) acc_x 71.8750 (67.2917) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [20/35] time 0.491 (0.477) data 0.360 (0.347) loss_x loss_x 1.7051 (1.3439) acc_x 50.0000 (65.4688) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [25/35] time 0.468 (0.471) data 0.338 (0.341) loss_x loss_x 0.7539 (1.3680) acc_x 75.0000 (65.3750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [30/35] time 0.364 (0.458) data 0.234 (0.328) loss_x loss_x 1.2197 (1.3959) acc_x 71.8750 (64.5833) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [35/35] time 0.477 (0.461) data 0.347 (0.331) loss_x loss_x 1.7383 (1.3856) acc_x 68.7500 (65.0893) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.3648, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1144
clean true:1142
clean false:2
clean_rate:0.9982517482517482
noisy true:355
noisy false:1637
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 1992
epoch [49/200] batch [5/35] time 0.499 (0.497) data 0.368 (0.366) loss_x loss_x 0.7983 (1.1188) acc_x 65.6250 (66.8750) lr 1.7396e-03 eta 0:00:14
epoch [49/200] batch [10/35] time 0.465 (0.486) data 0.334 (0.355) loss_x loss_x 1.6729 (1.2073) acc_x 50.0000 (65.3125) lr 1.7396e-03 eta 0:00:12
epoch [49/200] batch [15/35] time 0.374 (0.471) data 0.243 (0.340) loss_x loss_x 1.4775 (1.2299) acc_x 65.6250 (66.4583) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [20/35] time 0.506 (0.468) data 0.376 (0.337) loss_x loss_x 1.9062 (1.3279) acc_x 50.0000 (64.8438) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [25/35] time 0.467 (0.470) data 0.337 (0.340) loss_x loss_x 1.0156 (1.3409) acc_x 68.7500 (63.8750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [30/35] time 0.350 (0.465) data 0.220 (0.334) loss_x loss_x 1.5127 (1.3564) acc_x 56.2500 (63.5417) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [35/35] time 0.509 (0.467) data 0.379 (0.336) loss_x loss_x 1.2832 (1.3561) acc_x 59.3750 (63.4821) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.3591, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1126
clean true:1122
clean false:4
clean_rate:0.9964476021314387
noisy true:339
noisy false:1671
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 2010
epoch [50/200] batch [5/35] time 0.450 (0.425) data 0.320 (0.295) loss_x loss_x 1.3574 (1.4607) acc_x 62.5000 (62.5000) lr 1.7290e-03 eta 0:00:12
epoch [50/200] batch [10/35] time 0.427 (0.436) data 0.297 (0.305) loss_x loss_x 1.4912 (1.4441) acc_x 59.3750 (63.4375) lr 1.7290e-03 eta 0:00:10
epoch [50/200] batch [15/35] time 0.489 (0.444) data 0.359 (0.313) loss_x loss_x 1.5020 (1.3884) acc_x 75.0000 (65.4167) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [20/35] time 0.489 (0.455) data 0.358 (0.324) loss_x loss_x 1.7021 (1.4195) acc_x 59.3750 (65.3125) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [25/35] time 0.494 (0.460) data 0.363 (0.329) loss_x loss_x 1.3633 (1.3924) acc_x 65.6250 (65.7500) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [30/35] time 0.452 (0.459) data 0.321 (0.329) loss_x loss_x 1.5195 (1.4231) acc_x 65.6250 (64.6875) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [35/35] time 0.531 (0.462) data 0.400 (0.331) loss_x loss_x 1.3818 (1.4074) acc_x 65.6250 (64.5536) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.3607, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1131
clean true:1126
clean false:5
clean_rate:0.995579133510168
noisy true:357
noisy false:1648
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 2005
epoch [51/200] batch [5/35] time 0.488 (0.411) data 0.357 (0.280) loss_x loss_x 1.0078 (1.3064) acc_x 62.5000 (63.7500) lr 1.7181e-03 eta 0:00:12
epoch [51/200] batch [10/35] time 0.484 (0.449) data 0.353 (0.318) loss_x loss_x 1.4072 (1.4264) acc_x 65.6250 (64.3750) lr 1.7181e-03 eta 0:00:11
epoch [51/200] batch [15/35] time 0.473 (0.447) data 0.343 (0.317) loss_x loss_x 1.4570 (1.3725) acc_x 65.6250 (65.8333) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [20/35] time 0.387 (0.443) data 0.257 (0.312) loss_x loss_x 1.2188 (1.3668) acc_x 78.1250 (65.9375) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [25/35] time 0.541 (0.444) data 0.411 (0.313) loss_x loss_x 1.0693 (1.3124) acc_x 68.7500 (66.5000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [30/35] time 0.669 (0.454) data 0.539 (0.323) loss_x loss_x 1.5986 (1.3037) acc_x 62.5000 (67.6042) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [35/35] time 0.399 (0.451) data 0.269 (0.320) loss_x loss_x 1.1455 (1.3198) acc_x 68.7500 (66.9643) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1600
confident_label rate tensor(0.3795, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1190
clean true:1190
clean false:0
clean_rate:1.0
noisy true:346
noisy false:1600
after delete: len(clean_dataset) 1190
after delete: len(noisy_dataset) 1946
epoch [52/200] batch [5/37] time 0.556 (0.480) data 0.426 (0.349) loss_x loss_x 1.0928 (1.2563) acc_x 75.0000 (68.7500) lr 1.7071e-03 eta 0:00:15
epoch [52/200] batch [10/37] time 0.470 (0.463) data 0.340 (0.332) loss_x loss_x 1.3135 (1.3772) acc_x 78.1250 (65.9375) lr 1.7071e-03 eta 0:00:12
epoch [52/200] batch [15/37] time 0.412 (0.458) data 0.282 (0.327) loss_x loss_x 1.6133 (1.3805) acc_x 59.3750 (65.6250) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [20/37] time 0.551 (0.462) data 0.421 (0.332) loss_x loss_x 1.2949 (1.3636) acc_x 62.5000 (65.0000) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [25/37] time 0.442 (0.453) data 0.313 (0.322) loss_x loss_x 1.1201 (1.3523) acc_x 78.1250 (65.2500) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [30/37] time 0.363 (0.448) data 0.232 (0.317) loss_x loss_x 1.0078 (1.3157) acc_x 71.8750 (65.8333) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [35/37] time 0.552 (0.454) data 0.421 (0.323) loss_x loss_x 1.0176 (1.2926) acc_x 71.8750 (66.3393) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.3693, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1158
clean true:1157
clean false:1
clean_rate:0.9991364421416234
noisy true:359
noisy false:1619
after delete: len(clean_dataset) 1158
after delete: len(noisy_dataset) 1978
epoch [53/200] batch [5/36] time 0.423 (0.437) data 0.293 (0.306) loss_x loss_x 1.4326 (1.4018) acc_x 59.3750 (61.8750) lr 1.6959e-03 eta 0:00:13
epoch [53/200] batch [10/36] time 0.464 (0.460) data 0.333 (0.329) loss_x loss_x 1.3926 (1.3414) acc_x 56.2500 (61.2500) lr 1.6959e-03 eta 0:00:11
epoch [53/200] batch [15/36] time 0.478 (0.466) data 0.347 (0.335) loss_x loss_x 1.8359 (1.4176) acc_x 53.1250 (60.0000) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [20/36] time 0.399 (0.465) data 0.268 (0.334) loss_x loss_x 1.2461 (1.3791) acc_x 62.5000 (61.7188) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [25/36] time 0.411 (0.454) data 0.280 (0.323) loss_x loss_x 1.5020 (1.3915) acc_x 50.0000 (62.2500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [30/36] time 0.382 (0.453) data 0.251 (0.322) loss_x loss_x 1.1436 (1.3800) acc_x 62.5000 (62.6042) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [35/36] time 0.563 (0.458) data 0.432 (0.327) loss_x loss_x 1.5303 (1.4069) acc_x 75.0000 (62.0536) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.3667, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1150
clean true:1147
clean false:3
clean_rate:0.9973913043478261
noisy true:349
noisy false:1637
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 1986
epoch [54/200] batch [5/35] time 0.701 (0.531) data 0.570 (0.400) loss_x loss_x 1.1182 (1.4238) acc_x 65.6250 (64.3750) lr 1.6845e-03 eta 0:00:15
epoch [54/200] batch [10/35] time 0.456 (0.518) data 0.325 (0.387) loss_x loss_x 1.2969 (1.3880) acc_x 68.7500 (66.5625) lr 1.6845e-03 eta 0:00:12
epoch [54/200] batch [15/35] time 0.400 (0.476) data 0.269 (0.345) loss_x loss_x 1.1221 (1.3746) acc_x 78.1250 (67.5000) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [20/35] time 0.427 (0.471) data 0.296 (0.340) loss_x loss_x 1.2051 (1.2743) acc_x 65.6250 (69.0625) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [25/35] time 0.411 (0.465) data 0.279 (0.334) loss_x loss_x 1.2129 (1.3177) acc_x 75.0000 (67.8750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [30/35] time 0.556 (0.462) data 0.426 (0.331) loss_x loss_x 1.2676 (1.3059) acc_x 65.6250 (67.6042) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [35/35] time 0.471 (0.465) data 0.340 (0.334) loss_x loss_x 1.1895 (1.3168) acc_x 65.6250 (66.8750) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1613
confident_label rate tensor(0.3782, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1186
clean true:1184
clean false:2
clean_rate:0.9983136593591906
noisy true:339
noisy false:1611
after delete: len(clean_dataset) 1186
after delete: len(noisy_dataset) 1950
epoch [55/200] batch [5/37] time 0.372 (0.422) data 0.241 (0.291) loss_x loss_x 1.1318 (1.1604) acc_x 71.8750 (67.5000) lr 1.6730e-03 eta 0:00:13
epoch [55/200] batch [10/37] time 0.363 (0.416) data 0.232 (0.285) loss_x loss_x 1.0596 (1.1687) acc_x 71.8750 (69.0625) lr 1.6730e-03 eta 0:00:11
epoch [55/200] batch [15/37] time 0.419 (0.435) data 0.288 (0.304) loss_x loss_x 1.3369 (1.1746) acc_x 59.3750 (67.9167) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [20/37] time 0.615 (0.448) data 0.484 (0.317) loss_x loss_x 1.2070 (1.2244) acc_x 68.7500 (67.8125) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [25/37] time 0.470 (0.456) data 0.339 (0.326) loss_x loss_x 1.6084 (1.2654) acc_x 56.2500 (66.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [30/37] time 0.434 (0.453) data 0.302 (0.322) loss_x loss_x 1.6738 (1.2653) acc_x 62.5000 (67.1875) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [35/37] time 0.507 (0.460) data 0.376 (0.329) loss_x loss_x 1.4922 (1.2687) acc_x 56.2500 (66.5179) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1638
confident_label rate tensor(0.3699, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1160
clean true:1158
clean false:2
clean_rate:0.9982758620689656
noisy true:340
noisy false:1636
after delete: len(clean_dataset) 1160
after delete: len(noisy_dataset) 1976
epoch [56/200] batch [5/36] time 0.470 (0.444) data 0.340 (0.314) loss_x loss_x 1.1357 (1.2739) acc_x 65.6250 (69.3750) lr 1.6613e-03 eta 0:00:13
epoch [56/200] batch [10/36] time 0.500 (0.459) data 0.370 (0.329) loss_x loss_x 1.6758 (1.3291) acc_x 50.0000 (66.5625) lr 1.6613e-03 eta 0:00:11
epoch [56/200] batch [15/36] time 0.468 (0.444) data 0.337 (0.313) loss_x loss_x 0.9956 (1.3436) acc_x 71.8750 (65.2083) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [20/36] time 0.399 (0.438) data 0.268 (0.308) loss_x loss_x 1.1084 (1.3292) acc_x 68.7500 (65.6250) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [25/36] time 0.663 (0.455) data 0.532 (0.324) loss_x loss_x 1.2959 (1.4157) acc_x 68.7500 (63.2500) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [30/36] time 0.485 (0.464) data 0.354 (0.333) loss_x loss_x 1.1953 (1.3975) acc_x 68.7500 (63.4375) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [35/36] time 0.446 (0.468) data 0.316 (0.338) loss_x loss_x 2.0332 (1.4146) acc_x 53.1250 (63.4821) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.3648, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1144
clean true:1144
clean false:0
clean_rate:1.0
noisy true:317
noisy false:1675
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 1992
epoch [57/200] batch [5/35] time 0.485 (0.482) data 0.354 (0.351) loss_x loss_x 1.1914 (1.5506) acc_x 71.8750 (61.8750) lr 1.6494e-03 eta 0:00:14
epoch [57/200] batch [10/35] time 0.476 (0.453) data 0.346 (0.322) loss_x loss_x 1.1641 (1.4702) acc_x 65.6250 (61.5625) lr 1.6494e-03 eta 0:00:11
epoch [57/200] batch [15/35] time 0.402 (0.457) data 0.271 (0.326) loss_x loss_x 1.4453 (1.4112) acc_x 56.2500 (62.0833) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [20/35] time 0.443 (0.470) data 0.312 (0.339) loss_x loss_x 1.2363 (1.3812) acc_x 68.7500 (63.5938) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [25/35] time 0.428 (0.472) data 0.298 (0.341) loss_x loss_x 1.9395 (1.4106) acc_x 59.3750 (63.3750) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [30/35] time 0.433 (0.472) data 0.303 (0.341) loss_x loss_x 1.4473 (1.3864) acc_x 59.3750 (63.6458) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [35/35] time 0.311 (0.466) data 0.180 (0.335) loss_x loss_x 1.5371 (1.3735) acc_x 50.0000 (63.4821) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1664
confident_label rate tensor(0.3680, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1154
clean true:1152
clean false:2
clean_rate:0.9982668977469671
noisy true:320
noisy false:1662
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 1982
epoch [58/200] batch [5/36] time 0.627 (0.490) data 0.495 (0.359) loss_x loss_x 1.0898 (1.3086) acc_x 71.8750 (68.7500) lr 1.6374e-03 eta 0:00:15
epoch [58/200] batch [10/36] time 0.412 (0.469) data 0.280 (0.338) loss_x loss_x 1.2236 (1.4111) acc_x 71.8750 (65.6250) lr 1.6374e-03 eta 0:00:12
epoch [58/200] batch [15/36] time 0.535 (0.468) data 0.404 (0.337) loss_x loss_x 1.6748 (1.4075) acc_x 65.6250 (65.2083) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [20/36] time 0.565 (0.483) data 0.435 (0.353) loss_x loss_x 2.1113 (1.4090) acc_x 40.6250 (64.5312) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [25/36] time 0.417 (0.474) data 0.286 (0.343) loss_x loss_x 1.1729 (1.4327) acc_x 75.0000 (64.2500) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [30/36] time 0.401 (0.471) data 0.270 (0.340) loss_x loss_x 1.9912 (1.4316) acc_x 50.0000 (64.1667) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [35/36] time 0.586 (0.467) data 0.456 (0.336) loss_x loss_x 1.2266 (1.4110) acc_x 68.7500 (64.3750) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3740, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1173
clean true:1170
clean false:3
clean_rate:0.9974424552429667
noisy true:332
noisy false:1631
after delete: len(clean_dataset) 1173
after delete: len(noisy_dataset) 1963
epoch [59/200] batch [5/36] time 0.501 (0.533) data 0.371 (0.402) loss_x loss_x 1.0107 (1.2773) acc_x 81.2500 (68.7500) lr 1.6252e-03 eta 0:00:16
epoch [59/200] batch [10/36] time 0.442 (0.477) data 0.311 (0.346) loss_x loss_x 1.4658 (1.1900) acc_x 68.7500 (70.3125) lr 1.6252e-03 eta 0:00:12
epoch [59/200] batch [15/36] time 0.437 (0.483) data 0.307 (0.352) loss_x loss_x 1.3906 (1.3564) acc_x 62.5000 (67.2917) lr 1.6252e-03 eta 0:00:10
epoch [59/200] batch [20/36] time 0.440 (0.476) data 0.309 (0.346) loss_x loss_x 1.3086 (1.3556) acc_x 62.5000 (66.8750) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [25/36] time 0.424 (0.470) data 0.294 (0.340) loss_x loss_x 1.4961 (1.3600) acc_x 65.6250 (66.8750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [30/36] time 0.418 (0.475) data 0.287 (0.344) loss_x loss_x 1.2490 (1.3807) acc_x 59.3750 (66.0417) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [35/36] time 0.436 (0.467) data 0.305 (0.337) loss_x loss_x 1.1299 (1.3959) acc_x 68.7500 (65.8929) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1656
confident_label rate tensor(0.3658, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1147
clean true:1146
clean false:1
clean_rate:0.999128160418483
noisy true:334
noisy false:1655
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 1989
epoch [60/200] batch [5/35] time 0.374 (0.431) data 0.243 (0.300) loss_x loss_x 1.1143 (1.3047) acc_x 81.2500 (67.5000) lr 1.6129e-03 eta 0:00:12
epoch [60/200] batch [10/35] time 0.375 (0.456) data 0.245 (0.325) loss_x loss_x 1.0283 (1.2839) acc_x 68.7500 (67.1875) lr 1.6129e-03 eta 0:00:11
epoch [60/200] batch [15/35] time 0.402 (0.464) data 0.272 (0.334) loss_x loss_x 1.4824 (1.2898) acc_x 71.8750 (67.5000) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [20/35] time 0.382 (0.468) data 0.252 (0.337) loss_x loss_x 1.5674 (1.3022) acc_x 53.1250 (66.4062) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [25/35] time 0.442 (0.465) data 0.312 (0.334) loss_x loss_x 1.4854 (1.3033) acc_x 59.3750 (65.8750) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [30/35] time 0.425 (0.459) data 0.295 (0.329) loss_x loss_x 1.6943 (1.3213) acc_x 71.8750 (66.1458) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [35/35] time 0.535 (0.458) data 0.405 (0.327) loss_x loss_x 0.8755 (1.3330) acc_x 75.0000 (66.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1120
clean true:1118
clean false:2
clean_rate:0.9982142857142857
noisy true:339
noisy false:1677
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 2016
epoch [61/200] batch [5/35] time 0.439 (0.486) data 0.308 (0.356) loss_x loss_x 1.3057 (1.2502) acc_x 68.7500 (67.5000) lr 1.6004e-03 eta 0:00:14
epoch [61/200] batch [10/35] time 0.520 (0.473) data 0.389 (0.342) loss_x loss_x 1.4941 (1.3582) acc_x 62.5000 (67.5000) lr 1.6004e-03 eta 0:00:11
epoch [61/200] batch [15/35] time 0.588 (0.469) data 0.457 (0.338) loss_x loss_x 1.5371 (1.3338) acc_x 53.1250 (66.2500) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [20/35] time 0.451 (0.465) data 0.320 (0.334) loss_x loss_x 1.2480 (1.3592) acc_x 65.6250 (66.0938) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [25/35] time 0.470 (0.458) data 0.339 (0.327) loss_x loss_x 2.2344 (1.3966) acc_x 40.6250 (63.6250) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [30/35] time 0.449 (0.467) data 0.318 (0.336) loss_x loss_x 1.1709 (1.3529) acc_x 75.0000 (65.1042) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [35/35] time 0.505 (0.472) data 0.375 (0.341) loss_x loss_x 1.1074 (1.3457) acc_x 78.1250 (65.3571) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.3667, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1150
clean true:1150
clean false:0
clean_rate:1.0
noisy true:337
noisy false:1649
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 1986
epoch [62/200] batch [5/35] time 0.466 (0.479) data 0.334 (0.348) loss_x loss_x 1.5625 (1.4584) acc_x 56.2500 (58.1250) lr 1.5878e-03 eta 0:00:14
epoch [62/200] batch [10/35] time 0.435 (0.459) data 0.305 (0.329) loss_x loss_x 0.9917 (1.3153) acc_x 68.7500 (63.4375) lr 1.5878e-03 eta 0:00:11
epoch [62/200] batch [15/35] time 0.648 (0.481) data 0.517 (0.350) loss_x loss_x 1.0127 (1.3017) acc_x 68.7500 (64.1667) lr 1.5878e-03 eta 0:00:09
epoch [62/200] batch [20/35] time 0.592 (0.492) data 0.461 (0.361) loss_x loss_x 1.3818 (1.3102) acc_x 65.6250 (66.2500) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [25/35] time 0.451 (0.487) data 0.322 (0.357) loss_x loss_x 1.1445 (1.2944) acc_x 71.8750 (66.6250) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [30/35] time 0.478 (0.478) data 0.348 (0.348) loss_x loss_x 1.4619 (1.2979) acc_x 62.5000 (67.1875) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [35/35] time 0.441 (0.473) data 0.311 (0.342) loss_x loss_x 1.9463 (1.3164) acc_x 56.2500 (66.2500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1626
confident_label rate tensor(0.3747, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1175
clean true:1174
clean false:1
clean_rate:0.9991489361702127
noisy true:336
noisy false:1625
after delete: len(clean_dataset) 1175
after delete: len(noisy_dataset) 1961
epoch [63/200] batch [5/36] time 0.440 (0.458) data 0.310 (0.327) loss_x loss_x 1.2266 (1.4230) acc_x 71.8750 (64.3750) lr 1.5750e-03 eta 0:00:14
epoch [63/200] batch [10/36] time 0.428 (0.445) data 0.297 (0.314) loss_x loss_x 1.4395 (1.2799) acc_x 59.3750 (68.1250) lr 1.5750e-03 eta 0:00:11
epoch [63/200] batch [15/36] time 0.499 (0.462) data 0.368 (0.331) loss_x loss_x 1.7197 (1.3207) acc_x 62.5000 (66.8750) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [20/36] time 0.346 (0.461) data 0.215 (0.330) loss_x loss_x 2.3828 (1.3448) acc_x 43.7500 (65.7812) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [25/36] time 0.556 (0.465) data 0.425 (0.334) loss_x loss_x 1.6406 (1.3469) acc_x 53.1250 (65.8750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [30/36] time 0.447 (0.467) data 0.317 (0.337) loss_x loss_x 1.2568 (1.3702) acc_x 68.7500 (65.8333) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [35/36] time 0.424 (0.468) data 0.293 (0.337) loss_x loss_x 0.9438 (1.3373) acc_x 78.1250 (66.4286) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.3753, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1177
clean true:1174
clean false:3
clean_rate:0.9974511469838573
noisy true:327
noisy false:1632
after delete: len(clean_dataset) 1177
after delete: len(noisy_dataset) 1959
epoch [64/200] batch [5/36] time 0.534 (0.457) data 0.403 (0.327) loss_x loss_x 1.1533 (1.1674) acc_x 71.8750 (70.6250) lr 1.5621e-03 eta 0:00:14
epoch [64/200] batch [10/36] time 0.425 (0.454) data 0.294 (0.324) loss_x loss_x 1.1953 (1.2505) acc_x 71.8750 (67.1875) lr 1.5621e-03 eta 0:00:11
epoch [64/200] batch [15/36] time 0.540 (0.478) data 0.409 (0.348) loss_x loss_x 1.3311 (1.3443) acc_x 68.7500 (65.6250) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [20/36] time 0.416 (0.476) data 0.286 (0.346) loss_x loss_x 1.5938 (1.3642) acc_x 53.1250 (65.1562) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [25/36] time 0.475 (0.472) data 0.345 (0.342) loss_x loss_x 2.0195 (1.4086) acc_x 53.1250 (64.5000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [30/36] time 0.443 (0.476) data 0.313 (0.345) loss_x loss_x 0.9058 (1.3865) acc_x 75.0000 (65.5208) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [35/36] time 0.391 (0.468) data 0.260 (0.338) loss_x loss_x 1.4258 (1.3979) acc_x 75.0000 (65.1786) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.3693, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1158
clean true:1156
clean false:2
clean_rate:0.998272884283247
noisy true:334
noisy false:1644
after delete: len(clean_dataset) 1158
after delete: len(noisy_dataset) 1978
epoch [65/200] batch [5/36] time 0.516 (0.458) data 0.385 (0.327) loss_x loss_x 1.4619 (1.4004) acc_x 71.8750 (68.1250) lr 1.5490e-03 eta 0:00:14
epoch [65/200] batch [10/36] time 0.427 (0.446) data 0.297 (0.315) loss_x loss_x 2.1426 (1.4285) acc_x 50.0000 (66.2500) lr 1.5490e-03 eta 0:00:11
epoch [65/200] batch [15/36] time 0.523 (0.450) data 0.393 (0.320) loss_x loss_x 1.4932 (1.3822) acc_x 53.1250 (66.2500) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [20/36] time 0.378 (0.454) data 0.247 (0.323) loss_x loss_x 0.8599 (1.3136) acc_x 68.7500 (67.6562) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [25/36] time 0.526 (0.460) data 0.395 (0.330) loss_x loss_x 1.0156 (1.4065) acc_x 81.2500 (65.8750) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [30/36] time 0.515 (0.470) data 0.384 (0.339) loss_x loss_x 1.6133 (1.4603) acc_x 50.0000 (64.3750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [35/36] time 0.475 (0.473) data 0.344 (0.342) loss_x loss_x 1.4463 (1.4554) acc_x 71.8750 (64.8214) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1632
confident_label rate tensor(0.3798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1191
clean true:1189
clean false:2
clean_rate:0.998320738874895
noisy true:315
noisy false:1630
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 1945
epoch [66/200] batch [5/37] time 0.459 (0.547) data 0.329 (0.417) loss_x loss_x 1.1953 (1.2322) acc_x 71.8750 (67.5000) lr 1.5358e-03 eta 0:00:17
epoch [66/200] batch [10/37] time 0.409 (0.510) data 0.278 (0.379) loss_x loss_x 0.9814 (1.2638) acc_x 75.0000 (66.8750) lr 1.5358e-03 eta 0:00:13
epoch [66/200] batch [15/37] time 0.411 (0.492) data 0.281 (0.361) loss_x loss_x 1.7451 (1.3298) acc_x 53.1250 (65.4167) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [20/37] time 0.504 (0.481) data 0.373 (0.350) loss_x loss_x 1.2979 (1.3141) acc_x 53.1250 (65.1562) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [25/37] time 0.494 (0.487) data 0.364 (0.357) loss_x loss_x 1.2393 (1.3096) acc_x 68.7500 (65.3750) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [30/37] time 0.437 (0.478) data 0.306 (0.348) loss_x loss_x 1.8574 (1.3213) acc_x 50.0000 (64.8958) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [35/37] time 0.381 (0.471) data 0.250 (0.340) loss_x loss_x 1.2256 (1.3144) acc_x 71.8750 (65.0000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1641
confident_label rate tensor(0.3696, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1159
clean true:1159
clean false:0
clean_rate:1.0
noisy true:336
noisy false:1641
after delete: len(clean_dataset) 1159
after delete: len(noisy_dataset) 1977
epoch [67/200] batch [5/36] time 0.526 (0.520) data 0.395 (0.389) loss_x loss_x 1.4521 (1.2912) acc_x 68.7500 (67.5000) lr 1.5225e-03 eta 0:00:16
epoch [67/200] batch [10/36] time 0.525 (0.511) data 0.394 (0.380) loss_x loss_x 1.5381 (1.2751) acc_x 59.3750 (66.8750) lr 1.5225e-03 eta 0:00:13
epoch [67/200] batch [15/36] time 0.390 (0.480) data 0.259 (0.348) loss_x loss_x 1.3164 (1.3125) acc_x 62.5000 (66.2500) lr 1.5225e-03 eta 0:00:10
epoch [67/200] batch [20/36] time 0.470 (0.478) data 0.338 (0.347) loss_x loss_x 1.0938 (1.3407) acc_x 68.7500 (65.6250) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [25/36] time 0.494 (0.469) data 0.364 (0.338) loss_x loss_x 1.2471 (1.3150) acc_x 62.5000 (65.7500) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [30/36] time 0.448 (0.470) data 0.317 (0.339) loss_x loss_x 1.5264 (1.3206) acc_x 65.6250 (65.8333) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [35/36] time 0.552 (0.467) data 0.423 (0.336) loss_x loss_x 1.0049 (1.3244) acc_x 68.7500 (65.1786) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.3696, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1159
clean true:1156
clean false:3
clean_rate:0.997411561691113
noisy true:345
noisy false:1632
after delete: len(clean_dataset) 1159
after delete: len(noisy_dataset) 1977
epoch [68/200] batch [5/36] time 0.462 (0.464) data 0.332 (0.334) loss_x loss_x 1.1807 (1.3258) acc_x 65.6250 (63.7500) lr 1.5090e-03 eta 0:00:14
epoch [68/200] batch [10/36] time 0.361 (0.442) data 0.230 (0.311) loss_x loss_x 1.6934 (1.2878) acc_x 59.3750 (67.1875) lr 1.5090e-03 eta 0:00:11
epoch [68/200] batch [15/36] time 0.481 (0.462) data 0.350 (0.332) loss_x loss_x 1.3096 (1.2997) acc_x 62.5000 (66.8750) lr 1.5090e-03 eta 0:00:09
epoch [68/200] batch [20/36] time 0.497 (0.473) data 0.367 (0.342) loss_x loss_x 1.1299 (1.3028) acc_x 68.7500 (66.7188) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [25/36] time 0.482 (0.474) data 0.351 (0.344) loss_x loss_x 1.4219 (1.3031) acc_x 59.3750 (66.6250) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [30/36] time 0.514 (0.478) data 0.383 (0.347) loss_x loss_x 1.4961 (1.3062) acc_x 68.7500 (66.6667) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [35/36] time 0.396 (0.470) data 0.266 (0.339) loss_x loss_x 1.4775 (1.2843) acc_x 71.8750 (67.6786) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1594
confident_label rate tensor(0.3791, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1189
clean true:1188
clean false:1
clean_rate:0.9991589571068125
noisy true:354
noisy false:1593
after delete: len(clean_dataset) 1189
after delete: len(noisy_dataset) 1947
epoch [69/200] batch [5/37] time 0.421 (0.452) data 0.291 (0.321) loss_x loss_x 1.1152 (1.1083) acc_x 62.5000 (71.2500) lr 1.4955e-03 eta 0:00:14
epoch [69/200] batch [10/37] time 0.488 (0.445) data 0.357 (0.315) loss_x loss_x 1.2666 (1.1591) acc_x 75.0000 (71.2500) lr 1.4955e-03 eta 0:00:12
epoch [69/200] batch [15/37] time 0.456 (0.454) data 0.326 (0.324) loss_x loss_x 1.7471 (1.2822) acc_x 65.6250 (68.9583) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [20/37] time 0.329 (0.462) data 0.198 (0.331) loss_x loss_x 1.1602 (1.3287) acc_x 68.7500 (67.8125) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [25/37] time 0.478 (0.455) data 0.348 (0.325) loss_x loss_x 1.2939 (1.3616) acc_x 59.3750 (66.3750) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [30/37] time 0.543 (0.456) data 0.412 (0.325) loss_x loss_x 1.5391 (1.3723) acc_x 50.0000 (65.2083) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [35/37] time 0.580 (0.458) data 0.451 (0.328) loss_x loss_x 1.4395 (1.3701) acc_x 62.5000 (65.0893) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3747, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1175
clean true:1174
clean false:1
clean_rate:0.9991489361702127
noisy true:328
noisy false:1633
after delete: len(clean_dataset) 1175
after delete: len(noisy_dataset) 1961
epoch [70/200] batch [5/36] time 0.495 (0.526) data 0.364 (0.395) loss_x loss_x 1.1855 (1.3609) acc_x 75.0000 (66.8750) lr 1.4818e-03 eta 0:00:16
epoch [70/200] batch [10/36] time 0.429 (0.485) data 0.298 (0.354) loss_x loss_x 1.0205 (1.3667) acc_x 68.7500 (65.9375) lr 1.4818e-03 eta 0:00:12
epoch [70/200] batch [15/36] time 0.502 (0.489) data 0.372 (0.358) loss_x loss_x 0.7515 (1.2778) acc_x 81.2500 (68.1250) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [20/36] time 0.403 (0.468) data 0.272 (0.338) loss_x loss_x 1.1787 (1.3004) acc_x 68.7500 (67.9688) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [25/36] time 0.427 (0.463) data 0.296 (0.332) loss_x loss_x 1.6025 (1.3461) acc_x 53.1250 (65.8750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [30/36] time 0.436 (0.462) data 0.305 (0.331) loss_x loss_x 0.9038 (1.3528) acc_x 84.3750 (65.3125) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [35/36] time 0.367 (0.461) data 0.236 (0.330) loss_x loss_x 1.0039 (1.3317) acc_x 78.1250 (65.4464) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1643
confident_label rate tensor(0.3619, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1135
clean true:1134
clean false:1
clean_rate:0.9991189427312775
noisy true:359
noisy false:1642
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 2001
epoch [71/200] batch [5/35] time 0.414 (0.427) data 0.284 (0.296) loss_x loss_x 1.5469 (1.3059) acc_x 59.3750 (69.3750) lr 1.4679e-03 eta 0:00:12
epoch [71/200] batch [10/35] time 0.518 (0.454) data 0.387 (0.323) loss_x loss_x 1.7139 (1.3310) acc_x 53.1250 (68.4375) lr 1.4679e-03 eta 0:00:11
epoch [71/200] batch [15/35] time 0.398 (0.438) data 0.267 (0.308) loss_x loss_x 1.4932 (1.3128) acc_x 62.5000 (68.3333) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [20/35] time 0.545 (0.438) data 0.414 (0.307) loss_x loss_x 1.3291 (1.2942) acc_x 68.7500 (68.2812) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [25/35] time 0.527 (0.442) data 0.395 (0.311) loss_x loss_x 1.4541 (1.3020) acc_x 59.3750 (67.7500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [30/35] time 0.695 (0.461) data 0.561 (0.330) loss_x loss_x 1.1387 (1.2988) acc_x 68.7500 (67.7083) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [35/35] time 0.413 (0.468) data 0.282 (0.337) loss_x loss_x 1.1377 (1.3153) acc_x 59.3750 (67.3214) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3740, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1173
clean true:1172
clean false:1
clean_rate:0.9991474850809889
noisy true:335
noisy false:1628
after delete: len(clean_dataset) 1173
after delete: len(noisy_dataset) 1963
epoch [72/200] batch [5/36] time 0.358 (0.474) data 0.227 (0.343) loss_x loss_x 1.5293 (1.4516) acc_x 53.1250 (60.0000) lr 1.4540e-03 eta 0:00:14
epoch [72/200] batch [10/36] time 0.446 (0.449) data 0.316 (0.318) loss_x loss_x 1.4785 (1.5314) acc_x 62.5000 (57.8125) lr 1.4540e-03 eta 0:00:11
epoch [72/200] batch [15/36] time 0.514 (0.451) data 0.384 (0.320) loss_x loss_x 1.4150 (1.4860) acc_x 71.8750 (59.5833) lr 1.4540e-03 eta 0:00:09
epoch [72/200] batch [20/36] time 0.374 (0.455) data 0.244 (0.324) loss_x loss_x 1.5859 (1.4383) acc_x 59.3750 (60.4688) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [25/36] time 0.414 (0.459) data 0.284 (0.328) loss_x loss_x 1.1309 (1.3621) acc_x 71.8750 (62.7500) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [30/36] time 0.505 (0.463) data 0.374 (0.332) loss_x loss_x 1.2500 (1.3251) acc_x 68.7500 (64.0625) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [35/36] time 0.495 (0.464) data 0.365 (0.333) loss_x loss_x 1.6426 (1.3180) acc_x 65.6250 (65.0000) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.3820, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1198
clean true:1194
clean false:4
clean_rate:0.996661101836394
noisy true:335
noisy false:1603
after delete: len(clean_dataset) 1198
after delete: len(noisy_dataset) 1938
epoch [73/200] batch [5/37] time 0.414 (0.489) data 0.283 (0.358) loss_x loss_x 1.7637 (1.4320) acc_x 59.3750 (65.6250) lr 1.4399e-03 eta 0:00:15
epoch [73/200] batch [10/37] time 0.454 (0.473) data 0.324 (0.342) loss_x loss_x 0.9927 (1.4265) acc_x 71.8750 (64.0625) lr 1.4399e-03 eta 0:00:12
epoch [73/200] batch [15/37] time 0.465 (0.465) data 0.335 (0.335) loss_x loss_x 1.3604 (1.3837) acc_x 59.3750 (63.9583) lr 1.4399e-03 eta 0:00:10
epoch [73/200] batch [20/37] time 0.382 (0.455) data 0.252 (0.324) loss_x loss_x 1.3848 (1.4161) acc_x 65.6250 (64.3750) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [25/37] time 0.436 (0.456) data 0.306 (0.326) loss_x loss_x 1.2588 (1.4118) acc_x 59.3750 (64.2500) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [30/37] time 0.358 (0.458) data 0.228 (0.327) loss_x loss_x 1.2002 (1.4070) acc_x 78.1250 (64.6875) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [35/37] time 0.425 (0.454) data 0.295 (0.323) loss_x loss_x 1.3203 (1.4110) acc_x 68.7500 (65.4464) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1600
confident_label rate tensor(0.3798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1191
clean true:1187
clean false:4
clean_rate:0.9966414777497901
noisy true:349
noisy false:1596
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 1945
epoch [74/200] batch [5/37] time 0.470 (0.474) data 0.340 (0.344) loss_x loss_x 1.3047 (1.4643) acc_x 71.8750 (65.6250) lr 1.4258e-03 eta 0:00:15
epoch [74/200] batch [10/37] time 0.538 (0.480) data 0.407 (0.350) loss_x loss_x 1.4834 (1.4004) acc_x 62.5000 (64.6875) lr 1.4258e-03 eta 0:00:12
epoch [74/200] batch [15/37] time 0.499 (0.471) data 0.369 (0.340) loss_x loss_x 1.4727 (1.3082) acc_x 68.7500 (66.6667) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [20/37] time 0.385 (0.485) data 0.255 (0.355) loss_x loss_x 1.1719 (1.3167) acc_x 75.0000 (66.7188) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [25/37] time 0.485 (0.477) data 0.354 (0.347) loss_x loss_x 1.4121 (1.3017) acc_x 59.3750 (67.7500) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [30/37] time 0.499 (0.473) data 0.368 (0.343) loss_x loss_x 1.2275 (1.3403) acc_x 78.1250 (67.1875) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [35/37] time 0.471 (0.463) data 0.341 (0.333) loss_x loss_x 1.4834 (1.3368) acc_x 62.5000 (66.7857) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.3753, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1177
clean true:1176
clean false:1
clean_rate:0.9991503823279524
noisy true:327
noisy false:1632
after delete: len(clean_dataset) 1177
after delete: len(noisy_dataset) 1959
epoch [75/200] batch [5/36] time 0.485 (0.452) data 0.354 (0.322) loss_x loss_x 1.3008 (1.1197) acc_x 65.6250 (71.8750) lr 1.4115e-03 eta 0:00:14
epoch [75/200] batch [10/36] time 0.380 (0.474) data 0.249 (0.343) loss_x loss_x 0.9941 (1.2946) acc_x 78.1250 (68.1250) lr 1.4115e-03 eta 0:00:12
epoch [75/200] batch [15/36] time 0.417 (0.469) data 0.286 (0.338) loss_x loss_x 1.3564 (1.2806) acc_x 62.5000 (68.1250) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [20/36] time 0.472 (0.468) data 0.342 (0.337) loss_x loss_x 1.9922 (1.3521) acc_x 53.1250 (66.2500) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [25/36] time 0.470 (0.463) data 0.339 (0.332) loss_x loss_x 1.2256 (1.3504) acc_x 71.8750 (67.0000) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [30/36] time 0.466 (0.456) data 0.335 (0.325) loss_x loss_x 1.2148 (1.3252) acc_x 78.1250 (67.5000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [35/36] time 0.368 (0.456) data 0.237 (0.325) loss_x loss_x 1.1699 (1.3396) acc_x 71.8750 (67.3214) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1588
confident_label rate tensor(0.3827, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1200
clean true:1200
clean false:0
clean_rate:1.0
noisy true:348
noisy false:1588
after delete: len(clean_dataset) 1200
after delete: len(noisy_dataset) 1936
epoch [76/200] batch [5/37] time 0.409 (0.454) data 0.278 (0.323) loss_x loss_x 1.2148 (1.2568) acc_x 68.7500 (66.2500) lr 1.3971e-03 eta 0:00:14
epoch [76/200] batch [10/37] time 0.524 (0.464) data 0.393 (0.333) loss_x loss_x 1.0371 (1.2797) acc_x 71.8750 (66.5625) lr 1.3971e-03 eta 0:00:12
epoch [76/200] batch [15/37] time 0.503 (0.467) data 0.372 (0.336) loss_x loss_x 1.5879 (1.2856) acc_x 62.5000 (68.1250) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [20/37] time 0.467 (0.461) data 0.337 (0.330) loss_x loss_x 1.0498 (1.3012) acc_x 68.7500 (68.2812) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [25/37] time 0.533 (0.464) data 0.402 (0.333) loss_x loss_x 1.0840 (1.2939) acc_x 68.7500 (68.0000) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [30/37] time 0.483 (0.456) data 0.353 (0.325) loss_x loss_x 1.0010 (1.2634) acc_x 71.8750 (68.3333) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [35/37] time 0.505 (0.456) data 0.374 (0.326) loss_x loss_x 1.0518 (1.2761) acc_x 75.0000 (68.0357) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.3779, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1185
clean true:1183
clean false:2
clean_rate:0.9983122362869198
noisy true:314
noisy false:1637
after delete: len(clean_dataset) 1185
after delete: len(noisy_dataset) 1951
epoch [77/200] batch [5/37] time 0.454 (0.433) data 0.324 (0.302) loss_x loss_x 1.2168 (1.1980) acc_x 59.3750 (66.2500) lr 1.3827e-03 eta 0:00:13
epoch [77/200] batch [10/37] time 0.510 (0.486) data 0.379 (0.355) loss_x loss_x 1.2588 (1.1897) acc_x 65.6250 (67.5000) lr 1.3827e-03 eta 0:00:13
epoch [77/200] batch [15/37] time 0.347 (0.471) data 0.217 (0.340) loss_x loss_x 1.7305 (1.2845) acc_x 56.2500 (64.5833) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [20/37] time 0.485 (0.468) data 0.354 (0.337) loss_x loss_x 1.3135 (1.2924) acc_x 62.5000 (65.3125) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [25/37] time 0.408 (0.469) data 0.277 (0.339) loss_x loss_x 1.6318 (1.3298) acc_x 68.7500 (64.8750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [30/37] time 0.414 (0.467) data 0.283 (0.336) loss_x loss_x 1.7334 (1.2884) acc_x 59.3750 (66.2500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [35/37] time 0.397 (0.468) data 0.266 (0.337) loss_x loss_x 0.9248 (1.2664) acc_x 68.7500 (67.0536) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.3658, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1147
clean true:1147
clean false:0
clean_rate:1.0
noisy true:353
noisy false:1636
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 1989
epoch [78/200] batch [5/35] time 0.473 (0.440) data 0.342 (0.309) loss_x loss_x 1.2207 (1.2080) acc_x 68.7500 (72.5000) lr 1.3681e-03 eta 0:00:13
epoch [78/200] batch [10/35] time 0.621 (0.447) data 0.491 (0.316) loss_x loss_x 1.2744 (1.2333) acc_x 65.6250 (67.5000) lr 1.3681e-03 eta 0:00:11
epoch [78/200] batch [15/35] time 0.404 (0.451) data 0.273 (0.320) loss_x loss_x 1.1279 (1.2223) acc_x 78.1250 (68.7500) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [20/35] time 0.427 (0.462) data 0.297 (0.331) loss_x loss_x 1.1924 (1.1846) acc_x 59.3750 (69.8438) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [25/35] time 0.383 (0.456) data 0.252 (0.325) loss_x loss_x 1.6377 (1.1894) acc_x 62.5000 (69.8750) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [30/35] time 0.386 (0.449) data 0.256 (0.318) loss_x loss_x 0.9297 (1.2354) acc_x 84.3750 (69.3750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [35/35] time 0.411 (0.442) data 0.280 (0.311) loss_x loss_x 1.1416 (1.2333) acc_x 65.6250 (69.0179) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1176
clean true:1174
clean false:2
clean_rate:0.9982993197278912
noisy true:329
noisy false:1631
after delete: len(clean_dataset) 1176
after delete: len(noisy_dataset) 1960
epoch [79/200] batch [5/36] time 0.422 (0.442) data 0.291 (0.311) loss_x loss_x 0.6777 (1.4846) acc_x 84.3750 (60.6250) lr 1.3535e-03 eta 0:00:13
epoch [79/200] batch [10/36] time 0.381 (0.459) data 0.251 (0.328) loss_x loss_x 1.5752 (1.3702) acc_x 59.3750 (65.6250) lr 1.3535e-03 eta 0:00:11
epoch [79/200] batch [15/36] time 0.510 (0.482) data 0.378 (0.351) loss_x loss_x 1.2773 (1.3002) acc_x 75.0000 (67.2917) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [20/36] time 0.517 (0.484) data 0.386 (0.353) loss_x loss_x 1.0273 (1.2740) acc_x 71.8750 (67.1875) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [25/36] time 0.452 (0.479) data 0.321 (0.348) loss_x loss_x 1.4521 (1.2773) acc_x 59.3750 (67.3750) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [30/36] time 0.438 (0.472) data 0.308 (0.341) loss_x loss_x 1.3584 (1.2766) acc_x 65.6250 (67.6042) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [35/36] time 0.463 (0.471) data 0.333 (0.340) loss_x loss_x 1.1396 (1.3233) acc_x 71.8750 (66.4286) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3836, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1203
clean true:1201
clean false:2
clean_rate:0.99833748960931
noisy true:332
noisy false:1601
after delete: len(clean_dataset) 1203
after delete: len(noisy_dataset) 1933
epoch [80/200] batch [5/37] time 0.505 (0.490) data 0.375 (0.359) loss_x loss_x 1.8906 (1.3361) acc_x 53.1250 (66.2500) lr 1.3387e-03 eta 0:00:15
epoch [80/200] batch [10/37] time 0.453 (0.457) data 0.322 (0.327) loss_x loss_x 0.9678 (1.2326) acc_x 75.0000 (70.0000) lr 1.3387e-03 eta 0:00:12
epoch [80/200] batch [15/37] time 0.319 (0.445) data 0.188 (0.314) loss_x loss_x 0.9932 (1.2640) acc_x 81.2500 (70.0000) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [20/37] time 0.470 (0.455) data 0.339 (0.324) loss_x loss_x 0.8711 (1.2366) acc_x 75.0000 (70.1562) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [25/37] time 0.412 (0.450) data 0.281 (0.319) loss_x loss_x 1.2441 (1.2301) acc_x 59.3750 (70.0000) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [30/37] time 0.402 (0.444) data 0.271 (0.313) loss_x loss_x 1.5400 (1.2555) acc_x 68.7500 (69.2708) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [35/37] time 0.557 (0.446) data 0.425 (0.316) loss_x loss_x 0.9287 (1.2639) acc_x 75.0000 (68.3036) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.3772, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1183
clean true:1180
clean false:3
clean_rate:0.9974640743871513
noisy true:316
noisy false:1637
after delete: len(clean_dataset) 1183
after delete: len(noisy_dataset) 1953
epoch [81/200] batch [5/36] time 0.347 (0.431) data 0.217 (0.300) loss_x loss_x 1.3369 (1.2449) acc_x 50.0000 (65.0000) lr 1.3239e-03 eta 0:00:13
epoch [81/200] batch [10/36] time 0.397 (0.465) data 0.267 (0.335) loss_x loss_x 2.3555 (1.3597) acc_x 43.7500 (63.7500) lr 1.3239e-03 eta 0:00:12
epoch [81/200] batch [15/36] time 0.364 (0.462) data 0.233 (0.332) loss_x loss_x 1.6611 (1.3829) acc_x 65.6250 (65.6250) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [20/36] time 0.380 (0.452) data 0.249 (0.321) loss_x loss_x 1.3447 (1.3569) acc_x 68.7500 (66.0938) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [25/36] time 0.471 (0.449) data 0.340 (0.318) loss_x loss_x 1.4268 (1.3549) acc_x 71.8750 (65.7500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [30/36] time 0.378 (0.443) data 0.247 (0.312) loss_x loss_x 0.9858 (1.3333) acc_x 75.0000 (66.0417) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [35/36] time 0.622 (0.451) data 0.491 (0.321) loss_x loss_x 1.5078 (1.3470) acc_x 50.0000 (65.9821) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1195
clean true:1193
clean false:2
clean_rate:0.998326359832636
noisy true:336
noisy false:1605
after delete: len(clean_dataset) 1195
after delete: len(noisy_dataset) 1941
epoch [82/200] batch [5/37] time 0.390 (0.469) data 0.259 (0.338) loss_x loss_x 1.2031 (1.5342) acc_x 65.6250 (63.1250) lr 1.3090e-03 eta 0:00:14
epoch [82/200] batch [10/37] time 0.423 (0.457) data 0.293 (0.326) loss_x loss_x 1.3857 (1.4899) acc_x 65.6250 (63.1250) lr 1.3090e-03 eta 0:00:12
epoch [82/200] batch [15/37] time 0.428 (0.454) data 0.298 (0.323) loss_x loss_x 1.3691 (1.4804) acc_x 71.8750 (64.1667) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [20/37] time 0.610 (0.467) data 0.480 (0.336) loss_x loss_x 0.8701 (1.4275) acc_x 71.8750 (64.2188) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [25/37] time 0.457 (0.463) data 0.327 (0.333) loss_x loss_x 1.2070 (1.3630) acc_x 65.6250 (65.8750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [30/37] time 0.436 (0.465) data 0.306 (0.334) loss_x loss_x 0.9575 (1.3357) acc_x 71.8750 (66.1458) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [35/37] time 0.391 (0.459) data 0.260 (0.328) loss_x loss_x 1.4834 (1.3413) acc_x 62.5000 (65.9821) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1550
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1242
clean true:1240
clean false:2
clean_rate:0.998389694041868
noisy true:346
noisy false:1548
after delete: len(clean_dataset) 1242
after delete: len(noisy_dataset) 1894
epoch [83/200] batch [5/38] time 0.446 (0.402) data 0.316 (0.272) loss_x loss_x 1.4893 (1.4475) acc_x 71.8750 (66.2500) lr 1.2940e-03 eta 0:00:13
epoch [83/200] batch [10/38] time 0.397 (0.466) data 0.266 (0.336) loss_x loss_x 1.2891 (1.4116) acc_x 65.6250 (66.2500) lr 1.2940e-03 eta 0:00:13
epoch [83/200] batch [15/38] time 0.526 (0.474) data 0.395 (0.344) loss_x loss_x 1.4678 (1.4244) acc_x 68.7500 (66.0417) lr 1.2940e-03 eta 0:00:10
epoch [83/200] batch [20/38] time 0.390 (0.462) data 0.258 (0.332) loss_x loss_x 0.8721 (1.3766) acc_x 81.2500 (66.4062) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [25/38] time 0.368 (0.463) data 0.238 (0.333) loss_x loss_x 0.5225 (1.3130) acc_x 93.7500 (68.0000) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [30/38] time 0.472 (0.468) data 0.342 (0.337) loss_x loss_x 1.4648 (1.3385) acc_x 59.3750 (67.0833) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [35/38] time 0.652 (0.471) data 0.521 (0.340) loss_x loss_x 1.4219 (1.3759) acc_x 68.7500 (65.3571) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3807, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1194
clean true:1193
clean false:1
clean_rate:0.9991624790619765
noisy true:341
noisy false:1601
after delete: len(clean_dataset) 1194
after delete: len(noisy_dataset) 1942
epoch [84/200] batch [5/37] time 0.588 (0.479) data 0.458 (0.349) loss_x loss_x 1.1641 (1.1977) acc_x 68.7500 (68.1250) lr 1.2790e-03 eta 0:00:15
epoch [84/200] batch [10/37] time 0.480 (0.445) data 0.350 (0.314) loss_x loss_x 1.0117 (1.2651) acc_x 78.1250 (69.0625) lr 1.2790e-03 eta 0:00:12
epoch [84/200] batch [15/37] time 0.425 (0.439) data 0.294 (0.308) loss_x loss_x 0.9766 (1.2530) acc_x 75.0000 (70.2083) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [20/37] time 0.506 (0.452) data 0.375 (0.322) loss_x loss_x 1.6094 (1.3037) acc_x 59.3750 (68.4375) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [25/37] time 0.504 (0.454) data 0.374 (0.324) loss_x loss_x 0.8916 (1.2862) acc_x 75.0000 (68.5000) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [30/37] time 0.415 (0.462) data 0.285 (0.332) loss_x loss_x 1.5010 (1.2777) acc_x 75.0000 (68.7500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [35/37] time 0.576 (0.468) data 0.446 (0.338) loss_x loss_x 1.7168 (1.2932) acc_x 65.6250 (67.9464) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1589
confident_label rate tensor(0.3833, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1202
clean true:1200
clean false:2
clean_rate:0.9983361064891847
noisy true:347
noisy false:1587
after delete: len(clean_dataset) 1202
after delete: len(noisy_dataset) 1934
epoch [85/200] batch [5/37] time 0.395 (0.434) data 0.265 (0.304) loss_x loss_x 1.4453 (1.2140) acc_x 62.5000 (69.3750) lr 1.2639e-03 eta 0:00:13
epoch [85/200] batch [10/37] time 0.347 (0.434) data 0.217 (0.304) loss_x loss_x 1.7705 (1.2630) acc_x 56.2500 (66.2500) lr 1.2639e-03 eta 0:00:11
epoch [85/200] batch [15/37] time 0.447 (0.446) data 0.317 (0.316) loss_x loss_x 1.4863 (1.2218) acc_x 53.1250 (66.6667) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [20/37] time 0.409 (0.454) data 0.279 (0.324) loss_x loss_x 1.4258 (1.2172) acc_x 68.7500 (66.5625) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [25/37] time 0.379 (0.463) data 0.249 (0.332) loss_x loss_x 1.3799 (1.2839) acc_x 65.6250 (65.6250) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [30/37] time 0.552 (0.461) data 0.422 (0.331) loss_x loss_x 1.4971 (1.3039) acc_x 62.5000 (65.0000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [35/37] time 0.445 (0.459) data 0.314 (0.328) loss_x loss_x 1.6924 (1.3491) acc_x 62.5000 (64.7321) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1601
confident_label rate tensor(0.3836, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1203
clean true:1197
clean false:6
clean_rate:0.9950124688279302
noisy true:338
noisy false:1595
after delete: len(clean_dataset) 1203
after delete: len(noisy_dataset) 1933
epoch [86/200] batch [5/37] time 0.483 (0.472) data 0.353 (0.342) loss_x loss_x 1.5410 (1.4082) acc_x 62.5000 (65.0000) lr 1.2487e-03 eta 0:00:15
epoch [86/200] batch [10/37] time 0.417 (0.450) data 0.287 (0.319) loss_x loss_x 1.0088 (1.3462) acc_x 68.7500 (64.6875) lr 1.2487e-03 eta 0:00:12
epoch [86/200] batch [15/37] time 0.604 (0.465) data 0.473 (0.334) loss_x loss_x 0.8960 (1.3063) acc_x 75.0000 (65.8333) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [20/37] time 0.420 (0.451) data 0.290 (0.321) loss_x loss_x 1.5801 (1.2876) acc_x 68.7500 (67.3438) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [25/37] time 0.415 (0.449) data 0.284 (0.318) loss_x loss_x 0.9922 (1.2834) acc_x 75.0000 (67.1250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [30/37] time 0.522 (0.461) data 0.391 (0.330) loss_x loss_x 0.8120 (1.2726) acc_x 78.1250 (67.7083) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [35/37] time 0.395 (0.455) data 0.264 (0.325) loss_x loss_x 0.9351 (1.2617) acc_x 71.8750 (67.7679) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1182
clean true:1179
clean false:3
clean_rate:0.9974619289340102
noisy true:367
noisy false:1587
after delete: len(clean_dataset) 1182
after delete: len(noisy_dataset) 1954
epoch [87/200] batch [5/36] time 0.416 (0.455) data 0.284 (0.324) loss_x loss_x 1.1611 (1.3859) acc_x 65.6250 (65.6250) lr 1.2334e-03 eta 0:00:14
epoch [87/200] batch [10/36] time 0.399 (0.441) data 0.267 (0.310) loss_x loss_x 1.2705 (1.3414) acc_x 53.1250 (64.0625) lr 1.2334e-03 eta 0:00:11
epoch [87/200] batch [15/36] time 0.549 (0.463) data 0.418 (0.332) loss_x loss_x 1.0107 (1.3261) acc_x 65.6250 (64.5833) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [20/36] time 0.359 (0.456) data 0.229 (0.325) loss_x loss_x 0.9609 (1.3038) acc_x 68.7500 (65.4688) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [25/36] time 0.422 (0.451) data 0.290 (0.320) loss_x loss_x 0.9570 (1.3268) acc_x 75.0000 (65.0000) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [30/36] time 0.458 (0.450) data 0.327 (0.319) loss_x loss_x 1.1299 (1.2995) acc_x 62.5000 (65.7292) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [35/36] time 0.410 (0.450) data 0.280 (0.320) loss_x loss_x 1.0576 (1.3062) acc_x 71.8750 (65.8036) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1556
confident_label rate tensor(0.3890, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1220
clean true:1219
clean false:1
clean_rate:0.9991803278688525
noisy true:361
noisy false:1555
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 1916
epoch [88/200] batch [5/38] time 0.423 (0.403) data 0.293 (0.273) loss_x loss_x 1.7734 (1.2802) acc_x 62.5000 (68.7500) lr 1.2181e-03 eta 0:00:13
epoch [88/200] batch [10/38] time 0.434 (0.429) data 0.303 (0.298) loss_x loss_x 1.6328 (1.3534) acc_x 56.2500 (65.9375) lr 1.2181e-03 eta 0:00:12
epoch [88/200] batch [15/38] time 0.568 (0.449) data 0.438 (0.318) loss_x loss_x 1.0352 (1.2551) acc_x 75.0000 (68.5417) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [20/38] time 0.468 (0.468) data 0.337 (0.337) loss_x loss_x 1.5986 (1.2785) acc_x 62.5000 (68.1250) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [25/38] time 0.469 (0.467) data 0.339 (0.336) loss_x loss_x 1.4189 (1.3091) acc_x 59.3750 (66.8750) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [30/38] time 0.414 (0.463) data 0.283 (0.332) loss_x loss_x 1.3848 (1.3235) acc_x 68.7500 (66.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [35/38] time 0.511 (0.466) data 0.381 (0.336) loss_x loss_x 0.8599 (1.2996) acc_x 78.1250 (67.4107) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1579
confident_label rate tensor(0.3865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1212
clean true:1210
clean false:2
clean_rate:0.9983498349834984
noisy true:347
noisy false:1577
after delete: len(clean_dataset) 1212
after delete: len(noisy_dataset) 1924
epoch [89/200] batch [5/37] time 0.414 (0.441) data 0.283 (0.310) loss_x loss_x 1.3555 (1.4977) acc_x 65.6250 (65.6250) lr 1.2028e-03 eta 0:00:14
epoch [89/200] batch [10/37] time 0.400 (0.453) data 0.269 (0.322) loss_x loss_x 0.8799 (1.2767) acc_x 78.1250 (70.0000) lr 1.2028e-03 eta 0:00:12
epoch [89/200] batch [15/37] time 0.548 (0.460) data 0.418 (0.329) loss_x loss_x 1.5391 (1.2961) acc_x 65.6250 (69.3750) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [20/37] time 0.385 (0.468) data 0.254 (0.337) loss_x loss_x 1.6035 (1.3262) acc_x 50.0000 (67.5000) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [25/37] time 0.481 (0.468) data 0.351 (0.337) loss_x loss_x 1.0674 (1.3409) acc_x 71.8750 (67.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [30/37] time 0.520 (0.469) data 0.390 (0.338) loss_x loss_x 1.9199 (1.3549) acc_x 46.8750 (66.6667) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [35/37] time 0.451 (0.462) data 0.321 (0.332) loss_x loss_x 1.4434 (1.3574) acc_x 53.1250 (66.1607) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.3858, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1210
clean true:1207
clean false:3
clean_rate:0.9975206611570248
noisy true:339
noisy false:1587
after delete: len(clean_dataset) 1210
after delete: len(noisy_dataset) 1926
epoch [90/200] batch [5/37] time 0.371 (0.421) data 0.240 (0.290) loss_x loss_x 1.0811 (1.4073) acc_x 71.8750 (65.6250) lr 1.1874e-03 eta 0:00:13
epoch [90/200] batch [10/37] time 0.419 (0.433) data 0.286 (0.302) loss_x loss_x 1.0811 (1.2442) acc_x 71.8750 (69.0625) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [15/37] time 0.420 (0.438) data 0.290 (0.307) loss_x loss_x 1.2021 (1.2783) acc_x 62.5000 (66.0417) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [20/37] time 0.514 (0.450) data 0.383 (0.319) loss_x loss_x 1.0918 (1.2941) acc_x 68.7500 (65.9375) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [25/37] time 0.470 (0.452) data 0.338 (0.321) loss_x loss_x 1.4688 (1.2950) acc_x 68.7500 (66.7500) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [30/37] time 0.437 (0.464) data 0.306 (0.333) loss_x loss_x 2.0352 (1.3113) acc_x 53.1250 (66.6667) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [35/37] time 0.504 (0.462) data 0.373 (0.331) loss_x loss_x 1.1045 (1.3017) acc_x 71.8750 (66.6964) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.3814, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1196
clean true:1195
clean false:1
clean_rate:0.9991638795986622
noisy true:334
noisy false:1606
after delete: len(clean_dataset) 1196
after delete: len(noisy_dataset) 1940
epoch [91/200] batch [5/37] time 0.508 (0.458) data 0.377 (0.327) loss_x loss_x 0.9414 (1.1977) acc_x 62.5000 (70.0000) lr 1.1719e-03 eta 0:00:14
epoch [91/200] batch [10/37] time 0.422 (0.456) data 0.291 (0.325) loss_x loss_x 1.2207 (1.1558) acc_x 68.7500 (70.9375) lr 1.1719e-03 eta 0:00:12
epoch [91/200] batch [15/37] time 0.456 (0.461) data 0.325 (0.330) loss_x loss_x 1.3359 (1.1577) acc_x 59.3750 (69.5833) lr 1.1719e-03 eta 0:00:10
epoch [91/200] batch [20/37] time 0.429 (0.458) data 0.298 (0.327) loss_x loss_x 1.1611 (1.1399) acc_x 59.3750 (68.9062) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [25/37] time 0.503 (0.458) data 0.372 (0.327) loss_x loss_x 0.8765 (1.1674) acc_x 75.0000 (68.1250) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [30/37] time 0.565 (0.457) data 0.434 (0.326) loss_x loss_x 1.1719 (1.1758) acc_x 68.7500 (67.5000) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [35/37] time 0.419 (0.461) data 0.289 (0.330) loss_x loss_x 1.3232 (1.1758) acc_x 71.8750 (68.0357) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1562
confident_label rate tensor(0.3932, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1233
clean true:1231
clean false:2
clean_rate:0.9983779399837794
noisy true:343
noisy false:1560
after delete: len(clean_dataset) 1233
after delete: len(noisy_dataset) 1903
epoch [92/200] batch [5/38] time 0.364 (0.481) data 0.233 (0.350) loss_x loss_x 1.2793 (1.2416) acc_x 75.0000 (71.8750) lr 1.1564e-03 eta 0:00:15
epoch [92/200] batch [10/38] time 0.421 (0.487) data 0.290 (0.356) loss_x loss_x 1.2832 (1.1788) acc_x 71.8750 (70.9375) lr 1.1564e-03 eta 0:00:13
epoch [92/200] batch [15/38] time 0.551 (0.478) data 0.421 (0.347) loss_x loss_x 1.4697 (1.2843) acc_x 68.7500 (67.7083) lr 1.1564e-03 eta 0:00:10
epoch [92/200] batch [20/38] time 0.414 (0.470) data 0.283 (0.339) loss_x loss_x 1.1621 (1.2889) acc_x 71.8750 (67.9688) lr 1.1564e-03 eta 0:00:08
epoch [92/200] batch [25/38] time 0.447 (0.476) data 0.316 (0.345) loss_x loss_x 1.1748 (1.2825) acc_x 68.7500 (68.0000) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [30/38] time 0.476 (0.471) data 0.346 (0.340) loss_x loss_x 1.2412 (1.2804) acc_x 62.5000 (67.6042) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [35/38] time 0.569 (0.475) data 0.439 (0.344) loss_x loss_x 0.8442 (1.2609) acc_x 78.1250 (68.0357) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1572
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1246
clean true:1246
clean false:0
clean_rate:1.0
noisy true:318
noisy false:1572
after delete: len(clean_dataset) 1246
after delete: len(noisy_dataset) 1890
epoch [93/200] batch [5/38] time 0.514 (0.490) data 0.382 (0.359) loss_x loss_x 1.3564 (1.6391) acc_x 65.6250 (59.3750) lr 1.1409e-03 eta 0:00:16
epoch [93/200] batch [10/38] time 0.322 (0.458) data 0.189 (0.327) loss_x loss_x 1.3096 (1.3756) acc_x 75.0000 (66.8750) lr 1.1409e-03 eta 0:00:12
epoch [93/200] batch [15/38] time 0.485 (0.443) data 0.355 (0.312) loss_x loss_x 1.1074 (1.3162) acc_x 68.7500 (68.3333) lr 1.1409e-03 eta 0:00:10
epoch [93/200] batch [20/38] time 0.388 (0.440) data 0.257 (0.309) loss_x loss_x 1.0957 (1.3652) acc_x 75.0000 (66.7188) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [25/38] time 0.411 (0.440) data 0.280 (0.310) loss_x loss_x 1.9541 (1.3817) acc_x 50.0000 (65.7500) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [30/38] time 0.562 (0.444) data 0.432 (0.314) loss_x loss_x 1.6191 (1.3687) acc_x 59.3750 (65.8333) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [35/38] time 0.344 (0.443) data 0.212 (0.312) loss_x loss_x 0.9180 (1.3294) acc_x 68.7500 (66.6071) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1597
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1174
clean true:1170
clean false:4
clean_rate:0.9965928449744463
noisy true:369
noisy false:1593
after delete: len(clean_dataset) 1174
after delete: len(noisy_dataset) 1962
epoch [94/200] batch [5/36] time 0.406 (0.435) data 0.276 (0.304) loss_x loss_x 1.1094 (1.2518) acc_x 65.6250 (68.1250) lr 1.1253e-03 eta 0:00:13
epoch [94/200] batch [10/36] time 0.471 (0.435) data 0.340 (0.305) loss_x loss_x 1.4678 (1.2287) acc_x 65.6250 (66.8750) lr 1.1253e-03 eta 0:00:11
epoch [94/200] batch [15/36] time 0.395 (0.429) data 0.266 (0.299) loss_x loss_x 1.6846 (1.1841) acc_x 59.3750 (67.7083) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [20/36] time 0.474 (0.447) data 0.343 (0.317) loss_x loss_x 1.1865 (1.1842) acc_x 59.3750 (68.4375) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [25/36] time 0.414 (0.442) data 0.282 (0.311) loss_x loss_x 1.2158 (1.2151) acc_x 65.6250 (68.2500) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [30/36] time 0.495 (0.450) data 0.364 (0.319) loss_x loss_x 0.9683 (1.2253) acc_x 81.2500 (67.8125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [35/36] time 0.443 (0.457) data 0.312 (0.326) loss_x loss_x 1.2568 (1.2387) acc_x 71.8750 (67.7679) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.3941, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1236
clean true:1234
clean false:2
clean_rate:0.9983818770226537
noisy true:353
noisy false:1547
after delete: len(clean_dataset) 1236
after delete: len(noisy_dataset) 1900
epoch [95/200] batch [5/38] time 0.510 (0.473) data 0.379 (0.343) loss_x loss_x 1.4385 (1.3506) acc_x 62.5000 (64.3750) lr 1.1097e-03 eta 0:00:15
epoch [95/200] batch [10/38] time 0.472 (0.489) data 0.342 (0.358) loss_x loss_x 0.8301 (1.3616) acc_x 75.0000 (64.6875) lr 1.1097e-03 eta 0:00:13
epoch [95/200] batch [15/38] time 0.491 (0.477) data 0.360 (0.347) loss_x loss_x 1.0859 (1.2644) acc_x 68.7500 (66.8750) lr 1.1097e-03 eta 0:00:10
epoch [95/200] batch [20/38] time 0.463 (0.463) data 0.332 (0.332) loss_x loss_x 1.1777 (1.2919) acc_x 68.7500 (66.2500) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [25/38] time 0.414 (0.458) data 0.284 (0.327) loss_x loss_x 1.4053 (1.2952) acc_x 56.2500 (65.6250) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [30/38] time 0.488 (0.459) data 0.357 (0.328) loss_x loss_x 1.1348 (1.2883) acc_x 65.6250 (66.5625) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [35/38] time 0.398 (0.464) data 0.268 (0.334) loss_x loss_x 0.9028 (1.2537) acc_x 75.0000 (67.6786) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1561
confident_label rate tensor(0.3941, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1236
clean true:1234
clean false:2
clean_rate:0.9983818770226537
noisy true:341
noisy false:1559
after delete: len(clean_dataset) 1236
after delete: len(noisy_dataset) 1900
epoch [96/200] batch [5/38] time 0.519 (0.448) data 0.389 (0.317) loss_x loss_x 1.2607 (1.4438) acc_x 68.7500 (63.7500) lr 1.0941e-03 eta 0:00:14
epoch [96/200] batch [10/38] time 0.477 (0.456) data 0.347 (0.326) loss_x loss_x 0.8027 (1.3856) acc_x 78.1250 (62.1875) lr 1.0941e-03 eta 0:00:12
epoch [96/200] batch [15/38] time 0.548 (0.448) data 0.417 (0.318) loss_x loss_x 1.5615 (1.3725) acc_x 65.6250 (63.7500) lr 1.0941e-03 eta 0:00:10
epoch [96/200] batch [20/38] time 0.451 (0.447) data 0.320 (0.317) loss_x loss_x 1.4727 (1.3762) acc_x 59.3750 (63.9062) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [25/38] time 0.471 (0.458) data 0.341 (0.327) loss_x loss_x 1.5898 (1.3425) acc_x 65.6250 (65.3750) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [30/38] time 0.606 (0.456) data 0.475 (0.325) loss_x loss_x 1.0166 (1.3409) acc_x 71.8750 (64.4792) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [35/38] time 0.447 (0.457) data 0.317 (0.327) loss_x loss_x 1.0850 (1.3064) acc_x 78.1250 (65.4464) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1601
confident_label rate tensor(0.3839, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1204
clean true:1202
clean false:2
clean_rate:0.9983388704318937
noisy true:333
noisy false:1599
after delete: len(clean_dataset) 1204
after delete: len(noisy_dataset) 1932
epoch [97/200] batch [5/37] time 0.467 (0.479) data 0.335 (0.349) loss_x loss_x 0.9766 (1.4549) acc_x 71.8750 (68.1250) lr 1.0785e-03 eta 0:00:15
epoch [97/200] batch [10/37] time 0.557 (0.461) data 0.426 (0.330) loss_x loss_x 1.1074 (1.3196) acc_x 68.7500 (69.0625) lr 1.0785e-03 eta 0:00:12
epoch [97/200] batch [15/37] time 0.426 (0.464) data 0.295 (0.333) loss_x loss_x 1.4219 (1.2842) acc_x 59.3750 (68.7500) lr 1.0785e-03 eta 0:00:10
epoch [97/200] batch [20/37] time 0.459 (0.461) data 0.329 (0.330) loss_x loss_x 1.7676 (1.3211) acc_x 56.2500 (66.8750) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [25/37] time 0.517 (0.458) data 0.386 (0.327) loss_x loss_x 1.5928 (1.3701) acc_x 56.2500 (65.5000) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [30/37] time 0.520 (0.458) data 0.389 (0.327) loss_x loss_x 1.1543 (1.3644) acc_x 75.0000 (65.3125) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [35/37] time 0.575 (0.462) data 0.444 (0.331) loss_x loss_x 1.1582 (1.3500) acc_x 78.1250 (65.9821) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.3941, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1236
clean true:1235
clean false:1
clean_rate:0.9991909385113269
noisy true:346
noisy false:1554
after delete: len(clean_dataset) 1236
after delete: len(noisy_dataset) 1900
epoch [98/200] batch [5/38] time 0.416 (0.479) data 0.284 (0.348) loss_x loss_x 0.9775 (1.4645) acc_x 75.0000 (62.5000) lr 1.0628e-03 eta 0:00:15
epoch [98/200] batch [10/38] time 0.409 (0.468) data 0.278 (0.336) loss_x loss_x 1.1807 (1.3942) acc_x 68.7500 (64.0625) lr 1.0628e-03 eta 0:00:13
epoch [98/200] batch [15/38] time 0.468 (0.458) data 0.336 (0.326) loss_x loss_x 1.7070 (1.3615) acc_x 59.3750 (65.8333) lr 1.0628e-03 eta 0:00:10
epoch [98/200] batch [20/38] time 0.528 (0.460) data 0.397 (0.329) loss_x loss_x 1.5273 (1.4067) acc_x 59.3750 (65.1562) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [25/38] time 0.453 (0.478) data 0.322 (0.347) loss_x loss_x 1.8994 (1.4383) acc_x 59.3750 (64.6250) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [30/38] time 0.537 (0.485) data 0.406 (0.354) loss_x loss_x 1.3193 (1.4321) acc_x 62.5000 (64.6875) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [35/38] time 0.512 (0.487) data 0.382 (0.356) loss_x loss_x 1.1357 (1.4118) acc_x 75.0000 (65.0893) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1593
confident_label rate tensor(0.3878, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1216
clean true:1213
clean false:3
clean_rate:0.9975328947368421
noisy true:330
noisy false:1590
after delete: len(clean_dataset) 1216
after delete: len(noisy_dataset) 1920
epoch [99/200] batch [5/38] time 0.511 (0.458) data 0.381 (0.327) loss_x loss_x 0.8589 (1.2354) acc_x 75.0000 (68.1250) lr 1.0471e-03 eta 0:00:15
epoch [99/200] batch [10/38] time 0.437 (0.459) data 0.307 (0.329) loss_x loss_x 1.0742 (1.2537) acc_x 78.1250 (68.1250) lr 1.0471e-03 eta 0:00:12
epoch [99/200] batch [15/38] time 0.435 (0.465) data 0.304 (0.335) loss_x loss_x 1.1338 (1.2752) acc_x 71.8750 (67.2917) lr 1.0471e-03 eta 0:00:10
epoch [99/200] batch [20/38] time 0.385 (0.471) data 0.255 (0.341) loss_x loss_x 0.8389 (1.2244) acc_x 81.2500 (69.3750) lr 1.0471e-03 eta 0:00:08
epoch [99/200] batch [25/38] time 0.490 (0.473) data 0.360 (0.343) loss_x loss_x 1.6045 (1.2684) acc_x 62.5000 (68.1250) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [30/38] time 0.581 (0.470) data 0.451 (0.340) loss_x loss_x 1.6172 (1.2617) acc_x 59.3750 (68.6458) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [35/38] time 0.499 (0.471) data 0.369 (0.340) loss_x loss_x 1.4189 (1.2595) acc_x 65.6250 (68.5714) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1556
confident_label rate tensor(0.3922, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1230
clean true:1228
clean false:2
clean_rate:0.9983739837398374
noisy true:352
noisy false:1554
all clean rate:  [0.9976744186046511, 0.9897610921501706, 0.9966405375139977, 0.9957401490947817, 1.0, 0.9968085106382979, 0.995656894679696, 0.997020854021847, 0.996993987975952, 0.9970384995064165, 0.996031746031746, 1.0, 0.9990157480314961, 0.9951550387596899, 0.9980276134122288, 1.0, 0.9961685823754789, 0.9980334316617503, 0.9951409135082604, 0.9990512333965844, 0.997093023255814, 0.9980314960629921, 0.9980806142034548, 0.99812382739212, 0.9952963311382879, 0.998109640831758, 0.9982094897045658, 0.9962859795728877, 0.9990680335507922, 0.9990610328638497, 0.9981167608286252, 0.9981060606060606, 1.0, 0.998193315266486, 0.998158379373849, 0.9990909090909091, 0.9963963963963964, 0.9981735159817352, 1.0, 0.9973333333333333, 0.998220640569395, 0.9981834695731153, 0.999129677980853, 0.9991031390134529, 0.9991071428571429, 0.9982532751091703, 1.0, 0.9973821989528796, 0.9982517482517482, 0.9964476021314387, 0.995579133510168, 1.0, 0.9991364421416234, 0.9973913043478261, 0.9983136593591906, 0.9982758620689656, 1.0, 0.9982668977469671, 0.9974424552429667, 0.999128160418483, 0.9982142857142857, 1.0, 0.9991489361702127, 0.9974511469838573, 0.998272884283247, 0.998320738874895, 1.0, 0.997411561691113, 0.9991589571068125, 0.9991489361702127, 0.9991189427312775, 0.9991474850809889, 0.996661101836394, 0.9966414777497901, 0.9991503823279524, 1.0, 0.9983122362869198, 1.0, 0.9982993197278912, 0.99833748960931, 0.9974640743871513, 0.998326359832636, 0.998389694041868, 0.9991624790619765, 0.9983361064891847, 0.9950124688279302, 0.9974619289340102, 0.9991803278688525, 0.9983498349834984, 0.9975206611570248, 0.9991638795986622, 0.9983779399837794, 1.0, 0.9965928449744463, 0.9983818770226537, 0.9983818770226537, 0.9983388704318937, 0.9991909385113269, 0.9975328947368421, 0.9983739837398374]
after delete: len(clean_dataset) 1230
after delete: len(noisy_dataset) 1906
epoch [100/200] batch [5/38] time 0.442 (0.455) data 0.311 (0.324) loss_x loss_x 1.3604 (1.1303) acc_x 65.6250 (73.7500) lr 1.0314e-03 eta 0:00:15
epoch [100/200] batch [10/38] time 0.447 (0.458) data 0.317 (0.327) loss_x loss_x 1.4658 (1.2127) acc_x 59.3750 (69.3750) lr 1.0314e-03 eta 0:00:12
epoch [100/200] batch [15/38] time 0.396 (0.452) data 0.265 (0.321) loss_x loss_x 1.0107 (1.2644) acc_x 71.8750 (68.9583) lr 1.0314e-03 eta 0:00:10
epoch [100/200] batch [20/38] time 0.380 (0.440) data 0.250 (0.310) loss_x loss_x 1.4736 (1.3374) acc_x 62.5000 (67.0312) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [25/38] time 0.520 (0.452) data 0.390 (0.322) loss_x loss_x 1.5391 (1.3604) acc_x 62.5000 (66.1250) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [30/38] time 0.537 (0.455) data 0.407 (0.324) loss_x loss_x 1.0889 (1.3626) acc_x 65.6250 (65.6250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [35/38] time 0.440 (0.458) data 0.310 (0.328) loss_x loss_x 1.4141 (1.3572) acc_x 62.5000 (65.5357) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1207
clean true:1201
clean false:6
clean_rate:0.9950289975144988
noisy true:333
noisy false:1596
after delete: len(clean_dataset) 1207
after delete: len(noisy_dataset) 1929
epoch [101/200] batch [5/37] time 0.394 (0.436) data 0.264 (0.306) loss_x loss_x 1.3975 (1.3602) acc_x 65.6250 (66.2500) lr 1.0157e-03 eta 0:00:13
epoch [101/200] batch [10/37] time 0.607 (0.456) data 0.477 (0.326) loss_x loss_x 0.6597 (1.2855) acc_x 84.3750 (69.0625) lr 1.0157e-03 eta 0:00:12
epoch [101/200] batch [15/37] time 0.489 (0.455) data 0.358 (0.324) loss_x loss_x 2.1465 (1.4228) acc_x 56.2500 (65.2083) lr 1.0157e-03 eta 0:00:10
epoch [101/200] batch [20/37] time 0.440 (0.462) data 0.309 (0.332) loss_x loss_x 1.7090 (1.3875) acc_x 62.5000 (65.6250) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [25/37] time 0.527 (0.466) data 0.397 (0.335) loss_x loss_x 1.4043 (1.3880) acc_x 56.2500 (64.3750) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [30/37] time 0.417 (0.463) data 0.287 (0.332) loss_x loss_x 1.0205 (1.3442) acc_x 71.8750 (65.6250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [35/37] time 0.607 (0.461) data 0.477 (0.331) loss_x loss_x 1.2334 (1.3397) acc_x 68.7500 (65.5357) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1572
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1209
clean true:1208
clean false:1
clean_rate:0.9991728701406121
noisy true:356
noisy false:1571
after delete: len(clean_dataset) 1209
after delete: len(noisy_dataset) 1927
epoch [102/200] batch [5/37] time 0.373 (0.427) data 0.243 (0.296) loss_x loss_x 0.7271 (1.3554) acc_x 84.3750 (72.5000) lr 1.0000e-03 eta 0:00:13
epoch [102/200] batch [10/37] time 0.532 (0.453) data 0.402 (0.323) loss_x loss_x 1.6670 (1.3212) acc_x 62.5000 (71.2500) lr 1.0000e-03 eta 0:00:12
epoch [102/200] batch [15/37] time 0.467 (0.452) data 0.336 (0.321) loss_x loss_x 1.1182 (1.3129) acc_x 78.1250 (70.6250) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [20/37] time 0.406 (0.449) data 0.275 (0.318) loss_x loss_x 1.3535 (1.3076) acc_x 62.5000 (68.5938) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [25/37] time 0.489 (0.455) data 0.359 (0.324) loss_x loss_x 1.2168 (1.2955) acc_x 65.6250 (68.2500) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [30/37] time 0.397 (0.458) data 0.266 (0.327) loss_x loss_x 1.3379 (1.2804) acc_x 68.7500 (68.0208) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [35/37] time 0.535 (0.459) data 0.405 (0.329) loss_x loss_x 1.4482 (1.2945) acc_x 75.0000 (67.5893) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1559
confident_label rate tensor(0.3929, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1232
clean true:1229
clean false:3
clean_rate:0.997564935064935
noisy true:348
noisy false:1556
after delete: len(clean_dataset) 1232
after delete: len(noisy_dataset) 1904
epoch [103/200] batch [5/38] time 0.469 (0.447) data 0.338 (0.316) loss_x loss_x 1.4717 (1.2382) acc_x 71.8750 (71.2500) lr 9.8429e-04 eta 0:00:14
epoch [103/200] batch [10/38] time 0.426 (0.439) data 0.295 (0.307) loss_x loss_x 1.5020 (1.3167) acc_x 59.3750 (68.4375) lr 9.8429e-04 eta 0:00:12
epoch [103/200] batch [15/38] time 0.381 (0.452) data 0.251 (0.321) loss_x loss_x 1.4102 (1.3235) acc_x 62.5000 (67.0833) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [20/38] time 0.468 (0.453) data 0.338 (0.323) loss_x loss_x 1.4609 (1.3235) acc_x 59.3750 (66.7188) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [25/38] time 0.503 (0.457) data 0.372 (0.327) loss_x loss_x 0.7983 (1.3279) acc_x 78.1250 (67.0000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [30/38] time 0.614 (0.466) data 0.483 (0.335) loss_x loss_x 1.0801 (1.3455) acc_x 75.0000 (66.1458) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [35/38] time 0.505 (0.467) data 0.374 (0.337) loss_x loss_x 1.0850 (1.3420) acc_x 65.6250 (65.8929) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.3999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1254
clean true:1251
clean false:3
clean_rate:0.9976076555023924
noisy true:342
noisy false:1540
after delete: len(clean_dataset) 1254
after delete: len(noisy_dataset) 1882
epoch [104/200] batch [5/39] time 0.422 (0.423) data 0.292 (0.292) loss_x loss_x 1.8145 (1.3407) acc_x 53.1250 (67.5000) lr 9.6859e-04 eta 0:00:14
epoch [104/200] batch [10/39] time 0.403 (0.424) data 0.272 (0.292) loss_x loss_x 1.2188 (1.2189) acc_x 59.3750 (67.5000) lr 9.6859e-04 eta 0:00:12
epoch [104/200] batch [15/39] time 0.422 (0.435) data 0.291 (0.304) loss_x loss_x 1.3223 (1.3296) acc_x 68.7500 (66.8750) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [20/39] time 0.502 (0.444) data 0.370 (0.313) loss_x loss_x 0.6631 (1.2538) acc_x 78.1250 (68.2812) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [25/39] time 0.486 (0.451) data 0.355 (0.320) loss_x loss_x 1.2607 (1.2436) acc_x 56.2500 (68.0000) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [30/39] time 0.361 (0.454) data 0.231 (0.323) loss_x loss_x 1.3330 (1.2517) acc_x 65.6250 (68.0208) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [35/39] time 0.412 (0.450) data 0.282 (0.319) loss_x loss_x 1.4424 (1.2594) acc_x 68.7500 (67.3214) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1544
confident_label rate tensor(0.3909, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1226
clean true:1226
clean false:0
clean_rate:1.0
noisy true:366
noisy false:1544
after delete: len(clean_dataset) 1226
after delete: len(noisy_dataset) 1910
epoch [105/200] batch [5/38] time 0.429 (0.466) data 0.299 (0.335) loss_x loss_x 1.1562 (1.3926) acc_x 71.8750 (66.8750) lr 9.5289e-04 eta 0:00:15
epoch [105/200] batch [10/38] time 0.439 (0.454) data 0.308 (0.323) loss_x loss_x 0.9482 (1.2493) acc_x 78.1250 (70.6250) lr 9.5289e-04 eta 0:00:12
epoch [105/200] batch [15/38] time 0.450 (0.462) data 0.320 (0.331) loss_x loss_x 1.5068 (1.2775) acc_x 59.3750 (68.5417) lr 9.5289e-04 eta 0:00:10
epoch [105/200] batch [20/38] time 0.532 (0.467) data 0.402 (0.336) loss_x loss_x 1.1377 (1.3172) acc_x 75.0000 (67.8125) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [25/38] time 0.446 (0.464) data 0.316 (0.333) loss_x loss_x 1.4326 (1.3161) acc_x 62.5000 (67.7500) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [30/38] time 0.560 (0.469) data 0.429 (0.339) loss_x loss_x 1.0127 (1.3038) acc_x 81.2500 (67.9167) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [35/38] time 0.475 (0.468) data 0.345 (0.337) loss_x loss_x 1.2539 (1.3089) acc_x 62.5000 (67.2321) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1240
clean true:1238
clean false:2
clean_rate:0.9983870967741936
noisy true:340
noisy false:1556
after delete: len(clean_dataset) 1240
after delete: len(noisy_dataset) 1896
epoch [106/200] batch [5/38] time 0.466 (0.444) data 0.336 (0.313) loss_x loss_x 1.0469 (1.1812) acc_x 78.1250 (71.8750) lr 9.3721e-04 eta 0:00:14
epoch [106/200] batch [10/38] time 0.577 (0.459) data 0.447 (0.328) loss_x loss_x 0.9448 (1.2391) acc_x 62.5000 (69.0625) lr 9.3721e-04 eta 0:00:12
epoch [106/200] batch [15/38] time 0.487 (0.468) data 0.356 (0.337) loss_x loss_x 1.2754 (1.2565) acc_x 65.6250 (67.7083) lr 9.3721e-04 eta 0:00:10
epoch [106/200] batch [20/38] time 0.450 (0.466) data 0.319 (0.336) loss_x loss_x 1.4502 (1.2708) acc_x 65.6250 (68.1250) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [25/38] time 0.507 (0.464) data 0.377 (0.334) loss_x loss_x 1.1113 (1.2626) acc_x 68.7500 (68.3750) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [30/38] time 0.445 (0.466) data 0.315 (0.336) loss_x loss_x 1.1699 (1.2453) acc_x 78.1250 (68.4375) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [35/38] time 0.511 (0.460) data 0.381 (0.329) loss_x loss_x 1.2266 (1.2414) acc_x 68.7500 (68.3036) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1569
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1242
clean true:1238
clean false:4
clean_rate:0.9967793880837359
noisy true:329
noisy false:1565
after delete: len(clean_dataset) 1242
after delete: len(noisy_dataset) 1894
epoch [107/200] batch [5/38] time 0.370 (0.447) data 0.240 (0.316) loss_x loss_x 1.7871 (1.3678) acc_x 59.3750 (65.6250) lr 9.2154e-04 eta 0:00:14
epoch [107/200] batch [10/38] time 0.491 (0.464) data 0.361 (0.333) loss_x loss_x 1.2725 (1.3365) acc_x 68.7500 (67.8125) lr 9.2154e-04 eta 0:00:12
epoch [107/200] batch [15/38] time 0.517 (0.464) data 0.387 (0.334) loss_x loss_x 0.9448 (1.3077) acc_x 71.8750 (67.0833) lr 9.2154e-04 eta 0:00:10
epoch [107/200] batch [20/38] time 0.478 (0.472) data 0.348 (0.341) loss_x loss_x 1.2988 (1.2987) acc_x 65.6250 (67.9688) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [25/38] time 0.344 (0.463) data 0.214 (0.332) loss_x loss_x 0.7700 (1.2803) acc_x 75.0000 (67.5000) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [30/38] time 0.575 (0.465) data 0.445 (0.334) loss_x loss_x 0.9565 (1.2592) acc_x 75.0000 (67.5000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [35/38] time 0.498 (0.469) data 0.368 (0.339) loss_x loss_x 1.7559 (1.2765) acc_x 65.6250 (67.2321) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1594
confident_label rate tensor(0.3890, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1220
clean true:1217
clean false:3
clean_rate:0.9975409836065574
noisy true:325
noisy false:1591
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 1916
epoch [108/200] batch [5/38] time 0.367 (0.489) data 0.237 (0.359) loss_x loss_x 1.3242 (1.3580) acc_x 68.7500 (68.7500) lr 9.0589e-04 eta 0:00:16
epoch [108/200] batch [10/38] time 0.442 (0.457) data 0.311 (0.327) loss_x loss_x 0.8330 (1.1995) acc_x 71.8750 (70.3125) lr 9.0589e-04 eta 0:00:12
epoch [108/200] batch [15/38] time 0.574 (0.477) data 0.443 (0.346) loss_x loss_x 0.8857 (1.2235) acc_x 71.8750 (69.3750) lr 9.0589e-04 eta 0:00:10
epoch [108/200] batch [20/38] time 0.435 (0.467) data 0.304 (0.336) loss_x loss_x 1.1172 (1.2828) acc_x 71.8750 (68.5938) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [25/38] time 0.434 (0.463) data 0.304 (0.332) loss_x loss_x 1.0107 (1.2507) acc_x 75.0000 (69.2500) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [30/38] time 0.459 (0.468) data 0.328 (0.337) loss_x loss_x 1.0195 (1.2260) acc_x 71.8750 (70.1042) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [35/38] time 0.372 (0.468) data 0.241 (0.337) loss_x loss_x 2.2051 (1.2656) acc_x 46.8750 (69.0179) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.3945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1237
clean true:1236
clean false:1
clean_rate:0.9991915925626516
noisy true:351
noisy false:1548
after delete: len(clean_dataset) 1237
after delete: len(noisy_dataset) 1899
epoch [109/200] batch [5/38] time 0.312 (0.502) data 0.181 (0.371) loss_x loss_x 1.4355 (1.1099) acc_x 59.3750 (68.7500) lr 8.9027e-04 eta 0:00:16
epoch [109/200] batch [10/38] time 0.528 (0.477) data 0.398 (0.347) loss_x loss_x 0.9907 (1.2028) acc_x 68.7500 (69.0625) lr 8.9027e-04 eta 0:00:13
epoch [109/200] batch [15/38] time 0.470 (0.474) data 0.339 (0.343) loss_x loss_x 1.2959 (1.1844) acc_x 62.5000 (68.1250) lr 8.9027e-04 eta 0:00:10
epoch [109/200] batch [20/38] time 0.391 (0.471) data 0.260 (0.340) loss_x loss_x 0.9131 (1.1732) acc_x 81.2500 (68.1250) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [25/38] time 0.404 (0.465) data 0.273 (0.334) loss_x loss_x 1.5576 (1.2105) acc_x 62.5000 (67.3750) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [30/38] time 0.460 (0.464) data 0.329 (0.334) loss_x loss_x 0.8818 (1.1955) acc_x 71.8750 (67.8125) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [35/38] time 0.326 (0.464) data 0.195 (0.333) loss_x loss_x 1.3633 (1.1978) acc_x 65.6250 (68.6607) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.3881, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1217
clean true:1214
clean false:3
clean_rate:0.9975349219391948
noisy true:342
noisy false:1577
after delete: len(clean_dataset) 1217
after delete: len(noisy_dataset) 1919
epoch [110/200] batch [5/38] time 0.379 (0.431) data 0.249 (0.301) loss_x loss_x 1.2520 (1.0950) acc_x 68.7500 (73.1250) lr 8.7467e-04 eta 0:00:14
epoch [110/200] batch [10/38] time 0.471 (0.437) data 0.340 (0.306) loss_x loss_x 1.4355 (1.0682) acc_x 68.7500 (73.4375) lr 8.7467e-04 eta 0:00:12
epoch [110/200] batch [15/38] time 0.349 (0.433) data 0.218 (0.302) loss_x loss_x 1.2734 (1.1042) acc_x 62.5000 (71.0417) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [20/38] time 0.494 (0.446) data 0.364 (0.315) loss_x loss_x 1.4092 (1.1450) acc_x 56.2500 (69.6875) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [25/38] time 0.441 (0.451) data 0.310 (0.320) loss_x loss_x 1.0947 (1.1532) acc_x 71.8750 (70.2500) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [30/38] time 0.446 (0.451) data 0.315 (0.321) loss_x loss_x 1.1211 (1.1647) acc_x 59.3750 (69.4792) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [35/38] time 0.383 (0.449) data 0.252 (0.319) loss_x loss_x 1.0781 (1.1666) acc_x 71.8750 (70.1786) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1596
confident_label rate tensor(0.3890, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1220
clean true:1220
clean false:0
clean_rate:1.0
noisy true:320
noisy false:1596
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 1916
epoch [111/200] batch [5/38] time 0.472 (0.437) data 0.341 (0.307) loss_x loss_x 1.7256 (1.3807) acc_x 50.0000 (60.6250) lr 8.5910e-04 eta 0:00:14
epoch [111/200] batch [10/38] time 0.432 (0.452) data 0.301 (0.321) loss_x loss_x 0.9966 (1.3218) acc_x 75.0000 (62.1875) lr 8.5910e-04 eta 0:00:12
epoch [111/200] batch [15/38] time 0.538 (0.462) data 0.407 (0.332) loss_x loss_x 1.2246 (1.3334) acc_x 65.6250 (63.9583) lr 8.5910e-04 eta 0:00:10
epoch [111/200] batch [20/38] time 0.520 (0.466) data 0.389 (0.335) loss_x loss_x 0.8721 (1.2549) acc_x 84.3750 (66.7188) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [25/38] time 0.456 (0.463) data 0.325 (0.333) loss_x loss_x 1.0723 (1.2471) acc_x 62.5000 (66.1250) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [30/38] time 0.638 (0.467) data 0.507 (0.336) loss_x loss_x 1.1748 (1.2504) acc_x 65.6250 (65.7292) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [35/38] time 0.419 (0.468) data 0.288 (0.338) loss_x loss_x 1.3701 (1.2674) acc_x 71.8750 (66.2500) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1528
confident_label rate tensor(0.4021, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1261
clean true:1258
clean false:3
clean_rate:0.9976209357652657
noisy true:350
noisy false:1525
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 1875
epoch [112/200] batch [5/39] time 0.659 (0.471) data 0.528 (0.340) loss_x loss_x 1.0693 (1.2209) acc_x 81.2500 (73.7500) lr 8.4357e-04 eta 0:00:16
epoch [112/200] batch [10/39] time 0.353 (0.446) data 0.223 (0.315) loss_x loss_x 1.0811 (1.1907) acc_x 65.6250 (71.8750) lr 8.4357e-04 eta 0:00:12
epoch [112/200] batch [15/39] time 0.527 (0.439) data 0.397 (0.309) loss_x loss_x 1.4971 (1.2374) acc_x 68.7500 (70.2083) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [20/39] time 0.474 (0.444) data 0.343 (0.313) loss_x loss_x 1.5811 (1.2221) acc_x 62.5000 (69.5312) lr 8.4357e-04 eta 0:00:08
epoch [112/200] batch [25/39] time 0.446 (0.451) data 0.315 (0.321) loss_x loss_x 0.9351 (1.2477) acc_x 68.7500 (69.1250) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [30/39] time 0.495 (0.458) data 0.364 (0.327) loss_x loss_x 1.1982 (1.2301) acc_x 75.0000 (69.5833) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [35/39] time 0.425 (0.458) data 0.294 (0.327) loss_x loss_x 1.2139 (1.2430) acc_x 59.3750 (69.1964) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.3836, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1203
clean true:1201
clean false:2
clean_rate:0.99833748960931
noisy true:355
noisy false:1578
after delete: len(clean_dataset) 1203
after delete: len(noisy_dataset) 1933
epoch [113/200] batch [5/37] time 0.360 (0.433) data 0.229 (0.302) loss_x loss_x 1.0010 (1.3041) acc_x 78.1250 (69.3750) lr 8.2807e-04 eta 0:00:13
epoch [113/200] batch [10/37] time 0.400 (0.427) data 0.269 (0.296) loss_x loss_x 0.9351 (1.2057) acc_x 81.2500 (72.1875) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [15/37] time 0.462 (0.435) data 0.331 (0.304) loss_x loss_x 0.8750 (1.1661) acc_x 71.8750 (72.0833) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [20/37] time 0.466 (0.434) data 0.335 (0.303) loss_x loss_x 0.8608 (1.1640) acc_x 78.1250 (72.6562) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [25/37] time 0.538 (0.444) data 0.407 (0.313) loss_x loss_x 0.8066 (1.1566) acc_x 78.1250 (72.3750) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [30/37] time 0.558 (0.447) data 0.427 (0.316) loss_x loss_x 1.2656 (1.1688) acc_x 71.8750 (71.2500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [35/37] time 0.448 (0.442) data 0.317 (0.311) loss_x loss_x 1.0938 (1.1630) acc_x 78.1250 (71.5179) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1564
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1215
clean true:1213
clean false:2
clean_rate:0.9983539094650206
noisy true:359
noisy false:1562
after delete: len(clean_dataset) 1215
after delete: len(noisy_dataset) 1921
epoch [114/200] batch [5/37] time 0.514 (0.518) data 0.383 (0.387) loss_x loss_x 1.0986 (1.1707) acc_x 75.0000 (75.6250) lr 8.1262e-04 eta 0:00:16
epoch [114/200] batch [10/37] time 0.437 (0.463) data 0.307 (0.333) loss_x loss_x 1.0674 (1.1165) acc_x 75.0000 (75.6250) lr 8.1262e-04 eta 0:00:12
epoch [114/200] batch [15/37] time 0.499 (0.456) data 0.368 (0.326) loss_x loss_x 1.2412 (1.1754) acc_x 56.2500 (70.6250) lr 8.1262e-04 eta 0:00:10
epoch [114/200] batch [20/37] time 0.422 (0.463) data 0.291 (0.333) loss_x loss_x 1.4844 (1.1649) acc_x 68.7500 (70.7812) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [25/37] time 0.383 (0.454) data 0.253 (0.324) loss_x loss_x 1.8789 (1.2096) acc_x 53.1250 (69.0000) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [30/37] time 0.477 (0.455) data 0.347 (0.324) loss_x loss_x 1.2656 (1.1945) acc_x 68.7500 (69.4792) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [35/37] time 0.421 (0.454) data 0.290 (0.324) loss_x loss_x 1.5361 (1.1936) acc_x 68.7500 (70.0893) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.3980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1248
clean true:1245
clean false:3
clean_rate:0.9975961538461539
noisy true:328
noisy false:1560
after delete: len(clean_dataset) 1248
after delete: len(noisy_dataset) 1888
epoch [115/200] batch [5/39] time 0.460 (0.470) data 0.329 (0.339) loss_x loss_x 1.2783 (1.3746) acc_x 65.6250 (63.7500) lr 7.9721e-04 eta 0:00:15
epoch [115/200] batch [10/39] time 0.598 (0.476) data 0.467 (0.345) loss_x loss_x 1.3271 (1.2810) acc_x 62.5000 (65.9375) lr 7.9721e-04 eta 0:00:13
epoch [115/200] batch [15/39] time 0.460 (0.457) data 0.329 (0.326) loss_x loss_x 1.1611 (1.2380) acc_x 68.7500 (66.2500) lr 7.9721e-04 eta 0:00:10
epoch [115/200] batch [20/39] time 0.627 (0.472) data 0.496 (0.341) loss_x loss_x 1.7217 (1.2591) acc_x 65.6250 (66.5625) lr 7.9721e-04 eta 0:00:08
epoch [115/200] batch [25/39] time 0.380 (0.469) data 0.250 (0.338) loss_x loss_x 1.1992 (1.2431) acc_x 71.8750 (67.3750) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [30/39] time 0.385 (0.463) data 0.255 (0.333) loss_x loss_x 1.2588 (1.2173) acc_x 68.7500 (67.9167) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [35/39] time 0.411 (0.463) data 0.280 (0.332) loss_x loss_x 0.9795 (1.1865) acc_x 75.0000 (68.4821) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1231
clean true:1230
clean false:1
clean_rate:0.9991876523151909
noisy true:351
noisy false:1554
after delete: len(clean_dataset) 1231
after delete: len(noisy_dataset) 1905
epoch [116/200] batch [5/38] time 0.614 (0.518) data 0.484 (0.387) loss_x loss_x 1.6816 (1.2139) acc_x 65.6250 (72.5000) lr 7.8186e-04 eta 0:00:17
epoch [116/200] batch [10/38] time 0.359 (0.460) data 0.228 (0.330) loss_x loss_x 1.2275 (1.1529) acc_x 65.6250 (70.3125) lr 7.8186e-04 eta 0:00:12
epoch [116/200] batch [15/38] time 0.583 (0.479) data 0.453 (0.348) loss_x loss_x 1.7705 (1.2196) acc_x 46.8750 (68.7500) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [20/38] time 0.411 (0.470) data 0.281 (0.340) loss_x loss_x 1.1543 (1.1920) acc_x 65.6250 (69.2188) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [25/38] time 0.410 (0.461) data 0.280 (0.330) loss_x loss_x 0.9375 (1.1810) acc_x 78.1250 (69.6250) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [30/38] time 0.508 (0.464) data 0.378 (0.333) loss_x loss_x 1.5820 (1.1918) acc_x 62.5000 (69.5833) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [35/38] time 0.452 (0.458) data 0.323 (0.328) loss_x loss_x 1.3262 (1.2124) acc_x 65.6250 (68.5714) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.3906, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1225
clean true:1224
clean false:1
clean_rate:0.9991836734693877
noisy true:357
noisy false:1554
after delete: len(clean_dataset) 1225
after delete: len(noisy_dataset) 1911
epoch [117/200] batch [5/38] time 0.367 (0.481) data 0.237 (0.350) loss_x loss_x 1.1807 (1.1438) acc_x 68.7500 (72.5000) lr 7.6655e-04 eta 0:00:15
epoch [117/200] batch [10/38] time 0.344 (0.455) data 0.213 (0.325) loss_x loss_x 1.9844 (1.1727) acc_x 50.0000 (71.2500) lr 7.6655e-04 eta 0:00:12
epoch [117/200] batch [15/38] time 0.508 (0.484) data 0.377 (0.354) loss_x loss_x 1.2041 (1.2009) acc_x 62.5000 (70.0000) lr 7.6655e-04 eta 0:00:11
epoch [117/200] batch [20/38] time 0.496 (0.480) data 0.366 (0.349) loss_x loss_x 1.5537 (1.2197) acc_x 59.3750 (69.8438) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [25/38] time 0.469 (0.481) data 0.340 (0.351) loss_x loss_x 1.5332 (1.2367) acc_x 56.2500 (69.7500) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [30/38] time 0.388 (0.474) data 0.258 (0.343) loss_x loss_x 1.0166 (1.2511) acc_x 71.8750 (69.0625) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [35/38] time 0.359 (0.463) data 0.228 (0.333) loss_x loss_x 1.2598 (1.2297) acc_x 75.0000 (69.3750) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4015, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1259
clean true:1258
clean false:1
clean_rate:0.9992057188244639
noisy true:354
noisy false:1523
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 1877
epoch [118/200] batch [5/39] time 0.476 (0.478) data 0.345 (0.347) loss_x loss_x 0.9097 (0.9532) acc_x 78.1250 (76.8750) lr 7.5131e-04 eta 0:00:16
epoch [118/200] batch [10/39] time 0.334 (0.431) data 0.203 (0.301) loss_x loss_x 1.4189 (1.1109) acc_x 62.5000 (72.5000) lr 7.5131e-04 eta 0:00:12
epoch [118/200] batch [15/39] time 0.494 (0.460) data 0.363 (0.329) loss_x loss_x 1.1445 (1.0934) acc_x 62.5000 (72.9167) lr 7.5131e-04 eta 0:00:11
epoch [118/200] batch [20/39] time 0.419 (0.459) data 0.288 (0.328) loss_x loss_x 1.4922 (1.1412) acc_x 56.2500 (71.4062) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [25/39] time 0.584 (0.457) data 0.453 (0.326) loss_x loss_x 1.2451 (1.1539) acc_x 59.3750 (70.6250) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [30/39] time 0.411 (0.452) data 0.279 (0.320) loss_x loss_x 1.0146 (1.1182) acc_x 81.2500 (71.7708) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [35/39] time 0.399 (0.450) data 0.268 (0.319) loss_x loss_x 1.5322 (1.1709) acc_x 62.5000 (70.9821) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1525
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1264
clean true:1262
clean false:2
clean_rate:0.9984177215189873
noisy true:349
noisy false:1523
after delete: len(clean_dataset) 1264
after delete: len(noisy_dataset) 1872
epoch [119/200] batch [5/39] time 0.536 (0.524) data 0.405 (0.393) loss_x loss_x 1.7246 (1.2291) acc_x 46.8750 (69.3750) lr 7.3613e-04 eta 0:00:17
epoch [119/200] batch [10/39] time 0.575 (0.512) data 0.444 (0.380) loss_x loss_x 1.1416 (1.2771) acc_x 71.8750 (67.8125) lr 7.3613e-04 eta 0:00:14
epoch [119/200] batch [15/39] time 0.480 (0.483) data 0.350 (0.352) loss_x loss_x 1.4062 (1.3462) acc_x 62.5000 (65.8333) lr 7.3613e-04 eta 0:00:11
epoch [119/200] batch [20/39] time 0.532 (0.484) data 0.401 (0.353) loss_x loss_x 1.2734 (1.2983) acc_x 59.3750 (67.0312) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [25/39] time 0.431 (0.477) data 0.301 (0.346) loss_x loss_x 1.2500 (1.2739) acc_x 75.0000 (67.8750) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [30/39] time 0.369 (0.468) data 0.238 (0.336) loss_x loss_x 1.4258 (1.2933) acc_x 65.6250 (67.9167) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [35/39] time 0.424 (0.465) data 0.293 (0.334) loss_x loss_x 1.3311 (1.3411) acc_x 68.7500 (67.4107) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1582
confident_label rate tensor(0.3935, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1234
clean true:1232
clean false:2
clean_rate:0.9983792544570502
noisy true:322
noisy false:1580
after delete: len(clean_dataset) 1234
after delete: len(noisy_dataset) 1902
epoch [120/200] batch [5/38] time 0.754 (0.558) data 0.622 (0.427) loss_x loss_x 1.6533 (1.3527) acc_x 56.2500 (65.6250) lr 7.2101e-04 eta 0:00:18
epoch [120/200] batch [10/38] time 0.658 (0.514) data 0.527 (0.384) loss_x loss_x 1.3115 (1.3799) acc_x 75.0000 (66.5625) lr 7.2101e-04 eta 0:00:14
epoch [120/200] batch [15/38] time 0.449 (0.485) data 0.318 (0.354) loss_x loss_x 1.5283 (1.3571) acc_x 62.5000 (67.2917) lr 7.2101e-04 eta 0:00:11
epoch [120/200] batch [20/38] time 0.523 (0.496) data 0.392 (0.365) loss_x loss_x 1.1689 (1.2935) acc_x 62.5000 (67.6562) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [25/38] time 0.345 (0.488) data 0.214 (0.357) loss_x loss_x 1.3301 (1.2331) acc_x 68.7500 (68.8750) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [30/38] time 0.400 (0.481) data 0.269 (0.350) loss_x loss_x 0.9355 (1.2429) acc_x 81.2500 (69.1667) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [35/38] time 0.375 (0.471) data 0.244 (0.340) loss_x loss_x 1.2803 (1.2485) acc_x 56.2500 (68.3929) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1547
confident_label rate tensor(0.3938, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1235
clean true:1235
clean false:0
clean_rate:1.0
noisy true:354
noisy false:1547
after delete: len(clean_dataset) 1235
after delete: len(noisy_dataset) 1901
epoch [121/200] batch [5/38] time 0.456 (0.437) data 0.325 (0.307) loss_x loss_x 1.2422 (1.3906) acc_x 71.8750 (64.3750) lr 7.0596e-04 eta 0:00:14
epoch [121/200] batch [10/38] time 0.415 (0.441) data 0.284 (0.310) loss_x loss_x 1.2158 (1.3415) acc_x 71.8750 (67.1875) lr 7.0596e-04 eta 0:00:12
epoch [121/200] batch [15/38] time 0.429 (0.455) data 0.299 (0.324) loss_x loss_x 0.7817 (1.2414) acc_x 84.3750 (70.4167) lr 7.0596e-04 eta 0:00:10
epoch [121/200] batch [20/38] time 0.568 (0.464) data 0.437 (0.333) loss_x loss_x 1.3672 (1.2196) acc_x 68.7500 (70.6250) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [25/38] time 0.524 (0.457) data 0.393 (0.326) loss_x loss_x 1.2900 (1.2319) acc_x 65.6250 (70.5000) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [30/38] time 0.493 (0.462) data 0.362 (0.331) loss_x loss_x 0.8765 (1.2257) acc_x 68.7500 (70.3125) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [35/38] time 0.623 (0.466) data 0.492 (0.335) loss_x loss_x 0.9976 (1.2182) acc_x 75.0000 (69.8214) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.3948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1238
clean true:1237
clean false:1
clean_rate:0.9991922455573505
noisy true:344
noisy false:1554
after delete: len(clean_dataset) 1238
after delete: len(noisy_dataset) 1898
epoch [122/200] batch [5/38] time 0.524 (0.483) data 0.393 (0.351) loss_x loss_x 1.2725 (1.2965) acc_x 62.5000 (68.1250) lr 6.9098e-04 eta 0:00:15
epoch [122/200] batch [10/38] time 0.391 (0.457) data 0.260 (0.326) loss_x loss_x 1.2227 (1.2111) acc_x 75.0000 (68.1250) lr 6.9098e-04 eta 0:00:12
epoch [122/200] batch [15/38] time 0.456 (0.449) data 0.326 (0.318) loss_x loss_x 0.9634 (1.1223) acc_x 75.0000 (71.0417) lr 6.9098e-04 eta 0:00:10
epoch [122/200] batch [20/38] time 0.474 (0.449) data 0.343 (0.318) loss_x loss_x 0.9873 (1.1367) acc_x 71.8750 (70.7812) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [25/38] time 0.401 (0.451) data 0.270 (0.320) loss_x loss_x 1.7061 (1.1694) acc_x 56.2500 (69.3750) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [30/38] time 0.465 (0.456) data 0.334 (0.325) loss_x loss_x 1.3115 (1.1972) acc_x 68.7500 (68.7500) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [35/38] time 0.373 (0.463) data 0.243 (0.332) loss_x loss_x 1.3574 (1.2032) acc_x 62.5000 (68.5714) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1562
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1244
clean true:1241
clean false:3
clean_rate:0.997588424437299
noisy true:333
noisy false:1559
after delete: len(clean_dataset) 1244
after delete: len(noisy_dataset) 1892
epoch [123/200] batch [5/38] time 0.390 (0.443) data 0.260 (0.313) loss_x loss_x 1.5771 (1.5298) acc_x 56.2500 (61.2500) lr 6.7608e-04 eta 0:00:14
epoch [123/200] batch [10/38] time 0.482 (0.436) data 0.350 (0.305) loss_x loss_x 1.4277 (1.3336) acc_x 75.0000 (66.2500) lr 6.7608e-04 eta 0:00:12
epoch [123/200] batch [15/38] time 0.381 (0.444) data 0.250 (0.314) loss_x loss_x 1.2354 (1.2674) acc_x 68.7500 (67.9167) lr 6.7608e-04 eta 0:00:10
epoch [123/200] batch [20/38] time 0.510 (0.448) data 0.380 (0.317) loss_x loss_x 1.1494 (1.3197) acc_x 62.5000 (66.4062) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [25/38] time 0.454 (0.442) data 0.323 (0.311) loss_x loss_x 1.4697 (1.3137) acc_x 65.6250 (66.5000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [30/38] time 0.512 (0.451) data 0.381 (0.320) loss_x loss_x 1.2432 (1.3095) acc_x 71.8750 (67.2917) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [35/38] time 0.406 (0.443) data 0.275 (0.312) loss_x loss_x 1.1221 (1.2940) acc_x 65.6250 (66.9643) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1544
confident_label rate tensor(0.3935, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1234
clean true:1233
clean false:1
clean_rate:0.9991896272285251
noisy true:359
noisy false:1543
after delete: len(clean_dataset) 1234
after delete: len(noisy_dataset) 1902
epoch [124/200] batch [5/38] time 0.363 (0.443) data 0.232 (0.312) loss_x loss_x 1.5234 (1.2693) acc_x 65.6250 (67.5000) lr 6.6126e-04 eta 0:00:14
epoch [124/200] batch [10/38] time 0.410 (0.430) data 0.279 (0.299) loss_x loss_x 1.0166 (1.1198) acc_x 75.0000 (70.9375) lr 6.6126e-04 eta 0:00:12
epoch [124/200] batch [15/38] time 0.653 (0.466) data 0.522 (0.335) loss_x loss_x 0.9351 (1.0989) acc_x 75.0000 (71.8750) lr 6.6126e-04 eta 0:00:10
epoch [124/200] batch [20/38] time 0.391 (0.452) data 0.260 (0.322) loss_x loss_x 1.7070 (1.1597) acc_x 53.1250 (70.4688) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [25/38] time 0.417 (0.451) data 0.286 (0.320) loss_x loss_x 1.8574 (1.1752) acc_x 53.1250 (70.2500) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [30/38] time 0.551 (0.454) data 0.421 (0.323) loss_x loss_x 1.6445 (1.2319) acc_x 62.5000 (68.9583) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [35/38] time 0.372 (0.452) data 0.242 (0.321) loss_x loss_x 1.0645 (1.2047) acc_x 65.6250 (69.1071) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1568
confident_label rate tensor(0.3919, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1229
clean true:1226
clean false:3
clean_rate:0.9975589910496339
noisy true:342
noisy false:1565
after delete: len(clean_dataset) 1229
after delete: len(noisy_dataset) 1907
epoch [125/200] batch [5/38] time 0.419 (0.448) data 0.288 (0.317) loss_x loss_x 1.4121 (1.2941) acc_x 56.2500 (65.0000) lr 6.4653e-04 eta 0:00:14
epoch [125/200] batch [10/38] time 0.489 (0.451) data 0.359 (0.320) loss_x loss_x 1.0732 (1.2319) acc_x 65.6250 (67.8125) lr 6.4653e-04 eta 0:00:12
epoch [125/200] batch [15/38] time 0.432 (0.450) data 0.301 (0.320) loss_x loss_x 1.5586 (1.2148) acc_x 62.5000 (68.1250) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [20/38] time 0.468 (0.456) data 0.337 (0.325) loss_x loss_x 0.7129 (1.1771) acc_x 81.2500 (69.0625) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [25/38] time 0.464 (0.450) data 0.333 (0.320) loss_x loss_x 1.6973 (1.1680) acc_x 68.7500 (70.1250) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [30/38] time 0.326 (0.453) data 0.196 (0.322) loss_x loss_x 1.4922 (1.1919) acc_x 65.6250 (69.8958) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [35/38] time 0.379 (0.455) data 0.249 (0.324) loss_x loss_x 1.5234 (1.2072) acc_x 50.0000 (69.2857) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1552
confident_label rate tensor(0.3909, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1226
clean true:1225
clean false:1
clean_rate:0.9991843393148451
noisy true:359
noisy false:1551
after delete: len(clean_dataset) 1226
after delete: len(noisy_dataset) 1910
epoch [126/200] batch [5/38] time 0.367 (0.462) data 0.237 (0.331) loss_x loss_x 1.5059 (1.4328) acc_x 53.1250 (63.7500) lr 6.3188e-04 eta 0:00:15
epoch [126/200] batch [10/38] time 0.469 (0.442) data 0.339 (0.311) loss_x loss_x 1.3809 (1.2893) acc_x 65.6250 (68.7500) lr 6.3188e-04 eta 0:00:12
epoch [126/200] batch [15/38] time 0.407 (0.445) data 0.277 (0.315) loss_x loss_x 1.0566 (1.2993) acc_x 68.7500 (69.1667) lr 6.3188e-04 eta 0:00:10
epoch [126/200] batch [20/38] time 0.351 (0.442) data 0.220 (0.312) loss_x loss_x 1.2012 (1.2665) acc_x 71.8750 (69.5312) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [25/38] time 0.492 (0.446) data 0.361 (0.316) loss_x loss_x 0.9053 (1.2302) acc_x 75.0000 (69.6250) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [30/38] time 0.518 (0.449) data 0.387 (0.318) loss_x loss_x 1.3779 (1.2452) acc_x 62.5000 (68.8542) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [35/38] time 0.494 (0.458) data 0.363 (0.327) loss_x loss_x 1.1904 (1.2360) acc_x 65.6250 (68.5714) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1529
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1248
clean false:2
clean_rate:0.9984
noisy true:359
noisy false:1527
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [127/200] batch [5/39] time 0.395 (0.495) data 0.264 (0.364) loss_x loss_x 0.8408 (1.1142) acc_x 81.2500 (71.2500) lr 6.1732e-04 eta 0:00:16
epoch [127/200] batch [10/39] time 0.438 (0.477) data 0.307 (0.346) loss_x loss_x 1.3887 (1.1611) acc_x 65.6250 (70.3125) lr 6.1732e-04 eta 0:00:13
epoch [127/200] batch [15/39] time 0.447 (0.478) data 0.316 (0.347) loss_x loss_x 1.4658 (1.2062) acc_x 68.7500 (70.0000) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [20/39] time 0.396 (0.467) data 0.265 (0.336) loss_x loss_x 1.5654 (1.2053) acc_x 59.3750 (69.8438) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [25/39] time 0.412 (0.469) data 0.281 (0.338) loss_x loss_x 1.0977 (1.1900) acc_x 81.2500 (70.0000) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [30/39] time 0.416 (0.468) data 0.285 (0.337) loss_x loss_x 1.0938 (1.1931) acc_x 75.0000 (70.3125) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [35/39] time 0.567 (0.465) data 0.436 (0.334) loss_x loss_x 1.7510 (1.2095) acc_x 56.2500 (69.5536) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1564
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1231
clean true:1227
clean false:4
clean_rate:0.9967506092607636
noisy true:345
noisy false:1560
after delete: len(clean_dataset) 1231
after delete: len(noisy_dataset) 1905
epoch [128/200] batch [5/38] time 0.492 (0.504) data 0.361 (0.373) loss_x loss_x 1.3760 (1.2796) acc_x 65.6250 (65.6250) lr 6.0285e-04 eta 0:00:16
epoch [128/200] batch [10/38] time 0.472 (0.478) data 0.341 (0.347) loss_x loss_x 1.0283 (1.2639) acc_x 71.8750 (66.8750) lr 6.0285e-04 eta 0:00:13
epoch [128/200] batch [15/38] time 0.407 (0.478) data 0.276 (0.347) loss_x loss_x 0.9766 (1.2933) acc_x 71.8750 (67.0833) lr 6.0285e-04 eta 0:00:10
epoch [128/200] batch [20/38] time 0.506 (0.475) data 0.375 (0.344) loss_x loss_x 1.3398 (1.3039) acc_x 71.8750 (67.6562) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [25/38] time 0.458 (0.470) data 0.327 (0.339) loss_x loss_x 1.3428 (1.2855) acc_x 71.8750 (67.7500) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [30/38] time 0.455 (0.467) data 0.324 (0.336) loss_x loss_x 1.5391 (1.2752) acc_x 59.3750 (68.4375) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [35/38] time 0.461 (0.465) data 0.331 (0.334) loss_x loss_x 1.3877 (1.2803) acc_x 71.8750 (68.4821) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1520
confident_label rate tensor(0.4021, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1261
clean true:1260
clean false:1
clean_rate:0.9992069785884219
noisy true:356
noisy false:1519
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 1875
epoch [129/200] batch [5/39] time 0.451 (0.405) data 0.321 (0.274) loss_x loss_x 1.2686 (1.2010) acc_x 71.8750 (73.1250) lr 5.8849e-04 eta 0:00:13
epoch [129/200] batch [10/39] time 0.531 (0.434) data 0.400 (0.304) loss_x loss_x 1.4209 (1.3330) acc_x 71.8750 (68.7500) lr 5.8849e-04 eta 0:00:12
epoch [129/200] batch [15/39] time 0.494 (0.441) data 0.363 (0.311) loss_x loss_x 0.7295 (1.3125) acc_x 84.3750 (69.1667) lr 5.8849e-04 eta 0:00:10
epoch [129/200] batch [20/39] time 0.410 (0.441) data 0.280 (0.310) loss_x loss_x 0.8203 (1.2450) acc_x 78.1250 (70.3125) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [25/39] time 0.468 (0.449) data 0.339 (0.318) loss_x loss_x 1.5352 (1.2576) acc_x 62.5000 (69.8750) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [30/39] time 0.581 (0.453) data 0.451 (0.322) loss_x loss_x 1.8711 (1.2555) acc_x 62.5000 (70.0000) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [35/39] time 0.346 (0.449) data 0.216 (0.319) loss_x loss_x 1.1553 (1.2599) acc_x 65.6250 (69.7321) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.3890, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1220
clean true:1219
clean false:1
clean_rate:0.9991803278688525
noisy true:350
noisy false:1566
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 1916
epoch [130/200] batch [5/38] time 0.431 (0.461) data 0.301 (0.331) loss_x loss_x 1.2773 (1.1797) acc_x 71.8750 (73.1250) lr 5.7422e-04 eta 0:00:15
epoch [130/200] batch [10/38] time 0.429 (0.466) data 0.299 (0.335) loss_x loss_x 1.0029 (1.1152) acc_x 65.6250 (71.8750) lr 5.7422e-04 eta 0:00:13
epoch [130/200] batch [15/38] time 0.544 (0.475) data 0.413 (0.344) loss_x loss_x 1.3018 (1.1325) acc_x 75.0000 (70.8333) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [20/38] time 0.430 (0.475) data 0.299 (0.344) loss_x loss_x 1.1738 (1.1557) acc_x 81.2500 (71.2500) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [25/38] time 0.448 (0.472) data 0.317 (0.342) loss_x loss_x 1.8330 (1.1584) acc_x 50.0000 (71.0000) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [30/38] time 0.424 (0.466) data 0.293 (0.335) loss_x loss_x 1.4473 (1.1599) acc_x 68.7500 (70.6250) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [35/38] time 0.426 (0.466) data 0.295 (0.335) loss_x loss_x 1.6172 (1.1722) acc_x 59.3750 (70.0000) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.3951, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1239
clean true:1235
clean false:4
clean_rate:0.9967715899919289
noisy true:325
noisy false:1572
after delete: len(clean_dataset) 1239
after delete: len(noisy_dataset) 1897
epoch [131/200] batch [5/38] time 0.402 (0.494) data 0.271 (0.363) loss_x loss_x 1.5420 (1.1853) acc_x 59.3750 (69.3750) lr 5.6006e-04 eta 0:00:16
epoch [131/200] batch [10/38] time 0.431 (0.471) data 0.301 (0.341) loss_x loss_x 1.6387 (1.2923) acc_x 62.5000 (68.1250) lr 5.6006e-04 eta 0:00:13
epoch [131/200] batch [15/38] time 0.366 (0.457) data 0.235 (0.326) loss_x loss_x 1.0049 (1.3163) acc_x 75.0000 (67.2917) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [20/38] time 0.574 (0.455) data 0.444 (0.325) loss_x loss_x 1.2051 (1.2763) acc_x 65.6250 (67.6562) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [25/38] time 0.337 (0.456) data 0.207 (0.326) loss_x loss_x 1.7627 (1.3364) acc_x 59.3750 (65.8750) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [30/38] time 0.445 (0.455) data 0.315 (0.324) loss_x loss_x 1.2637 (1.3365) acc_x 81.2500 (66.5625) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [35/38] time 0.432 (0.454) data 0.302 (0.323) loss_x loss_x 1.4512 (1.3309) acc_x 68.7500 (66.5179) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1531
confident_label rate tensor(0.4034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1265
clean true:1263
clean false:2
clean_rate:0.9984189723320158
noisy true:342
noisy false:1529
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 1871
epoch [132/200] batch [5/39] time 0.447 (0.483) data 0.316 (0.352) loss_x loss_x 1.1689 (1.0728) acc_x 71.8750 (74.3750) lr 5.4601e-04 eta 0:00:16
epoch [132/200] batch [10/39] time 0.487 (0.454) data 0.356 (0.323) loss_x loss_x 0.8315 (1.0850) acc_x 78.1250 (73.7500) lr 5.4601e-04 eta 0:00:13
epoch [132/200] batch [15/39] time 0.462 (0.439) data 0.331 (0.308) loss_x loss_x 1.6221 (1.1134) acc_x 53.1250 (71.8750) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [20/39] time 0.350 (0.440) data 0.219 (0.309) loss_x loss_x 0.9717 (1.1338) acc_x 78.1250 (70.9375) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [25/39] time 0.460 (0.440) data 0.330 (0.309) loss_x loss_x 1.0098 (1.1277) acc_x 81.2500 (71.6250) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [30/39] time 0.663 (0.455) data 0.532 (0.324) loss_x loss_x 1.0342 (1.1086) acc_x 75.0000 (72.1875) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [35/39] time 0.504 (0.460) data 0.374 (0.330) loss_x loss_x 0.9517 (1.1047) acc_x 71.8750 (71.8750) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1529
confident_label rate tensor(0.4008, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1257
clean true:1257
clean false:0
clean_rate:1.0
noisy true:350
noisy false:1529
after delete: len(clean_dataset) 1257
after delete: len(noisy_dataset) 1879
epoch [133/200] batch [5/39] time 0.455 (0.472) data 0.323 (0.341) loss_x loss_x 0.9507 (1.2904) acc_x 84.3750 (71.2500) lr 5.3207e-04 eta 0:00:16
epoch [133/200] batch [10/39] time 0.424 (0.446) data 0.293 (0.315) loss_x loss_x 1.1748 (1.2864) acc_x 65.6250 (69.6875) lr 5.3207e-04 eta 0:00:12
epoch [133/200] batch [15/39] time 0.502 (0.457) data 0.371 (0.326) loss_x loss_x 1.0967 (1.2448) acc_x 71.8750 (69.1667) lr 5.3207e-04 eta 0:00:10
epoch [133/200] batch [20/39] time 0.539 (0.468) data 0.408 (0.337) loss_x loss_x 1.1816 (1.2266) acc_x 65.6250 (69.5312) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [25/39] time 0.395 (0.468) data 0.264 (0.337) loss_x loss_x 1.2686 (1.2153) acc_x 65.6250 (70.1250) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [30/39] time 0.381 (0.468) data 0.250 (0.337) loss_x loss_x 1.4385 (1.2097) acc_x 56.2500 (69.8958) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [35/39] time 0.417 (0.460) data 0.286 (0.329) loss_x loss_x 1.1523 (1.2063) acc_x 71.8750 (69.9107) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1526
confident_label rate tensor(0.3976, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1247
clean true:1244
clean false:3
clean_rate:0.9975942261427426
noisy true:366
noisy false:1523
after delete: len(clean_dataset) 1247
after delete: len(noisy_dataset) 1889
epoch [134/200] batch [5/38] time 0.513 (0.477) data 0.382 (0.346) loss_x loss_x 1.3027 (1.3158) acc_x 75.0000 (65.0000) lr 5.1825e-04 eta 0:00:15
epoch [134/200] batch [10/38] time 0.391 (0.462) data 0.259 (0.331) loss_x loss_x 0.8496 (1.2392) acc_x 71.8750 (66.8750) lr 5.1825e-04 eta 0:00:12
epoch [134/200] batch [15/38] time 0.428 (0.464) data 0.298 (0.333) loss_x loss_x 1.7471 (1.2940) acc_x 56.2500 (67.2917) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [20/38] time 0.457 (0.461) data 0.326 (0.330) loss_x loss_x 1.2959 (1.2753) acc_x 62.5000 (68.4375) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [25/38] time 0.463 (0.465) data 0.330 (0.334) loss_x loss_x 1.6504 (1.2617) acc_x 65.6250 (69.0000) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [30/38] time 0.469 (0.460) data 0.337 (0.329) loss_x loss_x 1.0996 (1.2565) acc_x 71.8750 (68.5417) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [35/38] time 0.433 (0.456) data 0.303 (0.325) loss_x loss_x 1.8340 (1.2989) acc_x 46.8750 (67.2321) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1534
confident_label rate tensor(0.4037, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:337
noisy false:1533
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 1870
epoch [135/200] batch [5/39] time 0.441 (0.461) data 0.311 (0.330) loss_x loss_x 1.7100 (1.3356) acc_x 59.3750 (64.3750) lr 5.0454e-04 eta 0:00:15
epoch [135/200] batch [10/39] time 0.526 (0.473) data 0.397 (0.342) loss_x loss_x 1.4268 (1.3311) acc_x 62.5000 (64.0625) lr 5.0454e-04 eta 0:00:13
epoch [135/200] batch [15/39] time 0.404 (0.462) data 0.275 (0.332) loss_x loss_x 1.0850 (1.2762) acc_x 68.7500 (64.7917) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [20/39] time 0.377 (0.445) data 0.248 (0.315) loss_x loss_x 0.9058 (1.2322) acc_x 78.1250 (66.8750) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [25/39] time 0.521 (0.445) data 0.392 (0.315) loss_x loss_x 0.6157 (1.1892) acc_x 75.0000 (67.8750) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [30/39] time 0.437 (0.438) data 0.306 (0.308) loss_x loss_x 1.2461 (1.2137) acc_x 78.1250 (67.9167) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [35/39] time 0.405 (0.438) data 0.275 (0.308) loss_x loss_x 1.3408 (1.2212) acc_x 59.3750 (67.3214) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1507
confident_label rate tensor(0.4088, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1282
clean true:1279
clean false:3
clean_rate:0.9976599063962559
noisy true:350
noisy false:1504
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 1854
epoch [136/200] batch [5/40] time 0.481 (0.478) data 0.350 (0.348) loss_x loss_x 1.4424 (1.2321) acc_x 75.0000 (71.2500) lr 4.9096e-04 eta 0:00:16
epoch [136/200] batch [10/40] time 0.515 (0.500) data 0.384 (0.369) loss_x loss_x 0.8633 (1.1977) acc_x 75.0000 (70.0000) lr 4.9096e-04 eta 0:00:15
epoch [136/200] batch [15/40] time 0.495 (0.488) data 0.364 (0.357) loss_x loss_x 1.0059 (1.2229) acc_x 75.0000 (68.9583) lr 4.9096e-04 eta 0:00:12
epoch [136/200] batch [20/40] time 0.588 (0.487) data 0.457 (0.357) loss_x loss_x 1.3887 (1.2503) acc_x 65.6250 (68.4375) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [25/40] time 0.424 (0.478) data 0.293 (0.347) loss_x loss_x 1.0547 (1.2299) acc_x 75.0000 (68.1250) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [30/40] time 0.502 (0.473) data 0.372 (0.343) loss_x loss_x 1.1396 (1.1896) acc_x 78.1250 (69.6875) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [35/40] time 0.386 (0.465) data 0.255 (0.335) loss_x loss_x 0.9004 (1.1650) acc_x 87.5000 (70.1786) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [40/40] time 0.480 (0.461) data 0.349 (0.331) loss_x loss_x 1.5098 (1.1856) acc_x 62.5000 (69.4531) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1557
confident_label rate tensor(0.3996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1253
clean true:1251
clean false:2
clean_rate:0.9984038308060654
noisy true:328
noisy false:1555
after delete: len(clean_dataset) 1253
after delete: len(noisy_dataset) 1883
epoch [137/200] batch [5/39] time 0.502 (0.452) data 0.371 (0.321) loss_x loss_x 1.2051 (1.0315) acc_x 68.7500 (72.5000) lr 4.7750e-04 eta 0:00:15
epoch [137/200] batch [10/39] time 0.524 (0.448) data 0.392 (0.317) loss_x loss_x 1.3203 (1.1383) acc_x 71.8750 (71.8750) lr 4.7750e-04 eta 0:00:12
epoch [137/200] batch [15/39] time 0.597 (0.457) data 0.466 (0.326) loss_x loss_x 1.7363 (1.2141) acc_x 59.3750 (70.2083) lr 4.7750e-04 eta 0:00:10
epoch [137/200] batch [20/39] time 0.459 (0.456) data 0.328 (0.325) loss_x loss_x 1.1602 (1.1854) acc_x 71.8750 (70.6250) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [25/39] time 0.426 (0.455) data 0.295 (0.324) loss_x loss_x 1.1670 (1.1704) acc_x 68.7500 (70.7500) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [30/39] time 0.441 (0.456) data 0.310 (0.325) loss_x loss_x 1.2012 (1.1924) acc_x 59.3750 (69.5833) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [35/39] time 0.603 (0.466) data 0.471 (0.335) loss_x loss_x 1.3848 (1.2153) acc_x 56.2500 (69.1071) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1534
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1247
clean false:3
clean_rate:0.9976
noisy true:355
noisy false:1531
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [138/200] batch [5/39] time 0.603 (0.479) data 0.472 (0.347) loss_x loss_x 1.9424 (1.2756) acc_x 62.5000 (66.8750) lr 4.6417e-04 eta 0:00:16
epoch [138/200] batch [10/39] time 0.524 (0.486) data 0.392 (0.354) loss_x loss_x 1.3750 (1.2822) acc_x 65.6250 (68.7500) lr 4.6417e-04 eta 0:00:14
epoch [138/200] batch [15/39] time 0.515 (0.478) data 0.384 (0.347) loss_x loss_x 1.4951 (1.3072) acc_x 68.7500 (68.7500) lr 4.6417e-04 eta 0:00:11
epoch [138/200] batch [20/39] time 0.394 (0.482) data 0.264 (0.351) loss_x loss_x 1.1143 (1.2939) acc_x 68.7500 (69.2188) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [25/39] time 0.406 (0.487) data 0.276 (0.356) loss_x loss_x 0.9648 (1.2929) acc_x 81.2500 (69.7500) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [30/39] time 0.399 (0.480) data 0.268 (0.349) loss_x loss_x 1.3789 (1.2851) acc_x 59.3750 (68.9583) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [35/39] time 0.553 (0.480) data 0.422 (0.350) loss_x loss_x 1.0654 (1.2647) acc_x 71.8750 (69.0179) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1541
confident_label rate tensor(0.4002, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1255
clean true:1255
clean false:0
clean_rate:1.0
noisy true:340
noisy false:1541
after delete: len(clean_dataset) 1255
after delete: len(noisy_dataset) 1881
epoch [139/200] batch [5/39] time 0.528 (0.470) data 0.397 (0.339) loss_x loss_x 1.4697 (1.2684) acc_x 62.5000 (63.7500) lr 4.5098e-04 eta 0:00:15
epoch [139/200] batch [10/39] time 0.414 (0.462) data 0.284 (0.332) loss_x loss_x 0.8857 (1.1497) acc_x 75.0000 (69.0625) lr 4.5098e-04 eta 0:00:13
epoch [139/200] batch [15/39] time 0.665 (0.490) data 0.534 (0.360) loss_x loss_x 1.0244 (1.1750) acc_x 68.7500 (69.1667) lr 4.5098e-04 eta 0:00:11
epoch [139/200] batch [20/39] time 0.401 (0.483) data 0.271 (0.352) loss_x loss_x 0.5996 (1.1777) acc_x 84.3750 (69.0625) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [25/39] time 0.633 (0.488) data 0.503 (0.357) loss_x loss_x 1.1680 (1.1882) acc_x 62.5000 (68.8750) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [30/39] time 0.320 (0.485) data 0.190 (0.355) loss_x loss_x 1.4609 (1.2130) acc_x 56.2500 (68.3333) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [35/39] time 0.344 (0.474) data 0.213 (0.343) loss_x loss_x 1.1309 (1.2168) acc_x 71.8750 (68.7500) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1548
confident_label rate tensor(0.4005, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1256
clean true:1252
clean false:4
clean_rate:0.9968152866242038
noisy true:336
noisy false:1544
after delete: len(clean_dataset) 1256
after delete: len(noisy_dataset) 1880
epoch [140/200] batch [5/39] time 0.489 (0.446) data 0.358 (0.316) loss_x loss_x 1.7451 (1.2915) acc_x 56.2500 (66.8750) lr 4.3792e-04 eta 0:00:15
epoch [140/200] batch [10/39] time 0.613 (0.500) data 0.483 (0.369) loss_x loss_x 1.1777 (1.3247) acc_x 65.6250 (66.2500) lr 4.3792e-04 eta 0:00:14
epoch [140/200] batch [15/39] time 0.463 (0.493) data 0.332 (0.362) loss_x loss_x 0.9844 (1.2806) acc_x 65.6250 (66.4583) lr 4.3792e-04 eta 0:00:11
epoch [140/200] batch [20/39] time 0.500 (0.482) data 0.370 (0.351) loss_x loss_x 1.0938 (1.2790) acc_x 75.0000 (67.3438) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [25/39] time 0.474 (0.483) data 0.343 (0.352) loss_x loss_x 0.7891 (1.3522) acc_x 75.0000 (65.8750) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [30/39] time 0.628 (0.493) data 0.498 (0.362) loss_x loss_x 1.2656 (1.3226) acc_x 71.8750 (65.8333) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [35/39] time 0.484 (0.490) data 0.353 (0.359) loss_x loss_x 1.1602 (1.3138) acc_x 75.0000 (66.6071) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1538
confident_label rate tensor(0.3964, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1243
clean true:1242
clean false:1
clean_rate:0.999195494770716
noisy true:356
noisy false:1537
after delete: len(clean_dataset) 1243
after delete: len(noisy_dataset) 1893
epoch [141/200] batch [5/38] time 0.403 (0.486) data 0.272 (0.356) loss_x loss_x 1.1504 (1.2312) acc_x 53.1250 (65.6250) lr 4.2499e-04 eta 0:00:16
epoch [141/200] batch [10/38] time 0.477 (0.494) data 0.346 (0.363) loss_x loss_x 0.7407 (1.2318) acc_x 84.3750 (68.4375) lr 4.2499e-04 eta 0:00:13
epoch [141/200] batch [15/38] time 0.437 (0.491) data 0.306 (0.360) loss_x loss_x 1.0518 (1.1746) acc_x 81.2500 (69.5833) lr 4.2499e-04 eta 0:00:11
epoch [141/200] batch [20/38] time 0.306 (0.481) data 0.176 (0.350) loss_x loss_x 1.1924 (1.1829) acc_x 68.7500 (69.8438) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [25/38] time 0.466 (0.479) data 0.335 (0.348) loss_x loss_x 1.2520 (1.1422) acc_x 65.6250 (70.7500) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [30/38] time 0.461 (0.475) data 0.330 (0.344) loss_x loss_x 1.3564 (1.1863) acc_x 68.7500 (70.1042) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [35/38] time 0.556 (0.474) data 0.425 (0.343) loss_x loss_x 2.1953 (1.2299) acc_x 37.5000 (68.9286) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1541
confident_label rate tensor(0.4021, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1261
clean true:1260
clean false:1
clean_rate:0.9992069785884219
noisy true:335
noisy false:1540
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 1875
epoch [142/200] batch [5/39] time 0.682 (0.515) data 0.551 (0.385) loss_x loss_x 0.6313 (1.2110) acc_x 87.5000 (68.7500) lr 4.1221e-04 eta 0:00:17
epoch [142/200] batch [10/39] time 0.428 (0.519) data 0.297 (0.388) loss_x loss_x 1.2158 (1.2708) acc_x 68.7500 (66.2500) lr 4.1221e-04 eta 0:00:15
epoch [142/200] batch [15/39] time 0.447 (0.489) data 0.316 (0.358) loss_x loss_x 1.1445 (1.2541) acc_x 75.0000 (67.2917) lr 4.1221e-04 eta 0:00:11
epoch [142/200] batch [20/39] time 0.418 (0.484) data 0.287 (0.353) loss_x loss_x 1.3555 (1.2289) acc_x 65.6250 (68.5938) lr 4.1221e-04 eta 0:00:09
epoch [142/200] batch [25/39] time 0.530 (0.479) data 0.399 (0.349) loss_x loss_x 1.5195 (1.2294) acc_x 59.3750 (68.3750) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [30/39] time 0.673 (0.480) data 0.543 (0.350) loss_x loss_x 0.8550 (1.2320) acc_x 75.0000 (68.0208) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [35/39] time 0.480 (0.475) data 0.350 (0.344) loss_x loss_x 1.3809 (1.2318) acc_x 59.3750 (67.3214) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1491
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1278
clean true:1276
clean false:2
clean_rate:0.9984350547730829
noisy true:369
noisy false:1489
after delete: len(clean_dataset) 1278
after delete: len(noisy_dataset) 1858
epoch [143/200] batch [5/39] time 0.465 (0.521) data 0.335 (0.390) loss_x loss_x 1.0547 (1.2937) acc_x 68.7500 (70.6250) lr 3.9958e-04 eta 0:00:17
epoch [143/200] batch [10/39] time 0.460 (0.515) data 0.329 (0.385) loss_x loss_x 1.8496 (1.3282) acc_x 53.1250 (68.4375) lr 3.9958e-04 eta 0:00:14
epoch [143/200] batch [15/39] time 0.478 (0.510) data 0.348 (0.379) loss_x loss_x 0.9565 (1.3072) acc_x 71.8750 (67.9167) lr 3.9958e-04 eta 0:00:12
epoch [143/200] batch [20/39] time 0.403 (0.502) data 0.272 (0.371) loss_x loss_x 0.9546 (1.2995) acc_x 81.2500 (67.9688) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [25/39] time 0.511 (0.497) data 0.380 (0.366) loss_x loss_x 0.7676 (1.2523) acc_x 81.2500 (69.2500) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [30/39] time 0.483 (0.490) data 0.352 (0.359) loss_x loss_x 0.7939 (1.2150) acc_x 78.1250 (69.7917) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [35/39] time 0.450 (0.484) data 0.320 (0.354) loss_x loss_x 1.5557 (1.2184) acc_x 68.7500 (69.8214) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1538
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1245
clean false:5
clean_rate:0.996
noisy true:353
noisy false:1533
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [144/200] batch [5/39] time 0.571 (0.482) data 0.440 (0.352) loss_x loss_x 1.2607 (1.2430) acc_x 68.7500 (69.3750) lr 3.8709e-04 eta 0:00:16
epoch [144/200] batch [10/39] time 0.354 (0.480) data 0.223 (0.349) loss_x loss_x 1.2109 (1.1929) acc_x 75.0000 (69.3750) lr 3.8709e-04 eta 0:00:13
epoch [144/200] batch [15/39] time 0.493 (0.467) data 0.363 (0.336) loss_x loss_x 1.1982 (1.2414) acc_x 68.7500 (68.9583) lr 3.8709e-04 eta 0:00:11
epoch [144/200] batch [20/39] time 0.504 (0.469) data 0.373 (0.339) loss_x loss_x 1.3047 (1.2442) acc_x 78.1250 (69.5312) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [25/39] time 0.791 (0.490) data 0.660 (0.359) loss_x loss_x 0.8301 (1.1748) acc_x 75.0000 (70.7500) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [30/39] time 0.375 (0.483) data 0.245 (0.352) loss_x loss_x 1.2207 (1.1715) acc_x 71.8750 (70.6250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [35/39] time 0.380 (0.480) data 0.250 (0.349) loss_x loss_x 1.1641 (1.1526) acc_x 81.2500 (71.5179) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.3913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1227
clean true:1225
clean false:2
clean_rate:0.9983700081499592
noisy true:357
noisy false:1552
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 1909
epoch [145/200] batch [5/38] time 0.566 (0.457) data 0.436 (0.326) loss_x loss_x 1.4551 (1.2490) acc_x 71.8750 (72.5000) lr 3.7476e-04 eta 0:00:15
epoch [145/200] batch [10/38] time 0.557 (0.473) data 0.426 (0.342) loss_x loss_x 0.9004 (1.1569) acc_x 81.2500 (71.8750) lr 3.7476e-04 eta 0:00:13
epoch [145/200] batch [15/38] time 0.426 (0.462) data 0.296 (0.331) loss_x loss_x 0.8501 (1.1783) acc_x 78.1250 (72.5000) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [20/38] time 0.449 (0.453) data 0.318 (0.323) loss_x loss_x 1.1230 (1.2241) acc_x 71.8750 (70.9375) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [25/38] time 0.542 (0.467) data 0.412 (0.336) loss_x loss_x 1.0371 (1.2456) acc_x 65.6250 (70.3750) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [30/38] time 0.379 (0.471) data 0.248 (0.340) loss_x loss_x 0.8350 (1.2234) acc_x 78.1250 (70.4167) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [35/38] time 0.456 (0.472) data 0.326 (0.341) loss_x loss_x 0.5859 (1.1988) acc_x 78.1250 (70.5357) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1513
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1284
clean true:1283
clean false:1
clean_rate:0.9992211838006231
noisy true:340
noisy false:1512
after delete: len(clean_dataset) 1284
after delete: len(noisy_dataset) 1852
epoch [146/200] batch [5/40] time 0.567 (0.492) data 0.436 (0.361) loss_x loss_x 1.4395 (1.1461) acc_x 62.5000 (66.8750) lr 3.6258e-04 eta 0:00:17
epoch [146/200] batch [10/40] time 0.624 (0.490) data 0.493 (0.358) loss_x loss_x 1.4385 (1.1935) acc_x 68.7500 (67.8125) lr 3.6258e-04 eta 0:00:14
epoch [146/200] batch [15/40] time 0.556 (0.479) data 0.426 (0.348) loss_x loss_x 1.1582 (1.2486) acc_x 81.2500 (67.2917) lr 3.6258e-04 eta 0:00:11
epoch [146/200] batch [20/40] time 0.431 (0.487) data 0.300 (0.356) loss_x loss_x 0.9312 (1.2538) acc_x 81.2500 (68.4375) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [25/40] time 0.544 (0.487) data 0.414 (0.356) loss_x loss_x 1.6484 (1.2763) acc_x 65.6250 (67.8750) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [30/40] time 0.511 (0.488) data 0.380 (0.357) loss_x loss_x 1.3301 (1.2786) acc_x 71.8750 (68.3333) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [35/40] time 0.390 (0.484) data 0.260 (0.353) loss_x loss_x 1.5820 (1.2949) acc_x 68.7500 (68.1250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [40/40] time 0.417 (0.483) data 0.286 (0.351) loss_x loss_x 0.6792 (1.2519) acc_x 87.5000 (68.8281) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.3948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1238
clean true:1235
clean false:3
clean_rate:0.9975767366720517
noisy true:338
noisy false:1560
after delete: len(clean_dataset) 1238
after delete: len(noisy_dataset) 1898
epoch [147/200] batch [5/38] time 0.522 (0.527) data 0.391 (0.397) loss_x loss_x 1.4473 (1.3426) acc_x 62.5000 (65.6250) lr 3.5055e-04 eta 0:00:17
epoch [147/200] batch [10/38] time 0.372 (0.501) data 0.241 (0.370) loss_x loss_x 1.6680 (1.3243) acc_x 65.6250 (66.8750) lr 3.5055e-04 eta 0:00:14
epoch [147/200] batch [15/38] time 0.581 (0.493) data 0.450 (0.362) loss_x loss_x 1.4424 (1.2524) acc_x 68.7500 (69.3750) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [20/38] time 0.334 (0.478) data 0.204 (0.348) loss_x loss_x 1.6582 (1.2542) acc_x 59.3750 (69.0625) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [25/38] time 0.485 (0.475) data 0.354 (0.345) loss_x loss_x 1.2158 (1.2448) acc_x 71.8750 (69.2500) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [30/38] time 0.381 (0.467) data 0.249 (0.336) loss_x loss_x 1.2266 (1.2345) acc_x 56.2500 (68.7500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [35/38] time 0.448 (0.465) data 0.316 (0.334) loss_x loss_x 1.0459 (1.2434) acc_x 65.6250 (69.0179) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1251
clean true:1251
clean false:0
clean_rate:1.0
noisy true:327
noisy false:1558
after delete: len(clean_dataset) 1251
after delete: len(noisy_dataset) 1885
epoch [148/200] batch [5/39] time 0.576 (0.507) data 0.445 (0.376) loss_x loss_x 1.7949 (1.2125) acc_x 50.0000 (68.7500) lr 3.3869e-04 eta 0:00:17
epoch [148/200] batch [10/39] time 0.565 (0.505) data 0.434 (0.374) loss_x loss_x 1.1631 (1.2113) acc_x 68.7500 (69.6875) lr 3.3869e-04 eta 0:00:14
epoch [148/200] batch [15/39] time 0.450 (0.503) data 0.319 (0.372) loss_x loss_x 1.5293 (1.3129) acc_x 68.7500 (67.2917) lr 3.3869e-04 eta 0:00:12
epoch [148/200] batch [20/39] time 0.476 (0.485) data 0.345 (0.354) loss_x loss_x 0.7427 (1.2588) acc_x 75.0000 (68.2812) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [25/39] time 0.430 (0.471) data 0.299 (0.340) loss_x loss_x 0.8330 (1.2990) acc_x 78.1250 (67.3750) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [30/39] time 0.436 (0.467) data 0.305 (0.336) loss_x loss_x 1.4180 (1.2985) acc_x 71.8750 (67.7083) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [35/39] time 0.422 (0.458) data 0.291 (0.327) loss_x loss_x 0.8438 (1.2887) acc_x 81.2500 (68.2143) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1519
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1247
clean false:3
clean_rate:0.9976
noisy true:370
noisy false:1516
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [149/200] batch [5/39] time 0.543 (0.474) data 0.412 (0.344) loss_x loss_x 1.4824 (1.1666) acc_x 59.3750 (70.0000) lr 3.2699e-04 eta 0:00:16
epoch [149/200] batch [10/39] time 0.402 (0.467) data 0.272 (0.336) loss_x loss_x 1.4756 (1.2130) acc_x 65.6250 (70.3125) lr 3.2699e-04 eta 0:00:13
epoch [149/200] batch [15/39] time 0.443 (0.451) data 0.313 (0.321) loss_x loss_x 1.1152 (1.2571) acc_x 75.0000 (70.2083) lr 3.2699e-04 eta 0:00:10
epoch [149/200] batch [20/39] time 0.489 (0.459) data 0.359 (0.329) loss_x loss_x 1.1484 (1.2628) acc_x 65.6250 (69.2188) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [25/39] time 0.489 (0.457) data 0.359 (0.326) loss_x loss_x 1.7559 (1.2503) acc_x 56.2500 (69.7500) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [30/39] time 0.406 (0.458) data 0.276 (0.327) loss_x loss_x 1.1338 (1.2243) acc_x 68.7500 (70.3125) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [35/39] time 0.594 (0.467) data 0.464 (0.337) loss_x loss_x 1.3330 (1.2663) acc_x 75.0000 (69.6429) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1531
confident_label rate tensor(0.4037, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1266
clean true:1266
clean false:0
clean_rate:1.0
noisy true:339
noisy false:1531
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 1870
epoch [150/200] batch [5/39] time 0.502 (0.448) data 0.372 (0.318) loss_x loss_x 0.8379 (1.1820) acc_x 81.2500 (71.2500) lr 3.1545e-04 eta 0:00:15
epoch [150/200] batch [10/39] time 0.462 (0.460) data 0.331 (0.330) loss_x loss_x 1.2480 (1.0848) acc_x 71.8750 (71.8750) lr 3.1545e-04 eta 0:00:13
epoch [150/200] batch [15/39] time 0.600 (0.477) data 0.469 (0.346) loss_x loss_x 0.7622 (1.0898) acc_x 75.0000 (71.8750) lr 3.1545e-04 eta 0:00:11
epoch [150/200] batch [20/39] time 0.390 (0.468) data 0.260 (0.337) loss_x loss_x 1.0645 (1.1679) acc_x 71.8750 (70.4688) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [25/39] time 0.478 (0.457) data 0.347 (0.327) loss_x loss_x 1.5195 (1.2086) acc_x 71.8750 (70.5000) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [30/39] time 0.550 (0.456) data 0.419 (0.325) loss_x loss_x 0.7471 (1.2180) acc_x 81.2500 (69.8958) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [35/39] time 0.499 (0.456) data 0.368 (0.326) loss_x loss_x 1.4414 (1.2128) acc_x 65.6250 (70.0893) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1518
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1272
clean true:1270
clean false:2
clean_rate:0.9984276729559748
noisy true:348
noisy false:1516
after delete: len(clean_dataset) 1272
after delete: len(noisy_dataset) 1864
epoch [151/200] batch [5/39] time 0.611 (0.475) data 0.481 (0.345) loss_x loss_x 0.7124 (1.0715) acc_x 84.3750 (74.3750) lr 3.0409e-04 eta 0:00:16
epoch [151/200] batch [10/39] time 0.562 (0.490) data 0.431 (0.360) loss_x loss_x 0.9624 (1.0955) acc_x 78.1250 (73.7500) lr 3.0409e-04 eta 0:00:14
epoch [151/200] batch [15/39] time 0.437 (0.492) data 0.306 (0.362) loss_x loss_x 1.2129 (1.1474) acc_x 71.8750 (72.2917) lr 3.0409e-04 eta 0:00:11
epoch [151/200] batch [20/39] time 0.608 (0.487) data 0.477 (0.356) loss_x loss_x 0.8945 (1.1897) acc_x 81.2500 (71.5625) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [25/39] time 0.542 (0.492) data 0.410 (0.361) loss_x loss_x 1.2842 (1.1966) acc_x 65.6250 (70.5000) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [30/39] time 0.497 (0.491) data 0.366 (0.361) loss_x loss_x 1.2373 (1.2133) acc_x 62.5000 (70.1042) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [35/39] time 0.513 (0.488) data 0.382 (0.357) loss_x loss_x 1.4023 (1.2000) acc_x 59.3750 (69.8214) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1505
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1269
clean true:1265
clean false:4
clean_rate:0.9968479117415288
noisy true:366
noisy false:1501
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 1867
epoch [152/200] batch [5/39] time 0.419 (0.410) data 0.289 (0.280) loss_x loss_x 1.0498 (0.9305) acc_x 71.8750 (74.3750) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [10/39] time 0.558 (0.478) data 0.428 (0.347) loss_x loss_x 1.2852 (1.1249) acc_x 59.3750 (68.4375) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [15/39] time 0.574 (0.486) data 0.444 (0.355) loss_x loss_x 1.2373 (1.1409) acc_x 68.7500 (68.3333) lr 2.9289e-04 eta 0:00:11
epoch [152/200] batch [20/39] time 0.515 (0.471) data 0.384 (0.340) loss_x loss_x 1.5166 (1.1781) acc_x 65.6250 (69.6875) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [25/39] time 0.478 (0.474) data 0.347 (0.343) loss_x loss_x 1.5459 (1.2443) acc_x 62.5000 (68.1250) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [30/39] time 0.368 (0.469) data 0.237 (0.339) loss_x loss_x 1.4121 (1.2189) acc_x 68.7500 (68.8542) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [35/39] time 0.510 (0.477) data 0.379 (0.347) loss_x loss_x 1.3721 (1.2175) acc_x 59.3750 (68.3929) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1506
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1275
clean true:1272
clean false:3
clean_rate:0.9976470588235294
noisy true:358
noisy false:1503
after delete: len(clean_dataset) 1275
after delete: len(noisy_dataset) 1861
epoch [153/200] batch [5/39] time 0.484 (0.447) data 0.353 (0.316) loss_x loss_x 1.1064 (1.2678) acc_x 75.0000 (65.6250) lr 2.8187e-04 eta 0:00:15
epoch [153/200] batch [10/39] time 0.438 (0.456) data 0.307 (0.325) loss_x loss_x 1.2344 (1.2244) acc_x 75.0000 (68.4375) lr 2.8187e-04 eta 0:00:13
epoch [153/200] batch [15/39] time 0.457 (0.464) data 0.326 (0.333) loss_x loss_x 1.1396 (1.2192) acc_x 65.6250 (68.3333) lr 2.8187e-04 eta 0:00:11
epoch [153/200] batch [20/39] time 0.533 (0.472) data 0.403 (0.341) loss_x loss_x 0.9434 (1.2476) acc_x 75.0000 (67.8125) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [25/39] time 0.505 (0.475) data 0.373 (0.345) loss_x loss_x 1.1855 (1.2621) acc_x 68.7500 (68.3750) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [30/39] time 0.452 (0.476) data 0.321 (0.345) loss_x loss_x 0.9233 (1.2358) acc_x 78.1250 (68.8542) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [35/39] time 0.475 (0.476) data 0.345 (0.345) loss_x loss_x 1.1963 (1.2131) acc_x 62.5000 (69.0179) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1539
confident_label rate tensor(0.4027, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1263
clean true:1262
clean false:1
clean_rate:0.9992082343626286
noisy true:335
noisy false:1538
after delete: len(clean_dataset) 1263
after delete: len(noisy_dataset) 1873
epoch [154/200] batch [5/39] time 0.382 (0.509) data 0.251 (0.379) loss_x loss_x 1.2510 (1.2627) acc_x 65.6250 (64.3750) lr 2.7103e-04 eta 0:00:17
epoch [154/200] batch [10/39] time 0.531 (0.488) data 0.401 (0.357) loss_x loss_x 1.0303 (1.1749) acc_x 81.2500 (70.0000) lr 2.7103e-04 eta 0:00:14
epoch [154/200] batch [15/39] time 0.512 (0.491) data 0.380 (0.360) loss_x loss_x 1.3008 (1.1908) acc_x 65.6250 (68.9583) lr 2.7103e-04 eta 0:00:11
epoch [154/200] batch [20/39] time 0.472 (0.487) data 0.340 (0.356) loss_x loss_x 0.5972 (1.1945) acc_x 84.3750 (70.4688) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [25/39] time 0.546 (0.487) data 0.415 (0.356) loss_x loss_x 0.9268 (1.1668) acc_x 71.8750 (70.6250) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [30/39] time 0.384 (0.478) data 0.253 (0.347) loss_x loss_x 1.0889 (1.1468) acc_x 75.0000 (71.7708) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [35/39] time 0.389 (0.476) data 0.258 (0.345) loss_x loss_x 1.1221 (1.1562) acc_x 65.6250 (71.0714) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1489
confident_label rate tensor(0.4168, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1307
clean true:1307
clean false:0
clean_rate:1.0
noisy true:340
noisy false:1489
after delete: len(clean_dataset) 1307
after delete: len(noisy_dataset) 1829
epoch [155/200] batch [5/40] time 0.418 (0.449) data 0.287 (0.318) loss_x loss_x 1.3086 (1.0470) acc_x 68.7500 (74.3750) lr 2.6037e-04 eta 0:00:15
epoch [155/200] batch [10/40] time 0.411 (0.459) data 0.280 (0.327) loss_x loss_x 1.2080 (1.1404) acc_x 71.8750 (71.5625) lr 2.6037e-04 eta 0:00:13
epoch [155/200] batch [15/40] time 0.514 (0.463) data 0.383 (0.332) loss_x loss_x 1.1797 (1.1058) acc_x 68.7500 (72.7083) lr 2.6037e-04 eta 0:00:11
epoch [155/200] batch [20/40] time 0.467 (0.460) data 0.336 (0.329) loss_x loss_x 1.4717 (1.1583) acc_x 59.3750 (71.2500) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [25/40] time 0.440 (0.463) data 0.309 (0.332) loss_x loss_x 1.1426 (1.1942) acc_x 75.0000 (70.2500) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [30/40] time 0.448 (0.461) data 0.317 (0.330) loss_x loss_x 1.2773 (1.1971) acc_x 65.6250 (69.5833) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [35/40] time 0.468 (0.458) data 0.337 (0.327) loss_x loss_x 1.1133 (1.1998) acc_x 68.7500 (69.5536) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [40/40] time 0.371 (0.456) data 0.239 (0.325) loss_x loss_x 1.4678 (1.1812) acc_x 75.0000 (70.0781) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1510
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1284
clean true:1282
clean false:2
clean_rate:0.9984423676012462
noisy true:344
noisy false:1508
after delete: len(clean_dataset) 1284
after delete: len(noisy_dataset) 1852
epoch [156/200] batch [5/40] time 0.454 (0.443) data 0.323 (0.312) loss_x loss_x 1.5234 (1.2433) acc_x 71.8750 (67.5000) lr 2.4989e-04 eta 0:00:15
epoch [156/200] batch [10/40] time 0.433 (0.445) data 0.303 (0.315) loss_x loss_x 0.6636 (1.2131) acc_x 81.2500 (69.3750) lr 2.4989e-04 eta 0:00:13
epoch [156/200] batch [15/40] time 0.384 (0.460) data 0.253 (0.329) loss_x loss_x 1.1602 (1.2176) acc_x 68.7500 (69.5833) lr 2.4989e-04 eta 0:00:11
epoch [156/200] batch [20/40] time 0.620 (0.470) data 0.490 (0.339) loss_x loss_x 1.3936 (1.2412) acc_x 75.0000 (69.5312) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [25/40] time 0.391 (0.460) data 0.260 (0.330) loss_x loss_x 1.2217 (1.2417) acc_x 65.6250 (68.6250) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [30/40] time 0.417 (0.460) data 0.286 (0.329) loss_x loss_x 1.2139 (1.2452) acc_x 65.6250 (68.3333) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [35/40] time 0.460 (0.460) data 0.329 (0.329) loss_x loss_x 1.1943 (1.2312) acc_x 68.7500 (68.7500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [40/40] time 0.549 (0.466) data 0.418 (0.336) loss_x loss_x 0.9463 (1.2293) acc_x 75.0000 (68.9844) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4031, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1264
clean true:1261
clean false:3
clean_rate:0.997626582278481
noisy true:351
noisy false:1521
after delete: len(clean_dataset) 1264
after delete: len(noisy_dataset) 1872
epoch [157/200] batch [5/39] time 0.495 (0.470) data 0.364 (0.339) loss_x loss_x 1.3525 (1.3387) acc_x 62.5000 (63.7500) lr 2.3959e-04 eta 0:00:15
epoch [157/200] batch [10/39] time 0.781 (0.522) data 0.650 (0.391) loss_x loss_x 0.5312 (1.1630) acc_x 93.7500 (71.5625) lr 2.3959e-04 eta 0:00:15
epoch [157/200] batch [15/39] time 0.582 (0.531) data 0.452 (0.400) loss_x loss_x 0.8950 (1.1252) acc_x 75.0000 (71.8750) lr 2.3959e-04 eta 0:00:12
epoch [157/200] batch [20/39] time 0.487 (0.517) data 0.355 (0.386) loss_x loss_x 0.8706 (1.1324) acc_x 71.8750 (71.7188) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [25/39] time 0.461 (0.508) data 0.329 (0.378) loss_x loss_x 1.1494 (1.1231) acc_x 71.8750 (71.7500) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [30/39] time 0.678 (0.507) data 0.547 (0.376) loss_x loss_x 0.9395 (1.1019) acc_x 75.0000 (72.0833) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [35/39] time 0.439 (0.496) data 0.309 (0.365) loss_x loss_x 0.9536 (1.1188) acc_x 78.1250 (71.5179) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1533
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1242
clean true:1241
clean false:1
clean_rate:0.999194847020934
noisy true:362
noisy false:1532
after delete: len(clean_dataset) 1242
after delete: len(noisy_dataset) 1894
epoch [158/200] batch [5/38] time 0.505 (0.590) data 0.375 (0.459) loss_x loss_x 1.1660 (1.2611) acc_x 71.8750 (68.7500) lr 2.2949e-04 eta 0:00:19
epoch [158/200] batch [10/38] time 0.343 (0.512) data 0.213 (0.382) loss_x loss_x 0.9443 (1.1211) acc_x 84.3750 (72.1875) lr 2.2949e-04 eta 0:00:14
epoch [158/200] batch [15/38] time 0.534 (0.507) data 0.403 (0.377) loss_x loss_x 0.6045 (1.0512) acc_x 81.2500 (74.1667) lr 2.2949e-04 eta 0:00:11
epoch [158/200] batch [20/38] time 0.498 (0.501) data 0.367 (0.370) loss_x loss_x 1.3633 (1.0835) acc_x 59.3750 (73.1250) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [25/38] time 0.401 (0.494) data 0.271 (0.363) loss_x loss_x 0.6909 (1.0661) acc_x 84.3750 (74.0000) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [30/38] time 0.447 (0.486) data 0.316 (0.355) loss_x loss_x 1.2275 (1.1034) acc_x 71.8750 (72.5000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [35/38] time 0.461 (0.489) data 0.331 (0.358) loss_x loss_x 1.1973 (1.1014) acc_x 65.6250 (72.5000) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1532
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1274
clean true:1273
clean false:1
clean_rate:0.9992150706436421
noisy true:331
noisy false:1531
after delete: len(clean_dataset) 1274
after delete: len(noisy_dataset) 1862
epoch [159/200] batch [5/39] time 0.502 (0.454) data 0.371 (0.324) loss_x loss_x 1.7881 (1.1493) acc_x 59.3750 (73.7500) lr 2.1957e-04 eta 0:00:15
epoch [159/200] batch [10/39] time 0.478 (0.464) data 0.347 (0.333) loss_x loss_x 0.9556 (1.2642) acc_x 75.0000 (70.3125) lr 2.1957e-04 eta 0:00:13
epoch [159/200] batch [15/39] time 0.571 (0.470) data 0.438 (0.339) loss_x loss_x 1.1172 (1.2283) acc_x 68.7500 (72.5000) lr 2.1957e-04 eta 0:00:11
epoch [159/200] batch [20/39] time 0.411 (0.478) data 0.280 (0.347) loss_x loss_x 1.0713 (1.1844) acc_x 62.5000 (72.6562) lr 2.1957e-04 eta 0:00:09
epoch [159/200] batch [25/39] time 0.417 (0.467) data 0.286 (0.336) loss_x loss_x 1.6143 (1.2114) acc_x 65.6250 (71.6250) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [30/39] time 0.468 (0.469) data 0.338 (0.338) loss_x loss_x 1.5117 (1.1960) acc_x 62.5000 (71.4583) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [35/39] time 0.415 (0.476) data 0.285 (0.345) loss_x loss_x 0.9780 (1.2234) acc_x 75.0000 (70.3571) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1503
confident_label rate tensor(0.4110, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1289
clean true:1285
clean false:4
clean_rate:0.9968968192397207
noisy true:348
noisy false:1499
after delete: len(clean_dataset) 1289
after delete: len(noisy_dataset) 1847
epoch [160/200] batch [5/40] time 0.416 (0.436) data 0.284 (0.305) loss_x loss_x 1.0557 (1.5285) acc_x 71.8750 (64.3750) lr 2.0984e-04 eta 0:00:15
epoch [160/200] batch [10/40] time 0.426 (0.443) data 0.294 (0.312) loss_x loss_x 1.3125 (1.4754) acc_x 78.1250 (68.1250) lr 2.0984e-04 eta 0:00:13
epoch [160/200] batch [15/40] time 0.470 (0.455) data 0.340 (0.325) loss_x loss_x 1.0361 (1.4001) acc_x 81.2500 (67.9167) lr 2.0984e-04 eta 0:00:11
epoch [160/200] batch [20/40] time 0.568 (0.468) data 0.437 (0.337) loss_x loss_x 1.2891 (1.3352) acc_x 59.3750 (68.4375) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [25/40] time 0.374 (0.476) data 0.244 (0.345) loss_x loss_x 1.3369 (1.3248) acc_x 59.3750 (67.8750) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [30/40] time 0.650 (0.480) data 0.519 (0.349) loss_x loss_x 1.1094 (1.2850) acc_x 68.7500 (68.0208) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [35/40] time 0.487 (0.478) data 0.356 (0.348) loss_x loss_x 0.9160 (1.2612) acc_x 75.0000 (68.3036) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [40/40] time 0.378 (0.478) data 0.247 (0.347) loss_x loss_x 1.4541 (1.2868) acc_x 68.7500 (67.5000) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1278
clean true:1276
clean false:2
clean_rate:0.9984350547730829
noisy true:346
noisy false:1512
after delete: len(clean_dataset) 1278
after delete: len(noisy_dataset) 1858
epoch [161/200] batch [5/39] time 0.434 (0.439) data 0.303 (0.309) loss_x loss_x 0.8496 (1.0501) acc_x 71.8750 (70.0000) lr 2.0032e-04 eta 0:00:14
epoch [161/200] batch [10/39] time 0.654 (0.472) data 0.524 (0.342) loss_x loss_x 1.6504 (1.1895) acc_x 59.3750 (70.3125) lr 2.0032e-04 eta 0:00:13
epoch [161/200] batch [15/39] time 0.468 (0.483) data 0.337 (0.353) loss_x loss_x 2.0039 (1.2228) acc_x 53.1250 (70.2083) lr 2.0032e-04 eta 0:00:11
epoch [161/200] batch [20/39] time 0.495 (0.479) data 0.364 (0.348) loss_x loss_x 1.3555 (1.2256) acc_x 65.6250 (69.8438) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [25/39] time 0.487 (0.474) data 0.356 (0.343) loss_x loss_x 1.4141 (1.2238) acc_x 68.7500 (69.5000) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [30/39] time 0.455 (0.473) data 0.324 (0.342) loss_x loss_x 0.8940 (1.2031) acc_x 78.1250 (69.8958) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [35/39] time 0.538 (0.471) data 0.406 (0.341) loss_x loss_x 1.3877 (1.2166) acc_x 68.7500 (69.5536) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1498
confident_label rate tensor(0.4203, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1318
clean true:1316
clean false:2
clean_rate:0.9984825493171472
noisy true:322
noisy false:1496
after delete: len(clean_dataset) 1318
after delete: len(noisy_dataset) 1818
epoch [162/200] batch [5/41] time 0.546 (0.502) data 0.415 (0.372) loss_x loss_x 1.2939 (1.0546) acc_x 56.2500 (71.2500) lr 1.9098e-04 eta 0:00:18
epoch [162/200] batch [10/41] time 0.549 (0.485) data 0.418 (0.354) loss_x loss_x 1.0596 (1.1346) acc_x 71.8750 (68.7500) lr 1.9098e-04 eta 0:00:15
epoch [162/200] batch [15/41] time 0.484 (0.484) data 0.354 (0.353) loss_x loss_x 1.0078 (1.1513) acc_x 75.0000 (69.5833) lr 1.9098e-04 eta 0:00:12
epoch [162/200] batch [20/41] time 0.563 (0.486) data 0.431 (0.355) loss_x loss_x 1.4082 (1.1593) acc_x 71.8750 (70.4688) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [25/41] time 0.416 (0.486) data 0.286 (0.355) loss_x loss_x 1.4355 (1.1856) acc_x 65.6250 (69.6250) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [30/41] time 0.474 (0.481) data 0.344 (0.351) loss_x loss_x 1.0918 (1.2040) acc_x 68.7500 (68.7500) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [35/41] time 0.363 (0.480) data 0.232 (0.349) loss_x loss_x 1.3203 (1.1800) acc_x 71.8750 (69.0179) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [40/41] time 0.424 (0.476) data 0.294 (0.346) loss_x loss_x 1.5820 (1.2042) acc_x 56.2500 (68.5938) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1491
confident_label rate tensor(0.4161, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1305
clean true:1302
clean false:3
clean_rate:0.9977011494252873
noisy true:343
noisy false:1488
after delete: len(clean_dataset) 1305
after delete: len(noisy_dataset) 1831
epoch [163/200] batch [5/40] time 0.489 (0.496) data 0.359 (0.366) loss_x loss_x 1.0449 (1.1600) acc_x 75.0000 (70.6250) lr 1.8185e-04 eta 0:00:17
epoch [163/200] batch [10/40] time 0.440 (0.481) data 0.310 (0.350) loss_x loss_x 0.8027 (1.1316) acc_x 71.8750 (70.6250) lr 1.8185e-04 eta 0:00:14
epoch [163/200] batch [15/40] time 0.464 (0.469) data 0.333 (0.338) loss_x loss_x 1.2324 (1.1548) acc_x 75.0000 (70.4167) lr 1.8185e-04 eta 0:00:11
epoch [163/200] batch [20/40] time 0.358 (0.459) data 0.228 (0.328) loss_x loss_x 1.3398 (1.1685) acc_x 68.7500 (70.6250) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [25/40] time 0.365 (0.449) data 0.235 (0.319) loss_x loss_x 1.1738 (1.1904) acc_x 62.5000 (70.5000) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [30/40] time 0.398 (0.445) data 0.267 (0.314) loss_x loss_x 1.0762 (1.1713) acc_x 71.8750 (70.9375) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [35/40] time 0.521 (0.449) data 0.391 (0.318) loss_x loss_x 1.4199 (1.1818) acc_x 65.6250 (70.4464) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [40/40] time 0.795 (0.457) data 0.665 (0.326) loss_x loss_x 1.1475 (1.1840) acc_x 71.8750 (70.4688) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1244
clean true:1240
clean false:4
clean_rate:0.9967845659163987
noisy true:347
noisy false:1545
after delete: len(clean_dataset) 1244
after delete: len(noisy_dataset) 1892
epoch [164/200] batch [5/38] time 0.565 (0.536) data 0.434 (0.405) loss_x loss_x 1.3125 (1.2995) acc_x 71.8750 (67.5000) lr 1.7292e-04 eta 0:00:17
epoch [164/200] batch [10/38] time 0.449 (0.489) data 0.318 (0.359) loss_x loss_x 1.4199 (1.2676) acc_x 59.3750 (67.5000) lr 1.7292e-04 eta 0:00:13
epoch [164/200] batch [15/38] time 0.371 (0.486) data 0.241 (0.355) loss_x loss_x 1.4736 (1.3211) acc_x 71.8750 (67.0833) lr 1.7292e-04 eta 0:00:11
epoch [164/200] batch [20/38] time 0.487 (0.481) data 0.355 (0.350) loss_x loss_x 1.1777 (1.2595) acc_x 65.6250 (68.5938) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [25/38] time 0.543 (0.487) data 0.412 (0.356) loss_x loss_x 1.3711 (1.2753) acc_x 59.3750 (68.7500) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [30/38] time 0.554 (0.482) data 0.424 (0.351) loss_x loss_x 0.7690 (1.2428) acc_x 87.5000 (70.2083) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [35/38] time 0.500 (0.486) data 0.369 (0.355) loss_x loss_x 1.3506 (1.2402) acc_x 68.7500 (70.4464) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.4018, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1260
clean true:1257
clean false:3
clean_rate:0.9976190476190476
noisy true:349
noisy false:1527
after delete: len(clean_dataset) 1260
after delete: len(noisy_dataset) 1876
epoch [165/200] batch [5/39] time 0.482 (0.470) data 0.352 (0.340) loss_x loss_x 1.0039 (1.2123) acc_x 75.0000 (70.6250) lr 1.6419e-04 eta 0:00:15
epoch [165/200] batch [10/39] time 0.384 (0.475) data 0.252 (0.344) loss_x loss_x 1.3848 (1.2902) acc_x 56.2500 (68.4375) lr 1.6419e-04 eta 0:00:13
epoch [165/200] batch [15/39] time 0.510 (0.496) data 0.379 (0.365) loss_x loss_x 1.3027 (1.2496) acc_x 62.5000 (68.1250) lr 1.6419e-04 eta 0:00:11
epoch [165/200] batch [20/39] time 0.481 (0.488) data 0.350 (0.357) loss_x loss_x 1.2090 (1.2184) acc_x 65.6250 (68.5938) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [25/39] time 0.424 (0.488) data 0.293 (0.358) loss_x loss_x 1.9102 (1.2591) acc_x 50.0000 (68.0000) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [30/39] time 0.527 (0.487) data 0.395 (0.357) loss_x loss_x 1.9736 (1.2676) acc_x 53.1250 (68.4375) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [35/39] time 0.573 (0.490) data 0.443 (0.359) loss_x loss_x 0.6792 (1.2442) acc_x 81.2500 (68.8393) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1515
confident_label rate tensor(0.4098, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1285
clean true:1281
clean false:4
clean_rate:0.9968871595330739
noisy true:340
noisy false:1511
after delete: len(clean_dataset) 1285
after delete: len(noisy_dataset) 1851
epoch [166/200] batch [5/40] time 0.561 (0.488) data 0.431 (0.358) loss_x loss_x 1.0996 (1.0653) acc_x 84.3750 (75.6250) lr 1.5567e-04 eta 0:00:17
epoch [166/200] batch [10/40] time 0.542 (0.490) data 0.412 (0.360) loss_x loss_x 0.9404 (1.1296) acc_x 71.8750 (72.5000) lr 1.5567e-04 eta 0:00:14
epoch [166/200] batch [15/40] time 0.350 (0.483) data 0.220 (0.353) loss_x loss_x 1.1895 (1.1156) acc_x 65.6250 (71.0417) lr 1.5567e-04 eta 0:00:12
epoch [166/200] batch [20/40] time 0.436 (0.485) data 0.306 (0.355) loss_x loss_x 0.9038 (1.1249) acc_x 71.8750 (71.2500) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [25/40] time 0.414 (0.484) data 0.284 (0.353) loss_x loss_x 1.5020 (1.1825) acc_x 65.6250 (69.8750) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [30/40] time 0.360 (0.479) data 0.230 (0.348) loss_x loss_x 0.9414 (1.1933) acc_x 71.8750 (69.8958) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [35/40] time 0.457 (0.476) data 0.325 (0.345) loss_x loss_x 0.8105 (1.1828) acc_x 78.1250 (69.9107) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [40/40] time 0.354 (0.481) data 0.224 (0.351) loss_x loss_x 1.3125 (1.1820) acc_x 68.7500 (69.7656) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1544
confident_label rate tensor(0.3976, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1247
clean true:1245
clean false:2
clean_rate:0.9983961507618284
noisy true:347
noisy false:1542
after delete: len(clean_dataset) 1247
after delete: len(noisy_dataset) 1889
epoch [167/200] batch [5/38] time 0.370 (0.512) data 0.240 (0.382) loss_x loss_x 1.5938 (1.3535) acc_x 56.2500 (67.5000) lr 1.4736e-04 eta 0:00:16
epoch [167/200] batch [10/38] time 0.397 (0.475) data 0.267 (0.344) loss_x loss_x 1.3184 (1.2633) acc_x 62.5000 (68.7500) lr 1.4736e-04 eta 0:00:13
epoch [167/200] batch [15/38] time 0.465 (0.463) data 0.335 (0.333) loss_x loss_x 1.6328 (1.2342) acc_x 59.3750 (70.0000) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [20/38] time 0.414 (0.465) data 0.283 (0.335) loss_x loss_x 1.3359 (1.2429) acc_x 65.6250 (69.2188) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [25/38] time 0.441 (0.465) data 0.310 (0.334) loss_x loss_x 0.9634 (1.1952) acc_x 78.1250 (70.2500) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [30/38] time 0.383 (0.470) data 0.251 (0.339) loss_x loss_x 1.8574 (1.2207) acc_x 65.6250 (69.6875) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [35/38] time 0.494 (0.475) data 0.363 (0.345) loss_x loss_x 0.9873 (1.2069) acc_x 71.8750 (69.8214) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1536
confident_label rate tensor(0.4015, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1259
clean true:1254
clean false:5
clean_rate:0.9960285941223193
noisy true:346
noisy false:1531
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 1877
epoch [168/200] batch [5/39] time 0.393 (0.442) data 0.262 (0.311) loss_x loss_x 0.9565 (1.5159) acc_x 75.0000 (65.0000) lr 1.3926e-04 eta 0:00:15
epoch [168/200] batch [10/39] time 0.564 (0.480) data 0.433 (0.350) loss_x loss_x 1.2256 (1.2987) acc_x 62.5000 (70.3125) lr 1.3926e-04 eta 0:00:13
epoch [168/200] batch [15/39] time 0.427 (0.485) data 0.297 (0.355) loss_x loss_x 1.1592 (1.2560) acc_x 81.2500 (70.6250) lr 1.3926e-04 eta 0:00:11
epoch [168/200] batch [20/39] time 0.355 (0.482) data 0.224 (0.351) loss_x loss_x 1.1084 (1.2447) acc_x 71.8750 (70.9375) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [25/39] time 0.529 (0.478) data 0.399 (0.347) loss_x loss_x 0.9087 (1.2286) acc_x 81.2500 (71.2500) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [30/39] time 0.497 (0.469) data 0.366 (0.338) loss_x loss_x 1.1113 (1.2331) acc_x 78.1250 (71.2500) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [35/39] time 0.432 (0.469) data 0.301 (0.339) loss_x loss_x 1.2207 (1.1966) acc_x 65.6250 (71.3393) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1516
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1280
clean true:1278
clean false:2
clean_rate:0.9984375
noisy true:342
noisy false:1514
after delete: len(clean_dataset) 1280
after delete: len(noisy_dataset) 1856
epoch [169/200] batch [5/40] time 0.482 (0.483) data 0.351 (0.352) loss_x loss_x 1.0488 (1.1061) acc_x 71.8750 (74.3750) lr 1.3137e-04 eta 0:00:16
epoch [169/200] batch [10/40] time 0.416 (0.458) data 0.285 (0.327) loss_x loss_x 1.2061 (1.2463) acc_x 62.5000 (70.6250) lr 1.3137e-04 eta 0:00:13
epoch [169/200] batch [15/40] time 0.569 (0.459) data 0.438 (0.328) loss_x loss_x 1.2529 (1.1896) acc_x 65.6250 (72.2917) lr 1.3137e-04 eta 0:00:11
epoch [169/200] batch [20/40] time 0.480 (0.477) data 0.350 (0.347) loss_x loss_x 0.8276 (1.1968) acc_x 87.5000 (72.3438) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [25/40] time 0.455 (0.479) data 0.324 (0.348) loss_x loss_x 1.6299 (1.2079) acc_x 78.1250 (72.7500) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [30/40] time 0.439 (0.477) data 0.307 (0.346) loss_x loss_x 0.8730 (1.2183) acc_x 78.1250 (71.9792) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [35/40] time 0.361 (0.468) data 0.231 (0.338) loss_x loss_x 1.2354 (1.2297) acc_x 65.6250 (71.3393) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [40/40] time 0.544 (0.474) data 0.413 (0.343) loss_x loss_x 1.2773 (1.2384) acc_x 65.6250 (70.8594) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1560
confident_label rate tensor(0.3913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1227
clean true:1224
clean false:3
clean_rate:0.9975550122249389
noisy true:352
noisy false:1557
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 1909
epoch [170/200] batch [5/38] time 0.625 (0.521) data 0.495 (0.390) loss_x loss_x 0.9692 (0.9459) acc_x 68.7500 (78.7500) lr 1.2369e-04 eta 0:00:17
epoch [170/200] batch [10/38] time 0.524 (0.490) data 0.394 (0.359) loss_x loss_x 0.9214 (1.1523) acc_x 78.1250 (73.4375) lr 1.2369e-04 eta 0:00:13
epoch [170/200] batch [15/38] time 0.362 (0.476) data 0.231 (0.346) loss_x loss_x 1.7158 (1.1481) acc_x 62.5000 (72.0833) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [20/38] time 0.475 (0.476) data 0.345 (0.345) loss_x loss_x 1.3164 (1.1355) acc_x 71.8750 (72.0312) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [25/38] time 0.473 (0.489) data 0.343 (0.358) loss_x loss_x 1.6387 (1.1690) acc_x 56.2500 (71.5000) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [30/38] time 0.411 (0.485) data 0.280 (0.354) loss_x loss_x 1.1201 (1.1805) acc_x 78.1250 (71.2500) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [35/38] time 0.350 (0.482) data 0.218 (0.352) loss_x loss_x 2.0566 (1.1798) acc_x 62.5000 (71.6071) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1518
confident_label rate tensor(0.4040, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1267
clean true:1265
clean false:2
clean_rate:0.9984214680347278
noisy true:353
noisy false:1516
after delete: len(clean_dataset) 1267
after delete: len(noisy_dataset) 1869
epoch [171/200] batch [5/39] time 0.526 (0.501) data 0.395 (0.371) loss_x loss_x 0.8740 (1.1764) acc_x 81.2500 (70.0000) lr 1.1623e-04 eta 0:00:17
epoch [171/200] batch [10/39] time 0.492 (0.475) data 0.362 (0.344) loss_x loss_x 1.3721 (1.2722) acc_x 65.6250 (69.3750) lr 1.1623e-04 eta 0:00:13
epoch [171/200] batch [15/39] time 0.479 (0.467) data 0.347 (0.336) loss_x loss_x 0.8765 (1.2674) acc_x 81.2500 (69.7917) lr 1.1623e-04 eta 0:00:11
epoch [171/200] batch [20/39] time 0.452 (0.461) data 0.321 (0.331) loss_x loss_x 1.3408 (1.2729) acc_x 62.5000 (69.5312) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [25/39] time 0.572 (0.470) data 0.442 (0.339) loss_x loss_x 1.8779 (1.2939) acc_x 59.3750 (69.3750) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [30/39] time 0.527 (0.480) data 0.395 (0.350) loss_x loss_x 0.6992 (1.2544) acc_x 81.2500 (69.5833) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [35/39] time 0.646 (0.485) data 0.515 (0.354) loss_x loss_x 1.0723 (1.2432) acc_x 68.7500 (70.0000) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1525
confident_label rate tensor(0.4037, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1266
clean true:1265
clean false:1
clean_rate:0.9992101105845181
noisy true:346
noisy false:1524
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 1870
epoch [172/200] batch [5/39] time 0.471 (0.479) data 0.340 (0.348) loss_x loss_x 1.0439 (1.1480) acc_x 78.1250 (70.6250) lr 1.0899e-04 eta 0:00:16
epoch [172/200] batch [10/39] time 0.430 (0.495) data 0.300 (0.364) loss_x loss_x 0.9639 (1.0263) acc_x 75.0000 (75.0000) lr 1.0899e-04 eta 0:00:14
epoch [172/200] batch [15/39] time 0.400 (0.486) data 0.270 (0.356) loss_x loss_x 1.1768 (1.0335) acc_x 65.6250 (74.3750) lr 1.0899e-04 eta 0:00:11
epoch [172/200] batch [20/39] time 0.553 (0.479) data 0.422 (0.349) loss_x loss_x 0.8047 (1.0700) acc_x 81.2500 (73.5938) lr 1.0899e-04 eta 0:00:09
epoch [172/200] batch [25/39] time 0.500 (0.482) data 0.369 (0.351) loss_x loss_x 0.7974 (1.1277) acc_x 71.8750 (72.2500) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [30/39] time 0.491 (0.482) data 0.360 (0.351) loss_x loss_x 0.9819 (1.1342) acc_x 75.0000 (72.1875) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [35/39] time 0.450 (0.482) data 0.319 (0.351) loss_x loss_x 1.1484 (1.1650) acc_x 62.5000 (71.4286) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1485
confident_label rate tensor(0.4145, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1300
clean true:1298
clean false:2
clean_rate:0.9984615384615385
noisy true:353
noisy false:1483
after delete: len(clean_dataset) 1300
after delete: len(noisy_dataset) 1836
epoch [173/200] batch [5/40] time 0.592 (0.509) data 0.462 (0.378) loss_x loss_x 1.1104 (0.9688) acc_x 78.1250 (75.6250) lr 1.0197e-04 eta 0:00:17
epoch [173/200] batch [10/40] time 0.533 (0.480) data 0.403 (0.350) loss_x loss_x 1.3057 (1.1132) acc_x 71.8750 (72.8125) lr 1.0197e-04 eta 0:00:14
epoch [173/200] batch [15/40] time 0.427 (0.495) data 0.296 (0.365) loss_x loss_x 1.1768 (1.1362) acc_x 78.1250 (71.6667) lr 1.0197e-04 eta 0:00:12
epoch [173/200] batch [20/40] time 0.394 (0.476) data 0.263 (0.345) loss_x loss_x 1.5098 (1.1468) acc_x 68.7500 (70.7812) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [25/40] time 0.418 (0.470) data 0.287 (0.339) loss_x loss_x 0.9053 (1.1208) acc_x 71.8750 (71.6250) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [30/40] time 0.572 (0.477) data 0.442 (0.346) loss_x loss_x 1.3438 (1.1022) acc_x 62.5000 (72.1875) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [35/40] time 0.583 (0.479) data 0.453 (0.348) loss_x loss_x 1.5850 (1.1261) acc_x 62.5000 (71.5179) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [40/40] time 0.457 (0.476) data 0.327 (0.345) loss_x loss_x 1.3486 (1.1408) acc_x 56.2500 (70.8594) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4098, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1285
clean true:1282
clean false:3
clean_rate:0.9976653696498055
noisy true:359
noisy false:1492
after delete: len(clean_dataset) 1285
after delete: len(noisy_dataset) 1851
epoch [174/200] batch [5/40] time 0.585 (0.455) data 0.455 (0.324) loss_x loss_x 1.4648 (1.2318) acc_x 75.0000 (75.6250) lr 9.5173e-05 eta 0:00:15
epoch [174/200] batch [10/40] time 0.533 (0.468) data 0.402 (0.337) loss_x loss_x 1.1709 (1.2307) acc_x 65.6250 (70.6250) lr 9.5173e-05 eta 0:00:14
epoch [174/200] batch [15/40] time 0.560 (0.481) data 0.429 (0.350) loss_x loss_x 1.5430 (1.2537) acc_x 65.6250 (70.0000) lr 9.5173e-05 eta 0:00:12
epoch [174/200] batch [20/40] time 0.422 (0.492) data 0.292 (0.362) loss_x loss_x 1.1260 (1.2972) acc_x 71.8750 (68.5938) lr 9.5173e-05 eta 0:00:09
epoch [174/200] batch [25/40] time 0.446 (0.499) data 0.315 (0.369) loss_x loss_x 0.8877 (1.2216) acc_x 81.2500 (70.3750) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [30/40] time 0.416 (0.497) data 0.285 (0.366) loss_x loss_x 1.3516 (1.2115) acc_x 65.6250 (70.1042) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [35/40] time 0.443 (0.497) data 0.313 (0.366) loss_x loss_x 0.8115 (1.1708) acc_x 90.6250 (71.3393) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [40/40] time 0.419 (0.491) data 0.289 (0.361) loss_x loss_x 1.2002 (1.1732) acc_x 65.6250 (70.8594) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.4059, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1273
clean true:1267
clean false:6
clean_rate:0.99528672427337
noisy true:342
noisy false:1521
after delete: len(clean_dataset) 1273
after delete: len(noisy_dataset) 1863
epoch [175/200] batch [5/39] time 0.486 (0.488) data 0.356 (0.357) loss_x loss_x 1.2588 (1.3355) acc_x 65.6250 (66.8750) lr 8.8597e-05 eta 0:00:16
epoch [175/200] batch [10/39] time 0.545 (0.468) data 0.414 (0.337) loss_x loss_x 1.2744 (1.3113) acc_x 56.2500 (66.8750) lr 8.8597e-05 eta 0:00:13
epoch [175/200] batch [15/39] time 0.376 (0.458) data 0.244 (0.327) loss_x loss_x 1.1709 (1.3092) acc_x 75.0000 (67.5000) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [20/39] time 0.482 (0.456) data 0.352 (0.325) loss_x loss_x 1.3232 (1.2881) acc_x 56.2500 (67.3438) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [25/39] time 0.463 (0.463) data 0.332 (0.332) loss_x loss_x 0.9902 (1.2738) acc_x 81.2500 (68.6250) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [30/39] time 0.533 (0.467) data 0.403 (0.336) loss_x loss_x 1.5479 (1.2681) acc_x 68.7500 (69.1667) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [35/39] time 0.456 (0.465) data 0.325 (0.334) loss_x loss_x 1.3555 (1.2672) acc_x 68.7500 (69.0179) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1517
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1284
clean true:1284
clean false:0
clean_rate:1.0
noisy true:335
noisy false:1517
after delete: len(clean_dataset) 1284
after delete: len(noisy_dataset) 1852
epoch [176/200] batch [5/40] time 0.499 (0.449) data 0.368 (0.318) loss_x loss_x 1.0859 (1.1575) acc_x 78.1250 (70.6250) lr 8.2245e-05 eta 0:00:15
epoch [176/200] batch [10/40] time 0.454 (0.458) data 0.323 (0.327) loss_x loss_x 1.3379 (1.1665) acc_x 62.5000 (70.9375) lr 8.2245e-05 eta 0:00:13
epoch [176/200] batch [15/40] time 0.474 (0.446) data 0.342 (0.316) loss_x loss_x 1.4404 (1.1943) acc_x 62.5000 (70.0000) lr 8.2245e-05 eta 0:00:11
epoch [176/200] batch [20/40] time 0.460 (0.452) data 0.328 (0.322) loss_x loss_x 1.4297 (1.2148) acc_x 65.6250 (70.4688) lr 8.2245e-05 eta 0:00:09
epoch [176/200] batch [25/40] time 0.612 (0.458) data 0.482 (0.328) loss_x loss_x 1.5186 (1.2438) acc_x 65.6250 (69.5000) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [30/40] time 0.465 (0.457) data 0.334 (0.327) loss_x loss_x 1.6494 (1.2629) acc_x 59.3750 (69.0625) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [35/40] time 0.415 (0.454) data 0.284 (0.323) loss_x loss_x 0.9258 (1.2570) acc_x 81.2500 (69.2857) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [40/40] time 0.530 (0.454) data 0.400 (0.323) loss_x loss_x 1.2988 (1.2420) acc_x 78.1250 (69.9219) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.3951, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1239
clean true:1237
clean false:2
clean_rate:0.9983857949959645
noisy true:336
noisy false:1561
after delete: len(clean_dataset) 1239
after delete: len(noisy_dataset) 1897
epoch [177/200] batch [5/38] time 0.435 (0.442) data 0.304 (0.311) loss_x loss_x 0.6113 (1.0723) acc_x 87.5000 (73.7500) lr 7.6120e-05 eta 0:00:14
epoch [177/200] batch [10/38] time 0.376 (0.430) data 0.245 (0.299) loss_x loss_x 1.7314 (1.1460) acc_x 56.2500 (70.6250) lr 7.6120e-05 eta 0:00:12
epoch [177/200] batch [15/38] time 0.622 (0.452) data 0.492 (0.322) loss_x loss_x 1.0781 (1.1600) acc_x 68.7500 (70.4167) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [20/38] time 0.440 (0.453) data 0.309 (0.323) loss_x loss_x 1.4199 (1.1428) acc_x 62.5000 (70.1562) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [25/38] time 0.499 (0.462) data 0.369 (0.331) loss_x loss_x 1.1914 (1.1432) acc_x 71.8750 (70.7500) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [30/38] time 0.446 (0.468) data 0.316 (0.338) loss_x loss_x 1.1748 (1.1234) acc_x 71.8750 (71.1458) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [35/38] time 0.445 (0.471) data 0.315 (0.341) loss_x loss_x 0.8174 (1.1233) acc_x 78.1250 (71.4286) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1515
confident_label rate tensor(0.3996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1253
clean true:1253
clean false:0
clean_rate:1.0
noisy true:368
noisy false:1515
after delete: len(clean_dataset) 1253
after delete: len(noisy_dataset) 1883
epoch [178/200] batch [5/39] time 0.473 (0.464) data 0.342 (0.333) loss_x loss_x 0.8359 (1.1759) acc_x 81.2500 (70.0000) lr 7.0224e-05 eta 0:00:15
epoch [178/200] batch [10/39] time 0.378 (0.455) data 0.247 (0.325) loss_x loss_x 1.3154 (1.2810) acc_x 71.8750 (67.5000) lr 7.0224e-05 eta 0:00:13
epoch [178/200] batch [15/39] time 0.517 (0.482) data 0.385 (0.352) loss_x loss_x 1.2734 (1.2036) acc_x 68.7500 (69.3750) lr 7.0224e-05 eta 0:00:11
epoch [178/200] batch [20/39] time 0.580 (0.493) data 0.448 (0.363) loss_x loss_x 1.6270 (1.2573) acc_x 62.5000 (68.4375) lr 7.0224e-05 eta 0:00:09
epoch [178/200] batch [25/39] time 0.474 (0.495) data 0.343 (0.365) loss_x loss_x 0.8286 (1.2348) acc_x 78.1250 (69.2500) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [30/39] time 0.339 (0.492) data 0.208 (0.361) loss_x loss_x 1.0293 (1.2328) acc_x 78.1250 (69.7917) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [35/39] time 0.455 (0.490) data 0.324 (0.359) loss_x loss_x 0.9399 (1.2454) acc_x 75.0000 (69.2857) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1533
confident_label rate tensor(0.4034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1265
clean true:1264
clean false:1
clean_rate:0.9992094861660079
noisy true:339
noisy false:1532
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 1871
epoch [179/200] batch [5/39] time 0.354 (0.475) data 0.223 (0.343) loss_x loss_x 1.5859 (1.1846) acc_x 56.2500 (70.6250) lr 6.4556e-05 eta 0:00:16
epoch [179/200] batch [10/39] time 0.393 (0.471) data 0.263 (0.340) loss_x loss_x 0.8779 (1.1543) acc_x 71.8750 (70.3125) lr 6.4556e-05 eta 0:00:13
epoch [179/200] batch [15/39] time 0.454 (0.452) data 0.323 (0.320) loss_x loss_x 1.5391 (1.2093) acc_x 59.3750 (69.1667) lr 6.4556e-05 eta 0:00:10
epoch [179/200] batch [20/39] time 0.397 (0.463) data 0.266 (0.331) loss_x loss_x 1.5186 (1.2415) acc_x 62.5000 (68.9062) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [25/39] time 0.415 (0.472) data 0.285 (0.341) loss_x loss_x 1.0586 (1.2772) acc_x 78.1250 (68.2500) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [30/39] time 0.478 (0.468) data 0.347 (0.338) loss_x loss_x 0.6074 (1.2220) acc_x 84.3750 (68.5417) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [35/39] time 0.485 (0.467) data 0.353 (0.336) loss_x loss_x 0.4612 (1.1886) acc_x 87.5000 (69.3750) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1494
confident_label rate tensor(0.4101, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1286
clean true:1286
clean false:0
clean_rate:1.0
noisy true:356
noisy false:1494
after delete: len(clean_dataset) 1286
after delete: len(noisy_dataset) 1850
epoch [180/200] batch [5/40] time 0.619 (0.504) data 0.487 (0.372) loss_x loss_x 0.8755 (1.0515) acc_x 81.2500 (68.7500) lr 5.9119e-05 eta 0:00:17
epoch [180/200] batch [10/40] time 0.474 (0.487) data 0.343 (0.356) loss_x loss_x 1.0293 (1.0291) acc_x 71.8750 (70.6250) lr 5.9119e-05 eta 0:00:14
epoch [180/200] batch [15/40] time 0.590 (0.508) data 0.460 (0.377) loss_x loss_x 0.9185 (1.0644) acc_x 71.8750 (70.0000) lr 5.9119e-05 eta 0:00:12
epoch [180/200] batch [20/40] time 0.421 (0.494) data 0.290 (0.363) loss_x loss_x 1.1367 (1.1098) acc_x 75.0000 (70.3125) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [25/40] time 0.516 (0.490) data 0.385 (0.359) loss_x loss_x 1.2305 (1.1455) acc_x 68.7500 (69.3750) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [30/40] time 0.464 (0.490) data 0.333 (0.360) loss_x loss_x 1.2363 (1.1494) acc_x 65.6250 (69.3750) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [35/40] time 0.434 (0.485) data 0.304 (0.355) loss_x loss_x 1.3008 (1.1523) acc_x 65.6250 (69.4643) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [40/40] time 0.329 (0.479) data 0.199 (0.348) loss_x loss_x 1.6660 (1.1619) acc_x 62.5000 (69.7656) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1525
confident_label rate tensor(0.4024, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1262
clean true:1262
clean false:0
clean_rate:1.0
noisy true:349
noisy false:1525
after delete: len(clean_dataset) 1262
after delete: len(noisy_dataset) 1874
epoch [181/200] batch [5/39] time 0.547 (0.512) data 0.416 (0.381) loss_x loss_x 1.1602 (1.1013) acc_x 75.0000 (70.0000) lr 5.3915e-05 eta 0:00:17
epoch [181/200] batch [10/39] time 0.497 (0.491) data 0.366 (0.360) loss_x loss_x 0.9692 (1.1075) acc_x 78.1250 (71.5625) lr 5.3915e-05 eta 0:00:14
epoch [181/200] batch [15/39] time 0.597 (0.493) data 0.466 (0.362) loss_x loss_x 1.1914 (1.0998) acc_x 75.0000 (73.1250) lr 5.3915e-05 eta 0:00:11
epoch [181/200] batch [20/39] time 0.479 (0.487) data 0.347 (0.356) loss_x loss_x 1.2090 (1.1547) acc_x 75.0000 (72.3438) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [25/39] time 0.632 (0.491) data 0.502 (0.360) loss_x loss_x 1.2451 (1.1562) acc_x 65.6250 (71.3750) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [30/39] time 0.411 (0.482) data 0.281 (0.351) loss_x loss_x 1.4541 (1.2048) acc_x 62.5000 (70.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [35/39] time 0.365 (0.472) data 0.233 (0.341) loss_x loss_x 1.5488 (1.2410) acc_x 68.7500 (68.9286) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.3980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1248
clean true:1246
clean false:2
clean_rate:0.9983974358974359
noisy true:347
noisy false:1541
after delete: len(clean_dataset) 1248
after delete: len(noisy_dataset) 1888
epoch [182/200] batch [5/39] time 0.495 (0.513) data 0.365 (0.382) loss_x loss_x 0.9766 (1.1996) acc_x 78.1250 (70.6250) lr 4.8943e-05 eta 0:00:17
epoch [182/200] batch [10/39] time 0.572 (0.498) data 0.442 (0.367) loss_x loss_x 1.4854 (1.2603) acc_x 71.8750 (68.4375) lr 4.8943e-05 eta 0:00:14
epoch [182/200] batch [15/39] time 0.455 (0.489) data 0.324 (0.358) loss_x loss_x 1.0527 (1.2554) acc_x 71.8750 (68.1250) lr 4.8943e-05 eta 0:00:11
epoch [182/200] batch [20/39] time 0.585 (0.497) data 0.455 (0.366) loss_x loss_x 0.7827 (1.2496) acc_x 81.2500 (68.9062) lr 4.8943e-05 eta 0:00:09
epoch [182/200] batch [25/39] time 0.455 (0.496) data 0.325 (0.365) loss_x loss_x 0.7969 (1.1932) acc_x 81.2500 (69.8750) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [30/39] time 0.471 (0.495) data 0.341 (0.364) loss_x loss_x 0.6968 (1.1882) acc_x 81.2500 (70.1042) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [35/39] time 0.466 (0.491) data 0.334 (0.360) loss_x loss_x 1.6895 (1.1889) acc_x 53.1250 (69.8214) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1504
confident_label rate tensor(0.4117, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1291
clean true:1288
clean false:3
clean_rate:0.9976762199845082
noisy true:344
noisy false:1501
after delete: len(clean_dataset) 1291
after delete: len(noisy_dataset) 1845
epoch [183/200] batch [5/40] time 0.531 (0.506) data 0.401 (0.375) loss_x loss_x 1.4658 (1.4504) acc_x 56.2500 (61.8750) lr 4.4207e-05 eta 0:00:17
epoch [183/200] batch [10/40] time 0.544 (0.500) data 0.414 (0.369) loss_x loss_x 1.0947 (1.2545) acc_x 71.8750 (66.8750) lr 4.4207e-05 eta 0:00:15
epoch [183/200] batch [15/40] time 0.518 (0.491) data 0.388 (0.361) loss_x loss_x 1.2578 (1.3219) acc_x 84.3750 (66.4583) lr 4.4207e-05 eta 0:00:12
epoch [183/200] batch [20/40] time 0.391 (0.491) data 0.261 (0.361) loss_x loss_x 1.1045 (1.2874) acc_x 75.0000 (66.8750) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [25/40] time 0.605 (0.498) data 0.474 (0.368) loss_x loss_x 1.4229 (1.2894) acc_x 71.8750 (67.5000) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [30/40] time 0.416 (0.492) data 0.286 (0.361) loss_x loss_x 1.4609 (1.2887) acc_x 65.6250 (67.7083) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [35/40] time 0.467 (0.499) data 0.336 (0.368) loss_x loss_x 1.4463 (1.2665) acc_x 56.2500 (67.7679) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [40/40] time 0.429 (0.491) data 0.298 (0.360) loss_x loss_x 1.7158 (1.2868) acc_x 65.6250 (67.8906) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1532
confident_label rate tensor(0.4008, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1257
clean true:1255
clean false:2
clean_rate:0.9984089101034208
noisy true:349
noisy false:1530
after delete: len(clean_dataset) 1257
after delete: len(noisy_dataset) 1879
epoch [184/200] batch [5/39] time 0.595 (0.498) data 0.464 (0.367) loss_x loss_x 1.4766 (1.2209) acc_x 71.8750 (72.5000) lr 3.9706e-05 eta 0:00:16
epoch [184/200] batch [10/39] time 0.627 (0.476) data 0.497 (0.346) loss_x loss_x 0.7993 (1.2714) acc_x 87.5000 (70.6250) lr 3.9706e-05 eta 0:00:13
epoch [184/200] batch [15/39] time 0.533 (0.471) data 0.403 (0.340) loss_x loss_x 0.7935 (1.2243) acc_x 71.8750 (70.4167) lr 3.9706e-05 eta 0:00:11
epoch [184/200] batch [20/39] time 0.492 (0.483) data 0.362 (0.353) loss_x loss_x 1.3047 (1.2179) acc_x 65.6250 (70.0000) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [25/39] time 0.465 (0.474) data 0.334 (0.344) loss_x loss_x 1.3271 (1.2113) acc_x 59.3750 (69.6250) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [30/39] time 0.444 (0.470) data 0.314 (0.339) loss_x loss_x 1.0088 (1.2070) acc_x 71.8750 (69.1667) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [35/39] time 0.417 (0.471) data 0.286 (0.340) loss_x loss_x 1.3457 (1.2004) acc_x 59.3750 (69.4643) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1279
clean true:1279
clean false:0
clean_rate:1.0
noisy true:343
noisy false:1514
after delete: len(clean_dataset) 1279
after delete: len(noisy_dataset) 1857
epoch [185/200] batch [5/39] time 0.391 (0.482) data 0.260 (0.351) loss_x loss_x 0.7622 (1.0370) acc_x 78.1250 (75.6250) lr 3.5443e-05 eta 0:00:16
epoch [185/200] batch [10/39] time 0.412 (0.449) data 0.281 (0.318) loss_x loss_x 1.1426 (1.0461) acc_x 65.6250 (75.6250) lr 3.5443e-05 eta 0:00:13
epoch [185/200] batch [15/39] time 0.534 (0.454) data 0.403 (0.323) loss_x loss_x 1.1504 (1.0918) acc_x 62.5000 (73.3333) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [20/39] time 0.403 (0.467) data 0.272 (0.336) loss_x loss_x 1.1133 (1.1389) acc_x 62.5000 (71.7188) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [25/39] time 0.398 (0.460) data 0.267 (0.329) loss_x loss_x 1.3730 (1.1757) acc_x 68.7500 (71.2500) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [30/39] time 0.481 (0.458) data 0.350 (0.327) loss_x loss_x 0.6533 (1.1458) acc_x 87.5000 (71.6667) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [35/39] time 0.565 (0.457) data 0.434 (0.326) loss_x loss_x 0.9766 (1.1248) acc_x 71.8750 (71.6964) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4129, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1295
clean true:1294
clean false:1
clean_rate:0.9992277992277993
noisy true:347
noisy false:1494
after delete: len(clean_dataset) 1295
after delete: len(noisy_dataset) 1841
epoch [186/200] batch [5/40] time 0.408 (0.447) data 0.277 (0.316) loss_x loss_x 1.2148 (1.1067) acc_x 65.6250 (70.0000) lr 3.1417e-05 eta 0:00:15
epoch [186/200] batch [10/40] time 0.435 (0.455) data 0.305 (0.323) loss_x loss_x 1.4834 (1.2091) acc_x 68.7500 (67.8125) lr 3.1417e-05 eta 0:00:13
epoch [186/200] batch [15/40] time 0.449 (0.446) data 0.318 (0.314) loss_x loss_x 1.5713 (1.1805) acc_x 56.2500 (69.1667) lr 3.1417e-05 eta 0:00:11
epoch [186/200] batch [20/40] time 0.659 (0.457) data 0.528 (0.326) loss_x loss_x 1.0244 (1.1674) acc_x 75.0000 (69.8438) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [25/40] time 0.456 (0.458) data 0.326 (0.327) loss_x loss_x 1.4121 (1.1586) acc_x 71.8750 (70.6250) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [30/40] time 0.501 (0.462) data 0.371 (0.331) loss_x loss_x 0.9248 (1.1672) acc_x 81.2500 (70.7292) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [35/40] time 0.507 (0.462) data 0.377 (0.332) loss_x loss_x 1.3184 (1.1542) acc_x 62.5000 (70.9821) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [40/40] time 0.352 (0.459) data 0.223 (0.328) loss_x loss_x 0.9775 (1.1582) acc_x 78.1250 (70.6250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4110, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1289
clean true:1289
clean false:0
clean_rate:1.0
noisy true:374
noisy false:1473
after delete: len(clean_dataset) 1289
after delete: len(noisy_dataset) 1847
epoch [187/200] batch [5/40] time 0.399 (0.424) data 0.267 (0.293) loss_x loss_x 0.9888 (1.1799) acc_x 84.3750 (73.7500) lr 2.7630e-05 eta 0:00:14
epoch [187/200] batch [10/40] time 0.460 (0.444) data 0.329 (0.312) loss_x loss_x 1.0586 (1.1566) acc_x 84.3750 (73.4375) lr 2.7630e-05 eta 0:00:13
epoch [187/200] batch [15/40] time 0.595 (0.461) data 0.464 (0.330) loss_x loss_x 1.0801 (1.1554) acc_x 65.6250 (71.8750) lr 2.7630e-05 eta 0:00:11
epoch [187/200] batch [20/40] time 0.508 (0.473) data 0.378 (0.342) loss_x loss_x 1.1797 (1.1827) acc_x 71.8750 (71.0938) lr 2.7630e-05 eta 0:00:09
epoch [187/200] batch [25/40] time 0.454 (0.483) data 0.324 (0.352) loss_x loss_x 1.1777 (1.1931) acc_x 75.0000 (70.6250) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [30/40] time 0.457 (0.481) data 0.326 (0.350) loss_x loss_x 1.0742 (1.1928) acc_x 75.0000 (70.7292) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [35/40] time 0.424 (0.474) data 0.293 (0.343) loss_x loss_x 1.5059 (1.2244) acc_x 75.0000 (70.0893) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [40/40] time 0.400 (0.473) data 0.269 (0.342) loss_x loss_x 1.1475 (1.2468) acc_x 65.6250 (69.3750) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1501
confident_label rate tensor(0.4107, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1288
clean true:1287
clean false:1
clean_rate:0.9992236024844721
noisy true:348
noisy false:1500
after delete: len(clean_dataset) 1288
after delete: len(noisy_dataset) 1848
epoch [188/200] batch [5/40] time 0.610 (0.561) data 0.480 (0.430) loss_x loss_x 1.5234 (1.2654) acc_x 75.0000 (68.7500) lr 2.4083e-05 eta 0:00:19
epoch [188/200] batch [10/40] time 0.627 (0.521) data 0.497 (0.390) loss_x loss_x 1.4873 (1.3147) acc_x 62.5000 (69.0625) lr 2.4083e-05 eta 0:00:15
epoch [188/200] batch [15/40] time 0.508 (0.509) data 0.377 (0.378) loss_x loss_x 1.2197 (1.3126) acc_x 65.6250 (67.0833) lr 2.4083e-05 eta 0:00:12
epoch [188/200] batch [20/40] time 0.564 (0.502) data 0.434 (0.372) loss_x loss_x 0.8594 (1.3157) acc_x 81.2500 (67.9688) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [25/40] time 0.491 (0.499) data 0.361 (0.369) loss_x loss_x 1.1836 (1.3361) acc_x 59.3750 (66.7500) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [30/40] time 0.624 (0.496) data 0.493 (0.366) loss_x loss_x 0.9429 (1.2961) acc_x 68.7500 (67.5000) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [35/40] time 0.419 (0.483) data 0.288 (0.353) loss_x loss_x 1.3164 (1.2916) acc_x 71.8750 (68.0357) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [40/40] time 0.444 (0.478) data 0.314 (0.347) loss_x loss_x 0.8848 (1.2626) acc_x 84.3750 (68.9062) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1513
confident_label rate tensor(0.4120, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1292
clean true:1289
clean false:3
clean_rate:0.9976780185758514
noisy true:334
noisy false:1510
after delete: len(clean_dataset) 1292
after delete: len(noisy_dataset) 1844
epoch [189/200] batch [5/40] time 0.508 (0.508) data 0.378 (0.377) loss_x loss_x 1.3506 (1.3583) acc_x 65.6250 (66.8750) lr 2.0777e-05 eta 0:00:17
epoch [189/200] batch [10/40] time 0.491 (0.538) data 0.360 (0.408) loss_x loss_x 1.0791 (1.2799) acc_x 68.7500 (70.0000) lr 2.0777e-05 eta 0:00:16
epoch [189/200] batch [15/40] time 0.543 (0.510) data 0.413 (0.380) loss_x loss_x 1.3037 (1.2289) acc_x 71.8750 (69.7917) lr 2.0777e-05 eta 0:00:12
epoch [189/200] batch [20/40] time 0.525 (0.499) data 0.394 (0.368) loss_x loss_x 1.1494 (1.2627) acc_x 71.8750 (69.3750) lr 2.0777e-05 eta 0:00:09
epoch [189/200] batch [25/40] time 0.439 (0.491) data 0.308 (0.361) loss_x loss_x 1.2275 (1.2607) acc_x 68.7500 (69.0000) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [30/40] time 0.515 (0.491) data 0.384 (0.361) loss_x loss_x 1.2295 (1.2571) acc_x 68.7500 (69.1667) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [35/40] time 0.421 (0.484) data 0.290 (0.353) loss_x loss_x 1.1689 (1.2437) acc_x 75.0000 (69.6429) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [40/40] time 0.386 (0.475) data 0.255 (0.345) loss_x loss_x 1.3379 (1.2343) acc_x 71.8750 (70.1562) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4098, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1285
clean true:1283
clean false:2
clean_rate:0.998443579766537
noisy true:341
noisy false:1510
after delete: len(clean_dataset) 1285
after delete: len(noisy_dataset) 1851
epoch [190/200] batch [5/40] time 0.493 (0.472) data 0.363 (0.341) loss_x loss_x 0.9790 (0.9657) acc_x 78.1250 (75.6250) lr 1.7713e-05 eta 0:00:16
epoch [190/200] batch [10/40] time 0.686 (0.494) data 0.556 (0.363) loss_x loss_x 0.8970 (1.0764) acc_x 75.0000 (72.8125) lr 1.7713e-05 eta 0:00:14
epoch [190/200] batch [15/40] time 0.435 (0.467) data 0.305 (0.337) loss_x loss_x 1.2559 (1.0995) acc_x 65.6250 (70.6250) lr 1.7713e-05 eta 0:00:11
epoch [190/200] batch [20/40] time 0.490 (0.458) data 0.358 (0.327) loss_x loss_x 0.5083 (1.0814) acc_x 96.8750 (72.0312) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [25/40] time 0.459 (0.466) data 0.328 (0.335) loss_x loss_x 1.5586 (1.1662) acc_x 68.7500 (70.5000) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [30/40] time 0.430 (0.464) data 0.299 (0.333) loss_x loss_x 1.5137 (1.1839) acc_x 65.6250 (70.0000) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [35/40] time 0.491 (0.466) data 0.360 (0.335) loss_x loss_x 0.8330 (1.1652) acc_x 75.0000 (70.3571) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [40/40] time 0.471 (0.464) data 0.341 (0.333) loss_x loss_x 1.0986 (1.1659) acc_x 62.5000 (69.9219) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1513
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1269
clean true:1265
clean false:4
clean_rate:0.9968479117415288
noisy true:358
noisy false:1509
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 1867
epoch [191/200] batch [5/39] time 0.487 (0.493) data 0.357 (0.362) loss_x loss_x 1.1924 (1.1068) acc_x 68.7500 (76.2500) lr 1.4891e-05 eta 0:00:16
epoch [191/200] batch [10/39] time 0.390 (0.459) data 0.259 (0.328) loss_x loss_x 0.8794 (1.1206) acc_x 75.0000 (74.0625) lr 1.4891e-05 eta 0:00:13
epoch [191/200] batch [15/39] time 0.474 (0.479) data 0.343 (0.348) loss_x loss_x 0.9927 (1.1441) acc_x 81.2500 (73.9583) lr 1.4891e-05 eta 0:00:11
epoch [191/200] batch [20/39] time 0.514 (0.482) data 0.383 (0.351) loss_x loss_x 0.9204 (1.1056) acc_x 75.0000 (73.9062) lr 1.4891e-05 eta 0:00:09
epoch [191/200] batch [25/39] time 0.437 (0.473) data 0.307 (0.342) loss_x loss_x 1.3086 (1.1409) acc_x 68.7500 (72.2500) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [30/39] time 0.359 (0.466) data 0.228 (0.335) loss_x loss_x 1.0254 (1.1373) acc_x 71.8750 (70.9375) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [35/39] time 0.391 (0.465) data 0.260 (0.334) loss_x loss_x 1.3105 (1.1632) acc_x 53.1250 (70.0893) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1522
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1274
clean true:1271
clean false:3
clean_rate:0.9976452119309263
noisy true:343
noisy false:1519
after delete: len(clean_dataset) 1274
after delete: len(noisy_dataset) 1862
epoch [192/200] batch [5/39] time 0.397 (0.495) data 0.267 (0.364) loss_x loss_x 1.6074 (1.2286) acc_x 62.5000 (69.3750) lr 1.2312e-05 eta 0:00:16
epoch [192/200] batch [10/39] time 0.429 (0.512) data 0.298 (0.382) loss_x loss_x 0.6685 (1.2193) acc_x 84.3750 (70.3125) lr 1.2312e-05 eta 0:00:14
epoch [192/200] batch [15/39] time 0.435 (0.475) data 0.304 (0.345) loss_x loss_x 1.7822 (1.2711) acc_x 56.2500 (69.1667) lr 1.2312e-05 eta 0:00:11
epoch [192/200] batch [20/39] time 0.690 (0.484) data 0.559 (0.353) loss_x loss_x 0.7314 (1.2121) acc_x 84.3750 (70.0000) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [25/39] time 0.554 (0.474) data 0.423 (0.343) loss_x loss_x 1.3652 (1.1881) acc_x 65.6250 (70.7500) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [30/39] time 0.364 (0.474) data 0.234 (0.343) loss_x loss_x 1.1934 (1.2122) acc_x 62.5000 (69.7917) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [35/39] time 0.611 (0.473) data 0.481 (0.342) loss_x loss_x 1.3740 (1.2411) acc_x 65.6250 (69.2857) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1455
confident_label rate tensor(0.4235, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1328
clean true:1326
clean false:2
clean_rate:0.9984939759036144
noisy true:355
noisy false:1453
after delete: len(clean_dataset) 1328
after delete: len(noisy_dataset) 1808
epoch [193/200] batch [5/41] time 0.468 (0.456) data 0.336 (0.326) loss_x loss_x 1.3125 (1.0844) acc_x 75.0000 (75.0000) lr 9.9763e-06 eta 0:00:16
epoch [193/200] batch [10/41] time 0.565 (0.480) data 0.435 (0.349) loss_x loss_x 1.2812 (1.1963) acc_x 62.5000 (69.6875) lr 9.9763e-06 eta 0:00:14
epoch [193/200] batch [15/41] time 0.508 (0.490) data 0.378 (0.359) loss_x loss_x 1.2393 (1.1771) acc_x 68.7500 (70.0000) lr 9.9763e-06 eta 0:00:12
epoch [193/200] batch [20/41] time 0.493 (0.495) data 0.362 (0.364) loss_x loss_x 1.1240 (1.1564) acc_x 81.2500 (71.4062) lr 9.9763e-06 eta 0:00:10
epoch [193/200] batch [25/41] time 0.488 (0.489) data 0.357 (0.358) loss_x loss_x 1.7051 (1.1791) acc_x 56.2500 (71.1250) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [30/41] time 0.395 (0.483) data 0.265 (0.352) loss_x loss_x 1.2607 (1.1661) acc_x 71.8750 (70.7292) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [35/41] time 0.490 (0.479) data 0.360 (0.348) loss_x loss_x 1.0498 (1.1752) acc_x 78.1250 (70.9821) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [40/41] time 0.417 (0.474) data 0.286 (0.343) loss_x loss_x 1.4551 (1.1846) acc_x 59.3750 (70.7031) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1489
confident_label rate tensor(0.4120, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1292
clean true:1289
clean false:3
clean_rate:0.9976780185758514
noisy true:358
noisy false:1486
after delete: len(clean_dataset) 1292
after delete: len(noisy_dataset) 1844
epoch [194/200] batch [5/40] time 0.590 (0.447) data 0.459 (0.316) loss_x loss_x 1.5996 (1.1734) acc_x 68.7500 (69.3750) lr 7.8853e-06 eta 0:00:15
epoch [194/200] batch [10/40] time 0.368 (0.429) data 0.237 (0.299) loss_x loss_x 0.6978 (1.1208) acc_x 84.3750 (71.8750) lr 7.8853e-06 eta 0:00:12
epoch [194/200] batch [15/40] time 0.480 (0.430) data 0.350 (0.300) loss_x loss_x 0.7793 (1.1816) acc_x 84.3750 (70.2083) lr 7.8853e-06 eta 0:00:10
epoch [194/200] batch [20/40] time 0.401 (0.430) data 0.271 (0.300) loss_x loss_x 1.5020 (1.2663) acc_x 65.6250 (67.8125) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [25/40] time 0.428 (0.436) data 0.297 (0.305) loss_x loss_x 1.3877 (1.2705) acc_x 71.8750 (68.1250) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [30/40] time 0.402 (0.438) data 0.271 (0.308) loss_x loss_x 1.3848 (1.2903) acc_x 62.5000 (67.1875) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [35/40] time 0.371 (0.441) data 0.239 (0.311) loss_x loss_x 1.0859 (1.2930) acc_x 65.6250 (67.5000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [40/40] time 0.537 (0.442) data 0.407 (0.311) loss_x loss_x 1.2002 (1.2875) acc_x 81.2500 (67.9688) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1528
confident_label rate tensor(0.3964, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1243
clean true:1239
clean false:4
clean_rate:0.996781979082864
noisy true:369
noisy false:1524
after delete: len(clean_dataset) 1243
after delete: len(noisy_dataset) 1893
epoch [195/200] batch [5/38] time 0.694 (0.520) data 0.564 (0.389) loss_x loss_x 1.1592 (1.1831) acc_x 78.1250 (73.1250) lr 6.0390e-06 eta 0:00:17
epoch [195/200] batch [10/38] time 0.411 (0.467) data 0.280 (0.337) loss_x loss_x 0.6938 (1.0448) acc_x 84.3750 (75.6250) lr 6.0390e-06 eta 0:00:13
epoch [195/200] batch [15/38] time 0.540 (0.462) data 0.409 (0.332) loss_x loss_x 1.1084 (1.0637) acc_x 78.1250 (75.0000) lr 6.0390e-06 eta 0:00:10
epoch [195/200] batch [20/38] time 0.382 (0.463) data 0.252 (0.332) loss_x loss_x 1.9131 (1.1750) acc_x 53.1250 (71.8750) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [25/38] time 0.444 (0.454) data 0.313 (0.324) loss_x loss_x 0.5591 (1.1783) acc_x 90.6250 (71.2500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [30/38] time 0.540 (0.448) data 0.409 (0.318) loss_x loss_x 0.9990 (1.1712) acc_x 84.3750 (71.2500) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [35/38] time 0.462 (0.455) data 0.331 (0.324) loss_x loss_x 1.5244 (1.1832) acc_x 65.6250 (70.6250) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1542
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1247
clean false:3
clean_rate:0.9976
noisy true:347
noisy false:1539
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [196/200] batch [5/39] time 0.426 (0.392) data 0.296 (0.262) loss_x loss_x 1.1426 (1.1389) acc_x 68.7500 (70.6250) lr 4.4380e-06 eta 0:00:13
epoch [196/200] batch [10/39] time 0.492 (0.421) data 0.361 (0.291) loss_x loss_x 1.3477 (1.1451) acc_x 59.3750 (71.2500) lr 4.4380e-06 eta 0:00:12
epoch [196/200] batch [15/39] time 0.591 (0.430) data 0.460 (0.300) loss_x loss_x 0.9658 (1.0914) acc_x 71.8750 (71.2500) lr 4.4380e-06 eta 0:00:10
epoch [196/200] batch [20/39] time 0.483 (0.426) data 0.353 (0.296) loss_x loss_x 0.9062 (1.1199) acc_x 78.1250 (71.0938) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [25/39] time 0.471 (0.435) data 0.340 (0.304) loss_x loss_x 1.0137 (1.1150) acc_x 78.1250 (71.6250) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [30/39] time 0.610 (0.438) data 0.479 (0.308) loss_x loss_x 0.9116 (1.1052) acc_x 81.2500 (72.3958) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [35/39] time 0.362 (0.437) data 0.231 (0.307) loss_x loss_x 1.4414 (1.1354) acc_x 62.5000 (71.5179) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1504
confident_label rate tensor(0.4034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1265
clean true:1265
clean false:0
clean_rate:1.0
noisy true:367
noisy false:1504
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 1871
epoch [197/200] batch [5/39] time 0.405 (0.409) data 0.274 (0.278) loss_x loss_x 1.1904 (1.1865) acc_x 75.0000 (69.3750) lr 3.0827e-06 eta 0:00:13
epoch [197/200] batch [10/39] time 0.420 (0.421) data 0.289 (0.291) loss_x loss_x 0.9360 (1.3169) acc_x 71.8750 (67.1875) lr 3.0827e-06 eta 0:00:12
epoch [197/200] batch [15/39] time 0.516 (0.431) data 0.386 (0.301) loss_x loss_x 1.0029 (1.2872) acc_x 75.0000 (68.3333) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [20/39] time 0.460 (0.434) data 0.330 (0.304) loss_x loss_x 1.3975 (1.2522) acc_x 59.3750 (67.8125) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [25/39] time 0.438 (0.438) data 0.308 (0.307) loss_x loss_x 1.0508 (1.2296) acc_x 71.8750 (68.6250) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [30/39] time 0.387 (0.434) data 0.256 (0.303) loss_x loss_x 0.8652 (1.1909) acc_x 75.0000 (69.3750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [35/39] time 0.373 (0.443) data 0.243 (0.313) loss_x loss_x 1.2227 (1.1984) acc_x 62.5000 (69.3750) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1269
clean true:1267
clean false:2
clean_rate:0.9984239558707644
noisy true:355
noisy false:1512
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 1867
epoch [198/200] batch [5/39] time 0.395 (0.446) data 0.265 (0.316) loss_x loss_x 1.0869 (1.1162) acc_x 78.1250 (72.5000) lr 1.9733e-06 eta 0:00:15
epoch [198/200] batch [10/39] time 0.474 (0.441) data 0.344 (0.311) loss_x loss_x 0.6919 (1.0371) acc_x 71.8750 (73.4375) lr 1.9733e-06 eta 0:00:12
epoch [198/200] batch [15/39] time 0.407 (0.438) data 0.277 (0.308) loss_x loss_x 1.2471 (1.1152) acc_x 62.5000 (71.2500) lr 1.9733e-06 eta 0:00:10
epoch [198/200] batch [20/39] time 0.457 (0.437) data 0.326 (0.306) loss_x loss_x 1.4121 (1.1701) acc_x 68.7500 (70.4688) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [25/39] time 0.442 (0.442) data 0.312 (0.312) loss_x loss_x 1.7305 (1.1783) acc_x 65.6250 (70.2500) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [30/39] time 0.430 (0.439) data 0.300 (0.309) loss_x loss_x 1.1885 (1.2098) acc_x 71.8750 (69.5833) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [35/39] time 0.431 (0.436) data 0.300 (0.306) loss_x loss_x 0.9497 (1.2098) acc_x 75.0000 (70.0893) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1509
confident_label rate tensor(0.4011, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1258
clean true:1257
clean false:1
clean_rate:0.9992050874403816
noisy true:370
noisy false:1508
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 1878
epoch [199/200] batch [5/39] time 0.421 (0.459) data 0.291 (0.328) loss_x loss_x 1.0449 (1.2699) acc_x 75.0000 (68.1250) lr 1.1101e-06 eta 0:00:15
epoch [199/200] batch [10/39] time 0.514 (0.460) data 0.384 (0.330) loss_x loss_x 1.1904 (1.2404) acc_x 68.7500 (70.0000) lr 1.1101e-06 eta 0:00:13
epoch [199/200] batch [15/39] time 0.466 (0.447) data 0.335 (0.317) loss_x loss_x 1.3125 (1.2478) acc_x 56.2500 (68.3333) lr 1.1101e-06 eta 0:00:10
epoch [199/200] batch [20/39] time 0.405 (0.443) data 0.275 (0.312) loss_x loss_x 0.9043 (1.2188) acc_x 84.3750 (70.3125) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [25/39] time 0.398 (0.437) data 0.267 (0.307) loss_x loss_x 0.7568 (1.2525) acc_x 78.1250 (69.6250) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [30/39] time 0.455 (0.436) data 0.325 (0.305) loss_x loss_x 1.0117 (1.2063) acc_x 68.7500 (70.7292) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [35/39] time 0.620 (0.442) data 0.489 (0.312) loss_x loss_x 1.0469 (1.2170) acc_x 78.1250 (71.0714) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1553
confident_label rate tensor(0.4024, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1262
clean true:1260
clean false:2
clean_rate:0.9984152139461173
noisy true:323
noisy false:1551
after delete: len(clean_dataset) 1262
after delete: len(noisy_dataset) 1874
epoch [200/200] batch [5/39] time 0.367 (0.421) data 0.237 (0.291) loss_x loss_x 1.1963 (1.2090) acc_x 68.7500 (69.3750) lr 4.9344e-07 eta 0:00:14
epoch [200/200] batch [10/39] time 0.524 (0.444) data 0.393 (0.313) loss_x loss_x 1.0342 (1.1246) acc_x 62.5000 (70.3125) lr 4.9344e-07 eta 0:00:12
epoch [200/200] batch [15/39] time 0.429 (0.432) data 0.299 (0.302) loss_x loss_x 1.4434 (1.2039) acc_x 62.5000 (67.5000) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [20/39] time 0.486 (0.445) data 0.355 (0.315) loss_x loss_x 1.0361 (1.2114) acc_x 78.1250 (68.4375) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [25/39] time 0.365 (0.446) data 0.234 (0.315) loss_x loss_x 0.7329 (1.2006) acc_x 81.2500 (69.6250) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [30/39] time 0.436 (0.446) data 0.305 (0.316) loss_x loss_x 1.4707 (1.1940) acc_x 65.6250 (70.2083) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [35/39] time 0.420 (0.441) data 0.290 (0.311) loss_x loss_x 1.0420 (1.1744) acc_x 71.8750 (70.2679) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,259
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 64.0%
Elapsed: 3:26:40
