***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1183, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 371
clean true:365
clean false:6
clean_rate:0.9838274932614556
noisy true:200
noisy false:2565
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 2765
epoch [1/200] batch [5/11] time 0.401 (0.504) data 0.271 (0.355) loss_x loss_x 2.9570 (3.0297) acc_x 50.0000 (42.5000) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [10/11] time 0.533 (0.492) data 0.404 (0.353) loss_x loss_x 2.5156 (2.8719) acc_x 46.8750 (45.6250) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2428
confident_label rate tensor(0.1476, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 463
clean true:457
clean false:6
clean_rate:0.9870410367170627
noisy true:251
noisy false:2422
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 2673
epoch [2/200] batch [5/14] time 0.523 (0.479) data 0.392 (0.347) loss_x loss_x 1.4336 (2.0492) acc_x 56.2500 (49.3750) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/14] time 0.406 (0.488) data 0.275 (0.357) loss_x loss_x 2.1973 (2.0292) acc_x 46.8750 (50.6250) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2024
confident_label rate tensor(0.2235, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 701
clean true:696
clean false:5
clean_rate:0.992867332382311
noisy true:416
noisy false:2019
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 2435
epoch [3/200] batch [5/21] time 0.451 (0.512) data 0.321 (0.382) loss_x loss_x 1.5889 (1.6576) acc_x 56.2500 (58.7500) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [10/21] time 0.524 (0.540) data 0.391 (0.409) loss_x loss_x 1.4580 (1.6026) acc_x 59.3750 (57.8125) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [15/21] time 0.577 (0.563) data 0.444 (0.432) loss_x loss_x 1.7539 (1.6176) acc_x 56.2500 (56.6667) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [20/21] time 0.569 (0.543) data 0.439 (0.412) loss_x loss_x 1.8584 (1.6243) acc_x 56.2500 (56.5625) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1887
confident_label rate tensor(0.2529, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 793
clean true:786
clean false:7
clean_rate:0.9911727616645649
noisy true:463
noisy false:1880
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 2343
epoch [4/200] batch [5/24] time 0.453 (0.462) data 0.322 (0.331) loss_x loss_x 1.7852 (1.7723) acc_x 43.7500 (51.2500) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [10/24] time 0.433 (0.447) data 0.302 (0.317) loss_x loss_x 1.6982 (1.6485) acc_x 59.3750 (55.9375) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [15/24] time 0.454 (0.451) data 0.323 (0.321) loss_x loss_x 1.5469 (1.5950) acc_x 53.1250 (57.5000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/24] time 0.515 (0.469) data 0.384 (0.338) loss_x loss_x 1.4453 (1.5785) acc_x 59.3750 (56.8750) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1883
confident_label rate tensor(0.2564, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 804
clean true:803
clean false:1
clean_rate:0.9987562189054726
noisy true:450
noisy false:1882
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 2332
epoch [5/200] batch [5/25] time 0.532 (0.488) data 0.402 (0.357) loss_x loss_x 1.3799 (1.6184) acc_x 62.5000 (57.5000) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [10/25] time 0.357 (0.449) data 0.226 (0.319) loss_x loss_x 1.4424 (1.7109) acc_x 68.7500 (54.3750) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [15/25] time 0.431 (0.457) data 0.300 (0.326) loss_x loss_x 1.7188 (1.6322) acc_x 53.1250 (57.7083) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [20/25] time 0.378 (0.453) data 0.248 (0.322) loss_x loss_x 1.6211 (1.6478) acc_x 56.2500 (57.5000) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [25/25] time 0.468 (0.469) data 0.337 (0.338) loss_x loss_x 1.4453 (1.6320) acc_x 59.3750 (57.6250) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1852
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 833
clean true:832
clean false:1
clean_rate:0.9987995198079231
noisy true:452
noisy false:1851
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 2303
epoch [6/200] batch [5/26] time 0.432 (0.428) data 0.302 (0.298) loss_x loss_x 1.3652 (1.5225) acc_x 62.5000 (61.8750) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [10/26] time 0.508 (0.459) data 0.378 (0.329) loss_x loss_x 1.4141 (1.5270) acc_x 56.2500 (60.0000) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [15/26] time 0.433 (0.462) data 0.303 (0.332) loss_x loss_x 1.4141 (1.5743) acc_x 62.5000 (58.1250) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [20/26] time 0.402 (0.468) data 0.272 (0.338) loss_x loss_x 1.7051 (1.6010) acc_x 50.0000 (57.1875) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/26] time 0.619 (0.479) data 0.488 (0.348) loss_x loss_x 1.5615 (1.5545) acc_x 59.3750 (58.6250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1867
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:808
clean false:4
clean_rate:0.9950738916256158
noisy true:461
noisy false:1863
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [7/200] batch [5/25] time 0.570 (0.565) data 0.440 (0.434) loss_x loss_x 1.7090 (1.6496) acc_x 65.6250 (58.1250) lr 1.9969e-03 eta 0:00:11
epoch [7/200] batch [10/25] time 0.412 (0.505) data 0.281 (0.375) loss_x loss_x 1.6035 (1.7034) acc_x 59.3750 (55.9375) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [15/25] time 0.383 (0.480) data 0.252 (0.349) loss_x loss_x 1.3975 (1.7061) acc_x 65.6250 (56.0417) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/25] time 0.495 (0.471) data 0.365 (0.340) loss_x loss_x 1.0283 (1.6788) acc_x 71.8750 (57.1875) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/25] time 0.393 (0.463) data 0.262 (0.332) loss_x loss_x 2.0605 (1.6252) acc_x 56.2500 (58.5000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1859
confident_label rate tensor(0.2577, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 808
clean true:804
clean false:4
clean_rate:0.995049504950495
noisy true:473
noisy false:1855
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 2328
epoch [8/200] batch [5/25] time 0.398 (0.521) data 0.268 (0.390) loss_x loss_x 1.7812 (1.6486) acc_x 50.0000 (56.2500) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [10/25] time 0.597 (0.520) data 0.467 (0.390) loss_x loss_x 1.4365 (1.6338) acc_x 59.3750 (56.5625) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [15/25] time 0.355 (0.504) data 0.224 (0.373) loss_x loss_x 1.7812 (1.5511) acc_x 53.1250 (58.9583) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [20/25] time 0.564 (0.493) data 0.433 (0.363) loss_x loss_x 2.0312 (1.5829) acc_x 37.5000 (57.3438) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/25] time 0.452 (0.476) data 0.322 (0.346) loss_x loss_x 1.1807 (1.5391) acc_x 75.0000 (59.0000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1847
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:811
clean false:1
clean_rate:0.9987684729064039
noisy true:478
noisy false:1846
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [9/200] batch [5/25] time 0.466 (0.465) data 0.335 (0.334) loss_x loss_x 2.1504 (1.6887) acc_x 53.1250 (60.6250) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [10/25] time 0.539 (0.497) data 0.405 (0.364) loss_x loss_x 1.4531 (1.5871) acc_x 62.5000 (60.0000) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [15/25] time 0.494 (0.512) data 0.363 (0.380) loss_x loss_x 1.7998 (1.6354) acc_x 59.3750 (58.5417) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [20/25] time 0.521 (0.498) data 0.391 (0.366) loss_x loss_x 1.3047 (1.6026) acc_x 59.3750 (58.5938) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/25] time 0.412 (0.485) data 0.281 (0.353) loss_x loss_x 1.2549 (1.6300) acc_x 71.8750 (58.0000) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1835
confident_label rate tensor(0.2592, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 813
clean true:812
clean false:1
clean_rate:0.998769987699877
noisy true:489
noisy false:1834
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 2323
epoch [10/200] batch [5/25] time 0.512 (0.499) data 0.380 (0.368) loss_x loss_x 1.6914 (1.6391) acc_x 62.5000 (58.7500) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [10/25] time 0.466 (0.490) data 0.336 (0.359) loss_x loss_x 1.3740 (1.5648) acc_x 71.8750 (62.8125) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [15/25] time 0.408 (0.493) data 0.278 (0.363) loss_x loss_x 1.8281 (1.5846) acc_x 43.7500 (60.2083) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/25] time 0.563 (0.481) data 0.432 (0.350) loss_x loss_x 1.4014 (1.5335) acc_x 56.2500 (61.5625) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/25] time 0.376 (0.469) data 0.245 (0.338) loss_x loss_x 1.2598 (1.5312) acc_x 59.3750 (61.3750) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1887
confident_label rate tensor(0.2596, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 814
clean true:811
clean false:3
clean_rate:0.9963144963144963
noisy true:438
noisy false:1884
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 2322
epoch [11/200] batch [5/25] time 0.497 (0.497) data 0.366 (0.367) loss_x loss_x 1.4326 (1.3010) acc_x 59.3750 (65.0000) lr 1.9900e-03 eta 0:00:09
epoch [11/200] batch [10/25] time 0.515 (0.473) data 0.385 (0.343) loss_x loss_x 1.4795 (1.4227) acc_x 65.6250 (63.1250) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [15/25] time 0.471 (0.468) data 0.341 (0.338) loss_x loss_x 1.7363 (1.4555) acc_x 50.0000 (61.2500) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [20/25] time 0.527 (0.483) data 0.396 (0.353) loss_x loss_x 1.7441 (1.4688) acc_x 56.2500 (60.6250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/25] time 0.445 (0.485) data 0.313 (0.355) loss_x loss_x 1.6543 (1.5364) acc_x 56.2500 (59.6250) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 848
clean true:847
clean false:1
clean_rate:0.9988207547169812
noisy true:479
noisy false:1809
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 2288
epoch [12/200] batch [5/26] time 0.406 (0.476) data 0.276 (0.345) loss_x loss_x 1.2910 (1.3482) acc_x 62.5000 (64.3750) lr 1.9877e-03 eta 0:00:10
epoch [12/200] batch [10/26] time 0.485 (0.474) data 0.354 (0.343) loss_x loss_x 1.5576 (1.4507) acc_x 50.0000 (60.9375) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [15/26] time 0.418 (0.476) data 0.287 (0.345) loss_x loss_x 1.8408 (1.5540) acc_x 53.1250 (57.2917) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [20/26] time 0.439 (0.462) data 0.308 (0.331) loss_x loss_x 2.1152 (1.6083) acc_x 59.3750 (57.6562) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/26] time 0.397 (0.461) data 0.266 (0.330) loss_x loss_x 1.3730 (1.5873) acc_x 62.5000 (58.1250) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1819
confident_label rate tensor(0.2643, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 829
clean true:827
clean false:2
clean_rate:0.9975874547647768
noisy true:490
noisy false:1817
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 2307
epoch [13/200] batch [5/25] time 0.447 (0.476) data 0.317 (0.346) loss_x loss_x 1.0273 (1.3129) acc_x 68.7500 (61.8750) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [10/25] time 0.422 (0.471) data 0.292 (0.341) loss_x loss_x 1.7441 (1.4387) acc_x 56.2500 (61.2500) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [15/25] time 0.483 (0.478) data 0.352 (0.348) loss_x loss_x 1.3271 (1.5726) acc_x 56.2500 (58.1250) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/25] time 0.565 (0.473) data 0.434 (0.342) loss_x loss_x 0.9355 (1.5237) acc_x 75.0000 (59.5312) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/25] time 0.479 (0.472) data 0.349 (0.342) loss_x loss_x 1.8340 (1.5354) acc_x 43.7500 (58.7500) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2710, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 850
clean true:849
clean false:1
clean_rate:0.9988235294117647
noisy true:477
noisy false:1809
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 2286
epoch [14/200] batch [5/26] time 0.514 (0.506) data 0.383 (0.375) loss_x loss_x 1.4424 (1.5619) acc_x 68.7500 (62.5000) lr 1.9823e-03 eta 0:00:10
epoch [14/200] batch [10/26] time 0.479 (0.492) data 0.348 (0.361) loss_x loss_x 1.2900 (1.4935) acc_x 75.0000 (63.7500) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [15/26] time 0.500 (0.489) data 0.369 (0.358) loss_x loss_x 1.4941 (1.4782) acc_x 68.7500 (63.3333) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [20/26] time 0.457 (0.490) data 0.327 (0.359) loss_x loss_x 1.4014 (1.4579) acc_x 65.6250 (62.8125) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/26] time 0.440 (0.493) data 0.310 (0.362) loss_x loss_x 1.5459 (1.5227) acc_x 56.2500 (61.3750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 859
clean true:856
clean false:3
clean_rate:0.9965075669383003
noisy true:470
noisy false:1807
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 2277
epoch [15/200] batch [5/26] time 0.422 (0.518) data 0.292 (0.387) loss_x loss_x 1.1660 (1.3623) acc_x 65.6250 (64.3750) lr 1.9792e-03 eta 0:00:10
epoch [15/200] batch [10/26] time 0.563 (0.492) data 0.433 (0.361) loss_x loss_x 0.9976 (1.4534) acc_x 78.1250 (62.8125) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [15/26] time 0.541 (0.491) data 0.410 (0.360) loss_x loss_x 2.2344 (1.4661) acc_x 43.7500 (62.9167) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [20/26] time 0.381 (0.481) data 0.251 (0.351) loss_x loss_x 1.7832 (1.4405) acc_x 53.1250 (63.2812) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/26] time 0.444 (0.481) data 0.315 (0.351) loss_x loss_x 1.7383 (1.4634) acc_x 59.3750 (62.3750) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1790
confident_label rate tensor(0.2765, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 867
clean true:864
clean false:3
clean_rate:0.9965397923875432
noisy true:482
noisy false:1787
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 2269
epoch [16/200] batch [5/27] time 0.528 (0.490) data 0.398 (0.359) loss_x loss_x 1.0664 (1.5908) acc_x 71.8750 (61.2500) lr 1.9759e-03 eta 0:00:10
epoch [16/200] batch [10/27] time 0.403 (0.457) data 0.273 (0.327) loss_x loss_x 2.0332 (1.5501) acc_x 53.1250 (61.8750) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [15/27] time 0.532 (0.474) data 0.402 (0.343) loss_x loss_x 1.9912 (1.6066) acc_x 50.0000 (59.5833) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [20/27] time 0.386 (0.474) data 0.255 (0.344) loss_x loss_x 1.2471 (1.5021) acc_x 65.6250 (61.8750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [25/27] time 0.504 (0.475) data 0.375 (0.345) loss_x loss_x 0.9272 (1.4722) acc_x 78.1250 (62.2500) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.2714, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 851
clean true:847
clean false:4
clean_rate:0.9952996474735605
noisy true:474
noisy false:1811
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 2285
epoch [17/200] batch [5/26] time 0.427 (0.470) data 0.297 (0.339) loss_x loss_x 1.5674 (1.4578) acc_x 56.2500 (63.1250) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [10/26] time 0.353 (0.448) data 0.223 (0.317) loss_x loss_x 1.3984 (1.4071) acc_x 65.6250 (65.9375) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [15/26] time 0.428 (0.468) data 0.297 (0.338) loss_x loss_x 2.2461 (1.6112) acc_x 46.8750 (60.8333) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [20/26] time 0.499 (0.464) data 0.368 (0.334) loss_x loss_x 1.2568 (1.6108) acc_x 59.3750 (59.6875) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/26] time 0.427 (0.464) data 0.296 (0.333) loss_x loss_x 1.3701 (1.6013) acc_x 68.7500 (60.3750) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1792
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 846
clean true:844
clean false:2
clean_rate:0.9976359338061466
noisy true:500
noisy false:1790
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 2290
epoch [18/200] batch [5/26] time 0.424 (0.505) data 0.293 (0.373) loss_x loss_x 1.6934 (1.3872) acc_x 62.5000 (63.7500) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [10/26] time 0.538 (0.494) data 0.407 (0.363) loss_x loss_x 1.6855 (1.4530) acc_x 50.0000 (60.6250) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [15/26] time 0.468 (0.483) data 0.338 (0.352) loss_x loss_x 1.9941 (1.5565) acc_x 56.2500 (59.1667) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [20/26] time 0.417 (0.487) data 0.287 (0.356) loss_x loss_x 2.0430 (1.6043) acc_x 50.0000 (58.7500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/26] time 0.421 (0.476) data 0.290 (0.345) loss_x loss_x 1.6543 (1.5842) acc_x 59.3750 (59.8750) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1776
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 884
clean true:884
clean false:0
clean_rate:1.0
noisy true:476
noisy false:1776
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 2252
epoch [19/200] batch [5/27] time 0.545 (0.511) data 0.414 (0.380) loss_x loss_x 1.4258 (1.4162) acc_x 62.5000 (63.7500) lr 1.9646e-03 eta 0:00:11
epoch [19/200] batch [10/27] time 0.508 (0.497) data 0.377 (0.366) loss_x loss_x 1.2549 (1.4208) acc_x 56.2500 (62.1875) lr 1.9646e-03 eta 0:00:08
epoch [19/200] batch [15/27] time 0.439 (0.483) data 0.308 (0.352) loss_x loss_x 1.1797 (1.4232) acc_x 62.5000 (62.5000) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [20/27] time 0.553 (0.485) data 0.422 (0.354) loss_x loss_x 1.4170 (1.4766) acc_x 53.1250 (61.4062) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [25/27] time 0.413 (0.478) data 0.282 (0.347) loss_x loss_x 1.8867 (1.5239) acc_x 56.2500 (59.8750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.2790, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 875
clean true:873
clean false:2
clean_rate:0.9977142857142857
noisy true:476
noisy false:1785
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 2261
epoch [20/200] batch [5/27] time 0.415 (0.498) data 0.284 (0.368) loss_x loss_x 1.8018 (1.5306) acc_x 46.8750 (60.0000) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [10/27] time 0.472 (0.493) data 0.341 (0.362) loss_x loss_x 1.5439 (1.5027) acc_x 68.7500 (61.2500) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [15/27] time 0.495 (0.477) data 0.364 (0.346) loss_x loss_x 1.2764 (1.5088) acc_x 65.6250 (60.6250) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [20/27] time 0.371 (0.467) data 0.240 (0.336) loss_x loss_x 1.3955 (1.5172) acc_x 50.0000 (59.6875) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/27] time 0.567 (0.481) data 0.436 (0.351) loss_x loss_x 1.5020 (1.5279) acc_x 65.6250 (59.6250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1778
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 884
clean true:883
clean false:1
clean_rate:0.998868778280543
noisy true:475
noisy false:1777
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 2252
epoch [21/200] batch [5/27] time 0.494 (0.485) data 0.365 (0.354) loss_x loss_x 1.3340 (1.2049) acc_x 59.3750 (67.5000) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [10/27] time 0.513 (0.497) data 0.382 (0.367) loss_x loss_x 0.8799 (1.2433) acc_x 84.3750 (67.1875) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [15/27] time 0.485 (0.488) data 0.354 (0.357) loss_x loss_x 1.4170 (1.3630) acc_x 56.2500 (64.1667) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [20/27] time 0.678 (0.479) data 0.547 (0.349) loss_x loss_x 1.0977 (1.3958) acc_x 75.0000 (63.7500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/27] time 0.342 (0.472) data 0.211 (0.342) loss_x loss_x 1.5273 (1.4481) acc_x 59.3750 (62.5000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 883
clean true:879
clean false:4
clean_rate:0.9954699886749717
noisy true:483
noisy false:1770
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 2253
epoch [22/200] batch [5/27] time 0.488 (0.497) data 0.358 (0.367) loss_x loss_x 1.1123 (1.2453) acc_x 81.2500 (67.5000) lr 1.9511e-03 eta 0:00:10
epoch [22/200] batch [10/27] time 0.389 (0.491) data 0.259 (0.361) loss_x loss_x 1.3330 (1.3401) acc_x 65.6250 (65.6250) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [15/27] time 0.523 (0.490) data 0.393 (0.360) loss_x loss_x 1.2383 (1.4005) acc_x 62.5000 (63.5417) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [20/27] time 0.380 (0.475) data 0.251 (0.344) loss_x loss_x 1.5840 (1.4774) acc_x 65.6250 (62.6562) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/27] time 0.460 (0.466) data 0.330 (0.335) loss_x loss_x 1.2559 (1.4889) acc_x 65.6250 (61.8750) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1812
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 852
clean true:851
clean false:1
clean_rate:0.9988262910798122
noisy true:473
noisy false:1811
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 2284
epoch [23/200] batch [5/26] time 0.535 (0.461) data 0.405 (0.331) loss_x loss_x 1.4629 (1.4818) acc_x 65.6250 (63.1250) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [10/26] time 0.533 (0.482) data 0.402 (0.352) loss_x loss_x 1.3896 (1.4772) acc_x 71.8750 (62.8125) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [15/26] time 0.508 (0.469) data 0.378 (0.339) loss_x loss_x 1.0664 (1.4119) acc_x 75.0000 (65.8333) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [20/26] time 0.375 (0.467) data 0.246 (0.337) loss_x loss_x 1.3291 (1.3627) acc_x 65.6250 (66.5625) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/26] time 0.508 (0.470) data 0.378 (0.340) loss_x loss_x 1.2959 (1.3711) acc_x 71.8750 (65.7500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1785
confident_label rate tensor(0.2765, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 867
clean true:863
clean false:4
clean_rate:0.9953863898500577
noisy true:488
noisy false:1781
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 2269
epoch [24/200] batch [5/27] time 0.550 (0.497) data 0.420 (0.367) loss_x loss_x 1.5479 (1.4885) acc_x 65.6250 (63.7500) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [10/27] time 0.545 (0.481) data 0.416 (0.351) loss_x loss_x 1.5635 (1.3660) acc_x 59.3750 (64.6875) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [15/27] time 0.468 (0.471) data 0.338 (0.341) loss_x loss_x 0.9790 (1.3389) acc_x 78.1250 (65.2083) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [20/27] time 0.449 (0.474) data 0.319 (0.344) loss_x loss_x 1.7520 (1.3698) acc_x 53.1250 (64.6875) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/27] time 0.443 (0.482) data 0.312 (0.351) loss_x loss_x 1.8154 (1.4084) acc_x 59.3750 (64.2500) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1775
confident_label rate tensor(0.2800, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 878
clean true:877
clean false:1
clean_rate:0.9988610478359908
noisy true:484
noisy false:1774
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 2258
epoch [25/200] batch [5/27] time 0.442 (0.425) data 0.312 (0.295) loss_x loss_x 1.4355 (1.4516) acc_x 65.6250 (61.2500) lr 1.9354e-03 eta 0:00:09
epoch [25/200] batch [10/27] time 0.409 (0.469) data 0.278 (0.338) loss_x loss_x 1.6914 (1.4407) acc_x 68.7500 (62.8125) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [15/27] time 0.639 (0.472) data 0.509 (0.341) loss_x loss_x 1.4033 (1.4589) acc_x 62.5000 (62.9167) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [20/27] time 0.560 (0.479) data 0.430 (0.349) loss_x loss_x 1.0117 (1.4809) acc_x 68.7500 (62.3438) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/27] time 0.490 (0.481) data 0.360 (0.351) loss_x loss_x 1.4268 (1.4655) acc_x 65.6250 (62.5000) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1796
confident_label rate tensor(0.2746, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 861
clean true:859
clean false:2
clean_rate:0.9976771196283392
noisy true:481
noisy false:1794
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 2275
epoch [26/200] batch [5/26] time 0.496 (0.509) data 0.365 (0.378) loss_x loss_x 1.3135 (1.4740) acc_x 53.1250 (54.3750) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [10/26] time 0.448 (0.493) data 0.318 (0.363) loss_x loss_x 1.3467 (1.4837) acc_x 65.6250 (59.0625) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [15/26] time 0.435 (0.489) data 0.305 (0.358) loss_x loss_x 1.3477 (1.4066) acc_x 68.7500 (61.4583) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [20/26] time 0.406 (0.484) data 0.275 (0.353) loss_x loss_x 1.1660 (1.4153) acc_x 65.6250 (62.5000) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/26] time 0.524 (0.481) data 0.394 (0.351) loss_x loss_x 1.1113 (1.4568) acc_x 71.8750 (62.2500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2790, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 875
clean true:874
clean false:1
clean_rate:0.9988571428571429
noisy true:496
noisy false:1765
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 2261
epoch [27/200] batch [5/27] time 0.473 (0.503) data 0.342 (0.371) loss_x loss_x 1.8916 (1.7615) acc_x 53.1250 (55.6250) lr 1.9239e-03 eta 0:00:11
epoch [27/200] batch [10/27] time 0.353 (0.494) data 0.222 (0.363) loss_x loss_x 1.4355 (1.5874) acc_x 68.7500 (61.2500) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [15/27] time 0.457 (0.487) data 0.326 (0.356) loss_x loss_x 1.7246 (1.5641) acc_x 46.8750 (60.2083) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [20/27] time 0.494 (0.490) data 0.363 (0.359) loss_x loss_x 1.5078 (1.5959) acc_x 71.8750 (59.8438) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/27] time 0.558 (0.487) data 0.427 (0.356) loss_x loss_x 1.0254 (1.5305) acc_x 65.6250 (60.3750) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1797
confident_label rate tensor(0.2771, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 869
clean true:865
clean false:4
clean_rate:0.9953970080552359
noisy true:474
noisy false:1793
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 2267
epoch [28/200] batch [5/27] time 0.466 (0.504) data 0.335 (0.373) loss_x loss_x 1.1660 (1.3471) acc_x 59.3750 (63.7500) lr 1.9178e-03 eta 0:00:11
epoch [28/200] batch [10/27] time 0.501 (0.490) data 0.369 (0.359) loss_x loss_x 1.3604 (1.3840) acc_x 62.5000 (62.5000) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [15/27] time 0.507 (0.484) data 0.375 (0.353) loss_x loss_x 1.5059 (1.3480) acc_x 65.6250 (63.5417) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [20/27] time 0.446 (0.475) data 0.315 (0.344) loss_x loss_x 1.4189 (1.4145) acc_x 65.6250 (62.8125) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/27] time 0.452 (0.477) data 0.320 (0.345) loss_x loss_x 1.5977 (1.4203) acc_x 62.5000 (62.5000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1754
confident_label rate tensor(0.2828, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 887
clean true:880
clean false:7
clean_rate:0.992108229988726
noisy true:502
noisy false:1747
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 2249
epoch [29/200] batch [5/27] time 0.376 (0.428) data 0.247 (0.298) loss_x loss_x 0.7261 (1.3095) acc_x 81.2500 (66.2500) lr 1.9114e-03 eta 0:00:09
epoch [29/200] batch [10/27] time 0.369 (0.452) data 0.240 (0.322) loss_x loss_x 1.3701 (1.3577) acc_x 68.7500 (65.0000) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [15/27] time 0.524 (0.470) data 0.393 (0.340) loss_x loss_x 1.5391 (1.4236) acc_x 53.1250 (64.1667) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [20/27] time 0.419 (0.487) data 0.288 (0.357) loss_x loss_x 1.8447 (1.4044) acc_x 62.5000 (64.6875) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/27] time 0.557 (0.480) data 0.426 (0.350) loss_x loss_x 1.1816 (1.3813) acc_x 65.6250 (64.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2841, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 891
clean true:888
clean false:3
clean_rate:0.9966329966329966
noisy true:482
noisy false:1763
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 2245
epoch [30/200] batch [5/27] time 0.421 (0.441) data 0.291 (0.311) loss_x loss_x 1.6172 (1.2926) acc_x 59.3750 (68.1250) lr 1.9048e-03 eta 0:00:09
epoch [30/200] batch [10/27] time 0.494 (0.431) data 0.363 (0.300) loss_x loss_x 1.8311 (1.4538) acc_x 53.1250 (65.6250) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [15/27] time 0.497 (0.450) data 0.367 (0.320) loss_x loss_x 1.6445 (1.4278) acc_x 62.5000 (64.7917) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [20/27] time 0.391 (0.454) data 0.261 (0.324) loss_x loss_x 1.6006 (1.4727) acc_x 56.2500 (62.5000) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/27] time 0.448 (0.461) data 0.317 (0.331) loss_x loss_x 1.4102 (1.4694) acc_x 59.3750 (62.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:879
clean false:3
clean_rate:0.9965986394557823
noisy true:484
noisy false:1770
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [31/200] batch [5/27] time 0.401 (0.505) data 0.271 (0.374) loss_x loss_x 2.3574 (1.5797) acc_x 34.3750 (56.8750) lr 1.8980e-03 eta 0:00:11
epoch [31/200] batch [10/27] time 0.414 (0.478) data 0.283 (0.347) loss_x loss_x 1.8994 (1.6393) acc_x 50.0000 (57.8125) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [15/27] time 0.492 (0.478) data 0.361 (0.348) loss_x loss_x 1.3643 (1.5070) acc_x 59.3750 (61.4583) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [20/27] time 0.668 (0.480) data 0.537 (0.349) loss_x loss_x 1.7910 (1.5386) acc_x 50.0000 (61.4062) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/27] time 0.459 (0.471) data 0.328 (0.340) loss_x loss_x 1.8311 (1.5218) acc_x 50.0000 (61.6250) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1739
confident_label rate tensor(0.2934, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 920
clean true:917
clean false:3
clean_rate:0.9967391304347826
noisy true:480
noisy false:1736
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 2216
epoch [32/200] batch [5/28] time 0.482 (0.527) data 0.351 (0.395) loss_x loss_x 0.9668 (1.4707) acc_x 75.0000 (61.2500) lr 1.8910e-03 eta 0:00:12
epoch [32/200] batch [10/28] time 0.466 (0.494) data 0.336 (0.363) loss_x loss_x 1.4619 (1.5130) acc_x 65.6250 (60.3125) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [15/28] time 0.445 (0.492) data 0.313 (0.361) loss_x loss_x 1.7393 (1.5103) acc_x 50.0000 (58.9583) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [20/28] time 0.502 (0.484) data 0.371 (0.353) loss_x loss_x 1.1758 (1.4769) acc_x 65.6250 (60.6250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/28] time 0.444 (0.477) data 0.313 (0.346) loss_x loss_x 1.7480 (1.4703) acc_x 62.5000 (60.7500) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1750
confident_label rate tensor(0.2867, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 899
clean true:897
clean false:2
clean_rate:0.9977753058954394
noisy true:489
noisy false:1748
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 2237
epoch [33/200] batch [5/28] time 0.526 (0.443) data 0.394 (0.311) loss_x loss_x 1.4580 (1.4207) acc_x 62.5000 (62.5000) lr 1.8838e-03 eta 0:00:10
epoch [33/200] batch [10/28] time 0.604 (0.476) data 0.473 (0.345) loss_x loss_x 1.4287 (1.3731) acc_x 68.7500 (64.0625) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [15/28] time 0.417 (0.455) data 0.286 (0.323) loss_x loss_x 1.3555 (1.3993) acc_x 68.7500 (63.7500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [20/28] time 0.502 (0.469) data 0.369 (0.338) loss_x loss_x 1.9805 (1.4086) acc_x 50.0000 (63.2812) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/28] time 0.460 (0.470) data 0.329 (0.339) loss_x loss_x 1.3125 (1.3999) acc_x 62.5000 (63.1250) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.2940, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 922
clean true:920
clean false:2
clean_rate:0.9978308026030369
noisy true:469
noisy false:1745
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 2214
epoch [34/200] batch [5/28] time 0.419 (0.530) data 0.289 (0.400) loss_x loss_x 1.3066 (1.3438) acc_x 65.6250 (65.0000) lr 1.8763e-03 eta 0:00:12
epoch [34/200] batch [10/28] time 0.457 (0.500) data 0.327 (0.370) loss_x loss_x 1.5869 (1.5052) acc_x 56.2500 (60.9375) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [15/28] time 0.382 (0.487) data 0.252 (0.357) loss_x loss_x 1.5469 (1.4863) acc_x 59.3750 (61.2500) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [20/28] time 0.467 (0.478) data 0.336 (0.347) loss_x loss_x 0.6885 (1.4768) acc_x 81.2500 (62.1875) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/28] time 0.439 (0.483) data 0.308 (0.352) loss_x loss_x 0.9756 (1.4240) acc_x 75.0000 (63.2500) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.2844, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 892
clean true:889
clean false:3
clean_rate:0.9966367713004485
noisy true:496
noisy false:1748
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 2244
epoch [35/200] batch [5/27] time 0.559 (0.495) data 0.428 (0.363) loss_x loss_x 1.1436 (1.2598) acc_x 62.5000 (65.0000) lr 1.8686e-03 eta 0:00:10
epoch [35/200] batch [10/27] time 0.522 (0.501) data 0.391 (0.369) loss_x loss_x 1.3252 (1.4274) acc_x 71.8750 (62.1875) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [15/27] time 0.404 (0.472) data 0.272 (0.341) loss_x loss_x 1.0312 (1.3909) acc_x 81.2500 (63.7500) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [20/27] time 0.540 (0.479) data 0.409 (0.347) loss_x loss_x 1.1074 (1.3858) acc_x 65.6250 (63.5938) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/27] time 0.484 (0.485) data 0.353 (0.354) loss_x loss_x 1.2207 (1.3686) acc_x 71.8750 (64.3750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1754
confident_label rate tensor(0.2873, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 901
clean true:897
clean false:4
clean_rate:0.9955604883462819
noisy true:485
noisy false:1750
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 2235
epoch [36/200] batch [5/28] time 0.378 (0.461) data 0.248 (0.331) loss_x loss_x 1.5127 (1.1737) acc_x 59.3750 (66.8750) lr 1.8607e-03 eta 0:00:10
epoch [36/200] batch [10/28] time 0.391 (0.457) data 0.261 (0.327) loss_x loss_x 1.6924 (1.3214) acc_x 59.3750 (66.2500) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [15/28] time 0.501 (0.460) data 0.370 (0.330) loss_x loss_x 1.2451 (1.3673) acc_x 59.3750 (63.1250) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [20/28] time 0.388 (0.455) data 0.257 (0.325) loss_x loss_x 1.4219 (1.3217) acc_x 68.7500 (63.9062) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/28] time 0.633 (0.464) data 0.502 (0.334) loss_x loss_x 1.3242 (1.3459) acc_x 59.3750 (64.2500) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1733
confident_label rate tensor(0.2988, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 937
clean true:932
clean false:5
clean_rate:0.9946638207043756
noisy true:471
noisy false:1728
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 2199
epoch [37/200] batch [5/29] time 0.553 (0.477) data 0.422 (0.346) loss_x loss_x 1.7002 (1.5316) acc_x 46.8750 (58.7500) lr 1.8526e-03 eta 0:00:11
epoch [37/200] batch [10/29] time 0.569 (0.481) data 0.438 (0.350) loss_x loss_x 1.7734 (1.4680) acc_x 59.3750 (61.5625) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [15/29] time 0.465 (0.481) data 0.333 (0.350) loss_x loss_x 1.7432 (1.5516) acc_x 62.5000 (59.7917) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [20/29] time 0.423 (0.472) data 0.292 (0.342) loss_x loss_x 1.3311 (1.5303) acc_x 62.5000 (60.0000) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [25/29] time 0.530 (0.482) data 0.399 (0.351) loss_x loss_x 1.0986 (1.5045) acc_x 68.7500 (60.3750) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1763
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 914
clean true:913
clean false:1
clean_rate:0.9989059080962801
noisy true:460
noisy false:1762
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 2222
epoch [38/200] batch [5/28] time 0.485 (0.491) data 0.354 (0.360) loss_x loss_x 1.1807 (1.4646) acc_x 65.6250 (63.1250) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [10/28] time 0.492 (0.468) data 0.360 (0.337) loss_x loss_x 1.4395 (1.3023) acc_x 53.1250 (66.5625) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [15/28] time 0.458 (0.460) data 0.328 (0.328) loss_x loss_x 1.1016 (1.3103) acc_x 65.6250 (65.2083) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [20/28] time 0.518 (0.469) data 0.388 (0.338) loss_x loss_x 0.8579 (1.2958) acc_x 71.8750 (65.3125) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/28] time 0.403 (0.462) data 0.272 (0.331) loss_x loss_x 1.6104 (1.3046) acc_x 62.5000 (66.1250) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1763
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:881
clean false:1
clean_rate:0.9988662131519275
noisy true:492
noisy false:1762
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [39/200] batch [5/27] time 0.459 (0.436) data 0.329 (0.306) loss_x loss_x 1.7109 (1.3645) acc_x 56.2500 (65.0000) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [10/27] time 0.371 (0.450) data 0.241 (0.319) loss_x loss_x 1.7529 (1.5293) acc_x 50.0000 (61.5625) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [15/27] time 0.409 (0.452) data 0.278 (0.321) loss_x loss_x 1.5068 (1.5096) acc_x 62.5000 (62.5000) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [20/27] time 0.439 (0.456) data 0.308 (0.325) loss_x loss_x 0.9966 (1.4459) acc_x 75.0000 (62.9688) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/27] time 0.490 (0.462) data 0.360 (0.332) loss_x loss_x 2.0527 (1.4879) acc_x 50.0000 (62.2500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1745
confident_label rate tensor(0.2918, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 915
clean true:911
clean false:4
clean_rate:0.9956284153005465
noisy true:480
noisy false:1741
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 2221
epoch [40/200] batch [5/28] time 0.436 (0.494) data 0.306 (0.364) loss_x loss_x 1.0986 (1.3982) acc_x 65.6250 (68.1250) lr 1.8271e-03 eta 0:00:11
epoch [40/200] batch [10/28] time 0.457 (0.483) data 0.327 (0.352) loss_x loss_x 1.0342 (1.2509) acc_x 71.8750 (69.0625) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [15/28] time 0.504 (0.484) data 0.373 (0.354) loss_x loss_x 1.8105 (1.2869) acc_x 53.1250 (67.5000) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [20/28] time 0.411 (0.469) data 0.281 (0.339) loss_x loss_x 2.0000 (1.4416) acc_x 50.0000 (64.5312) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/28] time 0.397 (0.475) data 0.267 (0.344) loss_x loss_x 1.7900 (1.4957) acc_x 65.6250 (63.2500) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.2876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 902
clean true:897
clean false:5
clean_rate:0.9944567627494457
noisy true:491
noisy false:1743
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 2234
epoch [41/200] batch [5/28] time 0.413 (0.428) data 0.282 (0.297) loss_x loss_x 1.3584 (1.4270) acc_x 65.6250 (60.0000) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [10/28] time 0.664 (0.474) data 0.534 (0.343) loss_x loss_x 1.1445 (1.3847) acc_x 62.5000 (62.8125) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [15/28] time 0.418 (0.474) data 0.288 (0.343) loss_x loss_x 1.2783 (1.4546) acc_x 65.6250 (61.6667) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [20/28] time 0.515 (0.482) data 0.384 (0.351) loss_x loss_x 1.4590 (1.4563) acc_x 62.5000 (61.7188) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/28] time 0.558 (0.497) data 0.428 (0.366) loss_x loss_x 0.8418 (1.4247) acc_x 75.0000 (63.2500) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1741
confident_label rate tensor(0.2988, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 937
clean true:933
clean false:4
clean_rate:0.9957310565635006
noisy true:462
noisy false:1737
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 2199
epoch [42/200] batch [5/29] time 0.428 (0.474) data 0.297 (0.343) loss_x loss_x 1.2705 (1.5078) acc_x 68.7500 (60.0000) lr 1.8090e-03 eta 0:00:11
epoch [42/200] batch [10/29] time 0.547 (0.478) data 0.415 (0.347) loss_x loss_x 1.2666 (1.3189) acc_x 62.5000 (64.3750) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [15/29] time 0.468 (0.470) data 0.337 (0.339) loss_x loss_x 1.4199 (1.3966) acc_x 59.3750 (61.8750) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [20/29] time 0.381 (0.463) data 0.251 (0.332) loss_x loss_x 1.4658 (1.4640) acc_x 65.6250 (60.9375) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [25/29] time 0.593 (0.461) data 0.462 (0.330) loss_x loss_x 1.5625 (1.4822) acc_x 65.6250 (61.6250) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1733
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 914
clean true:906
clean false:8
clean_rate:0.9912472647702407
noisy true:497
noisy false:1725
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 2222
epoch [43/200] batch [5/28] time 0.480 (0.512) data 0.350 (0.381) loss_x loss_x 1.1230 (1.2539) acc_x 68.7500 (60.6250) lr 1.7997e-03 eta 0:00:11
epoch [43/200] batch [10/28] time 0.460 (0.524) data 0.329 (0.393) loss_x loss_x 2.1992 (1.4896) acc_x 43.7500 (58.7500) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [15/28] time 0.428 (0.496) data 0.298 (0.365) loss_x loss_x 1.5674 (1.4872) acc_x 62.5000 (60.8333) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [20/28] time 0.564 (0.483) data 0.433 (0.353) loss_x loss_x 1.4443 (1.5180) acc_x 59.3750 (60.6250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/28] time 0.513 (0.483) data 0.383 (0.353) loss_x loss_x 1.3574 (1.5251) acc_x 71.8750 (59.3750) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.3074, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 964
clean true:959
clean false:5
clean_rate:0.9948132780082988
noisy true:477
noisy false:1695
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 2172
epoch [44/200] batch [5/30] time 0.534 (0.517) data 0.403 (0.386) loss_x loss_x 1.8193 (1.5252) acc_x 62.5000 (68.7500) lr 1.7902e-03 eta 0:00:12
epoch [44/200] batch [10/30] time 0.366 (0.493) data 0.236 (0.362) loss_x loss_x 1.6016 (1.4354) acc_x 65.6250 (68.1250) lr 1.7902e-03 eta 0:00:09
epoch [44/200] batch [15/30] time 0.419 (0.490) data 0.288 (0.359) loss_x loss_x 1.4629 (1.4492) acc_x 59.3750 (64.5833) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [20/30] time 0.521 (0.484) data 0.390 (0.353) loss_x loss_x 1.5283 (1.4169) acc_x 65.6250 (65.1562) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/30] time 0.484 (0.486) data 0.353 (0.355) loss_x loss_x 1.3994 (1.4371) acc_x 62.5000 (64.2500) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/30] time 0.471 (0.476) data 0.339 (0.345) loss_x loss_x 1.6592 (1.4505) acc_x 53.1250 (63.9583) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1708
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 941
clean true:939
clean false:2
clean_rate:0.997874601487779
noisy true:489
noisy false:1706
after delete: len(clean_dataset) 941
after delete: len(noisy_dataset) 2195
epoch [45/200] batch [5/29] time 0.442 (0.456) data 0.311 (0.325) loss_x loss_x 1.9707 (1.4826) acc_x 46.8750 (65.0000) lr 1.7804e-03 eta 0:00:10
epoch [45/200] batch [10/29] time 0.403 (0.439) data 0.272 (0.308) loss_x loss_x 0.9570 (1.4264) acc_x 75.0000 (65.3125) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [15/29] time 0.442 (0.448) data 0.311 (0.317) loss_x loss_x 1.2812 (1.3747) acc_x 59.3750 (65.2083) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [20/29] time 0.595 (0.456) data 0.464 (0.325) loss_x loss_x 1.3145 (1.4067) acc_x 62.5000 (64.2188) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [25/29] time 0.517 (0.471) data 0.386 (0.341) loss_x loss_x 1.7324 (1.3914) acc_x 53.1250 (64.8750) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1697
confident_label rate tensor(0.3074, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 964
clean true:960
clean false:4
clean_rate:0.995850622406639
noisy true:479
noisy false:1693
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 2172
epoch [46/200] batch [5/30] time 0.528 (0.447) data 0.398 (0.317) loss_x loss_x 1.8447 (1.4928) acc_x 50.0000 (59.3750) lr 1.7705e-03 eta 0:00:11
epoch [46/200] batch [10/30] time 0.535 (0.457) data 0.405 (0.327) loss_x loss_x 0.8696 (1.3982) acc_x 81.2500 (62.8125) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [15/30] time 0.449 (0.462) data 0.319 (0.331) loss_x loss_x 1.5645 (1.3841) acc_x 56.2500 (63.1250) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [20/30] time 0.443 (0.463) data 0.313 (0.332) loss_x loss_x 1.4658 (1.4274) acc_x 59.3750 (62.1875) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [25/30] time 0.559 (0.463) data 0.428 (0.332) loss_x loss_x 1.4180 (1.4438) acc_x 68.7500 (62.1250) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/30] time 0.452 (0.466) data 0.322 (0.336) loss_x loss_x 1.8965 (1.4534) acc_x 56.2500 (62.0833) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1711
confident_label rate tensor(0.2918, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 915
clean true:912
clean false:3
clean_rate:0.9967213114754099
noisy true:513
noisy false:1708
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 2221
epoch [47/200] batch [5/28] time 0.395 (0.489) data 0.264 (0.359) loss_x loss_x 1.3721 (1.2336) acc_x 59.3750 (67.5000) lr 1.7604e-03 eta 0:00:11
epoch [47/200] batch [10/28] time 0.406 (0.480) data 0.275 (0.350) loss_x loss_x 1.4395 (1.2444) acc_x 65.6250 (67.8125) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [15/28] time 0.520 (0.500) data 0.389 (0.369) loss_x loss_x 1.3389 (1.3072) acc_x 56.2500 (65.2083) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [20/28] time 0.451 (0.491) data 0.320 (0.361) loss_x loss_x 1.1074 (1.2785) acc_x 71.8750 (65.9375) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/28] time 0.478 (0.485) data 0.347 (0.354) loss_x loss_x 1.1436 (1.2883) acc_x 71.8750 (65.8750) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1704
confident_label rate tensor(0.2908, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 912
clean true:911
clean false:1
clean_rate:0.9989035087719298
noisy true:521
noisy false:1703
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 2224
epoch [48/200] batch [5/28] time 0.634 (0.540) data 0.504 (0.410) loss_x loss_x 0.9155 (1.2970) acc_x 71.8750 (65.6250) lr 1.7501e-03 eta 0:00:12
epoch [48/200] batch [10/28] time 0.487 (0.521) data 0.356 (0.391) loss_x loss_x 1.5518 (1.3366) acc_x 65.6250 (66.5625) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [15/28] time 0.413 (0.481) data 0.282 (0.350) loss_x loss_x 1.0928 (1.3654) acc_x 81.2500 (64.7917) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [20/28] time 0.451 (0.478) data 0.320 (0.347) loss_x loss_x 1.2295 (1.4357) acc_x 71.8750 (64.0625) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/28] time 0.380 (0.478) data 0.249 (0.347) loss_x loss_x 1.0615 (1.4022) acc_x 65.6250 (64.3750) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1721
confident_label rate tensor(0.2879, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 903
clean true:900
clean false:3
clean_rate:0.9966777408637874
noisy true:515
noisy false:1718
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 2233
epoch [49/200] batch [5/28] time 0.539 (0.438) data 0.408 (0.307) loss_x loss_x 1.8135 (1.4996) acc_x 62.5000 (58.1250) lr 1.7396e-03 eta 0:00:10
epoch [49/200] batch [10/28] time 0.436 (0.443) data 0.306 (0.312) loss_x loss_x 1.8818 (1.4914) acc_x 50.0000 (59.3750) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [15/28] time 0.484 (0.459) data 0.353 (0.328) loss_x loss_x 1.6416 (1.4256) acc_x 56.2500 (61.2500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [20/28] time 0.489 (0.461) data 0.359 (0.331) loss_x loss_x 0.9731 (1.4796) acc_x 68.7500 (60.1562) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/28] time 0.403 (0.451) data 0.272 (0.321) loss_x loss_x 1.4561 (1.4406) acc_x 65.6250 (61.3750) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.3087, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 968
clean true:964
clean false:4
clean_rate:0.9958677685950413
noisy true:519
noisy false:1649
after delete: len(clean_dataset) 968
after delete: len(noisy_dataset) 2168
epoch [50/200] batch [5/30] time 0.514 (0.505) data 0.383 (0.374) loss_x loss_x 1.9385 (1.4342) acc_x 53.1250 (63.7500) lr 1.7290e-03 eta 0:00:12
epoch [50/200] batch [10/30] time 0.392 (0.486) data 0.261 (0.356) loss_x loss_x 1.5195 (1.5200) acc_x 68.7500 (61.8750) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [15/30] time 0.412 (0.476) data 0.280 (0.345) loss_x loss_x 1.3926 (1.4205) acc_x 68.7500 (65.0000) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [20/30] time 0.414 (0.479) data 0.283 (0.348) loss_x loss_x 0.4983 (1.3183) acc_x 90.6250 (68.2812) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [25/30] time 0.572 (0.477) data 0.442 (0.346) loss_x loss_x 1.1885 (1.3203) acc_x 71.8750 (68.0000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [30/30] time 0.361 (0.464) data 0.230 (0.333) loss_x loss_x 1.4102 (1.3726) acc_x 65.6250 (66.2500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.2924, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 917
clean true:915
clean false:2
clean_rate:0.9978189749182116
noisy true:493
noisy false:1726
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 2219
epoch [51/200] batch [5/28] time 0.472 (0.496) data 0.341 (0.366) loss_x loss_x 1.0674 (1.5092) acc_x 68.7500 (60.0000) lr 1.7181e-03 eta 0:00:11
epoch [51/200] batch [10/28] time 0.497 (0.468) data 0.367 (0.338) loss_x loss_x 1.5117 (1.4531) acc_x 68.7500 (63.1250) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [15/28] time 0.574 (0.462) data 0.443 (0.331) loss_x loss_x 1.1826 (1.4291) acc_x 75.0000 (63.9583) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [20/28] time 0.494 (0.474) data 0.363 (0.344) loss_x loss_x 1.8779 (1.4707) acc_x 59.3750 (62.0312) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/28] time 0.471 (0.483) data 0.340 (0.352) loss_x loss_x 1.6543 (1.4162) acc_x 65.6250 (63.0000) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1714
confident_label rate tensor(0.3071, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 963
clean true:957
clean false:6
clean_rate:0.9937694704049844
noisy true:465
noisy false:1708
after delete: len(clean_dataset) 963
after delete: len(noisy_dataset) 2173
epoch [52/200] batch [5/30] time 0.622 (0.451) data 0.491 (0.320) loss_x loss_x 1.3965 (1.3764) acc_x 71.8750 (68.7500) lr 1.7071e-03 eta 0:00:11
epoch [52/200] batch [10/30] time 0.542 (0.464) data 0.411 (0.332) loss_x loss_x 1.2422 (1.4185) acc_x 62.5000 (65.6250) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [15/30] time 0.409 (0.468) data 0.278 (0.337) loss_x loss_x 1.3789 (1.4355) acc_x 71.8750 (65.6250) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [20/30] time 0.503 (0.466) data 0.372 (0.335) loss_x loss_x 1.9473 (1.4329) acc_x 53.1250 (65.4688) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [25/30] time 0.407 (0.467) data 0.276 (0.335) loss_x loss_x 2.0098 (1.4285) acc_x 56.2500 (64.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/30] time 0.578 (0.467) data 0.447 (0.336) loss_x loss_x 1.0449 (1.4108) acc_x 78.1250 (65.4167) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.2959, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 928
clean true:927
clean false:1
clean_rate:0.9989224137931034
noisy true:500
noisy false:1708
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 2208
epoch [53/200] batch [5/29] time 0.417 (0.458) data 0.286 (0.327) loss_x loss_x 0.7036 (1.2573) acc_x 84.3750 (68.1250) lr 1.6959e-03 eta 0:00:10
epoch [53/200] batch [10/29] time 0.427 (0.448) data 0.296 (0.317) loss_x loss_x 1.3330 (1.2550) acc_x 56.2500 (68.4375) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [15/29] time 0.486 (0.457) data 0.355 (0.326) loss_x loss_x 0.8921 (1.2618) acc_x 78.1250 (67.9167) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [20/29] time 0.359 (0.452) data 0.228 (0.321) loss_x loss_x 1.4619 (1.3360) acc_x 65.6250 (66.8750) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [25/29] time 0.467 (0.460) data 0.336 (0.329) loss_x loss_x 1.4424 (1.3458) acc_x 62.5000 (66.0000) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.3023, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 948
clean true:947
clean false:1
clean_rate:0.9989451476793249
noisy true:497
noisy false:1691
after delete: len(clean_dataset) 948
after delete: len(noisy_dataset) 2188
epoch [54/200] batch [5/29] time 0.385 (0.454) data 0.255 (0.323) loss_x loss_x 1.0781 (1.2443) acc_x 65.6250 (70.6250) lr 1.6845e-03 eta 0:00:10
epoch [54/200] batch [10/29] time 0.452 (0.434) data 0.321 (0.303) loss_x loss_x 1.4531 (1.2989) acc_x 62.5000 (69.0625) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [15/29] time 0.401 (0.449) data 0.270 (0.319) loss_x loss_x 1.3740 (1.3410) acc_x 53.1250 (66.2500) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [20/29] time 0.584 (0.467) data 0.452 (0.336) loss_x loss_x 1.5576 (1.3762) acc_x 56.2500 (65.3125) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [25/29] time 0.442 (0.470) data 0.311 (0.339) loss_x loss_x 1.3271 (1.3475) acc_x 68.7500 (66.5000) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1661
confident_label rate tensor(0.3061, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 960
clean true:956
clean false:4
clean_rate:0.9958333333333333
noisy true:519
noisy false:1657
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 2176
epoch [55/200] batch [5/30] time 0.403 (0.489) data 0.273 (0.358) loss_x loss_x 1.5010 (1.4061) acc_x 59.3750 (61.2500) lr 1.6730e-03 eta 0:00:12
epoch [55/200] batch [10/30] time 0.413 (0.499) data 0.283 (0.368) loss_x loss_x 1.1387 (1.3100) acc_x 71.8750 (65.3125) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [15/30] time 0.590 (0.490) data 0.459 (0.359) loss_x loss_x 1.0586 (1.3107) acc_x 71.8750 (65.2083) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [20/30] time 0.428 (0.482) data 0.297 (0.351) loss_x loss_x 1.0508 (1.3012) acc_x 71.8750 (65.9375) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [25/30] time 0.444 (0.488) data 0.314 (0.358) loss_x loss_x 1.5820 (1.3478) acc_x 56.2500 (65.0000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/30] time 0.389 (0.476) data 0.258 (0.346) loss_x loss_x 1.7207 (1.3473) acc_x 46.8750 (64.7917) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1673
confident_label rate tensor(0.3096, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 971
clean true:964
clean false:7
clean_rate:0.9927909371781668
noisy true:499
noisy false:1666
after delete: len(clean_dataset) 971
after delete: len(noisy_dataset) 2165
epoch [56/200] batch [5/30] time 0.539 (0.499) data 0.407 (0.368) loss_x loss_x 1.6738 (1.3084) acc_x 59.3750 (64.3750) lr 1.6613e-03 eta 0:00:12
epoch [56/200] batch [10/30] time 0.462 (0.485) data 0.330 (0.354) loss_x loss_x 1.3701 (1.3883) acc_x 65.6250 (64.0625) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [15/30] time 0.426 (0.474) data 0.295 (0.343) loss_x loss_x 1.2607 (1.3938) acc_x 65.6250 (61.6667) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [20/30] time 0.413 (0.490) data 0.282 (0.359) loss_x loss_x 1.5166 (1.3708) acc_x 75.0000 (64.3750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/30] time 0.394 (0.482) data 0.263 (0.351) loss_x loss_x 1.2520 (1.3439) acc_x 68.7500 (65.2500) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/30] time 0.430 (0.477) data 0.299 (0.346) loss_x loss_x 1.1494 (1.3132) acc_x 65.6250 (65.4167) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1656
confident_label rate tensor(0.3090, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 969
clean true:966
clean false:3
clean_rate:0.9969040247678018
noisy true:514
noisy false:1653
after delete: len(clean_dataset) 969
after delete: len(noisy_dataset) 2167
epoch [57/200] batch [5/30] time 0.321 (0.431) data 0.190 (0.300) loss_x loss_x 1.6826 (1.5922) acc_x 62.5000 (60.0000) lr 1.6494e-03 eta 0:00:10
epoch [57/200] batch [10/30] time 0.498 (0.465) data 0.367 (0.334) loss_x loss_x 1.3955 (1.5192) acc_x 68.7500 (59.0625) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [15/30] time 0.524 (0.466) data 0.394 (0.335) loss_x loss_x 1.2842 (1.4144) acc_x 65.6250 (62.0833) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [20/30] time 0.457 (0.473) data 0.326 (0.342) loss_x loss_x 1.2861 (1.4172) acc_x 65.6250 (64.0625) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [25/30] time 0.439 (0.476) data 0.308 (0.345) loss_x loss_x 1.1074 (1.3764) acc_x 71.8750 (64.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/30] time 0.430 (0.470) data 0.299 (0.340) loss_x loss_x 1.5273 (1.3943) acc_x 65.6250 (63.9583) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3084, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 967
clean true:965
clean false:2
clean_rate:0.9979317476732161
noisy true:537
noisy false:1632
after delete: len(clean_dataset) 967
after delete: len(noisy_dataset) 2169
epoch [58/200] batch [5/30] time 0.462 (0.475) data 0.332 (0.344) loss_x loss_x 1.4238 (1.3537) acc_x 65.6250 (68.1250) lr 1.6374e-03 eta 0:00:11
epoch [58/200] batch [10/30] time 0.472 (0.486) data 0.342 (0.356) loss_x loss_x 1.4092 (1.4425) acc_x 62.5000 (63.4375) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [15/30] time 0.426 (0.475) data 0.294 (0.344) loss_x loss_x 1.3516 (1.4608) acc_x 71.8750 (64.3750) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [20/30] time 0.416 (0.475) data 0.285 (0.344) loss_x loss_x 1.1582 (1.4079) acc_x 78.1250 (65.3125) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [25/30] time 0.479 (0.469) data 0.349 (0.338) loss_x loss_x 1.1904 (1.4022) acc_x 59.3750 (64.1250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/30] time 0.496 (0.462) data 0.365 (0.331) loss_x loss_x 0.9258 (1.3890) acc_x 75.0000 (64.6875) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 927
clean true:922
clean false:5
clean_rate:0.9946062567421791
noisy true:499
noisy false:1710
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 2209
epoch [59/200] batch [5/28] time 0.502 (0.451) data 0.371 (0.320) loss_x loss_x 0.9673 (1.3063) acc_x 78.1250 (68.7500) lr 1.6252e-03 eta 0:00:10
epoch [59/200] batch [10/28] time 0.559 (0.503) data 0.428 (0.372) loss_x loss_x 1.4014 (1.3314) acc_x 65.6250 (69.3750) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [15/28] time 0.607 (0.492) data 0.476 (0.361) loss_x loss_x 1.6904 (1.3640) acc_x 62.5000 (67.5000) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [20/28] time 0.466 (0.475) data 0.334 (0.344) loss_x loss_x 1.5674 (1.3889) acc_x 59.3750 (65.7812) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/28] time 0.368 (0.474) data 0.237 (0.343) loss_x loss_x 1.1748 (1.4176) acc_x 75.0000 (65.3750) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.3036, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 952
clean true:947
clean false:5
clean_rate:0.9947478991596639
noisy true:490
noisy false:1694
after delete: len(clean_dataset) 952
after delete: len(noisy_dataset) 2184
epoch [60/200] batch [5/29] time 0.466 (0.446) data 0.335 (0.315) loss_x loss_x 1.5859 (1.6609) acc_x 65.6250 (58.7500) lr 1.6129e-03 eta 0:00:10
epoch [60/200] batch [10/29] time 0.436 (0.436) data 0.305 (0.305) loss_x loss_x 1.5303 (1.6191) acc_x 62.5000 (59.0625) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [15/29] time 0.464 (0.457) data 0.334 (0.326) loss_x loss_x 1.1709 (1.4913) acc_x 71.8750 (61.8750) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [20/29] time 0.442 (0.454) data 0.312 (0.323) loss_x loss_x 1.5967 (1.4788) acc_x 46.8750 (61.5625) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [25/29] time 0.527 (0.451) data 0.396 (0.320) loss_x loss_x 1.5400 (1.4722) acc_x 56.2500 (62.0000) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1736
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 918
clean true:915
clean false:3
clean_rate:0.9967320261437909
noisy true:485
noisy false:1733
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 2218
epoch [61/200] batch [5/28] time 0.502 (0.454) data 0.372 (0.324) loss_x loss_x 1.3008 (1.3795) acc_x 71.8750 (63.1250) lr 1.6004e-03 eta 0:00:10
epoch [61/200] batch [10/28] time 0.364 (0.455) data 0.233 (0.325) loss_x loss_x 1.0537 (1.2863) acc_x 71.8750 (67.5000) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [15/28] time 0.387 (0.454) data 0.257 (0.324) loss_x loss_x 0.9077 (1.2890) acc_x 78.1250 (67.0833) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [20/28] time 0.377 (0.474) data 0.246 (0.344) loss_x loss_x 1.1445 (1.2972) acc_x 81.2500 (67.5000) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/28] time 0.473 (0.480) data 0.343 (0.350) loss_x loss_x 1.0977 (1.3294) acc_x 81.2500 (67.6250) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1693
confident_label rate tensor(0.2972, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 932
clean true:929
clean false:3
clean_rate:0.9967811158798283
noisy true:514
noisy false:1690
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 2204
epoch [62/200] batch [5/29] time 0.411 (0.437) data 0.281 (0.306) loss_x loss_x 1.5869 (1.5322) acc_x 59.3750 (60.0000) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [10/29] time 0.456 (0.442) data 0.325 (0.311) loss_x loss_x 1.2930 (1.3686) acc_x 62.5000 (65.0000) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [15/29] time 0.484 (0.463) data 0.353 (0.333) loss_x loss_x 1.4668 (1.3054) acc_x 62.5000 (66.6667) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [20/29] time 0.456 (0.453) data 0.325 (0.322) loss_x loss_x 1.0879 (1.3078) acc_x 68.7500 (67.0312) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [25/29] time 0.516 (0.454) data 0.385 (0.323) loss_x loss_x 1.1406 (1.2954) acc_x 68.7500 (67.3750) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.3052, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 957
clean true:955
clean false:2
clean_rate:0.9979101358411703
noisy true:510
noisy false:1669
after delete: len(clean_dataset) 957
after delete: len(noisy_dataset) 2179
epoch [63/200] batch [5/29] time 0.456 (0.509) data 0.326 (0.379) loss_x loss_x 1.3291 (1.4293) acc_x 65.6250 (61.2500) lr 1.5750e-03 eta 0:00:12
epoch [63/200] batch [10/29] time 0.439 (0.483) data 0.308 (0.353) loss_x loss_x 1.5859 (1.4475) acc_x 53.1250 (59.3750) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [15/29] time 0.423 (0.476) data 0.293 (0.346) loss_x loss_x 1.5635 (1.3951) acc_x 56.2500 (62.2917) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [20/29] time 0.507 (0.478) data 0.376 (0.348) loss_x loss_x 0.7031 (1.3756) acc_x 78.1250 (62.8125) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [25/29] time 0.566 (0.477) data 0.434 (0.347) loss_x loss_x 1.4766 (1.3636) acc_x 68.7500 (63.3750) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 939
clean true:937
clean false:2
clean_rate:0.9978700745473909
noisy true:503
noisy false:1694
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 2197
epoch [64/200] batch [5/29] time 0.453 (0.451) data 0.322 (0.320) loss_x loss_x 1.0703 (1.3490) acc_x 62.5000 (62.5000) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [10/29] time 0.761 (0.508) data 0.630 (0.377) loss_x loss_x 1.6641 (1.3591) acc_x 59.3750 (64.3750) lr 1.5621e-03 eta 0:00:09
epoch [64/200] batch [15/29] time 0.334 (0.480) data 0.203 (0.349) loss_x loss_x 1.1992 (1.3313) acc_x 68.7500 (65.0000) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [20/29] time 0.544 (0.481) data 0.413 (0.350) loss_x loss_x 1.5889 (1.3642) acc_x 65.6250 (64.5312) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [25/29] time 0.503 (0.474) data 0.372 (0.343) loss_x loss_x 1.6592 (1.3881) acc_x 59.3750 (64.8750) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.3058, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 959
clean true:954
clean false:5
clean_rate:0.9947862356621481
noisy true:503
noisy false:1674
after delete: len(clean_dataset) 959
after delete: len(noisy_dataset) 2177
epoch [65/200] batch [5/29] time 0.560 (0.455) data 0.429 (0.324) loss_x loss_x 1.3105 (1.3544) acc_x 68.7500 (63.7500) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [10/29] time 0.460 (0.485) data 0.329 (0.354) loss_x loss_x 1.0674 (1.3844) acc_x 78.1250 (64.0625) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [15/29] time 0.454 (0.472) data 0.322 (0.341) loss_x loss_x 0.7837 (1.3416) acc_x 81.2500 (66.0417) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [20/29] time 0.559 (0.479) data 0.428 (0.348) loss_x loss_x 0.9375 (1.3504) acc_x 71.8750 (64.5312) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [25/29] time 0.433 (0.479) data 0.302 (0.348) loss_x loss_x 1.3506 (1.3729) acc_x 65.6250 (63.5000) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1659
confident_label rate tensor(0.3112, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 976
clean true:975
clean false:1
clean_rate:0.9989754098360656
noisy true:502
noisy false:1658
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 2160
epoch [66/200] batch [5/30] time 0.427 (0.465) data 0.296 (0.334) loss_x loss_x 1.2881 (1.2783) acc_x 59.3750 (65.0000) lr 1.5358e-03 eta 0:00:11
epoch [66/200] batch [10/30] time 0.527 (0.471) data 0.395 (0.340) loss_x loss_x 1.0312 (1.2538) acc_x 68.7500 (65.6250) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [15/30] time 0.497 (0.466) data 0.366 (0.335) loss_x loss_x 1.5664 (1.2474) acc_x 59.3750 (65.8333) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [20/30] time 0.413 (0.460) data 0.282 (0.329) loss_x loss_x 1.6006 (1.2490) acc_x 65.6250 (66.7188) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [25/30] time 0.439 (0.460) data 0.308 (0.329) loss_x loss_x 1.9062 (1.2836) acc_x 53.1250 (66.0000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/30] time 0.509 (0.464) data 0.379 (0.333) loss_x loss_x 1.3955 (1.3142) acc_x 65.6250 (65.1042) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1683
confident_label rate tensor(0.3029, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 950
clean true:948
clean false:2
clean_rate:0.9978947368421053
noisy true:505
noisy false:1681
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 2186
epoch [67/200] batch [5/29] time 0.425 (0.468) data 0.294 (0.338) loss_x loss_x 1.9717 (1.4839) acc_x 59.3750 (65.0000) lr 1.5225e-03 eta 0:00:11
epoch [67/200] batch [10/29] time 0.539 (0.469) data 0.408 (0.338) loss_x loss_x 1.0713 (1.4438) acc_x 68.7500 (62.8125) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [15/29] time 0.481 (0.467) data 0.351 (0.336) loss_x loss_x 1.7480 (1.4900) acc_x 53.1250 (61.2500) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [20/29] time 0.512 (0.469) data 0.381 (0.338) loss_x loss_x 1.2383 (1.4205) acc_x 59.3750 (62.0312) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [25/29] time 0.386 (0.466) data 0.255 (0.335) loss_x loss_x 0.8945 (1.4100) acc_x 78.1250 (62.8750) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1688
confident_label rate tensor(0.3068, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 962
clean true:961
clean false:1
clean_rate:0.998960498960499
noisy true:487
noisy false:1687
after delete: len(clean_dataset) 962
after delete: len(noisy_dataset) 2174
epoch [68/200] batch [5/30] time 0.465 (0.453) data 0.334 (0.322) loss_x loss_x 1.3477 (1.3379) acc_x 56.2500 (62.5000) lr 1.5090e-03 eta 0:00:11
epoch [68/200] batch [10/30] time 0.639 (0.496) data 0.508 (0.365) loss_x loss_x 1.4951 (1.3108) acc_x 59.3750 (65.6250) lr 1.5090e-03 eta 0:00:09
epoch [68/200] batch [15/30] time 0.361 (0.481) data 0.231 (0.351) loss_x loss_x 1.3740 (1.4230) acc_x 65.6250 (62.9167) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [20/30] time 0.394 (0.466) data 0.264 (0.335) loss_x loss_x 1.1523 (1.4107) acc_x 65.6250 (63.5938) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [25/30] time 0.547 (0.469) data 0.417 (0.338) loss_x loss_x 1.4180 (1.3839) acc_x 68.7500 (64.8750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/30] time 0.445 (0.459) data 0.315 (0.329) loss_x loss_x 1.5342 (1.4157) acc_x 71.8750 (65.1042) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1655
confident_label rate tensor(0.3080, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 966
clean true:960
clean false:6
clean_rate:0.9937888198757764
noisy true:521
noisy false:1649
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 2170
epoch [69/200] batch [5/30] time 0.468 (0.514) data 0.338 (0.383) loss_x loss_x 1.3467 (1.3244) acc_x 65.6250 (64.3750) lr 1.4955e-03 eta 0:00:12
epoch [69/200] batch [10/30] time 0.450 (0.477) data 0.320 (0.346) loss_x loss_x 1.6484 (1.3079) acc_x 65.6250 (67.5000) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [15/30] time 0.401 (0.464) data 0.270 (0.333) loss_x loss_x 0.8955 (1.2783) acc_x 84.3750 (68.1250) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [20/30] time 0.473 (0.488) data 0.342 (0.358) loss_x loss_x 1.6396 (1.3047) acc_x 62.5000 (68.2812) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [25/30] time 0.446 (0.481) data 0.316 (0.351) loss_x loss_x 1.2959 (1.3734) acc_x 65.6250 (66.8750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/30] time 0.496 (0.482) data 0.366 (0.352) loss_x loss_x 1.3037 (1.3463) acc_x 65.6250 (67.3958) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1652
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 978
clean true:975
clean false:3
clean_rate:0.9969325153374233
noisy true:509
noisy false:1649
after delete: len(clean_dataset) 978
after delete: len(noisy_dataset) 2158
epoch [70/200] batch [5/30] time 0.431 (0.462) data 0.301 (0.331) loss_x loss_x 0.8091 (1.1786) acc_x 81.2500 (70.6250) lr 1.4818e-03 eta 0:00:11
epoch [70/200] batch [10/30] time 0.490 (0.460) data 0.359 (0.329) loss_x loss_x 1.2178 (1.2825) acc_x 78.1250 (70.6250) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [15/30] time 0.633 (0.469) data 0.502 (0.338) loss_x loss_x 1.7422 (1.2859) acc_x 59.3750 (70.4167) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [20/30] time 0.453 (0.465) data 0.322 (0.334) loss_x loss_x 1.5527 (1.3229) acc_x 59.3750 (68.7500) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [25/30] time 0.452 (0.466) data 0.321 (0.335) loss_x loss_x 0.9932 (1.3210) acc_x 78.1250 (68.2500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/30] time 0.458 (0.465) data 0.327 (0.334) loss_x loss_x 1.9951 (1.3537) acc_x 53.1250 (67.3958) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.3039, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 953
clean true:950
clean false:3
clean_rate:0.9968520461699895
noisy true:537
noisy false:1646
after delete: len(clean_dataset) 953
after delete: len(noisy_dataset) 2183
epoch [71/200] batch [5/29] time 0.470 (0.478) data 0.340 (0.347) loss_x loss_x 1.2402 (1.0899) acc_x 62.5000 (68.1250) lr 1.4679e-03 eta 0:00:11
epoch [71/200] batch [10/29] time 0.383 (0.458) data 0.253 (0.328) loss_x loss_x 1.0225 (1.0792) acc_x 78.1250 (70.3125) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [15/29] time 0.472 (0.444) data 0.341 (0.314) loss_x loss_x 0.6919 (1.0932) acc_x 84.3750 (70.6250) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [20/29] time 0.495 (0.456) data 0.365 (0.325) loss_x loss_x 1.7383 (1.1459) acc_x 50.0000 (70.0000) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [25/29] time 0.419 (0.457) data 0.287 (0.326) loss_x loss_x 1.4941 (1.2037) acc_x 65.6250 (68.8750) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1628
confident_label rate tensor(0.3176, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 996
clean true:995
clean false:1
clean_rate:0.998995983935743
noisy true:513
noisy false:1627
after delete: len(clean_dataset) 996
after delete: len(noisy_dataset) 2140
epoch [72/200] batch [5/31] time 0.516 (0.523) data 0.387 (0.392) loss_x loss_x 1.6045 (1.4098) acc_x 50.0000 (65.0000) lr 1.4540e-03 eta 0:00:13
epoch [72/200] batch [10/31] time 0.412 (0.494) data 0.281 (0.363) loss_x loss_x 1.2051 (1.3144) acc_x 65.6250 (65.0000) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [15/31] time 0.382 (0.488) data 0.251 (0.357) loss_x loss_x 1.6396 (1.3387) acc_x 68.7500 (64.3750) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [20/31] time 0.360 (0.465) data 0.229 (0.334) loss_x loss_x 1.3105 (1.3836) acc_x 68.7500 (64.3750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [25/31] time 0.421 (0.455) data 0.290 (0.324) loss_x loss_x 1.8984 (1.3912) acc_x 59.3750 (64.1250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/31] time 0.494 (0.462) data 0.363 (0.331) loss_x loss_x 1.2861 (1.3771) acc_x 78.1250 (65.4167) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1724
confident_label rate tensor(0.3004, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 942
clean true:937
clean false:5
clean_rate:0.994692144373673
noisy true:475
noisy false:1719
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 2194
epoch [73/200] batch [5/29] time 0.399 (0.463) data 0.268 (0.332) loss_x loss_x 1.8145 (1.4754) acc_x 53.1250 (61.2500) lr 1.4399e-03 eta 0:00:11
epoch [73/200] batch [10/29] time 0.525 (0.480) data 0.395 (0.349) loss_x loss_x 0.9868 (1.2835) acc_x 78.1250 (67.5000) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [15/29] time 0.467 (0.479) data 0.336 (0.348) loss_x loss_x 1.0156 (1.3503) acc_x 68.7500 (66.4583) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [20/29] time 0.437 (0.467) data 0.306 (0.337) loss_x loss_x 1.3828 (1.3372) acc_x 65.6250 (65.7812) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [25/29] time 0.444 (0.464) data 0.311 (0.333) loss_x loss_x 1.3086 (1.3303) acc_x 59.3750 (66.0000) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.2982, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 935
clean true:931
clean false:4
clean_rate:0.9957219251336898
noisy true:521
noisy false:1680
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 2201
epoch [74/200] batch [5/29] time 0.364 (0.441) data 0.233 (0.310) loss_x loss_x 1.3330 (1.3077) acc_x 62.5000 (66.8750) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [10/29] time 0.415 (0.452) data 0.283 (0.321) loss_x loss_x 0.9849 (1.3921) acc_x 75.0000 (65.0000) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [15/29] time 0.635 (0.473) data 0.504 (0.342) loss_x loss_x 1.0723 (1.3474) acc_x 71.8750 (64.7917) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [20/29] time 0.462 (0.479) data 0.332 (0.348) loss_x loss_x 1.4521 (1.2851) acc_x 65.6250 (66.8750) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [25/29] time 0.449 (0.473) data 0.318 (0.342) loss_x loss_x 1.4121 (1.3028) acc_x 68.7500 (67.0000) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 982
clean true:979
clean false:3
clean_rate:0.9969450101832994
noisy true:523
noisy false:1631
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 2154
epoch [75/200] batch [5/30] time 0.502 (0.473) data 0.372 (0.342) loss_x loss_x 0.9121 (0.9661) acc_x 71.8750 (73.7500) lr 1.4115e-03 eta 0:00:11
epoch [75/200] batch [10/30] time 0.425 (0.442) data 0.295 (0.311) loss_x loss_x 1.4209 (1.1945) acc_x 65.6250 (70.3125) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [15/30] time 0.432 (0.452) data 0.301 (0.321) loss_x loss_x 1.1250 (1.2292) acc_x 78.1250 (69.5833) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [20/30] time 0.484 (0.456) data 0.353 (0.325) loss_x loss_x 0.9565 (1.2700) acc_x 68.7500 (67.3438) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [25/30] time 0.428 (0.456) data 0.297 (0.325) loss_x loss_x 1.1465 (1.2753) acc_x 65.6250 (66.6250) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [30/30] time 0.433 (0.457) data 0.302 (0.326) loss_x loss_x 2.0566 (1.3097) acc_x 53.1250 (65.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1017
clean true:1013
clean false:4
clean_rate:0.9960668633235005
noisy true:515
noisy false:1604
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 2119
epoch [76/200] batch [5/31] time 0.411 (0.454) data 0.279 (0.323) loss_x loss_x 0.9810 (1.2214) acc_x 65.6250 (65.0000) lr 1.3971e-03 eta 0:00:11
epoch [76/200] batch [10/31] time 0.543 (0.479) data 0.412 (0.348) loss_x loss_x 1.2227 (1.2156) acc_x 56.2500 (63.1250) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [15/31] time 0.462 (0.483) data 0.330 (0.352) loss_x loss_x 1.7227 (1.3394) acc_x 56.2500 (62.7083) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [20/31] time 0.361 (0.464) data 0.230 (0.333) loss_x loss_x 1.6777 (1.3385) acc_x 53.1250 (63.7500) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [25/31] time 0.431 (0.456) data 0.300 (0.326) loss_x loss_x 1.2275 (1.3281) acc_x 62.5000 (63.6250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/31] time 0.438 (0.461) data 0.307 (0.330) loss_x loss_x 1.4727 (1.3179) acc_x 71.8750 (64.7917) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1624
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1013
clean true:1011
clean false:2
clean_rate:0.998025666337611
noisy true:501
noisy false:1622
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 2123
epoch [77/200] batch [5/31] time 0.367 (0.454) data 0.236 (0.323) loss_x loss_x 1.2969 (1.5020) acc_x 68.7500 (61.8750) lr 1.3827e-03 eta 0:00:11
epoch [77/200] batch [10/31] time 0.526 (0.481) data 0.395 (0.350) loss_x loss_x 0.9922 (1.3783) acc_x 75.0000 (65.0000) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [15/31] time 0.487 (0.480) data 0.356 (0.349) loss_x loss_x 1.1562 (1.3681) acc_x 71.8750 (66.0417) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [20/31] time 0.578 (0.481) data 0.447 (0.350) loss_x loss_x 0.9282 (1.3868) acc_x 71.8750 (64.8438) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [25/31] time 0.447 (0.476) data 0.316 (0.345) loss_x loss_x 1.6943 (1.4329) acc_x 56.2500 (63.1250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [30/31] time 0.404 (0.470) data 0.271 (0.339) loss_x loss_x 0.8745 (1.3538) acc_x 71.8750 (64.7917) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1645
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1015
clean true:1013
clean false:2
clean_rate:0.9980295566502463
noisy true:478
noisy false:1643
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 2121
epoch [78/200] batch [5/31] time 0.520 (0.481) data 0.389 (0.350) loss_x loss_x 1.2041 (1.2859) acc_x 65.6250 (69.3750) lr 1.3681e-03 eta 0:00:12
epoch [78/200] batch [10/31] time 0.600 (0.492) data 0.469 (0.361) loss_x loss_x 0.9277 (1.2350) acc_x 75.0000 (70.0000) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [15/31] time 0.450 (0.482) data 0.320 (0.352) loss_x loss_x 0.9854 (1.2337) acc_x 68.7500 (69.5833) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [20/31] time 0.413 (0.473) data 0.282 (0.342) loss_x loss_x 1.1816 (1.2171) acc_x 78.1250 (70.0000) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [25/31] time 0.448 (0.477) data 0.318 (0.346) loss_x loss_x 1.4189 (1.2387) acc_x 62.5000 (69.7500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/31] time 0.334 (0.470) data 0.203 (0.339) loss_x loss_x 1.5059 (1.2367) acc_x 53.1250 (69.1667) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1007
clean true:1004
clean false:3
clean_rate:0.997020854021847
noisy true:529
noisy false:1600
after delete: len(clean_dataset) 1007
after delete: len(noisy_dataset) 2129
epoch [79/200] batch [5/31] time 0.527 (0.537) data 0.397 (0.407) loss_x loss_x 1.9863 (1.3973) acc_x 50.0000 (65.6250) lr 1.3535e-03 eta 0:00:13
epoch [79/200] batch [10/31] time 0.490 (0.498) data 0.360 (0.368) loss_x loss_x 1.5205 (1.4053) acc_x 59.3750 (65.9375) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [15/31] time 0.336 (0.480) data 0.206 (0.349) loss_x loss_x 1.7881 (1.3422) acc_x 56.2500 (67.5000) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [20/31] time 0.451 (0.476) data 0.320 (0.345) loss_x loss_x 1.0889 (1.3212) acc_x 65.6250 (66.4062) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [25/31] time 0.409 (0.470) data 0.279 (0.340) loss_x loss_x 0.9438 (1.3096) acc_x 75.0000 (67.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/31] time 0.507 (0.469) data 0.376 (0.338) loss_x loss_x 1.2588 (1.3208) acc_x 75.0000 (66.8750) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1651
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 980
clean true:976
clean false:4
clean_rate:0.9959183673469387
noisy true:509
noisy false:1647
after delete: len(clean_dataset) 980
after delete: len(noisy_dataset) 2156
epoch [80/200] batch [5/30] time 0.523 (0.445) data 0.393 (0.314) loss_x loss_x 1.1494 (1.2988) acc_x 75.0000 (68.7500) lr 1.3387e-03 eta 0:00:11
epoch [80/200] batch [10/30] time 0.397 (0.472) data 0.266 (0.341) loss_x loss_x 0.8354 (1.3279) acc_x 65.6250 (65.9375) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [15/30] time 0.457 (0.471) data 0.327 (0.340) loss_x loss_x 1.4600 (1.4229) acc_x 62.5000 (64.3750) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [20/30] time 0.512 (0.458) data 0.381 (0.327) loss_x loss_x 1.3721 (1.4084) acc_x 68.7500 (65.6250) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [25/30] time 0.506 (0.457) data 0.375 (0.326) loss_x loss_x 1.4932 (1.4280) acc_x 65.6250 (64.7500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/30] time 0.478 (0.455) data 0.346 (0.324) loss_x loss_x 0.8247 (1.3381) acc_x 78.1250 (66.7708) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1645
confident_label rate tensor(0.3099, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 972
clean true:967
clean false:5
clean_rate:0.9948559670781894
noisy true:524
noisy false:1640
after delete: len(clean_dataset) 972
after delete: len(noisy_dataset) 2164
epoch [81/200] batch [5/30] time 0.548 (0.443) data 0.417 (0.312) loss_x loss_x 1.0430 (1.3316) acc_x 71.8750 (66.8750) lr 1.3239e-03 eta 0:00:11
epoch [81/200] batch [10/30] time 0.488 (0.470) data 0.358 (0.339) loss_x loss_x 1.7793 (1.5420) acc_x 59.3750 (62.8125) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [15/30] time 0.458 (0.456) data 0.327 (0.325) loss_x loss_x 1.4805 (1.5157) acc_x 68.7500 (64.1667) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/30] time 0.443 (0.464) data 0.313 (0.333) loss_x loss_x 0.7402 (1.4466) acc_x 75.0000 (64.6875) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/30] time 0.512 (0.465) data 0.382 (0.334) loss_x loss_x 1.2549 (1.4023) acc_x 68.7500 (65.6250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/30] time 0.447 (0.470) data 0.316 (0.339) loss_x loss_x 1.7471 (1.3700) acc_x 53.1250 (66.3542) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1652
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 980
clean true:980
clean false:0
clean_rate:1.0
noisy true:504
noisy false:1652
after delete: len(clean_dataset) 980
after delete: len(noisy_dataset) 2156
epoch [82/200] batch [5/30] time 0.480 (0.475) data 0.350 (0.345) loss_x loss_x 0.9116 (1.1891) acc_x 71.8750 (65.6250) lr 1.3090e-03 eta 0:00:11
epoch [82/200] batch [10/30] time 0.446 (0.467) data 0.316 (0.337) loss_x loss_x 0.7554 (1.2419) acc_x 81.2500 (68.1250) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [15/30] time 0.438 (0.460) data 0.307 (0.329) loss_x loss_x 1.0645 (1.2712) acc_x 71.8750 (66.2500) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [20/30] time 0.491 (0.463) data 0.361 (0.333) loss_x loss_x 1.3799 (1.2810) acc_x 71.8750 (66.8750) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [25/30] time 0.433 (0.463) data 0.302 (0.333) loss_x loss_x 1.1484 (1.2480) acc_x 59.3750 (67.5000) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [30/30] time 0.476 (0.464) data 0.345 (0.333) loss_x loss_x 1.8213 (1.2623) acc_x 59.3750 (67.8125) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 980
clean true:977
clean false:3
clean_rate:0.996938775510204
noisy true:512
noisy false:1644
after delete: len(clean_dataset) 980
after delete: len(noisy_dataset) 2156
epoch [83/200] batch [5/30] time 0.626 (0.530) data 0.496 (0.399) loss_x loss_x 1.1738 (1.3701) acc_x 71.8750 (64.3750) lr 1.2940e-03 eta 0:00:13
epoch [83/200] batch [10/30] time 0.406 (0.483) data 0.275 (0.352) loss_x loss_x 1.3115 (1.3622) acc_x 59.3750 (63.4375) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [15/30] time 0.420 (0.467) data 0.289 (0.336) loss_x loss_x 1.9375 (1.4459) acc_x 59.3750 (62.2917) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [20/30] time 0.509 (0.472) data 0.378 (0.341) loss_x loss_x 1.2021 (1.4239) acc_x 71.8750 (63.1250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/30] time 0.503 (0.471) data 0.372 (0.340) loss_x loss_x 1.2510 (1.4181) acc_x 59.3750 (63.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/30] time 0.374 (0.465) data 0.243 (0.334) loss_x loss_x 1.4658 (1.4033) acc_x 56.2500 (63.5417) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.3182, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 998
clean true:994
clean false:4
clean_rate:0.9959919839679359
noisy true:496
noisy false:1642
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 2138
epoch [84/200] batch [5/31] time 0.484 (0.555) data 0.354 (0.425) loss_x loss_x 1.2891 (1.4391) acc_x 65.6250 (64.3750) lr 1.2790e-03 eta 0:00:14
epoch [84/200] batch [10/31] time 0.339 (0.504) data 0.207 (0.374) loss_x loss_x 1.3613 (1.3799) acc_x 62.5000 (65.9375) lr 1.2790e-03 eta 0:00:10
epoch [84/200] batch [15/31] time 0.670 (0.520) data 0.539 (0.390) loss_x loss_x 1.0449 (1.3095) acc_x 75.0000 (67.0833) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [20/31] time 0.501 (0.511) data 0.370 (0.380) loss_x loss_x 1.6104 (1.3290) acc_x 65.6250 (66.2500) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [25/31] time 0.368 (0.499) data 0.237 (0.368) loss_x loss_x 1.2461 (1.3157) acc_x 59.3750 (65.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/31] time 0.418 (0.485) data 0.287 (0.354) loss_x loss_x 1.5098 (1.3204) acc_x 50.0000 (65.3125) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1617
confident_label rate tensor(0.3189, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1000
clean true:998
clean false:2
clean_rate:0.998
noisy true:521
noisy false:1615
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 2136
epoch [85/200] batch [5/31] time 0.431 (0.484) data 0.299 (0.353) loss_x loss_x 1.3311 (1.5037) acc_x 71.8750 (65.0000) lr 1.2639e-03 eta 0:00:12
epoch [85/200] batch [10/31] time 0.425 (0.463) data 0.294 (0.332) loss_x loss_x 1.4199 (1.3874) acc_x 68.7500 (65.9375) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [15/31] time 0.442 (0.469) data 0.311 (0.338) loss_x loss_x 1.5195 (1.3319) acc_x 62.5000 (66.6667) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [20/31] time 0.388 (0.465) data 0.257 (0.333) loss_x loss_x 1.0908 (1.2982) acc_x 71.8750 (68.1250) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [25/31] time 0.443 (0.472) data 0.312 (0.341) loss_x loss_x 1.3096 (1.2608) acc_x 71.8750 (69.1250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [30/31] time 0.346 (0.474) data 0.215 (0.343) loss_x loss_x 1.7432 (1.2503) acc_x 53.1250 (68.9583) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.3291, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1032
clean true:1031
clean false:1
clean_rate:0.999031007751938
noisy true:497
noisy false:1607
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 2104
epoch [86/200] batch [5/32] time 0.553 (0.473) data 0.422 (0.342) loss_x loss_x 1.4629 (1.3918) acc_x 65.6250 (65.6250) lr 1.2487e-03 eta 0:00:12
epoch [86/200] batch [10/32] time 0.384 (0.500) data 0.253 (0.369) loss_x loss_x 1.3916 (1.2604) acc_x 65.6250 (67.1875) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [15/32] time 0.432 (0.497) data 0.301 (0.366) loss_x loss_x 0.8740 (1.2191) acc_x 75.0000 (67.2917) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [20/32] time 0.465 (0.482) data 0.334 (0.351) loss_x loss_x 1.6309 (1.3040) acc_x 62.5000 (65.7812) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [25/32] time 0.444 (0.479) data 0.312 (0.348) loss_x loss_x 1.5010 (1.3543) acc_x 65.6250 (65.2500) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [30/32] time 0.423 (0.478) data 0.291 (0.347) loss_x loss_x 1.2598 (1.3357) acc_x 65.6250 (66.1458) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1626
confident_label rate tensor(0.3160, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 991
clean true:987
clean false:4
clean_rate:0.9959636730575177
noisy true:523
noisy false:1622
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 2145
epoch [87/200] batch [5/30] time 0.603 (0.465) data 0.473 (0.334) loss_x loss_x 1.3115 (1.1484) acc_x 65.6250 (66.8750) lr 1.2334e-03 eta 0:00:11
epoch [87/200] batch [10/30] time 0.513 (0.480) data 0.383 (0.349) loss_x loss_x 0.9976 (1.0998) acc_x 81.2500 (69.0625) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [15/30] time 0.387 (0.471) data 0.257 (0.340) loss_x loss_x 1.3887 (1.1947) acc_x 62.5000 (67.5000) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [20/30] time 0.389 (0.473) data 0.258 (0.343) loss_x loss_x 1.1768 (1.2284) acc_x 78.1250 (67.3438) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [25/30] time 0.486 (0.474) data 0.356 (0.343) loss_x loss_x 1.8623 (1.2979) acc_x 56.2500 (66.5000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/30] time 0.470 (0.478) data 0.339 (0.348) loss_x loss_x 1.7832 (1.2941) acc_x 65.6250 (66.6667) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.3192, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1001
clean true:995
clean false:6
clean_rate:0.994005994005994
noisy true:504
noisy false:1631
after delete: len(clean_dataset) 1001
after delete: len(noisy_dataset) 2135
epoch [88/200] batch [5/31] time 0.454 (0.456) data 0.323 (0.325) loss_x loss_x 1.4814 (1.4416) acc_x 71.8750 (65.6250) lr 1.2181e-03 eta 0:00:11
epoch [88/200] batch [10/31] time 0.524 (0.476) data 0.393 (0.345) loss_x loss_x 1.0938 (1.3436) acc_x 78.1250 (67.5000) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [15/31] time 0.485 (0.485) data 0.355 (0.354) loss_x loss_x 1.4922 (1.3353) acc_x 75.0000 (68.1250) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [20/31] time 0.329 (0.473) data 0.199 (0.342) loss_x loss_x 1.4561 (1.3620) acc_x 62.5000 (67.1875) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [25/31] time 0.498 (0.486) data 0.367 (0.356) loss_x loss_x 1.4600 (1.3343) acc_x 62.5000 (67.5000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [30/31] time 0.473 (0.474) data 0.342 (0.343) loss_x loss_x 1.0117 (1.3046) acc_x 75.0000 (67.8125) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1609
confident_label rate tensor(0.3166, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 993
clean true:990
clean false:3
clean_rate:0.9969788519637462
noisy true:537
noisy false:1606
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 2143
epoch [89/200] batch [5/31] time 0.414 (0.447) data 0.283 (0.316) loss_x loss_x 1.4082 (1.1992) acc_x 62.5000 (69.3750) lr 1.2028e-03 eta 0:00:11
epoch [89/200] batch [10/31] time 0.450 (0.477) data 0.319 (0.346) loss_x loss_x 1.3242 (1.3414) acc_x 68.7500 (65.9375) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [15/31] time 0.468 (0.480) data 0.337 (0.349) loss_x loss_x 1.4707 (1.3178) acc_x 65.6250 (66.8750) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [20/31] time 0.484 (0.476) data 0.354 (0.345) loss_x loss_x 1.7295 (1.3563) acc_x 56.2500 (66.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [25/31] time 0.470 (0.471) data 0.339 (0.340) loss_x loss_x 1.3457 (1.3549) acc_x 62.5000 (66.3750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [30/31] time 0.419 (0.458) data 0.288 (0.327) loss_x loss_x 1.1953 (1.3264) acc_x 81.2500 (67.1875) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1673
confident_label rate tensor(0.3061, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 960
clean true:958
clean false:2
clean_rate:0.9979166666666667
noisy true:505
noisy false:1671
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 2176
epoch [90/200] batch [5/30] time 0.369 (0.433) data 0.238 (0.302) loss_x loss_x 1.3574 (1.1524) acc_x 59.3750 (70.0000) lr 1.1874e-03 eta 0:00:10
epoch [90/200] batch [10/30] time 0.461 (0.422) data 0.331 (0.291) loss_x loss_x 1.1299 (1.1853) acc_x 59.3750 (69.3750) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [15/30] time 0.608 (0.449) data 0.477 (0.319) loss_x loss_x 1.0830 (1.1907) acc_x 78.1250 (68.7500) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [20/30] time 0.505 (0.452) data 0.374 (0.321) loss_x loss_x 0.9404 (1.1986) acc_x 71.8750 (68.4375) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [25/30] time 0.556 (0.455) data 0.425 (0.325) loss_x loss_x 1.6982 (1.2237) acc_x 59.3750 (68.6250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [30/30] time 0.512 (0.470) data 0.382 (0.339) loss_x loss_x 1.1338 (1.2068) acc_x 59.3750 (69.0625) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1606
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 980
clean true:978
clean false:2
clean_rate:0.9979591836734694
noisy true:552
noisy false:1604
after delete: len(clean_dataset) 980
after delete: len(noisy_dataset) 2156
epoch [91/200] batch [5/30] time 0.462 (0.510) data 0.331 (0.379) loss_x loss_x 1.2256 (1.1957) acc_x 68.7500 (66.8750) lr 1.1719e-03 eta 0:00:12
epoch [91/200] batch [10/30] time 0.507 (0.482) data 0.377 (0.351) loss_x loss_x 1.5879 (1.2635) acc_x 65.6250 (65.0000) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [15/30] time 0.437 (0.470) data 0.307 (0.339) loss_x loss_x 0.8862 (1.2223) acc_x 75.0000 (66.8750) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [20/30] time 0.379 (0.476) data 0.248 (0.345) loss_x loss_x 1.3379 (1.2049) acc_x 68.7500 (68.1250) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/30] time 0.383 (0.467) data 0.252 (0.337) loss_x loss_x 1.5586 (1.2103) acc_x 65.6250 (68.1250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/30] time 0.506 (0.469) data 0.375 (0.338) loss_x loss_x 1.1582 (1.2235) acc_x 75.0000 (68.1250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1015
clean true:1009
clean false:6
clean_rate:0.994088669950739
noisy true:517
noisy false:1604
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 2121
epoch [92/200] batch [5/31] time 0.587 (0.488) data 0.456 (0.357) loss_x loss_x 1.4609 (1.2881) acc_x 62.5000 (62.5000) lr 1.1564e-03 eta 0:00:12
epoch [92/200] batch [10/31] time 0.402 (0.453) data 0.271 (0.321) loss_x loss_x 1.0273 (1.2533) acc_x 71.8750 (66.8750) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [15/31] time 0.528 (0.456) data 0.397 (0.325) loss_x loss_x 1.0049 (1.2082) acc_x 71.8750 (67.5000) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [20/31] time 0.397 (0.456) data 0.266 (0.325) loss_x loss_x 1.2510 (1.2488) acc_x 68.7500 (67.6562) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [25/31] time 0.550 (0.468) data 0.419 (0.337) loss_x loss_x 1.6504 (1.2519) acc_x 56.2500 (67.7500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/31] time 0.393 (0.464) data 0.262 (0.333) loss_x loss_x 1.2725 (1.2248) acc_x 71.8750 (67.8125) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1578
confident_label rate tensor(0.3310, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1038
clean true:1035
clean false:3
clean_rate:0.9971098265895953
noisy true:523
noisy false:1575
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 2098
epoch [93/200] batch [5/32] time 0.400 (0.443) data 0.269 (0.312) loss_x loss_x 1.1855 (1.2838) acc_x 65.6250 (64.3750) lr 1.1409e-03 eta 0:00:11
epoch [93/200] batch [10/32] time 0.389 (0.462) data 0.257 (0.331) loss_x loss_x 0.8286 (1.1737) acc_x 87.5000 (70.9375) lr 1.1409e-03 eta 0:00:10
epoch [93/200] batch [15/32] time 0.580 (0.476) data 0.449 (0.345) loss_x loss_x 1.3369 (1.2101) acc_x 68.7500 (70.8333) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [20/32] time 0.550 (0.490) data 0.420 (0.359) loss_x loss_x 1.2461 (1.2217) acc_x 75.0000 (70.1562) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [25/32] time 0.445 (0.490) data 0.315 (0.359) loss_x loss_x 1.8193 (1.2109) acc_x 59.3750 (70.1250) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [30/32] time 0.536 (0.481) data 0.405 (0.351) loss_x loss_x 1.2031 (1.2509) acc_x 75.0000 (69.2708) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1601
confident_label rate tensor(0.3224, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1011
clean true:1002
clean false:9
clean_rate:0.9910979228486647
noisy true:533
noisy false:1592
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 2125
epoch [94/200] batch [5/31] time 0.398 (0.464) data 0.268 (0.333) loss_x loss_x 2.1719 (1.5627) acc_x 59.3750 (63.7500) lr 1.1253e-03 eta 0:00:12
epoch [94/200] batch [10/31] time 0.446 (0.463) data 0.315 (0.332) loss_x loss_x 2.1094 (1.5235) acc_x 53.1250 (63.7500) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [15/31] time 0.575 (0.472) data 0.444 (0.341) loss_x loss_x 2.0176 (1.4558) acc_x 56.2500 (66.0417) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [20/31] time 0.437 (0.476) data 0.307 (0.346) loss_x loss_x 1.6338 (1.4116) acc_x 59.3750 (66.5625) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [25/31] time 0.348 (0.466) data 0.218 (0.335) loss_x loss_x 0.9771 (1.3714) acc_x 78.1250 (67.3750) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/31] time 0.532 (0.466) data 0.402 (0.336) loss_x loss_x 1.3418 (1.3549) acc_x 56.2500 (67.5000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1630
confident_label rate tensor(0.3186, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 999
clean true:996
clean false:3
clean_rate:0.996996996996997
noisy true:510
noisy false:1627
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 2137
epoch [95/200] batch [5/31] time 0.480 (0.429) data 0.349 (0.298) loss_x loss_x 1.5107 (1.4789) acc_x 62.5000 (63.1250) lr 1.1097e-03 eta 0:00:11
epoch [95/200] batch [10/31] time 0.549 (0.471) data 0.418 (0.340) loss_x loss_x 1.0410 (1.3365) acc_x 65.6250 (65.9375) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [15/31] time 0.432 (0.468) data 0.301 (0.337) loss_x loss_x 1.5820 (1.4027) acc_x 59.3750 (65.4167) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [20/31] time 0.530 (0.464) data 0.400 (0.333) loss_x loss_x 1.5127 (1.4057) acc_x 62.5000 (65.3125) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [25/31] time 0.574 (0.472) data 0.444 (0.342) loss_x loss_x 1.1445 (1.3691) acc_x 65.6250 (66.0000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [30/31] time 0.587 (0.474) data 0.457 (0.343) loss_x loss_x 1.1416 (1.3632) acc_x 71.8750 (65.7292) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.3135, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 983
clean true:980
clean false:3
clean_rate:0.9969481180061037
noisy true:519
noisy false:1634
after delete: len(clean_dataset) 983
after delete: len(noisy_dataset) 2153
epoch [96/200] batch [5/30] time 0.499 (0.467) data 0.369 (0.337) loss_x loss_x 1.2764 (1.2859) acc_x 62.5000 (65.6250) lr 1.0941e-03 eta 0:00:11
epoch [96/200] batch [10/30] time 0.500 (0.464) data 0.370 (0.333) loss_x loss_x 1.4688 (1.2394) acc_x 59.3750 (66.2500) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [15/30] time 0.387 (0.458) data 0.257 (0.328) loss_x loss_x 1.4023 (1.2140) acc_x 65.6250 (68.3333) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [20/30] time 0.441 (0.460) data 0.311 (0.329) loss_x loss_x 1.0156 (1.1872) acc_x 75.0000 (70.0000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [25/30] time 0.367 (0.454) data 0.238 (0.324) loss_x loss_x 1.4297 (1.1647) acc_x 62.5000 (70.3750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [30/30] time 0.419 (0.458) data 0.289 (0.328) loss_x loss_x 1.6260 (1.2056) acc_x 59.3750 (69.6875) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.3316, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1040
clean true:1037
clean false:3
clean_rate:0.9971153846153846
noisy true:509
noisy false:1587
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 2096
epoch [97/200] batch [5/32] time 0.348 (0.436) data 0.218 (0.306) loss_x loss_x 1.4629 (1.4441) acc_x 59.3750 (61.2500) lr 1.0785e-03 eta 0:00:11
epoch [97/200] batch [10/32] time 0.430 (0.445) data 0.300 (0.314) loss_x loss_x 1.5039 (1.3542) acc_x 62.5000 (65.0000) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [15/32] time 0.416 (0.447) data 0.285 (0.316) loss_x loss_x 0.9507 (1.2786) acc_x 75.0000 (66.2500) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [20/32] time 0.449 (0.442) data 0.319 (0.311) loss_x loss_x 1.3379 (1.3167) acc_x 59.3750 (65.6250) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [25/32] time 0.494 (0.450) data 0.364 (0.320) loss_x loss_x 1.3008 (1.3213) acc_x 65.6250 (66.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [30/32] time 0.575 (0.454) data 0.444 (0.324) loss_x loss_x 1.4180 (1.3105) acc_x 50.0000 (65.6250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1618
confident_label rate tensor(0.3176, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 996
clean true:994
clean false:2
clean_rate:0.9979919678714859
noisy true:524
noisy false:1616
after delete: len(clean_dataset) 996
after delete: len(noisy_dataset) 2140
epoch [98/200] batch [5/31] time 0.480 (0.482) data 0.350 (0.351) loss_x loss_x 1.4717 (1.3849) acc_x 68.7500 (65.6250) lr 1.0628e-03 eta 0:00:12
epoch [98/200] batch [10/31] time 0.345 (0.449) data 0.215 (0.318) loss_x loss_x 1.2129 (1.3833) acc_x 75.0000 (67.1875) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [15/31] time 0.489 (0.476) data 0.358 (0.346) loss_x loss_x 1.0996 (1.2674) acc_x 59.3750 (68.5417) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [20/31] time 0.445 (0.468) data 0.314 (0.338) loss_x loss_x 1.0225 (1.2535) acc_x 81.2500 (68.7500) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [25/31] time 0.392 (0.461) data 0.262 (0.330) loss_x loss_x 1.2344 (1.2951) acc_x 71.8750 (67.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/31] time 0.456 (0.459) data 0.325 (0.329) loss_x loss_x 0.9893 (1.2913) acc_x 75.0000 (67.0833) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1618
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1019
clean true:1017
clean false:2
clean_rate:0.9980372914622179
noisy true:501
noisy false:1616
after delete: len(clean_dataset) 1019
after delete: len(noisy_dataset) 2117
epoch [99/200] batch [5/31] time 0.467 (0.474) data 0.336 (0.342) loss_x loss_x 0.8428 (1.2915) acc_x 81.2500 (68.1250) lr 1.0471e-03 eta 0:00:12
epoch [99/200] batch [10/31] time 0.379 (0.495) data 0.248 (0.364) loss_x loss_x 1.4033 (1.3490) acc_x 56.2500 (67.1875) lr 1.0471e-03 eta 0:00:10
epoch [99/200] batch [15/31] time 0.423 (0.493) data 0.292 (0.362) loss_x loss_x 1.2480 (1.3558) acc_x 68.7500 (67.7083) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [20/31] time 0.428 (0.485) data 0.297 (0.354) loss_x loss_x 1.3652 (1.3379) acc_x 56.2500 (66.8750) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [25/31] time 0.435 (0.472) data 0.304 (0.341) loss_x loss_x 1.3408 (1.3021) acc_x 68.7500 (67.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/31] time 0.482 (0.475) data 0.352 (0.344) loss_x loss_x 1.8369 (1.3125) acc_x 50.0000 (66.7708) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.3265, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1024
clean true:1018
clean false:6
clean_rate:0.994140625
noisy true:482
noisy false:1630
all clean rate:  [0.9838274932614556, 0.9870410367170627, 0.992867332382311, 0.9911727616645649, 0.9987562189054726, 0.9987995198079231, 0.9950738916256158, 0.995049504950495, 0.9987684729064039, 0.998769987699877, 0.9963144963144963, 0.9988207547169812, 0.9975874547647768, 0.9988235294117647, 0.9965075669383003, 0.9965397923875432, 0.9952996474735605, 0.9976359338061466, 1.0, 0.9977142857142857, 0.998868778280543, 0.9954699886749717, 0.9988262910798122, 0.9953863898500577, 0.9988610478359908, 0.9976771196283392, 0.9988571428571429, 0.9953970080552359, 0.992108229988726, 0.9966329966329966, 0.9965986394557823, 0.9967391304347826, 0.9977753058954394, 0.9978308026030369, 0.9966367713004485, 0.9955604883462819, 0.9946638207043756, 0.9989059080962801, 0.9988662131519275, 0.9956284153005465, 0.9944567627494457, 0.9957310565635006, 0.9912472647702407, 0.9948132780082988, 0.997874601487779, 0.995850622406639, 0.9967213114754099, 0.9989035087719298, 0.9966777408637874, 0.9958677685950413, 0.9978189749182116, 0.9937694704049844, 0.9989224137931034, 0.9989451476793249, 0.9958333333333333, 0.9927909371781668, 0.9969040247678018, 0.9979317476732161, 0.9946062567421791, 0.9947478991596639, 0.9967320261437909, 0.9967811158798283, 0.9979101358411703, 0.9978700745473909, 0.9947862356621481, 0.9989754098360656, 0.9978947368421053, 0.998960498960499, 0.9937888198757764, 0.9969325153374233, 0.9968520461699895, 0.998995983935743, 0.994692144373673, 0.9957219251336898, 0.9969450101832994, 0.9960668633235005, 0.998025666337611, 0.9980295566502463, 0.997020854021847, 0.9959183673469387, 0.9948559670781894, 1.0, 0.996938775510204, 0.9959919839679359, 0.998, 0.999031007751938, 0.9959636730575177, 0.994005994005994, 0.9969788519637462, 0.9979166666666667, 0.9979591836734694, 0.994088669950739, 0.9971098265895953, 0.9910979228486647, 0.996996996996997, 0.9969481180061037, 0.9971153846153846, 0.9979919678714859, 0.9980372914622179, 0.994140625]
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 2112
epoch [100/200] batch [5/32] time 0.410 (0.401) data 0.279 (0.270) loss_x loss_x 1.5420 (1.4363) acc_x 65.6250 (64.3750) lr 1.0314e-03 eta 0:00:10
epoch [100/200] batch [10/32] time 0.387 (0.437) data 0.256 (0.306) loss_x loss_x 1.2979 (1.3481) acc_x 62.5000 (64.3750) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [15/32] time 0.451 (0.444) data 0.319 (0.313) loss_x loss_x 1.8262 (1.3575) acc_x 53.1250 (65.2083) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [20/32] time 0.442 (0.454) data 0.312 (0.323) loss_x loss_x 1.3721 (1.3621) acc_x 68.7500 (65.7812) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [25/32] time 0.431 (0.449) data 0.299 (0.318) loss_x loss_x 1.0977 (1.3289) acc_x 68.7500 (66.6250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [30/32] time 0.527 (0.456) data 0.396 (0.325) loss_x loss_x 1.2246 (1.3055) acc_x 75.0000 (66.7708) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 978
clean true:976
clean false:2
clean_rate:0.9979550102249489
noisy true:527
noisy false:1631
after delete: len(clean_dataset) 978
after delete: len(noisy_dataset) 2158
epoch [101/200] batch [5/30] time 0.495 (0.525) data 0.364 (0.394) loss_x loss_x 1.2256 (1.3713) acc_x 65.6250 (66.8750) lr 1.0157e-03 eta 0:00:13
epoch [101/200] batch [10/30] time 0.378 (0.473) data 0.247 (0.342) loss_x loss_x 1.4697 (1.3613) acc_x 65.6250 (65.9375) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [15/30] time 0.460 (0.470) data 0.329 (0.339) loss_x loss_x 1.4912 (1.3230) acc_x 62.5000 (67.0833) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [20/30] time 0.514 (0.471) data 0.384 (0.340) loss_x loss_x 1.2852 (1.3036) acc_x 68.7500 (68.5938) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [25/30] time 0.452 (0.478) data 0.322 (0.347) loss_x loss_x 1.0527 (1.3176) acc_x 62.5000 (67.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [30/30] time 0.412 (0.469) data 0.282 (0.338) loss_x loss_x 2.4043 (1.3384) acc_x 37.5000 (66.6667) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1616
confident_label rate tensor(0.3195, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1002
clean true:995
clean false:7
clean_rate:0.9930139720558883
noisy true:525
noisy false:1609
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 2134
epoch [102/200] batch [5/31] time 0.484 (0.494) data 0.353 (0.363) loss_x loss_x 1.4805 (1.2734) acc_x 59.3750 (64.3750) lr 1.0000e-03 eta 0:00:12
epoch [102/200] batch [10/31] time 0.589 (0.504) data 0.458 (0.373) loss_x loss_x 1.2646 (1.2389) acc_x 65.6250 (66.5625) lr 1.0000e-03 eta 0:00:10
epoch [102/200] batch [15/31] time 0.368 (0.480) data 0.237 (0.349) loss_x loss_x 1.5352 (1.2560) acc_x 59.3750 (66.8750) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [20/31] time 0.433 (0.472) data 0.302 (0.341) loss_x loss_x 1.0381 (1.2603) acc_x 65.6250 (65.9375) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [25/31] time 0.500 (0.477) data 0.369 (0.346) loss_x loss_x 0.9272 (1.2262) acc_x 65.6250 (66.0000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [30/31] time 0.367 (0.476) data 0.236 (0.345) loss_x loss_x 1.3350 (1.1929) acc_x 62.5000 (67.5000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1585
confident_label rate tensor(0.3326, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1043
clean true:1039
clean false:4
clean_rate:0.9961649089165868
noisy true:512
noisy false:1581
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 2093
epoch [103/200] batch [5/32] time 0.546 (0.452) data 0.416 (0.322) loss_x loss_x 0.9863 (1.0979) acc_x 71.8750 (73.1250) lr 9.8429e-04 eta 0:00:12
epoch [103/200] batch [10/32] time 0.429 (0.470) data 0.298 (0.340) loss_x loss_x 1.7178 (1.1959) acc_x 37.5000 (69.0625) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [15/32] time 0.310 (0.462) data 0.179 (0.332) loss_x loss_x 1.4150 (1.2612) acc_x 59.3750 (68.5417) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [20/32] time 0.501 (0.461) data 0.370 (0.330) loss_x loss_x 1.3672 (1.2880) acc_x 62.5000 (67.5000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [25/32] time 0.468 (0.465) data 0.337 (0.334) loss_x loss_x 1.5029 (1.2894) acc_x 62.5000 (67.0000) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [30/32] time 0.485 (0.464) data 0.354 (0.333) loss_x loss_x 0.9409 (1.3000) acc_x 78.1250 (66.7708) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1587
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:1027
clean false:4
clean_rate:0.9961202715809894
noisy true:522
noisy false:1583
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [104/200] batch [5/32] time 0.465 (0.466) data 0.334 (0.335) loss_x loss_x 1.3574 (1.3169) acc_x 62.5000 (62.5000) lr 9.6859e-04 eta 0:00:12
epoch [104/200] batch [10/32] time 0.489 (0.466) data 0.357 (0.335) loss_x loss_x 1.2227 (1.3088) acc_x 68.7500 (65.6250) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [15/32] time 0.400 (0.452) data 0.269 (0.321) loss_x loss_x 0.9951 (1.2910) acc_x 65.6250 (65.8333) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [20/32] time 0.566 (0.468) data 0.434 (0.337) loss_x loss_x 1.0645 (1.3173) acc_x 62.5000 (64.5312) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [25/32] time 0.410 (0.476) data 0.280 (0.345) loss_x loss_x 1.8291 (1.3528) acc_x 50.0000 (64.0000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [30/32] time 0.401 (0.466) data 0.271 (0.335) loss_x loss_x 1.7139 (1.3228) acc_x 59.3750 (65.2083) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1573
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1021
clean true:1019
clean false:2
clean_rate:0.9980411361410382
noisy true:544
noisy false:1571
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 2115
epoch [105/200] batch [5/31] time 0.369 (0.457) data 0.237 (0.326) loss_x loss_x 1.3926 (1.3754) acc_x 65.6250 (66.2500) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [10/31] time 0.554 (0.473) data 0.424 (0.342) loss_x loss_x 1.3213 (1.2618) acc_x 59.3750 (67.8125) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [15/31] time 0.500 (0.470) data 0.370 (0.339) loss_x loss_x 1.1113 (1.2901) acc_x 78.1250 (67.2917) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [20/31] time 0.464 (0.478) data 0.334 (0.347) loss_x loss_x 1.2920 (1.2919) acc_x 65.6250 (67.1875) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [25/31] time 0.531 (0.473) data 0.401 (0.343) loss_x loss_x 1.1777 (1.2768) acc_x 75.0000 (67.0000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/31] time 0.588 (0.474) data 0.458 (0.344) loss_x loss_x 1.0713 (1.2725) acc_x 68.7500 (67.1875) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1592
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1028
clean true:1025
clean false:3
clean_rate:0.9970817120622568
noisy true:519
noisy false:1589
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 2108
epoch [106/200] batch [5/32] time 0.373 (0.465) data 0.242 (0.334) loss_x loss_x 1.0322 (1.2475) acc_x 71.8750 (70.0000) lr 9.3721e-04 eta 0:00:12
epoch [106/200] batch [10/32] time 0.447 (0.443) data 0.316 (0.312) loss_x loss_x 1.0342 (1.3236) acc_x 68.7500 (66.8750) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [15/32] time 0.551 (0.448) data 0.420 (0.317) loss_x loss_x 1.2891 (1.3271) acc_x 65.6250 (66.6667) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [20/32] time 0.460 (0.443) data 0.329 (0.312) loss_x loss_x 1.1016 (1.3146) acc_x 75.0000 (67.0312) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [25/32] time 0.495 (0.451) data 0.365 (0.321) loss_x loss_x 1.2197 (1.3213) acc_x 75.0000 (66.6250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [30/32] time 0.511 (0.462) data 0.381 (0.331) loss_x loss_x 0.9678 (1.3070) acc_x 75.0000 (67.7083) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1613
confident_label rate tensor(0.3262, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1023
clean true:1019
clean false:4
clean_rate:0.9960899315738025
noisy true:504
noisy false:1609
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 2113
epoch [107/200] batch [5/31] time 0.433 (0.449) data 0.302 (0.317) loss_x loss_x 1.6211 (1.3879) acc_x 65.6250 (64.3750) lr 9.2154e-04 eta 0:00:11
epoch [107/200] batch [10/31] time 0.458 (0.450) data 0.327 (0.319) loss_x loss_x 1.1924 (1.3547) acc_x 75.0000 (66.8750) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [15/31] time 0.425 (0.436) data 0.294 (0.305) loss_x loss_x 0.7437 (1.2556) acc_x 84.3750 (70.0000) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [20/31] time 0.430 (0.439) data 0.299 (0.308) loss_x loss_x 1.2002 (1.2230) acc_x 65.6250 (70.4688) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [25/31] time 0.473 (0.444) data 0.342 (0.313) loss_x loss_x 1.5811 (1.2542) acc_x 62.5000 (68.7500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/31] time 0.439 (0.446) data 0.308 (0.315) loss_x loss_x 1.1631 (1.2424) acc_x 78.1250 (69.1667) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1609
confident_label rate tensor(0.3253, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1020
clean true:1016
clean false:4
clean_rate:0.996078431372549
noisy true:511
noisy false:1605
after delete: len(clean_dataset) 1020
after delete: len(noisy_dataset) 2116
epoch [108/200] batch [5/31] time 0.521 (0.511) data 0.391 (0.380) loss_x loss_x 1.2051 (1.2409) acc_x 78.1250 (71.2500) lr 9.0589e-04 eta 0:00:13
epoch [108/200] batch [10/31] time 0.443 (0.501) data 0.312 (0.370) loss_x loss_x 1.0225 (1.2042) acc_x 84.3750 (72.8125) lr 9.0589e-04 eta 0:00:10
epoch [108/200] batch [15/31] time 0.450 (0.487) data 0.319 (0.356) loss_x loss_x 1.2686 (1.2149) acc_x 75.0000 (72.0833) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [20/31] time 0.461 (0.482) data 0.330 (0.351) loss_x loss_x 0.7827 (1.1810) acc_x 78.1250 (72.5000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [25/31] time 0.435 (0.480) data 0.304 (0.349) loss_x loss_x 1.0400 (1.1668) acc_x 71.8750 (72.1250) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [30/31] time 0.397 (0.471) data 0.265 (0.339) loss_x loss_x 1.6270 (1.1624) acc_x 59.3750 (71.8750) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1597
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:1028
clean false:3
clean_rate:0.997090203685742
noisy true:511
noisy false:1594
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [109/200] batch [5/32] time 0.506 (0.473) data 0.376 (0.343) loss_x loss_x 1.0020 (1.1151) acc_x 65.6250 (70.0000) lr 8.9027e-04 eta 0:00:12
epoch [109/200] batch [10/32] time 0.411 (0.474) data 0.280 (0.343) loss_x loss_x 1.0615 (1.0904) acc_x 68.7500 (70.0000) lr 8.9027e-04 eta 0:00:10
epoch [109/200] batch [15/32] time 0.492 (0.483) data 0.360 (0.352) loss_x loss_x 0.9546 (1.1163) acc_x 75.0000 (69.7917) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [20/32] time 0.412 (0.469) data 0.281 (0.339) loss_x loss_x 0.9907 (1.1535) acc_x 78.1250 (69.3750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [25/32] time 0.417 (0.470) data 0.288 (0.339) loss_x loss_x 1.2422 (1.1916) acc_x 78.1250 (69.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [30/32] time 0.549 (0.479) data 0.419 (0.348) loss_x loss_x 0.9888 (1.2083) acc_x 81.2500 (69.3750) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3265, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1024
clean true:1018
clean false:6
clean_rate:0.994140625
noisy true:515
noisy false:1597
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 2112
epoch [110/200] batch [5/32] time 0.441 (0.475) data 0.310 (0.344) loss_x loss_x 1.2871 (1.3346) acc_x 65.6250 (65.6250) lr 8.7467e-04 eta 0:00:12
epoch [110/200] batch [10/32] time 0.428 (0.476) data 0.297 (0.345) loss_x loss_x 0.9761 (1.2354) acc_x 71.8750 (65.9375) lr 8.7467e-04 eta 0:00:10
epoch [110/200] batch [15/32] time 0.427 (0.469) data 0.296 (0.338) loss_x loss_x 1.4834 (1.2236) acc_x 59.3750 (66.4583) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [20/32] time 0.385 (0.471) data 0.254 (0.340) loss_x loss_x 1.5898 (1.2067) acc_x 78.1250 (68.9062) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [25/32] time 0.562 (0.466) data 0.432 (0.335) loss_x loss_x 1.5049 (1.2091) acc_x 78.1250 (69.2500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [30/32] time 0.494 (0.461) data 0.364 (0.330) loss_x loss_x 1.0801 (1.2206) acc_x 65.6250 (69.3750) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:1028
clean false:3
clean_rate:0.997090203685742
noisy true:528
noisy false:1577
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [111/200] batch [5/32] time 0.559 (0.455) data 0.428 (0.325) loss_x loss_x 1.2871 (1.2500) acc_x 71.8750 (68.1250) lr 8.5910e-04 eta 0:00:12
epoch [111/200] batch [10/32] time 0.389 (0.480) data 0.259 (0.349) loss_x loss_x 1.4297 (1.2590) acc_x 56.2500 (66.8750) lr 8.5910e-04 eta 0:00:10
epoch [111/200] batch [15/32] time 0.543 (0.484) data 0.413 (0.353) loss_x loss_x 1.3906 (1.2910) acc_x 68.7500 (66.8750) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [20/32] time 0.461 (0.474) data 0.331 (0.344) loss_x loss_x 1.3516 (1.2996) acc_x 71.8750 (67.3438) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [25/32] time 0.566 (0.472) data 0.435 (0.342) loss_x loss_x 1.5264 (1.3141) acc_x 62.5000 (66.6250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [30/32] time 0.522 (0.477) data 0.391 (0.346) loss_x loss_x 1.1377 (1.2941) acc_x 71.8750 (66.7708) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1577
confident_label rate tensor(0.3291, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1032
clean true:1030
clean false:2
clean_rate:0.998062015503876
noisy true:529
noisy false:1575
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 2104
epoch [112/200] batch [5/32] time 0.476 (0.471) data 0.345 (0.340) loss_x loss_x 2.0430 (1.3530) acc_x 53.1250 (67.5000) lr 8.4357e-04 eta 0:00:12
epoch [112/200] batch [10/32] time 0.400 (0.469) data 0.269 (0.338) loss_x loss_x 1.0752 (1.3088) acc_x 75.0000 (70.0000) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [15/32] time 0.562 (0.478) data 0.432 (0.347) loss_x loss_x 1.2998 (1.2217) acc_x 71.8750 (72.0833) lr 8.4357e-04 eta 0:00:08
epoch [112/200] batch [20/32] time 0.536 (0.469) data 0.405 (0.338) loss_x loss_x 1.4854 (1.2637) acc_x 71.8750 (71.4062) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [25/32] time 0.542 (0.467) data 0.412 (0.336) loss_x loss_x 0.8618 (1.2423) acc_x 71.8750 (70.6250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [30/32] time 0.508 (0.474) data 0.377 (0.343) loss_x loss_x 1.3379 (1.2588) acc_x 59.3750 (70.2083) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1019
clean true:1017
clean false:2
clean_rate:0.9980372914622179
noisy true:517
noisy false:1600
after delete: len(clean_dataset) 1019
after delete: len(noisy_dataset) 2117
epoch [113/200] batch [5/31] time 0.435 (0.485) data 0.304 (0.354) loss_x loss_x 1.4658 (1.2652) acc_x 59.3750 (65.6250) lr 8.2807e-04 eta 0:00:12
epoch [113/200] batch [10/31] time 0.418 (0.465) data 0.288 (0.334) loss_x loss_x 1.9473 (1.3848) acc_x 53.1250 (63.1250) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [15/31] time 0.382 (0.445) data 0.251 (0.314) loss_x loss_x 0.9565 (1.2784) acc_x 71.8750 (66.4583) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [20/31] time 0.461 (0.437) data 0.331 (0.307) loss_x loss_x 0.9072 (1.2147) acc_x 71.8750 (69.0625) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [25/31] time 0.578 (0.450) data 0.448 (0.320) loss_x loss_x 1.5869 (1.2604) acc_x 56.2500 (67.7500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [30/31] time 0.581 (0.455) data 0.450 (0.325) loss_x loss_x 0.8027 (1.2617) acc_x 81.2500 (67.7083) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1577
confident_label rate tensor(0.3265, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1024
clean true:1021
clean false:3
clean_rate:0.9970703125
noisy true:538
noisy false:1574
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 2112
epoch [114/200] batch [5/32] time 0.543 (0.491) data 0.412 (0.359) loss_x loss_x 1.2812 (1.0899) acc_x 68.7500 (73.7500) lr 8.1262e-04 eta 0:00:13
epoch [114/200] batch [10/32] time 0.475 (0.461) data 0.344 (0.330) loss_x loss_x 0.9824 (1.1946) acc_x 68.7500 (70.0000) lr 8.1262e-04 eta 0:00:10
epoch [114/200] batch [15/32] time 0.645 (0.474) data 0.512 (0.343) loss_x loss_x 1.5195 (1.2205) acc_x 62.5000 (68.9583) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [20/32] time 0.479 (0.468) data 0.348 (0.337) loss_x loss_x 1.5303 (1.2431) acc_x 68.7500 (68.4375) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [25/32] time 0.519 (0.476) data 0.388 (0.345) loss_x loss_x 1.1748 (1.2693) acc_x 71.8750 (67.6250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [30/32] time 0.413 (0.474) data 0.282 (0.343) loss_x loss_x 1.4844 (1.2651) acc_x 65.6250 (67.6042) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1573
confident_label rate tensor(0.3268, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1025
clean true:1022
clean false:3
clean_rate:0.9970731707317073
noisy true:541
noisy false:1570
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 2111
epoch [115/200] batch [5/32] time 0.470 (0.421) data 0.340 (0.290) loss_x loss_x 1.5684 (1.3665) acc_x 62.5000 (65.0000) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [10/32] time 0.344 (0.434) data 0.214 (0.304) loss_x loss_x 0.9258 (1.3486) acc_x 71.8750 (64.3750) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [15/32] time 0.384 (0.441) data 0.254 (0.311) loss_x loss_x 1.5742 (1.3717) acc_x 56.2500 (63.7500) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [20/32] time 0.398 (0.440) data 0.268 (0.309) loss_x loss_x 0.9673 (1.3481) acc_x 68.7500 (64.6875) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [25/32] time 0.389 (0.448) data 0.260 (0.318) loss_x loss_x 0.9937 (1.3574) acc_x 65.6250 (64.2500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [30/32] time 0.546 (0.456) data 0.416 (0.326) loss_x loss_x 1.8213 (1.3811) acc_x 65.6250 (64.3750) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1561
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1057
clean false:4
clean_rate:0.9962299717247879
noisy true:518
noisy false:1557
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [116/200] batch [5/33] time 0.442 (0.464) data 0.310 (0.333) loss_x loss_x 1.4492 (1.1443) acc_x 65.6250 (75.6250) lr 7.8186e-04 eta 0:00:12
epoch [116/200] batch [10/33] time 0.436 (0.479) data 0.306 (0.348) loss_x loss_x 1.6221 (1.2304) acc_x 59.3750 (69.6875) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [15/33] time 0.381 (0.468) data 0.250 (0.337) loss_x loss_x 1.7285 (1.3260) acc_x 50.0000 (67.7083) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [20/33] time 0.405 (0.458) data 0.275 (0.327) loss_x loss_x 1.7686 (1.3705) acc_x 65.6250 (66.4062) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [25/33] time 0.430 (0.460) data 0.299 (0.330) loss_x loss_x 1.4932 (1.3319) acc_x 65.6250 (67.7500) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [30/33] time 0.426 (0.465) data 0.295 (0.334) loss_x loss_x 1.6484 (1.3433) acc_x 59.3750 (67.5000) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1597
confident_label rate tensor(0.3214, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1008
clean true:1005
clean false:3
clean_rate:0.9970238095238095
noisy true:534
noisy false:1594
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 2128
epoch [117/200] batch [5/31] time 0.414 (0.429) data 0.284 (0.299) loss_x loss_x 0.8262 (1.1282) acc_x 71.8750 (73.1250) lr 7.6655e-04 eta 0:00:11
epoch [117/200] batch [10/31] time 0.583 (0.459) data 0.452 (0.328) loss_x loss_x 1.4551 (1.1811) acc_x 59.3750 (72.8125) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [15/31] time 0.451 (0.449) data 0.320 (0.318) loss_x loss_x 1.2305 (1.1592) acc_x 68.7500 (71.6667) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [20/31] time 0.405 (0.454) data 0.274 (0.323) loss_x loss_x 0.8369 (1.1580) acc_x 81.2500 (71.7188) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [25/31] time 0.455 (0.457) data 0.324 (0.326) loss_x loss_x 0.9004 (1.1672) acc_x 75.0000 (71.2500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [30/31] time 0.435 (0.467) data 0.304 (0.336) loss_x loss_x 1.1396 (1.1837) acc_x 62.5000 (70.1042) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1569
confident_label rate tensor(0.3402, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1067
clean true:1063
clean false:4
clean_rate:0.9962511715089035
noisy true:504
noisy false:1565
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 2069
epoch [118/200] batch [5/33] time 0.391 (0.431) data 0.260 (0.300) loss_x loss_x 1.0908 (1.0732) acc_x 62.5000 (68.1250) lr 7.5131e-04 eta 0:00:12
epoch [118/200] batch [10/33] time 0.460 (0.467) data 0.329 (0.336) loss_x loss_x 1.1582 (1.1150) acc_x 65.6250 (68.1250) lr 7.5131e-04 eta 0:00:10
epoch [118/200] batch [15/33] time 0.401 (0.457) data 0.270 (0.326) loss_x loss_x 1.0605 (1.1176) acc_x 71.8750 (69.5833) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [20/33] time 0.556 (0.459) data 0.425 (0.328) loss_x loss_x 1.5176 (1.1553) acc_x 62.5000 (69.3750) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [25/33] time 0.413 (0.454) data 0.283 (0.323) loss_x loss_x 1.7188 (1.2057) acc_x 59.3750 (68.7500) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [30/33] time 0.465 (0.452) data 0.334 (0.321) loss_x loss_x 0.9912 (1.2063) acc_x 78.1250 (69.0625) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 986
clean true:981
clean false:5
clean_rate:0.9949290060851927
noisy true:526
noisy false:1624
after delete: len(clean_dataset) 986
after delete: len(noisy_dataset) 2150
epoch [119/200] batch [5/30] time 0.393 (0.444) data 0.262 (0.313) loss_x loss_x 0.8413 (1.2808) acc_x 84.3750 (70.0000) lr 7.3613e-04 eta 0:00:11
epoch [119/200] batch [10/30] time 0.610 (0.456) data 0.479 (0.326) loss_x loss_x 1.3740 (1.2161) acc_x 62.5000 (69.6875) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [15/30] time 0.407 (0.473) data 0.276 (0.343) loss_x loss_x 0.9429 (1.2190) acc_x 75.0000 (68.9583) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [20/30] time 0.474 (0.473) data 0.344 (0.342) loss_x loss_x 1.8408 (1.2292) acc_x 59.3750 (68.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [25/30] time 0.432 (0.472) data 0.301 (0.341) loss_x loss_x 1.0947 (1.1947) acc_x 65.6250 (69.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/30] time 0.515 (0.474) data 0.384 (0.343) loss_x loss_x 0.9634 (1.1747) acc_x 78.1250 (70.9375) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.3284, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1030
clean true:1028
clean false:2
clean_rate:0.9980582524271845
noisy true:532
noisy false:1574
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 2106
epoch [120/200] batch [5/32] time 0.566 (0.463) data 0.435 (0.332) loss_x loss_x 1.1738 (1.3779) acc_x 68.7500 (66.8750) lr 7.2101e-04 eta 0:00:12
epoch [120/200] batch [10/32] time 0.382 (0.448) data 0.252 (0.317) loss_x loss_x 1.5127 (1.2596) acc_x 71.8750 (69.6875) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [15/32] time 0.477 (0.462) data 0.347 (0.332) loss_x loss_x 1.0596 (1.2539) acc_x 65.6250 (69.3750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [20/32] time 0.476 (0.455) data 0.345 (0.324) loss_x loss_x 1.5752 (1.2755) acc_x 59.3750 (68.2812) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [25/32] time 0.510 (0.460) data 0.379 (0.329) loss_x loss_x 1.4160 (1.2786) acc_x 65.6250 (67.0000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [30/32] time 0.413 (0.461) data 0.283 (0.331) loss_x loss_x 1.6475 (1.3016) acc_x 53.1250 (66.6667) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1051
clean true:1048
clean false:3
clean_rate:0.9971455756422455
noisy true:525
noisy false:1560
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 2085
epoch [121/200] batch [5/32] time 0.406 (0.492) data 0.276 (0.361) loss_x loss_x 1.1611 (1.0330) acc_x 68.7500 (66.8750) lr 7.0596e-04 eta 0:00:13
epoch [121/200] batch [10/32] time 0.447 (0.484) data 0.317 (0.353) loss_x loss_x 1.4375 (1.2487) acc_x 65.6250 (65.3125) lr 7.0596e-04 eta 0:00:10
epoch [121/200] batch [15/32] time 0.473 (0.462) data 0.343 (0.332) loss_x loss_x 1.3291 (1.2035) acc_x 65.6250 (68.1250) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [20/32] time 0.388 (0.467) data 0.257 (0.336) loss_x loss_x 1.2695 (1.1886) acc_x 68.7500 (68.7500) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [25/32] time 0.483 (0.467) data 0.352 (0.336) loss_x loss_x 1.0264 (1.1720) acc_x 81.2500 (68.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [30/32] time 0.487 (0.463) data 0.357 (0.332) loss_x loss_x 1.2559 (1.2075) acc_x 71.8750 (67.5000) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1042
clean true:1037
clean false:5
clean_rate:0.9952015355086372
noisy true:532
noisy false:1562
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 2094
epoch [122/200] batch [5/32] time 0.481 (0.462) data 0.350 (0.332) loss_x loss_x 1.7432 (1.3729) acc_x 56.2500 (65.0000) lr 6.9098e-04 eta 0:00:12
epoch [122/200] batch [10/32] time 0.622 (0.487) data 0.491 (0.356) loss_x loss_x 1.2979 (1.3534) acc_x 68.7500 (65.9375) lr 6.9098e-04 eta 0:00:10
epoch [122/200] batch [15/32] time 0.434 (0.471) data 0.304 (0.341) loss_x loss_x 0.9526 (1.3214) acc_x 78.1250 (67.0833) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [20/32] time 0.408 (0.463) data 0.278 (0.333) loss_x loss_x 1.2725 (1.2587) acc_x 65.6250 (68.2812) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [25/32] time 0.388 (0.463) data 0.257 (0.333) loss_x loss_x 1.6846 (1.2958) acc_x 53.1250 (67.1250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [30/32] time 0.395 (0.461) data 0.265 (0.331) loss_x loss_x 1.2783 (1.2816) acc_x 68.7500 (67.2917) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1028
clean true:1024
clean false:4
clean_rate:0.9961089494163424
noisy true:510
noisy false:1598
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 2108
epoch [123/200] batch [5/32] time 0.546 (0.515) data 0.413 (0.383) loss_x loss_x 1.1094 (1.3384) acc_x 75.0000 (68.1250) lr 6.7608e-04 eta 0:00:13
epoch [123/200] batch [10/32] time 0.432 (0.476) data 0.301 (0.344) loss_x loss_x 1.2256 (1.3147) acc_x 56.2500 (67.8125) lr 6.7608e-04 eta 0:00:10
epoch [123/200] batch [15/32] time 0.444 (0.463) data 0.314 (0.332) loss_x loss_x 1.1240 (1.2952) acc_x 71.8750 (67.2917) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [20/32] time 0.395 (0.464) data 0.265 (0.333) loss_x loss_x 1.5645 (1.3222) acc_x 59.3750 (67.0312) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [25/32] time 0.477 (0.465) data 0.347 (0.334) loss_x loss_x 1.2061 (1.2900) acc_x 53.1250 (66.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [30/32] time 0.390 (0.466) data 0.259 (0.335) loss_x loss_x 1.2305 (1.2761) acc_x 65.6250 (66.7708) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1551
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1046
clean true:1041
clean false:5
clean_rate:0.9952198852772467
noisy true:544
noisy false:1546
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 2090
epoch [124/200] batch [5/32] time 0.408 (0.412) data 0.278 (0.281) loss_x loss_x 0.7837 (1.0595) acc_x 75.0000 (71.2500) lr 6.6126e-04 eta 0:00:11
epoch [124/200] batch [10/32] time 0.384 (0.446) data 0.253 (0.315) loss_x loss_x 1.2158 (1.0719) acc_x 62.5000 (70.9375) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [15/32] time 0.422 (0.449) data 0.291 (0.318) loss_x loss_x 0.8550 (1.0662) acc_x 68.7500 (69.5833) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [20/32] time 0.462 (0.465) data 0.331 (0.334) loss_x loss_x 1.4561 (1.1323) acc_x 68.7500 (69.0625) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [25/32] time 0.450 (0.472) data 0.320 (0.341) loss_x loss_x 0.9404 (1.1449) acc_x 78.1250 (69.5000) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [30/32] time 0.464 (0.464) data 0.334 (0.333) loss_x loss_x 1.4658 (1.1891) acc_x 65.6250 (68.3333) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1579
confident_label rate tensor(0.3265, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1024
clean true:1019
clean false:5
clean_rate:0.9951171875
noisy true:538
noisy false:1574
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 2112
epoch [125/200] batch [5/32] time 0.485 (0.458) data 0.354 (0.328) loss_x loss_x 1.4941 (1.3914) acc_x 78.1250 (68.1250) lr 6.4653e-04 eta 0:00:12
epoch [125/200] batch [10/32] time 0.389 (0.467) data 0.258 (0.337) loss_x loss_x 0.8276 (1.3868) acc_x 78.1250 (66.8750) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [15/32] time 0.432 (0.460) data 0.300 (0.329) loss_x loss_x 1.1025 (1.3051) acc_x 71.8750 (68.3333) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [20/32] time 0.529 (0.450) data 0.398 (0.319) loss_x loss_x 1.3604 (1.3146) acc_x 59.3750 (67.1875) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [25/32] time 0.589 (0.457) data 0.458 (0.326) loss_x loss_x 1.1533 (1.3203) acc_x 56.2500 (66.7500) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [30/32] time 0.466 (0.456) data 0.335 (0.325) loss_x loss_x 0.8892 (1.3031) acc_x 78.1250 (67.0833) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1021
clean true:1018
clean false:3
clean_rate:0.9970617042115573
noisy true:528
noisy false:1587
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 2115
epoch [126/200] batch [5/31] time 0.659 (0.492) data 0.528 (0.361) loss_x loss_x 1.0586 (1.3174) acc_x 71.8750 (68.1250) lr 6.3188e-04 eta 0:00:12
epoch [126/200] batch [10/31] time 0.513 (0.474) data 0.382 (0.342) loss_x loss_x 0.9800 (1.3668) acc_x 78.1250 (65.3125) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [15/31] time 0.522 (0.472) data 0.392 (0.341) loss_x loss_x 2.1230 (1.3950) acc_x 50.0000 (64.7917) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [20/31] time 0.437 (0.455) data 0.306 (0.324) loss_x loss_x 1.2100 (1.3625) acc_x 68.7500 (66.8750) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [25/31] time 0.418 (0.456) data 0.287 (0.325) loss_x loss_x 1.1279 (1.3172) acc_x 68.7500 (67.3750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/31] time 0.414 (0.451) data 0.284 (0.320) loss_x loss_x 1.3711 (1.2927) acc_x 62.5000 (67.9167) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1593
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:1026
clean false:5
clean_rate:0.9951503394762367
noisy true:517
noisy false:1588
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [127/200] batch [5/32] time 0.460 (0.461) data 0.329 (0.330) loss_x loss_x 1.4971 (1.2763) acc_x 68.7500 (70.0000) lr 6.1732e-04 eta 0:00:12
epoch [127/200] batch [10/32] time 0.500 (0.464) data 0.370 (0.333) loss_x loss_x 1.6582 (1.2930) acc_x 65.6250 (68.1250) lr 6.1732e-04 eta 0:00:10
epoch [127/200] batch [15/32] time 0.504 (0.468) data 0.372 (0.337) loss_x loss_x 1.1543 (1.2091) acc_x 62.5000 (69.1667) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [20/32] time 0.359 (0.457) data 0.228 (0.327) loss_x loss_x 1.3535 (1.2414) acc_x 65.6250 (67.5000) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [25/32] time 0.481 (0.460) data 0.351 (0.329) loss_x loss_x 1.1855 (1.2462) acc_x 68.7500 (67.5000) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [30/32] time 0.434 (0.458) data 0.302 (0.327) loss_x loss_x 1.2891 (1.2524) acc_x 71.8750 (67.6042) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1046
clean true:1044
clean false:2
clean_rate:0.9980879541108987
noisy true:526
noisy false:1564
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 2090
epoch [128/200] batch [5/32] time 0.450 (0.462) data 0.319 (0.331) loss_x loss_x 1.4385 (1.1871) acc_x 71.8750 (69.3750) lr 6.0285e-04 eta 0:00:12
epoch [128/200] batch [10/32] time 0.427 (0.449) data 0.297 (0.318) loss_x loss_x 1.3066 (1.2777) acc_x 68.7500 (67.1875) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [15/32] time 0.494 (0.471) data 0.364 (0.340) loss_x loss_x 1.3672 (1.3067) acc_x 50.0000 (65.0000) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [20/32] time 0.516 (0.462) data 0.385 (0.332) loss_x loss_x 0.7300 (1.2336) acc_x 84.3750 (67.3438) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [25/32] time 0.555 (0.466) data 0.424 (0.336) loss_x loss_x 1.2041 (1.2310) acc_x 65.6250 (67.1250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [30/32] time 0.517 (0.462) data 0.387 (0.331) loss_x loss_x 1.3252 (1.2601) acc_x 71.8750 (66.8750) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1583
confident_label rate tensor(0.3300, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1035
clean true:1030
clean false:5
clean_rate:0.9951690821256038
noisy true:523
noisy false:1578
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 2101
epoch [129/200] batch [5/32] time 0.386 (0.467) data 0.255 (0.336) loss_x loss_x 0.8032 (1.1937) acc_x 75.0000 (66.2500) lr 5.8849e-04 eta 0:00:12
epoch [129/200] batch [10/32] time 0.510 (0.465) data 0.380 (0.335) loss_x loss_x 0.7632 (1.1618) acc_x 87.5000 (71.5625) lr 5.8849e-04 eta 0:00:10
epoch [129/200] batch [15/32] time 0.494 (0.459) data 0.363 (0.329) loss_x loss_x 0.9229 (1.1116) acc_x 78.1250 (72.2917) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [20/32] time 0.391 (0.472) data 0.260 (0.341) loss_x loss_x 1.2695 (1.1666) acc_x 75.0000 (71.4062) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [25/32] time 0.579 (0.467) data 0.448 (0.337) loss_x loss_x 1.1543 (1.1840) acc_x 71.8750 (71.0000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [30/32] time 0.389 (0.471) data 0.258 (0.340) loss_x loss_x 1.0068 (1.2266) acc_x 68.7500 (70.2083) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1596
confident_label rate tensor(0.3281, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1029
clean true:1026
clean false:3
clean_rate:0.9970845481049563
noisy true:514
noisy false:1593
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 2107
epoch [130/200] batch [5/32] time 0.511 (0.472) data 0.380 (0.341) loss_x loss_x 1.2178 (1.3973) acc_x 71.8750 (67.5000) lr 5.7422e-04 eta 0:00:12
epoch [130/200] batch [10/32] time 0.457 (0.470) data 0.326 (0.339) loss_x loss_x 1.2559 (1.2310) acc_x 68.7500 (70.0000) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [15/32] time 0.462 (0.467) data 0.332 (0.336) loss_x loss_x 1.2109 (1.2230) acc_x 75.0000 (70.8333) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [20/32] time 0.440 (0.463) data 0.309 (0.333) loss_x loss_x 1.1875 (1.2614) acc_x 71.8750 (70.0000) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [25/32] time 0.764 (0.481) data 0.634 (0.350) loss_x loss_x 1.5752 (1.2592) acc_x 62.5000 (69.8750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [30/32] time 0.536 (0.478) data 0.406 (0.348) loss_x loss_x 1.0566 (1.2541) acc_x 75.0000 (69.4792) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1583
confident_label rate tensor(0.3307, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1037
clean true:1033
clean false:4
clean_rate:0.996142719382835
noisy true:520
noisy false:1579
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 2099
epoch [131/200] batch [5/32] time 0.461 (0.438) data 0.331 (0.308) loss_x loss_x 1.5400 (1.0993) acc_x 65.6250 (72.5000) lr 5.6006e-04 eta 0:00:11
epoch [131/200] batch [10/32] time 0.582 (0.460) data 0.452 (0.330) loss_x loss_x 1.7217 (1.2532) acc_x 56.2500 (68.7500) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [15/32] time 0.390 (0.449) data 0.259 (0.318) loss_x loss_x 1.6162 (1.2994) acc_x 59.3750 (67.0833) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [20/32] time 0.414 (0.452) data 0.283 (0.322) loss_x loss_x 1.8047 (1.3423) acc_x 53.1250 (67.0312) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [25/32] time 0.526 (0.455) data 0.394 (0.325) loss_x loss_x 1.0361 (1.3083) acc_x 78.1250 (68.2500) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [30/32] time 0.546 (0.464) data 0.414 (0.333) loss_x loss_x 1.4014 (1.2833) acc_x 59.3750 (68.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1548
confident_label rate tensor(0.3284, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1030
clean true:1024
clean false:6
clean_rate:0.9941747572815534
noisy true:564
noisy false:1542
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 2106
epoch [132/200] batch [5/32] time 0.542 (0.472) data 0.411 (0.341) loss_x loss_x 1.1680 (1.2885) acc_x 68.7500 (68.7500) lr 5.4601e-04 eta 0:00:12
epoch [132/200] batch [10/32] time 0.530 (0.484) data 0.399 (0.353) loss_x loss_x 0.9429 (1.1408) acc_x 75.0000 (71.5625) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [15/32] time 0.651 (0.505) data 0.521 (0.374) loss_x loss_x 2.1641 (1.2469) acc_x 53.1250 (68.7500) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [20/32] time 0.372 (0.487) data 0.241 (0.356) loss_x loss_x 1.2568 (1.2519) acc_x 68.7500 (69.5312) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [25/32] time 0.486 (0.482) data 0.355 (0.351) loss_x loss_x 1.3818 (1.2578) acc_x 62.5000 (69.7500) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [30/32] time 0.456 (0.466) data 0.326 (0.336) loss_x loss_x 1.0928 (1.2415) acc_x 81.2500 (70.0000) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1575
confident_label rate tensor(0.3320, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1041
clean true:1034
clean false:7
clean_rate:0.9932756964457252
noisy true:527
noisy false:1568
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 2095
epoch [133/200] batch [5/32] time 0.562 (0.530) data 0.431 (0.399) loss_x loss_x 1.4004 (1.2125) acc_x 71.8750 (68.7500) lr 5.3207e-04 eta 0:00:14
epoch [133/200] batch [10/32] time 0.484 (0.507) data 0.353 (0.376) loss_x loss_x 0.6030 (1.0191) acc_x 84.3750 (74.6875) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [15/32] time 0.455 (0.479) data 0.324 (0.348) loss_x loss_x 0.9766 (1.0482) acc_x 68.7500 (74.3750) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [20/32] time 0.399 (0.470) data 0.268 (0.339) loss_x loss_x 1.3506 (1.1159) acc_x 65.6250 (72.8125) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [25/32] time 0.480 (0.474) data 0.349 (0.343) loss_x loss_x 1.4971 (1.1530) acc_x 84.3750 (72.1250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [30/32] time 0.427 (0.467) data 0.296 (0.336) loss_x loss_x 1.0879 (1.1659) acc_x 75.0000 (71.9792) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.3345, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1049
clean true:1046
clean false:3
clean_rate:0.9971401334604385
noisy true:524
noisy false:1563
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 2087
epoch [134/200] batch [5/32] time 0.417 (0.467) data 0.287 (0.336) loss_x loss_x 0.9614 (1.3101) acc_x 65.6250 (66.2500) lr 5.1825e-04 eta 0:00:12
epoch [134/200] batch [10/32] time 0.443 (0.479) data 0.312 (0.349) loss_x loss_x 1.0205 (1.2691) acc_x 71.8750 (67.8125) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [15/32] time 0.366 (0.467) data 0.235 (0.337) loss_x loss_x 0.6885 (1.1711) acc_x 87.5000 (70.4167) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [20/32] time 0.488 (0.471) data 0.358 (0.340) loss_x loss_x 2.0117 (1.2142) acc_x 75.0000 (70.3125) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [25/32] time 0.339 (0.463) data 0.209 (0.332) loss_x loss_x 0.9727 (1.2004) acc_x 75.0000 (70.3750) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [30/32] time 0.478 (0.477) data 0.348 (0.346) loss_x loss_x 1.2842 (1.2106) acc_x 62.5000 (70.5208) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1053
clean false:4
clean_rate:0.9962157048249763
noisy true:503
noisy false:1576
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [135/200] batch [5/33] time 0.418 (0.453) data 0.287 (0.322) loss_x loss_x 1.3359 (1.0166) acc_x 68.7500 (75.6250) lr 5.0454e-04 eta 0:00:12
epoch [135/200] batch [10/33] time 0.444 (0.441) data 0.314 (0.311) loss_x loss_x 1.2881 (1.1380) acc_x 68.7500 (70.9375) lr 5.0454e-04 eta 0:00:10
epoch [135/200] batch [15/33] time 0.384 (0.447) data 0.253 (0.317) loss_x loss_x 1.5293 (1.1826) acc_x 65.6250 (70.0000) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [20/33] time 0.441 (0.463) data 0.310 (0.332) loss_x loss_x 1.1064 (1.2309) acc_x 71.8750 (69.5312) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [25/33] time 0.591 (0.473) data 0.461 (0.342) loss_x loss_x 0.7622 (1.1862) acc_x 78.1250 (70.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [30/33] time 0.480 (0.465) data 0.350 (0.335) loss_x loss_x 1.5322 (1.1828) acc_x 62.5000 (70.5208) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1632
confident_label rate tensor(0.3221, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1010
clean true:1004
clean false:6
clean_rate:0.994059405940594
noisy true:500
noisy false:1626
after delete: len(clean_dataset) 1010
after delete: len(noisy_dataset) 2126
epoch [136/200] batch [5/31] time 0.457 (0.452) data 0.326 (0.321) loss_x loss_x 1.1162 (1.1764) acc_x 68.7500 (72.5000) lr 4.9096e-04 eta 0:00:11
epoch [136/200] batch [10/31] time 0.445 (0.439) data 0.314 (0.309) loss_x loss_x 1.2666 (1.2203) acc_x 71.8750 (69.3750) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [15/31] time 0.447 (0.454) data 0.317 (0.324) loss_x loss_x 1.4316 (1.2965) acc_x 65.6250 (66.6667) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [20/31] time 0.425 (0.456) data 0.294 (0.325) loss_x loss_x 1.2070 (1.2637) acc_x 75.0000 (68.1250) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [25/31] time 0.600 (0.458) data 0.469 (0.327) loss_x loss_x 1.3467 (1.2695) acc_x 75.0000 (68.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [30/31] time 0.468 (0.461) data 0.337 (0.331) loss_x loss_x 1.4678 (1.2864) acc_x 59.3750 (66.9792) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1577
confident_label rate tensor(0.3297, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1034
clean true:1030
clean false:4
clean_rate:0.9961315280464217
noisy true:529
noisy false:1573
after delete: len(clean_dataset) 1034
after delete: len(noisy_dataset) 2102
epoch [137/200] batch [5/32] time 0.449 (0.456) data 0.318 (0.325) loss_x loss_x 1.5371 (1.1180) acc_x 75.0000 (75.0000) lr 4.7750e-04 eta 0:00:12
epoch [137/200] batch [10/32] time 0.450 (0.476) data 0.318 (0.345) loss_x loss_x 0.6641 (1.0443) acc_x 87.5000 (75.6250) lr 4.7750e-04 eta 0:00:10
epoch [137/200] batch [15/32] time 0.486 (0.464) data 0.355 (0.334) loss_x loss_x 1.0264 (1.0692) acc_x 68.7500 (73.5417) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [20/32] time 0.516 (0.468) data 0.385 (0.338) loss_x loss_x 1.1553 (1.0799) acc_x 75.0000 (73.1250) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [25/32] time 0.374 (0.469) data 0.244 (0.338) loss_x loss_x 0.8516 (1.0887) acc_x 78.1250 (72.0000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [30/32] time 0.340 (0.467) data 0.209 (0.336) loss_x loss_x 0.9292 (1.1333) acc_x 78.1250 (71.2500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1587
confident_label rate tensor(0.3262, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1023
clean true:1021
clean false:2
clean_rate:0.9980449657869013
noisy true:528
noisy false:1585
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 2113
epoch [138/200] batch [5/31] time 0.480 (0.448) data 0.350 (0.317) loss_x loss_x 1.3994 (1.1852) acc_x 75.0000 (73.1250) lr 4.6417e-04 eta 0:00:11
epoch [138/200] batch [10/31] time 0.558 (0.490) data 0.428 (0.359) loss_x loss_x 1.3770 (1.0378) acc_x 71.8750 (75.6250) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [15/31] time 0.380 (0.492) data 0.250 (0.362) loss_x loss_x 0.8848 (1.0601) acc_x 75.0000 (75.0000) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [20/31] time 0.618 (0.494) data 0.488 (0.364) loss_x loss_x 0.9907 (1.0867) acc_x 78.1250 (73.5938) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [25/31] time 0.465 (0.486) data 0.334 (0.355) loss_x loss_x 1.3027 (1.1381) acc_x 59.3750 (71.8750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [30/31] time 0.379 (0.476) data 0.249 (0.346) loss_x loss_x 1.4502 (1.1289) acc_x 50.0000 (70.9375) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1571
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1044
clean true:1040
clean false:4
clean_rate:0.9961685823754789
noisy true:525
noisy false:1567
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 2092
epoch [139/200] batch [5/32] time 0.530 (0.468) data 0.399 (0.337) loss_x loss_x 1.4512 (1.0626) acc_x 56.2500 (69.3750) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [10/32] time 0.488 (0.469) data 0.356 (0.338) loss_x loss_x 1.2246 (1.1930) acc_x 65.6250 (68.4375) lr 4.5098e-04 eta 0:00:10
epoch [139/200] batch [15/32] time 0.528 (0.466) data 0.397 (0.335) loss_x loss_x 1.0010 (1.2679) acc_x 71.8750 (66.8750) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [20/32] time 0.374 (0.465) data 0.244 (0.334) loss_x loss_x 1.8330 (1.2607) acc_x 53.1250 (67.5000) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [25/32] time 0.604 (0.457) data 0.473 (0.326) loss_x loss_x 1.3486 (1.2399) acc_x 71.8750 (68.1250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [30/32] time 0.566 (0.473) data 0.434 (0.342) loss_x loss_x 0.5703 (1.1915) acc_x 87.5000 (69.0625) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1559
confident_label rate tensor(0.3265, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1024
clean true:1022
clean false:2
clean_rate:0.998046875
noisy true:555
noisy false:1557
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 2112
epoch [140/200] batch [5/32] time 0.573 (0.494) data 0.441 (0.363) loss_x loss_x 1.5967 (1.2986) acc_x 62.5000 (69.3750) lr 4.3792e-04 eta 0:00:13
epoch [140/200] batch [10/32] time 0.446 (0.471) data 0.315 (0.341) loss_x loss_x 1.8564 (1.2247) acc_x 65.6250 (71.2500) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [15/32] time 0.459 (0.466) data 0.328 (0.336) loss_x loss_x 1.4570 (1.2909) acc_x 78.1250 (70.4167) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [20/32] time 0.447 (0.465) data 0.316 (0.335) loss_x loss_x 1.5439 (1.2296) acc_x 59.3750 (70.4688) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [25/32] time 0.442 (0.451) data 0.311 (0.320) loss_x loss_x 2.0938 (1.2812) acc_x 56.2500 (69.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [30/32] time 0.462 (0.460) data 0.332 (0.329) loss_x loss_x 1.3574 (1.3050) acc_x 68.7500 (68.7500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1051
clean false:6
clean_rate:0.9943235572374646
noisy true:536
noisy false:1543
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [141/200] batch [5/33] time 0.779 (0.533) data 0.648 (0.402) loss_x loss_x 1.7324 (1.3133) acc_x 65.6250 (71.8750) lr 4.2499e-04 eta 0:00:14
epoch [141/200] batch [10/33] time 0.534 (0.503) data 0.403 (0.372) loss_x loss_x 1.1504 (1.2568) acc_x 75.0000 (71.8750) lr 4.2499e-04 eta 0:00:11
epoch [141/200] batch [15/33] time 0.478 (0.480) data 0.347 (0.350) loss_x loss_x 0.6997 (1.2170) acc_x 84.3750 (71.8750) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [20/33] time 0.420 (0.476) data 0.290 (0.345) loss_x loss_x 0.9668 (1.2038) acc_x 78.1250 (72.5000) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [25/33] time 0.411 (0.472) data 0.280 (0.341) loss_x loss_x 0.8574 (1.1822) acc_x 68.7500 (71.6250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [30/33] time 0.439 (0.462) data 0.309 (0.331) loss_x loss_x 1.6025 (1.2355) acc_x 62.5000 (70.2083) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1552
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1052
clean false:6
clean_rate:0.994328922495274
noisy true:532
noisy false:1546
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [142/200] batch [5/33] time 0.517 (0.487) data 0.387 (0.357) loss_x loss_x 1.5381 (1.3464) acc_x 68.7500 (71.8750) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [10/33] time 0.393 (0.474) data 0.263 (0.343) loss_x loss_x 1.5762 (1.3392) acc_x 65.6250 (69.0625) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [15/33] time 0.416 (0.460) data 0.285 (0.330) loss_x loss_x 1.3711 (1.2444) acc_x 68.7500 (70.8333) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [20/33] time 0.517 (0.466) data 0.386 (0.335) loss_x loss_x 1.3330 (1.2287) acc_x 68.7500 (70.3125) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [25/33] time 0.466 (0.467) data 0.335 (0.336) loss_x loss_x 1.4170 (1.2872) acc_x 59.3750 (68.3750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [30/33] time 0.366 (0.461) data 0.235 (0.330) loss_x loss_x 1.7246 (1.3056) acc_x 53.1250 (67.9167) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1552
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1051
clean true:1046
clean false:5
clean_rate:0.9952426260704091
noisy true:538
noisy false:1547
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 2085
epoch [143/200] batch [5/32] time 0.584 (0.468) data 0.453 (0.336) loss_x loss_x 1.2871 (1.0568) acc_x 71.8750 (76.2500) lr 3.9958e-04 eta 0:00:12
epoch [143/200] batch [10/32] time 0.622 (0.502) data 0.490 (0.371) loss_x loss_x 1.3047 (1.1340) acc_x 68.7500 (73.7500) lr 3.9958e-04 eta 0:00:11
epoch [143/200] batch [15/32] time 0.428 (0.500) data 0.298 (0.369) loss_x loss_x 1.8916 (1.2247) acc_x 53.1250 (71.4583) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [20/32] time 0.386 (0.476) data 0.255 (0.345) loss_x loss_x 0.9873 (1.2209) acc_x 68.7500 (70.4688) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [25/32] time 0.423 (0.473) data 0.292 (0.342) loss_x loss_x 1.0039 (1.1685) acc_x 71.8750 (71.6250) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [30/32] time 0.375 (0.474) data 0.245 (0.343) loss_x loss_x 1.5400 (1.1941) acc_x 50.0000 (70.5208) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1564
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1053
clean true:1047
clean false:6
clean_rate:0.9943019943019943
noisy true:525
noisy false:1558
after delete: len(clean_dataset) 1053
after delete: len(noisy_dataset) 2083
epoch [144/200] batch [5/32] time 0.566 (0.519) data 0.436 (0.388) loss_x loss_x 1.0596 (1.2171) acc_x 78.1250 (71.2500) lr 3.8709e-04 eta 0:00:14
epoch [144/200] batch [10/32] time 0.367 (0.478) data 0.236 (0.348) loss_x loss_x 1.1514 (1.2893) acc_x 62.5000 (67.8125) lr 3.8709e-04 eta 0:00:10
epoch [144/200] batch [15/32] time 0.501 (0.468) data 0.371 (0.338) loss_x loss_x 0.8418 (1.2465) acc_x 78.1250 (68.7500) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [20/32] time 0.516 (0.467) data 0.385 (0.336) loss_x loss_x 1.3721 (1.3013) acc_x 56.2500 (66.7188) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [25/32] time 0.494 (0.459) data 0.363 (0.329) loss_x loss_x 1.0625 (1.2530) acc_x 75.0000 (67.5000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [30/32] time 0.409 (0.456) data 0.278 (0.325) loss_x loss_x 0.7920 (1.2232) acc_x 84.3750 (68.6458) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1541
confident_label rate tensor(0.3377, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1059
clean true:1055
clean false:4
clean_rate:0.996222851746931
noisy true:540
noisy false:1537
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 2077
epoch [145/200] batch [5/33] time 0.437 (0.444) data 0.306 (0.313) loss_x loss_x 1.4883 (1.2161) acc_x 53.1250 (67.5000) lr 3.7476e-04 eta 0:00:12
epoch [145/200] batch [10/33] time 0.433 (0.447) data 0.302 (0.316) loss_x loss_x 1.0859 (1.1672) acc_x 68.7500 (69.6875) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [15/33] time 0.392 (0.456) data 0.262 (0.325) loss_x loss_x 1.5732 (1.1660) acc_x 68.7500 (69.5833) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [20/33] time 0.487 (0.461) data 0.356 (0.330) loss_x loss_x 0.9609 (1.1607) acc_x 75.0000 (69.3750) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [25/33] time 0.483 (0.459) data 0.352 (0.328) loss_x loss_x 1.0166 (1.1723) acc_x 71.8750 (69.1250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [30/33] time 0.580 (0.464) data 0.450 (0.333) loss_x loss_x 1.2676 (1.1735) acc_x 65.6250 (69.2708) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1594
confident_label rate tensor(0.3262, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1023
clean true:1022
clean false:1
clean_rate:0.9990224828934506
noisy true:520
noisy false:1593
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 2113
epoch [146/200] batch [5/31] time 0.454 (0.464) data 0.324 (0.333) loss_x loss_x 1.2812 (1.3947) acc_x 65.6250 (63.1250) lr 3.6258e-04 eta 0:00:12
epoch [146/200] batch [10/31] time 0.457 (0.455) data 0.324 (0.324) loss_x loss_x 1.8193 (1.3614) acc_x 59.3750 (65.9375) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [15/31] time 0.431 (0.468) data 0.300 (0.337) loss_x loss_x 1.4053 (1.3654) acc_x 59.3750 (65.0000) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [20/31] time 0.481 (0.463) data 0.349 (0.331) loss_x loss_x 1.2949 (1.3526) acc_x 65.6250 (66.4062) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [25/31] time 0.580 (0.473) data 0.450 (0.342) loss_x loss_x 1.7188 (1.2958) acc_x 40.6250 (67.5000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [30/31] time 0.537 (0.486) data 0.407 (0.355) loss_x loss_x 1.6279 (1.2967) acc_x 50.0000 (67.2917) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1573
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1050
clean true:1045
clean false:5
clean_rate:0.9952380952380953
noisy true:518
noisy false:1568
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 2086
epoch [147/200] batch [5/32] time 0.485 (0.523) data 0.355 (0.392) loss_x loss_x 1.0312 (1.2594) acc_x 68.7500 (66.2500) lr 3.5055e-04 eta 0:00:14
epoch [147/200] batch [10/32] time 0.465 (0.515) data 0.335 (0.384) loss_x loss_x 1.4297 (1.2644) acc_x 78.1250 (68.1250) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [15/32] time 0.427 (0.483) data 0.297 (0.352) loss_x loss_x 1.3896 (1.2720) acc_x 71.8750 (68.3333) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [20/32] time 0.717 (0.487) data 0.585 (0.356) loss_x loss_x 1.0352 (1.2597) acc_x 78.1250 (69.6875) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [25/32] time 0.571 (0.491) data 0.439 (0.360) loss_x loss_x 1.5869 (1.2684) acc_x 65.6250 (69.3750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [30/32] time 0.440 (0.489) data 0.309 (0.358) loss_x loss_x 0.9712 (1.2420) acc_x 75.0000 (69.0625) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1604
confident_label rate tensor(0.3246, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1018
clean true:1012
clean false:6
clean_rate:0.9941060903732809
noisy true:520
noisy false:1598
after delete: len(clean_dataset) 1018
after delete: len(noisy_dataset) 2118
epoch [148/200] batch [5/31] time 0.549 (0.472) data 0.418 (0.341) loss_x loss_x 1.0371 (1.0530) acc_x 78.1250 (73.1250) lr 3.3869e-04 eta 0:00:12
epoch [148/200] batch [10/31] time 0.449 (0.472) data 0.318 (0.341) loss_x loss_x 0.9854 (1.1315) acc_x 71.8750 (70.9375) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [15/31] time 0.517 (0.490) data 0.387 (0.359) loss_x loss_x 1.8545 (1.2036) acc_x 62.5000 (70.6250) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [20/31] time 0.456 (0.476) data 0.326 (0.345) loss_x loss_x 1.0508 (1.1960) acc_x 68.7500 (70.1562) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [25/31] time 0.415 (0.464) data 0.283 (0.333) loss_x loss_x 1.0928 (1.1591) acc_x 68.7500 (70.6250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [30/31] time 0.442 (0.465) data 0.312 (0.334) loss_x loss_x 1.3408 (1.1667) acc_x 56.2500 (69.5833) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1546
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1058
clean false:3
clean_rate:0.9971724787935909
noisy true:532
noisy false:1543
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [149/200] batch [5/33] time 0.434 (0.473) data 0.303 (0.343) loss_x loss_x 1.4648 (1.3929) acc_x 56.2500 (62.5000) lr 3.2699e-04 eta 0:00:13
epoch [149/200] batch [10/33] time 0.587 (0.479) data 0.456 (0.348) loss_x loss_x 0.8696 (1.2443) acc_x 78.1250 (68.4375) lr 3.2699e-04 eta 0:00:11
epoch [149/200] batch [15/33] time 0.421 (0.465) data 0.290 (0.335) loss_x loss_x 1.3926 (1.1866) acc_x 59.3750 (69.7917) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [20/33] time 0.517 (0.470) data 0.386 (0.339) loss_x loss_x 1.4131 (1.1741) acc_x 68.7500 (70.1562) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [25/33] time 0.519 (0.472) data 0.389 (0.341) loss_x loss_x 1.1572 (1.1669) acc_x 62.5000 (69.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [30/33] time 0.607 (0.474) data 0.476 (0.344) loss_x loss_x 1.2695 (1.1837) acc_x 71.8750 (69.2708) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.3304, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1036
clean true:1034
clean false:2
clean_rate:0.9980694980694981
noisy true:526
noisy false:1574
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 2100
epoch [150/200] batch [5/32] time 0.454 (0.510) data 0.324 (0.379) loss_x loss_x 1.1025 (1.3617) acc_x 71.8750 (65.0000) lr 3.1545e-04 eta 0:00:13
epoch [150/200] batch [10/32] time 0.440 (0.470) data 0.309 (0.340) loss_x loss_x 1.1152 (1.3123) acc_x 78.1250 (66.2500) lr 3.1545e-04 eta 0:00:10
epoch [150/200] batch [15/32] time 0.648 (0.488) data 0.517 (0.358) loss_x loss_x 0.8623 (1.2237) acc_x 78.1250 (68.3333) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [20/32] time 0.457 (0.483) data 0.327 (0.352) loss_x loss_x 0.9097 (1.2138) acc_x 71.8750 (68.5938) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [25/32] time 0.593 (0.483) data 0.463 (0.353) loss_x loss_x 1.1982 (1.2054) acc_x 65.6250 (68.7500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [30/32] time 0.598 (0.489) data 0.467 (0.358) loss_x loss_x 1.3584 (1.2349) acc_x 62.5000 (68.7500) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1057
clean false:4
clean_rate:0.9962299717247879
noisy true:530
noisy false:1545
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [151/200] batch [5/33] time 0.391 (0.470) data 0.261 (0.340) loss_x loss_x 1.4307 (1.2990) acc_x 78.1250 (72.5000) lr 3.0409e-04 eta 0:00:13
epoch [151/200] batch [10/33] time 0.582 (0.469) data 0.452 (0.338) loss_x loss_x 1.0957 (1.2882) acc_x 71.8750 (71.5625) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [15/33] time 0.400 (0.461) data 0.270 (0.331) loss_x loss_x 1.1484 (1.2188) acc_x 68.7500 (71.6667) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [20/33] time 0.505 (0.455) data 0.375 (0.325) loss_x loss_x 0.7871 (1.2354) acc_x 81.2500 (70.4688) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [25/33] time 0.405 (0.459) data 0.275 (0.328) loss_x loss_x 1.0605 (1.2157) acc_x 78.1250 (70.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [30/33] time 0.368 (0.459) data 0.237 (0.328) loss_x loss_x 1.6289 (1.2584) acc_x 59.3750 (69.2708) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1559
confident_label rate tensor(0.3390, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1063
clean true:1061
clean false:2
clean_rate:0.9981185324553151
noisy true:516
noisy false:1557
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 2073
epoch [152/200] batch [5/33] time 0.467 (0.467) data 0.336 (0.336) loss_x loss_x 1.0068 (1.3301) acc_x 68.7500 (64.3750) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [10/33] time 0.483 (0.470) data 0.353 (0.339) loss_x loss_x 1.6875 (1.3840) acc_x 53.1250 (63.7500) lr 2.9289e-04 eta 0:00:10
epoch [152/200] batch [15/33] time 0.410 (0.470) data 0.280 (0.339) loss_x loss_x 1.2695 (1.3013) acc_x 62.5000 (66.6667) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [20/33] time 0.422 (0.466) data 0.292 (0.336) loss_x loss_x 1.2363 (1.2927) acc_x 71.8750 (67.6562) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [25/33] time 0.471 (0.471) data 0.340 (0.340) loss_x loss_x 1.2568 (1.2584) acc_x 65.6250 (67.6250) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [30/33] time 0.537 (0.473) data 0.407 (0.343) loss_x loss_x 1.3760 (1.2854) acc_x 65.6250 (66.9792) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1589
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1046
clean true:1044
clean false:2
clean_rate:0.9980879541108987
noisy true:503
noisy false:1587
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 2090
epoch [153/200] batch [5/32] time 0.469 (0.475) data 0.339 (0.344) loss_x loss_x 1.8740 (1.2845) acc_x 56.2500 (70.6250) lr 2.8187e-04 eta 0:00:12
epoch [153/200] batch [10/32] time 0.477 (0.512) data 0.346 (0.382) loss_x loss_x 1.1514 (1.2645) acc_x 71.8750 (70.0000) lr 2.8187e-04 eta 0:00:11
epoch [153/200] batch [15/32] time 0.348 (0.496) data 0.217 (0.365) loss_x loss_x 0.9038 (1.2131) acc_x 75.0000 (70.2083) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [20/32] time 0.459 (0.483) data 0.329 (0.352) loss_x loss_x 1.5244 (1.2673) acc_x 56.2500 (68.1250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [25/32] time 0.422 (0.473) data 0.292 (0.342) loss_x loss_x 1.4111 (1.2352) acc_x 59.3750 (68.8750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [30/32] time 0.414 (0.464) data 0.284 (0.334) loss_x loss_x 1.3691 (1.2317) acc_x 53.1250 (68.0208) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1046
clean true:1043
clean false:3
clean_rate:0.997131931166348
noisy true:535
noisy false:1555
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 2090
epoch [154/200] batch [5/32] time 0.479 (0.429) data 0.349 (0.298) loss_x loss_x 1.0986 (1.2200) acc_x 81.2500 (71.2500) lr 2.7103e-04 eta 0:00:11
epoch [154/200] batch [10/32] time 0.543 (0.454) data 0.412 (0.323) loss_x loss_x 1.3467 (1.1328) acc_x 71.8750 (73.1250) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [15/32] time 0.469 (0.468) data 0.338 (0.337) loss_x loss_x 1.5156 (1.1798) acc_x 71.8750 (71.6667) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [20/32] time 0.483 (0.474) data 0.353 (0.343) loss_x loss_x 1.2168 (1.1908) acc_x 62.5000 (70.7812) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [25/32] time 0.434 (0.472) data 0.304 (0.341) loss_x loss_x 1.3398 (1.2314) acc_x 53.1250 (69.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [30/32] time 0.733 (0.485) data 0.602 (0.355) loss_x loss_x 0.8613 (1.2290) acc_x 75.0000 (69.6875) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.3425, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1074
clean true:1067
clean false:7
clean_rate:0.9934823091247672
noisy true:502
noisy false:1560
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 2062
epoch [155/200] batch [5/33] time 0.576 (0.493) data 0.446 (0.362) loss_x loss_x 1.5059 (1.2120) acc_x 62.5000 (69.3750) lr 2.6037e-04 eta 0:00:13
epoch [155/200] batch [10/33] time 0.510 (0.478) data 0.380 (0.347) loss_x loss_x 0.9121 (1.2429) acc_x 75.0000 (69.0625) lr 2.6037e-04 eta 0:00:10
epoch [155/200] batch [15/33] time 0.455 (0.482) data 0.325 (0.352) loss_x loss_x 1.0859 (1.1825) acc_x 68.7500 (70.2083) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [20/33] time 0.688 (0.486) data 0.557 (0.355) loss_x loss_x 1.4219 (1.1792) acc_x 68.7500 (70.7812) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [25/33] time 0.470 (0.476) data 0.340 (0.346) loss_x loss_x 1.4639 (1.2161) acc_x 62.5000 (69.8750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [30/33] time 0.448 (0.472) data 0.318 (0.341) loss_x loss_x 1.6016 (1.2212) acc_x 59.3750 (69.5833) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1584
confident_label rate tensor(0.3310, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1038
clean true:1037
clean false:1
clean_rate:0.9990366088631984
noisy true:515
noisy false:1583
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 2098
epoch [156/200] batch [5/32] time 0.422 (0.477) data 0.291 (0.346) loss_x loss_x 1.2451 (1.2199) acc_x 62.5000 (67.5000) lr 2.4989e-04 eta 0:00:12
epoch [156/200] batch [10/32] time 0.526 (0.469) data 0.394 (0.338) loss_x loss_x 1.2432 (1.2874) acc_x 75.0000 (68.1250) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [15/32] time 0.501 (0.465) data 0.370 (0.334) loss_x loss_x 0.5967 (1.2156) acc_x 81.2500 (69.5833) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [20/32] time 0.412 (0.454) data 0.281 (0.323) loss_x loss_x 1.2695 (1.1987) acc_x 71.8750 (69.8438) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [25/32] time 0.425 (0.452) data 0.294 (0.321) loss_x loss_x 1.0293 (1.1993) acc_x 65.6250 (68.6250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [30/32] time 0.574 (0.478) data 0.444 (0.348) loss_x loss_x 0.9634 (1.1991) acc_x 71.8750 (68.4375) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1541
confident_label rate tensor(0.3332, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1045
clean true:1040
clean false:5
clean_rate:0.9952153110047847
noisy true:555
noisy false:1536
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 2091
epoch [157/200] batch [5/32] time 0.436 (0.508) data 0.306 (0.377) loss_x loss_x 0.8643 (1.2504) acc_x 81.2500 (73.1250) lr 2.3959e-04 eta 0:00:13
epoch [157/200] batch [10/32] time 0.453 (0.476) data 0.323 (0.345) loss_x loss_x 1.1592 (1.1934) acc_x 78.1250 (71.8750) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [15/32] time 0.407 (0.465) data 0.277 (0.334) loss_x loss_x 0.7842 (1.1547) acc_x 71.8750 (71.0417) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [20/32] time 0.567 (0.465) data 0.436 (0.335) loss_x loss_x 1.1221 (1.1688) acc_x 75.0000 (71.4062) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [25/32] time 0.411 (0.461) data 0.281 (0.331) loss_x loss_x 1.2188 (1.2230) acc_x 65.6250 (69.7500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [30/32] time 0.503 (0.468) data 0.373 (0.338) loss_x loss_x 1.4023 (1.2310) acc_x 65.6250 (69.2708) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1579
confident_label rate tensor(0.3297, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1034
clean true:1029
clean false:5
clean_rate:0.995164410058027
noisy true:528
noisy false:1574
after delete: len(clean_dataset) 1034
after delete: len(noisy_dataset) 2102
epoch [158/200] batch [5/32] time 0.467 (0.428) data 0.335 (0.297) loss_x loss_x 0.9976 (1.1433) acc_x 71.8750 (68.7500) lr 2.2949e-04 eta 0:00:11
epoch [158/200] batch [10/32] time 0.461 (0.450) data 0.331 (0.319) loss_x loss_x 1.0625 (1.1467) acc_x 78.1250 (69.6875) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [15/32] time 0.420 (0.463) data 0.290 (0.332) loss_x loss_x 1.3428 (1.1149) acc_x 68.7500 (71.6667) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [20/32] time 0.453 (0.478) data 0.321 (0.347) loss_x loss_x 1.1299 (1.0823) acc_x 71.8750 (72.8125) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [25/32] time 0.658 (0.483) data 0.527 (0.352) loss_x loss_x 1.2080 (1.1155) acc_x 68.7500 (72.0000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [30/32] time 0.413 (0.477) data 0.283 (0.346) loss_x loss_x 1.6816 (1.1514) acc_x 62.5000 (71.7708) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1540
confident_label rate tensor(0.3367, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1056
clean true:1052
clean false:4
clean_rate:0.9962121212121212
noisy true:544
noisy false:1536
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 2080
epoch [159/200] batch [5/33] time 0.501 (0.476) data 0.370 (0.345) loss_x loss_x 1.2305 (1.2018) acc_x 68.7500 (72.5000) lr 2.1957e-04 eta 0:00:13
epoch [159/200] batch [10/33] time 0.460 (0.473) data 0.328 (0.342) loss_x loss_x 1.3936 (1.1587) acc_x 65.6250 (71.2500) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [15/33] time 0.512 (0.481) data 0.382 (0.350) loss_x loss_x 0.8403 (1.1059) acc_x 78.1250 (71.8750) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [20/33] time 0.424 (0.485) data 0.293 (0.354) loss_x loss_x 1.3281 (1.1268) acc_x 68.7500 (71.0938) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [25/33] time 0.447 (0.477) data 0.316 (0.346) loss_x loss_x 1.3750 (1.1466) acc_x 65.6250 (70.5000) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [30/33] time 0.462 (0.476) data 0.332 (0.345) loss_x loss_x 1.5312 (1.1431) acc_x 65.6250 (70.6250) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1540
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1055
clean true:1052
clean false:3
clean_rate:0.9971563981042654
noisy true:544
noisy false:1537
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 2081
epoch [160/200] batch [5/32] time 0.483 (0.490) data 0.352 (0.359) loss_x loss_x 1.3545 (1.2961) acc_x 62.5000 (69.3750) lr 2.0984e-04 eta 0:00:13
epoch [160/200] batch [10/32] time 0.521 (0.464) data 0.390 (0.334) loss_x loss_x 1.4082 (1.3281) acc_x 62.5000 (66.8750) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [15/32] time 0.420 (0.467) data 0.289 (0.336) loss_x loss_x 1.2305 (1.2678) acc_x 75.0000 (69.1667) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [20/32] time 0.576 (0.486) data 0.444 (0.356) loss_x loss_x 1.2803 (1.2600) acc_x 71.8750 (69.3750) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [25/32] time 0.541 (0.491) data 0.410 (0.360) loss_x loss_x 1.1650 (1.2913) acc_x 71.8750 (69.0000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [30/32] time 0.492 (0.490) data 0.361 (0.359) loss_x loss_x 0.9199 (1.2849) acc_x 81.2500 (69.1667) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1581
confident_label rate tensor(0.3313, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1039
clean true:1034
clean false:5
clean_rate:0.9951876804619827
noisy true:521
noisy false:1576
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 2097
epoch [161/200] batch [5/32] time 0.618 (0.504) data 0.487 (0.372) loss_x loss_x 1.1211 (1.2641) acc_x 68.7500 (67.5000) lr 2.0032e-04 eta 0:00:13
epoch [161/200] batch [10/32] time 0.456 (0.504) data 0.325 (0.373) loss_x loss_x 1.0820 (1.2050) acc_x 68.7500 (68.7500) lr 2.0032e-04 eta 0:00:11
epoch [161/200] batch [15/32] time 0.464 (0.486) data 0.334 (0.355) loss_x loss_x 1.4541 (1.2190) acc_x 68.7500 (69.5833) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [20/32] time 0.597 (0.492) data 0.465 (0.361) loss_x loss_x 1.0566 (1.1640) acc_x 71.8750 (71.2500) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [25/32] time 0.558 (0.485) data 0.426 (0.354) loss_x loss_x 0.8779 (1.1569) acc_x 75.0000 (71.1250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [30/32] time 0.367 (0.481) data 0.236 (0.350) loss_x loss_x 1.3555 (1.1709) acc_x 62.5000 (70.3125) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1516
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1075
clean true:1072
clean false:3
clean_rate:0.9972093023255814
noisy true:548
noisy false:1513
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 2061
epoch [162/200] batch [5/33] time 0.381 (0.472) data 0.251 (0.341) loss_x loss_x 0.8936 (1.0500) acc_x 71.8750 (68.1250) lr 1.9098e-04 eta 0:00:13
epoch [162/200] batch [10/33] time 0.643 (0.487) data 0.512 (0.356) loss_x loss_x 0.9731 (1.0842) acc_x 78.1250 (69.0625) lr 1.9098e-04 eta 0:00:11
epoch [162/200] batch [15/33] time 0.497 (0.468) data 0.366 (0.337) loss_x loss_x 1.1934 (1.1166) acc_x 75.0000 (71.0417) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [20/33] time 0.455 (0.456) data 0.324 (0.325) loss_x loss_x 1.1973 (1.1944) acc_x 71.8750 (70.6250) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [25/33] time 0.389 (0.455) data 0.259 (0.325) loss_x loss_x 1.4014 (1.1998) acc_x 68.7500 (70.8750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [30/33] time 0.504 (0.457) data 0.374 (0.326) loss_x loss_x 1.2520 (1.1756) acc_x 65.6250 (71.4583) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1538
confident_label rate tensor(0.3409, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1069
clean true:1059
clean false:10
clean_rate:0.990645463049579
noisy true:539
noisy false:1528
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 2067
epoch [163/200] batch [5/33] time 0.504 (0.497) data 0.373 (0.366) loss_x loss_x 0.5400 (0.8585) acc_x 90.6250 (76.8750) lr 1.8185e-04 eta 0:00:13
epoch [163/200] batch [10/33] time 0.478 (0.482) data 0.347 (0.352) loss_x loss_x 1.0703 (1.0576) acc_x 75.0000 (73.1250) lr 1.8185e-04 eta 0:00:11
epoch [163/200] batch [15/33] time 0.400 (0.470) data 0.269 (0.339) loss_x loss_x 1.9697 (1.1259) acc_x 59.3750 (73.1250) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [20/33] time 0.367 (0.456) data 0.237 (0.325) loss_x loss_x 1.6133 (1.1309) acc_x 56.2500 (72.6562) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [25/33] time 0.550 (0.470) data 0.420 (0.339) loss_x loss_x 1.1855 (1.1917) acc_x 68.7500 (70.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [30/33] time 0.469 (0.469) data 0.339 (0.338) loss_x loss_x 1.4258 (1.1863) acc_x 62.5000 (70.7292) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1515
confident_label rate tensor(0.3504, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1099
clean true:1096
clean false:3
clean_rate:0.997270245677889
noisy true:525
noisy false:1512
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 2037
epoch [164/200] batch [5/34] time 0.434 (0.459) data 0.303 (0.329) loss_x loss_x 1.7070 (1.0594) acc_x 50.0000 (71.8750) lr 1.7292e-04 eta 0:00:13
epoch [164/200] batch [10/34] time 0.387 (0.461) data 0.257 (0.330) loss_x loss_x 1.2539 (1.1328) acc_x 71.8750 (71.2500) lr 1.7292e-04 eta 0:00:11
epoch [164/200] batch [15/34] time 0.540 (0.464) data 0.410 (0.334) loss_x loss_x 0.9585 (1.1185) acc_x 78.1250 (71.0417) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [20/34] time 0.360 (0.453) data 0.229 (0.323) loss_x loss_x 0.9443 (1.1092) acc_x 75.0000 (71.5625) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [25/34] time 0.596 (0.465) data 0.466 (0.335) loss_x loss_x 1.2305 (1.1284) acc_x 75.0000 (71.1250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [30/34] time 0.398 (0.461) data 0.267 (0.331) loss_x loss_x 1.3359 (1.1366) acc_x 59.3750 (70.5208) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1571
confident_label rate tensor(0.3284, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1030
clean true:1026
clean false:4
clean_rate:0.996116504854369
noisy true:539
noisy false:1567
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 2106
epoch [165/200] batch [5/32] time 0.462 (0.491) data 0.331 (0.360) loss_x loss_x 1.1455 (1.3414) acc_x 75.0000 (71.2500) lr 1.6419e-04 eta 0:00:13
epoch [165/200] batch [10/32] time 0.621 (0.488) data 0.490 (0.358) loss_x loss_x 1.1113 (1.2309) acc_x 62.5000 (70.9375) lr 1.6419e-04 eta 0:00:10
epoch [165/200] batch [15/32] time 0.479 (0.486) data 0.348 (0.355) loss_x loss_x 1.4268 (1.2426) acc_x 65.6250 (70.4167) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [20/32] time 0.407 (0.480) data 0.276 (0.349) loss_x loss_x 1.6846 (1.3089) acc_x 59.3750 (67.9688) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [25/32] time 0.605 (0.489) data 0.474 (0.358) loss_x loss_x 0.8457 (1.2588) acc_x 81.2500 (69.7500) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [30/32] time 0.502 (0.489) data 0.373 (0.358) loss_x loss_x 0.8887 (1.2295) acc_x 68.7500 (70.6250) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1046
clean true:1042
clean false:4
clean_rate:0.9961759082217974
noisy true:536
noisy false:1554
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 2090
epoch [166/200] batch [5/32] time 0.528 (0.467) data 0.397 (0.336) loss_x loss_x 1.0410 (1.3547) acc_x 71.8750 (66.8750) lr 1.5567e-04 eta 0:00:12
epoch [166/200] batch [10/32] time 0.453 (0.474) data 0.322 (0.344) loss_x loss_x 0.7173 (1.2853) acc_x 75.0000 (69.6875) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [15/32] time 0.402 (0.458) data 0.272 (0.327) loss_x loss_x 1.0703 (1.2295) acc_x 65.6250 (70.6250) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [20/32] time 0.627 (0.462) data 0.496 (0.331) loss_x loss_x 1.3838 (1.2549) acc_x 71.8750 (69.5312) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [25/32] time 0.490 (0.469) data 0.360 (0.339) loss_x loss_x 0.8037 (1.2531) acc_x 84.3750 (69.3750) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [30/32] time 0.406 (0.470) data 0.275 (0.339) loss_x loss_x 1.0654 (1.2178) acc_x 84.3750 (70.7292) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.3262, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1023
clean true:1020
clean false:3
clean_rate:0.9970674486803519
noisy true:540
noisy false:1573
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 2113
epoch [167/200] batch [5/31] time 0.431 (0.521) data 0.300 (0.390) loss_x loss_x 0.9155 (1.1412) acc_x 75.0000 (68.1250) lr 1.4736e-04 eta 0:00:13
epoch [167/200] batch [10/31] time 0.366 (0.482) data 0.235 (0.352) loss_x loss_x 1.2832 (1.1028) acc_x 65.6250 (69.6875) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [15/31] time 0.467 (0.489) data 0.337 (0.358) loss_x loss_x 0.9365 (1.1030) acc_x 68.7500 (70.2083) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [20/31] time 0.430 (0.476) data 0.300 (0.345) loss_x loss_x 1.0957 (1.1055) acc_x 65.6250 (70.9375) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [25/31] time 0.523 (0.471) data 0.391 (0.341) loss_x loss_x 0.9023 (1.1146) acc_x 71.8750 (71.0000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [30/31] time 0.485 (0.471) data 0.354 (0.340) loss_x loss_x 1.2480 (1.1702) acc_x 75.0000 (70.4167) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.3307, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1037
clean true:1034
clean false:3
clean_rate:0.9971070395371263
noisy true:526
noisy false:1573
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 2099
epoch [168/200] batch [5/32] time 0.469 (0.487) data 0.338 (0.356) loss_x loss_x 1.4150 (1.1404) acc_x 62.5000 (71.2500) lr 1.3926e-04 eta 0:00:13
epoch [168/200] batch [10/32] time 0.731 (0.494) data 0.600 (0.363) loss_x loss_x 0.8574 (1.0942) acc_x 84.3750 (74.3750) lr 1.3926e-04 eta 0:00:10
epoch [168/200] batch [15/32] time 0.490 (0.480) data 0.360 (0.349) loss_x loss_x 1.0410 (1.1530) acc_x 75.0000 (71.8750) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [20/32] time 0.415 (0.466) data 0.283 (0.335) loss_x loss_x 1.5303 (1.1602) acc_x 71.8750 (72.6562) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [25/32] time 0.493 (0.475) data 0.363 (0.344) loss_x loss_x 1.2510 (1.1555) acc_x 71.8750 (72.3750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [30/32] time 0.451 (0.477) data 0.321 (0.347) loss_x loss_x 1.3633 (1.1777) acc_x 65.6250 (71.6667) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1559
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1056
clean false:5
clean_rate:0.9952874646559849
noisy true:521
noisy false:1554
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [169/200] batch [5/33] time 0.436 (0.432) data 0.306 (0.301) loss_x loss_x 1.0186 (1.0881) acc_x 65.6250 (70.0000) lr 1.3137e-04 eta 0:00:12
epoch [169/200] batch [10/33] time 0.490 (0.466) data 0.360 (0.336) loss_x loss_x 1.4492 (1.2092) acc_x 59.3750 (67.8125) lr 1.3137e-04 eta 0:00:10
epoch [169/200] batch [15/33] time 0.564 (0.470) data 0.433 (0.340) loss_x loss_x 0.9980 (1.1420) acc_x 78.1250 (70.2083) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [20/33] time 0.428 (0.458) data 0.298 (0.328) loss_x loss_x 1.1113 (1.1335) acc_x 71.8750 (70.4688) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [25/33] time 0.436 (0.457) data 0.306 (0.326) loss_x loss_x 1.0000 (1.1224) acc_x 78.1250 (71.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [30/33] time 0.416 (0.466) data 0.285 (0.336) loss_x loss_x 1.3652 (1.1112) acc_x 65.6250 (72.0833) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1526
confident_label rate tensor(0.3396, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1065
clean true:1061
clean false:4
clean_rate:0.996244131455399
noisy true:549
noisy false:1522
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 2071
epoch [170/200] batch [5/33] time 0.419 (0.486) data 0.288 (0.355) loss_x loss_x 1.4766 (1.2419) acc_x 65.6250 (65.6250) lr 1.2369e-04 eta 0:00:13
epoch [170/200] batch [10/33] time 0.486 (0.505) data 0.356 (0.374) loss_x loss_x 1.1055 (1.1916) acc_x 75.0000 (68.7500) lr 1.2369e-04 eta 0:00:11
epoch [170/200] batch [15/33] time 0.495 (0.490) data 0.364 (0.359) loss_x loss_x 1.1338 (1.2209) acc_x 65.6250 (67.7083) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [20/33] time 0.674 (0.488) data 0.544 (0.358) loss_x loss_x 1.4062 (1.2295) acc_x 68.7500 (67.9688) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [25/33] time 0.434 (0.481) data 0.304 (0.350) loss_x loss_x 1.5225 (1.2301) acc_x 68.7500 (68.3750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [30/33] time 0.393 (0.482) data 0.262 (0.351) loss_x loss_x 1.0879 (1.1921) acc_x 78.1250 (69.6875) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.3479, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1091
clean true:1085
clean false:6
clean_rate:0.9945004582951421
noisy true:524
noisy false:1521
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 2045
epoch [171/200] batch [5/34] time 0.466 (0.435) data 0.335 (0.304) loss_x loss_x 0.9136 (1.0767) acc_x 71.8750 (72.5000) lr 1.1623e-04 eta 0:00:12
epoch [171/200] batch [10/34] time 0.520 (0.449) data 0.389 (0.318) loss_x loss_x 1.5771 (1.1719) acc_x 75.0000 (72.1875) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [15/34] time 0.525 (0.480) data 0.395 (0.349) loss_x loss_x 1.5967 (1.1777) acc_x 56.2500 (71.4583) lr 1.1623e-04 eta 0:00:09
epoch [171/200] batch [20/34] time 0.613 (0.493) data 0.483 (0.362) loss_x loss_x 2.2578 (1.2029) acc_x 65.6250 (71.4062) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [25/34] time 0.453 (0.487) data 0.322 (0.356) loss_x loss_x 1.0215 (1.1806) acc_x 78.1250 (71.1250) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [30/34] time 0.473 (0.488) data 0.342 (0.357) loss_x loss_x 1.0371 (1.1717) acc_x 65.6250 (70.8333) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1545
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1056
clean false:5
clean_rate:0.9952874646559849
noisy true:535
noisy false:1540
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [172/200] batch [5/33] time 0.566 (0.496) data 0.436 (0.366) loss_x loss_x 1.4648 (1.4312) acc_x 65.6250 (66.2500) lr 1.0899e-04 eta 0:00:13
epoch [172/200] batch [10/33] time 0.442 (0.465) data 0.311 (0.335) loss_x loss_x 1.4209 (1.3802) acc_x 65.6250 (65.6250) lr 1.0899e-04 eta 0:00:10
epoch [172/200] batch [15/33] time 0.574 (0.494) data 0.443 (0.363) loss_x loss_x 1.2910 (1.3467) acc_x 71.8750 (67.5000) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [20/33] time 0.454 (0.488) data 0.324 (0.358) loss_x loss_x 1.1631 (1.2884) acc_x 62.5000 (68.1250) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [25/33] time 0.458 (0.501) data 0.327 (0.370) loss_x loss_x 1.2041 (1.2606) acc_x 62.5000 (67.8750) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [30/33] time 0.455 (0.496) data 0.324 (0.366) loss_x loss_x 1.4209 (1.2576) acc_x 59.3750 (67.5000) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1604
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1028
clean true:1023
clean false:5
clean_rate:0.995136186770428
noisy true:509
noisy false:1599
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 2108
epoch [173/200] batch [5/32] time 0.424 (0.460) data 0.294 (0.329) loss_x loss_x 1.2324 (1.2504) acc_x 71.8750 (66.2500) lr 1.0197e-04 eta 0:00:12
epoch [173/200] batch [10/32] time 0.525 (0.459) data 0.394 (0.328) loss_x loss_x 0.9438 (1.2058) acc_x 78.1250 (65.9375) lr 1.0197e-04 eta 0:00:10
epoch [173/200] batch [15/32] time 0.495 (0.466) data 0.364 (0.335) loss_x loss_x 0.4507 (1.1104) acc_x 87.5000 (68.5417) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [20/32] time 0.466 (0.476) data 0.335 (0.345) loss_x loss_x 1.4697 (1.1222) acc_x 68.7500 (70.0000) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [25/32] time 0.430 (0.471) data 0.298 (0.340) loss_x loss_x 1.1562 (1.1308) acc_x 75.0000 (70.6250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [30/32] time 0.490 (0.474) data 0.359 (0.343) loss_x loss_x 0.7852 (1.1399) acc_x 75.0000 (70.2083) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1529
confident_label rate tensor(0.3438, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1078
clean true:1075
clean false:3
clean_rate:0.9972170686456401
noisy true:532
noisy false:1526
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 2058
epoch [174/200] batch [5/33] time 0.531 (0.489) data 0.400 (0.358) loss_x loss_x 1.1846 (1.0971) acc_x 78.1250 (75.0000) lr 9.5173e-05 eta 0:00:13
epoch [174/200] batch [10/33] time 0.472 (0.492) data 0.341 (0.361) loss_x loss_x 0.9429 (1.1230) acc_x 81.2500 (71.8750) lr 9.5173e-05 eta 0:00:11
epoch [174/200] batch [15/33] time 0.459 (0.472) data 0.328 (0.341) loss_x loss_x 1.8311 (1.1855) acc_x 53.1250 (69.7917) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [20/33] time 0.548 (0.470) data 0.418 (0.339) loss_x loss_x 1.3887 (1.2187) acc_x 68.7500 (68.1250) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [25/33] time 0.532 (0.469) data 0.400 (0.338) loss_x loss_x 1.2705 (1.2513) acc_x 71.8750 (68.2500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [30/33] time 0.414 (0.462) data 0.283 (0.331) loss_x loss_x 0.9756 (1.2362) acc_x 75.0000 (68.4375) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1079
clean true:1077
clean false:2
clean_rate:0.9981464318813716
noisy true:535
noisy false:1522
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 2057
epoch [175/200] batch [5/33] time 0.593 (0.486) data 0.463 (0.355) loss_x loss_x 1.3174 (1.1372) acc_x 68.7500 (71.2500) lr 8.8597e-05 eta 0:00:13
epoch [175/200] batch [10/33] time 0.413 (0.489) data 0.283 (0.358) loss_x loss_x 1.2285 (1.1626) acc_x 68.7500 (71.5625) lr 8.8597e-05 eta 0:00:11
epoch [175/200] batch [15/33] time 0.532 (0.468) data 0.402 (0.337) loss_x loss_x 1.4385 (1.2674) acc_x 62.5000 (68.3333) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [20/33] time 0.403 (0.458) data 0.272 (0.327) loss_x loss_x 1.4893 (1.2583) acc_x 62.5000 (68.1250) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [25/33] time 0.468 (0.463) data 0.337 (0.333) loss_x loss_x 1.0928 (1.2277) acc_x 62.5000 (68.2500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [30/33] time 0.521 (0.468) data 0.391 (0.338) loss_x loss_x 1.5840 (1.2435) acc_x 62.5000 (67.5000) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.3386, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1062
clean true:1058
clean false:4
clean_rate:0.9962335216572504
noisy true:535
noisy false:1539
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 2074
epoch [176/200] batch [5/33] time 0.462 (0.497) data 0.331 (0.366) loss_x loss_x 1.3311 (1.0227) acc_x 68.7500 (71.2500) lr 8.2245e-05 eta 0:00:13
epoch [176/200] batch [10/33] time 0.475 (0.477) data 0.343 (0.346) loss_x loss_x 1.9775 (1.1149) acc_x 56.2500 (71.8750) lr 8.2245e-05 eta 0:00:10
epoch [176/200] batch [15/33] time 0.403 (0.474) data 0.272 (0.343) loss_x loss_x 1.4463 (1.2106) acc_x 62.5000 (68.9583) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [20/33] time 0.696 (0.496) data 0.565 (0.365) loss_x loss_x 1.2373 (1.1787) acc_x 62.5000 (69.6875) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [25/33] time 0.448 (0.497) data 0.318 (0.366) loss_x loss_x 1.5244 (1.1828) acc_x 59.3750 (70.3750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [30/33] time 0.399 (0.499) data 0.269 (0.369) loss_x loss_x 1.1094 (1.1581) acc_x 78.1250 (71.4583) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1517
confident_label rate tensor(0.3438, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1078
clean true:1075
clean false:3
clean_rate:0.9972170686456401
noisy true:544
noisy false:1514
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 2058
epoch [177/200] batch [5/33] time 0.466 (0.458) data 0.336 (0.327) loss_x loss_x 1.7686 (1.3725) acc_x 53.1250 (66.2500) lr 7.6120e-05 eta 0:00:12
epoch [177/200] batch [10/33] time 0.463 (0.461) data 0.332 (0.330) loss_x loss_x 1.2285 (1.2838) acc_x 75.0000 (70.6250) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [15/33] time 0.487 (0.472) data 0.357 (0.341) loss_x loss_x 0.7378 (1.2449) acc_x 78.1250 (71.8750) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [20/33] time 0.400 (0.455) data 0.269 (0.325) loss_x loss_x 1.0830 (1.2000) acc_x 71.8750 (72.5000) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [25/33] time 0.508 (0.461) data 0.377 (0.330) loss_x loss_x 1.4951 (1.1990) acc_x 68.7500 (72.5000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [30/33] time 0.446 (0.465) data 0.315 (0.334) loss_x loss_x 1.3369 (1.1936) acc_x 62.5000 (72.6042) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1569
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1073
clean true:1067
clean false:6
clean_rate:0.994408201304753
noisy true:500
noisy false:1563
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 2063
epoch [178/200] batch [5/33] time 0.545 (0.530) data 0.415 (0.400) loss_x loss_x 1.4336 (1.2051) acc_x 75.0000 (68.1250) lr 7.0224e-05 eta 0:00:14
epoch [178/200] batch [10/33] time 0.524 (0.508) data 0.393 (0.377) loss_x loss_x 1.2939 (1.2508) acc_x 71.8750 (69.0625) lr 7.0224e-05 eta 0:00:11
epoch [178/200] batch [15/33] time 0.442 (0.483) data 0.311 (0.352) loss_x loss_x 1.7744 (1.2861) acc_x 71.8750 (69.3750) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [20/33] time 0.354 (0.491) data 0.222 (0.360) loss_x loss_x 1.3848 (1.3023) acc_x 65.6250 (69.6875) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [25/33] time 0.375 (0.481) data 0.244 (0.350) loss_x loss_x 1.1113 (1.2883) acc_x 75.0000 (69.7500) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [30/33] time 0.423 (0.480) data 0.293 (0.349) loss_x loss_x 1.4814 (1.2547) acc_x 62.5000 (69.7917) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.3489, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1094
clean true:1093
clean false:1
clean_rate:0.9990859232175503
noisy true:513
noisy false:1529
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 2042
epoch [179/200] batch [5/34] time 0.419 (0.506) data 0.288 (0.375) loss_x loss_x 1.2490 (1.1604) acc_x 62.5000 (70.0000) lr 6.4556e-05 eta 0:00:14
epoch [179/200] batch [10/34] time 0.536 (0.499) data 0.404 (0.368) loss_x loss_x 1.1445 (1.2105) acc_x 68.7500 (66.5625) lr 6.4556e-05 eta 0:00:11
epoch [179/200] batch [15/34] time 0.440 (0.485) data 0.309 (0.354) loss_x loss_x 1.3115 (1.1835) acc_x 68.7500 (68.7500) lr 6.4556e-05 eta 0:00:09
epoch [179/200] batch [20/34] time 0.590 (0.490) data 0.459 (0.359) loss_x loss_x 0.6191 (1.1571) acc_x 96.8750 (71.2500) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [25/34] time 0.515 (0.490) data 0.384 (0.359) loss_x loss_x 0.8184 (1.1047) acc_x 81.2500 (72.6250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [30/34] time 0.460 (0.488) data 0.330 (0.357) loss_x loss_x 0.9287 (1.1171) acc_x 75.0000 (72.3958) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3233, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1014
clean true:1012
clean false:2
clean_rate:0.9980276134122288
noisy true:522
noisy false:1600
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 2122
epoch [180/200] batch [5/31] time 0.524 (0.472) data 0.394 (0.341) loss_x loss_x 0.9780 (1.2259) acc_x 71.8750 (68.1250) lr 5.9119e-05 eta 0:00:12
epoch [180/200] batch [10/31] time 0.442 (0.465) data 0.311 (0.333) loss_x loss_x 1.3418 (1.1559) acc_x 65.6250 (69.3750) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [15/31] time 0.541 (0.480) data 0.410 (0.349) loss_x loss_x 1.0957 (1.1534) acc_x 56.2500 (68.9583) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [20/31] time 0.471 (0.484) data 0.340 (0.353) loss_x loss_x 0.9863 (1.1964) acc_x 81.2500 (68.9062) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [25/31] time 0.540 (0.482) data 0.409 (0.351) loss_x loss_x 1.2158 (1.2011) acc_x 65.6250 (69.5000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/31] time 0.394 (0.479) data 0.262 (0.348) loss_x loss_x 1.4453 (1.2168) acc_x 65.6250 (68.8542) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.3399, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1066
clean true:1063
clean false:3
clean_rate:0.9971857410881801
noisy true:546
noisy false:1524
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 2070
epoch [181/200] batch [5/33] time 0.752 (0.577) data 0.621 (0.446) loss_x loss_x 1.2100 (1.1344) acc_x 62.5000 (66.8750) lr 5.3915e-05 eta 0:00:16
epoch [181/200] batch [10/33] time 0.484 (0.541) data 0.354 (0.410) loss_x loss_x 0.6279 (1.1707) acc_x 93.7500 (71.2500) lr 5.3915e-05 eta 0:00:12
epoch [181/200] batch [15/33] time 0.491 (0.522) data 0.361 (0.391) loss_x loss_x 1.4619 (1.2055) acc_x 62.5000 (70.6250) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [20/33] time 0.665 (0.520) data 0.534 (0.389) loss_x loss_x 1.3750 (1.1877) acc_x 65.6250 (70.6250) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [25/33] time 0.549 (0.521) data 0.417 (0.390) loss_x loss_x 1.6309 (1.1914) acc_x 65.6250 (71.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [30/33] time 0.502 (0.506) data 0.372 (0.375) loss_x loss_x 1.2393 (1.1595) acc_x 68.7500 (71.0417) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.3466, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1087
clean true:1082
clean false:5
clean_rate:0.9954001839926403
noisy true:527
noisy false:1522
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 2049
epoch [182/200] batch [5/33] time 0.512 (0.505) data 0.380 (0.374) loss_x loss_x 1.5547 (1.1562) acc_x 56.2500 (67.5000) lr 4.8943e-05 eta 0:00:14
epoch [182/200] batch [10/33] time 0.618 (0.508) data 0.488 (0.377) loss_x loss_x 1.8936 (1.2427) acc_x 53.1250 (67.8125) lr 4.8943e-05 eta 0:00:11
epoch [182/200] batch [15/33] time 0.496 (0.489) data 0.365 (0.358) loss_x loss_x 1.1055 (1.2434) acc_x 68.7500 (67.7083) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [20/33] time 0.442 (0.489) data 0.312 (0.358) loss_x loss_x 0.8872 (1.1927) acc_x 71.8750 (69.5312) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [25/33] time 0.425 (0.488) data 0.295 (0.357) loss_x loss_x 0.9282 (1.1960) acc_x 71.8750 (69.6250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [30/33] time 0.513 (0.486) data 0.382 (0.356) loss_x loss_x 1.1699 (1.2078) acc_x 59.3750 (68.8542) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1053
clean true:1046
clean false:7
clean_rate:0.99335232668566
noisy true:532
noisy false:1551
after delete: len(clean_dataset) 1053
after delete: len(noisy_dataset) 2083
epoch [183/200] batch [5/32] time 0.484 (0.449) data 0.354 (0.319) loss_x loss_x 1.3457 (1.1823) acc_x 65.6250 (68.7500) lr 4.4207e-05 eta 0:00:12
epoch [183/200] batch [10/32] time 0.480 (0.474) data 0.349 (0.343) loss_x loss_x 0.6064 (1.1279) acc_x 78.1250 (69.6875) lr 4.4207e-05 eta 0:00:10
epoch [183/200] batch [15/32] time 0.430 (0.481) data 0.299 (0.351) loss_x loss_x 1.4414 (1.1762) acc_x 65.6250 (69.3750) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [20/32] time 0.400 (0.481) data 0.269 (0.350) loss_x loss_x 1.3145 (1.1513) acc_x 65.6250 (69.6875) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [25/32] time 0.424 (0.478) data 0.294 (0.347) loss_x loss_x 1.0459 (1.1727) acc_x 78.1250 (70.1250) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [30/32] time 0.435 (0.476) data 0.304 (0.345) loss_x loss_x 1.2012 (1.2147) acc_x 75.0000 (69.4792) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1599
confident_label rate tensor(0.3189, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1000
clean true:993
clean false:7
clean_rate:0.993
noisy true:544
noisy false:1592
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 2136
epoch [184/200] batch [5/31] time 0.479 (0.476) data 0.348 (0.345) loss_x loss_x 1.2021 (1.1752) acc_x 78.1250 (70.6250) lr 3.9706e-05 eta 0:00:12
epoch [184/200] batch [10/31] time 0.536 (0.460) data 0.406 (0.329) loss_x loss_x 1.0498 (1.1419) acc_x 71.8750 (70.0000) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [15/31] time 0.430 (0.462) data 0.300 (0.332) loss_x loss_x 1.7539 (1.1267) acc_x 62.5000 (71.0417) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [20/31] time 0.398 (0.458) data 0.267 (0.328) loss_x loss_x 1.7598 (1.1878) acc_x 62.5000 (70.3125) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [25/31] time 0.608 (0.462) data 0.477 (0.331) loss_x loss_x 1.3721 (1.1786) acc_x 56.2500 (69.2500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/31] time 0.372 (0.457) data 0.242 (0.327) loss_x loss_x 1.4795 (1.1915) acc_x 59.3750 (69.1667) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1535
confident_label rate tensor(0.3361, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1054
clean true:1050
clean false:4
clean_rate:0.9962049335863378
noisy true:551
noisy false:1531
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 2082
epoch [185/200] batch [5/32] time 0.431 (0.447) data 0.301 (0.316) loss_x loss_x 0.8979 (1.2198) acc_x 78.1250 (71.8750) lr 3.5443e-05 eta 0:00:12
epoch [185/200] batch [10/32] time 0.563 (0.478) data 0.433 (0.347) loss_x loss_x 1.2686 (1.3216) acc_x 68.7500 (67.8125) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [15/32] time 0.704 (0.494) data 0.574 (0.363) loss_x loss_x 1.2910 (1.3001) acc_x 75.0000 (68.5417) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [20/32] time 0.432 (0.493) data 0.302 (0.363) loss_x loss_x 1.1729 (1.2465) acc_x 65.6250 (69.8438) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [25/32] time 0.407 (0.481) data 0.277 (0.350) loss_x loss_x 1.2344 (1.1991) acc_x 75.0000 (71.0000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [30/32] time 0.690 (0.493) data 0.560 (0.362) loss_x loss_x 1.0967 (1.1776) acc_x 65.6250 (71.0417) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1539
confident_label rate tensor(0.3393, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1064
clean true:1059
clean false:5
clean_rate:0.9953007518796992
noisy true:538
noisy false:1534
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 2072
epoch [186/200] batch [5/33] time 0.493 (0.535) data 0.362 (0.404) loss_x loss_x 0.9097 (0.9928) acc_x 84.3750 (75.6250) lr 3.1417e-05 eta 0:00:14
epoch [186/200] batch [10/33] time 0.483 (0.516) data 0.352 (0.385) loss_x loss_x 1.2695 (1.1150) acc_x 62.5000 (72.1875) lr 3.1417e-05 eta 0:00:11
epoch [186/200] batch [15/33] time 0.389 (0.507) data 0.258 (0.376) loss_x loss_x 0.9556 (1.1659) acc_x 75.0000 (71.6667) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [20/33] time 0.482 (0.499) data 0.352 (0.368) loss_x loss_x 0.7246 (1.1760) acc_x 81.2500 (71.7188) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [25/33] time 0.442 (0.505) data 0.311 (0.374) loss_x loss_x 0.8213 (1.1549) acc_x 75.0000 (71.7500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [30/33] time 0.402 (0.496) data 0.272 (0.365) loss_x loss_x 1.2920 (1.1891) acc_x 78.1250 (71.2500) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1578
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1033
clean true:1030
clean false:3
clean_rate:0.9970958373668926
noisy true:528
noisy false:1575
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 2103
epoch [187/200] batch [5/32] time 0.708 (0.508) data 0.577 (0.377) loss_x loss_x 0.5835 (1.0426) acc_x 90.6250 (78.1250) lr 2.7630e-05 eta 0:00:13
epoch [187/200] batch [10/32] time 0.509 (0.477) data 0.380 (0.346) loss_x loss_x 1.0508 (1.1734) acc_x 78.1250 (73.7500) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [15/32] time 0.468 (0.493) data 0.338 (0.362) loss_x loss_x 0.8838 (1.0786) acc_x 68.7500 (73.9583) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [20/32] time 0.359 (0.487) data 0.228 (0.356) loss_x loss_x 1.4893 (1.1287) acc_x 53.1250 (71.5625) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [25/32] time 0.626 (0.489) data 0.495 (0.358) loss_x loss_x 0.9019 (1.1247) acc_x 71.8750 (71.8750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [30/32] time 0.508 (0.494) data 0.378 (0.363) loss_x loss_x 1.1289 (1.1215) acc_x 81.2500 (72.2917) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1079
clean true:1076
clean false:3
clean_rate:0.9972196478220574
noisy true:517
noisy false:1540
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 2057
epoch [188/200] batch [5/33] time 0.404 (0.448) data 0.273 (0.317) loss_x loss_x 1.2402 (1.1678) acc_x 65.6250 (71.2500) lr 2.4083e-05 eta 0:00:12
epoch [188/200] batch [10/33] time 0.408 (0.466) data 0.277 (0.335) loss_x loss_x 1.2354 (1.2324) acc_x 68.7500 (69.6875) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [15/33] time 0.399 (0.453) data 0.268 (0.322) loss_x loss_x 1.0605 (1.2206) acc_x 75.0000 (69.5833) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [20/33] time 0.399 (0.473) data 0.269 (0.342) loss_x loss_x 1.3096 (1.2536) acc_x 71.8750 (68.5938) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [25/33] time 0.560 (0.469) data 0.429 (0.339) loss_x loss_x 1.2803 (1.2371) acc_x 65.6250 (68.8750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [30/33] time 0.498 (0.476) data 0.366 (0.346) loss_x loss_x 1.0479 (1.2243) acc_x 68.7500 (69.0625) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1548
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1075
clean true:1073
clean false:2
clean_rate:0.998139534883721
noisy true:515
noisy false:1546
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 2061
epoch [189/200] batch [5/33] time 0.462 (0.461) data 0.330 (0.330) loss_x loss_x 1.1602 (1.0907) acc_x 71.8750 (69.3750) lr 2.0777e-05 eta 0:00:12
epoch [189/200] batch [10/33] time 0.493 (0.479) data 0.362 (0.348) loss_x loss_x 1.2959 (1.2108) acc_x 71.8750 (68.1250) lr 2.0777e-05 eta 0:00:11
epoch [189/200] batch [15/33] time 0.462 (0.475) data 0.331 (0.344) loss_x loss_x 0.8169 (1.2097) acc_x 78.1250 (68.1250) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [20/33] time 0.493 (0.494) data 0.362 (0.363) loss_x loss_x 1.5332 (1.1827) acc_x 68.7500 (69.6875) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [25/33] time 0.596 (0.487) data 0.465 (0.356) loss_x loss_x 1.3330 (1.1887) acc_x 68.7500 (69.6250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [30/33] time 0.414 (0.479) data 0.284 (0.348) loss_x loss_x 1.6094 (1.1985) acc_x 62.5000 (69.6875) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1050
clean false:7
clean_rate:0.9933774834437086
noisy true:519
noisy false:1560
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [190/200] batch [5/33] time 0.338 (0.418) data 0.206 (0.287) loss_x loss_x 0.9692 (1.1140) acc_x 78.1250 (72.5000) lr 1.7713e-05 eta 0:00:11
epoch [190/200] batch [10/33] time 0.431 (0.437) data 0.301 (0.306) loss_x loss_x 1.5039 (1.2471) acc_x 62.5000 (70.6250) lr 1.7713e-05 eta 0:00:10
epoch [190/200] batch [15/33] time 0.499 (0.450) data 0.368 (0.319) loss_x loss_x 1.2324 (1.2716) acc_x 68.7500 (70.0000) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [20/33] time 0.433 (0.448) data 0.302 (0.318) loss_x loss_x 0.6836 (1.2251) acc_x 84.3750 (70.6250) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [25/33] time 0.407 (0.446) data 0.277 (0.315) loss_x loss_x 1.0469 (1.2206) acc_x 78.1250 (71.5000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [30/33] time 0.475 (0.456) data 0.344 (0.326) loss_x loss_x 1.1660 (1.2603) acc_x 56.2500 (69.4792) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1574
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1050
clean true:1048
clean false:2
clean_rate:0.9980952380952381
noisy true:514
noisy false:1572
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 2086
epoch [191/200] batch [5/32] time 0.385 (0.467) data 0.255 (0.336) loss_x loss_x 1.4629 (1.4264) acc_x 62.5000 (62.5000) lr 1.4891e-05 eta 0:00:12
epoch [191/200] batch [10/32] time 0.424 (0.479) data 0.293 (0.348) loss_x loss_x 1.4463 (1.4598) acc_x 68.7500 (63.1250) lr 1.4891e-05 eta 0:00:10
epoch [191/200] batch [15/32] time 0.444 (0.481) data 0.313 (0.351) loss_x loss_x 1.1113 (1.3420) acc_x 65.6250 (65.6250) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [20/32] time 0.748 (0.485) data 0.617 (0.354) loss_x loss_x 1.2305 (1.2895) acc_x 71.8750 (67.5000) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [25/32] time 0.416 (0.478) data 0.285 (0.348) loss_x loss_x 1.2969 (1.2415) acc_x 81.2500 (68.6250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [30/32] time 0.531 (0.481) data 0.401 (0.351) loss_x loss_x 1.6377 (1.2553) acc_x 53.1250 (68.5417) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1082
clean true:1080
clean false:2
clean_rate:0.9981515711645101
noisy true:502
noisy false:1552
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 2054
epoch [192/200] batch [5/33] time 0.407 (0.471) data 0.276 (0.340) loss_x loss_x 1.4766 (1.2904) acc_x 62.5000 (68.1250) lr 1.2312e-05 eta 0:00:13
epoch [192/200] batch [10/33] time 0.406 (0.453) data 0.275 (0.322) loss_x loss_x 1.9131 (1.3747) acc_x 62.5000 (68.4375) lr 1.2312e-05 eta 0:00:10
epoch [192/200] batch [15/33] time 0.534 (0.472) data 0.403 (0.342) loss_x loss_x 1.4248 (1.3337) acc_x 68.7500 (68.9583) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [20/33] time 0.479 (0.483) data 0.349 (0.352) loss_x loss_x 1.5391 (1.3388) acc_x 59.3750 (68.1250) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [25/33] time 0.349 (0.478) data 0.219 (0.347) loss_x loss_x 1.2715 (1.2992) acc_x 71.8750 (69.1250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [30/33] time 0.520 (0.482) data 0.389 (0.351) loss_x loss_x 1.0371 (1.2808) acc_x 78.1250 (69.2708) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1600
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1033
clean true:1030
clean false:3
clean_rate:0.9970958373668926
noisy true:506
noisy false:1597
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 2103
epoch [193/200] batch [5/32] time 0.573 (0.490) data 0.441 (0.358) loss_x loss_x 0.8413 (1.1440) acc_x 84.3750 (74.3750) lr 9.9763e-06 eta 0:00:13
epoch [193/200] batch [10/32] time 0.545 (0.500) data 0.414 (0.369) loss_x loss_x 1.0703 (1.0967) acc_x 71.8750 (75.3125) lr 9.9763e-06 eta 0:00:11
epoch [193/200] batch [15/32] time 0.618 (0.502) data 0.487 (0.370) loss_x loss_x 1.0928 (1.1832) acc_x 75.0000 (73.7500) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [20/32] time 0.392 (0.501) data 0.262 (0.370) loss_x loss_x 1.4658 (1.1408) acc_x 68.7500 (73.5938) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [25/32] time 0.428 (0.489) data 0.298 (0.358) loss_x loss_x 1.3018 (1.1507) acc_x 71.8750 (73.2500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [30/32] time 0.508 (0.488) data 0.378 (0.357) loss_x loss_x 1.0703 (1.1801) acc_x 75.0000 (72.1875) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1561
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1052
clean false:5
clean_rate:0.9952696310312205
noisy true:523
noisy false:1556
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [194/200] batch [5/33] time 0.359 (0.437) data 0.229 (0.307) loss_x loss_x 1.3320 (1.1827) acc_x 62.5000 (70.0000) lr 7.8853e-06 eta 0:00:12
epoch [194/200] batch [10/33] time 0.354 (0.437) data 0.223 (0.306) loss_x loss_x 1.7393 (1.1758) acc_x 62.5000 (70.9375) lr 7.8853e-06 eta 0:00:10
epoch [194/200] batch [15/33] time 0.385 (0.437) data 0.255 (0.306) loss_x loss_x 0.9829 (1.1630) acc_x 78.1250 (70.6250) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [20/33] time 0.385 (0.438) data 0.255 (0.307) loss_x loss_x 0.9380 (1.1314) acc_x 81.2500 (72.5000) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [25/33] time 0.517 (0.440) data 0.387 (0.310) loss_x loss_x 1.0469 (1.1473) acc_x 71.8750 (71.7500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [30/33] time 0.431 (0.450) data 0.301 (0.319) loss_x loss_x 1.2607 (1.1591) acc_x 68.7500 (71.6667) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1552
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1055
clean true:1051
clean false:4
clean_rate:0.9962085308056872
noisy true:533
noisy false:1548
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 2081
epoch [195/200] batch [5/32] time 0.436 (0.464) data 0.304 (0.332) loss_x loss_x 1.1211 (1.3496) acc_x 78.1250 (67.5000) lr 6.0390e-06 eta 0:00:12
epoch [195/200] batch [10/32] time 0.409 (0.457) data 0.277 (0.326) loss_x loss_x 0.9961 (1.2217) acc_x 65.6250 (67.8125) lr 6.0390e-06 eta 0:00:10
epoch [195/200] batch [15/32] time 0.427 (0.461) data 0.296 (0.330) loss_x loss_x 1.7002 (1.2706) acc_x 62.5000 (67.5000) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [20/32] time 0.409 (0.457) data 0.278 (0.326) loss_x loss_x 0.9053 (1.2401) acc_x 78.1250 (69.0625) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [25/32] time 0.449 (0.471) data 0.318 (0.340) loss_x loss_x 1.2910 (1.2818) acc_x 59.3750 (68.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [30/32] time 0.420 (0.467) data 0.289 (0.336) loss_x loss_x 0.8901 (1.2676) acc_x 81.2500 (69.0625) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.3313, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1039
clean true:1037
clean false:2
clean_rate:0.9980750721847931
noisy true:523
noisy false:1574
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 2097
epoch [196/200] batch [5/32] time 0.501 (0.500) data 0.371 (0.369) loss_x loss_x 1.0078 (0.9735) acc_x 81.2500 (76.2500) lr 4.4380e-06 eta 0:00:13
epoch [196/200] batch [10/32] time 0.495 (0.503) data 0.364 (0.372) loss_x loss_x 0.8970 (1.0886) acc_x 78.1250 (72.1875) lr 4.4380e-06 eta 0:00:11
epoch [196/200] batch [15/32] time 0.440 (0.507) data 0.309 (0.377) loss_x loss_x 1.3076 (1.1374) acc_x 71.8750 (71.8750) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [20/32] time 0.564 (0.512) data 0.433 (0.381) loss_x loss_x 1.4854 (1.1669) acc_x 65.6250 (71.4062) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [25/32] time 0.477 (0.506) data 0.346 (0.375) loss_x loss_x 0.9937 (1.1322) acc_x 68.7500 (71.3750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [30/32] time 0.496 (0.498) data 0.365 (0.367) loss_x loss_x 1.3447 (1.1462) acc_x 65.6250 (71.0417) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1561
confident_label rate tensor(0.3361, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1054
clean true:1050
clean false:4
clean_rate:0.9962049335863378
noisy true:525
noisy false:1557
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 2082
epoch [197/200] batch [5/32] time 0.456 (0.510) data 0.325 (0.379) loss_x loss_x 0.8203 (1.2510) acc_x 81.2500 (69.3750) lr 3.0827e-06 eta 0:00:13
epoch [197/200] batch [10/32] time 0.494 (0.471) data 0.364 (0.340) loss_x loss_x 0.9707 (1.2060) acc_x 75.0000 (70.9375) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [15/32] time 0.547 (0.475) data 0.416 (0.344) loss_x loss_x 1.1514 (1.1515) acc_x 75.0000 (72.2917) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [20/32] time 0.498 (0.475) data 0.368 (0.344) loss_x loss_x 1.1523 (1.1450) acc_x 68.7500 (71.4062) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [25/32] time 0.408 (0.481) data 0.277 (0.350) loss_x loss_x 1.5547 (1.1699) acc_x 68.7500 (70.6250) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [30/32] time 0.441 (0.477) data 0.310 (0.346) loss_x loss_x 1.2480 (1.1916) acc_x 75.0000 (70.1042) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1532
confident_label rate tensor(0.3479, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1091
clean true:1085
clean false:6
clean_rate:0.9945004582951421
noisy true:519
noisy false:1526
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 2045
epoch [198/200] batch [5/34] time 0.475 (0.458) data 0.345 (0.328) loss_x loss_x 0.9678 (1.0765) acc_x 75.0000 (72.5000) lr 1.9733e-06 eta 0:00:13
epoch [198/200] batch [10/34] time 0.426 (0.468) data 0.294 (0.337) loss_x loss_x 1.0107 (1.1577) acc_x 75.0000 (70.3125) lr 1.9733e-06 eta 0:00:11
epoch [198/200] batch [15/34] time 0.495 (0.482) data 0.364 (0.351) loss_x loss_x 1.1123 (1.2272) acc_x 75.0000 (69.7917) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [20/34] time 0.490 (0.471) data 0.359 (0.341) loss_x loss_x 1.6074 (1.2282) acc_x 62.5000 (69.5312) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [25/34] time 0.574 (0.480) data 0.443 (0.349) loss_x loss_x 1.5215 (1.2314) acc_x 56.2500 (69.5000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [30/34] time 0.617 (0.484) data 0.487 (0.354) loss_x loss_x 0.7729 (1.2075) acc_x 81.2500 (69.7917) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1574
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1033
clean true:1027
clean false:6
clean_rate:0.9941916747337851
noisy true:535
noisy false:1568
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 2103
epoch [199/200] batch [5/32] time 0.609 (0.541) data 0.477 (0.410) loss_x loss_x 1.1611 (1.1635) acc_x 65.6250 (71.8750) lr 1.1101e-06 eta 0:00:14
epoch [199/200] batch [10/32] time 0.402 (0.500) data 0.272 (0.369) loss_x loss_x 0.8608 (1.0560) acc_x 81.2500 (76.5625) lr 1.1101e-06 eta 0:00:10
epoch [199/200] batch [15/32] time 0.520 (0.488) data 0.389 (0.357) loss_x loss_x 1.4473 (1.0750) acc_x 59.3750 (75.8333) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [20/32] time 0.406 (0.490) data 0.274 (0.359) loss_x loss_x 1.0654 (1.0922) acc_x 68.7500 (74.2188) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [25/32] time 0.458 (0.479) data 0.326 (0.348) loss_x loss_x 0.9771 (1.0874) acc_x 75.0000 (74.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [30/32] time 0.405 (0.480) data 0.274 (0.349) loss_x loss_x 0.8960 (1.0838) acc_x 71.8750 (73.4375) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1548
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1042
clean true:1039
clean false:3
clean_rate:0.9971209213051824
noisy true:549
noisy false:1545
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 2094
epoch [200/200] batch [5/32] time 0.801 (0.566) data 0.672 (0.436) loss_x loss_x 0.9585 (1.1729) acc_x 71.8750 (67.5000) lr 4.9344e-07 eta 0:00:15
epoch [200/200] batch [10/32] time 0.409 (0.531) data 0.278 (0.401) loss_x loss_x 1.4766 (1.2340) acc_x 50.0000 (66.2500) lr 4.9344e-07 eta 0:00:11
epoch [200/200] batch [15/32] time 0.449 (0.505) data 0.318 (0.374) loss_x loss_x 1.5771 (1.2393) acc_x 56.2500 (67.9167) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [20/32] time 0.496 (0.503) data 0.366 (0.372) loss_x loss_x 0.7749 (1.1721) acc_x 84.3750 (69.8438) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [25/32] time 0.534 (0.499) data 0.402 (0.368) loss_x loss_x 1.1719 (1.1185) acc_x 68.7500 (70.8750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [30/32] time 0.408 (0.491) data 0.278 (0.360) loss_x loss_x 0.7354 (1.1587) acc_x 71.8750 (69.7917) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,157
* accuracy: 64.1%
* error: 35.9%
* macro_f1: 62.4%
Elapsed: 3:17:46
