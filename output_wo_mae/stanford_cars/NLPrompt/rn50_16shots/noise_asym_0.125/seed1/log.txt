***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1620, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 508
clean true:498
clean false:10
clean_rate:0.9803149606299213
noisy true:67
noisy false:2561
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 2628
epoch [1/200] batch [5/15] time 0.449 (0.491) data 0.319 (0.333) loss_x loss_x 3.2031 (3.0574) acc_x 31.2500 (33.7500) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [10/15] time 0.438 (0.465) data 0.308 (0.321) loss_x loss_x 2.2949 (2.8857) acc_x 46.8750 (38.4375) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [15/15] time 0.588 (0.478) data 0.458 (0.338) loss_x loss_x 2.7246 (2.7076) acc_x 40.6250 (42.0833) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2312
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:723
clean false:12
clean_rate:0.9836734693877551
noisy true:101
noisy false:2300
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [2/200] batch [5/22] time 0.442 (0.459) data 0.311 (0.329) loss_x loss_x 1.3594 (1.7479) acc_x 62.5000 (52.5000) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [10/22] time 0.506 (0.505) data 0.373 (0.374) loss_x loss_x 2.1074 (1.9299) acc_x 53.1250 (48.4375) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [15/22] time 0.434 (0.480) data 0.304 (0.349) loss_x loss_x 1.3574 (1.8381) acc_x 62.5000 (51.8750) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/22] time 0.420 (0.466) data 0.290 (0.335) loss_x loss_x 1.9854 (1.8218) acc_x 40.6250 (51.4062) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1928
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1072
clean true:1058
clean false:14
clean_rate:0.9869402985074627
noisy true:150
noisy false:1914
after delete: len(clean_dataset) 1072
after delete: len(noisy_dataset) 2064
epoch [3/200] batch [5/33] time 0.504 (0.496) data 0.373 (0.365) loss_x loss_x 1.4941 (1.5695) acc_x 65.6250 (56.2500) lr 1.9999e-03 eta 0:00:13
epoch [3/200] batch [10/33] time 0.438 (0.520) data 0.308 (0.389) loss_x loss_x 1.6631 (1.5699) acc_x 62.5000 (58.1250) lr 1.9999e-03 eta 0:00:11
epoch [3/200] batch [15/33] time 0.489 (0.510) data 0.358 (0.379) loss_x loss_x 1.9609 (1.5874) acc_x 43.7500 (57.2917) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [20/33] time 0.384 (0.489) data 0.254 (0.358) loss_x loss_x 1.7207 (1.6837) acc_x 53.1250 (55.4688) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [25/33] time 0.432 (0.477) data 0.300 (0.346) loss_x loss_x 1.3301 (1.6195) acc_x 53.1250 (57.5000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [30/33] time 0.410 (0.485) data 0.279 (0.354) loss_x loss_x 1.8594 (1.6205) acc_x 62.5000 (57.6042) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1887
confident_label rate tensor(0.3555, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1115
clean true:1096
clean false:19
clean_rate:0.9829596412556054
noisy true:153
noisy false:1868
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 2021
epoch [4/200] batch [5/34] time 0.427 (0.465) data 0.296 (0.335) loss_x loss_x 1.4219 (1.6164) acc_x 62.5000 (57.5000) lr 1.9995e-03 eta 0:00:13
epoch [4/200] batch [10/34] time 0.533 (0.441) data 0.402 (0.310) loss_x loss_x 1.9971 (1.6551) acc_x 53.1250 (57.5000) lr 1.9995e-03 eta 0:00:10
epoch [4/200] batch [15/34] time 0.357 (0.448) data 0.226 (0.317) loss_x loss_x 1.5508 (1.6755) acc_x 56.2500 (56.0417) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [20/34] time 0.397 (0.455) data 0.267 (0.324) loss_x loss_x 1.7920 (1.6734) acc_x 56.2500 (55.0000) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [25/34] time 0.448 (0.452) data 0.317 (0.322) loss_x loss_x 1.7988 (1.7079) acc_x 50.0000 (54.0000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [30/34] time 0.569 (0.450) data 0.438 (0.320) loss_x loss_x 1.4785 (1.6985) acc_x 50.0000 (53.7500) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1880
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1120
clean true:1105
clean false:15
clean_rate:0.9866071428571429
noisy true:151
noisy false:1865
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 2016
epoch [5/200] batch [5/35] time 0.380 (0.463) data 0.248 (0.332) loss_x loss_x 1.9502 (1.6889) acc_x 50.0000 (56.2500) lr 1.9989e-03 eta 0:00:13
epoch [5/200] batch [10/35] time 0.329 (0.465) data 0.198 (0.334) loss_x loss_x 1.6328 (1.6442) acc_x 59.3750 (56.5625) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [15/35] time 0.514 (0.476) data 0.382 (0.345) loss_x loss_x 1.4697 (1.6479) acc_x 53.1250 (55.2083) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [20/35] time 0.403 (0.474) data 0.271 (0.343) loss_x loss_x 2.0527 (1.6280) acc_x 43.7500 (55.3125) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [25/35] time 0.394 (0.482) data 0.262 (0.350) loss_x loss_x 1.5967 (1.5814) acc_x 56.2500 (57.5000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [30/35] time 0.328 (0.469) data 0.197 (0.338) loss_x loss_x 1.7578 (1.5773) acc_x 43.7500 (57.6042) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [35/35] time 0.436 (0.465) data 0.305 (0.334) loss_x loss_x 1.0771 (1.5431) acc_x 68.7500 (58.6607) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1854
confident_label rate tensor(0.3689, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1157
clean true:1139
clean false:18
clean_rate:0.9844425237683665
noisy true:143
noisy false:1836
after delete: len(clean_dataset) 1157
after delete: len(noisy_dataset) 1979
epoch [6/200] batch [5/36] time 0.525 (0.421) data 0.394 (0.290) loss_x loss_x 1.8975 (1.6428) acc_x 50.0000 (59.3750) lr 1.9980e-03 eta 0:00:13
epoch [6/200] batch [10/36] time 0.431 (0.479) data 0.301 (0.348) loss_x loss_x 1.2930 (1.4528) acc_x 62.5000 (61.5625) lr 1.9980e-03 eta 0:00:12
epoch [6/200] batch [15/36] time 0.460 (0.474) data 0.329 (0.343) loss_x loss_x 1.3516 (1.5033) acc_x 56.2500 (59.5833) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [20/36] time 0.476 (0.467) data 0.345 (0.336) loss_x loss_x 1.3887 (1.4980) acc_x 65.6250 (59.6875) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [25/36] time 0.399 (0.475) data 0.268 (0.344) loss_x loss_x 2.0586 (1.5146) acc_x 53.1250 (59.2500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [30/36] time 0.501 (0.474) data 0.370 (0.344) loss_x loss_x 1.5664 (1.5414) acc_x 46.8750 (58.3333) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [35/36] time 0.434 (0.473) data 0.303 (0.342) loss_x loss_x 1.1865 (1.5087) acc_x 65.6250 (59.0179) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1849
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1145
clean true:1131
clean false:14
clean_rate:0.9877729257641922
noisy true:156
noisy false:1835
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 1991
epoch [7/200] batch [5/35] time 0.496 (0.479) data 0.365 (0.348) loss_x loss_x 1.0996 (1.4084) acc_x 68.7500 (64.3750) lr 1.9969e-03 eta 0:00:14
epoch [7/200] batch [10/35] time 0.443 (0.473) data 0.313 (0.342) loss_x loss_x 0.7056 (1.4166) acc_x 87.5000 (63.1250) lr 1.9969e-03 eta 0:00:11
epoch [7/200] batch [15/35] time 0.405 (0.478) data 0.274 (0.348) loss_x loss_x 1.7100 (1.4392) acc_x 43.7500 (61.6667) lr 1.9969e-03 eta 0:00:09
epoch [7/200] batch [20/35] time 0.438 (0.470) data 0.309 (0.339) loss_x loss_x 1.3311 (1.4666) acc_x 59.3750 (60.7812) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [25/35] time 0.566 (0.479) data 0.436 (0.348) loss_x loss_x 1.8389 (1.5662) acc_x 50.0000 (59.0000) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [30/35] time 0.435 (0.476) data 0.305 (0.345) loss_x loss_x 1.2900 (1.5725) acc_x 59.3750 (58.9583) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [35/35] time 0.560 (0.474) data 0.429 (0.344) loss_x loss_x 1.5137 (1.5625) acc_x 50.0000 (58.7500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1848
confident_label rate tensor(0.3677, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1153
clean true:1140
clean false:13
clean_rate:0.9887250650477016
noisy true:148
noisy false:1835
after delete: len(clean_dataset) 1153
after delete: len(noisy_dataset) 1983
epoch [8/200] batch [5/36] time 0.472 (0.512) data 0.340 (0.381) loss_x loss_x 1.7324 (1.7582) acc_x 53.1250 (52.5000) lr 1.9956e-03 eta 0:00:15
epoch [8/200] batch [10/36] time 0.699 (0.517) data 0.567 (0.385) loss_x loss_x 1.8428 (1.6824) acc_x 56.2500 (55.3125) lr 1.9956e-03 eta 0:00:13
epoch [8/200] batch [15/36] time 0.491 (0.510) data 0.359 (0.378) loss_x loss_x 1.5537 (1.6102) acc_x 56.2500 (57.2917) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [20/36] time 0.564 (0.502) data 0.434 (0.371) loss_x loss_x 1.3213 (1.6499) acc_x 65.6250 (56.5625) lr 1.9956e-03 eta 0:00:08
epoch [8/200] batch [25/36] time 0.467 (0.500) data 0.336 (0.369) loss_x loss_x 1.1289 (1.5856) acc_x 65.6250 (57.5000) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [30/36] time 0.450 (0.497) data 0.319 (0.366) loss_x loss_x 1.2393 (1.5561) acc_x 53.1250 (57.1875) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [35/36] time 0.400 (0.496) data 0.269 (0.365) loss_x loss_x 1.5742 (1.5430) acc_x 59.3750 (58.3929) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1804
confident_label rate tensor(0.3782, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1186
clean true:1178
clean false:8
clean_rate:0.9932546374367622
noisy true:154
noisy false:1796
after delete: len(clean_dataset) 1186
after delete: len(noisy_dataset) 1950
epoch [9/200] batch [5/37] time 0.387 (0.438) data 0.255 (0.306) loss_x loss_x 1.5254 (1.6961) acc_x 53.1250 (57.5000) lr 1.9940e-03 eta 0:00:14
epoch [9/200] batch [10/37] time 0.367 (0.455) data 0.237 (0.323) loss_x loss_x 1.7568 (1.6068) acc_x 53.1250 (58.7500) lr 1.9940e-03 eta 0:00:12
epoch [9/200] batch [15/37] time 0.423 (0.470) data 0.292 (0.339) loss_x loss_x 1.7129 (1.5902) acc_x 59.3750 (58.9583) lr 1.9940e-03 eta 0:00:10
epoch [9/200] batch [20/37] time 0.563 (0.468) data 0.433 (0.337) loss_x loss_x 1.3799 (1.5899) acc_x 71.8750 (59.5312) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [25/37] time 0.438 (0.462) data 0.308 (0.331) loss_x loss_x 1.8213 (1.5537) acc_x 59.3750 (60.2500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [30/37] time 0.384 (0.460) data 0.253 (0.329) loss_x loss_x 1.1191 (1.5394) acc_x 65.6250 (60.4167) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [35/37] time 0.525 (0.469) data 0.394 (0.338) loss_x loss_x 1.5410 (1.5264) acc_x 71.8750 (60.3571) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.3903, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1224
clean true:1203
clean false:21
clean_rate:0.9828431372549019
noisy true:147
noisy false:1765
after delete: len(clean_dataset) 1224
after delete: len(noisy_dataset) 1912
epoch [10/200] batch [5/38] time 0.536 (0.452) data 0.405 (0.320) loss_x loss_x 1.6885 (1.6846) acc_x 56.2500 (52.5000) lr 1.9921e-03 eta 0:00:14
epoch [10/200] batch [10/38] time 0.387 (0.451) data 0.256 (0.320) loss_x loss_x 1.5059 (1.5838) acc_x 68.7500 (59.6875) lr 1.9921e-03 eta 0:00:12
epoch [10/200] batch [15/38] time 0.370 (0.451) data 0.239 (0.320) loss_x loss_x 1.2539 (1.5337) acc_x 59.3750 (60.0000) lr 1.9921e-03 eta 0:00:10
epoch [10/200] batch [20/38] time 0.534 (0.445) data 0.403 (0.313) loss_x loss_x 1.7637 (1.5588) acc_x 43.7500 (58.1250) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [25/38] time 0.492 (0.456) data 0.361 (0.324) loss_x loss_x 1.2930 (1.5415) acc_x 62.5000 (58.7500) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [30/38] time 0.466 (0.469) data 0.334 (0.338) loss_x loss_x 1.3545 (1.5389) acc_x 65.6250 (58.8542) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [35/38] time 0.451 (0.464) data 0.319 (0.333) loss_x loss_x 2.2227 (1.5349) acc_x 43.7500 (59.1964) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1793
confident_label rate tensor(0.3804, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1193
clean true:1182
clean false:11
clean_rate:0.9907795473595976
noisy true:161
noisy false:1782
after delete: len(clean_dataset) 1193
after delete: len(noisy_dataset) 1943
epoch [11/200] batch [5/37] time 0.377 (0.436) data 0.246 (0.305) loss_x loss_x 1.5537 (1.6889) acc_x 50.0000 (55.6250) lr 1.9900e-03 eta 0:00:13
epoch [11/200] batch [10/37] time 0.412 (0.465) data 0.282 (0.334) loss_x loss_x 1.4443 (1.6204) acc_x 56.2500 (57.1875) lr 1.9900e-03 eta 0:00:12
epoch [11/200] batch [15/37] time 0.453 (0.486) data 0.323 (0.355) loss_x loss_x 1.5039 (1.6417) acc_x 65.6250 (57.0833) lr 1.9900e-03 eta 0:00:10
epoch [11/200] batch [20/37] time 0.410 (0.485) data 0.280 (0.354) loss_x loss_x 1.1543 (1.6268) acc_x 65.6250 (57.1875) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [25/37] time 0.540 (0.482) data 0.403 (0.351) loss_x loss_x 1.3076 (1.6008) acc_x 68.7500 (57.7500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [30/37] time 0.539 (0.484) data 0.408 (0.353) loss_x loss_x 1.7939 (1.5960) acc_x 56.2500 (57.6042) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [35/37] time 0.443 (0.479) data 0.312 (0.348) loss_x loss_x 1.5479 (1.5942) acc_x 53.1250 (57.9464) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1808
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1201
clean true:1182
clean false:19
clean_rate:0.984179850124896
noisy true:146
noisy false:1789
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 1935
epoch [12/200] batch [5/37] time 0.392 (0.485) data 0.261 (0.354) loss_x loss_x 1.3994 (1.4086) acc_x 59.3750 (60.6250) lr 1.9877e-03 eta 0:00:15
epoch [12/200] batch [10/37] time 0.463 (0.464) data 0.332 (0.333) loss_x loss_x 1.6982 (1.5201) acc_x 56.2500 (59.0625) lr 1.9877e-03 eta 0:00:12
epoch [12/200] batch [15/37] time 0.451 (0.448) data 0.320 (0.317) loss_x loss_x 1.0986 (1.5541) acc_x 65.6250 (58.3333) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [20/37] time 0.514 (0.471) data 0.382 (0.340) loss_x loss_x 1.5098 (1.5741) acc_x 59.3750 (58.9062) lr 1.9877e-03 eta 0:00:08
epoch [12/200] batch [25/37] time 0.525 (0.477) data 0.394 (0.346) loss_x loss_x 1.6025 (1.5988) acc_x 53.1250 (58.3750) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [30/37] time 0.575 (0.477) data 0.444 (0.346) loss_x loss_x 1.0469 (1.5279) acc_x 78.1250 (59.8958) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [35/37] time 0.416 (0.465) data 0.285 (0.334) loss_x loss_x 2.0879 (1.5669) acc_x 43.7500 (58.5714) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1242
clean true:1232
clean false:10
clean_rate:0.9919484702093397
noisy true:157
noisy false:1737
after delete: len(clean_dataset) 1242
after delete: len(noisy_dataset) 1894
epoch [13/200] batch [5/38] time 0.421 (0.515) data 0.290 (0.384) loss_x loss_x 1.1934 (1.4670) acc_x 59.3750 (63.7500) lr 1.9851e-03 eta 0:00:17
epoch [13/200] batch [10/38] time 0.435 (0.492) data 0.305 (0.361) loss_x loss_x 1.4150 (1.4087) acc_x 71.8750 (64.6875) lr 1.9851e-03 eta 0:00:13
epoch [13/200] batch [15/38] time 0.374 (0.499) data 0.242 (0.368) loss_x loss_x 2.1387 (1.5447) acc_x 50.0000 (60.8333) lr 1.9851e-03 eta 0:00:11
epoch [13/200] batch [20/38] time 0.428 (0.490) data 0.298 (0.359) loss_x loss_x 1.5293 (1.5404) acc_x 56.2500 (60.9375) lr 1.9851e-03 eta 0:00:08
epoch [13/200] batch [25/38] time 0.574 (0.490) data 0.443 (0.359) loss_x loss_x 1.3750 (1.5580) acc_x 62.5000 (59.6250) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [30/38] time 0.403 (0.486) data 0.272 (0.355) loss_x loss_x 1.5811 (1.6332) acc_x 59.3750 (58.6458) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [35/38] time 0.486 (0.486) data 0.355 (0.355) loss_x loss_x 1.4023 (1.6039) acc_x 71.8750 (59.1071) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1777
confident_label rate tensor(0.3900, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1223
clean true:1209
clean false:14
clean_rate:0.9885527391659853
noisy true:150
noisy false:1763
after delete: len(clean_dataset) 1223
after delete: len(noisy_dataset) 1913
epoch [14/200] batch [5/38] time 0.444 (0.494) data 0.312 (0.362) loss_x loss_x 1.5107 (1.5486) acc_x 53.1250 (58.1250) lr 1.9823e-03 eta 0:00:16
epoch [14/200] batch [10/38] time 0.560 (0.503) data 0.429 (0.372) loss_x loss_x 2.4004 (1.6337) acc_x 56.2500 (57.1875) lr 1.9823e-03 eta 0:00:14
epoch [14/200] batch [15/38] time 0.504 (0.492) data 0.373 (0.361) loss_x loss_x 1.3408 (1.4948) acc_x 65.6250 (60.8333) lr 1.9823e-03 eta 0:00:11
epoch [14/200] batch [20/38] time 0.477 (0.485) data 0.347 (0.354) loss_x loss_x 1.1504 (1.4794) acc_x 78.1250 (61.2500) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [25/38] time 0.585 (0.494) data 0.454 (0.363) loss_x loss_x 1.3730 (1.4555) acc_x 53.1250 (61.2500) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [30/38] time 0.545 (0.488) data 0.414 (0.357) loss_x loss_x 1.5547 (1.4792) acc_x 56.2500 (61.1458) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [35/38] time 0.373 (0.486) data 0.242 (0.355) loss_x loss_x 1.8633 (1.4737) acc_x 50.0000 (60.6250) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.3957, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1241
clean true:1225
clean false:16
clean_rate:0.9871071716357775
noisy true:160
noisy false:1735
after delete: len(clean_dataset) 1241
after delete: len(noisy_dataset) 1895
epoch [15/200] batch [5/38] time 0.409 (0.448) data 0.279 (0.317) loss_x loss_x 1.4561 (1.5049) acc_x 59.3750 (60.0000) lr 1.9792e-03 eta 0:00:14
epoch [15/200] batch [10/38] time 0.497 (0.444) data 0.366 (0.313) loss_x loss_x 1.3867 (1.4580) acc_x 65.6250 (61.8750) lr 1.9792e-03 eta 0:00:12
epoch [15/200] batch [15/38] time 0.419 (0.443) data 0.288 (0.312) loss_x loss_x 1.9883 (1.4716) acc_x 50.0000 (60.2083) lr 1.9792e-03 eta 0:00:10
epoch [15/200] batch [20/38] time 0.541 (0.454) data 0.410 (0.323) loss_x loss_x 1.2129 (1.4577) acc_x 62.5000 (61.8750) lr 1.9792e-03 eta 0:00:08
epoch [15/200] batch [25/38] time 0.475 (0.459) data 0.344 (0.329) loss_x loss_x 1.1592 (1.4393) acc_x 71.8750 (62.1250) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [30/38] time 0.488 (0.461) data 0.358 (0.331) loss_x loss_x 1.7783 (1.4767) acc_x 53.1250 (60.6250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [35/38] time 0.472 (0.462) data 0.340 (0.331) loss_x loss_x 1.7832 (1.4789) acc_x 53.1250 (60.5357) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.3852, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1208
clean true:1189
clean false:19
clean_rate:0.984271523178808
noisy true:161
noisy false:1767
after delete: len(clean_dataset) 1208
after delete: len(noisy_dataset) 1928
epoch [16/200] batch [5/37] time 0.549 (0.609) data 0.418 (0.478) loss_x loss_x 1.3721 (1.5631) acc_x 68.7500 (58.7500) lr 1.9759e-03 eta 0:00:19
epoch [16/200] batch [10/37] time 0.568 (0.579) data 0.438 (0.448) loss_x loss_x 1.1074 (1.4682) acc_x 75.0000 (63.1250) lr 1.9759e-03 eta 0:00:15
epoch [16/200] batch [15/37] time 0.506 (0.550) data 0.376 (0.420) loss_x loss_x 1.6533 (1.4543) acc_x 50.0000 (62.5000) lr 1.9759e-03 eta 0:00:12
epoch [16/200] batch [20/37] time 0.405 (0.519) data 0.274 (0.388) loss_x loss_x 1.4785 (1.4576) acc_x 65.6250 (62.1875) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [25/37] time 0.524 (0.506) data 0.393 (0.375) loss_x loss_x 1.3867 (1.4678) acc_x 65.6250 (62.2500) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [30/37] time 0.466 (0.502) data 0.335 (0.371) loss_x loss_x 2.1055 (1.5235) acc_x 53.1250 (61.0417) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [35/37] time 0.574 (0.508) data 0.443 (0.377) loss_x loss_x 1.2188 (1.5080) acc_x 59.3750 (60.8036) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1758
confident_label rate tensor(0.3878, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1216
clean true:1208
clean false:8
clean_rate:0.993421052631579
noisy true:170
noisy false:1750
after delete: len(clean_dataset) 1216
after delete: len(noisy_dataset) 1920
epoch [17/200] batch [5/38] time 0.449 (0.441) data 0.319 (0.311) loss_x loss_x 1.7061 (1.6342) acc_x 56.2500 (58.7500) lr 1.9724e-03 eta 0:00:14
epoch [17/200] batch [10/38] time 0.430 (0.481) data 0.300 (0.351) loss_x loss_x 1.4551 (1.4693) acc_x 59.3750 (63.1250) lr 1.9724e-03 eta 0:00:13
epoch [17/200] batch [15/38] time 0.606 (0.493) data 0.474 (0.362) loss_x loss_x 1.7744 (1.4831) acc_x 59.3750 (62.5000) lr 1.9724e-03 eta 0:00:11
epoch [17/200] batch [20/38] time 0.433 (0.489) data 0.302 (0.358) loss_x loss_x 1.0908 (1.4665) acc_x 71.8750 (62.6562) lr 1.9724e-03 eta 0:00:08
epoch [17/200] batch [25/38] time 0.620 (0.495) data 0.488 (0.364) loss_x loss_x 1.1523 (1.4575) acc_x 65.6250 (62.8750) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [30/38] time 0.494 (0.491) data 0.363 (0.360) loss_x loss_x 2.0195 (1.4958) acc_x 53.1250 (61.5625) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [35/38] time 0.595 (0.498) data 0.464 (0.367) loss_x loss_x 1.1738 (1.4721) acc_x 75.0000 (62.5000) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1775
confident_label rate tensor(0.3890, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1220
clean true:1207
clean false:13
clean_rate:0.989344262295082
noisy true:154
noisy false:1762
after delete: len(clean_dataset) 1220
after delete: len(noisy_dataset) 1916
epoch [18/200] batch [5/38] time 0.493 (0.526) data 0.363 (0.395) loss_x loss_x 1.7021 (1.7266) acc_x 65.6250 (59.3750) lr 1.9686e-03 eta 0:00:17
epoch [18/200] batch [10/38] time 0.643 (0.530) data 0.512 (0.399) loss_x loss_x 1.0703 (1.6621) acc_x 65.6250 (60.0000) lr 1.9686e-03 eta 0:00:14
epoch [18/200] batch [15/38] time 0.574 (0.519) data 0.444 (0.388) loss_x loss_x 1.1514 (1.6114) acc_x 81.2500 (63.7500) lr 1.9686e-03 eta 0:00:11
epoch [18/200] batch [20/38] time 0.506 (0.502) data 0.375 (0.371) loss_x loss_x 1.9043 (1.6398) acc_x 59.3750 (61.8750) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [25/38] time 0.340 (0.486) data 0.209 (0.355) loss_x loss_x 1.3936 (1.5987) acc_x 59.3750 (62.7500) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [30/38] time 0.537 (0.482) data 0.405 (0.351) loss_x loss_x 1.4404 (1.5683) acc_x 65.6250 (62.8125) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [35/38] time 0.430 (0.474) data 0.299 (0.343) loss_x loss_x 1.3418 (1.5266) acc_x 59.3750 (63.6607) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.3922, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1230
clean true:1213
clean false:17
clean_rate:0.9861788617886179
noisy true:157
noisy false:1749
after delete: len(clean_dataset) 1230
after delete: len(noisy_dataset) 1906
epoch [19/200] batch [5/38] time 0.485 (0.476) data 0.354 (0.345) loss_x loss_x 1.3301 (1.2854) acc_x 62.5000 (63.1250) lr 1.9646e-03 eta 0:00:15
epoch [19/200] batch [10/38] time 0.394 (0.469) data 0.263 (0.338) loss_x loss_x 1.6992 (1.3998) acc_x 56.2500 (61.2500) lr 1.9646e-03 eta 0:00:13
epoch [19/200] batch [15/38] time 0.482 (0.480) data 0.351 (0.349) loss_x loss_x 1.4258 (1.4746) acc_x 62.5000 (60.8333) lr 1.9646e-03 eta 0:00:11
epoch [19/200] batch [20/38] time 0.659 (0.491) data 0.523 (0.359) loss_x loss_x 1.1602 (1.5308) acc_x 71.8750 (59.6875) lr 1.9646e-03 eta 0:00:08
epoch [19/200] batch [25/38] time 0.489 (0.497) data 0.358 (0.366) loss_x loss_x 1.6963 (1.5333) acc_x 68.7500 (60.1250) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [30/38] time 0.703 (0.502) data 0.572 (0.370) loss_x loss_x 1.4561 (1.5459) acc_x 65.6250 (59.6875) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [35/38] time 0.428 (0.499) data 0.297 (0.368) loss_x loss_x 1.5244 (1.5328) acc_x 59.3750 (59.3750) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.3941, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1236
clean true:1218
clean false:18
clean_rate:0.9854368932038835
noisy true:151
noisy false:1749
after delete: len(clean_dataset) 1236
after delete: len(noisy_dataset) 1900
epoch [20/200] batch [5/38] time 0.528 (0.526) data 0.397 (0.395) loss_x loss_x 1.7197 (1.4066) acc_x 50.0000 (65.6250) lr 1.9603e-03 eta 0:00:17
epoch [20/200] batch [10/38] time 0.415 (0.487) data 0.284 (0.356) loss_x loss_x 1.9551 (1.4788) acc_x 43.7500 (62.8125) lr 1.9603e-03 eta 0:00:13
epoch [20/200] batch [15/38] time 0.576 (0.491) data 0.444 (0.360) loss_x loss_x 1.6270 (1.4147) acc_x 56.2500 (64.1667) lr 1.9603e-03 eta 0:00:11
epoch [20/200] batch [20/38] time 0.343 (0.471) data 0.212 (0.340) loss_x loss_x 1.7734 (1.5343) acc_x 56.2500 (62.9688) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [25/38] time 0.516 (0.484) data 0.381 (0.352) loss_x loss_x 1.5537 (1.5209) acc_x 50.0000 (61.8750) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [30/38] time 0.499 (0.487) data 0.367 (0.356) loss_x loss_x 1.0400 (1.4584) acc_x 81.2500 (63.6458) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [35/38] time 0.387 (0.487) data 0.256 (0.355) loss_x loss_x 1.6602 (1.4752) acc_x 59.3750 (63.1250) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.3999, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1254
clean true:1238
clean false:16
clean_rate:0.9872408293460925
noisy true:151
noisy false:1731
after delete: len(clean_dataset) 1254
after delete: len(noisy_dataset) 1882
epoch [21/200] batch [5/39] time 0.461 (0.455) data 0.330 (0.324) loss_x loss_x 1.6660 (1.5074) acc_x 62.5000 (60.6250) lr 1.9558e-03 eta 0:00:15
epoch [21/200] batch [10/39] time 0.379 (0.472) data 0.249 (0.341) loss_x loss_x 2.0684 (1.5389) acc_x 53.1250 (59.3750) lr 1.9558e-03 eta 0:00:13
epoch [21/200] batch [15/39] time 0.483 (0.458) data 0.352 (0.327) loss_x loss_x 1.3154 (1.5354) acc_x 56.2500 (60.6250) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [20/39] time 0.460 (0.462) data 0.329 (0.331) loss_x loss_x 1.1113 (1.5120) acc_x 65.6250 (61.4062) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [25/39] time 0.428 (0.460) data 0.297 (0.329) loss_x loss_x 1.8564 (1.4994) acc_x 43.7500 (61.3750) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [30/39] time 0.481 (0.459) data 0.350 (0.329) loss_x loss_x 1.6885 (1.5187) acc_x 50.0000 (60.9375) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [35/39] time 0.443 (0.462) data 0.311 (0.331) loss_x loss_x 1.4033 (1.5107) acc_x 65.6250 (60.9821) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.4011, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1258
clean true:1236
clean false:22
clean_rate:0.9825119236883942
noisy true:156
noisy false:1722
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 1878
epoch [22/200] batch [5/39] time 0.491 (0.433) data 0.360 (0.302) loss_x loss_x 1.5078 (1.4193) acc_x 62.5000 (58.7500) lr 1.9511e-03 eta 0:00:14
epoch [22/200] batch [10/39] time 0.492 (0.453) data 0.360 (0.322) loss_x loss_x 1.7881 (1.5558) acc_x 59.3750 (60.0000) lr 1.9511e-03 eta 0:00:13
epoch [22/200] batch [15/39] time 0.529 (0.483) data 0.398 (0.351) loss_x loss_x 1.9824 (1.5590) acc_x 53.1250 (60.4167) lr 1.9511e-03 eta 0:00:11
epoch [22/200] batch [20/39] time 0.464 (0.478) data 0.333 (0.346) loss_x loss_x 1.0078 (1.4997) acc_x 75.0000 (60.7812) lr 1.9511e-03 eta 0:00:09
epoch [22/200] batch [25/39] time 0.408 (0.470) data 0.277 (0.338) loss_x loss_x 1.2334 (1.5069) acc_x 65.6250 (60.5000) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [30/39] time 0.444 (0.465) data 0.312 (0.334) loss_x loss_x 1.2188 (1.4967) acc_x 68.7500 (60.3125) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [35/39] time 0.374 (0.461) data 0.243 (0.330) loss_x loss_x 1.3770 (1.4819) acc_x 56.2500 (59.9107) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1707
confident_label rate tensor(0.4104, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1287
clean true:1274
clean false:13
clean_rate:0.98989898989899
noisy true:155
noisy false:1694
after delete: len(clean_dataset) 1287
after delete: len(noisy_dataset) 1849
epoch [23/200] batch [5/40] time 0.458 (0.485) data 0.327 (0.354) loss_x loss_x 1.1406 (1.2348) acc_x 65.6250 (63.7500) lr 1.9461e-03 eta 0:00:16
epoch [23/200] batch [10/40] time 0.586 (0.503) data 0.455 (0.372) loss_x loss_x 0.7622 (1.3832) acc_x 75.0000 (61.5625) lr 1.9461e-03 eta 0:00:15
epoch [23/200] batch [15/40] time 0.498 (0.477) data 0.366 (0.346) loss_x loss_x 1.5010 (1.3808) acc_x 68.7500 (62.7083) lr 1.9461e-03 eta 0:00:11
epoch [23/200] batch [20/40] time 0.397 (0.476) data 0.265 (0.345) loss_x loss_x 1.2334 (1.3585) acc_x 62.5000 (62.6562) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [25/40] time 0.499 (0.496) data 0.368 (0.365) loss_x loss_x 1.3574 (1.3739) acc_x 56.2500 (61.2500) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [30/40] time 0.410 (0.485) data 0.280 (0.355) loss_x loss_x 1.2920 (1.3890) acc_x 71.8750 (61.5625) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [35/40] time 0.480 (0.491) data 0.349 (0.360) loss_x loss_x 1.3369 (1.3866) acc_x 62.5000 (61.9643) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [40/40] time 0.397 (0.487) data 0.266 (0.357) loss_x loss_x 1.4629 (1.4134) acc_x 62.5000 (61.1719) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1753
confident_label rate tensor(0.3922, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1230
clean true:1216
clean false:14
clean_rate:0.9886178861788618
noisy true:167
noisy false:1739
after delete: len(clean_dataset) 1230
after delete: len(noisy_dataset) 1906
epoch [24/200] batch [5/38] time 0.441 (0.508) data 0.309 (0.377) loss_x loss_x 1.9561 (1.6527) acc_x 56.2500 (55.6250) lr 1.9409e-03 eta 0:00:16
epoch [24/200] batch [10/38] time 0.430 (0.501) data 0.299 (0.370) loss_x loss_x 1.7598 (1.6196) acc_x 50.0000 (55.9375) lr 1.9409e-03 eta 0:00:14
epoch [24/200] batch [15/38] time 0.436 (0.476) data 0.305 (0.344) loss_x loss_x 1.3438 (1.5497) acc_x 46.8750 (58.1250) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [20/38] time 0.440 (0.476) data 0.310 (0.344) loss_x loss_x 2.1777 (1.6230) acc_x 56.2500 (57.9688) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [25/38] time 0.501 (0.474) data 0.370 (0.343) loss_x loss_x 1.3076 (1.5818) acc_x 65.6250 (58.5000) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [30/38] time 0.440 (0.471) data 0.310 (0.340) loss_x loss_x 1.6387 (1.5856) acc_x 59.3750 (58.5417) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [35/38] time 0.405 (0.469) data 0.274 (0.338) loss_x loss_x 1.8066 (1.5625) acc_x 53.1250 (59.4643) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.3957, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1241
clean true:1222
clean false:19
clean_rate:0.984689766317486
noisy true:166
noisy false:1729
after delete: len(clean_dataset) 1241
after delete: len(noisy_dataset) 1895
epoch [25/200] batch [5/38] time 0.610 (0.533) data 0.480 (0.402) loss_x loss_x 1.3008 (1.4109) acc_x 59.3750 (63.1250) lr 1.9354e-03 eta 0:00:17
epoch [25/200] batch [10/38] time 0.508 (0.502) data 0.377 (0.371) loss_x loss_x 1.2070 (1.3389) acc_x 68.7500 (63.1250) lr 1.9354e-03 eta 0:00:14
epoch [25/200] batch [15/38] time 0.415 (0.486) data 0.283 (0.355) loss_x loss_x 1.7979 (1.3554) acc_x 56.2500 (63.3333) lr 1.9354e-03 eta 0:00:11
epoch [25/200] batch [20/38] time 0.481 (0.481) data 0.350 (0.350) loss_x loss_x 1.5830 (1.4438) acc_x 50.0000 (60.9375) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [25/38] time 0.489 (0.478) data 0.358 (0.347) loss_x loss_x 0.9917 (1.4311) acc_x 75.0000 (62.1250) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [30/38] time 0.711 (0.484) data 0.580 (0.353) loss_x loss_x 1.2109 (1.4109) acc_x 65.6250 (63.4375) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [35/38] time 0.431 (0.479) data 0.300 (0.348) loss_x loss_x 1.0938 (1.4074) acc_x 71.8750 (64.0179) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.3945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1237
clean true:1221
clean false:16
clean_rate:0.9870654810024252
noisy true:148
noisy false:1751
after delete: len(clean_dataset) 1237
after delete: len(noisy_dataset) 1899
epoch [26/200] batch [5/38] time 0.425 (0.443) data 0.293 (0.312) loss_x loss_x 1.1387 (1.4406) acc_x 65.6250 (62.5000) lr 1.9298e-03 eta 0:00:14
epoch [26/200] batch [10/38] time 0.484 (0.453) data 0.352 (0.322) loss_x loss_x 2.0918 (1.5965) acc_x 50.0000 (58.7500) lr 1.9298e-03 eta 0:00:12
epoch [26/200] batch [15/38] time 0.447 (0.455) data 0.315 (0.324) loss_x loss_x 1.3691 (1.5474) acc_x 68.7500 (60.2083) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [20/38] time 0.384 (0.445) data 0.253 (0.314) loss_x loss_x 1.2246 (1.4615) acc_x 62.5000 (61.7188) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [25/38] time 0.579 (0.463) data 0.447 (0.332) loss_x loss_x 1.1084 (1.4601) acc_x 71.8750 (61.5000) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [30/38] time 0.528 (0.472) data 0.397 (0.341) loss_x loss_x 2.2266 (1.4502) acc_x 46.8750 (61.5625) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [35/38] time 0.431 (0.471) data 0.299 (0.340) loss_x loss_x 1.4082 (1.4279) acc_x 62.5000 (62.5000) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1717
confident_label rate tensor(0.3992, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1252
clean true:1236
clean false:16
clean_rate:0.987220447284345
noisy true:183
noisy false:1701
after delete: len(clean_dataset) 1252
after delete: len(noisy_dataset) 1884
epoch [27/200] batch [5/39] time 0.492 (0.479) data 0.361 (0.348) loss_x loss_x 1.3320 (1.5195) acc_x 62.5000 (64.3750) lr 1.9239e-03 eta 0:00:16
epoch [27/200] batch [10/39] time 0.432 (0.471) data 0.301 (0.339) loss_x loss_x 1.4668 (1.4876) acc_x 62.5000 (64.6875) lr 1.9239e-03 eta 0:00:13
epoch [27/200] batch [15/39] time 0.409 (0.459) data 0.278 (0.327) loss_x loss_x 1.4502 (1.4501) acc_x 56.2500 (63.9583) lr 1.9239e-03 eta 0:00:11
epoch [27/200] batch [20/39] time 0.613 (0.463) data 0.482 (0.332) loss_x loss_x 1.0420 (1.4494) acc_x 65.6250 (62.5000) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [25/39] time 0.482 (0.465) data 0.351 (0.334) loss_x loss_x 1.3799 (1.4466) acc_x 59.3750 (61.3750) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [30/39] time 0.380 (0.470) data 0.248 (0.339) loss_x loss_x 1.1201 (1.4124) acc_x 65.6250 (61.5625) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [35/39] time 0.437 (0.479) data 0.306 (0.347) loss_x loss_x 1.9844 (1.4253) acc_x 56.2500 (61.5179) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1749
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1240
clean true:1230
clean false:10
clean_rate:0.9919354838709677
noisy true:157
noisy false:1739
after delete: len(clean_dataset) 1240
after delete: len(noisy_dataset) 1896
epoch [28/200] batch [5/38] time 0.420 (0.431) data 0.289 (0.299) loss_x loss_x 1.4316 (1.6453) acc_x 53.1250 (55.6250) lr 1.9178e-03 eta 0:00:14
epoch [28/200] batch [10/38] time 0.361 (0.422) data 0.230 (0.291) loss_x loss_x 1.5713 (1.6343) acc_x 56.2500 (55.9375) lr 1.9178e-03 eta 0:00:11
epoch [28/200] batch [15/38] time 0.519 (0.437) data 0.388 (0.306) loss_x loss_x 1.2686 (1.5138) acc_x 62.5000 (59.1667) lr 1.9178e-03 eta 0:00:10
epoch [28/200] batch [20/38] time 0.590 (0.468) data 0.458 (0.336) loss_x loss_x 1.5352 (1.4607) acc_x 62.5000 (60.7812) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [25/38] time 0.453 (0.464) data 0.322 (0.333) loss_x loss_x 1.2754 (1.4380) acc_x 65.6250 (61.5000) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [30/38] time 0.487 (0.472) data 0.356 (0.341) loss_x loss_x 1.3291 (1.4806) acc_x 65.6250 (61.3542) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [35/38] time 0.474 (0.473) data 0.343 (0.341) loss_x loss_x 1.4395 (1.4482) acc_x 56.2500 (61.5179) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1716
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1270
clean true:1253
clean false:17
clean_rate:0.9866141732283464
noisy true:167
noisy false:1699
after delete: len(clean_dataset) 1270
after delete: len(noisy_dataset) 1866
epoch [29/200] batch [5/39] time 0.513 (0.449) data 0.382 (0.317) loss_x loss_x 1.0957 (1.3234) acc_x 65.6250 (61.8750) lr 1.9114e-03 eta 0:00:15
epoch [29/200] batch [10/39] time 0.667 (0.465) data 0.535 (0.334) loss_x loss_x 1.5898 (1.3507) acc_x 50.0000 (62.5000) lr 1.9114e-03 eta 0:00:13
epoch [29/200] batch [15/39] time 0.395 (0.466) data 0.264 (0.335) loss_x loss_x 1.1367 (1.3410) acc_x 68.7500 (63.1250) lr 1.9114e-03 eta 0:00:11
epoch [29/200] batch [20/39] time 0.400 (0.470) data 0.269 (0.339) loss_x loss_x 1.6113 (1.3449) acc_x 56.2500 (63.9062) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [25/39] time 0.374 (0.476) data 0.243 (0.345) loss_x loss_x 1.5117 (1.3177) acc_x 62.5000 (64.7500) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [30/39] time 0.606 (0.493) data 0.475 (0.362) loss_x loss_x 1.1191 (1.3301) acc_x 68.7500 (64.4792) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [35/39] time 0.539 (0.488) data 0.409 (0.357) loss_x loss_x 1.5518 (1.3583) acc_x 65.6250 (64.1071) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1740
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1249
clean true:1234
clean false:15
clean_rate:0.9879903923138511
noisy true:162
noisy false:1725
after delete: len(clean_dataset) 1249
after delete: len(noisy_dataset) 1887
epoch [30/200] batch [5/39] time 0.425 (0.445) data 0.294 (0.314) loss_x loss_x 1.3242 (1.5562) acc_x 71.8750 (64.3750) lr 1.9048e-03 eta 0:00:15
epoch [30/200] batch [10/39] time 0.458 (0.463) data 0.327 (0.331) loss_x loss_x 2.0098 (1.6375) acc_x 50.0000 (58.7500) lr 1.9048e-03 eta 0:00:13
epoch [30/200] batch [15/39] time 0.354 (0.455) data 0.223 (0.324) loss_x loss_x 1.1992 (1.4905) acc_x 62.5000 (62.0833) lr 1.9048e-03 eta 0:00:10
epoch [30/200] batch [20/39] time 0.473 (0.462) data 0.342 (0.330) loss_x loss_x 1.0771 (1.4794) acc_x 68.7500 (62.0312) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [25/39] time 0.400 (0.479) data 0.269 (0.348) loss_x loss_x 1.4941 (1.4549) acc_x 65.6250 (62.7500) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [30/39] time 0.491 (0.484) data 0.360 (0.353) loss_x loss_x 1.8320 (1.4607) acc_x 56.2500 (62.8125) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [35/39] time 0.418 (0.479) data 0.287 (0.348) loss_x loss_x 1.4893 (1.4512) acc_x 59.3750 (63.2143) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.4212, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1321
clean true:1304
clean false:17
clean_rate:0.9871309613928841
noisy true:155
noisy false:1660
after delete: len(clean_dataset) 1321
after delete: len(noisy_dataset) 1815
epoch [31/200] batch [5/41] time 0.429 (0.443) data 0.298 (0.312) loss_x loss_x 1.1299 (1.6123) acc_x 71.8750 (56.2500) lr 1.8980e-03 eta 0:00:15
epoch [31/200] batch [10/41] time 0.525 (0.448) data 0.395 (0.317) loss_x loss_x 1.3701 (1.6140) acc_x 68.7500 (59.0625) lr 1.8980e-03 eta 0:00:13
epoch [31/200] batch [15/41] time 0.471 (0.448) data 0.340 (0.317) loss_x loss_x 1.4404 (1.5998) acc_x 65.6250 (59.1667) lr 1.8980e-03 eta 0:00:11
epoch [31/200] batch [20/41] time 0.436 (0.439) data 0.305 (0.308) loss_x loss_x 1.4697 (1.5454) acc_x 65.6250 (60.7812) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [25/41] time 0.525 (0.456) data 0.393 (0.325) loss_x loss_x 1.0029 (1.4954) acc_x 68.7500 (61.2500) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [30/41] time 0.442 (0.469) data 0.311 (0.338) loss_x loss_x 1.4521 (1.4567) acc_x 53.1250 (62.3958) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [35/41] time 0.567 (0.477) data 0.436 (0.346) loss_x loss_x 1.1191 (1.4614) acc_x 65.6250 (61.7857) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [40/41] time 0.385 (0.477) data 0.254 (0.346) loss_x loss_x 1.5752 (1.4519) acc_x 68.7500 (61.9531) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1683
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1324
clean true:1302
clean false:22
clean_rate:0.9833836858006042
noisy true:151
noisy false:1661
after delete: len(clean_dataset) 1324
after delete: len(noisy_dataset) 1812
epoch [32/200] batch [5/41] time 0.466 (0.491) data 0.335 (0.360) loss_x loss_x 1.5352 (1.8178) acc_x 65.6250 (55.0000) lr 1.8910e-03 eta 0:00:17
epoch [32/200] batch [10/41] time 0.454 (0.482) data 0.322 (0.351) loss_x loss_x 1.0596 (1.6699) acc_x 68.7500 (55.6250) lr 1.8910e-03 eta 0:00:14
epoch [32/200] batch [15/41] time 0.562 (0.493) data 0.430 (0.362) loss_x loss_x 1.1045 (1.5985) acc_x 56.2500 (55.0000) lr 1.8910e-03 eta 0:00:12
epoch [32/200] batch [20/41] time 0.529 (0.481) data 0.397 (0.350) loss_x loss_x 1.7432 (1.5720) acc_x 43.7500 (55.9375) lr 1.8910e-03 eta 0:00:10
epoch [32/200] batch [25/41] time 0.413 (0.471) data 0.282 (0.340) loss_x loss_x 1.3730 (1.5550) acc_x 75.0000 (57.8750) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [30/41] time 0.500 (0.482) data 0.369 (0.351) loss_x loss_x 1.2754 (1.5075) acc_x 56.2500 (59.4792) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [35/41] time 0.454 (0.480) data 0.323 (0.349) loss_x loss_x 1.1875 (1.4784) acc_x 65.6250 (60.0893) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [40/41] time 0.401 (0.479) data 0.270 (0.348) loss_x loss_x 1.1094 (1.4716) acc_x 81.2500 (60.7812) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1325
clean true:1307
clean false:18
clean_rate:0.9864150943396226
noisy true:158
noisy false:1653
after delete: len(clean_dataset) 1325
after delete: len(noisy_dataset) 1811
epoch [33/200] batch [5/41] time 0.491 (0.499) data 0.360 (0.367) loss_x loss_x 1.4092 (1.2563) acc_x 62.5000 (62.5000) lr 1.8838e-03 eta 0:00:17
epoch [33/200] batch [10/41] time 0.591 (0.531) data 0.460 (0.399) loss_x loss_x 1.6016 (1.4225) acc_x 56.2500 (59.0625) lr 1.8838e-03 eta 0:00:16
epoch [33/200] batch [15/41] time 0.399 (0.487) data 0.267 (0.356) loss_x loss_x 1.8379 (1.4208) acc_x 53.1250 (58.9583) lr 1.8838e-03 eta 0:00:12
epoch [33/200] batch [20/41] time 0.679 (0.497) data 0.548 (0.366) loss_x loss_x 1.8057 (1.4620) acc_x 53.1250 (59.0625) lr 1.8838e-03 eta 0:00:10
epoch [33/200] batch [25/41] time 0.476 (0.490) data 0.345 (0.358) loss_x loss_x 1.4346 (1.4641) acc_x 56.2500 (59.6250) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [30/41] time 0.434 (0.480) data 0.303 (0.349) loss_x loss_x 1.3564 (1.4630) acc_x 68.7500 (60.7292) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [35/41] time 0.374 (0.478) data 0.243 (0.347) loss_x loss_x 1.4014 (1.4551) acc_x 65.6250 (60.7143) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [40/41] time 0.549 (0.475) data 0.418 (0.344) loss_x loss_x 1.7451 (1.4463) acc_x 53.1250 (61.3281) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1693
confident_label rate tensor(0.4104, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1287
clean true:1277
clean false:10
clean_rate:0.9922299922299922
noisy true:166
noisy false:1683
after delete: len(clean_dataset) 1287
after delete: len(noisy_dataset) 1849
epoch [34/200] batch [5/40] time 0.523 (0.470) data 0.392 (0.339) loss_x loss_x 1.1260 (1.2457) acc_x 71.8750 (70.0000) lr 1.8763e-03 eta 0:00:16
epoch [34/200] batch [10/40] time 0.573 (0.483) data 0.441 (0.352) loss_x loss_x 1.1064 (1.2173) acc_x 71.8750 (68.7500) lr 1.8763e-03 eta 0:00:14
epoch [34/200] batch [15/40] time 0.403 (0.484) data 0.272 (0.353) loss_x loss_x 1.3672 (1.2906) acc_x 59.3750 (65.6250) lr 1.8763e-03 eta 0:00:12
epoch [34/200] batch [20/40] time 0.494 (0.471) data 0.363 (0.340) loss_x loss_x 1.6406 (1.2910) acc_x 62.5000 (66.2500) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [25/40] time 0.499 (0.468) data 0.367 (0.336) loss_x loss_x 1.5703 (1.3138) acc_x 59.3750 (64.3750) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [30/40] time 0.392 (0.462) data 0.259 (0.330) loss_x loss_x 1.3779 (1.3410) acc_x 53.1250 (63.1250) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [35/40] time 0.407 (0.460) data 0.276 (0.328) loss_x loss_x 1.2471 (1.3614) acc_x 68.7500 (61.9643) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [40/40] time 0.397 (0.461) data 0.267 (0.330) loss_x loss_x 1.8203 (1.3750) acc_x 56.2500 (62.1094) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.4155, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1303
clean true:1290
clean false:13
clean_rate:0.990023023791251
noisy true:167
noisy false:1666
after delete: len(clean_dataset) 1303
after delete: len(noisy_dataset) 1833
epoch [35/200] batch [5/40] time 0.467 (0.466) data 0.336 (0.336) loss_x loss_x 1.2412 (1.6152) acc_x 65.6250 (58.1250) lr 1.8686e-03 eta 0:00:16
epoch [35/200] batch [10/40] time 0.747 (0.489) data 0.616 (0.358) loss_x loss_x 0.9473 (1.5749) acc_x 75.0000 (60.0000) lr 1.8686e-03 eta 0:00:14
epoch [35/200] batch [15/40] time 0.599 (0.480) data 0.467 (0.349) loss_x loss_x 1.8887 (1.5454) acc_x 56.2500 (61.8750) lr 1.8686e-03 eta 0:00:11
epoch [35/200] batch [20/40] time 0.413 (0.473) data 0.281 (0.343) loss_x loss_x 1.5156 (1.5143) acc_x 56.2500 (61.8750) lr 1.8686e-03 eta 0:00:09
epoch [35/200] batch [25/40] time 0.421 (0.464) data 0.291 (0.333) loss_x loss_x 1.7627 (1.5149) acc_x 50.0000 (60.8750) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [30/40] time 0.517 (0.463) data 0.386 (0.333) loss_x loss_x 1.3145 (1.4775) acc_x 62.5000 (61.2500) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [35/40] time 0.405 (0.463) data 0.274 (0.332) loss_x loss_x 1.7461 (1.4484) acc_x 56.2500 (62.0536) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [40/40] time 0.472 (0.471) data 0.341 (0.340) loss_x loss_x 1.6934 (1.4404) acc_x 56.2500 (62.2656) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.4232, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1327
clean true:1311
clean false:16
clean_rate:0.9879427279577996
noisy true:156
noisy false:1653
after delete: len(clean_dataset) 1327
after delete: len(noisy_dataset) 1809
epoch [36/200] batch [5/41] time 0.381 (0.457) data 0.250 (0.326) loss_x loss_x 1.6328 (1.5953) acc_x 56.2500 (63.7500) lr 1.8607e-03 eta 0:00:16
epoch [36/200] batch [10/41] time 0.505 (0.446) data 0.373 (0.315) loss_x loss_x 1.0605 (1.5050) acc_x 71.8750 (62.8125) lr 1.8607e-03 eta 0:00:13
epoch [36/200] batch [15/41] time 0.457 (0.443) data 0.326 (0.312) loss_x loss_x 1.1064 (1.3647) acc_x 62.5000 (65.2083) lr 1.8607e-03 eta 0:00:11
epoch [36/200] batch [20/41] time 0.417 (0.447) data 0.285 (0.316) loss_x loss_x 1.4141 (1.4208) acc_x 59.3750 (63.4375) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [25/41] time 0.493 (0.449) data 0.362 (0.317) loss_x loss_x 1.3223 (1.4058) acc_x 71.8750 (64.2500) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [30/41] time 0.477 (0.452) data 0.346 (0.321) loss_x loss_x 1.0244 (1.3955) acc_x 68.7500 (64.4792) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [35/41] time 0.480 (0.449) data 0.348 (0.317) loss_x loss_x 1.1211 (1.4049) acc_x 75.0000 (64.2857) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [40/41] time 0.414 (0.453) data 0.283 (0.321) loss_x loss_x 1.4492 (1.3929) acc_x 62.5000 (64.6875) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.4091, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1283
clean true:1268
clean false:15
clean_rate:0.9883086515978177
noisy true:159
noisy false:1694
after delete: len(clean_dataset) 1283
after delete: len(noisy_dataset) 1853
epoch [37/200] batch [5/40] time 0.519 (0.491) data 0.389 (0.360) loss_x loss_x 0.9009 (1.3200) acc_x 81.2500 (68.7500) lr 1.8526e-03 eta 0:00:17
epoch [37/200] batch [10/40] time 0.456 (0.511) data 0.325 (0.380) loss_x loss_x 1.1602 (1.3210) acc_x 71.8750 (68.1250) lr 1.8526e-03 eta 0:00:15
epoch [37/200] batch [15/40] time 0.437 (0.486) data 0.307 (0.355) loss_x loss_x 1.2021 (1.4199) acc_x 62.5000 (65.4167) lr 1.8526e-03 eta 0:00:12
epoch [37/200] batch [20/40] time 0.454 (0.478) data 0.323 (0.347) loss_x loss_x 1.6465 (1.4303) acc_x 59.3750 (65.4688) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [25/40] time 0.494 (0.474) data 0.363 (0.343) loss_x loss_x 1.2773 (1.4341) acc_x 71.8750 (64.3750) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [30/40] time 0.434 (0.469) data 0.302 (0.338) loss_x loss_x 1.4727 (1.4498) acc_x 62.5000 (64.0625) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [35/40] time 0.390 (0.468) data 0.258 (0.337) loss_x loss_x 0.8237 (1.4458) acc_x 78.1250 (63.3929) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [40/40] time 0.496 (0.474) data 0.365 (0.343) loss_x loss_x 0.9004 (1.4433) acc_x 75.0000 (63.2031) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.4174, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1309
clean true:1297
clean false:12
clean_rate:0.9908326967150497
noisy true:173
noisy false:1654
after delete: len(clean_dataset) 1309
after delete: len(noisy_dataset) 1827
epoch [38/200] batch [5/40] time 0.400 (0.444) data 0.269 (0.313) loss_x loss_x 1.2822 (1.6066) acc_x 62.5000 (55.6250) lr 1.8443e-03 eta 0:00:15
epoch [38/200] batch [10/40] time 0.581 (0.465) data 0.450 (0.334) loss_x loss_x 1.5459 (1.4439) acc_x 59.3750 (61.8750) lr 1.8443e-03 eta 0:00:13
epoch [38/200] batch [15/40] time 0.460 (0.473) data 0.325 (0.341) loss_x loss_x 1.5898 (1.4295) acc_x 59.3750 (61.6667) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [20/40] time 0.521 (0.494) data 0.390 (0.363) loss_x loss_x 1.2520 (1.3945) acc_x 59.3750 (61.8750) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [25/40] time 0.533 (0.503) data 0.401 (0.372) loss_x loss_x 1.0918 (1.4531) acc_x 75.0000 (61.5000) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [30/40] time 0.367 (0.492) data 0.236 (0.361) loss_x loss_x 1.6357 (1.4292) acc_x 68.7500 (62.2917) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [35/40] time 0.381 (0.485) data 0.250 (0.353) loss_x loss_x 1.8545 (1.4099) acc_x 62.5000 (62.6786) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [40/40] time 0.409 (0.488) data 0.278 (0.357) loss_x loss_x 1.2363 (1.3792) acc_x 62.5000 (63.2812) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.4314, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1353
clean true:1335
clean false:18
clean_rate:0.9866962305986696
noisy true:162
noisy false:1621
after delete: len(clean_dataset) 1353
after delete: len(noisy_dataset) 1783
epoch [39/200] batch [5/42] time 0.418 (0.446) data 0.288 (0.315) loss_x loss_x 1.2773 (1.4447) acc_x 65.6250 (61.8750) lr 1.8358e-03 eta 0:00:16
epoch [39/200] batch [10/42] time 0.393 (0.445) data 0.263 (0.315) loss_x loss_x 1.9082 (1.5627) acc_x 40.6250 (58.4375) lr 1.8358e-03 eta 0:00:14
epoch [39/200] batch [15/42] time 0.623 (0.451) data 0.492 (0.320) loss_x loss_x 1.6709 (1.4557) acc_x 65.6250 (62.2917) lr 1.8358e-03 eta 0:00:12
epoch [39/200] batch [20/42] time 0.529 (0.475) data 0.397 (0.344) loss_x loss_x 0.9941 (1.4118) acc_x 75.0000 (62.8125) lr 1.8358e-03 eta 0:00:10
epoch [39/200] batch [25/42] time 0.469 (0.488) data 0.339 (0.357) loss_x loss_x 1.2412 (1.4052) acc_x 71.8750 (61.8750) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [30/42] time 0.400 (0.484) data 0.269 (0.353) loss_x loss_x 1.1924 (1.4189) acc_x 71.8750 (61.7708) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [35/42] time 0.373 (0.483) data 0.242 (0.352) loss_x loss_x 1.8701 (1.4518) acc_x 46.8750 (61.1607) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [40/42] time 0.355 (0.480) data 0.224 (0.349) loss_x loss_x 1.7598 (1.4660) acc_x 50.0000 (60.7812) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.4114, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1290
clean true:1277
clean false:13
clean_rate:0.9899224806201551
noisy true:160
noisy false:1686
after delete: len(clean_dataset) 1290
after delete: len(noisy_dataset) 1846
epoch [40/200] batch [5/40] time 0.433 (0.487) data 0.302 (0.356) loss_x loss_x 1.1045 (1.3313) acc_x 78.1250 (69.3750) lr 1.8271e-03 eta 0:00:17
epoch [40/200] batch [10/40] time 0.421 (0.475) data 0.290 (0.344) loss_x loss_x 1.9121 (1.3631) acc_x 59.3750 (68.4375) lr 1.8271e-03 eta 0:00:14
epoch [40/200] batch [15/40] time 0.463 (0.471) data 0.333 (0.340) loss_x loss_x 1.1582 (1.3989) acc_x 68.7500 (66.0417) lr 1.8271e-03 eta 0:00:11
epoch [40/200] batch [20/40] time 0.433 (0.461) data 0.302 (0.330) loss_x loss_x 1.0830 (1.3794) acc_x 75.0000 (65.4688) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [25/40] time 0.568 (0.465) data 0.438 (0.334) loss_x loss_x 1.0186 (1.3409) acc_x 75.0000 (66.2500) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [30/40] time 0.429 (0.459) data 0.298 (0.328) loss_x loss_x 1.3252 (1.3509) acc_x 71.8750 (65.4167) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [35/40] time 0.446 (0.468) data 0.316 (0.337) loss_x loss_x 1.6523 (1.3614) acc_x 65.6250 (65.2679) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [40/40] time 0.439 (0.471) data 0.308 (0.340) loss_x loss_x 1.0703 (1.3551) acc_x 68.7500 (65.5469) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1658
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1333
clean true:1312
clean false:21
clean_rate:0.9842460615153789
noisy true:166
noisy false:1637
after delete: len(clean_dataset) 1333
after delete: len(noisy_dataset) 1803
epoch [41/200] batch [5/41] time 0.391 (0.491) data 0.261 (0.360) loss_x loss_x 1.3408 (1.4090) acc_x 78.1250 (63.7500) lr 1.8181e-03 eta 0:00:17
epoch [41/200] batch [10/41] time 0.402 (0.462) data 0.270 (0.331) loss_x loss_x 1.0273 (1.2443) acc_x 75.0000 (68.7500) lr 1.8181e-03 eta 0:00:14
epoch [41/200] batch [15/41] time 0.570 (0.493) data 0.439 (0.362) loss_x loss_x 1.9727 (1.3522) acc_x 50.0000 (64.7917) lr 1.8181e-03 eta 0:00:12
epoch [41/200] batch [20/41] time 0.382 (0.469) data 0.252 (0.338) loss_x loss_x 1.2285 (1.3625) acc_x 65.6250 (64.0625) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [25/41] time 0.485 (0.473) data 0.354 (0.342) loss_x loss_x 1.2832 (1.3683) acc_x 59.3750 (64.0000) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [30/41] time 0.723 (0.485) data 0.592 (0.354) loss_x loss_x 1.0879 (1.3622) acc_x 71.8750 (64.3750) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [35/41] time 0.442 (0.476) data 0.311 (0.345) loss_x loss_x 1.2158 (1.3630) acc_x 62.5000 (64.4643) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [40/41] time 0.455 (0.481) data 0.325 (0.350) loss_x loss_x 1.1924 (1.3580) acc_x 59.3750 (64.1406) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.4149, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1301
clean true:1287
clean false:14
clean_rate:0.98923904688701
noisy true:149
noisy false:1686
after delete: len(clean_dataset) 1301
after delete: len(noisy_dataset) 1835
epoch [42/200] batch [5/40] time 0.505 (0.534) data 0.373 (0.402) loss_x loss_x 1.6934 (1.4896) acc_x 59.3750 (61.2500) lr 1.8090e-03 eta 0:00:18
epoch [42/200] batch [10/40] time 0.441 (0.479) data 0.310 (0.348) loss_x loss_x 1.4727 (1.4620) acc_x 59.3750 (61.8750) lr 1.8090e-03 eta 0:00:14
epoch [42/200] batch [15/40] time 0.369 (0.468) data 0.238 (0.336) loss_x loss_x 1.4668 (1.4714) acc_x 56.2500 (60.4167) lr 1.8090e-03 eta 0:00:11
epoch [42/200] batch [20/40] time 0.672 (0.487) data 0.541 (0.356) loss_x loss_x 1.6221 (1.4753) acc_x 50.0000 (60.7812) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [25/40] time 0.406 (0.474) data 0.274 (0.343) loss_x loss_x 0.8960 (1.4721) acc_x 78.1250 (61.7500) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [30/40] time 0.513 (0.476) data 0.382 (0.345) loss_x loss_x 1.2109 (1.4536) acc_x 68.7500 (62.7083) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [35/40] time 0.479 (0.475) data 0.348 (0.343) loss_x loss_x 1.3828 (1.4577) acc_x 62.5000 (62.5893) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [40/40] time 0.450 (0.480) data 0.319 (0.349) loss_x loss_x 1.2529 (1.4448) acc_x 65.6250 (63.0469) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1624
confident_label rate tensor(0.4340, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1361
clean true:1348
clean false:13
clean_rate:0.9904481998530492
noisy true:164
noisy false:1611
after delete: len(clean_dataset) 1361
after delete: len(noisy_dataset) 1775
epoch [43/200] batch [5/42] time 0.553 (0.525) data 0.422 (0.393) loss_x loss_x 1.7471 (1.4123) acc_x 50.0000 (64.3750) lr 1.7997e-03 eta 0:00:19
epoch [43/200] batch [10/42] time 0.528 (0.477) data 0.397 (0.346) loss_x loss_x 1.4629 (1.4024) acc_x 56.2500 (64.3750) lr 1.7997e-03 eta 0:00:15
epoch [43/200] batch [15/42] time 0.529 (0.473) data 0.397 (0.342) loss_x loss_x 1.2432 (1.4344) acc_x 59.3750 (63.5417) lr 1.7997e-03 eta 0:00:12
epoch [43/200] batch [20/42] time 0.474 (0.474) data 0.343 (0.343) loss_x loss_x 1.8047 (1.4345) acc_x 59.3750 (63.9062) lr 1.7997e-03 eta 0:00:10
epoch [43/200] batch [25/42] time 0.449 (0.470) data 0.318 (0.339) loss_x loss_x 1.9668 (1.4548) acc_x 46.8750 (63.5000) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [30/42] time 0.335 (0.471) data 0.205 (0.340) loss_x loss_x 1.2373 (1.4146) acc_x 65.6250 (63.7500) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [35/42] time 0.499 (0.475) data 0.367 (0.344) loss_x loss_x 1.2363 (1.3720) acc_x 62.5000 (64.9107) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [40/42] time 0.470 (0.475) data 0.338 (0.344) loss_x loss_x 1.4980 (1.3676) acc_x 59.3750 (64.8438) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1643
confident_label rate tensor(0.4286, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1344
clean true:1329
clean false:15
clean_rate:0.9888392857142857
noisy true:164
noisy false:1628
after delete: len(clean_dataset) 1344
after delete: len(noisy_dataset) 1792
epoch [44/200] batch [5/42] time 0.646 (0.463) data 0.516 (0.331) loss_x loss_x 1.0527 (1.4949) acc_x 59.3750 (64.3750) lr 1.7902e-03 eta 0:00:17
epoch [44/200] batch [10/42] time 0.472 (0.469) data 0.341 (0.338) loss_x loss_x 1.4189 (1.3745) acc_x 65.6250 (65.3125) lr 1.7902e-03 eta 0:00:15
epoch [44/200] batch [15/42] time 0.555 (0.467) data 0.424 (0.336) loss_x loss_x 1.2510 (1.3731) acc_x 68.7500 (65.4167) lr 1.7902e-03 eta 0:00:12
epoch [44/200] batch [20/42] time 0.510 (0.474) data 0.379 (0.343) loss_x loss_x 1.4268 (1.3778) acc_x 65.6250 (65.6250) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [25/42] time 0.441 (0.474) data 0.309 (0.343) loss_x loss_x 1.8008 (1.4271) acc_x 56.2500 (63.6250) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [30/42] time 0.414 (0.477) data 0.283 (0.346) loss_x loss_x 1.8359 (1.4139) acc_x 46.8750 (63.2292) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [35/42] time 0.460 (0.472) data 0.329 (0.341) loss_x loss_x 1.5625 (1.3940) acc_x 50.0000 (63.0357) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [40/42] time 0.431 (0.474) data 0.300 (0.343) loss_x loss_x 1.4385 (1.3969) acc_x 59.3750 (63.0469) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1643
confident_label rate tensor(0.4302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1349
clean true:1334
clean false:15
clean_rate:0.9888806523350631
noisy true:159
noisy false:1628
after delete: len(clean_dataset) 1349
after delete: len(noisy_dataset) 1787
epoch [45/200] batch [5/42] time 0.522 (0.497) data 0.391 (0.365) loss_x loss_x 1.3311 (1.5271) acc_x 75.0000 (65.0000) lr 1.7804e-03 eta 0:00:18
epoch [45/200] batch [10/42] time 0.444 (0.494) data 0.309 (0.363) loss_x loss_x 2.1680 (1.4561) acc_x 53.1250 (65.6250) lr 1.7804e-03 eta 0:00:15
epoch [45/200] batch [15/42] time 0.519 (0.491) data 0.388 (0.360) loss_x loss_x 1.1309 (1.4085) acc_x 75.0000 (65.2083) lr 1.7804e-03 eta 0:00:13
epoch [45/200] batch [20/42] time 0.425 (0.476) data 0.293 (0.344) loss_x loss_x 1.0322 (1.3593) acc_x 71.8750 (65.6250) lr 1.7804e-03 eta 0:00:10
epoch [45/200] batch [25/42] time 0.455 (0.466) data 0.324 (0.335) loss_x loss_x 1.5947 (1.3679) acc_x 62.5000 (65.3750) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [30/42] time 0.374 (0.462) data 0.244 (0.331) loss_x loss_x 1.4756 (1.3924) acc_x 59.3750 (64.7917) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [35/42] time 0.531 (0.467) data 0.400 (0.336) loss_x loss_x 1.0713 (1.3787) acc_x 78.1250 (65.1786) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [40/42] time 0.434 (0.464) data 0.304 (0.333) loss_x loss_x 1.2637 (1.3604) acc_x 71.8750 (65.7812) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1624
confident_label rate tensor(0.4340, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1361
clean true:1345
clean false:16
clean_rate:0.988243938280676
noisy true:167
noisy false:1608
after delete: len(clean_dataset) 1361
after delete: len(noisy_dataset) 1775
epoch [46/200] batch [5/42] time 0.647 (0.461) data 0.517 (0.331) loss_x loss_x 1.4844 (1.4779) acc_x 59.3750 (62.5000) lr 1.7705e-03 eta 0:00:17
epoch [46/200] batch [10/42] time 0.392 (0.453) data 0.261 (0.322) loss_x loss_x 1.0732 (1.4095) acc_x 75.0000 (64.6875) lr 1.7705e-03 eta 0:00:14
epoch [46/200] batch [15/42] time 0.569 (0.461) data 0.438 (0.330) loss_x loss_x 1.4902 (1.4188) acc_x 59.3750 (63.7500) lr 1.7705e-03 eta 0:00:12
epoch [46/200] batch [20/42] time 0.538 (0.480) data 0.407 (0.349) loss_x loss_x 1.6543 (1.4282) acc_x 59.3750 (64.3750) lr 1.7705e-03 eta 0:00:10
epoch [46/200] batch [25/42] time 0.413 (0.474) data 0.282 (0.342) loss_x loss_x 0.9609 (1.4101) acc_x 68.7500 (63.7500) lr 1.7705e-03 eta 0:00:08
epoch [46/200] batch [30/42] time 0.556 (0.476) data 0.424 (0.345) loss_x loss_x 1.9082 (1.4497) acc_x 46.8750 (62.7083) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [35/42] time 0.414 (0.473) data 0.283 (0.342) loss_x loss_x 1.5693 (1.4648) acc_x 62.5000 (62.5000) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [40/42] time 0.442 (0.473) data 0.311 (0.341) loss_x loss_x 1.6758 (1.4689) acc_x 68.7500 (62.8906) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1324
clean true:1306
clean false:18
clean_rate:0.986404833836858
noisy true:160
noisy false:1652
after delete: len(clean_dataset) 1324
after delete: len(noisy_dataset) 1812
epoch [47/200] batch [5/41] time 0.386 (0.519) data 0.255 (0.387) loss_x loss_x 1.1709 (1.6076) acc_x 71.8750 (64.3750) lr 1.7604e-03 eta 0:00:18
epoch [47/200] batch [10/41] time 0.395 (0.481) data 0.265 (0.350) loss_x loss_x 1.3848 (1.3944) acc_x 71.8750 (66.5625) lr 1.7604e-03 eta 0:00:14
epoch [47/200] batch [15/41] time 0.440 (0.463) data 0.309 (0.332) loss_x loss_x 1.5205 (1.3284) acc_x 56.2500 (66.2500) lr 1.7604e-03 eta 0:00:12
epoch [47/200] batch [20/41] time 0.527 (0.467) data 0.396 (0.336) loss_x loss_x 1.4307 (1.3166) acc_x 59.3750 (65.6250) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [25/41] time 0.525 (0.470) data 0.393 (0.339) loss_x loss_x 1.6016 (1.3146) acc_x 68.7500 (66.0000) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [30/41] time 0.458 (0.461) data 0.327 (0.330) loss_x loss_x 1.5312 (1.3326) acc_x 62.5000 (66.1458) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [35/41] time 0.450 (0.463) data 0.319 (0.331) loss_x loss_x 1.3789 (1.3510) acc_x 65.6250 (65.8036) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [40/41] time 0.448 (0.466) data 0.317 (0.335) loss_x loss_x 1.5928 (1.3587) acc_x 59.3750 (65.2344) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.4343, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1362
clean true:1346
clean false:16
clean_rate:0.9882525697503671
noisy true:161
noisy false:1613
after delete: len(clean_dataset) 1362
after delete: len(noisy_dataset) 1774
epoch [48/200] batch [5/42] time 0.478 (0.502) data 0.346 (0.370) loss_x loss_x 1.2861 (1.3311) acc_x 71.8750 (70.6250) lr 1.7501e-03 eta 0:00:18
epoch [48/200] batch [10/42] time 0.436 (0.476) data 0.304 (0.344) loss_x loss_x 1.2100 (1.4159) acc_x 68.7500 (67.5000) lr 1.7501e-03 eta 0:00:15
epoch [48/200] batch [15/42] time 0.455 (0.472) data 0.324 (0.340) loss_x loss_x 1.3125 (1.3951) acc_x 56.2500 (64.7917) lr 1.7501e-03 eta 0:00:12
epoch [48/200] batch [20/42] time 0.458 (0.469) data 0.327 (0.338) loss_x loss_x 1.5928 (1.4234) acc_x 68.7500 (63.9062) lr 1.7501e-03 eta 0:00:10
epoch [48/200] batch [25/42] time 0.440 (0.468) data 0.309 (0.336) loss_x loss_x 1.4658 (1.3688) acc_x 62.5000 (64.5000) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [30/42] time 0.451 (0.476) data 0.319 (0.345) loss_x loss_x 1.5693 (1.3914) acc_x 71.8750 (64.4792) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [35/42] time 0.411 (0.480) data 0.280 (0.348) loss_x loss_x 1.4492 (1.3951) acc_x 65.6250 (64.4643) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [40/42] time 0.524 (0.486) data 0.388 (0.354) loss_x loss_x 1.3955 (1.3930) acc_x 62.5000 (64.7656) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.4292, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1346
clean true:1330
clean false:16
clean_rate:0.9881129271916791
noisy true:166
noisy false:1624
after delete: len(clean_dataset) 1346
after delete: len(noisy_dataset) 1790
epoch [49/200] batch [5/42] time 0.442 (0.488) data 0.310 (0.356) loss_x loss_x 2.0234 (1.5125) acc_x 53.1250 (60.6250) lr 1.7396e-03 eta 0:00:18
epoch [49/200] batch [10/42] time 0.415 (0.521) data 0.284 (0.388) loss_x loss_x 1.4375 (1.4431) acc_x 59.3750 (62.5000) lr 1.7396e-03 eta 0:00:16
epoch [49/200] batch [15/42] time 0.482 (0.493) data 0.351 (0.361) loss_x loss_x 1.2344 (1.4295) acc_x 65.6250 (63.3333) lr 1.7396e-03 eta 0:00:13
epoch [49/200] batch [20/42] time 0.399 (0.477) data 0.268 (0.345) loss_x loss_x 1.1406 (1.3879) acc_x 75.0000 (64.2188) lr 1.7396e-03 eta 0:00:10
epoch [49/200] batch [25/42] time 0.573 (0.469) data 0.442 (0.338) loss_x loss_x 1.8232 (1.3681) acc_x 53.1250 (64.2500) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [30/42] time 0.390 (0.463) data 0.259 (0.332) loss_x loss_x 0.6611 (1.3832) acc_x 87.5000 (64.3750) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [35/42] time 0.513 (0.465) data 0.381 (0.333) loss_x loss_x 1.8857 (1.3861) acc_x 50.0000 (63.7500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [40/42] time 0.477 (0.463) data 0.347 (0.332) loss_x loss_x 1.2227 (1.3912) acc_x 65.6250 (63.1250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.4311, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1352
clean true:1337
clean false:15
clean_rate:0.988905325443787
noisy true:163
noisy false:1621
after delete: len(clean_dataset) 1352
after delete: len(noisy_dataset) 1784
epoch [50/200] batch [5/42] time 0.412 (0.443) data 0.281 (0.312) loss_x loss_x 1.0908 (1.2980) acc_x 68.7500 (62.5000) lr 1.7290e-03 eta 0:00:16
epoch [50/200] batch [10/42] time 0.357 (0.439) data 0.226 (0.309) loss_x loss_x 1.5762 (1.4555) acc_x 53.1250 (59.3750) lr 1.7290e-03 eta 0:00:14
epoch [50/200] batch [15/42] time 0.395 (0.460) data 0.264 (0.329) loss_x loss_x 1.5732 (1.4314) acc_x 56.2500 (60.2083) lr 1.7290e-03 eta 0:00:12
epoch [50/200] batch [20/42] time 0.544 (0.479) data 0.413 (0.348) loss_x loss_x 1.2148 (1.3897) acc_x 71.8750 (61.2500) lr 1.7290e-03 eta 0:00:10
epoch [50/200] batch [25/42] time 0.598 (0.488) data 0.467 (0.357) loss_x loss_x 1.4795 (1.3723) acc_x 59.3750 (62.3750) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [30/42] time 0.460 (0.487) data 0.329 (0.356) loss_x loss_x 1.3311 (1.3868) acc_x 62.5000 (62.5000) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [35/42] time 0.408 (0.477) data 0.278 (0.346) loss_x loss_x 1.1055 (1.3679) acc_x 75.0000 (63.4821) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [40/42] time 0.465 (0.472) data 0.334 (0.342) loss_x loss_x 1.5098 (1.3509) acc_x 62.5000 (63.9062) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1588
confident_label rate tensor(0.4461, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1399
clean true:1382
clean false:17
clean_rate:0.9878484631879915
noisy true:166
noisy false:1571
after delete: len(clean_dataset) 1399
after delete: len(noisy_dataset) 1737
epoch [51/200] batch [5/43] time 0.540 (0.503) data 0.409 (0.371) loss_x loss_x 1.3389 (1.5285) acc_x 75.0000 (63.1250) lr 1.7181e-03 eta 0:00:19
epoch [51/200] batch [10/43] time 0.375 (0.468) data 0.244 (0.337) loss_x loss_x 1.5000 (1.4013) acc_x 56.2500 (65.0000) lr 1.7181e-03 eta 0:00:15
epoch [51/200] batch [15/43] time 0.466 (0.469) data 0.335 (0.338) loss_x loss_x 1.5293 (1.3914) acc_x 62.5000 (65.6250) lr 1.7181e-03 eta 0:00:13
epoch [51/200] batch [20/43] time 0.401 (0.453) data 0.270 (0.322) loss_x loss_x 1.2910 (1.3873) acc_x 65.6250 (64.6875) lr 1.7181e-03 eta 0:00:10
epoch [51/200] batch [25/43] time 0.527 (0.472) data 0.395 (0.340) loss_x loss_x 1.4141 (1.4221) acc_x 56.2500 (63.8750) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [30/43] time 0.387 (0.481) data 0.255 (0.350) loss_x loss_x 1.3105 (1.4151) acc_x 75.0000 (64.2708) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [35/43] time 0.561 (0.481) data 0.431 (0.350) loss_x loss_x 1.0615 (1.4162) acc_x 75.0000 (63.7500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [40/43] time 0.384 (0.475) data 0.253 (0.344) loss_x loss_x 1.6768 (1.4025) acc_x 50.0000 (63.7500) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1618
confident_label rate tensor(0.4343, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1362
clean true:1349
clean false:13
clean_rate:0.9904552129221733
noisy true:169
noisy false:1605
after delete: len(clean_dataset) 1362
after delete: len(noisy_dataset) 1774
epoch [52/200] batch [5/42] time 0.408 (0.424) data 0.277 (0.293) loss_x loss_x 1.4844 (1.2680) acc_x 68.7500 (68.7500) lr 1.7071e-03 eta 0:00:15
epoch [52/200] batch [10/42] time 0.383 (0.421) data 0.252 (0.290) loss_x loss_x 1.4121 (1.2631) acc_x 65.6250 (67.5000) lr 1.7071e-03 eta 0:00:13
epoch [52/200] batch [15/42] time 0.508 (0.448) data 0.378 (0.318) loss_x loss_x 1.0410 (1.2806) acc_x 68.7500 (65.2083) lr 1.7071e-03 eta 0:00:12
epoch [52/200] batch [20/42] time 0.395 (0.450) data 0.264 (0.319) loss_x loss_x 0.8105 (1.2848) acc_x 75.0000 (64.8438) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [25/42] time 0.408 (0.450) data 0.278 (0.319) loss_x loss_x 1.7324 (1.3138) acc_x 59.3750 (64.2500) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [30/42] time 0.493 (0.463) data 0.362 (0.332) loss_x loss_x 1.7939 (1.3520) acc_x 56.2500 (64.0625) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [35/42] time 0.443 (0.462) data 0.312 (0.331) loss_x loss_x 0.9302 (1.3311) acc_x 81.2500 (64.8214) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [40/42] time 0.458 (0.468) data 0.328 (0.337) loss_x loss_x 1.6445 (1.3401) acc_x 50.0000 (64.7656) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.4349, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1364
clean true:1349
clean false:15
clean_rate:0.9890029325513197
noisy true:164
noisy false:1608
after delete: len(clean_dataset) 1364
after delete: len(noisy_dataset) 1772
epoch [53/200] batch [5/42] time 0.418 (0.462) data 0.287 (0.331) loss_x loss_x 1.2617 (1.4408) acc_x 75.0000 (61.8750) lr 1.6959e-03 eta 0:00:17
epoch [53/200] batch [10/42] time 0.569 (0.499) data 0.438 (0.368) loss_x loss_x 1.6270 (1.5206) acc_x 62.5000 (60.9375) lr 1.6959e-03 eta 0:00:15
epoch [53/200] batch [15/42] time 0.640 (0.493) data 0.510 (0.362) loss_x loss_x 0.8296 (1.4774) acc_x 75.0000 (62.7083) lr 1.6959e-03 eta 0:00:13
epoch [53/200] batch [20/42] time 0.544 (0.493) data 0.413 (0.362) loss_x loss_x 1.7979 (1.4700) acc_x 62.5000 (62.6562) lr 1.6959e-03 eta 0:00:10
epoch [53/200] batch [25/42] time 0.482 (0.504) data 0.352 (0.373) loss_x loss_x 1.3057 (1.4118) acc_x 65.6250 (63.5000) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [30/42] time 0.524 (0.502) data 0.393 (0.371) loss_x loss_x 1.6338 (1.4584) acc_x 56.2500 (62.5000) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [35/42] time 0.498 (0.496) data 0.367 (0.366) loss_x loss_x 1.6562 (1.4417) acc_x 56.2500 (62.0536) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [40/42] time 0.417 (0.489) data 0.286 (0.358) loss_x loss_x 1.4502 (1.4276) acc_x 71.8750 (62.7344) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.4330, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1358
clean true:1349
clean false:9
clean_rate:0.9933726067746687
noisy true:167
noisy false:1611
after delete: len(clean_dataset) 1358
after delete: len(noisy_dataset) 1778
epoch [54/200] batch [5/42] time 0.439 (0.450) data 0.307 (0.319) loss_x loss_x 1.3613 (1.3533) acc_x 65.6250 (68.7500) lr 1.6845e-03 eta 0:00:16
epoch [54/200] batch [10/42] time 0.566 (0.460) data 0.435 (0.329) loss_x loss_x 1.0859 (1.4440) acc_x 81.2500 (68.1250) lr 1.6845e-03 eta 0:00:14
epoch [54/200] batch [15/42] time 0.461 (0.474) data 0.329 (0.343) loss_x loss_x 1.0918 (1.4211) acc_x 75.0000 (67.2917) lr 1.6845e-03 eta 0:00:12
epoch [54/200] batch [20/42] time 0.407 (0.476) data 0.276 (0.344) loss_x loss_x 1.1357 (1.3810) acc_x 75.0000 (67.0312) lr 1.6845e-03 eta 0:00:10
epoch [54/200] batch [25/42] time 0.423 (0.467) data 0.292 (0.335) loss_x loss_x 1.3027 (1.3460) acc_x 59.3750 (67.0000) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [30/42] time 0.408 (0.469) data 0.277 (0.337) loss_x loss_x 1.2490 (1.3278) acc_x 65.6250 (66.8750) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [35/42] time 0.703 (0.476) data 0.573 (0.345) loss_x loss_x 1.1660 (1.3191) acc_x 75.0000 (66.8750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [40/42] time 0.524 (0.469) data 0.393 (0.338) loss_x loss_x 1.0088 (1.3234) acc_x 84.3750 (66.8750) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.4327, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1357
clean true:1339
clean false:18
clean_rate:0.9867354458364038
noisy true:158
noisy false:1621
after delete: len(clean_dataset) 1357
after delete: len(noisy_dataset) 1779
epoch [55/200] batch [5/42] time 0.544 (0.460) data 0.413 (0.330) loss_x loss_x 1.4932 (1.4658) acc_x 56.2500 (62.5000) lr 1.6730e-03 eta 0:00:17
epoch [55/200] batch [10/42] time 0.612 (0.487) data 0.481 (0.357) loss_x loss_x 1.1367 (1.4071) acc_x 71.8750 (63.4375) lr 1.6730e-03 eta 0:00:15
epoch [55/200] batch [15/42] time 0.476 (0.479) data 0.346 (0.348) loss_x loss_x 1.2900 (1.4118) acc_x 78.1250 (63.5417) lr 1.6730e-03 eta 0:00:12
epoch [55/200] batch [20/42] time 0.507 (0.480) data 0.376 (0.350) loss_x loss_x 0.9580 (1.3699) acc_x 71.8750 (64.8438) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [25/42] time 0.457 (0.478) data 0.326 (0.348) loss_x loss_x 1.2500 (1.3347) acc_x 71.8750 (66.3750) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [30/42] time 0.448 (0.484) data 0.316 (0.353) loss_x loss_x 0.9653 (1.3270) acc_x 81.2500 (66.1458) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [35/42] time 0.483 (0.486) data 0.351 (0.355) loss_x loss_x 0.9155 (1.3086) acc_x 84.3750 (66.6071) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [40/42] time 0.434 (0.492) data 0.302 (0.361) loss_x loss_x 1.6738 (1.3193) acc_x 56.2500 (65.7031) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1641
confident_label rate tensor(0.4321, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1355
clean true:1337
clean false:18
clean_rate:0.9867158671586715
noisy true:158
noisy false:1623
after delete: len(clean_dataset) 1355
after delete: len(noisy_dataset) 1781
epoch [56/200] batch [5/42] time 0.367 (0.432) data 0.236 (0.300) loss_x loss_x 0.9219 (1.2145) acc_x 75.0000 (70.0000) lr 1.6613e-03 eta 0:00:15
epoch [56/200] batch [10/42] time 0.450 (0.435) data 0.319 (0.304) loss_x loss_x 0.9351 (1.2963) acc_x 81.2500 (67.1875) lr 1.6613e-03 eta 0:00:13
epoch [56/200] batch [15/42] time 0.416 (0.434) data 0.285 (0.303) loss_x loss_x 1.3564 (1.2815) acc_x 56.2500 (66.8750) lr 1.6613e-03 eta 0:00:11
epoch [56/200] batch [20/42] time 0.508 (0.444) data 0.376 (0.314) loss_x loss_x 1.1611 (1.3112) acc_x 71.8750 (66.7188) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [25/42] time 0.492 (0.455) data 0.362 (0.324) loss_x loss_x 1.5283 (1.3662) acc_x 71.8750 (65.8750) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [30/42] time 0.444 (0.460) data 0.314 (0.329) loss_x loss_x 1.4795 (1.3604) acc_x 56.2500 (65.4167) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [35/42] time 0.393 (0.455) data 0.263 (0.324) loss_x loss_x 2.1875 (1.3965) acc_x 50.0000 (64.1071) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [40/42] time 0.481 (0.458) data 0.351 (0.328) loss_x loss_x 1.3467 (1.3902) acc_x 68.7500 (64.1406) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1573
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1409
clean true:1396
clean false:13
clean_rate:0.9907735982966643
noisy true:167
noisy false:1560
after delete: len(clean_dataset) 1409
after delete: len(noisy_dataset) 1727
epoch [57/200] batch [5/44] time 0.493 (0.468) data 0.362 (0.337) loss_x loss_x 1.5068 (1.4092) acc_x 62.5000 (64.3750) lr 1.6494e-03 eta 0:00:18
epoch [57/200] batch [10/44] time 0.506 (0.478) data 0.374 (0.347) loss_x loss_x 1.0703 (1.3479) acc_x 71.8750 (64.3750) lr 1.6494e-03 eta 0:00:16
epoch [57/200] batch [15/44] time 0.418 (0.467) data 0.287 (0.336) loss_x loss_x 1.7080 (1.3714) acc_x 50.0000 (64.1667) lr 1.6494e-03 eta 0:00:13
epoch [57/200] batch [20/44] time 0.412 (0.465) data 0.282 (0.335) loss_x loss_x 1.0869 (1.3628) acc_x 71.8750 (64.6875) lr 1.6494e-03 eta 0:00:11
epoch [57/200] batch [25/44] time 0.436 (0.457) data 0.306 (0.327) loss_x loss_x 1.4043 (1.3688) acc_x 65.6250 (64.3750) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [30/44] time 0.478 (0.456) data 0.348 (0.325) loss_x loss_x 1.2812 (1.3552) acc_x 68.7500 (64.6875) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [35/44] time 0.464 (0.456) data 0.333 (0.325) loss_x loss_x 1.3291 (1.3675) acc_x 59.3750 (64.1071) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [40/44] time 0.388 (0.455) data 0.257 (0.325) loss_x loss_x 1.5654 (1.3622) acc_x 53.1250 (64.3750) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1397
clean true:1380
clean false:17
clean_rate:0.9878310665712241
noisy true:166
noisy false:1573
after delete: len(clean_dataset) 1397
after delete: len(noisy_dataset) 1739
epoch [58/200] batch [5/43] time 0.433 (0.548) data 0.302 (0.416) loss_x loss_x 1.2051 (1.2924) acc_x 62.5000 (65.6250) lr 1.6374e-03 eta 0:00:20
epoch [58/200] batch [10/43] time 0.494 (0.521) data 0.362 (0.389) loss_x loss_x 0.8408 (1.3498) acc_x 78.1250 (67.1875) lr 1.6374e-03 eta 0:00:17
epoch [58/200] batch [15/43] time 0.489 (0.493) data 0.358 (0.361) loss_x loss_x 1.2588 (1.3602) acc_x 65.6250 (66.2500) lr 1.6374e-03 eta 0:00:13
epoch [58/200] batch [20/43] time 0.372 (0.486) data 0.241 (0.355) loss_x loss_x 1.3672 (1.3408) acc_x 59.3750 (66.0938) lr 1.6374e-03 eta 0:00:11
epoch [58/200] batch [25/43] time 0.438 (0.479) data 0.307 (0.347) loss_x loss_x 1.2637 (1.3013) acc_x 62.5000 (66.6250) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [30/43] time 0.452 (0.469) data 0.321 (0.338) loss_x loss_x 1.7168 (1.3400) acc_x 59.3750 (66.2500) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [35/43] time 0.448 (0.467) data 0.317 (0.336) loss_x loss_x 1.3398 (1.3358) acc_x 68.7500 (66.6964) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [40/43] time 0.457 (0.465) data 0.326 (0.334) loss_x loss_x 1.3271 (1.3312) acc_x 65.6250 (66.7188) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1434
clean true:1421
clean false:13
clean_rate:0.9909344490934449
noisy true:157
noisy false:1545
after delete: len(clean_dataset) 1434
after delete: len(noisy_dataset) 1702
epoch [59/200] batch [5/44] time 0.656 (0.487) data 0.525 (0.356) loss_x loss_x 0.9282 (1.3114) acc_x 78.1250 (65.6250) lr 1.6252e-03 eta 0:00:19
epoch [59/200] batch [10/44] time 0.536 (0.493) data 0.405 (0.361) loss_x loss_x 1.1602 (1.3542) acc_x 75.0000 (67.1875) lr 1.6252e-03 eta 0:00:16
epoch [59/200] batch [15/44] time 0.340 (0.472) data 0.210 (0.340) loss_x loss_x 1.1123 (1.3123) acc_x 65.6250 (66.6667) lr 1.6252e-03 eta 0:00:13
epoch [59/200] batch [20/44] time 0.471 (0.480) data 0.340 (0.348) loss_x loss_x 1.0615 (1.3334) acc_x 75.0000 (66.4062) lr 1.6252e-03 eta 0:00:11
epoch [59/200] batch [25/44] time 0.433 (0.471) data 0.302 (0.339) loss_x loss_x 1.6748 (1.3240) acc_x 65.6250 (66.8750) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [30/44] time 0.473 (0.471) data 0.342 (0.340) loss_x loss_x 1.5127 (1.3740) acc_x 71.8750 (66.1458) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [35/44] time 0.406 (0.465) data 0.275 (0.334) loss_x loss_x 1.1895 (1.3496) acc_x 65.6250 (66.2500) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [40/44] time 0.407 (0.458) data 0.276 (0.326) loss_x loss_x 2.2266 (1.3683) acc_x 53.1250 (66.2500) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.4429, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1389
clean true:1372
clean false:17
clean_rate:0.9877609791216703
noisy true:156
noisy false:1591
after delete: len(clean_dataset) 1389
after delete: len(noisy_dataset) 1747
epoch [60/200] batch [5/43] time 0.436 (0.475) data 0.306 (0.345) loss_x loss_x 1.9189 (1.4771) acc_x 46.8750 (60.6250) lr 1.6129e-03 eta 0:00:18
epoch [60/200] batch [10/43] time 0.457 (0.473) data 0.327 (0.342) loss_x loss_x 1.2422 (1.4362) acc_x 71.8750 (62.8125) lr 1.6129e-03 eta 0:00:15
epoch [60/200] batch [15/43] time 0.445 (0.491) data 0.315 (0.360) loss_x loss_x 1.1973 (1.4575) acc_x 68.7500 (62.7083) lr 1.6129e-03 eta 0:00:13
epoch [60/200] batch [20/43] time 0.375 (0.479) data 0.245 (0.349) loss_x loss_x 1.5596 (1.4739) acc_x 59.3750 (61.8750) lr 1.6129e-03 eta 0:00:11
epoch [60/200] batch [25/43] time 0.439 (0.478) data 0.308 (0.347) loss_x loss_x 1.8535 (1.4751) acc_x 53.1250 (60.8750) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [30/43] time 0.449 (0.482) data 0.317 (0.352) loss_x loss_x 1.5293 (1.4587) acc_x 62.5000 (61.3542) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [35/43] time 0.525 (0.480) data 0.394 (0.349) loss_x loss_x 0.8765 (1.4320) acc_x 81.2500 (62.8571) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [40/43] time 0.400 (0.481) data 0.268 (0.350) loss_x loss_x 1.0342 (1.4222) acc_x 68.7500 (62.7344) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.4337, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1360
clean true:1344
clean false:16
clean_rate:0.9882352941176471
noisy true:172
noisy false:1604
after delete: len(clean_dataset) 1360
after delete: len(noisy_dataset) 1776
epoch [61/200] batch [5/42] time 0.464 (0.458) data 0.333 (0.327) loss_x loss_x 1.2607 (1.4607) acc_x 68.7500 (66.8750) lr 1.6004e-03 eta 0:00:16
epoch [61/200] batch [10/42] time 0.416 (0.484) data 0.285 (0.353) loss_x loss_x 1.4648 (1.4455) acc_x 62.5000 (66.8750) lr 1.6004e-03 eta 0:00:15
epoch [61/200] batch [15/42] time 0.362 (0.469) data 0.231 (0.338) loss_x loss_x 1.4326 (1.4390) acc_x 53.1250 (64.3750) lr 1.6004e-03 eta 0:00:12
epoch [61/200] batch [20/42] time 0.491 (0.479) data 0.359 (0.347) loss_x loss_x 1.0498 (1.3683) acc_x 68.7500 (65.4688) lr 1.6004e-03 eta 0:00:10
epoch [61/200] batch [25/42] time 0.512 (0.472) data 0.380 (0.341) loss_x loss_x 1.4033 (1.3239) acc_x 68.7500 (66.3750) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [30/42] time 0.463 (0.478) data 0.331 (0.346) loss_x loss_x 1.0801 (1.3116) acc_x 78.1250 (66.5625) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [35/42] time 0.469 (0.481) data 0.338 (0.349) loss_x loss_x 1.8057 (1.3344) acc_x 59.3750 (65.9821) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [40/42] time 0.454 (0.480) data 0.323 (0.348) loss_x loss_x 1.2031 (1.3335) acc_x 68.7500 (65.8594) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.4219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1323
clean true:1311
clean false:12
clean_rate:0.9909297052154195
noisy true:175
noisy false:1638
after delete: len(clean_dataset) 1323
after delete: len(noisy_dataset) 1813
epoch [62/200] batch [5/41] time 0.473 (0.494) data 0.341 (0.363) loss_x loss_x 1.1943 (1.2338) acc_x 68.7500 (71.2500) lr 1.5878e-03 eta 0:00:17
epoch [62/200] batch [10/41] time 0.376 (0.476) data 0.245 (0.345) loss_x loss_x 1.0049 (1.2245) acc_x 71.8750 (70.0000) lr 1.5878e-03 eta 0:00:14
epoch [62/200] batch [15/41] time 0.527 (0.471) data 0.395 (0.340) loss_x loss_x 1.6426 (1.3180) acc_x 53.1250 (65.8333) lr 1.5878e-03 eta 0:00:12
epoch [62/200] batch [20/41] time 0.512 (0.477) data 0.379 (0.346) loss_x loss_x 0.9453 (1.3073) acc_x 75.0000 (66.2500) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [25/41] time 0.495 (0.478) data 0.364 (0.347) loss_x loss_x 1.4521 (1.2973) acc_x 59.3750 (65.8750) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [30/41] time 0.583 (0.483) data 0.452 (0.352) loss_x loss_x 1.3896 (1.2728) acc_x 68.7500 (66.0417) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [35/41] time 0.449 (0.486) data 0.318 (0.355) loss_x loss_x 0.9297 (1.2578) acc_x 75.0000 (66.6071) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [40/41] time 0.556 (0.485) data 0.425 (0.354) loss_x loss_x 0.8042 (1.2572) acc_x 81.2500 (67.0312) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1644
confident_label rate tensor(0.4318, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1354
clean true:1333
clean false:21
clean_rate:0.9844903988183161
noisy true:159
noisy false:1623
after delete: len(clean_dataset) 1354
after delete: len(noisy_dataset) 1782
epoch [63/200] batch [5/42] time 0.377 (0.495) data 0.245 (0.364) loss_x loss_x 1.4082 (1.2330) acc_x 71.8750 (70.0000) lr 1.5750e-03 eta 0:00:18
epoch [63/200] batch [10/42] time 0.544 (0.463) data 0.412 (0.332) loss_x loss_x 1.3516 (1.2737) acc_x 68.7500 (69.0625) lr 1.5750e-03 eta 0:00:14
epoch [63/200] batch [15/42] time 0.428 (0.463) data 0.297 (0.332) loss_x loss_x 1.1992 (1.2488) acc_x 71.8750 (69.7917) lr 1.5750e-03 eta 0:00:12
epoch [63/200] batch [20/42] time 0.466 (0.469) data 0.334 (0.338) loss_x loss_x 1.6426 (1.3166) acc_x 56.2500 (67.8125) lr 1.5750e-03 eta 0:00:10
epoch [63/200] batch [25/42] time 0.548 (0.473) data 0.417 (0.342) loss_x loss_x 0.8916 (1.3157) acc_x 84.3750 (67.8750) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [30/42] time 0.492 (0.477) data 0.361 (0.346) loss_x loss_x 1.5674 (1.3315) acc_x 56.2500 (67.2917) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [35/42] time 0.384 (0.470) data 0.253 (0.339) loss_x loss_x 1.1846 (1.3094) acc_x 65.6250 (67.5000) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [40/42] time 0.498 (0.472) data 0.368 (0.341) loss_x loss_x 1.3457 (1.3029) acc_x 68.7500 (67.5781) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1595
confident_label rate tensor(0.4442, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1393
clean true:1375
clean false:18
clean_rate:0.9870782483847811
noisy true:166
noisy false:1577
after delete: len(clean_dataset) 1393
after delete: len(noisy_dataset) 1743
epoch [64/200] batch [5/43] time 0.600 (0.499) data 0.468 (0.367) loss_x loss_x 0.9316 (1.3402) acc_x 75.0000 (65.0000) lr 1.5621e-03 eta 0:00:18
epoch [64/200] batch [10/43] time 0.430 (0.480) data 0.299 (0.349) loss_x loss_x 1.1162 (1.3104) acc_x 68.7500 (66.2500) lr 1.5621e-03 eta 0:00:15
epoch [64/200] batch [15/43] time 0.490 (0.470) data 0.360 (0.338) loss_x loss_x 2.3516 (1.3146) acc_x 53.1250 (66.4583) lr 1.5621e-03 eta 0:00:13
epoch [64/200] batch [20/43] time 0.464 (0.473) data 0.333 (0.342) loss_x loss_x 1.1982 (1.3177) acc_x 68.7500 (66.0938) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [25/43] time 0.503 (0.466) data 0.372 (0.335) loss_x loss_x 1.5205 (1.3310) acc_x 62.5000 (66.5000) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [30/43] time 0.449 (0.458) data 0.318 (0.327) loss_x loss_x 1.0605 (1.3087) acc_x 71.8750 (67.3958) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [35/43] time 0.551 (0.462) data 0.419 (0.331) loss_x loss_x 1.5371 (1.3044) acc_x 59.3750 (67.4107) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [40/43] time 0.485 (0.468) data 0.355 (0.337) loss_x loss_x 1.2588 (1.3091) acc_x 65.6250 (66.9531) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1564
confident_label rate tensor(0.4515, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1416
clean true:1399
clean false:17
clean_rate:0.9879943502824858
noisy true:173
noisy false:1547
after delete: len(clean_dataset) 1416
after delete: len(noisy_dataset) 1720
epoch [65/200] batch [5/44] time 0.466 (0.482) data 0.335 (0.350) loss_x loss_x 1.2344 (1.2320) acc_x 71.8750 (69.3750) lr 1.5490e-03 eta 0:00:18
epoch [65/200] batch [10/44] time 0.457 (0.448) data 0.326 (0.316) loss_x loss_x 1.3779 (1.3518) acc_x 65.6250 (65.3125) lr 1.5490e-03 eta 0:00:15
epoch [65/200] batch [15/44] time 0.582 (0.453) data 0.451 (0.322) loss_x loss_x 1.2344 (1.3771) acc_x 75.0000 (65.4167) lr 1.5490e-03 eta 0:00:13
epoch [65/200] batch [20/44] time 0.652 (0.472) data 0.520 (0.340) loss_x loss_x 1.0225 (1.3210) acc_x 75.0000 (66.7188) lr 1.5490e-03 eta 0:00:11
epoch [65/200] batch [25/44] time 0.531 (0.477) data 0.400 (0.346) loss_x loss_x 1.0537 (1.2963) acc_x 71.8750 (66.8750) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [30/44] time 0.428 (0.470) data 0.297 (0.339) loss_x loss_x 1.1924 (1.3007) acc_x 78.1250 (66.5625) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [35/44] time 0.519 (0.464) data 0.387 (0.333) loss_x loss_x 1.4307 (1.3010) acc_x 71.8750 (66.8750) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [40/44] time 0.457 (0.459) data 0.326 (0.328) loss_x loss_x 1.0459 (1.2931) acc_x 65.6250 (66.5625) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1628
confident_label rate tensor(0.4365, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1369
clean true:1351
clean false:18
clean_rate:0.9868517165814463
noisy true:157
noisy false:1610
after delete: len(clean_dataset) 1369
after delete: len(noisy_dataset) 1767
epoch [66/200] batch [5/42] time 0.532 (0.435) data 0.402 (0.304) loss_x loss_x 1.6582 (1.4695) acc_x 62.5000 (65.6250) lr 1.5358e-03 eta 0:00:16
epoch [66/200] batch [10/42] time 0.381 (0.441) data 0.250 (0.310) loss_x loss_x 0.8286 (1.2425) acc_x 75.0000 (69.3750) lr 1.5358e-03 eta 0:00:14
epoch [66/200] batch [15/42] time 0.456 (0.454) data 0.326 (0.324) loss_x loss_x 0.8384 (1.2173) acc_x 84.3750 (69.3750) lr 1.5358e-03 eta 0:00:12
epoch [66/200] batch [20/42] time 0.392 (0.448) data 0.261 (0.317) loss_x loss_x 1.2617 (1.2339) acc_x 71.8750 (68.7500) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [25/42] time 0.392 (0.453) data 0.261 (0.322) loss_x loss_x 1.0107 (1.2226) acc_x 71.8750 (68.5000) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [30/42] time 0.413 (0.453) data 0.282 (0.322) loss_x loss_x 1.1807 (1.2127) acc_x 75.0000 (68.5417) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [35/42] time 0.378 (0.453) data 0.247 (0.322) loss_x loss_x 1.3809 (1.2618) acc_x 50.0000 (67.1429) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [40/42] time 0.427 (0.456) data 0.296 (0.325) loss_x loss_x 1.7090 (1.3059) acc_x 59.3750 (66.2500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1597
confident_label rate tensor(0.4439, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1392
clean true:1379
clean false:13
clean_rate:0.9906609195402298
noisy true:160
noisy false:1584
after delete: len(clean_dataset) 1392
after delete: len(noisy_dataset) 1744
epoch [67/200] batch [5/43] time 0.705 (0.502) data 0.574 (0.370) loss_x loss_x 1.7529 (1.4825) acc_x 59.3750 (65.0000) lr 1.5225e-03 eta 0:00:19
epoch [67/200] batch [10/43] time 0.457 (0.478) data 0.325 (0.347) loss_x loss_x 1.4707 (1.5311) acc_x 62.5000 (62.1875) lr 1.5225e-03 eta 0:00:15
epoch [67/200] batch [15/43] time 0.435 (0.487) data 0.304 (0.356) loss_x loss_x 1.4297 (1.4272) acc_x 56.2500 (63.3333) lr 1.5225e-03 eta 0:00:13
epoch [67/200] batch [20/43] time 0.500 (0.485) data 0.369 (0.354) loss_x loss_x 1.3164 (1.4249) acc_x 65.6250 (62.5000) lr 1.5225e-03 eta 0:00:11
epoch [67/200] batch [25/43] time 0.496 (0.475) data 0.365 (0.344) loss_x loss_x 1.2930 (1.4211) acc_x 71.8750 (62.3750) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [30/43] time 0.412 (0.476) data 0.281 (0.345) loss_x loss_x 1.9414 (1.4130) acc_x 59.3750 (62.9167) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [35/43] time 0.394 (0.465) data 0.263 (0.333) loss_x loss_x 1.6533 (1.4427) acc_x 62.5000 (62.4107) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [40/43] time 0.454 (0.467) data 0.323 (0.335) loss_x loss_x 1.4902 (1.4234) acc_x 62.5000 (62.9688) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1547
confident_label rate tensor(0.4563, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1431
clean true:1415
clean false:16
clean_rate:0.9888190076869322
noisy true:174
noisy false:1531
after delete: len(clean_dataset) 1431
after delete: len(noisy_dataset) 1705
epoch [68/200] batch [5/44] time 0.386 (0.467) data 0.255 (0.336) loss_x loss_x 1.6279 (1.3553) acc_x 53.1250 (65.0000) lr 1.5090e-03 eta 0:00:18
epoch [68/200] batch [10/44] time 0.557 (0.474) data 0.426 (0.343) loss_x loss_x 1.4561 (1.3817) acc_x 68.7500 (64.0625) lr 1.5090e-03 eta 0:00:16
epoch [68/200] batch [15/44] time 0.539 (0.475) data 0.408 (0.343) loss_x loss_x 0.9941 (1.4021) acc_x 75.0000 (63.5417) lr 1.5090e-03 eta 0:00:13
epoch [68/200] batch [20/44] time 0.414 (0.465) data 0.283 (0.334) loss_x loss_x 1.6084 (1.4631) acc_x 62.5000 (65.4688) lr 1.5090e-03 eta 0:00:11
epoch [68/200] batch [25/44] time 0.464 (0.463) data 0.334 (0.332) loss_x loss_x 1.1953 (1.4474) acc_x 65.6250 (65.2500) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [30/44] time 0.428 (0.467) data 0.297 (0.336) loss_x loss_x 0.9653 (1.3828) acc_x 71.8750 (66.3542) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [35/44] time 0.467 (0.467) data 0.335 (0.336) loss_x loss_x 1.2812 (1.3680) acc_x 65.6250 (66.5179) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [40/44] time 0.482 (0.466) data 0.350 (0.335) loss_x loss_x 1.5508 (1.3601) acc_x 62.5000 (66.5625) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1440
clean true:1424
clean false:16
clean_rate:0.9888888888888889
noisy true:169
noisy false:1527
after delete: len(clean_dataset) 1440
after delete: len(noisy_dataset) 1696
epoch [69/200] batch [5/45] time 0.537 (0.465) data 0.406 (0.335) loss_x loss_x 1.4199 (1.2578) acc_x 62.5000 (65.0000) lr 1.4955e-03 eta 0:00:18
epoch [69/200] batch [10/45] time 0.454 (0.446) data 0.323 (0.315) loss_x loss_x 1.2588 (1.2874) acc_x 59.3750 (67.1875) lr 1.4955e-03 eta 0:00:15
epoch [69/200] batch [15/45] time 0.378 (0.441) data 0.247 (0.310) loss_x loss_x 1.5830 (1.3099) acc_x 56.2500 (67.0833) lr 1.4955e-03 eta 0:00:13
epoch [69/200] batch [20/45] time 0.657 (0.458) data 0.525 (0.328) loss_x loss_x 0.8066 (1.3079) acc_x 78.1250 (67.0312) lr 1.4955e-03 eta 0:00:11
epoch [69/200] batch [25/45] time 0.484 (0.480) data 0.352 (0.349) loss_x loss_x 1.5791 (1.2950) acc_x 53.1250 (66.7500) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [30/45] time 0.358 (0.470) data 0.227 (0.339) loss_x loss_x 1.5557 (1.3129) acc_x 56.2500 (65.9375) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [35/45] time 0.515 (0.462) data 0.384 (0.331) loss_x loss_x 1.4463 (1.3073) acc_x 50.0000 (65.9821) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [40/45] time 0.398 (0.462) data 0.267 (0.331) loss_x loss_x 1.5684 (1.3107) acc_x 65.6250 (66.4844) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [45/45] time 0.501 (0.461) data 0.369 (0.330) loss_x loss_x 1.1758 (1.3296) acc_x 68.7500 (65.9028) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1583
confident_label rate tensor(0.4506, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1413
clean true:1396
clean false:17
clean_rate:0.9879688605803255
noisy true:157
noisy false:1566
after delete: len(clean_dataset) 1413
after delete: len(noisy_dataset) 1723
epoch [70/200] batch [5/44] time 0.500 (0.492) data 0.368 (0.361) loss_x loss_x 1.1943 (1.3807) acc_x 68.7500 (64.3750) lr 1.4818e-03 eta 0:00:19
epoch [70/200] batch [10/44] time 0.592 (0.506) data 0.461 (0.374) loss_x loss_x 1.3115 (1.2724) acc_x 68.7500 (68.1250) lr 1.4818e-03 eta 0:00:17
epoch [70/200] batch [15/44] time 0.418 (0.488) data 0.287 (0.357) loss_x loss_x 1.5127 (1.2784) acc_x 50.0000 (67.9167) lr 1.4818e-03 eta 0:00:14
epoch [70/200] batch [20/44] time 0.752 (0.500) data 0.621 (0.369) loss_x loss_x 0.9180 (1.3065) acc_x 81.2500 (67.1875) lr 1.4818e-03 eta 0:00:12
epoch [70/200] batch [25/44] time 0.543 (0.486) data 0.412 (0.355) loss_x loss_x 1.4785 (1.3055) acc_x 62.5000 (67.2500) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [30/44] time 0.416 (0.478) data 0.284 (0.347) loss_x loss_x 1.6553 (1.3257) acc_x 56.2500 (67.1875) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [35/44] time 0.372 (0.473) data 0.241 (0.341) loss_x loss_x 0.9648 (1.3130) acc_x 75.0000 (67.3214) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [40/44] time 0.413 (0.470) data 0.282 (0.339) loss_x loss_x 1.4346 (1.3014) acc_x 65.6250 (67.5781) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1601
confident_label rate tensor(0.4448, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1395
clean true:1383
clean false:12
clean_rate:0.9913978494623656
noisy true:152
noisy false:1589
after delete: len(clean_dataset) 1395
after delete: len(noisy_dataset) 1741
epoch [71/200] batch [5/43] time 0.393 (0.463) data 0.262 (0.331) loss_x loss_x 1.3262 (1.1541) acc_x 62.5000 (69.3750) lr 1.4679e-03 eta 0:00:17
epoch [71/200] batch [10/43] time 0.442 (0.479) data 0.311 (0.348) loss_x loss_x 1.5039 (1.3539) acc_x 50.0000 (63.7500) lr 1.4679e-03 eta 0:00:15
epoch [71/200] batch [15/43] time 0.500 (0.483) data 0.369 (0.352) loss_x loss_x 0.9863 (1.3162) acc_x 75.0000 (63.5417) lr 1.4679e-03 eta 0:00:13
epoch [71/200] batch [20/43] time 0.552 (0.486) data 0.421 (0.355) loss_x loss_x 1.5752 (1.2521) acc_x 65.6250 (66.2500) lr 1.4679e-03 eta 0:00:11
epoch [71/200] batch [25/43] time 0.565 (0.492) data 0.434 (0.361) loss_x loss_x 0.7671 (1.2480) acc_x 84.3750 (66.5000) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [30/43] time 0.452 (0.492) data 0.321 (0.360) loss_x loss_x 1.5957 (1.2512) acc_x 53.1250 (66.1458) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [35/43] time 0.839 (0.497) data 0.707 (0.366) loss_x loss_x 1.6006 (1.2762) acc_x 68.7500 (66.8750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [40/43] time 0.402 (0.493) data 0.271 (0.362) loss_x loss_x 1.2920 (1.3000) acc_x 71.8750 (66.4844) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1436
clean true:1418
clean false:18
clean_rate:0.9874651810584958
noisy true:163
noisy false:1537
after delete: len(clean_dataset) 1436
after delete: len(noisy_dataset) 1700
epoch [72/200] batch [5/44] time 0.638 (0.520) data 0.507 (0.389) loss_x loss_x 1.4346 (1.4424) acc_x 65.6250 (65.0000) lr 1.4540e-03 eta 0:00:20
epoch [72/200] batch [10/44] time 0.356 (0.491) data 0.225 (0.359) loss_x loss_x 1.2666 (1.4103) acc_x 62.5000 (62.5000) lr 1.4540e-03 eta 0:00:16
epoch [72/200] batch [15/44] time 0.420 (0.470) data 0.289 (0.338) loss_x loss_x 1.0176 (1.2674) acc_x 68.7500 (66.8750) lr 1.4540e-03 eta 0:00:13
epoch [72/200] batch [20/44] time 0.492 (0.460) data 0.360 (0.329) loss_x loss_x 1.4287 (1.2869) acc_x 53.1250 (64.8438) lr 1.4540e-03 eta 0:00:11
epoch [72/200] batch [25/44] time 0.403 (0.461) data 0.272 (0.330) loss_x loss_x 1.6201 (1.3104) acc_x 62.5000 (64.5000) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [30/44] time 0.435 (0.458) data 0.304 (0.326) loss_x loss_x 1.6572 (1.3114) acc_x 59.3750 (64.4792) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [35/44] time 0.568 (0.460) data 0.437 (0.328) loss_x loss_x 1.1865 (1.2977) acc_x 75.0000 (64.6429) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [40/44] time 0.438 (0.459) data 0.307 (0.328) loss_x loss_x 1.6816 (1.3257) acc_x 59.3750 (64.4531) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1560
confident_label rate tensor(0.4582, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1437
clean true:1417
clean false:20
clean_rate:0.9860821155184412
noisy true:159
noisy false:1540
after delete: len(clean_dataset) 1437
after delete: len(noisy_dataset) 1699
epoch [73/200] batch [5/44] time 0.603 (0.455) data 0.468 (0.322) loss_x loss_x 1.4336 (1.4215) acc_x 65.6250 (64.3750) lr 1.4399e-03 eta 0:00:17
epoch [73/200] batch [10/44] time 0.493 (0.476) data 0.361 (0.344) loss_x loss_x 0.9966 (1.3186) acc_x 75.0000 (67.5000) lr 1.4399e-03 eta 0:00:16
epoch [73/200] batch [15/44] time 0.395 (0.478) data 0.263 (0.346) loss_x loss_x 1.7002 (1.3517) acc_x 50.0000 (66.0417) lr 1.4399e-03 eta 0:00:13
epoch [73/200] batch [20/44] time 0.455 (0.466) data 0.324 (0.334) loss_x loss_x 1.4766 (1.3367) acc_x 68.7500 (65.6250) lr 1.4399e-03 eta 0:00:11
epoch [73/200] batch [25/44] time 0.412 (0.460) data 0.281 (0.329) loss_x loss_x 1.2148 (1.3336) acc_x 78.1250 (65.7500) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [30/44] time 0.532 (0.457) data 0.401 (0.326) loss_x loss_x 1.3311 (1.3289) acc_x 65.6250 (65.8333) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [35/44] time 0.445 (0.457) data 0.314 (0.326) loss_x loss_x 1.2109 (1.3231) acc_x 71.8750 (65.7143) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [40/44] time 0.563 (0.458) data 0.432 (0.326) loss_x loss_x 1.3789 (1.3316) acc_x 65.6250 (64.6094) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1544
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1440
clean true:1420
clean false:20
clean_rate:0.9861111111111112
noisy true:172
noisy false:1524
after delete: len(clean_dataset) 1440
after delete: len(noisy_dataset) 1696
epoch [74/200] batch [5/45] time 0.405 (0.446) data 0.274 (0.315) loss_x loss_x 1.0283 (1.1700) acc_x 75.0000 (70.0000) lr 1.4258e-03 eta 0:00:17
epoch [74/200] batch [10/45] time 0.405 (0.430) data 0.274 (0.299) loss_x loss_x 1.2061 (1.3038) acc_x 68.7500 (66.5625) lr 1.4258e-03 eta 0:00:15
epoch [74/200] batch [15/45] time 0.601 (0.462) data 0.470 (0.331) loss_x loss_x 1.5312 (1.3146) acc_x 62.5000 (68.1250) lr 1.4258e-03 eta 0:00:13
epoch [74/200] batch [20/45] time 0.414 (0.470) data 0.282 (0.338) loss_x loss_x 1.2852 (1.2743) acc_x 71.8750 (68.5938) lr 1.4258e-03 eta 0:00:11
epoch [74/200] batch [25/45] time 0.354 (0.466) data 0.223 (0.335) loss_x loss_x 1.2930 (1.3300) acc_x 62.5000 (67.3750) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [30/45] time 0.437 (0.461) data 0.305 (0.330) loss_x loss_x 1.2578 (1.3447) acc_x 62.5000 (66.0417) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [35/45] time 0.447 (0.460) data 0.315 (0.329) loss_x loss_x 2.0078 (1.3681) acc_x 56.2500 (64.9107) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [40/45] time 0.440 (0.459) data 0.308 (0.328) loss_x loss_x 1.8145 (1.3834) acc_x 59.3750 (65.2344) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [45/45] time 0.422 (0.458) data 0.291 (0.327) loss_x loss_x 1.3975 (1.3823) acc_x 68.7500 (65.1389) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1545
confident_label rate tensor(0.4624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1450
clean true:1432
clean false:18
clean_rate:0.9875862068965517
noisy true:159
noisy false:1527
after delete: len(clean_dataset) 1450
after delete: len(noisy_dataset) 1686
epoch [75/200] batch [5/45] time 0.338 (0.433) data 0.207 (0.302) loss_x loss_x 1.7666 (1.6471) acc_x 43.7500 (56.2500) lr 1.4115e-03 eta 0:00:17
epoch [75/200] batch [10/45] time 0.450 (0.432) data 0.319 (0.301) loss_x loss_x 1.4502 (1.4544) acc_x 62.5000 (61.2500) lr 1.4115e-03 eta 0:00:15
epoch [75/200] batch [15/45] time 0.544 (0.446) data 0.413 (0.314) loss_x loss_x 1.1465 (1.4493) acc_x 68.7500 (62.0833) lr 1.4115e-03 eta 0:00:13
epoch [75/200] batch [20/45] time 0.478 (0.449) data 0.347 (0.318) loss_x loss_x 1.1885 (1.3652) acc_x 65.6250 (64.2188) lr 1.4115e-03 eta 0:00:11
epoch [75/200] batch [25/45] time 0.418 (0.443) data 0.287 (0.312) loss_x loss_x 1.2949 (1.3714) acc_x 68.7500 (64.2500) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [30/45] time 0.538 (0.456) data 0.408 (0.324) loss_x loss_x 1.2637 (1.3823) acc_x 65.6250 (64.6875) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [35/45] time 0.428 (0.459) data 0.297 (0.327) loss_x loss_x 1.1133 (1.3650) acc_x 75.0000 (65.6250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [40/45] time 0.619 (0.466) data 0.488 (0.334) loss_x loss_x 1.1582 (1.3545) acc_x 62.5000 (65.8594) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [45/45] time 0.507 (0.472) data 0.376 (0.341) loss_x loss_x 1.4180 (1.3632) acc_x 65.6250 (65.7639) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.4314, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1353
clean true:1338
clean false:15
clean_rate:0.9889135254988913
noisy true:158
noisy false:1625
after delete: len(clean_dataset) 1353
after delete: len(noisy_dataset) 1783
epoch [76/200] batch [5/42] time 0.451 (0.453) data 0.319 (0.322) loss_x loss_x 1.4932 (1.2351) acc_x 71.8750 (70.0000) lr 1.3971e-03 eta 0:00:16
epoch [76/200] batch [10/42] time 0.521 (0.460) data 0.389 (0.328) loss_x loss_x 1.0781 (1.2828) acc_x 71.8750 (69.0625) lr 1.3971e-03 eta 0:00:14
epoch [76/200] batch [15/42] time 0.526 (0.464) data 0.395 (0.332) loss_x loss_x 1.3271 (1.2912) acc_x 71.8750 (68.3333) lr 1.3971e-03 eta 0:00:12
epoch [76/200] batch [20/42] time 0.427 (0.458) data 0.295 (0.326) loss_x loss_x 1.0361 (1.2498) acc_x 71.8750 (68.9062) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [25/42] time 0.466 (0.475) data 0.334 (0.344) loss_x loss_x 1.2617 (1.2943) acc_x 65.6250 (67.8750) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [30/42] time 0.450 (0.468) data 0.319 (0.337) loss_x loss_x 1.2637 (1.2826) acc_x 65.6250 (67.6042) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [35/42] time 0.464 (0.469) data 0.332 (0.338) loss_x loss_x 1.3613 (1.2754) acc_x 59.3750 (67.5893) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [40/42] time 0.369 (0.468) data 0.238 (0.337) loss_x loss_x 1.7598 (1.2776) acc_x 56.2500 (67.1875) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1546
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1436
clean true:1421
clean false:15
clean_rate:0.9895543175487466
noisy true:169
noisy false:1531
after delete: len(clean_dataset) 1436
after delete: len(noisy_dataset) 1700
epoch [77/200] batch [5/44] time 0.602 (0.527) data 0.471 (0.396) loss_x loss_x 1.1807 (1.0648) acc_x 75.0000 (74.3750) lr 1.3827e-03 eta 0:00:20
epoch [77/200] batch [10/44] time 0.501 (0.502) data 0.369 (0.370) loss_x loss_x 1.1729 (1.1008) acc_x 71.8750 (74.0625) lr 1.3827e-03 eta 0:00:17
epoch [77/200] batch [15/44] time 0.490 (0.497) data 0.358 (0.366) loss_x loss_x 1.0059 (1.1551) acc_x 71.8750 (71.8750) lr 1.3827e-03 eta 0:00:14
epoch [77/200] batch [20/44] time 0.429 (0.490) data 0.298 (0.358) loss_x loss_x 1.3936 (1.2417) acc_x 59.3750 (69.6875) lr 1.3827e-03 eta 0:00:11
epoch [77/200] batch [25/44] time 0.572 (0.488) data 0.441 (0.356) loss_x loss_x 0.9282 (1.2629) acc_x 78.1250 (69.0000) lr 1.3827e-03 eta 0:00:09
epoch [77/200] batch [30/44] time 0.588 (0.490) data 0.457 (0.359) loss_x loss_x 1.5479 (1.2561) acc_x 65.6250 (69.4792) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [35/44] time 0.359 (0.477) data 0.227 (0.345) loss_x loss_x 1.3564 (1.2471) acc_x 68.7500 (69.4643) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [40/44] time 0.457 (0.477) data 0.326 (0.346) loss_x loss_x 1.2246 (1.2631) acc_x 71.8750 (68.9062) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.4557, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1429
clean true:1411
clean false:18
clean_rate:0.9874037788663401
noisy true:158
noisy false:1549
after delete: len(clean_dataset) 1429
after delete: len(noisy_dataset) 1707
epoch [78/200] batch [5/44] time 0.474 (0.482) data 0.343 (0.352) loss_x loss_x 1.6172 (1.4000) acc_x 56.2500 (65.0000) lr 1.3681e-03 eta 0:00:18
epoch [78/200] batch [10/44] time 0.445 (0.476) data 0.314 (0.345) loss_x loss_x 1.2305 (1.3430) acc_x 59.3750 (65.0000) lr 1.3681e-03 eta 0:00:16
epoch [78/200] batch [15/44] time 0.401 (0.476) data 0.270 (0.345) loss_x loss_x 1.6084 (1.3636) acc_x 56.2500 (64.5833) lr 1.3681e-03 eta 0:00:13
epoch [78/200] batch [20/44] time 0.498 (0.470) data 0.367 (0.339) loss_x loss_x 1.5312 (1.3813) acc_x 62.5000 (63.9062) lr 1.3681e-03 eta 0:00:11
epoch [78/200] batch [25/44] time 0.489 (0.465) data 0.358 (0.334) loss_x loss_x 1.8740 (1.4107) acc_x 46.8750 (63.6250) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [30/44] time 0.389 (0.466) data 0.257 (0.335) loss_x loss_x 1.3818 (1.3880) acc_x 71.8750 (65.0000) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [35/44] time 0.441 (0.465) data 0.310 (0.334) loss_x loss_x 1.6006 (1.3753) acc_x 56.2500 (64.7321) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [40/44] time 0.461 (0.465) data 0.330 (0.334) loss_x loss_x 1.4404 (1.3732) acc_x 65.6250 (65.3125) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1528
confident_label rate tensor(0.4624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1450
clean true:1435
clean false:15
clean_rate:0.9896551724137931
noisy true:173
noisy false:1513
after delete: len(clean_dataset) 1450
after delete: len(noisy_dataset) 1686
epoch [79/200] batch [5/45] time 0.477 (0.442) data 0.345 (0.311) loss_x loss_x 1.6309 (1.4211) acc_x 46.8750 (58.7500) lr 1.3535e-03 eta 0:00:17
epoch [79/200] batch [10/45] time 0.431 (0.443) data 0.300 (0.311) loss_x loss_x 1.0771 (1.3947) acc_x 68.7500 (61.5625) lr 1.3535e-03 eta 0:00:15
epoch [79/200] batch [15/45] time 0.384 (0.441) data 0.253 (0.309) loss_x loss_x 0.9131 (1.2614) acc_x 84.3750 (65.8333) lr 1.3535e-03 eta 0:00:13
epoch [79/200] batch [20/45] time 0.428 (0.452) data 0.297 (0.321) loss_x loss_x 1.6514 (1.2708) acc_x 68.7500 (66.0938) lr 1.3535e-03 eta 0:00:11
epoch [79/200] batch [25/45] time 0.446 (0.456) data 0.315 (0.325) loss_x loss_x 1.4854 (1.3101) acc_x 62.5000 (65.7500) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [30/45] time 0.353 (0.457) data 0.222 (0.325) loss_x loss_x 1.6553 (1.3340) acc_x 56.2500 (65.7292) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [35/45] time 0.477 (0.453) data 0.346 (0.322) loss_x loss_x 0.9370 (1.3082) acc_x 75.0000 (65.9821) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [40/45] time 0.429 (0.454) data 0.298 (0.323) loss_x loss_x 1.1826 (1.3004) acc_x 65.6250 (65.9375) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [45/45] time 0.505 (0.451) data 0.373 (0.319) loss_x loss_x 1.9746 (1.3242) acc_x 43.7500 (65.2083) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1550
confident_label rate tensor(0.4566, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1432
clean true:1415
clean false:17
clean_rate:0.9881284916201117
noisy true:171
noisy false:1533
after delete: len(clean_dataset) 1432
after delete: len(noisy_dataset) 1704
epoch [80/200] batch [5/44] time 0.496 (0.492) data 0.365 (0.360) loss_x loss_x 1.7490 (1.4641) acc_x 56.2500 (63.1250) lr 1.3387e-03 eta 0:00:19
epoch [80/200] batch [10/44] time 0.403 (0.477) data 0.272 (0.346) loss_x loss_x 1.3984 (1.3122) acc_x 59.3750 (66.2500) lr 1.3387e-03 eta 0:00:16
epoch [80/200] batch [15/44] time 0.426 (0.464) data 0.296 (0.333) loss_x loss_x 1.8145 (1.3809) acc_x 59.3750 (65.6250) lr 1.3387e-03 eta 0:00:13
epoch [80/200] batch [20/44] time 0.469 (0.472) data 0.338 (0.340) loss_x loss_x 1.4795 (1.3654) acc_x 68.7500 (65.6250) lr 1.3387e-03 eta 0:00:11
epoch [80/200] batch [25/44] time 0.347 (0.466) data 0.215 (0.334) loss_x loss_x 1.5137 (1.3522) acc_x 56.2500 (65.6250) lr 1.3387e-03 eta 0:00:08
epoch [80/200] batch [30/44] time 0.409 (0.464) data 0.278 (0.333) loss_x loss_x 1.2832 (1.3577) acc_x 68.7500 (65.0000) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [35/44] time 0.364 (0.467) data 0.232 (0.336) loss_x loss_x 1.3545 (1.3482) acc_x 62.5000 (65.2679) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [40/44] time 0.424 (0.470) data 0.293 (0.339) loss_x loss_x 1.7373 (1.3496) acc_x 50.0000 (65.1562) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1426
clean true:1413
clean false:13
clean_rate:0.9908835904628331
noisy true:156
noisy false:1554
after delete: len(clean_dataset) 1426
after delete: len(noisy_dataset) 1710
epoch [81/200] batch [5/44] time 0.516 (0.611) data 0.385 (0.478) loss_x loss_x 0.6924 (1.2617) acc_x 75.0000 (66.8750) lr 1.3239e-03 eta 0:00:23
epoch [81/200] batch [10/44] time 0.424 (0.507) data 0.292 (0.375) loss_x loss_x 1.5420 (1.3790) acc_x 59.3750 (65.6250) lr 1.3239e-03 eta 0:00:17
epoch [81/200] batch [15/44] time 0.423 (0.482) data 0.293 (0.350) loss_x loss_x 1.1025 (1.3770) acc_x 75.0000 (65.6250) lr 1.3239e-03 eta 0:00:13
epoch [81/200] batch [20/44] time 0.511 (0.475) data 0.380 (0.344) loss_x loss_x 0.9111 (1.3659) acc_x 75.0000 (65.7812) lr 1.3239e-03 eta 0:00:11
epoch [81/200] batch [25/44] time 0.507 (0.474) data 0.376 (0.343) loss_x loss_x 1.5342 (1.3745) acc_x 62.5000 (66.0000) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [30/44] time 0.441 (0.476) data 0.310 (0.344) loss_x loss_x 1.0723 (1.3564) acc_x 71.8750 (66.3542) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [35/44] time 0.367 (0.478) data 0.236 (0.346) loss_x loss_x 1.6553 (1.3460) acc_x 59.3750 (66.3393) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [40/44] time 0.395 (0.478) data 0.264 (0.346) loss_x loss_x 1.2578 (1.3591) acc_x 71.8750 (66.1719) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1577
confident_label rate tensor(0.4464, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1400
clean true:1388
clean false:12
clean_rate:0.9914285714285714
noisy true:171
noisy false:1565
after delete: len(clean_dataset) 1400
after delete: len(noisy_dataset) 1736
epoch [82/200] batch [5/43] time 0.551 (0.521) data 0.415 (0.389) loss_x loss_x 1.3047 (1.2848) acc_x 62.5000 (63.1250) lr 1.3090e-03 eta 0:00:19
epoch [82/200] batch [10/43] time 0.462 (0.526) data 0.331 (0.394) loss_x loss_x 1.2197 (1.2555) acc_x 68.7500 (64.6875) lr 1.3090e-03 eta 0:00:17
epoch [82/200] batch [15/43] time 0.510 (0.514) data 0.379 (0.382) loss_x loss_x 1.3838 (1.2710) acc_x 65.6250 (65.0000) lr 1.3090e-03 eta 0:00:14
epoch [82/200] batch [20/43] time 0.533 (0.505) data 0.402 (0.373) loss_x loss_x 1.1553 (1.2127) acc_x 62.5000 (67.3438) lr 1.3090e-03 eta 0:00:11
epoch [82/200] batch [25/43] time 0.421 (0.491) data 0.290 (0.359) loss_x loss_x 0.8135 (1.1735) acc_x 81.2500 (68.6250) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [30/43] time 0.451 (0.496) data 0.320 (0.364) loss_x loss_x 1.4346 (1.1751) acc_x 62.5000 (68.8542) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [35/43] time 0.472 (0.490) data 0.341 (0.359) loss_x loss_x 1.3203 (1.1993) acc_x 56.2500 (68.4821) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [40/43] time 0.462 (0.491) data 0.330 (0.359) loss_x loss_x 0.9336 (1.1882) acc_x 65.6250 (68.5156) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1535
confident_label rate tensor(0.4611, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1446
clean true:1428
clean false:18
clean_rate:0.9875518672199171
noisy true:173
noisy false:1517
after delete: len(clean_dataset) 1446
after delete: len(noisy_dataset) 1690
epoch [83/200] batch [5/45] time 0.476 (0.463) data 0.345 (0.332) loss_x loss_x 1.1250 (1.1949) acc_x 62.5000 (65.0000) lr 1.2940e-03 eta 0:00:18
epoch [83/200] batch [10/45] time 0.469 (0.484) data 0.334 (0.352) loss_x loss_x 1.4043 (1.1245) acc_x 65.6250 (70.3125) lr 1.2940e-03 eta 0:00:16
epoch [83/200] batch [15/45] time 0.337 (0.490) data 0.205 (0.358) loss_x loss_x 1.3848 (1.2114) acc_x 65.6250 (69.5833) lr 1.2940e-03 eta 0:00:14
epoch [83/200] batch [20/45] time 0.420 (0.487) data 0.288 (0.355) loss_x loss_x 1.5439 (1.2410) acc_x 62.5000 (69.6875) lr 1.2940e-03 eta 0:00:12
epoch [83/200] batch [25/45] time 0.492 (0.472) data 0.360 (0.341) loss_x loss_x 0.8652 (1.2541) acc_x 78.1250 (68.2500) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [30/45] time 0.414 (0.476) data 0.283 (0.344) loss_x loss_x 1.2930 (1.2697) acc_x 78.1250 (67.5000) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [35/45] time 0.585 (0.479) data 0.454 (0.347) loss_x loss_x 1.1299 (1.2451) acc_x 68.7500 (68.0357) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [40/45] time 0.407 (0.475) data 0.275 (0.344) loss_x loss_x 1.0938 (1.2588) acc_x 71.8750 (67.7344) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [45/45] time 0.489 (0.480) data 0.358 (0.348) loss_x loss_x 0.8916 (1.2423) acc_x 68.7500 (67.9167) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1528
confident_label rate tensor(0.4611, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1446
clean true:1427
clean false:19
clean_rate:0.9868603042876902
noisy true:181
noisy false:1509
after delete: len(clean_dataset) 1446
after delete: len(noisy_dataset) 1690
epoch [84/200] batch [5/45] time 0.492 (0.464) data 0.360 (0.332) loss_x loss_x 1.4209 (1.1583) acc_x 65.6250 (71.8750) lr 1.2790e-03 eta 0:00:18
epoch [84/200] batch [10/45] time 0.479 (0.463) data 0.347 (0.331) loss_x loss_x 1.3320 (1.2139) acc_x 78.1250 (72.1875) lr 1.2790e-03 eta 0:00:16
epoch [84/200] batch [15/45] time 0.430 (0.489) data 0.299 (0.357) loss_x loss_x 0.8594 (1.2012) acc_x 75.0000 (70.4167) lr 1.2790e-03 eta 0:00:14
epoch [84/200] batch [20/45] time 0.558 (0.490) data 0.427 (0.358) loss_x loss_x 1.4766 (1.2406) acc_x 56.2500 (69.2188) lr 1.2790e-03 eta 0:00:12
epoch [84/200] batch [25/45] time 0.538 (0.483) data 0.407 (0.352) loss_x loss_x 1.4844 (1.2766) acc_x 62.5000 (68.2500) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [30/45] time 0.428 (0.473) data 0.297 (0.342) loss_x loss_x 1.1182 (1.2806) acc_x 84.3750 (68.0208) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [35/45] time 0.393 (0.470) data 0.262 (0.339) loss_x loss_x 1.5186 (1.2794) acc_x 62.5000 (67.7679) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [40/45] time 0.447 (0.468) data 0.316 (0.337) loss_x loss_x 1.1572 (1.2877) acc_x 68.7500 (67.4219) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [45/45] time 0.346 (0.463) data 0.215 (0.332) loss_x loss_x 1.6553 (1.3131) acc_x 56.2500 (66.7361) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1560
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1426
clean true:1412
clean false:14
clean_rate:0.9901823281907434
noisy true:164
noisy false:1546
after delete: len(clean_dataset) 1426
after delete: len(noisy_dataset) 1710
epoch [85/200] batch [5/44] time 0.401 (0.446) data 0.269 (0.315) loss_x loss_x 0.9189 (1.2148) acc_x 84.3750 (70.0000) lr 1.2639e-03 eta 0:00:17
epoch [85/200] batch [10/44] time 0.406 (0.462) data 0.275 (0.331) loss_x loss_x 1.1045 (1.3018) acc_x 68.7500 (66.5625) lr 1.2639e-03 eta 0:00:15
epoch [85/200] batch [15/44] time 0.483 (0.455) data 0.352 (0.324) loss_x loss_x 1.3389 (1.3404) acc_x 65.6250 (66.4583) lr 1.2639e-03 eta 0:00:13
epoch [85/200] batch [20/44] time 0.377 (0.463) data 0.246 (0.332) loss_x loss_x 1.5244 (1.3322) acc_x 62.5000 (67.5000) lr 1.2639e-03 eta 0:00:11
epoch [85/200] batch [25/44] time 0.324 (0.459) data 0.194 (0.328) loss_x loss_x 1.3975 (1.3228) acc_x 50.0000 (67.1250) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [30/44] time 0.352 (0.453) data 0.221 (0.322) loss_x loss_x 1.2783 (1.3256) acc_x 75.0000 (66.4583) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [35/44] time 0.433 (0.449) data 0.300 (0.318) loss_x loss_x 0.9775 (1.3101) acc_x 75.0000 (66.4286) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [40/44] time 0.447 (0.449) data 0.316 (0.318) loss_x loss_x 1.3672 (1.3141) acc_x 68.7500 (66.5625) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.4595, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1441
clean true:1427
clean false:14
clean_rate:0.9902845246356696
noisy true:166
noisy false:1529
after delete: len(clean_dataset) 1441
after delete: len(noisy_dataset) 1695
epoch [86/200] batch [5/45] time 0.577 (0.530) data 0.446 (0.399) loss_x loss_x 0.7808 (1.1176) acc_x 84.3750 (70.6250) lr 1.2487e-03 eta 0:00:21
epoch [86/200] batch [10/45] time 0.566 (0.502) data 0.436 (0.372) loss_x loss_x 1.3721 (1.1907) acc_x 71.8750 (70.9375) lr 1.2487e-03 eta 0:00:17
epoch [86/200] batch [15/45] time 0.432 (0.490) data 0.300 (0.359) loss_x loss_x 1.1426 (1.1632) acc_x 56.2500 (69.7917) lr 1.2487e-03 eta 0:00:14
epoch [86/200] batch [20/45] time 0.597 (0.483) data 0.466 (0.352) loss_x loss_x 0.9395 (1.1285) acc_x 75.0000 (70.6250) lr 1.2487e-03 eta 0:00:12
epoch [86/200] batch [25/45] time 0.515 (0.485) data 0.384 (0.353) loss_x loss_x 1.8115 (1.1931) acc_x 62.5000 (69.6250) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [30/45] time 0.572 (0.488) data 0.441 (0.357) loss_x loss_x 1.9385 (1.2134) acc_x 59.3750 (68.8542) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [35/45] time 0.434 (0.478) data 0.303 (0.347) loss_x loss_x 1.0732 (1.2297) acc_x 68.7500 (68.7500) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [40/45] time 0.556 (0.477) data 0.424 (0.346) loss_x loss_x 1.5977 (1.2422) acc_x 71.8750 (68.9062) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [45/45] time 0.387 (0.477) data 0.256 (0.346) loss_x loss_x 1.3750 (1.2415) acc_x 62.5000 (68.9583) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1421
clean true:1402
clean false:19
clean_rate:0.9866291344123856
noisy true:168
noisy false:1547
after delete: len(clean_dataset) 1421
after delete: len(noisy_dataset) 1715
epoch [87/200] batch [5/44] time 0.444 (0.423) data 0.313 (0.292) loss_x loss_x 1.2051 (1.1732) acc_x 81.2500 (69.3750) lr 1.2334e-03 eta 0:00:16
epoch [87/200] batch [10/44] time 0.598 (0.470) data 0.467 (0.340) loss_x loss_x 0.9834 (1.1671) acc_x 68.7500 (68.4375) lr 1.2334e-03 eta 0:00:15
epoch [87/200] batch [15/44] time 0.468 (0.458) data 0.336 (0.327) loss_x loss_x 1.1045 (1.1662) acc_x 62.5000 (68.7500) lr 1.2334e-03 eta 0:00:13
epoch [87/200] batch [20/44] time 0.464 (0.460) data 0.333 (0.329) loss_x loss_x 1.1504 (1.1867) acc_x 62.5000 (67.9688) lr 1.2334e-03 eta 0:00:11
epoch [87/200] batch [25/44] time 0.780 (0.477) data 0.643 (0.345) loss_x loss_x 1.0732 (1.2236) acc_x 81.2500 (67.6250) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [30/44] time 0.350 (0.471) data 0.218 (0.339) loss_x loss_x 1.3125 (1.2485) acc_x 62.5000 (67.5000) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [35/44] time 0.604 (0.478) data 0.473 (0.347) loss_x loss_x 1.2949 (1.2499) acc_x 71.8750 (67.3214) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [40/44] time 0.501 (0.474) data 0.370 (0.343) loss_x loss_x 1.0557 (1.2636) acc_x 78.1250 (67.3438) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1409
clean true:1398
clean false:11
clean_rate:0.9921930447125621
noisy true:175
noisy false:1552
after delete: len(clean_dataset) 1409
after delete: len(noisy_dataset) 1727
epoch [88/200] batch [5/44] time 0.440 (0.443) data 0.308 (0.312) loss_x loss_x 1.2627 (1.3687) acc_x 65.6250 (61.8750) lr 1.2181e-03 eta 0:00:17
epoch [88/200] batch [10/44] time 0.488 (0.440) data 0.357 (0.309) loss_x loss_x 1.2021 (1.2962) acc_x 75.0000 (68.4375) lr 1.2181e-03 eta 0:00:14
epoch [88/200] batch [15/44] time 0.438 (0.449) data 0.306 (0.318) loss_x loss_x 1.0225 (1.2607) acc_x 71.8750 (68.3333) lr 1.2181e-03 eta 0:00:13
epoch [88/200] batch [20/44] time 0.396 (0.438) data 0.265 (0.307) loss_x loss_x 1.0918 (1.3338) acc_x 75.0000 (66.8750) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [25/44] time 0.427 (0.444) data 0.296 (0.313) loss_x loss_x 1.3301 (1.3554) acc_x 71.8750 (66.6250) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [30/44] time 0.437 (0.445) data 0.305 (0.313) loss_x loss_x 1.2539 (1.3450) acc_x 62.5000 (66.3542) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [35/44] time 0.498 (0.465) data 0.367 (0.334) loss_x loss_x 0.8232 (1.3240) acc_x 75.0000 (66.6071) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [40/44] time 0.419 (0.461) data 0.288 (0.329) loss_x loss_x 1.4092 (1.3063) acc_x 68.7500 (67.1875) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1535
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1468
clean true:1448
clean false:20
clean_rate:0.9863760217983651
noisy true:153
noisy false:1515
after delete: len(clean_dataset) 1468
after delete: len(noisy_dataset) 1668
epoch [89/200] batch [5/45] time 0.363 (0.424) data 0.233 (0.293) loss_x loss_x 0.8652 (1.0025) acc_x 84.3750 (75.0000) lr 1.2028e-03 eta 0:00:16
epoch [89/200] batch [10/45] time 0.562 (0.460) data 0.431 (0.329) loss_x loss_x 1.5186 (1.2951) acc_x 65.6250 (68.1250) lr 1.2028e-03 eta 0:00:16
epoch [89/200] batch [15/45] time 0.395 (0.461) data 0.264 (0.330) loss_x loss_x 0.9692 (1.2475) acc_x 78.1250 (68.5417) lr 1.2028e-03 eta 0:00:13
epoch [89/200] batch [20/45] time 0.521 (0.469) data 0.390 (0.338) loss_x loss_x 1.4990 (1.3123) acc_x 56.2500 (66.0938) lr 1.2028e-03 eta 0:00:11
epoch [89/200] batch [25/45] time 0.503 (0.469) data 0.372 (0.337) loss_x loss_x 1.5361 (1.3077) acc_x 62.5000 (66.2500) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [30/45] time 0.359 (0.464) data 0.228 (0.333) loss_x loss_x 1.6094 (1.3181) acc_x 50.0000 (65.5208) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [35/45] time 0.612 (0.468) data 0.480 (0.336) loss_x loss_x 1.1064 (1.3080) acc_x 68.7500 (65.9821) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [40/45] time 0.390 (0.464) data 0.259 (0.332) loss_x loss_x 1.1807 (1.3106) acc_x 59.3750 (66.0156) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [45/45] time 0.494 (0.469) data 0.363 (0.338) loss_x loss_x 1.1533 (1.3029) acc_x 65.6250 (65.7639) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4563, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1431
clean true:1416
clean false:15
clean_rate:0.989517819706499
noisy true:166
noisy false:1539
after delete: len(clean_dataset) 1431
after delete: len(noisy_dataset) 1705
epoch [90/200] batch [5/44] time 0.566 (0.476) data 0.435 (0.344) loss_x loss_x 1.2891 (1.1942) acc_x 68.7500 (67.5000) lr 1.1874e-03 eta 0:00:18
epoch [90/200] batch [10/44] time 0.419 (0.470) data 0.288 (0.339) loss_x loss_x 1.2441 (1.1843) acc_x 75.0000 (69.0625) lr 1.1874e-03 eta 0:00:15
epoch [90/200] batch [15/44] time 0.480 (0.470) data 0.349 (0.339) loss_x loss_x 1.2363 (1.2011) acc_x 68.7500 (70.0000) lr 1.1874e-03 eta 0:00:13
epoch [90/200] batch [20/44] time 0.388 (0.460) data 0.257 (0.329) loss_x loss_x 1.3076 (1.1999) acc_x 62.5000 (69.6875) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [25/44] time 0.539 (0.464) data 0.408 (0.333) loss_x loss_x 1.6484 (1.2361) acc_x 59.3750 (69.2500) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [30/44] time 0.622 (0.465) data 0.491 (0.334) loss_x loss_x 1.4717 (1.2410) acc_x 68.7500 (69.0625) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [35/44] time 0.480 (0.463) data 0.350 (0.332) loss_x loss_x 1.5830 (1.2438) acc_x 65.6250 (69.1964) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [40/44] time 0.457 (0.468) data 0.327 (0.337) loss_x loss_x 1.4209 (1.2344) acc_x 68.7500 (69.2188) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4630, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1452
clean true:1441
clean false:11
clean_rate:0.9924242424242424
noisy true:171
noisy false:1513
after delete: len(clean_dataset) 1452
after delete: len(noisy_dataset) 1684
epoch [91/200] batch [5/45] time 0.531 (0.456) data 0.400 (0.325) loss_x loss_x 1.3906 (1.3850) acc_x 59.3750 (63.1250) lr 1.1719e-03 eta 0:00:18
epoch [91/200] batch [10/45] time 0.402 (0.453) data 0.271 (0.322) loss_x loss_x 1.2344 (1.3702) acc_x 75.0000 (64.6875) lr 1.1719e-03 eta 0:00:15
epoch [91/200] batch [15/45] time 0.455 (0.446) data 0.324 (0.315) loss_x loss_x 1.3164 (1.2619) acc_x 59.3750 (66.4583) lr 1.1719e-03 eta 0:00:13
epoch [91/200] batch [20/45] time 0.447 (0.455) data 0.315 (0.324) loss_x loss_x 1.1250 (1.2981) acc_x 71.8750 (65.3125) lr 1.1719e-03 eta 0:00:11
epoch [91/200] batch [25/45] time 0.495 (0.454) data 0.365 (0.323) loss_x loss_x 1.8311 (1.3485) acc_x 62.5000 (64.6250) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [30/45] time 0.418 (0.462) data 0.287 (0.332) loss_x loss_x 1.5137 (1.3679) acc_x 65.6250 (64.5833) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [35/45] time 0.455 (0.463) data 0.323 (0.332) loss_x loss_x 1.1279 (1.3292) acc_x 71.8750 (65.2679) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [40/45] time 0.436 (0.457) data 0.305 (0.326) loss_x loss_x 1.6533 (1.3424) acc_x 56.2500 (65.0781) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [45/45] time 0.536 (0.464) data 0.405 (0.333) loss_x loss_x 1.1445 (1.3258) acc_x 71.8750 (65.6250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1503
confident_label rate tensor(0.4729, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1483
clean true:1464
clean false:19
clean_rate:0.9871881321645314
noisy true:169
noisy false:1484
after delete: len(clean_dataset) 1483
after delete: len(noisy_dataset) 1653
epoch [92/200] batch [5/46] time 0.478 (0.490) data 0.347 (0.358) loss_x loss_x 1.6475 (1.3838) acc_x 59.3750 (65.6250) lr 1.1564e-03 eta 0:00:20
epoch [92/200] batch [10/46] time 0.407 (0.474) data 0.276 (0.343) loss_x loss_x 1.4082 (1.3374) acc_x 65.6250 (65.3125) lr 1.1564e-03 eta 0:00:17
epoch [92/200] batch [15/46] time 0.337 (0.486) data 0.206 (0.355) loss_x loss_x 1.2666 (1.2411) acc_x 62.5000 (67.7083) lr 1.1564e-03 eta 0:00:15
epoch [92/200] batch [20/46] time 0.388 (0.480) data 0.259 (0.349) loss_x loss_x 1.1875 (1.2290) acc_x 65.6250 (68.2812) lr 1.1564e-03 eta 0:00:12
epoch [92/200] batch [25/46] time 0.435 (0.473) data 0.305 (0.342) loss_x loss_x 1.1377 (1.2188) acc_x 75.0000 (68.2500) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [30/46] time 0.435 (0.467) data 0.304 (0.336) loss_x loss_x 1.5068 (1.2591) acc_x 56.2500 (67.6042) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [35/46] time 0.442 (0.463) data 0.311 (0.332) loss_x loss_x 1.1250 (1.2307) acc_x 65.6250 (68.4821) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [40/46] time 0.348 (0.458) data 0.217 (0.328) loss_x loss_x 1.9150 (1.2465) acc_x 43.7500 (67.5781) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [45/46] time 0.368 (0.458) data 0.238 (0.327) loss_x loss_x 1.4229 (1.2455) acc_x 65.6250 (67.4306) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1515
confident_label rate tensor(0.4726, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1482
clean true:1465
clean false:17
clean_rate:0.9885290148448043
noisy true:156
noisy false:1498
after delete: len(clean_dataset) 1482
after delete: len(noisy_dataset) 1654
epoch [93/200] batch [5/46] time 0.473 (0.466) data 0.342 (0.335) loss_x loss_x 1.3037 (1.1562) acc_x 68.7500 (67.5000) lr 1.1409e-03 eta 0:00:19
epoch [93/200] batch [10/46] time 0.351 (0.431) data 0.219 (0.300) loss_x loss_x 1.2705 (1.3081) acc_x 62.5000 (65.3125) lr 1.1409e-03 eta 0:00:15
epoch [93/200] batch [15/46] time 0.384 (0.447) data 0.253 (0.316) loss_x loss_x 1.0205 (1.2653) acc_x 68.7500 (65.4167) lr 1.1409e-03 eta 0:00:13
epoch [93/200] batch [20/46] time 0.436 (0.453) data 0.305 (0.322) loss_x loss_x 1.2549 (1.2656) acc_x 71.8750 (65.4688) lr 1.1409e-03 eta 0:00:11
epoch [93/200] batch [25/46] time 0.389 (0.451) data 0.259 (0.320) loss_x loss_x 0.9546 (1.2329) acc_x 68.7500 (66.3750) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [30/46] time 0.414 (0.461) data 0.282 (0.330) loss_x loss_x 1.4082 (1.2406) acc_x 59.3750 (66.4583) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [35/46] time 0.531 (0.462) data 0.399 (0.331) loss_x loss_x 1.6230 (1.2622) acc_x 56.2500 (65.9821) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [40/46] time 0.431 (0.458) data 0.301 (0.327) loss_x loss_x 1.1865 (1.2484) acc_x 71.8750 (67.0312) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [45/46] time 0.491 (0.460) data 0.360 (0.329) loss_x loss_x 1.4629 (1.2622) acc_x 75.0000 (67.1528) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1471
clean true:1458
clean false:13
clean_rate:0.991162474507138
noisy true:148
noisy false:1517
after delete: len(clean_dataset) 1471
after delete: len(noisy_dataset) 1665
epoch [94/200] batch [5/45] time 0.532 (0.447) data 0.400 (0.315) loss_x loss_x 1.5469 (1.2711) acc_x 62.5000 (68.1250) lr 1.1253e-03 eta 0:00:17
epoch [94/200] batch [10/45] time 0.377 (0.442) data 0.246 (0.311) loss_x loss_x 1.8750 (1.3310) acc_x 62.5000 (65.9375) lr 1.1253e-03 eta 0:00:15
epoch [94/200] batch [15/45] time 0.405 (0.436) data 0.273 (0.304) loss_x loss_x 1.1660 (1.2612) acc_x 68.7500 (67.9167) lr 1.1253e-03 eta 0:00:13
epoch [94/200] batch [20/45] time 0.513 (0.448) data 0.381 (0.317) loss_x loss_x 1.0986 (1.2248) acc_x 65.6250 (68.5938) lr 1.1253e-03 eta 0:00:11
epoch [94/200] batch [25/45] time 0.457 (0.450) data 0.326 (0.319) loss_x loss_x 1.1328 (1.2043) acc_x 75.0000 (68.6250) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [30/45] time 0.459 (0.449) data 0.327 (0.318) loss_x loss_x 1.7969 (1.2295) acc_x 68.7500 (68.7500) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [35/45] time 0.433 (0.454) data 0.302 (0.322) loss_x loss_x 1.0762 (1.2296) acc_x 75.0000 (68.9286) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [40/45] time 0.395 (0.455) data 0.263 (0.323) loss_x loss_x 1.6582 (1.2378) acc_x 65.6250 (68.8281) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [45/45] time 0.568 (0.460) data 0.438 (0.329) loss_x loss_x 1.2080 (1.2545) acc_x 65.6250 (68.3333) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1540
confident_label rate tensor(0.4617, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1448
clean true:1436
clean false:12
clean_rate:0.9917127071823204
noisy true:160
noisy false:1528
after delete: len(clean_dataset) 1448
after delete: len(noisy_dataset) 1688
epoch [95/200] batch [5/45] time 0.381 (0.402) data 0.251 (0.272) loss_x loss_x 1.3096 (1.2898) acc_x 62.5000 (69.3750) lr 1.1097e-03 eta 0:00:16
epoch [95/200] batch [10/45] time 0.642 (0.447) data 0.511 (0.316) loss_x loss_x 0.9976 (1.1998) acc_x 81.2500 (70.3125) lr 1.1097e-03 eta 0:00:15
epoch [95/200] batch [15/45] time 0.372 (0.442) data 0.242 (0.311) loss_x loss_x 1.3535 (1.2803) acc_x 56.2500 (67.7083) lr 1.1097e-03 eta 0:00:13
epoch [95/200] batch [20/45] time 0.481 (0.446) data 0.350 (0.315) loss_x loss_x 0.8413 (1.2275) acc_x 78.1250 (68.9062) lr 1.1097e-03 eta 0:00:11
epoch [95/200] batch [25/45] time 0.515 (0.442) data 0.384 (0.312) loss_x loss_x 0.8228 (1.2041) acc_x 78.1250 (69.2500) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [30/45] time 0.469 (0.453) data 0.339 (0.322) loss_x loss_x 1.5811 (1.2567) acc_x 59.3750 (67.9167) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [35/45] time 0.495 (0.463) data 0.363 (0.332) loss_x loss_x 1.0654 (1.2792) acc_x 71.8750 (67.0536) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [40/45] time 0.414 (0.473) data 0.284 (0.342) loss_x loss_x 1.2412 (1.2621) acc_x 68.7500 (67.1875) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [45/45] time 0.390 (0.471) data 0.260 (0.340) loss_x loss_x 1.6514 (1.2975) acc_x 68.7500 (67.0833) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.4557, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1429
clean true:1415
clean false:14
clean_rate:0.9902029391182645
noisy true:158
noisy false:1549
after delete: len(clean_dataset) 1429
after delete: len(noisy_dataset) 1707
epoch [96/200] batch [5/44] time 0.487 (0.484) data 0.355 (0.352) loss_x loss_x 1.6904 (1.3090) acc_x 53.1250 (64.3750) lr 1.0941e-03 eta 0:00:18
epoch [96/200] batch [10/44] time 0.409 (0.437) data 0.279 (0.306) loss_x loss_x 1.7051 (1.3054) acc_x 59.3750 (65.6250) lr 1.0941e-03 eta 0:00:14
epoch [96/200] batch [15/44] time 0.523 (0.445) data 0.392 (0.314) loss_x loss_x 0.8413 (1.2685) acc_x 75.0000 (66.0417) lr 1.0941e-03 eta 0:00:12
epoch [96/200] batch [20/44] time 0.487 (0.461) data 0.356 (0.330) loss_x loss_x 1.1719 (1.2457) acc_x 68.7500 (67.1875) lr 1.0941e-03 eta 0:00:11
epoch [96/200] batch [25/44] time 0.414 (0.455) data 0.283 (0.324) loss_x loss_x 1.2754 (1.2679) acc_x 68.7500 (67.6250) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [30/44] time 0.438 (0.452) data 0.307 (0.321) loss_x loss_x 1.8691 (1.3137) acc_x 56.2500 (67.5000) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [35/44] time 0.550 (0.455) data 0.420 (0.324) loss_x loss_x 1.3740 (1.3125) acc_x 59.3750 (67.7679) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [40/44] time 0.660 (0.457) data 0.529 (0.326) loss_x loss_x 1.0557 (1.3123) acc_x 71.8750 (67.5000) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1489
confident_label rate tensor(0.4732, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1484
clean true:1469
clean false:15
clean_rate:0.9898921832884097
noisy true:178
noisy false:1474
after delete: len(clean_dataset) 1484
after delete: len(noisy_dataset) 1652
epoch [97/200] batch [5/46] time 0.526 (0.507) data 0.394 (0.374) loss_x loss_x 1.0820 (1.1039) acc_x 71.8750 (75.6250) lr 1.0785e-03 eta 0:00:20
epoch [97/200] batch [10/46] time 0.492 (0.493) data 0.361 (0.361) loss_x loss_x 1.3389 (1.2307) acc_x 56.2500 (70.0000) lr 1.0785e-03 eta 0:00:17
epoch [97/200] batch [15/46] time 0.556 (0.482) data 0.424 (0.350) loss_x loss_x 1.0781 (1.1921) acc_x 75.0000 (70.0000) lr 1.0785e-03 eta 0:00:14
epoch [97/200] batch [20/46] time 0.430 (0.469) data 0.299 (0.338) loss_x loss_x 1.2988 (1.1882) acc_x 65.6250 (69.3750) lr 1.0785e-03 eta 0:00:12
epoch [97/200] batch [25/46] time 0.461 (0.466) data 0.331 (0.334) loss_x loss_x 1.4580 (1.2269) acc_x 56.2500 (67.7500) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [30/46] time 0.425 (0.459) data 0.294 (0.327) loss_x loss_x 1.2822 (1.2502) acc_x 68.7500 (67.5000) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [35/46] time 0.494 (0.464) data 0.363 (0.332) loss_x loss_x 1.7129 (1.2868) acc_x 46.8750 (66.3393) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [40/46] time 0.627 (0.472) data 0.495 (0.341) loss_x loss_x 1.3740 (1.2930) acc_x 59.3750 (66.4062) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [45/46] time 0.585 (0.479) data 0.454 (0.348) loss_x loss_x 1.1074 (1.2855) acc_x 75.0000 (66.8056) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1560
confident_label rate tensor(0.4538, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1423
clean true:1410
clean false:13
clean_rate:0.9908643710470836
noisy true:166
noisy false:1547
after delete: len(clean_dataset) 1423
after delete: len(noisy_dataset) 1713
epoch [98/200] batch [5/44] time 0.505 (0.533) data 0.375 (0.399) loss_x loss_x 1.1572 (1.4922) acc_x 62.5000 (61.2500) lr 1.0628e-03 eta 0:00:20
epoch [98/200] batch [10/44] time 0.441 (0.462) data 0.311 (0.330) loss_x loss_x 0.8408 (1.3671) acc_x 78.1250 (65.0000) lr 1.0628e-03 eta 0:00:15
epoch [98/200] batch [15/44] time 0.419 (0.466) data 0.288 (0.334) loss_x loss_x 1.1924 (1.4212) acc_x 71.8750 (66.4583) lr 1.0628e-03 eta 0:00:13
epoch [98/200] batch [20/44] time 0.366 (0.463) data 0.235 (0.331) loss_x loss_x 1.0977 (1.3103) acc_x 71.8750 (68.4375) lr 1.0628e-03 eta 0:00:11
epoch [98/200] batch [25/44] time 0.545 (0.476) data 0.412 (0.345) loss_x loss_x 1.5410 (1.3115) acc_x 68.7500 (68.0000) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [30/44] time 0.371 (0.476) data 0.240 (0.345) loss_x loss_x 1.0703 (1.2971) acc_x 68.7500 (68.4375) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [35/44] time 0.563 (0.484) data 0.431 (0.353) loss_x loss_x 0.9810 (1.2709) acc_x 75.0000 (68.9286) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [40/44] time 0.445 (0.484) data 0.315 (0.352) loss_x loss_x 1.2900 (1.2649) acc_x 65.6250 (68.7500) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4643, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1456
clean true:1441
clean false:15
clean_rate:0.9896978021978022
noisy true:171
noisy false:1509
after delete: len(clean_dataset) 1456
after delete: len(noisy_dataset) 1680
epoch [99/200] batch [5/45] time 0.467 (0.497) data 0.332 (0.364) loss_x loss_x 2.0332 (1.3311) acc_x 53.1250 (70.0000) lr 1.0471e-03 eta 0:00:19
epoch [99/200] batch [10/45] time 0.382 (0.484) data 0.250 (0.352) loss_x loss_x 1.3281 (1.2280) acc_x 62.5000 (69.6875) lr 1.0471e-03 eta 0:00:16
epoch [99/200] batch [15/45] time 0.440 (0.497) data 0.308 (0.365) loss_x loss_x 0.9697 (1.2292) acc_x 78.1250 (69.7917) lr 1.0471e-03 eta 0:00:14
epoch [99/200] batch [20/45] time 0.454 (0.494) data 0.323 (0.362) loss_x loss_x 1.1621 (1.2826) acc_x 68.7500 (68.2812) lr 1.0471e-03 eta 0:00:12
epoch [99/200] batch [25/45] time 0.624 (0.491) data 0.492 (0.359) loss_x loss_x 1.4082 (1.3168) acc_x 56.2500 (67.7500) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [30/45] time 0.364 (0.481) data 0.233 (0.349) loss_x loss_x 1.5869 (1.3349) acc_x 43.7500 (66.6667) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [35/45] time 0.460 (0.478) data 0.329 (0.346) loss_x loss_x 1.5381 (1.3325) acc_x 62.5000 (66.6964) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [40/45] time 0.381 (0.474) data 0.250 (0.342) loss_x loss_x 0.9258 (1.3000) acc_x 75.0000 (67.2656) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [45/45] time 0.541 (0.472) data 0.410 (0.340) loss_x loss_x 1.0625 (1.2925) acc_x 75.0000 (67.2222) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1528
confident_label rate tensor(0.4640, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1455
clean true:1441
clean false:14
clean_rate:0.9903780068728523
noisy true:167
noisy false:1514
all clean rate:  [0.9803149606299213, 0.9836734693877551, 0.9869402985074627, 0.9829596412556054, 0.9866071428571429, 0.9844425237683665, 0.9877729257641922, 0.9887250650477016, 0.9932546374367622, 0.9828431372549019, 0.9907795473595976, 0.984179850124896, 0.9919484702093397, 0.9885527391659853, 0.9871071716357775, 0.984271523178808, 0.993421052631579, 0.989344262295082, 0.9861788617886179, 0.9854368932038835, 0.9872408293460925, 0.9825119236883942, 0.98989898989899, 0.9886178861788618, 0.984689766317486, 0.9870654810024252, 0.987220447284345, 0.9919354838709677, 0.9866141732283464, 0.9879903923138511, 0.9871309613928841, 0.9833836858006042, 0.9864150943396226, 0.9922299922299922, 0.990023023791251, 0.9879427279577996, 0.9883086515978177, 0.9908326967150497, 0.9866962305986696, 0.9899224806201551, 0.9842460615153789, 0.98923904688701, 0.9904481998530492, 0.9888392857142857, 0.9888806523350631, 0.988243938280676, 0.986404833836858, 0.9882525697503671, 0.9881129271916791, 0.988905325443787, 0.9878484631879915, 0.9904552129221733, 0.9890029325513197, 0.9933726067746687, 0.9867354458364038, 0.9867158671586715, 0.9907735982966643, 0.9878310665712241, 0.9909344490934449, 0.9877609791216703, 0.9882352941176471, 0.9909297052154195, 0.9844903988183161, 0.9870782483847811, 0.9879943502824858, 0.9868517165814463, 0.9906609195402298, 0.9888190076869322, 0.9888888888888889, 0.9879688605803255, 0.9913978494623656, 0.9874651810584958, 0.9860821155184412, 0.9861111111111112, 0.9875862068965517, 0.9889135254988913, 0.9895543175487466, 0.9874037788663401, 0.9896551724137931, 0.9881284916201117, 0.9908835904628331, 0.9914285714285714, 0.9875518672199171, 0.9868603042876902, 0.9901823281907434, 0.9902845246356696, 0.9866291344123856, 0.9921930447125621, 0.9863760217983651, 0.989517819706499, 0.9924242424242424, 0.9871881321645314, 0.9885290148448043, 0.991162474507138, 0.9917127071823204, 0.9902029391182645, 0.9898921832884097, 0.9908643710470836, 0.9896978021978022, 0.9903780068728523]
after delete: len(clean_dataset) 1455
after delete: len(noisy_dataset) 1681
epoch [100/200] batch [5/45] time 0.505 (0.465) data 0.369 (0.333) loss_x loss_x 0.9399 (1.0948) acc_x 81.2500 (74.3750) lr 1.0314e-03 eta 0:00:18
epoch [100/200] batch [10/45] time 0.428 (0.485) data 0.297 (0.352) loss_x loss_x 1.3486 (1.1219) acc_x 62.5000 (71.8750) lr 1.0314e-03 eta 0:00:16
epoch [100/200] batch [15/45] time 0.385 (0.470) data 0.254 (0.338) loss_x loss_x 1.4902 (1.1947) acc_x 62.5000 (69.3750) lr 1.0314e-03 eta 0:00:14
epoch [100/200] batch [20/45] time 0.616 (0.472) data 0.484 (0.340) loss_x loss_x 1.0127 (1.2490) acc_x 75.0000 (67.9688) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [25/45] time 0.513 (0.478) data 0.382 (0.347) loss_x loss_x 1.5117 (1.2618) acc_x 56.2500 (67.3750) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [30/45] time 0.460 (0.485) data 0.329 (0.354) loss_x loss_x 1.0488 (1.2867) acc_x 68.7500 (66.9792) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [35/45] time 0.594 (0.488) data 0.463 (0.357) loss_x loss_x 1.4238 (1.2813) acc_x 59.3750 (67.5893) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [40/45] time 0.620 (0.492) data 0.490 (0.360) loss_x loss_x 1.4971 (1.2656) acc_x 65.6250 (67.8906) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [45/45] time 0.385 (0.489) data 0.255 (0.358) loss_x loss_x 1.2441 (1.2566) acc_x 68.7500 (67.6389) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1534
confident_label rate tensor(0.4652, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1459
clean true:1443
clean false:16
clean_rate:0.9890335846470185
noisy true:159
noisy false:1518
after delete: len(clean_dataset) 1459
after delete: len(noisy_dataset) 1677
epoch [101/200] batch [5/45] time 0.631 (0.503) data 0.495 (0.371) loss_x loss_x 1.1465 (1.2678) acc_x 75.0000 (68.7500) lr 1.0157e-03 eta 0:00:20
epoch [101/200] batch [10/45] time 0.372 (0.539) data 0.240 (0.406) loss_x loss_x 1.1680 (1.1998) acc_x 65.6250 (70.9375) lr 1.0157e-03 eta 0:00:18
epoch [101/200] batch [15/45] time 0.381 (0.503) data 0.250 (0.371) loss_x loss_x 1.0244 (1.1999) acc_x 62.5000 (70.0000) lr 1.0157e-03 eta 0:00:15
epoch [101/200] batch [20/45] time 0.399 (0.501) data 0.268 (0.369) loss_x loss_x 1.1611 (1.2123) acc_x 65.6250 (70.6250) lr 1.0157e-03 eta 0:00:12
epoch [101/200] batch [25/45] time 0.397 (0.491) data 0.265 (0.359) loss_x loss_x 1.2803 (1.2110) acc_x 71.8750 (70.6250) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [30/45] time 0.434 (0.488) data 0.302 (0.356) loss_x loss_x 0.8984 (1.2185) acc_x 75.0000 (70.0000) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [35/45] time 0.476 (0.475) data 0.345 (0.344) loss_x loss_x 1.1211 (1.2152) acc_x 71.8750 (69.7321) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [40/45] time 0.423 (0.470) data 0.292 (0.339) loss_x loss_x 1.1826 (1.2281) acc_x 68.7500 (69.6094) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [45/45] time 0.512 (0.471) data 0.380 (0.339) loss_x loss_x 1.1943 (1.2324) acc_x 78.1250 (69.2361) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1511
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1471
clean true:1458
clean false:13
clean_rate:0.991162474507138
noisy true:167
noisy false:1498
after delete: len(clean_dataset) 1471
after delete: len(noisy_dataset) 1665
epoch [102/200] batch [5/45] time 0.467 (0.453) data 0.331 (0.321) loss_x loss_x 1.4346 (1.1901) acc_x 56.2500 (68.1250) lr 1.0000e-03 eta 0:00:18
epoch [102/200] batch [10/45] time 0.438 (0.459) data 0.307 (0.326) loss_x loss_x 1.4014 (1.3212) acc_x 68.7500 (65.6250) lr 1.0000e-03 eta 0:00:16
epoch [102/200] batch [15/45] time 0.491 (0.458) data 0.360 (0.326) loss_x loss_x 0.8745 (1.2588) acc_x 65.6250 (65.8333) lr 1.0000e-03 eta 0:00:13
epoch [102/200] batch [20/45] time 0.412 (0.454) data 0.281 (0.323) loss_x loss_x 1.4297 (1.2585) acc_x 62.5000 (65.9375) lr 1.0000e-03 eta 0:00:11
epoch [102/200] batch [25/45] time 0.415 (0.458) data 0.284 (0.326) loss_x loss_x 1.1387 (1.2302) acc_x 68.7500 (67.2500) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [30/45] time 0.431 (0.468) data 0.300 (0.337) loss_x loss_x 0.9019 (1.2024) acc_x 75.0000 (68.5417) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [35/45] time 0.477 (0.467) data 0.347 (0.336) loss_x loss_x 0.5732 (1.1909) acc_x 81.2500 (68.7500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [40/45] time 0.380 (0.464) data 0.249 (0.332) loss_x loss_x 0.8813 (1.1956) acc_x 78.1250 (68.8281) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [45/45] time 0.440 (0.461) data 0.309 (0.330) loss_x loss_x 1.4795 (1.1960) acc_x 59.3750 (69.0278) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1505
confident_label rate tensor(0.4748, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1489
clean true:1472
clean false:17
clean_rate:0.9885829415715245
noisy true:159
noisy false:1488
after delete: len(clean_dataset) 1489
after delete: len(noisy_dataset) 1647
epoch [103/200] batch [5/46] time 0.378 (0.463) data 0.247 (0.331) loss_x loss_x 1.5342 (1.2268) acc_x 53.1250 (66.8750) lr 9.8429e-04 eta 0:00:18
epoch [103/200] batch [10/46] time 0.509 (0.493) data 0.377 (0.361) loss_x loss_x 1.2637 (1.2503) acc_x 59.3750 (64.3750) lr 9.8429e-04 eta 0:00:17
epoch [103/200] batch [15/46] time 0.508 (0.510) data 0.377 (0.379) loss_x loss_x 1.0850 (1.1988) acc_x 71.8750 (66.2500) lr 9.8429e-04 eta 0:00:15
epoch [103/200] batch [20/46] time 0.414 (0.497) data 0.283 (0.366) loss_x loss_x 1.4902 (1.2163) acc_x 65.6250 (66.4062) lr 9.8429e-04 eta 0:00:12
epoch [103/200] batch [25/46] time 0.466 (0.487) data 0.335 (0.355) loss_x loss_x 1.3701 (1.2604) acc_x 65.6250 (66.2500) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [30/46] time 0.579 (0.493) data 0.447 (0.362) loss_x loss_x 1.7910 (1.2776) acc_x 59.3750 (66.1458) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [35/46] time 0.422 (0.489) data 0.291 (0.358) loss_x loss_x 1.5225 (1.2987) acc_x 62.5000 (65.8036) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [40/46] time 0.453 (0.486) data 0.322 (0.355) loss_x loss_x 1.1201 (1.2617) acc_x 65.6250 (66.8750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [45/46] time 0.509 (0.483) data 0.377 (0.352) loss_x loss_x 1.1299 (1.2700) acc_x 71.8750 (66.8056) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1540
confident_label rate tensor(0.4652, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1459
clean true:1441
clean false:18
clean_rate:0.9876627827278959
noisy true:155
noisy false:1522
after delete: len(clean_dataset) 1459
after delete: len(noisy_dataset) 1677
epoch [104/200] batch [5/45] time 0.450 (0.478) data 0.318 (0.347) loss_x loss_x 1.8076 (1.2944) acc_x 59.3750 (68.7500) lr 9.6859e-04 eta 0:00:19
epoch [104/200] batch [10/45] time 0.457 (0.495) data 0.325 (0.363) loss_x loss_x 1.2705 (1.2905) acc_x 71.8750 (68.1250) lr 9.6859e-04 eta 0:00:17
epoch [104/200] batch [15/45] time 0.463 (0.498) data 0.331 (0.366) loss_x loss_x 1.4971 (1.2885) acc_x 62.5000 (67.2917) lr 9.6859e-04 eta 0:00:14
epoch [104/200] batch [20/45] time 0.386 (0.483) data 0.254 (0.351) loss_x loss_x 1.4307 (1.2891) acc_x 53.1250 (66.7188) lr 9.6859e-04 eta 0:00:12
epoch [104/200] batch [25/45] time 0.489 (0.475) data 0.358 (0.344) loss_x loss_x 1.4004 (1.2477) acc_x 75.0000 (68.6250) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [30/45] time 0.391 (0.479) data 0.260 (0.347) loss_x loss_x 1.3770 (1.2208) acc_x 65.6250 (69.0625) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [35/45] time 0.414 (0.478) data 0.283 (0.346) loss_x loss_x 1.0234 (1.2189) acc_x 78.1250 (68.1250) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [40/45] time 0.485 (0.482) data 0.354 (0.350) loss_x loss_x 0.5605 (1.1988) acc_x 87.5000 (68.2812) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [45/45] time 0.391 (0.480) data 0.259 (0.348) loss_x loss_x 1.3125 (1.2019) acc_x 68.7500 (68.4028) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1541
confident_label rate tensor(0.4652, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1459
clean true:1444
clean false:15
clean_rate:0.9897189856065799
noisy true:151
noisy false:1526
after delete: len(clean_dataset) 1459
after delete: len(noisy_dataset) 1677
epoch [105/200] batch [5/45] time 0.373 (0.475) data 0.242 (0.343) loss_x loss_x 1.1533 (1.2137) acc_x 71.8750 (71.2500) lr 9.5289e-04 eta 0:00:18
epoch [105/200] batch [10/45] time 0.681 (0.488) data 0.549 (0.357) loss_x loss_x 1.0664 (1.0888) acc_x 68.7500 (72.5000) lr 9.5289e-04 eta 0:00:17
epoch [105/200] batch [15/45] time 0.419 (0.499) data 0.289 (0.368) loss_x loss_x 1.2764 (1.0729) acc_x 68.7500 (73.1250) lr 9.5289e-04 eta 0:00:14
epoch [105/200] batch [20/45] time 0.464 (0.487) data 0.333 (0.356) loss_x loss_x 1.2217 (1.1420) acc_x 71.8750 (71.2500) lr 9.5289e-04 eta 0:00:12
epoch [105/200] batch [25/45] time 0.425 (0.480) data 0.294 (0.349) loss_x loss_x 1.0898 (1.1432) acc_x 75.0000 (70.5000) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [30/45] time 0.515 (0.483) data 0.384 (0.352) loss_x loss_x 1.6162 (1.1364) acc_x 53.1250 (70.9375) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [35/45] time 0.397 (0.483) data 0.267 (0.353) loss_x loss_x 1.4326 (1.1532) acc_x 59.3750 (69.6429) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [40/45] time 0.458 (0.478) data 0.327 (0.347) loss_x loss_x 1.8428 (1.1928) acc_x 65.6250 (68.9844) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [45/45] time 0.474 (0.480) data 0.342 (0.349) loss_x loss_x 1.4092 (1.1969) acc_x 68.7500 (68.8194) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1466
clean true:1452
clean false:14
clean_rate:0.990450204638472
noisy true:160
noisy false:1510
after delete: len(clean_dataset) 1466
after delete: len(noisy_dataset) 1670
epoch [106/200] batch [5/45] time 0.525 (0.431) data 0.393 (0.300) loss_x loss_x 0.9980 (1.1042) acc_x 75.0000 (76.2500) lr 9.3721e-04 eta 0:00:17
epoch [106/200] batch [10/45] time 0.508 (0.451) data 0.371 (0.319) loss_x loss_x 1.3506 (1.2824) acc_x 81.2500 (72.1875) lr 9.3721e-04 eta 0:00:15
epoch [106/200] batch [15/45] time 0.511 (0.470) data 0.379 (0.338) loss_x loss_x 1.5312 (1.2939) acc_x 53.1250 (69.3750) lr 9.3721e-04 eta 0:00:14
epoch [106/200] batch [20/45] time 0.414 (0.462) data 0.282 (0.331) loss_x loss_x 1.3789 (1.2681) acc_x 71.8750 (69.8438) lr 9.3721e-04 eta 0:00:11
epoch [106/200] batch [25/45] time 0.490 (0.464) data 0.358 (0.332) loss_x loss_x 1.1143 (1.2605) acc_x 62.5000 (69.0000) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [30/45] time 0.428 (0.472) data 0.297 (0.340) loss_x loss_x 1.0293 (1.2408) acc_x 75.0000 (69.1667) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [35/45] time 0.319 (0.476) data 0.188 (0.344) loss_x loss_x 1.6836 (1.2352) acc_x 59.3750 (69.1964) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [40/45] time 0.493 (0.472) data 0.361 (0.340) loss_x loss_x 0.7583 (1.2306) acc_x 84.3750 (69.3750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [45/45] time 0.544 (0.477) data 0.412 (0.345) loss_x loss_x 1.3838 (1.2295) acc_x 68.7500 (69.0972) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1505
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1468
clean true:1453
clean false:15
clean_rate:0.9897820163487738
noisy true:178
noisy false:1490
after delete: len(clean_dataset) 1468
after delete: len(noisy_dataset) 1668
epoch [107/200] batch [5/45] time 0.576 (0.463) data 0.445 (0.331) loss_x loss_x 1.6230 (1.3753) acc_x 56.2500 (64.3750) lr 9.2154e-04 eta 0:00:18
epoch [107/200] batch [10/45] time 0.429 (0.438) data 0.298 (0.307) loss_x loss_x 1.0801 (1.2591) acc_x 71.8750 (68.1250) lr 9.2154e-04 eta 0:00:15
epoch [107/200] batch [15/45] time 0.531 (0.478) data 0.399 (0.346) loss_x loss_x 1.7793 (1.2088) acc_x 65.6250 (70.0000) lr 9.2154e-04 eta 0:00:14
epoch [107/200] batch [20/45] time 0.464 (0.476) data 0.332 (0.344) loss_x loss_x 1.0605 (1.2057) acc_x 78.1250 (70.0000) lr 9.2154e-04 eta 0:00:11
epoch [107/200] batch [25/45] time 0.543 (0.478) data 0.412 (0.347) loss_x loss_x 1.3633 (1.2248) acc_x 62.5000 (69.6250) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [30/45] time 0.369 (0.470) data 0.238 (0.338) loss_x loss_x 0.9146 (1.2490) acc_x 78.1250 (68.4375) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [35/45] time 0.373 (0.471) data 0.241 (0.339) loss_x loss_x 1.5215 (1.2620) acc_x 59.3750 (67.8571) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [40/45] time 0.401 (0.468) data 0.269 (0.337) loss_x loss_x 1.1982 (1.2560) acc_x 71.8750 (68.5156) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [45/45] time 0.527 (0.466) data 0.396 (0.334) loss_x loss_x 1.3164 (1.2450) acc_x 68.7500 (68.7500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1476
confident_label rate tensor(0.4770, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1496
clean true:1484
clean false:12
clean_rate:0.9919786096256684
noisy true:176
noisy false:1464
after delete: len(clean_dataset) 1496
after delete: len(noisy_dataset) 1640
epoch [108/200] batch [5/46] time 0.390 (0.490) data 0.260 (0.359) loss_x loss_x 1.0693 (1.4791) acc_x 68.7500 (64.3750) lr 9.0589e-04 eta 0:00:20
epoch [108/200] batch [10/46] time 0.404 (0.492) data 0.272 (0.361) loss_x loss_x 1.0312 (1.3418) acc_x 75.0000 (67.8125) lr 9.0589e-04 eta 0:00:17
epoch [108/200] batch [15/46] time 0.767 (0.499) data 0.632 (0.368) loss_x loss_x 1.5391 (1.3200) acc_x 56.2500 (67.0833) lr 9.0589e-04 eta 0:00:15
epoch [108/200] batch [20/46] time 0.440 (0.491) data 0.310 (0.360) loss_x loss_x 1.4121 (1.3673) acc_x 65.6250 (65.3125) lr 9.0589e-04 eta 0:00:12
epoch [108/200] batch [25/46] time 0.450 (0.484) data 0.320 (0.353) loss_x loss_x 1.2998 (1.4036) acc_x 68.7500 (64.5000) lr 9.0589e-04 eta 0:00:10
epoch [108/200] batch [30/46] time 0.458 (0.483) data 0.326 (0.352) loss_x loss_x 0.8496 (1.3610) acc_x 81.2500 (66.0417) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [35/46] time 0.374 (0.484) data 0.243 (0.353) loss_x loss_x 1.3848 (1.3485) acc_x 62.5000 (66.1607) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [40/46] time 0.534 (0.485) data 0.403 (0.354) loss_x loss_x 1.3047 (1.3379) acc_x 62.5000 (66.0156) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [45/46] time 0.708 (0.484) data 0.578 (0.353) loss_x loss_x 0.8291 (1.3233) acc_x 75.0000 (66.1111) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1471
clean true:1453
clean false:18
clean_rate:0.9877634262406526
noisy true:171
noisy false:1494
after delete: len(clean_dataset) 1471
after delete: len(noisy_dataset) 1665
epoch [109/200] batch [5/45] time 0.480 (0.438) data 0.349 (0.306) loss_x loss_x 1.7432 (1.2963) acc_x 56.2500 (66.2500) lr 8.9027e-04 eta 0:00:17
epoch [109/200] batch [10/45] time 0.459 (0.452) data 0.327 (0.321) loss_x loss_x 1.0859 (1.3470) acc_x 65.6250 (65.6250) lr 8.9027e-04 eta 0:00:15
epoch [109/200] batch [15/45] time 0.759 (0.469) data 0.621 (0.337) loss_x loss_x 1.0361 (1.2328) acc_x 75.0000 (68.5417) lr 8.9027e-04 eta 0:00:14
epoch [109/200] batch [20/45] time 0.557 (0.479) data 0.426 (0.347) loss_x loss_x 1.3770 (1.2701) acc_x 68.7500 (67.5000) lr 8.9027e-04 eta 0:00:11
epoch [109/200] batch [25/45] time 0.424 (0.478) data 0.293 (0.346) loss_x loss_x 1.3818 (1.2755) acc_x 68.7500 (68.0000) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [30/45] time 0.417 (0.483) data 0.286 (0.352) loss_x loss_x 0.9458 (1.2570) acc_x 81.2500 (68.3333) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [35/45] time 0.396 (0.479) data 0.265 (0.348) loss_x loss_x 0.9019 (1.2346) acc_x 65.6250 (68.6607) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [40/45] time 0.515 (0.483) data 0.384 (0.351) loss_x loss_x 1.2402 (1.2422) acc_x 75.0000 (68.3594) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [45/45] time 0.407 (0.485) data 0.276 (0.354) loss_x loss_x 1.4395 (1.2557) acc_x 65.6250 (67.9167) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1457
confident_label rate tensor(0.4876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1529
clean true:1512
clean false:17
clean_rate:0.9888816219751472
noisy true:167
noisy false:1440
after delete: len(clean_dataset) 1529
after delete: len(noisy_dataset) 1607
epoch [110/200] batch [5/47] time 0.450 (0.488) data 0.318 (0.357) loss_x loss_x 1.3115 (1.3545) acc_x 71.8750 (66.8750) lr 8.7467e-04 eta 0:00:20
epoch [110/200] batch [10/47] time 0.401 (0.461) data 0.269 (0.329) loss_x loss_x 1.5957 (1.2748) acc_x 53.1250 (66.5625) lr 8.7467e-04 eta 0:00:17
epoch [110/200] batch [15/47] time 0.657 (0.472) data 0.521 (0.339) loss_x loss_x 0.9624 (1.2544) acc_x 78.1250 (67.5000) lr 8.7467e-04 eta 0:00:15
epoch [110/200] batch [20/47] time 0.512 (0.491) data 0.380 (0.358) loss_x loss_x 1.5137 (1.2876) acc_x 65.6250 (67.9688) lr 8.7467e-04 eta 0:00:13
epoch [110/200] batch [25/47] time 0.410 (0.477) data 0.279 (0.344) loss_x loss_x 1.3281 (1.2996) acc_x 59.3750 (67.2500) lr 8.7467e-04 eta 0:00:10
epoch [110/200] batch [30/47] time 0.423 (0.471) data 0.292 (0.339) loss_x loss_x 1.2236 (1.3093) acc_x 75.0000 (67.3958) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [35/47] time 0.595 (0.477) data 0.464 (0.345) loss_x loss_x 1.1426 (1.2844) acc_x 68.7500 (68.0357) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [40/47] time 0.466 (0.475) data 0.335 (0.343) loss_x loss_x 0.7690 (1.2573) acc_x 84.3750 (68.8281) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [45/47] time 0.465 (0.474) data 0.334 (0.342) loss_x loss_x 0.8984 (1.2316) acc_x 75.0000 (69.5139) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1490
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1498
clean true:1477
clean false:21
clean_rate:0.985981308411215
noisy true:169
noisy false:1469
after delete: len(clean_dataset) 1498
after delete: len(noisy_dataset) 1638
epoch [111/200] batch [5/46] time 0.490 (0.481) data 0.359 (0.349) loss_x loss_x 1.1748 (1.1689) acc_x 62.5000 (71.2500) lr 8.5910e-04 eta 0:00:19
epoch [111/200] batch [10/46] time 0.429 (0.461) data 0.298 (0.330) loss_x loss_x 1.0547 (1.1165) acc_x 71.8750 (71.5625) lr 8.5910e-04 eta 0:00:16
epoch [111/200] batch [15/46] time 0.508 (0.486) data 0.377 (0.354) loss_x loss_x 1.3008 (1.1948) acc_x 65.6250 (69.1667) lr 8.5910e-04 eta 0:00:15
epoch [111/200] batch [20/46] time 0.420 (0.479) data 0.289 (0.348) loss_x loss_x 1.4932 (1.2509) acc_x 62.5000 (68.2812) lr 8.5910e-04 eta 0:00:12
epoch [111/200] batch [25/46] time 0.424 (0.467) data 0.292 (0.336) loss_x loss_x 1.3057 (1.2534) acc_x 68.7500 (68.3750) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [30/46] time 0.479 (0.470) data 0.348 (0.338) loss_x loss_x 1.3457 (1.2445) acc_x 68.7500 (68.3333) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [35/46] time 0.408 (0.463) data 0.277 (0.332) loss_x loss_x 1.2285 (1.2675) acc_x 65.6250 (67.5893) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [40/46] time 0.463 (0.462) data 0.331 (0.331) loss_x loss_x 1.5352 (1.2665) acc_x 56.2500 (67.3438) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [45/46] time 0.358 (0.467) data 0.226 (0.335) loss_x loss_x 1.5752 (1.2940) acc_x 62.5000 (67.0833) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4713, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1478
clean true:1462
clean false:16
clean_rate:0.9891745602165088
noisy true:162
noisy false:1496
after delete: len(clean_dataset) 1478
after delete: len(noisy_dataset) 1658
epoch [112/200] batch [5/46] time 0.427 (0.497) data 0.296 (0.366) loss_x loss_x 0.7881 (1.2740) acc_x 65.6250 (63.7500) lr 8.4357e-04 eta 0:00:20
epoch [112/200] batch [10/46] time 0.477 (0.475) data 0.346 (0.344) loss_x loss_x 1.0303 (1.2173) acc_x 71.8750 (66.2500) lr 8.4357e-04 eta 0:00:17
epoch [112/200] batch [15/46] time 0.429 (0.477) data 0.298 (0.346) loss_x loss_x 1.3945 (1.2979) acc_x 71.8750 (65.4167) lr 8.4357e-04 eta 0:00:14
epoch [112/200] batch [20/46] time 0.593 (0.489) data 0.461 (0.358) loss_x loss_x 1.2793 (1.3002) acc_x 68.7500 (65.7812) lr 8.4357e-04 eta 0:00:12
epoch [112/200] batch [25/46] time 0.496 (0.487) data 0.365 (0.356) loss_x loss_x 0.7612 (1.2541) acc_x 75.0000 (67.0000) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [30/46] time 0.382 (0.480) data 0.251 (0.349) loss_x loss_x 1.0986 (1.2505) acc_x 71.8750 (67.1875) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [35/46] time 0.324 (0.473) data 0.193 (0.342) loss_x loss_x 1.5117 (1.2559) acc_x 71.8750 (66.9643) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [40/46] time 0.407 (0.467) data 0.276 (0.336) loss_x loss_x 0.6919 (1.2553) acc_x 78.1250 (67.3438) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [45/46] time 0.437 (0.459) data 0.306 (0.328) loss_x loss_x 0.9756 (1.2560) acc_x 65.6250 (66.8056) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.4665, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1463
clean true:1446
clean false:17
clean_rate:0.9883800410116199
noisy true:163
noisy false:1510
after delete: len(clean_dataset) 1463
after delete: len(noisy_dataset) 1673
epoch [113/200] batch [5/45] time 0.491 (0.472) data 0.360 (0.341) loss_x loss_x 1.5811 (1.3230) acc_x 59.3750 (67.5000) lr 8.2807e-04 eta 0:00:18
epoch [113/200] batch [10/45] time 0.457 (0.465) data 0.326 (0.334) loss_x loss_x 1.5801 (1.2742) acc_x 59.3750 (67.8125) lr 8.2807e-04 eta 0:00:16
epoch [113/200] batch [15/45] time 0.440 (0.488) data 0.309 (0.357) loss_x loss_x 1.0840 (1.2479) acc_x 75.0000 (68.7500) lr 8.2807e-04 eta 0:00:14
epoch [113/200] batch [20/45] time 0.461 (0.491) data 0.329 (0.360) loss_x loss_x 1.2646 (1.2308) acc_x 65.6250 (68.7500) lr 8.2807e-04 eta 0:00:12
epoch [113/200] batch [25/45] time 0.638 (0.520) data 0.502 (0.388) loss_x loss_x 1.1689 (1.1931) acc_x 71.8750 (69.1250) lr 8.2807e-04 eta 0:00:10
epoch [113/200] batch [30/45] time 0.541 (0.509) data 0.411 (0.378) loss_x loss_x 1.5742 (1.2099) acc_x 53.1250 (68.4375) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [35/45] time 0.355 (0.498) data 0.223 (0.366) loss_x loss_x 1.3301 (1.2200) acc_x 71.8750 (68.0357) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [40/45] time 0.445 (0.492) data 0.313 (0.361) loss_x loss_x 0.8755 (1.2027) acc_x 68.7500 (68.0469) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [45/45] time 0.442 (0.490) data 0.310 (0.359) loss_x loss_x 1.4150 (1.2236) acc_x 56.2500 (67.5694) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.4461, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1399
clean true:1383
clean false:16
clean_rate:0.9885632594710507
noisy true:167
noisy false:1570
after delete: len(clean_dataset) 1399
after delete: len(noisy_dataset) 1737
epoch [114/200] batch [5/43] time 0.490 (0.493) data 0.360 (0.362) loss_x loss_x 1.2246 (1.1674) acc_x 68.7500 (70.6250) lr 8.1262e-04 eta 0:00:18
epoch [114/200] batch [10/43] time 0.452 (0.474) data 0.322 (0.344) loss_x loss_x 1.2520 (1.2173) acc_x 65.6250 (66.5625) lr 8.1262e-04 eta 0:00:15
epoch [114/200] batch [15/43] time 0.394 (0.465) data 0.263 (0.334) loss_x loss_x 1.3477 (1.1965) acc_x 75.0000 (67.9167) lr 8.1262e-04 eta 0:00:13
epoch [114/200] batch [20/43] time 0.440 (0.461) data 0.308 (0.330) loss_x loss_x 1.0840 (1.2059) acc_x 75.0000 (68.5938) lr 8.1262e-04 eta 0:00:10
epoch [114/200] batch [25/43] time 0.475 (0.462) data 0.343 (0.331) loss_x loss_x 1.1543 (1.2109) acc_x 68.7500 (68.2500) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [30/43] time 0.619 (0.465) data 0.488 (0.334) loss_x loss_x 1.1064 (1.2215) acc_x 71.8750 (68.2292) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [35/43] time 0.494 (0.460) data 0.363 (0.329) loss_x loss_x 0.9233 (1.2001) acc_x 75.0000 (68.7500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [40/43] time 0.449 (0.458) data 0.318 (0.327) loss_x loss_x 1.6104 (1.2424) acc_x 62.5000 (67.8125) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1490
confident_label rate tensor(0.4764, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1494
clean true:1482
clean false:12
clean_rate:0.9919678714859438
noisy true:164
noisy false:1478
after delete: len(clean_dataset) 1494
after delete: len(noisy_dataset) 1642
epoch [115/200] batch [5/46] time 0.546 (0.518) data 0.415 (0.386) loss_x loss_x 1.2275 (1.2107) acc_x 68.7500 (70.0000) lr 7.9721e-04 eta 0:00:21
epoch [115/200] batch [10/46] time 0.385 (0.484) data 0.253 (0.352) loss_x loss_x 1.7793 (1.2999) acc_x 68.7500 (69.3750) lr 7.9721e-04 eta 0:00:17
epoch [115/200] batch [15/46] time 0.448 (0.471) data 0.318 (0.340) loss_x loss_x 1.3467 (1.2613) acc_x 59.3750 (69.1667) lr 7.9721e-04 eta 0:00:14
epoch [115/200] batch [20/46] time 0.446 (0.461) data 0.315 (0.330) loss_x loss_x 1.0684 (1.2530) acc_x 65.6250 (68.5938) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [25/46] time 0.439 (0.459) data 0.308 (0.328) loss_x loss_x 0.9243 (1.2713) acc_x 78.1250 (68.0000) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [30/46] time 0.423 (0.459) data 0.291 (0.327) loss_x loss_x 1.4580 (1.2786) acc_x 62.5000 (67.8125) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [35/46] time 0.437 (0.461) data 0.306 (0.330) loss_x loss_x 1.4658 (1.2874) acc_x 50.0000 (67.2321) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [40/46] time 0.519 (0.465) data 0.388 (0.334) loss_x loss_x 1.0078 (1.2798) acc_x 81.2500 (67.3438) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [45/46] time 0.385 (0.470) data 0.254 (0.339) loss_x loss_x 1.2754 (1.2890) acc_x 71.8750 (67.7083) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1492
confident_label rate tensor(0.4748, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1489
clean true:1473
clean false:16
clean_rate:0.9892545332437878
noisy true:171
noisy false:1476
after delete: len(clean_dataset) 1489
after delete: len(noisy_dataset) 1647
epoch [116/200] batch [5/46] time 0.541 (0.480) data 0.410 (0.349) loss_x loss_x 0.7695 (1.2124) acc_x 84.3750 (71.2500) lr 7.8186e-04 eta 0:00:19
epoch [116/200] batch [10/46] time 0.339 (0.461) data 0.209 (0.331) loss_x loss_x 1.2705 (1.2425) acc_x 75.0000 (69.6875) lr 7.8186e-04 eta 0:00:16
epoch [116/200] batch [15/46] time 0.529 (0.476) data 0.398 (0.345) loss_x loss_x 1.6357 (1.2516) acc_x 62.5000 (68.7500) lr 7.8186e-04 eta 0:00:14
epoch [116/200] batch [20/46] time 0.462 (0.471) data 0.330 (0.341) loss_x loss_x 1.3730 (1.2378) acc_x 68.7500 (68.4375) lr 7.8186e-04 eta 0:00:12
epoch [116/200] batch [25/46] time 0.420 (0.474) data 0.290 (0.343) loss_x loss_x 1.1064 (1.2412) acc_x 71.8750 (68.5000) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [30/46] time 0.371 (0.472) data 0.240 (0.342) loss_x loss_x 0.6777 (1.2180) acc_x 90.6250 (69.4792) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [35/46] time 0.388 (0.468) data 0.258 (0.337) loss_x loss_x 0.9224 (1.2018) acc_x 78.1250 (70.0893) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [40/46] time 0.683 (0.475) data 0.552 (0.344) loss_x loss_x 1.5498 (1.2176) acc_x 65.6250 (69.5312) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [45/46] time 0.648 (0.474) data 0.517 (0.343) loss_x loss_x 1.3301 (1.2290) acc_x 62.5000 (68.9583) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1529
confident_label rate tensor(0.4621, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1449
clean true:1436
clean false:13
clean_rate:0.9910282953761215
noisy true:171
noisy false:1516
after delete: len(clean_dataset) 1449
after delete: len(noisy_dataset) 1687
epoch [117/200] batch [5/45] time 0.419 (0.480) data 0.289 (0.349) loss_x loss_x 1.1221 (0.9748) acc_x 71.8750 (75.6250) lr 7.6655e-04 eta 0:00:19
epoch [117/200] batch [10/45] time 0.545 (0.478) data 0.415 (0.347) loss_x loss_x 1.3350 (1.1260) acc_x 68.7500 (71.2500) lr 7.6655e-04 eta 0:00:16
epoch [117/200] batch [15/45] time 0.473 (0.493) data 0.343 (0.362) loss_x loss_x 1.1416 (1.1603) acc_x 68.7500 (70.2083) lr 7.6655e-04 eta 0:00:14
epoch [117/200] batch [20/45] time 0.478 (0.475) data 0.348 (0.345) loss_x loss_x 1.0293 (1.2116) acc_x 68.7500 (69.0625) lr 7.6655e-04 eta 0:00:11
epoch [117/200] batch [25/45] time 0.422 (0.470) data 0.291 (0.339) loss_x loss_x 1.7334 (1.2511) acc_x 62.5000 (69.1250) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [30/45] time 0.393 (0.466) data 0.263 (0.335) loss_x loss_x 1.5635 (1.2292) acc_x 68.7500 (70.6250) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [35/45] time 0.485 (0.462) data 0.354 (0.332) loss_x loss_x 1.0078 (1.2487) acc_x 68.7500 (69.3750) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [40/45] time 0.543 (0.466) data 0.412 (0.335) loss_x loss_x 1.8721 (1.2674) acc_x 62.5000 (68.9844) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [45/45] time 0.442 (0.462) data 0.311 (0.331) loss_x loss_x 0.8418 (1.2470) acc_x 78.1250 (69.7222) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1535
confident_label rate tensor(0.4636, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1454
clean true:1441
clean false:13
clean_rate:0.9910591471801926
noisy true:160
noisy false:1522
after delete: len(clean_dataset) 1454
after delete: len(noisy_dataset) 1682
epoch [118/200] batch [5/45] time 0.532 (0.461) data 0.400 (0.330) loss_x loss_x 1.0674 (1.1433) acc_x 68.7500 (69.3750) lr 7.5131e-04 eta 0:00:18
epoch [118/200] batch [10/45] time 0.458 (0.485) data 0.328 (0.353) loss_x loss_x 1.4531 (1.2441) acc_x 65.6250 (69.3750) lr 7.5131e-04 eta 0:00:16
epoch [118/200] batch [15/45] time 0.408 (0.465) data 0.276 (0.333) loss_x loss_x 1.8740 (1.2823) acc_x 53.1250 (68.1250) lr 7.5131e-04 eta 0:00:13
epoch [118/200] batch [20/45] time 0.451 (0.462) data 0.320 (0.331) loss_x loss_x 1.4385 (1.2672) acc_x 68.7500 (68.1250) lr 7.5131e-04 eta 0:00:11
epoch [118/200] batch [25/45] time 0.491 (0.463) data 0.360 (0.331) loss_x loss_x 1.0918 (1.2784) acc_x 75.0000 (67.0000) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [30/45] time 0.436 (0.455) data 0.306 (0.323) loss_x loss_x 1.3721 (1.2732) acc_x 62.5000 (66.9792) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [35/45] time 0.532 (0.452) data 0.401 (0.320) loss_x loss_x 1.7041 (1.2663) acc_x 50.0000 (67.3214) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [40/45] time 0.490 (0.453) data 0.359 (0.322) loss_x loss_x 1.3115 (1.2776) acc_x 71.8750 (67.6562) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [45/45] time 0.580 (0.458) data 0.450 (0.327) loss_x loss_x 0.6680 (1.2545) acc_x 84.3750 (67.9167) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1482
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1493
clean true:1479
clean false:14
clean_rate:0.9906229068988613
noisy true:175
noisy false:1468
after delete: len(clean_dataset) 1493
after delete: len(noisy_dataset) 1643
epoch [119/200] batch [5/46] time 0.339 (0.485) data 0.208 (0.354) loss_x loss_x 0.8618 (1.1536) acc_x 78.1250 (76.2500) lr 7.3613e-04 eta 0:00:19
epoch [119/200] batch [10/46] time 0.403 (0.458) data 0.272 (0.326) loss_x loss_x 1.2207 (1.3000) acc_x 68.7500 (70.3125) lr 7.3613e-04 eta 0:00:16
epoch [119/200] batch [15/46] time 0.424 (0.455) data 0.293 (0.324) loss_x loss_x 0.7700 (1.2740) acc_x 75.0000 (69.7917) lr 7.3613e-04 eta 0:00:14
epoch [119/200] batch [20/46] time 0.453 (0.451) data 0.323 (0.320) loss_x loss_x 0.9404 (1.2431) acc_x 78.1250 (70.6250) lr 7.3613e-04 eta 0:00:11
epoch [119/200] batch [25/46] time 0.599 (0.465) data 0.469 (0.334) loss_x loss_x 1.5508 (1.2878) acc_x 65.6250 (69.2500) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [30/46] time 0.370 (0.465) data 0.240 (0.334) loss_x loss_x 1.3096 (1.2717) acc_x 68.7500 (69.4792) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [35/46] time 0.426 (0.467) data 0.295 (0.336) loss_x loss_x 1.2070 (1.2543) acc_x 62.5000 (69.6429) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [40/46] time 0.415 (0.461) data 0.285 (0.330) loss_x loss_x 1.6904 (1.2480) acc_x 46.8750 (69.1406) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [45/46] time 0.526 (0.462) data 0.395 (0.331) loss_x loss_x 1.2725 (1.2810) acc_x 59.3750 (68.0556) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1502
confident_label rate tensor(0.4754, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1491
clean true:1475
clean false:16
clean_rate:0.9892689470154259
noisy true:159
noisy false:1486
after delete: len(clean_dataset) 1491
after delete: len(noisy_dataset) 1645
epoch [120/200] batch [5/46] time 0.704 (0.518) data 0.572 (0.386) loss_x loss_x 1.4072 (1.2959) acc_x 65.6250 (69.3750) lr 7.2101e-04 eta 0:00:21
epoch [120/200] batch [10/46] time 0.538 (0.486) data 0.407 (0.354) loss_x loss_x 1.5098 (1.3858) acc_x 71.8750 (66.2500) lr 7.2101e-04 eta 0:00:17
epoch [120/200] batch [15/46] time 0.528 (0.473) data 0.398 (0.341) loss_x loss_x 1.7598 (1.3168) acc_x 50.0000 (67.9167) lr 7.2101e-04 eta 0:00:14
epoch [120/200] batch [20/46] time 0.473 (0.467) data 0.342 (0.335) loss_x loss_x 1.4141 (1.3383) acc_x 68.7500 (66.7188) lr 7.2101e-04 eta 0:00:12
epoch [120/200] batch [25/46] time 0.386 (0.463) data 0.255 (0.331) loss_x loss_x 1.9473 (1.3095) acc_x 50.0000 (67.1250) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [30/46] time 0.428 (0.467) data 0.298 (0.336) loss_x loss_x 1.0713 (1.3232) acc_x 75.0000 (67.0833) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [35/46] time 0.488 (0.464) data 0.357 (0.333) loss_x loss_x 1.3018 (1.3228) acc_x 56.2500 (66.7857) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [40/46] time 0.454 (0.461) data 0.322 (0.330) loss_x loss_x 1.0430 (1.2941) acc_x 71.8750 (67.1094) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [45/46] time 0.494 (0.465) data 0.363 (0.334) loss_x loss_x 0.7324 (1.2618) acc_x 81.2500 (68.1944) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1501
confident_label rate tensor(0.4710, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1477
clean true:1466
clean false:11
clean_rate:0.992552471225457
noisy true:169
noisy false:1490
after delete: len(clean_dataset) 1477
after delete: len(noisy_dataset) 1659
epoch [121/200] batch [5/46] time 0.413 (0.470) data 0.282 (0.339) loss_x loss_x 1.4883 (1.2438) acc_x 65.6250 (70.6250) lr 7.0596e-04 eta 0:00:19
epoch [121/200] batch [10/46] time 0.465 (0.472) data 0.334 (0.341) loss_x loss_x 1.5479 (1.1744) acc_x 46.8750 (69.0625) lr 7.0596e-04 eta 0:00:17
epoch [121/200] batch [15/46] time 0.529 (0.473) data 0.397 (0.342) loss_x loss_x 1.1904 (1.1396) acc_x 71.8750 (70.6250) lr 7.0596e-04 eta 0:00:14
epoch [121/200] batch [20/46] time 0.514 (0.463) data 0.383 (0.332) loss_x loss_x 1.0889 (1.1400) acc_x 71.8750 (69.6875) lr 7.0596e-04 eta 0:00:12
epoch [121/200] batch [25/46] time 0.530 (0.473) data 0.398 (0.341) loss_x loss_x 1.2354 (1.1638) acc_x 68.7500 (69.1250) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [30/46] time 0.528 (0.475) data 0.396 (0.344) loss_x loss_x 1.3975 (1.2247) acc_x 65.6250 (68.6458) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [35/46] time 0.457 (0.471) data 0.326 (0.340) loss_x loss_x 1.1211 (1.2168) acc_x 78.1250 (68.5714) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [40/46] time 0.423 (0.471) data 0.292 (0.339) loss_x loss_x 0.9224 (1.2219) acc_x 81.2500 (68.4375) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [45/46] time 0.685 (0.477) data 0.553 (0.345) loss_x loss_x 1.0166 (1.2157) acc_x 81.2500 (68.6806) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1490
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1500
clean true:1485
clean false:15
clean_rate:0.99
noisy true:161
noisy false:1475
after delete: len(clean_dataset) 1500
after delete: len(noisy_dataset) 1636
epoch [122/200] batch [5/46] time 0.398 (0.466) data 0.267 (0.334) loss_x loss_x 1.2930 (1.2076) acc_x 59.3750 (65.0000) lr 6.9098e-04 eta 0:00:19
epoch [122/200] batch [10/46] time 0.475 (0.470) data 0.343 (0.338) loss_x loss_x 1.1318 (1.1849) acc_x 65.6250 (66.8750) lr 6.9098e-04 eta 0:00:16
epoch [122/200] batch [15/46] time 0.493 (0.466) data 0.362 (0.334) loss_x loss_x 0.8804 (1.1048) acc_x 78.1250 (70.2083) lr 6.9098e-04 eta 0:00:14
epoch [122/200] batch [20/46] time 0.523 (0.480) data 0.392 (0.348) loss_x loss_x 1.7959 (1.1964) acc_x 59.3750 (70.3125) lr 6.9098e-04 eta 0:00:12
epoch [122/200] batch [25/46] time 0.470 (0.479) data 0.339 (0.347) loss_x loss_x 1.3135 (1.1832) acc_x 62.5000 (70.0000) lr 6.9098e-04 eta 0:00:10
epoch [122/200] batch [30/46] time 0.548 (0.474) data 0.417 (0.343) loss_x loss_x 1.5938 (1.2187) acc_x 59.3750 (69.3750) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [35/46] time 0.364 (0.467) data 0.233 (0.335) loss_x loss_x 1.4600 (1.2373) acc_x 65.6250 (68.5714) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [40/46] time 0.437 (0.462) data 0.305 (0.330) loss_x loss_x 1.7578 (1.2404) acc_x 56.2500 (68.8281) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [45/46] time 0.453 (0.462) data 0.321 (0.331) loss_x loss_x 0.9390 (1.2559) acc_x 81.2500 (68.6806) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1496
confident_label rate tensor(0.4723, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1481
clean true:1467
clean false:14
clean_rate:0.9905469277515192
noisy true:173
noisy false:1482
after delete: len(clean_dataset) 1481
after delete: len(noisy_dataset) 1655
epoch [123/200] batch [5/46] time 0.422 (0.468) data 0.290 (0.337) loss_x loss_x 1.9971 (1.5336) acc_x 62.5000 (65.0000) lr 6.7608e-04 eta 0:00:19
epoch [123/200] batch [10/46] time 0.508 (0.453) data 0.377 (0.322) loss_x loss_x 1.4023 (1.4117) acc_x 65.6250 (65.9375) lr 6.7608e-04 eta 0:00:16
epoch [123/200] batch [15/46] time 0.467 (0.452) data 0.336 (0.320) loss_x loss_x 1.5391 (1.4685) acc_x 71.8750 (65.2083) lr 6.7608e-04 eta 0:00:14
epoch [123/200] batch [20/46] time 0.467 (0.463) data 0.336 (0.332) loss_x loss_x 0.7812 (1.3646) acc_x 81.2500 (67.3438) lr 6.7608e-04 eta 0:00:12
epoch [123/200] batch [25/46] time 0.504 (0.462) data 0.373 (0.331) loss_x loss_x 1.2520 (1.3590) acc_x 59.3750 (66.3750) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [30/46] time 0.363 (0.458) data 0.231 (0.327) loss_x loss_x 1.2695 (1.3292) acc_x 78.1250 (67.3958) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [35/46] time 0.664 (0.467) data 0.533 (0.336) loss_x loss_x 1.1504 (1.3205) acc_x 68.7500 (68.1250) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [40/46] time 0.475 (0.470) data 0.344 (0.338) loss_x loss_x 1.0830 (1.2848) acc_x 78.1250 (68.4375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [45/46] time 0.446 (0.473) data 0.315 (0.342) loss_x loss_x 0.7397 (1.2663) acc_x 84.3750 (68.9583) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1500
confident_label rate tensor(0.4716, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1479
clean true:1466
clean false:13
clean_rate:0.991210277214334
noisy true:170
noisy false:1487
after delete: len(clean_dataset) 1479
after delete: len(noisy_dataset) 1657
epoch [124/200] batch [5/46] time 0.415 (0.454) data 0.285 (0.323) loss_x loss_x 1.2178 (1.1953) acc_x 71.8750 (63.7500) lr 6.6126e-04 eta 0:00:18
epoch [124/200] batch [10/46] time 0.357 (0.447) data 0.226 (0.316) loss_x loss_x 1.3213 (1.2397) acc_x 59.3750 (65.6250) lr 6.6126e-04 eta 0:00:16
epoch [124/200] batch [15/46] time 0.416 (0.449) data 0.286 (0.319) loss_x loss_x 1.3906 (1.2334) acc_x 68.7500 (65.6250) lr 6.6126e-04 eta 0:00:13
epoch [124/200] batch [20/46] time 0.520 (0.460) data 0.388 (0.329) loss_x loss_x 1.0469 (1.1978) acc_x 62.5000 (66.7188) lr 6.6126e-04 eta 0:00:11
epoch [124/200] batch [25/46] time 0.575 (0.463) data 0.444 (0.332) loss_x loss_x 1.7344 (1.2212) acc_x 53.1250 (66.2500) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [30/46] time 0.341 (0.464) data 0.210 (0.333) loss_x loss_x 1.9678 (1.2334) acc_x 59.3750 (66.6667) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [35/46] time 0.437 (0.460) data 0.306 (0.329) loss_x loss_x 1.2998 (1.2274) acc_x 62.5000 (67.3214) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [40/46] time 0.432 (0.454) data 0.300 (0.323) loss_x loss_x 0.9229 (1.2085) acc_x 84.3750 (68.0469) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [45/46] time 0.383 (0.452) data 0.253 (0.321) loss_x loss_x 0.7793 (1.1970) acc_x 75.0000 (68.3333) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1506
clean true:1488
clean false:18
clean_rate:0.9880478087649402
noisy true:175
noisy false:1455
after delete: len(clean_dataset) 1506
after delete: len(noisy_dataset) 1630
epoch [125/200] batch [5/47] time 0.513 (0.492) data 0.382 (0.361) loss_x loss_x 1.6357 (1.3760) acc_x 65.6250 (63.7500) lr 6.4653e-04 eta 0:00:20
epoch [125/200] batch [10/47] time 0.498 (0.497) data 0.368 (0.366) loss_x loss_x 1.5879 (1.3519) acc_x 62.5000 (65.6250) lr 6.4653e-04 eta 0:00:18
epoch [125/200] batch [15/47] time 0.470 (0.487) data 0.339 (0.356) loss_x loss_x 1.1514 (1.2880) acc_x 65.6250 (66.4583) lr 6.4653e-04 eta 0:00:15
epoch [125/200] batch [20/47] time 0.464 (0.499) data 0.332 (0.367) loss_x loss_x 1.3457 (1.2775) acc_x 56.2500 (66.5625) lr 6.4653e-04 eta 0:00:13
epoch [125/200] batch [25/47] time 0.524 (0.481) data 0.394 (0.349) loss_x loss_x 0.9971 (1.2456) acc_x 75.0000 (67.5000) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [30/47] time 0.415 (0.472) data 0.284 (0.341) loss_x loss_x 0.8447 (1.2385) acc_x 78.1250 (67.7083) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [35/47] time 0.400 (0.473) data 0.268 (0.342) loss_x loss_x 0.8018 (1.2097) acc_x 81.2500 (68.5714) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [40/47] time 0.620 (0.475) data 0.489 (0.344) loss_x loss_x 1.1689 (1.1973) acc_x 68.7500 (68.6719) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [45/47] time 0.427 (0.472) data 0.296 (0.341) loss_x loss_x 1.8271 (1.2019) acc_x 62.5000 (69.1667) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1496
confident_label rate tensor(0.4751, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1490
clean true:1477
clean false:13
clean_rate:0.991275167785235
noisy true:163
noisy false:1483
after delete: len(clean_dataset) 1490
after delete: len(noisy_dataset) 1646
epoch [126/200] batch [5/46] time 0.459 (0.518) data 0.328 (0.386) loss_x loss_x 0.6807 (1.0875) acc_x 87.5000 (71.2500) lr 6.3188e-04 eta 0:00:21
epoch [126/200] batch [10/46] time 0.520 (0.489) data 0.389 (0.358) loss_x loss_x 1.0547 (1.0848) acc_x 65.6250 (70.0000) lr 6.3188e-04 eta 0:00:17
epoch [126/200] batch [15/46] time 0.357 (0.462) data 0.226 (0.331) loss_x loss_x 1.5889 (1.1706) acc_x 62.5000 (68.5417) lr 6.3188e-04 eta 0:00:14
epoch [126/200] batch [20/46] time 0.453 (0.466) data 0.323 (0.335) loss_x loss_x 1.3535 (1.1924) acc_x 65.6250 (67.5000) lr 6.3188e-04 eta 0:00:12
epoch [126/200] batch [25/46] time 0.435 (0.467) data 0.304 (0.336) loss_x loss_x 1.1738 (1.2192) acc_x 71.8750 (68.1250) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [30/46] time 0.514 (0.471) data 0.383 (0.340) loss_x loss_x 0.9790 (1.2193) acc_x 68.7500 (68.0208) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [35/46] time 0.524 (0.469) data 0.393 (0.338) loss_x loss_x 0.8569 (1.2082) acc_x 75.0000 (68.1250) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [40/46] time 0.410 (0.460) data 0.279 (0.329) loss_x loss_x 1.1758 (1.2026) acc_x 62.5000 (68.1250) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [45/46] time 0.446 (0.458) data 0.314 (0.327) loss_x loss_x 1.1523 (1.1930) acc_x 71.8750 (68.4028) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1462
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1515
clean true:1498
clean false:17
clean_rate:0.9887788778877887
noisy true:176
noisy false:1445
after delete: len(clean_dataset) 1515
after delete: len(noisy_dataset) 1621
epoch [127/200] batch [5/47] time 0.605 (0.482) data 0.474 (0.350) loss_x loss_x 1.3613 (1.2116) acc_x 71.8750 (70.6250) lr 6.1732e-04 eta 0:00:20
epoch [127/200] batch [10/47] time 0.460 (0.494) data 0.330 (0.363) loss_x loss_x 0.9131 (1.2060) acc_x 81.2500 (69.6875) lr 6.1732e-04 eta 0:00:18
epoch [127/200] batch [15/47] time 0.506 (0.487) data 0.375 (0.355) loss_x loss_x 0.5317 (1.1536) acc_x 87.5000 (69.5833) lr 6.1732e-04 eta 0:00:15
epoch [127/200] batch [20/47] time 0.401 (0.491) data 0.269 (0.360) loss_x loss_x 1.1719 (1.1435) acc_x 71.8750 (70.0000) lr 6.1732e-04 eta 0:00:13
epoch [127/200] batch [25/47] time 0.437 (0.476) data 0.306 (0.345) loss_x loss_x 1.0078 (1.1537) acc_x 78.1250 (69.8750) lr 6.1732e-04 eta 0:00:10
epoch [127/200] batch [30/47] time 0.495 (0.474) data 0.365 (0.343) loss_x loss_x 0.5059 (1.1824) acc_x 84.3750 (68.9583) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [35/47] time 0.484 (0.468) data 0.352 (0.337) loss_x loss_x 0.9097 (1.2144) acc_x 78.1250 (68.6607) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [40/47] time 0.446 (0.462) data 0.314 (0.331) loss_x loss_x 1.1025 (1.2026) acc_x 75.0000 (68.9062) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [45/47] time 0.430 (0.463) data 0.300 (0.332) loss_x loss_x 1.5078 (1.1899) acc_x 62.5000 (69.5139) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1487
confident_label rate tensor(0.4735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1485
clean true:1471
clean false:14
clean_rate:0.9905723905723905
noisy true:178
noisy false:1473
after delete: len(clean_dataset) 1485
after delete: len(noisy_dataset) 1651
epoch [128/200] batch [5/46] time 0.426 (0.476) data 0.295 (0.345) loss_x loss_x 0.4751 (1.0843) acc_x 87.5000 (75.0000) lr 6.0285e-04 eta 0:00:19
epoch [128/200] batch [10/46] time 0.491 (0.496) data 0.360 (0.365) loss_x loss_x 1.0137 (0.9881) acc_x 75.0000 (77.1875) lr 6.0285e-04 eta 0:00:17
epoch [128/200] batch [15/46] time 0.552 (0.480) data 0.421 (0.349) loss_x loss_x 1.5791 (1.1283) acc_x 56.2500 (70.6250) lr 6.0285e-04 eta 0:00:14
epoch [128/200] batch [20/46] time 0.412 (0.483) data 0.281 (0.352) loss_x loss_x 0.9102 (1.0751) acc_x 81.2500 (72.3438) lr 6.0285e-04 eta 0:00:12
epoch [128/200] batch [25/46] time 0.396 (0.482) data 0.264 (0.351) loss_x loss_x 1.3125 (1.1537) acc_x 62.5000 (70.8750) lr 6.0285e-04 eta 0:00:10
epoch [128/200] batch [30/46] time 0.359 (0.482) data 0.229 (0.351) loss_x loss_x 1.0742 (1.1646) acc_x 78.1250 (70.5208) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [35/46] time 0.617 (0.477) data 0.486 (0.347) loss_x loss_x 1.4414 (1.2102) acc_x 59.3750 (68.9286) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [40/46] time 0.353 (0.470) data 0.222 (0.339) loss_x loss_x 1.8467 (1.2299) acc_x 59.3750 (68.4375) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [45/46] time 0.409 (0.465) data 0.278 (0.334) loss_x loss_x 0.8770 (1.2027) acc_x 68.7500 (68.6806) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1499
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1471
clean true:1457
clean false:14
clean_rate:0.990482664853841
noisy true:180
noisy false:1485
after delete: len(clean_dataset) 1471
after delete: len(noisy_dataset) 1665
epoch [129/200] batch [5/45] time 0.438 (0.514) data 0.307 (0.382) loss_x loss_x 1.2197 (1.3637) acc_x 71.8750 (66.8750) lr 5.8849e-04 eta 0:00:20
epoch [129/200] batch [10/45] time 0.514 (0.471) data 0.383 (0.339) loss_x loss_x 1.1074 (1.3243) acc_x 68.7500 (66.8750) lr 5.8849e-04 eta 0:00:16
epoch [129/200] batch [15/45] time 0.451 (0.467) data 0.320 (0.335) loss_x loss_x 0.9429 (1.2547) acc_x 71.8750 (68.3333) lr 5.8849e-04 eta 0:00:13
epoch [129/200] batch [20/45] time 0.452 (0.474) data 0.320 (0.342) loss_x loss_x 0.9150 (1.2374) acc_x 84.3750 (68.4375) lr 5.8849e-04 eta 0:00:11
epoch [129/200] batch [25/45] time 0.365 (0.464) data 0.233 (0.333) loss_x loss_x 1.3574 (1.2061) acc_x 68.7500 (69.7500) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [30/45] time 0.458 (0.463) data 0.326 (0.331) loss_x loss_x 0.6978 (1.1626) acc_x 78.1250 (70.0000) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [35/45] time 0.385 (0.460) data 0.253 (0.329) loss_x loss_x 1.4600 (1.2038) acc_x 56.2500 (68.7500) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [40/45] time 0.713 (0.466) data 0.582 (0.335) loss_x loss_x 0.9395 (1.2149) acc_x 75.0000 (68.9062) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [45/45] time 0.406 (0.460) data 0.274 (0.329) loss_x loss_x 1.3428 (1.2261) acc_x 59.3750 (68.3333) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1486
confident_label rate tensor(0.4713, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1478
clean true:1467
clean false:11
clean_rate:0.9925575101488497
noisy true:183
noisy false:1475
after delete: len(clean_dataset) 1478
after delete: len(noisy_dataset) 1658
epoch [130/200] batch [5/46] time 0.541 (0.494) data 0.410 (0.362) loss_x loss_x 1.2705 (1.2721) acc_x 78.1250 (67.5000) lr 5.7422e-04 eta 0:00:20
epoch [130/200] batch [10/46] time 0.379 (0.470) data 0.248 (0.338) loss_x loss_x 0.9077 (1.3318) acc_x 78.1250 (67.1875) lr 5.7422e-04 eta 0:00:16
epoch [130/200] batch [15/46] time 0.505 (0.458) data 0.374 (0.327) loss_x loss_x 0.8726 (1.3497) acc_x 78.1250 (67.5000) lr 5.7422e-04 eta 0:00:14
epoch [130/200] batch [20/46] time 0.434 (0.458) data 0.303 (0.327) loss_x loss_x 0.9058 (1.3205) acc_x 75.0000 (67.9688) lr 5.7422e-04 eta 0:00:11
epoch [130/200] batch [25/46] time 0.424 (0.459) data 0.293 (0.328) loss_x loss_x 1.0059 (1.2603) acc_x 71.8750 (68.7500) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [30/46] time 0.472 (0.457) data 0.341 (0.326) loss_x loss_x 1.0479 (1.2424) acc_x 71.8750 (69.4792) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [35/46] time 0.582 (0.459) data 0.450 (0.327) loss_x loss_x 1.6709 (1.2224) acc_x 53.1250 (69.8214) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [40/46] time 0.434 (0.460) data 0.302 (0.329) loss_x loss_x 0.7886 (1.1998) acc_x 81.2500 (70.2344) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [45/46] time 0.452 (0.459) data 0.321 (0.328) loss_x loss_x 1.2559 (1.1973) acc_x 71.8750 (70.2778) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1472
confident_label rate tensor(0.4793, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1503
clean true:1493
clean false:10
clean_rate:0.9933466400532269
noisy true:171
noisy false:1462
after delete: len(clean_dataset) 1503
after delete: len(noisy_dataset) 1633
epoch [131/200] batch [5/46] time 0.524 (0.479) data 0.393 (0.347) loss_x loss_x 0.6992 (1.0878) acc_x 87.5000 (75.6250) lr 5.6006e-04 eta 0:00:19
epoch [131/200] batch [10/46] time 0.344 (0.469) data 0.212 (0.337) loss_x loss_x 1.1650 (1.1348) acc_x 65.6250 (71.2500) lr 5.6006e-04 eta 0:00:16
epoch [131/200] batch [15/46] time 0.433 (0.478) data 0.302 (0.346) loss_x loss_x 1.2061 (1.1894) acc_x 59.3750 (69.7917) lr 5.6006e-04 eta 0:00:14
epoch [131/200] batch [20/46] time 0.422 (0.471) data 0.290 (0.340) loss_x loss_x 1.2969 (1.2120) acc_x 68.7500 (69.3750) lr 5.6006e-04 eta 0:00:12
epoch [131/200] batch [25/46] time 0.470 (0.465) data 0.339 (0.334) loss_x loss_x 1.1162 (1.1976) acc_x 78.1250 (70.0000) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [30/46] time 0.560 (0.476) data 0.429 (0.345) loss_x loss_x 1.2402 (1.2191) acc_x 78.1250 (70.1042) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [35/46] time 0.388 (0.472) data 0.258 (0.341) loss_x loss_x 0.6699 (1.1794) acc_x 84.3750 (71.0714) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [40/46] time 0.530 (0.470) data 0.398 (0.339) loss_x loss_x 0.8677 (1.1758) acc_x 84.3750 (71.0938) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [45/46] time 0.391 (0.465) data 0.260 (0.333) loss_x loss_x 1.6084 (1.2280) acc_x 62.5000 (70.4167) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1465
confident_label rate tensor(0.4774, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1497
clean true:1488
clean false:9
clean_rate:0.9939879759519038
noisy true:183
noisy false:1456
after delete: len(clean_dataset) 1497
after delete: len(noisy_dataset) 1639
epoch [132/200] batch [5/46] time 0.538 (0.488) data 0.407 (0.355) loss_x loss_x 1.4473 (1.2211) acc_x 68.7500 (70.6250) lr 5.4601e-04 eta 0:00:20
epoch [132/200] batch [10/46] time 0.532 (0.483) data 0.401 (0.351) loss_x loss_x 1.2393 (1.2147) acc_x 71.8750 (70.9375) lr 5.4601e-04 eta 0:00:17
epoch [132/200] batch [15/46] time 0.412 (0.480) data 0.281 (0.348) loss_x loss_x 0.7349 (1.1714) acc_x 84.3750 (70.4167) lr 5.4601e-04 eta 0:00:14
epoch [132/200] batch [20/46] time 0.460 (0.487) data 0.328 (0.356) loss_x loss_x 0.9951 (1.1545) acc_x 75.0000 (69.8438) lr 5.4601e-04 eta 0:00:12
epoch [132/200] batch [25/46] time 0.452 (0.478) data 0.320 (0.346) loss_x loss_x 1.2861 (1.1615) acc_x 65.6250 (70.1250) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [30/46] time 0.525 (0.482) data 0.395 (0.350) loss_x loss_x 0.6030 (1.1335) acc_x 87.5000 (70.8333) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [35/46] time 0.382 (0.477) data 0.251 (0.346) loss_x loss_x 1.1074 (1.1515) acc_x 65.6250 (69.6429) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [40/46] time 0.450 (0.478) data 0.320 (0.346) loss_x loss_x 0.5112 (1.1679) acc_x 90.6250 (69.6094) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [45/46] time 0.465 (0.476) data 0.335 (0.345) loss_x loss_x 0.6929 (1.1723) acc_x 87.5000 (69.3750) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1508
confident_label rate tensor(0.4643, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1456
clean true:1442
clean false:14
clean_rate:0.9903846153846154
noisy true:186
noisy false:1494
after delete: len(clean_dataset) 1456
after delete: len(noisy_dataset) 1680
epoch [133/200] batch [5/45] time 0.368 (0.462) data 0.237 (0.329) loss_x loss_x 1.0488 (1.0271) acc_x 75.0000 (72.5000) lr 5.3207e-04 eta 0:00:18
epoch [133/200] batch [10/45] time 0.471 (0.469) data 0.339 (0.337) loss_x loss_x 0.8901 (1.1014) acc_x 71.8750 (70.6250) lr 5.3207e-04 eta 0:00:16
epoch [133/200] batch [15/45] time 0.587 (0.493) data 0.457 (0.361) loss_x loss_x 1.5664 (1.1560) acc_x 53.1250 (68.9583) lr 5.3207e-04 eta 0:00:14
epoch [133/200] batch [20/45] time 0.413 (0.479) data 0.282 (0.348) loss_x loss_x 1.4941 (1.1949) acc_x 59.3750 (67.6562) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [25/45] time 0.482 (0.481) data 0.351 (0.350) loss_x loss_x 1.1650 (1.1988) acc_x 71.8750 (68.1250) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [30/45] time 0.504 (0.482) data 0.374 (0.351) loss_x loss_x 1.4512 (1.2229) acc_x 59.3750 (67.9167) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [35/45] time 0.598 (0.476) data 0.467 (0.345) loss_x loss_x 1.2129 (1.2278) acc_x 71.8750 (67.5893) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [40/45] time 0.460 (0.476) data 0.330 (0.345) loss_x loss_x 1.3809 (1.2306) acc_x 59.3750 (67.8906) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [45/45] time 0.505 (0.473) data 0.374 (0.341) loss_x loss_x 1.3066 (1.2331) acc_x 68.7500 (67.9167) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1451
confident_label rate tensor(0.4892, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1534
clean true:1520
clean false:14
clean_rate:0.9908735332464146
noisy true:165
noisy false:1437
after delete: len(clean_dataset) 1534
after delete: len(noisy_dataset) 1602
epoch [134/200] batch [5/47] time 0.420 (0.461) data 0.289 (0.329) loss_x loss_x 1.1758 (1.3082) acc_x 62.5000 (64.3750) lr 5.1825e-04 eta 0:00:19
epoch [134/200] batch [10/47] time 0.408 (0.473) data 0.267 (0.340) loss_x loss_x 1.0381 (1.2541) acc_x 78.1250 (68.1250) lr 5.1825e-04 eta 0:00:17
epoch [134/200] batch [15/47] time 0.415 (0.481) data 0.284 (0.348) loss_x loss_x 1.3145 (1.2277) acc_x 68.7500 (68.7500) lr 5.1825e-04 eta 0:00:15
epoch [134/200] batch [20/47] time 0.482 (0.485) data 0.351 (0.353) loss_x loss_x 1.1494 (1.2387) acc_x 68.7500 (68.1250) lr 5.1825e-04 eta 0:00:13
epoch [134/200] batch [25/47] time 0.415 (0.484) data 0.283 (0.352) loss_x loss_x 1.1670 (1.2246) acc_x 71.8750 (67.8750) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [30/47] time 0.390 (0.482) data 0.259 (0.350) loss_x loss_x 1.2598 (1.2275) acc_x 71.8750 (68.6458) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [35/47] time 0.454 (0.479) data 0.323 (0.347) loss_x loss_x 1.0264 (1.2360) acc_x 75.0000 (68.3036) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [40/47] time 0.466 (0.475) data 0.334 (0.343) loss_x loss_x 1.3359 (1.2439) acc_x 65.6250 (67.8906) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [45/47] time 0.404 (0.468) data 0.273 (0.337) loss_x loss_x 0.9702 (1.2515) acc_x 71.8750 (67.1528) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4751, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1490
clean true:1475
clean false:15
clean_rate:0.9899328859060402
noisy true:166
noisy false:1480
after delete: len(clean_dataset) 1490
after delete: len(noisy_dataset) 1646
epoch [135/200] batch [5/46] time 0.422 (0.429) data 0.291 (0.297) loss_x loss_x 1.1367 (1.2036) acc_x 75.0000 (71.8750) lr 5.0454e-04 eta 0:00:17
epoch [135/200] batch [10/46] time 0.391 (0.434) data 0.259 (0.302) loss_x loss_x 1.2812 (1.1398) acc_x 62.5000 (72.8125) lr 5.0454e-04 eta 0:00:15
epoch [135/200] batch [15/46] time 0.393 (0.448) data 0.262 (0.316) loss_x loss_x 0.7349 (1.1940) acc_x 84.3750 (70.2083) lr 5.0454e-04 eta 0:00:13
epoch [135/200] batch [20/46] time 0.440 (0.453) data 0.309 (0.321) loss_x loss_x 1.4150 (1.2009) acc_x 59.3750 (69.5312) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [25/46] time 0.434 (0.445) data 0.302 (0.313) loss_x loss_x 1.1748 (1.2165) acc_x 65.6250 (68.5000) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [30/46] time 0.612 (0.453) data 0.481 (0.321) loss_x loss_x 1.1543 (1.1966) acc_x 68.7500 (69.0625) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [35/46] time 0.435 (0.455) data 0.304 (0.324) loss_x loss_x 1.2549 (1.2007) acc_x 71.8750 (68.9286) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [40/46] time 0.509 (0.455) data 0.378 (0.324) loss_x loss_x 1.2305 (1.2201) acc_x 56.2500 (67.8125) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [45/46] time 0.488 (0.459) data 0.357 (0.328) loss_x loss_x 0.9878 (1.1975) acc_x 81.2500 (68.9583) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1437
confident_label rate tensor(0.4895, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1535
clean true:1518
clean false:17
clean_rate:0.9889250814332248
noisy true:181
noisy false:1420
after delete: len(clean_dataset) 1535
after delete: len(noisy_dataset) 1601
epoch [136/200] batch [5/47] time 0.497 (0.506) data 0.365 (0.375) loss_x loss_x 1.7129 (1.2609) acc_x 50.0000 (66.8750) lr 4.9096e-04 eta 0:00:21
epoch [136/200] batch [10/47] time 0.520 (0.494) data 0.388 (0.363) loss_x loss_x 0.8711 (1.2226) acc_x 71.8750 (67.1875) lr 4.9096e-04 eta 0:00:18
epoch [136/200] batch [15/47] time 0.444 (0.507) data 0.314 (0.375) loss_x loss_x 1.8125 (1.2481) acc_x 53.1250 (67.9167) lr 4.9096e-04 eta 0:00:16
epoch [136/200] batch [20/47] time 0.488 (0.487) data 0.357 (0.355) loss_x loss_x 1.2949 (1.2934) acc_x 68.7500 (66.7188) lr 4.9096e-04 eta 0:00:13
epoch [136/200] batch [25/47] time 0.424 (0.479) data 0.293 (0.348) loss_x loss_x 1.3252 (1.2890) acc_x 71.8750 (67.1250) lr 4.9096e-04 eta 0:00:10
epoch [136/200] batch [30/47] time 0.412 (0.473) data 0.281 (0.341) loss_x loss_x 1.1318 (1.2926) acc_x 65.6250 (67.6042) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [35/47] time 0.404 (0.465) data 0.273 (0.334) loss_x loss_x 0.9658 (1.2730) acc_x 68.7500 (67.7679) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [40/47] time 0.473 (0.466) data 0.343 (0.334) loss_x loss_x 1.3330 (1.2632) acc_x 62.5000 (67.8906) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [45/47] time 0.476 (0.470) data 0.345 (0.339) loss_x loss_x 1.5312 (1.2505) acc_x 59.3750 (68.1250) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1508
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1465
clean true:1452
clean false:13
clean_rate:0.9911262798634812
noisy true:176
noisy false:1495
after delete: len(clean_dataset) 1465
after delete: len(noisy_dataset) 1671
epoch [137/200] batch [5/45] time 0.475 (0.475) data 0.343 (0.344) loss_x loss_x 1.4141 (1.2100) acc_x 59.3750 (68.7500) lr 4.7750e-04 eta 0:00:19
epoch [137/200] batch [10/45] time 0.390 (0.464) data 0.260 (0.333) loss_x loss_x 1.4287 (1.3284) acc_x 65.6250 (67.1875) lr 4.7750e-04 eta 0:00:16
epoch [137/200] batch [15/45] time 0.533 (0.486) data 0.402 (0.355) loss_x loss_x 1.2734 (1.2934) acc_x 71.8750 (68.3333) lr 4.7750e-04 eta 0:00:14
epoch [137/200] batch [20/45] time 0.429 (0.465) data 0.298 (0.334) loss_x loss_x 1.0283 (1.2153) acc_x 75.0000 (69.3750) lr 4.7750e-04 eta 0:00:11
epoch [137/200] batch [25/45] time 0.485 (0.469) data 0.353 (0.337) loss_x loss_x 0.9849 (1.2195) acc_x 75.0000 (69.1250) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [30/45] time 0.473 (0.467) data 0.342 (0.335) loss_x loss_x 1.3340 (1.1990) acc_x 59.3750 (69.7917) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [35/45] time 0.467 (0.479) data 0.335 (0.347) loss_x loss_x 1.4980 (1.2450) acc_x 56.2500 (68.1250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [40/45] time 0.398 (0.478) data 0.267 (0.347) loss_x loss_x 1.1221 (1.2360) acc_x 68.7500 (68.6719) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [45/45] time 0.565 (0.477) data 0.434 (0.345) loss_x loss_x 1.0049 (1.2304) acc_x 71.8750 (68.6111) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1471
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1506
clean true:1487
clean false:19
clean_rate:0.9873837981407703
noisy true:178
noisy false:1452
after delete: len(clean_dataset) 1506
after delete: len(noisy_dataset) 1630
epoch [138/200] batch [5/47] time 0.535 (0.460) data 0.404 (0.329) loss_x loss_x 1.0264 (1.0814) acc_x 65.6250 (71.2500) lr 4.6417e-04 eta 0:00:19
epoch [138/200] batch [10/47] time 0.504 (0.457) data 0.373 (0.326) loss_x loss_x 1.2432 (1.1970) acc_x 56.2500 (67.8125) lr 4.6417e-04 eta 0:00:16
epoch [138/200] batch [15/47] time 0.577 (0.482) data 0.446 (0.351) loss_x loss_x 0.8071 (1.1292) acc_x 78.1250 (69.1667) lr 4.6417e-04 eta 0:00:15
epoch [138/200] batch [20/47] time 0.474 (0.484) data 0.343 (0.353) loss_x loss_x 1.6416 (1.1276) acc_x 56.2500 (69.3750) lr 4.6417e-04 eta 0:00:13
epoch [138/200] batch [25/47] time 0.463 (0.482) data 0.331 (0.351) loss_x loss_x 1.0742 (1.1158) acc_x 71.8750 (70.3750) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [30/47] time 0.450 (0.479) data 0.319 (0.348) loss_x loss_x 1.3818 (1.1485) acc_x 62.5000 (70.7292) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [35/47] time 0.532 (0.488) data 0.402 (0.356) loss_x loss_x 1.2568 (1.1438) acc_x 71.8750 (70.7143) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [40/47] time 0.379 (0.478) data 0.248 (0.347) loss_x loss_x 1.1162 (1.1551) acc_x 71.8750 (70.4688) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [45/47] time 0.543 (0.476) data 0.413 (0.345) loss_x loss_x 0.7397 (1.1585) acc_x 81.2500 (70.1389) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1481
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1498
clean true:1485
clean false:13
clean_rate:0.9913217623497997
noisy true:170
noisy false:1468
after delete: len(clean_dataset) 1498
after delete: len(noisy_dataset) 1638
epoch [139/200] batch [5/46] time 0.429 (0.422) data 0.297 (0.291) loss_x loss_x 1.0859 (1.0668) acc_x 59.3750 (71.8750) lr 4.5098e-04 eta 0:00:17
epoch [139/200] batch [10/46] time 0.413 (0.459) data 0.281 (0.328) loss_x loss_x 1.4893 (1.1620) acc_x 53.1250 (70.6250) lr 4.5098e-04 eta 0:00:16
epoch [139/200] batch [15/46] time 0.462 (0.477) data 0.327 (0.346) loss_x loss_x 1.3564 (1.1876) acc_x 59.3750 (69.5833) lr 4.5098e-04 eta 0:00:14
epoch [139/200] batch [20/46] time 0.368 (0.500) data 0.237 (0.368) loss_x loss_x 1.9707 (1.2340) acc_x 46.8750 (67.5000) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [25/46] time 0.527 (0.490) data 0.396 (0.358) loss_x loss_x 0.9565 (1.2492) acc_x 71.8750 (67.6250) lr 4.5098e-04 eta 0:00:10
epoch [139/200] batch [30/46] time 0.410 (0.496) data 0.279 (0.365) loss_x loss_x 1.3730 (1.2331) acc_x 68.7500 (67.8125) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [35/46] time 0.461 (0.487) data 0.330 (0.355) loss_x loss_x 1.1270 (1.2256) acc_x 71.8750 (68.3929) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [40/46] time 0.530 (0.489) data 0.398 (0.357) loss_x loss_x 0.9609 (1.2464) acc_x 78.1250 (67.9688) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [45/46] time 0.530 (0.482) data 0.400 (0.351) loss_x loss_x 0.7876 (1.2552) acc_x 75.0000 (67.9861) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1492
confident_label rate tensor(0.4742, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1487
clean true:1473
clean false:14
clean_rate:0.9905850706119704
noisy true:171
noisy false:1478
after delete: len(clean_dataset) 1487
after delete: len(noisy_dataset) 1649
epoch [140/200] batch [5/46] time 0.447 (0.481) data 0.316 (0.350) loss_x loss_x 0.6455 (1.0047) acc_x 84.3750 (75.0000) lr 4.3792e-04 eta 0:00:19
epoch [140/200] batch [10/46] time 0.534 (0.482) data 0.402 (0.351) loss_x loss_x 1.3037 (1.1030) acc_x 56.2500 (71.2500) lr 4.3792e-04 eta 0:00:17
epoch [140/200] batch [15/46] time 0.471 (0.487) data 0.340 (0.355) loss_x loss_x 1.3779 (1.1631) acc_x 75.0000 (71.2500) lr 4.3792e-04 eta 0:00:15
epoch [140/200] batch [20/46] time 0.512 (0.487) data 0.380 (0.355) loss_x loss_x 1.3555 (1.1952) acc_x 68.7500 (70.4688) lr 4.3792e-04 eta 0:00:12
epoch [140/200] batch [25/46] time 0.457 (0.494) data 0.326 (0.363) loss_x loss_x 1.0029 (1.1971) acc_x 78.1250 (70.3750) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [30/46] time 0.487 (0.490) data 0.355 (0.358) loss_x loss_x 1.1279 (1.2142) acc_x 71.8750 (69.8958) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [35/46] time 0.493 (0.488) data 0.362 (0.357) loss_x loss_x 1.4004 (1.2127) acc_x 71.8750 (70.0000) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [40/46] time 0.397 (0.483) data 0.266 (0.351) loss_x loss_x 1.4756 (1.2429) acc_x 68.7500 (69.0625) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [45/46] time 0.411 (0.480) data 0.280 (0.349) loss_x loss_x 0.8311 (1.2102) acc_x 71.8750 (69.7222) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1452
confident_label rate tensor(0.4850, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1521
clean true:1502
clean false:19
clean_rate:0.9875082182774491
noisy true:182
noisy false:1433
after delete: len(clean_dataset) 1521
after delete: len(noisy_dataset) 1615
epoch [141/200] batch [5/47] time 0.398 (0.454) data 0.266 (0.323) loss_x loss_x 0.9624 (1.0498) acc_x 75.0000 (70.0000) lr 4.2499e-04 eta 0:00:19
epoch [141/200] batch [10/47] time 0.431 (0.467) data 0.300 (0.336) loss_x loss_x 2.0176 (1.2443) acc_x 53.1250 (68.1250) lr 4.2499e-04 eta 0:00:17
epoch [141/200] batch [15/47] time 0.445 (0.465) data 0.314 (0.334) loss_x loss_x 1.3965 (1.2760) acc_x 65.6250 (68.3333) lr 4.2499e-04 eta 0:00:14
epoch [141/200] batch [20/47] time 0.513 (0.466) data 0.381 (0.335) loss_x loss_x 1.0781 (1.2539) acc_x 71.8750 (69.5312) lr 4.2499e-04 eta 0:00:12
epoch [141/200] batch [25/47] time 0.610 (0.474) data 0.479 (0.342) loss_x loss_x 1.3496 (1.2572) acc_x 71.8750 (69.8750) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [30/47] time 0.434 (0.475) data 0.302 (0.344) loss_x loss_x 0.8716 (1.2255) acc_x 84.3750 (70.5208) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [35/47] time 0.494 (0.479) data 0.362 (0.348) loss_x loss_x 1.0723 (1.2203) acc_x 68.7500 (70.7143) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [40/47] time 0.420 (0.477) data 0.289 (0.346) loss_x loss_x 1.6357 (1.2357) acc_x 62.5000 (70.4688) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [45/47] time 0.514 (0.476) data 0.383 (0.345) loss_x loss_x 1.0439 (1.2235) acc_x 78.1250 (70.5556) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1486
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1493
clean true:1475
clean false:18
clean_rate:0.9879437374413932
noisy true:175
noisy false:1468
after delete: len(clean_dataset) 1493
after delete: len(noisy_dataset) 1643
epoch [142/200] batch [5/46] time 0.382 (0.473) data 0.251 (0.341) loss_x loss_x 1.9297 (1.4550) acc_x 62.5000 (68.7500) lr 4.1221e-04 eta 0:00:19
epoch [142/200] batch [10/46] time 0.433 (0.443) data 0.302 (0.312) loss_x loss_x 1.0361 (1.3962) acc_x 71.8750 (65.6250) lr 4.1221e-04 eta 0:00:15
epoch [142/200] batch [15/46] time 0.466 (0.447) data 0.334 (0.315) loss_x loss_x 0.8311 (1.3724) acc_x 75.0000 (65.8333) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [20/46] time 0.484 (0.454) data 0.353 (0.322) loss_x loss_x 1.3115 (1.3012) acc_x 71.8750 (67.8125) lr 4.1221e-04 eta 0:00:11
epoch [142/200] batch [25/46] time 0.452 (0.441) data 0.315 (0.310) loss_x loss_x 1.7529 (1.2957) acc_x 62.5000 (68.0000) lr 4.1221e-04 eta 0:00:09
epoch [142/200] batch [30/46] time 0.433 (0.452) data 0.302 (0.321) loss_x loss_x 1.2236 (1.3057) acc_x 68.7500 (67.3958) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [35/46] time 0.379 (0.456) data 0.248 (0.324) loss_x loss_x 1.1152 (1.2672) acc_x 68.7500 (67.6786) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [40/46] time 0.443 (0.455) data 0.311 (0.323) loss_x loss_x 1.6338 (1.2573) acc_x 62.5000 (68.4375) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [45/46] time 0.469 (0.461) data 0.338 (0.330) loss_x loss_x 1.2178 (1.2707) acc_x 68.7500 (68.4028) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1446
confident_label rate tensor(0.4863, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1525
clean true:1513
clean false:12
clean_rate:0.9921311475409836
noisy true:177
noisy false:1434
after delete: len(clean_dataset) 1525
after delete: len(noisy_dataset) 1611
epoch [143/200] batch [5/47] time 0.383 (0.452) data 0.251 (0.321) loss_x loss_x 1.5186 (1.5013) acc_x 59.3750 (62.5000) lr 3.9958e-04 eta 0:00:18
epoch [143/200] batch [10/47] time 0.459 (0.453) data 0.328 (0.321) loss_x loss_x 1.2031 (1.2889) acc_x 71.8750 (69.0625) lr 3.9958e-04 eta 0:00:16
epoch [143/200] batch [15/47] time 0.415 (0.445) data 0.283 (0.314) loss_x loss_x 0.9844 (1.2336) acc_x 75.0000 (69.7917) lr 3.9958e-04 eta 0:00:14
epoch [143/200] batch [20/47] time 0.500 (0.439) data 0.369 (0.308) loss_x loss_x 1.0869 (1.2222) acc_x 68.7500 (68.5938) lr 3.9958e-04 eta 0:00:11
epoch [143/200] batch [25/47] time 0.446 (0.451) data 0.315 (0.319) loss_x loss_x 1.1045 (1.1694) acc_x 65.6250 (68.5000) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [30/47] time 0.481 (0.446) data 0.350 (0.314) loss_x loss_x 1.0479 (1.1565) acc_x 78.1250 (69.2708) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [35/47] time 0.505 (0.459) data 0.373 (0.328) loss_x loss_x 0.9854 (1.1565) acc_x 71.8750 (69.2857) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [40/47] time 0.352 (0.454) data 0.221 (0.323) loss_x loss_x 1.3066 (1.1641) acc_x 71.8750 (69.8438) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [45/47] time 0.476 (0.455) data 0.344 (0.324) loss_x loss_x 1.2090 (1.1698) acc_x 71.8750 (69.7222) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1487
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1515
clean true:1497
clean false:18
clean_rate:0.9881188118811881
noisy true:152
noisy false:1469
after delete: len(clean_dataset) 1515
after delete: len(noisy_dataset) 1621
epoch [144/200] batch [5/47] time 0.533 (0.444) data 0.402 (0.312) loss_x loss_x 1.1055 (1.1079) acc_x 68.7500 (67.5000) lr 3.8709e-04 eta 0:00:18
epoch [144/200] batch [10/47] time 0.521 (0.431) data 0.390 (0.300) loss_x loss_x 1.2754 (1.1255) acc_x 62.5000 (68.1250) lr 3.8709e-04 eta 0:00:15
epoch [144/200] batch [15/47] time 0.507 (0.457) data 0.376 (0.325) loss_x loss_x 0.8926 (1.1770) acc_x 68.7500 (67.2917) lr 3.8709e-04 eta 0:00:14
epoch [144/200] batch [20/47] time 0.459 (0.454) data 0.327 (0.323) loss_x loss_x 0.7954 (1.1824) acc_x 81.2500 (68.7500) lr 3.8709e-04 eta 0:00:12
epoch [144/200] batch [25/47] time 0.427 (0.450) data 0.295 (0.319) loss_x loss_x 1.0410 (1.2077) acc_x 78.1250 (68.8750) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [30/47] time 0.414 (0.455) data 0.282 (0.324) loss_x loss_x 1.2051 (1.1890) acc_x 65.6250 (69.5833) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [35/47] time 0.404 (0.451) data 0.272 (0.319) loss_x loss_x 1.7764 (1.2137) acc_x 53.1250 (68.9286) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [40/47] time 0.564 (0.458) data 0.433 (0.326) loss_x loss_x 0.6274 (1.2000) acc_x 84.3750 (69.3750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [45/47] time 0.498 (0.461) data 0.367 (0.329) loss_x loss_x 0.8179 (1.2074) acc_x 75.0000 (69.6528) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1498
confident_label rate tensor(0.4735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1485
clean true:1467
clean false:18
clean_rate:0.9878787878787879
noisy true:171
noisy false:1480
after delete: len(clean_dataset) 1485
after delete: len(noisy_dataset) 1651
epoch [145/200] batch [5/46] time 0.433 (0.472) data 0.303 (0.342) loss_x loss_x 1.0869 (1.1062) acc_x 75.0000 (72.5000) lr 3.7476e-04 eta 0:00:19
epoch [145/200] batch [10/46] time 0.368 (0.494) data 0.237 (0.363) loss_x loss_x 0.9741 (1.0844) acc_x 78.1250 (71.8750) lr 3.7476e-04 eta 0:00:17
epoch [145/200] batch [15/46] time 0.531 (0.488) data 0.401 (0.358) loss_x loss_x 0.5859 (1.1212) acc_x 81.2500 (70.8333) lr 3.7476e-04 eta 0:00:15
epoch [145/200] batch [20/46] time 0.419 (0.480) data 0.288 (0.349) loss_x loss_x 1.2617 (1.1392) acc_x 75.0000 (70.6250) lr 3.7476e-04 eta 0:00:12
epoch [145/200] batch [25/46] time 0.367 (0.473) data 0.237 (0.342) loss_x loss_x 1.2871 (1.1431) acc_x 65.6250 (69.5000) lr 3.7476e-04 eta 0:00:09
epoch [145/200] batch [30/46] time 0.448 (0.466) data 0.318 (0.335) loss_x loss_x 0.9644 (1.1360) acc_x 71.8750 (69.8958) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [35/46] time 0.645 (0.464) data 0.513 (0.334) loss_x loss_x 1.0234 (1.1351) acc_x 68.7500 (70.1786) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [40/46] time 0.530 (0.465) data 0.399 (0.334) loss_x loss_x 1.6387 (1.1565) acc_x 56.2500 (69.8438) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [45/46] time 0.431 (0.470) data 0.301 (0.339) loss_x loss_x 1.0537 (1.1585) acc_x 78.1250 (70.0694) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1450
confident_label rate tensor(0.4885, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1532
clean true:1518
clean false:14
clean_rate:0.9908616187989556
noisy true:168
noisy false:1436
after delete: len(clean_dataset) 1532
after delete: len(noisy_dataset) 1604
epoch [146/200] batch [5/47] time 0.424 (0.449) data 0.294 (0.318) loss_x loss_x 1.0557 (1.2955) acc_x 75.0000 (66.2500) lr 3.6258e-04 eta 0:00:18
epoch [146/200] batch [10/47] time 0.438 (0.467) data 0.308 (0.336) loss_x loss_x 1.6562 (1.3305) acc_x 59.3750 (67.1875) lr 3.6258e-04 eta 0:00:17
epoch [146/200] batch [15/47] time 0.452 (0.470) data 0.321 (0.339) loss_x loss_x 0.7046 (1.2334) acc_x 81.2500 (70.2083) lr 3.6258e-04 eta 0:00:15
epoch [146/200] batch [20/47] time 0.428 (0.458) data 0.297 (0.327) loss_x loss_x 0.9668 (1.2466) acc_x 81.2500 (70.3125) lr 3.6258e-04 eta 0:00:12
epoch [146/200] batch [25/47] time 0.403 (0.450) data 0.272 (0.319) loss_x loss_x 0.9155 (1.2046) acc_x 78.1250 (70.7500) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [30/47] time 0.401 (0.441) data 0.269 (0.310) loss_x loss_x 1.5938 (1.2427) acc_x 62.5000 (69.4792) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [35/47] time 0.495 (0.447) data 0.364 (0.316) loss_x loss_x 0.9648 (1.2154) acc_x 78.1250 (70.4464) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [40/47] time 0.383 (0.453) data 0.251 (0.322) loss_x loss_x 1.0605 (1.2155) acc_x 75.0000 (70.0781) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [45/47] time 0.601 (0.458) data 0.470 (0.327) loss_x loss_x 1.1592 (1.2326) acc_x 78.1250 (70.4861) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1436
confident_label rate tensor(0.4968, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1558
clean true:1539
clean false:19
clean_rate:0.9878048780487805
noisy true:161
noisy false:1417
after delete: len(clean_dataset) 1558
after delete: len(noisy_dataset) 1578
epoch [147/200] batch [5/48] time 0.413 (0.465) data 0.281 (0.334) loss_x loss_x 1.2725 (0.9570) acc_x 71.8750 (73.1250) lr 3.5055e-04 eta 0:00:20
epoch [147/200] batch [10/48] time 0.567 (0.478) data 0.436 (0.347) loss_x loss_x 1.3936 (1.1423) acc_x 68.7500 (70.0000) lr 3.5055e-04 eta 0:00:18
epoch [147/200] batch [15/48] time 0.404 (0.471) data 0.273 (0.339) loss_x loss_x 1.0527 (1.1614) acc_x 71.8750 (68.7500) lr 3.5055e-04 eta 0:00:15
epoch [147/200] batch [20/48] time 0.390 (0.460) data 0.259 (0.329) loss_x loss_x 1.2500 (1.1776) acc_x 68.7500 (68.4375) lr 3.5055e-04 eta 0:00:12
epoch [147/200] batch [25/48] time 0.452 (0.451) data 0.321 (0.320) loss_x loss_x 1.4580 (1.2105) acc_x 50.0000 (66.8750) lr 3.5055e-04 eta 0:00:10
epoch [147/200] batch [30/48] time 0.489 (0.457) data 0.359 (0.326) loss_x loss_x 0.9180 (1.1978) acc_x 78.1250 (67.7083) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [35/48] time 0.455 (0.458) data 0.324 (0.327) loss_x loss_x 0.9570 (1.1662) acc_x 65.6250 (68.4821) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [40/48] time 0.667 (0.464) data 0.537 (0.333) loss_x loss_x 1.2754 (1.1779) acc_x 62.5000 (68.2812) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [45/48] time 0.615 (0.470) data 0.483 (0.339) loss_x loss_x 0.9712 (1.1665) acc_x 65.6250 (68.3333) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1476
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1500
clean true:1485
clean false:15
clean_rate:0.99
noisy true:175
noisy false:1461
after delete: len(clean_dataset) 1500
after delete: len(noisy_dataset) 1636
epoch [148/200] batch [5/46] time 0.451 (0.486) data 0.320 (0.355) loss_x loss_x 1.0977 (1.0170) acc_x 78.1250 (76.2500) lr 3.3869e-04 eta 0:00:19
epoch [148/200] batch [10/46] time 0.455 (0.483) data 0.324 (0.352) loss_x loss_x 1.7207 (1.1495) acc_x 62.5000 (73.7500) lr 3.3869e-04 eta 0:00:17
epoch [148/200] batch [15/46] time 0.450 (0.473) data 0.319 (0.342) loss_x loss_x 1.3662 (1.1546) acc_x 65.6250 (72.5000) lr 3.3869e-04 eta 0:00:14
epoch [148/200] batch [20/46] time 0.414 (0.460) data 0.283 (0.329) loss_x loss_x 1.2891 (1.1373) acc_x 71.8750 (72.5000) lr 3.3869e-04 eta 0:00:11
epoch [148/200] batch [25/46] time 0.446 (0.455) data 0.316 (0.324) loss_x loss_x 0.8633 (1.1535) acc_x 75.0000 (71.1250) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [30/46] time 0.486 (0.459) data 0.354 (0.328) loss_x loss_x 0.8506 (1.1481) acc_x 71.8750 (71.0417) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [35/46] time 0.385 (0.461) data 0.253 (0.330) loss_x loss_x 1.2041 (1.1685) acc_x 62.5000 (70.1786) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [40/46] time 0.411 (0.465) data 0.280 (0.334) loss_x loss_x 1.0898 (1.1746) acc_x 75.0000 (70.2344) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [45/46] time 0.469 (0.465) data 0.338 (0.334) loss_x loss_x 1.2256 (1.1896) acc_x 62.5000 (69.7222) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1457
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1517
clean true:1502
clean false:15
clean_rate:0.990112063282795
noisy true:177
noisy false:1442
after delete: len(clean_dataset) 1517
after delete: len(noisy_dataset) 1619
epoch [149/200] batch [5/47] time 0.343 (0.417) data 0.212 (0.286) loss_x loss_x 1.8057 (1.2658) acc_x 62.5000 (68.7500) lr 3.2699e-04 eta 0:00:17
epoch [149/200] batch [10/47] time 0.408 (0.408) data 0.277 (0.277) loss_x loss_x 0.8701 (1.1357) acc_x 78.1250 (70.6250) lr 3.2699e-04 eta 0:00:15
epoch [149/200] batch [15/47] time 0.495 (0.429) data 0.365 (0.298) loss_x loss_x 1.5889 (1.2012) acc_x 59.3750 (69.3750) lr 3.2699e-04 eta 0:00:13
epoch [149/200] batch [20/47] time 0.411 (0.429) data 0.281 (0.299) loss_x loss_x 1.2832 (1.1844) acc_x 65.6250 (69.5312) lr 3.2699e-04 eta 0:00:11
epoch [149/200] batch [25/47] time 0.415 (0.441) data 0.284 (0.311) loss_x loss_x 1.6299 (1.1624) acc_x 53.1250 (69.7500) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [30/47] time 0.448 (0.447) data 0.317 (0.316) loss_x loss_x 1.0752 (1.1571) acc_x 65.6250 (69.2708) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [35/47] time 0.453 (0.454) data 0.322 (0.323) loss_x loss_x 1.3750 (1.1555) acc_x 59.3750 (68.9286) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [40/47] time 0.458 (0.459) data 0.327 (0.328) loss_x loss_x 0.9746 (1.1718) acc_x 75.0000 (68.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [45/47] time 0.519 (0.460) data 0.389 (0.329) loss_x loss_x 1.0293 (1.1636) acc_x 75.0000 (69.0278) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1476
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1517
clean true:1499
clean false:18
clean_rate:0.988134475939354
noisy true:161
noisy false:1458
after delete: len(clean_dataset) 1517
after delete: len(noisy_dataset) 1619
epoch [150/200] batch [5/47] time 0.457 (0.466) data 0.326 (0.335) loss_x loss_x 1.1631 (1.0399) acc_x 68.7500 (75.6250) lr 3.1545e-04 eta 0:00:19
epoch [150/200] batch [10/47] time 0.435 (0.466) data 0.304 (0.335) loss_x loss_x 0.8320 (1.0793) acc_x 78.1250 (73.1250) lr 3.1545e-04 eta 0:00:17
epoch [150/200] batch [15/47] time 0.382 (0.486) data 0.250 (0.355) loss_x loss_x 0.8862 (1.0932) acc_x 75.0000 (71.6667) lr 3.1545e-04 eta 0:00:15
epoch [150/200] batch [20/47] time 0.471 (0.488) data 0.340 (0.357) loss_x loss_x 1.4639 (1.1293) acc_x 65.6250 (70.6250) lr 3.1545e-04 eta 0:00:13
epoch [150/200] batch [25/47] time 0.367 (0.481) data 0.236 (0.350) loss_x loss_x 1.2617 (1.1336) acc_x 62.5000 (70.7500) lr 3.1545e-04 eta 0:00:10
epoch [150/200] batch [30/47] time 0.363 (0.473) data 0.232 (0.341) loss_x loss_x 1.1289 (1.1394) acc_x 71.8750 (71.2500) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [35/47] time 0.605 (0.475) data 0.474 (0.344) loss_x loss_x 1.0986 (1.1480) acc_x 59.3750 (70.6250) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [40/47] time 0.413 (0.472) data 0.282 (0.341) loss_x loss_x 1.0684 (1.1378) acc_x 75.0000 (70.9375) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [45/47] time 0.518 (0.474) data 0.386 (0.343) loss_x loss_x 1.6152 (1.1403) acc_x 71.8750 (71.2500) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1506
clean true:1491
clean false:15
clean_rate:0.9900398406374502
noisy true:172
noisy false:1458
after delete: len(clean_dataset) 1506
after delete: len(noisy_dataset) 1630
epoch [151/200] batch [5/47] time 0.429 (0.458) data 0.298 (0.327) loss_x loss_x 0.8735 (1.1492) acc_x 75.0000 (71.2500) lr 3.0409e-04 eta 0:00:19
epoch [151/200] batch [10/47] time 0.351 (0.462) data 0.220 (0.331) loss_x loss_x 1.6963 (1.2137) acc_x 62.5000 (69.3750) lr 3.0409e-04 eta 0:00:17
epoch [151/200] batch [15/47] time 0.655 (0.455) data 0.523 (0.324) loss_x loss_x 0.7500 (1.1888) acc_x 84.3750 (70.8333) lr 3.0409e-04 eta 0:00:14
epoch [151/200] batch [20/47] time 0.478 (0.461) data 0.347 (0.330) loss_x loss_x 1.5498 (1.2011) acc_x 65.6250 (70.3125) lr 3.0409e-04 eta 0:00:12
epoch [151/200] batch [25/47] time 0.388 (0.455) data 0.257 (0.324) loss_x loss_x 0.9551 (1.2038) acc_x 62.5000 (69.7500) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [30/47] time 0.473 (0.456) data 0.342 (0.325) loss_x loss_x 1.8242 (1.1888) acc_x 50.0000 (69.7917) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [35/47] time 0.452 (0.466) data 0.321 (0.335) loss_x loss_x 1.5117 (1.2186) acc_x 62.5000 (68.9286) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [40/47] time 0.552 (0.467) data 0.421 (0.336) loss_x loss_x 1.2070 (1.2054) acc_x 68.7500 (68.9844) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [45/47] time 0.451 (0.465) data 0.320 (0.334) loss_x loss_x 1.6768 (1.2061) acc_x 56.2500 (68.9583) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1466
clean true:1450
clean false:16
clean_rate:0.9890859481582538
noisy true:172
noisy false:1498
after delete: len(clean_dataset) 1466
after delete: len(noisy_dataset) 1670
epoch [152/200] batch [5/45] time 0.395 (0.470) data 0.264 (0.339) loss_x loss_x 0.8188 (1.1609) acc_x 75.0000 (67.5000) lr 2.9289e-04 eta 0:00:18
epoch [152/200] batch [10/45] time 0.465 (0.464) data 0.334 (0.333) loss_x loss_x 1.4951 (1.1859) acc_x 62.5000 (68.1250) lr 2.9289e-04 eta 0:00:16
epoch [152/200] batch [15/45] time 0.405 (0.461) data 0.274 (0.330) loss_x loss_x 1.0039 (1.1803) acc_x 78.1250 (69.5833) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [20/45] time 0.504 (0.457) data 0.372 (0.326) loss_x loss_x 1.0479 (1.1805) acc_x 71.8750 (69.6875) lr 2.9289e-04 eta 0:00:11
epoch [152/200] batch [25/45] time 0.416 (0.452) data 0.285 (0.321) loss_x loss_x 1.1055 (1.1441) acc_x 75.0000 (70.5000) lr 2.9289e-04 eta 0:00:09
epoch [152/200] batch [30/45] time 0.376 (0.457) data 0.244 (0.326) loss_x loss_x 0.9912 (1.1548) acc_x 75.0000 (70.2083) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [35/45] time 0.607 (0.468) data 0.475 (0.337) loss_x loss_x 0.7021 (1.1236) acc_x 84.3750 (70.9821) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [40/45] time 0.417 (0.464) data 0.286 (0.333) loss_x loss_x 1.5684 (1.1575) acc_x 56.2500 (69.8438) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [45/45] time 0.444 (0.465) data 0.314 (0.334) loss_x loss_x 0.8594 (1.1570) acc_x 75.0000 (70.2778) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1462
confident_label rate tensor(0.4818, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1511
clean true:1497
clean false:14
clean_rate:0.9907346128391793
noisy true:177
noisy false:1448
after delete: len(clean_dataset) 1511
after delete: len(noisy_dataset) 1625
epoch [153/200] batch [5/47] time 0.435 (0.450) data 0.304 (0.319) loss_x loss_x 1.2441 (1.2087) acc_x 71.8750 (70.0000) lr 2.8187e-04 eta 0:00:18
epoch [153/200] batch [10/47] time 0.506 (0.457) data 0.375 (0.326) loss_x loss_x 1.7295 (1.1550) acc_x 53.1250 (70.9375) lr 2.8187e-04 eta 0:00:16
epoch [153/200] batch [15/47] time 0.455 (0.442) data 0.324 (0.311) loss_x loss_x 1.0713 (1.1254) acc_x 65.6250 (71.2500) lr 2.8187e-04 eta 0:00:14
epoch [153/200] batch [20/47] time 0.525 (0.447) data 0.393 (0.316) loss_x loss_x 0.7773 (1.1350) acc_x 81.2500 (70.7812) lr 2.8187e-04 eta 0:00:12
epoch [153/200] batch [25/47] time 0.584 (0.448) data 0.452 (0.317) loss_x loss_x 1.0312 (1.0986) acc_x 71.8750 (71.6250) lr 2.8187e-04 eta 0:00:09
epoch [153/200] batch [30/47] time 0.439 (0.453) data 0.308 (0.321) loss_x loss_x 0.6997 (1.0743) acc_x 75.0000 (72.6042) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [35/47] time 0.480 (0.456) data 0.349 (0.325) loss_x loss_x 1.0859 (1.0727) acc_x 81.2500 (72.7679) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [40/47] time 0.478 (0.460) data 0.346 (0.329) loss_x loss_x 1.3057 (1.1079) acc_x 71.8750 (72.0312) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [45/47] time 0.420 (0.457) data 0.289 (0.325) loss_x loss_x 0.9541 (1.1404) acc_x 81.2500 (71.5972) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1474
confident_label rate tensor(0.4812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1509
clean true:1492
clean false:17
clean_rate:0.9887342611000662
noisy true:170
noisy false:1457
after delete: len(clean_dataset) 1509
after delete: len(noisy_dataset) 1627
epoch [154/200] batch [5/47] time 0.531 (0.581) data 0.396 (0.447) loss_x loss_x 1.5117 (1.2320) acc_x 68.7500 (73.7500) lr 2.7103e-04 eta 0:00:24
epoch [154/200] batch [10/47] time 0.543 (0.526) data 0.412 (0.393) loss_x loss_x 1.2773 (1.2023) acc_x 71.8750 (73.7500) lr 2.7103e-04 eta 0:00:19
epoch [154/200] batch [15/47] time 0.443 (0.499) data 0.311 (0.367) loss_x loss_x 1.2842 (1.1812) acc_x 75.0000 (72.9167) lr 2.7103e-04 eta 0:00:15
epoch [154/200] batch [20/47] time 0.473 (0.497) data 0.341 (0.366) loss_x loss_x 0.9258 (1.2001) acc_x 68.7500 (71.7188) lr 2.7103e-04 eta 0:00:13
epoch [154/200] batch [25/47] time 0.408 (0.492) data 0.277 (0.360) loss_x loss_x 0.9731 (1.1754) acc_x 71.8750 (72.2500) lr 2.7103e-04 eta 0:00:10
epoch [154/200] batch [30/47] time 0.492 (0.491) data 0.361 (0.360) loss_x loss_x 1.4141 (1.1778) acc_x 62.5000 (71.3542) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [35/47] time 0.359 (0.483) data 0.228 (0.351) loss_x loss_x 1.1816 (1.2037) acc_x 62.5000 (70.9821) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [40/47] time 0.433 (0.479) data 0.302 (0.348) loss_x loss_x 1.2432 (1.2159) acc_x 62.5000 (70.3906) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [45/47] time 0.544 (0.474) data 0.412 (0.343) loss_x loss_x 1.3721 (1.2299) acc_x 65.6250 (70.0694) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1479
confident_label rate tensor(0.4834, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1516
clean true:1496
clean false:20
clean_rate:0.9868073878627969
noisy true:161
noisy false:1459
after delete: len(clean_dataset) 1516
after delete: len(noisy_dataset) 1620
epoch [155/200] batch [5/47] time 0.442 (0.465) data 0.311 (0.334) loss_x loss_x 1.8066 (1.4252) acc_x 59.3750 (67.5000) lr 2.6037e-04 eta 0:00:19
epoch [155/200] batch [10/47] time 0.600 (0.491) data 0.468 (0.359) loss_x loss_x 0.8423 (1.2637) acc_x 75.0000 (69.6875) lr 2.6037e-04 eta 0:00:18
epoch [155/200] batch [15/47] time 0.735 (0.523) data 0.604 (0.391) loss_x loss_x 1.5645 (1.2723) acc_x 46.8750 (67.0833) lr 2.6037e-04 eta 0:00:16
epoch [155/200] batch [20/47] time 0.437 (0.499) data 0.307 (0.367) loss_x loss_x 0.8833 (1.2022) acc_x 87.5000 (69.5312) lr 2.6037e-04 eta 0:00:13
epoch [155/200] batch [25/47] time 0.365 (0.484) data 0.234 (0.353) loss_x loss_x 1.4062 (1.1720) acc_x 62.5000 (69.7500) lr 2.6037e-04 eta 0:00:10
epoch [155/200] batch [30/47] time 0.427 (0.478) data 0.296 (0.346) loss_x loss_x 0.9580 (1.1489) acc_x 71.8750 (70.6250) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [35/47] time 0.428 (0.480) data 0.297 (0.349) loss_x loss_x 1.2998 (1.1537) acc_x 59.3750 (70.6250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [40/47] time 0.643 (0.482) data 0.512 (0.351) loss_x loss_x 1.0801 (1.1753) acc_x 65.6250 (69.7656) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [45/47] time 0.477 (0.480) data 0.346 (0.349) loss_x loss_x 1.3184 (1.1778) acc_x 59.3750 (69.6528) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1445
confident_label rate tensor(0.4857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1523
clean true:1508
clean false:15
clean_rate:0.990151017728168
noisy true:183
noisy false:1430
after delete: len(clean_dataset) 1523
after delete: len(noisy_dataset) 1613
epoch [156/200] batch [5/47] time 0.542 (0.469) data 0.411 (0.337) loss_x loss_x 1.3428 (1.0855) acc_x 71.8750 (75.0000) lr 2.4989e-04 eta 0:00:19
epoch [156/200] batch [10/47] time 0.567 (0.507) data 0.436 (0.375) loss_x loss_x 1.0010 (1.1503) acc_x 71.8750 (71.5625) lr 2.4989e-04 eta 0:00:18
epoch [156/200] batch [15/47] time 0.479 (0.502) data 0.348 (0.371) loss_x loss_x 1.5693 (1.2366) acc_x 53.1250 (67.9167) lr 2.4989e-04 eta 0:00:16
epoch [156/200] batch [20/47] time 0.441 (0.478) data 0.310 (0.346) loss_x loss_x 0.9917 (1.2388) acc_x 75.0000 (68.1250) lr 2.4989e-04 eta 0:00:12
epoch [156/200] batch [25/47] time 0.380 (0.473) data 0.249 (0.341) loss_x loss_x 0.9307 (1.2165) acc_x 75.0000 (68.2500) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [30/47] time 0.396 (0.462) data 0.265 (0.331) loss_x loss_x 1.2236 (1.2005) acc_x 75.0000 (69.3750) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [35/47] time 0.376 (0.469) data 0.246 (0.338) loss_x loss_x 1.2109 (1.2257) acc_x 68.7500 (68.4821) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [40/47] time 0.482 (0.469) data 0.351 (0.337) loss_x loss_x 0.6719 (1.2126) acc_x 84.3750 (69.0625) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [45/47] time 0.515 (0.465) data 0.384 (0.334) loss_x loss_x 1.3418 (1.2016) acc_x 62.5000 (69.0972) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1467
confident_label rate tensor(0.4805, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1507
clean true:1492
clean false:15
clean_rate:0.9900464499004645
noisy true:177
noisy false:1452
after delete: len(clean_dataset) 1507
after delete: len(noisy_dataset) 1629
epoch [157/200] batch [5/47] time 0.356 (0.427) data 0.224 (0.295) loss_x loss_x 0.9746 (1.2240) acc_x 78.1250 (71.8750) lr 2.3959e-04 eta 0:00:17
epoch [157/200] batch [10/47] time 0.394 (0.471) data 0.258 (0.339) loss_x loss_x 1.5693 (1.2141) acc_x 50.0000 (70.0000) lr 2.3959e-04 eta 0:00:17
epoch [157/200] batch [15/47] time 0.465 (0.487) data 0.334 (0.355) loss_x loss_x 1.3477 (1.1819) acc_x 65.6250 (69.7917) lr 2.3959e-04 eta 0:00:15
epoch [157/200] batch [20/47] time 0.466 (0.484) data 0.335 (0.352) loss_x loss_x 0.8647 (1.1833) acc_x 78.1250 (69.8438) lr 2.3959e-04 eta 0:00:13
epoch [157/200] batch [25/47] time 0.469 (0.477) data 0.338 (0.346) loss_x loss_x 0.7583 (1.1397) acc_x 78.1250 (70.8750) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [30/47] time 0.569 (0.471) data 0.438 (0.340) loss_x loss_x 1.1074 (1.1437) acc_x 78.1250 (71.0417) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [35/47] time 0.442 (0.470) data 0.312 (0.338) loss_x loss_x 1.0186 (1.1314) acc_x 71.8750 (71.3393) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [40/47] time 0.434 (0.467) data 0.303 (0.336) loss_x loss_x 1.4326 (1.1183) acc_x 62.5000 (71.4062) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [45/47] time 0.362 (0.468) data 0.231 (0.337) loss_x loss_x 2.0859 (1.1341) acc_x 56.2500 (71.5972) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1452
confident_label rate tensor(0.4885, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1532
clean true:1518
clean false:14
clean_rate:0.9908616187989556
noisy true:166
noisy false:1438
after delete: len(clean_dataset) 1532
after delete: len(noisy_dataset) 1604
epoch [158/200] batch [5/47] time 0.501 (0.469) data 0.370 (0.339) loss_x loss_x 1.2686 (1.3563) acc_x 75.0000 (69.3750) lr 2.2949e-04 eta 0:00:19
epoch [158/200] batch [10/47] time 0.423 (0.466) data 0.292 (0.335) loss_x loss_x 1.1533 (1.2856) acc_x 62.5000 (68.4375) lr 2.2949e-04 eta 0:00:17
epoch [158/200] batch [15/47] time 0.603 (0.469) data 0.471 (0.338) loss_x loss_x 1.2803 (1.2820) acc_x 65.6250 (68.5417) lr 2.2949e-04 eta 0:00:15
epoch [158/200] batch [20/47] time 0.345 (0.456) data 0.215 (0.325) loss_x loss_x 0.7349 (1.2302) acc_x 81.2500 (70.0000) lr 2.2949e-04 eta 0:00:12
epoch [158/200] batch [25/47] time 0.588 (0.469) data 0.457 (0.338) loss_x loss_x 1.1699 (1.2203) acc_x 71.8750 (70.5000) lr 2.2949e-04 eta 0:00:10
epoch [158/200] batch [30/47] time 0.495 (0.467) data 0.363 (0.336) loss_x loss_x 1.5068 (1.2178) acc_x 59.3750 (70.1042) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [35/47] time 0.516 (0.467) data 0.384 (0.336) loss_x loss_x 1.0947 (1.2004) acc_x 71.8750 (70.3571) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [40/47] time 0.422 (0.468) data 0.290 (0.337) loss_x loss_x 1.6055 (1.2169) acc_x 59.3750 (70.0781) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [45/47] time 0.413 (0.465) data 0.282 (0.334) loss_x loss_x 0.9033 (1.1991) acc_x 75.0000 (70.1389) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1475
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1517
clean true:1497
clean false:20
clean_rate:0.98681608437706
noisy true:164
noisy false:1455
after delete: len(clean_dataset) 1517
after delete: len(noisy_dataset) 1619
epoch [159/200] batch [5/47] time 0.513 (0.476) data 0.383 (0.345) loss_x loss_x 1.2139 (1.1755) acc_x 65.6250 (67.5000) lr 2.1957e-04 eta 0:00:19
epoch [159/200] batch [10/47] time 0.446 (0.482) data 0.315 (0.351) loss_x loss_x 1.6436 (1.2618) acc_x 65.6250 (67.5000) lr 2.1957e-04 eta 0:00:17
epoch [159/200] batch [15/47] time 0.326 (0.499) data 0.196 (0.368) loss_x loss_x 1.6045 (1.2482) acc_x 59.3750 (67.7083) lr 2.1957e-04 eta 0:00:15
epoch [159/200] batch [20/47] time 0.466 (0.500) data 0.335 (0.369) loss_x loss_x 0.8745 (1.2486) acc_x 71.8750 (67.6562) lr 2.1957e-04 eta 0:00:13
epoch [159/200] batch [25/47] time 0.381 (0.492) data 0.250 (0.361) loss_x loss_x 1.3848 (1.2682) acc_x 71.8750 (67.6250) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [30/47] time 0.467 (0.499) data 0.337 (0.368) loss_x loss_x 1.5146 (1.2560) acc_x 71.8750 (68.8542) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [35/47] time 0.353 (0.491) data 0.223 (0.360) loss_x loss_x 1.4160 (1.2620) acc_x 71.8750 (68.6607) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [40/47] time 0.503 (0.487) data 0.373 (0.356) loss_x loss_x 1.3467 (1.2349) acc_x 56.2500 (68.8281) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [45/47] time 0.465 (0.478) data 0.335 (0.347) loss_x loss_x 1.0664 (1.2325) acc_x 81.2500 (68.6806) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1458
confident_label rate tensor(0.4876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1529
clean true:1513
clean false:16
clean_rate:0.9895356442119032
noisy true:165
noisy false:1442
after delete: len(clean_dataset) 1529
after delete: len(noisy_dataset) 1607
epoch [160/200] batch [5/47] time 0.429 (0.444) data 0.297 (0.313) loss_x loss_x 1.0117 (1.1479) acc_x 65.6250 (70.6250) lr 2.0984e-04 eta 0:00:18
epoch [160/200] batch [10/47] time 0.593 (0.464) data 0.462 (0.333) loss_x loss_x 1.0049 (1.0693) acc_x 68.7500 (72.1875) lr 2.0984e-04 eta 0:00:17
epoch [160/200] batch [15/47] time 0.520 (0.484) data 0.385 (0.353) loss_x loss_x 1.1260 (1.0656) acc_x 78.1250 (72.2917) lr 2.0984e-04 eta 0:00:15
epoch [160/200] batch [20/47] time 0.425 (0.487) data 0.294 (0.356) loss_x loss_x 1.1328 (1.0458) acc_x 62.5000 (71.8750) lr 2.0984e-04 eta 0:00:13
epoch [160/200] batch [25/47] time 0.468 (0.479) data 0.337 (0.348) loss_x loss_x 1.2480 (1.0854) acc_x 65.6250 (71.0000) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [30/47] time 0.471 (0.472) data 0.340 (0.341) loss_x loss_x 1.1816 (1.0965) acc_x 65.6250 (71.2500) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [35/47] time 0.405 (0.468) data 0.273 (0.337) loss_x loss_x 1.2441 (1.0833) acc_x 65.6250 (71.7857) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [40/47] time 0.399 (0.465) data 0.268 (0.334) loss_x loss_x 1.2275 (1.0702) acc_x 59.3750 (71.7969) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [45/47] time 0.402 (0.464) data 0.272 (0.332) loss_x loss_x 1.9854 (1.1008) acc_x 56.2500 (71.1806) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1417
confident_label rate tensor(0.4978, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1561
clean true:1540
clean false:21
clean_rate:0.9865470852017937
noisy true:179
noisy false:1396
after delete: len(clean_dataset) 1561
after delete: len(noisy_dataset) 1575
epoch [161/200] batch [5/48] time 0.402 (0.436) data 0.271 (0.306) loss_x loss_x 0.8813 (1.1765) acc_x 81.2500 (72.5000) lr 2.0032e-04 eta 0:00:18
epoch [161/200] batch [10/48] time 0.439 (0.440) data 0.307 (0.309) loss_x loss_x 1.2158 (1.2465) acc_x 75.0000 (69.0625) lr 2.0032e-04 eta 0:00:16
epoch [161/200] batch [15/48] time 0.396 (0.450) data 0.266 (0.319) loss_x loss_x 0.7280 (1.2175) acc_x 81.2500 (70.2083) lr 2.0032e-04 eta 0:00:14
epoch [161/200] batch [20/48] time 0.723 (0.469) data 0.591 (0.338) loss_x loss_x 1.2607 (1.2319) acc_x 71.8750 (69.3750) lr 2.0032e-04 eta 0:00:13
epoch [161/200] batch [25/48] time 0.448 (0.462) data 0.317 (0.331) loss_x loss_x 1.0010 (1.2072) acc_x 71.8750 (69.0000) lr 2.0032e-04 eta 0:00:10
epoch [161/200] batch [30/48] time 0.482 (0.469) data 0.351 (0.338) loss_x loss_x 1.1426 (1.1943) acc_x 65.6250 (69.4792) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [35/48] time 0.546 (0.469) data 0.415 (0.338) loss_x loss_x 1.3701 (1.2117) acc_x 59.3750 (68.6607) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [40/48] time 0.486 (0.471) data 0.355 (0.340) loss_x loss_x 1.1279 (1.2006) acc_x 71.8750 (68.5938) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [45/48] time 0.418 (0.467) data 0.287 (0.336) loss_x loss_x 1.4482 (1.1906) acc_x 68.7500 (69.0278) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1466
confident_label rate tensor(0.4872, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1528
clean true:1505
clean false:23
clean_rate:0.9849476439790575
noisy true:165
noisy false:1443
after delete: len(clean_dataset) 1528
after delete: len(noisy_dataset) 1608
epoch [162/200] batch [5/47] time 0.486 (0.456) data 0.356 (0.325) loss_x loss_x 1.1514 (1.2238) acc_x 68.7500 (70.6250) lr 1.9098e-04 eta 0:00:19
epoch [162/200] batch [10/47] time 0.581 (0.466) data 0.450 (0.335) loss_x loss_x 1.3730 (1.1846) acc_x 59.3750 (68.4375) lr 1.9098e-04 eta 0:00:17
epoch [162/200] batch [15/47] time 0.418 (0.451) data 0.288 (0.320) loss_x loss_x 1.1621 (1.2054) acc_x 65.6250 (67.7083) lr 1.9098e-04 eta 0:00:14
epoch [162/200] batch [20/47] time 0.762 (0.476) data 0.630 (0.344) loss_x loss_x 1.6621 (1.2291) acc_x 56.2500 (67.9688) lr 1.9098e-04 eta 0:00:12
epoch [162/200] batch [25/47] time 0.486 (0.474) data 0.355 (0.342) loss_x loss_x 1.1484 (1.2183) acc_x 75.0000 (68.2500) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [30/47] time 0.468 (0.479) data 0.337 (0.348) loss_x loss_x 1.2676 (1.2059) acc_x 59.3750 (68.3333) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [35/47] time 0.446 (0.477) data 0.314 (0.346) loss_x loss_x 1.3447 (1.2158) acc_x 68.7500 (68.6607) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [40/47] time 0.444 (0.475) data 0.313 (0.343) loss_x loss_x 1.0439 (1.2210) acc_x 75.0000 (68.2031) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [45/47] time 0.406 (0.472) data 0.274 (0.341) loss_x loss_x 1.0732 (1.2107) acc_x 65.6250 (68.4028) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1447
confident_label rate tensor(0.4885, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1532
clean true:1512
clean false:20
clean_rate:0.9869451697127938
noisy true:177
noisy false:1427
after delete: len(clean_dataset) 1532
after delete: len(noisy_dataset) 1604
epoch [163/200] batch [5/47] time 0.433 (0.470) data 0.302 (0.339) loss_x loss_x 1.3604 (1.2930) acc_x 75.0000 (68.7500) lr 1.8185e-04 eta 0:00:19
epoch [163/200] batch [10/47] time 0.408 (0.450) data 0.277 (0.319) loss_x loss_x 0.5127 (1.2062) acc_x 84.3750 (70.3125) lr 1.8185e-04 eta 0:00:16
epoch [163/200] batch [15/47] time 0.474 (0.465) data 0.343 (0.334) loss_x loss_x 0.7793 (1.2012) acc_x 75.0000 (69.5833) lr 1.8185e-04 eta 0:00:14
epoch [163/200] batch [20/47] time 0.497 (0.463) data 0.366 (0.332) loss_x loss_x 1.1045 (1.2326) acc_x 65.6250 (68.5938) lr 1.8185e-04 eta 0:00:12
epoch [163/200] batch [25/47] time 0.431 (0.461) data 0.300 (0.330) loss_x loss_x 1.5039 (1.2677) acc_x 65.6250 (67.8750) lr 1.8185e-04 eta 0:00:10
epoch [163/200] batch [30/47] time 0.510 (0.463) data 0.379 (0.332) loss_x loss_x 1.1826 (1.2461) acc_x 68.7500 (68.4375) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [35/47] time 0.508 (0.462) data 0.376 (0.330) loss_x loss_x 1.0312 (1.2199) acc_x 71.8750 (68.3929) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [40/47] time 0.519 (0.467) data 0.389 (0.336) loss_x loss_x 1.1445 (1.2151) acc_x 65.6250 (68.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [45/47] time 0.554 (0.468) data 0.423 (0.337) loss_x loss_x 0.9609 (1.1983) acc_x 71.8750 (69.0972) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1437
confident_label rate tensor(0.4901, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1537
clean true:1524
clean false:13
clean_rate:0.9915419648666233
noisy true:175
noisy false:1424
after delete: len(clean_dataset) 1537
after delete: len(noisy_dataset) 1599
epoch [164/200] batch [5/48] time 0.409 (0.446) data 0.278 (0.314) loss_x loss_x 1.1689 (1.1599) acc_x 62.5000 (70.0000) lr 1.7292e-04 eta 0:00:19
epoch [164/200] batch [10/48] time 0.438 (0.462) data 0.307 (0.331) loss_x loss_x 1.4473 (1.2957) acc_x 62.5000 (68.7500) lr 1.7292e-04 eta 0:00:17
epoch [164/200] batch [15/48] time 0.461 (0.500) data 0.330 (0.369) loss_x loss_x 1.5508 (1.2917) acc_x 53.1250 (68.3333) lr 1.7292e-04 eta 0:00:16
epoch [164/200] batch [20/48] time 0.435 (0.491) data 0.304 (0.360) loss_x loss_x 0.9023 (1.2345) acc_x 68.7500 (68.1250) lr 1.7292e-04 eta 0:00:13
epoch [164/200] batch [25/48] time 0.535 (0.508) data 0.404 (0.377) loss_x loss_x 0.9453 (1.1936) acc_x 68.7500 (69.0000) lr 1.7292e-04 eta 0:00:11
epoch [164/200] batch [30/48] time 0.397 (0.505) data 0.266 (0.373) loss_x loss_x 0.7690 (1.1579) acc_x 78.1250 (70.0000) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [35/48] time 0.337 (0.500) data 0.206 (0.368) loss_x loss_x 1.1035 (1.1752) acc_x 71.8750 (69.1964) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [40/48] time 0.400 (0.492) data 0.269 (0.361) loss_x loss_x 0.9058 (1.1693) acc_x 71.8750 (69.1406) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [45/48] time 0.502 (0.487) data 0.371 (0.355) loss_x loss_x 1.2646 (1.1771) acc_x 71.8750 (69.3056) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1457
confident_label rate tensor(0.4869, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1527
clean true:1511
clean false:16
clean_rate:0.9895219384413884
noisy true:168
noisy false:1441
after delete: len(clean_dataset) 1527
after delete: len(noisy_dataset) 1609
epoch [165/200] batch [5/47] time 0.519 (0.482) data 0.387 (0.350) loss_x loss_x 0.5317 (0.9966) acc_x 90.6250 (72.5000) lr 1.6419e-04 eta 0:00:20
epoch [165/200] batch [10/47] time 0.364 (0.458) data 0.232 (0.327) loss_x loss_x 1.1104 (1.1095) acc_x 75.0000 (72.5000) lr 1.6419e-04 eta 0:00:16
epoch [165/200] batch [15/47] time 0.512 (0.473) data 0.381 (0.342) loss_x loss_x 0.8560 (1.1318) acc_x 78.1250 (72.2917) lr 1.6419e-04 eta 0:00:15
epoch [165/200] batch [20/47] time 0.426 (0.459) data 0.295 (0.328) loss_x loss_x 1.0449 (1.1848) acc_x 68.7500 (70.6250) lr 1.6419e-04 eta 0:00:12
epoch [165/200] batch [25/47] time 0.559 (0.476) data 0.427 (0.345) loss_x loss_x 0.8237 (1.1538) acc_x 84.3750 (71.3750) lr 1.6419e-04 eta 0:00:10
epoch [165/200] batch [30/47] time 0.420 (0.472) data 0.289 (0.341) loss_x loss_x 0.7866 (1.1247) acc_x 78.1250 (71.3542) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [35/47] time 0.466 (0.467) data 0.334 (0.335) loss_x loss_x 1.2021 (1.1056) acc_x 65.6250 (71.6071) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [40/47] time 0.455 (0.465) data 0.324 (0.333) loss_x loss_x 1.5078 (1.1419) acc_x 65.6250 (70.9375) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [45/47] time 0.435 (0.461) data 0.304 (0.329) loss_x loss_x 1.6201 (1.1527) acc_x 65.6250 (70.9028) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1431
confident_label rate tensor(0.4936, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1548
clean true:1531
clean false:17
clean_rate:0.9890180878552972
noisy true:174
noisy false:1414
after delete: len(clean_dataset) 1548
after delete: len(noisy_dataset) 1588
epoch [166/200] batch [5/48] time 0.482 (0.443) data 0.350 (0.311) loss_x loss_x 1.3945 (1.2151) acc_x 62.5000 (69.3750) lr 1.5567e-04 eta 0:00:19
epoch [166/200] batch [10/48] time 0.543 (0.447) data 0.412 (0.316) loss_x loss_x 0.9468 (1.2286) acc_x 71.8750 (70.3125) lr 1.5567e-04 eta 0:00:16
epoch [166/200] batch [15/48] time 0.401 (0.442) data 0.270 (0.310) loss_x loss_x 1.1328 (1.2561) acc_x 68.7500 (67.7083) lr 1.5567e-04 eta 0:00:14
epoch [166/200] batch [20/48] time 0.511 (0.445) data 0.380 (0.314) loss_x loss_x 1.0723 (1.2347) acc_x 68.7500 (68.4375) lr 1.5567e-04 eta 0:00:12
epoch [166/200] batch [25/48] time 0.553 (0.455) data 0.418 (0.324) loss_x loss_x 1.1191 (1.2394) acc_x 65.6250 (68.1250) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [30/48] time 0.421 (0.455) data 0.290 (0.324) loss_x loss_x 1.1172 (1.2543) acc_x 71.8750 (68.2292) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [35/48] time 0.531 (0.457) data 0.400 (0.326) loss_x loss_x 1.3926 (1.2565) acc_x 71.8750 (68.3036) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [40/48] time 0.562 (0.460) data 0.431 (0.329) loss_x loss_x 1.5273 (1.2401) acc_x 62.5000 (68.3594) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [45/48] time 0.500 (0.461) data 0.368 (0.330) loss_x loss_x 1.1543 (1.2469) acc_x 78.1250 (68.4722) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1519
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1465
clean true:1446
clean false:19
clean_rate:0.9870307167235495
noisy true:171
noisy false:1500
after delete: len(clean_dataset) 1465
after delete: len(noisy_dataset) 1671
epoch [167/200] batch [5/45] time 0.436 (0.441) data 0.306 (0.310) loss_x loss_x 1.0957 (1.1323) acc_x 65.6250 (69.3750) lr 1.4736e-04 eta 0:00:17
epoch [167/200] batch [10/45] time 0.568 (0.444) data 0.438 (0.313) loss_x loss_x 1.6836 (1.1914) acc_x 65.6250 (70.0000) lr 1.4736e-04 eta 0:00:15
epoch [167/200] batch [15/45] time 0.465 (0.442) data 0.334 (0.311) loss_x loss_x 1.0615 (1.2024) acc_x 71.8750 (69.3750) lr 1.4736e-04 eta 0:00:13
epoch [167/200] batch [20/45] time 0.446 (0.450) data 0.316 (0.319) loss_x loss_x 0.7988 (1.1679) acc_x 78.1250 (69.6875) lr 1.4736e-04 eta 0:00:11
epoch [167/200] batch [25/45] time 0.638 (0.461) data 0.507 (0.330) loss_x loss_x 0.7461 (1.1376) acc_x 78.1250 (70.0000) lr 1.4736e-04 eta 0:00:09
epoch [167/200] batch [30/45] time 0.409 (0.457) data 0.278 (0.326) loss_x loss_x 0.9985 (1.1457) acc_x 78.1250 (70.8333) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [35/45] time 0.423 (0.459) data 0.293 (0.329) loss_x loss_x 2.1172 (1.1754) acc_x 50.0000 (70.8036) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [40/45] time 0.455 (0.458) data 0.323 (0.328) loss_x loss_x 1.5938 (1.1891) acc_x 65.6250 (70.3125) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [45/45] time 0.455 (0.461) data 0.323 (0.331) loss_x loss_x 1.0869 (1.1962) acc_x 68.7500 (70.0694) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1452
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1531
clean true:1515
clean false:16
clean_rate:0.9895493141737427
noisy true:169
noisy false:1436
after delete: len(clean_dataset) 1531
after delete: len(noisy_dataset) 1605
epoch [168/200] batch [5/47] time 0.481 (0.437) data 0.349 (0.305) loss_x loss_x 1.5811 (1.4734) acc_x 65.6250 (65.6250) lr 1.3926e-04 eta 0:00:18
epoch [168/200] batch [10/47] time 0.340 (0.452) data 0.209 (0.320) loss_x loss_x 1.3594 (1.3680) acc_x 71.8750 (68.7500) lr 1.3926e-04 eta 0:00:16
epoch [168/200] batch [15/47] time 0.423 (0.470) data 0.291 (0.338) loss_x loss_x 1.0459 (1.2650) acc_x 62.5000 (68.1250) lr 1.3926e-04 eta 0:00:15
epoch [168/200] batch [20/47] time 0.477 (0.466) data 0.346 (0.335) loss_x loss_x 1.1738 (1.2197) acc_x 71.8750 (69.8438) lr 1.3926e-04 eta 0:00:12
epoch [168/200] batch [25/47] time 0.538 (0.475) data 0.407 (0.343) loss_x loss_x 1.1338 (1.2056) acc_x 68.7500 (70.1250) lr 1.3926e-04 eta 0:00:10
epoch [168/200] batch [30/47] time 0.481 (0.487) data 0.350 (0.356) loss_x loss_x 1.5342 (1.1974) acc_x 65.6250 (70.8333) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [35/47] time 0.483 (0.484) data 0.352 (0.352) loss_x loss_x 1.2939 (1.2029) acc_x 68.7500 (70.8929) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [40/47] time 0.401 (0.480) data 0.269 (0.348) loss_x loss_x 0.9028 (1.1800) acc_x 81.2500 (71.3281) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [45/47] time 0.498 (0.481) data 0.367 (0.350) loss_x loss_x 1.1484 (1.1860) acc_x 65.6250 (70.9028) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1469
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1500
clean true:1489
clean false:11
clean_rate:0.9926666666666667
noisy true:178
noisy false:1458
after delete: len(clean_dataset) 1500
after delete: len(noisy_dataset) 1636
epoch [169/200] batch [5/46] time 0.451 (0.478) data 0.320 (0.346) loss_x loss_x 1.1777 (0.9965) acc_x 71.8750 (78.1250) lr 1.3137e-04 eta 0:00:19
epoch [169/200] batch [10/46] time 0.443 (0.475) data 0.313 (0.344) loss_x loss_x 1.1191 (1.2221) acc_x 65.6250 (71.5625) lr 1.3137e-04 eta 0:00:17
epoch [169/200] batch [15/46] time 0.570 (0.474) data 0.440 (0.343) loss_x loss_x 1.2412 (1.1358) acc_x 68.7500 (72.2917) lr 1.3137e-04 eta 0:00:14
epoch [169/200] batch [20/46] time 0.538 (0.480) data 0.407 (0.349) loss_x loss_x 1.1582 (1.1554) acc_x 65.6250 (70.9375) lr 1.3137e-04 eta 0:00:12
epoch [169/200] batch [25/46] time 0.519 (0.475) data 0.387 (0.344) loss_x loss_x 0.7695 (1.1326) acc_x 84.3750 (71.8750) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [30/46] time 0.532 (0.490) data 0.396 (0.358) loss_x loss_x 1.4121 (1.1439) acc_x 71.8750 (70.9375) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [35/46] time 0.430 (0.489) data 0.299 (0.358) loss_x loss_x 1.3311 (1.1567) acc_x 75.0000 (70.9821) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [40/46] time 0.586 (0.489) data 0.454 (0.357) loss_x loss_x 1.0693 (1.1796) acc_x 78.1250 (70.7031) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [45/46] time 0.437 (0.486) data 0.305 (0.354) loss_x loss_x 1.1885 (1.1813) acc_x 65.6250 (70.6250) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1457
confident_label rate tensor(0.4866, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1526
clean true:1503
clean false:23
clean_rate:0.9849279161205766
noisy true:176
noisy false:1434
after delete: len(clean_dataset) 1526
after delete: len(noisy_dataset) 1610
epoch [170/200] batch [5/47] time 0.647 (0.452) data 0.516 (0.320) loss_x loss_x 1.1582 (1.4624) acc_x 71.8750 (64.3750) lr 1.2369e-04 eta 0:00:18
epoch [170/200] batch [10/47] time 0.415 (0.450) data 0.284 (0.318) loss_x loss_x 1.3418 (1.4595) acc_x 68.7500 (63.4375) lr 1.2369e-04 eta 0:00:16
epoch [170/200] batch [15/47] time 0.490 (0.460) data 0.358 (0.329) loss_x loss_x 0.9966 (1.3221) acc_x 81.2500 (68.1250) lr 1.2369e-04 eta 0:00:14
epoch [170/200] batch [20/47] time 0.514 (0.453) data 0.382 (0.322) loss_x loss_x 1.6396 (1.3293) acc_x 62.5000 (66.2500) lr 1.2369e-04 eta 0:00:12
epoch [170/200] batch [25/47] time 0.373 (0.460) data 0.242 (0.329) loss_x loss_x 0.5576 (1.2543) acc_x 87.5000 (68.2500) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [30/47] time 0.403 (0.453) data 0.273 (0.321) loss_x loss_x 0.7915 (1.2270) acc_x 81.2500 (68.7500) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [35/47] time 0.410 (0.466) data 0.279 (0.335) loss_x loss_x 1.0566 (1.2086) acc_x 81.2500 (69.2857) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [40/47] time 0.447 (0.464) data 0.317 (0.333) loss_x loss_x 1.3330 (1.2058) acc_x 65.6250 (69.4531) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [45/47] time 0.602 (0.466) data 0.472 (0.335) loss_x loss_x 1.0068 (1.2170) acc_x 75.0000 (69.3056) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1449
confident_label rate tensor(0.4888, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1533
clean true:1525
clean false:8
clean_rate:0.994781474233529
noisy true:162
noisy false:1441
after delete: len(clean_dataset) 1533
after delete: len(noisy_dataset) 1603
epoch [171/200] batch [5/47] time 0.497 (0.523) data 0.365 (0.392) loss_x loss_x 0.6665 (1.1376) acc_x 78.1250 (69.3750) lr 1.1623e-04 eta 0:00:21
epoch [171/200] batch [10/47] time 0.518 (0.492) data 0.388 (0.360) loss_x loss_x 1.2334 (1.2594) acc_x 68.7500 (68.1250) lr 1.1623e-04 eta 0:00:18
epoch [171/200] batch [15/47] time 0.399 (0.478) data 0.267 (0.347) loss_x loss_x 1.0381 (1.1800) acc_x 68.7500 (69.3750) lr 1.1623e-04 eta 0:00:15
epoch [171/200] batch [20/47] time 0.410 (0.479) data 0.279 (0.347) loss_x loss_x 0.9668 (1.2012) acc_x 65.6250 (69.0625) lr 1.1623e-04 eta 0:00:12
epoch [171/200] batch [25/47] time 0.400 (0.469) data 0.270 (0.338) loss_x loss_x 0.9844 (1.1623) acc_x 75.0000 (70.0000) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [30/47] time 0.545 (0.467) data 0.415 (0.336) loss_x loss_x 0.8569 (1.1491) acc_x 84.3750 (70.4167) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [35/47] time 0.541 (0.466) data 0.410 (0.335) loss_x loss_x 1.0537 (1.1292) acc_x 68.7500 (71.3393) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [40/47] time 0.449 (0.466) data 0.318 (0.335) loss_x loss_x 1.3057 (1.1337) acc_x 59.3750 (71.0938) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [45/47] time 0.521 (0.464) data 0.391 (0.333) loss_x loss_x 1.2295 (1.1514) acc_x 81.2500 (70.9028) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1472
confident_label rate tensor(0.4828, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1514
clean true:1499
clean false:15
clean_rate:0.9900924702774109
noisy true:165
noisy false:1457
after delete: len(clean_dataset) 1514
after delete: len(noisy_dataset) 1622
epoch [172/200] batch [5/47] time 0.395 (0.416) data 0.264 (0.284) loss_x loss_x 1.3623 (1.1883) acc_x 68.7500 (73.7500) lr 1.0899e-04 eta 0:00:17
epoch [172/200] batch [10/47] time 0.403 (0.451) data 0.272 (0.320) loss_x loss_x 1.3828 (1.2384) acc_x 65.6250 (69.3750) lr 1.0899e-04 eta 0:00:16
epoch [172/200] batch [15/47] time 0.489 (0.450) data 0.358 (0.319) loss_x loss_x 1.1357 (1.2979) acc_x 78.1250 (68.3333) lr 1.0899e-04 eta 0:00:14
epoch [172/200] batch [20/47] time 0.534 (0.463) data 0.403 (0.331) loss_x loss_x 0.8716 (1.2586) acc_x 84.3750 (69.3750) lr 1.0899e-04 eta 0:00:12
epoch [172/200] batch [25/47] time 0.547 (0.463) data 0.417 (0.332) loss_x loss_x 0.9253 (1.2566) acc_x 78.1250 (70.2500) lr 1.0899e-04 eta 0:00:10
epoch [172/200] batch [30/47] time 0.566 (0.460) data 0.434 (0.328) loss_x loss_x 1.4189 (1.2666) acc_x 65.6250 (69.2708) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [35/47] time 0.322 (0.458) data 0.192 (0.327) loss_x loss_x 1.1768 (1.2695) acc_x 62.5000 (68.3036) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [40/47] time 0.712 (0.468) data 0.582 (0.337) loss_x loss_x 1.5166 (1.2493) acc_x 68.7500 (68.9844) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [45/47] time 0.413 (0.468) data 0.283 (0.336) loss_x loss_x 1.3525 (1.2290) acc_x 62.5000 (69.7917) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1463
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1519
clean true:1505
clean false:14
clean_rate:0.9907834101382489
noisy true:168
noisy false:1449
after delete: len(clean_dataset) 1519
after delete: len(noisy_dataset) 1617
epoch [173/200] batch [5/47] time 0.436 (0.437) data 0.305 (0.306) loss_x loss_x 0.9062 (1.0353) acc_x 78.1250 (78.7500) lr 1.0197e-04 eta 0:00:18
epoch [173/200] batch [10/47] time 0.460 (0.447) data 0.328 (0.316) loss_x loss_x 1.2197 (1.1191) acc_x 65.6250 (75.6250) lr 1.0197e-04 eta 0:00:16
epoch [173/200] batch [15/47] time 0.505 (0.451) data 0.374 (0.320) loss_x loss_x 1.1631 (1.1445) acc_x 75.0000 (73.9583) lr 1.0197e-04 eta 0:00:14
epoch [173/200] batch [20/47] time 0.393 (0.450) data 0.262 (0.318) loss_x loss_x 1.4434 (1.2185) acc_x 53.1250 (71.0938) lr 1.0197e-04 eta 0:00:12
epoch [173/200] batch [25/47] time 0.423 (0.451) data 0.291 (0.320) loss_x loss_x 1.3760 (1.2323) acc_x 56.2500 (71.0000) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [30/47] time 0.533 (0.449) data 0.402 (0.318) loss_x loss_x 0.8833 (1.2223) acc_x 68.7500 (70.4167) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [35/47] time 0.363 (0.444) data 0.232 (0.313) loss_x loss_x 0.9121 (1.2023) acc_x 71.8750 (70.6250) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [40/47] time 0.386 (0.441) data 0.254 (0.310) loss_x loss_x 1.2422 (1.2217) acc_x 71.8750 (70.4688) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [45/47] time 0.429 (0.451) data 0.297 (0.320) loss_x loss_x 1.2168 (1.2350) acc_x 59.3750 (69.5139) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1474
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1513
clean true:1497
clean false:16
clean_rate:0.9894249834765367
noisy true:165
noisy false:1458
after delete: len(clean_dataset) 1513
after delete: len(noisy_dataset) 1623
epoch [174/200] batch [5/47] time 0.443 (0.441) data 0.312 (0.311) loss_x loss_x 2.1680 (1.3621) acc_x 43.7500 (66.2500) lr 9.5173e-05 eta 0:00:18
epoch [174/200] batch [10/47] time 0.456 (0.437) data 0.324 (0.306) loss_x loss_x 1.5088 (1.3013) acc_x 59.3750 (69.0625) lr 9.5173e-05 eta 0:00:16
epoch [174/200] batch [15/47] time 0.519 (0.438) data 0.388 (0.307) loss_x loss_x 1.0312 (1.2594) acc_x 78.1250 (69.3750) lr 9.5173e-05 eta 0:00:14
epoch [174/200] batch [20/47] time 0.698 (0.455) data 0.567 (0.324) loss_x loss_x 1.2080 (1.2876) acc_x 81.2500 (70.3125) lr 9.5173e-05 eta 0:00:12
epoch [174/200] batch [25/47] time 0.482 (0.460) data 0.351 (0.329) loss_x loss_x 1.1367 (1.2543) acc_x 59.3750 (70.1250) lr 9.5173e-05 eta 0:00:10
epoch [174/200] batch [30/47] time 0.499 (0.463) data 0.368 (0.332) loss_x loss_x 0.9580 (1.2370) acc_x 75.0000 (69.6875) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [35/47] time 0.469 (0.459) data 0.337 (0.328) loss_x loss_x 1.7412 (1.2254) acc_x 59.3750 (69.9107) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [40/47] time 0.419 (0.460) data 0.288 (0.329) loss_x loss_x 0.7681 (1.2325) acc_x 81.2500 (69.6094) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [45/47] time 0.595 (0.467) data 0.463 (0.336) loss_x loss_x 1.6064 (1.2322) acc_x 53.1250 (69.1667) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1445
confident_label rate tensor(0.4917, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1542
clean true:1529
clean false:13
clean_rate:0.9915693904020753
noisy true:162
noisy false:1432
after delete: len(clean_dataset) 1542
after delete: len(noisy_dataset) 1594
epoch [175/200] batch [5/48] time 0.480 (0.460) data 0.350 (0.330) loss_x loss_x 1.1523 (1.1648) acc_x 75.0000 (73.1250) lr 8.8597e-05 eta 0:00:19
epoch [175/200] batch [10/48] time 0.655 (0.473) data 0.525 (0.343) loss_x loss_x 1.0049 (1.1424) acc_x 81.2500 (74.0625) lr 8.8597e-05 eta 0:00:17
epoch [175/200] batch [15/48] time 0.468 (0.461) data 0.337 (0.330) loss_x loss_x 1.2412 (1.0847) acc_x 68.7500 (73.7500) lr 8.8597e-05 eta 0:00:15
epoch [175/200] batch [20/48] time 0.391 (0.458) data 0.261 (0.328) loss_x loss_x 1.2168 (1.0679) acc_x 71.8750 (74.2188) lr 8.8597e-05 eta 0:00:12
epoch [175/200] batch [25/48] time 0.473 (0.461) data 0.341 (0.331) loss_x loss_x 1.1963 (1.0949) acc_x 75.0000 (73.6250) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [30/48] time 0.462 (0.463) data 0.331 (0.332) loss_x loss_x 1.1533 (1.1236) acc_x 65.6250 (72.6042) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [35/48] time 0.428 (0.458) data 0.296 (0.327) loss_x loss_x 0.9888 (1.1220) acc_x 75.0000 (72.7679) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [40/48] time 0.445 (0.457) data 0.314 (0.326) loss_x loss_x 0.9409 (1.1185) acc_x 78.1250 (72.4219) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [45/48] time 0.580 (0.467) data 0.444 (0.336) loss_x loss_x 1.3457 (1.1375) acc_x 71.8750 (71.8750) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1501
confident_label rate tensor(0.4758, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1492
clean true:1473
clean false:19
clean_rate:0.9872654155495979
noisy true:162
noisy false:1482
after delete: len(clean_dataset) 1492
after delete: len(noisy_dataset) 1644
epoch [176/200] batch [5/46] time 0.464 (0.454) data 0.333 (0.323) loss_x loss_x 1.0898 (1.0861) acc_x 62.5000 (66.2500) lr 8.2245e-05 eta 0:00:18
epoch [176/200] batch [10/46] time 0.414 (0.460) data 0.283 (0.329) loss_x loss_x 1.6504 (1.1443) acc_x 59.3750 (67.5000) lr 8.2245e-05 eta 0:00:16
epoch [176/200] batch [15/46] time 0.540 (0.472) data 0.407 (0.341) loss_x loss_x 1.0283 (1.1070) acc_x 71.8750 (68.7500) lr 8.2245e-05 eta 0:00:14
epoch [176/200] batch [20/46] time 0.403 (0.476) data 0.272 (0.345) loss_x loss_x 1.0840 (1.1622) acc_x 71.8750 (68.2812) lr 8.2245e-05 eta 0:00:12
epoch [176/200] batch [25/46] time 0.471 (0.471) data 0.340 (0.340) loss_x loss_x 1.5693 (1.1720) acc_x 65.6250 (68.3750) lr 8.2245e-05 eta 0:00:09
epoch [176/200] batch [30/46] time 0.449 (0.480) data 0.318 (0.349) loss_x loss_x 1.2715 (1.1568) acc_x 75.0000 (69.1667) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [35/46] time 0.651 (0.485) data 0.519 (0.354) loss_x loss_x 1.0361 (1.1668) acc_x 71.8750 (69.2857) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [40/46] time 0.630 (0.485) data 0.499 (0.354) loss_x loss_x 1.3535 (1.1762) acc_x 65.6250 (69.0625) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [45/46] time 0.306 (0.490) data 0.175 (0.359) loss_x loss_x 0.9312 (1.1580) acc_x 78.1250 (69.7222) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1422
confident_label rate tensor(0.4952, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1553
clean true:1540
clean false:13
clean_rate:0.9916291049581455
noisy true:174
noisy false:1409
after delete: len(clean_dataset) 1553
after delete: len(noisy_dataset) 1583
epoch [177/200] batch [5/48] time 0.333 (0.458) data 0.202 (0.327) loss_x loss_x 1.1270 (1.2623) acc_x 71.8750 (70.6250) lr 7.6120e-05 eta 0:00:19
epoch [177/200] batch [10/48] time 0.523 (0.448) data 0.392 (0.316) loss_x loss_x 0.9131 (1.2252) acc_x 75.0000 (70.6250) lr 7.6120e-05 eta 0:00:17
epoch [177/200] batch [15/48] time 0.379 (0.455) data 0.248 (0.324) loss_x loss_x 1.6465 (1.2698) acc_x 46.8750 (69.1667) lr 7.6120e-05 eta 0:00:15
epoch [177/200] batch [20/48] time 0.358 (0.467) data 0.227 (0.335) loss_x loss_x 1.7891 (1.2867) acc_x 56.2500 (68.1250) lr 7.6120e-05 eta 0:00:13
epoch [177/200] batch [25/48] time 0.456 (0.472) data 0.325 (0.341) loss_x loss_x 1.7520 (1.3098) acc_x 62.5000 (67.7500) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [30/48] time 0.380 (0.463) data 0.249 (0.332) loss_x loss_x 1.2402 (1.3004) acc_x 71.8750 (67.2917) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [35/48] time 0.488 (0.465) data 0.357 (0.334) loss_x loss_x 1.1846 (1.2808) acc_x 68.7500 (68.2143) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [40/48] time 0.447 (0.462) data 0.317 (0.331) loss_x loss_x 1.3242 (1.2649) acc_x 56.2500 (68.2812) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [45/48] time 0.489 (0.463) data 0.358 (0.333) loss_x loss_x 2.0547 (1.2801) acc_x 59.3750 (68.1944) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1469
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1513
clean true:1501
clean false:12
clean_rate:0.9920687376074026
noisy true:166
noisy false:1457
after delete: len(clean_dataset) 1513
after delete: len(noisy_dataset) 1623
epoch [178/200] batch [5/47] time 0.477 (0.476) data 0.346 (0.344) loss_x loss_x 1.3711 (1.2751) acc_x 62.5000 (65.0000) lr 7.0224e-05 eta 0:00:19
epoch [178/200] batch [10/47] time 0.463 (0.468) data 0.333 (0.337) loss_x loss_x 1.2041 (1.1168) acc_x 65.6250 (70.3125) lr 7.0224e-05 eta 0:00:17
epoch [178/200] batch [15/47] time 0.393 (0.471) data 0.263 (0.340) loss_x loss_x 1.5381 (1.1258) acc_x 53.1250 (69.5833) lr 7.0224e-05 eta 0:00:15
epoch [178/200] batch [20/47] time 0.715 (0.484) data 0.585 (0.353) loss_x loss_x 1.5146 (1.1184) acc_x 59.3750 (70.0000) lr 7.0224e-05 eta 0:00:13
epoch [178/200] batch [25/47] time 0.385 (0.473) data 0.255 (0.342) loss_x loss_x 1.5293 (1.1222) acc_x 68.7500 (70.0000) lr 7.0224e-05 eta 0:00:10
epoch [178/200] batch [30/47] time 0.424 (0.470) data 0.294 (0.339) loss_x loss_x 1.4893 (1.1352) acc_x 62.5000 (69.4792) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [35/47] time 0.383 (0.458) data 0.253 (0.327) loss_x loss_x 1.0684 (1.1235) acc_x 71.8750 (70.0893) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [40/47] time 0.462 (0.461) data 0.332 (0.330) loss_x loss_x 1.0283 (1.1322) acc_x 68.7500 (69.7656) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [45/47] time 0.373 (0.458) data 0.242 (0.327) loss_x loss_x 1.3770 (1.1578) acc_x 71.8750 (69.2361) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1446
confident_label rate tensor(0.4908, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1539
clean true:1520
clean false:19
clean_rate:0.9876543209876543
noisy true:170
noisy false:1427
after delete: len(clean_dataset) 1539
after delete: len(noisy_dataset) 1597
epoch [179/200] batch [5/48] time 0.421 (0.454) data 0.289 (0.322) loss_x loss_x 1.1455 (1.2362) acc_x 71.8750 (68.7500) lr 6.4556e-05 eta 0:00:19
epoch [179/200] batch [10/48] time 0.583 (0.465) data 0.452 (0.334) loss_x loss_x 1.0830 (1.1957) acc_x 71.8750 (68.4375) lr 6.4556e-05 eta 0:00:17
epoch [179/200] batch [15/48] time 0.458 (0.475) data 0.327 (0.344) loss_x loss_x 1.1973 (1.1538) acc_x 59.3750 (68.7500) lr 6.4556e-05 eta 0:00:15
epoch [179/200] batch [20/48] time 0.725 (0.485) data 0.595 (0.353) loss_x loss_x 0.9985 (1.1231) acc_x 81.2500 (71.2500) lr 6.4556e-05 eta 0:00:13
epoch [179/200] batch [25/48] time 0.392 (0.485) data 0.262 (0.354) loss_x loss_x 1.1064 (1.1325) acc_x 81.2500 (71.5000) lr 6.4556e-05 eta 0:00:11
epoch [179/200] batch [30/48] time 0.361 (0.473) data 0.230 (0.342) loss_x loss_x 1.3389 (1.1505) acc_x 62.5000 (70.9375) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [35/48] time 0.450 (0.473) data 0.318 (0.342) loss_x loss_x 0.6265 (1.1511) acc_x 84.3750 (71.0714) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [40/48] time 0.451 (0.469) data 0.321 (0.338) loss_x loss_x 1.0020 (1.1347) acc_x 71.8750 (71.3281) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [45/48] time 0.506 (0.466) data 0.375 (0.335) loss_x loss_x 1.1543 (1.1318) acc_x 68.7500 (71.7361) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1485
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1513
clean true:1495
clean false:18
clean_rate:0.9881031064111038
noisy true:156
noisy false:1467
after delete: len(clean_dataset) 1513
after delete: len(noisy_dataset) 1623
epoch [180/200] batch [5/47] time 0.516 (0.442) data 0.384 (0.310) loss_x loss_x 0.9990 (1.4660) acc_x 78.1250 (61.8750) lr 5.9119e-05 eta 0:00:18
epoch [180/200] batch [10/47] time 0.530 (0.463) data 0.399 (0.331) loss_x loss_x 1.2900 (1.3268) acc_x 78.1250 (67.1875) lr 5.9119e-05 eta 0:00:17
epoch [180/200] batch [15/47] time 0.487 (0.470) data 0.356 (0.338) loss_x loss_x 1.3760 (1.2624) acc_x 53.1250 (67.7083) lr 5.9119e-05 eta 0:00:15
epoch [180/200] batch [20/47] time 0.429 (0.468) data 0.298 (0.336) loss_x loss_x 0.7295 (1.2186) acc_x 78.1250 (68.5938) lr 5.9119e-05 eta 0:00:12
epoch [180/200] batch [25/47] time 0.478 (0.465) data 0.347 (0.334) loss_x loss_x 0.9360 (1.1809) acc_x 75.0000 (70.0000) lr 5.9119e-05 eta 0:00:10
epoch [180/200] batch [30/47] time 0.405 (0.459) data 0.274 (0.328) loss_x loss_x 1.3613 (1.1890) acc_x 59.3750 (69.2708) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [35/47] time 0.484 (0.461) data 0.353 (0.329) loss_x loss_x 0.8970 (1.1871) acc_x 71.8750 (69.1964) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [40/47] time 0.402 (0.456) data 0.271 (0.325) loss_x loss_x 0.9351 (1.1775) acc_x 75.0000 (69.5312) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [45/47] time 0.421 (0.453) data 0.289 (0.322) loss_x loss_x 0.7939 (1.1538) acc_x 75.0000 (70.1389) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1466
confident_label rate tensor(0.4850, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1521
clean true:1502
clean false:19
clean_rate:0.9875082182774491
noisy true:168
noisy false:1447
after delete: len(clean_dataset) 1521
after delete: len(noisy_dataset) 1615
epoch [181/200] batch [5/47] time 0.532 (0.448) data 0.402 (0.318) loss_x loss_x 1.0156 (1.3166) acc_x 68.7500 (72.5000) lr 5.3915e-05 eta 0:00:18
epoch [181/200] batch [10/47] time 0.381 (0.450) data 0.250 (0.320) loss_x loss_x 1.3682 (1.2350) acc_x 65.6250 (69.6875) lr 5.3915e-05 eta 0:00:16
epoch [181/200] batch [15/47] time 0.438 (0.442) data 0.308 (0.311) loss_x loss_x 1.3623 (1.2521) acc_x 59.3750 (69.3750) lr 5.3915e-05 eta 0:00:14
epoch [181/200] batch [20/47] time 0.472 (0.437) data 0.342 (0.307) loss_x loss_x 1.1865 (1.2760) acc_x 62.5000 (69.2188) lr 5.3915e-05 eta 0:00:11
epoch [181/200] batch [25/47] time 0.476 (0.439) data 0.346 (0.309) loss_x loss_x 0.8779 (1.2195) acc_x 81.2500 (70.0000) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [30/47] time 0.374 (0.441) data 0.244 (0.310) loss_x loss_x 1.0469 (1.1992) acc_x 75.0000 (70.0000) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [35/47] time 0.332 (0.440) data 0.201 (0.310) loss_x loss_x 1.1768 (1.1780) acc_x 71.8750 (70.6250) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [40/47] time 0.504 (0.436) data 0.374 (0.306) loss_x loss_x 1.3184 (1.1883) acc_x 65.6250 (70.1562) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [45/47] time 0.426 (0.442) data 0.296 (0.312) loss_x loss_x 1.0371 (1.1648) acc_x 75.0000 (70.5556) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1445
confident_label rate tensor(0.4872, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1528
clean true:1508
clean false:20
clean_rate:0.9869109947643979
noisy true:183
noisy false:1425
after delete: len(clean_dataset) 1528
after delete: len(noisy_dataset) 1608
epoch [182/200] batch [5/47] time 0.424 (0.461) data 0.293 (0.331) loss_x loss_x 0.6909 (0.9047) acc_x 81.2500 (78.1250) lr 4.8943e-05 eta 0:00:19
epoch [182/200] batch [10/47] time 0.421 (0.438) data 0.291 (0.307) loss_x loss_x 0.9878 (1.0439) acc_x 71.8750 (73.7500) lr 4.8943e-05 eta 0:00:16
epoch [182/200] batch [15/47] time 0.481 (0.432) data 0.351 (0.302) loss_x loss_x 1.3994 (1.0429) acc_x 75.0000 (74.3750) lr 4.8943e-05 eta 0:00:13
epoch [182/200] batch [20/47] time 0.410 (0.429) data 0.279 (0.299) loss_x loss_x 1.2070 (1.0814) acc_x 75.0000 (72.9688) lr 4.8943e-05 eta 0:00:11
epoch [182/200] batch [25/47] time 0.441 (0.434) data 0.311 (0.303) loss_x loss_x 0.9780 (1.0386) acc_x 75.0000 (74.0000) lr 4.8943e-05 eta 0:00:09
epoch [182/200] batch [30/47] time 0.527 (0.442) data 0.397 (0.312) loss_x loss_x 0.9629 (1.0231) acc_x 84.3750 (74.6875) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [35/47] time 0.430 (0.444) data 0.300 (0.314) loss_x loss_x 1.6162 (1.0531) acc_x 50.0000 (73.6607) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [40/47] time 0.468 (0.439) data 0.337 (0.309) loss_x loss_x 0.8535 (1.0371) acc_x 75.0000 (73.5156) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [45/47] time 0.384 (0.443) data 0.254 (0.313) loss_x loss_x 1.0537 (1.0508) acc_x 78.1250 (73.2639) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1485
confident_label rate tensor(0.4863, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1525
clean true:1503
clean false:22
clean_rate:0.9855737704918033
noisy true:148
noisy false:1463
after delete: len(clean_dataset) 1525
after delete: len(noisy_dataset) 1611
epoch [183/200] batch [5/47] time 0.387 (0.463) data 0.256 (0.332) loss_x loss_x 0.9614 (1.1635) acc_x 68.7500 (67.5000) lr 4.4207e-05 eta 0:00:19
epoch [183/200] batch [10/47] time 0.424 (0.462) data 0.292 (0.331) loss_x loss_x 1.0947 (1.1168) acc_x 78.1250 (70.0000) lr 4.4207e-05 eta 0:00:17
epoch [183/200] batch [15/47] time 0.410 (0.445) data 0.279 (0.314) loss_x loss_x 1.0850 (1.1211) acc_x 68.7500 (70.4167) lr 4.4207e-05 eta 0:00:14
epoch [183/200] batch [20/47] time 0.374 (0.441) data 0.243 (0.309) loss_x loss_x 1.1758 (1.1061) acc_x 71.8750 (70.4688) lr 4.4207e-05 eta 0:00:11
epoch [183/200] batch [25/47] time 0.448 (0.448) data 0.316 (0.317) loss_x loss_x 1.0498 (1.1676) acc_x 75.0000 (69.1250) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [30/47] time 0.469 (0.448) data 0.338 (0.317) loss_x loss_x 0.9624 (1.1094) acc_x 71.8750 (70.6250) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [35/47] time 0.515 (0.452) data 0.384 (0.321) loss_x loss_x 0.9731 (1.1014) acc_x 65.6250 (70.1786) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [40/47] time 0.387 (0.451) data 0.256 (0.320) loss_x loss_x 0.7383 (1.1199) acc_x 81.2500 (69.3750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [45/47] time 0.368 (0.447) data 0.237 (0.316) loss_x loss_x 1.2627 (1.1039) acc_x 75.0000 (70.2083) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1431
confident_label rate tensor(0.4968, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1558
clean true:1540
clean false:18
clean_rate:0.9884467265725289
noisy true:165
noisy false:1413
after delete: len(clean_dataset) 1558
after delete: len(noisy_dataset) 1578
epoch [184/200] batch [5/48] time 0.425 (0.453) data 0.293 (0.321) loss_x loss_x 1.4902 (1.0460) acc_x 56.2500 (72.5000) lr 3.9706e-05 eta 0:00:19
epoch [184/200] batch [10/48] time 0.434 (0.440) data 0.303 (0.309) loss_x loss_x 1.2578 (1.1952) acc_x 68.7500 (70.0000) lr 3.9706e-05 eta 0:00:16
epoch [184/200] batch [15/48] time 0.454 (0.432) data 0.323 (0.301) loss_x loss_x 1.0381 (1.1180) acc_x 71.8750 (71.6667) lr 3.9706e-05 eta 0:00:14
epoch [184/200] batch [20/48] time 0.521 (0.448) data 0.390 (0.317) loss_x loss_x 0.9561 (1.0956) acc_x 68.7500 (72.0312) lr 3.9706e-05 eta 0:00:12
epoch [184/200] batch [25/48] time 0.373 (0.446) data 0.242 (0.315) loss_x loss_x 1.5332 (1.1404) acc_x 59.3750 (71.0000) lr 3.9706e-05 eta 0:00:10
epoch [184/200] batch [30/48] time 0.522 (0.449) data 0.392 (0.317) loss_x loss_x 1.1973 (1.1477) acc_x 65.6250 (70.6250) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [35/48] time 0.536 (0.454) data 0.406 (0.323) loss_x loss_x 1.4688 (1.1663) acc_x 56.2500 (70.3571) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [40/48] time 0.585 (0.461) data 0.454 (0.330) loss_x loss_x 0.9971 (1.1665) acc_x 68.7500 (69.3750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [45/48] time 0.415 (0.458) data 0.284 (0.327) loss_x loss_x 0.9966 (1.1595) acc_x 75.0000 (69.7222) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1470
confident_label rate tensor(0.4809, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1508
clean true:1490
clean false:18
clean_rate:0.9880636604774535
noisy true:176
noisy false:1452
after delete: len(clean_dataset) 1508
after delete: len(noisy_dataset) 1628
epoch [185/200] batch [5/47] time 0.486 (0.464) data 0.355 (0.334) loss_x loss_x 1.2031 (1.1779) acc_x 71.8750 (71.2500) lr 3.5443e-05 eta 0:00:19
epoch [185/200] batch [10/47] time 0.542 (0.464) data 0.411 (0.333) loss_x loss_x 1.0977 (1.1872) acc_x 68.7500 (70.6250) lr 3.5443e-05 eta 0:00:17
epoch [185/200] batch [15/47] time 0.411 (0.457) data 0.281 (0.326) loss_x loss_x 1.6396 (1.1701) acc_x 59.3750 (71.8750) lr 3.5443e-05 eta 0:00:14
epoch [185/200] batch [20/47] time 0.391 (0.462) data 0.261 (0.331) loss_x loss_x 0.9082 (1.1676) acc_x 87.5000 (72.0312) lr 3.5443e-05 eta 0:00:12
epoch [185/200] batch [25/47] time 0.567 (0.461) data 0.435 (0.330) loss_x loss_x 1.6904 (1.1583) acc_x 46.8750 (71.3750) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [30/47] time 0.491 (0.463) data 0.361 (0.332) loss_x loss_x 1.0811 (1.1807) acc_x 71.8750 (70.9375) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [35/47] time 0.506 (0.467) data 0.376 (0.336) loss_x loss_x 0.5820 (1.1554) acc_x 81.2500 (71.3393) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [40/47] time 0.404 (0.461) data 0.274 (0.330) loss_x loss_x 0.5215 (1.1324) acc_x 84.3750 (71.6406) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [45/47] time 0.408 (0.463) data 0.278 (0.332) loss_x loss_x 1.0391 (1.1279) acc_x 71.8750 (71.5972) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1440
confident_label rate tensor(0.4930, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1546
clean true:1530
clean false:16
clean_rate:0.9896507115135834
noisy true:166
noisy false:1424
after delete: len(clean_dataset) 1546
after delete: len(noisy_dataset) 1590
epoch [186/200] batch [5/48] time 0.421 (0.466) data 0.291 (0.335) loss_x loss_x 1.0361 (1.2491) acc_x 71.8750 (67.5000) lr 3.1417e-05 eta 0:00:20
epoch [186/200] batch [10/48] time 0.541 (0.470) data 0.409 (0.338) loss_x loss_x 0.9429 (1.2230) acc_x 75.0000 (69.0625) lr 3.1417e-05 eta 0:00:17
epoch [186/200] batch [15/48] time 0.525 (0.461) data 0.393 (0.329) loss_x loss_x 1.2832 (1.1792) acc_x 78.1250 (71.4583) lr 3.1417e-05 eta 0:00:15
epoch [186/200] batch [20/48] time 0.408 (0.450) data 0.277 (0.319) loss_x loss_x 1.1152 (1.1786) acc_x 62.5000 (70.9375) lr 3.1417e-05 eta 0:00:12
epoch [186/200] batch [25/48] time 0.408 (0.449) data 0.277 (0.317) loss_x loss_x 0.8403 (1.1838) acc_x 81.2500 (70.6250) lr 3.1417e-05 eta 0:00:10
epoch [186/200] batch [30/48] time 0.502 (0.458) data 0.371 (0.327) loss_x loss_x 1.7031 (1.2335) acc_x 65.6250 (68.7500) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [35/48] time 0.470 (0.455) data 0.339 (0.323) loss_x loss_x 1.5420 (1.2445) acc_x 65.6250 (68.6607) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [40/48] time 0.445 (0.447) data 0.314 (0.316) loss_x loss_x 1.2988 (1.2357) acc_x 56.2500 (68.7500) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [45/48] time 0.520 (0.450) data 0.389 (0.318) loss_x loss_x 1.5166 (1.2435) acc_x 68.7500 (68.8194) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1458
confident_label rate tensor(0.4841, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1518
clean true:1502
clean false:16
clean_rate:0.9894598155467721
noisy true:176
noisy false:1442
after delete: len(clean_dataset) 1518
after delete: len(noisy_dataset) 1618
epoch [187/200] batch [5/47] time 0.443 (0.460) data 0.312 (0.329) loss_x loss_x 1.0967 (1.2037) acc_x 71.8750 (67.5000) lr 2.7630e-05 eta 0:00:19
epoch [187/200] batch [10/47] time 0.394 (0.476) data 0.263 (0.345) loss_x loss_x 0.8804 (1.1197) acc_x 84.3750 (70.6250) lr 2.7630e-05 eta 0:00:17
epoch [187/200] batch [15/47] time 0.424 (0.475) data 0.293 (0.342) loss_x loss_x 1.3428 (1.1928) acc_x 71.8750 (69.5833) lr 2.7630e-05 eta 0:00:15
epoch [187/200] batch [20/47] time 0.495 (0.462) data 0.364 (0.330) loss_x loss_x 1.3789 (1.2096) acc_x 59.3750 (68.7500) lr 2.7630e-05 eta 0:00:12
epoch [187/200] batch [25/47] time 0.494 (0.464) data 0.363 (0.332) loss_x loss_x 1.2715 (1.1825) acc_x 65.6250 (68.6250) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [30/47] time 0.453 (0.465) data 0.321 (0.334) loss_x loss_x 1.0234 (1.1884) acc_x 75.0000 (69.0625) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [35/47] time 0.403 (0.460) data 0.272 (0.329) loss_x loss_x 0.9346 (1.2001) acc_x 75.0000 (68.7500) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [40/47] time 0.396 (0.466) data 0.265 (0.334) loss_x loss_x 1.0605 (1.1866) acc_x 71.8750 (69.0625) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [45/47] time 0.507 (0.465) data 0.376 (0.334) loss_x loss_x 0.9214 (1.1653) acc_x 71.8750 (69.6528) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1465
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1520
clean true:1504
clean false:16
clean_rate:0.9894736842105263
noisy true:167
noisy false:1449
after delete: len(clean_dataset) 1520
after delete: len(noisy_dataset) 1616
epoch [188/200] batch [5/47] time 0.555 (0.455) data 0.424 (0.324) loss_x loss_x 0.9204 (1.0618) acc_x 84.3750 (70.6250) lr 2.4083e-05 eta 0:00:19
epoch [188/200] batch [10/47] time 0.441 (0.457) data 0.310 (0.326) loss_x loss_x 1.1611 (1.1044) acc_x 68.7500 (70.3125) lr 2.4083e-05 eta 0:00:16
epoch [188/200] batch [15/47] time 0.482 (0.457) data 0.350 (0.326) loss_x loss_x 1.7051 (1.1575) acc_x 56.2500 (69.3750) lr 2.4083e-05 eta 0:00:14
epoch [188/200] batch [20/47] time 0.412 (0.471) data 0.281 (0.339) loss_x loss_x 0.8276 (1.1688) acc_x 81.2500 (69.2188) lr 2.4083e-05 eta 0:00:12
epoch [188/200] batch [25/47] time 0.362 (0.458) data 0.231 (0.327) loss_x loss_x 1.1162 (1.1968) acc_x 71.8750 (68.8750) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [30/47] time 0.517 (0.458) data 0.386 (0.327) loss_x loss_x 1.1406 (1.1809) acc_x 65.6250 (69.2708) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [35/47] time 0.576 (0.463) data 0.445 (0.331) loss_x loss_x 0.7759 (1.1609) acc_x 81.2500 (69.9107) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [40/47] time 0.338 (0.454) data 0.207 (0.323) loss_x loss_x 1.3818 (1.1517) acc_x 65.6250 (70.2344) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [45/47] time 0.380 (0.461) data 0.249 (0.330) loss_x loss_x 1.6670 (1.1524) acc_x 56.2500 (69.9306) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1464
confident_label rate tensor(0.4857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1523
clean true:1502
clean false:21
clean_rate:0.9862114248194354
noisy true:170
noisy false:1443
after delete: len(clean_dataset) 1523
after delete: len(noisy_dataset) 1613
epoch [189/200] batch [5/47] time 0.566 (0.446) data 0.435 (0.315) loss_x loss_x 0.9629 (1.0069) acc_x 78.1250 (73.7500) lr 2.0777e-05 eta 0:00:18
epoch [189/200] batch [10/47] time 0.394 (0.436) data 0.263 (0.305) loss_x loss_x 1.0273 (1.1397) acc_x 75.0000 (71.5625) lr 2.0777e-05 eta 0:00:16
epoch [189/200] batch [15/47] time 0.436 (0.444) data 0.305 (0.313) loss_x loss_x 0.7583 (1.1177) acc_x 81.2500 (71.8750) lr 2.0777e-05 eta 0:00:14
epoch [189/200] batch [20/47] time 0.430 (0.441) data 0.298 (0.310) loss_x loss_x 1.1270 (1.1421) acc_x 75.0000 (71.4062) lr 2.0777e-05 eta 0:00:11
epoch [189/200] batch [25/47] time 0.638 (0.456) data 0.507 (0.325) loss_x loss_x 0.9541 (1.1242) acc_x 81.2500 (71.6250) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [30/47] time 0.513 (0.454) data 0.382 (0.323) loss_x loss_x 1.5898 (1.1178) acc_x 53.1250 (71.4583) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [35/47] time 0.402 (0.450) data 0.270 (0.319) loss_x loss_x 1.3594 (1.1503) acc_x 65.6250 (70.8929) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [40/47] time 0.385 (0.445) data 0.253 (0.314) loss_x loss_x 0.9907 (1.1631) acc_x 71.8750 (70.5469) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [45/47] time 0.552 (0.451) data 0.421 (0.320) loss_x loss_x 1.4072 (1.1947) acc_x 68.7500 (70.3472) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1438
confident_label rate tensor(0.4933, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1547
clean true:1526
clean false:21
clean_rate:0.9864253393665159
noisy true:172
noisy false:1417
after delete: len(clean_dataset) 1547
after delete: len(noisy_dataset) 1589
epoch [190/200] batch [5/48] time 0.480 (0.481) data 0.348 (0.350) loss_x loss_x 1.3828 (1.3063) acc_x 68.7500 (70.0000) lr 1.7713e-05 eta 0:00:20
epoch [190/200] batch [10/48] time 0.517 (0.490) data 0.385 (0.358) loss_x loss_x 1.1104 (1.1892) acc_x 78.1250 (71.5625) lr 1.7713e-05 eta 0:00:18
epoch [190/200] batch [15/48] time 0.445 (0.490) data 0.313 (0.358) loss_x loss_x 0.9746 (1.1429) acc_x 68.7500 (71.6667) lr 1.7713e-05 eta 0:00:16
epoch [190/200] batch [20/48] time 0.416 (0.472) data 0.285 (0.341) loss_x loss_x 1.5186 (1.1576) acc_x 62.5000 (71.2500) lr 1.7713e-05 eta 0:00:13
epoch [190/200] batch [25/48] time 0.304 (0.465) data 0.173 (0.334) loss_x loss_x 1.0918 (1.1586) acc_x 68.7500 (70.2500) lr 1.7713e-05 eta 0:00:10
epoch [190/200] batch [30/48] time 0.560 (0.476) data 0.429 (0.345) loss_x loss_x 0.9839 (1.1412) acc_x 71.8750 (70.6250) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [35/48] time 0.437 (0.470) data 0.305 (0.338) loss_x loss_x 1.0654 (1.1377) acc_x 65.6250 (70.6250) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [40/48] time 0.461 (0.472) data 0.330 (0.340) loss_x loss_x 0.7910 (1.1418) acc_x 84.3750 (70.3906) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [45/48] time 0.431 (0.472) data 0.300 (0.341) loss_x loss_x 0.8823 (1.1452) acc_x 75.0000 (70.1389) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1429
confident_label rate tensor(0.4955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1554
clean true:1535
clean false:19
clean_rate:0.9877734877734877
noisy true:172
noisy false:1410
after delete: len(clean_dataset) 1554
after delete: len(noisy_dataset) 1582
epoch [191/200] batch [5/48] time 0.426 (0.456) data 0.295 (0.325) loss_x loss_x 0.8540 (0.8388) acc_x 71.8750 (76.8750) lr 1.4891e-05 eta 0:00:19
epoch [191/200] batch [10/48] time 0.404 (0.451) data 0.273 (0.321) loss_x loss_x 1.5977 (1.1220) acc_x 68.7500 (70.3125) lr 1.4891e-05 eta 0:00:17
epoch [191/200] batch [15/48] time 0.398 (0.446) data 0.267 (0.316) loss_x loss_x 1.1602 (1.1073) acc_x 68.7500 (70.2083) lr 1.4891e-05 eta 0:00:14
epoch [191/200] batch [20/48] time 0.351 (0.459) data 0.221 (0.328) loss_x loss_x 1.1934 (1.1172) acc_x 71.8750 (70.9375) lr 1.4891e-05 eta 0:00:12
epoch [191/200] batch [25/48] time 0.553 (0.467) data 0.423 (0.336) loss_x loss_x 1.3740 (1.1451) acc_x 65.6250 (70.3750) lr 1.4891e-05 eta 0:00:10
epoch [191/200] batch [30/48] time 0.486 (0.461) data 0.353 (0.330) loss_x loss_x 0.9966 (1.1351) acc_x 68.7500 (70.5208) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [35/48] time 0.491 (0.472) data 0.359 (0.342) loss_x loss_x 1.3652 (1.1424) acc_x 59.3750 (70.0000) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [40/48] time 0.479 (0.474) data 0.348 (0.344) loss_x loss_x 1.0010 (1.1716) acc_x 75.0000 (69.2188) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [45/48] time 0.455 (0.471) data 0.324 (0.340) loss_x loss_x 1.0693 (1.1627) acc_x 75.0000 (69.7917) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1458
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1513
clean true:1498
clean false:15
clean_rate:0.9900859220092532
noisy true:180
noisy false:1443
after delete: len(clean_dataset) 1513
after delete: len(noisy_dataset) 1623
epoch [192/200] batch [5/47] time 0.431 (0.445) data 0.300 (0.315) loss_x loss_x 1.3818 (1.1896) acc_x 68.7500 (68.7500) lr 1.2312e-05 eta 0:00:18
epoch [192/200] batch [10/47] time 0.515 (0.426) data 0.384 (0.296) loss_x loss_x 1.0391 (1.1263) acc_x 81.2500 (70.9375) lr 1.2312e-05 eta 0:00:15
epoch [192/200] batch [15/47] time 0.530 (0.426) data 0.399 (0.295) loss_x loss_x 0.9795 (1.1273) acc_x 75.0000 (71.0417) lr 1.2312e-05 eta 0:00:13
epoch [192/200] batch [20/47] time 0.555 (0.438) data 0.424 (0.307) loss_x loss_x 1.1035 (1.1028) acc_x 71.8750 (71.8750) lr 1.2312e-05 eta 0:00:11
epoch [192/200] batch [25/47] time 0.376 (0.442) data 0.245 (0.311) loss_x loss_x 1.4629 (1.1777) acc_x 59.3750 (70.5000) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [30/47] time 0.450 (0.437) data 0.319 (0.306) loss_x loss_x 1.0078 (1.1942) acc_x 71.8750 (70.1042) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [35/47] time 0.450 (0.437) data 0.319 (0.306) loss_x loss_x 0.8906 (1.2264) acc_x 75.0000 (69.3750) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [40/47] time 0.471 (0.441) data 0.339 (0.310) loss_x loss_x 1.5195 (1.2345) acc_x 65.6250 (69.6094) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [45/47] time 0.621 (0.446) data 0.490 (0.315) loss_x loss_x 1.4395 (1.2330) acc_x 62.5000 (69.5139) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1424
confident_label rate tensor(0.4933, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1547
clean true:1529
clean false:18
clean_rate:0.9883645765998708
noisy true:183
noisy false:1406
after delete: len(clean_dataset) 1547
after delete: len(noisy_dataset) 1589
epoch [193/200] batch [5/48] time 0.553 (0.438) data 0.423 (0.307) loss_x loss_x 1.0645 (1.3241) acc_x 65.6250 (66.8750) lr 9.9763e-06 eta 0:00:18
epoch [193/200] batch [10/48] time 0.465 (0.445) data 0.335 (0.314) loss_x loss_x 0.6875 (1.2100) acc_x 78.1250 (69.0625) lr 9.9763e-06 eta 0:00:16
epoch [193/200] batch [15/48] time 0.403 (0.435) data 0.273 (0.304) loss_x loss_x 1.4902 (1.1771) acc_x 65.6250 (69.5833) lr 9.9763e-06 eta 0:00:14
epoch [193/200] batch [20/48] time 0.386 (0.430) data 0.255 (0.300) loss_x loss_x 1.0596 (1.1860) acc_x 84.3750 (69.8438) lr 9.9763e-06 eta 0:00:12
epoch [193/200] batch [25/48] time 0.579 (0.435) data 0.448 (0.305) loss_x loss_x 1.4238 (1.2206) acc_x 56.2500 (68.7500) lr 9.9763e-06 eta 0:00:10
epoch [193/200] batch [30/48] time 0.390 (0.432) data 0.259 (0.301) loss_x loss_x 1.4014 (1.2315) acc_x 62.5000 (69.0625) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [35/48] time 0.393 (0.436) data 0.263 (0.306) loss_x loss_x 1.0801 (1.2241) acc_x 71.8750 (69.1964) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [40/48] time 0.433 (0.437) data 0.303 (0.306) loss_x loss_x 1.6543 (1.2370) acc_x 59.3750 (68.8281) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [45/48] time 0.426 (0.438) data 0.296 (0.307) loss_x loss_x 1.5029 (1.2275) acc_x 59.3750 (69.0972) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1471
confident_label rate tensor(0.4857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1523
clean true:1506
clean false:17
clean_rate:0.9888378200919238
noisy true:159
noisy false:1454
after delete: len(clean_dataset) 1523
after delete: len(noisy_dataset) 1613
epoch [194/200] batch [5/47] time 0.413 (0.436) data 0.282 (0.305) loss_x loss_x 1.0723 (1.0646) acc_x 71.8750 (73.1250) lr 7.8853e-06 eta 0:00:18
epoch [194/200] batch [10/47] time 0.489 (0.462) data 0.359 (0.331) loss_x loss_x 0.9834 (1.0687) acc_x 65.6250 (72.1875) lr 7.8853e-06 eta 0:00:17
epoch [194/200] batch [15/47] time 0.478 (0.459) data 0.348 (0.328) loss_x loss_x 1.0010 (1.0672) acc_x 71.8750 (72.9167) lr 7.8853e-06 eta 0:00:14
epoch [194/200] batch [20/47] time 0.486 (0.457) data 0.355 (0.326) loss_x loss_x 0.7725 (1.0959) acc_x 78.1250 (72.9688) lr 7.8853e-06 eta 0:00:12
epoch [194/200] batch [25/47] time 0.319 (0.447) data 0.188 (0.316) loss_x loss_x 1.1621 (1.1427) acc_x 62.5000 (72.2500) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [30/47] time 0.340 (0.443) data 0.209 (0.313) loss_x loss_x 1.4014 (1.1372) acc_x 65.6250 (71.9792) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [35/47] time 0.406 (0.444) data 0.276 (0.313) loss_x loss_x 1.4238 (1.1380) acc_x 65.6250 (72.3214) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [40/47] time 0.353 (0.440) data 0.222 (0.310) loss_x loss_x 1.0732 (1.1513) acc_x 68.7500 (72.1094) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [45/47] time 0.524 (0.443) data 0.393 (0.312) loss_x loss_x 0.7778 (1.1227) acc_x 81.2500 (72.5694) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1474
confident_label rate tensor(0.4828, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1514
clean true:1494
clean false:20
clean_rate:0.9867899603698811
noisy true:168
noisy false:1454
after delete: len(clean_dataset) 1514
after delete: len(noisy_dataset) 1622
epoch [195/200] batch [5/47] time 0.428 (0.402) data 0.297 (0.272) loss_x loss_x 0.7793 (1.1798) acc_x 81.2500 (73.7500) lr 6.0390e-06 eta 0:00:16
epoch [195/200] batch [10/47] time 0.610 (0.424) data 0.479 (0.293) loss_x loss_x 1.6162 (1.1700) acc_x 62.5000 (71.8750) lr 6.0390e-06 eta 0:00:15
epoch [195/200] batch [15/47] time 0.378 (0.419) data 0.248 (0.289) loss_x loss_x 0.8359 (1.1653) acc_x 71.8750 (70.4167) lr 6.0390e-06 eta 0:00:13
epoch [195/200] batch [20/47] time 0.407 (0.424) data 0.276 (0.294) loss_x loss_x 1.5273 (1.1970) acc_x 53.1250 (69.6875) lr 6.0390e-06 eta 0:00:11
epoch [195/200] batch [25/47] time 0.480 (0.432) data 0.349 (0.301) loss_x loss_x 1.3457 (1.2124) acc_x 71.8750 (69.5000) lr 6.0390e-06 eta 0:00:09
epoch [195/200] batch [30/47] time 0.374 (0.438) data 0.243 (0.308) loss_x loss_x 1.1592 (1.2105) acc_x 71.8750 (70.0000) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [35/47] time 0.376 (0.435) data 0.245 (0.304) loss_x loss_x 1.5039 (1.1963) acc_x 56.2500 (70.1786) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [40/47] time 0.568 (0.441) data 0.438 (0.310) loss_x loss_x 1.3037 (1.2172) acc_x 75.0000 (69.6875) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [45/47] time 0.316 (0.439) data 0.185 (0.308) loss_x loss_x 0.9297 (1.1889) acc_x 81.2500 (70.4167) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1479
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1517
clean true:1500
clean false:17
clean_rate:0.988793671720501
noisy true:157
noisy false:1462
after delete: len(clean_dataset) 1517
after delete: len(noisy_dataset) 1619
epoch [196/200] batch [5/47] time 0.453 (0.458) data 0.322 (0.327) loss_x loss_x 1.9502 (1.1048) acc_x 56.2500 (73.1250) lr 4.4380e-06 eta 0:00:19
epoch [196/200] batch [10/47] time 0.495 (0.466) data 0.364 (0.335) loss_x loss_x 0.7808 (1.0643) acc_x 81.2500 (75.6250) lr 4.4380e-06 eta 0:00:17
epoch [196/200] batch [15/47] time 0.499 (0.451) data 0.368 (0.321) loss_x loss_x 0.8774 (1.0619) acc_x 78.1250 (74.1667) lr 4.4380e-06 eta 0:00:14
epoch [196/200] batch [20/47] time 0.487 (0.439) data 0.357 (0.309) loss_x loss_x 0.6445 (1.0830) acc_x 87.5000 (73.7500) lr 4.4380e-06 eta 0:00:11
epoch [196/200] batch [25/47] time 0.631 (0.445) data 0.500 (0.314) loss_x loss_x 1.2676 (1.0682) acc_x 65.6250 (73.2500) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [30/47] time 0.416 (0.445) data 0.285 (0.314) loss_x loss_x 1.2383 (1.0953) acc_x 71.8750 (72.5000) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [35/47] time 0.341 (0.441) data 0.210 (0.311) loss_x loss_x 1.3760 (1.1221) acc_x 71.8750 (71.9643) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [40/47] time 0.378 (0.435) data 0.248 (0.304) loss_x loss_x 0.7910 (1.1021) acc_x 71.8750 (72.2656) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [45/47] time 0.483 (0.436) data 0.353 (0.305) loss_x loss_x 1.0635 (1.0854) acc_x 68.7500 (72.7778) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1424
confident_label rate tensor(0.4933, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1547
clean true:1533
clean false:14
clean_rate:0.9909502262443439
noisy true:179
noisy false:1410
after delete: len(clean_dataset) 1547
after delete: len(noisy_dataset) 1589
epoch [197/200] batch [5/48] time 0.431 (0.482) data 0.301 (0.351) loss_x loss_x 1.4912 (1.1292) acc_x 59.3750 (68.7500) lr 3.0827e-06 eta 0:00:20
epoch [197/200] batch [10/48] time 0.434 (0.465) data 0.304 (0.334) loss_x loss_x 1.4561 (1.1547) acc_x 68.7500 (70.0000) lr 3.0827e-06 eta 0:00:17
epoch [197/200] batch [15/48] time 0.346 (0.471) data 0.215 (0.340) loss_x loss_x 0.8228 (1.1739) acc_x 81.2500 (71.0417) lr 3.0827e-06 eta 0:00:15
epoch [197/200] batch [20/48] time 0.432 (0.449) data 0.302 (0.318) loss_x loss_x 1.1826 (1.2252) acc_x 71.8750 (69.6875) lr 3.0827e-06 eta 0:00:12
epoch [197/200] batch [25/48] time 0.376 (0.437) data 0.246 (0.307) loss_x loss_x 1.1094 (1.2158) acc_x 75.0000 (69.1250) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [30/48] time 0.365 (0.439) data 0.234 (0.309) loss_x loss_x 1.1396 (1.2039) acc_x 68.7500 (68.7500) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [35/48] time 0.460 (0.438) data 0.329 (0.307) loss_x loss_x 1.1455 (1.1969) acc_x 68.7500 (68.9286) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [40/48] time 0.418 (0.431) data 0.287 (0.301) loss_x loss_x 1.1650 (1.1837) acc_x 62.5000 (69.2188) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [45/48] time 0.431 (0.432) data 0.300 (0.301) loss_x loss_x 1.0996 (1.2026) acc_x 75.0000 (68.8194) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1487
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1502
clean true:1487
clean false:15
clean_rate:0.9900133155792277
noisy true:162
noisy false:1472
after delete: len(clean_dataset) 1502
after delete: len(noisy_dataset) 1634
epoch [198/200] batch [5/46] time 0.398 (0.434) data 0.267 (0.303) loss_x loss_x 1.1074 (1.2771) acc_x 62.5000 (65.6250) lr 1.9733e-06 eta 0:00:17
epoch [198/200] batch [10/46] time 0.566 (0.448) data 0.435 (0.317) loss_x loss_x 1.1064 (1.2232) acc_x 71.8750 (68.1250) lr 1.9733e-06 eta 0:00:16
epoch [198/200] batch [15/46] time 0.431 (0.447) data 0.300 (0.316) loss_x loss_x 0.9321 (1.1491) acc_x 84.3750 (70.6250) lr 1.9733e-06 eta 0:00:13
epoch [198/200] batch [20/46] time 0.444 (0.445) data 0.313 (0.314) loss_x loss_x 1.2656 (1.1592) acc_x 68.7500 (69.8438) lr 1.9733e-06 eta 0:00:11
epoch [198/200] batch [25/46] time 0.425 (0.445) data 0.294 (0.314) loss_x loss_x 1.4414 (1.1788) acc_x 62.5000 (69.7500) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [30/46] time 0.532 (0.449) data 0.401 (0.318) loss_x loss_x 1.2344 (1.1583) acc_x 68.7500 (70.4167) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [35/46] time 0.518 (0.445) data 0.387 (0.314) loss_x loss_x 1.4072 (1.1547) acc_x 68.7500 (70.2679) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [40/46] time 0.386 (0.456) data 0.255 (0.325) loss_x loss_x 0.8716 (1.1526) acc_x 78.1250 (70.3125) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [45/46] time 0.315 (0.451) data 0.184 (0.320) loss_x loss_x 0.9370 (1.1377) acc_x 75.0000 (70.5556) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1444
confident_label rate tensor(0.4879, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1530
clean true:1510
clean false:20
clean_rate:0.9869281045751634
noisy true:182
noisy false:1424
after delete: len(clean_dataset) 1530
after delete: len(noisy_dataset) 1606
epoch [199/200] batch [5/47] time 0.440 (0.435) data 0.309 (0.304) loss_x loss_x 1.2363 (1.1745) acc_x 71.8750 (71.8750) lr 1.1101e-06 eta 0:00:18
epoch [199/200] batch [10/47] time 0.375 (0.435) data 0.243 (0.304) loss_x loss_x 0.7456 (1.0925) acc_x 75.0000 (73.1250) lr 1.1101e-06 eta 0:00:16
epoch [199/200] batch [15/47] time 0.464 (0.463) data 0.332 (0.331) loss_x loss_x 1.5254 (1.1622) acc_x 62.5000 (71.0417) lr 1.1101e-06 eta 0:00:14
epoch [199/200] batch [20/47] time 0.438 (0.463) data 0.307 (0.331) loss_x loss_x 1.4307 (1.1838) acc_x 50.0000 (69.5312) lr 1.1101e-06 eta 0:00:12
epoch [199/200] batch [25/47] time 0.389 (0.455) data 0.258 (0.324) loss_x loss_x 1.7754 (1.2721) acc_x 59.3750 (67.2500) lr 1.1101e-06 eta 0:00:10
epoch [199/200] batch [30/47] time 0.371 (0.452) data 0.240 (0.320) loss_x loss_x 1.5635 (1.2775) acc_x 59.3750 (67.6042) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [35/47] time 0.311 (0.446) data 0.180 (0.315) loss_x loss_x 1.1973 (1.2716) acc_x 71.8750 (67.4107) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [40/47] time 0.407 (0.443) data 0.277 (0.311) loss_x loss_x 1.1201 (1.2502) acc_x 75.0000 (68.5938) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [45/47] time 0.455 (0.449) data 0.324 (0.318) loss_x loss_x 0.7876 (1.2335) acc_x 78.1250 (68.6806) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1423
confident_label rate tensor(0.4955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1554
clean true:1542
clean false:12
clean_rate:0.9922779922779923
noisy true:171
noisy false:1411
after delete: len(clean_dataset) 1554
after delete: len(noisy_dataset) 1582
epoch [200/200] batch [5/48] time 0.432 (0.446) data 0.301 (0.315) loss_x loss_x 1.6504 (1.4286) acc_x 59.3750 (64.3750) lr 4.9344e-07 eta 0:00:19
epoch [200/200] batch [10/48] time 0.407 (0.462) data 0.276 (0.331) loss_x loss_x 1.3105 (1.2754) acc_x 71.8750 (68.7500) lr 4.9344e-07 eta 0:00:17
epoch [200/200] batch [15/48] time 0.400 (0.456) data 0.270 (0.325) loss_x loss_x 1.1377 (1.2690) acc_x 62.5000 (67.5000) lr 4.9344e-07 eta 0:00:15
epoch [200/200] batch [20/48] time 0.369 (0.457) data 0.238 (0.326) loss_x loss_x 1.0469 (1.2314) acc_x 78.1250 (68.4375) lr 4.9344e-07 eta 0:00:12
epoch [200/200] batch [25/48] time 0.443 (0.446) data 0.312 (0.315) loss_x loss_x 1.3701 (1.2224) acc_x 71.8750 (69.5000) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [30/48] time 0.513 (0.442) data 0.382 (0.311) loss_x loss_x 0.8433 (1.2190) acc_x 81.2500 (70.2083) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [35/48] time 0.474 (0.439) data 0.343 (0.308) loss_x loss_x 1.0430 (1.2006) acc_x 68.7500 (70.0893) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [40/48] time 0.405 (0.432) data 0.274 (0.301) loss_x loss_x 1.3965 (1.2184) acc_x 59.3750 (69.7656) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [45/48] time 0.386 (0.433) data 0.255 (0.302) loss_x loss_x 1.0215 (1.2198) acc_x 75.0000 (69.9306) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,372
* accuracy: 66.8%
* error: 33.2%
* macro_f1: 65.3%
Elapsed: 3:37:25
