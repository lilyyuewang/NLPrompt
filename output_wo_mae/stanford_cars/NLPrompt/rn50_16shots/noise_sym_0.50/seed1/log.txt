***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.0973, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 305
clean true:297
clean false:8
clean_rate:0.9737704918032787
noisy true:268
noisy false:2563
after delete: len(clean_dataset) 305
after delete: len(noisy_dataset) 2831
epoch [1/200] batch [5/9] time 0.373 (0.522) data 0.243 (0.364) loss_x loss_x 2.9414 (2.9316) acc_x 53.1250 (41.8750) lr 1.0000e-05 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2421
confident_label rate tensor(0.1199, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 376
clean true:366
clean false:10
clean_rate:0.973404255319149
noisy true:349
noisy false:2411
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 2760
epoch [2/200] batch [5/11] time 0.426 (0.492) data 0.295 (0.361) loss_x loss_x 1.9326 (2.1328) acc_x 40.6250 (47.5000) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/11] time 0.432 (0.497) data 0.301 (0.366) loss_x loss_x 2.0449 (2.0912) acc_x 43.7500 (46.2500) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2025
confident_label rate tensor(0.1891, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 593
clean true:587
clean false:6
clean_rate:0.9898819561551433
noisy true:524
noisy false:2019
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 2543
epoch [3/200] batch [5/18] time 0.402 (0.422) data 0.271 (0.291) loss_x loss_x 1.8877 (1.7672) acc_x 59.3750 (51.2500) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/18] time 0.414 (0.437) data 0.283 (0.307) loss_x loss_x 1.6230 (1.7620) acc_x 62.5000 (53.1250) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/18] time 0.425 (0.444) data 0.295 (0.313) loss_x loss_x 1.7256 (1.7665) acc_x 46.8750 (53.3333) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1890
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:635
clean false:3
clean_rate:0.9952978056426333
noisy true:611
noisy false:1887
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [4/200] batch [5/19] time 0.416 (0.452) data 0.287 (0.322) loss_x loss_x 1.6592 (1.5734) acc_x 62.5000 (60.6250) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/19] time 0.494 (0.478) data 0.362 (0.348) loss_x loss_x 1.1201 (1.6464) acc_x 75.0000 (58.7500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [15/19] time 0.474 (0.470) data 0.343 (0.340) loss_x loss_x 1.9961 (1.6413) acc_x 50.0000 (57.5000) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1918
confident_label rate tensor(0.2101, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 659
clean true:650
clean false:9
clean_rate:0.9863429438543247
noisy true:568
noisy false:1909
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 2477
epoch [5/200] batch [5/20] time 0.423 (0.477) data 0.292 (0.346) loss_x loss_x 1.7480 (1.7068) acc_x 62.5000 (60.6250) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [10/20] time 0.411 (0.469) data 0.281 (0.339) loss_x loss_x 1.5879 (1.5915) acc_x 59.3750 (61.5625) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/20] time 0.382 (0.465) data 0.252 (0.335) loss_x loss_x 1.6289 (1.5265) acc_x 62.5000 (63.3333) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/20] time 0.453 (0.457) data 0.323 (0.326) loss_x loss_x 1.6367 (1.5506) acc_x 59.3750 (61.4062) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1906
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:648
clean false:7
clean_rate:0.9893129770992366
noisy true:582
noisy false:1899
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [6/200] batch [5/20] time 0.409 (0.431) data 0.278 (0.300) loss_x loss_x 1.6094 (1.7895) acc_x 59.3750 (55.0000) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/20] time 0.468 (0.438) data 0.337 (0.307) loss_x loss_x 1.7852 (1.6834) acc_x 56.2500 (56.8750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/20] time 0.417 (0.448) data 0.286 (0.317) loss_x loss_x 1.2168 (1.6651) acc_x 68.7500 (55.8333) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/20] time 0.487 (0.449) data 0.356 (0.318) loss_x loss_x 1.8809 (1.6777) acc_x 50.0000 (55.0000) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1844
confident_label rate tensor(0.2172, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 681
clean true:672
clean false:9
clean_rate:0.986784140969163
noisy true:620
noisy false:1835
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 2455
epoch [7/200] batch [5/21] time 0.444 (0.466) data 0.314 (0.335) loss_x loss_x 1.5498 (1.3867) acc_x 59.3750 (61.8750) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [10/21] time 0.452 (0.466) data 0.321 (0.336) loss_x loss_x 1.3770 (1.4806) acc_x 65.6250 (61.5625) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/21] time 0.426 (0.457) data 0.296 (0.326) loss_x loss_x 2.1211 (1.6025) acc_x 46.8750 (59.5833) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/21] time 0.622 (0.449) data 0.492 (0.319) loss_x loss_x 1.4746 (1.6116) acc_x 71.8750 (59.0625) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1846
confident_label rate tensor(0.2111, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 662
clean true:656
clean false:6
clean_rate:0.9909365558912386
noisy true:634
noisy false:1840
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 2474
epoch [8/200] batch [5/20] time 0.365 (0.435) data 0.234 (0.305) loss_x loss_x 1.8604 (1.4893) acc_x 46.8750 (59.3750) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [10/20] time 0.393 (0.430) data 0.263 (0.299) loss_x loss_x 1.4375 (1.5052) acc_x 62.5000 (60.0000) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [15/20] time 0.363 (0.424) data 0.233 (0.293) loss_x loss_x 1.7764 (1.6305) acc_x 59.3750 (57.9167) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/20] time 0.569 (0.439) data 0.438 (0.308) loss_x loss_x 1.6650 (1.6074) acc_x 53.1250 (57.9688) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1860
confident_label rate tensor(0.2172, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 681
clean true:673
clean false:8
clean_rate:0.9882525697503671
noisy true:603
noisy false:1852
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 2455
epoch [9/200] batch [5/21] time 0.445 (0.470) data 0.315 (0.339) loss_x loss_x 2.2637 (1.5430) acc_x 37.5000 (60.0000) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [10/21] time 0.497 (0.475) data 0.366 (0.344) loss_x loss_x 1.5381 (1.5466) acc_x 65.6250 (58.4375) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/21] time 0.446 (0.473) data 0.315 (0.342) loss_x loss_x 2.1621 (1.5972) acc_x 37.5000 (58.1250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/21] time 0.548 (0.477) data 0.418 (0.346) loss_x loss_x 1.3174 (1.5474) acc_x 56.2500 (59.0625) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1860
confident_label rate tensor(0.2085, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 654
clean true:648
clean false:6
clean_rate:0.9908256880733946
noisy true:628
noisy false:1854
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 2482
epoch [10/200] batch [5/20] time 0.614 (0.506) data 0.484 (0.375) loss_x loss_x 1.3926 (1.3727) acc_x 59.3750 (62.5000) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [10/20] time 0.399 (0.477) data 0.269 (0.346) loss_x loss_x 1.4668 (1.4529) acc_x 56.2500 (62.5000) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/20] time 0.455 (0.465) data 0.324 (0.335) loss_x loss_x 1.5420 (1.4676) acc_x 68.7500 (62.2917) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/20] time 0.496 (0.457) data 0.365 (0.326) loss_x loss_x 1.4160 (1.4562) acc_x 56.2500 (62.0312) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 714
clean true:708
clean false:6
clean_rate:0.9915966386554622
noisy true:615
noisy false:1807
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 2422
epoch [11/200] batch [5/22] time 0.461 (0.474) data 0.329 (0.342) loss_x loss_x 1.4229 (1.5910) acc_x 62.5000 (58.7500) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [10/22] time 0.415 (0.475) data 0.284 (0.344) loss_x loss_x 1.8906 (1.6283) acc_x 56.2500 (58.7500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/22] time 0.534 (0.472) data 0.403 (0.341) loss_x loss_x 1.4785 (1.5700) acc_x 56.2500 (60.8333) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/22] time 0.555 (0.476) data 0.423 (0.345) loss_x loss_x 1.3496 (1.5629) acc_x 65.6250 (60.1562) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1821
confident_label rate tensor(0.2216, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 695
clean true:690
clean false:5
clean_rate:0.9928057553956835
noisy true:625
noisy false:1816
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 2441
epoch [12/200] batch [5/21] time 0.470 (0.479) data 0.339 (0.348) loss_x loss_x 1.5459 (1.5893) acc_x 56.2500 (57.5000) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [10/21] time 0.485 (0.475) data 0.354 (0.344) loss_x loss_x 1.7451 (1.5720) acc_x 46.8750 (56.5625) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/21] time 0.565 (0.473) data 0.434 (0.342) loss_x loss_x 1.8174 (1.5527) acc_x 59.3750 (57.9167) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/21] time 0.598 (0.468) data 0.467 (0.337) loss_x loss_x 1.5098 (1.6113) acc_x 68.7500 (57.5000) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1897
confident_label rate tensor(0.2070, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 649
clean true:643
clean false:6
clean_rate:0.9907550077041603
noisy true:596
noisy false:1891
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 2487
epoch [13/200] batch [5/20] time 0.395 (0.450) data 0.264 (0.319) loss_x loss_x 1.5674 (1.5238) acc_x 59.3750 (61.8750) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/20] time 0.529 (0.478) data 0.398 (0.347) loss_x loss_x 1.6963 (1.5248) acc_x 50.0000 (60.6250) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [15/20] time 0.449 (0.462) data 0.318 (0.331) loss_x loss_x 1.5234 (1.4396) acc_x 46.8750 (62.0833) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/20] time 0.415 (0.465) data 0.284 (0.334) loss_x loss_x 1.6289 (1.4661) acc_x 62.5000 (61.5625) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1847
confident_label rate tensor(0.2165, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 679
clean true:672
clean false:7
clean_rate:0.9896907216494846
noisy true:617
noisy false:1840
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 2457
epoch [14/200] batch [5/21] time 0.437 (0.424) data 0.306 (0.294) loss_x loss_x 1.2100 (1.4172) acc_x 65.6250 (66.8750) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/21] time 0.529 (0.454) data 0.398 (0.323) loss_x loss_x 1.5420 (1.4266) acc_x 56.2500 (64.0625) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/21] time 0.509 (0.462) data 0.379 (0.332) loss_x loss_x 1.4658 (1.4231) acc_x 59.3750 (63.1250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/21] time 0.660 (0.485) data 0.530 (0.354) loss_x loss_x 2.0410 (1.4711) acc_x 46.8750 (62.1875) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1836
confident_label rate tensor(0.2149, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 674
clean true:671
clean false:3
clean_rate:0.9955489614243324
noisy true:629
noisy false:1833
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 2462
epoch [15/200] batch [5/21] time 0.381 (0.477) data 0.251 (0.347) loss_x loss_x 1.4902 (1.5373) acc_x 65.6250 (61.2500) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [10/21] time 0.406 (0.481) data 0.276 (0.351) loss_x loss_x 1.4629 (1.5674) acc_x 46.8750 (58.7500) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/21] time 0.493 (0.477) data 0.364 (0.347) loss_x loss_x 1.6006 (1.5026) acc_x 50.0000 (60.6250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/21] time 0.362 (0.461) data 0.232 (0.331) loss_x loss_x 1.3965 (1.4939) acc_x 62.5000 (62.3438) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.2140, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 671
clean true:661
clean false:10
clean_rate:0.9850968703427719
noisy true:657
noisy false:1808
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 2465
epoch [16/200] batch [5/20] time 0.494 (0.436) data 0.363 (0.304) loss_x loss_x 1.2109 (1.3430) acc_x 53.1250 (58.1250) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [10/20] time 0.461 (0.462) data 0.330 (0.331) loss_x loss_x 1.8857 (1.4799) acc_x 50.0000 (58.7500) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/20] time 0.469 (0.454) data 0.338 (0.323) loss_x loss_x 1.5879 (1.4471) acc_x 56.2500 (60.6250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/20] time 0.445 (0.459) data 0.314 (0.328) loss_x loss_x 1.3291 (1.4779) acc_x 65.6250 (60.4688) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1792
confident_label rate tensor(0.2210, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 693
clean true:683
clean false:10
clean_rate:0.9855699855699855
noisy true:661
noisy false:1782
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 2443
epoch [17/200] batch [5/21] time 0.578 (0.458) data 0.447 (0.327) loss_x loss_x 1.3789 (1.4256) acc_x 75.0000 (63.1250) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [10/21] time 0.481 (0.468) data 0.349 (0.337) loss_x loss_x 1.7842 (1.5925) acc_x 56.2500 (60.0000) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [15/21] time 0.482 (0.492) data 0.351 (0.361) loss_x loss_x 1.4199 (1.5838) acc_x 65.6250 (59.5833) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/21] time 0.428 (0.485) data 0.297 (0.353) loss_x loss_x 1.1201 (1.5349) acc_x 71.8750 (60.4688) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1788
confident_label rate tensor(0.2242, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 703
clean true:696
clean false:7
clean_rate:0.9900426742532006
noisy true:652
noisy false:1781
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 2433
epoch [18/200] batch [5/21] time 0.522 (0.500) data 0.391 (0.369) loss_x loss_x 1.5088 (1.5449) acc_x 62.5000 (60.6250) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [10/21] time 0.328 (0.471) data 0.197 (0.340) loss_x loss_x 1.4980 (1.4550) acc_x 62.5000 (64.0625) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/21] time 0.535 (0.483) data 0.404 (0.353) loss_x loss_x 1.3174 (1.4710) acc_x 56.2500 (61.8750) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/21] time 0.509 (0.478) data 0.378 (0.347) loss_x loss_x 1.7471 (1.4812) acc_x 56.2500 (62.0312) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 684
clean true:678
clean false:6
clean_rate:0.9912280701754386
noisy true:640
noisy false:1812
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 2452
epoch [19/200] batch [5/21] time 0.490 (0.468) data 0.359 (0.337) loss_x loss_x 1.6270 (1.7090) acc_x 53.1250 (58.1250) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [10/21] time 0.408 (0.467) data 0.277 (0.336) loss_x loss_x 1.3906 (1.7052) acc_x 68.7500 (54.3750) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/21] time 0.410 (0.476) data 0.279 (0.345) loss_x loss_x 1.8936 (1.6278) acc_x 59.3750 (56.6667) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/21] time 0.383 (0.456) data 0.252 (0.326) loss_x loss_x 1.1924 (1.5904) acc_x 65.6250 (57.9688) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.2146, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 673
clean true:665
clean false:8
clean_rate:0.9881129271916791
noisy true:656
noisy false:1807
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 2463
epoch [20/200] batch [5/21] time 0.376 (0.424) data 0.246 (0.293) loss_x loss_x 1.3203 (1.7787) acc_x 56.2500 (53.1250) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/21] time 0.397 (0.427) data 0.267 (0.296) loss_x loss_x 1.3018 (1.5690) acc_x 68.7500 (59.0625) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/21] time 0.310 (0.429) data 0.179 (0.298) loss_x loss_x 1.6855 (1.5901) acc_x 68.7500 (59.1667) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/21] time 0.462 (0.462) data 0.331 (0.331) loss_x loss_x 1.1973 (1.5525) acc_x 71.8750 (60.3125) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1835
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 696
clean true:686
clean false:10
clean_rate:0.985632183908046
noisy true:615
noisy false:1825
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 2440
epoch [21/200] batch [5/21] time 0.514 (0.529) data 0.383 (0.398) loss_x loss_x 1.1348 (1.5074) acc_x 68.7500 (58.1250) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [10/21] time 0.395 (0.519) data 0.264 (0.388) loss_x loss_x 0.9819 (1.4547) acc_x 68.7500 (61.2500) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/21] time 0.460 (0.503) data 0.329 (0.372) loss_x loss_x 1.2188 (1.4170) acc_x 59.3750 (62.7083) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/21] time 0.659 (0.495) data 0.527 (0.364) loss_x loss_x 1.3965 (1.4490) acc_x 65.6250 (61.8750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1800
confident_label rate tensor(0.2299, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 721
clean true:714
clean false:7
clean_rate:0.9902912621359223
noisy true:622
noisy false:1793
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 2415
epoch [22/200] batch [5/22] time 0.438 (0.475) data 0.308 (0.345) loss_x loss_x 1.3867 (1.5600) acc_x 59.3750 (63.7500) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [10/22] time 0.564 (0.459) data 0.435 (0.329) loss_x loss_x 1.2529 (1.5336) acc_x 65.6250 (59.6875) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/22] time 0.378 (0.449) data 0.248 (0.319) loss_x loss_x 1.0420 (1.5186) acc_x 65.6250 (60.2083) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/22] time 0.535 (0.467) data 0.405 (0.337) loss_x loss_x 1.8994 (1.4983) acc_x 56.2500 (61.5625) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1821
confident_label rate tensor(0.2239, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 702
clean true:695
clean false:7
clean_rate:0.99002849002849
noisy true:620
noisy false:1814
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 2434
epoch [23/200] batch [5/21] time 0.523 (0.475) data 0.392 (0.344) loss_x loss_x 0.9268 (1.2979) acc_x 68.7500 (60.6250) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [10/21] time 0.472 (0.468) data 0.342 (0.338) loss_x loss_x 0.8994 (1.3243) acc_x 68.7500 (60.9375) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/21] time 0.432 (0.460) data 0.301 (0.329) loss_x loss_x 1.8203 (1.3871) acc_x 53.1250 (61.2500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/21] time 0.491 (0.456) data 0.360 (0.325) loss_x loss_x 1.2949 (1.3859) acc_x 65.6250 (61.5625) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2357, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 739
clean true:735
clean false:4
clean_rate:0.9945872801082544
noisy true:649
noisy false:1748
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 2397
epoch [24/200] batch [5/23] time 0.472 (0.484) data 0.342 (0.353) loss_x loss_x 1.4395 (1.3400) acc_x 56.2500 (62.5000) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [10/23] time 0.506 (0.496) data 0.375 (0.365) loss_x loss_x 1.1895 (1.3670) acc_x 84.3750 (65.0000) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [15/23] time 0.482 (0.509) data 0.351 (0.379) loss_x loss_x 1.5742 (1.3858) acc_x 53.1250 (64.1667) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/23] time 0.429 (0.507) data 0.299 (0.376) loss_x loss_x 1.1406 (1.4019) acc_x 65.6250 (63.7500) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1780
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 714
clean true:707
clean false:7
clean_rate:0.9901960784313726
noisy true:649
noisy false:1773
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 2422
epoch [25/200] batch [5/22] time 0.650 (0.525) data 0.519 (0.394) loss_x loss_x 1.5732 (1.6183) acc_x 59.3750 (61.8750) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [10/22] time 0.437 (0.479) data 0.307 (0.349) loss_x loss_x 1.1973 (1.4630) acc_x 62.5000 (61.2500) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/22] time 0.363 (0.462) data 0.232 (0.331) loss_x loss_x 1.5625 (1.4993) acc_x 59.3750 (59.5833) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/22] time 0.660 (0.477) data 0.529 (0.346) loss_x loss_x 1.7910 (1.4773) acc_x 50.0000 (59.5312) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1829
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 696
clean true:689
clean false:7
clean_rate:0.9899425287356322
noisy true:618
noisy false:1822
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 2440
epoch [26/200] batch [5/21] time 0.417 (0.455) data 0.286 (0.324) loss_x loss_x 1.3408 (1.3020) acc_x 75.0000 (66.2500) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [10/21] time 0.471 (0.467) data 0.340 (0.336) loss_x loss_x 1.0518 (1.3725) acc_x 75.0000 (66.2500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [15/21] time 0.389 (0.456) data 0.258 (0.325) loss_x loss_x 1.5156 (1.4055) acc_x 65.6250 (65.4167) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/21] time 0.503 (0.459) data 0.372 (0.328) loss_x loss_x 1.6494 (1.4722) acc_x 43.7500 (63.5938) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1755
confident_label rate tensor(0.2369, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 743
clean true:740
clean false:3
clean_rate:0.9959623149394348
noisy true:641
noisy false:1752
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 2393
epoch [27/200] batch [5/23] time 0.461 (0.501) data 0.331 (0.371) loss_x loss_x 1.2129 (1.2542) acc_x 59.3750 (61.2500) lr 1.9239e-03 eta 0:00:09
epoch [27/200] batch [10/23] time 0.518 (0.482) data 0.387 (0.352) loss_x loss_x 1.2588 (1.3753) acc_x 65.6250 (60.9375) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [15/23] time 0.400 (0.476) data 0.268 (0.344) loss_x loss_x 1.3955 (1.3768) acc_x 46.8750 (60.2083) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/23] time 0.515 (0.478) data 0.385 (0.347) loss_x loss_x 0.9214 (1.3930) acc_x 71.8750 (60.0000) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 696
clean true:686
clean false:10
clean_rate:0.985632183908046
noisy true:633
noisy false:1807
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 2440
epoch [28/200] batch [5/21] time 0.408 (0.457) data 0.277 (0.326) loss_x loss_x 1.7891 (1.3804) acc_x 56.2500 (63.7500) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [10/21] time 0.536 (0.475) data 0.405 (0.344) loss_x loss_x 1.1592 (1.3667) acc_x 75.0000 (65.0000) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [15/21] time 0.410 (0.456) data 0.279 (0.325) loss_x loss_x 1.7334 (1.3025) acc_x 62.5000 (66.8750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/21] time 0.428 (0.461) data 0.298 (0.330) loss_x loss_x 1.2852 (1.3223) acc_x 59.3750 (66.5625) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1803
confident_label rate tensor(0.2216, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 695
clean true:690
clean false:5
clean_rate:0.9928057553956835
noisy true:643
noisy false:1798
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 2441
epoch [29/200] batch [5/21] time 0.533 (0.507) data 0.402 (0.375) loss_x loss_x 1.7500 (1.4309) acc_x 56.2500 (63.1250) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [10/21] time 0.536 (0.488) data 0.405 (0.357) loss_x loss_x 1.7695 (1.4114) acc_x 62.5000 (64.3750) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/21] time 0.490 (0.491) data 0.359 (0.359) loss_x loss_x 1.3271 (1.4921) acc_x 68.7500 (62.2917) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/21] time 0.462 (0.483) data 0.331 (0.351) loss_x loss_x 1.3379 (1.4644) acc_x 59.3750 (62.3438) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 722
clean true:715
clean false:7
clean_rate:0.9903047091412742
noisy true:648
noisy false:1766
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 2414
epoch [30/200] batch [5/22] time 0.387 (0.445) data 0.256 (0.314) loss_x loss_x 1.7607 (1.2844) acc_x 65.6250 (65.6250) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [10/22] time 0.451 (0.447) data 0.319 (0.316) loss_x loss_x 1.2656 (1.3731) acc_x 68.7500 (64.6875) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [15/22] time 0.449 (0.464) data 0.318 (0.332) loss_x loss_x 0.8989 (1.4024) acc_x 68.7500 (63.7500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/22] time 0.437 (0.464) data 0.306 (0.333) loss_x loss_x 0.9883 (1.3728) acc_x 68.7500 (65.0000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1827
confident_label rate tensor(0.2251, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 706
clean true:698
clean false:8
clean_rate:0.9886685552407932
noisy true:611
noisy false:1819
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 2430
epoch [31/200] batch [5/22] time 0.446 (0.423) data 0.315 (0.292) loss_x loss_x 1.5381 (1.7365) acc_x 65.6250 (59.3750) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [10/22] time 0.516 (0.455) data 0.384 (0.324) loss_x loss_x 1.3740 (1.6588) acc_x 56.2500 (58.4375) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [15/22] time 0.519 (0.463) data 0.388 (0.332) loss_x loss_x 1.1357 (1.5768) acc_x 75.0000 (60.6250) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/22] time 0.541 (0.462) data 0.410 (0.331) loss_x loss_x 1.6299 (1.5434) acc_x 59.3750 (62.0312) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1789
confident_label rate tensor(0.2293, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 719
clean true:712
clean false:7
clean_rate:0.9902642559109874
noisy true:635
noisy false:1782
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 2417
epoch [32/200] batch [5/22] time 0.521 (0.487) data 0.390 (0.356) loss_x loss_x 1.4316 (1.4316) acc_x 71.8750 (66.8750) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [10/22] time 0.402 (0.467) data 0.271 (0.336) loss_x loss_x 1.2246 (1.5191) acc_x 75.0000 (64.6875) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [15/22] time 0.398 (0.465) data 0.267 (0.334) loss_x loss_x 1.6621 (1.5551) acc_x 62.5000 (64.5833) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/22] time 0.506 (0.477) data 0.375 (0.345) loss_x loss_x 1.0283 (1.5189) acc_x 71.8750 (64.8438) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1805
confident_label rate tensor(0.2216, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 695
clean true:691
clean false:4
clean_rate:0.9942446043165467
noisy true:640
noisy false:1801
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 2441
epoch [33/200] batch [5/21] time 0.606 (0.506) data 0.474 (0.374) loss_x loss_x 1.4219 (1.4100) acc_x 59.3750 (60.6250) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [10/21] time 0.550 (0.488) data 0.418 (0.356) loss_x loss_x 1.2480 (1.4484) acc_x 68.7500 (63.7500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [15/21] time 0.480 (0.474) data 0.348 (0.342) loss_x loss_x 1.7627 (1.4113) acc_x 59.3750 (63.9583) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/21] time 0.410 (0.469) data 0.279 (0.337) loss_x loss_x 1.9121 (1.4266) acc_x 59.3750 (63.9062) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1796
confident_label rate tensor(0.2293, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 719
clean true:712
clean false:7
clean_rate:0.9902642559109874
noisy true:628
noisy false:1789
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 2417
epoch [34/200] batch [5/22] time 0.493 (0.471) data 0.361 (0.340) loss_x loss_x 1.7998 (1.4482) acc_x 62.5000 (68.1250) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [10/22] time 0.516 (0.466) data 0.385 (0.335) loss_x loss_x 1.7998 (1.4843) acc_x 40.6250 (63.1250) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [15/22] time 0.503 (0.480) data 0.371 (0.349) loss_x loss_x 1.5537 (1.5577) acc_x 62.5000 (59.5833) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/22] time 0.348 (0.484) data 0.217 (0.352) loss_x loss_x 1.7490 (1.5021) acc_x 46.8750 (60.9375) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 720
clean true:717
clean false:3
clean_rate:0.9958333333333333
noisy true:646
noisy false:1770
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 2416
epoch [35/200] batch [5/22] time 0.462 (0.480) data 0.330 (0.348) loss_x loss_x 0.9570 (1.2430) acc_x 71.8750 (66.8750) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [10/22] time 0.526 (0.459) data 0.394 (0.327) loss_x loss_x 1.4248 (1.3406) acc_x 68.7500 (67.1875) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [15/22] time 0.457 (0.458) data 0.326 (0.327) loss_x loss_x 0.9326 (1.3420) acc_x 71.8750 (66.2500) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/22] time 0.416 (0.460) data 0.286 (0.329) loss_x loss_x 1.2656 (1.3423) acc_x 71.8750 (67.0312) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1788
confident_label rate tensor(0.2305, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 723
clean true:714
clean false:9
clean_rate:0.9875518672199171
noisy true:634
noisy false:1779
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 2413
epoch [36/200] batch [5/22] time 0.520 (0.504) data 0.389 (0.373) loss_x loss_x 1.3184 (1.6156) acc_x 40.6250 (55.6250) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [10/22] time 0.443 (0.498) data 0.312 (0.367) loss_x loss_x 1.2285 (1.4799) acc_x 68.7500 (60.3125) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [15/22] time 0.433 (0.483) data 0.302 (0.352) loss_x loss_x 1.1484 (1.4102) acc_x 75.0000 (63.7500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/22] time 0.360 (0.481) data 0.228 (0.350) loss_x loss_x 1.7959 (1.4634) acc_x 53.1250 (62.8125) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 711
clean true:704
clean false:7
clean_rate:0.9901547116736991
noisy true:646
noisy false:1779
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 2425
epoch [37/200] batch [5/22] time 0.440 (0.475) data 0.308 (0.343) loss_x loss_x 1.0146 (1.4014) acc_x 75.0000 (67.5000) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [10/22] time 0.459 (0.474) data 0.328 (0.342) loss_x loss_x 1.2676 (1.4660) acc_x 50.0000 (63.1250) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [15/22] time 0.383 (0.468) data 0.252 (0.336) loss_x loss_x 1.1533 (1.4159) acc_x 71.8750 (65.0000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/22] time 0.520 (0.468) data 0.389 (0.337) loss_x loss_x 1.4326 (1.3871) acc_x 50.0000 (65.1562) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2360, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 740
clean true:731
clean false:9
clean_rate:0.9878378378378379
noisy true:633
noisy false:1763
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 2396
epoch [38/200] batch [5/23] time 0.525 (0.443) data 0.394 (0.312) loss_x loss_x 1.5693 (1.4830) acc_x 59.3750 (63.7500) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [10/23] time 0.494 (0.456) data 0.363 (0.325) loss_x loss_x 2.2031 (1.5292) acc_x 59.3750 (63.1250) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [15/23] time 0.402 (0.460) data 0.271 (0.329) loss_x loss_x 1.0547 (1.4345) acc_x 71.8750 (64.7917) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/23] time 0.387 (0.459) data 0.256 (0.328) loss_x loss_x 1.6172 (1.4603) acc_x 62.5000 (64.5312) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.2334, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 732
clean true:724
clean false:8
clean_rate:0.9890710382513661
noisy true:661
noisy false:1743
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 2404
epoch [39/200] batch [5/22] time 0.479 (0.480) data 0.348 (0.350) loss_x loss_x 1.4482 (1.5437) acc_x 68.7500 (61.2500) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [10/22] time 0.534 (0.494) data 0.403 (0.363) loss_x loss_x 1.3242 (1.3621) acc_x 71.8750 (65.6250) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [15/22] time 0.373 (0.494) data 0.242 (0.363) loss_x loss_x 1.6846 (1.3798) acc_x 65.6250 (65.6250) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/22] time 0.472 (0.491) data 0.341 (0.360) loss_x loss_x 1.4814 (1.3557) acc_x 65.6250 (65.4688) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1794
confident_label rate tensor(0.2245, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 704
clean true:699
clean false:5
clean_rate:0.9928977272727273
noisy true:643
noisy false:1789
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 2432
epoch [40/200] batch [5/22] time 0.340 (0.472) data 0.209 (0.341) loss_x loss_x 0.9155 (1.2745) acc_x 75.0000 (67.5000) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [10/22] time 0.430 (0.467) data 0.300 (0.336) loss_x loss_x 1.2627 (1.4578) acc_x 71.8750 (61.5625) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [15/22] time 0.445 (0.476) data 0.314 (0.345) loss_x loss_x 1.2744 (1.4651) acc_x 68.7500 (61.8750) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/22] time 0.522 (0.478) data 0.391 (0.347) loss_x loss_x 1.9199 (1.4673) acc_x 50.0000 (62.3438) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.2242, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 703
clean true:695
clean false:8
clean_rate:0.9886201991465149
noisy true:646
noisy false:1787
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 2433
epoch [41/200] batch [5/21] time 0.502 (0.510) data 0.371 (0.378) loss_x loss_x 1.4277 (1.4547) acc_x 53.1250 (59.3750) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [10/21] time 0.657 (0.491) data 0.526 (0.360) loss_x loss_x 1.5381 (1.3698) acc_x 59.3750 (61.5625) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [15/21] time 0.492 (0.484) data 0.360 (0.353) loss_x loss_x 1.3877 (1.3804) acc_x 59.3750 (61.4583) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/21] time 0.403 (0.474) data 0.272 (0.343) loss_x loss_x 1.7861 (1.4158) acc_x 50.0000 (60.4688) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2337, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 733
clean true:725
clean false:8
clean_rate:0.9890859481582538
noisy true:659
noisy false:1744
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 2403
epoch [42/200] batch [5/22] time 0.486 (0.502) data 0.355 (0.371) loss_x loss_x 1.2207 (1.4061) acc_x 68.7500 (64.3750) lr 1.8090e-03 eta 0:00:08
epoch [42/200] batch [10/22] time 0.350 (0.469) data 0.219 (0.338) loss_x loss_x 1.5986 (1.4144) acc_x 53.1250 (62.1875) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [15/22] time 0.495 (0.458) data 0.364 (0.327) loss_x loss_x 1.3164 (1.3788) acc_x 68.7500 (64.1667) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/22] time 0.500 (0.460) data 0.368 (0.329) loss_x loss_x 1.0791 (1.3808) acc_x 81.2500 (64.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2423, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 760
clean true:756
clean false:4
clean_rate:0.9947368421052631
noisy true:624
noisy false:1752
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 2376
epoch [43/200] batch [5/23] time 0.528 (0.481) data 0.397 (0.350) loss_x loss_x 1.5615 (1.3751) acc_x 65.6250 (64.3750) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [10/23] time 0.570 (0.504) data 0.440 (0.373) loss_x loss_x 1.2373 (1.4006) acc_x 68.7500 (64.3750) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [15/23] time 0.447 (0.498) data 0.316 (0.367) loss_x loss_x 1.3379 (1.3838) acc_x 75.0000 (65.2083) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/23] time 0.384 (0.486) data 0.253 (0.354) loss_x loss_x 0.9927 (1.3901) acc_x 65.6250 (64.3750) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1755
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:732
clean false:3
clean_rate:0.9959183673469387
noisy true:649
noisy false:1752
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [44/200] batch [5/22] time 0.383 (0.477) data 0.252 (0.345) loss_x loss_x 1.6641 (1.5723) acc_x 56.2500 (61.2500) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [10/22] time 0.442 (0.457) data 0.310 (0.325) loss_x loss_x 1.0557 (1.4584) acc_x 71.8750 (62.8125) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [15/22] time 0.422 (0.458) data 0.291 (0.326) loss_x loss_x 1.4717 (1.3964) acc_x 56.2500 (64.1667) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/22] time 0.574 (0.461) data 0.443 (0.330) loss_x loss_x 1.1396 (1.3713) acc_x 65.6250 (64.5312) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 722
clean true:717
clean false:5
clean_rate:0.9930747922437673
noisy true:662
noisy false:1752
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 2414
epoch [45/200] batch [5/22] time 0.513 (0.482) data 0.381 (0.351) loss_x loss_x 1.6709 (1.6451) acc_x 56.2500 (59.3750) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [10/22] time 0.422 (0.446) data 0.292 (0.315) loss_x loss_x 1.6172 (1.5950) acc_x 59.3750 (60.0000) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [15/22] time 0.555 (0.464) data 0.424 (0.333) loss_x loss_x 0.8975 (1.4800) acc_x 81.2500 (63.5417) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/22] time 0.483 (0.464) data 0.352 (0.333) loss_x loss_x 1.6641 (1.4574) acc_x 59.3750 (63.4375) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1718
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 780
clean true:771
clean false:9
clean_rate:0.9884615384615385
noisy true:647
noisy false:1709
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 2356
epoch [46/200] batch [5/24] time 0.386 (0.438) data 0.255 (0.306) loss_x loss_x 1.4590 (1.4742) acc_x 53.1250 (62.5000) lr 1.7705e-03 eta 0:00:08
epoch [46/200] batch [10/24] time 0.488 (0.442) data 0.357 (0.310) loss_x loss_x 1.1875 (1.5633) acc_x 65.6250 (60.3125) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [15/24] time 0.367 (0.443) data 0.237 (0.312) loss_x loss_x 1.3584 (1.5123) acc_x 65.6250 (62.7083) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/24] time 0.478 (0.446) data 0.347 (0.314) loss_x loss_x 1.7666 (1.5015) acc_x 65.6250 (62.8125) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2315, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 726
clean true:723
clean false:3
clean_rate:0.9958677685950413
noisy true:656
noisy false:1754
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 2410
epoch [47/200] batch [5/22] time 0.424 (0.416) data 0.293 (0.285) loss_x loss_x 1.4941 (1.3138) acc_x 56.2500 (65.6250) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [10/22] time 0.419 (0.452) data 0.288 (0.320) loss_x loss_x 1.4648 (1.3009) acc_x 59.3750 (66.2500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [15/22] time 0.549 (0.457) data 0.418 (0.325) loss_x loss_x 0.9292 (1.2968) acc_x 68.7500 (65.4167) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/22] time 0.459 (0.465) data 0.328 (0.334) loss_x loss_x 2.0273 (1.3268) acc_x 46.8750 (65.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.2411, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 756
clean true:750
clean false:6
clean_rate:0.9920634920634921
noisy true:677
noisy false:1703
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 2380
epoch [48/200] batch [5/23] time 0.404 (0.468) data 0.273 (0.336) loss_x loss_x 1.9561 (1.2902) acc_x 50.0000 (66.2500) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [10/23] time 0.513 (0.485) data 0.381 (0.354) loss_x loss_x 1.3936 (1.2700) acc_x 75.0000 (68.4375) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [15/23] time 0.429 (0.477) data 0.299 (0.346) loss_x loss_x 1.8994 (1.3595) acc_x 59.3750 (65.8333) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/23] time 0.499 (0.463) data 0.369 (0.332) loss_x loss_x 1.2061 (1.3359) acc_x 65.6250 (66.0938) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 759
clean true:749
clean false:10
clean_rate:0.9868247694334651
noisy true:640
noisy false:1737
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 2377
epoch [49/200] batch [5/23] time 0.635 (0.516) data 0.504 (0.385) loss_x loss_x 1.2803 (1.4768) acc_x 56.2500 (56.2500) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/23] time 0.495 (0.473) data 0.364 (0.343) loss_x loss_x 0.7554 (1.3981) acc_x 84.3750 (61.2500) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [15/23] time 0.446 (0.471) data 0.314 (0.341) loss_x loss_x 1.3193 (1.3818) acc_x 75.0000 (64.1667) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/23] time 0.499 (0.482) data 0.368 (0.351) loss_x loss_x 1.5947 (1.3554) acc_x 59.3750 (65.1562) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1771
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 736
clean true:728
clean false:8
clean_rate:0.9891304347826086
noisy true:637
noisy false:1763
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 2400
epoch [50/200] batch [5/23] time 0.657 (0.482) data 0.525 (0.351) loss_x loss_x 0.9883 (1.2803) acc_x 71.8750 (65.0000) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [10/23] time 0.408 (0.475) data 0.277 (0.344) loss_x loss_x 1.3457 (1.2557) acc_x 68.7500 (68.4375) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [15/23] time 0.424 (0.478) data 0.293 (0.347) loss_x loss_x 1.2686 (1.2333) acc_x 62.5000 (69.5833) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/23] time 0.525 (0.471) data 0.393 (0.340) loss_x loss_x 1.9482 (1.3154) acc_x 56.2500 (68.5938) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1761
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 745
clean true:741
clean false:4
clean_rate:0.9946308724832215
noisy true:634
noisy false:1757
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 2391
epoch [51/200] batch [5/23] time 0.418 (0.477) data 0.286 (0.346) loss_x loss_x 2.0078 (1.7344) acc_x 53.1250 (51.8750) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [10/23] time 0.389 (0.440) data 0.258 (0.309) loss_x loss_x 1.4531 (1.5192) acc_x 56.2500 (57.8125) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [15/23] time 0.441 (0.450) data 0.310 (0.319) loss_x loss_x 1.1885 (1.4167) acc_x 68.7500 (60.8333) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/23] time 0.652 (0.469) data 0.521 (0.337) loss_x loss_x 1.0068 (1.3000) acc_x 78.1250 (65.6250) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 738
clean true:730
clean false:8
clean_rate:0.989159891598916
noisy true:650
noisy false:1748
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 2398
epoch [52/200] batch [5/23] time 0.513 (0.498) data 0.382 (0.367) loss_x loss_x 0.8311 (1.3217) acc_x 84.3750 (67.5000) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [10/23] time 0.395 (0.484) data 0.264 (0.353) loss_x loss_x 1.2803 (1.3351) acc_x 65.6250 (68.7500) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [15/23] time 0.483 (0.487) data 0.352 (0.356) loss_x loss_x 1.2305 (1.3809) acc_x 71.8750 (66.0417) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/23] time 0.464 (0.471) data 0.333 (0.340) loss_x loss_x 1.8896 (1.3837) acc_x 43.7500 (64.8438) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.2309, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 724
clean true:715
clean false:9
clean_rate:0.9875690607734806
noisy true:626
noisy false:1786
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 2412
epoch [53/200] batch [5/22] time 0.348 (0.445) data 0.216 (0.314) loss_x loss_x 1.4141 (1.4256) acc_x 68.7500 (66.8750) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [10/22] time 0.481 (0.459) data 0.349 (0.327) loss_x loss_x 1.1914 (1.4868) acc_x 56.2500 (64.3750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [15/22] time 0.436 (0.473) data 0.304 (0.342) loss_x loss_x 1.7900 (1.4521) acc_x 59.3750 (64.1667) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/22] time 0.453 (0.460) data 0.322 (0.329) loss_x loss_x 1.0039 (1.3879) acc_x 78.1250 (65.0000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2411, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 756
clean true:748
clean false:8
clean_rate:0.9894179894179894
noisy true:631
noisy false:1749
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 2380
epoch [54/200] batch [5/23] time 0.400 (0.442) data 0.269 (0.311) loss_x loss_x 1.2949 (1.2977) acc_x 65.6250 (67.5000) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [10/23] time 0.431 (0.449) data 0.300 (0.318) loss_x loss_x 1.4189 (1.3677) acc_x 62.5000 (65.3125) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [15/23] time 0.564 (0.454) data 0.432 (0.323) loss_x loss_x 1.0645 (1.3633) acc_x 75.0000 (65.0000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/23] time 0.462 (0.460) data 0.330 (0.328) loss_x loss_x 1.2070 (1.4193) acc_x 65.6250 (63.5938) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1738
confident_label rate tensor(0.2350, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 737
clean true:734
clean false:3
clean_rate:0.9959294436906377
noisy true:664
noisy false:1735
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 2399
epoch [55/200] batch [5/23] time 0.436 (0.504) data 0.304 (0.373) loss_x loss_x 0.7168 (1.0616) acc_x 84.3750 (74.3750) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [10/23] time 0.337 (0.479) data 0.206 (0.348) loss_x loss_x 1.4238 (1.1283) acc_x 59.3750 (69.3750) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [15/23] time 0.484 (0.501) data 0.353 (0.369) loss_x loss_x 1.2188 (1.2050) acc_x 71.8750 (66.6667) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [20/23] time 0.443 (0.484) data 0.312 (0.353) loss_x loss_x 1.0527 (1.2582) acc_x 65.6250 (65.6250) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.2436, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 764
clean true:761
clean false:3
clean_rate:0.9960732984293194
noisy true:676
noisy false:1696
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 2372
epoch [56/200] batch [5/23] time 0.383 (0.445) data 0.252 (0.314) loss_x loss_x 1.2607 (1.3584) acc_x 68.7500 (65.6250) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [10/23] time 0.423 (0.475) data 0.293 (0.344) loss_x loss_x 1.9170 (1.3302) acc_x 56.2500 (66.8750) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [15/23] time 0.533 (0.496) data 0.402 (0.365) loss_x loss_x 1.2217 (1.3003) acc_x 71.8750 (67.7083) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/23] time 0.530 (0.493) data 0.399 (0.362) loss_x loss_x 1.4082 (1.2945) acc_x 53.1250 (66.5625) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 745
clean true:736
clean false:9
clean_rate:0.9879194630872483
noisy true:648
noisy false:1743
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 2391
epoch [57/200] batch [5/23] time 0.517 (0.504) data 0.386 (0.373) loss_x loss_x 1.4434 (1.3553) acc_x 75.0000 (70.0000) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [10/23] time 0.564 (0.479) data 0.434 (0.348) loss_x loss_x 0.8223 (1.2771) acc_x 71.8750 (67.5000) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [15/23] time 0.473 (0.472) data 0.343 (0.341) loss_x loss_x 1.3916 (1.2914) acc_x 71.8750 (67.0833) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/23] time 0.415 (0.470) data 0.285 (0.339) loss_x loss_x 1.7314 (1.3261) acc_x 62.5000 (66.7188) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1697
confident_label rate tensor(0.2455, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 770
clean true:763
clean false:7
clean_rate:0.990909090909091
noisy true:676
noisy false:1690
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 2366
epoch [58/200] batch [5/24] time 0.422 (0.487) data 0.288 (0.355) loss_x loss_x 1.2207 (1.4643) acc_x 59.3750 (60.6250) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [10/24] time 0.445 (0.518) data 0.314 (0.385) loss_x loss_x 0.8589 (1.3472) acc_x 84.3750 (65.0000) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [15/24] time 0.378 (0.493) data 0.247 (0.361) loss_x loss_x 1.5684 (1.4036) acc_x 62.5000 (64.3750) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [20/24] time 0.436 (0.482) data 0.305 (0.351) loss_x loss_x 1.1475 (1.4227) acc_x 71.8750 (63.9062) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.2360, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 740
clean true:733
clean false:7
clean_rate:0.9905405405405405
noisy true:635
noisy false:1761
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 2396
epoch [59/200] batch [5/23] time 0.561 (0.498) data 0.431 (0.366) loss_x loss_x 2.1172 (1.4871) acc_x 40.6250 (60.0000) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [10/23] time 0.428 (0.481) data 0.298 (0.350) loss_x loss_x 1.2363 (1.4813) acc_x 65.6250 (60.9375) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [15/23] time 0.442 (0.473) data 0.311 (0.342) loss_x loss_x 0.8828 (1.3968) acc_x 78.1250 (63.3333) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/23] time 0.479 (0.475) data 0.347 (0.344) loss_x loss_x 1.7754 (1.4292) acc_x 56.2500 (64.0625) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1673
confident_label rate tensor(0.2497, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 783
clean true:777
clean false:6
clean_rate:0.9923371647509579
noisy true:686
noisy false:1667
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 2353
epoch [60/200] batch [5/24] time 0.536 (0.475) data 0.405 (0.344) loss_x loss_x 1.7568 (1.2670) acc_x 62.5000 (69.3750) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [10/24] time 0.426 (0.490) data 0.295 (0.360) loss_x loss_x 1.6484 (1.3931) acc_x 53.1250 (65.3125) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [15/24] time 0.472 (0.470) data 0.341 (0.339) loss_x loss_x 1.2861 (1.4147) acc_x 75.0000 (66.0417) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [20/24] time 0.420 (0.468) data 0.288 (0.337) loss_x loss_x 1.6484 (1.4385) acc_x 56.2500 (64.3750) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1760
confident_label rate tensor(0.2318, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 727
clean true:724
clean false:3
clean_rate:0.9958734525447043
noisy true:652
noisy false:1757
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 2409
epoch [61/200] batch [5/22] time 0.444 (0.440) data 0.314 (0.309) loss_x loss_x 1.8789 (1.3572) acc_x 59.3750 (68.1250) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [10/22] time 0.517 (0.468) data 0.387 (0.338) loss_x loss_x 0.8887 (1.3178) acc_x 81.2500 (67.5000) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [15/22] time 0.467 (0.469) data 0.337 (0.338) loss_x loss_x 1.0459 (1.2710) acc_x 71.8750 (67.0833) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/22] time 0.471 (0.476) data 0.340 (0.346) loss_x loss_x 0.8159 (1.2582) acc_x 84.3750 (67.5000) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1707
confident_label rate tensor(0.2443, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 766
clean true:755
clean false:11
clean_rate:0.9856396866840731
noisy true:674
noisy false:1696
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 2370
epoch [62/200] batch [5/23] time 0.507 (0.489) data 0.375 (0.355) loss_x loss_x 1.3672 (1.4309) acc_x 68.7500 (65.0000) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [10/23] time 0.527 (0.482) data 0.397 (0.350) loss_x loss_x 1.3799 (1.4256) acc_x 62.5000 (64.3750) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [15/23] time 0.371 (0.464) data 0.241 (0.333) loss_x loss_x 2.2578 (1.3878) acc_x 46.8750 (65.8333) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/23] time 0.593 (0.479) data 0.464 (0.348) loss_x loss_x 0.8755 (1.3843) acc_x 78.1250 (65.3125) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2478, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 777
clean true:770
clean false:7
clean_rate:0.990990990990991
noisy true:670
noisy false:1689
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 2359
epoch [63/200] batch [5/24] time 0.607 (0.463) data 0.477 (0.332) loss_x loss_x 1.9473 (1.5869) acc_x 46.8750 (58.7500) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [10/24] time 0.381 (0.453) data 0.249 (0.323) loss_x loss_x 1.1094 (1.4309) acc_x 71.8750 (63.4375) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [15/24] time 0.400 (0.456) data 0.270 (0.325) loss_x loss_x 1.2041 (1.4077) acc_x 71.8750 (63.9583) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [20/24] time 0.569 (0.475) data 0.438 (0.344) loss_x loss_x 1.5059 (1.4321) acc_x 56.2500 (62.6562) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1738
confident_label rate tensor(0.2404, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 754
clean true:745
clean false:9
clean_rate:0.9880636604774535
noisy true:653
noisy false:1729
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 2382
epoch [64/200] batch [5/23] time 0.427 (0.447) data 0.296 (0.316) loss_x loss_x 1.5000 (1.3750) acc_x 65.6250 (65.6250) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [10/23] time 0.548 (0.492) data 0.417 (0.361) loss_x loss_x 1.1768 (1.3416) acc_x 62.5000 (69.0625) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [15/23] time 0.367 (0.485) data 0.237 (0.354) loss_x loss_x 1.0947 (1.3145) acc_x 75.0000 (67.9167) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/23] time 0.386 (0.486) data 0.255 (0.355) loss_x loss_x 2.1699 (1.3597) acc_x 37.5000 (66.8750) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1710
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:748
clean false:5
clean_rate:0.9933598937583001
noisy true:678
noisy false:1705
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [65/200] batch [5/23] time 0.441 (0.499) data 0.310 (0.368) loss_x loss_x 1.5703 (1.3156) acc_x 56.2500 (66.2500) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [10/23] time 0.766 (0.517) data 0.635 (0.386) loss_x loss_x 1.6055 (1.3736) acc_x 59.3750 (65.3125) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [15/23] time 0.357 (0.484) data 0.227 (0.353) loss_x loss_x 1.1221 (1.3392) acc_x 65.6250 (64.5833) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/23] time 0.354 (0.470) data 0.222 (0.339) loss_x loss_x 1.0664 (1.3502) acc_x 71.8750 (64.8438) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.2459, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 771
clean true:763
clean false:8
clean_rate:0.9896238651102465
noisy true:681
noisy false:1684
after delete: len(clean_dataset) 771
after delete: len(noisy_dataset) 2365
epoch [66/200] batch [5/24] time 0.456 (0.485) data 0.325 (0.354) loss_x loss_x 0.9570 (1.2760) acc_x 75.0000 (68.7500) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [10/24] time 0.385 (0.445) data 0.254 (0.314) loss_x loss_x 0.8965 (1.1705) acc_x 71.8750 (68.7500) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [15/24] time 0.627 (0.455) data 0.496 (0.325) loss_x loss_x 1.1963 (1.1640) acc_x 68.7500 (69.1667) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [20/24] time 0.487 (0.460) data 0.356 (0.330) loss_x loss_x 0.8745 (1.1794) acc_x 75.0000 (69.0625) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.2526, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 792
clean true:784
clean false:8
clean_rate:0.98989898989899
noisy true:637
noisy false:1707
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 2344
epoch [67/200] batch [5/24] time 0.575 (0.554) data 0.444 (0.422) loss_x loss_x 1.5234 (1.3294) acc_x 46.8750 (61.2500) lr 1.5225e-03 eta 0:00:10
epoch [67/200] batch [10/24] time 0.675 (0.537) data 0.543 (0.406) loss_x loss_x 0.9795 (1.2393) acc_x 65.6250 (65.9375) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [15/24] time 0.385 (0.526) data 0.253 (0.395) loss_x loss_x 1.6084 (1.3180) acc_x 56.2500 (66.6667) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [20/24] time 0.413 (0.512) data 0.283 (0.381) loss_x loss_x 1.4814 (1.3489) acc_x 62.5000 (65.7812) lr 1.5225e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 805
clean true:795
clean false:10
clean_rate:0.9875776397515528
noisy true:667
noisy false:1664
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 2331
epoch [68/200] batch [5/25] time 0.549 (0.453) data 0.418 (0.322) loss_x loss_x 1.4443 (1.4305) acc_x 59.3750 (63.1250) lr 1.5090e-03 eta 0:00:09
epoch [68/200] batch [10/25] time 0.427 (0.437) data 0.296 (0.306) loss_x loss_x 1.4238 (1.6105) acc_x 62.5000 (60.6250) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [15/25] time 0.620 (0.481) data 0.489 (0.350) loss_x loss_x 1.2793 (1.5306) acc_x 62.5000 (61.0417) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/25] time 0.410 (0.484) data 0.278 (0.353) loss_x loss_x 1.5674 (1.5015) acc_x 65.6250 (61.7188) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/25] time 0.448 (0.486) data 0.316 (0.355) loss_x loss_x 1.5273 (1.4984) acc_x 50.0000 (62.0000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 759
clean true:756
clean false:3
clean_rate:0.9960474308300395
noisy true:652
noisy false:1725
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 2377
epoch [69/200] batch [5/23] time 0.465 (0.472) data 0.334 (0.341) loss_x loss_x 1.3613 (1.2471) acc_x 71.8750 (69.3750) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [10/23] time 0.444 (0.481) data 0.314 (0.350) loss_x loss_x 1.8066 (1.3762) acc_x 59.3750 (66.8750) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [15/23] time 0.458 (0.470) data 0.327 (0.339) loss_x loss_x 1.2480 (1.3390) acc_x 62.5000 (65.0000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/23] time 0.459 (0.464) data 0.329 (0.333) loss_x loss_x 1.6104 (1.3687) acc_x 62.5000 (64.2188) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.2573, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 807
clean true:799
clean false:8
clean_rate:0.990086741016109
noisy true:698
noisy false:1631
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 2329
epoch [70/200] batch [5/25] time 0.445 (0.553) data 0.314 (0.422) loss_x loss_x 1.1025 (1.3342) acc_x 68.7500 (66.2500) lr 1.4818e-03 eta 0:00:11
epoch [70/200] batch [10/25] time 0.571 (0.503) data 0.440 (0.371) loss_x loss_x 1.4434 (1.3692) acc_x 56.2500 (62.8125) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [15/25] time 0.520 (0.500) data 0.389 (0.369) loss_x loss_x 1.6963 (1.3595) acc_x 59.3750 (63.9583) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [20/25] time 0.428 (0.480) data 0.297 (0.349) loss_x loss_x 1.0781 (1.3611) acc_x 71.8750 (64.8438) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/25] time 0.451 (0.485) data 0.320 (0.354) loss_x loss_x 1.5518 (1.3651) acc_x 59.3750 (64.7500) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.2465, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 773
clean true:765
clean false:8
clean_rate:0.9896507115135834
noisy true:687
noisy false:1676
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 2363
epoch [71/200] batch [5/24] time 0.473 (0.505) data 0.342 (0.374) loss_x loss_x 0.7920 (1.3045) acc_x 81.2500 (70.0000) lr 1.4679e-03 eta 0:00:09
epoch [71/200] batch [10/24] time 0.475 (0.487) data 0.344 (0.356) loss_x loss_x 1.5791 (1.3345) acc_x 59.3750 (67.8125) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [15/24] time 0.396 (0.477) data 0.266 (0.346) loss_x loss_x 1.4219 (1.3895) acc_x 59.3750 (66.2500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [20/24] time 0.409 (0.468) data 0.278 (0.337) loss_x loss_x 1.0391 (1.3631) acc_x 71.8750 (67.1875) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1721
confident_label rate tensor(0.2452, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 769
clean true:766
clean false:3
clean_rate:0.9960988296488946
noisy true:649
noisy false:1718
after delete: len(clean_dataset) 769
after delete: len(noisy_dataset) 2367
epoch [72/200] batch [5/24] time 0.428 (0.419) data 0.297 (0.288) loss_x loss_x 0.9712 (1.3315) acc_x 71.8750 (65.0000) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [10/24] time 0.483 (0.443) data 0.351 (0.312) loss_x loss_x 1.0264 (1.3027) acc_x 78.1250 (66.5625) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [15/24] time 0.462 (0.455) data 0.332 (0.325) loss_x loss_x 0.7852 (1.2744) acc_x 78.1250 (67.2917) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [20/24] time 0.463 (0.467) data 0.332 (0.336) loss_x loss_x 1.2793 (1.2657) acc_x 62.5000 (67.0312) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1710
confident_label rate tensor(0.2436, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 764
clean true:756
clean false:8
clean_rate:0.9895287958115183
noisy true:670
noisy false:1702
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 2372
epoch [73/200] batch [5/23] time 0.459 (0.514) data 0.329 (0.383) loss_x loss_x 1.7852 (1.3283) acc_x 65.6250 (71.2500) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [10/23] time 0.561 (0.504) data 0.430 (0.373) loss_x loss_x 1.0742 (1.3378) acc_x 75.0000 (70.6250) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [15/23] time 0.387 (0.491) data 0.257 (0.360) loss_x loss_x 0.9517 (1.3229) acc_x 78.1250 (70.4167) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/23] time 0.416 (0.481) data 0.286 (0.350) loss_x loss_x 1.0498 (1.3362) acc_x 75.0000 (68.1250) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 747
clean true:742
clean false:5
clean_rate:0.9933065595716198
noisy true:642
noisy false:1747
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 2389
epoch [74/200] batch [5/23] time 0.458 (0.552) data 0.327 (0.421) loss_x loss_x 0.9009 (1.1895) acc_x 75.0000 (73.7500) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [10/23] time 0.370 (0.519) data 0.239 (0.388) loss_x loss_x 1.1230 (1.1728) acc_x 78.1250 (70.3125) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [15/23] time 0.372 (0.484) data 0.242 (0.354) loss_x loss_x 1.5957 (1.2725) acc_x 62.5000 (66.8750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/23] time 0.429 (0.468) data 0.298 (0.338) loss_x loss_x 0.9653 (1.2727) acc_x 71.8750 (66.7188) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1712
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:775
clean false:10
clean_rate:0.9872611464968153
noisy true:649
noisy false:1702
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [75/200] batch [5/24] time 0.619 (0.485) data 0.488 (0.354) loss_x loss_x 1.9629 (1.5377) acc_x 62.5000 (65.6250) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [10/24] time 0.553 (0.477) data 0.423 (0.346) loss_x loss_x 1.0840 (1.4811) acc_x 75.0000 (64.3750) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [15/24] time 0.472 (0.487) data 0.342 (0.356) loss_x loss_x 1.5557 (1.4066) acc_x 62.5000 (65.8333) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [20/24] time 0.519 (0.480) data 0.387 (0.349) loss_x loss_x 1.3994 (1.4407) acc_x 65.6250 (65.3125) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.2478, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 777
clean true:770
clean false:7
clean_rate:0.990990990990991
noisy true:666
noisy false:1693
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 2359
epoch [76/200] batch [5/24] time 0.577 (0.519) data 0.447 (0.388) loss_x loss_x 1.2256 (1.3154) acc_x 71.8750 (69.3750) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [10/24] time 0.503 (0.509) data 0.373 (0.378) loss_x loss_x 1.1670 (1.2073) acc_x 75.0000 (70.0000) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [15/24] time 0.430 (0.495) data 0.299 (0.364) loss_x loss_x 1.4678 (1.2365) acc_x 68.7500 (69.5833) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [20/24] time 0.495 (0.500) data 0.365 (0.369) loss_x loss_x 1.4014 (1.2730) acc_x 65.6250 (69.3750) lr 1.3971e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:750
clean false:3
clean_rate:0.9960159362549801
noisy true:661
noisy false:1722
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [77/200] batch [5/23] time 0.491 (0.452) data 0.360 (0.321) loss_x loss_x 1.3369 (1.5729) acc_x 71.8750 (64.3750) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [10/23] time 0.470 (0.475) data 0.339 (0.344) loss_x loss_x 0.9146 (1.3888) acc_x 81.2500 (70.0000) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [15/23] time 0.382 (0.487) data 0.251 (0.357) loss_x loss_x 1.3535 (1.4510) acc_x 62.5000 (67.7083) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/23] time 0.505 (0.479) data 0.374 (0.349) loss_x loss_x 1.1445 (1.3558) acc_x 71.8750 (68.9062) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1739
confident_label rate tensor(0.2395, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 751
clean true:743
clean false:8
clean_rate:0.9893475366178429
noisy true:654
noisy false:1731
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 2385
epoch [78/200] batch [5/23] time 0.537 (0.533) data 0.407 (0.402) loss_x loss_x 1.7451 (1.1829) acc_x 62.5000 (72.5000) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [10/23] time 0.450 (0.486) data 0.319 (0.356) loss_x loss_x 1.2402 (1.3086) acc_x 71.8750 (68.4375) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [15/23] time 0.396 (0.477) data 0.265 (0.346) loss_x loss_x 1.4170 (1.3864) acc_x 65.6250 (66.8750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/23] time 0.615 (0.470) data 0.485 (0.339) loss_x loss_x 1.0059 (1.3678) acc_x 75.0000 (66.5625) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1667
confident_label rate tensor(0.2554, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 801
clean true:792
clean false:9
clean_rate:0.9887640449438202
noisy true:677
noisy false:1658
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 2335
epoch [79/200] batch [5/25] time 0.390 (0.475) data 0.259 (0.342) loss_x loss_x 1.8018 (1.3723) acc_x 62.5000 (66.8750) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [10/25] time 0.643 (0.503) data 0.512 (0.371) loss_x loss_x 1.6045 (1.3862) acc_x 53.1250 (64.6875) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [15/25] time 0.362 (0.480) data 0.231 (0.348) loss_x loss_x 1.0273 (1.3051) acc_x 68.7500 (67.5000) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [20/25] time 0.485 (0.478) data 0.353 (0.347) loss_x loss_x 2.6758 (1.3902) acc_x 59.3750 (66.2500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/25] time 0.339 (0.476) data 0.209 (0.345) loss_x loss_x 0.9619 (1.3509) acc_x 75.0000 (67.1250) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1730
confident_label rate tensor(0.2459, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 771
clean true:770
clean false:1
clean_rate:0.9987029831387808
noisy true:636
noisy false:1729
after delete: len(clean_dataset) 771
after delete: len(noisy_dataset) 2365
epoch [80/200] batch [5/24] time 0.398 (0.433) data 0.268 (0.302) loss_x loss_x 1.4609 (1.3615) acc_x 59.3750 (63.7500) lr 1.3387e-03 eta 0:00:08
epoch [80/200] batch [10/24] time 0.416 (0.429) data 0.284 (0.298) loss_x loss_x 1.3535 (1.3042) acc_x 71.8750 (65.6250) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [15/24] time 0.435 (0.445) data 0.304 (0.314) loss_x loss_x 1.2529 (1.2845) acc_x 59.3750 (65.6250) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [20/24] time 0.552 (0.448) data 0.421 (0.317) loss_x loss_x 1.3838 (1.2741) acc_x 65.6250 (66.7188) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1673
confident_label rate tensor(0.2592, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 813
clean true:807
clean false:6
clean_rate:0.992619926199262
noisy true:656
noisy false:1667
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 2323
epoch [81/200] batch [5/25] time 0.538 (0.459) data 0.407 (0.328) loss_x loss_x 1.8926 (1.2515) acc_x 50.0000 (63.1250) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/25] time 0.448 (0.458) data 0.316 (0.327) loss_x loss_x 1.2402 (1.3003) acc_x 65.6250 (64.6875) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [15/25] time 0.391 (0.456) data 0.260 (0.325) loss_x loss_x 1.0029 (1.2342) acc_x 75.0000 (66.8750) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [20/25] time 0.401 (0.451) data 0.269 (0.319) loss_x loss_x 1.4160 (1.2090) acc_x 65.6250 (68.2812) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/25] time 0.474 (0.462) data 0.343 (0.331) loss_x loss_x 1.7021 (1.2758) acc_x 65.6250 (66.7500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.2471, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 775
clean true:767
clean false:8
clean_rate:0.9896774193548387
noisy true:669
noisy false:1692
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 2361
epoch [82/200] batch [5/24] time 0.360 (0.441) data 0.228 (0.309) loss_x loss_x 1.0811 (1.2084) acc_x 75.0000 (70.0000) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [10/24] time 0.434 (0.460) data 0.302 (0.328) loss_x loss_x 1.2812 (1.2263) acc_x 59.3750 (67.8125) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [15/24] time 0.462 (0.462) data 0.331 (0.330) loss_x loss_x 1.2803 (1.3136) acc_x 75.0000 (67.7083) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [20/24] time 0.498 (0.464) data 0.367 (0.332) loss_x loss_x 1.9160 (1.3500) acc_x 59.3750 (66.4062) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1643
confident_label rate tensor(0.2618, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 821
clean true:811
clean false:10
clean_rate:0.9878197320341048
noisy true:682
noisy false:1633
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 2315
epoch [83/200] batch [5/25] time 0.383 (0.437) data 0.253 (0.306) loss_x loss_x 0.9878 (1.2198) acc_x 78.1250 (68.1250) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [10/25] time 0.581 (0.467) data 0.450 (0.336) loss_x loss_x 1.3838 (1.3719) acc_x 59.3750 (65.9375) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [15/25] time 0.417 (0.465) data 0.286 (0.334) loss_x loss_x 1.3584 (1.3869) acc_x 68.7500 (65.6250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [20/25] time 0.506 (0.464) data 0.374 (0.333) loss_x loss_x 1.2041 (1.4472) acc_x 75.0000 (65.3125) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/25] time 0.481 (0.468) data 0.350 (0.337) loss_x loss_x 1.4033 (1.4177) acc_x 62.5000 (66.3750) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.2398, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 752
clean true:743
clean false:9
clean_rate:0.988031914893617
noisy true:658
noisy false:1726
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 2384
epoch [84/200] batch [5/23] time 0.453 (0.450) data 0.322 (0.319) loss_x loss_x 0.8936 (1.3596) acc_x 75.0000 (60.0000) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [10/23] time 0.390 (0.446) data 0.259 (0.315) loss_x loss_x 1.9180 (1.2935) acc_x 56.2500 (65.9375) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [15/23] time 0.569 (0.461) data 0.438 (0.329) loss_x loss_x 1.8105 (1.3526) acc_x 53.1250 (65.2083) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/23] time 0.473 (0.457) data 0.343 (0.326) loss_x loss_x 1.2988 (1.3043) acc_x 65.6250 (65.9375) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1690
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 784
clean true:774
clean false:10
clean_rate:0.9872448979591837
noisy true:672
noisy false:1680
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 2352
epoch [85/200] batch [5/24] time 0.637 (0.541) data 0.504 (0.407) loss_x loss_x 1.7734 (1.4182) acc_x 65.6250 (67.5000) lr 1.2639e-03 eta 0:00:10
epoch [85/200] batch [10/24] time 0.458 (0.542) data 0.327 (0.409) loss_x loss_x 1.1143 (1.3545) acc_x 68.7500 (67.1875) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [15/24] time 0.422 (0.527) data 0.291 (0.395) loss_x loss_x 1.1475 (1.2677) acc_x 68.7500 (68.7500) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [20/24] time 0.641 (0.509) data 0.510 (0.377) loss_x loss_x 1.2227 (1.2881) acc_x 81.2500 (68.5938) lr 1.2639e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:774
clean false:11
clean_rate:0.9859872611464968
noisy true:705
noisy false:1646
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [86/200] batch [5/24] time 0.479 (0.449) data 0.347 (0.317) loss_x loss_x 0.9961 (1.2196) acc_x 75.0000 (71.2500) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [10/24] time 0.403 (0.456) data 0.272 (0.324) loss_x loss_x 1.7686 (1.3235) acc_x 50.0000 (68.4375) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [15/24] time 0.387 (0.448) data 0.255 (0.317) loss_x loss_x 1.2559 (1.3690) acc_x 59.3750 (67.5000) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [20/24] time 0.528 (0.467) data 0.396 (0.335) loss_x loss_x 1.9297 (1.3852) acc_x 43.7500 (65.4688) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 811
clean true:804
clean false:7
clean_rate:0.9913686806411838
noisy true:655
noisy false:1670
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 2325
epoch [87/200] batch [5/25] time 0.456 (0.456) data 0.325 (0.325) loss_x loss_x 0.8999 (1.1911) acc_x 81.2500 (71.8750) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/25] time 0.580 (0.467) data 0.449 (0.336) loss_x loss_x 1.1357 (1.2430) acc_x 78.1250 (69.6875) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/25] time 0.458 (0.457) data 0.326 (0.326) loss_x loss_x 1.2520 (1.2524) acc_x 75.0000 (68.5417) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [20/25] time 0.468 (0.463) data 0.337 (0.332) loss_x loss_x 0.8413 (1.2173) acc_x 75.0000 (69.0625) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/25] time 0.426 (0.455) data 0.295 (0.324) loss_x loss_x 0.8965 (1.2213) acc_x 81.2500 (69.6250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1683
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:781
clean false:4
clean_rate:0.9949044585987261
noisy true:672
noisy false:1679
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [88/200] batch [5/24] time 0.481 (0.475) data 0.350 (0.343) loss_x loss_x 1.4189 (1.3803) acc_x 56.2500 (61.2500) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [10/24] time 0.359 (0.443) data 0.228 (0.312) loss_x loss_x 1.3701 (1.3268) acc_x 62.5000 (63.4375) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [15/24] time 0.521 (0.440) data 0.390 (0.309) loss_x loss_x 0.9238 (1.2891) acc_x 75.0000 (65.4167) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/24] time 0.522 (0.462) data 0.390 (0.331) loss_x loss_x 1.0195 (1.2770) acc_x 68.7500 (65.7812) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.2628, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 824
clean true:816
clean false:8
clean_rate:0.9902912621359223
noisy true:667
noisy false:1645
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 2312
epoch [89/200] batch [5/25] time 0.508 (0.488) data 0.377 (0.356) loss_x loss_x 1.0674 (1.1796) acc_x 78.1250 (70.0000) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/25] time 0.559 (0.511) data 0.428 (0.379) loss_x loss_x 1.1875 (1.2139) acc_x 78.1250 (70.6250) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [15/25] time 0.516 (0.498) data 0.385 (0.367) loss_x loss_x 1.4541 (1.1987) acc_x 62.5000 (70.2083) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [20/25] time 0.470 (0.503) data 0.339 (0.371) loss_x loss_x 1.2324 (1.2225) acc_x 62.5000 (69.2188) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/25] time 0.612 (0.500) data 0.481 (0.368) loss_x loss_x 1.1006 (1.2099) acc_x 78.1250 (69.5000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.2522, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 791
clean true:781
clean false:10
clean_rate:0.9873577749683944
noisy true:689
noisy false:1656
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 2345
epoch [90/200] batch [5/24] time 0.573 (0.457) data 0.442 (0.325) loss_x loss_x 1.4434 (1.3984) acc_x 68.7500 (67.5000) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [10/24] time 0.485 (0.459) data 0.353 (0.328) loss_x loss_x 1.3496 (1.3595) acc_x 68.7500 (67.5000) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [15/24] time 0.497 (0.467) data 0.366 (0.336) loss_x loss_x 1.4082 (1.3514) acc_x 62.5000 (67.2917) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [20/24] time 0.517 (0.463) data 0.386 (0.332) loss_x loss_x 1.1553 (1.3699) acc_x 65.6250 (66.4062) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.2497, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 783
clean true:776
clean false:7
clean_rate:0.9910600255427842
noisy true:658
noisy false:1695
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 2353
epoch [91/200] batch [5/24] time 0.494 (0.472) data 0.364 (0.341) loss_x loss_x 1.8711 (1.3033) acc_x 68.7500 (72.5000) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [10/24] time 0.564 (0.460) data 0.434 (0.329) loss_x loss_x 1.1709 (1.3280) acc_x 75.0000 (68.7500) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [15/24] time 0.535 (0.456) data 0.404 (0.325) loss_x loss_x 1.0078 (1.2438) acc_x 71.8750 (70.4167) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [20/24] time 0.405 (0.455) data 0.273 (0.324) loss_x loss_x 0.8745 (1.2530) acc_x 78.1250 (69.6875) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1712
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 782
clean true:775
clean false:7
clean_rate:0.9910485933503836
noisy true:649
noisy false:1705
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 2354
epoch [92/200] batch [5/24] time 0.502 (0.443) data 0.371 (0.312) loss_x loss_x 1.2988 (1.2657) acc_x 59.3750 (68.7500) lr 1.1564e-03 eta 0:00:08
epoch [92/200] batch [10/24] time 0.393 (0.454) data 0.262 (0.324) loss_x loss_x 1.1387 (1.2700) acc_x 78.1250 (68.1250) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [15/24] time 0.415 (0.471) data 0.284 (0.340) loss_x loss_x 1.6963 (1.3041) acc_x 65.6250 (66.6667) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [20/24] time 0.365 (0.466) data 0.234 (0.335) loss_x loss_x 0.7891 (1.2843) acc_x 75.0000 (67.5000) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2541, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 797
clean true:788
clean false:9
clean_rate:0.9887076537013801
noisy true:671
noisy false:1668
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 2339
epoch [93/200] batch [5/24] time 0.405 (0.489) data 0.274 (0.357) loss_x loss_x 0.7217 (1.1533) acc_x 75.0000 (68.7500) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [10/24] time 0.449 (0.478) data 0.319 (0.347) loss_x loss_x 0.8101 (1.1458) acc_x 75.0000 (69.3750) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [15/24] time 0.374 (0.470) data 0.242 (0.339) loss_x loss_x 1.2998 (1.2550) acc_x 65.6250 (67.7083) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [20/24] time 0.490 (0.471) data 0.359 (0.340) loss_x loss_x 1.8955 (1.2821) acc_x 53.1250 (68.1250) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 788
clean true:778
clean false:10
clean_rate:0.9873096446700508
noisy true:663
noisy false:1685
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 2348
epoch [94/200] batch [5/24] time 0.360 (0.468) data 0.229 (0.337) loss_x loss_x 1.6768 (1.1504) acc_x 62.5000 (73.7500) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [10/24] time 0.508 (0.488) data 0.377 (0.357) loss_x loss_x 1.1504 (1.1918) acc_x 75.0000 (72.1875) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [15/24] time 0.605 (0.494) data 0.475 (0.363) loss_x loss_x 1.1758 (1.2773) acc_x 68.7500 (70.8333) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [20/24] time 0.466 (0.485) data 0.336 (0.354) loss_x loss_x 1.0566 (1.3056) acc_x 71.8750 (69.8438) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1654
confident_label rate tensor(0.2564, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 804
clean true:796
clean false:8
clean_rate:0.9900497512437811
noisy true:686
noisy false:1646
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 2332
epoch [95/200] batch [5/25] time 0.480 (0.555) data 0.349 (0.423) loss_x loss_x 0.9590 (1.4096) acc_x 71.8750 (63.1250) lr 1.1097e-03 eta 0:00:11
epoch [95/200] batch [10/25] time 0.719 (0.546) data 0.589 (0.415) loss_x loss_x 1.2568 (1.4082) acc_x 68.7500 (65.0000) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [15/25] time 0.482 (0.533) data 0.351 (0.402) loss_x loss_x 1.4033 (1.4106) acc_x 68.7500 (65.4167) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [20/25] time 0.538 (0.517) data 0.408 (0.386) loss_x loss_x 1.3906 (1.3537) acc_x 65.6250 (66.7188) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/25] time 0.469 (0.500) data 0.337 (0.369) loss_x loss_x 1.6240 (1.3558) acc_x 62.5000 (67.0000) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1676
confident_label rate tensor(0.2465, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 773
clean true:767
clean false:6
clean_rate:0.9922380336351876
noisy true:693
noisy false:1670
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 2363
epoch [96/200] batch [5/24] time 0.712 (0.538) data 0.580 (0.406) loss_x loss_x 1.1973 (1.2914) acc_x 75.0000 (65.6250) lr 1.0941e-03 eta 0:00:10
epoch [96/200] batch [10/24] time 0.707 (0.529) data 0.576 (0.397) loss_x loss_x 0.9155 (1.2286) acc_x 68.7500 (67.5000) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/24] time 0.412 (0.494) data 0.282 (0.363) loss_x loss_x 1.0635 (1.2454) acc_x 75.0000 (67.7083) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [20/24] time 0.373 (0.475) data 0.242 (0.344) loss_x loss_x 1.0986 (1.2279) acc_x 71.8750 (68.5938) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:806
clean false:6
clean_rate:0.9926108374384236
noisy true:656
noisy false:1668
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [97/200] batch [5/25] time 0.468 (0.504) data 0.338 (0.373) loss_x loss_x 1.2979 (1.2251) acc_x 75.0000 (68.7500) lr 1.0785e-03 eta 0:00:10
epoch [97/200] batch [10/25] time 0.408 (0.466) data 0.278 (0.335) loss_x loss_x 1.0693 (1.2921) acc_x 81.2500 (68.4375) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [15/25] time 0.396 (0.450) data 0.265 (0.319) loss_x loss_x 1.4795 (1.2926) acc_x 68.7500 (68.3333) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [20/25] time 0.418 (0.460) data 0.286 (0.329) loss_x loss_x 1.0205 (1.3016) acc_x 71.8750 (67.9688) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/25] time 0.497 (0.471) data 0.365 (0.339) loss_x loss_x 0.9521 (1.2976) acc_x 78.1250 (67.3750) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1690
confident_label rate tensor(0.2468, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 774
clean true:768
clean false:6
clean_rate:0.9922480620155039
noisy true:678
noisy false:1684
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 2362
epoch [98/200] batch [5/24] time 0.348 (0.481) data 0.216 (0.351) loss_x loss_x 1.2998 (1.1264) acc_x 65.6250 (70.6250) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [10/24] time 0.469 (0.472) data 0.338 (0.341) loss_x loss_x 1.2451 (1.2193) acc_x 65.6250 (69.0625) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [15/24] time 0.482 (0.475) data 0.351 (0.344) loss_x loss_x 0.8232 (1.1801) acc_x 81.2500 (70.0000) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [20/24] time 0.583 (0.480) data 0.453 (0.349) loss_x loss_x 1.3770 (1.2102) acc_x 65.6250 (69.2188) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:803
clean false:9
clean_rate:0.9889162561576355
noisy true:668
noisy false:1656
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [99/200] batch [5/25] time 0.389 (0.465) data 0.257 (0.334) loss_x loss_x 1.8330 (1.7152) acc_x 50.0000 (60.0000) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/25] time 0.504 (0.444) data 0.374 (0.313) loss_x loss_x 1.4707 (1.5592) acc_x 62.5000 (62.8125) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [15/25] time 0.690 (0.463) data 0.558 (0.331) loss_x loss_x 1.6611 (1.5035) acc_x 65.6250 (63.7500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [20/25] time 0.482 (0.460) data 0.351 (0.329) loss_x loss_x 1.0459 (1.3974) acc_x 68.7500 (65.3125) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/25] time 0.414 (0.454) data 0.283 (0.322) loss_x loss_x 1.0332 (1.3639) acc_x 78.1250 (66.6250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 782
clean true:774
clean false:8
clean_rate:0.989769820971867
noisy true:670
noisy false:1684
all clean rate:  [0.9737704918032787, 0.973404255319149, 0.9898819561551433, 0.9952978056426333, 0.9863429438543247, 0.9893129770992366, 0.986784140969163, 0.9909365558912386, 0.9882525697503671, 0.9908256880733946, 0.9915966386554622, 0.9928057553956835, 0.9907550077041603, 0.9896907216494846, 0.9955489614243324, 0.9850968703427719, 0.9855699855699855, 0.9900426742532006, 0.9912280701754386, 0.9881129271916791, 0.985632183908046, 0.9902912621359223, 0.99002849002849, 0.9945872801082544, 0.9901960784313726, 0.9899425287356322, 0.9959623149394348, 0.985632183908046, 0.9928057553956835, 0.9903047091412742, 0.9886685552407932, 0.9902642559109874, 0.9942446043165467, 0.9902642559109874, 0.9958333333333333, 0.9875518672199171, 0.9901547116736991, 0.9878378378378379, 0.9890710382513661, 0.9928977272727273, 0.9886201991465149, 0.9890859481582538, 0.9947368421052631, 0.9959183673469387, 0.9930747922437673, 0.9884615384615385, 0.9958677685950413, 0.9920634920634921, 0.9868247694334651, 0.9891304347826086, 0.9946308724832215, 0.989159891598916, 0.9875690607734806, 0.9894179894179894, 0.9959294436906377, 0.9960732984293194, 0.9879194630872483, 0.990909090909091, 0.9905405405405405, 0.9923371647509579, 0.9958734525447043, 0.9856396866840731, 0.990990990990991, 0.9880636604774535, 0.9933598937583001, 0.9896238651102465, 0.98989898989899, 0.9875776397515528, 0.9960474308300395, 0.990086741016109, 0.9896507115135834, 0.9960988296488946, 0.9895287958115183, 0.9933065595716198, 0.9872611464968153, 0.990990990990991, 0.9960159362549801, 0.9893475366178429, 0.9887640449438202, 0.9987029831387808, 0.992619926199262, 0.9896774193548387, 0.9878197320341048, 0.988031914893617, 0.9872448979591837, 0.9859872611464968, 0.9913686806411838, 0.9949044585987261, 0.9902912621359223, 0.9873577749683944, 0.9910600255427842, 0.9910485933503836, 0.9887076537013801, 0.9873096446700508, 0.9900497512437811, 0.9922380336351876, 0.9926108374384236, 0.9922480620155039, 0.9889162561576355, 0.989769820971867]
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 2354
epoch [100/200] batch [5/24] time 0.580 (0.538) data 0.450 (0.408) loss_x loss_x 1.1162 (1.1376) acc_x 65.6250 (68.1250) lr 1.0314e-03 eta 0:00:10
epoch [100/200] batch [10/24] time 0.518 (0.497) data 0.387 (0.367) loss_x loss_x 0.9268 (1.1458) acc_x 68.7500 (69.3750) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [15/24] time 0.463 (0.486) data 0.332 (0.355) loss_x loss_x 1.4287 (1.2262) acc_x 68.7500 (67.5000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [20/24] time 0.619 (0.482) data 0.488 (0.352) loss_x loss_x 1.5205 (1.2179) acc_x 65.6250 (68.5938) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:777
clean false:8
clean_rate:0.9898089171974522
noisy true:659
noisy false:1692
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [101/200] batch [5/24] time 0.531 (0.505) data 0.399 (0.373) loss_x loss_x 1.4824 (1.2859) acc_x 62.5000 (70.6250) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [10/24] time 0.381 (0.471) data 0.249 (0.339) loss_x loss_x 1.1611 (1.2344) acc_x 75.0000 (71.8750) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [15/24] time 0.450 (0.451) data 0.319 (0.320) loss_x loss_x 1.3770 (1.2094) acc_x 59.3750 (70.4167) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [20/24] time 0.489 (0.470) data 0.358 (0.339) loss_x loss_x 1.8662 (1.2405) acc_x 59.3750 (70.9375) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.2599, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 815
clean true:808
clean false:7
clean_rate:0.9914110429447853
noisy true:654
noisy false:1667
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 2321
epoch [102/200] batch [5/25] time 0.718 (0.528) data 0.587 (0.397) loss_x loss_x 1.2100 (1.1851) acc_x 65.6250 (70.6250) lr 1.0000e-03 eta 0:00:10
epoch [102/200] batch [10/25] time 0.558 (0.510) data 0.426 (0.378) loss_x loss_x 1.5918 (1.3745) acc_x 59.3750 (64.6875) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [15/25] time 0.458 (0.535) data 0.327 (0.403) loss_x loss_x 1.4150 (1.4299) acc_x 62.5000 (62.7083) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [20/25] time 0.458 (0.509) data 0.328 (0.378) loss_x loss_x 1.3516 (1.4000) acc_x 62.5000 (63.4375) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/25] time 0.384 (0.504) data 0.253 (0.372) loss_x loss_x 0.9648 (1.3443) acc_x 78.1250 (65.3750) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1654
confident_label rate tensor(0.2596, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 814
clean true:809
clean false:5
clean_rate:0.9938574938574939
noisy true:673
noisy false:1649
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 2322
epoch [103/200] batch [5/25] time 0.605 (0.487) data 0.474 (0.356) loss_x loss_x 1.7949 (1.4312) acc_x 56.2500 (65.0000) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [10/25] time 0.527 (0.466) data 0.397 (0.335) loss_x loss_x 1.1152 (1.2910) acc_x 68.7500 (67.1875) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [15/25] time 0.476 (0.475) data 0.345 (0.345) loss_x loss_x 0.8340 (1.2015) acc_x 78.1250 (69.3750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [20/25] time 0.541 (0.472) data 0.410 (0.341) loss_x loss_x 1.4375 (1.2840) acc_x 62.5000 (68.5938) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/25] time 0.505 (0.466) data 0.374 (0.336) loss_x loss_x 1.2002 (1.2908) acc_x 65.6250 (68.6250) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1628
confident_label rate tensor(0.2564, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 804
clean true:797
clean false:7
clean_rate:0.9912935323383084
noisy true:711
noisy false:1621
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 2332
epoch [104/200] batch [5/25] time 0.395 (0.501) data 0.264 (0.370) loss_x loss_x 1.3496 (1.3281) acc_x 65.6250 (65.6250) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [10/25] time 0.451 (0.475) data 0.321 (0.344) loss_x loss_x 0.9111 (1.2041) acc_x 81.2500 (69.6875) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/25] time 0.534 (0.472) data 0.404 (0.341) loss_x loss_x 1.6406 (1.2649) acc_x 53.1250 (67.5000) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [20/25] time 0.528 (0.475) data 0.398 (0.344) loss_x loss_x 1.3877 (1.3252) acc_x 56.2500 (66.7188) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/25] time 0.467 (0.471) data 0.337 (0.341) loss_x loss_x 1.3086 (1.3454) acc_x 56.2500 (64.8750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1678
confident_label rate tensor(0.2468, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 774
clean true:770
clean false:4
clean_rate:0.9948320413436692
noisy true:688
noisy false:1674
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 2362
epoch [105/200] batch [5/24] time 0.429 (0.510) data 0.298 (0.377) loss_x loss_x 1.4814 (1.3131) acc_x 62.5000 (65.6250) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [10/24] time 0.780 (0.516) data 0.648 (0.384) loss_x loss_x 1.0430 (1.2876) acc_x 75.0000 (66.5625) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/24] time 0.545 (0.503) data 0.415 (0.371) loss_x loss_x 0.8667 (1.3289) acc_x 75.0000 (66.0417) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [20/24] time 0.589 (0.495) data 0.458 (0.363) loss_x loss_x 1.5244 (1.3337) acc_x 62.5000 (65.6250) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1648
confident_label rate tensor(0.2596, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 814
clean true:807
clean false:7
clean_rate:0.9914004914004914
noisy true:681
noisy false:1641
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 2322
epoch [106/200] batch [5/25] time 0.442 (0.505) data 0.311 (0.374) loss_x loss_x 1.0840 (1.4313) acc_x 71.8750 (68.1250) lr 9.3721e-04 eta 0:00:10
epoch [106/200] batch [10/25] time 0.561 (0.485) data 0.429 (0.354) loss_x loss_x 1.2051 (1.2688) acc_x 59.3750 (67.8125) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [15/25] time 0.541 (0.500) data 0.411 (0.369) loss_x loss_x 1.0527 (1.2786) acc_x 71.8750 (67.7083) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [20/25] time 0.512 (0.496) data 0.381 (0.365) loss_x loss_x 1.6729 (1.3441) acc_x 65.6250 (66.5625) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/25] time 0.426 (0.499) data 0.295 (0.368) loss_x loss_x 1.3867 (1.3275) acc_x 62.5000 (66.8750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.2628, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 824
clean true:818
clean false:6
clean_rate:0.9927184466019418
noisy true:698
noisy false:1614
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 2312
epoch [107/200] batch [5/25] time 0.448 (0.464) data 0.317 (0.333) loss_x loss_x 1.4922 (1.2275) acc_x 59.3750 (70.0000) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [10/25] time 0.507 (0.469) data 0.376 (0.338) loss_x loss_x 1.1846 (1.2557) acc_x 75.0000 (70.3125) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/25] time 0.442 (0.467) data 0.311 (0.336) loss_x loss_x 1.0186 (1.2346) acc_x 71.8750 (70.0000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [20/25] time 0.530 (0.461) data 0.399 (0.330) loss_x loss_x 1.1465 (1.2834) acc_x 65.6250 (67.6562) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/25] time 0.475 (0.465) data 0.344 (0.334) loss_x loss_x 0.8975 (1.2567) acc_x 71.8750 (67.7500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 811
clean true:801
clean false:10
clean_rate:0.9876695437731196
noisy true:685
noisy false:1640
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 2325
epoch [108/200] batch [5/25] time 0.426 (0.487) data 0.295 (0.356) loss_x loss_x 1.1895 (1.4205) acc_x 65.6250 (67.5000) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/25] time 0.506 (0.483) data 0.374 (0.351) loss_x loss_x 1.7168 (1.3502) acc_x 68.7500 (67.5000) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/25] time 0.435 (0.472) data 0.304 (0.341) loss_x loss_x 0.8384 (1.2697) acc_x 75.0000 (69.3750) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [20/25] time 0.459 (0.463) data 0.328 (0.332) loss_x loss_x 1.7949 (1.2574) acc_x 62.5000 (69.5312) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/25] time 0.487 (0.460) data 0.356 (0.329) loss_x loss_x 2.0859 (1.2644) acc_x 50.0000 (69.2500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1714
confident_label rate tensor(0.2548, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 799
clean true:790
clean false:9
clean_rate:0.9887359198998749
noisy true:632
noisy false:1705
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 2337
epoch [109/200] batch [5/24] time 0.641 (0.524) data 0.510 (0.392) loss_x loss_x 1.0146 (1.2688) acc_x 78.1250 (71.2500) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [10/24] time 0.418 (0.476) data 0.286 (0.345) loss_x loss_x 1.2480 (1.2971) acc_x 68.7500 (69.3750) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [15/24] time 0.497 (0.468) data 0.366 (0.337) loss_x loss_x 1.5293 (1.4101) acc_x 71.8750 (67.7083) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [20/24] time 0.481 (0.476) data 0.351 (0.345) loss_x loss_x 1.4316 (1.4011) acc_x 68.7500 (68.1250) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1689
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 780
clean true:775
clean false:5
clean_rate:0.9935897435897436
noisy true:672
noisy false:1684
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 2356
epoch [110/200] batch [5/24] time 0.479 (0.507) data 0.348 (0.376) loss_x loss_x 1.3252 (1.3791) acc_x 71.8750 (66.2500) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [10/24] time 0.513 (0.501) data 0.381 (0.369) loss_x loss_x 1.0352 (1.2947) acc_x 78.1250 (68.7500) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [15/24] time 0.453 (0.487) data 0.321 (0.356) loss_x loss_x 1.0410 (1.2878) acc_x 75.0000 (69.1667) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [20/24] time 0.443 (0.496) data 0.311 (0.365) loss_x loss_x 1.1768 (1.2767) acc_x 75.0000 (69.5312) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1694
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:773
clean false:12
clean_rate:0.9847133757961783
noisy true:669
noisy false:1682
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [111/200] batch [5/24] time 0.566 (0.553) data 0.434 (0.421) loss_x loss_x 1.0146 (1.3289) acc_x 71.8750 (65.0000) lr 8.5910e-04 eta 0:00:10
epoch [111/200] batch [10/24] time 0.449 (0.495) data 0.318 (0.364) loss_x loss_x 1.5791 (1.2978) acc_x 68.7500 (67.5000) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [15/24] time 0.485 (0.490) data 0.354 (0.358) loss_x loss_x 1.6855 (1.4196) acc_x 46.8750 (64.5833) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [20/24] time 0.495 (0.469) data 0.364 (0.338) loss_x loss_x 1.1572 (1.3978) acc_x 75.0000 (64.6875) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 788
clean true:780
clean false:8
clean_rate:0.9898477157360406
noisy true:660
noisy false:1688
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 2348
epoch [112/200] batch [5/24] time 0.481 (0.459) data 0.351 (0.329) loss_x loss_x 1.6572 (1.2630) acc_x 46.8750 (68.7500) lr 8.4357e-04 eta 0:00:08
epoch [112/200] batch [10/24] time 0.883 (0.501) data 0.747 (0.370) loss_x loss_x 1.2637 (1.2373) acc_x 68.7500 (68.4375) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/24] time 0.453 (0.517) data 0.322 (0.386) loss_x loss_x 0.9658 (1.1701) acc_x 81.2500 (70.0000) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [20/24] time 0.498 (0.504) data 0.367 (0.373) loss_x loss_x 1.2959 (1.1685) acc_x 68.7500 (70.1562) lr 8.4357e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:802
clean false:10
clean_rate:0.9876847290640394
noisy true:700
noisy false:1624
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [113/200] batch [5/25] time 0.413 (0.444) data 0.281 (0.313) loss_x loss_x 1.3760 (1.2660) acc_x 75.0000 (71.8750) lr 8.2807e-04 eta 0:00:08
epoch [113/200] batch [10/25] time 0.612 (0.467) data 0.482 (0.336) loss_x loss_x 1.8574 (1.4167) acc_x 62.5000 (67.5000) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [15/25] time 0.441 (0.454) data 0.310 (0.323) loss_x loss_x 1.4326 (1.3822) acc_x 75.0000 (67.9167) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [20/25] time 0.639 (0.470) data 0.508 (0.339) loss_x loss_x 1.5420 (1.3760) acc_x 62.5000 (67.1875) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/25] time 0.436 (0.465) data 0.305 (0.334) loss_x loss_x 1.0449 (1.3505) acc_x 65.6250 (67.6250) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2516, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 789
clean true:781
clean false:8
clean_rate:0.9898605830164765
noisy true:659
noisy false:1688
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 2347
epoch [114/200] batch [5/24] time 0.334 (0.407) data 0.203 (0.276) loss_x loss_x 1.2480 (1.3584) acc_x 68.7500 (68.1250) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [10/24] time 0.520 (0.465) data 0.389 (0.334) loss_x loss_x 1.5850 (1.3133) acc_x 62.5000 (69.6875) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [15/24] time 0.460 (0.465) data 0.328 (0.334) loss_x loss_x 0.9399 (1.3272) acc_x 75.0000 (68.1250) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [20/24] time 0.430 (0.474) data 0.299 (0.343) loss_x loss_x 1.2383 (1.2988) acc_x 78.1250 (69.2188) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1662
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 805
clean true:799
clean false:6
clean_rate:0.9925465838509316
noisy true:675
noisy false:1656
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 2331
epoch [115/200] batch [5/25] time 0.669 (0.563) data 0.537 (0.431) loss_x loss_x 1.2031 (1.4865) acc_x 71.8750 (65.6250) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [10/25] time 0.409 (0.515) data 0.279 (0.384) loss_x loss_x 1.1074 (1.4215) acc_x 71.8750 (67.8125) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [15/25] time 0.492 (0.495) data 0.362 (0.363) loss_x loss_x 1.4307 (1.4128) acc_x 68.7500 (68.1250) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [20/25] time 0.597 (0.502) data 0.466 (0.371) loss_x loss_x 1.0566 (1.3778) acc_x 68.7500 (68.4375) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/25] time 0.747 (0.507) data 0.616 (0.376) loss_x loss_x 0.9814 (1.3222) acc_x 78.1250 (69.2500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.2554, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 801
clean true:793
clean false:8
clean_rate:0.9900124843945068
noisy true:694
noisy false:1641
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 2335
epoch [116/200] batch [5/25] time 0.383 (0.467) data 0.252 (0.335) loss_x loss_x 1.0508 (1.2172) acc_x 68.7500 (64.3750) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [10/25] time 0.409 (0.455) data 0.278 (0.324) loss_x loss_x 0.8193 (1.2331) acc_x 84.3750 (66.5625) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [15/25] time 0.575 (0.454) data 0.445 (0.323) loss_x loss_x 1.0078 (1.2050) acc_x 68.7500 (68.7500) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [20/25] time 0.513 (0.463) data 0.382 (0.332) loss_x loss_x 1.3018 (1.1605) acc_x 65.6250 (69.8438) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/25] time 0.431 (0.463) data 0.298 (0.333) loss_x loss_x 1.5078 (1.1765) acc_x 59.3750 (69.3750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.2468, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 774
clean true:769
clean false:5
clean_rate:0.9935400516795866
noisy true:680
noisy false:1682
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 2362
epoch [117/200] batch [5/24] time 0.581 (0.484) data 0.449 (0.353) loss_x loss_x 0.8462 (1.4240) acc_x 78.1250 (67.5000) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [10/24] time 0.367 (0.468) data 0.236 (0.336) loss_x loss_x 1.1670 (1.2556) acc_x 71.8750 (69.6875) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [15/24] time 0.377 (0.462) data 0.246 (0.331) loss_x loss_x 1.2344 (1.2541) acc_x 81.2500 (70.0000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [20/24] time 0.416 (0.462) data 0.286 (0.331) loss_x loss_x 1.3076 (1.2299) acc_x 71.8750 (70.3125) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2653, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 832
clean true:822
clean false:10
clean_rate:0.9879807692307693
noisy true:654
noisy false:1650
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 2304
epoch [118/200] batch [5/26] time 0.565 (0.490) data 0.433 (0.359) loss_x loss_x 1.3154 (1.1149) acc_x 59.3750 (69.3750) lr 7.5131e-04 eta 0:00:10
epoch [118/200] batch [10/26] time 0.388 (0.477) data 0.257 (0.346) loss_x loss_x 1.2207 (1.1744) acc_x 65.6250 (69.0625) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [15/26] time 0.386 (0.476) data 0.256 (0.345) loss_x loss_x 1.4482 (1.2337) acc_x 65.6250 (68.5417) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [20/26] time 0.421 (0.479) data 0.290 (0.347) loss_x loss_x 1.5107 (1.2228) acc_x 71.8750 (69.3750) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/26] time 0.536 (0.480) data 0.404 (0.348) loss_x loss_x 1.9189 (1.2494) acc_x 65.6250 (69.5000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1615
confident_label rate tensor(0.2628, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 824
clean true:818
clean false:6
clean_rate:0.9927184466019418
noisy true:703
noisy false:1609
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 2312
epoch [119/200] batch [5/25] time 0.468 (0.500) data 0.337 (0.369) loss_x loss_x 1.2529 (1.1701) acc_x 75.0000 (70.6250) lr 7.3613e-04 eta 0:00:10
epoch [119/200] batch [10/25] time 0.482 (0.481) data 0.351 (0.350) loss_x loss_x 1.5283 (1.3316) acc_x 59.3750 (67.8125) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [15/25] time 0.413 (0.479) data 0.281 (0.347) loss_x loss_x 1.1162 (1.2812) acc_x 71.8750 (67.5000) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/25] time 0.542 (0.485) data 0.411 (0.354) loss_x loss_x 1.6670 (1.3171) acc_x 68.7500 (67.3438) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/25] time 0.518 (0.482) data 0.387 (0.351) loss_x loss_x 1.0391 (1.2934) acc_x 78.1250 (67.2500) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.2408, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 755
clean true:748
clean false:7
clean_rate:0.990728476821192
noisy true:703
noisy false:1678
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 2381
epoch [120/200] batch [5/23] time 0.453 (0.470) data 0.322 (0.338) loss_x loss_x 1.4580 (1.3768) acc_x 65.6250 (66.8750) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [10/23] time 0.490 (0.454) data 0.359 (0.322) loss_x loss_x 1.1367 (1.2685) acc_x 75.0000 (68.4375) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/23] time 0.404 (0.457) data 0.274 (0.326) loss_x loss_x 1.0078 (1.2788) acc_x 78.1250 (68.9583) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/23] time 0.524 (0.461) data 0.392 (0.330) loss_x loss_x 1.6406 (1.2995) acc_x 62.5000 (69.2188) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.2522, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 791
clean true:784
clean false:7
clean_rate:0.9911504424778761
noisy true:705
noisy false:1640
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 2345
epoch [121/200] batch [5/24] time 0.566 (0.493) data 0.430 (0.360) loss_x loss_x 1.5352 (1.2328) acc_x 62.5000 (68.7500) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [10/24] time 0.425 (0.489) data 0.293 (0.357) loss_x loss_x 1.0928 (1.2815) acc_x 71.8750 (67.8125) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [15/24] time 0.483 (0.496) data 0.352 (0.364) loss_x loss_x 0.8628 (1.2501) acc_x 84.3750 (68.1250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [20/24] time 0.400 (0.489) data 0.269 (0.357) loss_x loss_x 1.4326 (1.2332) acc_x 65.6250 (68.4375) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.2548, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 799
clean true:793
clean false:6
clean_rate:0.9924906132665833
noisy true:707
noisy false:1630
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 2337
epoch [122/200] batch [5/24] time 0.569 (0.525) data 0.438 (0.394) loss_x loss_x 0.9600 (1.1781) acc_x 71.8750 (65.6250) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [10/24] time 0.465 (0.503) data 0.334 (0.373) loss_x loss_x 1.6270 (1.2541) acc_x 65.6250 (67.8125) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [15/24] time 0.494 (0.488) data 0.363 (0.357) loss_x loss_x 0.8740 (1.2670) acc_x 75.0000 (69.1667) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [20/24] time 0.581 (0.491) data 0.450 (0.360) loss_x loss_x 0.6655 (1.2285) acc_x 87.5000 (70.0000) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1642
confident_label rate tensor(0.2541, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 797
clean true:792
clean false:5
clean_rate:0.9937264742785445
noisy true:702
noisy false:1637
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 2339
epoch [123/200] batch [5/24] time 0.560 (0.480) data 0.429 (0.349) loss_x loss_x 0.9404 (1.1561) acc_x 78.1250 (71.2500) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [10/24] time 0.545 (0.472) data 0.414 (0.341) loss_x loss_x 1.2627 (1.1965) acc_x 68.7500 (68.7500) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [15/24] time 0.396 (0.466) data 0.264 (0.335) loss_x loss_x 1.9678 (1.3139) acc_x 56.2500 (67.2917) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [20/24] time 0.433 (0.457) data 0.302 (0.326) loss_x loss_x 0.9341 (1.2401) acc_x 81.2500 (69.6875) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 809
clean true:801
clean false:8
clean_rate:0.9901112484548825
noisy true:678
noisy false:1649
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 2327
epoch [124/200] batch [5/25] time 0.572 (0.524) data 0.441 (0.392) loss_x loss_x 1.1357 (1.1793) acc_x 75.0000 (71.8750) lr 6.6126e-04 eta 0:00:10
epoch [124/200] batch [10/25] time 0.417 (0.468) data 0.286 (0.337) loss_x loss_x 0.6885 (1.2072) acc_x 87.5000 (72.5000) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [15/25] time 0.497 (0.473) data 0.366 (0.342) loss_x loss_x 0.7773 (1.1330) acc_x 75.0000 (73.7500) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [20/25] time 0.416 (0.466) data 0.284 (0.335) loss_x loss_x 1.1318 (1.1837) acc_x 75.0000 (72.8125) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/25] time 0.536 (0.468) data 0.404 (0.336) loss_x loss_x 1.7080 (1.1953) acc_x 62.5000 (71.8750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.2532, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 794
clean true:787
clean false:7
clean_rate:0.9911838790931989
noisy true:683
noisy false:1659
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 2342
epoch [125/200] batch [5/24] time 0.545 (0.542) data 0.414 (0.411) loss_x loss_x 1.4531 (1.3135) acc_x 65.6250 (66.8750) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [10/24] time 0.526 (0.507) data 0.395 (0.376) loss_x loss_x 1.0898 (1.2544) acc_x 65.6250 (66.8750) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/24] time 0.435 (0.497) data 0.304 (0.365) loss_x loss_x 1.3857 (1.1743) acc_x 62.5000 (68.7500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [20/24] time 0.407 (0.482) data 0.276 (0.351) loss_x loss_x 1.4121 (1.1931) acc_x 65.6250 (69.3750) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2535, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 795
clean true:788
clean false:7
clean_rate:0.9911949685534591
noisy true:711
noisy false:1630
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 2341
epoch [126/200] batch [5/24] time 0.559 (0.550) data 0.428 (0.419) loss_x loss_x 1.1309 (1.1240) acc_x 71.8750 (70.6250) lr 6.3188e-04 eta 0:00:10
epoch [126/200] batch [10/24] time 0.498 (0.497) data 0.367 (0.366) loss_x loss_x 1.2568 (1.1646) acc_x 71.8750 (70.9375) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [15/24] time 0.428 (0.480) data 0.297 (0.349) loss_x loss_x 1.5146 (1.1905) acc_x 62.5000 (71.2500) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [20/24] time 0.403 (0.488) data 0.272 (0.357) loss_x loss_x 0.9214 (1.2048) acc_x 75.0000 (70.0000) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.2532, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 794
clean true:788
clean false:6
clean_rate:0.9924433249370277
noisy true:683
noisy false:1659
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 2342
epoch [127/200] batch [5/24] time 0.573 (0.511) data 0.441 (0.379) loss_x loss_x 0.8911 (1.1390) acc_x 75.0000 (70.0000) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [10/24] time 0.498 (0.497) data 0.367 (0.366) loss_x loss_x 0.9351 (1.1729) acc_x 75.0000 (68.1250) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [15/24] time 0.459 (0.503) data 0.327 (0.372) loss_x loss_x 1.1182 (1.1045) acc_x 75.0000 (71.6667) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [20/24] time 0.442 (0.503) data 0.310 (0.372) loss_x loss_x 0.9062 (1.1158) acc_x 75.0000 (71.0938) lr 6.1732e-04 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2612, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 819
clean true:812
clean false:7
clean_rate:0.9914529914529915
noisy true:684
noisy false:1633
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 2317
epoch [128/200] batch [5/25] time 0.590 (0.483) data 0.459 (0.352) loss_x loss_x 1.2188 (1.2229) acc_x 71.8750 (67.5000) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [10/25] time 0.477 (0.485) data 0.346 (0.353) loss_x loss_x 1.5762 (1.3353) acc_x 62.5000 (66.5625) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [15/25] time 0.480 (0.511) data 0.349 (0.379) loss_x loss_x 1.2705 (1.2900) acc_x 68.7500 (66.8750) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [20/25] time 0.430 (0.489) data 0.299 (0.357) loss_x loss_x 1.7109 (1.3170) acc_x 65.6250 (65.7812) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/25] time 0.518 (0.498) data 0.387 (0.367) loss_x loss_x 1.4336 (1.2919) acc_x 65.6250 (66.6250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1618
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 809
clean true:804
clean false:5
clean_rate:0.9938195302843016
noisy true:714
noisy false:1613
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 2327
epoch [129/200] batch [5/25] time 0.408 (0.447) data 0.277 (0.316) loss_x loss_x 1.6582 (1.3727) acc_x 56.2500 (62.5000) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/25] time 0.397 (0.451) data 0.266 (0.320) loss_x loss_x 0.8770 (1.1983) acc_x 75.0000 (66.2500) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [15/25] time 0.468 (0.456) data 0.336 (0.325) loss_x loss_x 1.3271 (1.2048) acc_x 68.7500 (68.3333) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [20/25] time 0.443 (0.447) data 0.312 (0.316) loss_x loss_x 0.7778 (1.1929) acc_x 81.2500 (69.0625) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/25] time 0.454 (0.458) data 0.323 (0.327) loss_x loss_x 1.0547 (1.2175) acc_x 65.6250 (68.2500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:820
clean false:7
clean_rate:0.9915356711003628
noisy true:670
noisy false:1639
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [130/200] batch [5/25] time 0.457 (0.483) data 0.326 (0.352) loss_x loss_x 1.2812 (1.3033) acc_x 62.5000 (61.8750) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [10/25] time 0.403 (0.445) data 0.272 (0.314) loss_x loss_x 1.1963 (1.2136) acc_x 68.7500 (68.1250) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [15/25] time 0.391 (0.469) data 0.261 (0.338) loss_x loss_x 1.6133 (1.2162) acc_x 71.8750 (68.7500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/25] time 0.490 (0.471) data 0.359 (0.340) loss_x loss_x 1.5527 (1.2295) acc_x 62.5000 (68.7500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/25] time 0.514 (0.475) data 0.383 (0.344) loss_x loss_x 0.5942 (1.2121) acc_x 87.5000 (68.5000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 786
clean true:782
clean false:4
clean_rate:0.9949109414758269
noisy true:669
noisy false:1681
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 2350
epoch [131/200] batch [5/24] time 0.457 (0.466) data 0.326 (0.335) loss_x loss_x 1.7676 (1.5225) acc_x 56.2500 (65.6250) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [10/24] time 0.484 (0.478) data 0.353 (0.346) loss_x loss_x 1.1768 (1.3895) acc_x 75.0000 (66.8750) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [15/24] time 0.366 (0.462) data 0.235 (0.331) loss_x loss_x 1.1758 (1.3927) acc_x 75.0000 (66.8750) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/24] time 0.526 (0.474) data 0.395 (0.342) loss_x loss_x 0.8804 (1.3653) acc_x 78.1250 (67.6562) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1632
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 833
clean true:824
clean false:9
clean_rate:0.9891956782713085
noisy true:680
noisy false:1623
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 2303
epoch [132/200] batch [5/26] time 0.495 (0.489) data 0.364 (0.358) loss_x loss_x 1.6094 (1.5117) acc_x 62.5000 (63.1250) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [10/26] time 0.348 (0.467) data 0.218 (0.336) loss_x loss_x 1.4775 (1.3927) acc_x 65.6250 (65.3125) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [15/26] time 0.550 (0.483) data 0.419 (0.352) loss_x loss_x 1.3604 (1.3411) acc_x 81.2500 (68.7500) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [20/26] time 0.434 (0.481) data 0.303 (0.350) loss_x loss_x 1.3467 (1.3736) acc_x 71.8750 (68.2812) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/26] time 0.413 (0.483) data 0.282 (0.352) loss_x loss_x 1.2588 (1.3339) acc_x 71.8750 (69.2500) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 805
clean true:799
clean false:6
clean_rate:0.9925465838509316
noisy true:687
noisy false:1644
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 2331
epoch [133/200] batch [5/25] time 0.482 (0.531) data 0.351 (0.400) loss_x loss_x 1.3730 (1.1346) acc_x 68.7500 (75.6250) lr 5.3207e-04 eta 0:00:10
epoch [133/200] batch [10/25] time 0.515 (0.515) data 0.383 (0.384) loss_x loss_x 1.5684 (1.3062) acc_x 56.2500 (70.9375) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [15/25] time 0.483 (0.495) data 0.352 (0.364) loss_x loss_x 0.9995 (1.2300) acc_x 65.6250 (70.4167) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/25] time 0.541 (0.488) data 0.410 (0.357) loss_x loss_x 1.0205 (1.2335) acc_x 78.1250 (70.9375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/25] time 0.411 (0.477) data 0.281 (0.346) loss_x loss_x 0.9165 (1.1895) acc_x 71.8750 (71.5000) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.2577, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 808
clean true:798
clean false:10
clean_rate:0.9876237623762376
noisy true:703
noisy false:1625
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 2328
epoch [134/200] batch [5/25] time 0.622 (0.565) data 0.490 (0.432) loss_x loss_x 1.2354 (1.2186) acc_x 65.6250 (71.2500) lr 5.1825e-04 eta 0:00:11
epoch [134/200] batch [10/25] time 0.432 (0.507) data 0.302 (0.375) loss_x loss_x 1.9590 (1.2439) acc_x 50.0000 (68.7500) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [15/25] time 0.450 (0.487) data 0.319 (0.355) loss_x loss_x 0.5962 (1.2053) acc_x 84.3750 (69.3750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [20/25] time 0.449 (0.477) data 0.318 (0.345) loss_x loss_x 1.1572 (1.2030) acc_x 68.7500 (69.8438) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/25] time 0.501 (0.469) data 0.369 (0.338) loss_x loss_x 1.0996 (1.2010) acc_x 65.6250 (69.6250) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1663
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:819
clean false:8
clean_rate:0.9903264812575574
noisy true:654
noisy false:1655
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [135/200] batch [5/25] time 0.324 (0.461) data 0.192 (0.330) loss_x loss_x 1.7480 (1.1438) acc_x 53.1250 (71.8750) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [10/25] time 0.439 (0.468) data 0.308 (0.337) loss_x loss_x 1.0752 (1.1813) acc_x 78.1250 (70.3125) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/25] time 0.407 (0.490) data 0.276 (0.359) loss_x loss_x 0.9536 (1.1841) acc_x 71.8750 (69.1667) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [20/25] time 0.495 (0.488) data 0.358 (0.357) loss_x loss_x 1.4883 (1.1556) acc_x 68.7500 (70.7812) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/25] time 0.496 (0.488) data 0.365 (0.356) loss_x loss_x 1.2432 (1.2323) acc_x 62.5000 (69.5000) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.2647, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 830
clean true:822
clean false:8
clean_rate:0.9903614457831326
noisy true:691
noisy false:1615
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 2306
epoch [136/200] batch [5/25] time 0.478 (0.483) data 0.346 (0.351) loss_x loss_x 1.2148 (1.3087) acc_x 75.0000 (65.6250) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/25] time 0.436 (0.498) data 0.305 (0.367) loss_x loss_x 1.7822 (1.3242) acc_x 65.6250 (68.7500) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [15/25] time 0.442 (0.478) data 0.310 (0.346) loss_x loss_x 1.3311 (1.2596) acc_x 68.7500 (69.3750) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [20/25] time 0.484 (0.485) data 0.352 (0.353) loss_x loss_x 1.0977 (1.2387) acc_x 71.8750 (70.3125) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/25] time 0.676 (0.491) data 0.544 (0.360) loss_x loss_x 0.9556 (1.2198) acc_x 81.2500 (70.1250) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2554, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 801
clean true:797
clean false:4
clean_rate:0.9950062421972534
noisy true:679
noisy false:1656
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 2335
epoch [137/200] batch [5/25] time 0.513 (0.537) data 0.382 (0.405) loss_x loss_x 1.1807 (1.2768) acc_x 65.6250 (69.3750) lr 4.7750e-04 eta 0:00:10
epoch [137/200] batch [10/25] time 0.586 (0.515) data 0.454 (0.383) loss_x loss_x 1.6895 (1.2074) acc_x 65.6250 (72.1875) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [15/25] time 0.556 (0.487) data 0.425 (0.356) loss_x loss_x 1.0791 (1.2148) acc_x 78.1250 (71.0417) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [20/25] time 0.434 (0.480) data 0.303 (0.349) loss_x loss_x 0.9189 (1.2109) acc_x 81.2500 (70.6250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/25] time 0.430 (0.483) data 0.300 (0.352) loss_x loss_x 1.1914 (1.2237) acc_x 75.0000 (70.2500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.2691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 844
clean true:841
clean false:3
clean_rate:0.9964454976303317
noisy true:688
noisy false:1604
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 2292
epoch [138/200] batch [5/26] time 0.444 (0.499) data 0.313 (0.368) loss_x loss_x 1.4600 (1.5662) acc_x 59.3750 (57.5000) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [10/26] time 0.801 (0.518) data 0.668 (0.387) loss_x loss_x 1.0840 (1.3505) acc_x 68.7500 (64.6875) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [15/26] time 0.432 (0.500) data 0.302 (0.369) loss_x loss_x 1.3398 (1.2594) acc_x 65.6250 (67.5000) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [20/26] time 0.547 (0.497) data 0.416 (0.366) loss_x loss_x 1.5791 (1.2766) acc_x 65.6250 (67.9688) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/26] time 0.424 (0.491) data 0.293 (0.360) loss_x loss_x 0.9648 (1.2818) acc_x 68.7500 (67.8750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1632
confident_label rate tensor(0.2577, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 808
clean true:800
clean false:8
clean_rate:0.9900990099009901
noisy true:704
noisy false:1624
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 2328
epoch [139/200] batch [5/25] time 0.511 (0.447) data 0.379 (0.316) loss_x loss_x 1.0947 (1.3160) acc_x 71.8750 (68.7500) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [10/25] time 0.429 (0.458) data 0.297 (0.327) loss_x loss_x 1.1465 (1.3106) acc_x 68.7500 (65.9375) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [15/25] time 0.538 (0.453) data 0.406 (0.322) loss_x loss_x 1.5791 (1.2954) acc_x 56.2500 (66.0417) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/25] time 0.410 (0.464) data 0.279 (0.332) loss_x loss_x 0.9351 (1.2735) acc_x 62.5000 (67.5000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/25] time 0.594 (0.485) data 0.464 (0.353) loss_x loss_x 1.4219 (1.3023) acc_x 65.6250 (67.2500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1611
confident_label rate tensor(0.2602, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 816
clean true:809
clean false:7
clean_rate:0.991421568627451
noisy true:716
noisy false:1604
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 2320
epoch [140/200] batch [5/25] time 0.556 (0.537) data 0.425 (0.406) loss_x loss_x 1.1162 (1.3672) acc_x 53.1250 (63.7500) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [10/25] time 0.700 (0.519) data 0.570 (0.389) loss_x loss_x 0.5381 (1.1799) acc_x 87.5000 (70.0000) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [15/25] time 0.488 (0.501) data 0.358 (0.371) loss_x loss_x 0.9077 (1.2072) acc_x 84.3750 (71.2500) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [20/25] time 0.424 (0.484) data 0.294 (0.353) loss_x loss_x 1.4209 (1.1834) acc_x 62.5000 (71.4062) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/25] time 0.487 (0.486) data 0.356 (0.356) loss_x loss_x 0.8809 (1.2247) acc_x 75.0000 (71.1250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1645
confident_label rate tensor(0.2615, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 820
clean true:814
clean false:6
clean_rate:0.9926829268292683
noisy true:677
noisy false:1639
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 2316
epoch [141/200] batch [5/25] time 0.528 (0.456) data 0.397 (0.325) loss_x loss_x 0.7939 (1.0327) acc_x 78.1250 (71.2500) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [10/25] time 0.518 (0.474) data 0.388 (0.343) loss_x loss_x 1.0977 (1.1097) acc_x 75.0000 (71.2500) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [15/25] time 0.534 (0.473) data 0.403 (0.342) loss_x loss_x 1.3389 (1.2398) acc_x 62.5000 (68.7500) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [20/25] time 0.382 (0.463) data 0.250 (0.332) loss_x loss_x 1.4434 (1.2223) acc_x 75.0000 (69.6875) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/25] time 0.385 (0.457) data 0.254 (0.326) loss_x loss_x 1.0928 (1.2437) acc_x 84.3750 (68.6250) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2535, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 795
clean true:789
clean false:6
clean_rate:0.9924528301886792
noisy true:710
noisy false:1631
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 2341
epoch [142/200] batch [5/24] time 0.547 (0.484) data 0.417 (0.354) loss_x loss_x 0.9883 (1.0143) acc_x 71.8750 (75.0000) lr 4.1221e-04 eta 0:00:09
epoch [142/200] batch [10/24] time 0.434 (0.464) data 0.302 (0.333) loss_x loss_x 1.3623 (1.1055) acc_x 65.6250 (70.6250) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [15/24] time 0.389 (0.456) data 0.259 (0.325) loss_x loss_x 1.2256 (1.1781) acc_x 68.7500 (69.5833) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [20/24] time 0.422 (0.481) data 0.291 (0.350) loss_x loss_x 0.9355 (1.1541) acc_x 71.8750 (70.0000) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.2545, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 798
clean true:790
clean false:8
clean_rate:0.9899749373433584
noisy true:697
noisy false:1641
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 2338
epoch [143/200] batch [5/24] time 0.480 (0.477) data 0.349 (0.346) loss_x loss_x 1.0898 (1.0662) acc_x 75.0000 (72.5000) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [10/24] time 0.409 (0.453) data 0.277 (0.322) loss_x loss_x 1.1660 (1.1173) acc_x 75.0000 (71.5625) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [15/24] time 0.522 (0.464) data 0.390 (0.333) loss_x loss_x 1.2432 (1.1851) acc_x 71.8750 (70.6250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [20/24] time 0.490 (0.463) data 0.359 (0.332) loss_x loss_x 1.0156 (1.2329) acc_x 81.2500 (69.6875) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 809
clean true:801
clean false:8
clean_rate:0.9901112484548825
noisy true:698
noisy false:1629
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 2327
epoch [144/200] batch [5/25] time 0.483 (0.488) data 0.353 (0.357) loss_x loss_x 0.8550 (1.1441) acc_x 78.1250 (73.7500) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [10/25] time 0.466 (0.488) data 0.336 (0.357) loss_x loss_x 1.1396 (1.2581) acc_x 71.8750 (70.0000) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [15/25] time 0.460 (0.459) data 0.329 (0.328) loss_x loss_x 1.2451 (1.2742) acc_x 68.7500 (70.2083) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [20/25] time 0.535 (0.465) data 0.405 (0.334) loss_x loss_x 1.0859 (1.3176) acc_x 75.0000 (68.4375) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/25] time 0.458 (0.459) data 0.328 (0.328) loss_x loss_x 1.2012 (1.2951) acc_x 65.6250 (68.3750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.2596, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 814
clean true:805
clean false:9
clean_rate:0.9889434889434889
noisy true:695
noisy false:1627
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 2322
epoch [145/200] batch [5/25] time 0.456 (0.434) data 0.325 (0.303) loss_x loss_x 1.2041 (1.2961) acc_x 78.1250 (68.7500) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [10/25] time 0.495 (0.451) data 0.364 (0.320) loss_x loss_x 0.9146 (1.3057) acc_x 68.7500 (67.8125) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [15/25] time 0.466 (0.463) data 0.335 (0.332) loss_x loss_x 1.4424 (1.3168) acc_x 56.2500 (67.5000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/25] time 0.594 (0.477) data 0.463 (0.346) loss_x loss_x 1.1475 (1.2837) acc_x 75.0000 (68.7500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/25] time 0.538 (0.478) data 0.407 (0.347) loss_x loss_x 1.5205 (1.3032) acc_x 59.3750 (67.5000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1630
confident_label rate tensor(0.2605, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 817
clean true:811
clean false:6
clean_rate:0.99265605875153
noisy true:695
noisy false:1624
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 2319
epoch [146/200] batch [5/25] time 0.375 (0.462) data 0.245 (0.332) loss_x loss_x 0.9927 (1.3173) acc_x 71.8750 (70.6250) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [10/25] time 0.440 (0.504) data 0.309 (0.373) loss_x loss_x 0.9512 (1.2733) acc_x 75.0000 (69.6875) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [15/25] time 0.532 (0.489) data 0.402 (0.359) loss_x loss_x 0.9194 (1.2566) acc_x 75.0000 (70.2083) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/25] time 0.494 (0.484) data 0.365 (0.353) loss_x loss_x 1.2363 (1.2417) acc_x 71.8750 (70.1562) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/25] time 0.469 (0.480) data 0.339 (0.349) loss_x loss_x 1.0938 (1.2268) acc_x 68.7500 (70.7500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1614
confident_label rate tensor(0.2707, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 849
clean true:842
clean false:7
clean_rate:0.9917550058892816
noisy true:680
noisy false:1607
after delete: len(clean_dataset) 849
after delete: len(noisy_dataset) 2287
epoch [147/200] batch [5/26] time 0.443 (0.454) data 0.313 (0.323) loss_x loss_x 0.9844 (1.2163) acc_x 71.8750 (69.3750) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [10/26] time 0.510 (0.474) data 0.379 (0.343) loss_x loss_x 1.2344 (1.2412) acc_x 59.3750 (68.7500) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [15/26] time 0.433 (0.475) data 0.302 (0.344) loss_x loss_x 1.2734 (1.2654) acc_x 68.7500 (69.5833) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [20/26] time 0.402 (0.478) data 0.271 (0.348) loss_x loss_x 1.0332 (1.2383) acc_x 71.8750 (69.8438) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/26] time 0.426 (0.466) data 0.295 (0.335) loss_x loss_x 1.5811 (1.2638) acc_x 62.5000 (69.1250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2612, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 819
clean true:812
clean false:7
clean_rate:0.9914529914529915
noisy true:684
noisy false:1633
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 2317
epoch [148/200] batch [5/25] time 0.446 (0.440) data 0.315 (0.310) loss_x loss_x 1.0781 (1.0282) acc_x 71.8750 (75.6250) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [10/25] time 0.531 (0.448) data 0.398 (0.318) loss_x loss_x 0.9731 (1.1322) acc_x 75.0000 (72.1875) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [15/25] time 0.395 (0.470) data 0.264 (0.340) loss_x loss_x 1.4932 (1.1617) acc_x 59.3750 (71.2500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [20/25] time 0.592 (0.490) data 0.460 (0.359) loss_x loss_x 1.7275 (1.1609) acc_x 62.5000 (71.4062) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/25] time 0.504 (0.487) data 0.372 (0.356) loss_x loss_x 1.2256 (1.1772) acc_x 62.5000 (70.8750) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1625
confident_label rate tensor(0.2643, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 829
clean true:821
clean false:8
clean_rate:0.9903498190591074
noisy true:690
noisy false:1617
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 2307
epoch [149/200] batch [5/25] time 0.454 (0.500) data 0.324 (0.369) loss_x loss_x 1.3623 (1.1996) acc_x 65.6250 (70.0000) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [10/25] time 0.445 (0.479) data 0.314 (0.348) loss_x loss_x 0.8691 (1.2267) acc_x 71.8750 (69.6875) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [15/25] time 0.486 (0.472) data 0.356 (0.341) loss_x loss_x 1.0283 (1.1806) acc_x 75.0000 (71.0417) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [20/25] time 0.361 (0.471) data 0.230 (0.340) loss_x loss_x 1.9062 (1.2148) acc_x 68.7500 (70.9375) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/25] time 0.534 (0.470) data 0.404 (0.339) loss_x loss_x 1.2314 (1.2375) acc_x 62.5000 (70.2500) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2535, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 795
clean true:787
clean false:8
clean_rate:0.989937106918239
noisy true:689
noisy false:1652
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 2341
epoch [150/200] batch [5/24] time 0.482 (0.484) data 0.352 (0.354) loss_x loss_x 1.0605 (1.0449) acc_x 71.8750 (73.1250) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [10/24] time 0.609 (0.487) data 0.479 (0.356) loss_x loss_x 0.9331 (1.1998) acc_x 68.7500 (68.4375) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [15/24] time 0.451 (0.477) data 0.320 (0.347) loss_x loss_x 0.9795 (1.1852) acc_x 71.8750 (70.2083) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [20/24] time 0.378 (0.469) data 0.248 (0.339) loss_x loss_x 1.3418 (1.2289) acc_x 65.6250 (69.0625) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1622
confident_label rate tensor(0.2643, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 829
clean true:822
clean false:7
clean_rate:0.991556091676719
noisy true:692
noisy false:1615
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 2307
epoch [151/200] batch [5/25] time 0.465 (0.474) data 0.334 (0.343) loss_x loss_x 0.9126 (1.2202) acc_x 75.0000 (70.0000) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [10/25] time 0.445 (0.487) data 0.314 (0.355) loss_x loss_x 0.9390 (1.2706) acc_x 81.2500 (67.5000) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [15/25] time 0.448 (0.471) data 0.317 (0.340) loss_x loss_x 1.7285 (1.2860) acc_x 65.6250 (67.9167) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/25] time 0.473 (0.472) data 0.341 (0.341) loss_x loss_x 1.2139 (1.2583) acc_x 71.8750 (67.3438) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/25] time 0.400 (0.469) data 0.270 (0.338) loss_x loss_x 1.6582 (1.2977) acc_x 65.6250 (67.2500) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 805
clean true:800
clean false:5
clean_rate:0.9937888198757764
noisy true:699
noisy false:1632
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 2331
epoch [152/200] batch [5/25] time 0.410 (0.489) data 0.278 (0.358) loss_x loss_x 0.8804 (1.1614) acc_x 81.2500 (71.2500) lr 2.9289e-04 eta 0:00:09
epoch [152/200] batch [10/25] time 0.714 (0.511) data 0.582 (0.380) loss_x loss_x 1.0078 (1.2386) acc_x 78.1250 (68.7500) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/25] time 0.405 (0.493) data 0.274 (0.362) loss_x loss_x 0.9736 (1.1726) acc_x 75.0000 (70.2083) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/25] time 0.507 (0.484) data 0.376 (0.352) loss_x loss_x 1.6758 (1.2135) acc_x 59.3750 (69.3750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/25] time 0.417 (0.480) data 0.286 (0.349) loss_x loss_x 1.1797 (1.1910) acc_x 68.7500 (70.0000) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1611
confident_label rate tensor(0.2618, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 821
clean true:815
clean false:6
clean_rate:0.9926918392204629
noisy true:710
noisy false:1605
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 2315
epoch [153/200] batch [5/25] time 0.531 (0.502) data 0.401 (0.371) loss_x loss_x 1.4863 (1.2014) acc_x 65.6250 (71.8750) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [10/25] time 0.591 (0.501) data 0.460 (0.370) loss_x loss_x 1.4766 (1.1929) acc_x 62.5000 (71.2500) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [15/25] time 0.587 (0.500) data 0.455 (0.368) loss_x loss_x 1.1846 (1.1970) acc_x 68.7500 (72.0833) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [20/25] time 0.390 (0.485) data 0.258 (0.354) loss_x loss_x 1.2012 (1.1626) acc_x 56.2500 (71.8750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/25] time 0.461 (0.475) data 0.331 (0.344) loss_x loss_x 1.7158 (1.2235) acc_x 53.1250 (70.0000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1625
confident_label rate tensor(0.2624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 823
clean true:815
clean false:8
clean_rate:0.9902794653705954
noisy true:696
noisy false:1617
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 2313
epoch [154/200] batch [5/25] time 0.472 (0.486) data 0.340 (0.355) loss_x loss_x 0.8584 (1.2547) acc_x 78.1250 (69.3750) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [10/25] time 0.502 (0.472) data 0.371 (0.341) loss_x loss_x 1.4268 (1.3239) acc_x 65.6250 (66.8750) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [15/25] time 0.581 (0.487) data 0.451 (0.355) loss_x loss_x 0.9053 (1.2866) acc_x 75.0000 (67.5000) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [20/25] time 0.467 (0.479) data 0.336 (0.348) loss_x loss_x 1.6084 (1.2984) acc_x 68.7500 (68.4375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/25] time 0.423 (0.469) data 0.292 (0.338) loss_x loss_x 2.2520 (1.3496) acc_x 40.6250 (67.1250) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.2577, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 808
clean true:803
clean false:5
clean_rate:0.9938118811881188
noisy true:698
noisy false:1630
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 2328
epoch [155/200] batch [5/25] time 0.455 (0.459) data 0.324 (0.328) loss_x loss_x 0.8872 (1.0791) acc_x 78.1250 (73.1250) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [10/25] time 0.604 (0.473) data 0.473 (0.342) loss_x loss_x 1.2041 (1.0588) acc_x 62.5000 (70.9375) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [15/25] time 0.445 (0.468) data 0.314 (0.337) loss_x loss_x 1.3223 (1.1390) acc_x 75.0000 (70.2083) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/25] time 0.513 (0.468) data 0.383 (0.337) loss_x loss_x 0.9702 (1.1397) acc_x 78.1250 (71.4062) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/25] time 0.432 (0.464) data 0.301 (0.333) loss_x loss_x 1.1777 (1.1107) acc_x 65.6250 (71.7500) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1648
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:820
clean false:7
clean_rate:0.9915356711003628
noisy true:668
noisy false:1641
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [156/200] batch [5/25] time 0.463 (0.523) data 0.332 (0.392) loss_x loss_x 1.1055 (1.2254) acc_x 68.7500 (72.5000) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [10/25] time 0.440 (0.486) data 0.309 (0.355) loss_x loss_x 1.0713 (1.2070) acc_x 78.1250 (72.1875) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [15/25] time 0.372 (0.480) data 0.241 (0.349) loss_x loss_x 1.4043 (1.2044) acc_x 75.0000 (71.0417) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [20/25] time 0.556 (0.479) data 0.425 (0.348) loss_x loss_x 1.0684 (1.2251) acc_x 71.8750 (70.0000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/25] time 0.561 (0.476) data 0.430 (0.344) loss_x loss_x 1.1709 (1.2379) acc_x 78.1250 (69.7500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1631
confident_label rate tensor(0.2564, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 804
clean true:795
clean false:9
clean_rate:0.9888059701492538
noisy true:710
noisy false:1622
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 2332
epoch [157/200] batch [5/25] time 0.566 (0.490) data 0.435 (0.359) loss_x loss_x 1.1377 (0.9897) acc_x 71.8750 (75.6250) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [10/25] time 0.420 (0.503) data 0.289 (0.372) loss_x loss_x 1.0625 (1.0500) acc_x 75.0000 (75.3125) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/25] time 0.480 (0.487) data 0.348 (0.356) loss_x loss_x 1.4229 (1.0383) acc_x 59.3750 (75.6250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [20/25] time 0.462 (0.480) data 0.331 (0.349) loss_x loss_x 1.2588 (1.0934) acc_x 62.5000 (73.4375) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/25] time 0.458 (0.474) data 0.327 (0.343) loss_x loss_x 1.1631 (1.1127) acc_x 71.8750 (73.1250) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1641
confident_label rate tensor(0.2615, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 820
clean true:815
clean false:5
clean_rate:0.9939024390243902
noisy true:680
noisy false:1636
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 2316
epoch [158/200] batch [5/25] time 0.370 (0.492) data 0.239 (0.362) loss_x loss_x 1.2197 (1.2626) acc_x 65.6250 (64.3750) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [10/25] time 0.376 (0.469) data 0.245 (0.338) loss_x loss_x 1.5840 (1.1716) acc_x 68.7500 (69.0625) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [15/25] time 0.512 (0.472) data 0.381 (0.341) loss_x loss_x 0.8936 (1.1446) acc_x 81.2500 (71.2500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/25] time 0.469 (0.471) data 0.338 (0.340) loss_x loss_x 0.9893 (1.1441) acc_x 59.3750 (70.3125) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/25] time 0.495 (0.475) data 0.364 (0.344) loss_x loss_x 1.2188 (1.1697) acc_x 71.8750 (70.3750) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.2573, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 807
clean true:798
clean false:9
clean_rate:0.9888475836431226
noisy true:647
noisy false:1682
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 2329
epoch [159/200] batch [5/25] time 0.376 (0.508) data 0.246 (0.377) loss_x loss_x 0.8721 (1.1367) acc_x 81.2500 (73.7500) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [10/25] time 0.577 (0.511) data 0.446 (0.380) loss_x loss_x 1.9482 (1.3067) acc_x 68.7500 (70.0000) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [15/25] time 0.488 (0.487) data 0.357 (0.356) loss_x loss_x 1.1309 (1.2010) acc_x 81.2500 (71.6667) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/25] time 0.530 (0.484) data 0.398 (0.353) loss_x loss_x 1.1621 (1.2498) acc_x 65.6250 (70.1562) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/25] time 0.433 (0.477) data 0.302 (0.346) loss_x loss_x 0.7305 (1.2120) acc_x 78.1250 (70.5000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.2669, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 837
clean true:829
clean false:8
clean_rate:0.9904420549581839
noisy true:699
noisy false:1600
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 2299
epoch [160/200] batch [5/26] time 0.514 (0.510) data 0.383 (0.377) loss_x loss_x 0.9546 (1.2077) acc_x 71.8750 (67.5000) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [10/26] time 0.440 (0.475) data 0.309 (0.343) loss_x loss_x 0.8638 (1.2302) acc_x 84.3750 (70.9375) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [15/26] time 0.464 (0.489) data 0.332 (0.357) loss_x loss_x 1.0664 (1.2261) acc_x 71.8750 (70.2083) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [20/26] time 0.502 (0.506) data 0.372 (0.375) loss_x loss_x 1.1777 (1.2215) acc_x 65.6250 (69.8438) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [25/26] time 0.409 (0.486) data 0.277 (0.354) loss_x loss_x 1.0176 (1.2292) acc_x 81.2500 (69.1250) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1638
confident_label rate tensor(0.2647, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 830
clean true:824
clean false:6
clean_rate:0.9927710843373494
noisy true:674
noisy false:1632
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 2306
epoch [161/200] batch [5/25] time 0.423 (0.477) data 0.293 (0.346) loss_x loss_x 1.3789 (1.0899) acc_x 59.3750 (71.8750) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [10/25] time 0.379 (0.504) data 0.249 (0.373) loss_x loss_x 1.5400 (1.1561) acc_x 59.3750 (71.5625) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [15/25] time 0.526 (0.490) data 0.395 (0.359) loss_x loss_x 1.3291 (1.1669) acc_x 62.5000 (71.6667) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [20/25] time 0.424 (0.474) data 0.293 (0.343) loss_x loss_x 1.1084 (1.1747) acc_x 71.8750 (70.9375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/25] time 0.478 (0.486) data 0.347 (0.355) loss_x loss_x 1.0283 (1.1690) acc_x 75.0000 (70.8750) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1622
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:822
clean false:5
clean_rate:0.9939540507859734
noisy true:692
noisy false:1617
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [162/200] batch [5/25] time 0.467 (0.514) data 0.336 (0.383) loss_x loss_x 0.7852 (1.3236) acc_x 81.2500 (68.7500) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [10/25] time 0.473 (0.495) data 0.342 (0.364) loss_x loss_x 1.1074 (1.2830) acc_x 71.8750 (69.0625) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [15/25] time 0.495 (0.465) data 0.365 (0.335) loss_x loss_x 1.1279 (1.3145) acc_x 68.7500 (66.4583) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [20/25] time 0.551 (0.470) data 0.421 (0.339) loss_x loss_x 1.5020 (1.3362) acc_x 65.6250 (67.0312) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/25] time 0.427 (0.461) data 0.296 (0.330) loss_x loss_x 1.2627 (1.2784) acc_x 59.3750 (68.0000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.2529, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 793
clean true:789
clean false:4
clean_rate:0.9949558638083228
noisy true:714
noisy false:1629
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 2343
epoch [163/200] batch [5/24] time 0.552 (0.423) data 0.421 (0.293) loss_x loss_x 1.5820 (1.3778) acc_x 65.6250 (69.3750) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [10/24] time 0.326 (0.457) data 0.194 (0.326) loss_x loss_x 1.4014 (1.4179) acc_x 50.0000 (65.9375) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [15/24] time 0.600 (0.459) data 0.469 (0.328) loss_x loss_x 1.4336 (1.3184) acc_x 65.6250 (68.9583) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [20/24] time 0.416 (0.466) data 0.286 (0.335) loss_x loss_x 0.9912 (1.3075) acc_x 65.6250 (68.5938) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:821
clean false:6
clean_rate:0.992744860943168
noisy true:681
noisy false:1628
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [164/200] batch [5/25] time 0.491 (0.436) data 0.360 (0.305) loss_x loss_x 1.2568 (1.2481) acc_x 68.7500 (66.8750) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [10/25] time 0.486 (0.443) data 0.355 (0.312) loss_x loss_x 1.2705 (1.2160) acc_x 71.8750 (69.3750) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/25] time 0.360 (0.443) data 0.229 (0.312) loss_x loss_x 0.4756 (1.1826) acc_x 87.5000 (71.4583) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [20/25] time 0.449 (0.460) data 0.318 (0.329) loss_x loss_x 0.8184 (1.1544) acc_x 78.1250 (71.4062) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/25] time 0.483 (0.476) data 0.352 (0.344) loss_x loss_x 1.3770 (1.2184) acc_x 71.8750 (70.2500) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2573, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 807
clean true:802
clean false:5
clean_rate:0.9938042131350682
noisy true:677
noisy false:1652
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 2329
epoch [165/200] batch [5/25] time 0.386 (0.496) data 0.255 (0.364) loss_x loss_x 1.0928 (1.1219) acc_x 71.8750 (70.6250) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [10/25] time 0.440 (0.483) data 0.309 (0.352) loss_x loss_x 0.8853 (1.0917) acc_x 78.1250 (70.9375) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [15/25] time 0.376 (0.479) data 0.246 (0.348) loss_x loss_x 0.9814 (1.0840) acc_x 78.1250 (71.8750) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/25] time 0.445 (0.480) data 0.315 (0.349) loss_x loss_x 1.7832 (1.1319) acc_x 59.3750 (71.0938) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/25] time 0.428 (0.479) data 0.298 (0.348) loss_x loss_x 1.6670 (1.1997) acc_x 59.3750 (69.5000) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1628
confident_label rate tensor(0.2608, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 818
clean true:813
clean false:5
clean_rate:0.9938875305623472
noisy true:695
noisy false:1623
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 2318
epoch [166/200] batch [5/25] time 0.458 (0.546) data 0.328 (0.414) loss_x loss_x 0.9102 (0.9411) acc_x 81.2500 (78.1250) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [10/25] time 0.353 (0.490) data 0.223 (0.359) loss_x loss_x 0.9185 (1.0476) acc_x 78.1250 (76.5625) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/25] time 0.446 (0.487) data 0.315 (0.356) loss_x loss_x 0.8833 (1.0405) acc_x 75.0000 (76.0417) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [20/25] time 0.459 (0.471) data 0.328 (0.340) loss_x loss_x 1.0576 (1.0664) acc_x 78.1250 (75.1562) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/25] time 0.428 (0.462) data 0.298 (0.331) loss_x loss_x 1.4531 (1.1222) acc_x 59.3750 (73.3750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1664
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:820
clean false:7
clean_rate:0.9915356711003628
noisy true:652
noisy false:1657
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [167/200] batch [5/25] time 0.422 (0.445) data 0.292 (0.314) loss_x loss_x 0.9653 (1.2542) acc_x 68.7500 (71.2500) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [10/25] time 0.423 (0.490) data 0.292 (0.359) loss_x loss_x 1.3311 (1.3889) acc_x 62.5000 (64.6875) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [15/25] time 0.385 (0.469) data 0.255 (0.338) loss_x loss_x 1.7100 (1.3875) acc_x 59.3750 (66.0417) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [20/25] time 0.538 (0.458) data 0.408 (0.328) loss_x loss_x 1.1035 (1.3172) acc_x 65.6250 (67.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/25] time 0.486 (0.462) data 0.356 (0.331) loss_x loss_x 1.1543 (1.3269) acc_x 68.7500 (67.6250) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:821
clean false:6
clean_rate:0.992744860943168
noisy true:705
noisy false:1604
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [168/200] batch [5/25] time 0.393 (0.445) data 0.263 (0.314) loss_x loss_x 0.9849 (1.3413) acc_x 65.6250 (64.3750) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [10/25] time 0.487 (0.458) data 0.356 (0.328) loss_x loss_x 1.8701 (1.2112) acc_x 56.2500 (69.3750) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [15/25] time 0.440 (0.472) data 0.310 (0.341) loss_x loss_x 1.2471 (1.2255) acc_x 71.8750 (68.5417) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [20/25] time 0.396 (0.471) data 0.265 (0.340) loss_x loss_x 1.1787 (1.2316) acc_x 71.8750 (69.5312) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/25] time 0.444 (0.467) data 0.313 (0.336) loss_x loss_x 0.9946 (1.2186) acc_x 71.8750 (69.3750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.2682, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 841
clean true:836
clean false:5
clean_rate:0.9940546967895363
noisy true:692
noisy false:1603
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 2295
epoch [169/200] batch [5/26] time 0.541 (0.465) data 0.410 (0.334) loss_x loss_x 1.0410 (1.0942) acc_x 71.8750 (70.0000) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [10/26] time 0.508 (0.450) data 0.377 (0.319) loss_x loss_x 0.5674 (1.0279) acc_x 90.6250 (72.1875) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [15/26] time 0.385 (0.451) data 0.254 (0.320) loss_x loss_x 0.8726 (1.0829) acc_x 75.0000 (70.8333) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/26] time 0.371 (0.453) data 0.241 (0.322) loss_x loss_x 1.0801 (1.1487) acc_x 71.8750 (69.5312) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/26] time 0.509 (0.447) data 0.379 (0.316) loss_x loss_x 0.9043 (1.1775) acc_x 78.1250 (69.5000) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1638
confident_label rate tensor(0.2710, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 850
clean true:840
clean false:10
clean_rate:0.9882352941176471
noisy true:658
noisy false:1628
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 2286
epoch [170/200] batch [5/26] time 0.469 (0.496) data 0.339 (0.365) loss_x loss_x 0.9814 (1.0744) acc_x 75.0000 (77.5000) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [10/26] time 0.445 (0.496) data 0.314 (0.365) loss_x loss_x 1.4395 (1.2012) acc_x 71.8750 (74.0625) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [15/26] time 0.505 (0.474) data 0.374 (0.343) loss_x loss_x 0.9282 (1.1266) acc_x 75.0000 (74.1667) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [20/26] time 0.404 (0.483) data 0.272 (0.352) loss_x loss_x 0.9126 (1.1671) acc_x 75.0000 (72.1875) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/26] time 0.486 (0.476) data 0.356 (0.345) loss_x loss_x 0.9663 (1.1634) acc_x 75.0000 (72.0000) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1625
confident_label rate tensor(0.2733, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 857
clean true:847
clean false:10
clean_rate:0.9883313885647608
noisy true:664
noisy false:1615
after delete: len(clean_dataset) 857
after delete: len(noisy_dataset) 2279
epoch [171/200] batch [5/26] time 0.630 (0.546) data 0.500 (0.415) loss_x loss_x 1.3125 (1.1869) acc_x 68.7500 (73.1250) lr 1.1623e-04 eta 0:00:11
epoch [171/200] batch [10/26] time 0.420 (0.500) data 0.290 (0.369) loss_x loss_x 1.0732 (1.2584) acc_x 75.0000 (70.3125) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [15/26] time 0.489 (0.474) data 0.353 (0.342) loss_x loss_x 1.3281 (1.2391) acc_x 68.7500 (70.8333) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [20/26] time 0.387 (0.477) data 0.255 (0.345) loss_x loss_x 1.1562 (1.2300) acc_x 68.7500 (70.1562) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/26] time 0.536 (0.478) data 0.405 (0.346) loss_x loss_x 1.4287 (1.1903) acc_x 65.6250 (70.7500) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2615, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 820
clean true:812
clean false:8
clean_rate:0.9902439024390244
noisy true:687
noisy false:1629
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 2316
epoch [172/200] batch [5/25] time 0.551 (0.496) data 0.420 (0.365) loss_x loss_x 0.8838 (1.3193) acc_x 75.0000 (65.6250) lr 1.0899e-04 eta 0:00:09
epoch [172/200] batch [10/25] time 0.451 (0.463) data 0.319 (0.331) loss_x loss_x 1.2822 (1.2528) acc_x 71.8750 (68.7500) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [15/25] time 0.652 (0.472) data 0.521 (0.341) loss_x loss_x 1.0244 (1.2290) acc_x 71.8750 (68.1250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/25] time 0.489 (0.473) data 0.358 (0.342) loss_x loss_x 1.3613 (1.2160) acc_x 68.7500 (68.5938) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/25] time 0.426 (0.470) data 0.295 (0.339) loss_x loss_x 0.9805 (1.2662) acc_x 68.7500 (67.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1626
confident_label rate tensor(0.2621, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 822
clean true:814
clean false:8
clean_rate:0.9902676399026764
noisy true:696
noisy false:1618
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 2314
epoch [173/200] batch [5/25] time 0.490 (0.498) data 0.358 (0.366) loss_x loss_x 1.4160 (1.3646) acc_x 65.6250 (65.0000) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [10/25] time 0.631 (0.508) data 0.498 (0.376) loss_x loss_x 0.9189 (1.2198) acc_x 75.0000 (70.0000) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [15/25] time 0.474 (0.494) data 0.342 (0.362) loss_x loss_x 0.9795 (1.2230) acc_x 81.2500 (69.5833) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [20/25] time 0.486 (0.485) data 0.354 (0.353) loss_x loss_x 1.0010 (1.2437) acc_x 68.7500 (69.2188) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/25] time 0.436 (0.474) data 0.305 (0.342) loss_x loss_x 1.1680 (1.2424) acc_x 75.0000 (70.0000) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.2647, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 830
clean true:823
clean false:7
clean_rate:0.9915662650602409
noisy true:693
noisy false:1613
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 2306
epoch [174/200] batch [5/25] time 0.414 (0.434) data 0.283 (0.304) loss_x loss_x 2.1504 (1.5518) acc_x 59.3750 (66.8750) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [10/25] time 0.483 (0.452) data 0.351 (0.321) loss_x loss_x 1.2725 (1.3780) acc_x 65.6250 (68.4375) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [15/25] time 0.451 (0.466) data 0.320 (0.335) loss_x loss_x 1.0918 (1.3360) acc_x 75.0000 (68.9583) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [20/25] time 0.568 (0.470) data 0.436 (0.339) loss_x loss_x 1.1699 (1.3150) acc_x 75.0000 (68.2812) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/25] time 0.436 (0.482) data 0.304 (0.351) loss_x loss_x 0.9702 (1.2713) acc_x 75.0000 (69.5000) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.2628, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 824
clean true:816
clean false:8
clean_rate:0.9902912621359223
noisy true:667
noisy false:1645
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 2312
epoch [175/200] batch [5/25] time 0.462 (0.420) data 0.331 (0.289) loss_x loss_x 0.9712 (1.2117) acc_x 68.7500 (65.6250) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [10/25] time 0.502 (0.438) data 0.371 (0.307) loss_x loss_x 1.0283 (1.2478) acc_x 75.0000 (66.8750) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [15/25] time 0.470 (0.449) data 0.340 (0.318) loss_x loss_x 1.4277 (1.3013) acc_x 56.2500 (65.4167) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [20/25] time 0.448 (0.450) data 0.317 (0.319) loss_x loss_x 0.7261 (1.3327) acc_x 84.3750 (65.4688) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/25] time 0.470 (0.449) data 0.339 (0.318) loss_x loss_x 1.5938 (1.3098) acc_x 68.7500 (66.0000) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1619
confident_label rate tensor(0.2650, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 831
clean true:824
clean false:7
clean_rate:0.9915764139590855
noisy true:693
noisy false:1612
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 2305
epoch [176/200] batch [5/25] time 0.521 (0.494) data 0.390 (0.363) loss_x loss_x 1.0625 (1.2259) acc_x 78.1250 (71.8750) lr 8.2245e-05 eta 0:00:09
epoch [176/200] batch [10/25] time 0.677 (0.503) data 0.546 (0.373) loss_x loss_x 1.6875 (1.2022) acc_x 56.2500 (73.1250) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [15/25] time 0.387 (0.493) data 0.255 (0.362) loss_x loss_x 1.1846 (1.2215) acc_x 65.6250 (71.0417) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [20/25] time 0.395 (0.486) data 0.265 (0.355) loss_x loss_x 1.5518 (1.2138) acc_x 75.0000 (71.4062) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/25] time 0.483 (0.477) data 0.351 (0.347) loss_x loss_x 1.3340 (1.2664) acc_x 59.3750 (69.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1627
confident_label rate tensor(0.2621, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 822
clean true:815
clean false:7
clean_rate:0.9914841849148418
noisy true:694
noisy false:1620
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 2314
epoch [177/200] batch [5/25] time 0.573 (0.519) data 0.442 (0.388) loss_x loss_x 1.0234 (1.1168) acc_x 71.8750 (73.7500) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [10/25] time 0.485 (0.496) data 0.355 (0.365) loss_x loss_x 1.3184 (1.1096) acc_x 62.5000 (70.6250) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [15/25] time 0.456 (0.479) data 0.326 (0.348) loss_x loss_x 0.9199 (1.0703) acc_x 68.7500 (69.5833) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [20/25] time 0.376 (0.476) data 0.246 (0.346) loss_x loss_x 1.4102 (1.1419) acc_x 65.6250 (68.5938) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/25] time 0.378 (0.480) data 0.247 (0.349) loss_x loss_x 1.1650 (1.1061) acc_x 65.6250 (69.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1616
confident_label rate tensor(0.2650, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 831
clean true:825
clean false:6
clean_rate:0.9927797833935018
noisy true:695
noisy false:1610
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 2305
epoch [178/200] batch [5/25] time 0.443 (0.480) data 0.313 (0.349) loss_x loss_x 0.8574 (1.0862) acc_x 71.8750 (71.2500) lr 7.0224e-05 eta 0:00:09
epoch [178/200] batch [10/25] time 0.403 (0.472) data 0.272 (0.341) loss_x loss_x 1.4814 (1.2237) acc_x 65.6250 (69.0625) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [15/25] time 0.490 (0.475) data 0.359 (0.344) loss_x loss_x 1.3525 (1.2343) acc_x 65.6250 (67.7083) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [20/25] time 0.512 (0.459) data 0.381 (0.329) loss_x loss_x 0.8560 (1.2157) acc_x 75.0000 (68.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/25] time 0.551 (0.459) data 0.420 (0.329) loss_x loss_x 1.2305 (1.1925) acc_x 68.7500 (69.6250) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1576
confident_label rate tensor(0.2669, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 837
clean true:828
clean false:9
clean_rate:0.989247311827957
noisy true:732
noisy false:1567
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 2299
epoch [179/200] batch [5/26] time 0.439 (0.450) data 0.308 (0.319) loss_x loss_x 1.0801 (1.2047) acc_x 59.3750 (66.8750) lr 6.4556e-05 eta 0:00:09
epoch [179/200] batch [10/26] time 0.440 (0.465) data 0.309 (0.333) loss_x loss_x 1.1182 (1.1722) acc_x 71.8750 (68.1250) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [15/26] time 0.463 (0.461) data 0.332 (0.330) loss_x loss_x 0.8818 (1.1496) acc_x 78.1250 (70.8333) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [20/26] time 0.441 (0.456) data 0.310 (0.324) loss_x loss_x 1.3105 (1.1435) acc_x 68.7500 (71.4062) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/26] time 0.580 (0.458) data 0.449 (0.327) loss_x loss_x 0.9922 (1.1513) acc_x 75.0000 (70.7500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1597
confident_label rate tensor(0.2685, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 842
clean true:834
clean false:8
clean_rate:0.9904988123515439
noisy true:705
noisy false:1589
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 2294
epoch [180/200] batch [5/26] time 0.441 (0.474) data 0.310 (0.343) loss_x loss_x 1.1055 (1.0296) acc_x 68.7500 (73.1250) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [10/26] time 0.458 (0.467) data 0.327 (0.336) loss_x loss_x 1.4932 (1.1858) acc_x 59.3750 (69.6875) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [15/26] time 0.389 (0.469) data 0.258 (0.338) loss_x loss_x 0.7490 (1.1243) acc_x 78.1250 (71.0417) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [20/26] time 0.476 (0.465) data 0.345 (0.335) loss_x loss_x 1.2529 (1.2160) acc_x 71.8750 (69.3750) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/26] time 0.442 (0.460) data 0.311 (0.329) loss_x loss_x 1.1309 (1.1809) acc_x 71.8750 (69.8750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.2634, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 826
clean true:818
clean false:8
clean_rate:0.9903147699757869
noisy true:672
noisy false:1638
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 2310
epoch [181/200] batch [5/25] time 0.382 (0.431) data 0.251 (0.300) loss_x loss_x 1.6836 (1.2229) acc_x 59.3750 (70.6250) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [10/25] time 0.408 (0.438) data 0.277 (0.307) loss_x loss_x 1.1455 (1.1946) acc_x 68.7500 (71.8750) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [15/25] time 0.366 (0.426) data 0.235 (0.295) loss_x loss_x 1.2041 (1.1790) acc_x 65.6250 (71.2500) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [20/25] time 0.540 (0.432) data 0.408 (0.301) loss_x loss_x 1.0967 (1.1722) acc_x 75.0000 (70.4688) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/25] time 0.548 (0.442) data 0.417 (0.311) loss_x loss_x 0.9302 (1.1972) acc_x 68.7500 (70.6250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1599
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 833
clean true:825
clean false:8
clean_rate:0.9903961584633854
noisy true:712
noisy false:1591
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 2303
epoch [182/200] batch [5/26] time 0.432 (0.433) data 0.301 (0.302) loss_x loss_x 1.2686 (1.2503) acc_x 65.6250 (69.3750) lr 4.8943e-05 eta 0:00:09
epoch [182/200] batch [10/26] time 0.438 (0.433) data 0.307 (0.302) loss_x loss_x 1.4863 (1.2681) acc_x 71.8750 (67.5000) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [15/26] time 0.416 (0.446) data 0.285 (0.315) loss_x loss_x 1.2979 (1.2586) acc_x 71.8750 (68.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [20/26] time 0.342 (0.433) data 0.211 (0.302) loss_x loss_x 1.0791 (1.2376) acc_x 68.7500 (69.2188) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/26] time 0.685 (0.443) data 0.553 (0.312) loss_x loss_x 0.9092 (1.2121) acc_x 71.8750 (69.3750) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.2707, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 849
clean true:843
clean false:6
clean_rate:0.9929328621908127
noisy true:690
noisy false:1597
after delete: len(clean_dataset) 849
after delete: len(noisy_dataset) 2287
epoch [183/200] batch [5/26] time 0.455 (0.417) data 0.324 (0.286) loss_x loss_x 1.0312 (1.1713) acc_x 75.0000 (70.0000) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [10/26] time 0.533 (0.442) data 0.402 (0.311) loss_x loss_x 1.1357 (1.1372) acc_x 68.7500 (71.2500) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [15/26] time 0.441 (0.448) data 0.310 (0.317) loss_x loss_x 1.4756 (1.1406) acc_x 65.6250 (71.0417) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [20/26] time 0.468 (0.459) data 0.337 (0.328) loss_x loss_x 1.0186 (1.1261) acc_x 71.8750 (71.4062) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/26] time 0.383 (0.450) data 0.252 (0.319) loss_x loss_x 1.0527 (1.1617) acc_x 68.7500 (70.2500) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1678
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 809
clean true:801
clean false:8
clean_rate:0.9901112484548825
noisy true:657
noisy false:1670
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 2327
epoch [184/200] batch [5/25] time 0.402 (0.482) data 0.271 (0.351) loss_x loss_x 1.5918 (1.3316) acc_x 56.2500 (63.1250) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [10/25] time 0.400 (0.495) data 0.269 (0.364) loss_x loss_x 1.6885 (1.2369) acc_x 65.6250 (68.1250) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [15/25] time 0.385 (0.466) data 0.254 (0.335) loss_x loss_x 1.2490 (1.1679) acc_x 71.8750 (70.0000) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [20/25] time 0.387 (0.449) data 0.256 (0.318) loss_x loss_x 1.4336 (1.2368) acc_x 65.6250 (69.2188) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/25] time 0.460 (0.442) data 0.329 (0.311) loss_x loss_x 1.3457 (1.2020) acc_x 62.5000 (70.3750) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1621
confident_label rate tensor(0.2666, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 836
clean true:829
clean false:7
clean_rate:0.9916267942583732
noisy true:686
noisy false:1614
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 2300
epoch [185/200] batch [5/26] time 0.482 (0.449) data 0.351 (0.318) loss_x loss_x 1.1865 (1.2869) acc_x 68.7500 (72.5000) lr 3.5443e-05 eta 0:00:09
epoch [185/200] batch [10/26] time 0.445 (0.442) data 0.314 (0.312) loss_x loss_x 1.3213 (1.2435) acc_x 71.8750 (70.6250) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [15/26] time 0.433 (0.440) data 0.302 (0.310) loss_x loss_x 0.6948 (1.2092) acc_x 84.3750 (72.0833) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [20/26] time 0.491 (0.442) data 0.360 (0.312) loss_x loss_x 1.2979 (1.1508) acc_x 68.7500 (72.1875) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/26] time 0.412 (0.445) data 0.281 (0.314) loss_x loss_x 1.8486 (1.1786) acc_x 59.3750 (71.5000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1605
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 839
clean true:834
clean false:5
clean_rate:0.9940405244338498
noisy true:697
noisy false:1600
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 2297
epoch [186/200] batch [5/26] time 0.524 (0.459) data 0.393 (0.328) loss_x loss_x 1.2988 (1.0710) acc_x 75.0000 (71.2500) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [10/26] time 0.460 (0.436) data 0.329 (0.305) loss_x loss_x 0.5674 (1.0006) acc_x 84.3750 (74.0625) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [15/26] time 0.400 (0.419) data 0.268 (0.288) loss_x loss_x 1.4277 (1.0885) acc_x 71.8750 (72.0833) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [20/26] time 0.542 (0.435) data 0.411 (0.304) loss_x loss_x 1.4600 (1.1091) acc_x 62.5000 (72.8125) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/26] time 0.481 (0.445) data 0.350 (0.314) loss_x loss_x 1.7109 (1.1408) acc_x 68.7500 (72.1250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.2462, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 772
clean true:767
clean false:5
clean_rate:0.9935233160621761
noisy true:699
noisy false:1665
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 2364
epoch [187/200] batch [5/24] time 0.474 (0.449) data 0.343 (0.319) loss_x loss_x 1.3369 (1.2563) acc_x 65.6250 (69.3750) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [10/24] time 0.514 (0.461) data 0.383 (0.330) loss_x loss_x 1.0273 (1.2925) acc_x 78.1250 (68.4375) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [15/24] time 0.443 (0.450) data 0.312 (0.319) loss_x loss_x 0.9297 (1.2238) acc_x 68.7500 (70.4167) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [20/24] time 0.401 (0.446) data 0.270 (0.316) loss_x loss_x 1.0820 (1.1972) acc_x 78.1250 (70.7812) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.2618, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 821
clean true:817
clean false:4
clean_rate:0.9951278928136419
noisy true:690
noisy false:1625
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 2315
epoch [188/200] batch [5/25] time 0.578 (0.444) data 0.448 (0.313) loss_x loss_x 1.4492 (1.2100) acc_x 68.7500 (71.8750) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [10/25] time 0.435 (0.444) data 0.305 (0.313) loss_x loss_x 1.1855 (1.1369) acc_x 75.0000 (72.8125) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [15/25] time 0.380 (0.429) data 0.249 (0.298) loss_x loss_x 0.9404 (1.1407) acc_x 68.7500 (72.0833) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [20/25] time 0.550 (0.452) data 0.419 (0.321) loss_x loss_x 0.9927 (1.1783) acc_x 71.8750 (71.2500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/25] time 0.427 (0.453) data 0.296 (0.322) loss_x loss_x 1.9326 (1.2328) acc_x 53.1250 (69.8750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.2653, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 832
clean true:825
clean false:7
clean_rate:0.9915865384615384
noisy true:675
noisy false:1629
after delete: len(clean_dataset) 832
after delete: len(noisy_dataset) 2304
epoch [189/200] batch [5/26] time 0.403 (0.470) data 0.272 (0.339) loss_x loss_x 0.8765 (1.1285) acc_x 81.2500 (70.0000) lr 2.0777e-05 eta 0:00:09
epoch [189/200] batch [10/26] time 0.381 (0.460) data 0.250 (0.329) loss_x loss_x 0.9243 (1.2559) acc_x 71.8750 (68.7500) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [15/26] time 0.586 (0.473) data 0.455 (0.343) loss_x loss_x 1.0264 (1.2404) acc_x 75.0000 (69.3750) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [20/26] time 0.446 (0.457) data 0.315 (0.326) loss_x loss_x 1.0078 (1.2076) acc_x 75.0000 (71.0938) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/26] time 0.347 (0.447) data 0.216 (0.316) loss_x loss_x 1.2734 (1.1850) acc_x 75.0000 (71.2500) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2679, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 840
clean true:836
clean false:4
clean_rate:0.9952380952380953
noisy true:660
noisy false:1636
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 2296
epoch [190/200] batch [5/26] time 0.447 (0.443) data 0.316 (0.312) loss_x loss_x 1.1299 (1.1064) acc_x 75.0000 (76.8750) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [10/26] time 0.431 (0.438) data 0.301 (0.308) loss_x loss_x 0.6621 (1.0486) acc_x 84.3750 (76.2500) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [15/26] time 0.649 (0.459) data 0.518 (0.328) loss_x loss_x 1.1006 (1.1222) acc_x 65.6250 (72.5000) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [20/26] time 0.359 (0.453) data 0.228 (0.322) loss_x loss_x 1.0850 (1.1204) acc_x 68.7500 (72.8125) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/26] time 0.424 (0.448) data 0.293 (0.317) loss_x loss_x 1.6943 (1.1661) acc_x 59.3750 (70.7500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1622
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 833
clean true:827
clean false:6
clean_rate:0.992797118847539
noisy true:687
noisy false:1616
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 2303
epoch [191/200] batch [5/26] time 0.457 (0.480) data 0.326 (0.349) loss_x loss_x 1.0498 (0.9995) acc_x 68.7500 (77.5000) lr 1.4891e-05 eta 0:00:10
epoch [191/200] batch [10/26] time 0.437 (0.476) data 0.306 (0.345) loss_x loss_x 1.4346 (1.0458) acc_x 78.1250 (75.9375) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [15/26] time 0.389 (0.469) data 0.258 (0.338) loss_x loss_x 1.0400 (1.1299) acc_x 71.8750 (72.2917) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [20/26] time 0.474 (0.453) data 0.343 (0.322) loss_x loss_x 0.6538 (1.1008) acc_x 87.5000 (73.9062) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/26] time 0.384 (0.460) data 0.254 (0.329) loss_x loss_x 1.6406 (1.1160) acc_x 59.3750 (73.1250) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2599, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 815
clean true:808
clean false:7
clean_rate:0.9914110429447853
noisy true:688
noisy false:1633
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 2321
epoch [192/200] batch [5/25] time 0.393 (0.427) data 0.262 (0.296) loss_x loss_x 1.2441 (1.1920) acc_x 68.7500 (68.7500) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [10/25] time 0.442 (0.463) data 0.311 (0.332) loss_x loss_x 1.0107 (1.1748) acc_x 75.0000 (71.5625) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [15/25] time 0.380 (0.462) data 0.249 (0.331) loss_x loss_x 1.0352 (1.1878) acc_x 84.3750 (71.0417) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [20/25] time 0.477 (0.451) data 0.346 (0.320) loss_x loss_x 1.0596 (1.2459) acc_x 75.0000 (70.3125) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/25] time 0.581 (0.452) data 0.450 (0.321) loss_x loss_x 0.9922 (1.2596) acc_x 78.1250 (69.7500) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 823
clean true:812
clean false:11
clean_rate:0.9866342648845686
noisy true:684
noisy false:1629
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 2313
epoch [193/200] batch [5/25] time 0.490 (0.426) data 0.359 (0.295) loss_x loss_x 1.1826 (1.3094) acc_x 78.1250 (71.8750) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [10/25] time 0.512 (0.428) data 0.381 (0.297) loss_x loss_x 0.9526 (1.3458) acc_x 68.7500 (67.1875) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [15/25] time 0.532 (0.441) data 0.401 (0.310) loss_x loss_x 1.1006 (1.2620) acc_x 75.0000 (68.5417) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [20/25] time 0.433 (0.439) data 0.302 (0.309) loss_x loss_x 1.2891 (1.2505) acc_x 65.6250 (67.9688) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/25] time 0.460 (0.440) data 0.329 (0.309) loss_x loss_x 1.0430 (1.2778) acc_x 81.2500 (67.6250) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1605
confident_label rate tensor(0.2679, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 840
clean true:832
clean false:8
clean_rate:0.9904761904761905
noisy true:699
noisy false:1597
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 2296
epoch [194/200] batch [5/26] time 0.399 (0.442) data 0.268 (0.311) loss_x loss_x 1.0430 (1.1105) acc_x 75.0000 (74.3750) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [10/26] time 0.470 (0.457) data 0.339 (0.326) loss_x loss_x 0.7544 (1.1215) acc_x 84.3750 (73.4375) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [15/26] time 0.468 (0.451) data 0.338 (0.320) loss_x loss_x 1.2988 (1.1307) acc_x 68.7500 (71.8750) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [20/26] time 0.398 (0.452) data 0.268 (0.321) loss_x loss_x 1.5928 (1.1850) acc_x 59.3750 (70.9375) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/26] time 0.407 (0.446) data 0.276 (0.315) loss_x loss_x 0.9800 (1.1587) acc_x 75.0000 (71.5000) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.2551, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 800
clean true:793
clean false:7
clean_rate:0.99125
noisy true:694
noisy false:1642
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 2336
epoch [195/200] batch [5/25] time 0.502 (0.436) data 0.371 (0.305) loss_x loss_x 1.0361 (1.0021) acc_x 71.8750 (76.2500) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/25] time 0.399 (0.429) data 0.268 (0.298) loss_x loss_x 1.4014 (1.1937) acc_x 65.6250 (72.5000) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [15/25] time 0.517 (0.447) data 0.386 (0.316) loss_x loss_x 1.3252 (1.2142) acc_x 65.6250 (70.6250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [20/25] time 0.486 (0.441) data 0.355 (0.310) loss_x loss_x 1.0459 (1.1918) acc_x 68.7500 (70.7812) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/25] time 0.369 (0.445) data 0.239 (0.315) loss_x loss_x 1.5020 (1.2234) acc_x 68.7500 (70.2500) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:806
clean false:6
clean_rate:0.9926108374384236
noisy true:673
noisy false:1651
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [196/200] batch [5/25] time 0.490 (0.473) data 0.359 (0.341) loss_x loss_x 1.1904 (1.1714) acc_x 68.7500 (72.5000) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [10/25] time 0.483 (0.461) data 0.352 (0.330) loss_x loss_x 0.9253 (1.2207) acc_x 78.1250 (70.9375) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [15/25] time 0.409 (0.482) data 0.278 (0.350) loss_x loss_x 0.9951 (1.2135) acc_x 68.7500 (71.0417) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [20/25] time 0.480 (0.465) data 0.349 (0.334) loss_x loss_x 0.7808 (1.2135) acc_x 81.2500 (71.0938) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/25] time 0.425 (0.465) data 0.295 (0.334) loss_x loss_x 1.3994 (1.1999) acc_x 65.6250 (71.3750) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.2577, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 808
clean true:802
clean false:6
clean_rate:0.9925742574257426
noisy true:700
noisy false:1628
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 2328
epoch [197/200] batch [5/25] time 0.474 (0.498) data 0.343 (0.367) loss_x loss_x 1.2354 (1.2500) acc_x 65.6250 (70.0000) lr 3.0827e-06 eta 0:00:09
epoch [197/200] batch [10/25] time 0.433 (0.458) data 0.303 (0.327) loss_x loss_x 1.0732 (1.4128) acc_x 75.0000 (67.1875) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [15/25] time 0.420 (0.475) data 0.288 (0.344) loss_x loss_x 1.2305 (1.3967) acc_x 65.6250 (65.8333) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [20/25] time 0.564 (0.484) data 0.432 (0.353) loss_x loss_x 1.3936 (1.4206) acc_x 68.7500 (65.9375) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/25] time 0.480 (0.481) data 0.349 (0.350) loss_x loss_x 1.6074 (1.3628) acc_x 59.3750 (66.7500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1617
confident_label rate tensor(0.2723, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 854
clean true:849
clean false:5
clean_rate:0.9941451990632318
noisy true:670
noisy false:1612
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 2282
epoch [198/200] batch [5/26] time 0.357 (0.447) data 0.226 (0.316) loss_x loss_x 1.8262 (1.2765) acc_x 53.1250 (69.3750) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [10/26] time 0.463 (0.425) data 0.333 (0.295) loss_x loss_x 0.8994 (1.2486) acc_x 65.6250 (67.8125) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [15/26] time 0.416 (0.418) data 0.285 (0.287) loss_x loss_x 1.3359 (1.2004) acc_x 75.0000 (71.0417) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [20/26] time 0.548 (0.433) data 0.417 (0.302) loss_x loss_x 1.4346 (1.2492) acc_x 59.3750 (69.6875) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/26] time 0.486 (0.443) data 0.355 (0.312) loss_x loss_x 1.2939 (1.2488) acc_x 56.2500 (68.6250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1597
confident_label rate tensor(0.2624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 823
clean true:820
clean false:3
clean_rate:0.9963547995139733
noisy true:719
noisy false:1594
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 2313
epoch [199/200] batch [5/25] time 0.352 (0.431) data 0.221 (0.300) loss_x loss_x 1.4600 (1.2206) acc_x 68.7500 (70.6250) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [10/25] time 0.437 (0.461) data 0.307 (0.330) loss_x loss_x 1.0518 (1.2317) acc_x 68.7500 (70.3125) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [15/25] time 0.370 (0.455) data 0.240 (0.324) loss_x loss_x 1.0850 (1.1676) acc_x 75.0000 (72.2917) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [20/25] time 0.340 (0.443) data 0.209 (0.312) loss_x loss_x 1.5400 (1.1747) acc_x 56.2500 (71.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/25] time 0.470 (0.441) data 0.340 (0.310) loss_x loss_x 0.9302 (1.1703) acc_x 75.0000 (71.8750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1658
confident_label rate tensor(0.2577, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 808
clean true:801
clean false:7
clean_rate:0.9913366336633663
noisy true:677
noisy false:1651
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 2328
epoch [200/200] batch [5/25] time 0.378 (0.420) data 0.247 (0.289) loss_x loss_x 1.3203 (1.3754) acc_x 71.8750 (65.6250) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [10/25] time 0.441 (0.428) data 0.311 (0.297) loss_x loss_x 1.0947 (1.3200) acc_x 71.8750 (69.3750) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [15/25] time 0.415 (0.430) data 0.284 (0.299) loss_x loss_x 0.7031 (1.2409) acc_x 84.3750 (70.4167) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [20/25] time 0.419 (0.438) data 0.288 (0.307) loss_x loss_x 1.7930 (1.2784) acc_x 53.1250 (70.0000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/25] time 0.502 (0.439) data 0.372 (0.308) loss_x loss_x 1.2832 (1.2559) acc_x 62.5000 (69.5000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,026
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 60.3%
Elapsed: 3:05:28
