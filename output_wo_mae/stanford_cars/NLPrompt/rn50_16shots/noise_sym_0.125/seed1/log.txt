***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1591, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 499
clean true:498
clean false:1
clean_rate:0.9979959919839679
noisy true:67
noisy false:2570
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 2637
epoch [1/200] batch [5/15] time 0.427 (0.452) data 0.297 (0.304) loss_x loss_x 2.6738 (2.9723) acc_x 46.8750 (44.3750) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [10/15] time 0.452 (0.462) data 0.321 (0.323) loss_x loss_x 2.9980 (2.7863) acc_x 28.1250 (46.5625) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [15/15] time 0.828 (0.485) data 0.698 (0.348) loss_x loss_x 2.8984 (2.6788) acc_x 43.7500 (46.6667) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2310
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 736
clean true:735
clean false:1
clean_rate:0.998641304347826
noisy true:91
noisy false:2309
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 2400
epoch [2/200] batch [5/23] time 0.452 (0.486) data 0.322 (0.356) loss_x loss_x 1.7539 (1.7951) acc_x 43.7500 (51.2500) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [10/23] time 0.486 (0.490) data 0.356 (0.360) loss_x loss_x 1.8506 (1.8396) acc_x 53.1250 (50.0000) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [15/23] time 0.539 (0.490) data 0.409 (0.360) loss_x loss_x 1.8359 (1.7838) acc_x 50.0000 (52.5000) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/23] time 0.401 (0.477) data 0.270 (0.347) loss_x loss_x 1.7979 (1.7777) acc_x 50.0000 (53.1250) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1935
confident_label rate tensor(0.3361, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1054
clean true:1053
clean false:1
clean_rate:0.9990512333965844
noisy true:148
noisy false:1934
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 2082
epoch [3/200] batch [5/32] time 0.535 (0.483) data 0.405 (0.352) loss_x loss_x 1.4844 (1.5115) acc_x 62.5000 (61.8750) lr 1.9999e-03 eta 0:00:13
epoch [3/200] batch [10/32] time 0.474 (0.502) data 0.342 (0.371) loss_x loss_x 1.7568 (1.5928) acc_x 62.5000 (60.9375) lr 1.9999e-03 eta 0:00:11
epoch [3/200] batch [15/32] time 0.494 (0.500) data 0.363 (0.369) loss_x loss_x 2.0781 (1.6344) acc_x 46.8750 (58.9583) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [20/32] time 0.402 (0.496) data 0.271 (0.365) loss_x loss_x 1.2715 (1.6079) acc_x 62.5000 (59.2188) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [25/32] time 0.403 (0.495) data 0.272 (0.364) loss_x loss_x 1.7285 (1.6184) acc_x 59.3750 (59.1250) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [30/32] time 0.528 (0.497) data 0.397 (0.366) loss_x loss_x 1.9648 (1.5943) acc_x 53.1250 (59.7917) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1869
confident_label rate tensor(0.3565, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1118
clean true:1116
clean false:2
clean_rate:0.998211091234347
noisy true:151
noisy false:1867
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 2018
epoch [4/200] batch [5/34] time 0.423 (0.520) data 0.292 (0.390) loss_x loss_x 1.5322 (1.5670) acc_x 56.2500 (60.6250) lr 1.9995e-03 eta 0:00:15
epoch [4/200] batch [10/34] time 0.526 (0.486) data 0.395 (0.356) loss_x loss_x 1.4971 (1.6062) acc_x 62.5000 (58.4375) lr 1.9995e-03 eta 0:00:11
epoch [4/200] batch [15/34] time 0.506 (0.478) data 0.375 (0.348) loss_x loss_x 1.4414 (1.6710) acc_x 65.6250 (55.8333) lr 1.9995e-03 eta 0:00:09
epoch [4/200] batch [20/34] time 0.418 (0.475) data 0.287 (0.344) loss_x loss_x 1.6982 (1.6443) acc_x 59.3750 (57.0312) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [25/34] time 0.459 (0.476) data 0.328 (0.345) loss_x loss_x 1.6074 (1.6331) acc_x 59.3750 (57.0000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [30/34] time 0.559 (0.475) data 0.429 (0.344) loss_x loss_x 1.5205 (1.5972) acc_x 62.5000 (57.5000) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1881
confident_label rate tensor(0.3501, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1098
clean true:1097
clean false:1
clean_rate:0.9990892531876139
noisy true:158
noisy false:1880
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 2038
epoch [5/200] batch [5/34] time 0.548 (0.468) data 0.418 (0.337) loss_x loss_x 1.2432 (1.5254) acc_x 71.8750 (61.2500) lr 1.9989e-03 eta 0:00:13
epoch [5/200] batch [10/34] time 0.548 (0.480) data 0.418 (0.349) loss_x loss_x 1.6875 (1.5501) acc_x 50.0000 (59.6875) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [15/34] time 0.458 (0.483) data 0.327 (0.352) loss_x loss_x 1.6807 (1.5653) acc_x 43.7500 (59.5833) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [20/34] time 0.362 (0.467) data 0.232 (0.337) loss_x loss_x 1.7002 (1.5695) acc_x 65.6250 (59.6875) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [25/34] time 0.517 (0.471) data 0.386 (0.340) loss_x loss_x 1.8633 (1.5730) acc_x 46.8750 (59.0000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [30/34] time 0.466 (0.470) data 0.335 (0.339) loss_x loss_x 2.1816 (1.5951) acc_x 37.5000 (59.2708) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1855
confident_label rate tensor(0.3565, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1118
clean true:1118
clean false:0
clean_rate:1.0
noisy true:163
noisy false:1855
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 2018
epoch [6/200] batch [5/34] time 0.468 (0.472) data 0.338 (0.341) loss_x loss_x 1.5068 (1.5498) acc_x 56.2500 (60.0000) lr 1.9980e-03 eta 0:00:13
epoch [6/200] batch [10/34] time 0.468 (0.466) data 0.338 (0.335) loss_x loss_x 1.2451 (1.3668) acc_x 65.6250 (63.7500) lr 1.9980e-03 eta 0:00:11
epoch [6/200] batch [15/34] time 0.641 (0.476) data 0.511 (0.346) loss_x loss_x 2.0547 (1.4071) acc_x 40.6250 (61.0417) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [20/34] time 0.449 (0.465) data 0.319 (0.334) loss_x loss_x 1.2490 (1.4539) acc_x 65.6250 (60.9375) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [25/34] time 0.455 (0.460) data 0.325 (0.329) loss_x loss_x 1.2383 (1.4809) acc_x 78.1250 (61.3750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [30/34] time 0.428 (0.456) data 0.297 (0.325) loss_x loss_x 1.7588 (1.4635) acc_x 59.3750 (62.1875) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1883
confident_label rate tensor(0.3495, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1096
clean true:1095
clean false:1
clean_rate:0.9990875912408759
noisy true:158
noisy false:1882
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 2040
epoch [7/200] batch [5/34] time 0.355 (0.433) data 0.225 (0.303) loss_x loss_x 1.6426 (1.5742) acc_x 53.1250 (58.7500) lr 1.9969e-03 eta 0:00:12
epoch [7/200] batch [10/34] time 0.335 (0.460) data 0.205 (0.330) loss_x loss_x 1.2764 (1.4817) acc_x 68.7500 (61.2500) lr 1.9969e-03 eta 0:00:11
epoch [7/200] batch [15/34] time 0.454 (0.455) data 0.324 (0.325) loss_x loss_x 1.5381 (1.5265) acc_x 59.3750 (59.3750) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [20/34] time 0.422 (0.461) data 0.291 (0.331) loss_x loss_x 1.6631 (1.5381) acc_x 43.7500 (59.0625) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [25/34] time 0.435 (0.458) data 0.305 (0.327) loss_x loss_x 1.3496 (1.5526) acc_x 59.3750 (59.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [30/34] time 0.456 (0.453) data 0.326 (0.323) loss_x loss_x 1.5957 (1.5918) acc_x 59.3750 (58.9583) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1796
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1178
clean true:1175
clean false:3
clean_rate:0.9974533106960951
noisy true:165
noisy false:1793
after delete: len(clean_dataset) 1178
after delete: len(noisy_dataset) 1958
epoch [8/200] batch [5/36] time 0.450 (0.443) data 0.319 (0.312) loss_x loss_x 1.7891 (1.6139) acc_x 46.8750 (57.5000) lr 1.9956e-03 eta 0:00:13
epoch [8/200] batch [10/36] time 0.466 (0.454) data 0.335 (0.324) loss_x loss_x 1.2549 (1.5181) acc_x 62.5000 (57.8125) lr 1.9956e-03 eta 0:00:11
epoch [8/200] batch [15/36] time 0.398 (0.466) data 0.267 (0.336) loss_x loss_x 1.4326 (1.5420) acc_x 71.8750 (58.5417) lr 1.9956e-03 eta 0:00:09
epoch [8/200] batch [20/36] time 0.651 (0.471) data 0.520 (0.341) loss_x loss_x 1.5879 (1.5577) acc_x 56.2500 (57.9688) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [25/36] time 0.505 (0.467) data 0.375 (0.337) loss_x loss_x 1.2900 (1.5413) acc_x 75.0000 (59.1250) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [30/36] time 0.388 (0.462) data 0.259 (0.332) loss_x loss_x 1.0166 (1.5083) acc_x 71.8750 (60.6250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [35/36] time 0.335 (0.456) data 0.204 (0.325) loss_x loss_x 1.1377 (1.5150) acc_x 62.5000 (60.5357) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.3680, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1154
clean true:1153
clean false:1
clean_rate:0.9991334488734835
noisy true:168
noisy false:1814
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 1982
epoch [9/200] batch [5/36] time 0.529 (0.489) data 0.397 (0.358) loss_x loss_x 1.9482 (1.4967) acc_x 50.0000 (61.2500) lr 1.9940e-03 eta 0:00:15
epoch [9/200] batch [10/36] time 0.543 (0.491) data 0.411 (0.360) loss_x loss_x 1.2803 (1.5317) acc_x 59.3750 (60.3125) lr 1.9940e-03 eta 0:00:12
epoch [9/200] batch [15/36] time 0.596 (0.503) data 0.465 (0.372) loss_x loss_x 1.4033 (1.4998) acc_x 59.3750 (60.8333) lr 1.9940e-03 eta 0:00:10
epoch [9/200] batch [20/36] time 0.384 (0.488) data 0.252 (0.357) loss_x loss_x 1.8662 (1.5788) acc_x 53.1250 (59.6875) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [25/36] time 0.389 (0.490) data 0.259 (0.359) loss_x loss_x 0.9253 (1.5721) acc_x 68.7500 (59.5000) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [30/36] time 0.450 (0.486) data 0.319 (0.355) loss_x loss_x 1.5488 (1.5664) acc_x 56.2500 (59.5833) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [35/36] time 0.472 (0.478) data 0.341 (0.347) loss_x loss_x 1.5938 (1.5617) acc_x 56.2500 (59.4643) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1829
confident_label rate tensor(0.3702, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1161
clean true:1159
clean false:2
clean_rate:0.9982773471145564
noisy true:148
noisy false:1827
after delete: len(clean_dataset) 1161
after delete: len(noisy_dataset) 1975
epoch [10/200] batch [5/36] time 0.388 (0.467) data 0.257 (0.336) loss_x loss_x 1.4902 (1.4377) acc_x 56.2500 (58.7500) lr 1.9921e-03 eta 0:00:14
epoch [10/200] batch [10/36] time 0.607 (0.481) data 0.476 (0.351) loss_x loss_x 1.3721 (1.4800) acc_x 56.2500 (58.4375) lr 1.9921e-03 eta 0:00:12
epoch [10/200] batch [15/36] time 0.410 (0.464) data 0.280 (0.333) loss_x loss_x 1.6396 (1.4811) acc_x 62.5000 (61.0417) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [20/36] time 0.483 (0.461) data 0.352 (0.330) loss_x loss_x 1.3252 (1.4889) acc_x 62.5000 (61.0938) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [25/36] time 0.469 (0.459) data 0.339 (0.328) loss_x loss_x 1.9375 (1.5711) acc_x 53.1250 (59.2500) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [30/36] time 0.474 (0.466) data 0.345 (0.335) loss_x loss_x 1.9443 (1.5739) acc_x 53.1250 (59.0625) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [35/36] time 0.382 (0.463) data 0.251 (0.332) loss_x loss_x 1.5713 (1.5621) acc_x 56.2500 (59.5536) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1197
clean true:1196
clean false:1
clean_rate:0.9991645781119465
noisy true:154
noisy false:1785
after delete: len(clean_dataset) 1197
after delete: len(noisy_dataset) 1939
epoch [11/200] batch [5/37] time 0.543 (0.477) data 0.412 (0.346) loss_x loss_x 1.5166 (1.4773) acc_x 53.1250 (62.5000) lr 1.9900e-03 eta 0:00:15
epoch [11/200] batch [10/37] time 0.458 (0.469) data 0.327 (0.339) loss_x loss_x 1.6367 (1.5172) acc_x 62.5000 (60.9375) lr 1.9900e-03 eta 0:00:12
epoch [11/200] batch [15/37] time 0.615 (0.482) data 0.484 (0.351) loss_x loss_x 1.5820 (1.5152) acc_x 62.5000 (60.8333) lr 1.9900e-03 eta 0:00:10
epoch [11/200] batch [20/37] time 0.396 (0.475) data 0.266 (0.345) loss_x loss_x 1.7441 (1.5418) acc_x 56.2500 (60.3125) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [25/37] time 0.473 (0.466) data 0.342 (0.336) loss_x loss_x 1.3203 (1.5141) acc_x 65.6250 (60.5000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [30/37] time 0.427 (0.464) data 0.296 (0.333) loss_x loss_x 1.3525 (1.5011) acc_x 68.7500 (60.9375) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [35/37] time 0.475 (0.466) data 0.344 (0.335) loss_x loss_x 1.7314 (1.5067) acc_x 59.3750 (60.7143) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1826
confident_label rate tensor(0.3661, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1148
clean true:1148
clean false:0
clean_rate:1.0
noisy true:162
noisy false:1826
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 1988
epoch [12/200] batch [5/35] time 0.423 (0.464) data 0.292 (0.333) loss_x loss_x 2.0293 (1.5836) acc_x 59.3750 (60.0000) lr 1.9877e-03 eta 0:00:13
epoch [12/200] batch [10/35] time 0.564 (0.485) data 0.433 (0.355) loss_x loss_x 1.4180 (1.5437) acc_x 59.3750 (58.1250) lr 1.9877e-03 eta 0:00:12
epoch [12/200] batch [15/35] time 0.337 (0.474) data 0.206 (0.343) loss_x loss_x 1.2842 (1.5757) acc_x 68.7500 (57.2917) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [20/35] time 0.435 (0.467) data 0.305 (0.337) loss_x loss_x 1.8809 (1.5717) acc_x 50.0000 (58.9062) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [25/35] time 0.431 (0.469) data 0.300 (0.338) loss_x loss_x 1.9346 (1.5739) acc_x 43.7500 (59.2500) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [30/35] time 0.647 (0.467) data 0.511 (0.336) loss_x loss_x 1.2617 (1.5662) acc_x 65.6250 (58.9583) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [35/35] time 0.418 (0.462) data 0.287 (0.331) loss_x loss_x 1.1016 (1.5234) acc_x 75.0000 (60.2679) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.3680, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1154
clean true:1153
clean false:1
clean_rate:0.9991334488734835
noisy true:166
noisy false:1816
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 1982
epoch [13/200] batch [5/36] time 0.426 (0.493) data 0.295 (0.362) loss_x loss_x 1.4395 (1.5428) acc_x 50.0000 (56.2500) lr 1.9851e-03 eta 0:00:15
epoch [13/200] batch [10/36] time 0.486 (0.484) data 0.356 (0.354) loss_x loss_x 1.3320 (1.4788) acc_x 62.5000 (59.3750) lr 1.9851e-03 eta 0:00:12
epoch [13/200] batch [15/36] time 0.384 (0.471) data 0.253 (0.340) loss_x loss_x 1.5215 (1.4545) acc_x 56.2500 (60.8333) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [20/36] time 0.427 (0.469) data 0.296 (0.338) loss_x loss_x 1.4551 (1.4374) acc_x 56.2500 (61.5625) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [25/36] time 0.469 (0.460) data 0.338 (0.330) loss_x loss_x 1.8594 (1.5247) acc_x 62.5000 (60.3750) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [30/36] time 0.415 (0.462) data 0.284 (0.331) loss_x loss_x 1.3867 (1.5213) acc_x 62.5000 (60.2083) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [35/36] time 0.409 (0.453) data 0.279 (0.322) loss_x loss_x 1.3408 (1.5102) acc_x 62.5000 (60.8036) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1837
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:163
noisy false:1836
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 1999
epoch [14/200] batch [5/35] time 0.489 (0.464) data 0.358 (0.333) loss_x loss_x 0.9995 (1.2604) acc_x 71.8750 (65.0000) lr 1.9823e-03 eta 0:00:13
epoch [14/200] batch [10/35] time 0.438 (0.433) data 0.307 (0.302) loss_x loss_x 1.3564 (1.4698) acc_x 68.7500 (60.9375) lr 1.9823e-03 eta 0:00:10
epoch [14/200] batch [15/35] time 0.420 (0.442) data 0.289 (0.311) loss_x loss_x 1.2754 (1.4675) acc_x 62.5000 (61.0417) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [20/35] time 0.580 (0.442) data 0.449 (0.311) loss_x loss_x 1.0918 (1.4503) acc_x 56.2500 (60.9375) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [25/35] time 0.478 (0.438) data 0.349 (0.307) loss_x loss_x 1.8604 (1.4619) acc_x 65.6250 (61.2500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [30/35] time 0.655 (0.457) data 0.524 (0.326) loss_x loss_x 1.3555 (1.4680) acc_x 59.3750 (61.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [35/35] time 0.535 (0.463) data 0.405 (0.332) loss_x loss_x 1.5312 (1.4647) acc_x 46.8750 (61.4286) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1790
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1201
clean true:1199
clean false:2
clean_rate:0.9983347210657785
noisy true:147
noisy false:1788
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 1935
epoch [15/200] batch [5/37] time 0.484 (0.527) data 0.354 (0.395) loss_x loss_x 1.1572 (1.4623) acc_x 71.8750 (65.0000) lr 1.9792e-03 eta 0:00:16
epoch [15/200] batch [10/37] time 0.444 (0.509) data 0.313 (0.378) loss_x loss_x 1.3604 (1.3979) acc_x 68.7500 (64.3750) lr 1.9792e-03 eta 0:00:13
epoch [15/200] batch [15/37] time 0.378 (0.483) data 0.247 (0.352) loss_x loss_x 1.3984 (1.4053) acc_x 71.8750 (63.5417) lr 1.9792e-03 eta 0:00:10
epoch [15/200] batch [20/37] time 0.400 (0.480) data 0.269 (0.349) loss_x loss_x 1.4639 (1.4770) acc_x 59.3750 (61.5625) lr 1.9792e-03 eta 0:00:08
epoch [15/200] batch [25/37] time 0.448 (0.492) data 0.317 (0.361) loss_x loss_x 1.3164 (1.4509) acc_x 56.2500 (62.0000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [30/37] time 0.595 (0.486) data 0.465 (0.355) loss_x loss_x 1.9941 (1.4833) acc_x 56.2500 (61.0417) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [35/37] time 0.446 (0.481) data 0.316 (0.350) loss_x loss_x 1.3291 (1.4833) acc_x 59.3750 (60.5357) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1824
confident_label rate tensor(0.3712, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1164
clean true:1164
clean false:0
clean_rate:1.0
noisy true:148
noisy false:1824
after delete: len(clean_dataset) 1164
after delete: len(noisy_dataset) 1972
epoch [16/200] batch [5/36] time 0.480 (0.420) data 0.349 (0.290) loss_x loss_x 1.3760 (1.5074) acc_x 68.7500 (59.3750) lr 1.9759e-03 eta 0:00:13
epoch [16/200] batch [10/36] time 0.456 (0.440) data 0.320 (0.308) loss_x loss_x 1.8828 (1.4768) acc_x 56.2500 (60.0000) lr 1.9759e-03 eta 0:00:11
epoch [16/200] batch [15/36] time 0.440 (0.451) data 0.309 (0.320) loss_x loss_x 1.4746 (1.4457) acc_x 56.2500 (59.1667) lr 1.9759e-03 eta 0:00:09
epoch [16/200] batch [20/36] time 0.394 (0.454) data 0.263 (0.323) loss_x loss_x 1.4697 (1.5007) acc_x 53.1250 (58.9062) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [25/36] time 0.382 (0.465) data 0.251 (0.334) loss_x loss_x 1.9326 (1.5246) acc_x 46.8750 (58.3750) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [30/36] time 0.538 (0.462) data 0.407 (0.331) loss_x loss_x 1.8320 (1.5361) acc_x 53.1250 (57.8125) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [35/36] time 0.448 (0.459) data 0.317 (0.328) loss_x loss_x 1.7549 (1.5781) acc_x 56.2500 (56.6071) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1761
confident_label rate tensor(0.3887, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1219
clean true:1218
clean false:1
clean_rate:0.9991796554552912
noisy true:157
noisy false:1760
after delete: len(clean_dataset) 1219
after delete: len(noisy_dataset) 1917
epoch [17/200] batch [5/38] time 0.469 (0.427) data 0.339 (0.296) loss_x loss_x 1.4492 (1.5861) acc_x 59.3750 (53.1250) lr 1.9724e-03 eta 0:00:14
epoch [17/200] batch [10/38] time 0.491 (0.424) data 0.360 (0.293) loss_x loss_x 2.0938 (1.5575) acc_x 50.0000 (56.2500) lr 1.9724e-03 eta 0:00:11
epoch [17/200] batch [15/38] time 0.493 (0.438) data 0.362 (0.308) loss_x loss_x 1.4971 (1.5905) acc_x 56.2500 (56.8750) lr 1.9724e-03 eta 0:00:10
epoch [17/200] batch [20/38] time 0.458 (0.459) data 0.327 (0.328) loss_x loss_x 1.7998 (1.5870) acc_x 46.8750 (57.8125) lr 1.9724e-03 eta 0:00:08
epoch [17/200] batch [25/38] time 0.500 (0.477) data 0.370 (0.347) loss_x loss_x 1.1816 (1.5325) acc_x 62.5000 (58.6250) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [30/38] time 0.379 (0.466) data 0.248 (0.335) loss_x loss_x 1.7080 (1.5563) acc_x 53.1250 (59.1667) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [35/38] time 0.450 (0.470) data 0.320 (0.339) loss_x loss_x 1.0996 (1.5595) acc_x 59.3750 (59.1071) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1201
clean true:1198
clean false:3
clean_rate:0.9975020815986678
noisy true:170
noisy false:1765
after delete: len(clean_dataset) 1201
after delete: len(noisy_dataset) 1935
epoch [18/200] batch [5/37] time 0.620 (0.470) data 0.489 (0.339) loss_x loss_x 1.8965 (1.6052) acc_x 46.8750 (61.2500) lr 1.9686e-03 eta 0:00:15
epoch [18/200] batch [10/37] time 0.420 (0.484) data 0.291 (0.353) loss_x loss_x 1.1875 (1.4494) acc_x 65.6250 (61.8750) lr 1.9686e-03 eta 0:00:13
epoch [18/200] batch [15/37] time 0.385 (0.460) data 0.254 (0.329) loss_x loss_x 1.6670 (1.5545) acc_x 53.1250 (58.9583) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [20/37] time 0.351 (0.448) data 0.221 (0.318) loss_x loss_x 2.0449 (1.5340) acc_x 40.6250 (58.4375) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [25/37] time 0.409 (0.444) data 0.280 (0.313) loss_x loss_x 1.9043 (1.5461) acc_x 46.8750 (58.1250) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [30/37] time 0.452 (0.451) data 0.322 (0.321) loss_x loss_x 1.4062 (1.5166) acc_x 68.7500 (59.2708) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [35/37] time 0.502 (0.459) data 0.371 (0.329) loss_x loss_x 1.4795 (1.5464) acc_x 56.2500 (58.8393) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1791
confident_label rate tensor(0.3785, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1187
clean true:1184
clean false:3
clean_rate:0.9974726200505476
noisy true:161
noisy false:1788
after delete: len(clean_dataset) 1187
after delete: len(noisy_dataset) 1949
epoch [19/200] batch [5/37] time 0.582 (0.457) data 0.452 (0.326) loss_x loss_x 1.3711 (1.4035) acc_x 68.7500 (64.3750) lr 1.9646e-03 eta 0:00:14
epoch [19/200] batch [10/37] time 0.459 (0.456) data 0.329 (0.326) loss_x loss_x 0.9458 (1.4085) acc_x 75.0000 (65.0000) lr 1.9646e-03 eta 0:00:12
epoch [19/200] batch [15/37] time 0.494 (0.457) data 0.363 (0.326) loss_x loss_x 1.4961 (1.4510) acc_x 65.6250 (63.7500) lr 1.9646e-03 eta 0:00:10
epoch [19/200] batch [20/37] time 0.559 (0.468) data 0.428 (0.337) loss_x loss_x 1.3271 (1.4424) acc_x 68.7500 (64.2188) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [25/37] time 0.479 (0.460) data 0.349 (0.329) loss_x loss_x 1.6816 (1.4335) acc_x 65.6250 (65.1250) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [30/37] time 0.369 (0.460) data 0.239 (0.330) loss_x loss_x 1.4561 (1.4188) acc_x 53.1250 (65.0000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [35/37] time 0.582 (0.461) data 0.452 (0.331) loss_x loss_x 1.2637 (1.4162) acc_x 65.6250 (64.8214) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.3881, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1217
clean true:1215
clean false:2
clean_rate:0.9983566146261298
noisy true:164
noisy false:1755
after delete: len(clean_dataset) 1217
after delete: len(noisy_dataset) 1919
epoch [20/200] batch [5/38] time 0.487 (0.445) data 0.356 (0.314) loss_x loss_x 1.3086 (1.2225) acc_x 62.5000 (66.8750) lr 1.9603e-03 eta 0:00:14
epoch [20/200] batch [10/38] time 0.373 (0.440) data 0.242 (0.309) loss_x loss_x 1.6035 (1.3889) acc_x 56.2500 (62.8125) lr 1.9603e-03 eta 0:00:12
epoch [20/200] batch [15/38] time 0.352 (0.441) data 0.221 (0.310) loss_x loss_x 1.4365 (1.4277) acc_x 59.3750 (61.4583) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [20/38] time 0.481 (0.454) data 0.350 (0.323) loss_x loss_x 1.4814 (1.4785) acc_x 71.8750 (61.2500) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [25/38] time 0.451 (0.461) data 0.320 (0.330) loss_x loss_x 1.7119 (1.4847) acc_x 56.2500 (61.1250) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [30/38] time 0.425 (0.465) data 0.294 (0.334) loss_x loss_x 1.4590 (1.4670) acc_x 68.7500 (61.7708) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [35/38] time 0.396 (0.462) data 0.266 (0.332) loss_x loss_x 1.3477 (1.4734) acc_x 62.5000 (60.8036) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.3893, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1221
clean true:1220
clean false:1
clean_rate:0.9991809991809992
noisy true:159
noisy false:1756
after delete: len(clean_dataset) 1221
after delete: len(noisy_dataset) 1915
epoch [21/200] batch [5/38] time 0.485 (0.453) data 0.354 (0.322) loss_x loss_x 1.5703 (1.6816) acc_x 56.2500 (55.0000) lr 1.9558e-03 eta 0:00:14
epoch [21/200] batch [10/38] time 0.530 (0.458) data 0.399 (0.327) loss_x loss_x 1.7227 (1.7024) acc_x 50.0000 (53.7500) lr 1.9558e-03 eta 0:00:12
epoch [21/200] batch [15/38] time 0.475 (0.461) data 0.345 (0.330) loss_x loss_x 1.3838 (1.6497) acc_x 62.5000 (55.6250) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [20/38] time 0.445 (0.448) data 0.314 (0.317) loss_x loss_x 1.2432 (1.5931) acc_x 65.6250 (57.0312) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [25/38] time 0.374 (0.447) data 0.244 (0.317) loss_x loss_x 1.3848 (1.5699) acc_x 50.0000 (57.3750) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [30/38] time 0.526 (0.456) data 0.395 (0.326) loss_x loss_x 1.2295 (1.5271) acc_x 65.6250 (58.2292) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [35/38] time 0.511 (0.457) data 0.381 (0.327) loss_x loss_x 1.4121 (1.5067) acc_x 56.2500 (58.3929) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.3833, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1202
clean true:1202
clean false:0
clean_rate:1.0
noisy true:150
noisy false:1784
after delete: len(clean_dataset) 1202
after delete: len(noisy_dataset) 1934
epoch [22/200] batch [5/37] time 0.468 (0.447) data 0.337 (0.317) loss_x loss_x 1.4697 (1.4602) acc_x 62.5000 (63.7500) lr 1.9511e-03 eta 0:00:14
epoch [22/200] batch [10/37] time 0.359 (0.449) data 0.228 (0.318) loss_x loss_x 1.8867 (1.5953) acc_x 46.8750 (59.3750) lr 1.9511e-03 eta 0:00:12
epoch [22/200] batch [15/37] time 0.513 (0.460) data 0.382 (0.329) loss_x loss_x 1.4932 (1.4933) acc_x 46.8750 (60.6250) lr 1.9511e-03 eta 0:00:10
epoch [22/200] batch [20/37] time 0.470 (0.453) data 0.338 (0.322) loss_x loss_x 1.0732 (1.4915) acc_x 84.3750 (61.2500) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [25/37] time 0.478 (0.471) data 0.348 (0.340) loss_x loss_x 1.4209 (1.5198) acc_x 65.6250 (60.5000) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [30/37] time 0.467 (0.479) data 0.336 (0.348) loss_x loss_x 1.4629 (1.5187) acc_x 62.5000 (60.3125) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [35/37] time 0.415 (0.476) data 0.284 (0.345) loss_x loss_x 1.1709 (1.4846) acc_x 81.2500 (61.6964) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1764
confident_label rate tensor(0.3913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1227
clean true:1226
clean false:1
clean_rate:0.9991850040749797
noisy true:146
noisy false:1763
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 1909
epoch [23/200] batch [5/38] time 0.377 (0.450) data 0.247 (0.319) loss_x loss_x 1.6924 (1.5689) acc_x 62.5000 (63.1250) lr 1.9461e-03 eta 0:00:14
epoch [23/200] batch [10/38] time 0.437 (0.439) data 0.307 (0.308) loss_x loss_x 2.0684 (1.5545) acc_x 59.3750 (65.0000) lr 1.9461e-03 eta 0:00:12
epoch [23/200] batch [15/38] time 0.439 (0.449) data 0.308 (0.318) loss_x loss_x 1.2646 (1.5220) acc_x 75.0000 (64.3750) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [20/38] time 0.382 (0.446) data 0.252 (0.315) loss_x loss_x 1.2881 (1.4786) acc_x 71.8750 (64.6875) lr 1.9461e-03 eta 0:00:08
epoch [23/200] batch [25/38] time 0.545 (0.446) data 0.415 (0.315) loss_x loss_x 1.1641 (1.4329) acc_x 68.7500 (64.3750) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [30/38] time 0.502 (0.450) data 0.372 (0.319) loss_x loss_x 1.9229 (1.4537) acc_x 43.7500 (62.8125) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [35/38] time 0.518 (0.458) data 0.388 (0.328) loss_x loss_x 1.9883 (1.4510) acc_x 53.1250 (62.6786) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.3909, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1226
clean true:1225
clean false:1
clean_rate:0.9991843393148451
noisy true:152
noisy false:1758
after delete: len(clean_dataset) 1226
after delete: len(noisy_dataset) 1910
epoch [24/200] batch [5/38] time 0.529 (0.420) data 0.398 (0.289) loss_x loss_x 1.7090 (1.3557) acc_x 62.5000 (68.1250) lr 1.9409e-03 eta 0:00:13
epoch [24/200] batch [10/38] time 0.471 (0.455) data 0.340 (0.325) loss_x loss_x 1.3164 (1.3892) acc_x 75.0000 (66.5625) lr 1.9409e-03 eta 0:00:12
epoch [24/200] batch [15/38] time 0.906 (0.502) data 0.765 (0.370) loss_x loss_x 1.3320 (1.3468) acc_x 62.5000 (67.5000) lr 1.9409e-03 eta 0:00:11
epoch [24/200] batch [20/38] time 0.451 (0.515) data 0.321 (0.383) loss_x loss_x 1.0039 (1.3386) acc_x 78.1250 (67.0312) lr 1.9409e-03 eta 0:00:09
epoch [24/200] batch [25/38] time 0.478 (0.504) data 0.348 (0.372) loss_x loss_x 1.6973 (1.3998) acc_x 59.3750 (65.1250) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [30/38] time 0.488 (0.492) data 0.356 (0.360) loss_x loss_x 1.5547 (1.4309) acc_x 59.3750 (63.3333) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [35/38] time 0.414 (0.488) data 0.284 (0.357) loss_x loss_x 1.2744 (1.4097) acc_x 68.7500 (63.9286) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1707
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1274
clean true:1271
clean false:3
clean_rate:0.9976452119309263
noisy true:158
noisy false:1704
after delete: len(clean_dataset) 1274
after delete: len(noisy_dataset) 1862
epoch [25/200] batch [5/39] time 0.431 (0.427) data 0.301 (0.296) loss_x loss_x 1.3242 (1.5043) acc_x 62.5000 (56.8750) lr 1.9354e-03 eta 0:00:14
epoch [25/200] batch [10/39] time 0.346 (0.460) data 0.215 (0.329) loss_x loss_x 1.6123 (1.5762) acc_x 59.3750 (57.8125) lr 1.9354e-03 eta 0:00:13
epoch [25/200] batch [15/39] time 0.603 (0.463) data 0.472 (0.332) loss_x loss_x 0.9922 (1.5174) acc_x 75.0000 (60.4167) lr 1.9354e-03 eta 0:00:11
epoch [25/200] batch [20/39] time 0.515 (0.455) data 0.384 (0.324) loss_x loss_x 1.4111 (1.5434) acc_x 62.5000 (60.0000) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [25/39] time 0.528 (0.454) data 0.397 (0.323) loss_x loss_x 1.7178 (1.5377) acc_x 50.0000 (59.7500) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [30/39] time 0.541 (0.462) data 0.411 (0.331) loss_x loss_x 1.4375 (1.5170) acc_x 62.5000 (60.2083) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [35/39] time 0.416 (0.457) data 0.285 (0.326) loss_x loss_x 1.8652 (1.5264) acc_x 46.8750 (59.5536) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1726
confident_label rate tensor(0.4027, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1263
clean true:1262
clean false:1
clean_rate:0.9992082343626286
noisy true:148
noisy false:1725
after delete: len(clean_dataset) 1263
after delete: len(noisy_dataset) 1873
epoch [26/200] batch [5/39] time 0.370 (0.451) data 0.239 (0.320) loss_x loss_x 1.2109 (1.3273) acc_x 65.6250 (62.5000) lr 1.9298e-03 eta 0:00:15
epoch [26/200] batch [10/39] time 0.420 (0.480) data 0.289 (0.349) loss_x loss_x 1.1338 (1.3022) acc_x 71.8750 (64.3750) lr 1.9298e-03 eta 0:00:13
epoch [26/200] batch [15/39] time 0.444 (0.466) data 0.314 (0.336) loss_x loss_x 1.7822 (1.3848) acc_x 50.0000 (62.5000) lr 1.9298e-03 eta 0:00:11
epoch [26/200] batch [20/39] time 0.477 (0.472) data 0.347 (0.341) loss_x loss_x 1.4707 (1.3892) acc_x 59.3750 (62.5000) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [25/39] time 0.408 (0.463) data 0.277 (0.333) loss_x loss_x 1.6855 (1.4002) acc_x 59.3750 (62.1250) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [30/39] time 0.451 (0.464) data 0.320 (0.334) loss_x loss_x 1.3457 (1.4190) acc_x 59.3750 (62.1875) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [35/39] time 0.431 (0.465) data 0.300 (0.334) loss_x loss_x 1.1777 (1.4286) acc_x 68.7500 (61.5179) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1745
confident_label rate tensor(0.3903, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1224
clean true:1223
clean false:1
clean_rate:0.9991830065359477
noisy true:168
noisy false:1744
after delete: len(clean_dataset) 1224
after delete: len(noisy_dataset) 1912
epoch [27/200] batch [5/38] time 0.468 (0.448) data 0.339 (0.318) loss_x loss_x 1.4580 (1.4875) acc_x 65.6250 (65.0000) lr 1.9239e-03 eta 0:00:14
epoch [27/200] batch [10/38] time 0.421 (0.455) data 0.290 (0.325) loss_x loss_x 1.9424 (1.5419) acc_x 56.2500 (62.1875) lr 1.9239e-03 eta 0:00:12
epoch [27/200] batch [15/38] time 0.424 (0.456) data 0.293 (0.326) loss_x loss_x 1.1514 (1.4956) acc_x 78.1250 (63.7500) lr 1.9239e-03 eta 0:00:10
epoch [27/200] batch [20/38] time 0.492 (0.453) data 0.361 (0.322) loss_x loss_x 1.7129 (1.4979) acc_x 65.6250 (64.3750) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [25/38] time 0.525 (0.457) data 0.394 (0.327) loss_x loss_x 1.6143 (1.4523) acc_x 62.5000 (65.2500) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [30/38] time 0.462 (0.452) data 0.332 (0.321) loss_x loss_x 1.6914 (1.4430) acc_x 53.1250 (65.3125) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [35/38] time 0.449 (0.452) data 0.319 (0.322) loss_x loss_x 1.0693 (1.4187) acc_x 71.8750 (65.0893) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.3992, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1252
clean true:1251
clean false:1
clean_rate:0.9992012779552716
noisy true:160
noisy false:1724
after delete: len(clean_dataset) 1252
after delete: len(noisy_dataset) 1884
epoch [28/200] batch [5/39] time 0.536 (0.456) data 0.405 (0.325) loss_x loss_x 1.2246 (1.3123) acc_x 68.7500 (67.5000) lr 1.9178e-03 eta 0:00:15
epoch [28/200] batch [10/39] time 0.370 (0.466) data 0.239 (0.335) loss_x loss_x 1.4541 (1.4201) acc_x 62.5000 (62.8125) lr 1.9178e-03 eta 0:00:13
epoch [28/200] batch [15/39] time 0.428 (0.477) data 0.297 (0.346) loss_x loss_x 1.4785 (1.4048) acc_x 59.3750 (62.5000) lr 1.9178e-03 eta 0:00:11
epoch [28/200] batch [20/39] time 0.391 (0.469) data 0.260 (0.338) loss_x loss_x 1.4375 (1.4167) acc_x 68.7500 (62.6562) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [25/39] time 0.410 (0.468) data 0.279 (0.337) loss_x loss_x 1.9033 (1.4759) acc_x 50.0000 (61.3750) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [30/39] time 0.500 (0.462) data 0.369 (0.331) loss_x loss_x 1.8252 (1.4897) acc_x 59.3750 (61.1458) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [35/39] time 0.478 (0.461) data 0.343 (0.330) loss_x loss_x 1.7578 (1.4978) acc_x 53.1250 (60.8929) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1741
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1249
clean true:1246
clean false:3
clean_rate:0.9975980784627703
noisy true:149
noisy false:1738
after delete: len(clean_dataset) 1249
after delete: len(noisy_dataset) 1887
epoch [29/200] batch [5/39] time 0.423 (0.487) data 0.292 (0.357) loss_x loss_x 1.3350 (1.3453) acc_x 68.7500 (68.1250) lr 1.9114e-03 eta 0:00:16
epoch [29/200] batch [10/39] time 0.481 (0.472) data 0.350 (0.342) loss_x loss_x 1.1230 (1.3583) acc_x 75.0000 (66.5625) lr 1.9114e-03 eta 0:00:13
epoch [29/200] batch [15/39] time 0.506 (0.473) data 0.375 (0.342) loss_x loss_x 1.4980 (1.4879) acc_x 62.5000 (62.9167) lr 1.9114e-03 eta 0:00:11
epoch [29/200] batch [20/39] time 0.451 (0.466) data 0.320 (0.336) loss_x loss_x 1.5439 (1.5072) acc_x 53.1250 (62.1875) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [25/39] time 0.405 (0.477) data 0.274 (0.346) loss_x loss_x 1.1621 (1.4595) acc_x 71.8750 (63.2500) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [30/39] time 0.454 (0.477) data 0.323 (0.347) loss_x loss_x 1.4756 (1.4635) acc_x 62.5000 (62.1875) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [35/39] time 0.467 (0.472) data 0.336 (0.341) loss_x loss_x 1.3975 (1.4551) acc_x 65.6250 (62.5000) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1279
clean true:1278
clean false:1
clean_rate:0.9992181391712275
noisy true:149
noisy false:1708
after delete: len(clean_dataset) 1279
after delete: len(noisy_dataset) 1857
epoch [30/200] batch [5/39] time 0.403 (0.447) data 0.273 (0.316) loss_x loss_x 1.0664 (1.1711) acc_x 62.5000 (65.6250) lr 1.9048e-03 eta 0:00:15
epoch [30/200] batch [10/39] time 0.405 (0.459) data 0.274 (0.328) loss_x loss_x 1.6533 (1.3457) acc_x 59.3750 (64.0625) lr 1.9048e-03 eta 0:00:13
epoch [30/200] batch [15/39] time 0.447 (0.463) data 0.317 (0.332) loss_x loss_x 1.2500 (1.3247) acc_x 65.6250 (64.3750) lr 1.9048e-03 eta 0:00:11
epoch [30/200] batch [20/39] time 0.494 (0.463) data 0.363 (0.333) loss_x loss_x 1.6914 (1.3459) acc_x 59.3750 (64.8438) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [25/39] time 0.394 (0.468) data 0.263 (0.338) loss_x loss_x 2.1816 (1.4051) acc_x 46.8750 (64.0000) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [30/39] time 0.510 (0.466) data 0.380 (0.335) loss_x loss_x 1.1875 (1.3881) acc_x 75.0000 (63.8542) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [35/39] time 0.425 (0.471) data 0.295 (0.340) loss_x loss_x 1.1416 (1.3925) acc_x 65.6250 (63.3929) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1215
clean true:1214
clean false:1
clean_rate:0.9991769547325103
noisy true:165
noisy false:1756
after delete: len(clean_dataset) 1215
after delete: len(noisy_dataset) 1921
epoch [31/200] batch [5/37] time 0.438 (0.484) data 0.308 (0.353) loss_x loss_x 1.4561 (1.3596) acc_x 65.6250 (66.2500) lr 1.8980e-03 eta 0:00:15
epoch [31/200] batch [10/37] time 0.415 (0.469) data 0.285 (0.338) loss_x loss_x 1.2441 (1.3858) acc_x 68.7500 (62.8125) lr 1.8980e-03 eta 0:00:12
epoch [31/200] batch [15/37] time 0.545 (0.468) data 0.415 (0.337) loss_x loss_x 0.7964 (1.3237) acc_x 84.3750 (64.7917) lr 1.8980e-03 eta 0:00:10
epoch [31/200] batch [20/37] time 0.520 (0.479) data 0.389 (0.348) loss_x loss_x 1.3691 (1.3239) acc_x 68.7500 (65.0000) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [25/37] time 0.492 (0.479) data 0.361 (0.349) loss_x loss_x 1.3838 (1.3019) acc_x 68.7500 (64.6250) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [30/37] time 0.415 (0.481) data 0.284 (0.350) loss_x loss_x 1.8721 (1.3197) acc_x 56.2500 (64.8958) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [35/37] time 0.612 (0.483) data 0.481 (0.353) loss_x loss_x 1.5342 (1.3835) acc_x 68.7500 (63.9286) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.4101, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1286
clean true:1284
clean false:2
clean_rate:0.9984447900466563
noisy true:168
noisy false:1682
after delete: len(clean_dataset) 1286
after delete: len(noisy_dataset) 1850
epoch [32/200] batch [5/40] time 0.553 (0.501) data 0.422 (0.369) loss_x loss_x 1.7373 (1.5742) acc_x 59.3750 (61.8750) lr 1.8910e-03 eta 0:00:17
epoch [32/200] batch [10/40] time 0.427 (0.474) data 0.297 (0.343) loss_x loss_x 1.1445 (1.4702) acc_x 75.0000 (65.6250) lr 1.8910e-03 eta 0:00:14
epoch [32/200] batch [15/40] time 0.440 (0.463) data 0.309 (0.333) loss_x loss_x 1.0840 (1.4840) acc_x 75.0000 (64.5833) lr 1.8910e-03 eta 0:00:11
epoch [32/200] batch [20/40] time 0.525 (0.465) data 0.395 (0.335) loss_x loss_x 1.3672 (1.4470) acc_x 65.6250 (64.0625) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [25/40] time 0.447 (0.457) data 0.316 (0.327) loss_x loss_x 1.4170 (1.4650) acc_x 65.6250 (63.6250) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [30/40] time 0.461 (0.451) data 0.331 (0.320) loss_x loss_x 1.1816 (1.4460) acc_x 65.6250 (64.2708) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [35/40] time 0.399 (0.456) data 0.268 (0.326) loss_x loss_x 1.4121 (1.4516) acc_x 62.5000 (64.1964) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [40/40] time 0.463 (0.455) data 0.333 (0.325) loss_x loss_x 1.5918 (1.4558) acc_x 62.5000 (64.2188) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1708
confident_label rate tensor(0.3992, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1252
clean true:1251
clean false:1
clean_rate:0.9992012779552716
noisy true:177
noisy false:1707
after delete: len(clean_dataset) 1252
after delete: len(noisy_dataset) 1884
epoch [33/200] batch [5/39] time 0.534 (0.479) data 0.403 (0.348) loss_x loss_x 2.0605 (1.6139) acc_x 40.6250 (57.5000) lr 1.8838e-03 eta 0:00:16
epoch [33/200] batch [10/39] time 0.483 (0.452) data 0.349 (0.321) loss_x loss_x 1.7539 (1.5215) acc_x 56.2500 (59.0625) lr 1.8838e-03 eta 0:00:13
epoch [33/200] batch [15/39] time 0.484 (0.470) data 0.353 (0.339) loss_x loss_x 1.5645 (1.4766) acc_x 62.5000 (61.0417) lr 1.8838e-03 eta 0:00:11
epoch [33/200] batch [20/39] time 0.599 (0.480) data 0.468 (0.348) loss_x loss_x 1.9170 (1.4412) acc_x 40.6250 (61.2500) lr 1.8838e-03 eta 0:00:09
epoch [33/200] batch [25/39] time 0.486 (0.476) data 0.355 (0.345) loss_x loss_x 1.0635 (1.3970) acc_x 75.0000 (62.5000) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [30/39] time 0.416 (0.473) data 0.285 (0.341) loss_x loss_x 1.4941 (1.4014) acc_x 65.6250 (62.7083) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [35/39] time 0.396 (0.466) data 0.265 (0.335) loss_x loss_x 1.4863 (1.4084) acc_x 71.8750 (63.1250) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1280
clean true:1280
clean false:0
clean_rate:1.0
noisy true:161
noisy false:1695
after delete: len(clean_dataset) 1280
after delete: len(noisy_dataset) 1856
epoch [34/200] batch [5/40] time 0.419 (0.466) data 0.289 (0.336) loss_x loss_x 1.1768 (1.3203) acc_x 65.6250 (65.0000) lr 1.8763e-03 eta 0:00:16
epoch [34/200] batch [10/40] time 0.444 (0.464) data 0.313 (0.334) loss_x loss_x 1.3623 (1.3092) acc_x 75.0000 (66.5625) lr 1.8763e-03 eta 0:00:13
epoch [34/200] batch [15/40] time 0.474 (0.464) data 0.344 (0.333) loss_x loss_x 1.0107 (1.2908) acc_x 71.8750 (65.8333) lr 1.8763e-03 eta 0:00:11
epoch [34/200] batch [20/40] time 0.490 (0.458) data 0.360 (0.327) loss_x loss_x 1.1582 (1.3181) acc_x 59.3750 (64.2188) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [25/40] time 0.371 (0.462) data 0.240 (0.331) loss_x loss_x 1.4170 (1.3606) acc_x 65.6250 (63.7500) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [30/40] time 0.470 (0.458) data 0.339 (0.327) loss_x loss_x 1.2578 (1.3676) acc_x 62.5000 (63.0208) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [35/40] time 0.437 (0.457) data 0.306 (0.326) loss_x loss_x 1.0010 (1.3595) acc_x 78.1250 (63.3036) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [40/40] time 0.516 (0.466) data 0.385 (0.335) loss_x loss_x 1.4785 (1.3825) acc_x 62.5000 (62.9688) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.4011, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1258
clean true:1256
clean false:2
clean_rate:0.9984101748807631
noisy true:149
noisy false:1729
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 1878
epoch [35/200] batch [5/39] time 0.379 (0.453) data 0.248 (0.322) loss_x loss_x 1.4609 (1.2457) acc_x 62.5000 (66.2500) lr 1.8686e-03 eta 0:00:15
epoch [35/200] batch [10/39] time 0.449 (0.465) data 0.318 (0.334) loss_x loss_x 1.2334 (1.3752) acc_x 62.5000 (63.4375) lr 1.8686e-03 eta 0:00:13
epoch [35/200] batch [15/39] time 0.414 (0.462) data 0.283 (0.331) loss_x loss_x 1.3711 (1.3562) acc_x 71.8750 (64.5833) lr 1.8686e-03 eta 0:00:11
epoch [35/200] batch [20/39] time 0.459 (0.463) data 0.329 (0.333) loss_x loss_x 1.7051 (1.3911) acc_x 62.5000 (64.3750) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [25/39] time 0.625 (0.469) data 0.494 (0.338) loss_x loss_x 1.1113 (1.3695) acc_x 65.6250 (63.8750) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [30/39] time 0.695 (0.478) data 0.564 (0.347) loss_x loss_x 1.3438 (1.3631) acc_x 62.5000 (63.8542) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [35/39] time 0.367 (0.469) data 0.237 (0.338) loss_x loss_x 1.2178 (1.3539) acc_x 75.0000 (64.0179) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1741
confident_label rate tensor(0.3976, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1247
clean true:1244
clean false:3
clean_rate:0.9975942261427426
noisy true:151
noisy false:1738
after delete: len(clean_dataset) 1247
after delete: len(noisy_dataset) 1889
epoch [36/200] batch [5/38] time 0.532 (0.465) data 0.402 (0.335) loss_x loss_x 1.1602 (1.4641) acc_x 71.8750 (61.2500) lr 1.8607e-03 eta 0:00:15
epoch [36/200] batch [10/38] time 0.676 (0.478) data 0.545 (0.347) loss_x loss_x 1.6025 (1.5413) acc_x 65.6250 (62.5000) lr 1.8607e-03 eta 0:00:13
epoch [36/200] batch [15/38] time 0.545 (0.477) data 0.414 (0.346) loss_x loss_x 1.8418 (1.5646) acc_x 50.0000 (61.4583) lr 1.8607e-03 eta 0:00:10
epoch [36/200] batch [20/38] time 0.476 (0.462) data 0.346 (0.331) loss_x loss_x 1.6055 (1.5077) acc_x 56.2500 (62.5000) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [25/38] time 0.451 (0.463) data 0.321 (0.332) loss_x loss_x 1.6172 (1.5475) acc_x 62.5000 (61.6250) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [30/38] time 0.420 (0.460) data 0.289 (0.329) loss_x loss_x 1.2979 (1.5328) acc_x 56.2500 (61.7708) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [35/38] time 0.412 (0.453) data 0.281 (0.322) loss_x loss_x 1.3301 (1.5274) acc_x 56.2500 (61.6071) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1701
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1269
clean true:1269
clean false:0
clean_rate:1.0
noisy true:166
noisy false:1701
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 1867
epoch [37/200] batch [5/39] time 0.453 (0.470) data 0.323 (0.339) loss_x loss_x 1.0039 (1.1619) acc_x 71.8750 (70.0000) lr 1.8526e-03 eta 0:00:15
epoch [37/200] batch [10/39] time 0.395 (0.466) data 0.264 (0.335) loss_x loss_x 1.8770 (1.2334) acc_x 53.1250 (66.5625) lr 1.8526e-03 eta 0:00:13
epoch [37/200] batch [15/39] time 0.551 (0.462) data 0.420 (0.332) loss_x loss_x 1.2871 (1.3197) acc_x 68.7500 (65.0000) lr 1.8526e-03 eta 0:00:11
epoch [37/200] batch [20/39] time 0.362 (0.471) data 0.232 (0.340) loss_x loss_x 1.3623 (1.3788) acc_x 71.8750 (63.5938) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [25/39] time 0.363 (0.464) data 0.232 (0.334) loss_x loss_x 1.8848 (1.4147) acc_x 46.8750 (62.2500) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [30/39] time 0.389 (0.470) data 0.258 (0.339) loss_x loss_x 1.8789 (1.4486) acc_x 40.6250 (60.9375) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [35/39] time 0.511 (0.478) data 0.381 (0.347) loss_x loss_x 1.3301 (1.4278) acc_x 68.7500 (61.6964) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1278
clean true:1277
clean false:1
clean_rate:0.9992175273865415
noisy true:160
noisy false:1698
after delete: len(clean_dataset) 1278
after delete: len(noisy_dataset) 1858
epoch [38/200] batch [5/39] time 0.425 (0.482) data 0.294 (0.351) loss_x loss_x 1.8291 (1.3816) acc_x 56.2500 (66.2500) lr 1.8443e-03 eta 0:00:16
epoch [38/200] batch [10/39] time 0.476 (0.465) data 0.345 (0.334) loss_x loss_x 1.2852 (1.3906) acc_x 71.8750 (65.0000) lr 1.8443e-03 eta 0:00:13
epoch [38/200] batch [15/39] time 0.354 (0.470) data 0.223 (0.339) loss_x loss_x 1.7334 (1.3898) acc_x 62.5000 (65.0000) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [20/39] time 0.495 (0.459) data 0.365 (0.328) loss_x loss_x 1.0010 (1.4169) acc_x 71.8750 (64.3750) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [25/39] time 0.427 (0.450) data 0.297 (0.319) loss_x loss_x 1.3965 (1.4191) acc_x 68.7500 (63.8750) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [30/39] time 0.644 (0.461) data 0.514 (0.331) loss_x loss_x 1.4385 (1.4273) acc_x 59.3750 (63.5417) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [35/39] time 0.505 (0.465) data 0.374 (0.335) loss_x loss_x 1.3574 (1.4364) acc_x 62.5000 (63.1250) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1698
confident_label rate tensor(0.4085, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1281
clean true:1280
clean false:1
clean_rate:0.9992193598750976
noisy true:158
noisy false:1697
after delete: len(clean_dataset) 1281
after delete: len(noisy_dataset) 1855
epoch [39/200] batch [5/40] time 0.494 (0.460) data 0.363 (0.330) loss_x loss_x 1.4561 (1.4461) acc_x 56.2500 (56.8750) lr 1.8358e-03 eta 0:00:16
epoch [39/200] batch [10/40] time 0.465 (0.474) data 0.335 (0.344) loss_x loss_x 1.4961 (1.3631) acc_x 71.8750 (61.5625) lr 1.8358e-03 eta 0:00:14
epoch [39/200] batch [15/40] time 0.512 (0.478) data 0.382 (0.347) loss_x loss_x 1.0420 (1.3368) acc_x 65.6250 (63.1250) lr 1.8358e-03 eta 0:00:11
epoch [39/200] batch [20/40] time 0.396 (0.462) data 0.266 (0.332) loss_x loss_x 0.9951 (1.3629) acc_x 75.0000 (64.3750) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [25/40] time 0.354 (0.458) data 0.224 (0.328) loss_x loss_x 1.2314 (1.3864) acc_x 62.5000 (63.1250) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [30/40] time 0.344 (0.459) data 0.213 (0.329) loss_x loss_x 1.3584 (1.3910) acc_x 68.7500 (62.6042) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [35/40] time 0.440 (0.460) data 0.310 (0.330) loss_x loss_x 1.5811 (1.3869) acc_x 65.6250 (62.8571) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [40/40] time 0.416 (0.459) data 0.286 (0.328) loss_x loss_x 1.9043 (1.4076) acc_x 62.5000 (62.5000) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.4110, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1289
clean true:1287
clean false:2
clean_rate:0.9984484096198604
noisy true:165
noisy false:1682
after delete: len(clean_dataset) 1289
after delete: len(noisy_dataset) 1847
epoch [40/200] batch [5/40] time 0.500 (0.500) data 0.369 (0.369) loss_x loss_x 1.5586 (1.6006) acc_x 56.2500 (60.0000) lr 1.8271e-03 eta 0:00:17
epoch [40/200] batch [10/40] time 0.463 (0.475) data 0.333 (0.344) loss_x loss_x 1.2666 (1.4920) acc_x 56.2500 (62.5000) lr 1.8271e-03 eta 0:00:14
epoch [40/200] batch [15/40] time 0.357 (0.452) data 0.223 (0.321) loss_x loss_x 1.4951 (1.4795) acc_x 59.3750 (61.0417) lr 1.8271e-03 eta 0:00:11
epoch [40/200] batch [20/40] time 0.430 (0.459) data 0.300 (0.328) loss_x loss_x 1.2988 (1.4513) acc_x 65.6250 (61.5625) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [25/40] time 0.321 (0.461) data 0.190 (0.330) loss_x loss_x 1.6045 (1.4551) acc_x 65.6250 (61.7500) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [30/40] time 0.431 (0.466) data 0.299 (0.335) loss_x loss_x 1.5557 (1.4950) acc_x 59.3750 (61.2500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [35/40] time 0.452 (0.472) data 0.321 (0.341) loss_x loss_x 1.0654 (1.4575) acc_x 68.7500 (61.5179) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [40/40] time 0.571 (0.470) data 0.440 (0.340) loss_x loss_x 1.9775 (1.4379) acc_x 62.5000 (62.5000) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1631
confident_label rate tensor(0.4289, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1345
clean true:1344
clean false:1
clean_rate:0.9992565055762082
noisy true:161
noisy false:1630
after delete: len(clean_dataset) 1345
after delete: len(noisy_dataset) 1791
epoch [41/200] batch [5/42] time 0.514 (0.492) data 0.384 (0.361) loss_x loss_x 1.8086 (1.4545) acc_x 62.5000 (61.2500) lr 1.8181e-03 eta 0:00:18
epoch [41/200] batch [10/42] time 0.401 (0.473) data 0.271 (0.342) loss_x loss_x 1.4180 (1.3057) acc_x 71.8750 (67.5000) lr 1.8181e-03 eta 0:00:15
epoch [41/200] batch [15/42] time 0.643 (0.465) data 0.513 (0.334) loss_x loss_x 1.2207 (1.3477) acc_x 62.5000 (65.2083) lr 1.8181e-03 eta 0:00:12
epoch [41/200] batch [20/42] time 0.490 (0.467) data 0.360 (0.337) loss_x loss_x 1.5420 (1.3844) acc_x 62.5000 (65.0000) lr 1.8181e-03 eta 0:00:10
epoch [41/200] batch [25/42] time 0.372 (0.463) data 0.238 (0.332) loss_x loss_x 1.3535 (1.3430) acc_x 59.3750 (65.5000) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [30/42] time 0.549 (0.472) data 0.418 (0.341) loss_x loss_x 1.4277 (1.3313) acc_x 50.0000 (65.3125) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [35/42] time 0.422 (0.470) data 0.292 (0.339) loss_x loss_x 1.0771 (1.3115) acc_x 71.8750 (65.7143) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [40/42] time 0.410 (0.465) data 0.280 (0.334) loss_x loss_x 0.9551 (1.3377) acc_x 68.7500 (64.7656) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1667
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1306
clean true:1306
clean false:0
clean_rate:1.0
noisy true:163
noisy false:1667
after delete: len(clean_dataset) 1306
after delete: len(noisy_dataset) 1830
epoch [42/200] batch [5/40] time 0.446 (0.470) data 0.317 (0.340) loss_x loss_x 1.6738 (1.5189) acc_x 62.5000 (63.7500) lr 1.8090e-03 eta 0:00:16
epoch [42/200] batch [10/40] time 0.385 (0.461) data 0.254 (0.330) loss_x loss_x 1.0312 (1.3438) acc_x 71.8750 (66.2500) lr 1.8090e-03 eta 0:00:13
epoch [42/200] batch [15/40] time 0.420 (0.453) data 0.290 (0.322) loss_x loss_x 1.2744 (1.2671) acc_x 59.3750 (67.7083) lr 1.8090e-03 eta 0:00:11
epoch [42/200] batch [20/40] time 0.424 (0.461) data 0.293 (0.331) loss_x loss_x 1.5732 (1.2979) acc_x 43.7500 (66.4062) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [25/40] time 0.688 (0.460) data 0.558 (0.330) loss_x loss_x 1.2637 (1.2886) acc_x 65.6250 (66.0000) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [30/40] time 0.575 (0.466) data 0.445 (0.335) loss_x loss_x 1.6660 (1.3225) acc_x 59.3750 (65.5208) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [35/40] time 0.496 (0.466) data 0.365 (0.336) loss_x loss_x 1.5869 (1.3564) acc_x 50.0000 (64.4643) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [40/40] time 0.425 (0.462) data 0.294 (0.331) loss_x loss_x 1.1338 (1.3586) acc_x 75.0000 (64.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.4104, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1287
clean true:1287
clean false:0
clean_rate:1.0
noisy true:158
noisy false:1691
after delete: len(clean_dataset) 1287
after delete: len(noisy_dataset) 1849
epoch [43/200] batch [5/40] time 0.478 (0.486) data 0.348 (0.356) loss_x loss_x 1.3652 (1.4264) acc_x 56.2500 (61.2500) lr 1.7997e-03 eta 0:00:17
epoch [43/200] batch [10/40] time 0.571 (0.490) data 0.441 (0.360) loss_x loss_x 1.3906 (1.3071) acc_x 71.8750 (65.9375) lr 1.7997e-03 eta 0:00:14
epoch [43/200] batch [15/40] time 0.722 (0.500) data 0.592 (0.370) loss_x loss_x 0.9453 (1.3342) acc_x 71.8750 (65.4167) lr 1.7997e-03 eta 0:00:12
epoch [43/200] batch [20/40] time 0.412 (0.494) data 0.282 (0.364) loss_x loss_x 1.8115 (1.4177) acc_x 50.0000 (64.0625) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [25/40] time 0.422 (0.485) data 0.292 (0.355) loss_x loss_x 1.9189 (1.3904) acc_x 56.2500 (65.7500) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [30/40] time 0.488 (0.478) data 0.359 (0.348) loss_x loss_x 2.2148 (1.4267) acc_x 53.1250 (64.8958) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [35/40] time 0.403 (0.470) data 0.272 (0.339) loss_x loss_x 1.2461 (1.3862) acc_x 62.5000 (65.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [40/40] time 0.564 (0.471) data 0.433 (0.341) loss_x loss_x 1.3223 (1.3914) acc_x 56.2500 (64.7656) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1611
confident_label rate tensor(0.4324, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1356
clean true:1354
clean false:2
clean_rate:0.9985250737463127
noisy true:171
noisy false:1609
after delete: len(clean_dataset) 1356
after delete: len(noisy_dataset) 1780
epoch [44/200] batch [5/42] time 0.504 (0.461) data 0.374 (0.331) loss_x loss_x 1.1123 (1.3980) acc_x 68.7500 (63.7500) lr 1.7902e-03 eta 0:00:17
epoch [44/200] batch [10/42] time 0.414 (0.445) data 0.283 (0.315) loss_x loss_x 1.5332 (1.4542) acc_x 59.3750 (62.8125) lr 1.7902e-03 eta 0:00:14
epoch [44/200] batch [15/42] time 0.396 (0.441) data 0.266 (0.311) loss_x loss_x 1.3486 (1.4512) acc_x 68.7500 (63.7500) lr 1.7902e-03 eta 0:00:11
epoch [44/200] batch [20/42] time 0.400 (0.437) data 0.269 (0.307) loss_x loss_x 1.5605 (1.4417) acc_x 59.3750 (63.5938) lr 1.7902e-03 eta 0:00:09
epoch [44/200] batch [25/42] time 0.409 (0.431) data 0.280 (0.301) loss_x loss_x 1.7197 (1.3978) acc_x 62.5000 (64.2500) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [30/42] time 0.624 (0.445) data 0.494 (0.315) loss_x loss_x 1.0635 (1.3467) acc_x 75.0000 (65.9375) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [35/42] time 0.420 (0.444) data 0.289 (0.314) loss_x loss_x 1.2393 (1.3405) acc_x 62.5000 (65.4464) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [40/42] time 0.499 (0.448) data 0.367 (0.318) loss_x loss_x 1.5430 (1.3576) acc_x 65.6250 (65.1562) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.4117, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1291
clean true:1288
clean false:3
clean_rate:0.9976762199845082
noisy true:166
noisy false:1679
after delete: len(clean_dataset) 1291
after delete: len(noisy_dataset) 1845
epoch [45/200] batch [5/40] time 0.406 (0.457) data 0.275 (0.326) loss_x loss_x 1.5820 (1.4277) acc_x 62.5000 (65.6250) lr 1.7804e-03 eta 0:00:15
epoch [45/200] batch [10/40] time 0.531 (0.459) data 0.400 (0.328) loss_x loss_x 1.3887 (1.3771) acc_x 65.6250 (65.3125) lr 1.7804e-03 eta 0:00:13
epoch [45/200] batch [15/40] time 0.465 (0.465) data 0.334 (0.334) loss_x loss_x 1.8086 (1.3888) acc_x 56.2500 (65.2083) lr 1.7804e-03 eta 0:00:11
epoch [45/200] batch [20/40] time 0.425 (0.474) data 0.294 (0.344) loss_x loss_x 0.8403 (1.3239) acc_x 75.0000 (66.8750) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [25/40] time 0.417 (0.479) data 0.286 (0.348) loss_x loss_x 1.3604 (1.3171) acc_x 68.7500 (66.6250) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [30/40] time 0.451 (0.475) data 0.321 (0.344) loss_x loss_x 1.1943 (1.3456) acc_x 62.5000 (65.0000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [35/40] time 0.589 (0.477) data 0.459 (0.346) loss_x loss_x 1.9170 (1.3601) acc_x 46.8750 (65.2679) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [40/40] time 0.442 (0.476) data 0.311 (0.346) loss_x loss_x 1.0332 (1.3829) acc_x 78.1250 (64.6094) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1251
clean true:1249
clean false:2
clean_rate:0.9984012789768185
noisy true:159
noisy false:1726
after delete: len(clean_dataset) 1251
after delete: len(noisy_dataset) 1885
epoch [46/200] batch [5/39] time 0.677 (0.479) data 0.546 (0.348) loss_x loss_x 0.9106 (1.2144) acc_x 65.6250 (66.8750) lr 1.7705e-03 eta 0:00:16
epoch [46/200] batch [10/39] time 0.376 (0.475) data 0.246 (0.344) loss_x loss_x 1.4834 (1.2619) acc_x 62.5000 (65.9375) lr 1.7705e-03 eta 0:00:13
epoch [46/200] batch [15/39] time 0.452 (0.468) data 0.321 (0.338) loss_x loss_x 1.4385 (1.2087) acc_x 68.7500 (68.3333) lr 1.7705e-03 eta 0:00:11
epoch [46/200] batch [20/39] time 0.415 (0.457) data 0.284 (0.327) loss_x loss_x 1.1963 (1.2615) acc_x 68.7500 (66.8750) lr 1.7705e-03 eta 0:00:08
epoch [46/200] batch [25/39] time 0.496 (0.467) data 0.365 (0.337) loss_x loss_x 2.0820 (1.3589) acc_x 53.1250 (64.1250) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [30/39] time 0.558 (0.463) data 0.427 (0.332) loss_x loss_x 1.4473 (1.3604) acc_x 65.6250 (63.7500) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [35/39] time 0.389 (0.461) data 0.258 (0.330) loss_x loss_x 1.3574 (1.3425) acc_x 56.2500 (64.2857) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.4149, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1301
clean true:1300
clean false:1
clean_rate:0.9992313604919293
noisy true:167
noisy false:1668
after delete: len(clean_dataset) 1301
after delete: len(noisy_dataset) 1835
epoch [47/200] batch [5/40] time 0.487 (0.456) data 0.356 (0.325) loss_x loss_x 1.6133 (1.4818) acc_x 53.1250 (61.2500) lr 1.7604e-03 eta 0:00:15
epoch [47/200] batch [10/40] time 0.430 (0.491) data 0.300 (0.360) loss_x loss_x 1.5371 (1.3838) acc_x 50.0000 (62.8125) lr 1.7604e-03 eta 0:00:14
epoch [47/200] batch [15/40] time 0.451 (0.469) data 0.320 (0.339) loss_x loss_x 2.0703 (1.4392) acc_x 46.8750 (62.9167) lr 1.7604e-03 eta 0:00:11
epoch [47/200] batch [20/40] time 0.610 (0.477) data 0.480 (0.347) loss_x loss_x 2.2168 (1.4503) acc_x 43.7500 (61.4062) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [25/40] time 0.375 (0.463) data 0.245 (0.333) loss_x loss_x 1.3145 (1.4496) acc_x 65.6250 (62.1250) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [30/40] time 0.418 (0.469) data 0.287 (0.339) loss_x loss_x 1.6504 (1.4584) acc_x 59.3750 (61.9792) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [35/40] time 0.589 (0.471) data 0.458 (0.341) loss_x loss_x 1.2803 (1.4255) acc_x 71.8750 (63.1250) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [40/40] time 0.463 (0.477) data 0.333 (0.347) loss_x loss_x 0.9741 (1.4148) acc_x 68.7500 (63.2031) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1678
confident_label rate tensor(0.4161, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1305
clean true:1303
clean false:2
clean_rate:0.9984674329501916
noisy true:155
noisy false:1676
after delete: len(clean_dataset) 1305
after delete: len(noisy_dataset) 1831
epoch [48/200] batch [5/40] time 0.474 (0.448) data 0.344 (0.317) loss_x loss_x 1.2715 (1.2105) acc_x 68.7500 (71.8750) lr 1.7501e-03 eta 0:00:15
epoch [48/200] batch [10/40] time 0.424 (0.459) data 0.293 (0.328) loss_x loss_x 1.3418 (1.3162) acc_x 65.6250 (69.0625) lr 1.7501e-03 eta 0:00:13
epoch [48/200] batch [15/40] time 0.554 (0.468) data 0.424 (0.337) loss_x loss_x 1.4717 (1.3366) acc_x 62.5000 (67.5000) lr 1.7501e-03 eta 0:00:11
epoch [48/200] batch [20/40] time 0.593 (0.467) data 0.462 (0.337) loss_x loss_x 1.8408 (1.4178) acc_x 56.2500 (65.4688) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [25/40] time 0.479 (0.471) data 0.348 (0.340) loss_x loss_x 1.2832 (1.3812) acc_x 62.5000 (66.3750) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [30/40] time 0.415 (0.466) data 0.284 (0.336) loss_x loss_x 1.0117 (1.4096) acc_x 68.7500 (64.7917) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [35/40] time 0.453 (0.469) data 0.324 (0.338) loss_x loss_x 1.6455 (1.4260) acc_x 59.3750 (64.0179) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [40/40] time 0.575 (0.467) data 0.445 (0.336) loss_x loss_x 1.8965 (1.4379) acc_x 46.8750 (63.5938) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1325
clean true:1321
clean false:4
clean_rate:0.9969811320754717
noisy true:158
noisy false:1653
after delete: len(clean_dataset) 1325
after delete: len(noisy_dataset) 1811
epoch [49/200] batch [5/41] time 0.485 (0.457) data 0.355 (0.327) loss_x loss_x 1.6514 (1.4660) acc_x 71.8750 (64.3750) lr 1.7396e-03 eta 0:00:16
epoch [49/200] batch [10/41] time 0.472 (0.459) data 0.341 (0.329) loss_x loss_x 1.2998 (1.3674) acc_x 62.5000 (63.7500) lr 1.7396e-03 eta 0:00:14
epoch [49/200] batch [15/41] time 0.435 (0.476) data 0.305 (0.345) loss_x loss_x 1.0820 (1.3434) acc_x 75.0000 (64.7917) lr 1.7396e-03 eta 0:00:12
epoch [49/200] batch [20/41] time 0.543 (0.485) data 0.409 (0.354) loss_x loss_x 1.6494 (1.3270) acc_x 62.5000 (65.3125) lr 1.7396e-03 eta 0:00:10
epoch [49/200] batch [25/41] time 0.587 (0.481) data 0.457 (0.351) loss_x loss_x 1.3184 (1.3597) acc_x 71.8750 (65.0000) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [30/41] time 0.415 (0.472) data 0.283 (0.341) loss_x loss_x 1.7520 (1.3797) acc_x 59.3750 (64.8958) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [35/41] time 0.591 (0.473) data 0.461 (0.342) loss_x loss_x 1.3008 (1.3857) acc_x 65.6250 (64.6429) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [40/41] time 0.463 (0.471) data 0.333 (0.340) loss_x loss_x 1.1650 (1.3766) acc_x 65.6250 (64.7656) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1654
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1325
clean true:1325
clean false:0
clean_rate:1.0
noisy true:157
noisy false:1654
after delete: len(clean_dataset) 1325
after delete: len(noisy_dataset) 1811
epoch [50/200] batch [5/41] time 0.511 (0.452) data 0.381 (0.322) loss_x loss_x 1.2588 (1.1121) acc_x 71.8750 (72.5000) lr 1.7290e-03 eta 0:00:16
epoch [50/200] batch [10/41] time 0.439 (0.495) data 0.308 (0.365) loss_x loss_x 1.3428 (1.2210) acc_x 65.6250 (70.0000) lr 1.7290e-03 eta 0:00:15
epoch [50/200] batch [15/41] time 0.495 (0.486) data 0.364 (0.355) loss_x loss_x 1.0879 (1.2701) acc_x 75.0000 (68.3333) lr 1.7290e-03 eta 0:00:12
epoch [50/200] batch [20/41] time 0.520 (0.478) data 0.390 (0.347) loss_x loss_x 1.4668 (1.3240) acc_x 68.7500 (66.8750) lr 1.7290e-03 eta 0:00:10
epoch [50/200] batch [25/41] time 0.542 (0.484) data 0.411 (0.353) loss_x loss_x 1.5029 (1.3300) acc_x 56.2500 (65.5000) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [30/41] time 0.395 (0.491) data 0.264 (0.361) loss_x loss_x 1.0586 (1.3228) acc_x 68.7500 (65.1042) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [35/41] time 0.542 (0.494) data 0.411 (0.363) loss_x loss_x 1.5830 (1.3440) acc_x 62.5000 (65.2679) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [40/41] time 0.457 (0.492) data 0.326 (0.361) loss_x loss_x 1.5596 (1.3495) acc_x 59.3750 (65.0781) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1604
confident_label rate tensor(0.4346, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1363
clean true:1363
clean false:0
clean_rate:1.0
noisy true:169
noisy false:1604
after delete: len(clean_dataset) 1363
after delete: len(noisy_dataset) 1773
epoch [51/200] batch [5/42] time 0.441 (0.500) data 0.310 (0.368) loss_x loss_x 2.2070 (1.5912) acc_x 56.2500 (57.5000) lr 1.7181e-03 eta 0:00:18
epoch [51/200] batch [10/42] time 0.538 (0.497) data 0.408 (0.366) loss_x loss_x 1.3359 (1.5084) acc_x 65.6250 (60.0000) lr 1.7181e-03 eta 0:00:15
epoch [51/200] batch [15/42] time 0.368 (0.491) data 0.238 (0.360) loss_x loss_x 1.0186 (1.4428) acc_x 75.0000 (63.1250) lr 1.7181e-03 eta 0:00:13
epoch [51/200] batch [20/42] time 0.524 (0.486) data 0.394 (0.355) loss_x loss_x 1.0117 (1.4496) acc_x 62.5000 (62.9688) lr 1.7181e-03 eta 0:00:10
epoch [51/200] batch [25/42] time 0.584 (0.481) data 0.454 (0.351) loss_x loss_x 0.8755 (1.3757) acc_x 78.1250 (65.1250) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [30/42] time 0.403 (0.466) data 0.273 (0.335) loss_x loss_x 1.8809 (1.3809) acc_x 50.0000 (65.3125) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [35/42] time 0.444 (0.461) data 0.314 (0.331) loss_x loss_x 1.5078 (1.3616) acc_x 62.5000 (65.7143) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [40/42] time 0.512 (0.464) data 0.382 (0.333) loss_x loss_x 0.9189 (1.3399) acc_x 78.1250 (65.8594) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1642
confident_label rate tensor(0.4235, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1328
clean true:1328
clean false:0
clean_rate:1.0
noisy true:166
noisy false:1642
after delete: len(clean_dataset) 1328
after delete: len(noisy_dataset) 1808
epoch [52/200] batch [5/41] time 0.560 (0.502) data 0.430 (0.371) loss_x loss_x 1.2139 (1.2022) acc_x 65.6250 (67.5000) lr 1.7071e-03 eta 0:00:18
epoch [52/200] batch [10/41] time 0.477 (0.500) data 0.347 (0.370) loss_x loss_x 1.6299 (1.3151) acc_x 53.1250 (63.7500) lr 1.7071e-03 eta 0:00:15
epoch [52/200] batch [15/41] time 0.415 (0.477) data 0.285 (0.346) loss_x loss_x 1.6396 (1.3360) acc_x 53.1250 (63.5417) lr 1.7071e-03 eta 0:00:12
epoch [52/200] batch [20/41] time 0.407 (0.463) data 0.277 (0.333) loss_x loss_x 1.1074 (1.3226) acc_x 71.8750 (63.5938) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [25/41] time 0.426 (0.454) data 0.295 (0.323) loss_x loss_x 0.9556 (1.3078) acc_x 71.8750 (63.6250) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [30/41] time 0.515 (0.452) data 0.385 (0.321) loss_x loss_x 1.8262 (1.3547) acc_x 46.8750 (62.1875) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [35/41] time 0.562 (0.461) data 0.432 (0.330) loss_x loss_x 1.3984 (1.3384) acc_x 59.3750 (62.6786) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [40/41] time 0.420 (0.457) data 0.289 (0.327) loss_x loss_x 1.2686 (1.3474) acc_x 68.7500 (62.8906) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1594
confident_label rate tensor(0.4410, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1383
clean true:1382
clean false:1
clean_rate:0.9992769342010123
noisy true:160
noisy false:1593
after delete: len(clean_dataset) 1383
after delete: len(noisy_dataset) 1753
epoch [53/200] batch [5/43] time 0.452 (0.492) data 0.321 (0.361) loss_x loss_x 1.0967 (1.2050) acc_x 68.7500 (64.3750) lr 1.6959e-03 eta 0:00:18
epoch [53/200] batch [10/43] time 0.465 (0.462) data 0.334 (0.332) loss_x loss_x 1.8066 (1.3438) acc_x 53.1250 (63.7500) lr 1.6959e-03 eta 0:00:15
epoch [53/200] batch [15/43] time 0.391 (0.457) data 0.260 (0.326) loss_x loss_x 1.0508 (1.4352) acc_x 71.8750 (62.5000) lr 1.6959e-03 eta 0:00:12
epoch [53/200] batch [20/43] time 0.454 (0.446) data 0.323 (0.315) loss_x loss_x 0.9458 (1.3957) acc_x 75.0000 (63.1250) lr 1.6959e-03 eta 0:00:10
epoch [53/200] batch [25/43] time 0.409 (0.445) data 0.278 (0.314) loss_x loss_x 1.3135 (1.3862) acc_x 71.8750 (64.2500) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [30/43] time 0.676 (0.453) data 0.545 (0.323) loss_x loss_x 1.0293 (1.3787) acc_x 68.7500 (64.0625) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [35/43] time 0.500 (0.455) data 0.369 (0.324) loss_x loss_x 1.6201 (1.3772) acc_x 59.3750 (64.2857) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [40/43] time 0.422 (0.460) data 0.291 (0.329) loss_x loss_x 1.4346 (1.3782) acc_x 62.5000 (64.6094) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.4235, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1328
clean true:1327
clean false:1
clean_rate:0.9992469879518072
noisy true:163
noisy false:1645
after delete: len(clean_dataset) 1328
after delete: len(noisy_dataset) 1808
epoch [54/200] batch [5/41] time 0.454 (0.476) data 0.324 (0.346) loss_x loss_x 1.4160 (1.3320) acc_x 56.2500 (64.3750) lr 1.6845e-03 eta 0:00:17
epoch [54/200] batch [10/41] time 0.483 (0.463) data 0.352 (0.332) loss_x loss_x 1.1963 (1.2924) acc_x 65.6250 (65.3125) lr 1.6845e-03 eta 0:00:14
epoch [54/200] batch [15/41] time 0.483 (0.457) data 0.353 (0.326) loss_x loss_x 1.7969 (1.3611) acc_x 53.1250 (63.5417) lr 1.6845e-03 eta 0:00:11
epoch [54/200] batch [20/41] time 0.514 (0.465) data 0.383 (0.334) loss_x loss_x 1.5312 (1.3765) acc_x 65.6250 (64.2188) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [25/41] time 0.460 (0.468) data 0.329 (0.338) loss_x loss_x 0.9185 (1.3492) acc_x 68.7500 (64.3750) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [30/41] time 0.400 (0.464) data 0.269 (0.333) loss_x loss_x 1.2393 (1.3379) acc_x 56.2500 (64.2708) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [35/41] time 0.495 (0.467) data 0.364 (0.337) loss_x loss_x 1.4971 (1.3339) acc_x 59.3750 (64.4643) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [40/41] time 0.530 (0.473) data 0.399 (0.342) loss_x loss_x 1.4932 (1.3477) acc_x 62.5000 (64.2969) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.4305, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1350
clean true:1348
clean false:2
clean_rate:0.9985185185185185
noisy true:168
noisy false:1618
after delete: len(clean_dataset) 1350
after delete: len(noisy_dataset) 1786
epoch [55/200] batch [5/42] time 0.541 (0.465) data 0.410 (0.333) loss_x loss_x 1.3262 (1.3611) acc_x 62.5000 (63.1250) lr 1.6730e-03 eta 0:00:17
epoch [55/200] batch [10/42] time 0.474 (0.465) data 0.344 (0.334) loss_x loss_x 1.7285 (1.3249) acc_x 62.5000 (65.0000) lr 1.6730e-03 eta 0:00:14
epoch [55/200] batch [15/42] time 0.528 (0.457) data 0.397 (0.326) loss_x loss_x 1.3418 (1.3524) acc_x 53.1250 (63.9583) lr 1.6730e-03 eta 0:00:12
epoch [55/200] batch [20/42] time 0.440 (0.458) data 0.309 (0.327) loss_x loss_x 1.8301 (1.3606) acc_x 50.0000 (64.6875) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [25/42] time 0.490 (0.458) data 0.360 (0.327) loss_x loss_x 1.5537 (1.3879) acc_x 56.2500 (64.8750) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [30/42] time 0.451 (0.457) data 0.320 (0.327) loss_x loss_x 1.1582 (1.3880) acc_x 68.7500 (64.8958) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [35/42] time 0.574 (0.460) data 0.443 (0.329) loss_x loss_x 1.2549 (1.3755) acc_x 68.7500 (65.0000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [40/42] time 0.512 (0.457) data 0.381 (0.326) loss_x loss_x 1.5273 (1.3619) acc_x 56.2500 (64.9219) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.4193, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1315
clean true:1314
clean false:1
clean_rate:0.9992395437262357
noisy true:156
noisy false:1665
after delete: len(clean_dataset) 1315
after delete: len(noisy_dataset) 1821
epoch [56/200] batch [5/41] time 0.440 (0.501) data 0.310 (0.371) loss_x loss_x 1.5420 (1.2520) acc_x 50.0000 (61.8750) lr 1.6613e-03 eta 0:00:18
epoch [56/200] batch [10/41] time 0.449 (0.482) data 0.319 (0.352) loss_x loss_x 1.7246 (1.4099) acc_x 62.5000 (61.5625) lr 1.6613e-03 eta 0:00:14
epoch [56/200] batch [15/41] time 0.457 (0.461) data 0.327 (0.330) loss_x loss_x 1.4521 (1.4023) acc_x 68.7500 (62.7083) lr 1.6613e-03 eta 0:00:11
epoch [56/200] batch [20/41] time 0.505 (0.476) data 0.375 (0.346) loss_x loss_x 1.6396 (1.3795) acc_x 53.1250 (63.5938) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [25/41] time 0.396 (0.464) data 0.265 (0.334) loss_x loss_x 1.0703 (1.3838) acc_x 71.8750 (63.2500) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [30/41] time 0.367 (0.466) data 0.237 (0.336) loss_x loss_x 1.4951 (1.3877) acc_x 65.6250 (64.0625) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [35/41] time 0.448 (0.460) data 0.317 (0.329) loss_x loss_x 1.3340 (1.3624) acc_x 65.6250 (64.9107) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [40/41] time 0.472 (0.455) data 0.341 (0.325) loss_x loss_x 1.5869 (1.3651) acc_x 65.6250 (65.7812) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1598
confident_label rate tensor(0.4404, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1381
clean true:1378
clean false:3
clean_rate:0.997827661115134
noisy true:160
noisy false:1595
after delete: len(clean_dataset) 1381
after delete: len(noisy_dataset) 1755
epoch [57/200] batch [5/43] time 0.459 (0.473) data 0.329 (0.343) loss_x loss_x 1.8076 (1.4223) acc_x 46.8750 (60.0000) lr 1.6494e-03 eta 0:00:17
epoch [57/200] batch [10/43] time 0.490 (0.502) data 0.359 (0.371) loss_x loss_x 1.2217 (1.3791) acc_x 71.8750 (64.0625) lr 1.6494e-03 eta 0:00:16
epoch [57/200] batch [15/43] time 0.530 (0.500) data 0.399 (0.369) loss_x loss_x 0.9521 (1.3867) acc_x 71.8750 (63.7500) lr 1.6494e-03 eta 0:00:13
epoch [57/200] batch [20/43] time 0.583 (0.501) data 0.452 (0.370) loss_x loss_x 1.2246 (1.3523) acc_x 75.0000 (64.8438) lr 1.6494e-03 eta 0:00:11
epoch [57/200] batch [25/43] time 0.495 (0.489) data 0.364 (0.358) loss_x loss_x 1.6064 (1.3432) acc_x 56.2500 (64.8750) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [30/43] time 0.625 (0.487) data 0.495 (0.357) loss_x loss_x 0.6089 (1.3074) acc_x 87.5000 (66.0417) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [35/43] time 0.342 (0.478) data 0.212 (0.347) loss_x loss_x 1.3086 (1.3137) acc_x 65.6250 (65.9821) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [40/43] time 0.463 (0.470) data 0.331 (0.339) loss_x loss_x 1.5059 (1.3322) acc_x 62.5000 (65.4688) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.4302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1349
clean true:1346
clean false:3
clean_rate:0.9977761304670126
noisy true:156
noisy false:1631
after delete: len(clean_dataset) 1349
after delete: len(noisy_dataset) 1787
epoch [58/200] batch [5/42] time 0.425 (0.417) data 0.294 (0.286) loss_x loss_x 1.3242 (1.3334) acc_x 75.0000 (68.1250) lr 1.6374e-03 eta 0:00:15
epoch [58/200] batch [10/42] time 0.407 (0.443) data 0.276 (0.312) loss_x loss_x 1.3057 (1.2988) acc_x 75.0000 (70.9375) lr 1.6374e-03 eta 0:00:14
epoch [58/200] batch [15/42] time 0.476 (0.453) data 0.340 (0.322) loss_x loss_x 1.3115 (1.3099) acc_x 68.7500 (70.0000) lr 1.6374e-03 eta 0:00:12
epoch [58/200] batch [20/42] time 0.508 (0.463) data 0.378 (0.331) loss_x loss_x 1.3027 (1.3329) acc_x 68.7500 (69.0625) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [25/42] time 0.534 (0.468) data 0.404 (0.337) loss_x loss_x 1.4404 (1.2963) acc_x 71.8750 (69.8750) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [30/42] time 0.523 (0.465) data 0.393 (0.334) loss_x loss_x 1.3467 (1.2864) acc_x 62.5000 (69.1667) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [35/42] time 0.369 (0.461) data 0.238 (0.330) loss_x loss_x 0.7754 (1.2867) acc_x 75.0000 (68.7500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [40/42] time 0.529 (0.459) data 0.399 (0.329) loss_x loss_x 1.0947 (1.2858) acc_x 68.7500 (68.7500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1584
confident_label rate tensor(0.4407, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1382
clean true:1381
clean false:1
clean_rate:0.9992764109985528
noisy true:171
noisy false:1583
after delete: len(clean_dataset) 1382
after delete: len(noisy_dataset) 1754
epoch [59/200] batch [5/43] time 0.490 (0.537) data 0.360 (0.407) loss_x loss_x 1.5410 (1.5006) acc_x 68.7500 (68.1250) lr 1.6252e-03 eta 0:00:20
epoch [59/200] batch [10/43] time 0.541 (0.502) data 0.411 (0.372) loss_x loss_x 1.4326 (1.3041) acc_x 65.6250 (70.3125) lr 1.6252e-03 eta 0:00:16
epoch [59/200] batch [15/43] time 0.500 (0.489) data 0.369 (0.359) loss_x loss_x 1.4756 (1.3251) acc_x 65.6250 (68.3333) lr 1.6252e-03 eta 0:00:13
epoch [59/200] batch [20/43] time 0.472 (0.472) data 0.342 (0.342) loss_x loss_x 1.4004 (1.3488) acc_x 62.5000 (67.3438) lr 1.6252e-03 eta 0:00:10
epoch [59/200] batch [25/43] time 0.580 (0.468) data 0.448 (0.338) loss_x loss_x 1.3818 (1.3512) acc_x 71.8750 (66.8750) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [30/43] time 0.425 (0.470) data 0.295 (0.340) loss_x loss_x 0.6089 (1.3111) acc_x 84.3750 (67.5000) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [35/43] time 0.477 (0.472) data 0.347 (0.342) loss_x loss_x 0.9785 (1.3182) acc_x 68.7500 (66.3393) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [40/43] time 0.415 (0.464) data 0.284 (0.334) loss_x loss_x 1.1113 (1.2997) acc_x 65.6250 (66.2500) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1409
clean true:1407
clean false:2
clean_rate:0.9985805535841022
noisy true:166
noisy false:1561
after delete: len(clean_dataset) 1409
after delete: len(noisy_dataset) 1727
epoch [60/200] batch [5/44] time 0.482 (0.505) data 0.351 (0.375) loss_x loss_x 0.9292 (1.3675) acc_x 75.0000 (62.5000) lr 1.6129e-03 eta 0:00:19
epoch [60/200] batch [10/44] time 0.558 (0.511) data 0.428 (0.381) loss_x loss_x 1.1260 (1.3046) acc_x 71.8750 (65.3125) lr 1.6129e-03 eta 0:00:17
epoch [60/200] batch [15/44] time 0.585 (0.502) data 0.454 (0.371) loss_x loss_x 1.7656 (1.2605) acc_x 62.5000 (67.7083) lr 1.6129e-03 eta 0:00:14
epoch [60/200] batch [20/44] time 0.501 (0.491) data 0.371 (0.360) loss_x loss_x 1.5840 (1.3268) acc_x 62.5000 (66.2500) lr 1.6129e-03 eta 0:00:11
epoch [60/200] batch [25/44] time 0.440 (0.485) data 0.309 (0.355) loss_x loss_x 1.7617 (1.3250) acc_x 46.8750 (66.1250) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [30/44] time 0.404 (0.471) data 0.273 (0.341) loss_x loss_x 1.4160 (1.3278) acc_x 62.5000 (66.3542) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [35/44] time 0.517 (0.483) data 0.387 (0.352) loss_x loss_x 1.6758 (1.3125) acc_x 50.0000 (66.6964) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [40/44] time 0.395 (0.475) data 0.264 (0.344) loss_x loss_x 1.3594 (1.3439) acc_x 65.6250 (65.3906) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1578
confident_label rate tensor(0.4426, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1388
clean true:1387
clean false:1
clean_rate:0.9992795389048992
noisy true:171
noisy false:1577
after delete: len(clean_dataset) 1388
after delete: len(noisy_dataset) 1748
epoch [61/200] batch [5/43] time 0.490 (0.559) data 0.360 (0.429) loss_x loss_x 0.9150 (1.3035) acc_x 75.0000 (66.8750) lr 1.6004e-03 eta 0:00:21
epoch [61/200] batch [10/43] time 0.639 (0.524) data 0.508 (0.394) loss_x loss_x 1.5645 (1.2545) acc_x 53.1250 (66.5625) lr 1.6004e-03 eta 0:00:17
epoch [61/200] batch [15/43] time 0.493 (0.515) data 0.362 (0.385) loss_x loss_x 1.0771 (1.2478) acc_x 78.1250 (66.8750) lr 1.6004e-03 eta 0:00:14
epoch [61/200] batch [20/43] time 0.579 (0.515) data 0.449 (0.385) loss_x loss_x 1.2920 (1.2592) acc_x 65.6250 (67.5000) lr 1.6004e-03 eta 0:00:11
epoch [61/200] batch [25/43] time 0.503 (0.509) data 0.373 (0.378) loss_x loss_x 1.1631 (1.2312) acc_x 65.6250 (68.1250) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [30/43] time 0.390 (0.499) data 0.259 (0.369) loss_x loss_x 1.2734 (1.2689) acc_x 59.3750 (66.5625) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [35/43] time 0.690 (0.502) data 0.559 (0.371) loss_x loss_x 1.4688 (1.2814) acc_x 65.6250 (66.6964) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [40/43] time 0.449 (0.499) data 0.319 (0.369) loss_x loss_x 0.9404 (1.2673) acc_x 84.3750 (67.2656) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1550
confident_label rate tensor(0.4487, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1407
clean true:1406
clean false:1
clean_rate:0.9992892679459844
noisy true:180
noisy false:1549
after delete: len(clean_dataset) 1407
after delete: len(noisy_dataset) 1729
epoch [62/200] batch [5/43] time 0.535 (0.481) data 0.405 (0.351) loss_x loss_x 1.1338 (1.2484) acc_x 68.7500 (65.6250) lr 1.5878e-03 eta 0:00:18
epoch [62/200] batch [10/43] time 0.453 (0.472) data 0.324 (0.342) loss_x loss_x 1.6768 (1.1834) acc_x 59.3750 (67.1875) lr 1.5878e-03 eta 0:00:15
epoch [62/200] batch [15/43] time 0.644 (0.487) data 0.513 (0.356) loss_x loss_x 1.4922 (1.2454) acc_x 59.3750 (67.0833) lr 1.5878e-03 eta 0:00:13
epoch [62/200] batch [20/43] time 0.436 (0.488) data 0.306 (0.357) loss_x loss_x 1.7988 (1.3580) acc_x 53.1250 (65.1562) lr 1.5878e-03 eta 0:00:11
epoch [62/200] batch [25/43] time 0.535 (0.485) data 0.404 (0.354) loss_x loss_x 1.6475 (1.3885) acc_x 62.5000 (64.2500) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [30/43] time 0.504 (0.489) data 0.373 (0.358) loss_x loss_x 1.3291 (1.3513) acc_x 62.5000 (64.8958) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [35/43] time 0.392 (0.480) data 0.261 (0.349) loss_x loss_x 1.1943 (1.3253) acc_x 65.6250 (65.1786) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [40/43] time 0.481 (0.484) data 0.349 (0.353) loss_x loss_x 1.2266 (1.3114) acc_x 65.6250 (65.7812) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1589
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1372
clean true:1372
clean false:0
clean_rate:1.0
noisy true:175
noisy false:1589
after delete: len(clean_dataset) 1372
after delete: len(noisy_dataset) 1764
epoch [63/200] batch [5/42] time 0.442 (0.456) data 0.311 (0.325) loss_x loss_x 1.3252 (1.1783) acc_x 62.5000 (70.0000) lr 1.5750e-03 eta 0:00:16
epoch [63/200] batch [10/42] time 0.399 (0.459) data 0.269 (0.329) loss_x loss_x 1.8350 (1.2900) acc_x 56.2500 (68.7500) lr 1.5750e-03 eta 0:00:14
epoch [63/200] batch [15/42] time 0.555 (0.472) data 0.424 (0.341) loss_x loss_x 1.0039 (1.2803) acc_x 62.5000 (67.5000) lr 1.5750e-03 eta 0:00:12
epoch [63/200] batch [20/42] time 0.450 (0.492) data 0.320 (0.362) loss_x loss_x 0.8433 (1.2994) acc_x 68.7500 (67.0312) lr 1.5750e-03 eta 0:00:10
epoch [63/200] batch [25/42] time 0.452 (0.473) data 0.321 (0.343) loss_x loss_x 1.1982 (1.2885) acc_x 65.6250 (67.5000) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [30/42] time 0.443 (0.468) data 0.312 (0.338) loss_x loss_x 0.9272 (1.3153) acc_x 84.3750 (66.9792) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [35/42] time 0.356 (0.459) data 0.226 (0.329) loss_x loss_x 1.6963 (1.3687) acc_x 56.2500 (65.5357) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [40/42] time 0.652 (0.463) data 0.522 (0.332) loss_x loss_x 0.9468 (1.3688) acc_x 78.1250 (65.6250) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1584
confident_label rate tensor(0.4439, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1392
clean true:1390
clean false:2
clean_rate:0.9985632183908046
noisy true:162
noisy false:1582
after delete: len(clean_dataset) 1392
after delete: len(noisy_dataset) 1744
epoch [64/200] batch [5/43] time 0.435 (0.462) data 0.304 (0.331) loss_x loss_x 1.5801 (1.4177) acc_x 65.6250 (66.8750) lr 1.5621e-03 eta 0:00:17
epoch [64/200] batch [10/43] time 0.410 (0.463) data 0.279 (0.333) loss_x loss_x 1.7041 (1.3292) acc_x 62.5000 (69.3750) lr 1.5621e-03 eta 0:00:15
epoch [64/200] batch [15/43] time 0.413 (0.440) data 0.283 (0.309) loss_x loss_x 1.1953 (1.2604) acc_x 68.7500 (69.7917) lr 1.5621e-03 eta 0:00:12
epoch [64/200] batch [20/43] time 0.430 (0.445) data 0.299 (0.314) loss_x loss_x 1.1562 (1.2777) acc_x 59.3750 (67.0312) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [25/43] time 0.589 (0.454) data 0.458 (0.324) loss_x loss_x 1.1436 (1.2703) acc_x 71.8750 (67.6250) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [30/43] time 0.434 (0.454) data 0.303 (0.323) loss_x loss_x 1.5928 (1.2876) acc_x 62.5000 (67.1875) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [35/43] time 0.455 (0.452) data 0.324 (0.321) loss_x loss_x 1.9453 (1.3358) acc_x 68.7500 (66.6071) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [40/43] time 0.559 (0.457) data 0.428 (0.326) loss_x loss_x 1.5527 (1.3288) acc_x 62.5000 (66.7969) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1587
confident_label rate tensor(0.4413, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1384
clean true:1384
clean false:0
clean_rate:1.0
noisy true:165
noisy false:1587
after delete: len(clean_dataset) 1384
after delete: len(noisy_dataset) 1752
epoch [65/200] batch [5/43] time 0.386 (0.452) data 0.255 (0.320) loss_x loss_x 1.2607 (1.4561) acc_x 71.8750 (63.7500) lr 1.5490e-03 eta 0:00:17
epoch [65/200] batch [10/43] time 0.540 (0.475) data 0.409 (0.344) loss_x loss_x 1.3643 (1.3282) acc_x 68.7500 (66.2500) lr 1.5490e-03 eta 0:00:15
epoch [65/200] batch [15/43] time 0.431 (0.474) data 0.300 (0.343) loss_x loss_x 1.5137 (1.3793) acc_x 62.5000 (66.2500) lr 1.5490e-03 eta 0:00:13
epoch [65/200] batch [20/43] time 0.405 (0.469) data 0.274 (0.338) loss_x loss_x 1.5508 (1.3373) acc_x 62.5000 (67.3438) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [25/43] time 0.378 (0.469) data 0.247 (0.338) loss_x loss_x 1.5283 (1.3736) acc_x 65.6250 (66.1250) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [30/43] time 0.450 (0.460) data 0.319 (0.330) loss_x loss_x 1.3115 (1.3851) acc_x 65.6250 (65.8333) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [35/43] time 0.429 (0.461) data 0.299 (0.330) loss_x loss_x 1.4473 (1.3447) acc_x 62.5000 (66.6964) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [40/43] time 0.459 (0.458) data 0.328 (0.327) loss_x loss_x 0.9683 (1.3204) acc_x 75.0000 (67.1094) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1556
confident_label rate tensor(0.4512, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1415
clean true:1413
clean false:2
clean_rate:0.9985865724381625
noisy true:167
noisy false:1554
after delete: len(clean_dataset) 1415
after delete: len(noisy_dataset) 1721
epoch [66/200] batch [5/44] time 0.421 (0.504) data 0.291 (0.373) loss_x loss_x 1.2539 (1.2180) acc_x 71.8750 (70.0000) lr 1.5358e-03 eta 0:00:19
epoch [66/200] batch [10/44] time 0.408 (0.455) data 0.277 (0.324) loss_x loss_x 0.8491 (1.2191) acc_x 71.8750 (69.3750) lr 1.5358e-03 eta 0:00:15
epoch [66/200] batch [15/44] time 0.467 (0.443) data 0.336 (0.312) loss_x loss_x 1.1904 (1.2625) acc_x 71.8750 (68.7500) lr 1.5358e-03 eta 0:00:12
epoch [66/200] batch [20/44] time 0.438 (0.460) data 0.307 (0.329) loss_x loss_x 1.2266 (1.2754) acc_x 65.6250 (67.8125) lr 1.5358e-03 eta 0:00:11
epoch [66/200] batch [25/44] time 0.492 (0.458) data 0.362 (0.327) loss_x loss_x 1.6729 (1.3521) acc_x 50.0000 (65.2500) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [30/44] time 0.313 (0.454) data 0.182 (0.323) loss_x loss_x 1.2646 (1.3986) acc_x 65.6250 (64.2708) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [35/44] time 0.647 (0.458) data 0.516 (0.328) loss_x loss_x 1.0762 (1.3598) acc_x 65.6250 (65.6250) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [40/44] time 0.414 (0.459) data 0.283 (0.329) loss_x loss_x 1.0244 (1.3205) acc_x 65.6250 (66.4062) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1615
confident_label rate tensor(0.4334, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1359
clean true:1358
clean false:1
clean_rate:0.9992641648270787
noisy true:163
noisy false:1614
after delete: len(clean_dataset) 1359
after delete: len(noisy_dataset) 1777
epoch [67/200] batch [5/42] time 0.379 (0.444) data 0.248 (0.314) loss_x loss_x 1.3467 (1.1608) acc_x 59.3750 (68.1250) lr 1.5225e-03 eta 0:00:16
epoch [67/200] batch [10/42] time 0.473 (0.462) data 0.343 (0.332) loss_x loss_x 0.9673 (1.2597) acc_x 78.1250 (67.8125) lr 1.5225e-03 eta 0:00:14
epoch [67/200] batch [15/42] time 0.451 (0.437) data 0.320 (0.306) loss_x loss_x 0.8955 (1.2958) acc_x 78.1250 (67.2917) lr 1.5225e-03 eta 0:00:11
epoch [67/200] batch [20/42] time 0.484 (0.441) data 0.353 (0.310) loss_x loss_x 1.0088 (1.2709) acc_x 75.0000 (66.8750) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [25/42] time 0.413 (0.440) data 0.283 (0.310) loss_x loss_x 1.4092 (1.2565) acc_x 59.3750 (66.8750) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [30/42] time 0.536 (0.442) data 0.405 (0.311) loss_x loss_x 1.2529 (1.2634) acc_x 78.1250 (67.0833) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [35/42] time 0.507 (0.443) data 0.376 (0.313) loss_x loss_x 1.2520 (1.2824) acc_x 75.0000 (67.1429) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [40/42] time 0.398 (0.450) data 0.267 (0.319) loss_x loss_x 1.3281 (1.2777) acc_x 62.5000 (67.1094) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1604
confident_label rate tensor(0.4372, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1371
clean true:1371
clean false:0
clean_rate:1.0
noisy true:161
noisy false:1604
after delete: len(clean_dataset) 1371
after delete: len(noisy_dataset) 1765
epoch [68/200] batch [5/42] time 0.447 (0.513) data 0.316 (0.382) loss_x loss_x 1.1279 (1.2262) acc_x 81.2500 (70.0000) lr 1.5090e-03 eta 0:00:18
epoch [68/200] batch [10/42] time 0.518 (0.474) data 0.388 (0.344) loss_x loss_x 1.1045 (1.1924) acc_x 65.6250 (68.7500) lr 1.5090e-03 eta 0:00:15
epoch [68/200] batch [15/42] time 0.395 (0.455) data 0.264 (0.324) loss_x loss_x 1.2314 (1.2433) acc_x 68.7500 (66.8750) lr 1.5090e-03 eta 0:00:12
epoch [68/200] batch [20/42] time 0.538 (0.459) data 0.408 (0.329) loss_x loss_x 1.3037 (1.2382) acc_x 68.7500 (67.0312) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [25/42] time 0.349 (0.453) data 0.219 (0.322) loss_x loss_x 1.4619 (1.2573) acc_x 65.6250 (67.5000) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [30/42] time 0.429 (0.456) data 0.299 (0.325) loss_x loss_x 1.3301 (1.2676) acc_x 65.6250 (67.1875) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [35/42] time 0.519 (0.451) data 0.389 (0.321) loss_x loss_x 1.1250 (1.2576) acc_x 75.0000 (67.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [40/42] time 0.479 (0.455) data 0.349 (0.324) loss_x loss_x 0.9673 (1.2594) acc_x 78.1250 (67.5000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1562
confident_label rate tensor(0.4487, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1407
clean true:1407
clean false:0
clean_rate:1.0
noisy true:167
noisy false:1562
after delete: len(clean_dataset) 1407
after delete: len(noisy_dataset) 1729
epoch [69/200] batch [5/43] time 0.383 (0.442) data 0.252 (0.311) loss_x loss_x 0.9707 (1.1467) acc_x 71.8750 (66.2500) lr 1.4955e-03 eta 0:00:16
epoch [69/200] batch [10/43] time 0.472 (0.446) data 0.341 (0.315) loss_x loss_x 1.0938 (1.1457) acc_x 68.7500 (68.1250) lr 1.4955e-03 eta 0:00:14
epoch [69/200] batch [15/43] time 0.723 (0.482) data 0.592 (0.351) loss_x loss_x 1.2744 (1.2307) acc_x 71.8750 (66.2500) lr 1.4955e-03 eta 0:00:13
epoch [69/200] batch [20/43] time 0.477 (0.502) data 0.338 (0.370) loss_x loss_x 0.7993 (1.2122) acc_x 81.2500 (65.7812) lr 1.4955e-03 eta 0:00:11
epoch [69/200] batch [25/43] time 0.511 (0.503) data 0.381 (0.371) loss_x loss_x 1.0713 (1.2023) acc_x 75.0000 (66.8750) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [30/43] time 0.424 (0.492) data 0.293 (0.361) loss_x loss_x 1.8906 (1.2569) acc_x 56.2500 (65.5208) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [35/43] time 0.473 (0.482) data 0.343 (0.350) loss_x loss_x 1.5020 (1.2706) acc_x 71.8750 (65.5357) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [40/43] time 0.378 (0.473) data 0.247 (0.342) loss_x loss_x 0.9541 (1.2525) acc_x 75.0000 (66.2500) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4506, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1413
clean true:1412
clean false:1
clean_rate:0.9992922859164898
noisy true:170
noisy false:1553
after delete: len(clean_dataset) 1413
after delete: len(noisy_dataset) 1723
epoch [70/200] batch [5/44] time 0.452 (0.463) data 0.322 (0.332) loss_x loss_x 1.0244 (1.2791) acc_x 81.2500 (69.3750) lr 1.4818e-03 eta 0:00:18
epoch [70/200] batch [10/44] time 0.460 (0.465) data 0.329 (0.334) loss_x loss_x 1.3447 (1.3264) acc_x 62.5000 (67.1875) lr 1.4818e-03 eta 0:00:15
epoch [70/200] batch [15/44] time 0.380 (0.478) data 0.249 (0.347) loss_x loss_x 1.3721 (1.3252) acc_x 68.7500 (67.2917) lr 1.4818e-03 eta 0:00:13
epoch [70/200] batch [20/44] time 0.466 (0.474) data 0.335 (0.343) loss_x loss_x 0.9414 (1.3355) acc_x 68.7500 (66.4062) lr 1.4818e-03 eta 0:00:11
epoch [70/200] batch [25/44] time 0.374 (0.466) data 0.243 (0.335) loss_x loss_x 0.7261 (1.2945) acc_x 75.0000 (66.5000) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [30/44] time 0.392 (0.468) data 0.261 (0.337) loss_x loss_x 1.1533 (1.2797) acc_x 65.6250 (66.8750) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [35/44] time 0.444 (0.468) data 0.313 (0.337) loss_x loss_x 1.5498 (1.2931) acc_x 59.3750 (66.6071) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [40/44] time 0.473 (0.469) data 0.341 (0.338) loss_x loss_x 1.0781 (1.2706) acc_x 71.8750 (67.2656) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1569
confident_label rate tensor(0.4445, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1394
clean true:1394
clean false:0
clean_rate:1.0
noisy true:173
noisy false:1569
after delete: len(clean_dataset) 1394
after delete: len(noisy_dataset) 1742
epoch [71/200] batch [5/43] time 0.495 (0.477) data 0.364 (0.346) loss_x loss_x 1.0859 (1.0935) acc_x 75.0000 (76.8750) lr 1.4679e-03 eta 0:00:18
epoch [71/200] batch [10/43] time 0.488 (0.455) data 0.358 (0.324) loss_x loss_x 1.0996 (1.2182) acc_x 84.3750 (73.4375) lr 1.4679e-03 eta 0:00:15
epoch [71/200] batch [15/43] time 0.481 (0.447) data 0.349 (0.316) loss_x loss_x 1.5830 (1.2723) acc_x 62.5000 (70.2083) lr 1.4679e-03 eta 0:00:12
epoch [71/200] batch [20/43] time 0.469 (0.446) data 0.339 (0.316) loss_x loss_x 1.2764 (1.2426) acc_x 68.7500 (70.3125) lr 1.4679e-03 eta 0:00:10
epoch [71/200] batch [25/43] time 0.704 (0.454) data 0.573 (0.324) loss_x loss_x 1.3652 (1.2509) acc_x 56.2500 (68.8750) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [30/43] time 0.440 (0.453) data 0.309 (0.322) loss_x loss_x 0.9121 (1.2420) acc_x 78.1250 (68.6458) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [35/43] time 0.458 (0.460) data 0.328 (0.329) loss_x loss_x 1.1260 (1.2545) acc_x 68.7500 (68.3036) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [40/43] time 0.409 (0.464) data 0.279 (0.334) loss_x loss_x 1.1543 (1.2490) acc_x 78.1250 (68.5156) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1589
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1378
clean true:1375
clean false:3
clean_rate:0.997822931785196
noisy true:172
noisy false:1586
after delete: len(clean_dataset) 1378
after delete: len(noisy_dataset) 1758
epoch [72/200] batch [5/43] time 0.561 (0.456) data 0.430 (0.325) loss_x loss_x 1.8018 (1.3303) acc_x 62.5000 (70.6250) lr 1.4540e-03 eta 0:00:17
epoch [72/200] batch [10/43] time 0.479 (0.470) data 0.348 (0.339) loss_x loss_x 1.8242 (1.3227) acc_x 62.5000 (70.6250) lr 1.4540e-03 eta 0:00:15
epoch [72/200] batch [15/43] time 0.457 (0.481) data 0.326 (0.350) loss_x loss_x 1.0928 (1.2984) acc_x 75.0000 (70.2083) lr 1.4540e-03 eta 0:00:13
epoch [72/200] batch [20/43] time 0.530 (0.472) data 0.399 (0.341) loss_x loss_x 1.4160 (1.3376) acc_x 65.6250 (68.4375) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [25/43] time 0.435 (0.466) data 0.304 (0.335) loss_x loss_x 1.3350 (1.3239) acc_x 68.7500 (68.1250) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [30/43] time 0.443 (0.465) data 0.312 (0.334) loss_x loss_x 1.5234 (1.3390) acc_x 62.5000 (67.7083) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [35/43] time 0.627 (0.463) data 0.496 (0.332) loss_x loss_x 1.5645 (1.3420) acc_x 59.3750 (67.5000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [40/43] time 0.409 (0.457) data 0.278 (0.326) loss_x loss_x 1.6592 (1.3335) acc_x 59.3750 (67.8125) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1426
clean true:1425
clean false:1
clean_rate:0.9992987377279102
noisy true:168
noisy false:1542
after delete: len(clean_dataset) 1426
after delete: len(noisy_dataset) 1710
epoch [73/200] batch [5/44] time 0.477 (0.464) data 0.347 (0.333) loss_x loss_x 1.6416 (1.4572) acc_x 59.3750 (68.1250) lr 1.4399e-03 eta 0:00:18
epoch [73/200] batch [10/44] time 0.453 (0.458) data 0.322 (0.328) loss_x loss_x 1.4727 (1.2852) acc_x 62.5000 (70.6250) lr 1.4399e-03 eta 0:00:15
epoch [73/200] batch [15/44] time 0.465 (0.464) data 0.335 (0.333) loss_x loss_x 1.5732 (1.2691) acc_x 71.8750 (69.7917) lr 1.4399e-03 eta 0:00:13
epoch [73/200] batch [20/44] time 0.442 (0.459) data 0.311 (0.329) loss_x loss_x 1.1084 (1.2713) acc_x 68.7500 (69.2188) lr 1.4399e-03 eta 0:00:11
epoch [73/200] batch [25/44] time 0.446 (0.470) data 0.316 (0.340) loss_x loss_x 1.2891 (1.2686) acc_x 68.7500 (69.1250) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [30/44] time 0.433 (0.464) data 0.302 (0.334) loss_x loss_x 1.3701 (1.2426) acc_x 56.2500 (69.5833) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [35/44] time 0.583 (0.463) data 0.452 (0.332) loss_x loss_x 1.1484 (1.2605) acc_x 71.8750 (68.8393) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [40/44] time 0.474 (0.466) data 0.343 (0.336) loss_x loss_x 1.2295 (1.2646) acc_x 59.3750 (68.3594) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.4477, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1404
clean true:1402
clean false:2
clean_rate:0.9985754985754985
noisy true:167
noisy false:1565
after delete: len(clean_dataset) 1404
after delete: len(noisy_dataset) 1732
epoch [74/200] batch [5/43] time 0.433 (0.469) data 0.303 (0.338) loss_x loss_x 1.0322 (1.2496) acc_x 78.1250 (69.3750) lr 1.4258e-03 eta 0:00:17
epoch [74/200] batch [10/43] time 0.450 (0.462) data 0.320 (0.332) loss_x loss_x 0.9458 (1.2625) acc_x 71.8750 (68.7500) lr 1.4258e-03 eta 0:00:15
epoch [74/200] batch [15/43] time 0.570 (0.459) data 0.440 (0.329) loss_x loss_x 0.8979 (1.2709) acc_x 81.2500 (68.5417) lr 1.4258e-03 eta 0:00:12
epoch [74/200] batch [20/43] time 0.426 (0.456) data 0.296 (0.325) loss_x loss_x 1.4033 (1.2883) acc_x 62.5000 (67.5000) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [25/43] time 0.463 (0.467) data 0.332 (0.337) loss_x loss_x 1.3486 (1.2314) acc_x 65.6250 (69.0000) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [30/43] time 0.398 (0.464) data 0.267 (0.333) loss_x loss_x 0.9575 (1.2214) acc_x 71.8750 (68.8542) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [35/43] time 0.552 (0.464) data 0.422 (0.334) loss_x loss_x 1.4141 (1.2248) acc_x 59.3750 (68.4821) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [40/43] time 0.442 (0.463) data 0.312 (0.333) loss_x loss_x 1.3447 (1.2621) acc_x 68.7500 (67.5781) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1540
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1438
clean true:1436
clean false:2
clean_rate:0.9986091794158554
noisy true:160
noisy false:1538
after delete: len(clean_dataset) 1438
after delete: len(noisy_dataset) 1698
epoch [75/200] batch [5/44] time 0.416 (0.439) data 0.286 (0.309) loss_x loss_x 0.9287 (1.2506) acc_x 75.0000 (71.8750) lr 1.4115e-03 eta 0:00:17
epoch [75/200] batch [10/44] time 0.427 (0.434) data 0.297 (0.304) loss_x loss_x 1.3418 (1.3760) acc_x 68.7500 (65.0000) lr 1.4115e-03 eta 0:00:14
epoch [75/200] batch [15/44] time 0.394 (0.444) data 0.264 (0.314) loss_x loss_x 1.2979 (1.3609) acc_x 62.5000 (64.7917) lr 1.4115e-03 eta 0:00:12
epoch [75/200] batch [20/44] time 0.481 (0.458) data 0.351 (0.328) loss_x loss_x 1.3672 (1.3556) acc_x 65.6250 (65.0000) lr 1.4115e-03 eta 0:00:10
epoch [75/200] batch [25/44] time 0.549 (0.449) data 0.418 (0.318) loss_x loss_x 1.5537 (1.3712) acc_x 71.8750 (65.3750) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [30/44] time 0.567 (0.455) data 0.436 (0.325) loss_x loss_x 0.9019 (1.3455) acc_x 71.8750 (65.2083) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [35/44] time 0.554 (0.465) data 0.423 (0.335) loss_x loss_x 1.0947 (1.3388) acc_x 62.5000 (65.8036) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [40/44] time 0.522 (0.474) data 0.391 (0.343) loss_x loss_x 0.8384 (1.3470) acc_x 78.1250 (66.0156) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.4531, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1421
clean true:1420
clean false:1
clean_rate:0.9992962702322308
noisy true:158
noisy false:1557
after delete: len(clean_dataset) 1421
after delete: len(noisy_dataset) 1715
epoch [76/200] batch [5/44] time 0.376 (0.456) data 0.245 (0.326) loss_x loss_x 1.1875 (1.3971) acc_x 71.8750 (64.3750) lr 1.3971e-03 eta 0:00:17
epoch [76/200] batch [10/44] time 0.454 (0.450) data 0.323 (0.320) loss_x loss_x 0.7847 (1.3389) acc_x 78.1250 (65.6250) lr 1.3971e-03 eta 0:00:15
epoch [76/200] batch [15/44] time 0.374 (0.455) data 0.243 (0.324) loss_x loss_x 1.4150 (1.3776) acc_x 68.7500 (66.6667) lr 1.3971e-03 eta 0:00:13
epoch [76/200] batch [20/44] time 0.389 (0.454) data 0.258 (0.324) loss_x loss_x 1.3945 (1.3552) acc_x 65.6250 (65.7812) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [25/44] time 0.497 (0.451) data 0.366 (0.320) loss_x loss_x 1.3818 (1.3352) acc_x 65.6250 (65.8750) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [30/44] time 0.449 (0.447) data 0.318 (0.317) loss_x loss_x 1.6250 (1.3485) acc_x 68.7500 (65.8333) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [35/44] time 0.480 (0.454) data 0.350 (0.324) loss_x loss_x 1.4326 (1.3239) acc_x 56.2500 (66.3393) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [40/44] time 0.370 (0.452) data 0.239 (0.321) loss_x loss_x 1.2471 (1.3230) acc_x 68.7500 (66.6406) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4509, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1414
clean true:1413
clean false:1
clean_rate:0.9992927864214993
noisy true:169
noisy false:1553
after delete: len(clean_dataset) 1414
after delete: len(noisy_dataset) 1722
epoch [77/200] batch [5/44] time 0.381 (0.467) data 0.250 (0.336) loss_x loss_x 1.1475 (1.2164) acc_x 68.7500 (68.7500) lr 1.3827e-03 eta 0:00:18
epoch [77/200] batch [10/44] time 0.384 (0.472) data 0.253 (0.341) loss_x loss_x 1.5820 (1.2861) acc_x 71.8750 (68.4375) lr 1.3827e-03 eta 0:00:16
epoch [77/200] batch [15/44] time 0.416 (0.456) data 0.285 (0.325) loss_x loss_x 0.8267 (1.2273) acc_x 78.1250 (70.0000) lr 1.3827e-03 eta 0:00:13
epoch [77/200] batch [20/44] time 0.605 (0.460) data 0.474 (0.329) loss_x loss_x 1.1074 (1.2076) acc_x 78.1250 (70.4688) lr 1.3827e-03 eta 0:00:11
epoch [77/200] batch [25/44] time 0.404 (0.463) data 0.273 (0.332) loss_x loss_x 0.9624 (1.2311) acc_x 81.2500 (70.2500) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [30/44] time 0.437 (0.469) data 0.306 (0.339) loss_x loss_x 1.1357 (1.2501) acc_x 75.0000 (69.8958) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [35/44] time 0.414 (0.465) data 0.283 (0.334) loss_x loss_x 1.5225 (1.2602) acc_x 65.6250 (69.2857) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [40/44] time 0.394 (0.470) data 0.263 (0.339) loss_x loss_x 1.8242 (1.2760) acc_x 50.0000 (68.6719) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1557
confident_label rate tensor(0.4496, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1410
clean true:1409
clean false:1
clean_rate:0.999290780141844
noisy true:170
noisy false:1556
after delete: len(clean_dataset) 1410
after delete: len(noisy_dataset) 1726
epoch [78/200] batch [5/44] time 0.466 (0.430) data 0.335 (0.299) loss_x loss_x 1.2412 (1.2940) acc_x 68.7500 (67.5000) lr 1.3681e-03 eta 0:00:16
epoch [78/200] batch [10/44] time 0.525 (0.448) data 0.395 (0.317) loss_x loss_x 0.7017 (1.2696) acc_x 81.2500 (65.9375) lr 1.3681e-03 eta 0:00:15
epoch [78/200] batch [15/44] time 0.502 (0.453) data 0.371 (0.322) loss_x loss_x 1.3555 (1.2464) acc_x 65.6250 (66.6667) lr 1.3681e-03 eta 0:00:13
epoch [78/200] batch [20/44] time 0.408 (0.456) data 0.277 (0.326) loss_x loss_x 1.0352 (1.2625) acc_x 71.8750 (66.5625) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [25/44] time 0.488 (0.453) data 0.357 (0.323) loss_x loss_x 1.2314 (1.2439) acc_x 65.6250 (67.1250) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [30/44] time 0.441 (0.457) data 0.310 (0.326) loss_x loss_x 1.2100 (1.2844) acc_x 65.6250 (66.5625) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [35/44] time 0.539 (0.464) data 0.408 (0.334) loss_x loss_x 1.1738 (1.2776) acc_x 71.8750 (67.1429) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [40/44] time 0.542 (0.462) data 0.411 (0.331) loss_x loss_x 1.6504 (1.2919) acc_x 62.5000 (66.8750) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1420
clean true:1419
clean false:1
clean_rate:0.9992957746478873
noisy true:150
noisy false:1566
after delete: len(clean_dataset) 1420
after delete: len(noisy_dataset) 1716
epoch [79/200] batch [5/44] time 0.416 (0.415) data 0.285 (0.285) loss_x loss_x 1.2422 (1.2922) acc_x 62.5000 (66.8750) lr 1.3535e-03 eta 0:00:16
epoch [79/200] batch [10/44] time 0.514 (0.436) data 0.383 (0.305) loss_x loss_x 1.0488 (1.3620) acc_x 62.5000 (65.0000) lr 1.3535e-03 eta 0:00:14
epoch [79/200] batch [15/44] time 0.543 (0.448) data 0.412 (0.318) loss_x loss_x 1.1914 (1.3262) acc_x 68.7500 (65.0000) lr 1.3535e-03 eta 0:00:13
epoch [79/200] batch [20/44] time 0.374 (0.453) data 0.243 (0.322) loss_x loss_x 1.7080 (1.3413) acc_x 59.3750 (65.6250) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [25/44] time 0.423 (0.447) data 0.292 (0.316) loss_x loss_x 1.1250 (1.2837) acc_x 68.7500 (66.5000) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [30/44] time 0.630 (0.444) data 0.499 (0.313) loss_x loss_x 0.8682 (1.2580) acc_x 84.3750 (67.8125) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [35/44] time 0.352 (0.455) data 0.221 (0.324) loss_x loss_x 1.7959 (1.2689) acc_x 50.0000 (67.8571) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [40/44] time 0.365 (0.452) data 0.234 (0.321) loss_x loss_x 1.2266 (1.2696) acc_x 71.8750 (67.8906) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.4525, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1419
clean true:1417
clean false:2
clean_rate:0.9985905567300916
noisy true:170
noisy false:1547
after delete: len(clean_dataset) 1419
after delete: len(noisy_dataset) 1717
epoch [80/200] batch [5/44] time 0.457 (0.475) data 0.327 (0.345) loss_x loss_x 1.7617 (1.4229) acc_x 59.3750 (63.1250) lr 1.3387e-03 eta 0:00:18
epoch [80/200] batch [10/44] time 0.481 (0.472) data 0.351 (0.342) loss_x loss_x 0.9385 (1.3490) acc_x 71.8750 (65.6250) lr 1.3387e-03 eta 0:00:16
epoch [80/200] batch [15/44] time 0.606 (0.482) data 0.476 (0.351) loss_x loss_x 1.5049 (1.3727) acc_x 59.3750 (66.2500) lr 1.3387e-03 eta 0:00:13
epoch [80/200] batch [20/44] time 0.525 (0.479) data 0.394 (0.349) loss_x loss_x 1.1855 (1.3244) acc_x 68.7500 (66.8750) lr 1.3387e-03 eta 0:00:11
epoch [80/200] batch [25/44] time 0.608 (0.477) data 0.478 (0.347) loss_x loss_x 1.2939 (1.3080) acc_x 59.3750 (66.8750) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [30/44] time 0.451 (0.470) data 0.320 (0.339) loss_x loss_x 0.9165 (1.3199) acc_x 71.8750 (66.5625) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [35/44] time 0.425 (0.469) data 0.294 (0.338) loss_x loss_x 1.3984 (1.3301) acc_x 71.8750 (67.1429) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [40/44] time 0.353 (0.466) data 0.222 (0.336) loss_x loss_x 1.0566 (1.3039) acc_x 75.0000 (67.4219) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1563
confident_label rate tensor(0.4471, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1402
clean true:1401
clean false:1
clean_rate:0.9992867332382311
noisy true:172
noisy false:1562
after delete: len(clean_dataset) 1402
after delete: len(noisy_dataset) 1734
epoch [81/200] batch [5/43] time 0.510 (0.464) data 0.380 (0.333) loss_x loss_x 1.3232 (1.2046) acc_x 65.6250 (71.2500) lr 1.3239e-03 eta 0:00:17
epoch [81/200] batch [10/43] time 0.611 (0.479) data 0.480 (0.349) loss_x loss_x 1.0820 (1.1752) acc_x 68.7500 (70.0000) lr 1.3239e-03 eta 0:00:15
epoch [81/200] batch [15/43] time 0.504 (0.461) data 0.373 (0.330) loss_x loss_x 1.1445 (1.1703) acc_x 78.1250 (71.2500) lr 1.3239e-03 eta 0:00:12
epoch [81/200] batch [20/43] time 0.418 (0.458) data 0.287 (0.328) loss_x loss_x 1.1787 (1.1935) acc_x 65.6250 (71.2500) lr 1.3239e-03 eta 0:00:10
epoch [81/200] batch [25/43] time 0.424 (0.453) data 0.293 (0.322) loss_x loss_x 0.7666 (1.2221) acc_x 71.8750 (70.5000) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [30/43] time 0.493 (0.460) data 0.362 (0.329) loss_x loss_x 1.1416 (1.2278) acc_x 68.7500 (69.8958) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [35/43] time 0.478 (0.466) data 0.348 (0.336) loss_x loss_x 1.3457 (1.2489) acc_x 68.7500 (69.5536) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [40/43] time 0.414 (0.464) data 0.283 (0.333) loss_x loss_x 0.8521 (1.2164) acc_x 81.2500 (70.4688) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1536
confident_label rate tensor(0.4560, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1430
clean true:1428
clean false:2
clean_rate:0.9986013986013986
noisy true:172
noisy false:1534
after delete: len(clean_dataset) 1430
after delete: len(noisy_dataset) 1706
epoch [82/200] batch [5/44] time 0.546 (0.487) data 0.416 (0.356) loss_x loss_x 0.8848 (1.0606) acc_x 75.0000 (71.2500) lr 1.3090e-03 eta 0:00:18
epoch [82/200] batch [10/44] time 0.438 (0.508) data 0.307 (0.377) loss_x loss_x 1.2402 (1.2133) acc_x 59.3750 (67.1875) lr 1.3090e-03 eta 0:00:17
epoch [82/200] batch [15/44] time 0.391 (0.496) data 0.260 (0.365) loss_x loss_x 1.2422 (1.2724) acc_x 71.8750 (66.0417) lr 1.3090e-03 eta 0:00:14
epoch [82/200] batch [20/44] time 0.357 (0.488) data 0.226 (0.357) loss_x loss_x 1.3477 (1.3691) acc_x 53.1250 (64.2188) lr 1.3090e-03 eta 0:00:11
epoch [82/200] batch [25/44] time 0.418 (0.464) data 0.287 (0.334) loss_x loss_x 1.2432 (1.3437) acc_x 65.6250 (64.6250) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [30/44] time 0.539 (0.472) data 0.409 (0.341) loss_x loss_x 1.5410 (1.3233) acc_x 59.3750 (65.7292) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [35/44] time 0.545 (0.468) data 0.416 (0.337) loss_x loss_x 2.0391 (1.3372) acc_x 59.3750 (65.5357) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [40/44] time 0.580 (0.470) data 0.450 (0.339) loss_x loss_x 1.2295 (1.3454) acc_x 68.7500 (65.8594) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1501
confident_label rate tensor(0.4662, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1462
clean true:1461
clean false:1
clean_rate:0.9993160054719562
noisy true:174
noisy false:1500
after delete: len(clean_dataset) 1462
after delete: len(noisy_dataset) 1674
epoch [83/200] batch [5/45] time 0.433 (0.460) data 0.302 (0.329) loss_x loss_x 1.4834 (1.2251) acc_x 68.7500 (70.0000) lr 1.2940e-03 eta 0:00:18
epoch [83/200] batch [10/45] time 0.519 (0.477) data 0.388 (0.346) loss_x loss_x 1.2227 (1.2117) acc_x 62.5000 (70.0000) lr 1.2940e-03 eta 0:00:16
epoch [83/200] batch [15/45] time 0.444 (0.454) data 0.313 (0.323) loss_x loss_x 0.9648 (1.1752) acc_x 71.8750 (70.6250) lr 1.2940e-03 eta 0:00:13
epoch [83/200] batch [20/45] time 0.547 (0.463) data 0.416 (0.331) loss_x loss_x 0.7817 (1.2024) acc_x 81.2500 (71.0938) lr 1.2940e-03 eta 0:00:11
epoch [83/200] batch [25/45] time 0.503 (0.470) data 0.372 (0.339) loss_x loss_x 1.1875 (1.2126) acc_x 75.0000 (70.5000) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [30/45] time 0.462 (0.469) data 0.332 (0.338) loss_x loss_x 1.4121 (1.1975) acc_x 59.3750 (70.3125) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [35/45] time 0.469 (0.465) data 0.338 (0.333) loss_x loss_x 1.6963 (1.2382) acc_x 59.3750 (69.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [40/45] time 0.456 (0.460) data 0.325 (0.329) loss_x loss_x 1.2188 (1.2470) acc_x 62.5000 (68.5156) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [45/45] time 0.332 (0.468) data 0.200 (0.337) loss_x loss_x 1.5596 (1.2580) acc_x 65.6250 (68.6111) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4512, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1415
clean true:1413
clean false:2
clean_rate:0.9985865724381625
noisy true:169
noisy false:1552
after delete: len(clean_dataset) 1415
after delete: len(noisy_dataset) 1721
epoch [84/200] batch [5/44] time 0.432 (0.449) data 0.301 (0.318) loss_x loss_x 1.1182 (1.0891) acc_x 59.3750 (68.7500) lr 1.2790e-03 eta 0:00:17
epoch [84/200] batch [10/44] time 0.459 (0.472) data 0.329 (0.341) loss_x loss_x 1.2236 (1.0958) acc_x 62.5000 (69.6875) lr 1.2790e-03 eta 0:00:16
epoch [84/200] batch [15/44] time 0.402 (0.476) data 0.272 (0.345) loss_x loss_x 1.4756 (1.2326) acc_x 59.3750 (66.8750) lr 1.2790e-03 eta 0:00:13
epoch [84/200] batch [20/44] time 0.471 (0.485) data 0.340 (0.355) loss_x loss_x 0.9624 (1.1989) acc_x 65.6250 (66.7188) lr 1.2790e-03 eta 0:00:11
epoch [84/200] batch [25/44] time 0.435 (0.468) data 0.304 (0.338) loss_x loss_x 1.3818 (1.2006) acc_x 62.5000 (67.3750) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [30/44] time 0.531 (0.466) data 0.400 (0.335) loss_x loss_x 0.8320 (1.1946) acc_x 84.3750 (68.1250) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [35/44] time 0.482 (0.464) data 0.351 (0.333) loss_x loss_x 0.6694 (1.2070) acc_x 84.3750 (68.4821) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [40/44] time 0.368 (0.462) data 0.237 (0.331) loss_x loss_x 1.1230 (1.2243) acc_x 75.0000 (68.1250) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1523
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1447
clean true:1445
clean false:2
clean_rate:0.9986178299930891
noisy true:168
noisy false:1521
after delete: len(clean_dataset) 1447
after delete: len(noisy_dataset) 1689
epoch [85/200] batch [5/45] time 0.623 (0.475) data 0.492 (0.344) loss_x loss_x 1.2559 (1.3165) acc_x 65.6250 (67.5000) lr 1.2639e-03 eta 0:00:19
epoch [85/200] batch [10/45] time 0.408 (0.462) data 0.277 (0.331) loss_x loss_x 1.3672 (1.2166) acc_x 65.6250 (70.0000) lr 1.2639e-03 eta 0:00:16
epoch [85/200] batch [15/45] time 0.472 (0.461) data 0.341 (0.330) loss_x loss_x 1.1152 (1.2132) acc_x 68.7500 (69.7917) lr 1.2639e-03 eta 0:00:13
epoch [85/200] batch [20/45] time 0.318 (0.437) data 0.187 (0.306) loss_x loss_x 1.0947 (1.2042) acc_x 71.8750 (70.0000) lr 1.2639e-03 eta 0:00:10
epoch [85/200] batch [25/45] time 0.407 (0.438) data 0.276 (0.307) loss_x loss_x 1.2432 (1.1775) acc_x 68.7500 (71.0000) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [30/45] time 0.443 (0.451) data 0.312 (0.320) loss_x loss_x 1.5137 (1.2126) acc_x 59.3750 (69.8958) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [35/45] time 0.384 (0.455) data 0.253 (0.324) loss_x loss_x 1.4453 (1.1905) acc_x 62.5000 (70.2679) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [40/45] time 0.517 (0.455) data 0.387 (0.324) loss_x loss_x 0.9834 (1.1859) acc_x 68.7500 (70.0781) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [45/45] time 0.629 (0.458) data 0.498 (0.327) loss_x loss_x 1.1514 (1.1993) acc_x 71.8750 (69.7917) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1420
clean true:1416
clean false:4
clean_rate:0.9971830985915493
noisy true:190
noisy false:1526
after delete: len(clean_dataset) 1420
after delete: len(noisy_dataset) 1716
epoch [86/200] batch [5/44] time 0.378 (0.447) data 0.247 (0.316) loss_x loss_x 1.2178 (1.2152) acc_x 71.8750 (68.7500) lr 1.2487e-03 eta 0:00:17
epoch [86/200] batch [10/44] time 0.445 (0.451) data 0.315 (0.320) loss_x loss_x 1.2881 (1.3340) acc_x 68.7500 (65.9375) lr 1.2487e-03 eta 0:00:15
epoch [86/200] batch [15/44] time 0.428 (0.439) data 0.296 (0.308) loss_x loss_x 1.5947 (1.3201) acc_x 56.2500 (66.0417) lr 1.2487e-03 eta 0:00:12
epoch [86/200] batch [20/44] time 0.394 (0.432) data 0.264 (0.301) loss_x loss_x 1.0273 (1.3230) acc_x 71.8750 (65.4688) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [25/44] time 0.353 (0.426) data 0.222 (0.296) loss_x loss_x 1.4658 (1.3271) acc_x 59.3750 (65.7500) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [30/44] time 0.401 (0.436) data 0.270 (0.306) loss_x loss_x 1.3027 (1.3089) acc_x 68.7500 (66.2500) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [35/44] time 0.464 (0.439) data 0.333 (0.308) loss_x loss_x 0.7407 (1.2629) acc_x 78.1250 (67.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [40/44] time 0.379 (0.440) data 0.248 (0.310) loss_x loss_x 1.3711 (1.2529) acc_x 68.7500 (67.5781) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.4464, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1400
clean true:1398
clean false:2
clean_rate:0.9985714285714286
noisy true:172
noisy false:1564
after delete: len(clean_dataset) 1400
after delete: len(noisy_dataset) 1736
epoch [87/200] batch [5/43] time 0.352 (0.459) data 0.221 (0.328) loss_x loss_x 1.0049 (1.0282) acc_x 71.8750 (76.2500) lr 1.2334e-03 eta 0:00:17
epoch [87/200] batch [10/43] time 0.424 (0.449) data 0.294 (0.318) loss_x loss_x 1.0430 (1.1333) acc_x 75.0000 (72.8125) lr 1.2334e-03 eta 0:00:14
epoch [87/200] batch [15/43] time 0.411 (0.440) data 0.280 (0.309) loss_x loss_x 0.8862 (1.1336) acc_x 75.0000 (70.6250) lr 1.2334e-03 eta 0:00:12
epoch [87/200] batch [20/43] time 0.445 (0.446) data 0.314 (0.316) loss_x loss_x 1.6016 (1.1940) acc_x 56.2500 (69.2188) lr 1.2334e-03 eta 0:00:10
epoch [87/200] batch [25/43] time 0.402 (0.452) data 0.270 (0.321) loss_x loss_x 1.2021 (1.2128) acc_x 78.1250 (69.3750) lr 1.2334e-03 eta 0:00:08
epoch [87/200] batch [30/43] time 0.538 (0.459) data 0.407 (0.328) loss_x loss_x 1.4082 (1.2165) acc_x 65.6250 (69.1667) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [35/43] time 0.630 (0.466) data 0.500 (0.335) loss_x loss_x 0.6855 (1.1944) acc_x 71.8750 (69.8214) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [40/43] time 0.388 (0.461) data 0.258 (0.331) loss_x loss_x 1.5713 (1.2002) acc_x 62.5000 (69.8438) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1544
confident_label rate tensor(0.4518, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1417
clean true:1416
clean false:1
clean_rate:0.9992942836979535
noisy true:176
noisy false:1543
after delete: len(clean_dataset) 1417
after delete: len(noisy_dataset) 1719
epoch [88/200] batch [5/44] time 0.507 (0.564) data 0.376 (0.432) loss_x loss_x 1.4697 (1.2880) acc_x 65.6250 (66.8750) lr 1.2181e-03 eta 0:00:21
epoch [88/200] batch [10/44] time 0.444 (0.520) data 0.313 (0.388) loss_x loss_x 1.0889 (1.1893) acc_x 71.8750 (68.7500) lr 1.2181e-03 eta 0:00:17
epoch [88/200] batch [15/44] time 0.419 (0.498) data 0.288 (0.367) loss_x loss_x 1.4648 (1.1501) acc_x 68.7500 (70.8333) lr 1.2181e-03 eta 0:00:14
epoch [88/200] batch [20/44] time 0.399 (0.482) data 0.268 (0.351) loss_x loss_x 1.1719 (1.1465) acc_x 75.0000 (70.4688) lr 1.2181e-03 eta 0:00:11
epoch [88/200] batch [25/44] time 0.449 (0.480) data 0.318 (0.349) loss_x loss_x 1.2539 (1.1553) acc_x 65.6250 (70.2500) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [30/44] time 0.477 (0.481) data 0.346 (0.350) loss_x loss_x 1.5918 (1.1443) acc_x 65.6250 (70.4167) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [35/44] time 0.396 (0.474) data 0.266 (0.343) loss_x loss_x 1.5283 (1.1916) acc_x 53.1250 (69.1071) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [40/44] time 0.516 (0.476) data 0.386 (0.345) loss_x loss_x 1.0586 (1.1922) acc_x 78.1250 (69.8438) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1496
confident_label rate tensor(0.4668, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1464
clean true:1463
clean false:1
clean_rate:0.9993169398907104
noisy true:177
noisy false:1495
after delete: len(clean_dataset) 1464
after delete: len(noisy_dataset) 1672
epoch [89/200] batch [5/45] time 0.539 (0.460) data 0.406 (0.329) loss_x loss_x 1.4932 (1.2238) acc_x 59.3750 (67.5000) lr 1.2028e-03 eta 0:00:18
epoch [89/200] batch [10/45] time 0.389 (0.465) data 0.258 (0.334) loss_x loss_x 1.1162 (1.1835) acc_x 68.7500 (67.8125) lr 1.2028e-03 eta 0:00:16
epoch [89/200] batch [15/45] time 0.453 (0.481) data 0.322 (0.350) loss_x loss_x 1.8066 (1.2735) acc_x 59.3750 (67.2917) lr 1.2028e-03 eta 0:00:14
epoch [89/200] batch [20/45] time 0.449 (0.466) data 0.318 (0.335) loss_x loss_x 1.0000 (1.2856) acc_x 81.2500 (67.6562) lr 1.2028e-03 eta 0:00:11
epoch [89/200] batch [25/45] time 0.349 (0.457) data 0.219 (0.327) loss_x loss_x 1.2051 (1.2545) acc_x 78.1250 (69.2500) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [30/45] time 0.499 (0.462) data 0.369 (0.331) loss_x loss_x 0.7383 (1.2250) acc_x 81.2500 (69.6875) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [35/45] time 0.414 (0.466) data 0.283 (0.336) loss_x loss_x 1.2871 (1.2333) acc_x 71.8750 (69.5536) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [40/45] time 0.618 (0.467) data 0.488 (0.337) loss_x loss_x 1.0381 (1.2527) acc_x 71.8750 (68.5938) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [45/45] time 0.402 (0.465) data 0.272 (0.334) loss_x loss_x 1.0322 (1.2531) acc_x 62.5000 (67.7083) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1523
confident_label rate tensor(0.4624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1450
clean true:1448
clean false:2
clean_rate:0.9986206896551724
noisy true:165
noisy false:1521
after delete: len(clean_dataset) 1450
after delete: len(noisy_dataset) 1686
epoch [90/200] batch [5/45] time 0.429 (0.432) data 0.298 (0.301) loss_x loss_x 0.8633 (1.2811) acc_x 87.5000 (65.6250) lr 1.1874e-03 eta 0:00:17
epoch [90/200] batch [10/45] time 0.380 (0.417) data 0.250 (0.286) loss_x loss_x 1.4863 (1.3290) acc_x 68.7500 (66.5625) lr 1.1874e-03 eta 0:00:14
epoch [90/200] batch [15/45] time 0.406 (0.444) data 0.275 (0.313) loss_x loss_x 1.0312 (1.3048) acc_x 71.8750 (67.0833) lr 1.1874e-03 eta 0:00:13
epoch [90/200] batch [20/45] time 0.468 (0.461) data 0.337 (0.330) loss_x loss_x 1.4092 (1.2899) acc_x 68.7500 (67.5000) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [25/45] time 0.568 (0.468) data 0.437 (0.337) loss_x loss_x 1.2656 (1.2689) acc_x 71.8750 (68.2500) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [30/45] time 0.411 (0.465) data 0.280 (0.334) loss_x loss_x 1.2529 (1.2839) acc_x 71.8750 (67.7083) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [35/45] time 0.506 (0.468) data 0.375 (0.337) loss_x loss_x 0.5088 (1.2512) acc_x 87.5000 (68.8393) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [40/45] time 0.524 (0.465) data 0.392 (0.334) loss_x loss_x 1.3027 (1.2366) acc_x 71.8750 (69.0625) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [45/45] time 0.471 (0.468) data 0.341 (0.337) loss_x loss_x 1.1445 (1.2441) acc_x 75.0000 (68.8194) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1547
confident_label rate tensor(0.4554, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1428
clean true:1427
clean false:1
clean_rate:0.9992997198879552
noisy true:162
noisy false:1546
after delete: len(clean_dataset) 1428
after delete: len(noisy_dataset) 1708
epoch [91/200] batch [5/44] time 0.432 (0.443) data 0.301 (0.312) loss_x loss_x 1.2412 (1.3211) acc_x 68.7500 (67.5000) lr 1.1719e-03 eta 0:00:17
epoch [91/200] batch [10/44] time 0.590 (0.475) data 0.458 (0.344) loss_x loss_x 1.6826 (1.3580) acc_x 62.5000 (66.5625) lr 1.1719e-03 eta 0:00:16
epoch [91/200] batch [15/44] time 0.597 (0.482) data 0.465 (0.351) loss_x loss_x 1.2324 (1.2694) acc_x 59.3750 (67.9167) lr 1.1719e-03 eta 0:00:13
epoch [91/200] batch [20/44] time 0.438 (0.469) data 0.308 (0.338) loss_x loss_x 1.0498 (1.2444) acc_x 75.0000 (69.3750) lr 1.1719e-03 eta 0:00:11
epoch [91/200] batch [25/44] time 0.545 (0.466) data 0.413 (0.335) loss_x loss_x 1.1182 (1.2699) acc_x 81.2500 (69.1250) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [30/44] time 0.622 (0.468) data 0.491 (0.337) loss_x loss_x 1.3916 (1.2570) acc_x 65.6250 (68.9583) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [35/44] time 0.447 (0.463) data 0.317 (0.332) loss_x loss_x 1.6377 (1.2810) acc_x 65.6250 (67.7679) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [40/44] time 0.451 (0.458) data 0.321 (0.327) loss_x loss_x 1.3945 (1.2871) acc_x 68.7500 (67.5781) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4605, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1444
clean true:1444
clean false:0
clean_rate:1.0
noisy true:180
noisy false:1512
after delete: len(clean_dataset) 1444
after delete: len(noisy_dataset) 1692
epoch [92/200] batch [5/45] time 0.438 (0.420) data 0.307 (0.289) loss_x loss_x 1.0410 (1.1787) acc_x 75.0000 (70.0000) lr 1.1564e-03 eta 0:00:16
epoch [92/200] batch [10/45] time 0.446 (0.424) data 0.315 (0.293) loss_x loss_x 1.3789 (1.2882) acc_x 71.8750 (68.1250) lr 1.1564e-03 eta 0:00:14
epoch [92/200] batch [15/45] time 0.529 (0.460) data 0.399 (0.329) loss_x loss_x 1.1104 (1.2227) acc_x 81.2500 (69.7917) lr 1.1564e-03 eta 0:00:13
epoch [92/200] batch [20/45] time 0.454 (0.455) data 0.319 (0.324) loss_x loss_x 1.1885 (1.2435) acc_x 65.6250 (69.6875) lr 1.1564e-03 eta 0:00:11
epoch [92/200] batch [25/45] time 0.334 (0.457) data 0.204 (0.325) loss_x loss_x 1.1162 (1.2615) acc_x 68.7500 (68.8750) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [30/45] time 0.429 (0.456) data 0.298 (0.325) loss_x loss_x 1.1768 (1.2569) acc_x 75.0000 (69.0625) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [35/45] time 0.447 (0.457) data 0.317 (0.326) loss_x loss_x 1.6445 (1.2743) acc_x 59.3750 (68.5714) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [40/45] time 0.594 (0.457) data 0.464 (0.326) loss_x loss_x 1.0830 (1.2699) acc_x 68.7500 (68.5156) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [45/45] time 0.620 (0.458) data 0.490 (0.327) loss_x loss_x 1.2422 (1.2558) acc_x 71.8750 (69.1667) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1485
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1475
clean true:1473
clean false:2
clean_rate:0.9986440677966102
noisy true:178
noisy false:1483
after delete: len(clean_dataset) 1475
after delete: len(noisy_dataset) 1661
epoch [93/200] batch [5/46] time 0.503 (0.460) data 0.372 (0.329) loss_x loss_x 1.5420 (1.3174) acc_x 68.7500 (70.6250) lr 1.1409e-03 eta 0:00:18
epoch [93/200] batch [10/46] time 0.496 (0.472) data 0.366 (0.341) loss_x loss_x 1.1387 (1.2199) acc_x 68.7500 (68.1250) lr 1.1409e-03 eta 0:00:16
epoch [93/200] batch [15/46] time 0.441 (0.455) data 0.311 (0.324) loss_x loss_x 1.3242 (1.2363) acc_x 59.3750 (68.1250) lr 1.1409e-03 eta 0:00:14
epoch [93/200] batch [20/46] time 0.479 (0.453) data 0.348 (0.322) loss_x loss_x 1.4336 (1.2529) acc_x 59.3750 (66.8750) lr 1.1409e-03 eta 0:00:11
epoch [93/200] batch [25/46] time 0.411 (0.443) data 0.280 (0.312) loss_x loss_x 1.1562 (1.2516) acc_x 71.8750 (67.0000) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [30/46] time 0.461 (0.454) data 0.329 (0.323) loss_x loss_x 1.0205 (1.2452) acc_x 71.8750 (67.7083) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [35/46] time 0.616 (0.456) data 0.485 (0.325) loss_x loss_x 1.7744 (1.2671) acc_x 50.0000 (67.5000) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [40/46] time 0.412 (0.458) data 0.282 (0.327) loss_x loss_x 1.0166 (1.2850) acc_x 68.7500 (67.3438) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [45/46] time 0.513 (0.464) data 0.382 (0.333) loss_x loss_x 1.7285 (1.3201) acc_x 59.3750 (66.6667) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1438
clean true:1435
clean false:3
clean_rate:0.997913769123783
noisy true:171
noisy false:1527
after delete: len(clean_dataset) 1438
after delete: len(noisy_dataset) 1698
epoch [94/200] batch [5/44] time 0.430 (0.460) data 0.300 (0.330) loss_x loss_x 0.8882 (1.0707) acc_x 78.1250 (73.7500) lr 1.1253e-03 eta 0:00:17
epoch [94/200] batch [10/44] time 0.404 (0.444) data 0.274 (0.314) loss_x loss_x 0.6953 (1.0963) acc_x 81.2500 (73.1250) lr 1.1253e-03 eta 0:00:15
epoch [94/200] batch [15/44] time 0.516 (0.467) data 0.385 (0.337) loss_x loss_x 1.3486 (1.1636) acc_x 65.6250 (71.6667) lr 1.1253e-03 eta 0:00:13
epoch [94/200] batch [20/44] time 0.428 (0.467) data 0.297 (0.337) loss_x loss_x 1.3242 (1.2042) acc_x 75.0000 (70.6250) lr 1.1253e-03 eta 0:00:11
epoch [94/200] batch [25/44] time 0.383 (0.459) data 0.252 (0.329) loss_x loss_x 1.0205 (1.2456) acc_x 75.0000 (70.0000) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [30/44] time 0.441 (0.467) data 0.310 (0.336) loss_x loss_x 1.6162 (1.2609) acc_x 68.7500 (69.8958) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [35/44] time 0.412 (0.461) data 0.281 (0.330) loss_x loss_x 0.8867 (1.2489) acc_x 71.8750 (69.9107) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [40/44] time 0.421 (0.459) data 0.290 (0.328) loss_x loss_x 1.0898 (1.2337) acc_x 75.0000 (70.2344) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4550, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1427
clean true:1426
clean false:1
clean_rate:0.9992992291520673
noisy true:186
noisy false:1523
after delete: len(clean_dataset) 1427
after delete: len(noisy_dataset) 1709
epoch [95/200] batch [5/44] time 0.411 (0.456) data 0.280 (0.325) loss_x loss_x 1.3701 (1.0868) acc_x 62.5000 (71.8750) lr 1.1097e-03 eta 0:00:17
epoch [95/200] batch [10/44] time 0.382 (0.471) data 0.252 (0.340) loss_x loss_x 1.2832 (1.1660) acc_x 68.7500 (70.0000) lr 1.1097e-03 eta 0:00:16
epoch [95/200] batch [15/44] time 0.555 (0.475) data 0.424 (0.344) loss_x loss_x 1.1465 (1.1787) acc_x 65.6250 (70.4167) lr 1.1097e-03 eta 0:00:13
epoch [95/200] batch [20/44] time 0.466 (0.463) data 0.335 (0.332) loss_x loss_x 1.1094 (1.1740) acc_x 62.5000 (69.2188) lr 1.1097e-03 eta 0:00:11
epoch [95/200] batch [25/44] time 0.441 (0.457) data 0.310 (0.326) loss_x loss_x 1.0850 (1.1678) acc_x 65.6250 (69.6250) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [30/44] time 0.471 (0.460) data 0.340 (0.329) loss_x loss_x 1.4785 (1.1745) acc_x 59.3750 (69.6875) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [35/44] time 0.385 (0.464) data 0.254 (0.333) loss_x loss_x 1.1387 (1.1772) acc_x 71.8750 (69.3750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [40/44] time 0.390 (0.460) data 0.259 (0.329) loss_x loss_x 1.0234 (1.1751) acc_x 75.0000 (69.2969) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1497
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1468
clean true:1467
clean false:1
clean_rate:0.9993188010899182
noisy true:172
noisy false:1496
after delete: len(clean_dataset) 1468
after delete: len(noisy_dataset) 1668
epoch [96/200] batch [5/45] time 0.491 (0.500) data 0.360 (0.369) loss_x loss_x 1.2520 (1.2357) acc_x 75.0000 (71.2500) lr 1.0941e-03 eta 0:00:19
epoch [96/200] batch [10/45] time 0.456 (0.468) data 0.325 (0.337) loss_x loss_x 1.5234 (1.2679) acc_x 56.2500 (70.3125) lr 1.0941e-03 eta 0:00:16
epoch [96/200] batch [15/45] time 0.376 (0.442) data 0.245 (0.311) loss_x loss_x 1.4141 (1.3196) acc_x 68.7500 (68.5417) lr 1.0941e-03 eta 0:00:13
epoch [96/200] batch [20/45] time 0.502 (0.446) data 0.371 (0.315) loss_x loss_x 1.3965 (1.3352) acc_x 65.6250 (68.1250) lr 1.0941e-03 eta 0:00:11
epoch [96/200] batch [25/45] time 0.365 (0.446) data 0.234 (0.315) loss_x loss_x 1.2656 (1.3484) acc_x 68.7500 (67.3750) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [30/45] time 0.422 (0.443) data 0.292 (0.312) loss_x loss_x 0.9951 (1.3248) acc_x 75.0000 (68.1250) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [35/45] time 0.381 (0.448) data 0.250 (0.317) loss_x loss_x 0.7783 (1.2902) acc_x 81.2500 (68.9286) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [40/45] time 0.480 (0.452) data 0.345 (0.321) loss_x loss_x 1.2578 (1.2791) acc_x 62.5000 (68.9844) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [45/45] time 0.444 (0.453) data 0.314 (0.322) loss_x loss_x 1.2783 (1.2769) acc_x 71.8750 (69.0278) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1493
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1470
clean true:1469
clean false:1
clean_rate:0.9993197278911564
noisy true:174
noisy false:1492
after delete: len(clean_dataset) 1470
after delete: len(noisy_dataset) 1666
epoch [97/200] batch [5/45] time 0.457 (0.451) data 0.326 (0.321) loss_x loss_x 1.1514 (1.1600) acc_x 65.6250 (65.0000) lr 1.0785e-03 eta 0:00:18
epoch [97/200] batch [10/45] time 0.515 (0.445) data 0.385 (0.314) loss_x loss_x 1.1494 (1.2435) acc_x 62.5000 (64.3750) lr 1.0785e-03 eta 0:00:15
epoch [97/200] batch [15/45] time 0.489 (0.459) data 0.359 (0.328) loss_x loss_x 1.3877 (1.2747) acc_x 59.3750 (64.7917) lr 1.0785e-03 eta 0:00:13
epoch [97/200] batch [20/45] time 0.422 (0.451) data 0.291 (0.320) loss_x loss_x 1.2305 (1.2488) acc_x 65.6250 (66.4062) lr 1.0785e-03 eta 0:00:11
epoch [97/200] batch [25/45] time 0.470 (0.452) data 0.340 (0.322) loss_x loss_x 1.3721 (1.2282) acc_x 71.8750 (68.2500) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [30/45] time 0.460 (0.451) data 0.329 (0.320) loss_x loss_x 1.3672 (1.2506) acc_x 71.8750 (68.0208) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [35/45] time 0.477 (0.449) data 0.347 (0.319) loss_x loss_x 1.6924 (1.2822) acc_x 50.0000 (67.4107) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [40/45] time 0.392 (0.446) data 0.262 (0.315) loss_x loss_x 1.1768 (1.2499) acc_x 62.5000 (68.2812) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [45/45] time 0.657 (0.455) data 0.526 (0.325) loss_x loss_x 1.2168 (1.2702) acc_x 71.8750 (67.9167) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1470
clean true:1468
clean false:2
clean_rate:0.998639455782313
noisy true:173
noisy false:1493
after delete: len(clean_dataset) 1470
after delete: len(noisy_dataset) 1666
epoch [98/200] batch [5/45] time 0.415 (0.454) data 0.284 (0.323) loss_x loss_x 1.3193 (1.2484) acc_x 68.7500 (67.5000) lr 1.0628e-03 eta 0:00:18
epoch [98/200] batch [10/45] time 0.410 (0.451) data 0.278 (0.320) loss_x loss_x 0.7192 (1.2314) acc_x 78.1250 (66.5625) lr 1.0628e-03 eta 0:00:15
epoch [98/200] batch [15/45] time 0.451 (0.452) data 0.321 (0.321) loss_x loss_x 0.8369 (1.1647) acc_x 75.0000 (67.5000) lr 1.0628e-03 eta 0:00:13
epoch [98/200] batch [20/45] time 0.609 (0.446) data 0.478 (0.315) loss_x loss_x 1.0176 (1.1173) acc_x 78.1250 (69.3750) lr 1.0628e-03 eta 0:00:11
epoch [98/200] batch [25/45] time 0.593 (0.451) data 0.462 (0.320) loss_x loss_x 0.9780 (1.1929) acc_x 68.7500 (68.5000) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [30/45] time 0.505 (0.453) data 0.374 (0.322) loss_x loss_x 1.2432 (1.1939) acc_x 56.2500 (68.0208) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [35/45] time 0.533 (0.455) data 0.402 (0.324) loss_x loss_x 1.5176 (1.2339) acc_x 62.5000 (67.2321) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [40/45] time 0.445 (0.455) data 0.315 (0.324) loss_x loss_x 1.1221 (1.2198) acc_x 71.8750 (67.8125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [45/45] time 0.611 (0.464) data 0.480 (0.333) loss_x loss_x 1.2441 (1.2126) acc_x 71.8750 (68.0556) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1496
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1466
clean true:1462
clean false:4
clean_rate:0.9972714870395635
noisy true:178
noisy false:1492
after delete: len(clean_dataset) 1466
after delete: len(noisy_dataset) 1670
epoch [99/200] batch [5/45] time 0.442 (0.495) data 0.311 (0.365) loss_x loss_x 1.1592 (1.0924) acc_x 65.6250 (71.8750) lr 1.0471e-03 eta 0:00:19
epoch [99/200] batch [10/45] time 0.401 (0.495) data 0.270 (0.364) loss_x loss_x 1.1006 (1.0500) acc_x 71.8750 (72.8125) lr 1.0471e-03 eta 0:00:17
epoch [99/200] batch [15/45] time 0.473 (0.474) data 0.342 (0.343) loss_x loss_x 1.2793 (1.1141) acc_x 75.0000 (71.8750) lr 1.0471e-03 eta 0:00:14
epoch [99/200] batch [20/45] time 0.391 (0.459) data 0.261 (0.328) loss_x loss_x 0.9824 (1.1841) acc_x 81.2500 (70.4688) lr 1.0471e-03 eta 0:00:11
epoch [99/200] batch [25/45] time 0.596 (0.474) data 0.466 (0.344) loss_x loss_x 0.9102 (1.2205) acc_x 81.2500 (70.0000) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [30/45] time 0.362 (0.472) data 0.232 (0.342) loss_x loss_x 1.4551 (1.2505) acc_x 62.5000 (69.1667) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [35/45] time 0.399 (0.468) data 0.268 (0.337) loss_x loss_x 0.8628 (1.2416) acc_x 81.2500 (69.4643) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [40/45] time 0.422 (0.468) data 0.291 (0.337) loss_x loss_x 1.1992 (1.2484) acc_x 62.5000 (69.4531) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [45/45] time 0.454 (0.468) data 0.323 (0.337) loss_x loss_x 1.2588 (1.2490) acc_x 71.8750 (69.5833) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1505
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1465
clean true:1464
clean false:1
clean_rate:0.9993174061433447
noisy true:167
noisy false:1504
all clean rate:  [0.9979959919839679, 0.998641304347826, 0.9990512333965844, 0.998211091234347, 0.9990892531876139, 1.0, 0.9990875912408759, 0.9974533106960951, 0.9991334488734835, 0.9982773471145564, 0.9991645781119465, 1.0, 0.9991334488734835, 0.9991204925241864, 0.9983347210657785, 1.0, 0.9991796554552912, 0.9975020815986678, 0.9974726200505476, 0.9983566146261298, 0.9991809991809992, 1.0, 0.9991850040749797, 0.9991843393148451, 0.9976452119309263, 0.9992082343626286, 0.9991830065359477, 0.9992012779552716, 0.9975980784627703, 0.9992181391712275, 0.9991769547325103, 0.9984447900466563, 0.9992012779552716, 1.0, 0.9984101748807631, 0.9975942261427426, 1.0, 0.9992175273865415, 0.9992193598750976, 0.9984484096198604, 0.9992565055762082, 1.0, 1.0, 0.9985250737463127, 0.9976762199845082, 0.9984012789768185, 0.9992313604919293, 0.9984674329501916, 0.9969811320754717, 1.0, 1.0, 1.0, 0.9992769342010123, 0.9992469879518072, 0.9985185185185185, 0.9992395437262357, 0.997827661115134, 0.9977761304670126, 0.9992764109985528, 0.9985805535841022, 0.9992795389048992, 0.9992892679459844, 1.0, 0.9985632183908046, 1.0, 0.9985865724381625, 0.9992641648270787, 1.0, 1.0, 0.9992922859164898, 1.0, 0.997822931785196, 0.9992987377279102, 0.9985754985754985, 0.9986091794158554, 0.9992962702322308, 0.9992927864214993, 0.999290780141844, 0.9992957746478873, 0.9985905567300916, 0.9992867332382311, 0.9986013986013986, 0.9993160054719562, 0.9985865724381625, 0.9986178299930891, 0.9971830985915493, 0.9985714285714286, 0.9992942836979535, 0.9993169398907104, 0.9986206896551724, 0.9992997198879552, 1.0, 0.9986440677966102, 0.997913769123783, 0.9992992291520673, 0.9993188010899182, 0.9993197278911564, 0.998639455782313, 0.9972714870395635, 0.9993174061433447]
after delete: len(clean_dataset) 1465
after delete: len(noisy_dataset) 1671
epoch [100/200] batch [5/45] time 0.407 (0.475) data 0.276 (0.343) loss_x loss_x 1.3525 (1.1745) acc_x 65.6250 (70.0000) lr 1.0314e-03 eta 0:00:18
epoch [100/200] batch [10/45] time 0.457 (0.490) data 0.327 (0.358) loss_x loss_x 1.2285 (1.1542) acc_x 71.8750 (71.2500) lr 1.0314e-03 eta 0:00:17
epoch [100/200] batch [15/45] time 0.403 (0.482) data 0.273 (0.351) loss_x loss_x 1.0137 (1.1727) acc_x 68.7500 (70.2083) lr 1.0314e-03 eta 0:00:14
epoch [100/200] batch [20/45] time 0.587 (0.470) data 0.456 (0.339) loss_x loss_x 1.6660 (1.1970) acc_x 62.5000 (68.9062) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [25/45] time 0.489 (0.464) data 0.359 (0.333) loss_x loss_x 1.5713 (1.2073) acc_x 56.2500 (68.6250) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [30/45] time 0.352 (0.462) data 0.221 (0.331) loss_x loss_x 1.4854 (1.2612) acc_x 59.3750 (67.3958) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [35/45] time 0.600 (0.473) data 0.470 (0.342) loss_x loss_x 1.1914 (1.2684) acc_x 71.8750 (67.2321) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [40/45] time 0.400 (0.465) data 0.270 (0.334) loss_x loss_x 1.3887 (1.2606) acc_x 68.7500 (67.5781) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [45/45] time 0.427 (0.462) data 0.297 (0.331) loss_x loss_x 1.5107 (1.2650) acc_x 53.1250 (66.8056) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4630, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1452
clean true:1450
clean false:2
clean_rate:0.9986225895316805
noisy true:172
noisy false:1512
after delete: len(clean_dataset) 1452
after delete: len(noisy_dataset) 1684
epoch [101/200] batch [5/45] time 0.519 (0.484) data 0.387 (0.352) loss_x loss_x 1.4678 (1.1885) acc_x 71.8750 (72.5000) lr 1.0157e-03 eta 0:00:19
epoch [101/200] batch [10/45] time 0.451 (0.463) data 0.320 (0.332) loss_x loss_x 1.4600 (1.2108) acc_x 62.5000 (71.5625) lr 1.0157e-03 eta 0:00:16
epoch [101/200] batch [15/45] time 0.496 (0.462) data 0.365 (0.331) loss_x loss_x 0.8906 (1.0998) acc_x 75.0000 (73.9583) lr 1.0157e-03 eta 0:00:13
epoch [101/200] batch [20/45] time 0.344 (0.446) data 0.213 (0.315) loss_x loss_x 1.2637 (1.1623) acc_x 65.6250 (71.7188) lr 1.0157e-03 eta 0:00:11
epoch [101/200] batch [25/45] time 0.489 (0.440) data 0.358 (0.309) loss_x loss_x 0.7920 (1.1365) acc_x 78.1250 (72.1250) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [30/45] time 0.398 (0.442) data 0.267 (0.311) loss_x loss_x 0.7329 (1.1306) acc_x 84.3750 (72.1875) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [35/45] time 0.383 (0.446) data 0.252 (0.315) loss_x loss_x 1.5635 (1.1587) acc_x 62.5000 (71.9643) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [40/45] time 0.449 (0.446) data 0.318 (0.315) loss_x loss_x 1.3232 (1.1417) acc_x 65.6250 (71.8750) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [45/45] time 0.450 (0.448) data 0.319 (0.317) loss_x loss_x 0.9893 (1.1599) acc_x 78.1250 (71.5278) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4713, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1478
clean true:1476
clean false:2
clean_rate:0.9986468200270636
noisy true:165
noisy false:1493
after delete: len(clean_dataset) 1478
after delete: len(noisy_dataset) 1658
epoch [102/200] batch [5/46] time 0.592 (0.517) data 0.461 (0.386) loss_x loss_x 1.4434 (1.3613) acc_x 65.6250 (65.0000) lr 1.0000e-03 eta 0:00:21
epoch [102/200] batch [10/46] time 0.431 (0.482) data 0.300 (0.352) loss_x loss_x 1.3721 (1.1932) acc_x 68.7500 (68.7500) lr 1.0000e-03 eta 0:00:17
epoch [102/200] batch [15/46] time 0.449 (0.474) data 0.318 (0.343) loss_x loss_x 1.3496 (1.1793) acc_x 75.0000 (68.7500) lr 1.0000e-03 eta 0:00:14
epoch [102/200] batch [20/46] time 0.472 (0.472) data 0.341 (0.341) loss_x loss_x 1.3330 (1.2387) acc_x 68.7500 (68.1250) lr 1.0000e-03 eta 0:00:12
epoch [102/200] batch [25/46] time 0.422 (0.461) data 0.291 (0.330) loss_x loss_x 1.8037 (1.2644) acc_x 62.5000 (67.7500) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [30/46] time 0.448 (0.457) data 0.318 (0.326) loss_x loss_x 1.0752 (1.2309) acc_x 81.2500 (68.4375) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [35/46] time 0.435 (0.453) data 0.304 (0.322) loss_x loss_x 1.4121 (1.2472) acc_x 56.2500 (68.2143) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [40/46] time 0.468 (0.448) data 0.338 (0.318) loss_x loss_x 1.1084 (1.2297) acc_x 75.0000 (68.2031) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [45/46] time 0.532 (0.452) data 0.401 (0.321) loss_x loss_x 1.2051 (1.2188) acc_x 71.8750 (68.2639) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1509
confident_label rate tensor(0.4652, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1459
clean true:1459
clean false:0
clean_rate:1.0
noisy true:168
noisy false:1509
after delete: len(clean_dataset) 1459
after delete: len(noisy_dataset) 1677
epoch [103/200] batch [5/45] time 0.406 (0.425) data 0.276 (0.294) loss_x loss_x 1.2520 (1.1602) acc_x 65.6250 (70.6250) lr 9.8429e-04 eta 0:00:17
epoch [103/200] batch [10/45] time 0.504 (0.468) data 0.374 (0.337) loss_x loss_x 1.0723 (1.1569) acc_x 75.0000 (73.1250) lr 9.8429e-04 eta 0:00:16
epoch [103/200] batch [15/45] time 0.438 (0.451) data 0.308 (0.320) loss_x loss_x 1.3496 (1.2412) acc_x 65.6250 (70.4167) lr 9.8429e-04 eta 0:00:13
epoch [103/200] batch [20/45] time 0.460 (0.464) data 0.330 (0.333) loss_x loss_x 1.6094 (1.3055) acc_x 62.5000 (68.7500) lr 9.8429e-04 eta 0:00:11
epoch [103/200] batch [25/45] time 0.460 (0.452) data 0.329 (0.321) loss_x loss_x 1.0996 (1.2693) acc_x 78.1250 (69.6250) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [30/45] time 0.438 (0.454) data 0.307 (0.323) loss_x loss_x 1.6143 (1.2716) acc_x 56.2500 (68.7500) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [35/45] time 0.382 (0.453) data 0.252 (0.322) loss_x loss_x 1.0654 (1.2593) acc_x 68.7500 (68.5714) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [40/45] time 0.339 (0.452) data 0.208 (0.322) loss_x loss_x 1.5049 (1.2510) acc_x 65.6250 (68.6719) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [45/45] time 0.446 (0.446) data 0.315 (0.316) loss_x loss_x 1.2549 (1.2470) acc_x 71.8750 (68.6111) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1471
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1502
clean true:1498
clean false:4
clean_rate:0.9973368841544608
noisy true:167
noisy false:1467
after delete: len(clean_dataset) 1502
after delete: len(noisy_dataset) 1634
epoch [104/200] batch [5/46] time 0.616 (0.435) data 0.486 (0.305) loss_x loss_x 0.9058 (1.2448) acc_x 75.0000 (70.0000) lr 9.6859e-04 eta 0:00:17
epoch [104/200] batch [10/46] time 0.484 (0.442) data 0.354 (0.312) loss_x loss_x 0.8555 (1.2526) acc_x 71.8750 (69.0625) lr 9.6859e-04 eta 0:00:15
epoch [104/200] batch [15/46] time 0.520 (0.469) data 0.385 (0.338) loss_x loss_x 1.0068 (1.2418) acc_x 65.6250 (68.9583) lr 9.6859e-04 eta 0:00:14
epoch [104/200] batch [20/46] time 0.370 (0.460) data 0.239 (0.330) loss_x loss_x 0.6069 (1.1953) acc_x 90.6250 (69.6875) lr 9.6859e-04 eta 0:00:11
epoch [104/200] batch [25/46] time 0.454 (0.459) data 0.324 (0.329) loss_x loss_x 1.2598 (1.2409) acc_x 62.5000 (68.6250) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [30/46] time 0.385 (0.462) data 0.254 (0.331) loss_x loss_x 0.9761 (1.2032) acc_x 81.2500 (69.6875) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [35/46] time 0.363 (0.455) data 0.233 (0.325) loss_x loss_x 1.9277 (1.2273) acc_x 53.1250 (68.5714) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [40/46] time 0.470 (0.450) data 0.340 (0.319) loss_x loss_x 1.4199 (1.2242) acc_x 65.6250 (69.0625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [45/46] time 0.374 (0.448) data 0.243 (0.317) loss_x loss_x 1.7461 (1.2656) acc_x 53.1250 (68.0556) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4716, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1479
clean true:1476
clean false:3
clean_rate:0.9979716024340771
noisy true:165
noisy false:1492
after delete: len(clean_dataset) 1479
after delete: len(noisy_dataset) 1657
epoch [105/200] batch [5/46] time 0.395 (0.442) data 0.265 (0.312) loss_x loss_x 1.1641 (1.3564) acc_x 68.7500 (66.8750) lr 9.5289e-04 eta 0:00:18
epoch [105/200] batch [10/46] time 0.532 (0.454) data 0.401 (0.324) loss_x loss_x 1.2559 (1.2987) acc_x 75.0000 (67.8125) lr 9.5289e-04 eta 0:00:16
epoch [105/200] batch [15/46] time 0.498 (0.445) data 0.367 (0.314) loss_x loss_x 1.3711 (1.2673) acc_x 71.8750 (68.1250) lr 9.5289e-04 eta 0:00:13
epoch [105/200] batch [20/46] time 0.491 (0.433) data 0.360 (0.302) loss_x loss_x 1.1094 (1.2912) acc_x 78.1250 (68.7500) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [25/46] time 0.804 (0.460) data 0.673 (0.329) loss_x loss_x 1.3760 (1.3019) acc_x 68.7500 (69.3750) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [30/46] time 0.426 (0.460) data 0.296 (0.329) loss_x loss_x 0.9141 (1.3025) acc_x 68.7500 (68.6458) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [35/46] time 0.440 (0.458) data 0.309 (0.328) loss_x loss_x 0.9458 (1.2926) acc_x 75.0000 (69.1071) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [40/46] time 0.455 (0.454) data 0.324 (0.323) loss_x loss_x 1.6123 (1.2905) acc_x 56.2500 (68.6719) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [45/46] time 0.387 (0.456) data 0.256 (0.325) loss_x loss_x 1.0850 (1.2873) acc_x 71.8750 (68.4028) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1489
confident_label rate tensor(0.4713, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1478
clean true:1475
clean false:3
clean_rate:0.9979702300405954
noisy true:172
noisy false:1486
after delete: len(clean_dataset) 1478
after delete: len(noisy_dataset) 1658
epoch [106/200] batch [5/46] time 0.615 (0.472) data 0.484 (0.341) loss_x loss_x 0.9897 (1.1321) acc_x 81.2500 (72.5000) lr 9.3721e-04 eta 0:00:19
epoch [106/200] batch [10/46] time 0.464 (0.451) data 0.333 (0.320) loss_x loss_x 1.1377 (1.2101) acc_x 65.6250 (69.6875) lr 9.3721e-04 eta 0:00:16
epoch [106/200] batch [15/46] time 0.430 (0.449) data 0.299 (0.318) loss_x loss_x 1.6074 (1.2931) acc_x 71.8750 (68.5417) lr 9.3721e-04 eta 0:00:13
epoch [106/200] batch [20/46] time 0.913 (0.508) data 0.777 (0.376) loss_x loss_x 1.0547 (1.3471) acc_x 75.0000 (67.3438) lr 9.3721e-04 eta 0:00:13
epoch [106/200] batch [25/46] time 0.467 (0.496) data 0.336 (0.364) loss_x loss_x 1.0137 (1.3422) acc_x 71.8750 (67.5000) lr 9.3721e-04 eta 0:00:10
epoch [106/200] batch [30/46] time 0.435 (0.488) data 0.306 (0.357) loss_x loss_x 1.3174 (1.3208) acc_x 68.7500 (67.7083) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [35/46] time 0.440 (0.485) data 0.310 (0.353) loss_x loss_x 0.7480 (1.3074) acc_x 81.2500 (68.2143) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [40/46] time 0.447 (0.479) data 0.316 (0.348) loss_x loss_x 1.6182 (1.3043) acc_x 65.6250 (68.2031) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [45/46] time 0.479 (0.476) data 0.348 (0.345) loss_x loss_x 1.2334 (1.2875) acc_x 65.6250 (69.0972) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1513
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1467
clean true:1465
clean false:2
clean_rate:0.9986366734832992
noisy true:158
noisy false:1511
after delete: len(clean_dataset) 1467
after delete: len(noisy_dataset) 1669
epoch [107/200] batch [5/45] time 0.415 (0.441) data 0.285 (0.310) loss_x loss_x 0.8530 (1.0883) acc_x 78.1250 (73.1250) lr 9.2154e-04 eta 0:00:17
epoch [107/200] batch [10/45] time 0.445 (0.431) data 0.314 (0.300) loss_x loss_x 1.9961 (1.1547) acc_x 56.2500 (70.9375) lr 9.2154e-04 eta 0:00:15
epoch [107/200] batch [15/45] time 0.337 (0.434) data 0.206 (0.303) loss_x loss_x 1.6025 (1.1606) acc_x 65.6250 (71.8750) lr 9.2154e-04 eta 0:00:13
epoch [107/200] batch [20/45] time 0.455 (0.439) data 0.324 (0.308) loss_x loss_x 1.0781 (1.1622) acc_x 71.8750 (72.1875) lr 9.2154e-04 eta 0:00:10
epoch [107/200] batch [25/45] time 0.483 (0.443) data 0.352 (0.312) loss_x loss_x 1.3984 (1.1788) acc_x 71.8750 (71.7500) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [30/45] time 0.475 (0.448) data 0.345 (0.316) loss_x loss_x 0.9209 (1.1597) acc_x 78.1250 (71.8750) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [35/45] time 0.405 (0.453) data 0.274 (0.322) loss_x loss_x 1.1123 (1.1549) acc_x 71.8750 (71.6964) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [40/45] time 0.467 (0.457) data 0.337 (0.326) loss_x loss_x 1.5293 (1.1587) acc_x 43.7500 (71.1719) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [45/45] time 0.398 (0.456) data 0.268 (0.325) loss_x loss_x 0.9258 (1.1676) acc_x 75.0000 (71.1111) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1506
confident_label rate tensor(0.4624, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1450
clean true:1448
clean false:2
clean_rate:0.9986206896551724
noisy true:182
noisy false:1504
after delete: len(clean_dataset) 1450
after delete: len(noisy_dataset) 1686
epoch [108/200] batch [5/45] time 0.381 (0.416) data 0.251 (0.285) loss_x loss_x 1.5244 (1.0536) acc_x 65.6250 (73.1250) lr 9.0589e-04 eta 0:00:16
epoch [108/200] batch [10/45] time 0.429 (0.417) data 0.298 (0.286) loss_x loss_x 1.4189 (1.1887) acc_x 68.7500 (71.8750) lr 9.0589e-04 eta 0:00:14
epoch [108/200] batch [15/45] time 0.569 (0.439) data 0.438 (0.308) loss_x loss_x 1.5977 (1.2780) acc_x 62.5000 (69.5833) lr 9.0589e-04 eta 0:00:13
epoch [108/200] batch [20/45] time 0.431 (0.450) data 0.301 (0.319) loss_x loss_x 0.8975 (1.2759) acc_x 81.2500 (70.1562) lr 9.0589e-04 eta 0:00:11
epoch [108/200] batch [25/45] time 0.385 (0.439) data 0.255 (0.308) loss_x loss_x 0.8867 (1.2456) acc_x 68.7500 (70.1250) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [30/45] time 0.508 (0.457) data 0.378 (0.327) loss_x loss_x 0.7632 (1.2684) acc_x 84.3750 (69.6875) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [35/45] time 0.440 (0.461) data 0.310 (0.331) loss_x loss_x 1.3145 (1.2481) acc_x 78.1250 (69.8214) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [40/45] time 0.378 (0.456) data 0.248 (0.325) loss_x loss_x 1.0303 (1.2341) acc_x 71.8750 (69.8438) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [45/45] time 0.427 (0.452) data 0.296 (0.322) loss_x loss_x 1.3965 (1.2406) acc_x 68.7500 (69.4444) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1507
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1467
clean true:1463
clean false:4
clean_rate:0.9972733469665985
noisy true:166
noisy false:1503
after delete: len(clean_dataset) 1467
after delete: len(noisy_dataset) 1669
epoch [109/200] batch [5/45] time 0.563 (0.494) data 0.433 (0.363) loss_x loss_x 1.2549 (1.0140) acc_x 56.2500 (68.7500) lr 8.9027e-04 eta 0:00:19
epoch [109/200] batch [10/45] time 0.479 (0.486) data 0.349 (0.355) loss_x loss_x 0.7061 (1.0284) acc_x 81.2500 (70.0000) lr 8.9027e-04 eta 0:00:16
epoch [109/200] batch [15/45] time 0.477 (0.483) data 0.346 (0.352) loss_x loss_x 1.4277 (1.0726) acc_x 75.0000 (72.7083) lr 8.9027e-04 eta 0:00:14
epoch [109/200] batch [20/45] time 0.516 (0.494) data 0.385 (0.363) loss_x loss_x 0.5312 (1.0410) acc_x 87.5000 (73.4375) lr 8.9027e-04 eta 0:00:12
epoch [109/200] batch [25/45] time 0.496 (0.488) data 0.365 (0.357) loss_x loss_x 1.2861 (1.0491) acc_x 68.7500 (72.8750) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [30/45] time 0.506 (0.491) data 0.374 (0.360) loss_x loss_x 1.1436 (1.0658) acc_x 75.0000 (72.1875) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [35/45] time 0.457 (0.480) data 0.326 (0.349) loss_x loss_x 1.7852 (1.0993) acc_x 56.2500 (71.7857) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [40/45] time 0.459 (0.478) data 0.329 (0.347) loss_x loss_x 1.0635 (1.1360) acc_x 75.0000 (71.1719) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [45/45] time 0.408 (0.473) data 0.277 (0.342) loss_x loss_x 1.4316 (1.1680) acc_x 68.7500 (70.1389) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1484
confident_label rate tensor(0.4748, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1489
clean true:1488
clean false:1
clean_rate:0.9993284083277367
noisy true:164
noisy false:1483
after delete: len(clean_dataset) 1489
after delete: len(noisy_dataset) 1647
epoch [110/200] batch [5/46] time 0.459 (0.391) data 0.328 (0.260) loss_x loss_x 1.0020 (1.2849) acc_x 75.0000 (68.1250) lr 8.7467e-04 eta 0:00:16
epoch [110/200] batch [10/46] time 0.446 (0.421) data 0.315 (0.290) loss_x loss_x 1.2549 (1.2436) acc_x 71.8750 (70.9375) lr 8.7467e-04 eta 0:00:15
epoch [110/200] batch [15/46] time 0.665 (0.441) data 0.534 (0.310) loss_x loss_x 0.8184 (1.2312) acc_x 84.3750 (71.6667) lr 8.7467e-04 eta 0:00:13
epoch [110/200] batch [20/46] time 0.424 (0.446) data 0.294 (0.315) loss_x loss_x 1.5498 (1.2585) acc_x 53.1250 (70.0000) lr 8.7467e-04 eta 0:00:11
epoch [110/200] batch [25/46] time 0.488 (0.440) data 0.358 (0.309) loss_x loss_x 1.3711 (1.2626) acc_x 59.3750 (69.0000) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [30/46] time 0.497 (0.450) data 0.366 (0.320) loss_x loss_x 1.2080 (1.2643) acc_x 78.1250 (68.8542) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [35/46] time 0.477 (0.464) data 0.345 (0.333) loss_x loss_x 1.2676 (1.2313) acc_x 71.8750 (69.1964) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [40/46] time 0.523 (0.464) data 0.392 (0.333) loss_x loss_x 1.1006 (1.2020) acc_x 71.8750 (69.7656) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [45/46] time 0.547 (0.464) data 0.416 (0.334) loss_x loss_x 1.3711 (1.2240) acc_x 65.6250 (69.2361) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1519
confident_label rate tensor(0.4621, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1449
clean true:1446
clean false:3
clean_rate:0.9979296066252588
noisy true:171
noisy false:1516
after delete: len(clean_dataset) 1449
after delete: len(noisy_dataset) 1687
epoch [111/200] batch [5/45] time 0.555 (0.440) data 0.425 (0.310) loss_x loss_x 1.2090 (1.1683) acc_x 75.0000 (69.3750) lr 8.5910e-04 eta 0:00:17
epoch [111/200] batch [10/45] time 0.400 (0.445) data 0.269 (0.314) loss_x loss_x 1.2334 (1.1237) acc_x 78.1250 (72.8125) lr 8.5910e-04 eta 0:00:15
epoch [111/200] batch [15/45] time 0.607 (0.477) data 0.476 (0.346) loss_x loss_x 1.8047 (1.2395) acc_x 59.3750 (69.3750) lr 8.5910e-04 eta 0:00:14
epoch [111/200] batch [20/45] time 0.479 (0.474) data 0.349 (0.344) loss_x loss_x 1.3467 (1.2349) acc_x 62.5000 (68.9062) lr 8.5910e-04 eta 0:00:11
epoch [111/200] batch [25/45] time 0.511 (0.477) data 0.380 (0.346) loss_x loss_x 1.3467 (1.2276) acc_x 71.8750 (69.8750) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [30/45] time 0.509 (0.477) data 0.378 (0.346) loss_x loss_x 1.2070 (1.2479) acc_x 65.6250 (68.7500) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [35/45] time 0.483 (0.481) data 0.353 (0.350) loss_x loss_x 1.1885 (1.2319) acc_x 68.7500 (69.1964) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [40/45] time 0.551 (0.479) data 0.421 (0.348) loss_x loss_x 1.4053 (1.2230) acc_x 65.6250 (68.9844) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [45/45] time 0.524 (0.477) data 0.393 (0.347) loss_x loss_x 1.3467 (1.2182) acc_x 75.0000 (69.4444) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4646, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1457
clean true:1455
clean false:2
clean_rate:0.9986273164035689
noisy true:169
noisy false:1510
after delete: len(clean_dataset) 1457
after delete: len(noisy_dataset) 1679
epoch [112/200] batch [5/45] time 0.420 (0.436) data 0.290 (0.306) loss_x loss_x 0.9619 (0.9987) acc_x 68.7500 (73.7500) lr 8.4357e-04 eta 0:00:17
epoch [112/200] batch [10/45] time 0.434 (0.449) data 0.303 (0.319) loss_x loss_x 1.2930 (1.0757) acc_x 68.7500 (74.3750) lr 8.4357e-04 eta 0:00:15
epoch [112/200] batch [15/45] time 0.473 (0.470) data 0.343 (0.340) loss_x loss_x 0.8975 (1.0712) acc_x 81.2500 (74.7917) lr 8.4357e-04 eta 0:00:14
epoch [112/200] batch [20/45] time 0.477 (0.468) data 0.347 (0.338) loss_x loss_x 1.2832 (1.1233) acc_x 65.6250 (72.8125) lr 8.4357e-04 eta 0:00:11
epoch [112/200] batch [25/45] time 0.431 (0.470) data 0.301 (0.340) loss_x loss_x 1.5342 (1.1350) acc_x 62.5000 (72.2500) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [30/45] time 0.554 (0.479) data 0.423 (0.349) loss_x loss_x 0.9487 (1.1727) acc_x 75.0000 (71.8750) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [35/45] time 0.475 (0.473) data 0.345 (0.343) loss_x loss_x 1.2637 (1.1908) acc_x 59.3750 (70.9821) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [40/45] time 0.449 (0.471) data 0.318 (0.341) loss_x loss_x 1.2666 (1.1858) acc_x 65.6250 (70.7031) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [45/45] time 0.393 (0.465) data 0.262 (0.334) loss_x loss_x 1.6113 (1.2122) acc_x 56.2500 (70.0000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4640, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1455
clean true:1452
clean false:3
clean_rate:0.9979381443298969
noisy true:170
noisy false:1511
after delete: len(clean_dataset) 1455
after delete: len(noisy_dataset) 1681
epoch [113/200] batch [5/45] time 0.394 (0.429) data 0.263 (0.299) loss_x loss_x 1.3965 (1.1326) acc_x 56.2500 (70.6250) lr 8.2807e-04 eta 0:00:17
epoch [113/200] batch [10/45] time 0.457 (0.426) data 0.327 (0.295) loss_x loss_x 1.1924 (1.2499) acc_x 68.7500 (68.4375) lr 8.2807e-04 eta 0:00:14
epoch [113/200] batch [15/45] time 0.610 (0.447) data 0.479 (0.317) loss_x loss_x 1.9824 (1.2782) acc_x 46.8750 (67.0833) lr 8.2807e-04 eta 0:00:13
epoch [113/200] batch [20/45] time 0.528 (0.454) data 0.398 (0.324) loss_x loss_x 1.0234 (1.1955) acc_x 71.8750 (69.3750) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [25/45] time 0.502 (0.456) data 0.372 (0.325) loss_x loss_x 0.8970 (1.1862) acc_x 75.0000 (69.0000) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [30/45] time 0.521 (0.461) data 0.391 (0.331) loss_x loss_x 1.0762 (1.2009) acc_x 62.5000 (68.5417) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [35/45] time 0.430 (0.456) data 0.300 (0.326) loss_x loss_x 1.8340 (1.2496) acc_x 65.6250 (68.3929) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [40/45] time 0.366 (0.456) data 0.235 (0.325) loss_x loss_x 1.2891 (1.2700) acc_x 71.8750 (68.1250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [45/45] time 0.467 (0.454) data 0.336 (0.324) loss_x loss_x 1.2812 (1.2663) acc_x 56.2500 (68.1250) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1491
confident_label rate tensor(0.4764, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1494
clean true:1492
clean false:2
clean_rate:0.998661311914324
noisy true:153
noisy false:1489
after delete: len(clean_dataset) 1494
after delete: len(noisy_dataset) 1642
epoch [114/200] batch [5/46] time 0.628 (0.513) data 0.498 (0.383) loss_x loss_x 1.2646 (1.1705) acc_x 68.7500 (70.0000) lr 8.1262e-04 eta 0:00:21
epoch [114/200] batch [10/46] time 0.411 (0.474) data 0.281 (0.344) loss_x loss_x 1.0479 (1.1840) acc_x 65.6250 (69.6875) lr 8.1262e-04 eta 0:00:17
epoch [114/200] batch [15/46] time 0.418 (0.460) data 0.287 (0.330) loss_x loss_x 1.5176 (1.2329) acc_x 65.6250 (68.7500) lr 8.1262e-04 eta 0:00:14
epoch [114/200] batch [20/46] time 0.533 (0.462) data 0.403 (0.331) loss_x loss_x 1.1592 (1.2371) acc_x 62.5000 (68.7500) lr 8.1262e-04 eta 0:00:12
epoch [114/200] batch [25/46] time 0.651 (0.473) data 0.521 (0.342) loss_x loss_x 1.3721 (1.2493) acc_x 71.8750 (68.3750) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [30/46] time 0.451 (0.466) data 0.320 (0.336) loss_x loss_x 1.0645 (1.2411) acc_x 71.8750 (68.5417) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [35/46] time 0.394 (0.465) data 0.263 (0.334) loss_x loss_x 1.5127 (1.2827) acc_x 59.3750 (68.0357) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [40/46] time 0.537 (0.464) data 0.407 (0.334) loss_x loss_x 1.5898 (1.2807) acc_x 62.5000 (67.8125) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [45/46] time 0.414 (0.464) data 0.284 (0.333) loss_x loss_x 1.3340 (1.2719) acc_x 59.3750 (67.9167) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1480
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1500
clean true:1498
clean false:2
clean_rate:0.9986666666666667
noisy true:158
noisy false:1478
after delete: len(clean_dataset) 1500
after delete: len(noisy_dataset) 1636
epoch [115/200] batch [5/46] time 0.439 (0.430) data 0.308 (0.299) loss_x loss_x 1.3877 (1.0825) acc_x 56.2500 (65.0000) lr 7.9721e-04 eta 0:00:17
epoch [115/200] batch [10/46] time 0.408 (0.435) data 0.277 (0.304) loss_x loss_x 1.3115 (1.0838) acc_x 62.5000 (67.1875) lr 7.9721e-04 eta 0:00:15
epoch [115/200] batch [15/46] time 0.515 (0.436) data 0.384 (0.305) loss_x loss_x 1.2803 (1.1313) acc_x 68.7500 (68.1250) lr 7.9721e-04 eta 0:00:13
epoch [115/200] batch [20/46] time 0.563 (0.454) data 0.432 (0.323) loss_x loss_x 1.1338 (1.1438) acc_x 71.8750 (68.2812) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [25/46] time 0.539 (0.450) data 0.408 (0.319) loss_x loss_x 0.9551 (1.1767) acc_x 75.0000 (67.6250) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [30/46] time 0.461 (0.453) data 0.330 (0.323) loss_x loss_x 1.2129 (1.1823) acc_x 78.1250 (68.3333) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [35/46] time 0.466 (0.460) data 0.336 (0.329) loss_x loss_x 1.4873 (1.2177) acc_x 65.6250 (68.1250) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [40/46] time 0.584 (0.461) data 0.453 (0.331) loss_x loss_x 1.0615 (1.2057) acc_x 62.5000 (68.5938) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [45/46] time 0.396 (0.460) data 0.265 (0.329) loss_x loss_x 0.9448 (1.2058) acc_x 78.1250 (68.5417) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4751, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1490
clean true:1489
clean false:1
clean_rate:0.9993288590604027
noisy true:174
noisy false:1472
after delete: len(clean_dataset) 1490
after delete: len(noisy_dataset) 1646
epoch [116/200] batch [5/46] time 0.493 (0.473) data 0.363 (0.342) loss_x loss_x 1.5625 (1.3447) acc_x 59.3750 (69.3750) lr 7.8186e-04 eta 0:00:19
epoch [116/200] batch [10/46] time 0.456 (0.492) data 0.325 (0.361) loss_x loss_x 1.3730 (1.2731) acc_x 62.5000 (71.2500) lr 7.8186e-04 eta 0:00:17
epoch [116/200] batch [15/46] time 0.366 (0.470) data 0.236 (0.340) loss_x loss_x 1.2041 (1.2662) acc_x 68.7500 (70.6250) lr 7.8186e-04 eta 0:00:14
epoch [116/200] batch [20/46] time 0.424 (0.462) data 0.294 (0.331) loss_x loss_x 1.8027 (1.2902) acc_x 53.1250 (70.1562) lr 7.8186e-04 eta 0:00:12
epoch [116/200] batch [25/46] time 0.446 (0.476) data 0.316 (0.346) loss_x loss_x 0.9800 (1.2479) acc_x 81.2500 (70.6250) lr 7.8186e-04 eta 0:00:10
epoch [116/200] batch [30/46] time 0.475 (0.484) data 0.345 (0.354) loss_x loss_x 0.8345 (1.2519) acc_x 78.1250 (70.7292) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [35/46] time 0.542 (0.482) data 0.412 (0.352) loss_x loss_x 1.5664 (1.2352) acc_x 59.3750 (70.8036) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [40/46] time 0.587 (0.479) data 0.457 (0.349) loss_x loss_x 1.1787 (1.2411) acc_x 65.6250 (70.4688) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [45/46] time 0.587 (0.479) data 0.457 (0.349) loss_x loss_x 1.5498 (1.2523) acc_x 62.5000 (70.4861) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1448
confident_label rate tensor(0.4857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1523
clean true:1521
clean false:2
clean_rate:0.9986868023637557
noisy true:167
noisy false:1446
after delete: len(clean_dataset) 1523
after delete: len(noisy_dataset) 1613
epoch [117/200] batch [5/47] time 0.408 (0.461) data 0.278 (0.330) loss_x loss_x 1.4150 (1.3545) acc_x 65.6250 (65.0000) lr 7.6655e-04 eta 0:00:19
epoch [117/200] batch [10/47] time 0.392 (0.449) data 0.261 (0.318) loss_x loss_x 1.4600 (1.3336) acc_x 62.5000 (67.5000) lr 7.6655e-04 eta 0:00:16
epoch [117/200] batch [15/47] time 0.431 (0.452) data 0.301 (0.321) loss_x loss_x 1.5059 (1.3306) acc_x 65.6250 (67.0833) lr 7.6655e-04 eta 0:00:14
epoch [117/200] batch [20/47] time 0.498 (0.450) data 0.367 (0.320) loss_x loss_x 1.5996 (1.3365) acc_x 53.1250 (66.7188) lr 7.6655e-04 eta 0:00:12
epoch [117/200] batch [25/47] time 0.393 (0.449) data 0.263 (0.318) loss_x loss_x 1.2412 (1.3489) acc_x 65.6250 (66.1250) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [30/47] time 0.377 (0.448) data 0.246 (0.318) loss_x loss_x 1.6055 (1.3540) acc_x 62.5000 (65.8333) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [35/47] time 0.462 (0.445) data 0.331 (0.314) loss_x loss_x 1.4473 (1.3502) acc_x 62.5000 (66.1607) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [40/47] time 0.426 (0.442) data 0.296 (0.311) loss_x loss_x 1.0303 (1.3269) acc_x 75.0000 (66.2500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [45/47] time 0.467 (0.448) data 0.337 (0.318) loss_x loss_x 1.0166 (1.3000) acc_x 68.7500 (66.6667) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1503
confident_label rate tensor(0.4684, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1469
clean true:1469
clean false:0
clean_rate:1.0
noisy true:164
noisy false:1503
after delete: len(clean_dataset) 1469
after delete: len(noisy_dataset) 1667
epoch [118/200] batch [5/45] time 0.423 (0.518) data 0.293 (0.387) loss_x loss_x 1.6113 (1.2313) acc_x 56.2500 (66.8750) lr 7.5131e-04 eta 0:00:20
epoch [118/200] batch [10/45] time 0.481 (0.498) data 0.350 (0.368) loss_x loss_x 1.5840 (1.2300) acc_x 68.7500 (68.1250) lr 7.5131e-04 eta 0:00:17
epoch [118/200] batch [15/45] time 0.457 (0.477) data 0.327 (0.347) loss_x loss_x 1.1777 (1.2354) acc_x 65.6250 (68.1250) lr 7.5131e-04 eta 0:00:14
epoch [118/200] batch [20/45] time 0.382 (0.475) data 0.251 (0.344) loss_x loss_x 1.4375 (1.2189) acc_x 62.5000 (68.1250) lr 7.5131e-04 eta 0:00:11
epoch [118/200] batch [25/45] time 0.442 (0.469) data 0.312 (0.338) loss_x loss_x 1.1074 (1.1842) acc_x 81.2500 (69.5000) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [30/45] time 0.450 (0.468) data 0.320 (0.337) loss_x loss_x 1.0303 (1.2081) acc_x 75.0000 (69.0625) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [35/45] time 0.456 (0.472) data 0.325 (0.341) loss_x loss_x 1.8242 (1.2322) acc_x 40.6250 (68.2143) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [40/45] time 0.512 (0.473) data 0.381 (0.342) loss_x loss_x 0.6616 (1.2131) acc_x 87.5000 (68.9062) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [45/45] time 0.412 (0.466) data 0.281 (0.335) loss_x loss_x 0.5684 (1.2081) acc_x 90.6250 (68.9583) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1470
confident_label rate tensor(0.4799, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1505
clean true:1501
clean false:4
clean_rate:0.9973421926910299
noisy true:165
noisy false:1466
after delete: len(clean_dataset) 1505
after delete: len(noisy_dataset) 1631
epoch [119/200] batch [5/47] time 0.582 (0.483) data 0.451 (0.352) loss_x loss_x 1.2412 (1.2050) acc_x 65.6250 (70.6250) lr 7.3613e-04 eta 0:00:20
epoch [119/200] batch [10/47] time 0.464 (0.495) data 0.334 (0.363) loss_x loss_x 1.1680 (1.1703) acc_x 68.7500 (70.9375) lr 7.3613e-04 eta 0:00:18
epoch [119/200] batch [15/47] time 0.405 (0.478) data 0.274 (0.347) loss_x loss_x 1.1309 (1.1394) acc_x 81.2500 (72.5000) lr 7.3613e-04 eta 0:00:15
epoch [119/200] batch [20/47] time 0.340 (0.471) data 0.209 (0.340) loss_x loss_x 1.0879 (1.1332) acc_x 75.0000 (72.5000) lr 7.3613e-04 eta 0:00:12
epoch [119/200] batch [25/47] time 0.422 (0.467) data 0.291 (0.336) loss_x loss_x 1.3525 (1.1406) acc_x 62.5000 (72.1250) lr 7.3613e-04 eta 0:00:10
epoch [119/200] batch [30/47] time 0.474 (0.466) data 0.343 (0.335) loss_x loss_x 1.4336 (1.1961) acc_x 68.7500 (70.7292) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [35/47] time 0.467 (0.459) data 0.336 (0.328) loss_x loss_x 1.3535 (1.2199) acc_x 65.6250 (70.7143) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [40/47] time 0.396 (0.462) data 0.266 (0.331) loss_x loss_x 1.4893 (1.2276) acc_x 68.7500 (70.6250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [45/47] time 0.476 (0.471) data 0.346 (0.340) loss_x loss_x 1.1182 (1.2134) acc_x 59.3750 (70.8333) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1470
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1493
clean true:1490
clean false:3
clean_rate:0.9979906229068989
noisy true:176
noisy false:1467
after delete: len(clean_dataset) 1493
after delete: len(noisy_dataset) 1643
epoch [120/200] batch [5/46] time 0.674 (0.551) data 0.543 (0.419) loss_x loss_x 0.8062 (1.1788) acc_x 81.2500 (67.5000) lr 7.2101e-04 eta 0:00:22
epoch [120/200] batch [10/46] time 0.424 (0.501) data 0.293 (0.369) loss_x loss_x 1.0674 (1.2218) acc_x 68.7500 (66.2500) lr 7.2101e-04 eta 0:00:18
epoch [120/200] batch [15/46] time 0.420 (0.482) data 0.289 (0.350) loss_x loss_x 1.2227 (1.2793) acc_x 59.3750 (66.0417) lr 7.2101e-04 eta 0:00:14
epoch [120/200] batch [20/46] time 0.474 (0.485) data 0.342 (0.354) loss_x loss_x 0.7075 (1.2941) acc_x 75.0000 (65.7812) lr 7.2101e-04 eta 0:00:12
epoch [120/200] batch [25/46] time 0.523 (0.477) data 0.392 (0.346) loss_x loss_x 1.0664 (1.3075) acc_x 78.1250 (65.2500) lr 7.2101e-04 eta 0:00:10
epoch [120/200] batch [30/46] time 0.386 (0.468) data 0.254 (0.336) loss_x loss_x 1.3838 (1.2953) acc_x 65.6250 (65.9375) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [35/46] time 0.396 (0.460) data 0.264 (0.328) loss_x loss_x 1.1455 (1.2725) acc_x 71.8750 (66.9643) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [40/46] time 0.444 (0.452) data 0.312 (0.321) loss_x loss_x 1.2627 (1.2984) acc_x 65.6250 (66.3281) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [45/46] time 0.370 (0.450) data 0.240 (0.318) loss_x loss_x 1.5674 (1.2903) acc_x 65.6250 (66.5972) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1464
confident_label rate tensor(0.4828, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1514
clean true:1511
clean false:3
clean_rate:0.9980184940554822
noisy true:161
noisy false:1461
after delete: len(clean_dataset) 1514
after delete: len(noisy_dataset) 1622
epoch [121/200] batch [5/47] time 0.480 (0.445) data 0.350 (0.314) loss_x loss_x 1.3975 (1.0548) acc_x 71.8750 (75.6250) lr 7.0596e-04 eta 0:00:18
epoch [121/200] batch [10/47] time 0.465 (0.434) data 0.335 (0.303) loss_x loss_x 1.3154 (1.1569) acc_x 65.6250 (72.5000) lr 7.0596e-04 eta 0:00:16
epoch [121/200] batch [15/47] time 0.423 (0.448) data 0.292 (0.318) loss_x loss_x 1.3242 (1.1377) acc_x 56.2500 (71.0417) lr 7.0596e-04 eta 0:00:14
epoch [121/200] batch [20/47] time 0.570 (0.465) data 0.439 (0.334) loss_x loss_x 1.3789 (1.1896) acc_x 75.0000 (69.8438) lr 7.0596e-04 eta 0:00:12
epoch [121/200] batch [25/47] time 0.535 (0.464) data 0.403 (0.334) loss_x loss_x 0.9741 (1.1730) acc_x 65.6250 (70.3750) lr 7.0596e-04 eta 0:00:10
epoch [121/200] batch [30/47] time 0.399 (0.460) data 0.269 (0.329) loss_x loss_x 1.6934 (1.1950) acc_x 65.6250 (69.7917) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [35/47] time 0.507 (0.461) data 0.376 (0.330) loss_x loss_x 0.9883 (1.1884) acc_x 59.3750 (69.8214) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [40/47] time 0.369 (0.454) data 0.238 (0.323) loss_x loss_x 1.1660 (1.1927) acc_x 59.3750 (69.6094) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [45/47] time 0.507 (0.457) data 0.376 (0.326) loss_x loss_x 1.4336 (1.1861) acc_x 65.6250 (70.0000) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1442
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1531
clean true:1530
clean false:1
clean_rate:0.999346832135859
noisy true:164
noisy false:1441
after delete: len(clean_dataset) 1531
after delete: len(noisy_dataset) 1605
epoch [122/200] batch [5/47] time 0.457 (0.474) data 0.326 (0.343) loss_x loss_x 1.2402 (0.9397) acc_x 68.7500 (75.6250) lr 6.9098e-04 eta 0:00:19
epoch [122/200] batch [10/47] time 0.519 (0.465) data 0.388 (0.334) loss_x loss_x 1.3057 (1.0333) acc_x 71.8750 (73.7500) lr 6.9098e-04 eta 0:00:17
epoch [122/200] batch [15/47] time 0.482 (0.465) data 0.351 (0.334) loss_x loss_x 1.3916 (1.0820) acc_x 59.3750 (71.6667) lr 6.9098e-04 eta 0:00:14
epoch [122/200] batch [20/47] time 0.358 (0.461) data 0.227 (0.330) loss_x loss_x 1.2891 (1.1407) acc_x 65.6250 (69.5312) lr 6.9098e-04 eta 0:00:12
epoch [122/200] batch [25/47] time 0.402 (0.456) data 0.272 (0.325) loss_x loss_x 0.9966 (1.1461) acc_x 68.7500 (69.7500) lr 6.9098e-04 eta 0:00:10
epoch [122/200] batch [30/47] time 0.384 (0.452) data 0.254 (0.321) loss_x loss_x 1.4453 (1.1577) acc_x 62.5000 (69.7917) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [35/47] time 0.427 (0.451) data 0.296 (0.320) loss_x loss_x 0.8496 (1.1544) acc_x 68.7500 (70.0893) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [40/47] time 0.427 (0.452) data 0.297 (0.321) loss_x loss_x 1.5459 (1.1542) acc_x 65.6250 (70.5469) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [45/47] time 0.483 (0.452) data 0.352 (0.321) loss_x loss_x 1.1250 (1.1493) acc_x 68.7500 (70.6250) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4636, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1454
clean true:1453
clean false:1
clean_rate:0.9993122420907841
noisy true:169
noisy false:1513
after delete: len(clean_dataset) 1454
after delete: len(noisy_dataset) 1682
epoch [123/200] batch [5/45] time 0.421 (0.437) data 0.287 (0.305) loss_x loss_x 1.2510 (1.1855) acc_x 59.3750 (68.1250) lr 6.7608e-04 eta 0:00:17
epoch [123/200] batch [10/45] time 0.397 (0.450) data 0.266 (0.318) loss_x loss_x 1.5518 (1.2118) acc_x 62.5000 (68.7500) lr 6.7608e-04 eta 0:00:15
epoch [123/200] batch [15/45] time 0.530 (0.463) data 0.399 (0.331) loss_x loss_x 1.0459 (1.1943) acc_x 68.7500 (70.0000) lr 6.7608e-04 eta 0:00:13
epoch [123/200] batch [20/45] time 0.503 (0.461) data 0.373 (0.329) loss_x loss_x 0.6284 (1.1429) acc_x 87.5000 (71.5625) lr 6.7608e-04 eta 0:00:11
epoch [123/200] batch [25/45] time 0.370 (0.459) data 0.239 (0.327) loss_x loss_x 0.8257 (1.1533) acc_x 75.0000 (72.1250) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [30/45] time 0.461 (0.462) data 0.330 (0.331) loss_x loss_x 1.3672 (1.1566) acc_x 71.8750 (71.5625) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [35/45] time 0.414 (0.461) data 0.284 (0.330) loss_x loss_x 0.7461 (1.1443) acc_x 81.2500 (71.9643) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [40/45] time 0.444 (0.459) data 0.313 (0.328) loss_x loss_x 0.9277 (1.1458) acc_x 71.8750 (71.6406) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [45/45] time 0.527 (0.456) data 0.396 (0.325) loss_x loss_x 1.0459 (1.1572) acc_x 68.7500 (71.5278) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1459
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1500
clean true:1499
clean false:1
clean_rate:0.9993333333333333
noisy true:178
noisy false:1458
after delete: len(clean_dataset) 1500
after delete: len(noisy_dataset) 1636
epoch [124/200] batch [5/46] time 0.461 (0.447) data 0.331 (0.317) loss_x loss_x 1.1631 (1.2159) acc_x 65.6250 (71.8750) lr 6.6126e-04 eta 0:00:18
epoch [124/200] batch [10/46] time 0.468 (0.434) data 0.337 (0.304) loss_x loss_x 0.9536 (1.1300) acc_x 81.2500 (71.8750) lr 6.6126e-04 eta 0:00:15
epoch [124/200] batch [15/46] time 0.404 (0.443) data 0.273 (0.312) loss_x loss_x 1.3008 (1.1383) acc_x 75.0000 (71.8750) lr 6.6126e-04 eta 0:00:13
epoch [124/200] batch [20/46] time 0.643 (0.455) data 0.512 (0.324) loss_x loss_x 1.2959 (1.1809) acc_x 68.7500 (70.7812) lr 6.6126e-04 eta 0:00:11
epoch [124/200] batch [25/46] time 0.635 (0.458) data 0.504 (0.327) loss_x loss_x 1.4785 (1.1894) acc_x 62.5000 (70.3750) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [30/46] time 0.419 (0.467) data 0.288 (0.335) loss_x loss_x 1.2178 (1.1812) acc_x 68.7500 (70.6250) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [35/46] time 0.437 (0.466) data 0.306 (0.335) loss_x loss_x 1.1846 (1.1888) acc_x 65.6250 (69.5536) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [40/46] time 0.478 (0.468) data 0.347 (0.336) loss_x loss_x 1.2949 (1.1824) acc_x 71.8750 (69.9219) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [45/46] time 0.516 (0.467) data 0.385 (0.336) loss_x loss_x 1.2129 (1.1833) acc_x 78.1250 (69.9306) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1465
confident_label rate tensor(0.4809, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1508
clean true:1506
clean false:2
clean_rate:0.9986737400530504
noisy true:165
noisy false:1463
after delete: len(clean_dataset) 1508
after delete: len(noisy_dataset) 1628
epoch [125/200] batch [5/47] time 0.487 (0.449) data 0.356 (0.318) loss_x loss_x 1.3750 (1.2537) acc_x 68.7500 (72.5000) lr 6.4653e-04 eta 0:00:18
epoch [125/200] batch [10/47] time 0.498 (0.463) data 0.367 (0.332) loss_x loss_x 1.0898 (1.2285) acc_x 65.6250 (70.9375) lr 6.4653e-04 eta 0:00:17
epoch [125/200] batch [15/47] time 0.541 (0.477) data 0.409 (0.346) loss_x loss_x 0.7080 (1.2389) acc_x 81.2500 (70.2083) lr 6.4653e-04 eta 0:00:15
epoch [125/200] batch [20/47] time 0.408 (0.465) data 0.278 (0.334) loss_x loss_x 1.3379 (1.2108) acc_x 71.8750 (70.7812) lr 6.4653e-04 eta 0:00:12
epoch [125/200] batch [25/47] time 0.466 (0.460) data 0.337 (0.329) loss_x loss_x 1.3213 (1.2422) acc_x 71.8750 (70.0000) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [30/47] time 0.383 (0.457) data 0.252 (0.327) loss_x loss_x 1.2314 (1.2088) acc_x 75.0000 (70.8333) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [35/47] time 0.598 (0.457) data 0.467 (0.326) loss_x loss_x 1.3877 (1.2523) acc_x 71.8750 (70.2679) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [40/47] time 0.450 (0.460) data 0.321 (0.329) loss_x loss_x 1.2148 (1.2461) acc_x 71.8750 (70.3125) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [45/47] time 0.439 (0.457) data 0.309 (0.326) loss_x loss_x 0.9956 (1.2243) acc_x 71.8750 (70.6944) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1480
confident_label rate tensor(0.4732, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1484
clean true:1480
clean false:4
clean_rate:0.9973045822102425
noisy true:176
noisy false:1476
after delete: len(clean_dataset) 1484
after delete: len(noisy_dataset) 1652
epoch [126/200] batch [5/46] time 0.418 (0.419) data 0.289 (0.289) loss_x loss_x 1.0918 (1.1119) acc_x 71.8750 (71.8750) lr 6.3188e-04 eta 0:00:17
epoch [126/200] batch [10/46] time 0.491 (0.452) data 0.361 (0.322) loss_x loss_x 0.9722 (1.1568) acc_x 75.0000 (71.2500) lr 6.3188e-04 eta 0:00:16
epoch [126/200] batch [15/46] time 0.450 (0.451) data 0.320 (0.321) loss_x loss_x 0.9624 (1.1508) acc_x 75.0000 (70.8333) lr 6.3188e-04 eta 0:00:13
epoch [126/200] batch [20/46] time 0.441 (0.445) data 0.309 (0.315) loss_x loss_x 1.4668 (1.1497) acc_x 68.7500 (71.2500) lr 6.3188e-04 eta 0:00:11
epoch [126/200] batch [25/46] time 0.424 (0.452) data 0.293 (0.321) loss_x loss_x 0.8101 (1.1417) acc_x 78.1250 (70.7500) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [30/46] time 0.665 (0.456) data 0.534 (0.326) loss_x loss_x 0.8760 (1.1745) acc_x 75.0000 (70.3125) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [35/46] time 0.579 (0.459) data 0.449 (0.328) loss_x loss_x 0.9336 (1.1949) acc_x 81.2500 (70.1786) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [40/46] time 0.553 (0.458) data 0.422 (0.328) loss_x loss_x 1.4404 (1.1931) acc_x 65.6250 (70.1562) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [45/46] time 0.389 (0.452) data 0.258 (0.322) loss_x loss_x 1.2451 (1.1959) acc_x 68.7500 (69.7917) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1490
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1471
clean true:1470
clean false:1
clean_rate:0.9993201903467029
noisy true:176
noisy false:1489
after delete: len(clean_dataset) 1471
after delete: len(noisy_dataset) 1665
epoch [127/200] batch [5/45] time 0.426 (0.465) data 0.295 (0.334) loss_x loss_x 0.7939 (0.8164) acc_x 78.1250 (76.8750) lr 6.1732e-04 eta 0:00:18
epoch [127/200] batch [10/45] time 0.449 (0.457) data 0.319 (0.327) loss_x loss_x 1.0879 (1.0564) acc_x 68.7500 (70.0000) lr 6.1732e-04 eta 0:00:15
epoch [127/200] batch [15/45] time 0.391 (0.445) data 0.260 (0.314) loss_x loss_x 1.8682 (1.1240) acc_x 50.0000 (69.7917) lr 6.1732e-04 eta 0:00:13
epoch [127/200] batch [20/45] time 0.420 (0.450) data 0.290 (0.319) loss_x loss_x 1.2383 (1.1108) acc_x 87.5000 (71.4062) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [25/45] time 0.332 (0.444) data 0.201 (0.313) loss_x loss_x 1.5068 (1.1812) acc_x 59.3750 (69.7500) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [30/45] time 0.403 (0.445) data 0.273 (0.314) loss_x loss_x 0.9707 (1.1901) acc_x 75.0000 (69.2708) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [35/45] time 0.569 (0.449) data 0.438 (0.318) loss_x loss_x 1.3760 (1.2047) acc_x 62.5000 (69.2857) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [40/45] time 0.642 (0.449) data 0.511 (0.318) loss_x loss_x 0.9131 (1.2062) acc_x 78.1250 (69.4531) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [45/45] time 0.405 (0.448) data 0.274 (0.317) loss_x loss_x 1.0664 (1.2024) acc_x 78.1250 (69.3056) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1483
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1471
clean true:1470
clean false:1
clean_rate:0.9993201903467029
noisy true:183
noisy false:1482
after delete: len(clean_dataset) 1471
after delete: len(noisy_dataset) 1665
epoch [128/200] batch [5/45] time 0.429 (0.452) data 0.298 (0.321) loss_x loss_x 1.2305 (1.1418) acc_x 68.7500 (72.5000) lr 6.0285e-04 eta 0:00:18
epoch [128/200] batch [10/45] time 0.430 (0.463) data 0.299 (0.332) loss_x loss_x 0.9214 (1.1396) acc_x 75.0000 (71.2500) lr 6.0285e-04 eta 0:00:16
epoch [128/200] batch [15/45] time 0.456 (0.466) data 0.325 (0.335) loss_x loss_x 1.2100 (1.1695) acc_x 75.0000 (72.5000) lr 6.0285e-04 eta 0:00:13
epoch [128/200] batch [20/45] time 0.433 (0.456) data 0.302 (0.325) loss_x loss_x 0.5947 (1.1749) acc_x 87.5000 (72.6562) lr 6.0285e-04 eta 0:00:11
epoch [128/200] batch [25/45] time 0.456 (0.455) data 0.325 (0.324) loss_x loss_x 1.1240 (1.1339) acc_x 71.8750 (72.3750) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [30/45] time 0.455 (0.454) data 0.325 (0.323) loss_x loss_x 1.1328 (1.1437) acc_x 78.1250 (72.5000) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [35/45] time 0.508 (0.454) data 0.377 (0.323) loss_x loss_x 1.3174 (1.1665) acc_x 65.6250 (71.9643) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [40/45] time 0.488 (0.453) data 0.358 (0.323) loss_x loss_x 1.0303 (1.1542) acc_x 75.0000 (72.0312) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [45/45] time 0.436 (0.460) data 0.305 (0.329) loss_x loss_x 1.2578 (1.1526) acc_x 78.1250 (72.1528) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1453
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1512
clean true:1511
clean false:1
clean_rate:0.9993386243386243
noisy true:172
noisy false:1452
after delete: len(clean_dataset) 1512
after delete: len(noisy_dataset) 1624
epoch [129/200] batch [5/47] time 0.466 (0.507) data 0.335 (0.375) loss_x loss_x 1.2363 (1.3627) acc_x 65.6250 (68.7500) lr 5.8849e-04 eta 0:00:21
epoch [129/200] batch [10/47] time 0.429 (0.491) data 0.296 (0.359) loss_x loss_x 1.4072 (1.3373) acc_x 62.5000 (68.1250) lr 5.8849e-04 eta 0:00:18
epoch [129/200] batch [15/47] time 0.649 (0.481) data 0.519 (0.350) loss_x loss_x 0.8628 (1.3117) acc_x 78.1250 (68.5417) lr 5.8849e-04 eta 0:00:15
epoch [129/200] batch [20/47] time 0.403 (0.476) data 0.272 (0.345) loss_x loss_x 0.8926 (1.2589) acc_x 75.0000 (69.5312) lr 5.8849e-04 eta 0:00:12
epoch [129/200] batch [25/47] time 0.557 (0.475) data 0.427 (0.344) loss_x loss_x 1.4473 (1.2833) acc_x 62.5000 (68.3750) lr 5.8849e-04 eta 0:00:10
epoch [129/200] batch [30/47] time 0.422 (0.478) data 0.291 (0.347) loss_x loss_x 0.9858 (1.2624) acc_x 75.0000 (68.0208) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [35/47] time 0.530 (0.478) data 0.399 (0.347) loss_x loss_x 0.9546 (1.2453) acc_x 68.7500 (68.7500) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [40/47] time 0.603 (0.479) data 0.472 (0.348) loss_x loss_x 1.0762 (1.2447) acc_x 75.0000 (68.7500) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [45/47] time 0.320 (0.469) data 0.190 (0.338) loss_x loss_x 0.7520 (1.2329) acc_x 81.2500 (69.4444) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4758, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1492
clean true:1490
clean false:2
clean_rate:0.9986595174262735
noisy true:173
noisy false:1471
after delete: len(clean_dataset) 1492
after delete: len(noisy_dataset) 1644
epoch [130/200] batch [5/46] time 0.449 (0.483) data 0.318 (0.352) loss_x loss_x 1.2285 (1.3314) acc_x 65.6250 (59.3750) lr 5.7422e-04 eta 0:00:19
epoch [130/200] batch [10/46] time 0.368 (0.457) data 0.238 (0.326) loss_x loss_x 1.2031 (1.2440) acc_x 78.1250 (67.8125) lr 5.7422e-04 eta 0:00:16
epoch [130/200] batch [15/46] time 0.444 (0.453) data 0.313 (0.322) loss_x loss_x 1.6729 (1.2666) acc_x 56.2500 (67.5000) lr 5.7422e-04 eta 0:00:14
epoch [130/200] batch [20/46] time 0.441 (0.457) data 0.310 (0.326) loss_x loss_x 1.2559 (1.2117) acc_x 65.6250 (69.3750) lr 5.7422e-04 eta 0:00:11
epoch [130/200] batch [25/46] time 0.433 (0.451) data 0.302 (0.321) loss_x loss_x 1.2803 (1.2429) acc_x 71.8750 (68.8750) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [30/46] time 0.576 (0.471) data 0.446 (0.340) loss_x loss_x 1.0117 (1.2156) acc_x 71.8750 (69.4792) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [35/46] time 0.547 (0.476) data 0.417 (0.345) loss_x loss_x 0.7539 (1.1927) acc_x 71.8750 (69.1071) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [40/46] time 0.422 (0.465) data 0.290 (0.334) loss_x loss_x 1.1143 (1.1760) acc_x 75.0000 (69.5312) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [45/46] time 0.433 (0.462) data 0.303 (0.331) loss_x loss_x 1.5039 (1.1841) acc_x 65.6250 (69.0278) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1438
confident_label rate tensor(0.4892, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1534
clean true:1530
clean false:4
clean_rate:0.9973924380704041
noisy true:168
noisy false:1434
after delete: len(clean_dataset) 1534
after delete: len(noisy_dataset) 1602
epoch [131/200] batch [5/47] time 0.407 (0.418) data 0.276 (0.287) loss_x loss_x 1.8066 (1.4343) acc_x 53.1250 (63.7500) lr 5.6006e-04 eta 0:00:17
epoch [131/200] batch [10/47] time 0.423 (0.451) data 0.292 (0.320) loss_x loss_x 1.0547 (1.4383) acc_x 75.0000 (64.3750) lr 5.6006e-04 eta 0:00:16
epoch [131/200] batch [15/47] time 0.382 (0.460) data 0.251 (0.329) loss_x loss_x 1.1992 (1.4370) acc_x 65.6250 (64.5833) lr 5.6006e-04 eta 0:00:14
epoch [131/200] batch [20/47] time 0.498 (0.462) data 0.366 (0.331) loss_x loss_x 0.8755 (1.3621) acc_x 71.8750 (66.5625) lr 5.6006e-04 eta 0:00:12
epoch [131/200] batch [25/47] time 0.475 (0.460) data 0.343 (0.328) loss_x loss_x 1.3193 (1.3270) acc_x 68.7500 (67.1250) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [30/47] time 0.376 (0.455) data 0.245 (0.324) loss_x loss_x 1.0283 (1.2539) acc_x 71.8750 (68.3333) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [35/47] time 0.445 (0.454) data 0.314 (0.322) loss_x loss_x 1.2432 (1.2218) acc_x 75.0000 (69.0179) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [40/47] time 0.364 (0.452) data 0.233 (0.321) loss_x loss_x 0.8408 (1.2286) acc_x 78.1250 (68.9062) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [45/47] time 0.633 (0.458) data 0.503 (0.327) loss_x loss_x 1.2080 (1.2351) acc_x 71.8750 (68.5417) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1453
confident_label rate tensor(0.4850, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1521
clean true:1518
clean false:3
clean_rate:0.9980276134122288
noisy true:165
noisy false:1450
after delete: len(clean_dataset) 1521
after delete: len(noisy_dataset) 1615
epoch [132/200] batch [5/47] time 0.451 (0.452) data 0.320 (0.321) loss_x loss_x 0.7744 (1.1434) acc_x 71.8750 (69.3750) lr 5.4601e-04 eta 0:00:18
epoch [132/200] batch [10/47] time 0.451 (0.466) data 0.320 (0.335) loss_x loss_x 1.1572 (1.0806) acc_x 62.5000 (70.9375) lr 5.4601e-04 eta 0:00:17
epoch [132/200] batch [15/47] time 0.368 (0.452) data 0.238 (0.322) loss_x loss_x 1.1055 (1.0782) acc_x 71.8750 (72.5000) lr 5.4601e-04 eta 0:00:14
epoch [132/200] batch [20/47] time 0.567 (0.457) data 0.436 (0.326) loss_x loss_x 1.1191 (1.0875) acc_x 68.7500 (71.4062) lr 5.4601e-04 eta 0:00:12
epoch [132/200] batch [25/47] time 0.472 (0.463) data 0.341 (0.332) loss_x loss_x 1.0508 (1.0917) acc_x 65.6250 (71.7500) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [30/47] time 0.602 (0.460) data 0.471 (0.329) loss_x loss_x 1.2588 (1.0985) acc_x 65.6250 (71.2500) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [35/47] time 0.576 (0.474) data 0.445 (0.343) loss_x loss_x 1.0684 (1.1099) acc_x 75.0000 (70.8036) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [40/47] time 0.513 (0.473) data 0.382 (0.342) loss_x loss_x 1.8115 (1.1444) acc_x 59.3750 (69.7656) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [45/47] time 0.501 (0.469) data 0.370 (0.338) loss_x loss_x 1.4199 (1.1534) acc_x 59.3750 (69.7222) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1483
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1475
clean true:1474
clean false:1
clean_rate:0.9993220338983051
noisy true:179
noisy false:1482
after delete: len(clean_dataset) 1475
after delete: len(noisy_dataset) 1661
epoch [133/200] batch [5/46] time 0.464 (0.441) data 0.333 (0.310) loss_x loss_x 0.9741 (1.1460) acc_x 71.8750 (68.1250) lr 5.3207e-04 eta 0:00:18
epoch [133/200] batch [10/46] time 0.343 (0.451) data 0.213 (0.320) loss_x loss_x 1.3838 (1.1463) acc_x 65.6250 (68.7500) lr 5.3207e-04 eta 0:00:16
epoch [133/200] batch [15/46] time 0.411 (0.460) data 0.280 (0.329) loss_x loss_x 1.2324 (1.1351) acc_x 62.5000 (68.7500) lr 5.3207e-04 eta 0:00:14
epoch [133/200] batch [20/46] time 0.374 (0.453) data 0.243 (0.322) loss_x loss_x 1.0527 (1.1437) acc_x 75.0000 (69.0625) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [25/46] time 0.387 (0.458) data 0.256 (0.327) loss_x loss_x 1.0117 (1.1308) acc_x 71.8750 (69.3750) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [30/46] time 0.657 (0.467) data 0.526 (0.336) loss_x loss_x 0.9702 (1.1430) acc_x 68.7500 (69.4792) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [35/46] time 0.417 (0.464) data 0.287 (0.333) loss_x loss_x 1.2607 (1.1304) acc_x 75.0000 (70.0000) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [40/46] time 0.396 (0.459) data 0.266 (0.328) loss_x loss_x 1.8564 (1.1358) acc_x 56.2500 (69.8438) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [45/46] time 0.484 (0.457) data 0.354 (0.327) loss_x loss_x 1.2256 (1.1290) acc_x 75.0000 (70.1389) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1472
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1500
clean true:1499
clean false:1
clean_rate:0.9993333333333333
noisy true:165
noisy false:1471
after delete: len(clean_dataset) 1500
after delete: len(noisy_dataset) 1636
epoch [134/200] batch [5/46] time 0.420 (0.415) data 0.289 (0.284) loss_x loss_x 1.2568 (1.1856) acc_x 68.7500 (71.8750) lr 5.1825e-04 eta 0:00:17
epoch [134/200] batch [10/46] time 0.466 (0.452) data 0.335 (0.321) loss_x loss_x 1.6064 (1.1758) acc_x 62.5000 (71.2500) lr 5.1825e-04 eta 0:00:16
epoch [134/200] batch [15/46] time 0.480 (0.464) data 0.349 (0.333) loss_x loss_x 1.2266 (1.2195) acc_x 68.7500 (70.2083) lr 5.1825e-04 eta 0:00:14
epoch [134/200] batch [20/46] time 0.462 (0.459) data 0.331 (0.328) loss_x loss_x 1.3867 (1.2232) acc_x 59.3750 (69.5312) lr 5.1825e-04 eta 0:00:11
epoch [134/200] batch [25/46] time 0.446 (0.473) data 0.314 (0.342) loss_x loss_x 1.2031 (1.2439) acc_x 78.1250 (69.5000) lr 5.1825e-04 eta 0:00:09
epoch [134/200] batch [30/46] time 0.447 (0.472) data 0.316 (0.341) loss_x loss_x 1.0400 (1.2184) acc_x 68.7500 (70.0000) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [35/46] time 0.557 (0.472) data 0.426 (0.341) loss_x loss_x 0.9756 (1.1966) acc_x 78.1250 (70.1786) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [40/46] time 0.540 (0.469) data 0.410 (0.338) loss_x loss_x 0.7852 (1.1846) acc_x 78.1250 (70.4688) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [45/46] time 0.505 (0.469) data 0.374 (0.338) loss_x loss_x 0.7236 (1.1690) acc_x 81.2500 (70.2778) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1471
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1493
clean true:1493
clean false:0
clean_rate:1.0
noisy true:172
noisy false:1471
after delete: len(clean_dataset) 1493
after delete: len(noisy_dataset) 1643
epoch [135/200] batch [5/46] time 0.421 (0.409) data 0.290 (0.278) loss_x loss_x 0.9897 (1.1101) acc_x 71.8750 (71.8750) lr 5.0454e-04 eta 0:00:16
epoch [135/200] batch [10/46] time 0.372 (0.397) data 0.241 (0.266) loss_x loss_x 0.8413 (1.1811) acc_x 84.3750 (70.3125) lr 5.0454e-04 eta 0:00:14
epoch [135/200] batch [15/46] time 0.558 (0.423) data 0.427 (0.292) loss_x loss_x 0.8716 (1.1373) acc_x 84.3750 (73.1250) lr 5.0454e-04 eta 0:00:13
epoch [135/200] batch [20/46] time 0.458 (0.423) data 0.327 (0.292) loss_x loss_x 0.9590 (1.1530) acc_x 65.6250 (71.4062) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [25/46] time 0.447 (0.430) data 0.316 (0.299) loss_x loss_x 1.0596 (1.1349) acc_x 75.0000 (71.1250) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [30/46] time 0.336 (0.440) data 0.206 (0.309) loss_x loss_x 1.3857 (1.1539) acc_x 68.7500 (70.5208) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [35/46] time 0.504 (0.448) data 0.373 (0.317) loss_x loss_x 1.3691 (1.1504) acc_x 68.7500 (70.6250) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [40/46] time 0.589 (0.454) data 0.458 (0.323) loss_x loss_x 1.3359 (1.1784) acc_x 75.0000 (70.6250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [45/46] time 0.415 (0.453) data 0.284 (0.322) loss_x loss_x 0.6934 (1.1667) acc_x 75.0000 (70.9028) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1462
confident_label rate tensor(0.4809, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1508
clean true:1507
clean false:1
clean_rate:0.9993368700265252
noisy true:167
noisy false:1461
after delete: len(clean_dataset) 1508
after delete: len(noisy_dataset) 1628
epoch [136/200] batch [5/47] time 0.419 (0.464) data 0.288 (0.333) loss_x loss_x 1.0449 (1.1488) acc_x 75.0000 (73.1250) lr 4.9096e-04 eta 0:00:19
epoch [136/200] batch [10/47] time 0.490 (0.468) data 0.359 (0.337) loss_x loss_x 1.0176 (1.1642) acc_x 71.8750 (70.0000) lr 4.9096e-04 eta 0:00:17
epoch [136/200] batch [15/47] time 0.468 (0.465) data 0.336 (0.334) loss_x loss_x 0.9751 (1.2064) acc_x 75.0000 (69.5833) lr 4.9096e-04 eta 0:00:14
epoch [136/200] batch [20/47] time 0.432 (0.467) data 0.301 (0.336) loss_x loss_x 0.7900 (1.1703) acc_x 75.0000 (70.4688) lr 4.9096e-04 eta 0:00:12
epoch [136/200] batch [25/47] time 0.415 (0.462) data 0.284 (0.331) loss_x loss_x 1.5078 (1.1921) acc_x 68.7500 (70.2500) lr 4.9096e-04 eta 0:00:10
epoch [136/200] batch [30/47] time 0.559 (0.460) data 0.428 (0.329) loss_x loss_x 1.0576 (1.1710) acc_x 78.1250 (71.1458) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [35/47] time 0.652 (0.465) data 0.522 (0.334) loss_x loss_x 1.2920 (1.1893) acc_x 71.8750 (70.6250) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [40/47] time 0.459 (0.475) data 0.329 (0.344) loss_x loss_x 0.8525 (1.1798) acc_x 78.1250 (70.9375) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [45/47] time 0.503 (0.477) data 0.372 (0.346) loss_x loss_x 0.9663 (1.1776) acc_x 71.8750 (71.0417) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1469
confident_label rate tensor(0.4774, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1497
clean true:1495
clean false:2
clean_rate:0.9986639946559787
noisy true:172
noisy false:1467
after delete: len(clean_dataset) 1497
after delete: len(noisy_dataset) 1639
epoch [137/200] batch [5/46] time 0.435 (0.473) data 0.304 (0.342) loss_x loss_x 1.2910 (1.1596) acc_x 62.5000 (69.3750) lr 4.7750e-04 eta 0:00:19
epoch [137/200] batch [10/46] time 0.470 (0.476) data 0.339 (0.345) loss_x loss_x 1.2285 (1.1875) acc_x 71.8750 (70.0000) lr 4.7750e-04 eta 0:00:17
epoch [137/200] batch [15/46] time 0.500 (0.472) data 0.369 (0.341) loss_x loss_x 1.0127 (1.2147) acc_x 78.1250 (70.8333) lr 4.7750e-04 eta 0:00:14
epoch [137/200] batch [20/46] time 0.542 (0.473) data 0.412 (0.343) loss_x loss_x 0.9878 (1.1749) acc_x 75.0000 (71.5625) lr 4.7750e-04 eta 0:00:12
epoch [137/200] batch [25/46] time 0.454 (0.472) data 0.323 (0.342) loss_x loss_x 1.0762 (1.1906) acc_x 68.7500 (71.8750) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [30/46] time 0.403 (0.464) data 0.272 (0.333) loss_x loss_x 1.5781 (1.1987) acc_x 62.5000 (71.3542) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [35/46] time 0.494 (0.462) data 0.363 (0.331) loss_x loss_x 0.9619 (1.2175) acc_x 81.2500 (70.2679) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [40/46] time 0.381 (0.458) data 0.250 (0.327) loss_x loss_x 0.8022 (1.1966) acc_x 78.1250 (70.6250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [45/46] time 0.483 (0.459) data 0.352 (0.328) loss_x loss_x 1.3965 (1.1979) acc_x 71.8750 (70.2778) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1477
confident_label rate tensor(0.4764, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1494
clean true:1493
clean false:1
clean_rate:0.999330655957162
noisy true:166
noisy false:1476
after delete: len(clean_dataset) 1494
after delete: len(noisy_dataset) 1642
epoch [138/200] batch [5/46] time 0.368 (0.425) data 0.237 (0.294) loss_x loss_x 1.3096 (1.1620) acc_x 75.0000 (72.5000) lr 4.6417e-04 eta 0:00:17
epoch [138/200] batch [10/46] time 0.445 (0.438) data 0.314 (0.307) loss_x loss_x 1.2393 (1.1806) acc_x 78.1250 (70.9375) lr 4.6417e-04 eta 0:00:15
epoch [138/200] batch [15/46] time 0.396 (0.436) data 0.265 (0.305) loss_x loss_x 0.7573 (1.1162) acc_x 78.1250 (72.0833) lr 4.6417e-04 eta 0:00:13
epoch [138/200] batch [20/46] time 0.618 (0.454) data 0.487 (0.323) loss_x loss_x 1.0840 (1.1490) acc_x 75.0000 (71.4062) lr 4.6417e-04 eta 0:00:11
epoch [138/200] batch [25/46] time 0.429 (0.451) data 0.298 (0.320) loss_x loss_x 0.9956 (1.1780) acc_x 71.8750 (70.7500) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [30/46] time 0.543 (0.454) data 0.412 (0.323) loss_x loss_x 0.7070 (1.1613) acc_x 81.2500 (70.5208) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [35/46] time 0.551 (0.457) data 0.417 (0.326) loss_x loss_x 1.0430 (1.1651) acc_x 71.8750 (70.5357) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [40/46] time 0.472 (0.458) data 0.341 (0.327) loss_x loss_x 1.7881 (1.1624) acc_x 65.6250 (70.7812) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [45/46] time 0.649 (0.460) data 0.517 (0.329) loss_x loss_x 1.0977 (1.1638) acc_x 75.0000 (70.6944) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1412
confident_label rate tensor(0.4923, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1544
clean true:1543
clean false:1
clean_rate:0.9993523316062176
noisy true:181
noisy false:1411
after delete: len(clean_dataset) 1544
after delete: len(noisy_dataset) 1592
epoch [139/200] batch [5/48] time 0.570 (0.483) data 0.440 (0.352) loss_x loss_x 1.9844 (1.3018) acc_x 50.0000 (67.5000) lr 4.5098e-04 eta 0:00:20
epoch [139/200] batch [10/48] time 0.498 (0.468) data 0.367 (0.337) loss_x loss_x 1.0752 (1.2395) acc_x 71.8750 (70.0000) lr 4.5098e-04 eta 0:00:17
epoch [139/200] batch [15/48] time 0.404 (0.457) data 0.273 (0.326) loss_x loss_x 0.5903 (1.2118) acc_x 84.3750 (69.3750) lr 4.5098e-04 eta 0:00:15
epoch [139/200] batch [20/48] time 0.466 (0.468) data 0.335 (0.337) loss_x loss_x 1.2861 (1.2229) acc_x 68.7500 (68.7500) lr 4.5098e-04 eta 0:00:13
epoch [139/200] batch [25/48] time 0.471 (0.464) data 0.340 (0.333) loss_x loss_x 1.0059 (1.1956) acc_x 75.0000 (69.8750) lr 4.5098e-04 eta 0:00:10
epoch [139/200] batch [30/48] time 0.478 (0.470) data 0.347 (0.339) loss_x loss_x 1.1016 (1.1686) acc_x 71.8750 (70.9375) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [35/48] time 0.340 (0.456) data 0.209 (0.325) loss_x loss_x 1.1465 (1.1776) acc_x 68.7500 (70.2679) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [40/48] time 0.486 (0.458) data 0.355 (0.327) loss_x loss_x 1.1748 (1.2013) acc_x 75.0000 (70.0000) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [45/48] time 0.433 (0.455) data 0.302 (0.324) loss_x loss_x 1.1758 (1.1808) acc_x 71.8750 (70.2778) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1472
confident_label rate tensor(0.4774, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1497
clean true:1494
clean false:3
clean_rate:0.9979959919839679
noisy true:170
noisy false:1469
after delete: len(clean_dataset) 1497
after delete: len(noisy_dataset) 1639
epoch [140/200] batch [5/46] time 0.551 (0.459) data 0.421 (0.329) loss_x loss_x 1.1279 (1.0562) acc_x 65.6250 (75.0000) lr 4.3792e-04 eta 0:00:18
epoch [140/200] batch [10/46] time 0.436 (0.452) data 0.305 (0.322) loss_x loss_x 1.3535 (1.1430) acc_x 65.6250 (72.5000) lr 4.3792e-04 eta 0:00:16
epoch [140/200] batch [15/46] time 0.487 (0.457) data 0.357 (0.327) loss_x loss_x 1.0039 (1.2486) acc_x 71.8750 (68.7500) lr 4.3792e-04 eta 0:00:14
epoch [140/200] batch [20/46] time 0.381 (0.449) data 0.251 (0.319) loss_x loss_x 1.4629 (1.2631) acc_x 62.5000 (68.1250) lr 4.3792e-04 eta 0:00:11
epoch [140/200] batch [25/46] time 0.367 (0.452) data 0.236 (0.321) loss_x loss_x 1.3594 (1.2255) acc_x 68.7500 (68.6250) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [30/46] time 0.564 (0.462) data 0.434 (0.332) loss_x loss_x 0.8125 (1.1906) acc_x 75.0000 (69.6875) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [35/46] time 0.379 (0.459) data 0.248 (0.328) loss_x loss_x 0.9912 (1.1862) acc_x 78.1250 (69.9107) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [40/46] time 0.360 (0.457) data 0.226 (0.327) loss_x loss_x 1.0508 (1.1795) acc_x 68.7500 (69.9219) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [45/46] time 0.431 (0.465) data 0.300 (0.334) loss_x loss_x 1.7422 (1.1819) acc_x 59.3750 (69.5833) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1465
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1504
clean true:1499
clean false:5
clean_rate:0.9966755319148937
noisy true:172
noisy false:1460
after delete: len(clean_dataset) 1504
after delete: len(noisy_dataset) 1632
epoch [141/200] batch [5/47] time 0.458 (0.455) data 0.326 (0.324) loss_x loss_x 1.0371 (1.1225) acc_x 65.6250 (65.0000) lr 4.2499e-04 eta 0:00:19
epoch [141/200] batch [10/47] time 0.409 (0.436) data 0.278 (0.305) loss_x loss_x 1.2285 (1.1491) acc_x 78.1250 (68.4375) lr 4.2499e-04 eta 0:00:16
epoch [141/200] batch [15/47] time 0.440 (0.436) data 0.310 (0.305) loss_x loss_x 1.2041 (1.1969) acc_x 68.7500 (67.0833) lr 4.2499e-04 eta 0:00:13
epoch [141/200] batch [20/47] time 0.442 (0.433) data 0.311 (0.303) loss_x loss_x 0.8379 (1.2452) acc_x 81.2500 (67.1875) lr 4.2499e-04 eta 0:00:11
epoch [141/200] batch [25/47] time 0.529 (0.452) data 0.399 (0.321) loss_x loss_x 0.9985 (1.2317) acc_x 71.8750 (67.6250) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [30/47] time 0.480 (0.451) data 0.349 (0.321) loss_x loss_x 1.5781 (1.2266) acc_x 65.6250 (68.3333) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [35/47] time 0.333 (0.441) data 0.203 (0.310) loss_x loss_x 0.9331 (1.2277) acc_x 81.2500 (68.1250) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [40/47] time 0.445 (0.447) data 0.314 (0.316) loss_x loss_x 1.4004 (1.2189) acc_x 65.6250 (68.2812) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [45/47] time 0.431 (0.445) data 0.300 (0.314) loss_x loss_x 1.4893 (1.2252) acc_x 65.6250 (68.3333) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4770, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1496
clean true:1495
clean false:1
clean_rate:0.9993315508021391
noisy true:168
noisy false:1472
after delete: len(clean_dataset) 1496
after delete: len(noisy_dataset) 1640
epoch [142/200] batch [5/46] time 0.405 (0.426) data 0.274 (0.295) loss_x loss_x 1.0986 (1.2968) acc_x 68.7500 (65.0000) lr 4.1221e-04 eta 0:00:17
epoch [142/200] batch [10/46] time 0.374 (0.421) data 0.243 (0.290) loss_x loss_x 1.1406 (1.2056) acc_x 75.0000 (68.1250) lr 4.1221e-04 eta 0:00:15
epoch [142/200] batch [15/46] time 0.568 (0.441) data 0.437 (0.310) loss_x loss_x 1.1904 (1.1677) acc_x 75.0000 (69.5833) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [20/46] time 0.509 (0.448) data 0.378 (0.317) loss_x loss_x 0.9150 (1.1867) acc_x 68.7500 (68.7500) lr 4.1221e-04 eta 0:00:11
epoch [142/200] batch [25/46] time 0.506 (0.449) data 0.375 (0.319) loss_x loss_x 1.2236 (1.1627) acc_x 75.0000 (69.5000) lr 4.1221e-04 eta 0:00:09
epoch [142/200] batch [30/46] time 0.596 (0.452) data 0.465 (0.321) loss_x loss_x 0.7793 (1.1692) acc_x 81.2500 (69.6875) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [35/46] time 0.421 (0.448) data 0.290 (0.317) loss_x loss_x 1.0801 (1.1769) acc_x 78.1250 (69.7321) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [40/46] time 0.370 (0.450) data 0.239 (0.319) loss_x loss_x 1.6084 (1.1730) acc_x 56.2500 (69.6875) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [45/46] time 0.419 (0.446) data 0.288 (0.315) loss_x loss_x 0.9170 (1.1495) acc_x 78.1250 (70.3472) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1484
confident_label rate tensor(0.4745, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1488
clean true:1486
clean false:2
clean_rate:0.9986559139784946
noisy true:166
noisy false:1482
after delete: len(clean_dataset) 1488
after delete: len(noisy_dataset) 1648
epoch [143/200] batch [5/46] time 0.407 (0.471) data 0.277 (0.340) loss_x loss_x 1.8311 (1.1753) acc_x 59.3750 (75.6250) lr 3.9958e-04 eta 0:00:19
epoch [143/200] batch [10/46] time 0.438 (0.463) data 0.308 (0.333) loss_x loss_x 0.8950 (1.2221) acc_x 78.1250 (72.8125) lr 3.9958e-04 eta 0:00:16
epoch [143/200] batch [15/46] time 0.377 (0.459) data 0.247 (0.329) loss_x loss_x 1.1865 (1.1829) acc_x 68.7500 (72.7083) lr 3.9958e-04 eta 0:00:14
epoch [143/200] batch [20/46] time 0.371 (0.445) data 0.240 (0.314) loss_x loss_x 0.8706 (1.2040) acc_x 87.5000 (72.1875) lr 3.9958e-04 eta 0:00:11
epoch [143/200] batch [25/46] time 0.487 (0.456) data 0.356 (0.326) loss_x loss_x 1.0723 (1.1583) acc_x 81.2500 (73.1250) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [30/46] time 0.394 (0.453) data 0.264 (0.322) loss_x loss_x 1.3584 (1.1589) acc_x 62.5000 (72.1875) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [35/46] time 0.546 (0.458) data 0.415 (0.327) loss_x loss_x 1.7500 (1.1489) acc_x 56.2500 (72.1429) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [40/46] time 0.439 (0.456) data 0.308 (0.325) loss_x loss_x 1.5977 (1.1517) acc_x 62.5000 (72.1875) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [45/46] time 0.434 (0.454) data 0.303 (0.324) loss_x loss_x 1.6865 (1.1897) acc_x 62.5000 (71.5278) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1444
confident_label rate tensor(0.4841, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1518
clean true:1515
clean false:3
clean_rate:0.9980237154150198
noisy true:177
noisy false:1441
after delete: len(clean_dataset) 1518
after delete: len(noisy_dataset) 1618
epoch [144/200] batch [5/47] time 0.468 (0.435) data 0.338 (0.304) loss_x loss_x 1.0293 (1.2033) acc_x 75.0000 (70.0000) lr 3.8709e-04 eta 0:00:18
epoch [144/200] batch [10/47] time 0.402 (0.434) data 0.271 (0.303) loss_x loss_x 1.1143 (1.1806) acc_x 65.6250 (71.5625) lr 3.8709e-04 eta 0:00:16
epoch [144/200] batch [15/47] time 0.373 (0.430) data 0.243 (0.299) loss_x loss_x 1.5840 (1.2507) acc_x 59.3750 (69.5833) lr 3.8709e-04 eta 0:00:13
epoch [144/200] batch [20/47] time 0.435 (0.435) data 0.304 (0.304) loss_x loss_x 1.6201 (1.2325) acc_x 65.6250 (70.7812) lr 3.8709e-04 eta 0:00:11
epoch [144/200] batch [25/47] time 0.391 (0.433) data 0.260 (0.303) loss_x loss_x 1.6582 (1.2992) acc_x 59.3750 (69.6250) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [30/47] time 0.381 (0.433) data 0.251 (0.303) loss_x loss_x 1.5879 (1.3281) acc_x 65.6250 (68.5417) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [35/47] time 0.474 (0.445) data 0.343 (0.315) loss_x loss_x 0.9775 (1.2973) acc_x 75.0000 (69.0179) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [40/47] time 0.398 (0.445) data 0.266 (0.314) loss_x loss_x 0.7847 (1.2769) acc_x 87.5000 (69.9219) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [45/47] time 0.639 (0.450) data 0.509 (0.320) loss_x loss_x 0.8418 (1.2548) acc_x 84.3750 (70.2083) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1416
confident_label rate tensor(0.4917, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1542
clean true:1538
clean false:4
clean_rate:0.9974059662775616
noisy true:182
noisy false:1412
after delete: len(clean_dataset) 1542
after delete: len(noisy_dataset) 1594
epoch [145/200] batch [5/48] time 0.474 (0.476) data 0.343 (0.345) loss_x loss_x 1.3125 (1.1944) acc_x 68.7500 (73.1250) lr 3.7476e-04 eta 0:00:20
epoch [145/200] batch [10/48] time 0.475 (0.484) data 0.344 (0.354) loss_x loss_x 1.4834 (1.1631) acc_x 56.2500 (71.5625) lr 3.7476e-04 eta 0:00:18
epoch [145/200] batch [15/48] time 0.493 (0.469) data 0.362 (0.338) loss_x loss_x 1.2520 (1.1465) acc_x 59.3750 (71.2500) lr 3.7476e-04 eta 0:00:15
epoch [145/200] batch [20/48] time 0.465 (0.460) data 0.334 (0.329) loss_x loss_x 1.7773 (1.2160) acc_x 53.1250 (69.3750) lr 3.7476e-04 eta 0:00:12
epoch [145/200] batch [25/48] time 0.427 (0.463) data 0.297 (0.332) loss_x loss_x 1.4053 (1.2646) acc_x 62.5000 (68.0000) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [30/48] time 0.400 (0.454) data 0.270 (0.324) loss_x loss_x 1.2598 (1.2708) acc_x 62.5000 (67.6042) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [35/48] time 0.438 (0.451) data 0.308 (0.320) loss_x loss_x 1.1230 (1.2390) acc_x 75.0000 (68.7500) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [40/48] time 0.616 (0.458) data 0.485 (0.328) loss_x loss_x 1.6592 (1.2439) acc_x 65.6250 (68.6719) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [45/48] time 0.535 (0.459) data 0.405 (0.328) loss_x loss_x 1.5322 (1.2770) acc_x 62.5000 (68.0556) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1448
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1520
clean true:1518
clean false:2
clean_rate:0.9986842105263158
noisy true:170
noisy false:1446
after delete: len(clean_dataset) 1520
after delete: len(noisy_dataset) 1616
epoch [146/200] batch [5/47] time 0.434 (0.487) data 0.303 (0.356) loss_x loss_x 1.6846 (1.1711) acc_x 59.3750 (70.6250) lr 3.6258e-04 eta 0:00:20
epoch [146/200] batch [10/47] time 0.541 (0.474) data 0.410 (0.343) loss_x loss_x 1.3789 (1.2443) acc_x 68.7500 (69.0625) lr 3.6258e-04 eta 0:00:17
epoch [146/200] batch [15/47] time 0.387 (0.463) data 0.256 (0.332) loss_x loss_x 1.7666 (1.2689) acc_x 65.6250 (68.3333) lr 3.6258e-04 eta 0:00:14
epoch [146/200] batch [20/47] time 0.495 (0.455) data 0.364 (0.324) loss_x loss_x 0.8735 (1.2434) acc_x 81.2500 (69.2188) lr 3.6258e-04 eta 0:00:12
epoch [146/200] batch [25/47] time 0.499 (0.459) data 0.368 (0.328) loss_x loss_x 1.1240 (1.2327) acc_x 68.7500 (69.2500) lr 3.6258e-04 eta 0:00:10
epoch [146/200] batch [30/47] time 0.383 (0.450) data 0.253 (0.319) loss_x loss_x 1.0215 (1.2030) acc_x 75.0000 (70.2083) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [35/47] time 0.421 (0.450) data 0.290 (0.319) loss_x loss_x 0.9355 (1.2049) acc_x 78.1250 (69.1964) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [40/47] time 0.529 (0.453) data 0.398 (0.322) loss_x loss_x 0.9365 (1.1792) acc_x 78.1250 (69.5312) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [45/47] time 0.403 (0.452) data 0.273 (0.321) loss_x loss_x 1.1309 (1.1632) acc_x 71.8750 (69.8611) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1482
confident_label rate tensor(0.4735, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1485
clean true:1483
clean false:2
clean_rate:0.9986531986531987
noisy true:171
noisy false:1480
after delete: len(clean_dataset) 1485
after delete: len(noisy_dataset) 1651
epoch [147/200] batch [5/46] time 0.496 (0.454) data 0.365 (0.323) loss_x loss_x 0.8887 (1.0552) acc_x 78.1250 (77.5000) lr 3.5055e-04 eta 0:00:18
epoch [147/200] batch [10/46] time 0.370 (0.433) data 0.239 (0.302) loss_x loss_x 1.1064 (1.1036) acc_x 62.5000 (73.4375) lr 3.5055e-04 eta 0:00:15
epoch [147/200] batch [15/46] time 0.581 (0.446) data 0.450 (0.315) loss_x loss_x 0.7388 (1.0428) acc_x 81.2500 (73.7500) lr 3.5055e-04 eta 0:00:13
epoch [147/200] batch [20/46] time 0.482 (0.449) data 0.351 (0.318) loss_x loss_x 0.9751 (1.0862) acc_x 84.3750 (73.7500) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [25/46] time 0.530 (0.451) data 0.399 (0.320) loss_x loss_x 0.7549 (1.0502) acc_x 78.1250 (73.7500) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [30/46] time 0.527 (0.453) data 0.396 (0.322) loss_x loss_x 1.2344 (1.0840) acc_x 71.8750 (72.9167) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [35/46] time 0.456 (0.460) data 0.325 (0.330) loss_x loss_x 0.9160 (1.0946) acc_x 81.2500 (73.3036) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [40/46] time 0.450 (0.455) data 0.319 (0.324) loss_x loss_x 0.9082 (1.0913) acc_x 78.1250 (73.4375) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [45/46] time 0.422 (0.450) data 0.291 (0.319) loss_x loss_x 1.0352 (1.0688) acc_x 62.5000 (73.5417) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1432
confident_label rate tensor(0.4844, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1519
clean true:1516
clean false:3
clean_rate:0.9980250164581962
noisy true:188
noisy false:1429
after delete: len(clean_dataset) 1519
after delete: len(noisy_dataset) 1617
epoch [148/200] batch [5/47] time 0.431 (0.418) data 0.301 (0.288) loss_x loss_x 1.5830 (1.1694) acc_x 56.2500 (68.1250) lr 3.3869e-04 eta 0:00:17
epoch [148/200] batch [10/47] time 0.422 (0.430) data 0.291 (0.300) loss_x loss_x 1.7217 (1.1955) acc_x 56.2500 (69.3750) lr 3.3869e-04 eta 0:00:15
epoch [148/200] batch [15/47] time 0.576 (0.440) data 0.445 (0.310) loss_x loss_x 0.7065 (1.1654) acc_x 81.2500 (70.2083) lr 3.3869e-04 eta 0:00:14
epoch [148/200] batch [20/47] time 0.656 (0.462) data 0.525 (0.331) loss_x loss_x 1.1064 (1.1839) acc_x 71.8750 (70.0000) lr 3.3869e-04 eta 0:00:12
epoch [148/200] batch [25/47] time 0.482 (0.462) data 0.351 (0.331) loss_x loss_x 2.0977 (1.2746) acc_x 59.3750 (68.7500) lr 3.3869e-04 eta 0:00:10
epoch [148/200] batch [30/47] time 0.386 (0.460) data 0.255 (0.329) loss_x loss_x 1.2236 (1.2389) acc_x 68.7500 (69.7917) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [35/47] time 0.547 (0.460) data 0.416 (0.330) loss_x loss_x 1.1211 (1.2227) acc_x 68.7500 (70.2679) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [40/47] time 0.377 (0.455) data 0.246 (0.324) loss_x loss_x 1.2109 (1.2265) acc_x 71.8750 (70.3125) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [45/47] time 0.507 (0.455) data 0.376 (0.325) loss_x loss_x 1.1182 (1.2147) acc_x 75.0000 (70.4861) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1454
confident_label rate tensor(0.4841, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1518
clean true:1517
clean false:1
clean_rate:0.9993412384716732
noisy true:165
noisy false:1453
after delete: len(clean_dataset) 1518
after delete: len(noisy_dataset) 1618
epoch [149/200] batch [5/47] time 0.497 (0.472) data 0.367 (0.342) loss_x loss_x 1.5752 (1.2969) acc_x 68.7500 (68.7500) lr 3.2699e-04 eta 0:00:19
epoch [149/200] batch [10/47] time 0.390 (0.447) data 0.260 (0.316) loss_x loss_x 0.7495 (1.0788) acc_x 71.8750 (72.5000) lr 3.2699e-04 eta 0:00:16
epoch [149/200] batch [15/47] time 0.384 (0.454) data 0.253 (0.324) loss_x loss_x 1.1172 (1.0951) acc_x 71.8750 (72.0833) lr 3.2699e-04 eta 0:00:14
epoch [149/200] batch [20/47] time 0.466 (0.478) data 0.335 (0.348) loss_x loss_x 1.1348 (1.0579) acc_x 68.7500 (72.8125) lr 3.2699e-04 eta 0:00:12
epoch [149/200] batch [25/47] time 0.466 (0.469) data 0.335 (0.338) loss_x loss_x 1.0674 (1.0785) acc_x 65.6250 (72.2500) lr 3.2699e-04 eta 0:00:10
epoch [149/200] batch [30/47] time 0.456 (0.470) data 0.326 (0.339) loss_x loss_x 1.1104 (1.0862) acc_x 78.1250 (72.6042) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [35/47] time 0.429 (0.467) data 0.298 (0.336) loss_x loss_x 1.5967 (1.1419) acc_x 62.5000 (71.6071) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [40/47] time 0.481 (0.461) data 0.351 (0.330) loss_x loss_x 1.2549 (1.1618) acc_x 68.7500 (70.8594) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [45/47] time 0.405 (0.462) data 0.274 (0.331) loss_x loss_x 0.9722 (1.1399) acc_x 75.0000 (71.3889) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1446
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1502
clean true:1501
clean false:1
clean_rate:0.9993342210386151
noisy true:189
noisy false:1445
after delete: len(clean_dataset) 1502
after delete: len(noisy_dataset) 1634
epoch [150/200] batch [5/46] time 0.529 (0.535) data 0.398 (0.404) loss_x loss_x 1.7139 (1.2568) acc_x 59.3750 (70.6250) lr 3.1545e-04 eta 0:00:21
epoch [150/200] batch [10/46] time 0.398 (0.484) data 0.268 (0.354) loss_x loss_x 1.5576 (1.2479) acc_x 53.1250 (69.0625) lr 3.1545e-04 eta 0:00:17
epoch [150/200] batch [15/46] time 0.560 (0.466) data 0.430 (0.335) loss_x loss_x 0.9033 (1.1305) acc_x 78.1250 (71.2500) lr 3.1545e-04 eta 0:00:14
epoch [150/200] batch [20/46] time 0.504 (0.457) data 0.373 (0.327) loss_x loss_x 1.1865 (1.1603) acc_x 78.1250 (71.5625) lr 3.1545e-04 eta 0:00:11
epoch [150/200] batch [25/46] time 0.552 (0.457) data 0.421 (0.326) loss_x loss_x 0.6421 (1.1223) acc_x 87.5000 (72.6250) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [30/46] time 0.404 (0.452) data 0.274 (0.321) loss_x loss_x 1.2285 (1.1006) acc_x 59.3750 (72.2917) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [35/46] time 0.334 (0.447) data 0.203 (0.317) loss_x loss_x 1.4248 (1.1161) acc_x 62.5000 (72.1429) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [40/46] time 0.466 (0.447) data 0.336 (0.316) loss_x loss_x 1.1006 (1.1173) acc_x 71.8750 (71.7969) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [45/46] time 0.473 (0.453) data 0.343 (0.322) loss_x loss_x 1.4697 (1.1256) acc_x 62.5000 (71.5278) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1456
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1512
clean true:1509
clean false:3
clean_rate:0.998015873015873
noisy true:171
noisy false:1453
after delete: len(clean_dataset) 1512
after delete: len(noisy_dataset) 1624
epoch [151/200] batch [5/47] time 0.527 (0.468) data 0.396 (0.337) loss_x loss_x 1.2998 (1.1964) acc_x 68.7500 (71.2500) lr 3.0409e-04 eta 0:00:19
epoch [151/200] batch [10/47] time 0.481 (0.472) data 0.350 (0.341) loss_x loss_x 1.0244 (1.1926) acc_x 81.2500 (72.1875) lr 3.0409e-04 eta 0:00:17
epoch [151/200] batch [15/47] time 0.473 (0.476) data 0.343 (0.345) loss_x loss_x 1.4219 (1.2147) acc_x 78.1250 (71.8750) lr 3.0409e-04 eta 0:00:15
epoch [151/200] batch [20/47] time 0.601 (0.470) data 0.470 (0.339) loss_x loss_x 1.4150 (1.2263) acc_x 65.6250 (70.7812) lr 3.0409e-04 eta 0:00:12
epoch [151/200] batch [25/47] time 0.526 (0.459) data 0.395 (0.328) loss_x loss_x 0.6689 (1.1890) acc_x 81.2500 (70.8750) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [30/47] time 0.390 (0.452) data 0.259 (0.321) loss_x loss_x 1.3262 (1.1974) acc_x 71.8750 (70.9375) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [35/47] time 0.529 (0.453) data 0.398 (0.322) loss_x loss_x 0.9814 (1.1842) acc_x 71.8750 (70.8929) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [40/47] time 0.418 (0.460) data 0.287 (0.329) loss_x loss_x 0.7783 (1.1753) acc_x 78.1250 (70.3125) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [45/47] time 0.430 (0.455) data 0.299 (0.324) loss_x loss_x 1.0488 (1.1610) acc_x 68.7500 (70.0694) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1451
confident_label rate tensor(0.4825, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1513
clean true:1511
clean false:2
clean_rate:0.998678122934567
noisy true:174
noisy false:1449
after delete: len(clean_dataset) 1513
after delete: len(noisy_dataset) 1623
epoch [152/200] batch [5/47] time 0.401 (0.470) data 0.270 (0.339) loss_x loss_x 1.5146 (1.1589) acc_x 62.5000 (70.0000) lr 2.9289e-04 eta 0:00:19
epoch [152/200] batch [10/47] time 0.480 (0.477) data 0.349 (0.346) loss_x loss_x 1.6934 (1.1984) acc_x 59.3750 (70.9375) lr 2.9289e-04 eta 0:00:17
epoch [152/200] batch [15/47] time 0.415 (0.457) data 0.285 (0.326) loss_x loss_x 1.0000 (1.1994) acc_x 68.7500 (69.1667) lr 2.9289e-04 eta 0:00:14
epoch [152/200] batch [20/47] time 0.525 (0.452) data 0.394 (0.321) loss_x loss_x 0.6162 (1.1400) acc_x 87.5000 (70.3125) lr 2.9289e-04 eta 0:00:12
epoch [152/200] batch [25/47] time 0.415 (0.458) data 0.284 (0.327) loss_x loss_x 1.0156 (1.1634) acc_x 81.2500 (70.6250) lr 2.9289e-04 eta 0:00:10
epoch [152/200] batch [30/47] time 0.435 (0.463) data 0.304 (0.332) loss_x loss_x 1.0264 (1.1437) acc_x 68.7500 (71.4583) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [35/47] time 0.384 (0.453) data 0.253 (0.322) loss_x loss_x 1.5664 (1.1443) acc_x 68.7500 (71.6964) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [40/47] time 0.436 (0.453) data 0.306 (0.322) loss_x loss_x 0.8477 (1.1552) acc_x 75.0000 (71.8750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [45/47] time 0.387 (0.450) data 0.256 (0.320) loss_x loss_x 0.8237 (1.1573) acc_x 81.2500 (71.6667) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1432
confident_label rate tensor(0.4901, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1537
clean true:1534
clean false:3
clean_rate:0.9980481457384516
noisy true:170
noisy false:1429
after delete: len(clean_dataset) 1537
after delete: len(noisy_dataset) 1599
epoch [153/200] batch [5/48] time 0.450 (0.469) data 0.319 (0.337) loss_x loss_x 1.0312 (1.1602) acc_x 65.6250 (69.3750) lr 2.8187e-04 eta 0:00:20
epoch [153/200] batch [10/48] time 0.444 (0.450) data 0.313 (0.319) loss_x loss_x 0.8989 (1.0925) acc_x 81.2500 (71.5625) lr 2.8187e-04 eta 0:00:17
epoch [153/200] batch [15/48] time 0.428 (0.449) data 0.295 (0.318) loss_x loss_x 1.0967 (1.1065) acc_x 71.8750 (71.2500) lr 2.8187e-04 eta 0:00:14
epoch [153/200] batch [20/48] time 0.387 (0.450) data 0.256 (0.319) loss_x loss_x 0.7144 (1.1072) acc_x 81.2500 (71.2500) lr 2.8187e-04 eta 0:00:12
epoch [153/200] batch [25/48] time 0.470 (0.452) data 0.339 (0.321) loss_x loss_x 0.9561 (1.0950) acc_x 81.2500 (71.7500) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [30/48] time 0.421 (0.450) data 0.290 (0.319) loss_x loss_x 0.9077 (1.0572) acc_x 75.0000 (73.0208) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [35/48] time 0.527 (0.455) data 0.396 (0.324) loss_x loss_x 0.7930 (1.0653) acc_x 78.1250 (72.7679) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [40/48] time 0.563 (0.456) data 0.432 (0.325) loss_x loss_x 1.6660 (1.0960) acc_x 68.7500 (72.3438) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [45/48] time 0.390 (0.453) data 0.259 (0.322) loss_x loss_x 0.7168 (1.1053) acc_x 75.0000 (71.9444) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1398
confident_label rate tensor(0.4968, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1558
clean true:1554
clean false:4
clean_rate:0.9974326059050064
noisy true:184
noisy false:1394
after delete: len(clean_dataset) 1558
after delete: len(noisy_dataset) 1578
epoch [154/200] batch [5/48] time 0.409 (0.412) data 0.278 (0.281) loss_x loss_x 1.1201 (1.1050) acc_x 78.1250 (71.2500) lr 2.7103e-04 eta 0:00:17
epoch [154/200] batch [10/48] time 0.473 (0.457) data 0.342 (0.326) loss_x loss_x 1.0459 (0.9973) acc_x 75.0000 (74.0625) lr 2.7103e-04 eta 0:00:17
epoch [154/200] batch [15/48] time 0.452 (0.465) data 0.321 (0.334) loss_x loss_x 1.4033 (0.9809) acc_x 59.3750 (73.9583) lr 2.7103e-04 eta 0:00:15
epoch [154/200] batch [20/48] time 0.463 (0.461) data 0.332 (0.329) loss_x loss_x 1.2373 (0.9997) acc_x 75.0000 (73.4375) lr 2.7103e-04 eta 0:00:12
epoch [154/200] batch [25/48] time 0.381 (0.461) data 0.250 (0.330) loss_x loss_x 1.3652 (1.0393) acc_x 71.8750 (73.5000) lr 2.7103e-04 eta 0:00:10
epoch [154/200] batch [30/48] time 0.345 (0.449) data 0.215 (0.318) loss_x loss_x 1.3545 (1.0668) acc_x 65.6250 (72.8125) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [35/48] time 0.392 (0.450) data 0.262 (0.319) loss_x loss_x 1.3008 (1.0894) acc_x 68.7500 (72.2321) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [40/48] time 0.537 (0.453) data 0.406 (0.322) loss_x loss_x 0.8799 (1.0731) acc_x 78.1250 (72.6562) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [45/48] time 0.423 (0.453) data 0.293 (0.322) loss_x loss_x 1.7256 (1.0860) acc_x 62.5000 (72.4306) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1454
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1517
clean true:1515
clean false:2
clean_rate:0.998681608437706
noisy true:167
noisy false:1452
after delete: len(clean_dataset) 1517
after delete: len(noisy_dataset) 1619
epoch [155/200] batch [5/47] time 0.460 (0.445) data 0.329 (0.313) loss_x loss_x 1.0459 (1.1083) acc_x 78.1250 (74.3750) lr 2.6037e-04 eta 0:00:18
epoch [155/200] batch [10/47] time 0.413 (0.469) data 0.282 (0.338) loss_x loss_x 0.7461 (1.1085) acc_x 78.1250 (72.5000) lr 2.6037e-04 eta 0:00:17
epoch [155/200] batch [15/47] time 0.459 (0.473) data 0.328 (0.342) loss_x loss_x 1.0391 (1.1487) acc_x 75.0000 (71.4583) lr 2.6037e-04 eta 0:00:15
epoch [155/200] batch [20/47] time 0.465 (0.467) data 0.334 (0.336) loss_x loss_x 1.0273 (1.1326) acc_x 71.8750 (72.0312) lr 2.6037e-04 eta 0:00:12
epoch [155/200] batch [25/47] time 0.381 (0.460) data 0.251 (0.329) loss_x loss_x 1.0635 (1.1465) acc_x 78.1250 (71.1250) lr 2.6037e-04 eta 0:00:10
epoch [155/200] batch [30/47] time 0.442 (0.457) data 0.312 (0.326) loss_x loss_x 0.9946 (1.1380) acc_x 78.1250 (71.1458) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [35/47] time 0.489 (0.458) data 0.359 (0.327) loss_x loss_x 1.6953 (1.1497) acc_x 65.6250 (71.2500) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [40/47] time 0.615 (0.460) data 0.486 (0.329) loss_x loss_x 1.1416 (1.1572) acc_x 71.8750 (71.0938) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [45/47] time 0.449 (0.462) data 0.318 (0.331) loss_x loss_x 0.9893 (1.1680) acc_x 68.7500 (70.7639) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1459
confident_label rate tensor(0.4751, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1490
clean true:1489
clean false:1
clean_rate:0.9993288590604027
noisy true:188
noisy false:1458
after delete: len(clean_dataset) 1490
after delete: len(noisy_dataset) 1646
epoch [156/200] batch [5/46] time 0.464 (0.470) data 0.334 (0.340) loss_x loss_x 1.0654 (1.1172) acc_x 78.1250 (73.7500) lr 2.4989e-04 eta 0:00:19
epoch [156/200] batch [10/46] time 0.431 (0.463) data 0.301 (0.333) loss_x loss_x 1.1689 (1.1139) acc_x 65.6250 (73.1250) lr 2.4989e-04 eta 0:00:16
epoch [156/200] batch [15/46] time 0.463 (0.455) data 0.332 (0.324) loss_x loss_x 1.0400 (1.1019) acc_x 75.0000 (73.7500) lr 2.4989e-04 eta 0:00:14
epoch [156/200] batch [20/46] time 0.476 (0.459) data 0.344 (0.329) loss_x loss_x 0.7646 (1.0874) acc_x 84.3750 (74.2188) lr 2.4989e-04 eta 0:00:11
epoch [156/200] batch [25/46] time 0.409 (0.450) data 0.278 (0.319) loss_x loss_x 0.8691 (1.0583) acc_x 81.2500 (74.6250) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [30/46] time 0.634 (0.452) data 0.503 (0.322) loss_x loss_x 1.1680 (1.0794) acc_x 78.1250 (73.9583) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [35/46] time 0.489 (0.453) data 0.358 (0.322) loss_x loss_x 0.8052 (1.0867) acc_x 78.1250 (74.1964) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [40/46] time 0.403 (0.454) data 0.272 (0.323) loss_x loss_x 0.9341 (1.1050) acc_x 71.8750 (73.1250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [45/46] time 0.451 (0.455) data 0.320 (0.324) loss_x loss_x 1.1777 (1.1080) acc_x 65.6250 (72.7778) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1419
confident_label rate tensor(0.4962, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1556
clean true:1551
clean false:5
clean_rate:0.9967866323907455
noisy true:166
noisy false:1414
after delete: len(clean_dataset) 1556
after delete: len(noisy_dataset) 1580
epoch [157/200] batch [5/48] time 0.494 (0.457) data 0.362 (0.326) loss_x loss_x 0.6763 (1.0425) acc_x 81.2500 (71.2500) lr 2.3959e-04 eta 0:00:19
epoch [157/200] batch [10/48] time 0.544 (0.461) data 0.413 (0.330) loss_x loss_x 1.2100 (1.1525) acc_x 75.0000 (70.6250) lr 2.3959e-04 eta 0:00:17
epoch [157/200] batch [15/48] time 0.450 (0.471) data 0.319 (0.340) loss_x loss_x 1.4688 (1.1519) acc_x 68.7500 (69.7917) lr 2.3959e-04 eta 0:00:15
epoch [157/200] batch [20/48] time 0.540 (0.469) data 0.409 (0.338) loss_x loss_x 0.7979 (1.1343) acc_x 78.1250 (70.6250) lr 2.3959e-04 eta 0:00:13
epoch [157/200] batch [25/48] time 0.362 (0.471) data 0.231 (0.340) loss_x loss_x 1.0127 (1.1546) acc_x 65.6250 (70.3750) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [30/48] time 0.555 (0.466) data 0.424 (0.335) loss_x loss_x 1.2852 (1.1506) acc_x 65.6250 (70.5208) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [35/48] time 0.461 (0.460) data 0.330 (0.329) loss_x loss_x 0.8130 (1.1330) acc_x 81.2500 (70.7143) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [40/48] time 0.428 (0.459) data 0.297 (0.328) loss_x loss_x 0.9678 (1.1387) acc_x 84.3750 (71.0938) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [45/48] time 0.431 (0.469) data 0.300 (0.338) loss_x loss_x 1.1650 (1.1561) acc_x 75.0000 (71.3194) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1448
confident_label rate tensor(0.4834, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1516
clean true:1514
clean false:2
clean_rate:0.9986807387862797
noisy true:174
noisy false:1446
after delete: len(clean_dataset) 1516
after delete: len(noisy_dataset) 1620
epoch [158/200] batch [5/47] time 0.463 (0.476) data 0.332 (0.345) loss_x loss_x 0.7808 (1.0278) acc_x 78.1250 (71.8750) lr 2.2949e-04 eta 0:00:20
epoch [158/200] batch [10/47] time 0.607 (0.489) data 0.476 (0.359) loss_x loss_x 1.3867 (0.9815) acc_x 68.7500 (73.1250) lr 2.2949e-04 eta 0:00:18
epoch [158/200] batch [15/47] time 0.539 (0.478) data 0.408 (0.347) loss_x loss_x 1.0332 (1.0037) acc_x 75.0000 (72.9167) lr 2.2949e-04 eta 0:00:15
epoch [158/200] batch [20/47] time 0.381 (0.475) data 0.250 (0.344) loss_x loss_x 1.4199 (1.0552) acc_x 62.5000 (71.0938) lr 2.2949e-04 eta 0:00:12
epoch [158/200] batch [25/47] time 0.382 (0.469) data 0.252 (0.338) loss_x loss_x 1.5918 (1.0900) acc_x 65.6250 (70.7500) lr 2.2949e-04 eta 0:00:10
epoch [158/200] batch [30/47] time 0.452 (0.467) data 0.321 (0.336) loss_x loss_x 1.0254 (1.0886) acc_x 78.1250 (71.1458) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [35/47] time 0.465 (0.462) data 0.335 (0.331) loss_x loss_x 1.0010 (1.0945) acc_x 75.0000 (70.9821) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [40/47] time 0.390 (0.458) data 0.259 (0.327) loss_x loss_x 1.4346 (1.1291) acc_x 59.3750 (70.3125) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [45/47] time 0.507 (0.457) data 0.377 (0.326) loss_x loss_x 1.0293 (1.1327) acc_x 71.8750 (70.3472) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1436
confident_label rate tensor(0.4927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1545
clean true:1544
clean false:1
clean_rate:0.9993527508090615
noisy true:156
noisy false:1435
after delete: len(clean_dataset) 1545
after delete: len(noisy_dataset) 1591
epoch [159/200] batch [5/48] time 0.468 (0.442) data 0.337 (0.311) loss_x loss_x 1.5430 (1.2685) acc_x 68.7500 (66.8750) lr 2.1957e-04 eta 0:00:18
epoch [159/200] batch [10/48] time 0.480 (0.456) data 0.349 (0.325) loss_x loss_x 0.9194 (1.1253) acc_x 78.1250 (71.5625) lr 2.1957e-04 eta 0:00:17
epoch [159/200] batch [15/48] time 0.430 (0.439) data 0.299 (0.308) loss_x loss_x 0.6997 (1.0870) acc_x 78.1250 (72.2917) lr 2.1957e-04 eta 0:00:14
epoch [159/200] batch [20/48] time 0.467 (0.446) data 0.336 (0.316) loss_x loss_x 1.0664 (1.1018) acc_x 78.1250 (72.0312) lr 2.1957e-04 eta 0:00:12
epoch [159/200] batch [25/48] time 0.550 (0.459) data 0.419 (0.328) loss_x loss_x 0.7451 (1.0628) acc_x 84.3750 (72.8750) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [30/48] time 0.392 (0.465) data 0.262 (0.334) loss_x loss_x 1.1650 (1.0701) acc_x 68.7500 (73.6458) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [35/48] time 0.420 (0.455) data 0.289 (0.324) loss_x loss_x 1.7148 (1.0821) acc_x 62.5000 (73.2143) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [40/48] time 0.447 (0.449) data 0.316 (0.318) loss_x loss_x 0.7842 (1.0935) acc_x 81.2500 (73.0469) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [45/48] time 0.528 (0.447) data 0.397 (0.317) loss_x loss_x 1.2061 (1.1140) acc_x 62.5000 (72.6389) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1436
confident_label rate tensor(0.4866, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1526
clean true:1525
clean false:1
clean_rate:0.9993446920052425
noisy true:175
noisy false:1435
after delete: len(clean_dataset) 1526
after delete: len(noisy_dataset) 1610
epoch [160/200] batch [5/47] time 0.423 (0.438) data 0.292 (0.307) loss_x loss_x 1.7441 (1.3473) acc_x 68.7500 (66.8750) lr 2.0984e-04 eta 0:00:18
epoch [160/200] batch [10/47] time 0.432 (0.449) data 0.301 (0.318) loss_x loss_x 1.0693 (1.3671) acc_x 75.0000 (65.6250) lr 2.0984e-04 eta 0:00:16
epoch [160/200] batch [15/47] time 0.439 (0.450) data 0.304 (0.319) loss_x loss_x 0.9951 (1.2840) acc_x 75.0000 (67.2917) lr 2.0984e-04 eta 0:00:14
epoch [160/200] batch [20/47] time 0.378 (0.457) data 0.247 (0.326) loss_x loss_x 0.9595 (1.2323) acc_x 75.0000 (68.9062) lr 2.0984e-04 eta 0:00:12
epoch [160/200] batch [25/47] time 0.342 (0.456) data 0.211 (0.325) loss_x loss_x 1.3652 (1.1949) acc_x 68.7500 (70.2500) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [30/47] time 0.527 (0.459) data 0.396 (0.328) loss_x loss_x 1.0859 (1.1594) acc_x 78.1250 (71.4583) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [35/47] time 0.388 (0.458) data 0.257 (0.326) loss_x loss_x 1.1416 (1.1730) acc_x 68.7500 (71.2500) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [40/47] time 0.572 (0.463) data 0.442 (0.332) loss_x loss_x 1.2920 (1.1703) acc_x 65.6250 (71.4062) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [45/47] time 0.429 (0.461) data 0.298 (0.330) loss_x loss_x 1.4316 (1.1848) acc_x 59.3750 (71.0417) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1425
confident_label rate tensor(0.4927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1545
clean true:1543
clean false:2
clean_rate:0.998705501618123
noisy true:168
noisy false:1423
after delete: len(clean_dataset) 1545
after delete: len(noisy_dataset) 1591
epoch [161/200] batch [5/48] time 0.495 (0.455) data 0.364 (0.324) loss_x loss_x 2.0723 (1.4900) acc_x 46.8750 (66.8750) lr 2.0032e-04 eta 0:00:19
epoch [161/200] batch [10/48] time 0.444 (0.458) data 0.314 (0.327) loss_x loss_x 0.7593 (1.2918) acc_x 71.8750 (69.0625) lr 2.0032e-04 eta 0:00:17
epoch [161/200] batch [15/48] time 0.622 (0.486) data 0.488 (0.355) loss_x loss_x 1.3291 (1.2710) acc_x 68.7500 (68.3333) lr 2.0032e-04 eta 0:00:16
epoch [161/200] batch [20/48] time 0.436 (0.480) data 0.305 (0.349) loss_x loss_x 0.7119 (1.2066) acc_x 84.3750 (69.6875) lr 2.0032e-04 eta 0:00:13
epoch [161/200] batch [25/48] time 0.366 (0.471) data 0.236 (0.340) loss_x loss_x 1.0684 (1.2250) acc_x 78.1250 (69.7500) lr 2.0032e-04 eta 0:00:10
epoch [161/200] batch [30/48] time 0.448 (0.465) data 0.318 (0.335) loss_x loss_x 1.1924 (1.2233) acc_x 75.0000 (69.4792) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [35/48] time 0.494 (0.462) data 0.363 (0.331) loss_x loss_x 1.3623 (1.2230) acc_x 59.3750 (69.5536) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [40/48] time 0.380 (0.454) data 0.249 (0.323) loss_x loss_x 0.7314 (1.1961) acc_x 78.1250 (70.1562) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [45/48] time 0.452 (0.454) data 0.321 (0.323) loss_x loss_x 0.9360 (1.1960) acc_x 71.8750 (70.0694) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1444
confident_label rate tensor(0.4850, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1521
clean true:1519
clean false:2
clean_rate:0.9986850756081526
noisy true:173
noisy false:1442
after delete: len(clean_dataset) 1521
after delete: len(noisy_dataset) 1615
epoch [162/200] batch [5/47] time 0.411 (0.437) data 0.280 (0.306) loss_x loss_x 1.3066 (0.9979) acc_x 65.6250 (72.5000) lr 1.9098e-04 eta 0:00:18
epoch [162/200] batch [10/47] time 0.356 (0.436) data 0.225 (0.305) loss_x loss_x 1.1201 (1.1256) acc_x 65.6250 (70.0000) lr 1.9098e-04 eta 0:00:16
epoch [162/200] batch [15/47] time 0.615 (0.471) data 0.484 (0.340) loss_x loss_x 0.8667 (1.0826) acc_x 78.1250 (71.0417) lr 1.9098e-04 eta 0:00:15
epoch [162/200] batch [20/47] time 0.355 (0.453) data 0.224 (0.322) loss_x loss_x 0.8037 (1.1499) acc_x 78.1250 (69.6875) lr 1.9098e-04 eta 0:00:12
epoch [162/200] batch [25/47] time 0.462 (0.446) data 0.332 (0.316) loss_x loss_x 1.1650 (1.1607) acc_x 75.0000 (69.6250) lr 1.9098e-04 eta 0:00:09
epoch [162/200] batch [30/47] time 0.363 (0.445) data 0.233 (0.315) loss_x loss_x 0.7085 (1.1547) acc_x 90.6250 (70.0000) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [35/47] time 0.410 (0.447) data 0.280 (0.316) loss_x loss_x 1.2588 (1.1421) acc_x 68.7500 (70.7143) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [40/47] time 0.412 (0.447) data 0.281 (0.316) loss_x loss_x 1.8809 (1.1800) acc_x 68.7500 (69.5312) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [45/47] time 0.349 (0.449) data 0.219 (0.319) loss_x loss_x 1.0303 (1.1660) acc_x 78.1250 (70.0694) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1445
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1512
clean true:1511
clean false:1
clean_rate:0.9993386243386243
noisy true:180
noisy false:1444
after delete: len(clean_dataset) 1512
after delete: len(noisy_dataset) 1624
epoch [163/200] batch [5/47] time 0.356 (0.427) data 0.225 (0.296) loss_x loss_x 0.9780 (1.0747) acc_x 75.0000 (73.1250) lr 1.8185e-04 eta 0:00:17
epoch [163/200] batch [10/47] time 0.389 (0.451) data 0.258 (0.320) loss_x loss_x 0.6484 (1.0037) acc_x 84.3750 (75.6250) lr 1.8185e-04 eta 0:00:16
epoch [163/200] batch [15/47] time 0.426 (0.454) data 0.295 (0.323) loss_x loss_x 1.0430 (1.0794) acc_x 71.8750 (72.5000) lr 1.8185e-04 eta 0:00:14
epoch [163/200] batch [20/47] time 0.495 (0.450) data 0.364 (0.319) loss_x loss_x 1.1748 (1.0888) acc_x 71.8750 (72.8125) lr 1.8185e-04 eta 0:00:12
epoch [163/200] batch [25/47] time 0.452 (0.446) data 0.321 (0.315) loss_x loss_x 1.0205 (1.1162) acc_x 65.6250 (71.7500) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [30/47] time 0.353 (0.449) data 0.222 (0.318) loss_x loss_x 1.2197 (1.1347) acc_x 65.6250 (71.2500) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [35/47] time 0.616 (0.456) data 0.486 (0.325) loss_x loss_x 1.3633 (1.1524) acc_x 62.5000 (70.8036) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [40/47] time 0.430 (0.459) data 0.299 (0.328) loss_x loss_x 1.0889 (1.1381) acc_x 68.7500 (71.4844) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [45/47] time 0.507 (0.461) data 0.376 (0.330) loss_x loss_x 0.7783 (1.1390) acc_x 84.3750 (71.4583) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1477
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1498
clean true:1497
clean false:1
clean_rate:0.9993324432576769
noisy true:162
noisy false:1476
after delete: len(clean_dataset) 1498
after delete: len(noisy_dataset) 1638
epoch [164/200] batch [5/46] time 0.417 (0.477) data 0.286 (0.346) loss_x loss_x 1.3174 (1.4117) acc_x 71.8750 (70.0000) lr 1.7292e-04 eta 0:00:19
epoch [164/200] batch [10/46] time 0.410 (0.447) data 0.279 (0.316) loss_x loss_x 1.8057 (1.2785) acc_x 59.3750 (70.3125) lr 1.7292e-04 eta 0:00:16
epoch [164/200] batch [15/46] time 0.495 (0.460) data 0.363 (0.329) loss_x loss_x 0.8564 (1.1862) acc_x 81.2500 (71.2500) lr 1.7292e-04 eta 0:00:14
epoch [164/200] batch [20/46] time 0.497 (0.466) data 0.366 (0.334) loss_x loss_x 1.9746 (1.2090) acc_x 53.1250 (70.7812) lr 1.7292e-04 eta 0:00:12
epoch [164/200] batch [25/46] time 0.626 (0.467) data 0.495 (0.336) loss_x loss_x 0.7861 (1.1967) acc_x 81.2500 (70.7500) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [30/46] time 0.668 (0.472) data 0.537 (0.341) loss_x loss_x 0.7358 (1.1765) acc_x 78.1250 (71.0417) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [35/46] time 0.479 (0.470) data 0.348 (0.339) loss_x loss_x 1.3252 (1.1722) acc_x 75.0000 (71.5179) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [40/46] time 0.398 (0.471) data 0.268 (0.340) loss_x loss_x 0.9512 (1.1590) acc_x 71.8750 (71.9531) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [45/46] time 0.497 (0.473) data 0.366 (0.342) loss_x loss_x 0.9375 (1.1438) acc_x 78.1250 (72.1528) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1447
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1504
clean true:1502
clean false:2
clean_rate:0.9986702127659575
noisy true:187
noisy false:1445
after delete: len(clean_dataset) 1504
after delete: len(noisy_dataset) 1632
epoch [165/200] batch [5/47] time 0.365 (0.453) data 0.233 (0.321) loss_x loss_x 1.4707 (1.0723) acc_x 62.5000 (71.2500) lr 1.6419e-04 eta 0:00:19
epoch [165/200] batch [10/47] time 0.613 (0.466) data 0.482 (0.334) loss_x loss_x 1.5801 (1.1072) acc_x 65.6250 (72.5000) lr 1.6419e-04 eta 0:00:17
epoch [165/200] batch [15/47] time 0.350 (0.451) data 0.219 (0.319) loss_x loss_x 1.1543 (1.0541) acc_x 75.0000 (72.7083) lr 1.6419e-04 eta 0:00:14
epoch [165/200] batch [20/47] time 0.432 (0.441) data 0.301 (0.310) loss_x loss_x 1.1367 (1.0895) acc_x 68.7500 (71.5625) lr 1.6419e-04 eta 0:00:11
epoch [165/200] batch [25/47] time 0.408 (0.443) data 0.278 (0.312) loss_x loss_x 0.9810 (1.0836) acc_x 75.0000 (72.5000) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [30/47] time 0.482 (0.447) data 0.351 (0.316) loss_x loss_x 1.3271 (1.0975) acc_x 75.0000 (71.8750) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [35/47] time 0.557 (0.458) data 0.426 (0.327) loss_x loss_x 0.8794 (1.1114) acc_x 78.1250 (71.9643) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [40/47] time 0.567 (0.458) data 0.436 (0.327) loss_x loss_x 1.3799 (1.1267) acc_x 59.3750 (71.1719) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [45/47] time 0.422 (0.459) data 0.290 (0.328) loss_x loss_x 0.5786 (1.1111) acc_x 90.6250 (72.0833) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1442
confident_label rate tensor(0.4866, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1526
clean true:1525
clean false:1
clean_rate:0.9993446920052425
noisy true:169
noisy false:1441
after delete: len(clean_dataset) 1526
after delete: len(noisy_dataset) 1610
epoch [166/200] batch [5/47] time 0.405 (0.419) data 0.274 (0.288) loss_x loss_x 1.3574 (1.1550) acc_x 68.7500 (73.1250) lr 1.5567e-04 eta 0:00:17
epoch [166/200] batch [10/47] time 0.437 (0.450) data 0.306 (0.319) loss_x loss_x 1.3135 (1.1000) acc_x 62.5000 (75.6250) lr 1.5567e-04 eta 0:00:16
epoch [166/200] batch [15/47] time 0.395 (0.446) data 0.264 (0.315) loss_x loss_x 1.1172 (1.0933) acc_x 68.7500 (75.2083) lr 1.5567e-04 eta 0:00:14
epoch [166/200] batch [20/47] time 0.350 (0.459) data 0.219 (0.328) loss_x loss_x 1.2236 (1.1124) acc_x 62.5000 (74.0625) lr 1.5567e-04 eta 0:00:12
epoch [166/200] batch [25/47] time 0.526 (0.454) data 0.395 (0.323) loss_x loss_x 1.1055 (1.1153) acc_x 75.0000 (74.7500) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [30/47] time 0.495 (0.454) data 0.363 (0.323) loss_x loss_x 1.3643 (1.1403) acc_x 62.5000 (73.4375) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [35/47] time 0.389 (0.458) data 0.258 (0.326) loss_x loss_x 1.3271 (1.1472) acc_x 65.6250 (72.9464) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [40/47] time 0.508 (0.457) data 0.377 (0.326) loss_x loss_x 1.2314 (1.1576) acc_x 59.3750 (72.4219) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [45/47] time 0.429 (0.458) data 0.298 (0.327) loss_x loss_x 1.1328 (1.1552) acc_x 65.6250 (72.2222) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1468
confident_label rate tensor(0.4799, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1505
clean true:1502
clean false:3
clean_rate:0.9980066445182725
noisy true:166
noisy false:1465
after delete: len(clean_dataset) 1505
after delete: len(noisy_dataset) 1631
epoch [167/200] batch [5/47] time 0.357 (0.412) data 0.226 (0.281) loss_x loss_x 1.2988 (1.1478) acc_x 71.8750 (71.8750) lr 1.4736e-04 eta 0:00:17
epoch [167/200] batch [10/47] time 0.531 (0.443) data 0.400 (0.312) loss_x loss_x 1.2139 (1.1747) acc_x 75.0000 (71.2500) lr 1.4736e-04 eta 0:00:16
epoch [167/200] batch [15/47] time 0.482 (0.453) data 0.352 (0.323) loss_x loss_x 1.2852 (1.1472) acc_x 68.7500 (71.2500) lr 1.4736e-04 eta 0:00:14
epoch [167/200] batch [20/47] time 0.600 (0.462) data 0.469 (0.331) loss_x loss_x 1.3574 (1.1649) acc_x 65.6250 (70.9375) lr 1.4736e-04 eta 0:00:12
epoch [167/200] batch [25/47] time 0.396 (0.455) data 0.265 (0.324) loss_x loss_x 0.9727 (1.1557) acc_x 62.5000 (70.6250) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [30/47] time 0.478 (0.457) data 0.347 (0.326) loss_x loss_x 1.2588 (1.1537) acc_x 75.0000 (71.1458) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [35/47] time 0.419 (0.457) data 0.288 (0.326) loss_x loss_x 0.8716 (1.1294) acc_x 78.1250 (72.4107) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [40/47] time 0.426 (0.458) data 0.295 (0.327) loss_x loss_x 0.9453 (1.1255) acc_x 78.1250 (72.4219) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [45/47] time 0.556 (0.462) data 0.425 (0.332) loss_x loss_x 0.8403 (1.1137) acc_x 84.3750 (72.8472) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1447
confident_label rate tensor(0.4841, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1518
clean true:1516
clean false:2
clean_rate:0.9986824769433466
noisy true:173
noisy false:1445
after delete: len(clean_dataset) 1518
after delete: len(noisy_dataset) 1618
epoch [168/200] batch [5/47] time 0.446 (0.476) data 0.314 (0.344) loss_x loss_x 0.8887 (1.2109) acc_x 87.5000 (71.2500) lr 1.3926e-04 eta 0:00:19
epoch [168/200] batch [10/47] time 0.543 (0.486) data 0.412 (0.354) loss_x loss_x 1.0703 (1.2779) acc_x 71.8750 (68.7500) lr 1.3926e-04 eta 0:00:17
epoch [168/200] batch [15/47] time 0.519 (0.499) data 0.388 (0.368) loss_x loss_x 1.2119 (1.1880) acc_x 71.8750 (71.0417) lr 1.3926e-04 eta 0:00:15
epoch [168/200] batch [20/47] time 0.444 (0.502) data 0.313 (0.371) loss_x loss_x 0.7544 (1.0954) acc_x 81.2500 (73.4375) lr 1.3926e-04 eta 0:00:13
epoch [168/200] batch [25/47] time 0.393 (0.497) data 0.262 (0.366) loss_x loss_x 1.5186 (1.1584) acc_x 59.3750 (71.8750) lr 1.3926e-04 eta 0:00:10
epoch [168/200] batch [30/47] time 0.373 (0.489) data 0.243 (0.357) loss_x loss_x 0.9209 (1.1823) acc_x 78.1250 (71.3542) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [35/47] time 0.417 (0.484) data 0.286 (0.353) loss_x loss_x 1.1631 (1.1660) acc_x 62.5000 (71.1607) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [40/47] time 0.472 (0.480) data 0.341 (0.349) loss_x loss_x 1.0449 (1.1529) acc_x 68.7500 (70.7031) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [45/47] time 0.399 (0.475) data 0.268 (0.344) loss_x loss_x 1.5312 (1.1610) acc_x 62.5000 (70.4167) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1403
confident_label rate tensor(0.4978, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1561
clean true:1558
clean false:3
clean_rate:0.9980781550288277
noisy true:175
noisy false:1400
after delete: len(clean_dataset) 1561
after delete: len(noisy_dataset) 1575
epoch [169/200] batch [5/48] time 0.490 (0.493) data 0.359 (0.362) loss_x loss_x 1.9580 (1.2545) acc_x 65.6250 (73.1250) lr 1.3137e-04 eta 0:00:21
epoch [169/200] batch [10/48] time 0.474 (0.471) data 0.343 (0.340) loss_x loss_x 0.9214 (1.2209) acc_x 75.0000 (70.6250) lr 1.3137e-04 eta 0:00:17
epoch [169/200] batch [15/48] time 0.654 (0.477) data 0.523 (0.346) loss_x loss_x 1.1787 (1.2136) acc_x 68.7500 (70.4167) lr 1.3137e-04 eta 0:00:15
epoch [169/200] batch [20/48] time 0.564 (0.471) data 0.433 (0.340) loss_x loss_x 1.0293 (1.1801) acc_x 68.7500 (70.4688) lr 1.3137e-04 eta 0:00:13
epoch [169/200] batch [25/48] time 0.448 (0.459) data 0.317 (0.328) loss_x loss_x 1.2256 (1.2227) acc_x 56.2500 (67.7500) lr 1.3137e-04 eta 0:00:10
epoch [169/200] batch [30/48] time 0.374 (0.456) data 0.243 (0.325) loss_x loss_x 1.1143 (1.1966) acc_x 71.8750 (68.5417) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [35/48] time 0.383 (0.448) data 0.252 (0.317) loss_x loss_x 1.1035 (1.1887) acc_x 71.8750 (69.2857) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [40/48] time 0.496 (0.449) data 0.365 (0.318) loss_x loss_x 0.9463 (1.1844) acc_x 71.8750 (69.4531) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [45/48] time 0.420 (0.453) data 0.289 (0.322) loss_x loss_x 1.2236 (1.1824) acc_x 62.5000 (69.3750) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1450
confident_label rate tensor(0.4837, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1517
clean true:1515
clean false:2
clean_rate:0.998681608437706
noisy true:171
noisy false:1448
after delete: len(clean_dataset) 1517
after delete: len(noisy_dataset) 1619
epoch [170/200] batch [5/47] time 0.440 (0.437) data 0.309 (0.306) loss_x loss_x 1.5322 (1.1305) acc_x 62.5000 (70.0000) lr 1.2369e-04 eta 0:00:18
epoch [170/200] batch [10/47] time 0.387 (0.428) data 0.256 (0.297) loss_x loss_x 0.8701 (1.0348) acc_x 78.1250 (73.7500) lr 1.2369e-04 eta 0:00:15
epoch [170/200] batch [15/47] time 0.447 (0.451) data 0.316 (0.320) loss_x loss_x 0.8223 (1.0242) acc_x 81.2500 (73.1250) lr 1.2369e-04 eta 0:00:14
epoch [170/200] batch [20/47] time 0.647 (0.452) data 0.516 (0.321) loss_x loss_x 1.0322 (1.0611) acc_x 81.2500 (73.5938) lr 1.2369e-04 eta 0:00:12
epoch [170/200] batch [25/47] time 0.416 (0.456) data 0.284 (0.325) loss_x loss_x 0.9253 (1.0852) acc_x 81.2500 (73.0000) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [30/47] time 0.508 (0.457) data 0.377 (0.326) loss_x loss_x 1.5889 (1.1139) acc_x 59.3750 (72.7083) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [35/47] time 0.379 (0.456) data 0.248 (0.325) loss_x loss_x 1.5674 (1.1236) acc_x 65.6250 (72.1429) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [40/47] time 0.510 (0.456) data 0.379 (0.325) loss_x loss_x 1.5654 (1.1184) acc_x 65.6250 (72.1094) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [45/47] time 0.353 (0.452) data 0.222 (0.321) loss_x loss_x 1.0000 (1.1151) acc_x 75.0000 (72.0833) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1433
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1520
clean true:1520
clean false:0
clean_rate:1.0
noisy true:183
noisy false:1433
after delete: len(clean_dataset) 1520
after delete: len(noisy_dataset) 1616
epoch [171/200] batch [5/47] time 0.377 (0.464) data 0.246 (0.333) loss_x loss_x 1.9932 (1.4005) acc_x 46.8750 (66.2500) lr 1.1623e-04 eta 0:00:19
epoch [171/200] batch [10/47] time 0.563 (0.457) data 0.432 (0.326) loss_x loss_x 1.0693 (1.2337) acc_x 78.1250 (69.3750) lr 1.1623e-04 eta 0:00:16
epoch [171/200] batch [15/47] time 0.537 (0.472) data 0.406 (0.341) loss_x loss_x 0.9292 (1.2052) acc_x 81.2500 (71.2500) lr 1.1623e-04 eta 0:00:15
epoch [171/200] batch [20/47] time 0.404 (0.462) data 0.273 (0.331) loss_x loss_x 1.0186 (1.1979) acc_x 75.0000 (70.6250) lr 1.1623e-04 eta 0:00:12
epoch [171/200] batch [25/47] time 0.477 (0.461) data 0.347 (0.330) loss_x loss_x 1.1201 (1.1831) acc_x 65.6250 (71.1250) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [30/47] time 0.498 (0.457) data 0.367 (0.326) loss_x loss_x 1.4512 (1.2277) acc_x 68.7500 (69.8958) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [35/47] time 0.384 (0.455) data 0.253 (0.324) loss_x loss_x 1.2812 (1.2098) acc_x 56.2500 (70.0000) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [40/47] time 0.472 (0.449) data 0.341 (0.318) loss_x loss_x 0.8784 (1.1947) acc_x 78.1250 (70.5469) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [45/47] time 0.703 (0.455) data 0.572 (0.324) loss_x loss_x 0.6396 (1.1707) acc_x 93.7500 (71.1111) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1459
confident_label rate tensor(0.4805, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1507
clean true:1504
clean false:3
clean_rate:0.9980092899800929
noisy true:173
noisy false:1456
after delete: len(clean_dataset) 1507
after delete: len(noisy_dataset) 1629
epoch [172/200] batch [5/47] time 0.401 (0.461) data 0.270 (0.330) loss_x loss_x 1.3633 (1.0293) acc_x 59.3750 (73.1250) lr 1.0899e-04 eta 0:00:19
epoch [172/200] batch [10/47] time 0.493 (0.450) data 0.362 (0.319) loss_x loss_x 1.2451 (1.1052) acc_x 56.2500 (70.9375) lr 1.0899e-04 eta 0:00:16
epoch [172/200] batch [15/47] time 0.555 (0.453) data 0.424 (0.322) loss_x loss_x 1.0801 (1.0847) acc_x 68.7500 (71.2500) lr 1.0899e-04 eta 0:00:14
epoch [172/200] batch [20/47] time 0.411 (0.448) data 0.280 (0.318) loss_x loss_x 1.3506 (1.0817) acc_x 71.8750 (71.5625) lr 1.0899e-04 eta 0:00:12
epoch [172/200] batch [25/47] time 0.433 (0.449) data 0.302 (0.318) loss_x loss_x 0.9370 (1.0942) acc_x 75.0000 (71.2500) lr 1.0899e-04 eta 0:00:09
epoch [172/200] batch [30/47] time 0.408 (0.453) data 0.277 (0.322) loss_x loss_x 0.6489 (1.0822) acc_x 75.0000 (71.4583) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [35/47] time 0.465 (0.453) data 0.333 (0.322) loss_x loss_x 1.2998 (1.1207) acc_x 62.5000 (71.2500) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [40/47] time 0.408 (0.454) data 0.278 (0.323) loss_x loss_x 1.4561 (1.1339) acc_x 71.8750 (71.1719) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [45/47] time 0.467 (0.453) data 0.336 (0.322) loss_x loss_x 0.4954 (1.1261) acc_x 90.6250 (71.5972) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1434
confident_label rate tensor(0.4904, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1538
clean true:1535
clean false:3
clean_rate:0.9980494148244473
noisy true:167
noisy false:1431
after delete: len(clean_dataset) 1538
after delete: len(noisy_dataset) 1598
epoch [173/200] batch [5/48] time 0.398 (0.461) data 0.267 (0.330) loss_x loss_x 0.5957 (1.0954) acc_x 81.2500 (73.7500) lr 1.0197e-04 eta 0:00:19
epoch [173/200] batch [10/48] time 0.401 (0.453) data 0.270 (0.322) loss_x loss_x 1.0117 (1.3106) acc_x 78.1250 (67.1875) lr 1.0197e-04 eta 0:00:17
epoch [173/200] batch [15/48] time 0.457 (0.456) data 0.326 (0.325) loss_x loss_x 0.9526 (1.2216) acc_x 81.2500 (70.4167) lr 1.0197e-04 eta 0:00:15
epoch [173/200] batch [20/48] time 0.434 (0.453) data 0.303 (0.321) loss_x loss_x 1.3115 (1.1954) acc_x 71.8750 (71.5625) lr 1.0197e-04 eta 0:00:12
epoch [173/200] batch [25/48] time 0.376 (0.454) data 0.245 (0.323) loss_x loss_x 1.3125 (1.1876) acc_x 71.8750 (71.6250) lr 1.0197e-04 eta 0:00:10
epoch [173/200] batch [30/48] time 0.431 (0.455) data 0.300 (0.324) loss_x loss_x 0.7417 (1.1685) acc_x 87.5000 (71.6667) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [35/48] time 0.373 (0.455) data 0.242 (0.324) loss_x loss_x 0.6738 (1.1235) acc_x 78.1250 (72.4107) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [40/48] time 0.420 (0.460) data 0.289 (0.329) loss_x loss_x 1.2607 (1.1282) acc_x 71.8750 (72.8906) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [45/48] time 0.388 (0.456) data 0.257 (0.325) loss_x loss_x 1.6709 (1.1318) acc_x 59.3750 (72.8472) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1452
confident_label rate tensor(0.4850, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1521
clean true:1519
clean false:2
clean_rate:0.9986850756081526
noisy true:165
noisy false:1450
after delete: len(clean_dataset) 1521
after delete: len(noisy_dataset) 1615
epoch [174/200] batch [5/47] time 0.399 (0.473) data 0.268 (0.342) loss_x loss_x 1.3906 (1.1244) acc_x 65.6250 (70.0000) lr 9.5173e-05 eta 0:00:19
epoch [174/200] batch [10/47] time 0.520 (0.449) data 0.389 (0.318) loss_x loss_x 0.9287 (1.1527) acc_x 78.1250 (70.6250) lr 9.5173e-05 eta 0:00:16
epoch [174/200] batch [15/47] time 0.446 (0.454) data 0.316 (0.323) loss_x loss_x 1.3506 (1.1761) acc_x 62.5000 (69.7917) lr 9.5173e-05 eta 0:00:14
epoch [174/200] batch [20/47] time 0.507 (0.454) data 0.377 (0.323) loss_x loss_x 0.9067 (1.1630) acc_x 81.2500 (70.9375) lr 9.5173e-05 eta 0:00:12
epoch [174/200] batch [25/47] time 0.525 (0.444) data 0.395 (0.313) loss_x loss_x 1.2080 (1.1782) acc_x 71.8750 (70.1250) lr 9.5173e-05 eta 0:00:09
epoch [174/200] batch [30/47] time 0.397 (0.443) data 0.266 (0.312) loss_x loss_x 1.3955 (1.1927) acc_x 59.3750 (69.3750) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [35/47] time 0.460 (0.448) data 0.329 (0.317) loss_x loss_x 1.3057 (1.1712) acc_x 62.5000 (69.9107) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [40/47] time 0.631 (0.455) data 0.501 (0.324) loss_x loss_x 0.9614 (1.1413) acc_x 68.7500 (70.6250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [45/47] time 0.520 (0.455) data 0.389 (0.324) loss_x loss_x 0.9912 (1.1396) acc_x 68.7500 (70.3472) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1455
confident_label rate tensor(0.4793, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1503
clean true:1499
clean false:4
clean_rate:0.9973386560212908
noisy true:182
noisy false:1451
after delete: len(clean_dataset) 1503
after delete: len(noisy_dataset) 1633
epoch [175/200] batch [5/46] time 0.373 (0.420) data 0.242 (0.289) loss_x loss_x 1.1797 (1.1521) acc_x 71.8750 (70.6250) lr 8.8597e-05 eta 0:00:17
epoch [175/200] batch [10/46] time 0.442 (0.425) data 0.311 (0.294) loss_x loss_x 0.8521 (1.2820) acc_x 81.2500 (68.1250) lr 8.8597e-05 eta 0:00:15
epoch [175/200] batch [15/46] time 0.531 (0.443) data 0.400 (0.312) loss_x loss_x 0.6543 (1.1731) acc_x 84.3750 (71.2500) lr 8.8597e-05 eta 0:00:13
epoch [175/200] batch [20/46] time 0.361 (0.443) data 0.230 (0.312) loss_x loss_x 1.4062 (1.1309) acc_x 62.5000 (72.5000) lr 8.8597e-05 eta 0:00:11
epoch [175/200] batch [25/46] time 0.513 (0.448) data 0.382 (0.317) loss_x loss_x 2.0352 (1.1427) acc_x 59.3750 (71.5000) lr 8.8597e-05 eta 0:00:09
epoch [175/200] batch [30/46] time 0.353 (0.444) data 0.222 (0.313) loss_x loss_x 0.6240 (1.1117) acc_x 90.6250 (72.1875) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [35/46] time 0.423 (0.448) data 0.292 (0.317) loss_x loss_x 1.5166 (1.1412) acc_x 78.1250 (72.3214) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [40/46] time 0.338 (0.445) data 0.207 (0.314) loss_x loss_x 1.0957 (1.1768) acc_x 78.1250 (71.7969) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [45/46] time 0.409 (0.447) data 0.278 (0.316) loss_x loss_x 1.2852 (1.1695) acc_x 78.1250 (72.3611) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1466
confident_label rate tensor(0.4815, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1510
clean true:1508
clean false:2
clean_rate:0.9986754966887417
noisy true:162
noisy false:1464
after delete: len(clean_dataset) 1510
after delete: len(noisy_dataset) 1626
epoch [176/200] batch [5/47] time 0.411 (0.474) data 0.281 (0.343) loss_x loss_x 1.7725 (1.2443) acc_x 59.3750 (69.3750) lr 8.2245e-05 eta 0:00:19
epoch [176/200] batch [10/47] time 0.398 (0.466) data 0.267 (0.335) loss_x loss_x 1.0879 (1.2221) acc_x 71.8750 (69.3750) lr 8.2245e-05 eta 0:00:17
epoch [176/200] batch [15/47] time 0.489 (0.451) data 0.358 (0.320) loss_x loss_x 0.7510 (1.1867) acc_x 81.2500 (71.0417) lr 8.2245e-05 eta 0:00:14
epoch [176/200] batch [20/47] time 0.534 (0.456) data 0.403 (0.325) loss_x loss_x 0.8589 (1.1293) acc_x 78.1250 (72.3438) lr 8.2245e-05 eta 0:00:12
epoch [176/200] batch [25/47] time 0.421 (0.455) data 0.290 (0.324) loss_x loss_x 0.7163 (1.0879) acc_x 78.1250 (72.2500) lr 8.2245e-05 eta 0:00:10
epoch [176/200] batch [30/47] time 0.442 (0.459) data 0.311 (0.328) loss_x loss_x 1.1533 (1.0795) acc_x 75.0000 (72.7083) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [35/47] time 0.631 (0.457) data 0.500 (0.326) loss_x loss_x 1.0947 (1.1106) acc_x 78.1250 (72.4107) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [40/47] time 0.467 (0.456) data 0.336 (0.325) loss_x loss_x 1.5215 (1.1124) acc_x 68.7500 (72.5000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [45/47] time 0.372 (0.453) data 0.241 (0.322) loss_x loss_x 1.1191 (1.1209) acc_x 75.0000 (72.5000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1436
confident_label rate tensor(0.4866, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1526
clean true:1524
clean false:2
clean_rate:0.9986893840104849
noisy true:176
noisy false:1434
after delete: len(clean_dataset) 1526
after delete: len(noisy_dataset) 1610
epoch [177/200] batch [5/47] time 0.411 (0.478) data 0.281 (0.347) loss_x loss_x 0.9424 (1.2857) acc_x 78.1250 (68.1250) lr 7.6120e-05 eta 0:00:20
epoch [177/200] batch [10/47] time 0.400 (0.470) data 0.269 (0.339) loss_x loss_x 1.3838 (1.2031) acc_x 62.5000 (70.0000) lr 7.6120e-05 eta 0:00:17
epoch [177/200] batch [15/47] time 0.457 (0.450) data 0.326 (0.319) loss_x loss_x 1.1172 (1.2223) acc_x 65.6250 (70.6250) lr 7.6120e-05 eta 0:00:14
epoch [177/200] batch [20/47] time 0.466 (0.446) data 0.335 (0.315) loss_x loss_x 0.8682 (1.2014) acc_x 75.0000 (70.9375) lr 7.6120e-05 eta 0:00:12
epoch [177/200] batch [25/47] time 0.492 (0.448) data 0.361 (0.317) loss_x loss_x 1.0391 (1.1391) acc_x 71.8750 (71.7500) lr 7.6120e-05 eta 0:00:09
epoch [177/200] batch [30/47] time 0.564 (0.448) data 0.433 (0.317) loss_x loss_x 1.2188 (1.1158) acc_x 62.5000 (72.0833) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [35/47] time 0.589 (0.452) data 0.459 (0.321) loss_x loss_x 0.8501 (1.1170) acc_x 78.1250 (71.6964) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [40/47] time 0.361 (0.446) data 0.230 (0.316) loss_x loss_x 1.2188 (1.0990) acc_x 68.7500 (72.1875) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [45/47] time 0.610 (0.452) data 0.479 (0.321) loss_x loss_x 1.1143 (1.0928) acc_x 59.3750 (72.0139) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1454
confident_label rate tensor(0.4815, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1510
clean true:1509
clean false:1
clean_rate:0.9993377483443708
noisy true:173
noisy false:1453
after delete: len(clean_dataset) 1510
after delete: len(noisy_dataset) 1626
epoch [178/200] batch [5/47] time 0.363 (0.461) data 0.232 (0.330) loss_x loss_x 0.8574 (1.3281) acc_x 75.0000 (65.6250) lr 7.0224e-05 eta 0:00:19
epoch [178/200] batch [10/47] time 0.396 (0.443) data 0.265 (0.312) loss_x loss_x 1.0059 (1.2613) acc_x 75.0000 (67.1875) lr 7.0224e-05 eta 0:00:16
epoch [178/200] batch [15/47] time 0.451 (0.438) data 0.320 (0.307) loss_x loss_x 1.0752 (1.1908) acc_x 81.2500 (70.6250) lr 7.0224e-05 eta 0:00:14
epoch [178/200] batch [20/47] time 0.575 (0.445) data 0.445 (0.315) loss_x loss_x 1.9277 (1.2636) acc_x 56.2500 (69.3750) lr 7.0224e-05 eta 0:00:12
epoch [178/200] batch [25/47] time 0.456 (0.442) data 0.325 (0.311) loss_x loss_x 1.0283 (1.2175) acc_x 68.7500 (70.2500) lr 7.0224e-05 eta 0:00:09
epoch [178/200] batch [30/47] time 0.398 (0.445) data 0.267 (0.314) loss_x loss_x 1.5225 (1.2059) acc_x 59.3750 (70.2083) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [35/47] time 0.444 (0.452) data 0.313 (0.321) loss_x loss_x 1.5762 (1.2113) acc_x 71.8750 (70.0893) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [40/47] time 0.415 (0.452) data 0.285 (0.321) loss_x loss_x 0.8716 (1.1881) acc_x 78.1250 (70.3906) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [45/47] time 0.529 (0.453) data 0.398 (0.322) loss_x loss_x 1.0928 (1.1910) acc_x 71.8750 (70.6944) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1468
confident_label rate tensor(0.4828, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1514
clean true:1512
clean false:2
clean_rate:0.9986789960369881
noisy true:156
noisy false:1466
after delete: len(clean_dataset) 1514
after delete: len(noisy_dataset) 1622
epoch [179/200] batch [5/47] time 0.448 (0.480) data 0.318 (0.349) loss_x loss_x 0.7681 (1.1286) acc_x 87.5000 (71.2500) lr 6.4556e-05 eta 0:00:20
epoch [179/200] batch [10/47] time 0.437 (0.473) data 0.306 (0.342) loss_x loss_x 0.9067 (1.0543) acc_x 71.8750 (71.5625) lr 6.4556e-05 eta 0:00:17
epoch [179/200] batch [15/47] time 0.383 (0.463) data 0.252 (0.332) loss_x loss_x 1.3096 (1.0931) acc_x 65.6250 (71.0417) lr 6.4556e-05 eta 0:00:14
epoch [179/200] batch [20/47] time 0.624 (0.463) data 0.493 (0.332) loss_x loss_x 0.6553 (1.0678) acc_x 84.3750 (71.8750) lr 6.4556e-05 eta 0:00:12
epoch [179/200] batch [25/47] time 0.438 (0.458) data 0.307 (0.327) loss_x loss_x 1.3457 (1.0855) acc_x 71.8750 (71.6250) lr 6.4556e-05 eta 0:00:10
epoch [179/200] batch [30/47] time 0.428 (0.454) data 0.297 (0.323) loss_x loss_x 0.9067 (1.0849) acc_x 71.8750 (71.8750) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [35/47] time 0.485 (0.458) data 0.354 (0.327) loss_x loss_x 1.0117 (1.0819) acc_x 62.5000 (71.5179) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [40/47] time 0.372 (0.455) data 0.241 (0.324) loss_x loss_x 1.0449 (1.0866) acc_x 68.7500 (71.3281) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [45/47] time 0.569 (0.457) data 0.438 (0.326) loss_x loss_x 0.8477 (1.1029) acc_x 81.2500 (71.0417) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1413
confident_label rate tensor(0.4923, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1544
clean true:1543
clean false:1
clean_rate:0.9993523316062176
noisy true:180
noisy false:1412
after delete: len(clean_dataset) 1544
after delete: len(noisy_dataset) 1592
epoch [180/200] batch [5/48] time 0.405 (0.441) data 0.274 (0.310) loss_x loss_x 1.0137 (1.0478) acc_x 68.7500 (73.1250) lr 5.9119e-05 eta 0:00:18
epoch [180/200] batch [10/48] time 0.431 (0.456) data 0.300 (0.325) loss_x loss_x 1.4961 (1.0500) acc_x 53.1250 (72.8125) lr 5.9119e-05 eta 0:00:17
epoch [180/200] batch [15/48] time 0.414 (0.450) data 0.283 (0.318) loss_x loss_x 1.3350 (1.0570) acc_x 71.8750 (73.5417) lr 5.9119e-05 eta 0:00:14
epoch [180/200] batch [20/48] time 0.409 (0.439) data 0.278 (0.308) loss_x loss_x 1.3916 (1.1037) acc_x 78.1250 (73.4375) lr 5.9119e-05 eta 0:00:12
epoch [180/200] batch [25/48] time 0.409 (0.449) data 0.278 (0.318) loss_x loss_x 1.5537 (1.1234) acc_x 56.2500 (72.3750) lr 5.9119e-05 eta 0:00:10
epoch [180/200] batch [30/48] time 0.481 (0.450) data 0.350 (0.318) loss_x loss_x 1.1250 (1.1733) acc_x 71.8750 (70.9375) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [35/48] time 0.457 (0.447) data 0.326 (0.316) loss_x loss_x 1.4160 (1.1753) acc_x 68.7500 (71.0714) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [40/48] time 0.496 (0.447) data 0.364 (0.316) loss_x loss_x 0.5205 (1.1744) acc_x 81.2500 (71.0938) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [45/48] time 0.300 (0.446) data 0.169 (0.315) loss_x loss_x 1.5762 (1.1830) acc_x 56.2500 (70.9722) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1411
confident_label rate tensor(0.4917, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1542
clean true:1539
clean false:3
clean_rate:0.9980544747081712
noisy true:186
noisy false:1408
after delete: len(clean_dataset) 1542
after delete: len(noisy_dataset) 1594
epoch [181/200] batch [5/48] time 0.469 (0.479) data 0.338 (0.349) loss_x loss_x 0.8169 (1.1676) acc_x 75.0000 (75.0000) lr 5.3915e-05 eta 0:00:20
epoch [181/200] batch [10/48] time 0.474 (0.484) data 0.343 (0.353) loss_x loss_x 1.2129 (1.1256) acc_x 65.6250 (73.1250) lr 5.3915e-05 eta 0:00:18
epoch [181/200] batch [15/48] time 0.565 (0.471) data 0.433 (0.340) loss_x loss_x 0.9907 (1.1649) acc_x 75.0000 (72.2917) lr 5.3915e-05 eta 0:00:15
epoch [181/200] batch [20/48] time 0.399 (0.464) data 0.269 (0.334) loss_x loss_x 1.5371 (1.1883) acc_x 68.7500 (71.2500) lr 5.3915e-05 eta 0:00:13
epoch [181/200] batch [25/48] time 0.587 (0.468) data 0.455 (0.337) loss_x loss_x 0.9551 (1.1239) acc_x 78.1250 (72.5000) lr 5.3915e-05 eta 0:00:10
epoch [181/200] batch [30/48] time 0.442 (0.457) data 0.310 (0.326) loss_x loss_x 1.0684 (1.1306) acc_x 71.8750 (72.3958) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [35/48] time 0.421 (0.460) data 0.290 (0.330) loss_x loss_x 1.3271 (1.1776) acc_x 71.8750 (71.4286) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [40/48] time 0.425 (0.463) data 0.294 (0.332) loss_x loss_x 1.1582 (1.1571) acc_x 71.8750 (72.2656) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [45/48] time 0.492 (0.459) data 0.361 (0.328) loss_x loss_x 0.9790 (1.1496) acc_x 71.8750 (71.9444) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1458
confident_label rate tensor(0.4799, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1505
clean true:1503
clean false:2
clean_rate:0.998671096345515
noisy true:175
noisy false:1456
after delete: len(clean_dataset) 1505
after delete: len(noisy_dataset) 1631
epoch [182/200] batch [5/47] time 0.526 (0.460) data 0.395 (0.329) loss_x loss_x 1.3203 (1.1778) acc_x 71.8750 (70.6250) lr 4.8943e-05 eta 0:00:19
epoch [182/200] batch [10/47] time 0.466 (0.466) data 0.335 (0.335) loss_x loss_x 1.6836 (1.2864) acc_x 56.2500 (65.9375) lr 4.8943e-05 eta 0:00:17
epoch [182/200] batch [15/47] time 0.496 (0.455) data 0.365 (0.324) loss_x loss_x 0.9937 (1.1729) acc_x 78.1250 (70.4167) lr 4.8943e-05 eta 0:00:14
epoch [182/200] batch [20/47] time 0.638 (0.463) data 0.507 (0.332) loss_x loss_x 1.0068 (1.1272) acc_x 75.0000 (71.7188) lr 4.8943e-05 eta 0:00:12
epoch [182/200] batch [25/47] time 0.458 (0.465) data 0.327 (0.334) loss_x loss_x 0.5801 (1.0782) acc_x 87.5000 (72.6250) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [30/47] time 0.679 (0.468) data 0.548 (0.337) loss_x loss_x 1.0205 (1.0711) acc_x 65.6250 (72.6042) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [35/47] time 0.476 (0.466) data 0.345 (0.335) loss_x loss_x 1.1240 (1.0878) acc_x 62.5000 (71.7857) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [40/47] time 0.433 (0.464) data 0.302 (0.333) loss_x loss_x 1.5322 (1.1094) acc_x 59.3750 (71.3281) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [45/47] time 0.452 (0.465) data 0.322 (0.334) loss_x loss_x 0.9941 (1.1185) acc_x 71.8750 (71.0417) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1469
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1498
clean true:1498
clean false:0
clean_rate:1.0
noisy true:169
noisy false:1469
after delete: len(clean_dataset) 1498
after delete: len(noisy_dataset) 1638
epoch [183/200] batch [5/46] time 0.521 (0.503) data 0.390 (0.372) loss_x loss_x 1.1729 (1.1917) acc_x 75.0000 (71.2500) lr 4.4207e-05 eta 0:00:20
epoch [183/200] batch [10/46] time 0.600 (0.483) data 0.468 (0.352) loss_x loss_x 1.2705 (1.1250) acc_x 68.7500 (73.7500) lr 4.4207e-05 eta 0:00:17
epoch [183/200] batch [15/46] time 0.434 (0.479) data 0.303 (0.348) loss_x loss_x 1.3633 (1.1772) acc_x 65.6250 (71.8750) lr 4.4207e-05 eta 0:00:14
epoch [183/200] batch [20/46] time 0.436 (0.464) data 0.305 (0.333) loss_x loss_x 1.5801 (1.2392) acc_x 59.3750 (69.5312) lr 4.4207e-05 eta 0:00:12
epoch [183/200] batch [25/46] time 0.392 (0.456) data 0.261 (0.325) loss_x loss_x 1.1748 (1.1975) acc_x 71.8750 (69.3750) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [30/46] time 0.362 (0.456) data 0.232 (0.325) loss_x loss_x 0.9941 (1.1893) acc_x 68.7500 (69.5833) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [35/46] time 0.585 (0.455) data 0.454 (0.324) loss_x loss_x 1.0117 (1.1642) acc_x 81.2500 (70.3571) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [40/46] time 0.412 (0.456) data 0.281 (0.325) loss_x loss_x 0.6113 (1.1191) acc_x 84.3750 (71.4062) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [45/46] time 0.325 (0.455) data 0.194 (0.324) loss_x loss_x 0.8799 (1.1164) acc_x 81.2500 (71.5972) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1416
confident_label rate tensor(0.4978, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1561
clean true:1558
clean false:3
clean_rate:0.9980781550288277
noisy true:162
noisy false:1413
after delete: len(clean_dataset) 1561
after delete: len(noisy_dataset) 1575
epoch [184/200] batch [5/48] time 0.392 (0.456) data 0.261 (0.325) loss_x loss_x 1.0264 (1.1715) acc_x 75.0000 (71.2500) lr 3.9706e-05 eta 0:00:19
epoch [184/200] batch [10/48] time 0.380 (0.455) data 0.249 (0.323) loss_x loss_x 0.8105 (1.1715) acc_x 78.1250 (72.5000) lr 3.9706e-05 eta 0:00:17
epoch [184/200] batch [15/48] time 0.513 (0.461) data 0.382 (0.330) loss_x loss_x 1.1377 (1.1444) acc_x 68.7500 (72.0833) lr 3.9706e-05 eta 0:00:15
epoch [184/200] batch [20/48] time 0.452 (0.451) data 0.320 (0.320) loss_x loss_x 0.9390 (1.1427) acc_x 78.1250 (71.4062) lr 3.9706e-05 eta 0:00:12
epoch [184/200] batch [25/48] time 0.403 (0.438) data 0.272 (0.306) loss_x loss_x 1.2002 (1.1345) acc_x 68.7500 (71.6250) lr 3.9706e-05 eta 0:00:10
epoch [184/200] batch [30/48] time 0.387 (0.439) data 0.256 (0.308) loss_x loss_x 0.9116 (1.1105) acc_x 71.8750 (71.9792) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [35/48] time 0.573 (0.447) data 0.442 (0.316) loss_x loss_x 0.4990 (1.0776) acc_x 84.3750 (72.8571) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [40/48] time 0.514 (0.450) data 0.383 (0.319) loss_x loss_x 1.2314 (1.0833) acc_x 65.6250 (72.6562) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [45/48] time 0.487 (0.449) data 0.356 (0.318) loss_x loss_x 0.6396 (1.0585) acc_x 84.3750 (73.2639) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1493
confident_label rate tensor(0.4761, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1493
clean true:1492
clean false:1
clean_rate:0.999330207635633
noisy true:151
noisy false:1492
after delete: len(clean_dataset) 1493
after delete: len(noisy_dataset) 1643
epoch [185/200] batch [5/46] time 0.479 (0.460) data 0.350 (0.330) loss_x loss_x 1.7402 (1.2641) acc_x 53.1250 (68.7500) lr 3.5443e-05 eta 0:00:18
epoch [185/200] batch [10/46] time 0.516 (0.491) data 0.382 (0.360) loss_x loss_x 0.8950 (1.2032) acc_x 81.2500 (71.5625) lr 3.5443e-05 eta 0:00:17
epoch [185/200] batch [15/46] time 0.450 (0.482) data 0.320 (0.351) loss_x loss_x 1.4287 (1.1991) acc_x 56.2500 (70.8333) lr 3.5443e-05 eta 0:00:14
epoch [185/200] batch [20/46] time 0.543 (0.475) data 0.412 (0.345) loss_x loss_x 1.3340 (1.1433) acc_x 65.6250 (72.1875) lr 3.5443e-05 eta 0:00:12
epoch [185/200] batch [25/46] time 0.487 (0.477) data 0.356 (0.347) loss_x loss_x 0.8394 (1.1184) acc_x 71.8750 (72.3750) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [30/46] time 0.391 (0.482) data 0.259 (0.351) loss_x loss_x 1.0879 (1.1305) acc_x 78.1250 (71.6667) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [35/46] time 0.414 (0.486) data 0.283 (0.355) loss_x loss_x 1.2969 (1.1362) acc_x 68.7500 (71.6071) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [40/46] time 0.388 (0.480) data 0.257 (0.349) loss_x loss_x 1.3438 (1.1228) acc_x 68.7500 (71.8750) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [45/46] time 0.438 (0.474) data 0.308 (0.343) loss_x loss_x 0.7974 (1.1296) acc_x 71.8750 (71.3889) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1423
confident_label rate tensor(0.4876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1529
clean true:1529
clean false:0
clean_rate:1.0
noisy true:184
noisy false:1423
after delete: len(clean_dataset) 1529
after delete: len(noisy_dataset) 1607
epoch [186/200] batch [5/47] time 0.442 (0.439) data 0.311 (0.308) loss_x loss_x 1.0781 (1.1210) acc_x 68.7500 (74.3750) lr 3.1417e-05 eta 0:00:18
epoch [186/200] batch [10/47] time 0.488 (0.457) data 0.355 (0.325) loss_x loss_x 1.2539 (1.1941) acc_x 68.7500 (71.2500) lr 3.1417e-05 eta 0:00:16
epoch [186/200] batch [15/47] time 0.457 (0.454) data 0.326 (0.323) loss_x loss_x 1.4492 (1.2706) acc_x 65.6250 (69.3750) lr 3.1417e-05 eta 0:00:14
epoch [186/200] batch [20/47] time 0.388 (0.447) data 0.257 (0.316) loss_x loss_x 0.9775 (1.2102) acc_x 75.0000 (70.3125) lr 3.1417e-05 eta 0:00:12
epoch [186/200] batch [25/47] time 0.426 (0.449) data 0.295 (0.318) loss_x loss_x 0.8911 (1.1792) acc_x 75.0000 (71.3750) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [30/47] time 0.587 (0.457) data 0.456 (0.326) loss_x loss_x 1.0645 (1.1691) acc_x 71.8750 (71.8750) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [35/47] time 0.563 (0.454) data 0.433 (0.322) loss_x loss_x 0.7402 (1.1566) acc_x 81.2500 (72.0536) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [40/47] time 0.527 (0.457) data 0.396 (0.326) loss_x loss_x 1.0723 (1.1427) acc_x 75.0000 (72.6562) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [45/47] time 0.410 (0.452) data 0.279 (0.321) loss_x loss_x 1.0205 (1.1515) acc_x 68.7500 (72.1528) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1451
confident_label rate tensor(0.4809, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1508
clean true:1504
clean false:4
clean_rate:0.9973474801061007
noisy true:181
noisy false:1447
after delete: len(clean_dataset) 1508
after delete: len(noisy_dataset) 1628
epoch [187/200] batch [5/47] time 0.507 (0.448) data 0.376 (0.317) loss_x loss_x 1.1475 (1.0344) acc_x 62.5000 (70.6250) lr 2.7630e-05 eta 0:00:18
epoch [187/200] batch [10/47] time 0.522 (0.443) data 0.391 (0.312) loss_x loss_x 0.8804 (1.0468) acc_x 78.1250 (71.5625) lr 2.7630e-05 eta 0:00:16
epoch [187/200] batch [15/47] time 0.517 (0.462) data 0.386 (0.331) loss_x loss_x 0.9883 (1.0403) acc_x 78.1250 (72.0833) lr 2.7630e-05 eta 0:00:14
epoch [187/200] batch [20/47] time 0.355 (0.449) data 0.224 (0.318) loss_x loss_x 0.9702 (1.0490) acc_x 78.1250 (72.0312) lr 2.7630e-05 eta 0:00:12
epoch [187/200] batch [25/47] time 0.436 (0.445) data 0.306 (0.314) loss_x loss_x 1.6641 (1.0940) acc_x 65.6250 (71.2500) lr 2.7630e-05 eta 0:00:09
epoch [187/200] batch [30/47] time 0.372 (0.444) data 0.241 (0.313) loss_x loss_x 1.1543 (1.0983) acc_x 59.3750 (71.3542) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [35/47] time 0.729 (0.453) data 0.599 (0.322) loss_x loss_x 1.4482 (1.0887) acc_x 71.8750 (72.1429) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [40/47] time 0.458 (0.454) data 0.327 (0.323) loss_x loss_x 0.8462 (1.0877) acc_x 78.1250 (72.4219) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [45/47] time 0.465 (0.449) data 0.334 (0.318) loss_x loss_x 1.5449 (1.1129) acc_x 71.8750 (72.1528) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1446
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1515
clean true:1514
clean false:1
clean_rate:0.9993399339933994
noisy true:176
noisy false:1445
after delete: len(clean_dataset) 1515
after delete: len(noisy_dataset) 1621
epoch [188/200] batch [5/47] time 0.467 (0.456) data 0.336 (0.325) loss_x loss_x 1.4453 (1.0268) acc_x 75.0000 (75.0000) lr 2.4083e-05 eta 0:00:19
epoch [188/200] batch [10/47] time 0.592 (0.464) data 0.461 (0.333) loss_x loss_x 0.5269 (1.0971) acc_x 84.3750 (72.5000) lr 2.4083e-05 eta 0:00:17
epoch [188/200] batch [15/47] time 0.424 (0.453) data 0.293 (0.322) loss_x loss_x 1.0508 (1.0803) acc_x 78.1250 (73.3333) lr 2.4083e-05 eta 0:00:14
epoch [188/200] batch [20/47] time 0.422 (0.451) data 0.291 (0.321) loss_x loss_x 1.0312 (1.0770) acc_x 78.1250 (73.7500) lr 2.4083e-05 eta 0:00:12
epoch [188/200] batch [25/47] time 0.529 (0.445) data 0.398 (0.314) loss_x loss_x 0.8149 (1.1091) acc_x 78.1250 (73.3750) lr 2.4083e-05 eta 0:00:09
epoch [188/200] batch [30/47] time 0.406 (0.440) data 0.276 (0.309) loss_x loss_x 1.0879 (1.0692) acc_x 75.0000 (74.6875) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [35/47] time 0.403 (0.434) data 0.272 (0.303) loss_x loss_x 0.9795 (1.0408) acc_x 75.0000 (75.0893) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [40/47] time 0.475 (0.438) data 0.343 (0.307) loss_x loss_x 1.4316 (1.0735) acc_x 68.7500 (74.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [45/47] time 0.375 (0.439) data 0.244 (0.308) loss_x loss_x 1.2607 (1.0979) acc_x 65.6250 (73.5417) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1421
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1543
clean true:1540
clean false:3
clean_rate:0.9980557355800389
noisy true:175
noisy false:1418
after delete: len(clean_dataset) 1543
after delete: len(noisy_dataset) 1593
epoch [189/200] batch [5/48] time 0.458 (0.412) data 0.327 (0.281) loss_x loss_x 1.5840 (1.1989) acc_x 56.2500 (68.7500) lr 2.0777e-05 eta 0:00:17
epoch [189/200] batch [10/48] time 0.575 (0.423) data 0.444 (0.292) loss_x loss_x 0.8794 (1.1166) acc_x 68.7500 (71.5625) lr 2.0777e-05 eta 0:00:16
epoch [189/200] batch [15/48] time 0.375 (0.444) data 0.245 (0.313) loss_x loss_x 1.0137 (1.1271) acc_x 75.0000 (71.2500) lr 2.0777e-05 eta 0:00:14
epoch [189/200] batch [20/48] time 0.560 (0.444) data 0.429 (0.313) loss_x loss_x 1.5820 (1.1722) acc_x 59.3750 (71.0938) lr 2.0777e-05 eta 0:00:12
epoch [189/200] batch [25/48] time 0.436 (0.448) data 0.306 (0.317) loss_x loss_x 0.9351 (1.1966) acc_x 78.1250 (70.2500) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [30/48] time 0.418 (0.449) data 0.287 (0.318) loss_x loss_x 0.7705 (1.1369) acc_x 81.2500 (71.4583) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [35/48] time 0.472 (0.445) data 0.341 (0.314) loss_x loss_x 1.5010 (1.1604) acc_x 62.5000 (70.4464) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [40/48] time 0.467 (0.449) data 0.336 (0.318) loss_x loss_x 0.8345 (1.1458) acc_x 84.3750 (71.1719) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [45/48] time 0.434 (0.446) data 0.303 (0.315) loss_x loss_x 1.1729 (1.1288) acc_x 62.5000 (71.5972) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1495
confident_label rate tensor(0.4726, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1482
clean true:1479
clean false:3
clean_rate:0.9979757085020243
noisy true:162
noisy false:1492
after delete: len(clean_dataset) 1482
after delete: len(noisy_dataset) 1654
epoch [190/200] batch [5/46] time 0.508 (0.439) data 0.377 (0.308) loss_x loss_x 0.7153 (1.1390) acc_x 84.3750 (73.1250) lr 1.7713e-05 eta 0:00:18
epoch [190/200] batch [10/46] time 0.515 (0.457) data 0.384 (0.326) loss_x loss_x 0.9287 (1.1817) acc_x 75.0000 (70.3125) lr 1.7713e-05 eta 0:00:16
epoch [190/200] batch [15/46] time 0.482 (0.453) data 0.351 (0.322) loss_x loss_x 1.2090 (1.1604) acc_x 65.6250 (70.6250) lr 1.7713e-05 eta 0:00:14
epoch [190/200] batch [20/46] time 0.520 (0.455) data 0.390 (0.324) loss_x loss_x 1.4023 (1.1408) acc_x 68.7500 (71.4062) lr 1.7713e-05 eta 0:00:11
epoch [190/200] batch [25/46] time 0.442 (0.456) data 0.311 (0.325) loss_x loss_x 1.0078 (1.1547) acc_x 78.1250 (71.2500) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [30/46] time 0.425 (0.456) data 0.294 (0.325) loss_x loss_x 1.5244 (1.1308) acc_x 65.6250 (71.8750) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [35/46] time 0.452 (0.458) data 0.321 (0.327) loss_x loss_x 0.9287 (1.1370) acc_x 75.0000 (71.6071) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [40/46] time 0.450 (0.456) data 0.319 (0.325) loss_x loss_x 1.2031 (1.1255) acc_x 75.0000 (71.8750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [45/46] time 0.534 (0.454) data 0.403 (0.323) loss_x loss_x 0.9448 (1.1379) acc_x 71.8750 (72.0139) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1497
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1468
clean true:1468
clean false:0
clean_rate:1.0
noisy true:171
noisy false:1497
after delete: len(clean_dataset) 1468
after delete: len(noisy_dataset) 1668
epoch [191/200] batch [5/45] time 0.410 (0.433) data 0.278 (0.302) loss_x loss_x 1.0469 (1.0150) acc_x 68.7500 (73.1250) lr 1.4891e-05 eta 0:00:17
epoch [191/200] batch [10/45] time 0.403 (0.437) data 0.273 (0.306) loss_x loss_x 1.2881 (1.1089) acc_x 75.0000 (70.9375) lr 1.4891e-05 eta 0:00:15
epoch [191/200] batch [15/45] time 0.387 (0.438) data 0.256 (0.307) loss_x loss_x 0.9673 (1.1123) acc_x 81.2500 (71.0417) lr 1.4891e-05 eta 0:00:13
epoch [191/200] batch [20/45] time 0.379 (0.443) data 0.248 (0.312) loss_x loss_x 0.9561 (1.1369) acc_x 78.1250 (71.2500) lr 1.4891e-05 eta 0:00:11
epoch [191/200] batch [25/45] time 0.440 (0.438) data 0.309 (0.307) loss_x loss_x 1.0078 (1.1375) acc_x 78.1250 (71.6250) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [30/45] time 0.642 (0.444) data 0.511 (0.313) loss_x loss_x 1.3252 (1.1480) acc_x 65.6250 (71.3542) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [35/45] time 0.509 (0.445) data 0.378 (0.314) loss_x loss_x 1.0176 (1.1434) acc_x 75.0000 (71.5179) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [40/45] time 0.416 (0.446) data 0.285 (0.315) loss_x loss_x 1.6133 (1.1577) acc_x 62.5000 (70.8594) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [45/45] time 0.329 (0.445) data 0.199 (0.314) loss_x loss_x 0.9399 (1.1588) acc_x 71.8750 (70.7639) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1473
confident_label rate tensor(0.4774, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1497
clean true:1496
clean false:1
clean_rate:0.9993319973279893
noisy true:167
noisy false:1472
after delete: len(clean_dataset) 1497
after delete: len(noisy_dataset) 1639
epoch [192/200] batch [5/46] time 0.465 (0.486) data 0.334 (0.355) loss_x loss_x 1.3037 (1.1798) acc_x 62.5000 (70.6250) lr 1.2312e-05 eta 0:00:19
epoch [192/200] batch [10/46] time 0.487 (0.481) data 0.356 (0.350) loss_x loss_x 1.1035 (1.1000) acc_x 78.1250 (72.8125) lr 1.2312e-05 eta 0:00:17
epoch [192/200] batch [15/46] time 0.321 (0.450) data 0.190 (0.319) loss_x loss_x 1.1084 (1.0903) acc_x 71.8750 (72.9167) lr 1.2312e-05 eta 0:00:13
epoch [192/200] batch [20/46] time 0.382 (0.445) data 0.251 (0.314) loss_x loss_x 1.0342 (1.0829) acc_x 81.2500 (73.7500) lr 1.2312e-05 eta 0:00:11
epoch [192/200] batch [25/46] time 0.401 (0.446) data 0.270 (0.315) loss_x loss_x 1.4248 (1.1249) acc_x 65.6250 (72.7500) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [30/46] time 0.433 (0.448) data 0.303 (0.317) loss_x loss_x 0.9858 (1.1190) acc_x 78.1250 (72.6042) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [35/46] time 0.478 (0.451) data 0.347 (0.320) loss_x loss_x 1.0820 (1.1084) acc_x 75.0000 (72.8571) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [40/46] time 0.436 (0.448) data 0.305 (0.317) loss_x loss_x 1.1777 (1.1212) acc_x 65.6250 (72.4219) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [45/46] time 0.380 (0.446) data 0.249 (0.315) loss_x loss_x 1.0918 (1.1101) acc_x 78.1250 (72.7778) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1477
confident_label rate tensor(0.4770, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1496
clean true:1491
clean false:5
clean_rate:0.9966577540106952
noisy true:168
noisy false:1472
after delete: len(clean_dataset) 1496
after delete: len(noisy_dataset) 1640
epoch [193/200] batch [5/46] time 0.364 (0.471) data 0.233 (0.340) loss_x loss_x 1.0059 (1.1811) acc_x 78.1250 (70.6250) lr 9.9763e-06 eta 0:00:19
epoch [193/200] batch [10/46] time 0.454 (0.461) data 0.323 (0.330) loss_x loss_x 1.2432 (1.1350) acc_x 71.8750 (72.5000) lr 9.9763e-06 eta 0:00:16
epoch [193/200] batch [15/46] time 0.494 (0.462) data 0.363 (0.331) loss_x loss_x 1.4844 (1.2324) acc_x 62.5000 (67.9167) lr 9.9763e-06 eta 0:00:14
epoch [193/200] batch [20/46] time 0.591 (0.462) data 0.460 (0.331) loss_x loss_x 1.2715 (1.2045) acc_x 71.8750 (69.0625) lr 9.9763e-06 eta 0:00:12
epoch [193/200] batch [25/46] time 0.441 (0.460) data 0.310 (0.329) loss_x loss_x 1.1738 (1.1589) acc_x 68.7500 (70.2500) lr 9.9763e-06 eta 0:00:09
epoch [193/200] batch [30/46] time 0.487 (0.463) data 0.356 (0.332) loss_x loss_x 0.8774 (1.1020) acc_x 75.0000 (71.9792) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [35/46] time 0.516 (0.462) data 0.385 (0.331) loss_x loss_x 0.9644 (1.0962) acc_x 78.1250 (72.4107) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [40/46] time 0.512 (0.458) data 0.381 (0.327) loss_x loss_x 1.1123 (1.1068) acc_x 68.7500 (72.0312) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [45/46] time 0.604 (0.462) data 0.473 (0.331) loss_x loss_x 1.5146 (1.1308) acc_x 71.8750 (71.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1426
confident_label rate tensor(0.4895, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1535
clean true:1532
clean false:3
clean_rate:0.9980456026058632
noisy true:178
noisy false:1423
after delete: len(clean_dataset) 1535
after delete: len(noisy_dataset) 1601
epoch [194/200] batch [5/47] time 0.500 (0.451) data 0.369 (0.320) loss_x loss_x 1.4121 (1.1023) acc_x 62.5000 (70.6250) lr 7.8853e-06 eta 0:00:18
epoch [194/200] batch [10/47] time 0.529 (0.445) data 0.397 (0.315) loss_x loss_x 0.8843 (1.1320) acc_x 78.1250 (70.9375) lr 7.8853e-06 eta 0:00:16
epoch [194/200] batch [15/47] time 0.482 (0.452) data 0.352 (0.321) loss_x loss_x 1.0479 (1.1550) acc_x 78.1250 (71.4583) lr 7.8853e-06 eta 0:00:14
epoch [194/200] batch [20/47] time 0.423 (0.455) data 0.293 (0.324) loss_x loss_x 1.2842 (1.1287) acc_x 68.7500 (72.6562) lr 7.8853e-06 eta 0:00:12
epoch [194/200] batch [25/47] time 0.442 (0.450) data 0.312 (0.320) loss_x loss_x 0.7178 (1.0819) acc_x 87.5000 (73.8750) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [30/47] time 0.393 (0.445) data 0.263 (0.315) loss_x loss_x 0.5352 (1.0424) acc_x 81.2500 (74.4792) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [35/47] time 0.400 (0.440) data 0.270 (0.309) loss_x loss_x 1.2266 (1.0794) acc_x 78.1250 (73.4821) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [40/47] time 0.495 (0.440) data 0.365 (0.309) loss_x loss_x 1.0381 (1.1085) acc_x 68.7500 (72.4219) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [45/47] time 0.453 (0.439) data 0.322 (0.309) loss_x loss_x 1.2451 (1.1014) acc_x 59.3750 (72.1528) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1434
confident_label rate tensor(0.4908, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1539
clean true:1536
clean false:3
clean_rate:0.9980506822612085
noisy true:166
noisy false:1431
after delete: len(clean_dataset) 1539
after delete: len(noisy_dataset) 1597
epoch [195/200] batch [5/48] time 0.469 (0.433) data 0.338 (0.302) loss_x loss_x 1.1084 (1.0033) acc_x 71.8750 (74.3750) lr 6.0390e-06 eta 0:00:18
epoch [195/200] batch [10/48] time 0.493 (0.422) data 0.363 (0.291) loss_x loss_x 1.1035 (1.1141) acc_x 71.8750 (71.8750) lr 6.0390e-06 eta 0:00:16
epoch [195/200] batch [15/48] time 0.461 (0.422) data 0.331 (0.291) loss_x loss_x 1.0830 (1.0718) acc_x 75.0000 (73.1250) lr 6.0390e-06 eta 0:00:13
epoch [195/200] batch [20/48] time 0.445 (0.434) data 0.315 (0.304) loss_x loss_x 1.1914 (1.0803) acc_x 75.0000 (72.9688) lr 6.0390e-06 eta 0:00:12
epoch [195/200] batch [25/48] time 0.452 (0.433) data 0.321 (0.302) loss_x loss_x 1.5088 (1.0573) acc_x 56.2500 (73.0000) lr 6.0390e-06 eta 0:00:09
epoch [195/200] batch [30/48] time 0.561 (0.437) data 0.431 (0.306) loss_x loss_x 1.0430 (1.0849) acc_x 75.0000 (73.1250) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [35/48] time 0.362 (0.433) data 0.231 (0.303) loss_x loss_x 0.9805 (1.0964) acc_x 78.1250 (72.4107) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [40/48] time 0.489 (0.437) data 0.358 (0.307) loss_x loss_x 0.8535 (1.1007) acc_x 78.1250 (72.3438) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [45/48] time 0.420 (0.436) data 0.289 (0.305) loss_x loss_x 1.1797 (1.1059) acc_x 62.5000 (72.3611) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1452
confident_label rate tensor(0.4831, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1515
clean true:1513
clean false:2
clean_rate:0.9986798679867986
noisy true:171
noisy false:1450
after delete: len(clean_dataset) 1515
after delete: len(noisy_dataset) 1621
epoch [196/200] batch [5/47] time 0.465 (0.447) data 0.334 (0.316) loss_x loss_x 1.3936 (1.0480) acc_x 75.0000 (74.3750) lr 4.4380e-06 eta 0:00:18
epoch [196/200] batch [10/47] time 0.401 (0.444) data 0.270 (0.313) loss_x loss_x 1.0811 (1.0744) acc_x 78.1250 (74.6875) lr 4.4380e-06 eta 0:00:16
epoch [196/200] batch [15/47] time 0.490 (0.444) data 0.359 (0.313) loss_x loss_x 0.6797 (1.0933) acc_x 81.2500 (73.7500) lr 4.4380e-06 eta 0:00:14
epoch [196/200] batch [20/47] time 0.434 (0.435) data 0.303 (0.304) loss_x loss_x 0.9639 (1.1055) acc_x 71.8750 (72.9688) lr 4.4380e-06 eta 0:00:11
epoch [196/200] batch [25/47] time 0.516 (0.452) data 0.385 (0.321) loss_x loss_x 0.9302 (1.1142) acc_x 75.0000 (72.5000) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [30/47] time 0.378 (0.450) data 0.247 (0.319) loss_x loss_x 1.0215 (1.1053) acc_x 78.1250 (73.1250) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [35/47] time 0.376 (0.448) data 0.245 (0.318) loss_x loss_x 0.9775 (1.0868) acc_x 71.8750 (73.3036) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [40/47] time 0.387 (0.452) data 0.256 (0.322) loss_x loss_x 1.2061 (1.0754) acc_x 65.6250 (73.6719) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [45/47] time 0.619 (0.457) data 0.488 (0.326) loss_x loss_x 0.6377 (1.0708) acc_x 81.2500 (73.4028) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1398
confident_label rate tensor(0.4990, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1565
clean true:1564
clean false:1
clean_rate:0.9993610223642172
noisy true:174
noisy false:1397
after delete: len(clean_dataset) 1565
after delete: len(noisy_dataset) 1571
epoch [197/200] batch [5/48] time 0.404 (0.485) data 0.273 (0.353) loss_x loss_x 1.2734 (0.9894) acc_x 75.0000 (76.8750) lr 3.0827e-06 eta 0:00:20
epoch [197/200] batch [10/48] time 0.499 (0.453) data 0.368 (0.321) loss_x loss_x 0.8794 (1.0810) acc_x 81.2500 (74.0625) lr 3.0827e-06 eta 0:00:17
epoch [197/200] batch [15/48] time 0.431 (0.436) data 0.300 (0.305) loss_x loss_x 1.1338 (1.0925) acc_x 68.7500 (73.3333) lr 3.0827e-06 eta 0:00:14
epoch [197/200] batch [20/48] time 0.523 (0.451) data 0.392 (0.319) loss_x loss_x 1.1621 (1.1103) acc_x 65.6250 (72.1875) lr 3.0827e-06 eta 0:00:12
epoch [197/200] batch [25/48] time 0.500 (0.452) data 0.368 (0.320) loss_x loss_x 1.3037 (1.1451) acc_x 68.7500 (71.5000) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [30/48] time 0.437 (0.457) data 0.306 (0.326) loss_x loss_x 1.0137 (1.1461) acc_x 81.2500 (72.3958) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [35/48] time 0.397 (0.452) data 0.266 (0.321) loss_x loss_x 1.0967 (1.1323) acc_x 71.8750 (72.2321) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [40/48] time 0.526 (0.454) data 0.395 (0.323) loss_x loss_x 0.8032 (1.1115) acc_x 68.7500 (72.1094) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [45/48] time 0.359 (0.454) data 0.229 (0.323) loss_x loss_x 1.5449 (1.1395) acc_x 59.3750 (71.4583) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1448
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1520
clean true:1518
clean false:2
clean_rate:0.9986842105263158
noisy true:170
noisy false:1446
after delete: len(clean_dataset) 1520
after delete: len(noisy_dataset) 1616
epoch [198/200] batch [5/47] time 0.503 (0.476) data 0.372 (0.345) loss_x loss_x 0.9160 (1.1729) acc_x 75.0000 (70.0000) lr 1.9733e-06 eta 0:00:19
epoch [198/200] batch [10/47] time 0.366 (0.460) data 0.235 (0.329) loss_x loss_x 1.1406 (1.1340) acc_x 75.0000 (72.5000) lr 1.9733e-06 eta 0:00:17
epoch [198/200] batch [15/47] time 0.685 (0.462) data 0.555 (0.331) loss_x loss_x 1.1484 (1.1377) acc_x 62.5000 (71.8750) lr 1.9733e-06 eta 0:00:14
epoch [198/200] batch [20/47] time 0.403 (0.460) data 0.273 (0.329) loss_x loss_x 1.1602 (1.1309) acc_x 84.3750 (71.8750) lr 1.9733e-06 eta 0:00:12
epoch [198/200] batch [25/47] time 0.428 (0.452) data 0.297 (0.321) loss_x loss_x 1.3555 (1.1375) acc_x 65.6250 (71.7500) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [30/47] time 0.401 (0.443) data 0.270 (0.312) loss_x loss_x 1.3564 (1.1570) acc_x 71.8750 (71.6667) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [35/47] time 0.484 (0.442) data 0.353 (0.311) loss_x loss_x 0.9678 (1.1769) acc_x 71.8750 (71.3393) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [40/47] time 0.381 (0.446) data 0.250 (0.315) loss_x loss_x 0.8267 (1.1686) acc_x 78.1250 (71.2500) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [45/47] time 0.380 (0.444) data 0.249 (0.313) loss_x loss_x 1.3154 (1.1851) acc_x 65.6250 (70.7639) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1467
confident_label rate tensor(0.4786, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1501
clean true:1501
clean false:0
clean_rate:1.0
noisy true:168
noisy false:1467
after delete: len(clean_dataset) 1501
after delete: len(noisy_dataset) 1635
epoch [199/200] batch [5/46] time 0.483 (0.434) data 0.352 (0.303) loss_x loss_x 0.7334 (0.9146) acc_x 81.2500 (75.6250) lr 1.1101e-06 eta 0:00:17
epoch [199/200] batch [10/46] time 0.479 (0.430) data 0.349 (0.300) loss_x loss_x 0.8286 (1.1097) acc_x 84.3750 (73.7500) lr 1.1101e-06 eta 0:00:15
epoch [199/200] batch [15/46] time 0.487 (0.425) data 0.356 (0.294) loss_x loss_x 1.0625 (1.1529) acc_x 71.8750 (71.6667) lr 1.1101e-06 eta 0:00:13
epoch [199/200] batch [20/46] time 0.607 (0.436) data 0.476 (0.305) loss_x loss_x 1.4834 (1.1799) acc_x 65.6250 (70.4688) lr 1.1101e-06 eta 0:00:11
epoch [199/200] batch [25/46] time 0.391 (0.449) data 0.261 (0.319) loss_x loss_x 0.5718 (1.1497) acc_x 90.6250 (70.8750) lr 1.1101e-06 eta 0:00:09
epoch [199/200] batch [30/46] time 0.546 (0.453) data 0.415 (0.322) loss_x loss_x 0.8350 (1.1571) acc_x 81.2500 (70.5208) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [35/46] time 0.456 (0.450) data 0.325 (0.319) loss_x loss_x 1.3770 (1.1556) acc_x 62.5000 (70.5357) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [40/46] time 0.479 (0.455) data 0.348 (0.324) loss_x loss_x 1.1719 (1.1624) acc_x 71.8750 (70.7812) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [45/46] time 0.505 (0.453) data 0.374 (0.323) loss_x loss_x 1.4160 (1.1701) acc_x 65.6250 (70.4167) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1401
confident_label rate tensor(0.4974, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1560
clean true:1555
clean false:5
clean_rate:0.9967948717948718
noisy true:180
noisy false:1396
after delete: len(clean_dataset) 1560
after delete: len(noisy_dataset) 1576
epoch [200/200] batch [5/48] time 0.363 (0.453) data 0.232 (0.322) loss_x loss_x 1.2285 (1.1922) acc_x 68.7500 (71.2500) lr 4.9344e-07 eta 0:00:19
epoch [200/200] batch [10/48] time 0.463 (0.466) data 0.332 (0.335) loss_x loss_x 1.6680 (1.2047) acc_x 62.5000 (69.6875) lr 4.9344e-07 eta 0:00:17
epoch [200/200] batch [15/48] time 0.402 (0.446) data 0.271 (0.315) loss_x loss_x 0.9160 (1.1122) acc_x 81.2500 (72.0833) lr 4.9344e-07 eta 0:00:14
epoch [200/200] batch [20/48] time 0.497 (0.451) data 0.366 (0.320) loss_x loss_x 1.1025 (1.1265) acc_x 78.1250 (71.7188) lr 4.9344e-07 eta 0:00:12
epoch [200/200] batch [25/48] time 0.420 (0.440) data 0.289 (0.309) loss_x loss_x 0.6240 (1.1261) acc_x 75.0000 (71.0000) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [30/48] time 0.514 (0.443) data 0.383 (0.312) loss_x loss_x 0.9624 (1.1066) acc_x 71.8750 (71.5625) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [35/48] time 0.458 (0.445) data 0.328 (0.314) loss_x loss_x 1.2002 (1.1246) acc_x 71.8750 (70.9821) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [40/48] time 0.402 (0.439) data 0.271 (0.309) loss_x loss_x 1.1855 (1.1095) acc_x 75.0000 (71.3281) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [45/48] time 0.445 (0.439) data 0.314 (0.308) loss_x loss_x 1.7842 (1.1146) acc_x 65.6250 (71.5278) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,365
* accuracy: 66.7%
* error: 33.3%
* macro_f1: 65.2%
Elapsed: 3:33:29
