***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1110, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 348
clean true:297
clean false:51
clean_rate:0.853448275862069
noisy true:268
noisy false:2520
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 2788
epoch [1/200] batch [5/10] time 0.461 (0.509) data 0.331 (0.361) loss_x loss_x 3.0117 (2.9035) acc_x 43.7500 (40.0000) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [10/10] time 0.425 (0.486) data 0.294 (0.347) loss_x loss_x 2.3906 (2.7975) acc_x 53.1250 (41.5625) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2395
confident_label rate tensor(0.1352, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 424
clean true:379
clean false:45
clean_rate:0.8938679245283019
noisy true:362
noisy false:2350
after delete: len(clean_dataset) 424
after delete: len(noisy_dataset) 2712
epoch [2/200] batch [5/13] time 0.598 (0.524) data 0.464 (0.393) loss_x loss_x 2.7480 (2.2471) acc_x 37.5000 (49.3750) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/13] time 0.493 (0.565) data 0.363 (0.434) loss_x loss_x 1.7686 (2.0438) acc_x 40.6250 (47.8125) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2003
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:602
clean false:53
clean_rate:0.9190839694656489
noisy true:531
noisy false:1950
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [3/200] batch [5/20] time 0.679 (0.490) data 0.548 (0.359) loss_x loss_x 1.6260 (1.7582) acc_x 59.3750 (55.0000) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [10/20] time 0.467 (0.487) data 0.337 (0.357) loss_x loss_x 1.6191 (1.6816) acc_x 50.0000 (54.0625) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/20] time 0.516 (0.478) data 0.385 (0.347) loss_x loss_x 1.5693 (1.7005) acc_x 56.2500 (54.5833) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/20] time 0.559 (0.484) data 0.428 (0.353) loss_x loss_x 2.0371 (1.7383) acc_x 43.7500 (53.4375) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1929
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 690
clean true:631
clean false:59
clean_rate:0.9144927536231884
noisy true:576
noisy false:1870
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 2446
epoch [4/200] batch [5/21] time 0.451 (0.459) data 0.320 (0.329) loss_x loss_x 1.4150 (1.7078) acc_x 75.0000 (58.7500) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [10/21] time 0.538 (0.462) data 0.408 (0.331) loss_x loss_x 1.3867 (1.7379) acc_x 65.6250 (57.5000) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [15/21] time 0.560 (0.459) data 0.430 (0.328) loss_x loss_x 1.9697 (1.7615) acc_x 59.3750 (56.6667) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/21] time 0.565 (0.478) data 0.435 (0.347) loss_x loss_x 1.4971 (1.7382) acc_x 56.2500 (56.4062) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1922
confident_label rate tensor(0.2130, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 668
clean true:608
clean false:60
clean_rate:0.9101796407185628
noisy true:606
noisy false:1862
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 2468
epoch [5/200] batch [5/20] time 0.399 (0.469) data 0.269 (0.339) loss_x loss_x 1.7920 (1.7881) acc_x 50.0000 (56.2500) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [10/20] time 0.373 (0.449) data 0.242 (0.318) loss_x loss_x 1.6670 (1.6961) acc_x 46.8750 (54.0625) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/20] time 0.352 (0.461) data 0.222 (0.331) loss_x loss_x 1.5850 (1.6403) acc_x 62.5000 (56.2500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/20] time 0.413 (0.466) data 0.282 (0.335) loss_x loss_x 1.4199 (1.6362) acc_x 59.3750 (55.0000) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1881
confident_label rate tensor(0.2226, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 698
clean true:637
clean false:61
clean_rate:0.9126074498567335
noisy true:618
noisy false:1820
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 2438
epoch [6/200] batch [5/21] time 0.615 (0.521) data 0.484 (0.390) loss_x loss_x 1.9404 (1.5777) acc_x 53.1250 (60.0000) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [10/21] time 0.619 (0.511) data 0.488 (0.380) loss_x loss_x 1.8164 (1.5479) acc_x 56.2500 (58.7500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/21] time 0.472 (0.504) data 0.342 (0.373) loss_x loss_x 1.3311 (1.4692) acc_x 65.6250 (61.6667) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/21] time 0.525 (0.494) data 0.395 (0.363) loss_x loss_x 2.1992 (1.5068) acc_x 46.8750 (60.9375) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1874
confident_label rate tensor(0.2283, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 716
clean true:649
clean false:67
clean_rate:0.9064245810055865
noisy true:613
noisy false:1807
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 2420
epoch [7/200] batch [5/22] time 0.494 (0.456) data 0.363 (0.325) loss_x loss_x 1.5605 (1.7002) acc_x 56.2500 (53.1250) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [10/22] time 0.374 (0.451) data 0.244 (0.320) loss_x loss_x 1.3760 (1.6507) acc_x 71.8750 (55.6250) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/22] time 0.430 (0.452) data 0.300 (0.321) loss_x loss_x 1.4062 (1.6788) acc_x 62.5000 (55.8333) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/22] time 0.428 (0.472) data 0.297 (0.341) loss_x loss_x 1.7480 (1.6337) acc_x 53.1250 (55.1562) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1940
confident_label rate tensor(0.2146, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 673
clean true:608
clean false:65
clean_rate:0.9034175334323923
noisy true:588
noisy false:1875
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 2463
epoch [8/200] batch [5/21] time 0.496 (0.476) data 0.365 (0.345) loss_x loss_x 1.3975 (1.5221) acc_x 53.1250 (55.0000) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [10/21] time 0.402 (0.463) data 0.272 (0.333) loss_x loss_x 1.5430 (1.6986) acc_x 65.6250 (55.0000) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/21] time 0.413 (0.465) data 0.283 (0.334) loss_x loss_x 1.7285 (1.7612) acc_x 62.5000 (54.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/21] time 0.436 (0.471) data 0.306 (0.340) loss_x loss_x 1.9873 (1.7197) acc_x 40.6250 (54.8438) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1887
confident_label rate tensor(0.2299, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 721
clean true:651
clean false:70
clean_rate:0.9029126213592233
noisy true:598
noisy false:1817
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 2415
epoch [9/200] batch [5/22] time 0.443 (0.437) data 0.312 (0.306) loss_x loss_x 1.3887 (1.6164) acc_x 59.3750 (57.5000) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [10/22] time 0.361 (0.448) data 0.230 (0.317) loss_x loss_x 1.8242 (1.5556) acc_x 46.8750 (57.5000) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/22] time 0.545 (0.477) data 0.414 (0.346) loss_x loss_x 1.5508 (1.5576) acc_x 43.7500 (58.3333) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/22] time 0.440 (0.469) data 0.310 (0.338) loss_x loss_x 1.0225 (1.5369) acc_x 78.1250 (59.2188) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1850
confident_label rate tensor(0.2385, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 748
clean true:676
clean false:72
clean_rate:0.9037433155080213
noisy true:610
noisy false:1778
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 2388
epoch [10/200] batch [5/23] time 0.547 (0.474) data 0.416 (0.343) loss_x loss_x 1.2090 (1.6254) acc_x 56.2500 (55.0000) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [10/23] time 0.380 (0.446) data 0.249 (0.315) loss_x loss_x 2.1914 (1.5551) acc_x 50.0000 (56.5625) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/23] time 0.494 (0.446) data 0.363 (0.316) loss_x loss_x 1.4346 (1.5872) acc_x 59.3750 (55.4167) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/23] time 0.431 (0.466) data 0.301 (0.335) loss_x loss_x 1.2764 (1.5338) acc_x 71.8750 (57.6562) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 731
clean true:667
clean false:64
clean_rate:0.9124487004103967
noisy true:656
noisy false:1749
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 2405
epoch [11/200] batch [5/22] time 0.556 (0.460) data 0.425 (0.329) loss_x loss_x 1.7998 (1.8623) acc_x 53.1250 (53.1250) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [10/22] time 0.445 (0.444) data 0.313 (0.313) loss_x loss_x 1.9512 (1.7543) acc_x 46.8750 (55.0000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/22] time 0.561 (0.462) data 0.430 (0.331) loss_x loss_x 1.5059 (1.7521) acc_x 56.2500 (55.8333) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/22] time 0.447 (0.459) data 0.316 (0.328) loss_x loss_x 1.3809 (1.7148) acc_x 53.1250 (56.7188) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1830
confident_label rate tensor(0.2385, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 748
clean true:688
clean false:60
clean_rate:0.9197860962566845
noisy true:618
noisy false:1770
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 2388
epoch [12/200] batch [5/23] time 0.681 (0.517) data 0.549 (0.386) loss_x loss_x 2.0820 (1.8055) acc_x 40.6250 (53.7500) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [10/23] time 0.437 (0.485) data 0.306 (0.354) loss_x loss_x 1.7881 (1.7297) acc_x 53.1250 (55.9375) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [15/23] time 0.460 (0.482) data 0.330 (0.352) loss_x loss_x 1.7090 (1.6785) acc_x 56.2500 (57.5000) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/23] time 0.427 (0.473) data 0.296 (0.343) loss_x loss_x 1.4775 (1.6723) acc_x 53.1250 (57.9688) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1828
confident_label rate tensor(0.2360, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 740
clean true:683
clean false:57
clean_rate:0.922972972972973
noisy true:625
noisy false:1771
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 2396
epoch [13/200] batch [5/23] time 0.517 (0.511) data 0.386 (0.380) loss_x loss_x 1.7842 (1.5600) acc_x 53.1250 (53.1250) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [10/23] time 0.492 (0.497) data 0.361 (0.366) loss_x loss_x 1.6602 (1.5565) acc_x 62.5000 (56.5625) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [15/23] time 0.429 (0.471) data 0.298 (0.341) loss_x loss_x 1.4668 (1.4898) acc_x 56.2500 (59.5833) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [20/23] time 0.615 (0.469) data 0.484 (0.338) loss_x loss_x 1.5547 (1.5376) acc_x 56.2500 (60.0000) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1823
confident_label rate tensor(0.2360, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 740
clean true:673
clean false:67
clean_rate:0.9094594594594595
noisy true:640
noisy false:1756
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 2396
epoch [14/200] batch [5/23] time 0.449 (0.464) data 0.318 (0.333) loss_x loss_x 1.6611 (1.4730) acc_x 50.0000 (58.7500) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [10/23] time 0.611 (0.459) data 0.480 (0.328) loss_x loss_x 1.1191 (1.4589) acc_x 71.8750 (60.6250) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [15/23] time 0.375 (0.459) data 0.244 (0.328) loss_x loss_x 1.4385 (1.4687) acc_x 62.5000 (61.2500) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [20/23] time 0.450 (0.462) data 0.320 (0.331) loss_x loss_x 1.4170 (1.5224) acc_x 65.6250 (59.3750) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1779
confident_label rate tensor(0.2427, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 761
clean true:699
clean false:62
clean_rate:0.9185282522996058
noisy true:658
noisy false:1717
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 2375
epoch [15/200] batch [5/23] time 0.343 (0.425) data 0.213 (0.295) loss_x loss_x 1.9590 (1.6295) acc_x 59.3750 (60.0000) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [10/23] time 0.396 (0.441) data 0.265 (0.311) loss_x loss_x 1.6660 (1.5140) acc_x 62.5000 (61.8750) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/23] time 0.499 (0.452) data 0.369 (0.322) loss_x loss_x 1.5557 (1.5340) acc_x 62.5000 (62.0833) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/23] time 0.458 (0.455) data 0.327 (0.324) loss_x loss_x 1.7959 (1.5453) acc_x 56.2500 (61.0938) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1862
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 736
clean true:666
clean false:70
clean_rate:0.904891304347826
noisy true:608
noisy false:1792
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 2400
epoch [16/200] batch [5/23] time 0.471 (0.464) data 0.340 (0.333) loss_x loss_x 0.9673 (1.4909) acc_x 62.5000 (56.2500) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [10/23] time 0.506 (0.482) data 0.374 (0.351) loss_x loss_x 1.7393 (1.5562) acc_x 59.3750 (57.1875) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [15/23] time 0.422 (0.487) data 0.291 (0.356) loss_x loss_x 1.6436 (1.5355) acc_x 50.0000 (56.0417) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [20/23] time 0.471 (0.491) data 0.340 (0.360) loss_x loss_x 1.3838 (1.5142) acc_x 62.5000 (56.5625) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1805
confident_label rate tensor(0.2408, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 755
clean true:688
clean false:67
clean_rate:0.9112582781456954
noisy true:643
noisy false:1738
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 2381
epoch [17/200] batch [5/23] time 0.344 (0.492) data 0.212 (0.361) loss_x loss_x 1.8213 (1.7516) acc_x 62.5000 (58.1250) lr 1.9724e-03 eta 0:00:08
epoch [17/200] batch [10/23] time 0.504 (0.485) data 0.373 (0.354) loss_x loss_x 1.7588 (1.6591) acc_x 46.8750 (57.5000) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [15/23] time 0.571 (0.490) data 0.440 (0.358) loss_x loss_x 1.9297 (1.7066) acc_x 53.1250 (56.0417) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/23] time 0.599 (0.486) data 0.469 (0.355) loss_x loss_x 1.3047 (1.6604) acc_x 68.7500 (57.8125) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1800
confident_label rate tensor(0.2379, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 746
clean true:684
clean false:62
clean_rate:0.9168900804289544
noisy true:652
noisy false:1738
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 2390
epoch [18/200] batch [5/23] time 0.520 (0.499) data 0.388 (0.368) loss_x loss_x 0.7773 (1.4641) acc_x 81.2500 (63.7500) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [10/23] time 0.411 (0.512) data 0.279 (0.381) loss_x loss_x 1.7637 (1.5479) acc_x 50.0000 (59.0625) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [15/23] time 0.481 (0.512) data 0.350 (0.381) loss_x loss_x 1.7803 (1.5661) acc_x 53.1250 (58.1250) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/23] time 0.476 (0.494) data 0.345 (0.363) loss_x loss_x 1.6094 (1.5763) acc_x 62.5000 (58.1250) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1799
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:699
clean false:54
clean_rate:0.9282868525896414
noisy true:638
noisy false:1745
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [19/200] batch [5/23] time 0.477 (0.453) data 0.347 (0.323) loss_x loss_x 2.2969 (1.6279) acc_x 50.0000 (56.2500) lr 1.9646e-03 eta 0:00:08
epoch [19/200] batch [10/23] time 0.395 (0.487) data 0.264 (0.356) loss_x loss_x 1.8389 (1.6700) acc_x 59.3750 (55.9375) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [15/23] time 0.464 (0.478) data 0.333 (0.347) loss_x loss_x 1.5381 (1.7088) acc_x 59.3750 (57.2917) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/23] time 0.368 (0.470) data 0.238 (0.340) loss_x loss_x 1.7012 (1.6771) acc_x 56.2500 (57.0312) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1836
confident_label rate tensor(0.2388, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 749
clean true:672
clean false:77
clean_rate:0.897196261682243
noisy true:628
noisy false:1759
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 2387
epoch [20/200] batch [5/23] time 0.461 (0.452) data 0.330 (0.322) loss_x loss_x 1.5879 (1.5963) acc_x 65.6250 (60.6250) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [10/23] time 0.417 (0.447) data 0.287 (0.317) loss_x loss_x 1.3838 (1.6534) acc_x 65.6250 (58.1250) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [15/23] time 0.455 (0.443) data 0.324 (0.312) loss_x loss_x 1.6133 (1.6658) acc_x 53.1250 (57.2917) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/23] time 0.389 (0.438) data 0.258 (0.307) loss_x loss_x 1.4902 (1.6505) acc_x 62.5000 (58.4375) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1822
confident_label rate tensor(0.2299, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 721
clean true:667
clean false:54
clean_rate:0.9251040221914009
noisy true:647
noisy false:1768
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 2415
epoch [21/200] batch [5/22] time 0.411 (0.417) data 0.280 (0.286) loss_x loss_x 1.3184 (1.3855) acc_x 68.7500 (63.7500) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [10/22] time 0.456 (0.459) data 0.326 (0.328) loss_x loss_x 1.1992 (1.4215) acc_x 78.1250 (65.3125) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/22] time 0.508 (0.462) data 0.378 (0.331) loss_x loss_x 1.6602 (1.5095) acc_x 56.2500 (64.3750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/22] time 0.447 (0.488) data 0.316 (0.357) loss_x loss_x 1.7012 (1.5273) acc_x 50.0000 (62.5000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:692
clean false:61
clean_rate:0.9189907038512616
noisy true:634
noisy false:1749
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [22/200] batch [5/23] time 0.451 (0.488) data 0.321 (0.357) loss_x loss_x 1.5000 (1.2928) acc_x 68.7500 (69.3750) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [10/23] time 0.595 (0.484) data 0.464 (0.354) loss_x loss_x 1.6416 (1.5127) acc_x 56.2500 (60.6250) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [15/23] time 0.507 (0.472) data 0.376 (0.341) loss_x loss_x 1.3193 (1.5430) acc_x 50.0000 (59.1667) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/23] time 0.437 (0.461) data 0.306 (0.330) loss_x loss_x 1.7031 (1.5505) acc_x 62.5000 (58.9062) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1855
confident_label rate tensor(0.2385, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 748
clean true:684
clean false:64
clean_rate:0.9144385026737968
noisy true:597
noisy false:1791
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 2388
epoch [23/200] batch [5/23] time 0.554 (0.519) data 0.423 (0.388) loss_x loss_x 1.3369 (1.3918) acc_x 65.6250 (64.3750) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [10/23] time 0.617 (0.501) data 0.487 (0.370) loss_x loss_x 2.0527 (1.5264) acc_x 43.7500 (58.4375) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [15/23] time 0.431 (0.484) data 0.299 (0.353) loss_x loss_x 1.4775 (1.5663) acc_x 56.2500 (57.9167) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/23] time 0.532 (0.488) data 0.402 (0.357) loss_x loss_x 1.3066 (1.5323) acc_x 65.6250 (59.5312) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1806
confident_label rate tensor(0.2433, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 763
clean true:698
clean false:65
clean_rate:0.9148099606815203
noisy true:632
noisy false:1741
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 2373
epoch [24/200] batch [5/23] time 0.336 (0.406) data 0.205 (0.275) loss_x loss_x 1.5781 (1.5709) acc_x 62.5000 (55.6250) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [10/23] time 0.533 (0.459) data 0.402 (0.328) loss_x loss_x 1.6699 (1.6653) acc_x 65.6250 (57.8125) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/23] time 0.688 (0.495) data 0.557 (0.364) loss_x loss_x 0.9868 (1.5763) acc_x 78.1250 (59.5833) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/23] time 0.521 (0.492) data 0.390 (0.361) loss_x loss_x 1.6113 (1.5676) acc_x 62.5000 (59.6875) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 747
clean true:699
clean false:48
clean_rate:0.9357429718875502
noisy true:665
noisy false:1724
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 2389
epoch [25/200] batch [5/23] time 0.361 (0.449) data 0.230 (0.318) loss_x loss_x 1.7178 (1.4768) acc_x 71.8750 (66.2500) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [10/23] time 0.361 (0.440) data 0.230 (0.309) loss_x loss_x 1.4678 (1.4479) acc_x 59.3750 (64.6875) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/23] time 0.448 (0.447) data 0.317 (0.316) loss_x loss_x 1.8135 (1.5053) acc_x 50.0000 (63.3333) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/23] time 0.422 (0.453) data 0.291 (0.321) loss_x loss_x 1.4385 (1.4640) acc_x 65.6250 (64.5312) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2538, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 796
clean true:732
clean false:64
clean_rate:0.9195979899497487
noisy true:631
noisy false:1709
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 2340
epoch [26/200] batch [5/24] time 0.444 (0.558) data 0.313 (0.426) loss_x loss_x 1.4082 (1.5719) acc_x 62.5000 (57.5000) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [10/24] time 0.405 (0.523) data 0.274 (0.391) loss_x loss_x 1.6484 (1.6289) acc_x 56.2500 (55.9375) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [15/24] time 0.393 (0.495) data 0.262 (0.363) loss_x loss_x 1.2188 (1.5341) acc_x 62.5000 (57.5000) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/24] time 0.577 (0.485) data 0.446 (0.353) loss_x loss_x 1.2881 (1.5567) acc_x 75.0000 (57.9688) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1793
confident_label rate tensor(0.2535, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 795
clean true:722
clean false:73
clean_rate:0.9081761006289308
noisy true:621
noisy false:1720
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 2341
epoch [27/200] batch [5/24] time 0.538 (0.431) data 0.407 (0.300) loss_x loss_x 1.7959 (1.6105) acc_x 46.8750 (58.1250) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [10/24] time 0.387 (0.444) data 0.256 (0.312) loss_x loss_x 1.3232 (1.4784) acc_x 65.6250 (61.5625) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [15/24] time 0.548 (0.455) data 0.416 (0.324) loss_x loss_x 2.2676 (1.5286) acc_x 43.7500 (61.0417) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/24] time 0.499 (0.455) data 0.367 (0.323) loss_x loss_x 1.5869 (1.5454) acc_x 65.6250 (61.7188) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1789
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 778
clean true:714
clean false:64
clean_rate:0.9177377892030848
noisy true:633
noisy false:1725
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 2358
epoch [28/200] batch [5/24] time 0.423 (0.415) data 0.293 (0.284) loss_x loss_x 1.1133 (1.3908) acc_x 71.8750 (62.5000) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [10/24] time 0.587 (0.455) data 0.456 (0.324) loss_x loss_x 1.9658 (1.5800) acc_x 50.0000 (59.3750) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [15/24] time 0.415 (0.461) data 0.284 (0.330) loss_x loss_x 1.1650 (1.5671) acc_x 65.6250 (58.5417) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/24] time 0.464 (0.466) data 0.333 (0.335) loss_x loss_x 1.6611 (1.4966) acc_x 50.0000 (60.3125) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1799
confident_label rate tensor(0.2459, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 771
clean true:700
clean false:71
clean_rate:0.9079118028534371
noisy true:637
noisy false:1728
after delete: len(clean_dataset) 771
after delete: len(noisy_dataset) 2365
epoch [29/200] batch [5/24] time 0.500 (0.468) data 0.369 (0.336) loss_x loss_x 1.7686 (1.5520) acc_x 56.2500 (58.7500) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [10/24] time 0.451 (0.521) data 0.320 (0.389) loss_x loss_x 0.7456 (1.3699) acc_x 81.2500 (61.8750) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [15/24] time 0.366 (0.497) data 0.236 (0.365) loss_x loss_x 1.4326 (1.3126) acc_x 53.1250 (63.7500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [20/24] time 0.413 (0.481) data 0.282 (0.350) loss_x loss_x 1.0859 (1.3144) acc_x 62.5000 (64.5312) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1777
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:715
clean false:70
clean_rate:0.910828025477707
noisy true:644
noisy false:1707
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [30/200] batch [5/24] time 0.440 (0.428) data 0.308 (0.297) loss_x loss_x 1.3066 (1.3480) acc_x 62.5000 (68.1250) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [10/24] time 0.358 (0.435) data 0.228 (0.304) loss_x loss_x 1.3848 (1.3968) acc_x 68.7500 (65.9375) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [15/24] time 0.426 (0.450) data 0.296 (0.319) loss_x loss_x 1.3857 (1.3534) acc_x 56.2500 (66.0417) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [20/24] time 0.544 (0.458) data 0.413 (0.327) loss_x loss_x 0.6665 (1.3100) acc_x 68.7500 (66.8750) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1755
confident_label rate tensor(0.2503, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 785
clean true:725
clean false:60
clean_rate:0.9235668789808917
noisy true:656
noisy false:1695
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 2351
epoch [31/200] batch [5/24] time 0.694 (0.550) data 0.563 (0.419) loss_x loss_x 1.0479 (1.4500) acc_x 78.1250 (61.8750) lr 1.8980e-03 eta 0:00:10
epoch [31/200] batch [10/24] time 0.422 (0.532) data 0.291 (0.401) loss_x loss_x 1.3975 (1.3431) acc_x 59.3750 (63.1250) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [15/24] time 0.383 (0.503) data 0.253 (0.372) loss_x loss_x 1.2842 (1.3540) acc_x 71.8750 (64.1667) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [20/24] time 0.486 (0.485) data 0.355 (0.354) loss_x loss_x 1.3154 (1.3863) acc_x 62.5000 (63.2812) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 747
clean true:682
clean false:65
clean_rate:0.9129852744310576
noisy true:637
noisy false:1752
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 2389
epoch [32/200] batch [5/23] time 0.464 (0.449) data 0.334 (0.318) loss_x loss_x 1.3818 (1.4865) acc_x 65.6250 (63.1250) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [10/23] time 0.529 (0.464) data 0.397 (0.333) loss_x loss_x 1.4014 (1.4333) acc_x 62.5000 (65.9375) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [15/23] time 0.445 (0.466) data 0.315 (0.335) loss_x loss_x 1.4160 (1.4293) acc_x 68.7500 (65.2083) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/23] time 0.485 (0.465) data 0.355 (0.334) loss_x loss_x 1.4541 (1.4624) acc_x 62.5000 (63.2812) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1780
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 788
clean true:724
clean false:64
clean_rate:0.9187817258883249
noisy true:632
noisy false:1716
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 2348
epoch [33/200] batch [5/24] time 0.422 (0.458) data 0.291 (0.327) loss_x loss_x 1.7432 (1.4777) acc_x 50.0000 (60.0000) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [10/24] time 0.425 (0.456) data 0.295 (0.325) loss_x loss_x 1.5205 (1.3858) acc_x 56.2500 (62.5000) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [15/24] time 0.318 (0.455) data 0.187 (0.324) loss_x loss_x 1.6533 (1.3978) acc_x 59.3750 (62.9167) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [20/24] time 0.500 (0.465) data 0.368 (0.334) loss_x loss_x 1.2852 (1.4357) acc_x 65.6250 (61.7188) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.2417, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 758
clean true:706
clean false:52
clean_rate:0.9313984168865436
noisy true:644
noisy false:1734
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 2378
epoch [34/200] batch [5/23] time 0.496 (0.509) data 0.365 (0.378) loss_x loss_x 1.2930 (1.3424) acc_x 59.3750 (67.5000) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [10/23] time 0.429 (0.485) data 0.299 (0.354) loss_x loss_x 1.7227 (1.5086) acc_x 53.1250 (63.1250) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [15/23] time 0.376 (0.471) data 0.244 (0.340) loss_x loss_x 2.3164 (1.5855) acc_x 46.8750 (61.0417) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/23] time 0.459 (0.471) data 0.328 (0.340) loss_x loss_x 1.3662 (1.5646) acc_x 65.6250 (61.7188) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1782
confident_label rate tensor(0.2471, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 775
clean true:710
clean false:65
clean_rate:0.9161290322580645
noisy true:644
noisy false:1717
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 2361
epoch [35/200] batch [5/24] time 0.410 (0.459) data 0.279 (0.327) loss_x loss_x 1.3965 (1.3375) acc_x 53.1250 (64.3750) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [10/24] time 0.592 (0.455) data 0.455 (0.323) loss_x loss_x 1.4766 (1.3847) acc_x 68.7500 (64.3750) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [15/24] time 0.588 (0.466) data 0.457 (0.334) loss_x loss_x 1.7002 (1.4701) acc_x 59.3750 (63.1250) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [20/24] time 0.374 (0.454) data 0.243 (0.321) loss_x loss_x 1.4893 (1.4995) acc_x 59.3750 (62.0312) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2599, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 815
clean true:744
clean false:71
clean_rate:0.912883435582822
noisy true:636
noisy false:1685
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 2321
epoch [36/200] batch [5/25] time 0.537 (0.504) data 0.406 (0.373) loss_x loss_x 1.1152 (1.5855) acc_x 71.8750 (57.5000) lr 1.8607e-03 eta 0:00:10
epoch [36/200] batch [10/25] time 0.401 (0.501) data 0.269 (0.370) loss_x loss_x 1.4307 (1.5502) acc_x 46.8750 (58.4375) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [15/25] time 0.403 (0.472) data 0.271 (0.341) loss_x loss_x 1.6738 (1.5756) acc_x 65.6250 (58.9583) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/25] time 0.515 (0.470) data 0.385 (0.339) loss_x loss_x 1.3340 (1.5261) acc_x 62.5000 (60.3125) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/25] time 0.538 (0.468) data 0.407 (0.337) loss_x loss_x 1.1318 (1.5193) acc_x 62.5000 (60.8750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2522, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 791
clean true:721
clean false:70
clean_rate:0.911504424778761
noisy true:642
noisy false:1703
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 2345
epoch [37/200] batch [5/24] time 0.413 (0.425) data 0.282 (0.294) loss_x loss_x 1.4609 (1.6244) acc_x 59.3750 (58.7500) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [10/24] time 0.394 (0.444) data 0.262 (0.313) loss_x loss_x 0.9873 (1.5294) acc_x 65.6250 (61.2500) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [15/24] time 0.516 (0.462) data 0.385 (0.331) loss_x loss_x 1.2637 (1.4352) acc_x 56.2500 (62.0833) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [20/24] time 0.415 (0.462) data 0.285 (0.331) loss_x loss_x 1.4131 (1.3815) acc_x 53.1250 (63.1250) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1764
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 811
clean true:738
clean false:73
clean_rate:0.9099876695437731
noisy true:634
noisy false:1691
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 2325
epoch [38/200] batch [5/25] time 0.422 (0.446) data 0.292 (0.315) loss_x loss_x 1.3994 (1.5834) acc_x 65.6250 (58.7500) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [10/25] time 0.437 (0.464) data 0.305 (0.332) loss_x loss_x 1.5156 (1.5679) acc_x 68.7500 (61.8750) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [15/25] time 0.472 (0.475) data 0.341 (0.344) loss_x loss_x 0.9771 (1.5605) acc_x 68.7500 (60.6250) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [20/25] time 0.456 (0.466) data 0.325 (0.334) loss_x loss_x 1.5684 (1.5582) acc_x 62.5000 (59.3750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/25] time 0.475 (0.473) data 0.344 (0.342) loss_x loss_x 1.5166 (1.5293) acc_x 68.7500 (60.2500) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.2532, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 794
clean true:714
clean false:80
clean_rate:0.8992443324937027
noisy true:635
noisy false:1707
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 2342
epoch [39/200] batch [5/24] time 0.398 (0.439) data 0.267 (0.308) loss_x loss_x 1.1309 (1.4926) acc_x 78.1250 (64.3750) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [10/24] time 0.447 (0.459) data 0.316 (0.327) loss_x loss_x 1.1748 (1.3897) acc_x 75.0000 (65.6250) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [15/24] time 0.480 (0.467) data 0.349 (0.335) loss_x loss_x 1.0791 (1.3544) acc_x 71.8750 (65.8333) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [20/24] time 0.399 (0.452) data 0.267 (0.321) loss_x loss_x 1.4600 (1.4469) acc_x 68.7500 (64.3750) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1775
confident_label rate tensor(0.2490, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 781
clean true:713
clean false:68
clean_rate:0.912932138284251
noisy true:648
noisy false:1707
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 2355
epoch [40/200] batch [5/24] time 0.488 (0.475) data 0.357 (0.344) loss_x loss_x 1.2363 (1.5424) acc_x 62.5000 (64.3750) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [10/24] time 0.402 (0.440) data 0.271 (0.309) loss_x loss_x 1.3604 (1.4030) acc_x 68.7500 (66.2500) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [15/24] time 0.447 (0.459) data 0.315 (0.328) loss_x loss_x 1.5264 (1.5115) acc_x 40.6250 (61.2500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [20/24] time 0.563 (0.467) data 0.432 (0.335) loss_x loss_x 1.8105 (1.5527) acc_x 62.5000 (60.6250) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.2663, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 835
clean true:753
clean false:82
clean_rate:0.9017964071856287
noisy true:652
noisy false:1649
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 2301
epoch [41/200] batch [5/26] time 0.348 (0.440) data 0.217 (0.310) loss_x loss_x 1.4434 (1.5107) acc_x 62.5000 (65.0000) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [10/26] time 0.438 (0.479) data 0.307 (0.349) loss_x loss_x 1.2773 (1.4767) acc_x 68.7500 (62.5000) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [15/26] time 0.437 (0.477) data 0.306 (0.347) loss_x loss_x 1.5117 (1.5018) acc_x 65.6250 (60.6250) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [20/26] time 0.397 (0.476) data 0.267 (0.346) loss_x loss_x 1.5273 (1.4983) acc_x 56.2500 (60.3125) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/26] time 0.424 (0.489) data 0.292 (0.358) loss_x loss_x 1.5771 (1.4993) acc_x 53.1250 (60.1250) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1762
confident_label rate tensor(0.2602, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 816
clean true:744
clean false:72
clean_rate:0.9117647058823529
noisy true:630
noisy false:1690
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 2320
epoch [42/200] batch [5/25] time 0.355 (0.468) data 0.225 (0.337) loss_x loss_x 1.6250 (1.3457) acc_x 68.7500 (65.0000) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [10/25] time 0.554 (0.501) data 0.423 (0.370) loss_x loss_x 1.3350 (1.3317) acc_x 68.7500 (65.3125) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [15/25] time 0.421 (0.492) data 0.290 (0.362) loss_x loss_x 1.6621 (1.3263) acc_x 56.2500 (64.1667) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [20/25] time 0.493 (0.481) data 0.362 (0.350) loss_x loss_x 1.7090 (1.3544) acc_x 62.5000 (63.5938) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/25] time 0.443 (0.490) data 0.312 (0.359) loss_x loss_x 1.5781 (1.3959) acc_x 56.2500 (62.7500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 782
clean true:717
clean false:65
clean_rate:0.9168797953964194
noisy true:672
noisy false:1682
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 2354
epoch [43/200] batch [5/24] time 0.464 (0.498) data 0.333 (0.367) loss_x loss_x 0.9819 (1.5202) acc_x 75.0000 (63.1250) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [10/24] time 0.361 (0.497) data 0.230 (0.366) loss_x loss_x 1.6367 (1.3420) acc_x 43.7500 (65.6250) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [15/24] time 0.503 (0.501) data 0.371 (0.370) loss_x loss_x 1.4434 (1.4239) acc_x 65.6250 (63.9583) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [20/24] time 0.424 (0.503) data 0.294 (0.372) loss_x loss_x 2.0449 (1.4483) acc_x 56.2500 (63.7500) lr 1.7997e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 809
clean true:722
clean false:87
clean_rate:0.892459826946848
noisy true:648
noisy false:1679
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 2327
epoch [44/200] batch [5/25] time 0.474 (0.541) data 0.343 (0.409) loss_x loss_x 1.4600 (1.3648) acc_x 59.3750 (61.8750) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [10/25] time 0.390 (0.517) data 0.259 (0.385) loss_x loss_x 1.1562 (1.3521) acc_x 65.6250 (62.5000) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [15/25] time 0.426 (0.516) data 0.295 (0.384) loss_x loss_x 1.2412 (1.3856) acc_x 68.7500 (63.3333) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [20/25] time 0.470 (0.499) data 0.340 (0.368) loss_x loss_x 1.7568 (1.4325) acc_x 56.2500 (63.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/25] time 0.503 (0.498) data 0.372 (0.367) loss_x loss_x 1.5898 (1.4396) acc_x 59.3750 (62.8750) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.2529, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 793
clean true:721
clean false:72
clean_rate:0.9092055485498108
noisy true:656
noisy false:1687
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 2343
epoch [45/200] batch [5/24] time 0.460 (0.516) data 0.330 (0.385) loss_x loss_x 1.7510 (1.4932) acc_x 56.2500 (63.7500) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [10/24] time 0.654 (0.523) data 0.523 (0.392) loss_x loss_x 1.2988 (1.4463) acc_x 62.5000 (61.8750) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [15/24] time 0.583 (0.515) data 0.452 (0.385) loss_x loss_x 1.4023 (1.4503) acc_x 56.2500 (61.2500) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [20/24] time 0.355 (0.509) data 0.225 (0.379) loss_x loss_x 1.0000 (1.4273) acc_x 78.1250 (62.0312) lr 1.7804e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1742
confident_label rate tensor(0.2666, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 836
clean true:761
clean false:75
clean_rate:0.9102870813397129
noisy true:633
noisy false:1667
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 2300
epoch [46/200] batch [5/26] time 0.587 (0.484) data 0.455 (0.353) loss_x loss_x 1.4873 (1.4094) acc_x 59.3750 (61.8750) lr 1.7705e-03 eta 0:00:10
epoch [46/200] batch [10/26] time 0.505 (0.460) data 0.374 (0.329) loss_x loss_x 1.3408 (1.4253) acc_x 68.7500 (61.5625) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [15/26] time 0.413 (0.462) data 0.282 (0.330) loss_x loss_x 0.9614 (1.3856) acc_x 75.0000 (63.1250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [20/26] time 0.433 (0.458) data 0.302 (0.326) loss_x loss_x 1.4209 (1.4245) acc_x 68.7500 (63.1250) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/26] time 0.390 (0.452) data 0.259 (0.321) loss_x loss_x 1.4902 (1.4272) acc_x 56.2500 (63.0000) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.2663, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 835
clean true:751
clean false:84
clean_rate:0.8994011976047904
noisy true:670
noisy false:1631
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 2301
epoch [47/200] batch [5/26] time 0.520 (0.553) data 0.388 (0.420) loss_x loss_x 1.6084 (1.3449) acc_x 59.3750 (61.8750) lr 1.7604e-03 eta 0:00:11
epoch [47/200] batch [10/26] time 0.499 (0.529) data 0.368 (0.397) loss_x loss_x 1.3242 (1.4476) acc_x 56.2500 (60.0000) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [15/26] time 0.423 (0.512) data 0.292 (0.380) loss_x loss_x 1.2822 (1.4081) acc_x 65.6250 (62.0833) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/26] time 0.390 (0.486) data 0.260 (0.354) loss_x loss_x 1.7402 (1.3717) acc_x 62.5000 (63.4375) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/26] time 0.442 (0.489) data 0.310 (0.358) loss_x loss_x 1.4219 (1.3808) acc_x 59.3750 (63.5000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.2516, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 789
clean true:709
clean false:80
clean_rate:0.8986058301647655
noisy true:659
noisy false:1688
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 2347
epoch [48/200] batch [5/24] time 0.516 (0.417) data 0.384 (0.285) loss_x loss_x 1.7832 (1.4795) acc_x 50.0000 (60.0000) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [10/24] time 0.541 (0.438) data 0.410 (0.307) loss_x loss_x 1.4609 (1.4975) acc_x 65.6250 (62.1875) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [15/24] time 0.535 (0.453) data 0.403 (0.322) loss_x loss_x 1.6494 (1.4725) acc_x 59.3750 (62.0833) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [20/24] time 0.493 (0.451) data 0.362 (0.319) loss_x loss_x 1.7461 (1.4856) acc_x 50.0000 (62.3438) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 805
clean true:724
clean false:81
clean_rate:0.8993788819875776
noisy true:646
noisy false:1685
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 2331
epoch [49/200] batch [5/25] time 0.490 (0.462) data 0.359 (0.331) loss_x loss_x 1.4238 (1.3083) acc_x 62.5000 (65.0000) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/25] time 0.499 (0.444) data 0.367 (0.313) loss_x loss_x 0.9658 (1.3762) acc_x 75.0000 (64.3750) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [15/25] time 0.420 (0.457) data 0.289 (0.326) loss_x loss_x 1.5928 (1.3587) acc_x 65.6250 (65.8333) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [20/25] time 0.494 (0.467) data 0.363 (0.336) loss_x loss_x 1.9209 (1.3990) acc_x 43.7500 (64.3750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/25] time 0.417 (0.466) data 0.286 (0.335) loss_x loss_x 1.6357 (1.4053) acc_x 62.5000 (64.1250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1745
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 833
clean true:747
clean false:86
clean_rate:0.8967587034813925
noisy true:644
noisy false:1659
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 2303
epoch [50/200] batch [5/26] time 0.341 (0.466) data 0.210 (0.334) loss_x loss_x 1.7441 (1.3758) acc_x 59.3750 (65.0000) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [10/26] time 0.356 (0.455) data 0.224 (0.324) loss_x loss_x 1.6416 (1.4914) acc_x 65.6250 (63.1250) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [15/26] time 0.464 (0.466) data 0.333 (0.335) loss_x loss_x 1.8555 (1.5036) acc_x 59.3750 (61.8750) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [20/26] time 0.383 (0.462) data 0.253 (0.331) loss_x loss_x 1.7568 (1.5043) acc_x 62.5000 (63.1250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/26] time 0.457 (0.465) data 0.327 (0.334) loss_x loss_x 1.5684 (1.5080) acc_x 65.6250 (62.3750) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.2529, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 793
clean true:724
clean false:69
clean_rate:0.9129886506935687
noisy true:665
noisy false:1678
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 2343
epoch [51/200] batch [5/24] time 0.428 (0.522) data 0.297 (0.391) loss_x loss_x 1.4229 (1.5521) acc_x 68.7500 (64.3750) lr 1.7181e-03 eta 0:00:09
epoch [51/200] batch [10/24] time 0.414 (0.483) data 0.284 (0.352) loss_x loss_x 1.4727 (1.4697) acc_x 59.3750 (62.8125) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [15/24] time 0.361 (0.491) data 0.231 (0.360) loss_x loss_x 0.7852 (1.4822) acc_x 78.1250 (63.1250) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [20/24] time 0.500 (0.478) data 0.369 (0.348) loss_x loss_x 1.2021 (1.4309) acc_x 65.6250 (63.7500) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 811
clean true:722
clean false:89
clean_rate:0.8902589395807645
noisy true:662
noisy false:1663
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 2325
epoch [52/200] batch [5/25] time 0.522 (0.448) data 0.391 (0.318) loss_x loss_x 1.5254 (1.2658) acc_x 59.3750 (71.2500) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [10/25] time 0.478 (0.460) data 0.348 (0.329) loss_x loss_x 1.4316 (1.3486) acc_x 59.3750 (65.6250) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [15/25] time 0.523 (0.452) data 0.392 (0.321) loss_x loss_x 1.5225 (1.3647) acc_x 56.2500 (64.7917) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [20/25] time 0.575 (0.457) data 0.444 (0.326) loss_x loss_x 0.9722 (1.3508) acc_x 71.8750 (65.4688) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/25] time 0.403 (0.462) data 0.273 (0.331) loss_x loss_x 1.4639 (1.3466) acc_x 59.3750 (65.2500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2656, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 833
clean true:736
clean false:97
clean_rate:0.8835534213685474
noisy true:656
noisy false:1647
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 2303
epoch [53/200] batch [5/26] time 0.505 (0.523) data 0.375 (0.391) loss_x loss_x 1.0527 (1.3869) acc_x 78.1250 (66.8750) lr 1.6959e-03 eta 0:00:10
epoch [53/200] batch [10/26] time 0.425 (0.521) data 0.295 (0.390) loss_x loss_x 1.4150 (1.2816) acc_x 62.5000 (67.1875) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [15/26] time 0.476 (0.488) data 0.346 (0.357) loss_x loss_x 1.0322 (1.2971) acc_x 75.0000 (65.8333) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [20/26] time 0.403 (0.485) data 0.272 (0.354) loss_x loss_x 0.9355 (1.2850) acc_x 78.1250 (65.9375) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/26] time 0.394 (0.482) data 0.264 (0.351) loss_x loss_x 1.8223 (1.3557) acc_x 59.3750 (64.1250) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1741
confident_label rate tensor(0.2583, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 810
clean true:737
clean false:73
clean_rate:0.9098765432098765
noisy true:658
noisy false:1668
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 2326
epoch [54/200] batch [5/25] time 0.448 (0.496) data 0.317 (0.365) loss_x loss_x 1.8945 (1.4537) acc_x 53.1250 (65.6250) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [10/25] time 0.808 (0.498) data 0.677 (0.368) loss_x loss_x 1.7627 (1.4695) acc_x 53.1250 (63.1250) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [15/25] time 0.356 (0.486) data 0.225 (0.356) loss_x loss_x 2.0352 (1.4726) acc_x 43.7500 (61.6667) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [20/25] time 0.532 (0.475) data 0.400 (0.345) loss_x loss_x 1.1084 (1.4173) acc_x 71.8750 (64.0625) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/25] time 0.438 (0.489) data 0.307 (0.358) loss_x loss_x 1.5762 (1.4518) acc_x 56.2500 (63.0000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.2675, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 839
clean true:750
clean false:89
clean_rate:0.8939213349225268
noisy true:651
noisy false:1646
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 2297
epoch [55/200] batch [5/26] time 0.487 (0.465) data 0.356 (0.334) loss_x loss_x 1.7266 (1.3118) acc_x 59.3750 (65.0000) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [10/26] time 0.404 (0.466) data 0.272 (0.335) loss_x loss_x 1.3838 (1.3816) acc_x 62.5000 (64.6875) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [15/26] time 0.492 (0.457) data 0.361 (0.325) loss_x loss_x 1.5332 (1.4750) acc_x 65.6250 (63.3333) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [20/26] time 0.515 (0.462) data 0.384 (0.331) loss_x loss_x 1.6885 (1.4636) acc_x 50.0000 (62.9688) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/26] time 0.483 (0.455) data 0.351 (0.323) loss_x loss_x 1.2939 (1.4554) acc_x 78.1250 (63.3750) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2535, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 795
clean true:717
clean false:78
clean_rate:0.9018867924528302
noisy true:667
noisy false:1674
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 2341
epoch [56/200] batch [5/24] time 0.398 (0.516) data 0.268 (0.385) loss_x loss_x 1.1602 (1.6111) acc_x 65.6250 (60.0000) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [10/24] time 0.358 (0.486) data 0.227 (0.355) loss_x loss_x 1.6621 (1.5198) acc_x 50.0000 (60.0000) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [15/24] time 0.620 (0.483) data 0.489 (0.352) loss_x loss_x 1.1836 (1.3853) acc_x 65.6250 (62.7083) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [20/24] time 0.510 (0.484) data 0.378 (0.353) loss_x loss_x 1.4990 (1.3683) acc_x 65.6250 (63.9062) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.2634, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 826
clean true:738
clean false:88
clean_rate:0.8934624697336562
noisy true:655
noisy false:1655
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 2310
epoch [57/200] batch [5/25] time 0.434 (0.410) data 0.303 (0.279) loss_x loss_x 1.5889 (1.5031) acc_x 53.1250 (62.5000) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [10/25] time 0.416 (0.422) data 0.285 (0.291) loss_x loss_x 1.9590 (1.4510) acc_x 40.6250 (60.6250) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [15/25] time 0.465 (0.436) data 0.334 (0.305) loss_x loss_x 1.2441 (1.4632) acc_x 71.8750 (62.5000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [20/25] time 0.535 (0.454) data 0.404 (0.323) loss_x loss_x 1.6055 (1.4137) acc_x 59.3750 (63.7500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/25] time 0.524 (0.465) data 0.389 (0.334) loss_x loss_x 1.5566 (1.4383) acc_x 46.8750 (62.2500) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1746
confident_label rate tensor(0.2688, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 843
clean true:752
clean false:91
clean_rate:0.8920521945432978
noisy true:638
noisy false:1655
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 2293
epoch [58/200] batch [5/26] time 0.516 (0.485) data 0.385 (0.354) loss_x loss_x 1.3662 (1.3779) acc_x 65.6250 (61.8750) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [10/26] time 0.521 (0.476) data 0.391 (0.345) loss_x loss_x 1.4238 (1.2380) acc_x 68.7500 (66.2500) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [15/26] time 0.476 (0.482) data 0.344 (0.351) loss_x loss_x 1.3701 (1.2929) acc_x 71.8750 (65.8333) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [20/26] time 0.391 (0.470) data 0.259 (0.339) loss_x loss_x 0.9561 (1.3382) acc_x 75.0000 (64.8438) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/26] time 0.430 (0.480) data 0.299 (0.349) loss_x loss_x 1.7539 (1.4108) acc_x 62.5000 (63.0000) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.2634, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 826
clean true:754
clean false:72
clean_rate:0.9128329297820823
noisy true:657
noisy false:1653
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 2310
epoch [59/200] batch [5/25] time 0.754 (0.581) data 0.624 (0.450) loss_x loss_x 1.5605 (1.4773) acc_x 53.1250 (59.3750) lr 1.6252e-03 eta 0:00:11
epoch [59/200] batch [10/25] time 0.438 (0.539) data 0.306 (0.408) loss_x loss_x 1.3701 (1.3463) acc_x 56.2500 (64.3750) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [15/25] time 0.411 (0.508) data 0.280 (0.377) loss_x loss_x 1.8066 (1.3973) acc_x 53.1250 (63.9583) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [20/25] time 0.539 (0.496) data 0.408 (0.365) loss_x loss_x 1.2031 (1.3668) acc_x 65.6250 (64.8438) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/25] time 0.481 (0.487) data 0.350 (0.356) loss_x loss_x 2.0840 (1.4017) acc_x 59.3750 (64.1250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.2730, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 856
clean true:762
clean false:94
clean_rate:0.8901869158878505
noisy true:672
noisy false:1608
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 2280
epoch [60/200] batch [5/26] time 0.392 (0.424) data 0.261 (0.294) loss_x loss_x 1.4004 (1.6615) acc_x 59.3750 (60.0000) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [10/26] time 0.546 (0.443) data 0.416 (0.313) loss_x loss_x 1.4385 (1.5141) acc_x 62.5000 (62.5000) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [15/26] time 0.545 (0.452) data 0.409 (0.322) loss_x loss_x 1.3447 (1.4656) acc_x 62.5000 (63.7500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [20/26] time 0.556 (0.466) data 0.425 (0.335) loss_x loss_x 1.5078 (1.4699) acc_x 53.1250 (62.6562) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/26] time 0.589 (0.472) data 0.458 (0.340) loss_x loss_x 1.0283 (1.4766) acc_x 81.2500 (63.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1721
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 852
clean true:762
clean false:90
clean_rate:0.8943661971830986
noisy true:653
noisy false:1631
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 2284
epoch [61/200] batch [5/26] time 0.434 (0.492) data 0.302 (0.361) loss_x loss_x 1.4521 (1.3967) acc_x 65.6250 (63.7500) lr 1.6004e-03 eta 0:00:10
epoch [61/200] batch [10/26] time 0.520 (0.461) data 0.388 (0.330) loss_x loss_x 1.2461 (1.3835) acc_x 81.2500 (64.6875) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [15/26] time 0.703 (0.470) data 0.571 (0.339) loss_x loss_x 1.6748 (1.3983) acc_x 71.8750 (64.7917) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [20/26] time 0.364 (0.470) data 0.233 (0.339) loss_x loss_x 1.2627 (1.3981) acc_x 62.5000 (64.0625) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/26] time 0.373 (0.455) data 0.241 (0.324) loss_x loss_x 1.6680 (1.4106) acc_x 56.2500 (63.7500) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1722
confident_label rate tensor(0.2637, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 827
clean true:746
clean false:81
clean_rate:0.9020556227327691
noisy true:668
noisy false:1641
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 2309
epoch [62/200] batch [5/25] time 0.493 (0.418) data 0.362 (0.286) loss_x loss_x 1.5479 (1.4611) acc_x 59.3750 (63.1250) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [10/25] time 0.390 (0.447) data 0.258 (0.315) loss_x loss_x 1.7256 (1.4441) acc_x 50.0000 (63.4375) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [15/25] time 0.374 (0.468) data 0.243 (0.337) loss_x loss_x 1.2920 (1.3878) acc_x 62.5000 (64.5833) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [20/25] time 0.498 (0.475) data 0.367 (0.343) loss_x loss_x 1.6855 (1.3748) acc_x 56.2500 (63.5938) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/25] time 0.505 (0.479) data 0.373 (0.348) loss_x loss_x 1.2451 (1.3453) acc_x 68.7500 (64.5000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.2666, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 836
clean true:756
clean false:80
clean_rate:0.9043062200956937
noisy true:652
noisy false:1648
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 2300
epoch [63/200] batch [5/26] time 0.333 (0.445) data 0.202 (0.314) loss_x loss_x 1.6357 (1.4457) acc_x 59.3750 (61.2500) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [10/26] time 0.469 (0.464) data 0.338 (0.333) loss_x loss_x 1.4102 (1.3904) acc_x 68.7500 (64.6875) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [15/26] time 0.492 (0.484) data 0.361 (0.353) loss_x loss_x 1.2695 (1.3848) acc_x 62.5000 (64.7917) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [20/26] time 0.520 (0.490) data 0.389 (0.359) loss_x loss_x 1.6855 (1.4089) acc_x 59.3750 (64.2188) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/26] time 0.408 (0.477) data 0.277 (0.346) loss_x loss_x 1.4707 (1.4232) acc_x 62.5000 (64.8750) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.2707, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 849
clean true:758
clean false:91
clean_rate:0.8928150765606596
noisy true:610
noisy false:1677
after delete: len(clean_dataset) 849
after delete: len(noisy_dataset) 2287
epoch [64/200] batch [5/26] time 0.482 (0.464) data 0.351 (0.332) loss_x loss_x 1.4961 (1.4402) acc_x 56.2500 (58.1250) lr 1.5621e-03 eta 0:00:09
epoch [64/200] batch [10/26] time 0.437 (0.472) data 0.306 (0.341) loss_x loss_x 1.1777 (1.3352) acc_x 78.1250 (65.6250) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [15/26] time 0.391 (0.477) data 0.261 (0.345) loss_x loss_x 1.4688 (1.3792) acc_x 59.3750 (65.4167) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [20/26] time 0.484 (0.463) data 0.353 (0.332) loss_x loss_x 1.3877 (1.3863) acc_x 65.6250 (63.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/26] time 0.476 (0.469) data 0.346 (0.337) loss_x loss_x 1.0293 (1.4017) acc_x 78.1250 (64.1250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1717
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 848
clean true:758
clean false:90
clean_rate:0.8938679245283019
noisy true:661
noisy false:1627
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 2288
epoch [65/200] batch [5/26] time 0.534 (0.441) data 0.403 (0.310) loss_x loss_x 0.9507 (1.5757) acc_x 71.8750 (56.2500) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [10/26] time 0.519 (0.440) data 0.389 (0.309) loss_x loss_x 1.3516 (1.5456) acc_x 65.6250 (58.7500) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [15/26] time 0.379 (0.429) data 0.249 (0.299) loss_x loss_x 2.5117 (1.5058) acc_x 46.8750 (61.4583) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [20/26] time 0.563 (0.446) data 0.433 (0.315) loss_x loss_x 1.2275 (1.5171) acc_x 65.6250 (60.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/26] time 0.542 (0.454) data 0.411 (0.324) loss_x loss_x 0.8862 (1.4652) acc_x 84.3750 (62.7500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 852
clean true:762
clean false:90
clean_rate:0.8943661971830986
noisy true:630
noisy false:1654
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 2284
epoch [66/200] batch [5/26] time 0.470 (0.436) data 0.338 (0.305) loss_x loss_x 1.0566 (1.2717) acc_x 65.6250 (68.7500) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [10/26] time 0.481 (0.441) data 0.346 (0.309) loss_x loss_x 1.6777 (1.3128) acc_x 56.2500 (65.9375) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [15/26] time 0.402 (0.465) data 0.270 (0.333) loss_x loss_x 1.7539 (1.3773) acc_x 59.3750 (64.7917) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [20/26] time 0.478 (0.476) data 0.347 (0.345) loss_x loss_x 1.2598 (1.3923) acc_x 68.7500 (64.2188) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/26] time 0.533 (0.491) data 0.402 (0.360) loss_x loss_x 0.9561 (1.3155) acc_x 81.2500 (65.7500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1762
confident_label rate tensor(0.2567, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 805
clean true:718
clean false:87
clean_rate:0.8919254658385093
noisy true:656
noisy false:1675
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 2331
epoch [67/200] batch [5/25] time 0.489 (0.452) data 0.358 (0.320) loss_x loss_x 1.1113 (1.3941) acc_x 71.8750 (65.0000) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [10/25] time 0.555 (0.486) data 0.424 (0.355) loss_x loss_x 1.6211 (1.4413) acc_x 50.0000 (61.2500) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [15/25] time 0.572 (0.497) data 0.441 (0.366) loss_x loss_x 1.4316 (1.4692) acc_x 62.5000 (62.0833) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [20/25] time 0.358 (0.483) data 0.227 (0.352) loss_x loss_x 1.1191 (1.4190) acc_x 75.0000 (63.9062) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/25] time 0.500 (0.473) data 0.368 (0.342) loss_x loss_x 0.9790 (1.3700) acc_x 68.7500 (65.1250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1754
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:737
clean false:75
clean_rate:0.9076354679802956
noisy true:645
noisy false:1679
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [68/200] batch [5/25] time 0.363 (0.402) data 0.233 (0.270) loss_x loss_x 1.4277 (1.4781) acc_x 68.7500 (63.1250) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [10/25] time 0.468 (0.480) data 0.337 (0.349) loss_x loss_x 0.9082 (1.3714) acc_x 71.8750 (66.2500) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [15/25] time 0.456 (0.479) data 0.324 (0.347) loss_x loss_x 1.4824 (1.3481) acc_x 65.6250 (66.2500) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/25] time 0.455 (0.469) data 0.323 (0.337) loss_x loss_x 1.7002 (1.3282) acc_x 59.3750 (67.1875) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/25] time 0.498 (0.474) data 0.367 (0.343) loss_x loss_x 2.0117 (1.3631) acc_x 56.2500 (66.3750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.2650, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 831
clean true:742
clean false:89
clean_rate:0.8929001203369434
noisy true:666
noisy false:1639
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 2305
epoch [69/200] batch [5/25] time 0.712 (0.486) data 0.581 (0.355) loss_x loss_x 1.0850 (1.1563) acc_x 78.1250 (70.0000) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [10/25] time 0.657 (0.510) data 0.526 (0.378) loss_x loss_x 1.1113 (1.3236) acc_x 68.7500 (66.2500) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [15/25] time 0.478 (0.523) data 0.344 (0.391) loss_x loss_x 1.2129 (1.3372) acc_x 75.0000 (66.8750) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [20/25] time 0.438 (0.501) data 0.307 (0.369) loss_x loss_x 1.1963 (1.3436) acc_x 65.6250 (64.6875) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/25] time 0.494 (0.481) data 0.363 (0.349) loss_x loss_x 1.5391 (1.3521) acc_x 62.5000 (64.7500) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1730
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 848
clean true:762
clean false:86
clean_rate:0.8985849056603774
noisy true:644
noisy false:1644
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 2288
epoch [70/200] batch [5/26] time 0.414 (0.494) data 0.284 (0.363) loss_x loss_x 1.6270 (1.4059) acc_x 62.5000 (64.3750) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [10/26] time 0.450 (0.468) data 0.320 (0.338) loss_x loss_x 1.0625 (1.3982) acc_x 59.3750 (63.4375) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [15/26] time 0.523 (0.480) data 0.392 (0.350) loss_x loss_x 1.0771 (1.3626) acc_x 65.6250 (64.1667) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [20/26] time 0.363 (0.470) data 0.232 (0.340) loss_x loss_x 1.1846 (1.3833) acc_x 68.7500 (63.7500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/26] time 0.459 (0.473) data 0.329 (0.343) loss_x loss_x 0.9858 (1.3513) acc_x 71.8750 (64.1250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1724
confident_label rate tensor(0.2752, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 863
clean true:766
clean false:97
clean_rate:0.8876013904982619
noisy true:646
noisy false:1627
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 2273
epoch [71/200] batch [5/26] time 0.363 (0.469) data 0.232 (0.338) loss_x loss_x 1.2803 (1.2559) acc_x 68.7500 (68.7500) lr 1.4679e-03 eta 0:00:09
epoch [71/200] batch [10/26] time 0.436 (0.467) data 0.305 (0.336) loss_x loss_x 2.1230 (1.4169) acc_x 56.2500 (65.3125) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [15/26] time 0.553 (0.471) data 0.423 (0.340) loss_x loss_x 1.0215 (1.3562) acc_x 71.8750 (66.2500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [20/26] time 0.425 (0.467) data 0.295 (0.337) loss_x loss_x 1.5996 (1.3700) acc_x 62.5000 (65.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/26] time 0.413 (0.462) data 0.283 (0.331) loss_x loss_x 1.0615 (1.3012) acc_x 65.6250 (67.1250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.2787, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 874
clean true:783
clean false:91
clean_rate:0.8958810068649885
noisy true:678
noisy false:1584
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 2262
epoch [72/200] batch [5/27] time 0.374 (0.457) data 0.243 (0.325) loss_x loss_x 1.3174 (1.3845) acc_x 59.3750 (66.2500) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [10/27] time 0.399 (0.438) data 0.268 (0.306) loss_x loss_x 1.8418 (1.3566) acc_x 50.0000 (66.8750) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [15/27] time 0.406 (0.454) data 0.276 (0.323) loss_x loss_x 1.3457 (1.3394) acc_x 59.3750 (65.2083) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [20/27] time 0.733 (0.474) data 0.602 (0.344) loss_x loss_x 0.8813 (1.3178) acc_x 71.8750 (66.4062) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/27] time 0.468 (0.482) data 0.337 (0.351) loss_x loss_x 1.6230 (1.3470) acc_x 62.5000 (64.8750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.2720, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 853
clean true:774
clean false:79
clean_rate:0.9073856975381008
noisy true:647
noisy false:1636
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 2283
epoch [73/200] batch [5/26] time 0.389 (0.418) data 0.258 (0.287) loss_x loss_x 1.2090 (1.2418) acc_x 68.7500 (69.3750) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [10/26] time 0.405 (0.447) data 0.274 (0.317) loss_x loss_x 1.5752 (1.3727) acc_x 65.6250 (67.1875) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [15/26] time 0.487 (0.449) data 0.356 (0.318) loss_x loss_x 1.5000 (1.3847) acc_x 53.1250 (66.0417) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [20/26] time 0.562 (0.452) data 0.431 (0.321) loss_x loss_x 1.2842 (1.4122) acc_x 68.7500 (64.0625) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/26] time 0.658 (0.461) data 0.528 (0.330) loss_x loss_x 2.0117 (1.4030) acc_x 43.7500 (63.7500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2596, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 814
clean true:739
clean false:75
clean_rate:0.9078624078624079
noisy true:624
noisy false:1698
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 2322
epoch [74/200] batch [5/25] time 0.432 (0.473) data 0.301 (0.342) loss_x loss_x 0.6851 (1.2808) acc_x 81.2500 (69.3750) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [10/25] time 0.436 (0.480) data 0.305 (0.349) loss_x loss_x 0.9897 (1.1813) acc_x 71.8750 (70.3125) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [15/25] time 0.484 (0.479) data 0.353 (0.348) loss_x loss_x 1.2793 (1.2427) acc_x 65.6250 (68.5417) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [20/25] time 0.386 (0.479) data 0.255 (0.348) loss_x loss_x 1.3096 (1.2607) acc_x 62.5000 (67.8125) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/25] time 0.409 (0.470) data 0.278 (0.338) loss_x loss_x 0.9722 (1.2944) acc_x 68.7500 (66.5000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 876
clean true:790
clean false:86
clean_rate:0.9018264840182648
noisy true:644
noisy false:1616
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 2260
epoch [75/200] batch [5/27] time 0.420 (0.494) data 0.289 (0.363) loss_x loss_x 1.4238 (1.4127) acc_x 65.6250 (63.7500) lr 1.4115e-03 eta 0:00:10
epoch [75/200] batch [10/27] time 0.449 (0.496) data 0.318 (0.364) loss_x loss_x 0.9917 (1.3178) acc_x 75.0000 (65.6250) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [15/27] time 0.554 (0.488) data 0.423 (0.357) loss_x loss_x 0.8853 (1.3370) acc_x 81.2500 (65.2083) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [20/27] time 0.426 (0.474) data 0.295 (0.343) loss_x loss_x 1.5947 (1.3458) acc_x 65.6250 (65.4688) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [25/27] time 0.632 (0.473) data 0.502 (0.342) loss_x loss_x 1.3262 (1.3723) acc_x 65.6250 (65.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2714, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 851
clean true:774
clean false:77
clean_rate:0.9095182138660399
noisy true:666
noisy false:1619
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 2285
epoch [76/200] batch [5/26] time 0.472 (0.476) data 0.341 (0.345) loss_x loss_x 1.1436 (1.5746) acc_x 62.5000 (56.2500) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [10/26] time 0.417 (0.470) data 0.286 (0.339) loss_x loss_x 1.4072 (1.6101) acc_x 62.5000 (57.5000) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [15/26] time 0.378 (0.472) data 0.247 (0.340) loss_x loss_x 1.4658 (1.4675) acc_x 68.7500 (61.2500) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [20/26] time 0.450 (0.471) data 0.319 (0.340) loss_x loss_x 1.5518 (1.4927) acc_x 65.6250 (62.5000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/26] time 0.374 (0.474) data 0.243 (0.342) loss_x loss_x 1.4619 (1.5025) acc_x 53.1250 (61.7500) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1705
confident_label rate tensor(0.2666, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 836
clean true:756
clean false:80
clean_rate:0.9043062200956937
noisy true:675
noisy false:1625
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 2300
epoch [77/200] batch [5/26] time 0.437 (0.399) data 0.306 (0.268) loss_x loss_x 1.4268 (1.2701) acc_x 68.7500 (67.5000) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [10/26] time 0.532 (0.464) data 0.401 (0.333) loss_x loss_x 1.0244 (1.2737) acc_x 75.0000 (68.1250) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [15/26] time 0.469 (0.478) data 0.338 (0.347) loss_x loss_x 1.5107 (1.3577) acc_x 62.5000 (65.6250) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [20/26] time 0.443 (0.467) data 0.312 (0.336) loss_x loss_x 0.9570 (1.3226) acc_x 71.8750 (66.2500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/26] time 0.422 (0.461) data 0.291 (0.330) loss_x loss_x 1.0840 (1.2981) acc_x 68.7500 (66.7500) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 852
clean true:753
clean false:99
clean_rate:0.8838028169014085
noisy true:626
noisy false:1658
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 2284
epoch [78/200] batch [5/26] time 0.540 (0.457) data 0.409 (0.327) loss_x loss_x 1.1875 (1.2244) acc_x 56.2500 (67.5000) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [10/26] time 0.508 (0.476) data 0.378 (0.344) loss_x loss_x 0.9170 (1.2002) acc_x 65.6250 (67.1875) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [15/26] time 0.448 (0.467) data 0.317 (0.336) loss_x loss_x 1.7129 (1.2621) acc_x 65.6250 (65.6250) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [20/26] time 0.537 (0.471) data 0.407 (0.340) loss_x loss_x 1.1836 (1.2704) acc_x 81.2500 (65.9375) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/26] time 0.399 (0.475) data 0.268 (0.344) loss_x loss_x 1.1709 (1.3124) acc_x 62.5000 (64.6250) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1718
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:786
clean false:96
clean_rate:0.891156462585034
noisy true:632
noisy false:1622
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [79/200] batch [5/27] time 0.343 (0.466) data 0.211 (0.335) loss_x loss_x 1.5742 (1.4963) acc_x 75.0000 (62.5000) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [10/27] time 0.470 (0.483) data 0.338 (0.352) loss_x loss_x 1.0322 (1.3584) acc_x 81.2500 (68.4375) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [15/27] time 0.446 (0.474) data 0.315 (0.343) loss_x loss_x 1.8184 (1.4382) acc_x 56.2500 (66.0417) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [20/27] time 0.392 (0.464) data 0.260 (0.333) loss_x loss_x 1.3047 (1.4128) acc_x 65.6250 (65.1562) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [25/27] time 0.522 (0.475) data 0.391 (0.343) loss_x loss_x 1.6562 (1.4162) acc_x 62.5000 (64.5000) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.2631, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 825
clean true:739
clean false:86
clean_rate:0.8957575757575758
noisy true:654
noisy false:1657
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 2311
epoch [80/200] batch [5/25] time 0.383 (0.475) data 0.252 (0.344) loss_x loss_x 1.5234 (1.3816) acc_x 50.0000 (63.1250) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [10/25] time 0.477 (0.449) data 0.347 (0.318) loss_x loss_x 1.3418 (1.2807) acc_x 75.0000 (68.1250) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [15/25] time 0.446 (0.459) data 0.315 (0.328) loss_x loss_x 1.3613 (1.2263) acc_x 71.8750 (70.0000) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [20/25] time 0.421 (0.454) data 0.289 (0.323) loss_x loss_x 1.4180 (1.3146) acc_x 62.5000 (67.9688) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/25] time 0.486 (0.450) data 0.355 (0.319) loss_x loss_x 1.5527 (1.3110) acc_x 62.5000 (68.0000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1693
confident_label rate tensor(0.2742, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 860
clean true:777
clean false:83
clean_rate:0.9034883720930232
noisy true:666
noisy false:1610
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 2276
epoch [81/200] batch [5/26] time 0.482 (0.500) data 0.351 (0.369) loss_x loss_x 1.5068 (1.6080) acc_x 56.2500 (54.3750) lr 1.3239e-03 eta 0:00:10
epoch [81/200] batch [10/26] time 0.468 (0.479) data 0.337 (0.347) loss_x loss_x 1.8154 (1.5877) acc_x 62.5000 (57.8125) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [15/26] time 0.438 (0.470) data 0.306 (0.339) loss_x loss_x 1.1348 (1.3891) acc_x 68.7500 (61.2500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [20/26] time 0.421 (0.483) data 0.291 (0.352) loss_x loss_x 1.2441 (1.3651) acc_x 56.2500 (62.0312) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/26] time 0.492 (0.484) data 0.362 (0.352) loss_x loss_x 1.2246 (1.3367) acc_x 68.7500 (63.6250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.2765, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 867
clean true:779
clean false:88
clean_rate:0.8985005767012687
noisy true:648
noisy false:1621
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 2269
epoch [82/200] batch [5/27] time 0.416 (0.493) data 0.284 (0.361) loss_x loss_x 1.3428 (1.2404) acc_x 62.5000 (66.8750) lr 1.3090e-03 eta 0:00:10
epoch [82/200] batch [10/27] time 0.442 (0.497) data 0.312 (0.366) loss_x loss_x 2.1133 (1.3048) acc_x 56.2500 (66.5625) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [15/27] time 0.321 (0.459) data 0.191 (0.328) loss_x loss_x 1.0547 (1.2910) acc_x 71.8750 (66.8750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [20/27] time 0.491 (0.470) data 0.361 (0.340) loss_x loss_x 1.2256 (1.2495) acc_x 62.5000 (67.1875) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [25/27] time 0.674 (0.483) data 0.539 (0.351) loss_x loss_x 1.5195 (1.2792) acc_x 65.6250 (67.3750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.2848, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 893
clean true:794
clean false:99
clean_rate:0.8891377379619261
noisy true:650
noisy false:1593
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 2243
epoch [83/200] batch [5/27] time 0.511 (0.523) data 0.381 (0.393) loss_x loss_x 1.4648 (1.5248) acc_x 56.2500 (57.5000) lr 1.2940e-03 eta 0:00:11
epoch [83/200] batch [10/27] time 0.496 (0.499) data 0.364 (0.369) loss_x loss_x 1.0488 (1.3393) acc_x 84.3750 (65.0000) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [15/27] time 0.472 (0.485) data 0.340 (0.354) loss_x loss_x 1.1240 (1.3251) acc_x 65.6250 (64.7917) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [20/27] time 0.411 (0.477) data 0.280 (0.346) loss_x loss_x 1.2402 (1.3178) acc_x 75.0000 (66.0938) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [25/27] time 0.367 (0.465) data 0.236 (0.334) loss_x loss_x 1.1201 (1.3064) acc_x 71.8750 (66.5000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1705
confident_label rate tensor(0.2797, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 877
clean true:784
clean false:93
clean_rate:0.8939566704675028
noisy true:647
noisy false:1612
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 2259
epoch [84/200] batch [5/27] time 0.503 (0.489) data 0.371 (0.357) loss_x loss_x 1.3213 (1.5680) acc_x 59.3750 (60.6250) lr 1.2790e-03 eta 0:00:10
epoch [84/200] batch [10/27] time 0.392 (0.470) data 0.261 (0.339) loss_x loss_x 1.3418 (1.6150) acc_x 75.0000 (59.6875) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [15/27] time 0.386 (0.454) data 0.254 (0.323) loss_x loss_x 0.8999 (1.4685) acc_x 71.8750 (63.5417) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [20/27] time 0.433 (0.467) data 0.303 (0.336) loss_x loss_x 1.1182 (1.4347) acc_x 75.0000 (64.8438) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [25/27] time 0.450 (0.465) data 0.318 (0.334) loss_x loss_x 1.3848 (1.4311) acc_x 65.6250 (65.0000) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1726
confident_label rate tensor(0.2771, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 869
clean true:773
clean false:96
clean_rate:0.8895281933256617
noisy true:637
noisy false:1630
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 2267
epoch [85/200] batch [5/27] time 0.590 (0.580) data 0.459 (0.450) loss_x loss_x 1.4941 (1.1175) acc_x 56.2500 (72.5000) lr 1.2639e-03 eta 0:00:12
epoch [85/200] batch [10/27] time 0.410 (0.517) data 0.280 (0.386) loss_x loss_x 0.9375 (1.2629) acc_x 71.8750 (67.5000) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [15/27] time 0.478 (0.516) data 0.348 (0.385) loss_x loss_x 1.5586 (1.2583) acc_x 75.0000 (68.3333) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [20/27] time 0.474 (0.502) data 0.343 (0.371) loss_x loss_x 1.4941 (1.2835) acc_x 59.3750 (67.6562) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [25/27] time 0.581 (0.496) data 0.449 (0.365) loss_x loss_x 1.1699 (1.2844) acc_x 65.6250 (67.7500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:791
clean false:91
clean_rate:0.8968253968253969
noisy true:664
noisy false:1590
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [86/200] batch [5/27] time 0.507 (0.478) data 0.375 (0.347) loss_x loss_x 1.9590 (1.4255) acc_x 56.2500 (65.6250) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [10/27] time 0.564 (0.475) data 0.432 (0.343) loss_x loss_x 1.4756 (1.4608) acc_x 62.5000 (63.7500) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [15/27] time 0.528 (0.478) data 0.397 (0.347) loss_x loss_x 1.4346 (1.3971) acc_x 59.3750 (65.0000) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [20/27] time 0.452 (0.477) data 0.320 (0.345) loss_x loss_x 1.2178 (1.4176) acc_x 68.7500 (64.2188) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [25/27] time 0.428 (0.476) data 0.296 (0.344) loss_x loss_x 1.1533 (1.4091) acc_x 71.8750 (63.8750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1712
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:792
clean false:90
clean_rate:0.8979591836734694
noisy true:632
noisy false:1622
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [87/200] batch [5/27] time 0.474 (0.440) data 0.343 (0.309) loss_x loss_x 1.2051 (1.2424) acc_x 71.8750 (66.8750) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/27] time 0.361 (0.451) data 0.230 (0.320) loss_x loss_x 1.0068 (1.2169) acc_x 71.8750 (67.5000) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/27] time 0.413 (0.454) data 0.282 (0.323) loss_x loss_x 1.5840 (1.2352) acc_x 59.3750 (66.6667) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [20/27] time 0.520 (0.469) data 0.389 (0.338) loss_x loss_x 1.3896 (1.2508) acc_x 68.7500 (66.4062) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [25/27] time 0.472 (0.477) data 0.341 (0.346) loss_x loss_x 1.1777 (1.2594) acc_x 62.5000 (66.1250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.2768, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 868
clean true:779
clean false:89
clean_rate:0.8974654377880185
noisy true:658
noisy false:1610
after delete: len(clean_dataset) 868
after delete: len(noisy_dataset) 2268
epoch [88/200] batch [5/27] time 0.556 (0.595) data 0.425 (0.462) loss_x loss_x 1.8945 (1.4674) acc_x 56.2500 (60.0000) lr 1.2181e-03 eta 0:00:13
epoch [88/200] batch [10/27] time 0.484 (0.555) data 0.352 (0.422) loss_x loss_x 1.7402 (1.4541) acc_x 65.6250 (62.5000) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [15/27] time 0.492 (0.528) data 0.360 (0.395) loss_x loss_x 1.2979 (1.4572) acc_x 71.8750 (63.3333) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [20/27] time 0.461 (0.511) data 0.330 (0.379) loss_x loss_x 1.2168 (1.4295) acc_x 68.7500 (64.0625) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [25/27] time 0.554 (0.504) data 0.423 (0.372) loss_x loss_x 1.3633 (1.4007) acc_x 56.2500 (64.3750) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 855
clean true:772
clean false:83
clean_rate:0.9029239766081871
noisy true:687
noisy false:1594
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 2281
epoch [89/200] batch [5/26] time 0.364 (0.451) data 0.233 (0.319) loss_x loss_x 1.1641 (1.2611) acc_x 75.0000 (67.5000) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/26] time 0.481 (0.471) data 0.349 (0.340) loss_x loss_x 1.1064 (1.1839) acc_x 68.7500 (70.3125) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [15/26] time 0.460 (0.450) data 0.329 (0.318) loss_x loss_x 1.0469 (1.1977) acc_x 75.0000 (70.6250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [20/26] time 0.435 (0.457) data 0.304 (0.326) loss_x loss_x 1.2656 (1.2327) acc_x 62.5000 (69.5312) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/26] time 0.492 (0.465) data 0.361 (0.333) loss_x loss_x 1.2754 (1.2752) acc_x 62.5000 (67.6250) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1738
confident_label rate tensor(0.2682, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 841
clean true:749
clean false:92
clean_rate:0.8906064209274673
noisy true:649
noisy false:1646
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 2295
epoch [90/200] batch [5/26] time 0.443 (0.460) data 0.313 (0.329) loss_x loss_x 1.2188 (1.2917) acc_x 71.8750 (68.1250) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/26] time 0.442 (0.470) data 0.311 (0.338) loss_x loss_x 1.4922 (1.3108) acc_x 71.8750 (66.5625) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [15/26] time 0.455 (0.467) data 0.324 (0.336) loss_x loss_x 1.1602 (1.2623) acc_x 62.5000 (65.8333) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [20/26] time 0.423 (0.460) data 0.292 (0.329) loss_x loss_x 1.0342 (1.2894) acc_x 71.8750 (65.1562) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/26] time 0.429 (0.458) data 0.298 (0.327) loss_x loss_x 1.3730 (1.3324) acc_x 68.7500 (65.0000) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1690
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 885
clean true:795
clean false:90
clean_rate:0.8983050847457628
noisy true:651
noisy false:1600
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 2251
epoch [91/200] batch [5/27] time 0.499 (0.501) data 0.367 (0.369) loss_x loss_x 1.1631 (1.2916) acc_x 68.7500 (66.8750) lr 1.1719e-03 eta 0:00:11
epoch [91/200] batch [10/27] time 0.458 (0.478) data 0.326 (0.346) loss_x loss_x 1.8125 (1.4762) acc_x 56.2500 (63.7500) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/27] time 0.428 (0.466) data 0.297 (0.334) loss_x loss_x 1.4043 (1.4646) acc_x 68.7500 (63.7500) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [20/27] time 0.599 (0.480) data 0.468 (0.348) loss_x loss_x 1.2637 (1.4161) acc_x 65.6250 (64.8438) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [25/27] time 0.495 (0.475) data 0.364 (0.344) loss_x loss_x 1.6650 (1.4106) acc_x 53.1250 (65.1250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:788
clean false:94
clean_rate:0.8934240362811792
noisy true:652
noisy false:1602
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [92/200] batch [5/27] time 0.364 (0.466) data 0.233 (0.335) loss_x loss_x 1.5596 (1.4541) acc_x 59.3750 (60.0000) lr 1.1564e-03 eta 0:00:10
epoch [92/200] batch [10/27] time 0.430 (0.433) data 0.298 (0.302) loss_x loss_x 1.8857 (1.4457) acc_x 53.1250 (62.8125) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/27] time 0.399 (0.428) data 0.267 (0.296) loss_x loss_x 1.5371 (1.3975) acc_x 62.5000 (63.9583) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [20/27] time 0.381 (0.436) data 0.249 (0.304) loss_x loss_x 1.6357 (1.3766) acc_x 65.6250 (64.6875) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [25/27] time 0.552 (0.446) data 0.421 (0.314) loss_x loss_x 1.2588 (1.3880) acc_x 68.7500 (63.0000) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 884
clean true:786
clean false:98
clean_rate:0.8891402714932126
noisy true:663
noisy false:1589
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 2252
epoch [93/200] batch [5/27] time 0.386 (0.459) data 0.254 (0.327) loss_x loss_x 1.6025 (1.5107) acc_x 50.0000 (61.8750) lr 1.1409e-03 eta 0:00:10
epoch [93/200] batch [10/27] time 0.531 (0.462) data 0.399 (0.331) loss_x loss_x 1.1406 (1.3923) acc_x 71.8750 (65.3125) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [15/27] time 0.423 (0.474) data 0.293 (0.343) loss_x loss_x 1.2578 (1.3619) acc_x 78.1250 (67.0833) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [20/27] time 0.547 (0.476) data 0.416 (0.345) loss_x loss_x 1.2051 (1.3972) acc_x 56.2500 (65.3125) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [25/27] time 0.679 (0.486) data 0.548 (0.355) loss_x loss_x 1.2158 (1.3713) acc_x 62.5000 (66.5000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.2854, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 895
clean true:801
clean false:94
clean_rate:0.8949720670391061
noisy true:643
noisy false:1598
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 2241
epoch [94/200] batch [5/27] time 0.390 (0.419) data 0.259 (0.288) loss_x loss_x 1.1504 (1.3230) acc_x 71.8750 (65.6250) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [10/27] time 0.548 (0.467) data 0.417 (0.335) loss_x loss_x 1.4375 (1.3615) acc_x 59.3750 (65.0000) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/27] time 0.409 (0.470) data 0.278 (0.339) loss_x loss_x 1.5527 (1.3223) acc_x 56.2500 (65.2083) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [20/27] time 0.505 (0.472) data 0.374 (0.341) loss_x loss_x 1.0977 (1.3409) acc_x 65.6250 (63.9062) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [25/27] time 0.461 (0.465) data 0.330 (0.334) loss_x loss_x 1.2139 (1.3516) acc_x 65.6250 (63.7500) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 921
clean true:822
clean false:99
clean_rate:0.8925081433224755
noisy true:674
noisy false:1541
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 2215
epoch [95/200] batch [5/28] time 0.537 (0.560) data 0.405 (0.428) loss_x loss_x 1.0195 (1.3010) acc_x 75.0000 (68.1250) lr 1.1097e-03 eta 0:00:12
epoch [95/200] batch [10/28] time 0.395 (0.537) data 0.263 (0.406) loss_x loss_x 1.3291 (1.3115) acc_x 68.7500 (65.0000) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [15/28] time 0.530 (0.506) data 0.398 (0.375) loss_x loss_x 1.2227 (1.3581) acc_x 65.6250 (63.7500) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [20/28] time 0.460 (0.492) data 0.328 (0.360) loss_x loss_x 1.3330 (1.3729) acc_x 75.0000 (63.9062) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [25/28] time 0.431 (0.483) data 0.300 (0.352) loss_x loss_x 1.7656 (1.3647) acc_x 53.1250 (63.7500) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1689
confident_label rate tensor(0.2832, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 888
clean true:793
clean false:95
clean_rate:0.8930180180180181
noisy true:654
noisy false:1594
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 2248
epoch [96/200] batch [5/27] time 0.609 (0.451) data 0.479 (0.320) loss_x loss_x 1.4805 (1.4902) acc_x 53.1250 (56.8750) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [10/27] time 0.407 (0.464) data 0.276 (0.333) loss_x loss_x 1.9863 (1.3993) acc_x 59.3750 (61.2500) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/27] time 0.442 (0.448) data 0.312 (0.317) loss_x loss_x 2.2363 (1.4722) acc_x 53.1250 (61.6667) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [20/27] time 0.640 (0.474) data 0.502 (0.342) loss_x loss_x 1.0967 (1.4086) acc_x 75.0000 (63.9062) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [25/27] time 0.448 (0.484) data 0.317 (0.353) loss_x loss_x 1.0869 (1.3512) acc_x 75.0000 (65.3750) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1705
confident_label rate tensor(0.2860, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 897
clean true:805
clean false:92
clean_rate:0.8974358974358975
noisy true:626
noisy false:1613
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 2239
epoch [97/200] batch [5/28] time 0.433 (0.470) data 0.301 (0.338) loss_x loss_x 1.1143 (1.0845) acc_x 75.0000 (72.5000) lr 1.0785e-03 eta 0:00:10
epoch [97/200] batch [10/28] time 0.407 (0.462) data 0.275 (0.331) loss_x loss_x 0.9673 (1.0833) acc_x 78.1250 (72.8125) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [15/28] time 0.345 (0.441) data 0.214 (0.309) loss_x loss_x 1.4971 (1.1820) acc_x 65.6250 (69.7917) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [20/28] time 0.711 (0.478) data 0.579 (0.346) loss_x loss_x 0.6094 (1.1621) acc_x 90.6250 (69.8438) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [25/28] time 0.546 (0.479) data 0.415 (0.348) loss_x loss_x 1.1572 (1.1882) acc_x 68.7500 (69.3750) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 884
clean true:789
clean false:95
clean_rate:0.8925339366515838
noisy true:648
noisy false:1604
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 2252
epoch [98/200] batch [5/27] time 0.472 (0.456) data 0.341 (0.325) loss_x loss_x 0.9819 (1.1450) acc_x 81.2500 (74.3750) lr 1.0628e-03 eta 0:00:10
epoch [98/200] batch [10/27] time 0.428 (0.452) data 0.297 (0.321) loss_x loss_x 1.0107 (1.2111) acc_x 78.1250 (72.1875) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [15/27] time 0.620 (0.479) data 0.490 (0.348) loss_x loss_x 1.9121 (1.2983) acc_x 62.5000 (70.0000) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [20/27] time 0.429 (0.480) data 0.297 (0.348) loss_x loss_x 1.1309 (1.3016) acc_x 68.7500 (68.9062) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [25/27] time 0.460 (0.475) data 0.328 (0.344) loss_x loss_x 0.6660 (1.2621) acc_x 81.2500 (69.0000) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.2857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 896
clean true:802
clean false:94
clean_rate:0.8950892857142857
noisy true:665
noisy false:1575
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 2240
epoch [99/200] batch [5/28] time 0.580 (0.578) data 0.448 (0.445) loss_x loss_x 0.9487 (1.3093) acc_x 71.8750 (68.7500) lr 1.0471e-03 eta 0:00:13
epoch [99/200] batch [10/28] time 0.422 (0.531) data 0.290 (0.399) loss_x loss_x 1.1855 (1.2459) acc_x 71.8750 (68.7500) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [15/28] time 0.400 (0.508) data 0.269 (0.376) loss_x loss_x 0.9858 (1.2979) acc_x 78.1250 (66.2500) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [20/28] time 0.522 (0.506) data 0.390 (0.375) loss_x loss_x 1.8125 (1.3193) acc_x 59.3750 (66.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [25/28] time 0.489 (0.500) data 0.358 (0.368) loss_x loss_x 1.2461 (1.3000) acc_x 68.7500 (66.8750) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.2730, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 856
clean true:767
clean false:89
clean_rate:0.8960280373831776
noisy true:634
noisy false:1646
all clean rate:  [0.853448275862069, 0.8938679245283019, 0.9190839694656489, 0.9144927536231884, 0.9101796407185628, 0.9126074498567335, 0.9064245810055865, 0.9034175334323923, 0.9029126213592233, 0.9037433155080213, 0.9124487004103967, 0.9197860962566845, 0.922972972972973, 0.9094594594594595, 0.9185282522996058, 0.904891304347826, 0.9112582781456954, 0.9168900804289544, 0.9282868525896414, 0.897196261682243, 0.9251040221914009, 0.9189907038512616, 0.9144385026737968, 0.9148099606815203, 0.9357429718875502, 0.9195979899497487, 0.9081761006289308, 0.9177377892030848, 0.9079118028534371, 0.910828025477707, 0.9235668789808917, 0.9129852744310576, 0.9187817258883249, 0.9313984168865436, 0.9161290322580645, 0.912883435582822, 0.911504424778761, 0.9099876695437731, 0.8992443324937027, 0.912932138284251, 0.9017964071856287, 0.9117647058823529, 0.9168797953964194, 0.892459826946848, 0.9092055485498108, 0.9102870813397129, 0.8994011976047904, 0.8986058301647655, 0.8993788819875776, 0.8967587034813925, 0.9129886506935687, 0.8902589395807645, 0.8835534213685474, 0.9098765432098765, 0.8939213349225268, 0.9018867924528302, 0.8934624697336562, 0.8920521945432978, 0.9128329297820823, 0.8901869158878505, 0.8943661971830986, 0.9020556227327691, 0.9043062200956937, 0.8928150765606596, 0.8938679245283019, 0.8943661971830986, 0.8919254658385093, 0.9076354679802956, 0.8929001203369434, 0.8985849056603774, 0.8876013904982619, 0.8958810068649885, 0.9073856975381008, 0.9078624078624079, 0.9018264840182648, 0.9095182138660399, 0.9043062200956937, 0.8838028169014085, 0.891156462585034, 0.8957575757575758, 0.9034883720930232, 0.8985005767012687, 0.8891377379619261, 0.8939566704675028, 0.8895281933256617, 0.8968253968253969, 0.8979591836734694, 0.8974654377880185, 0.9029239766081871, 0.8906064209274673, 0.8983050847457628, 0.8934240362811792, 0.8891402714932126, 0.8949720670391061, 0.8925081433224755, 0.8930180180180181, 0.8974358974358975, 0.8925339366515838, 0.8950892857142857, 0.8960280373831776]
after delete: len(clean_dataset) 856
after delete: len(noisy_dataset) 2280
epoch [100/200] batch [5/26] time 0.408 (0.473) data 0.277 (0.342) loss_x loss_x 0.9521 (1.0615) acc_x 78.1250 (72.5000) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [10/26] time 0.410 (0.491) data 0.279 (0.359) loss_x loss_x 1.0947 (1.0730) acc_x 68.7500 (72.1875) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [15/26] time 0.416 (0.474) data 0.284 (0.343) loss_x loss_x 1.4346 (1.1287) acc_x 62.5000 (70.0000) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [20/26] time 0.419 (0.471) data 0.287 (0.340) loss_x loss_x 0.9395 (1.1702) acc_x 71.8750 (68.5938) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/26] time 0.394 (0.470) data 0.263 (0.339) loss_x loss_x 0.8491 (1.1569) acc_x 75.0000 (69.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.2876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 902
clean true:806
clean false:96
clean_rate:0.893569844789357
noisy true:660
noisy false:1574
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 2234
epoch [101/200] batch [5/28] time 0.427 (0.483) data 0.297 (0.352) loss_x loss_x 1.3809 (1.2273) acc_x 65.6250 (69.3750) lr 1.0157e-03 eta 0:00:11
epoch [101/200] batch [10/28] time 0.433 (0.484) data 0.302 (0.353) loss_x loss_x 1.0654 (1.3503) acc_x 65.6250 (64.3750) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [15/28] time 0.496 (0.461) data 0.365 (0.330) loss_x loss_x 1.6504 (1.3812) acc_x 56.2500 (63.1250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [20/28] time 0.449 (0.458) data 0.318 (0.327) loss_x loss_x 1.0508 (1.2972) acc_x 71.8750 (65.3125) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [25/28] time 0.408 (0.459) data 0.277 (0.328) loss_x loss_x 1.3457 (1.2886) acc_x 75.0000 (65.8750) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1694
confident_label rate tensor(0.2774, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 870
clean true:777
clean false:93
clean_rate:0.8931034482758621
noisy true:665
noisy false:1601
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 2266
epoch [102/200] batch [5/27] time 0.457 (0.461) data 0.326 (0.331) loss_x loss_x 1.3398 (1.2517) acc_x 71.8750 (70.0000) lr 1.0000e-03 eta 0:00:10
epoch [102/200] batch [10/27] time 0.430 (0.457) data 0.298 (0.326) loss_x loss_x 1.6641 (1.2749) acc_x 56.2500 (68.4375) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [15/27] time 0.406 (0.455) data 0.276 (0.324) loss_x loss_x 1.5703 (1.2797) acc_x 59.3750 (67.7083) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [20/27] time 0.524 (0.459) data 0.392 (0.328) loss_x loss_x 0.9785 (1.2597) acc_x 75.0000 (67.9688) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [25/27] time 0.516 (0.460) data 0.385 (0.329) loss_x loss_x 1.4365 (1.2832) acc_x 62.5000 (67.5000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1708
confident_label rate tensor(0.2835, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 889
clean true:786
clean false:103
clean_rate:0.8841394825646794
noisy true:642
noisy false:1605
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 2247
epoch [103/200] batch [5/27] time 0.498 (0.504) data 0.367 (0.372) loss_x loss_x 1.3857 (1.4439) acc_x 65.6250 (63.7500) lr 9.8429e-04 eta 0:00:11
epoch [103/200] batch [10/27] time 0.360 (0.484) data 0.230 (0.353) loss_x loss_x 1.2705 (1.3331) acc_x 68.7500 (67.8125) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [15/27] time 0.560 (0.504) data 0.427 (0.373) loss_x loss_x 1.3320 (1.2639) acc_x 68.7500 (69.5833) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [20/27] time 0.631 (0.495) data 0.499 (0.364) loss_x loss_x 0.8877 (1.2943) acc_x 71.8750 (67.6562) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [25/27] time 0.621 (0.506) data 0.490 (0.375) loss_x loss_x 1.1377 (1.2223) acc_x 75.0000 (70.0000) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1708
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:781
clean false:101
clean_rate:0.8854875283446711
noisy true:647
noisy false:1607
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [104/200] batch [5/27] time 0.459 (0.418) data 0.327 (0.286) loss_x loss_x 1.6055 (1.3054) acc_x 62.5000 (67.5000) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [10/27] time 0.572 (0.443) data 0.441 (0.311) loss_x loss_x 1.6963 (1.3482) acc_x 62.5000 (65.9375) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/27] time 0.407 (0.435) data 0.276 (0.304) loss_x loss_x 0.5981 (1.3104) acc_x 87.5000 (67.5000) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [20/27] time 0.471 (0.448) data 0.339 (0.316) loss_x loss_x 1.2246 (1.3095) acc_x 62.5000 (67.3438) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [25/27] time 0.450 (0.457) data 0.319 (0.326) loss_x loss_x 1.5732 (1.2778) acc_x 56.2500 (67.3750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.2787, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 874
clean true:788
clean false:86
clean_rate:0.9016018306636155
noisy true:664
noisy false:1598
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 2262
epoch [105/200] batch [5/27] time 0.451 (0.507) data 0.320 (0.375) loss_x loss_x 1.1533 (1.1434) acc_x 71.8750 (66.2500) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [10/27] time 0.489 (0.461) data 0.359 (0.330) loss_x loss_x 1.7422 (1.1651) acc_x 56.2500 (67.5000) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/27] time 0.386 (0.465) data 0.255 (0.334) loss_x loss_x 1.4219 (1.2149) acc_x 71.8750 (67.5000) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [20/27] time 0.503 (0.465) data 0.372 (0.334) loss_x loss_x 1.3604 (1.2796) acc_x 65.6250 (65.9375) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [25/27] time 0.489 (0.457) data 0.358 (0.327) loss_x loss_x 1.4307 (1.3330) acc_x 62.5000 (65.0000) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1690
confident_label rate tensor(0.2809, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 881
clean true:791
clean false:90
clean_rate:0.8978433598183881
noisy true:655
noisy false:1600
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 2255
epoch [106/200] batch [5/27] time 0.391 (0.448) data 0.260 (0.317) loss_x loss_x 1.4688 (1.2095) acc_x 62.5000 (68.1250) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [10/27] time 0.571 (0.504) data 0.440 (0.372) loss_x loss_x 1.2256 (1.2564) acc_x 68.7500 (69.3750) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [15/27] time 0.411 (0.490) data 0.280 (0.359) loss_x loss_x 1.5576 (1.2944) acc_x 59.3750 (68.5417) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [20/27] time 0.471 (0.482) data 0.339 (0.350) loss_x loss_x 1.3818 (1.3456) acc_x 68.7500 (67.6562) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [25/27] time 0.365 (0.481) data 0.233 (0.350) loss_x loss_x 1.1865 (1.3125) acc_x 71.8750 (69.0000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1688
confident_label rate tensor(0.2752, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 863
clean true:781
clean false:82
clean_rate:0.9049826187717266
noisy true:667
noisy false:1606
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 2273
epoch [107/200] batch [5/26] time 0.541 (0.491) data 0.409 (0.359) loss_x loss_x 0.7812 (1.1909) acc_x 78.1250 (71.2500) lr 9.2154e-04 eta 0:00:10
epoch [107/200] batch [10/26] time 0.478 (0.477) data 0.346 (0.346) loss_x loss_x 1.5654 (1.2214) acc_x 53.1250 (69.3750) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/26] time 0.415 (0.460) data 0.284 (0.329) loss_x loss_x 1.1494 (1.2462) acc_x 68.7500 (68.1250) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [20/26] time 0.459 (0.462) data 0.327 (0.331) loss_x loss_x 1.2090 (1.2146) acc_x 71.8750 (69.0625) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/26] time 0.443 (0.470) data 0.312 (0.338) loss_x loss_x 1.0088 (1.2181) acc_x 71.8750 (69.0000) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.2848, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 893
clean true:799
clean false:94
clean_rate:0.8947368421052632
noisy true:650
noisy false:1593
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 2243
epoch [108/200] batch [5/27] time 0.538 (0.459) data 0.407 (0.328) loss_x loss_x 1.4434 (1.3317) acc_x 68.7500 (67.5000) lr 9.0589e-04 eta 0:00:10
epoch [108/200] batch [10/27] time 0.517 (0.484) data 0.387 (0.353) loss_x loss_x 1.7559 (1.3659) acc_x 65.6250 (66.8750) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [15/27] time 0.431 (0.476) data 0.300 (0.345) loss_x loss_x 1.1572 (1.2481) acc_x 71.8750 (70.2083) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [20/27] time 0.459 (0.462) data 0.327 (0.331) loss_x loss_x 1.3223 (1.2970) acc_x 68.7500 (68.7500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [25/27] time 0.538 (0.454) data 0.408 (0.323) loss_x loss_x 1.1953 (1.2913) acc_x 62.5000 (68.3750) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2895, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 908
clean true:818
clean false:90
clean_rate:0.9008810572687225
noisy true:661
noisy false:1567
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 2228
epoch [109/200] batch [5/28] time 0.555 (0.575) data 0.423 (0.442) loss_x loss_x 1.4102 (1.3949) acc_x 62.5000 (67.5000) lr 8.9027e-04 eta 0:00:13
epoch [109/200] batch [10/28] time 0.420 (0.514) data 0.289 (0.383) loss_x loss_x 1.3633 (1.3414) acc_x 56.2500 (67.1875) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [15/28] time 0.467 (0.487) data 0.336 (0.356) loss_x loss_x 1.3018 (1.3973) acc_x 71.8750 (65.4167) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [20/28] time 0.526 (0.478) data 0.395 (0.347) loss_x loss_x 1.2129 (1.3732) acc_x 65.6250 (65.6250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [25/28] time 0.401 (0.463) data 0.269 (0.332) loss_x loss_x 1.6143 (1.3634) acc_x 53.1250 (65.6250) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.2911, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 913
clean true:810
clean false:103
clean_rate:0.8871851040525739
noisy true:657
noisy false:1566
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 2223
epoch [110/200] batch [5/28] time 0.482 (0.471) data 0.351 (0.340) loss_x loss_x 1.3291 (1.2113) acc_x 68.7500 (69.3750) lr 8.7467e-04 eta 0:00:10
epoch [110/200] batch [10/28] time 0.431 (0.473) data 0.301 (0.342) loss_x loss_x 1.3818 (1.2166) acc_x 59.3750 (68.1250) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [15/28] time 0.441 (0.457) data 0.310 (0.326) loss_x loss_x 0.6548 (1.1402) acc_x 84.3750 (70.2083) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [20/28] time 0.428 (0.455) data 0.297 (0.324) loss_x loss_x 1.2090 (1.1560) acc_x 68.7500 (69.8438) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [25/28] time 0.377 (0.460) data 0.247 (0.329) loss_x loss_x 1.0957 (1.1750) acc_x 65.6250 (70.1250) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1683
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 916
clean true:814
clean false:102
clean_rate:0.888646288209607
noisy true:639
noisy false:1581
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 2220
epoch [111/200] batch [5/28] time 0.431 (0.483) data 0.299 (0.352) loss_x loss_x 1.5117 (1.1933) acc_x 56.2500 (65.6250) lr 8.5910e-04 eta 0:00:11
epoch [111/200] batch [10/28] time 0.436 (0.456) data 0.304 (0.325) loss_x loss_x 1.8154 (1.2641) acc_x 56.2500 (66.2500) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [15/28] time 0.401 (0.460) data 0.270 (0.329) loss_x loss_x 1.7568 (1.2782) acc_x 59.3750 (65.8333) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [20/28] time 0.515 (0.468) data 0.383 (0.337) loss_x loss_x 1.1143 (1.3267) acc_x 68.7500 (65.0000) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [25/28] time 0.577 (0.464) data 0.445 (0.332) loss_x loss_x 1.2090 (1.3329) acc_x 71.8750 (65.7500) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.2835, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 889
clean true:796
clean false:93
clean_rate:0.8953880764904387
noisy true:658
noisy false:1589
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 2247
epoch [112/200] batch [5/27] time 0.488 (0.470) data 0.358 (0.339) loss_x loss_x 1.1875 (1.3315) acc_x 71.8750 (67.5000) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [10/27] time 0.374 (0.466) data 0.243 (0.335) loss_x loss_x 1.7881 (1.2904) acc_x 62.5000 (67.8125) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/27] time 0.451 (0.449) data 0.320 (0.318) loss_x loss_x 1.2500 (1.1861) acc_x 68.7500 (70.2083) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [20/27] time 0.350 (0.458) data 0.219 (0.327) loss_x loss_x 1.1250 (1.1954) acc_x 56.2500 (68.4375) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [25/27] time 0.425 (0.461) data 0.293 (0.330) loss_x loss_x 1.2266 (1.1798) acc_x 65.6250 (68.8750) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1697
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 879
clean true:769
clean false:110
clean_rate:0.8748577929465301
noisy true:670
noisy false:1587
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 2257
epoch [113/200] batch [5/27] time 0.444 (0.411) data 0.313 (0.279) loss_x loss_x 1.4893 (1.5650) acc_x 59.3750 (63.7500) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [10/27] time 0.392 (0.405) data 0.261 (0.273) loss_x loss_x 1.4111 (1.5188) acc_x 65.6250 (65.0000) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [15/27] time 0.507 (0.427) data 0.371 (0.295) loss_x loss_x 1.1699 (1.4049) acc_x 71.8750 (66.8750) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [20/27] time 0.350 (0.440) data 0.219 (0.308) loss_x loss_x 1.0186 (1.3279) acc_x 75.0000 (67.8125) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [25/27] time 0.623 (0.457) data 0.492 (0.325) loss_x loss_x 1.6045 (1.3401) acc_x 50.0000 (67.2500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1664
confident_label rate tensor(0.2864, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 898
clean true:810
clean false:88
clean_rate:0.9020044543429844
noisy true:662
noisy false:1576
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 2238
epoch [114/200] batch [5/28] time 0.542 (0.485) data 0.410 (0.353) loss_x loss_x 1.0596 (1.3453) acc_x 75.0000 (67.5000) lr 8.1262e-04 eta 0:00:11
epoch [114/200] batch [10/28] time 0.394 (0.481) data 0.263 (0.350) loss_x loss_x 1.2119 (1.3622) acc_x 68.7500 (65.0000) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [15/28] time 0.541 (0.493) data 0.410 (0.362) loss_x loss_x 1.0342 (1.3416) acc_x 68.7500 (65.8333) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [20/28] time 0.588 (0.486) data 0.457 (0.355) loss_x loss_x 1.3320 (1.3714) acc_x 65.6250 (65.6250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [25/28] time 0.518 (0.490) data 0.387 (0.359) loss_x loss_x 1.9990 (1.3664) acc_x 62.5000 (65.8750) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2867, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 899
clean true:801
clean false:98
clean_rate:0.8909899888765295
noisy true:658
noisy false:1579
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 2237
epoch [115/200] batch [5/28] time 0.380 (0.459) data 0.249 (0.328) loss_x loss_x 1.3867 (1.2448) acc_x 65.6250 (70.0000) lr 7.9721e-04 eta 0:00:10
epoch [115/200] batch [10/28] time 0.462 (0.467) data 0.332 (0.337) loss_x loss_x 0.8682 (1.1270) acc_x 65.6250 (72.5000) lr 7.9721e-04 eta 0:00:08
epoch [115/200] batch [15/28] time 0.328 (0.461) data 0.198 (0.331) loss_x loss_x 1.3018 (1.1670) acc_x 71.8750 (71.6667) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [20/28] time 0.486 (0.452) data 0.354 (0.321) loss_x loss_x 1.1504 (1.2188) acc_x 68.7500 (69.2188) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [25/28] time 0.369 (0.460) data 0.238 (0.329) loss_x loss_x 1.7598 (1.2696) acc_x 62.5000 (68.3750) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 879
clean true:784
clean false:95
clean_rate:0.8919226393629124
noisy true:665
noisy false:1592
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 2257
epoch [116/200] batch [5/27] time 0.734 (0.528) data 0.602 (0.397) loss_x loss_x 1.2812 (1.1048) acc_x 59.3750 (69.3750) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [10/27] time 0.508 (0.497) data 0.378 (0.366) loss_x loss_x 0.9346 (1.1211) acc_x 65.6250 (70.3125) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [15/27] time 0.464 (0.486) data 0.331 (0.355) loss_x loss_x 0.8638 (1.1716) acc_x 75.0000 (68.3333) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [20/27] time 0.419 (0.482) data 0.288 (0.350) loss_x loss_x 1.5264 (1.2322) acc_x 62.5000 (67.1875) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [25/27] time 0.399 (0.467) data 0.267 (0.336) loss_x loss_x 1.2090 (1.1969) acc_x 68.7500 (69.1250) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1693
confident_label rate tensor(0.2797, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 877
clean true:786
clean false:91
clean_rate:0.8962371721778791
noisy true:657
noisy false:1602
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 2259
epoch [117/200] batch [5/27] time 0.465 (0.447) data 0.334 (0.316) loss_x loss_x 0.7832 (0.9598) acc_x 75.0000 (73.7500) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [10/27] time 0.586 (0.470) data 0.455 (0.339) loss_x loss_x 0.9688 (1.1283) acc_x 68.7500 (70.6250) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/27] time 0.472 (0.481) data 0.341 (0.350) loss_x loss_x 1.2500 (1.1689) acc_x 62.5000 (68.5417) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [20/27] time 0.474 (0.469) data 0.343 (0.338) loss_x loss_x 0.8813 (1.1940) acc_x 78.1250 (67.6562) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [25/27] time 0.437 (0.480) data 0.306 (0.349) loss_x loss_x 1.4395 (1.2154) acc_x 62.5000 (68.1250) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 909
clean true:808
clean false:101
clean_rate:0.8888888888888888
noisy true:633
noisy false:1594
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 2227
epoch [118/200] batch [5/28] time 0.435 (0.426) data 0.304 (0.295) loss_x loss_x 2.0156 (1.2540) acc_x 50.0000 (70.6250) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [10/28] time 0.461 (0.445) data 0.330 (0.314) loss_x loss_x 1.5645 (1.2857) acc_x 56.2500 (68.7500) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [15/28] time 0.633 (0.469) data 0.501 (0.338) loss_x loss_x 1.2578 (1.2642) acc_x 71.8750 (68.9583) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [20/28] time 0.483 (0.465) data 0.352 (0.333) loss_x loss_x 1.6240 (1.2396) acc_x 65.6250 (69.3750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [25/28] time 0.410 (0.463) data 0.279 (0.332) loss_x loss_x 1.0791 (1.2440) acc_x 81.2500 (69.3750) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 885
clean true:784
clean false:101
clean_rate:0.8858757062146893
noisy true:661
noisy false:1590
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 2251
epoch [119/200] batch [5/27] time 0.372 (0.452) data 0.241 (0.321) loss_x loss_x 1.8691 (1.3828) acc_x 56.2500 (64.3750) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [10/27] time 0.541 (0.474) data 0.409 (0.343) loss_x loss_x 1.1426 (1.4506) acc_x 59.3750 (63.4375) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [15/27] time 0.351 (0.503) data 0.221 (0.371) loss_x loss_x 1.5312 (1.3647) acc_x 59.3750 (64.5833) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [20/27] time 0.476 (0.483) data 0.344 (0.352) loss_x loss_x 1.1445 (1.2840) acc_x 71.8750 (66.5625) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [25/27] time 0.467 (0.475) data 0.336 (0.344) loss_x loss_x 1.2422 (1.2554) acc_x 71.8750 (67.5000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.2940, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 922
clean true:821
clean false:101
clean_rate:0.8904555314533622
noisy true:649
noisy false:1565
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 2214
epoch [120/200] batch [5/28] time 0.498 (0.470) data 0.368 (0.339) loss_x loss_x 1.8857 (1.4871) acc_x 53.1250 (63.7500) lr 7.2101e-04 eta 0:00:10
epoch [120/200] batch [10/28] time 0.534 (0.474) data 0.403 (0.343) loss_x loss_x 0.9810 (1.3312) acc_x 75.0000 (66.8750) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [15/28] time 0.535 (0.462) data 0.405 (0.331) loss_x loss_x 1.1064 (1.3099) acc_x 65.6250 (66.8750) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [20/28] time 0.467 (0.461) data 0.337 (0.330) loss_x loss_x 1.0010 (1.2932) acc_x 71.8750 (67.6562) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [25/28] time 0.434 (0.458) data 0.303 (0.327) loss_x loss_x 1.0811 (1.2971) acc_x 75.0000 (68.0000) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 879
clean true:780
clean false:99
clean_rate:0.8873720136518771
noisy true:665
noisy false:1592
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 2257
epoch [121/200] batch [5/27] time 0.474 (0.509) data 0.343 (0.378) loss_x loss_x 1.3691 (1.2273) acc_x 75.0000 (71.8750) lr 7.0596e-04 eta 0:00:11
epoch [121/200] batch [10/27] time 0.470 (0.492) data 0.339 (0.362) loss_x loss_x 0.9448 (1.1615) acc_x 75.0000 (71.5625) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [15/27] time 0.389 (0.475) data 0.257 (0.344) loss_x loss_x 0.9302 (1.1758) acc_x 75.0000 (70.6250) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [20/27] time 0.392 (0.465) data 0.261 (0.334) loss_x loss_x 1.2314 (1.2261) acc_x 53.1250 (68.9062) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [25/27] time 0.433 (0.466) data 0.302 (0.336) loss_x loss_x 1.5771 (1.2340) acc_x 71.8750 (69.7500) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2962, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 929
clean true:826
clean false:103
clean_rate:0.8891280947255114
noisy true:660
noisy false:1547
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 2207
epoch [122/200] batch [5/29] time 0.801 (0.609) data 0.670 (0.476) loss_x loss_x 1.1875 (1.4902) acc_x 75.0000 (61.2500) lr 6.9098e-04 eta 0:00:14
epoch [122/200] batch [10/29] time 0.454 (0.514) data 0.323 (0.382) loss_x loss_x 1.2920 (1.3023) acc_x 68.7500 (66.2500) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [15/29] time 0.402 (0.481) data 0.271 (0.350) loss_x loss_x 1.6602 (1.3282) acc_x 65.6250 (65.2083) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [20/29] time 0.479 (0.479) data 0.348 (0.347) loss_x loss_x 1.3818 (1.3293) acc_x 65.6250 (66.4062) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [25/29] time 0.454 (0.475) data 0.323 (0.343) loss_x loss_x 1.8525 (1.3172) acc_x 56.2500 (66.2500) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1680
confident_label rate tensor(0.2985, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 936
clean true:827
clean false:109
clean_rate:0.8835470085470085
noisy true:629
noisy false:1571
after delete: len(clean_dataset) 936
after delete: len(noisy_dataset) 2200
epoch [123/200] batch [5/29] time 0.385 (0.453) data 0.255 (0.322) loss_x loss_x 1.4326 (1.3035) acc_x 59.3750 (65.6250) lr 6.7608e-04 eta 0:00:10
epoch [123/200] batch [10/29] time 0.386 (0.436) data 0.256 (0.305) loss_x loss_x 1.4492 (1.2656) acc_x 62.5000 (66.8750) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [15/29] time 0.619 (0.461) data 0.488 (0.330) loss_x loss_x 0.9238 (1.2849) acc_x 65.6250 (66.0417) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [20/29] time 0.402 (0.459) data 0.270 (0.328) loss_x loss_x 1.1279 (1.2925) acc_x 65.6250 (65.6250) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [25/29] time 0.420 (0.466) data 0.289 (0.335) loss_x loss_x 1.1895 (1.3062) acc_x 78.1250 (66.5000) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.2905, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 911
clean true:818
clean false:93
clean_rate:0.897914379802415
noisy true:652
noisy false:1573
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 2225
epoch [124/200] batch [5/28] time 0.525 (0.473) data 0.394 (0.341) loss_x loss_x 1.3701 (1.1182) acc_x 65.6250 (70.0000) lr 6.6126e-04 eta 0:00:10
epoch [124/200] batch [10/28] time 0.419 (0.486) data 0.288 (0.354) loss_x loss_x 1.1709 (1.1708) acc_x 65.6250 (69.6875) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [15/28] time 0.649 (0.489) data 0.518 (0.357) loss_x loss_x 1.7305 (1.2406) acc_x 62.5000 (68.5417) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [20/28] time 0.481 (0.483) data 0.350 (0.351) loss_x loss_x 1.7441 (1.2178) acc_x 59.3750 (68.5938) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [25/28] time 0.355 (0.472) data 0.224 (0.341) loss_x loss_x 1.4375 (1.2430) acc_x 68.7500 (68.1250) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1619
confident_label rate tensor(0.3026, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 949
clean true:846
clean false:103
clean_rate:0.8914646996838778
noisy true:671
noisy false:1516
after delete: len(clean_dataset) 949
after delete: len(noisy_dataset) 2187
epoch [125/200] batch [5/29] time 0.395 (0.450) data 0.265 (0.319) loss_x loss_x 1.1064 (0.9448) acc_x 78.1250 (76.2500) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [10/29] time 0.554 (0.466) data 0.423 (0.335) loss_x loss_x 1.7061 (1.1343) acc_x 53.1250 (71.2500) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [15/29] time 0.480 (0.455) data 0.349 (0.324) loss_x loss_x 1.8125 (1.1497) acc_x 53.1250 (71.2500) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [20/29] time 0.369 (0.447) data 0.238 (0.316) loss_x loss_x 1.5146 (1.1607) acc_x 62.5000 (70.0000) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [25/29] time 0.406 (0.444) data 0.275 (0.313) loss_x loss_x 1.1533 (1.1508) acc_x 62.5000 (69.3750) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1680
confident_label rate tensor(0.2851, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 894
clean true:795
clean false:99
clean_rate:0.889261744966443
noisy true:661
noisy false:1581
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 2242
epoch [126/200] batch [5/27] time 0.449 (0.472) data 0.318 (0.341) loss_x loss_x 1.4668 (1.1945) acc_x 65.6250 (70.0000) lr 6.3188e-04 eta 0:00:10
epoch [126/200] batch [10/27] time 0.377 (0.456) data 0.245 (0.325) loss_x loss_x 1.8076 (1.2363) acc_x 50.0000 (69.3750) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [15/27] time 0.459 (0.474) data 0.327 (0.343) loss_x loss_x 0.7729 (1.2057) acc_x 71.8750 (69.7917) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [20/27] time 0.421 (0.477) data 0.290 (0.346) loss_x loss_x 1.3828 (1.1856) acc_x 62.5000 (69.6875) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [25/27] time 0.413 (0.466) data 0.282 (0.334) loss_x loss_x 0.8335 (1.2147) acc_x 71.8750 (69.1250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.2790, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 875
clean true:768
clean false:107
clean_rate:0.8777142857142857
noisy true:669
noisy false:1592
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 2261
epoch [127/200] batch [5/27] time 0.347 (0.403) data 0.215 (0.272) loss_x loss_x 1.2373 (1.1184) acc_x 65.6250 (68.7500) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [10/27] time 0.480 (0.447) data 0.350 (0.316) loss_x loss_x 1.6982 (1.1270) acc_x 68.7500 (71.5625) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [15/27] time 0.540 (0.450) data 0.409 (0.320) loss_x loss_x 0.8242 (1.0926) acc_x 81.2500 (72.0833) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [20/27] time 0.444 (0.455) data 0.313 (0.325) loss_x loss_x 1.0234 (1.1319) acc_x 71.8750 (71.5625) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [25/27] time 0.403 (0.458) data 0.273 (0.328) loss_x loss_x 0.9961 (1.1012) acc_x 78.1250 (72.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1678
confident_label rate tensor(0.2867, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 899
clean true:805
clean false:94
clean_rate:0.8954393770856507
noisy true:653
noisy false:1584
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 2237
epoch [128/200] batch [5/28] time 0.410 (0.487) data 0.279 (0.355) loss_x loss_x 0.9185 (1.0763) acc_x 87.5000 (69.3750) lr 6.0285e-04 eta 0:00:11
epoch [128/200] batch [10/28] time 0.435 (0.463) data 0.304 (0.332) loss_x loss_x 1.1055 (1.1367) acc_x 75.0000 (69.3750) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [15/28] time 0.460 (0.475) data 0.330 (0.344) loss_x loss_x 1.5156 (1.2359) acc_x 62.5000 (68.3333) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [20/28] time 0.643 (0.470) data 0.513 (0.339) loss_x loss_x 1.0762 (1.3082) acc_x 65.6250 (66.5625) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [25/28] time 0.554 (0.475) data 0.423 (0.344) loss_x loss_x 1.3037 (1.3296) acc_x 62.5000 (65.7500) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1705
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 879
clean true:774
clean false:105
clean_rate:0.8805460750853242
noisy true:657
noisy false:1600
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 2257
epoch [129/200] batch [5/27] time 0.395 (0.461) data 0.264 (0.329) loss_x loss_x 1.3105 (1.3816) acc_x 65.6250 (65.6250) lr 5.8849e-04 eta 0:00:10
epoch [129/200] batch [10/27] time 0.562 (0.480) data 0.431 (0.348) loss_x loss_x 1.4287 (1.3404) acc_x 68.7500 (67.1875) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [15/27] time 0.468 (0.459) data 0.337 (0.327) loss_x loss_x 1.0322 (1.3033) acc_x 65.6250 (67.9167) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [20/27] time 0.337 (0.455) data 0.206 (0.323) loss_x loss_x 1.2930 (1.3169) acc_x 62.5000 (67.0312) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [25/27] time 0.395 (0.461) data 0.264 (0.329) loss_x loss_x 1.0752 (1.2922) acc_x 68.7500 (68.2500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2848, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 893
clean true:802
clean false:91
clean_rate:0.8980963045912654
noisy true:674
noisy false:1569
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 2243
epoch [130/200] batch [5/27] time 0.577 (0.467) data 0.446 (0.337) loss_x loss_x 1.3828 (1.1467) acc_x 65.6250 (65.6250) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [10/27] time 0.404 (0.458) data 0.273 (0.328) loss_x loss_x 1.3633 (1.2001) acc_x 65.6250 (67.1875) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/27] time 0.441 (0.455) data 0.310 (0.324) loss_x loss_x 1.1699 (1.2477) acc_x 71.8750 (66.2500) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [20/27] time 0.413 (0.457) data 0.282 (0.326) loss_x loss_x 1.1074 (1.2228) acc_x 75.0000 (67.1875) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [25/27] time 0.442 (0.463) data 0.312 (0.332) loss_x loss_x 0.8672 (1.1809) acc_x 71.8750 (68.1250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 916
clean true:802
clean false:114
clean_rate:0.8755458515283843
noisy true:638
noisy false:1582
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 2220
epoch [131/200] batch [5/28] time 0.398 (0.478) data 0.267 (0.347) loss_x loss_x 1.5303 (1.2291) acc_x 62.5000 (68.7500) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [10/28] time 0.484 (0.473) data 0.354 (0.343) loss_x loss_x 1.3301 (1.2166) acc_x 65.6250 (69.3750) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [15/28] time 0.393 (0.470) data 0.261 (0.339) loss_x loss_x 0.8833 (1.1583) acc_x 75.0000 (70.6250) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [20/28] time 0.429 (0.462) data 0.298 (0.331) loss_x loss_x 1.3379 (1.1788) acc_x 62.5000 (70.3125) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [25/28] time 0.615 (0.465) data 0.484 (0.334) loss_x loss_x 1.0273 (1.1699) acc_x 78.1250 (70.7500) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1688
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 884
clean true:789
clean false:95
clean_rate:0.8925339366515838
noisy true:659
noisy false:1593
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 2252
epoch [132/200] batch [5/27] time 0.508 (0.511) data 0.377 (0.379) loss_x loss_x 0.8979 (0.9976) acc_x 71.8750 (72.5000) lr 5.4601e-04 eta 0:00:11
epoch [132/200] batch [10/27] time 0.467 (0.486) data 0.335 (0.354) loss_x loss_x 1.3457 (1.0961) acc_x 65.6250 (68.1250) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [15/27] time 0.375 (0.472) data 0.244 (0.341) loss_x loss_x 1.2744 (1.1162) acc_x 62.5000 (67.7083) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [20/27] time 0.550 (0.468) data 0.419 (0.337) loss_x loss_x 1.3691 (1.1503) acc_x 71.8750 (67.9688) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [25/27] time 0.532 (0.465) data 0.402 (0.334) loss_x loss_x 0.9644 (1.1458) acc_x 68.7500 (68.2500) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1676
confident_label rate tensor(0.2860, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 897
clean true:802
clean false:95
clean_rate:0.8940914158305463
noisy true:658
noisy false:1581
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 2239
epoch [133/200] batch [5/28] time 0.412 (0.481) data 0.282 (0.350) loss_x loss_x 1.6699 (1.1561) acc_x 62.5000 (71.8750) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [10/28] time 0.452 (0.451) data 0.321 (0.320) loss_x loss_x 1.2354 (1.0968) acc_x 62.5000 (71.8750) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [15/28] time 0.513 (0.474) data 0.382 (0.343) loss_x loss_x 1.2129 (1.0825) acc_x 68.7500 (72.7083) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [20/28] time 0.401 (0.453) data 0.271 (0.322) loss_x loss_x 1.1865 (1.0871) acc_x 62.5000 (71.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [25/28] time 0.439 (0.460) data 0.307 (0.328) loss_x loss_x 1.3174 (1.0843) acc_x 59.3750 (71.8750) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1686
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 909
clean true:809
clean false:100
clean_rate:0.88998899889989
noisy true:641
noisy false:1586
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 2227
epoch [134/200] batch [5/28] time 0.520 (0.491) data 0.389 (0.360) loss_x loss_x 0.9688 (1.4297) acc_x 75.0000 (66.8750) lr 5.1825e-04 eta 0:00:11
epoch [134/200] batch [10/28] time 0.426 (0.468) data 0.295 (0.336) loss_x loss_x 1.4766 (1.3613) acc_x 53.1250 (66.5625) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [15/28] time 0.442 (0.449) data 0.311 (0.318) loss_x loss_x 1.2090 (1.3446) acc_x 59.3750 (65.8333) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [20/28] time 0.418 (0.451) data 0.286 (0.320) loss_x loss_x 1.4072 (1.3161) acc_x 62.5000 (66.4062) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [25/28] time 0.574 (0.456) data 0.443 (0.324) loss_x loss_x 1.1055 (1.3056) acc_x 68.7500 (66.7500) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 883
clean true:777
clean false:106
clean_rate:0.8799546998867497
noisy true:644
noisy false:1609
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 2253
epoch [135/200] batch [5/27] time 0.390 (0.396) data 0.259 (0.266) loss_x loss_x 1.2871 (1.3364) acc_x 75.0000 (69.3750) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/27] time 0.477 (0.448) data 0.347 (0.318) loss_x loss_x 0.8237 (1.2069) acc_x 78.1250 (70.9375) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/27] time 0.375 (0.459) data 0.244 (0.329) loss_x loss_x 1.5576 (1.2312) acc_x 59.3750 (70.8333) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [20/27] time 0.389 (0.453) data 0.259 (0.322) loss_x loss_x 1.4639 (1.2569) acc_x 62.5000 (68.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [25/27] time 0.385 (0.457) data 0.254 (0.327) loss_x loss_x 1.1826 (1.2287) acc_x 62.5000 (68.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1688
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 914
clean true:809
clean false:105
clean_rate:0.8851203501094091
noisy true:639
noisy false:1583
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 2222
epoch [136/200] batch [5/28] time 0.436 (0.430) data 0.305 (0.298) loss_x loss_x 0.9590 (1.1210) acc_x 75.0000 (70.6250) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/28] time 0.454 (0.432) data 0.323 (0.301) loss_x loss_x 1.2568 (1.0616) acc_x 75.0000 (71.8750) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [15/28] time 0.560 (0.468) data 0.429 (0.336) loss_x loss_x 1.9668 (1.1214) acc_x 50.0000 (69.5833) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [20/28] time 0.407 (0.465) data 0.276 (0.333) loss_x loss_x 1.0703 (1.1003) acc_x 78.1250 (71.4062) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [25/28] time 0.435 (0.468) data 0.304 (0.336) loss_x loss_x 0.8022 (1.1364) acc_x 84.3750 (71.0000) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1672
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 882
clean true:787
clean false:95
clean_rate:0.8922902494331065
noisy true:677
noisy false:1577
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 2254
epoch [137/200] batch [5/27] time 0.380 (0.508) data 0.249 (0.377) loss_x loss_x 1.2285 (1.2641) acc_x 71.8750 (65.0000) lr 4.7750e-04 eta 0:00:11
epoch [137/200] batch [10/27] time 0.399 (0.477) data 0.267 (0.345) loss_x loss_x 1.7178 (1.3604) acc_x 56.2500 (65.0000) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [15/27] time 0.418 (0.459) data 0.286 (0.328) loss_x loss_x 1.2646 (1.2779) acc_x 68.7500 (67.7083) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [20/27] time 0.440 (0.469) data 0.308 (0.338) loss_x loss_x 0.6152 (1.2192) acc_x 84.3750 (68.9062) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [25/27] time 0.396 (0.473) data 0.265 (0.342) loss_x loss_x 1.6143 (1.2393) acc_x 56.2500 (68.3750) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2950, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 925
clean true:827
clean false:98
clean_rate:0.894054054054054
noisy true:672
noisy false:1539
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 2211
epoch [138/200] batch [5/28] time 0.402 (0.471) data 0.271 (0.341) loss_x loss_x 1.3027 (1.2850) acc_x 65.6250 (66.8750) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [10/28] time 0.410 (0.466) data 0.279 (0.335) loss_x loss_x 1.2314 (1.3015) acc_x 59.3750 (65.0000) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [15/28] time 0.457 (0.462) data 0.326 (0.331) loss_x loss_x 1.4229 (1.2566) acc_x 59.3750 (66.2500) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [20/28] time 0.456 (0.466) data 0.325 (0.335) loss_x loss_x 0.8438 (1.2680) acc_x 78.1250 (66.8750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [25/28] time 0.407 (0.464) data 0.277 (0.333) loss_x loss_x 0.9868 (1.2488) acc_x 68.7500 (66.8750) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 918
clean true:821
clean false:97
clean_rate:0.8943355119825708
noisy true:665
noisy false:1553
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 2218
epoch [139/200] batch [5/28] time 0.592 (0.546) data 0.462 (0.415) loss_x loss_x 1.0361 (1.1438) acc_x 71.8750 (72.5000) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [10/28] time 0.576 (0.497) data 0.445 (0.366) loss_x loss_x 1.3115 (1.1762) acc_x 71.8750 (71.5625) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [15/28] time 0.401 (0.484) data 0.270 (0.353) loss_x loss_x 1.2520 (1.2483) acc_x 71.8750 (68.7500) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [20/28] time 0.431 (0.475) data 0.301 (0.344) loss_x loss_x 1.5381 (1.1969) acc_x 62.5000 (70.1562) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [25/28] time 0.334 (0.462) data 0.204 (0.331) loss_x loss_x 1.4082 (1.1704) acc_x 68.7500 (71.0000) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2905, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 911
clean true:800
clean false:111
clean_rate:0.8781558726673985
noisy true:659
noisy false:1566
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 2225
epoch [140/200] batch [5/28] time 0.554 (0.427) data 0.424 (0.296) loss_x loss_x 1.4121 (1.0463) acc_x 65.6250 (73.1250) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [10/28] time 0.462 (0.443) data 0.331 (0.313) loss_x loss_x 1.4795 (1.1276) acc_x 59.3750 (70.9375) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [15/28] time 0.422 (0.449) data 0.291 (0.318) loss_x loss_x 1.2988 (1.1827) acc_x 68.7500 (70.2083) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [20/28] time 0.495 (0.457) data 0.364 (0.327) loss_x loss_x 1.5029 (1.2029) acc_x 59.3750 (71.0938) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [25/28] time 0.459 (0.479) data 0.327 (0.348) loss_x loss_x 1.2998 (1.2062) acc_x 62.5000 (70.2500) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1667
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 909
clean true:805
clean false:104
clean_rate:0.8855885588558856
noisy true:664
noisy false:1563
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 2227
epoch [141/200] batch [5/28] time 0.496 (0.475) data 0.365 (0.344) loss_x loss_x 1.2432 (1.3484) acc_x 68.7500 (66.8750) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [10/28] time 0.549 (0.486) data 0.418 (0.355) loss_x loss_x 0.9980 (1.3544) acc_x 81.2500 (67.5000) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [15/28] time 0.474 (0.477) data 0.343 (0.346) loss_x loss_x 0.8086 (1.2752) acc_x 68.7500 (67.9167) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [20/28] time 0.461 (0.467) data 0.330 (0.336) loss_x loss_x 1.0361 (1.2382) acc_x 75.0000 (69.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [25/28] time 0.447 (0.459) data 0.316 (0.328) loss_x loss_x 0.9517 (1.2080) acc_x 71.8750 (69.8750) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.2911, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 913
clean true:810
clean false:103
clean_rate:0.8871851040525739
noisy true:645
noisy false:1578
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 2223
epoch [142/200] batch [5/28] time 0.428 (0.443) data 0.297 (0.312) loss_x loss_x 0.9692 (1.3991) acc_x 71.8750 (66.8750) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [10/28] time 0.354 (0.442) data 0.224 (0.311) loss_x loss_x 0.8188 (1.3019) acc_x 81.2500 (68.7500) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [15/28] time 0.420 (0.430) data 0.290 (0.299) loss_x loss_x 0.8486 (1.2536) acc_x 68.7500 (69.3750) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [20/28] time 0.561 (0.438) data 0.431 (0.307) loss_x loss_x 0.6377 (1.1948) acc_x 78.1250 (70.7812) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [25/28] time 0.486 (0.450) data 0.355 (0.320) loss_x loss_x 0.9346 (1.1883) acc_x 71.8750 (70.2500) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.2911, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 913
clean true:824
clean false:89
clean_rate:0.9025191675794085
noisy true:637
noisy false:1586
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 2223
epoch [143/200] batch [5/28] time 0.436 (0.464) data 0.305 (0.333) loss_x loss_x 1.9854 (1.2025) acc_x 62.5000 (71.2500) lr 3.9958e-04 eta 0:00:10
epoch [143/200] batch [10/28] time 0.384 (0.437) data 0.253 (0.306) loss_x loss_x 1.4961 (1.2284) acc_x 59.3750 (70.9375) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [15/28] time 0.448 (0.444) data 0.316 (0.312) loss_x loss_x 1.2197 (1.2598) acc_x 75.0000 (70.0000) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [20/28] time 0.395 (0.451) data 0.264 (0.319) loss_x loss_x 1.3281 (1.2607) acc_x 65.6250 (69.5312) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [25/28] time 0.416 (0.452) data 0.285 (0.321) loss_x loss_x 1.1865 (1.2310) acc_x 68.7500 (70.1250) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.2950, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 925
clean true:828
clean false:97
clean_rate:0.8951351351351351
noisy true:658
noisy false:1553
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 2211
epoch [144/200] batch [5/28] time 0.464 (0.449) data 0.332 (0.318) loss_x loss_x 1.3389 (1.3063) acc_x 68.7500 (67.5000) lr 3.8709e-04 eta 0:00:10
epoch [144/200] batch [10/28] time 0.425 (0.459) data 0.295 (0.328) loss_x loss_x 1.3760 (1.1858) acc_x 65.6250 (70.6250) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [15/28] time 0.561 (0.478) data 0.430 (0.347) loss_x loss_x 0.9126 (1.1738) acc_x 75.0000 (71.2500) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [20/28] time 0.411 (0.479) data 0.281 (0.348) loss_x loss_x 1.4062 (1.1627) acc_x 65.6250 (70.3125) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [25/28] time 0.467 (0.476) data 0.336 (0.345) loss_x loss_x 0.6362 (1.1756) acc_x 81.2500 (69.8750) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.2943, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 923
clean true:818
clean false:105
clean_rate:0.886240520043337
noisy true:658
noisy false:1555
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 2213
epoch [145/200] batch [5/28] time 0.527 (0.488) data 0.396 (0.357) loss_x loss_x 1.6182 (1.4258) acc_x 65.6250 (66.2500) lr 3.7476e-04 eta 0:00:11
epoch [145/200] batch [10/28] time 0.541 (0.500) data 0.409 (0.368) loss_x loss_x 1.1660 (1.3080) acc_x 68.7500 (66.5625) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [15/28] time 0.417 (0.499) data 0.286 (0.367) loss_x loss_x 0.8872 (1.3011) acc_x 78.1250 (66.8750) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [20/28] time 0.375 (0.489) data 0.244 (0.357) loss_x loss_x 1.3682 (1.3059) acc_x 56.2500 (65.9375) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [25/28] time 0.413 (0.477) data 0.282 (0.346) loss_x loss_x 1.3271 (1.2977) acc_x 75.0000 (66.5000) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 884
clean true:774
clean false:110
clean_rate:0.8755656108597285
noisy true:660
noisy false:1592
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 2252
epoch [146/200] batch [5/27] time 0.493 (0.522) data 0.362 (0.390) loss_x loss_x 1.4463 (1.2188) acc_x 71.8750 (66.8750) lr 3.6258e-04 eta 0:00:11
epoch [146/200] batch [10/27] time 0.524 (0.501) data 0.392 (0.369) loss_x loss_x 1.3721 (1.3142) acc_x 68.7500 (65.9375) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [15/27] time 0.464 (0.478) data 0.333 (0.347) loss_x loss_x 0.9731 (1.3035) acc_x 84.3750 (67.9167) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [20/27] time 0.488 (0.477) data 0.357 (0.346) loss_x loss_x 1.4414 (1.2938) acc_x 65.6250 (67.6562) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [25/27] time 0.385 (0.475) data 0.254 (0.344) loss_x loss_x 1.2139 (1.2847) acc_x 71.8750 (68.0000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.2966, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 930
clean true:820
clean false:110
clean_rate:0.8817204301075269
noisy true:631
noisy false:1575
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 2206
epoch [147/200] batch [5/29] time 0.475 (0.492) data 0.345 (0.361) loss_x loss_x 1.2588 (1.2968) acc_x 62.5000 (65.6250) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [10/29] time 0.385 (0.472) data 0.254 (0.341) loss_x loss_x 0.9766 (1.1466) acc_x 71.8750 (68.4375) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [15/29] time 0.345 (0.457) data 0.214 (0.326) loss_x loss_x 0.9619 (1.1815) acc_x 78.1250 (68.3333) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [20/29] time 0.342 (0.473) data 0.210 (0.342) loss_x loss_x 0.9692 (1.1876) acc_x 78.1250 (69.0625) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [25/29] time 0.378 (0.475) data 0.248 (0.343) loss_x loss_x 1.0811 (1.2383) acc_x 68.7500 (68.8750) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1701
confident_label rate tensor(0.2787, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 874
clean true:777
clean false:97
clean_rate:0.8890160183066361
noisy true:658
noisy false:1604
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 2262
epoch [148/200] batch [5/27] time 0.431 (0.453) data 0.300 (0.321) loss_x loss_x 1.4004 (1.0960) acc_x 62.5000 (71.2500) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [10/27] time 0.362 (0.440) data 0.231 (0.309) loss_x loss_x 1.2197 (1.2510) acc_x 65.6250 (69.0625) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [15/27] time 0.405 (0.464) data 0.274 (0.332) loss_x loss_x 1.2168 (1.2593) acc_x 75.0000 (69.5833) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [20/27] time 0.501 (0.459) data 0.370 (0.328) loss_x loss_x 1.0156 (1.2510) acc_x 75.0000 (69.6875) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [25/27] time 0.399 (0.459) data 0.268 (0.328) loss_x loss_x 1.3369 (1.2664) acc_x 68.7500 (69.5000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1696
confident_label rate tensor(0.2895, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 908
clean true:795
clean false:113
clean_rate:0.8755506607929515
noisy true:645
noisy false:1583
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 2228
epoch [149/200] batch [5/28] time 0.356 (0.476) data 0.225 (0.345) loss_x loss_x 0.9062 (1.1926) acc_x 71.8750 (71.8750) lr 3.2699e-04 eta 0:00:10
epoch [149/200] batch [10/28] time 0.446 (0.453) data 0.316 (0.323) loss_x loss_x 1.0088 (1.0886) acc_x 87.5000 (73.4375) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [15/28] time 0.408 (0.451) data 0.276 (0.321) loss_x loss_x 1.1904 (1.0828) acc_x 75.0000 (73.7500) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [20/28] time 0.683 (0.473) data 0.552 (0.343) loss_x loss_x 1.2051 (1.1491) acc_x 62.5000 (72.1875) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [25/28] time 0.559 (0.472) data 0.428 (0.341) loss_x loss_x 1.3877 (1.1384) acc_x 68.7500 (71.7500) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.2895, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 908
clean true:800
clean false:108
clean_rate:0.8810572687224669
noisy true:659
noisy false:1569
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 2228
epoch [150/200] batch [5/28] time 0.564 (0.490) data 0.429 (0.358) loss_x loss_x 0.9131 (1.2093) acc_x 68.7500 (73.1250) lr 3.1545e-04 eta 0:00:11
epoch [150/200] batch [10/28] time 0.465 (0.465) data 0.335 (0.334) loss_x loss_x 1.0322 (1.1507) acc_x 71.8750 (70.9375) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [15/28] time 0.445 (0.469) data 0.314 (0.337) loss_x loss_x 0.8433 (1.1960) acc_x 78.1250 (69.3750) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [20/28] time 0.529 (0.462) data 0.399 (0.331) loss_x loss_x 1.4883 (1.1459) acc_x 65.6250 (69.6875) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [25/28] time 0.518 (0.464) data 0.387 (0.333) loss_x loss_x 1.2266 (1.1679) acc_x 71.8750 (70.1250) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.2876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 902
clean true:803
clean false:99
clean_rate:0.8902439024390244
noisy true:659
noisy false:1575
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 2234
epoch [151/200] batch [5/28] time 0.785 (0.552) data 0.654 (0.421) loss_x loss_x 1.5928 (1.2410) acc_x 56.2500 (66.8750) lr 3.0409e-04 eta 0:00:12
epoch [151/200] batch [10/28] time 0.504 (0.494) data 0.373 (0.363) loss_x loss_x 1.2061 (1.3329) acc_x 68.7500 (67.5000) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [15/28] time 0.396 (0.471) data 0.264 (0.340) loss_x loss_x 0.8584 (1.2372) acc_x 75.0000 (68.5417) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [20/28] time 0.565 (0.467) data 0.434 (0.336) loss_x loss_x 1.0635 (1.2494) acc_x 71.8750 (68.7500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [25/28] time 0.514 (0.471) data 0.383 (0.340) loss_x loss_x 1.6650 (1.2882) acc_x 50.0000 (68.1250) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2940, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 922
clean true:821
clean false:101
clean_rate:0.8904555314533622
noisy true:678
noisy false:1536
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 2214
epoch [152/200] batch [5/28] time 0.484 (0.454) data 0.353 (0.322) loss_x loss_x 1.0977 (1.2089) acc_x 68.7500 (69.3750) lr 2.9289e-04 eta 0:00:10
epoch [152/200] batch [10/28] time 0.544 (0.474) data 0.413 (0.343) loss_x loss_x 1.2646 (1.2047) acc_x 65.6250 (70.3125) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [15/28] time 0.456 (0.468) data 0.325 (0.337) loss_x loss_x 0.7842 (1.2380) acc_x 78.1250 (69.1667) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [20/28] time 0.568 (0.484) data 0.436 (0.353) loss_x loss_x 1.3623 (1.2044) acc_x 65.6250 (69.8438) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [25/28] time 0.479 (0.479) data 0.348 (0.348) loss_x loss_x 1.2783 (1.1944) acc_x 75.0000 (70.0000) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.2953, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 926
clean true:817
clean false:109
clean_rate:0.8822894168466523
noisy true:640
noisy false:1570
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 2210
epoch [153/200] batch [5/28] time 0.472 (0.469) data 0.341 (0.338) loss_x loss_x 1.1787 (1.0971) acc_x 65.6250 (70.0000) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [10/28] time 0.418 (0.469) data 0.287 (0.338) loss_x loss_x 1.0596 (1.0699) acc_x 81.2500 (70.9375) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [15/28] time 0.393 (0.457) data 0.261 (0.325) loss_x loss_x 0.9600 (1.0580) acc_x 75.0000 (71.2500) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [20/28] time 0.397 (0.458) data 0.266 (0.327) loss_x loss_x 1.7822 (1.1770) acc_x 62.5000 (69.0625) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [25/28] time 0.482 (0.455) data 0.350 (0.324) loss_x loss_x 1.0176 (1.1646) acc_x 81.2500 (69.7500) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1637
confident_label rate tensor(0.2876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 902
clean true:810
clean false:92
clean_rate:0.8980044345898004
noisy true:689
noisy false:1545
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 2234
epoch [154/200] batch [5/28] time 0.379 (0.431) data 0.247 (0.300) loss_x loss_x 1.3389 (1.0632) acc_x 68.7500 (74.3750) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [10/28] time 0.405 (0.428) data 0.275 (0.296) loss_x loss_x 0.6455 (1.0381) acc_x 78.1250 (73.4375) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [15/28] time 0.474 (0.455) data 0.341 (0.323) loss_x loss_x 1.0703 (1.1567) acc_x 71.8750 (71.0417) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [20/28] time 0.487 (0.480) data 0.355 (0.349) loss_x loss_x 1.5283 (1.1749) acc_x 62.5000 (69.5312) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [25/28] time 0.482 (0.475) data 0.351 (0.344) loss_x loss_x 1.0244 (1.1972) acc_x 75.0000 (69.0000) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.2832, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 888
clean true:784
clean false:104
clean_rate:0.8828828828828829
noisy true:661
noisy false:1587
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 2248
epoch [155/200] batch [5/27] time 0.372 (0.502) data 0.241 (0.371) loss_x loss_x 1.0830 (1.0246) acc_x 75.0000 (76.8750) lr 2.6037e-04 eta 0:00:11
epoch [155/200] batch [10/27] time 0.437 (0.462) data 0.306 (0.330) loss_x loss_x 0.8560 (1.0498) acc_x 78.1250 (76.5625) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [15/27] time 0.492 (0.458) data 0.361 (0.327) loss_x loss_x 1.5127 (1.1384) acc_x 65.6250 (73.9583) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [20/27] time 0.447 (0.466) data 0.316 (0.334) loss_x loss_x 1.6309 (1.1771) acc_x 59.3750 (72.0312) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [25/27] time 0.594 (0.473) data 0.462 (0.342) loss_x loss_x 1.5586 (1.1879) acc_x 59.3750 (71.5000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1651
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 918
clean true:814
clean false:104
clean_rate:0.8867102396514162
noisy true:671
noisy false:1547
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 2218
epoch [156/200] batch [5/28] time 0.423 (0.438) data 0.291 (0.306) loss_x loss_x 1.2715 (1.1365) acc_x 65.6250 (73.7500) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [10/28] time 0.453 (0.468) data 0.321 (0.336) loss_x loss_x 0.7778 (1.1877) acc_x 78.1250 (69.6875) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [15/28] time 0.381 (0.469) data 0.250 (0.337) loss_x loss_x 1.0801 (1.1929) acc_x 65.6250 (70.0000) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [20/28] time 0.464 (0.451) data 0.333 (0.319) loss_x loss_x 0.7920 (1.1710) acc_x 78.1250 (70.6250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [25/28] time 0.512 (0.472) data 0.380 (0.340) loss_x loss_x 0.7148 (1.1416) acc_x 84.3750 (71.5000) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.2889, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 906
clean true:798
clean false:108
clean_rate:0.8807947019867549
noisy true:636
noisy false:1594
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 2230
epoch [157/200] batch [5/28] time 0.515 (0.602) data 0.380 (0.468) loss_x loss_x 1.0596 (1.1830) acc_x 65.6250 (68.1250) lr 2.3959e-04 eta 0:00:13
epoch [157/200] batch [10/28] time 0.416 (0.540) data 0.284 (0.407) loss_x loss_x 1.2158 (1.1503) acc_x 65.6250 (69.6875) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [15/28] time 0.420 (0.509) data 0.290 (0.377) loss_x loss_x 1.5527 (1.2472) acc_x 62.5000 (68.7500) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [20/28] time 0.446 (0.495) data 0.314 (0.363) loss_x loss_x 0.8516 (1.2670) acc_x 84.3750 (69.2188) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [25/28] time 0.412 (0.484) data 0.281 (0.352) loss_x loss_x 1.1758 (1.2466) acc_x 68.7500 (68.7500) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.2857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 896
clean true:793
clean false:103
clean_rate:0.8850446428571429
noisy true:656
noisy false:1584
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 2240
epoch [158/200] batch [5/28] time 0.383 (0.464) data 0.253 (0.332) loss_x loss_x 0.8711 (1.1365) acc_x 65.6250 (71.8750) lr 2.2949e-04 eta 0:00:10
epoch [158/200] batch [10/28] time 0.381 (0.447) data 0.249 (0.316) loss_x loss_x 1.2988 (1.2352) acc_x 56.2500 (66.8750) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [15/28] time 0.447 (0.454) data 0.316 (0.323) loss_x loss_x 1.5332 (1.1999) acc_x 62.5000 (68.7500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [20/28] time 0.376 (0.443) data 0.245 (0.311) loss_x loss_x 1.1143 (1.2060) acc_x 78.1250 (69.0625) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [25/28] time 0.599 (0.450) data 0.467 (0.318) loss_x loss_x 0.9819 (1.1646) acc_x 65.6250 (69.8750) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1652
confident_label rate tensor(0.2870, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 900
clean true:786
clean false:114
clean_rate:0.8733333333333333
noisy true:698
noisy false:1538
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 2236
epoch [159/200] batch [5/28] time 0.444 (0.473) data 0.313 (0.341) loss_x loss_x 1.6494 (1.2127) acc_x 59.3750 (68.7500) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [10/28] time 0.397 (0.464) data 0.266 (0.333) loss_x loss_x 1.0918 (1.2062) acc_x 75.0000 (70.0000) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [15/28] time 0.466 (0.466) data 0.334 (0.335) loss_x loss_x 1.5059 (1.2066) acc_x 65.6250 (71.2500) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [20/28] time 0.412 (0.456) data 0.281 (0.325) loss_x loss_x 1.1484 (1.1548) acc_x 68.7500 (72.3438) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [25/28] time 0.577 (0.465) data 0.446 (0.334) loss_x loss_x 1.1152 (1.1962) acc_x 75.0000 (71.6250) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1642
confident_label rate tensor(0.2959, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 928
clean true:818
clean false:110
clean_rate:0.8814655172413793
noisy true:676
noisy false:1532
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 2208
epoch [160/200] batch [5/29] time 0.534 (0.558) data 0.404 (0.427) loss_x loss_x 1.2041 (1.2445) acc_x 71.8750 (65.0000) lr 2.0984e-04 eta 0:00:13
epoch [160/200] batch [10/29] time 0.460 (0.500) data 0.327 (0.370) loss_x loss_x 1.2158 (1.2359) acc_x 68.7500 (67.8125) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [15/29] time 0.537 (0.476) data 0.406 (0.345) loss_x loss_x 1.1885 (1.2273) acc_x 78.1250 (67.7083) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [20/29] time 0.414 (0.470) data 0.283 (0.339) loss_x loss_x 1.1260 (1.2442) acc_x 75.0000 (67.5000) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [25/29] time 0.431 (0.468) data 0.300 (0.337) loss_x loss_x 1.5029 (1.2354) acc_x 62.5000 (67.6250) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1664
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 924
clean true:815
clean false:109
clean_rate:0.8820346320346321
noisy true:657
noisy false:1555
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 2212
epoch [161/200] batch [5/28] time 0.453 (0.411) data 0.322 (0.280) loss_x loss_x 1.1387 (1.1215) acc_x 65.6250 (70.0000) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [10/28] time 0.500 (0.437) data 0.369 (0.306) loss_x loss_x 1.0615 (1.0713) acc_x 81.2500 (75.0000) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [15/28] time 0.453 (0.457) data 0.321 (0.326) loss_x loss_x 1.1543 (1.0517) acc_x 75.0000 (73.9583) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [20/28] time 0.505 (0.458) data 0.373 (0.327) loss_x loss_x 1.0400 (1.0766) acc_x 78.1250 (72.8125) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [25/28] time 0.568 (0.463) data 0.438 (0.331) loss_x loss_x 1.2881 (1.1206) acc_x 62.5000 (71.7500) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1646
confident_label rate tensor(0.3029, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 950
clean true:823
clean false:127
clean_rate:0.8663157894736843
noisy true:667
noisy false:1519
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 2186
epoch [162/200] batch [5/29] time 0.457 (0.443) data 0.326 (0.312) loss_x loss_x 1.6426 (1.4520) acc_x 59.3750 (68.1250) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [10/29] time 0.449 (0.434) data 0.318 (0.303) loss_x loss_x 1.6602 (1.3652) acc_x 53.1250 (66.2500) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [15/29] time 0.473 (0.449) data 0.341 (0.318) loss_x loss_x 0.9600 (1.2927) acc_x 65.6250 (65.6250) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [20/29] time 0.370 (0.441) data 0.239 (0.310) loss_x loss_x 1.3418 (1.3062) acc_x 75.0000 (66.2500) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [25/29] time 0.439 (0.449) data 0.308 (0.318) loss_x loss_x 1.1807 (1.3068) acc_x 71.8750 (66.6250) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1642
confident_label rate tensor(0.3017, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 946
clean true:841
clean false:105
clean_rate:0.8890063424947146
noisy true:653
noisy false:1537
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 2190
epoch [163/200] batch [5/29] time 0.475 (0.426) data 0.344 (0.294) loss_x loss_x 1.1201 (1.1335) acc_x 75.0000 (71.8750) lr 1.8185e-04 eta 0:00:10
epoch [163/200] batch [10/29] time 0.424 (0.438) data 0.294 (0.307) loss_x loss_x 1.0527 (1.2458) acc_x 65.6250 (70.3125) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [15/29] time 0.464 (0.450) data 0.333 (0.319) loss_x loss_x 1.1045 (1.1748) acc_x 65.6250 (70.4167) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [20/29] time 0.484 (0.453) data 0.354 (0.322) loss_x loss_x 1.6797 (1.2905) acc_x 68.7500 (67.5000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [25/29] time 0.322 (0.445) data 0.191 (0.315) loss_x loss_x 1.8809 (1.2789) acc_x 56.2500 (67.2500) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.2879, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 903
clean true:805
clean false:98
clean_rate:0.8914728682170543
noisy true:684
noisy false:1549
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 2233
epoch [164/200] batch [5/28] time 0.411 (0.454) data 0.280 (0.323) loss_x loss_x 1.7373 (1.5184) acc_x 46.8750 (60.0000) lr 1.7292e-04 eta 0:00:10
epoch [164/200] batch [10/28] time 0.623 (0.462) data 0.487 (0.330) loss_x loss_x 0.8872 (1.3301) acc_x 78.1250 (63.7500) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [15/28] time 0.403 (0.481) data 0.272 (0.349) loss_x loss_x 1.1514 (1.2611) acc_x 78.1250 (67.5000) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [20/28] time 0.479 (0.476) data 0.348 (0.344) loss_x loss_x 1.5312 (1.2343) acc_x 68.7500 (68.9062) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [25/28] time 0.435 (0.468) data 0.303 (0.336) loss_x loss_x 0.9741 (1.3045) acc_x 75.0000 (68.0000) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.2867, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 899
clean true:801
clean false:98
clean_rate:0.8909899888765295
noisy true:665
noisy false:1572
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 2237
epoch [165/200] batch [5/28] time 0.662 (0.526) data 0.531 (0.394) loss_x loss_x 1.2305 (1.2010) acc_x 68.7500 (71.2500) lr 1.6419e-04 eta 0:00:12
epoch [165/200] batch [10/28] time 0.501 (0.515) data 0.370 (0.384) loss_x loss_x 1.2158 (1.2213) acc_x 65.6250 (68.4375) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [15/28] time 0.420 (0.490) data 0.288 (0.359) loss_x loss_x 1.2676 (1.1733) acc_x 65.6250 (69.1667) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [20/28] time 0.387 (0.475) data 0.255 (0.343) loss_x loss_x 1.1436 (1.1867) acc_x 62.5000 (69.0625) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [25/28] time 0.376 (0.471) data 0.245 (0.339) loss_x loss_x 1.3311 (1.2457) acc_x 65.6250 (68.3750) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1639
confident_label rate tensor(0.2972, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 932
clean true:819
clean false:113
clean_rate:0.878755364806867
noisy true:678
noisy false:1526
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 2204
epoch [166/200] batch [5/29] time 0.416 (0.405) data 0.286 (0.274) loss_x loss_x 0.8701 (1.1389) acc_x 75.0000 (69.3750) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [10/29] time 0.399 (0.410) data 0.268 (0.279) loss_x loss_x 1.1602 (1.1341) acc_x 78.1250 (69.6875) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/29] time 0.501 (0.436) data 0.371 (0.305) loss_x loss_x 1.1953 (1.1864) acc_x 75.0000 (69.3750) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [20/29] time 0.427 (0.429) data 0.297 (0.298) loss_x loss_x 0.7158 (1.1828) acc_x 81.2500 (69.8438) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [25/29] time 0.560 (0.444) data 0.429 (0.313) loss_x loss_x 1.3779 (1.2251) acc_x 68.7500 (69.2500) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 909
clean true:816
clean false:93
clean_rate:0.8976897689768977
noisy true:671
noisy false:1556
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 2227
epoch [167/200] batch [5/28] time 0.794 (0.552) data 0.659 (0.420) loss_x loss_x 1.0527 (1.0719) acc_x 78.1250 (73.7500) lr 1.4736e-04 eta 0:00:12
epoch [167/200] batch [10/28] time 0.508 (0.520) data 0.377 (0.388) loss_x loss_x 1.4219 (1.0277) acc_x 65.6250 (74.3750) lr 1.4736e-04 eta 0:00:09
epoch [167/200] batch [15/28] time 0.519 (0.510) data 0.388 (0.378) loss_x loss_x 0.9204 (1.0378) acc_x 78.1250 (72.7083) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [20/28] time 0.565 (0.482) data 0.433 (0.350) loss_x loss_x 0.9985 (1.0770) acc_x 71.8750 (72.3438) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [25/28] time 0.401 (0.477) data 0.270 (0.345) loss_x loss_x 0.8042 (1.0828) acc_x 78.1250 (72.0000) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 918
clean true:810
clean false:108
clean_rate:0.8823529411764706
noisy true:631
noisy false:1587
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 2218
epoch [168/200] batch [5/28] time 0.488 (0.511) data 0.357 (0.379) loss_x loss_x 1.0342 (1.0688) acc_x 71.8750 (73.7500) lr 1.3926e-04 eta 0:00:11
epoch [168/200] batch [10/28] time 0.437 (0.506) data 0.305 (0.375) loss_x loss_x 1.3330 (1.2130) acc_x 65.6250 (71.5625) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [15/28] time 0.443 (0.491) data 0.312 (0.359) loss_x loss_x 1.2168 (1.2068) acc_x 62.5000 (70.0000) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [20/28] time 0.455 (0.470) data 0.323 (0.339) loss_x loss_x 1.0830 (1.1939) acc_x 71.8750 (69.8438) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [25/28] time 0.489 (0.464) data 0.357 (0.332) loss_x loss_x 1.0693 (1.2132) acc_x 59.3750 (69.6250) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.2959, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 928
clean true:820
clean false:108
clean_rate:0.8836206896551724
noisy true:645
noisy false:1563
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 2208
epoch [169/200] batch [5/29] time 0.412 (0.475) data 0.280 (0.343) loss_x loss_x 1.7412 (1.3441) acc_x 62.5000 (66.2500) lr 1.3137e-04 eta 0:00:11
epoch [169/200] batch [10/29] time 0.569 (0.493) data 0.438 (0.362) loss_x loss_x 0.8574 (1.0991) acc_x 71.8750 (71.5625) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [15/29] time 0.415 (0.481) data 0.283 (0.350) loss_x loss_x 1.1387 (1.1315) acc_x 65.6250 (70.4167) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [20/29] time 0.372 (0.466) data 0.241 (0.335) loss_x loss_x 1.2559 (1.1350) acc_x 75.0000 (70.9375) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [25/29] time 0.520 (0.466) data 0.389 (0.334) loss_x loss_x 0.9224 (1.1453) acc_x 78.1250 (71.0000) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1613
confident_label rate tensor(0.2988, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 937
clean true:839
clean false:98
clean_rate:0.8954108858057631
noisy true:684
noisy false:1515
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 2199
epoch [170/200] batch [5/29] time 0.699 (0.517) data 0.567 (0.386) loss_x loss_x 1.2002 (1.2710) acc_x 62.5000 (64.3750) lr 1.2369e-04 eta 0:00:12
epoch [170/200] batch [10/29] time 0.555 (0.505) data 0.424 (0.374) loss_x loss_x 1.2031 (1.2324) acc_x 68.7500 (66.8750) lr 1.2369e-04 eta 0:00:09
epoch [170/200] batch [15/29] time 0.511 (0.504) data 0.380 (0.373) loss_x loss_x 0.9849 (1.2323) acc_x 78.1250 (67.9167) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [20/29] time 0.415 (0.479) data 0.284 (0.347) loss_x loss_x 0.7866 (1.2156) acc_x 75.0000 (68.5938) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [25/29] time 0.589 (0.479) data 0.458 (0.348) loss_x loss_x 0.7378 (1.1710) acc_x 68.7500 (69.1250) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1685
confident_label rate tensor(0.2857, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 896
clean true:796
clean false:100
clean_rate:0.8883928571428571
noisy true:655
noisy false:1585
after delete: len(clean_dataset) 896
after delete: len(noisy_dataset) 2240
epoch [171/200] batch [5/28] time 0.385 (0.450) data 0.254 (0.319) loss_x loss_x 1.0840 (1.0995) acc_x 62.5000 (67.5000) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [10/28] time 0.591 (0.488) data 0.460 (0.357) loss_x loss_x 1.2393 (1.1848) acc_x 71.8750 (67.8125) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [15/28] time 0.377 (0.477) data 0.247 (0.346) loss_x loss_x 0.8071 (1.2020) acc_x 81.2500 (68.3333) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [20/28] time 0.461 (0.490) data 0.330 (0.359) loss_x loss_x 1.2500 (1.1928) acc_x 71.8750 (68.7500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [25/28] time 0.418 (0.483) data 0.287 (0.352) loss_x loss_x 1.3525 (1.2154) acc_x 71.8750 (68.8750) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.2985, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 936
clean true:834
clean false:102
clean_rate:0.8910256410256411
noisy true:655
noisy false:1545
after delete: len(clean_dataset) 936
after delete: len(noisy_dataset) 2200
epoch [172/200] batch [5/29] time 0.385 (0.470) data 0.254 (0.339) loss_x loss_x 0.8252 (1.1098) acc_x 78.1250 (68.7500) lr 1.0899e-04 eta 0:00:11
epoch [172/200] batch [10/29] time 0.453 (0.463) data 0.322 (0.332) loss_x loss_x 1.4736 (1.1705) acc_x 68.7500 (69.3750) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [15/29] time 0.433 (0.480) data 0.302 (0.348) loss_x loss_x 1.4551 (1.1540) acc_x 68.7500 (70.8333) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [20/29] time 0.472 (0.472) data 0.340 (0.340) loss_x loss_x 0.9478 (1.1381) acc_x 75.0000 (70.1562) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [25/29] time 0.432 (0.463) data 0.300 (0.331) loss_x loss_x 1.1299 (1.1487) acc_x 68.7500 (70.3750) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1695
confident_label rate tensor(0.2879, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 903
clean true:796
clean false:107
clean_rate:0.8815060908084164
noisy true:645
noisy false:1588
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 2233
epoch [173/200] batch [5/28] time 0.434 (0.458) data 0.302 (0.326) loss_x loss_x 0.8198 (1.2363) acc_x 78.1250 (70.0000) lr 1.0197e-04 eta 0:00:10
epoch [173/200] batch [10/28] time 0.322 (0.446) data 0.190 (0.315) loss_x loss_x 0.7930 (1.1768) acc_x 81.2500 (71.2500) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [15/28] time 0.505 (0.432) data 0.373 (0.301) loss_x loss_x 1.1436 (1.2410) acc_x 71.8750 (69.1667) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [20/28] time 0.408 (0.450) data 0.276 (0.318) loss_x loss_x 0.6724 (1.1684) acc_x 87.5000 (70.4688) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [25/28] time 0.549 (0.454) data 0.418 (0.323) loss_x loss_x 1.2324 (1.1913) acc_x 78.1250 (70.5000) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1644
confident_label rate tensor(0.2982, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 935
clean true:837
clean false:98
clean_rate:0.895187165775401
noisy true:655
noisy false:1546
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 2201
epoch [174/200] batch [5/29] time 0.395 (0.482) data 0.264 (0.351) loss_x loss_x 1.1016 (1.3459) acc_x 65.6250 (64.3750) lr 9.5173e-05 eta 0:00:11
epoch [174/200] batch [10/29] time 0.454 (0.473) data 0.323 (0.342) loss_x loss_x 1.7119 (1.2638) acc_x 59.3750 (67.8125) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [15/29] time 0.386 (0.471) data 0.255 (0.340) loss_x loss_x 1.1816 (1.2170) acc_x 65.6250 (68.5417) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [20/29] time 0.432 (0.465) data 0.301 (0.334) loss_x loss_x 1.1934 (1.2071) acc_x 65.6250 (69.2188) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [25/29] time 0.466 (0.461) data 0.335 (0.331) loss_x loss_x 1.2617 (1.2102) acc_x 65.6250 (68.0000) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.2924, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 917
clean true:807
clean false:110
clean_rate:0.8800436205016358
noisy true:664
noisy false:1555
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 2219
epoch [175/200] batch [5/28] time 0.471 (0.492) data 0.341 (0.362) loss_x loss_x 1.0283 (1.2932) acc_x 75.0000 (65.6250) lr 8.8597e-05 eta 0:00:11
epoch [175/200] batch [10/28] time 0.454 (0.462) data 0.324 (0.331) loss_x loss_x 1.2461 (1.2685) acc_x 71.8750 (69.0625) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [15/28] time 1.051 (0.487) data 0.919 (0.356) loss_x loss_x 0.7852 (1.2013) acc_x 81.2500 (70.6250) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [20/28] time 0.424 (0.471) data 0.294 (0.340) loss_x loss_x 0.6021 (1.1611) acc_x 90.6250 (72.5000) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [25/28] time 0.388 (0.463) data 0.257 (0.332) loss_x loss_x 1.1104 (1.1593) acc_x 71.8750 (71.5000) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 939
clean true:831
clean false:108
clean_rate:0.8849840255591054
noisy true:665
noisy false:1532
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 2197
epoch [176/200] batch [5/29] time 0.441 (0.440) data 0.310 (0.309) loss_x loss_x 0.8921 (1.0561) acc_x 65.6250 (75.0000) lr 8.2245e-05 eta 0:00:10
epoch [176/200] batch [10/29] time 0.412 (0.464) data 0.281 (0.333) loss_x loss_x 1.0166 (1.0882) acc_x 75.0000 (74.3750) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [15/29] time 0.464 (0.467) data 0.334 (0.335) loss_x loss_x 1.0928 (1.1038) acc_x 68.7500 (74.1667) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [20/29] time 0.423 (0.469) data 0.291 (0.338) loss_x loss_x 0.8477 (1.1403) acc_x 75.0000 (73.1250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [25/29] time 0.418 (0.463) data 0.287 (0.332) loss_x loss_x 1.1270 (1.1582) acc_x 65.6250 (72.8750) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2969, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 931
clean true:823
clean false:108
clean_rate:0.8839957035445757
noisy true:656
noisy false:1549
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 2205
epoch [177/200] batch [5/29] time 0.418 (0.484) data 0.287 (0.353) loss_x loss_x 1.3301 (1.0718) acc_x 65.6250 (69.3750) lr 7.6120e-05 eta 0:00:11
epoch [177/200] batch [10/29] time 0.404 (0.478) data 0.273 (0.347) loss_x loss_x 1.6660 (1.1532) acc_x 56.2500 (67.8125) lr 7.6120e-05 eta 0:00:09
epoch [177/200] batch [15/29] time 0.439 (0.486) data 0.308 (0.355) loss_x loss_x 1.0615 (1.1282) acc_x 65.6250 (66.8750) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [20/29] time 0.565 (0.489) data 0.434 (0.357) loss_x loss_x 1.5479 (1.1522) acc_x 62.5000 (67.1875) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/29] time 0.381 (0.477) data 0.249 (0.346) loss_x loss_x 0.8823 (1.1702) acc_x 75.0000 (67.6250) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1627
confident_label rate tensor(0.2879, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 903
clean true:801
clean false:102
clean_rate:0.8870431893687708
noisy true:708
noisy false:1525
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 2233
epoch [178/200] batch [5/28] time 0.488 (0.581) data 0.356 (0.447) loss_x loss_x 1.2412 (1.6574) acc_x 68.7500 (60.6250) lr 7.0224e-05 eta 0:00:13
epoch [178/200] batch [10/28] time 0.340 (0.525) data 0.209 (0.393) loss_x loss_x 1.7803 (1.3966) acc_x 56.2500 (66.8750) lr 7.0224e-05 eta 0:00:09
epoch [178/200] batch [15/28] time 0.539 (0.505) data 0.407 (0.373) loss_x loss_x 0.9746 (1.3172) acc_x 78.1250 (68.9583) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [20/28] time 0.559 (0.506) data 0.428 (0.374) loss_x loss_x 0.8921 (1.2263) acc_x 84.3750 (72.0312) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [25/28] time 0.497 (0.498) data 0.365 (0.366) loss_x loss_x 1.4512 (1.2184) acc_x 53.1250 (71.3750) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1622
confident_label rate tensor(0.2953, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 926
clean true:823
clean false:103
clean_rate:0.8887688984881209
noisy true:691
noisy false:1519
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 2210
epoch [179/200] batch [5/28] time 0.522 (0.495) data 0.390 (0.364) loss_x loss_x 1.3809 (1.0994) acc_x 62.5000 (69.3750) lr 6.4556e-05 eta 0:00:11
epoch [179/200] batch [10/28] time 0.378 (0.470) data 0.247 (0.338) loss_x loss_x 1.2197 (1.1428) acc_x 65.6250 (70.0000) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [15/28] time 0.461 (0.473) data 0.330 (0.341) loss_x loss_x 1.4023 (1.2545) acc_x 75.0000 (68.3333) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [20/28] time 0.518 (0.472) data 0.383 (0.341) loss_x loss_x 0.6855 (1.2417) acc_x 84.3750 (68.7500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [25/28] time 0.417 (0.483) data 0.285 (0.352) loss_x loss_x 1.3574 (1.2296) acc_x 71.8750 (69.0000) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.2902, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 910
clean true:808
clean false:102
clean_rate:0.8879120879120879
noisy true:658
noisy false:1568
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 2226
epoch [180/200] batch [5/28] time 0.376 (0.456) data 0.245 (0.324) loss_x loss_x 1.8848 (1.3506) acc_x 62.5000 (72.5000) lr 5.9119e-05 eta 0:00:10
epoch [180/200] batch [10/28] time 0.426 (0.444) data 0.295 (0.313) loss_x loss_x 0.8491 (1.1710) acc_x 78.1250 (73.7500) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [15/28] time 0.410 (0.429) data 0.279 (0.298) loss_x loss_x 1.0947 (1.1410) acc_x 78.1250 (74.1667) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [20/28] time 0.469 (0.437) data 0.338 (0.306) loss_x loss_x 0.8003 (1.1093) acc_x 78.1250 (74.2188) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [25/28] time 0.409 (0.449) data 0.278 (0.318) loss_x loss_x 1.1494 (1.0924) acc_x 71.8750 (74.3750) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1654
confident_label rate tensor(0.2943, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 923
clean true:812
clean false:111
clean_rate:0.8797399783315276
noisy true:670
noisy false:1543
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 2213
epoch [181/200] batch [5/28] time 0.623 (0.486) data 0.491 (0.355) loss_x loss_x 1.4727 (1.1995) acc_x 62.5000 (66.8750) lr 5.3915e-05 eta 0:00:11
epoch [181/200] batch [10/28] time 0.375 (0.443) data 0.243 (0.311) loss_x loss_x 1.1182 (1.1690) acc_x 75.0000 (70.3125) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [15/28] time 0.522 (0.468) data 0.390 (0.337) loss_x loss_x 1.3271 (1.1558) acc_x 65.6250 (70.0000) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [20/28] time 0.422 (0.465) data 0.292 (0.334) loss_x loss_x 0.7954 (1.1375) acc_x 78.1250 (69.5312) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [25/28] time 0.456 (0.465) data 0.325 (0.334) loss_x loss_x 0.7681 (1.1205) acc_x 81.2500 (69.6250) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.2972, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 932
clean true:828
clean false:104
clean_rate:0.8884120171673819
noisy true:639
noisy false:1565
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 2204
epoch [182/200] batch [5/29] time 0.538 (0.429) data 0.407 (0.298) loss_x loss_x 1.0410 (1.0921) acc_x 75.0000 (73.1250) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [10/29] time 0.542 (0.477) data 0.407 (0.344) loss_x loss_x 0.7622 (1.1249) acc_x 81.2500 (74.0625) lr 4.8943e-05 eta 0:00:09
epoch [182/200] batch [15/29] time 0.530 (0.496) data 0.399 (0.363) loss_x loss_x 1.1152 (1.1111) acc_x 65.6250 (73.1250) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [20/29] time 0.457 (0.492) data 0.325 (0.360) loss_x loss_x 1.0400 (1.1735) acc_x 75.0000 (70.7812) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [25/29] time 0.431 (0.480) data 0.300 (0.348) loss_x loss_x 1.0029 (1.1788) acc_x 68.7500 (70.1250) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1663
confident_label rate tensor(0.2950, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 925
clean true:815
clean false:110
clean_rate:0.8810810810810811
noisy true:658
noisy false:1553
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 2211
epoch [183/200] batch [5/28] time 0.389 (0.431) data 0.259 (0.300) loss_x loss_x 0.9756 (1.2355) acc_x 78.1250 (66.2500) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [10/28] time 0.542 (0.450) data 0.411 (0.319) loss_x loss_x 1.7402 (1.3387) acc_x 62.5000 (66.2500) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [15/28] time 0.460 (0.470) data 0.329 (0.339) loss_x loss_x 0.9653 (1.3010) acc_x 75.0000 (66.6667) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [20/28] time 0.614 (0.485) data 0.483 (0.354) loss_x loss_x 1.4951 (1.3119) acc_x 68.7500 (66.7188) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [25/28] time 0.394 (0.480) data 0.263 (0.349) loss_x loss_x 1.6426 (1.3095) acc_x 56.2500 (67.8750) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1647
confident_label rate tensor(0.2950, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 925
clean true:814
clean false:111
clean_rate:0.88
noisy true:675
noisy false:1536
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 2211
epoch [184/200] batch [5/28] time 0.394 (0.415) data 0.263 (0.283) loss_x loss_x 1.5859 (1.2756) acc_x 53.1250 (65.0000) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [10/28] time 0.454 (0.414) data 0.323 (0.282) loss_x loss_x 0.8105 (1.1125) acc_x 71.8750 (69.3750) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [15/28] time 0.434 (0.407) data 0.303 (0.276) loss_x loss_x 1.1123 (1.1412) acc_x 75.0000 (67.5000) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [20/28] time 0.788 (0.454) data 0.657 (0.322) loss_x loss_x 1.3936 (1.1679) acc_x 68.7500 (68.2812) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [25/28] time 0.513 (0.468) data 0.381 (0.337) loss_x loss_x 0.9653 (1.1447) acc_x 62.5000 (67.8750) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.2969, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 931
clean true:820
clean false:111
clean_rate:0.8807733619763695
noisy true:647
noisy false:1558
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 2205
epoch [185/200] batch [5/29] time 0.577 (0.483) data 0.447 (0.352) loss_x loss_x 1.2764 (1.3215) acc_x 62.5000 (63.7500) lr 3.5443e-05 eta 0:00:11
epoch [185/200] batch [10/29] time 0.361 (0.473) data 0.230 (0.343) loss_x loss_x 1.0303 (1.1705) acc_x 71.8750 (67.1875) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [15/29] time 0.473 (0.466) data 0.341 (0.335) loss_x loss_x 1.2178 (1.1867) acc_x 71.8750 (68.1250) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [20/29] time 0.407 (0.458) data 0.277 (0.327) loss_x loss_x 1.2021 (1.1657) acc_x 59.3750 (68.4375) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [25/29] time 0.380 (0.449) data 0.249 (0.318) loss_x loss_x 1.1914 (1.1795) acc_x 68.7500 (69.2500) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1668
confident_label rate tensor(0.2911, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 913
clean true:819
clean false:94
clean_rate:0.8970427163198248
noisy true:649
noisy false:1574
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 2223
epoch [186/200] batch [5/28] time 0.424 (0.428) data 0.293 (0.297) loss_x loss_x 1.2178 (1.0242) acc_x 78.1250 (75.6250) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [10/28] time 0.437 (0.462) data 0.306 (0.331) loss_x loss_x 1.2783 (1.1937) acc_x 65.6250 (71.8750) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [15/28] time 0.469 (0.441) data 0.338 (0.311) loss_x loss_x 0.6050 (1.1247) acc_x 81.2500 (72.5000) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [20/28] time 0.367 (0.444) data 0.236 (0.314) loss_x loss_x 0.6543 (1.1551) acc_x 81.2500 (71.7188) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [25/28] time 0.336 (0.433) data 0.206 (0.303) loss_x loss_x 1.0117 (1.1338) acc_x 65.6250 (71.7500) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.2991, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 938
clean true:824
clean false:114
clean_rate:0.8784648187633263
noisy true:646
noisy false:1552
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 2198
epoch [187/200] batch [5/29] time 0.435 (0.428) data 0.304 (0.297) loss_x loss_x 0.8872 (1.2163) acc_x 71.8750 (65.0000) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [10/29] time 0.361 (0.426) data 0.230 (0.296) loss_x loss_x 1.3008 (1.1852) acc_x 62.5000 (66.8750) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [15/29] time 0.426 (0.433) data 0.295 (0.302) loss_x loss_x 0.9536 (1.1685) acc_x 75.0000 (69.3750) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [20/29] time 0.389 (0.426) data 0.258 (0.295) loss_x loss_x 1.1260 (1.1219) acc_x 84.3750 (71.0938) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [25/29] time 0.548 (0.431) data 0.417 (0.300) loss_x loss_x 1.4756 (1.1859) acc_x 68.7500 (70.2500) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1619
confident_label rate tensor(0.2975, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 933
clean true:835
clean false:98
clean_rate:0.894962486602358
noisy true:682
noisy false:1521
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 2203
epoch [188/200] batch [5/29] time 0.441 (0.442) data 0.310 (0.311) loss_x loss_x 1.0449 (1.2601) acc_x 75.0000 (72.5000) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [10/29] time 0.453 (0.420) data 0.322 (0.289) loss_x loss_x 1.5957 (1.2199) acc_x 56.2500 (70.9375) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [15/29] time 0.366 (0.414) data 0.236 (0.283) loss_x loss_x 1.2070 (1.1517) acc_x 71.8750 (71.8750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [20/29] time 0.404 (0.427) data 0.273 (0.296) loss_x loss_x 0.9297 (1.1145) acc_x 75.0000 (72.1875) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [25/29] time 0.469 (0.433) data 0.338 (0.303) loss_x loss_x 0.7456 (1.1218) acc_x 84.3750 (72.0000) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1644
confident_label rate tensor(0.2975, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 933
clean true:823
clean false:110
clean_rate:0.8821007502679529
noisy true:669
noisy false:1534
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 2203
epoch [189/200] batch [5/29] time 0.423 (0.418) data 0.292 (0.287) loss_x loss_x 1.2305 (1.4768) acc_x 71.8750 (62.5000) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [10/29] time 0.529 (0.456) data 0.398 (0.325) loss_x loss_x 1.2637 (1.2665) acc_x 65.6250 (67.8125) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [15/29] time 0.377 (0.438) data 0.246 (0.307) loss_x loss_x 1.2324 (1.2737) acc_x 68.7500 (68.1250) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [20/29] time 0.492 (0.434) data 0.361 (0.303) loss_x loss_x 1.6738 (1.3061) acc_x 59.3750 (67.0312) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [25/29] time 0.446 (0.446) data 0.315 (0.315) loss_x loss_x 0.7227 (1.2664) acc_x 84.3750 (68.6250) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1687
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 916
clean true:802
clean false:114
clean_rate:0.8755458515283843
noisy true:647
noisy false:1573
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 2220
epoch [190/200] batch [5/28] time 0.478 (0.411) data 0.347 (0.280) loss_x loss_x 1.3623 (1.3018) acc_x 65.6250 (68.1250) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [10/28] time 0.382 (0.458) data 0.251 (0.327) loss_x loss_x 0.9907 (1.1592) acc_x 78.1250 (70.6250) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [15/28] time 0.342 (0.433) data 0.211 (0.302) loss_x loss_x 1.0547 (1.1567) acc_x 71.8750 (70.6250) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [20/28] time 0.502 (0.444) data 0.372 (0.313) loss_x loss_x 1.1992 (1.1927) acc_x 62.5000 (69.6875) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [25/28] time 0.444 (0.445) data 0.313 (0.315) loss_x loss_x 1.2422 (1.1808) acc_x 62.5000 (69.5000) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1653
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 924
clean true:824
clean false:100
clean_rate:0.8917748917748918
noisy true:659
noisy false:1553
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 2212
epoch [191/200] batch [5/28] time 0.340 (0.433) data 0.211 (0.302) loss_x loss_x 1.2148 (1.1725) acc_x 68.7500 (72.5000) lr 1.4891e-05 eta 0:00:09
epoch [191/200] batch [10/28] time 0.440 (0.435) data 0.310 (0.305) loss_x loss_x 1.5049 (1.2372) acc_x 65.6250 (69.0625) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [15/28] time 0.360 (0.424) data 0.229 (0.294) loss_x loss_x 0.8594 (1.1864) acc_x 81.2500 (70.6250) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [20/28] time 0.329 (0.422) data 0.198 (0.292) loss_x loss_x 1.3369 (1.1780) acc_x 68.7500 (70.4688) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [25/28] time 0.361 (0.422) data 0.230 (0.291) loss_x loss_x 0.7437 (1.1831) acc_x 84.3750 (70.6250) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1638
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 927
clean true:824
clean false:103
clean_rate:0.8888888888888888
noisy true:674
noisy false:1535
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 2209
epoch [192/200] batch [5/28] time 0.400 (0.430) data 0.270 (0.299) loss_x loss_x 0.8623 (1.3293) acc_x 75.0000 (68.1250) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [10/28] time 0.454 (0.421) data 0.323 (0.290) loss_x loss_x 1.4043 (1.3929) acc_x 62.5000 (64.6875) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [15/28] time 0.466 (0.427) data 0.335 (0.296) loss_x loss_x 0.9453 (1.2847) acc_x 87.5000 (68.3333) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [20/28] time 0.399 (0.428) data 0.267 (0.297) loss_x loss_x 1.3633 (1.2329) acc_x 71.8750 (70.0000) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [25/28] time 0.390 (0.445) data 0.258 (0.314) loss_x loss_x 1.3506 (1.2344) acc_x 62.5000 (70.3750) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1640
confident_label rate tensor(0.3036, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 952
clean true:849
clean false:103
clean_rate:0.8918067226890757
noisy true:647
noisy false:1537
after delete: len(clean_dataset) 952
after delete: len(noisy_dataset) 2184
epoch [193/200] batch [5/29] time 0.547 (0.467) data 0.416 (0.336) loss_x loss_x 1.2568 (1.2314) acc_x 65.6250 (65.6250) lr 9.9763e-06 eta 0:00:11
epoch [193/200] batch [10/29] time 0.395 (0.423) data 0.264 (0.292) loss_x loss_x 1.1533 (1.2374) acc_x 71.8750 (66.5625) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [15/29] time 0.574 (0.430) data 0.443 (0.299) loss_x loss_x 1.1768 (1.2115) acc_x 62.5000 (67.7083) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [20/29] time 0.368 (0.436) data 0.238 (0.305) loss_x loss_x 1.2246 (1.2281) acc_x 71.8750 (68.9062) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [25/29] time 0.454 (0.439) data 0.323 (0.308) loss_x loss_x 1.3135 (1.2145) acc_x 65.6250 (69.5000) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.2969, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 931
clean true:820
clean false:111
clean_rate:0.8807733619763695
noisy true:647
noisy false:1558
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 2205
epoch [194/200] batch [5/29] time 0.373 (0.478) data 0.242 (0.347) loss_x loss_x 0.8203 (1.0697) acc_x 84.3750 (75.6250) lr 7.8853e-06 eta 0:00:11
epoch [194/200] batch [10/29] time 0.355 (0.447) data 0.224 (0.316) loss_x loss_x 1.3828 (1.0588) acc_x 65.6250 (74.3750) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [15/29] time 0.360 (0.443) data 0.229 (0.312) loss_x loss_x 1.8613 (1.1335) acc_x 56.2500 (72.0833) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [20/29] time 0.405 (0.441) data 0.274 (0.310) loss_x loss_x 1.4111 (1.1476) acc_x 65.6250 (70.9375) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [25/29] time 0.427 (0.435) data 0.296 (0.304) loss_x loss_x 1.6953 (1.2006) acc_x 65.6250 (69.7500) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1630
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 927
clean true:824
clean false:103
clean_rate:0.8888888888888888
noisy true:682
noisy false:1527
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 2209
epoch [195/200] batch [5/28] time 0.411 (0.491) data 0.280 (0.360) loss_x loss_x 1.2012 (1.3521) acc_x 75.0000 (65.0000) lr 6.0390e-06 eta 0:00:11
epoch [195/200] batch [10/28] time 0.345 (0.444) data 0.214 (0.313) loss_x loss_x 0.9658 (1.3053) acc_x 81.2500 (66.5625) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [15/28] time 0.490 (0.433) data 0.357 (0.302) loss_x loss_x 1.5586 (1.3437) acc_x 59.3750 (65.4167) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [20/28] time 0.647 (0.454) data 0.515 (0.323) loss_x loss_x 1.7637 (1.3256) acc_x 56.2500 (67.3438) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [25/28] time 0.430 (0.467) data 0.298 (0.335) loss_x loss_x 1.0195 (1.2982) acc_x 75.0000 (67.8750) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1703
confident_label rate tensor(0.2848, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 893
clean true:788
clean false:105
clean_rate:0.8824188129899216
noisy true:645
noisy false:1598
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 2243
epoch [196/200] batch [5/27] time 0.427 (0.517) data 0.295 (0.385) loss_x loss_x 1.4922 (1.3453) acc_x 59.3750 (66.8750) lr 4.4380e-06 eta 0:00:11
epoch [196/200] batch [10/27] time 0.398 (0.480) data 0.266 (0.348) loss_x loss_x 1.6875 (1.2515) acc_x 50.0000 (67.8125) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [15/27] time 0.429 (0.457) data 0.298 (0.326) loss_x loss_x 0.9028 (1.1627) acc_x 81.2500 (70.8333) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [20/27] time 0.392 (0.460) data 0.261 (0.329) loss_x loss_x 1.3623 (1.2225) acc_x 59.3750 (69.0625) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [25/27] time 0.395 (0.448) data 0.264 (0.317) loss_x loss_x 1.0781 (1.2253) acc_x 75.0000 (69.1250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1661
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 918
clean true:809
clean false:109
clean_rate:0.8812636165577342
noisy true:666
noisy false:1552
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 2218
epoch [197/200] batch [5/28] time 0.606 (0.447) data 0.474 (0.315) loss_x loss_x 1.0693 (1.3391) acc_x 84.3750 (68.7500) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [10/28] time 0.584 (0.460) data 0.453 (0.329) loss_x loss_x 1.4922 (1.3103) acc_x 65.6250 (67.5000) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [15/28] time 0.407 (0.480) data 0.275 (0.348) loss_x loss_x 1.1055 (1.3005) acc_x 62.5000 (67.2917) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [20/28] time 0.397 (0.468) data 0.266 (0.336) loss_x loss_x 1.1484 (1.3215) acc_x 68.7500 (66.5625) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [25/28] time 0.397 (0.453) data 0.266 (0.322) loss_x loss_x 1.0996 (1.3103) acc_x 65.6250 (66.3750) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 909
clean true:807
clean false:102
clean_rate:0.8877887788778878
noisy true:672
noisy false:1555
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 2227
epoch [198/200] batch [5/28] time 0.644 (0.517) data 0.513 (0.385) loss_x loss_x 0.9688 (0.9962) acc_x 75.0000 (80.6250) lr 1.9733e-06 eta 0:00:11
epoch [198/200] batch [10/28] time 0.612 (0.506) data 0.480 (0.374) loss_x loss_x 0.9854 (1.0442) acc_x 62.5000 (76.2500) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [15/28] time 0.374 (0.474) data 0.243 (0.343) loss_x loss_x 1.0840 (1.0688) acc_x 68.7500 (73.7500) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [20/28] time 0.362 (0.457) data 0.231 (0.325) loss_x loss_x 1.1104 (1.1226) acc_x 71.8750 (72.1875) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [25/28] time 0.582 (0.460) data 0.450 (0.328) loss_x loss_x 1.2793 (1.1238) acc_x 71.8750 (73.0000) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1644
confident_label rate tensor(0.2966, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 930
clean true:824
clean false:106
clean_rate:0.886021505376344
noisy true:668
noisy false:1538
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 2206
epoch [199/200] batch [5/29] time 0.527 (0.470) data 0.396 (0.338) loss_x loss_x 1.3574 (1.3143) acc_x 75.0000 (68.7500) lr 1.1101e-06 eta 0:00:11
epoch [199/200] batch [10/29] time 0.466 (0.461) data 0.335 (0.330) loss_x loss_x 1.8955 (1.2770) acc_x 56.2500 (69.0625) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [15/29] time 0.559 (0.464) data 0.427 (0.332) loss_x loss_x 1.0791 (1.2708) acc_x 75.0000 (69.5833) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [20/29] time 0.530 (0.463) data 0.398 (0.331) loss_x loss_x 1.7012 (1.2452) acc_x 56.2500 (69.6875) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [25/29] time 0.374 (0.453) data 0.242 (0.321) loss_x loss_x 1.5195 (1.2883) acc_x 68.7500 (69.1250) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 927
clean true:814
clean false:113
clean_rate:0.8781014023732471
noisy true:647
noisy false:1562
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 2209
epoch [200/200] batch [5/28] time 0.471 (0.451) data 0.340 (0.320) loss_x loss_x 1.1250 (1.2152) acc_x 68.7500 (70.6250) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [10/28] time 0.382 (0.439) data 0.250 (0.307) loss_x loss_x 1.2432 (1.3188) acc_x 68.7500 (69.0625) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [15/28] time 0.538 (0.488) data 0.406 (0.356) loss_x loss_x 1.0811 (1.2574) acc_x 71.8750 (70.0000) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [20/28] time 0.412 (0.485) data 0.281 (0.353) loss_x loss_x 1.0645 (1.2219) acc_x 84.3750 (70.3125) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [25/28] time 0.369 (0.472) data 0.236 (0.340) loss_x loss_x 1.1025 (1.2285) acc_x 81.2500 (69.8750) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 4,762
* accuracy: 59.2%
* error: 40.8%
* macro_f1: 57.2%
Elapsed: 3:09:58
