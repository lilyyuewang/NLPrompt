***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1445, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 453
clean true:429
clean false:24
clean_rate:0.9470198675496688
noisy true:136
noisy false:2547
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 2683
epoch [1/200] batch [5/14] time 0.434 (0.510) data 0.304 (0.362) loss_x loss_x 3.0469 (3.0875) acc_x 43.7500 (35.0000) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [10/14] time 0.509 (0.507) data 0.380 (0.368) loss_x loss_x 2.5527 (2.8186) acc_x 53.1250 (40.9375) lr 1.0000e-05 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2312
confident_label rate tensor(0.2044, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 641
clean true:617
clean false:24
clean_rate:0.9625585023400937
noisy true:207
noisy false:2288
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 2495
epoch [2/200] batch [5/20] time 0.461 (0.505) data 0.331 (0.372) loss_x loss_x 2.0586 (1.9432) acc_x 53.1250 (51.8750) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [10/20] time 0.498 (0.512) data 0.367 (0.380) loss_x loss_x 1.7588 (1.8916) acc_x 56.2500 (52.1875) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [15/20] time 0.482 (0.505) data 0.350 (0.373) loss_x loss_x 2.1797 (1.8920) acc_x 28.1250 (50.8333) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [20/20] time 0.484 (0.512) data 0.353 (0.380) loss_x loss_x 1.8379 (1.8549) acc_x 59.3750 (51.7188) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1982
confident_label rate tensor(0.2835, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 889
clean true:871
clean false:18
clean_rate:0.9797525309336333
noisy true:283
noisy false:1964
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 2247
epoch [3/200] batch [5/27] time 0.564 (0.486) data 0.434 (0.354) loss_x loss_x 1.1904 (1.6893) acc_x 68.7500 (53.7500) lr 1.9999e-03 eta 0:00:10
epoch [3/200] batch [10/27] time 0.587 (0.507) data 0.456 (0.375) loss_x loss_x 1.3965 (1.6277) acc_x 68.7500 (55.3125) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [15/27] time 0.528 (0.505) data 0.397 (0.373) loss_x loss_x 1.4941 (1.6395) acc_x 68.7500 (56.0417) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [20/27] time 0.664 (0.513) data 0.533 (0.382) loss_x loss_x 1.8896 (1.6494) acc_x 46.8750 (56.5625) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/27] time 0.494 (0.516) data 0.363 (0.385) loss_x loss_x 2.0039 (1.6820) acc_x 50.0000 (55.3750) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1922
confident_label rate tensor(0.3048, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 956
clean true:931
clean false:25
clean_rate:0.9738493723849372
noisy true:283
noisy false:1897
after delete: len(clean_dataset) 956
after delete: len(noisy_dataset) 2180
epoch [4/200] batch [5/29] time 0.469 (0.487) data 0.338 (0.355) loss_x loss_x 1.7598 (1.5549) acc_x 46.8750 (54.3750) lr 1.9995e-03 eta 0:00:11
epoch [4/200] batch [10/29] time 0.531 (0.524) data 0.400 (0.393) loss_x loss_x 1.4854 (1.4738) acc_x 56.2500 (56.8750) lr 1.9995e-03 eta 0:00:09
epoch [4/200] batch [15/29] time 0.380 (0.503) data 0.250 (0.372) loss_x loss_x 1.8057 (1.6128) acc_x 62.5000 (55.4167) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [20/29] time 0.502 (0.487) data 0.371 (0.356) loss_x loss_x 1.2178 (1.5490) acc_x 65.6250 (57.3438) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [25/29] time 0.374 (0.486) data 0.242 (0.355) loss_x loss_x 1.9766 (1.6023) acc_x 43.7500 (55.5000) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1905
confident_label rate tensor(0.3182, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 998
clean true:963
clean false:35
clean_rate:0.9649298597194389
noisy true:268
noisy false:1870
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 2138
epoch [5/200] batch [5/31] time 0.502 (0.486) data 0.372 (0.356) loss_x loss_x 1.6514 (1.6883) acc_x 53.1250 (51.2500) lr 1.9989e-03 eta 0:00:12
epoch [5/200] batch [10/31] time 0.517 (0.521) data 0.386 (0.390) loss_x loss_x 1.6416 (1.6424) acc_x 46.8750 (54.6875) lr 1.9989e-03 eta 0:00:10
epoch [5/200] batch [15/31] time 0.443 (0.509) data 0.312 (0.378) loss_x loss_x 1.1826 (1.4922) acc_x 68.7500 (59.5833) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [20/31] time 0.333 (0.490) data 0.202 (0.359) loss_x loss_x 1.2764 (1.4905) acc_x 65.6250 (59.6875) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [25/31] time 0.551 (0.489) data 0.420 (0.358) loss_x loss_x 1.8662 (1.5295) acc_x 40.6250 (58.2500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [30/31] time 0.376 (0.481) data 0.246 (0.350) loss_x loss_x 1.5596 (1.5212) acc_x 56.2500 (59.0625) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1889
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 982
clean true:949
clean false:33
clean_rate:0.9663951120162932
noisy true:298
noisy false:1856
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 2154
epoch [6/200] batch [5/30] time 0.402 (0.451) data 0.271 (0.319) loss_x loss_x 1.5557 (1.6508) acc_x 50.0000 (52.5000) lr 1.9980e-03 eta 0:00:11
epoch [6/200] batch [10/30] time 0.537 (0.489) data 0.406 (0.358) loss_x loss_x 1.6475 (1.6079) acc_x 59.3750 (55.0000) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [15/30] time 0.512 (0.478) data 0.381 (0.346) loss_x loss_x 1.7393 (1.5969) acc_x 56.2500 (56.6667) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [20/30] time 0.399 (0.461) data 0.268 (0.330) loss_x loss_x 1.2490 (1.5288) acc_x 75.0000 (59.2188) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [25/30] time 0.485 (0.466) data 0.353 (0.335) loss_x loss_x 1.3457 (1.5476) acc_x 65.6250 (58.3750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [30/30] time 0.418 (0.470) data 0.286 (0.338) loss_x loss_x 2.0547 (1.5556) acc_x 56.2500 (58.2292) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1873
confident_label rate tensor(0.3198, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1003
clean true:977
clean false:26
clean_rate:0.9740777666999003
noisy true:286
noisy false:1847
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 2133
epoch [7/200] batch [5/31] time 0.606 (0.481) data 0.476 (0.351) loss_x loss_x 1.6504 (1.5598) acc_x 62.5000 (57.5000) lr 1.9969e-03 eta 0:00:12
epoch [7/200] batch [10/31] time 0.367 (0.465) data 0.236 (0.334) loss_x loss_x 1.5732 (1.5695) acc_x 50.0000 (58.1250) lr 1.9969e-03 eta 0:00:09
epoch [7/200] batch [15/31] time 0.467 (0.472) data 0.336 (0.341) loss_x loss_x 1.9629 (1.6053) acc_x 59.3750 (58.3333) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [20/31] time 0.422 (0.464) data 0.290 (0.333) loss_x loss_x 1.4004 (1.5980) acc_x 71.8750 (57.9688) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [25/31] time 0.428 (0.474) data 0.298 (0.343) loss_x loss_x 1.3604 (1.5980) acc_x 68.7500 (57.3750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [30/31] time 0.511 (0.477) data 0.381 (0.346) loss_x loss_x 1.1982 (1.5948) acc_x 56.2500 (57.0833) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1827
confident_label rate tensor(0.3233, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1014
clean true:992
clean false:22
clean_rate:0.9783037475345168
noisy true:317
noisy false:1805
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 2122
epoch [8/200] batch [5/31] time 0.570 (0.457) data 0.440 (0.327) loss_x loss_x 1.4551 (1.7711) acc_x 65.6250 (54.3750) lr 1.9956e-03 eta 0:00:11
epoch [8/200] batch [10/31] time 0.515 (0.472) data 0.384 (0.342) loss_x loss_x 1.7715 (1.7062) acc_x 50.0000 (54.3750) lr 1.9956e-03 eta 0:00:09
epoch [8/200] batch [15/31] time 0.390 (0.474) data 0.260 (0.343) loss_x loss_x 1.6201 (1.6777) acc_x 53.1250 (55.2083) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [20/31] time 0.443 (0.468) data 0.312 (0.337) loss_x loss_x 1.3477 (1.6356) acc_x 65.6250 (57.1875) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [25/31] time 0.522 (0.465) data 0.391 (0.334) loss_x loss_x 1.8281 (1.6489) acc_x 71.8750 (57.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/31] time 0.455 (0.463) data 0.325 (0.332) loss_x loss_x 1.3721 (1.5994) acc_x 62.5000 (58.2292) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1826
confident_label rate tensor(0.3281, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1029
clean true:1001
clean false:28
clean_rate:0.9727891156462585
noisy true:309
noisy false:1798
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 2107
epoch [9/200] batch [5/32] time 0.404 (0.417) data 0.273 (0.286) loss_x loss_x 1.5713 (1.5338) acc_x 59.3750 (60.0000) lr 1.9940e-03 eta 0:00:11
epoch [9/200] batch [10/32] time 0.550 (0.427) data 0.419 (0.297) loss_x loss_x 1.0498 (1.5599) acc_x 75.0000 (59.0625) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [15/32] time 0.601 (0.442) data 0.470 (0.312) loss_x loss_x 1.6318 (1.5828) acc_x 56.2500 (58.1250) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [20/32] time 0.388 (0.435) data 0.257 (0.305) loss_x loss_x 1.4600 (1.5882) acc_x 59.3750 (57.6562) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [25/32] time 0.639 (0.450) data 0.509 (0.320) loss_x loss_x 1.5928 (1.5496) acc_x 53.1250 (58.0000) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [30/32] time 0.451 (0.453) data 0.320 (0.322) loss_x loss_x 1.0283 (1.5257) acc_x 75.0000 (58.9583) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1851
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1021
clean true:991
clean false:30
clean_rate:0.970617042115573
noisy true:294
noisy false:1821
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 2115
epoch [10/200] batch [5/31] time 0.537 (0.456) data 0.406 (0.325) loss_x loss_x 1.1719 (1.4254) acc_x 65.6250 (64.3750) lr 1.9921e-03 eta 0:00:11
epoch [10/200] batch [10/31] time 0.432 (0.481) data 0.301 (0.351) loss_x loss_x 2.2500 (1.4799) acc_x 53.1250 (61.2500) lr 1.9921e-03 eta 0:00:10
epoch [10/200] batch [15/31] time 0.471 (0.473) data 0.340 (0.342) loss_x loss_x 1.9678 (1.5776) acc_x 50.0000 (60.0000) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [20/31] time 0.458 (0.469) data 0.327 (0.338) loss_x loss_x 1.7549 (1.5986) acc_x 53.1250 (59.3750) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [25/31] time 0.489 (0.471) data 0.359 (0.340) loss_x loss_x 1.6270 (1.5474) acc_x 53.1250 (60.0000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [30/31] time 0.604 (0.466) data 0.473 (0.335) loss_x loss_x 1.0850 (1.5348) acc_x 65.6250 (60.2083) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.3367, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1056
clean true:1026
clean false:30
clean_rate:0.9715909090909091
noisy true:323
noisy false:1757
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 2080
epoch [11/200] batch [5/33] time 0.612 (0.520) data 0.482 (0.390) loss_x loss_x 1.4785 (1.4740) acc_x 65.6250 (63.1250) lr 1.9900e-03 eta 0:00:14
epoch [11/200] batch [10/33] time 0.358 (0.481) data 0.227 (0.351) loss_x loss_x 1.0586 (1.4508) acc_x 71.8750 (62.1875) lr 1.9900e-03 eta 0:00:11
epoch [11/200] batch [15/33] time 0.504 (0.486) data 0.373 (0.356) loss_x loss_x 1.7676 (1.4439) acc_x 46.8750 (61.4583) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [20/33] time 0.439 (0.475) data 0.309 (0.344) loss_x loss_x 1.7451 (1.4941) acc_x 53.1250 (60.1562) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [25/33] time 0.600 (0.479) data 0.468 (0.348) loss_x loss_x 1.5977 (1.5182) acc_x 56.2500 (59.7500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [30/33] time 0.719 (0.485) data 0.588 (0.354) loss_x loss_x 1.7373 (1.5216) acc_x 62.5000 (59.4792) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1840
confident_label rate tensor(0.3313, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1039
clean true:1007
clean false:32
clean_rate:0.9692011549566891
noisy true:289
noisy false:1808
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 2097
epoch [12/200] batch [5/32] time 0.476 (0.468) data 0.345 (0.338) loss_x loss_x 1.4893 (1.5113) acc_x 56.2500 (62.5000) lr 1.9877e-03 eta 0:00:12
epoch [12/200] batch [10/32] time 0.380 (0.449) data 0.250 (0.318) loss_x loss_x 1.8066 (1.5619) acc_x 62.5000 (60.6250) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [15/32] time 0.543 (0.462) data 0.413 (0.331) loss_x loss_x 1.1816 (1.5565) acc_x 65.6250 (60.4167) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [20/32] time 0.462 (0.477) data 0.332 (0.347) loss_x loss_x 2.0117 (1.5480) acc_x 56.2500 (60.4688) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [25/32] time 0.451 (0.477) data 0.320 (0.347) loss_x loss_x 1.9824 (1.5402) acc_x 46.8750 (59.7500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [30/32] time 0.376 (0.477) data 0.245 (0.346) loss_x loss_x 1.5234 (1.5244) acc_x 56.2500 (59.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1802
confident_label rate tensor(0.3342, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1048
clean true:1023
clean false:25
clean_rate:0.976145038167939
noisy true:311
noisy false:1777
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 2088
epoch [13/200] batch [5/32] time 0.469 (0.448) data 0.339 (0.317) loss_x loss_x 1.9883 (1.4003) acc_x 62.5000 (67.5000) lr 1.9851e-03 eta 0:00:12
epoch [13/200] batch [10/32] time 0.498 (0.456) data 0.368 (0.325) loss_x loss_x 1.2021 (1.5155) acc_x 53.1250 (61.2500) lr 1.9851e-03 eta 0:00:10
epoch [13/200] batch [15/32] time 0.355 (0.447) data 0.224 (0.316) loss_x loss_x 1.8604 (1.5315) acc_x 53.1250 (60.0000) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [20/32] time 0.583 (0.453) data 0.452 (0.322) loss_x loss_x 1.1650 (1.4346) acc_x 62.5000 (61.5625) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [25/32] time 0.543 (0.450) data 0.412 (0.319) loss_x loss_x 1.3682 (1.4532) acc_x 56.2500 (60.8750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [30/32] time 0.403 (0.455) data 0.272 (0.325) loss_x loss_x 1.5986 (1.4574) acc_x 46.8750 (60.5208) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1775
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1073
clean true:1039
clean false:34
clean_rate:0.9683131407269339
noisy true:322
noisy false:1741
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 2063
epoch [14/200] batch [5/33] time 0.487 (0.461) data 0.356 (0.330) loss_x loss_x 1.3262 (1.4300) acc_x 62.5000 (61.8750) lr 1.9823e-03 eta 0:00:12
epoch [14/200] batch [10/33] time 0.427 (0.434) data 0.296 (0.303) loss_x loss_x 1.6025 (1.5164) acc_x 65.6250 (60.3125) lr 1.9823e-03 eta 0:00:09
epoch [14/200] batch [15/33] time 0.434 (0.441) data 0.304 (0.310) loss_x loss_x 1.3740 (1.5154) acc_x 59.3750 (59.5833) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [20/33] time 0.390 (0.448) data 0.259 (0.317) loss_x loss_x 1.6279 (1.5050) acc_x 56.2500 (59.6875) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [25/33] time 0.455 (0.451) data 0.325 (0.320) loss_x loss_x 1.3447 (1.4780) acc_x 65.6250 (60.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [30/33] time 0.524 (0.459) data 0.394 (0.328) loss_x loss_x 1.4756 (1.5020) acc_x 59.3750 (59.8958) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1750
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1080
clean true:1054
clean false:26
clean_rate:0.975925925925926
noisy true:332
noisy false:1724
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 2056
epoch [15/200] batch [5/33] time 0.417 (0.452) data 0.287 (0.321) loss_x loss_x 0.9971 (1.3373) acc_x 78.1250 (64.3750) lr 1.9792e-03 eta 0:00:12
epoch [15/200] batch [10/33] time 0.380 (0.440) data 0.249 (0.309) loss_x loss_x 1.2002 (1.3644) acc_x 65.6250 (60.9375) lr 1.9792e-03 eta 0:00:10
epoch [15/200] batch [15/33] time 0.595 (0.461) data 0.464 (0.330) loss_x loss_x 1.5225 (1.4979) acc_x 65.6250 (59.7917) lr 1.9792e-03 eta 0:00:08
epoch [15/200] batch [20/33] time 0.349 (0.468) data 0.218 (0.337) loss_x loss_x 1.6416 (1.4830) acc_x 65.6250 (61.5625) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [25/33] time 0.571 (0.464) data 0.440 (0.334) loss_x loss_x 1.5020 (1.5011) acc_x 59.3750 (60.6250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [30/33] time 0.434 (0.468) data 0.303 (0.337) loss_x loss_x 1.7188 (1.5129) acc_x 46.8750 (60.1042) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1790
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1050
clean true:1020
clean false:30
clean_rate:0.9714285714285714
noisy true:326
noisy false:1760
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 2086
epoch [16/200] batch [5/32] time 0.462 (0.507) data 0.332 (0.376) loss_x loss_x 1.6377 (1.6557) acc_x 43.7500 (48.7500) lr 1.9759e-03 eta 0:00:13
epoch [16/200] batch [10/32] time 0.563 (0.492) data 0.432 (0.362) loss_x loss_x 1.4238 (1.5255) acc_x 71.8750 (59.0625) lr 1.9759e-03 eta 0:00:10
epoch [16/200] batch [15/32] time 0.460 (0.476) data 0.331 (0.346) loss_x loss_x 1.6562 (1.5664) acc_x 68.7500 (59.3750) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [20/32] time 0.399 (0.467) data 0.269 (0.336) loss_x loss_x 1.5020 (1.5549) acc_x 71.8750 (60.1562) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [25/32] time 0.407 (0.467) data 0.276 (0.336) loss_x loss_x 1.2920 (1.5170) acc_x 65.6250 (60.7500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [30/32] time 0.489 (0.483) data 0.358 (0.352) loss_x loss_x 1.8184 (1.5263) acc_x 46.8750 (59.5833) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1084
clean true:1055
clean false:29
clean_rate:0.9732472324723247
noisy true:307
noisy false:1745
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 2052
epoch [17/200] batch [5/33] time 0.385 (0.450) data 0.254 (0.320) loss_x loss_x 1.1318 (1.2437) acc_x 68.7500 (66.2500) lr 1.9724e-03 eta 0:00:12
epoch [17/200] batch [10/33] time 0.378 (0.456) data 0.247 (0.325) loss_x loss_x 1.8066 (1.3723) acc_x 59.3750 (65.6250) lr 1.9724e-03 eta 0:00:10
epoch [17/200] batch [15/33] time 0.465 (0.470) data 0.334 (0.339) loss_x loss_x 1.7588 (1.4291) acc_x 62.5000 (64.3750) lr 1.9724e-03 eta 0:00:08
epoch [17/200] batch [20/33] time 0.409 (0.462) data 0.278 (0.331) loss_x loss_x 1.8369 (1.4712) acc_x 46.8750 (61.5625) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [25/33] time 0.415 (0.458) data 0.285 (0.327) loss_x loss_x 1.4131 (1.4826) acc_x 65.6250 (62.1250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [30/33] time 0.476 (0.460) data 0.345 (0.329) loss_x loss_x 1.5928 (1.5031) acc_x 59.3750 (60.9375) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1053
clean true:1025
clean false:28
clean_rate:0.97340930674264
noisy true:294
noisy false:1789
after delete: len(clean_dataset) 1053
after delete: len(noisy_dataset) 2083
epoch [18/200] batch [5/32] time 0.421 (0.444) data 0.290 (0.312) loss_x loss_x 1.1436 (1.4600) acc_x 62.5000 (59.3750) lr 1.9686e-03 eta 0:00:11
epoch [18/200] batch [10/32] time 0.365 (0.463) data 0.234 (0.332) loss_x loss_x 1.1152 (1.3305) acc_x 68.7500 (63.4375) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [15/32] time 0.537 (0.480) data 0.406 (0.349) loss_x loss_x 1.1465 (1.2452) acc_x 71.8750 (66.4583) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [20/32] time 0.531 (0.484) data 0.400 (0.353) loss_x loss_x 0.9526 (1.2629) acc_x 65.6250 (66.0938) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [25/32] time 0.380 (0.475) data 0.249 (0.344) loss_x loss_x 1.9492 (1.3358) acc_x 59.3750 (65.2500) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [30/32] time 0.559 (0.488) data 0.428 (0.358) loss_x loss_x 2.3262 (1.3737) acc_x 46.8750 (64.4792) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.3300, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1035
clean true:1007
clean false:28
clean_rate:0.9729468599033816
noisy true:319
noisy false:1782
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 2101
epoch [19/200] batch [5/32] time 0.440 (0.456) data 0.309 (0.325) loss_x loss_x 1.4395 (1.3609) acc_x 62.5000 (67.5000) lr 1.9646e-03 eta 0:00:12
epoch [19/200] batch [10/32] time 0.487 (0.471) data 0.356 (0.341) loss_x loss_x 1.8779 (1.4416) acc_x 56.2500 (63.1250) lr 1.9646e-03 eta 0:00:10
epoch [19/200] batch [15/32] time 0.547 (0.473) data 0.416 (0.343) loss_x loss_x 1.3545 (1.4767) acc_x 71.8750 (62.5000) lr 1.9646e-03 eta 0:00:08
epoch [19/200] batch [20/32] time 0.397 (0.482) data 0.267 (0.352) loss_x loss_x 1.4756 (1.5114) acc_x 56.2500 (60.4688) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [25/32] time 0.439 (0.489) data 0.309 (0.358) loss_x loss_x 1.4990 (1.5087) acc_x 62.5000 (61.2500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [30/32] time 0.556 (0.487) data 0.425 (0.356) loss_x loss_x 0.8511 (1.5056) acc_x 84.3750 (60.8333) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1793
confident_label rate tensor(0.3377, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1059
clean true:1030
clean false:29
clean_rate:0.9726156751652503
noisy true:313
noisy false:1764
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 2077
epoch [20/200] batch [5/33] time 0.441 (0.458) data 0.311 (0.327) loss_x loss_x 2.0195 (1.5535) acc_x 40.6250 (57.5000) lr 1.9603e-03 eta 0:00:12
epoch [20/200] batch [10/33] time 0.560 (0.476) data 0.429 (0.346) loss_x loss_x 1.1162 (1.4840) acc_x 56.2500 (59.3750) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [15/33] time 0.480 (0.472) data 0.350 (0.342) loss_x loss_x 1.6445 (1.5292) acc_x 56.2500 (58.5417) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [20/33] time 0.423 (0.458) data 0.293 (0.327) loss_x loss_x 1.8828 (1.5017) acc_x 53.1250 (58.9062) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [25/33] time 0.581 (0.456) data 0.450 (0.325) loss_x loss_x 1.0420 (1.4788) acc_x 68.7500 (59.1250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [30/33] time 0.487 (0.459) data 0.357 (0.328) loss_x loss_x 1.7021 (1.4923) acc_x 53.1250 (59.3750) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1753
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1083
clean true:1059
clean false:24
clean_rate:0.9778393351800554
noisy true:324
noisy false:1729
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 2053
epoch [21/200] batch [5/33] time 0.435 (0.455) data 0.304 (0.324) loss_x loss_x 1.3135 (1.3207) acc_x 65.6250 (63.1250) lr 1.9558e-03 eta 0:00:12
epoch [21/200] batch [10/33] time 0.506 (0.443) data 0.375 (0.312) loss_x loss_x 1.6201 (1.4195) acc_x 56.2500 (63.7500) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [15/33] time 0.465 (0.457) data 0.334 (0.325) loss_x loss_x 1.3516 (1.4161) acc_x 62.5000 (64.1667) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [20/33] time 0.432 (0.456) data 0.301 (0.325) loss_x loss_x 1.6484 (1.4577) acc_x 56.2500 (62.8125) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [25/33] time 0.358 (0.455) data 0.228 (0.324) loss_x loss_x 1.3232 (1.4410) acc_x 53.1250 (63.3750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [30/33] time 0.456 (0.454) data 0.325 (0.323) loss_x loss_x 1.5664 (1.4359) acc_x 53.1250 (62.8125) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.3326, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1043
clean true:1016
clean false:27
clean_rate:0.9741131351869607
noisy true:333
noisy false:1760
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 2093
epoch [22/200] batch [5/32] time 0.424 (0.466) data 0.294 (0.335) loss_x loss_x 1.5957 (1.6135) acc_x 56.2500 (60.0000) lr 1.9511e-03 eta 0:00:12
epoch [22/200] batch [10/32] time 0.360 (0.471) data 0.229 (0.340) loss_x loss_x 1.8906 (1.5758) acc_x 53.1250 (60.6250) lr 1.9511e-03 eta 0:00:10
epoch [22/200] batch [15/32] time 0.447 (0.468) data 0.316 (0.338) loss_x loss_x 1.5010 (1.5421) acc_x 50.0000 (60.2083) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [20/32] time 0.498 (0.475) data 0.367 (0.344) loss_x loss_x 1.4414 (1.5208) acc_x 62.5000 (60.3125) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [25/32] time 0.398 (0.473) data 0.267 (0.342) loss_x loss_x 1.3936 (1.5043) acc_x 62.5000 (60.1250) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [30/32] time 0.454 (0.466) data 0.323 (0.336) loss_x loss_x 1.2852 (1.4971) acc_x 59.3750 (60.7292) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1760
confident_label rate tensor(0.3390, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1063
clean true:1040
clean false:23
clean_rate:0.9783631232361242
noisy true:336
noisy false:1737
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 2073
epoch [23/200] batch [5/33] time 0.475 (0.448) data 0.344 (0.318) loss_x loss_x 1.4043 (1.3889) acc_x 68.7500 (60.6250) lr 1.9461e-03 eta 0:00:12
epoch [23/200] batch [10/33] time 0.557 (0.462) data 0.426 (0.332) loss_x loss_x 1.6416 (1.4688) acc_x 65.6250 (63.1250) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [15/33] time 0.411 (0.467) data 0.280 (0.336) loss_x loss_x 1.6680 (1.4654) acc_x 65.6250 (62.2917) lr 1.9461e-03 eta 0:00:08
epoch [23/200] batch [20/33] time 0.447 (0.462) data 0.316 (0.331) loss_x loss_x 0.9756 (1.4053) acc_x 68.7500 (63.4375) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [25/33] time 0.435 (0.461) data 0.304 (0.330) loss_x loss_x 1.7227 (1.4071) acc_x 59.3750 (63.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [30/33] time 0.508 (0.465) data 0.378 (0.335) loss_x loss_x 1.6396 (1.4200) acc_x 59.3750 (62.8125) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.3581, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1123
clean true:1091
clean false:32
clean_rate:0.9715048975957258
noisy true:317
noisy false:1696
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 2013
epoch [24/200] batch [5/35] time 0.384 (0.421) data 0.253 (0.290) loss_x loss_x 1.3311 (1.4590) acc_x 59.3750 (61.2500) lr 1.9409e-03 eta 0:00:12
epoch [24/200] batch [10/35] time 0.308 (0.420) data 0.178 (0.289) loss_x loss_x 1.6621 (1.5509) acc_x 62.5000 (59.6875) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [15/35] time 0.460 (0.456) data 0.328 (0.325) loss_x loss_x 1.5127 (1.5635) acc_x 65.6250 (58.9583) lr 1.9409e-03 eta 0:00:09
epoch [24/200] batch [20/35] time 0.493 (0.464) data 0.362 (0.334) loss_x loss_x 1.3711 (1.5570) acc_x 59.3750 (58.1250) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [25/35] time 0.477 (0.470) data 0.346 (0.339) loss_x loss_x 1.5322 (1.5366) acc_x 50.0000 (58.1250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [30/35] time 0.495 (0.478) data 0.364 (0.347) loss_x loss_x 1.3857 (1.4987) acc_x 59.3750 (59.0625) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [35/35] time 0.374 (0.472) data 0.243 (0.341) loss_x loss_x 1.7480 (1.4906) acc_x 53.1250 (59.4643) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.3326, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1043
clean true:1008
clean false:35
clean_rate:0.9664429530201343
noisy true:315
noisy false:1778
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 2093
epoch [25/200] batch [5/32] time 0.389 (0.481) data 0.258 (0.351) loss_x loss_x 1.3613 (1.3512) acc_x 68.7500 (66.8750) lr 1.9354e-03 eta 0:00:12
epoch [25/200] batch [10/32] time 0.424 (0.471) data 0.293 (0.340) loss_x loss_x 1.2363 (1.3845) acc_x 59.3750 (65.0000) lr 1.9354e-03 eta 0:00:10
epoch [25/200] batch [15/32] time 0.537 (0.461) data 0.407 (0.331) loss_x loss_x 1.9062 (1.4947) acc_x 53.1250 (62.0833) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [20/32] time 0.377 (0.460) data 0.246 (0.330) loss_x loss_x 1.3076 (1.4562) acc_x 68.7500 (62.6562) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [25/32] time 0.501 (0.452) data 0.370 (0.322) loss_x loss_x 1.4395 (1.4763) acc_x 71.8750 (61.8750) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [30/32] time 0.489 (0.456) data 0.358 (0.325) loss_x loss_x 1.4775 (1.4500) acc_x 78.1250 (62.9167) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1082
clean true:1052
clean false:30
clean_rate:0.9722735674676525
noisy true:317
noisy false:1737
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 2054
epoch [26/200] batch [5/33] time 0.483 (0.488) data 0.351 (0.357) loss_x loss_x 1.9043 (1.6451) acc_x 65.6250 (60.0000) lr 1.9298e-03 eta 0:00:13
epoch [26/200] batch [10/33] time 0.473 (0.470) data 0.341 (0.339) loss_x loss_x 1.2773 (1.4954) acc_x 68.7500 (62.5000) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [15/33] time 0.572 (0.475) data 0.440 (0.344) loss_x loss_x 1.3262 (1.4314) acc_x 68.7500 (62.7083) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [20/33] time 0.486 (0.465) data 0.355 (0.334) loss_x loss_x 1.9131 (1.4879) acc_x 56.2500 (61.2500) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [25/33] time 0.474 (0.463) data 0.344 (0.332) loss_x loss_x 1.5205 (1.5133) acc_x 59.3750 (60.7500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [30/33] time 0.529 (0.466) data 0.396 (0.335) loss_x loss_x 1.4346 (1.5251) acc_x 59.3750 (60.5208) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.3530, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1107
clean true:1076
clean false:31
clean_rate:0.971996386630533
noisy true:325
noisy false:1704
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 2029
epoch [27/200] batch [5/34] time 0.473 (0.484) data 0.341 (0.353) loss_x loss_x 1.7197 (1.7209) acc_x 43.7500 (55.6250) lr 1.9239e-03 eta 0:00:14
epoch [27/200] batch [10/34] time 0.378 (0.436) data 0.248 (0.305) loss_x loss_x 1.0518 (1.5384) acc_x 75.0000 (60.3125) lr 1.9239e-03 eta 0:00:10
epoch [27/200] batch [15/34] time 0.439 (0.444) data 0.309 (0.313) loss_x loss_x 1.3730 (1.4772) acc_x 68.7500 (63.1250) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [20/34] time 0.517 (0.455) data 0.386 (0.324) loss_x loss_x 1.3379 (1.4613) acc_x 62.5000 (61.5625) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [25/34] time 0.439 (0.458) data 0.308 (0.327) loss_x loss_x 1.4189 (1.4536) acc_x 56.2500 (61.7500) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [30/34] time 0.466 (0.460) data 0.335 (0.329) loss_x loss_x 1.3447 (1.4495) acc_x 65.6250 (62.1875) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1700
confident_label rate tensor(0.3610, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1132
clean true:1099
clean false:33
clean_rate:0.9708480565371025
noisy true:337
noisy false:1667
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 2004
epoch [28/200] batch [5/35] time 0.373 (0.408) data 0.242 (0.277) loss_x loss_x 1.3252 (1.4906) acc_x 68.7500 (63.7500) lr 1.9178e-03 eta 0:00:12
epoch [28/200] batch [10/35] time 0.355 (0.445) data 0.224 (0.314) loss_x loss_x 1.8076 (1.5354) acc_x 56.2500 (62.1875) lr 1.9178e-03 eta 0:00:11
epoch [28/200] batch [15/35] time 0.402 (0.448) data 0.271 (0.317) loss_x loss_x 2.1270 (1.5960) acc_x 46.8750 (60.2083) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [20/35] time 0.486 (0.452) data 0.356 (0.321) loss_x loss_x 0.9346 (1.5055) acc_x 71.8750 (62.1875) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [25/35] time 0.493 (0.463) data 0.362 (0.332) loss_x loss_x 1.0088 (1.4489) acc_x 68.7500 (63.6250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [30/35] time 0.395 (0.458) data 0.263 (0.328) loss_x loss_x 1.5391 (1.4597) acc_x 65.6250 (63.6458) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [35/35] time 0.528 (0.456) data 0.397 (0.325) loss_x loss_x 1.4150 (1.4588) acc_x 62.5000 (63.3929) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1083
clean true:1057
clean false:26
clean_rate:0.9759926131117267
noisy true:322
noisy false:1731
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 2053
epoch [29/200] batch [5/33] time 0.486 (0.438) data 0.355 (0.307) loss_x loss_x 1.9385 (1.4826) acc_x 59.3750 (61.2500) lr 1.9114e-03 eta 0:00:12
epoch [29/200] batch [10/33] time 0.397 (0.439) data 0.267 (0.309) loss_x loss_x 1.6035 (1.5430) acc_x 50.0000 (58.4375) lr 1.9114e-03 eta 0:00:10
epoch [29/200] batch [15/33] time 0.399 (0.436) data 0.269 (0.305) loss_x loss_x 2.0586 (1.6610) acc_x 53.1250 (57.0833) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [20/33] time 0.485 (0.446) data 0.353 (0.316) loss_x loss_x 1.4912 (1.5971) acc_x 56.2500 (58.9062) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [25/33] time 0.456 (0.456) data 0.327 (0.325) loss_x loss_x 1.1777 (1.5823) acc_x 65.6250 (58.5000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [30/33] time 0.407 (0.460) data 0.276 (0.329) loss_x loss_x 1.1875 (1.5437) acc_x 75.0000 (60.2083) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1703
confident_label rate tensor(0.3648, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1144
clean true:1113
clean false:31
clean_rate:0.9729020979020979
noisy true:320
noisy false:1672
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 1992
epoch [30/200] batch [5/35] time 0.402 (0.431) data 0.271 (0.300) loss_x loss_x 1.4844 (1.6330) acc_x 68.7500 (57.5000) lr 1.9048e-03 eta 0:00:12
epoch [30/200] batch [10/35] time 0.445 (0.437) data 0.315 (0.306) loss_x loss_x 1.1914 (1.5020) acc_x 62.5000 (60.0000) lr 1.9048e-03 eta 0:00:10
epoch [30/200] batch [15/35] time 0.431 (0.440) data 0.301 (0.309) loss_x loss_x 1.3896 (1.4538) acc_x 65.6250 (61.6667) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [20/35] time 0.653 (0.481) data 0.522 (0.350) loss_x loss_x 0.9795 (1.4150) acc_x 75.0000 (62.6562) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [25/35] time 0.447 (0.472) data 0.317 (0.342) loss_x loss_x 1.3125 (1.4039) acc_x 68.7500 (62.7500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [30/35] time 0.355 (0.467) data 0.224 (0.336) loss_x loss_x 1.4248 (1.4213) acc_x 59.3750 (62.3958) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [35/35] time 0.497 (0.468) data 0.365 (0.337) loss_x loss_x 1.8848 (1.4331) acc_x 62.5000 (62.5000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.3489, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1094
clean true:1067
clean false:27
clean_rate:0.9753199268738574
noisy true:318
noisy false:1724
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 2042
epoch [31/200] batch [5/34] time 0.477 (0.487) data 0.345 (0.356) loss_x loss_x 1.1836 (1.3412) acc_x 65.6250 (66.2500) lr 1.8980e-03 eta 0:00:14
epoch [31/200] batch [10/34] time 0.464 (0.471) data 0.333 (0.339) loss_x loss_x 1.6094 (1.4012) acc_x 68.7500 (65.0000) lr 1.8980e-03 eta 0:00:11
epoch [31/200] batch [15/34] time 0.414 (0.469) data 0.283 (0.338) loss_x loss_x 1.4365 (1.4272) acc_x 56.2500 (63.3333) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [20/34] time 0.546 (0.468) data 0.416 (0.337) loss_x loss_x 1.4736 (1.4410) acc_x 65.6250 (64.0625) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [25/34] time 0.351 (0.464) data 0.220 (0.333) loss_x loss_x 1.5557 (1.4349) acc_x 62.5000 (63.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [30/34] time 0.485 (0.466) data 0.353 (0.335) loss_x loss_x 1.1621 (1.4367) acc_x 65.6250 (63.7500) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1722
confident_label rate tensor(0.3527, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1106
clean true:1081
clean false:25
clean_rate:0.9773960216998192
noisy true:333
noisy false:1697
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 2030
epoch [32/200] batch [5/34] time 0.489 (0.541) data 0.358 (0.409) loss_x loss_x 1.6494 (1.4305) acc_x 62.5000 (63.7500) lr 1.8910e-03 eta 0:00:15
epoch [32/200] batch [10/34] time 0.408 (0.498) data 0.277 (0.367) loss_x loss_x 1.1182 (1.4135) acc_x 71.8750 (62.8125) lr 1.8910e-03 eta 0:00:11
epoch [32/200] batch [15/34] time 0.455 (0.481) data 0.324 (0.350) loss_x loss_x 1.2949 (1.3306) acc_x 62.5000 (64.1667) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [20/34] time 0.385 (0.475) data 0.254 (0.345) loss_x loss_x 1.2695 (1.3576) acc_x 65.6250 (63.9062) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [25/34] time 0.462 (0.462) data 0.331 (0.331) loss_x loss_x 1.5605 (1.3770) acc_x 53.1250 (64.0000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [30/34] time 0.373 (0.462) data 0.243 (0.331) loss_x loss_x 1.3213 (1.3726) acc_x 68.7500 (64.0625) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.3699, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1160
clean true:1126
clean false:34
clean_rate:0.9706896551724138
noisy true:326
noisy false:1650
after delete: len(clean_dataset) 1160
after delete: len(noisy_dataset) 1976
epoch [33/200] batch [5/36] time 0.407 (0.441) data 0.277 (0.311) loss_x loss_x 1.2559 (1.3611) acc_x 65.6250 (62.5000) lr 1.8838e-03 eta 0:00:13
epoch [33/200] batch [10/36] time 0.464 (0.464) data 0.334 (0.334) loss_x loss_x 2.0430 (1.5083) acc_x 50.0000 (58.7500) lr 1.8838e-03 eta 0:00:12
epoch [33/200] batch [15/36] time 0.495 (0.456) data 0.364 (0.326) loss_x loss_x 1.3135 (1.4476) acc_x 65.6250 (62.0833) lr 1.8838e-03 eta 0:00:09
epoch [33/200] batch [20/36] time 0.548 (0.479) data 0.417 (0.348) loss_x loss_x 1.5166 (1.4656) acc_x 53.1250 (60.4688) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [25/36] time 0.427 (0.468) data 0.295 (0.337) loss_x loss_x 1.7451 (1.4807) acc_x 53.1250 (60.0000) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [30/36] time 0.441 (0.469) data 0.310 (0.338) loss_x loss_x 1.9492 (1.4878) acc_x 59.3750 (59.4792) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [35/36] time 0.375 (0.465) data 0.245 (0.334) loss_x loss_x 2.1855 (1.5204) acc_x 50.0000 (59.3750) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1724
confident_label rate tensor(0.3520, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1104
clean true:1068
clean false:36
clean_rate:0.967391304347826
noisy true:344
noisy false:1688
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 2032
epoch [34/200] batch [5/34] time 0.421 (0.440) data 0.291 (0.310) loss_x loss_x 1.5684 (1.4391) acc_x 71.8750 (62.5000) lr 1.8763e-03 eta 0:00:12
epoch [34/200] batch [10/34] time 0.477 (0.454) data 0.346 (0.323) loss_x loss_x 1.0918 (1.2592) acc_x 71.8750 (66.5625) lr 1.8763e-03 eta 0:00:10
epoch [34/200] batch [15/34] time 0.406 (0.459) data 0.275 (0.329) loss_x loss_x 1.1455 (1.2291) acc_x 71.8750 (67.2917) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [20/34] time 0.459 (0.454) data 0.329 (0.323) loss_x loss_x 1.3711 (1.2959) acc_x 62.5000 (64.8438) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [25/34] time 0.492 (0.453) data 0.362 (0.322) loss_x loss_x 1.7646 (1.3391) acc_x 59.3750 (64.7500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [30/34] time 0.432 (0.449) data 0.301 (0.318) loss_x loss_x 1.5029 (1.3778) acc_x 65.6250 (63.5417) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1775
confident_label rate tensor(0.3447, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1081
clean true:1052
clean false:29
clean_rate:0.973172987974098
noisy true:309
noisy false:1746
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 2055
epoch [35/200] batch [5/33] time 0.524 (0.477) data 0.393 (0.346) loss_x loss_x 1.0234 (1.3287) acc_x 65.6250 (61.8750) lr 1.8686e-03 eta 0:00:13
epoch [35/200] batch [10/33] time 0.482 (0.480) data 0.351 (0.349) loss_x loss_x 1.2568 (1.4243) acc_x 59.3750 (60.6250) lr 1.8686e-03 eta 0:00:11
epoch [35/200] batch [15/33] time 0.565 (0.487) data 0.434 (0.356) loss_x loss_x 1.1826 (1.3865) acc_x 62.5000 (63.1250) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [20/33] time 0.371 (0.464) data 0.239 (0.333) loss_x loss_x 1.5410 (1.4395) acc_x 53.1250 (60.3125) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [25/33] time 0.460 (0.473) data 0.330 (0.342) loss_x loss_x 0.9897 (1.3975) acc_x 71.8750 (61.7500) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [30/33] time 0.398 (0.475) data 0.266 (0.344) loss_x loss_x 1.5000 (1.3794) acc_x 68.7500 (62.3958) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.3476, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1090
clean true:1069
clean false:21
clean_rate:0.9807339449541285
noisy true:336
noisy false:1710
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 2046
epoch [36/200] batch [5/34] time 0.350 (0.390) data 0.219 (0.259) loss_x loss_x 1.8252 (1.4970) acc_x 50.0000 (60.6250) lr 1.8607e-03 eta 0:00:11
epoch [36/200] batch [10/34] time 0.436 (0.464) data 0.305 (0.333) loss_x loss_x 2.0820 (1.5737) acc_x 62.5000 (61.8750) lr 1.8607e-03 eta 0:00:11
epoch [36/200] batch [15/34] time 0.402 (0.450) data 0.271 (0.319) loss_x loss_x 1.3984 (1.5284) acc_x 68.7500 (62.5000) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [20/34] time 0.425 (0.447) data 0.294 (0.316) loss_x loss_x 1.5771 (1.4892) acc_x 65.6250 (63.9062) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [25/34] time 0.452 (0.454) data 0.322 (0.323) loss_x loss_x 1.3721 (1.4522) acc_x 62.5000 (64.8750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [30/34] time 0.478 (0.453) data 0.348 (0.322) loss_x loss_x 2.0859 (1.4402) acc_x 53.1250 (64.6875) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.3546, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1112
clean true:1093
clean false:19
clean_rate:0.9829136690647482
noisy true:334
noisy false:1690
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 2024
epoch [37/200] batch [5/34] time 0.425 (0.457) data 0.295 (0.326) loss_x loss_x 1.3379 (1.4801) acc_x 71.8750 (62.5000) lr 1.8526e-03 eta 0:00:13
epoch [37/200] batch [10/34] time 0.591 (0.499) data 0.460 (0.368) loss_x loss_x 1.5508 (1.4417) acc_x 59.3750 (61.5625) lr 1.8526e-03 eta 0:00:11
epoch [37/200] batch [15/34] time 0.425 (0.487) data 0.294 (0.356) loss_x loss_x 1.0732 (1.3820) acc_x 68.7500 (63.9583) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [20/34] time 0.437 (0.494) data 0.307 (0.363) loss_x loss_x 1.5322 (1.4669) acc_x 68.7500 (62.5000) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [25/34] time 0.413 (0.485) data 0.283 (0.354) loss_x loss_x 1.5938 (1.4798) acc_x 59.3750 (62.3750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [30/34] time 0.420 (0.474) data 0.289 (0.344) loss_x loss_x 1.7129 (1.4558) acc_x 56.2500 (62.9167) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1684
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1139
clean true:1112
clean false:27
clean_rate:0.9762949956101844
noisy true:340
noisy false:1657
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 1997
epoch [38/200] batch [5/35] time 0.415 (0.451) data 0.285 (0.321) loss_x loss_x 1.1133 (1.3070) acc_x 68.7500 (63.1250) lr 1.8443e-03 eta 0:00:13
epoch [38/200] batch [10/35] time 0.418 (0.461) data 0.287 (0.330) loss_x loss_x 1.0400 (1.2304) acc_x 68.7500 (65.0000) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [15/35] time 0.448 (0.476) data 0.317 (0.345) loss_x loss_x 1.4551 (1.2429) acc_x 65.6250 (66.2500) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [20/35] time 0.455 (0.460) data 0.324 (0.329) loss_x loss_x 1.7637 (1.3108) acc_x 53.1250 (64.8438) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [25/35] time 0.367 (0.463) data 0.237 (0.333) loss_x loss_x 1.5654 (1.3127) acc_x 53.1250 (64.8750) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [30/35] time 0.375 (0.456) data 0.244 (0.326) loss_x loss_x 1.6006 (1.3284) acc_x 56.2500 (64.4792) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [35/35] time 0.471 (0.452) data 0.341 (0.322) loss_x loss_x 1.1865 (1.3261) acc_x 68.7500 (64.9107) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1712
confident_label rate tensor(0.3587, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1125
clean true:1095
clean false:30
clean_rate:0.9733333333333334
noisy true:329
noisy false:1682
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 2011
epoch [39/200] batch [5/35] time 0.519 (0.566) data 0.389 (0.435) loss_x loss_x 1.3223 (1.5521) acc_x 59.3750 (60.6250) lr 1.8358e-03 eta 0:00:16
epoch [39/200] batch [10/35] time 0.448 (0.512) data 0.317 (0.381) loss_x loss_x 1.3779 (1.5610) acc_x 53.1250 (58.7500) lr 1.8358e-03 eta 0:00:12
epoch [39/200] batch [15/35] time 0.539 (0.508) data 0.408 (0.377) loss_x loss_x 2.0625 (1.5702) acc_x 62.5000 (58.9583) lr 1.8358e-03 eta 0:00:10
epoch [39/200] batch [20/35] time 0.463 (0.503) data 0.333 (0.373) loss_x loss_x 1.5283 (1.4970) acc_x 68.7500 (61.2500) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [25/35] time 0.407 (0.499) data 0.276 (0.368) loss_x loss_x 1.0703 (1.5033) acc_x 68.7500 (62.0000) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [30/35] time 0.371 (0.488) data 0.240 (0.357) loss_x loss_x 1.9854 (1.4903) acc_x 53.1250 (61.6667) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [35/35] time 0.518 (0.484) data 0.387 (0.353) loss_x loss_x 1.4180 (1.4879) acc_x 65.6250 (61.9643) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1704
confident_label rate tensor(0.3607, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1131
clean true:1092
clean false:39
clean_rate:0.9655172413793104
noisy true:340
noisy false:1665
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 2005
epoch [40/200] batch [5/35] time 0.433 (0.444) data 0.302 (0.314) loss_x loss_x 1.1240 (1.5180) acc_x 75.0000 (63.7500) lr 1.8271e-03 eta 0:00:13
epoch [40/200] batch [10/35] time 0.525 (0.445) data 0.395 (0.314) loss_x loss_x 1.3369 (1.5670) acc_x 71.8750 (62.1875) lr 1.8271e-03 eta 0:00:11
epoch [40/200] batch [15/35] time 0.374 (0.445) data 0.243 (0.315) loss_x loss_x 1.7695 (1.5209) acc_x 53.1250 (62.5000) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [20/35] time 0.489 (0.453) data 0.358 (0.322) loss_x loss_x 1.4287 (1.5106) acc_x 59.3750 (61.8750) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [25/35] time 0.492 (0.452) data 0.361 (0.321) loss_x loss_x 1.0469 (1.5123) acc_x 75.0000 (61.5000) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [30/35] time 0.434 (0.456) data 0.303 (0.325) loss_x loss_x 1.1738 (1.5164) acc_x 75.0000 (61.3542) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [35/35] time 0.558 (0.462) data 0.427 (0.331) loss_x loss_x 1.6797 (1.5006) acc_x 43.7500 (61.2500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1149
clean true:1122
clean false:27
clean_rate:0.9765013054830287
noisy true:333
noisy false:1654
after delete: len(clean_dataset) 1149
after delete: len(noisy_dataset) 1987
epoch [41/200] batch [5/35] time 0.406 (0.448) data 0.276 (0.318) loss_x loss_x 1.4014 (1.4162) acc_x 62.5000 (63.1250) lr 1.8181e-03 eta 0:00:13
epoch [41/200] batch [10/35] time 0.636 (0.475) data 0.505 (0.345) loss_x loss_x 1.0293 (1.4730) acc_x 68.7500 (61.8750) lr 1.8181e-03 eta 0:00:11
epoch [41/200] batch [15/35] time 0.387 (0.464) data 0.256 (0.333) loss_x loss_x 1.4932 (1.4537) acc_x 53.1250 (62.2917) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [20/35] time 0.385 (0.455) data 0.254 (0.324) loss_x loss_x 0.8726 (1.3916) acc_x 81.2500 (64.2188) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [25/35] time 0.490 (0.456) data 0.359 (0.325) loss_x loss_x 2.2812 (1.4512) acc_x 56.2500 (63.5000) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [30/35] time 0.405 (0.453) data 0.275 (0.322) loss_x loss_x 1.5742 (1.4245) acc_x 43.7500 (63.0208) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [35/35] time 0.356 (0.451) data 0.225 (0.320) loss_x loss_x 1.1533 (1.4182) acc_x 71.8750 (63.5714) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1701
confident_label rate tensor(0.3724, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1168
clean true:1132
clean false:36
clean_rate:0.9691780821917808
noisy true:303
noisy false:1665
after delete: len(clean_dataset) 1168
after delete: len(noisy_dataset) 1968
epoch [42/200] batch [5/36] time 0.532 (0.540) data 0.401 (0.409) loss_x loss_x 1.8291 (1.4705) acc_x 46.8750 (60.0000) lr 1.8090e-03 eta 0:00:16
epoch [42/200] batch [10/36] time 0.445 (0.506) data 0.315 (0.375) loss_x loss_x 0.7646 (1.3862) acc_x 84.3750 (65.0000) lr 1.8090e-03 eta 0:00:13
epoch [42/200] batch [15/36] time 0.582 (0.503) data 0.451 (0.372) loss_x loss_x 1.8418 (1.4460) acc_x 56.2500 (63.1250) lr 1.8090e-03 eta 0:00:10
epoch [42/200] batch [20/36] time 0.518 (0.494) data 0.387 (0.364) loss_x loss_x 1.4941 (1.4333) acc_x 59.3750 (63.1250) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [25/36] time 0.439 (0.494) data 0.308 (0.363) loss_x loss_x 0.9326 (1.4286) acc_x 78.1250 (63.0000) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [30/36] time 0.418 (0.491) data 0.288 (0.360) loss_x loss_x 1.2529 (1.4133) acc_x 62.5000 (63.4375) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [35/36] time 0.490 (0.490) data 0.360 (0.359) loss_x loss_x 1.9473 (1.4372) acc_x 53.1250 (62.9464) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1707
confident_label rate tensor(0.3638, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1141
clean true:1109
clean false:32
clean_rate:0.971954425942156
noisy true:320
noisy false:1675
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 1995
epoch [43/200] batch [5/35] time 0.493 (0.465) data 0.362 (0.334) loss_x loss_x 2.0273 (1.5160) acc_x 40.6250 (60.6250) lr 1.7997e-03 eta 0:00:13
epoch [43/200] batch [10/35] time 0.624 (0.468) data 0.492 (0.337) loss_x loss_x 1.4307 (1.4777) acc_x 71.8750 (63.4375) lr 1.7997e-03 eta 0:00:11
epoch [43/200] batch [15/35] time 0.386 (0.468) data 0.255 (0.336) loss_x loss_x 1.7754 (1.4842) acc_x 62.5000 (62.5000) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [20/35] time 0.580 (0.462) data 0.449 (0.331) loss_x loss_x 1.2783 (1.4565) acc_x 71.8750 (63.9062) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [25/35] time 0.567 (0.473) data 0.435 (0.342) loss_x loss_x 2.0762 (1.5305) acc_x 56.2500 (63.2500) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [30/35] time 0.474 (0.483) data 0.343 (0.352) loss_x loss_x 2.1406 (1.5150) acc_x 46.8750 (62.9167) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [35/35] time 0.525 (0.490) data 0.394 (0.358) loss_x loss_x 1.7227 (1.5044) acc_x 56.2500 (62.8571) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.3469, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1088
clean true:1056
clean false:32
clean_rate:0.9705882352941176
noisy true:307
noisy false:1741
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 2048
epoch [44/200] batch [5/34] time 0.397 (0.436) data 0.267 (0.305) loss_x loss_x 1.3652 (1.6084) acc_x 65.6250 (55.0000) lr 1.7902e-03 eta 0:00:12
epoch [44/200] batch [10/34] time 0.419 (0.449) data 0.289 (0.319) loss_x loss_x 1.0010 (1.4320) acc_x 68.7500 (59.3750) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [15/34] time 0.575 (0.481) data 0.444 (0.350) loss_x loss_x 1.3760 (1.4215) acc_x 59.3750 (60.0000) lr 1.7902e-03 eta 0:00:09
epoch [44/200] batch [20/34] time 0.439 (0.465) data 0.308 (0.335) loss_x loss_x 1.6104 (1.4326) acc_x 65.6250 (62.1875) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [25/34] time 0.341 (0.467) data 0.211 (0.336) loss_x loss_x 1.8477 (1.4105) acc_x 43.7500 (62.1250) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [30/34] time 0.468 (0.462) data 0.337 (0.332) loss_x loss_x 1.7852 (1.4051) acc_x 59.3750 (62.3958) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1178
clean true:1143
clean false:35
clean_rate:0.9702886247877759
noisy true:322
noisy false:1636
after delete: len(clean_dataset) 1178
after delete: len(noisy_dataset) 1958
epoch [45/200] batch [5/36] time 0.463 (0.471) data 0.332 (0.340) loss_x loss_x 1.1748 (1.3941) acc_x 62.5000 (63.1250) lr 1.7804e-03 eta 0:00:14
epoch [45/200] batch [10/36] time 0.464 (0.453) data 0.333 (0.322) loss_x loss_x 1.7441 (1.4236) acc_x 46.8750 (61.8750) lr 1.7804e-03 eta 0:00:11
epoch [45/200] batch [15/36] time 0.349 (0.460) data 0.218 (0.330) loss_x loss_x 1.5254 (1.3891) acc_x 62.5000 (64.5833) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [20/36] time 0.529 (0.466) data 0.399 (0.336) loss_x loss_x 2.2949 (1.4438) acc_x 46.8750 (63.9062) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [25/36] time 0.393 (0.467) data 0.263 (0.336) loss_x loss_x 1.2490 (1.4190) acc_x 75.0000 (64.7500) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [30/36] time 0.366 (0.466) data 0.236 (0.335) loss_x loss_x 1.0068 (1.3999) acc_x 71.8750 (64.2708) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [35/36] time 0.553 (0.479) data 0.422 (0.348) loss_x loss_x 1.3457 (1.4014) acc_x 59.3750 (63.9286) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1699
confident_label rate tensor(0.3648, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1144
clean true:1117
clean false:27
clean_rate:0.9763986013986014
noisy true:320
noisy false:1672
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 1992
epoch [46/200] batch [5/35] time 0.568 (0.509) data 0.437 (0.377) loss_x loss_x 1.0303 (1.2176) acc_x 71.8750 (67.5000) lr 1.7705e-03 eta 0:00:15
epoch [46/200] batch [10/35] time 0.505 (0.506) data 0.374 (0.374) loss_x loss_x 1.3994 (1.3317) acc_x 59.3750 (65.3125) lr 1.7705e-03 eta 0:00:12
epoch [46/200] batch [15/35] time 0.371 (0.488) data 0.241 (0.357) loss_x loss_x 1.1641 (1.3600) acc_x 65.6250 (65.0000) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [20/35] time 0.403 (0.475) data 0.272 (0.344) loss_x loss_x 1.3633 (1.2971) acc_x 65.6250 (66.7188) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [25/35] time 0.678 (0.486) data 0.547 (0.355) loss_x loss_x 1.1611 (1.3202) acc_x 68.7500 (66.0000) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [30/35] time 0.534 (0.478) data 0.403 (0.347) loss_x loss_x 1.3896 (1.3501) acc_x 62.5000 (65.1042) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [35/35] time 0.485 (0.473) data 0.353 (0.342) loss_x loss_x 1.1973 (1.3411) acc_x 65.6250 (65.1786) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1677
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1174
clean true:1136
clean false:38
clean_rate:0.9676320272572402
noisy true:323
noisy false:1639
after delete: len(clean_dataset) 1174
after delete: len(noisy_dataset) 1962
epoch [47/200] batch [5/36] time 0.699 (0.501) data 0.569 (0.370) loss_x loss_x 1.0732 (1.3479) acc_x 71.8750 (66.8750) lr 1.7604e-03 eta 0:00:15
epoch [47/200] batch [10/36] time 0.361 (0.480) data 0.230 (0.350) loss_x loss_x 2.2656 (1.5035) acc_x 46.8750 (61.2500) lr 1.7604e-03 eta 0:00:12
epoch [47/200] batch [15/36] time 0.578 (0.493) data 0.448 (0.362) loss_x loss_x 1.6504 (1.5811) acc_x 56.2500 (59.7917) lr 1.7604e-03 eta 0:00:10
epoch [47/200] batch [20/36] time 0.496 (0.482) data 0.365 (0.351) loss_x loss_x 1.2686 (1.5298) acc_x 68.7500 (59.5312) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [25/36] time 0.443 (0.475) data 0.313 (0.344) loss_x loss_x 1.3994 (1.4544) acc_x 53.1250 (61.5000) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [30/36] time 0.408 (0.473) data 0.277 (0.342) loss_x loss_x 1.0596 (1.4221) acc_x 62.5000 (61.5625) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [35/36] time 0.455 (0.470) data 0.324 (0.339) loss_x loss_x 1.1436 (1.3879) acc_x 65.6250 (61.9643) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1716
confident_label rate tensor(0.3600, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1129
clean true:1093
clean false:36
clean_rate:0.9681133746678476
noisy true:327
noisy false:1680
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 2007
epoch [48/200] batch [5/35] time 0.392 (0.436) data 0.260 (0.304) loss_x loss_x 1.4062 (1.5236) acc_x 53.1250 (60.0000) lr 1.7501e-03 eta 0:00:13
epoch [48/200] batch [10/35] time 0.420 (0.466) data 0.289 (0.335) loss_x loss_x 1.7969 (1.4313) acc_x 53.1250 (62.1875) lr 1.7501e-03 eta 0:00:11
epoch [48/200] batch [15/35] time 0.422 (0.466) data 0.291 (0.335) loss_x loss_x 1.1426 (1.4280) acc_x 68.7500 (62.7083) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [20/35] time 0.466 (0.457) data 0.335 (0.326) loss_x loss_x 1.0156 (1.4117) acc_x 68.7500 (63.4375) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [25/35] time 0.434 (0.463) data 0.304 (0.333) loss_x loss_x 1.2344 (1.4170) acc_x 62.5000 (63.0000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [30/35] time 0.583 (0.475) data 0.453 (0.345) loss_x loss_x 1.0840 (1.4114) acc_x 62.5000 (62.3958) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [35/35] time 0.398 (0.470) data 0.268 (0.339) loss_x loss_x 1.4727 (1.3879) acc_x 75.0000 (63.3036) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.3648, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1144
clean true:1109
clean false:35
clean_rate:0.9694055944055944
noisy true:335
noisy false:1657
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 1992
epoch [49/200] batch [5/35] time 0.497 (0.448) data 0.367 (0.317) loss_x loss_x 1.0186 (1.1529) acc_x 71.8750 (71.8750) lr 1.7396e-03 eta 0:00:13
epoch [49/200] batch [10/35] time 0.435 (0.455) data 0.304 (0.324) loss_x loss_x 1.0664 (1.2822) acc_x 78.1250 (69.0625) lr 1.7396e-03 eta 0:00:11
epoch [49/200] batch [15/35] time 0.472 (0.471) data 0.341 (0.340) loss_x loss_x 1.5020 (1.4061) acc_x 50.0000 (63.5417) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [20/35] time 0.463 (0.472) data 0.333 (0.341) loss_x loss_x 1.6445 (1.4228) acc_x 59.3750 (63.9062) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [25/35] time 0.490 (0.475) data 0.359 (0.345) loss_x loss_x 1.5361 (1.4213) acc_x 46.8750 (63.3750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [30/35] time 0.413 (0.465) data 0.282 (0.335) loss_x loss_x 1.9678 (1.4343) acc_x 50.0000 (63.5417) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [35/35] time 0.538 (0.471) data 0.407 (0.340) loss_x loss_x 1.4648 (1.4484) acc_x 68.7500 (63.7500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1693
confident_label rate tensor(0.3667, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1150
clean true:1115
clean false:35
clean_rate:0.9695652173913043
noisy true:328
noisy false:1658
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 1986
epoch [50/200] batch [5/35] time 0.740 (0.552) data 0.607 (0.420) loss_x loss_x 1.2568 (1.5783) acc_x 62.5000 (56.2500) lr 1.7290e-03 eta 0:00:16
epoch [50/200] batch [10/35] time 0.427 (0.532) data 0.297 (0.401) loss_x loss_x 1.5869 (1.4567) acc_x 50.0000 (59.0625) lr 1.7290e-03 eta 0:00:13
epoch [50/200] batch [15/35] time 0.382 (0.508) data 0.251 (0.377) loss_x loss_x 1.0459 (1.4146) acc_x 71.8750 (62.0833) lr 1.7290e-03 eta 0:00:10
epoch [50/200] batch [20/35] time 0.477 (0.509) data 0.347 (0.378) loss_x loss_x 1.9453 (1.4561) acc_x 53.1250 (61.7188) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [25/35] time 0.334 (0.499) data 0.203 (0.368) loss_x loss_x 1.1758 (1.4196) acc_x 75.0000 (63.2500) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [30/35] time 0.398 (0.488) data 0.268 (0.357) loss_x loss_x 0.9790 (1.4065) acc_x 81.2500 (63.2292) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [35/35] time 0.390 (0.479) data 0.259 (0.348) loss_x loss_x 1.9814 (1.4392) acc_x 53.1250 (62.8571) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1691
confident_label rate tensor(0.3677, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1153
clean true:1117
clean false:36
clean_rate:0.96877710320902
noisy true:328
noisy false:1655
after delete: len(clean_dataset) 1153
after delete: len(noisy_dataset) 1983
epoch [51/200] batch [5/36] time 0.587 (0.494) data 0.456 (0.364) loss_x loss_x 1.1787 (1.4693) acc_x 71.8750 (63.1250) lr 1.7181e-03 eta 0:00:15
epoch [51/200] batch [10/36] time 0.552 (0.500) data 0.421 (0.370) loss_x loss_x 1.7744 (1.4586) acc_x 62.5000 (64.3750) lr 1.7181e-03 eta 0:00:13
epoch [51/200] batch [15/36] time 0.594 (0.499) data 0.463 (0.368) loss_x loss_x 1.3877 (1.4026) acc_x 68.7500 (64.1667) lr 1.7181e-03 eta 0:00:10
epoch [51/200] batch [20/36] time 0.470 (0.488) data 0.340 (0.357) loss_x loss_x 1.2744 (1.4077) acc_x 65.6250 (63.7500) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [25/36] time 0.401 (0.484) data 0.270 (0.353) loss_x loss_x 0.8960 (1.4235) acc_x 68.7500 (63.6250) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [30/36] time 0.405 (0.479) data 0.275 (0.348) loss_x loss_x 1.7100 (1.4179) acc_x 65.6250 (64.0625) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [35/36] time 0.420 (0.474) data 0.289 (0.343) loss_x loss_x 1.0215 (1.4139) acc_x 78.1250 (64.0179) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1618
confident_label rate tensor(0.3833, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1202
clean true:1172
clean false:30
clean_rate:0.9750415973377704
noisy true:346
noisy false:1588
after delete: len(clean_dataset) 1202
after delete: len(noisy_dataset) 1934
epoch [52/200] batch [5/37] time 0.433 (0.623) data 0.302 (0.492) loss_x loss_x 1.0752 (1.3267) acc_x 71.8750 (66.8750) lr 1.7071e-03 eta 0:00:19
epoch [52/200] batch [10/37] time 0.502 (0.541) data 0.372 (0.410) loss_x loss_x 1.7148 (1.4779) acc_x 56.2500 (60.3125) lr 1.7071e-03 eta 0:00:14
epoch [52/200] batch [15/37] time 0.435 (0.511) data 0.304 (0.380) loss_x loss_x 1.1250 (1.4396) acc_x 75.0000 (61.6667) lr 1.7071e-03 eta 0:00:11
epoch [52/200] batch [20/37] time 0.490 (0.493) data 0.359 (0.362) loss_x loss_x 1.6152 (1.4337) acc_x 62.5000 (63.5938) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [25/37] time 0.586 (0.506) data 0.455 (0.375) loss_x loss_x 0.9766 (1.3926) acc_x 75.0000 (64.3750) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [30/37] time 0.557 (0.509) data 0.426 (0.378) loss_x loss_x 1.3389 (1.3735) acc_x 68.7500 (64.5833) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [35/37] time 0.449 (0.501) data 0.317 (0.370) loss_x loss_x 0.9658 (1.3319) acc_x 68.7500 (65.2679) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1654
confident_label rate tensor(0.3766, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1181
clean true:1156
clean false:25
clean_rate:0.97883149872989
noisy true:326
noisy false:1629
after delete: len(clean_dataset) 1181
after delete: len(noisy_dataset) 1955
epoch [53/200] batch [5/36] time 0.427 (0.443) data 0.297 (0.312) loss_x loss_x 1.3330 (1.4449) acc_x 56.2500 (61.2500) lr 1.6959e-03 eta 0:00:13
epoch [53/200] batch [10/36] time 0.596 (0.454) data 0.465 (0.323) loss_x loss_x 1.1133 (1.4830) acc_x 75.0000 (60.9375) lr 1.6959e-03 eta 0:00:11
epoch [53/200] batch [15/36] time 0.434 (0.466) data 0.303 (0.335) loss_x loss_x 1.5986 (1.4327) acc_x 56.2500 (62.5000) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [20/36] time 0.425 (0.468) data 0.295 (0.337) loss_x loss_x 1.0625 (1.3743) acc_x 75.0000 (64.2188) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [25/36] time 0.401 (0.463) data 0.271 (0.332) loss_x loss_x 1.3076 (1.3634) acc_x 71.8750 (64.7500) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [30/36] time 0.443 (0.458) data 0.313 (0.327) loss_x loss_x 1.2656 (1.3698) acc_x 78.1250 (65.1042) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [35/36] time 0.464 (0.461) data 0.334 (0.330) loss_x loss_x 1.1143 (1.3018) acc_x 71.8750 (66.9643) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1675
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1178
clean true:1145
clean false:33
clean_rate:0.9719864176570459
noisy true:316
noisy false:1642
after delete: len(clean_dataset) 1178
after delete: len(noisy_dataset) 1958
epoch [54/200] batch [5/36] time 0.444 (0.452) data 0.313 (0.321) loss_x loss_x 1.2295 (1.4131) acc_x 71.8750 (64.3750) lr 1.6845e-03 eta 0:00:14
epoch [54/200] batch [10/36] time 0.331 (0.484) data 0.200 (0.353) loss_x loss_x 1.1289 (1.3939) acc_x 68.7500 (65.0000) lr 1.6845e-03 eta 0:00:12
epoch [54/200] batch [15/36] time 0.420 (0.481) data 0.289 (0.350) loss_x loss_x 1.4854 (1.4376) acc_x 56.2500 (62.0833) lr 1.6845e-03 eta 0:00:10
epoch [54/200] batch [20/36] time 0.349 (0.474) data 0.218 (0.343) loss_x loss_x 1.3467 (1.4045) acc_x 59.3750 (63.4375) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [25/36] time 0.450 (0.473) data 0.319 (0.342) loss_x loss_x 1.4590 (1.4332) acc_x 59.3750 (62.8750) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [30/36] time 0.501 (0.472) data 0.370 (0.341) loss_x loss_x 1.4346 (1.4230) acc_x 53.1250 (63.2292) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [35/36] time 0.523 (0.472) data 0.393 (0.342) loss_x loss_x 2.3438 (1.4414) acc_x 46.8750 (63.3929) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1690
confident_label rate tensor(0.3696, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1159
clean true:1133
clean false:26
clean_rate:0.9775668679896462
noisy true:313
noisy false:1664
after delete: len(clean_dataset) 1159
after delete: len(noisy_dataset) 1977
epoch [55/200] batch [5/36] time 0.483 (0.465) data 0.352 (0.334) loss_x loss_x 1.6279 (1.5742) acc_x 56.2500 (61.8750) lr 1.6730e-03 eta 0:00:14
epoch [55/200] batch [10/36] time 0.514 (0.472) data 0.383 (0.342) loss_x loss_x 1.4990 (1.5141) acc_x 65.6250 (62.5000) lr 1.6730e-03 eta 0:00:12
epoch [55/200] batch [15/36] time 0.371 (0.466) data 0.241 (0.335) loss_x loss_x 1.6816 (1.5346) acc_x 56.2500 (62.5000) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [20/36] time 0.427 (0.467) data 0.296 (0.336) loss_x loss_x 1.1787 (1.5088) acc_x 68.7500 (62.9688) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [25/36] time 0.456 (0.462) data 0.326 (0.331) loss_x loss_x 1.0469 (1.4612) acc_x 75.0000 (64.0000) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [30/36] time 0.405 (0.460) data 0.273 (0.329) loss_x loss_x 0.7891 (1.4684) acc_x 84.3750 (64.3750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [35/36] time 0.411 (0.460) data 0.281 (0.329) loss_x loss_x 1.3760 (1.4627) acc_x 68.7500 (64.2857) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1191
clean true:1162
clean false:29
clean_rate:0.9756507136859782
noisy true:345
noisy false:1600
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 1945
epoch [56/200] batch [5/37] time 0.436 (0.444) data 0.306 (0.313) loss_x loss_x 1.1465 (1.2972) acc_x 62.5000 (65.6250) lr 1.6613e-03 eta 0:00:14
epoch [56/200] batch [10/37] time 0.386 (0.459) data 0.255 (0.329) loss_x loss_x 1.1553 (1.3095) acc_x 62.5000 (64.6875) lr 1.6613e-03 eta 0:00:12
epoch [56/200] batch [15/37] time 0.417 (0.468) data 0.285 (0.337) loss_x loss_x 1.2803 (1.3208) acc_x 71.8750 (65.8333) lr 1.6613e-03 eta 0:00:10
epoch [56/200] batch [20/37] time 0.557 (0.470) data 0.427 (0.339) loss_x loss_x 1.4619 (1.3495) acc_x 71.8750 (65.7812) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [25/37] time 0.482 (0.485) data 0.351 (0.354) loss_x loss_x 1.2295 (1.3402) acc_x 71.8750 (65.2500) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [30/37] time 0.382 (0.491) data 0.252 (0.360) loss_x loss_x 1.3076 (1.3544) acc_x 71.8750 (65.1042) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [35/37] time 0.364 (0.485) data 0.234 (0.354) loss_x loss_x 1.5059 (1.3642) acc_x 68.7500 (64.9107) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.3680, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1154
clean true:1118
clean false:36
clean_rate:0.9688041594454073
noisy true:316
noisy false:1666
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 1982
epoch [57/200] batch [5/36] time 0.432 (0.460) data 0.301 (0.328) loss_x loss_x 1.5127 (1.5328) acc_x 65.6250 (63.1250) lr 1.6494e-03 eta 0:00:14
epoch [57/200] batch [10/36] time 0.453 (0.469) data 0.322 (0.338) loss_x loss_x 2.2070 (1.6096) acc_x 46.8750 (60.9375) lr 1.6494e-03 eta 0:00:12
epoch [57/200] batch [15/36] time 0.373 (0.474) data 0.243 (0.343) loss_x loss_x 1.4004 (1.5433) acc_x 62.5000 (61.6667) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [20/36] time 0.528 (0.470) data 0.398 (0.340) loss_x loss_x 1.6787 (1.5156) acc_x 53.1250 (61.5625) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [25/36] time 0.369 (0.458) data 0.239 (0.328) loss_x loss_x 1.3584 (1.4856) acc_x 65.6250 (62.2500) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [30/36] time 0.396 (0.456) data 0.265 (0.326) loss_x loss_x 1.4287 (1.4959) acc_x 53.1250 (61.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [35/36] time 0.420 (0.450) data 0.289 (0.320) loss_x loss_x 1.8291 (1.5096) acc_x 46.8750 (61.1607) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1613
confident_label rate tensor(0.3858, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1210
clean true:1180
clean false:30
clean_rate:0.9752066115702479
noisy true:343
noisy false:1583
after delete: len(clean_dataset) 1210
after delete: len(noisy_dataset) 1926
epoch [58/200] batch [5/37] time 0.399 (0.485) data 0.269 (0.354) loss_x loss_x 1.6172 (1.4777) acc_x 62.5000 (64.3750) lr 1.6374e-03 eta 0:00:15
epoch [58/200] batch [10/37] time 0.443 (0.476) data 0.313 (0.345) loss_x loss_x 1.6367 (1.5795) acc_x 62.5000 (59.0625) lr 1.6374e-03 eta 0:00:12
epoch [58/200] batch [15/37] time 0.478 (0.464) data 0.346 (0.334) loss_x loss_x 1.6406 (1.4840) acc_x 59.3750 (61.6667) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [20/37] time 0.495 (0.465) data 0.364 (0.334) loss_x loss_x 1.3135 (1.4411) acc_x 62.5000 (62.3438) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [25/37] time 0.518 (0.471) data 0.386 (0.340) loss_x loss_x 1.4033 (1.4309) acc_x 56.2500 (62.1250) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [30/37] time 0.512 (0.472) data 0.381 (0.341) loss_x loss_x 1.0898 (1.3971) acc_x 62.5000 (62.9167) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [35/37] time 0.413 (0.468) data 0.283 (0.337) loss_x loss_x 0.8979 (1.3624) acc_x 78.1250 (64.0179) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3846, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1206
clean true:1174
clean false:32
clean_rate:0.9734660033167496
noisy true:328
noisy false:1602
after delete: len(clean_dataset) 1206
after delete: len(noisy_dataset) 1930
epoch [59/200] batch [5/37] time 0.365 (0.426) data 0.234 (0.295) loss_x loss_x 1.2490 (1.3408) acc_x 75.0000 (68.1250) lr 1.6252e-03 eta 0:00:13
epoch [59/200] batch [10/37] time 0.367 (0.445) data 0.237 (0.314) loss_x loss_x 1.3271 (1.5569) acc_x 62.5000 (63.7500) lr 1.6252e-03 eta 0:00:12
epoch [59/200] batch [15/37] time 0.335 (0.434) data 0.205 (0.304) loss_x loss_x 1.4463 (1.4660) acc_x 68.7500 (64.3750) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [20/37] time 0.400 (0.442) data 0.269 (0.312) loss_x loss_x 1.5752 (1.4506) acc_x 50.0000 (62.9688) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [25/37] time 0.556 (0.451) data 0.425 (0.320) loss_x loss_x 1.5303 (1.4421) acc_x 62.5000 (63.0000) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [30/37] time 0.591 (0.451) data 0.461 (0.320) loss_x loss_x 1.2539 (1.4140) acc_x 71.8750 (63.8542) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [35/37] time 0.442 (0.454) data 0.312 (0.324) loss_x loss_x 1.5850 (1.3943) acc_x 56.2500 (64.1964) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.3699, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1160
clean true:1126
clean false:34
clean_rate:0.9706896551724138
noisy true:360
noisy false:1616
after delete: len(clean_dataset) 1160
after delete: len(noisy_dataset) 1976
epoch [60/200] batch [5/36] time 0.482 (0.434) data 0.351 (0.303) loss_x loss_x 1.7939 (1.6775) acc_x 59.3750 (56.8750) lr 1.6129e-03 eta 0:00:13
epoch [60/200] batch [10/36] time 0.370 (0.442) data 0.239 (0.311) loss_x loss_x 1.6230 (1.5393) acc_x 68.7500 (60.6250) lr 1.6129e-03 eta 0:00:11
epoch [60/200] batch [15/36] time 0.365 (0.435) data 0.235 (0.304) loss_x loss_x 1.5234 (1.5029) acc_x 65.6250 (62.0833) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [20/36] time 0.437 (0.440) data 0.306 (0.309) loss_x loss_x 1.2422 (1.4930) acc_x 65.6250 (60.7812) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [25/36] time 0.450 (0.438) data 0.318 (0.307) loss_x loss_x 1.2627 (1.4406) acc_x 62.5000 (62.2500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [30/36] time 0.503 (0.445) data 0.373 (0.314) loss_x loss_x 0.9175 (1.3923) acc_x 71.8750 (63.0208) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [35/36] time 0.422 (0.445) data 0.291 (0.314) loss_x loss_x 1.2959 (1.3657) acc_x 56.2500 (63.3929) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1686
confident_label rate tensor(0.3661, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1148
clean true:1114
clean false:34
clean_rate:0.9703832752613241
noisy true:336
noisy false:1652
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 1988
epoch [61/200] batch [5/35] time 0.449 (0.478) data 0.319 (0.347) loss_x loss_x 1.5879 (1.4002) acc_x 65.6250 (68.1250) lr 1.6004e-03 eta 0:00:14
epoch [61/200] batch [10/35] time 0.351 (0.474) data 0.220 (0.343) loss_x loss_x 1.3223 (1.3469) acc_x 62.5000 (67.5000) lr 1.6004e-03 eta 0:00:11
epoch [61/200] batch [15/35] time 0.416 (0.476) data 0.285 (0.345) loss_x loss_x 1.7705 (1.3329) acc_x 62.5000 (68.1250) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [20/35] time 0.501 (0.465) data 0.371 (0.334) loss_x loss_x 1.0684 (1.3865) acc_x 65.6250 (65.0000) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [25/35] time 0.574 (0.469) data 0.443 (0.338) loss_x loss_x 1.4326 (1.3538) acc_x 62.5000 (65.7500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [30/35] time 0.400 (0.467) data 0.270 (0.336) loss_x loss_x 1.4912 (1.3714) acc_x 65.6250 (65.3125) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [35/35] time 0.426 (0.464) data 0.296 (0.333) loss_x loss_x 1.4111 (1.3926) acc_x 65.6250 (64.8214) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.3798, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1191
clean true:1167
clean false:24
clean_rate:0.9798488664987406
noisy true:336
noisy false:1609
after delete: len(clean_dataset) 1191
after delete: len(noisy_dataset) 1945
epoch [62/200] batch [5/37] time 0.653 (0.472) data 0.522 (0.341) loss_x loss_x 1.1377 (1.4613) acc_x 62.5000 (64.3750) lr 1.5878e-03 eta 0:00:15
epoch [62/200] batch [10/37] time 0.603 (0.498) data 0.472 (0.367) loss_x loss_x 1.3008 (1.4296) acc_x 59.3750 (60.9375) lr 1.5878e-03 eta 0:00:13
epoch [62/200] batch [15/37] time 0.622 (0.507) data 0.491 (0.376) loss_x loss_x 0.7339 (1.3333) acc_x 81.2500 (63.1250) lr 1.5878e-03 eta 0:00:11
epoch [62/200] batch [20/37] time 0.455 (0.490) data 0.324 (0.359) loss_x loss_x 1.2686 (1.3591) acc_x 75.0000 (63.5938) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [25/37] time 0.404 (0.490) data 0.273 (0.359) loss_x loss_x 1.5029 (1.3369) acc_x 68.7500 (64.8750) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [30/37] time 0.438 (0.482) data 0.308 (0.352) loss_x loss_x 0.9121 (1.3554) acc_x 71.8750 (64.6875) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [35/37] time 0.423 (0.474) data 0.292 (0.343) loss_x loss_x 0.8623 (1.3553) acc_x 78.1250 (65.0000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1615
confident_label rate tensor(0.3865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1212
clean true:1186
clean false:26
clean_rate:0.9785478547854786
noisy true:335
noisy false:1589
after delete: len(clean_dataset) 1212
after delete: len(noisy_dataset) 1924
epoch [63/200] batch [5/37] time 0.453 (0.476) data 0.322 (0.345) loss_x loss_x 1.3252 (1.3391) acc_x 65.6250 (65.6250) lr 1.5750e-03 eta 0:00:15
epoch [63/200] batch [10/37] time 0.435 (0.487) data 0.304 (0.356) loss_x loss_x 1.6719 (1.3868) acc_x 50.0000 (62.5000) lr 1.5750e-03 eta 0:00:13
epoch [63/200] batch [15/37] time 0.504 (0.463) data 0.374 (0.332) loss_x loss_x 1.1475 (1.3243) acc_x 75.0000 (65.2083) lr 1.5750e-03 eta 0:00:10
epoch [63/200] batch [20/37] time 0.419 (0.469) data 0.289 (0.338) loss_x loss_x 0.9653 (1.2806) acc_x 75.0000 (66.4062) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [25/37] time 0.574 (0.481) data 0.444 (0.350) loss_x loss_x 1.7012 (1.2927) acc_x 62.5000 (66.8750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [30/37] time 0.439 (0.480) data 0.308 (0.350) loss_x loss_x 1.6260 (1.3347) acc_x 50.0000 (65.3125) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [35/37] time 0.381 (0.472) data 0.250 (0.342) loss_x loss_x 1.2969 (1.3536) acc_x 59.3750 (64.4643) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1645
confident_label rate tensor(0.3795, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1190
clean true:1156
clean false:34
clean_rate:0.9714285714285714
noisy true:335
noisy false:1611
after delete: len(clean_dataset) 1190
after delete: len(noisy_dataset) 1946
epoch [64/200] batch [5/37] time 0.571 (0.519) data 0.440 (0.388) loss_x loss_x 1.0400 (1.2537) acc_x 75.0000 (70.6250) lr 1.5621e-03 eta 0:00:16
epoch [64/200] batch [10/37] time 0.416 (0.465) data 0.285 (0.334) loss_x loss_x 1.3291 (1.2895) acc_x 68.7500 (67.1875) lr 1.5621e-03 eta 0:00:12
epoch [64/200] batch [15/37] time 0.446 (0.474) data 0.315 (0.343) loss_x loss_x 1.6523 (1.3078) acc_x 62.5000 (66.6667) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [20/37] time 0.362 (0.468) data 0.231 (0.337) loss_x loss_x 1.5176 (1.3800) acc_x 59.3750 (65.0000) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [25/37] time 0.476 (0.461) data 0.345 (0.330) loss_x loss_x 0.4805 (1.3068) acc_x 87.5000 (66.3750) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [30/37] time 0.485 (0.452) data 0.355 (0.321) loss_x loss_x 1.5176 (1.3256) acc_x 59.3750 (65.6250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [35/37] time 0.393 (0.452) data 0.263 (0.321) loss_x loss_x 1.2637 (1.3322) acc_x 78.1250 (65.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.3858, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1210
clean true:1179
clean false:31
clean_rate:0.9743801652892562
noisy true:322
noisy false:1604
after delete: len(clean_dataset) 1210
after delete: len(noisy_dataset) 1926
epoch [65/200] batch [5/37] time 0.593 (0.509) data 0.463 (0.378) loss_x loss_x 1.8877 (1.7053) acc_x 56.2500 (59.3750) lr 1.5490e-03 eta 0:00:16
epoch [65/200] batch [10/37] time 0.509 (0.481) data 0.378 (0.350) loss_x loss_x 1.1318 (1.4773) acc_x 59.3750 (62.5000) lr 1.5490e-03 eta 0:00:12
epoch [65/200] batch [15/37] time 0.545 (0.492) data 0.414 (0.361) loss_x loss_x 1.3262 (1.5041) acc_x 65.6250 (61.6667) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [20/37] time 0.487 (0.486) data 0.355 (0.355) loss_x loss_x 1.0410 (1.4435) acc_x 78.1250 (63.4375) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [25/37] time 0.503 (0.483) data 0.373 (0.352) loss_x loss_x 1.5146 (1.4313) acc_x 56.2500 (63.6250) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [30/37] time 0.565 (0.484) data 0.433 (0.353) loss_x loss_x 1.1104 (1.4258) acc_x 71.8750 (63.2292) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [35/37] time 0.485 (0.495) data 0.354 (0.364) loss_x loss_x 1.9941 (1.4326) acc_x 56.2500 (62.7679) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1625
confident_label rate tensor(0.3865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1212
clean true:1169
clean false:43
clean_rate:0.9645214521452146
noisy true:342
noisy false:1582
after delete: len(clean_dataset) 1212
after delete: len(noisy_dataset) 1924
epoch [66/200] batch [5/37] time 0.443 (0.477) data 0.312 (0.347) loss_x loss_x 1.3945 (1.2026) acc_x 65.6250 (63.7500) lr 1.5358e-03 eta 0:00:15
epoch [66/200] batch [10/37] time 0.472 (0.465) data 0.342 (0.335) loss_x loss_x 1.4971 (1.3370) acc_x 56.2500 (61.8750) lr 1.5358e-03 eta 0:00:12
epoch [66/200] batch [15/37] time 0.427 (0.482) data 0.297 (0.351) loss_x loss_x 1.2686 (1.3156) acc_x 62.5000 (62.5000) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [20/37] time 0.525 (0.477) data 0.394 (0.347) loss_x loss_x 1.4697 (1.3157) acc_x 65.6250 (62.9688) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [25/37] time 0.462 (0.473) data 0.330 (0.342) loss_x loss_x 1.3467 (1.3210) acc_x 71.8750 (64.2500) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [30/37] time 0.517 (0.471) data 0.387 (0.340) loss_x loss_x 1.2109 (1.3410) acc_x 71.8750 (64.1667) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [35/37] time 0.448 (0.474) data 0.317 (0.343) loss_x loss_x 1.8389 (1.3521) acc_x 65.6250 (64.6429) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1605
confident_label rate tensor(0.3887, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1219
clean true:1185
clean false:34
clean_rate:0.9721082854799016
noisy true:346
noisy false:1571
after delete: len(clean_dataset) 1219
after delete: len(noisy_dataset) 1917
epoch [67/200] batch [5/38] time 0.416 (0.471) data 0.284 (0.340) loss_x loss_x 1.5195 (1.3420) acc_x 65.6250 (64.3750) lr 1.5225e-03 eta 0:00:15
epoch [67/200] batch [10/38] time 0.403 (0.470) data 0.273 (0.339) loss_x loss_x 1.5693 (1.3675) acc_x 56.2500 (63.7500) lr 1.5225e-03 eta 0:00:13
epoch [67/200] batch [15/38] time 0.446 (0.455) data 0.314 (0.324) loss_x loss_x 1.5605 (1.3793) acc_x 65.6250 (65.4167) lr 1.5225e-03 eta 0:00:10
epoch [67/200] batch [20/38] time 0.636 (0.469) data 0.504 (0.338) loss_x loss_x 1.4688 (1.3659) acc_x 65.6250 (65.4688) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [25/38] time 0.475 (0.468) data 0.343 (0.337) loss_x loss_x 1.5879 (1.3352) acc_x 59.3750 (66.1250) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [30/38] time 0.454 (0.464) data 0.323 (0.333) loss_x loss_x 2.3105 (1.3577) acc_x 59.3750 (66.1458) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [35/38] time 0.579 (0.467) data 0.448 (0.336) loss_x loss_x 1.8867 (1.3638) acc_x 50.0000 (65.5357) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1589
confident_label rate tensor(0.3913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1227
clean true:1204
clean false:23
clean_rate:0.9812550937245313
noisy true:343
noisy false:1566
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 1909
epoch [68/200] batch [5/38] time 0.402 (0.467) data 0.271 (0.336) loss_x loss_x 1.2012 (1.4445) acc_x 71.8750 (63.7500) lr 1.5090e-03 eta 0:00:15
epoch [68/200] batch [10/38] time 0.417 (0.471) data 0.287 (0.340) loss_x loss_x 1.8359 (1.4056) acc_x 56.2500 (65.6250) lr 1.5090e-03 eta 0:00:13
epoch [68/200] batch [15/38] time 0.421 (0.471) data 0.290 (0.340) loss_x loss_x 1.6807 (1.4095) acc_x 53.1250 (64.7917) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [20/38] time 0.450 (0.467) data 0.319 (0.336) loss_x loss_x 1.5117 (1.4302) acc_x 65.6250 (64.6875) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [25/38] time 0.559 (0.477) data 0.428 (0.346) loss_x loss_x 1.0166 (1.4892) acc_x 78.1250 (62.7500) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [30/38] time 0.498 (0.487) data 0.367 (0.356) loss_x loss_x 1.0635 (1.4372) acc_x 71.8750 (64.0625) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [35/38] time 0.532 (0.482) data 0.402 (0.351) loss_x loss_x 1.0801 (1.4219) acc_x 62.5000 (64.2857) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3925, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1231
clean true:1196
clean false:35
clean_rate:0.9715678310316815
noisy true:337
noisy false:1568
after delete: len(clean_dataset) 1231
after delete: len(noisy_dataset) 1905
epoch [69/200] batch [5/38] time 0.387 (0.478) data 0.256 (0.346) loss_x loss_x 0.8057 (1.2768) acc_x 75.0000 (64.3750) lr 1.4955e-03 eta 0:00:15
epoch [69/200] batch [10/38] time 0.444 (0.482) data 0.314 (0.351) loss_x loss_x 1.5264 (1.4380) acc_x 56.2500 (64.0625) lr 1.4955e-03 eta 0:00:13
epoch [69/200] batch [15/38] time 0.441 (0.485) data 0.310 (0.355) loss_x loss_x 1.3408 (1.4055) acc_x 62.5000 (64.5833) lr 1.4955e-03 eta 0:00:11
epoch [69/200] batch [20/38] time 0.488 (0.486) data 0.357 (0.355) loss_x loss_x 1.2139 (1.4194) acc_x 71.8750 (64.5312) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [25/38] time 0.373 (0.470) data 0.242 (0.339) loss_x loss_x 1.7373 (1.4260) acc_x 56.2500 (63.5000) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [30/38] time 0.440 (0.471) data 0.310 (0.340) loss_x loss_x 1.5850 (1.4458) acc_x 59.3750 (62.9167) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [35/38] time 0.468 (0.465) data 0.337 (0.334) loss_x loss_x 1.5859 (1.4595) acc_x 62.5000 (62.5000) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1616
confident_label rate tensor(0.3865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1212
clean true:1182
clean false:30
clean_rate:0.9752475247524752
noisy true:338
noisy false:1586
after delete: len(clean_dataset) 1212
after delete: len(noisy_dataset) 1924
epoch [70/200] batch [5/37] time 0.486 (0.452) data 0.355 (0.321) loss_x loss_x 1.3369 (1.3273) acc_x 65.6250 (66.2500) lr 1.4818e-03 eta 0:00:14
epoch [70/200] batch [10/37] time 0.457 (0.473) data 0.327 (0.342) loss_x loss_x 1.3027 (1.3115) acc_x 71.8750 (66.5625) lr 1.4818e-03 eta 0:00:12
epoch [70/200] batch [15/37] time 0.505 (0.470) data 0.374 (0.339) loss_x loss_x 1.3711 (1.3018) acc_x 59.3750 (66.4583) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [20/37] time 0.507 (0.467) data 0.377 (0.337) loss_x loss_x 1.1191 (1.3037) acc_x 78.1250 (66.5625) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [25/37] time 0.385 (0.461) data 0.254 (0.330) loss_x loss_x 0.9546 (1.2829) acc_x 75.0000 (66.5000) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [30/37] time 0.634 (0.463) data 0.503 (0.332) loss_x loss_x 1.3262 (1.3183) acc_x 62.5000 (65.6250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [35/37] time 0.432 (0.462) data 0.302 (0.331) loss_x loss_x 1.4980 (1.3109) acc_x 62.5000 (65.6250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1612
confident_label rate tensor(0.3871, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1214
clean true:1178
clean false:36
clean_rate:0.9703459637561779
noisy true:346
noisy false:1576
after delete: len(clean_dataset) 1214
after delete: len(noisy_dataset) 1922
epoch [71/200] batch [5/37] time 0.443 (0.437) data 0.313 (0.307) loss_x loss_x 1.3457 (1.4004) acc_x 68.7500 (67.5000) lr 1.4679e-03 eta 0:00:13
epoch [71/200] batch [10/37] time 0.410 (0.437) data 0.280 (0.306) loss_x loss_x 1.4346 (1.4032) acc_x 65.6250 (64.3750) lr 1.4679e-03 eta 0:00:11
epoch [71/200] batch [15/37] time 0.679 (0.461) data 0.548 (0.330) loss_x loss_x 1.1533 (1.3556) acc_x 68.7500 (65.4167) lr 1.4679e-03 eta 0:00:10
epoch [71/200] batch [20/37] time 0.585 (0.465) data 0.454 (0.334) loss_x loss_x 1.4160 (1.3394) acc_x 62.5000 (65.7812) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [25/37] time 0.570 (0.467) data 0.440 (0.336) loss_x loss_x 1.1211 (1.3188) acc_x 71.8750 (65.3750) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [30/37] time 0.496 (0.464) data 0.365 (0.333) loss_x loss_x 1.0098 (1.3313) acc_x 68.7500 (65.3125) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [35/37] time 0.474 (0.460) data 0.343 (0.330) loss_x loss_x 1.4873 (1.3516) acc_x 68.7500 (65.4464) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.3893, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1221
clean true:1191
clean false:30
clean_rate:0.9754299754299754
noisy true:322
noisy false:1593
after delete: len(clean_dataset) 1221
after delete: len(noisy_dataset) 1915
epoch [72/200] batch [5/38] time 0.436 (0.462) data 0.305 (0.331) loss_x loss_x 1.4473 (1.2779) acc_x 62.5000 (67.5000) lr 1.4540e-03 eta 0:00:15
epoch [72/200] batch [10/38] time 0.357 (0.470) data 0.226 (0.339) loss_x loss_x 1.3271 (1.2334) acc_x 68.7500 (68.7500) lr 1.4540e-03 eta 0:00:13
epoch [72/200] batch [15/38] time 0.461 (0.462) data 0.330 (0.331) loss_x loss_x 1.3750 (1.2674) acc_x 68.7500 (66.6667) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [20/38] time 0.431 (0.457) data 0.300 (0.326) loss_x loss_x 1.4014 (1.2694) acc_x 59.3750 (66.7188) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [25/38] time 0.443 (0.464) data 0.312 (0.333) loss_x loss_x 1.3652 (1.2485) acc_x 62.5000 (67.0000) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [30/38] time 0.488 (0.463) data 0.357 (0.332) loss_x loss_x 1.3662 (1.2464) acc_x 62.5000 (67.1875) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [35/38] time 0.387 (0.469) data 0.257 (0.338) loss_x loss_x 1.5957 (1.2816) acc_x 59.3750 (67.0536) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.3913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1227
clean true:1197
clean false:30
clean_rate:0.9755501222493888
noisy true:329
noisy false:1580
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 1909
epoch [73/200] batch [5/38] time 0.562 (0.467) data 0.431 (0.335) loss_x loss_x 1.4277 (1.2314) acc_x 56.2500 (66.8750) lr 1.4399e-03 eta 0:00:15
epoch [73/200] batch [10/38] time 0.411 (0.470) data 0.280 (0.339) loss_x loss_x 1.7178 (1.2479) acc_x 50.0000 (65.6250) lr 1.4399e-03 eta 0:00:13
epoch [73/200] batch [15/38] time 0.618 (0.477) data 0.486 (0.346) loss_x loss_x 1.8096 (1.2850) acc_x 53.1250 (65.0000) lr 1.4399e-03 eta 0:00:10
epoch [73/200] batch [20/38] time 0.499 (0.479) data 0.368 (0.348) loss_x loss_x 1.6230 (1.2832) acc_x 50.0000 (64.3750) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [25/38] time 0.616 (0.482) data 0.485 (0.351) loss_x loss_x 1.0586 (1.3059) acc_x 78.1250 (65.3750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [30/38] time 0.430 (0.474) data 0.299 (0.343) loss_x loss_x 1.5146 (1.3391) acc_x 65.6250 (65.5208) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [35/38] time 0.455 (0.476) data 0.325 (0.345) loss_x loss_x 1.1787 (1.3491) acc_x 65.6250 (65.8929) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1593
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1246
clean true:1212
clean false:34
clean_rate:0.9727126805778491
noisy true:331
noisy false:1559
after delete: len(clean_dataset) 1246
after delete: len(noisy_dataset) 1890
epoch [74/200] batch [5/38] time 0.523 (0.469) data 0.392 (0.338) loss_x loss_x 2.0566 (1.2895) acc_x 50.0000 (66.8750) lr 1.4258e-03 eta 0:00:15
epoch [74/200] batch [10/38] time 0.612 (0.509) data 0.481 (0.379) loss_x loss_x 1.6045 (1.2889) acc_x 62.5000 (65.3125) lr 1.4258e-03 eta 0:00:14
epoch [74/200] batch [15/38] time 0.464 (0.490) data 0.334 (0.359) loss_x loss_x 1.2100 (1.3011) acc_x 59.3750 (65.2083) lr 1.4258e-03 eta 0:00:11
epoch [74/200] batch [20/38] time 0.523 (0.486) data 0.392 (0.355) loss_x loss_x 1.1660 (1.2814) acc_x 65.6250 (66.2500) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [25/38] time 0.419 (0.489) data 0.288 (0.358) loss_x loss_x 1.6982 (1.2772) acc_x 56.2500 (67.1250) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [30/38] time 0.515 (0.484) data 0.384 (0.353) loss_x loss_x 1.3389 (1.2685) acc_x 68.7500 (67.2917) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [35/38] time 0.635 (0.480) data 0.504 (0.349) loss_x loss_x 1.1758 (1.2604) acc_x 62.5000 (67.5000) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1624
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1215
clean true:1184
clean false:31
clean_rate:0.974485596707819
noisy true:328
noisy false:1593
after delete: len(clean_dataset) 1215
after delete: len(noisy_dataset) 1921
epoch [75/200] batch [5/37] time 0.457 (0.443) data 0.326 (0.313) loss_x loss_x 1.4160 (1.2828) acc_x 68.7500 (66.8750) lr 1.4115e-03 eta 0:00:14
epoch [75/200] batch [10/37] time 0.539 (0.454) data 0.404 (0.323) loss_x loss_x 0.9897 (1.0820) acc_x 75.0000 (72.1875) lr 1.4115e-03 eta 0:00:12
epoch [75/200] batch [15/37] time 0.459 (0.454) data 0.329 (0.323) loss_x loss_x 1.6230 (1.2316) acc_x 56.2500 (68.3333) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [20/37] time 0.437 (0.467) data 0.306 (0.336) loss_x loss_x 1.4238 (1.2459) acc_x 62.5000 (67.5000) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [25/37] time 0.506 (0.471) data 0.376 (0.340) loss_x loss_x 1.1143 (1.2633) acc_x 71.8750 (67.3750) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [30/37] time 0.766 (0.475) data 0.635 (0.344) loss_x loss_x 1.1045 (1.2521) acc_x 68.7500 (68.1250) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [35/37] time 0.368 (0.476) data 0.238 (0.345) loss_x loss_x 1.3867 (1.2758) acc_x 68.7500 (67.9464) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.3945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1237
clean true:1199
clean false:38
clean_rate:0.9692805173807599
noisy true:304
noisy false:1595
after delete: len(clean_dataset) 1237
after delete: len(noisy_dataset) 1899
epoch [76/200] batch [5/38] time 0.422 (0.471) data 0.292 (0.340) loss_x loss_x 1.4189 (1.2480) acc_x 62.5000 (70.0000) lr 1.3971e-03 eta 0:00:15
epoch [76/200] batch [10/38] time 0.433 (0.460) data 0.303 (0.329) loss_x loss_x 1.4678 (1.2871) acc_x 62.5000 (67.8125) lr 1.3971e-03 eta 0:00:12
epoch [76/200] batch [15/38] time 0.375 (0.466) data 0.244 (0.336) loss_x loss_x 1.5479 (1.3302) acc_x 59.3750 (68.1250) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [20/38] time 0.354 (0.459) data 0.222 (0.328) loss_x loss_x 2.1914 (1.4333) acc_x 56.2500 (65.1562) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [25/38] time 0.593 (0.473) data 0.462 (0.342) loss_x loss_x 1.5752 (1.4203) acc_x 56.2500 (65.3750) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [30/38] time 0.378 (0.466) data 0.246 (0.335) loss_x loss_x 1.4824 (1.4459) acc_x 62.5000 (63.9583) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [35/38] time 0.511 (0.464) data 0.379 (0.333) loss_x loss_x 1.1406 (1.4147) acc_x 78.1250 (64.2857) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1579
confident_label rate tensor(0.4034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1265
clean true:1227
clean false:38
clean_rate:0.9699604743083003
noisy true:330
noisy false:1541
after delete: len(clean_dataset) 1265
after delete: len(noisy_dataset) 1871
epoch [77/200] batch [5/39] time 0.515 (0.467) data 0.384 (0.337) loss_x loss_x 1.8584 (1.4879) acc_x 59.3750 (61.8750) lr 1.3827e-03 eta 0:00:15
epoch [77/200] batch [10/39] time 0.386 (0.470) data 0.256 (0.340) loss_x loss_x 1.4229 (1.4722) acc_x 68.7500 (63.4375) lr 1.3827e-03 eta 0:00:13
epoch [77/200] batch [15/39] time 0.469 (0.469) data 0.339 (0.338) loss_x loss_x 1.4736 (1.4429) acc_x 62.5000 (63.9583) lr 1.3827e-03 eta 0:00:11
epoch [77/200] batch [20/39] time 0.440 (0.471) data 0.310 (0.340) loss_x loss_x 1.8926 (1.4480) acc_x 59.3750 (63.5938) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [25/39] time 0.429 (0.468) data 0.297 (0.337) loss_x loss_x 1.0205 (1.4092) acc_x 71.8750 (64.1250) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [30/39] time 0.541 (0.466) data 0.410 (0.336) loss_x loss_x 1.0762 (1.3950) acc_x 68.7500 (64.7917) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [35/39] time 0.468 (0.465) data 0.337 (0.334) loss_x loss_x 1.3691 (1.3721) acc_x 68.7500 (65.0893) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1584
confident_label rate tensor(0.3996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1253
clean true:1219
clean false:34
clean_rate:0.9728651237031125
noisy true:333
noisy false:1550
after delete: len(clean_dataset) 1253
after delete: len(noisy_dataset) 1883
epoch [78/200] batch [5/39] time 0.363 (0.412) data 0.232 (0.281) loss_x loss_x 1.6211 (1.4158) acc_x 62.5000 (61.2500) lr 1.3681e-03 eta 0:00:14
epoch [78/200] batch [10/39] time 0.408 (0.453) data 0.278 (0.323) loss_x loss_x 1.2627 (1.3656) acc_x 56.2500 (62.1875) lr 1.3681e-03 eta 0:00:13
epoch [78/200] batch [15/39] time 0.373 (0.453) data 0.243 (0.322) loss_x loss_x 1.8018 (1.3906) acc_x 62.5000 (63.3333) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [20/39] time 0.388 (0.472) data 0.257 (0.341) loss_x loss_x 1.2783 (1.3979) acc_x 75.0000 (63.7500) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [25/39] time 0.360 (0.465) data 0.230 (0.334) loss_x loss_x 0.9985 (1.3373) acc_x 71.8750 (65.5000) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [30/39] time 0.444 (0.470) data 0.311 (0.339) loss_x loss_x 1.3164 (1.3075) acc_x 65.6250 (65.5208) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [35/39] time 0.465 (0.466) data 0.333 (0.335) loss_x loss_x 1.5020 (1.3171) acc_x 59.3750 (65.0000) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1581
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1251
clean true:1220
clean false:31
clean_rate:0.9752198241406874
noisy true:335
noisy false:1550
after delete: len(clean_dataset) 1251
after delete: len(noisy_dataset) 1885
epoch [79/200] batch [5/39] time 0.604 (0.520) data 0.473 (0.389) loss_x loss_x 1.4932 (1.3255) acc_x 65.6250 (66.8750) lr 1.3535e-03 eta 0:00:17
epoch [79/200] batch [10/39] time 0.443 (0.477) data 0.312 (0.346) loss_x loss_x 1.8105 (1.3786) acc_x 59.3750 (66.8750) lr 1.3535e-03 eta 0:00:13
epoch [79/200] batch [15/39] time 0.476 (0.466) data 0.346 (0.335) loss_x loss_x 1.2432 (1.3518) acc_x 68.7500 (66.6667) lr 1.3535e-03 eta 0:00:11
epoch [79/200] batch [20/39] time 0.411 (0.460) data 0.280 (0.329) loss_x loss_x 1.2705 (1.3299) acc_x 65.6250 (66.5625) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [25/39] time 0.594 (0.470) data 0.463 (0.339) loss_x loss_x 0.9258 (1.3028) acc_x 75.0000 (67.7500) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [30/39] time 0.392 (0.463) data 0.261 (0.332) loss_x loss_x 1.4023 (1.2974) acc_x 68.7500 (67.8125) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [35/39] time 0.394 (0.456) data 0.262 (0.325) loss_x loss_x 1.7559 (1.3115) acc_x 59.3750 (67.5893) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1209
clean true:1177
clean false:32
clean_rate:0.9735318444995864
noisy true:336
noisy false:1591
after delete: len(clean_dataset) 1209
after delete: len(noisy_dataset) 1927
epoch [80/200] batch [5/37] time 0.447 (0.466) data 0.316 (0.335) loss_x loss_x 0.9414 (1.2576) acc_x 84.3750 (68.7500) lr 1.3387e-03 eta 0:00:14
epoch [80/200] batch [10/37] time 0.441 (0.469) data 0.310 (0.338) loss_x loss_x 1.3633 (1.2720) acc_x 65.6250 (68.4375) lr 1.3387e-03 eta 0:00:12
epoch [80/200] batch [15/37] time 0.458 (0.474) data 0.327 (0.343) loss_x loss_x 1.7852 (1.2976) acc_x 43.7500 (67.2917) lr 1.3387e-03 eta 0:00:10
epoch [80/200] batch [20/37] time 0.515 (0.468) data 0.383 (0.337) loss_x loss_x 1.2100 (1.3104) acc_x 68.7500 (66.5625) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [25/37] time 0.443 (0.461) data 0.313 (0.330) loss_x loss_x 1.0742 (1.2970) acc_x 75.0000 (67.1250) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [30/37] time 0.389 (0.457) data 0.258 (0.326) loss_x loss_x 1.3125 (1.2712) acc_x 75.0000 (68.0208) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [35/37] time 0.482 (0.455) data 0.351 (0.324) loss_x loss_x 1.2949 (1.2590) acc_x 68.7500 (69.0179) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1605
confident_label rate tensor(0.3932, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1233
clean true:1201
clean false:32
clean_rate:0.9740470397404704
noisy true:330
noisy false:1573
after delete: len(clean_dataset) 1233
after delete: len(noisy_dataset) 1903
epoch [81/200] batch [5/38] time 0.422 (0.451) data 0.292 (0.320) loss_x loss_x 1.7666 (1.3004) acc_x 50.0000 (65.0000) lr 1.3239e-03 eta 0:00:14
epoch [81/200] batch [10/38] time 0.423 (0.441) data 0.293 (0.311) loss_x loss_x 1.3135 (1.3004) acc_x 65.6250 (67.1875) lr 1.3239e-03 eta 0:00:12
epoch [81/200] batch [15/38] time 0.399 (0.434) data 0.269 (0.303) loss_x loss_x 0.9409 (1.2274) acc_x 81.2500 (67.7083) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [20/38] time 0.552 (0.448) data 0.422 (0.318) loss_x loss_x 1.1748 (1.2463) acc_x 75.0000 (67.9688) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [25/38] time 0.471 (0.457) data 0.341 (0.327) loss_x loss_x 1.5352 (1.2667) acc_x 65.6250 (67.6250) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [30/38] time 0.454 (0.460) data 0.324 (0.329) loss_x loss_x 1.4590 (1.2748) acc_x 59.3750 (67.9167) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [35/38] time 0.519 (0.459) data 0.388 (0.328) loss_x loss_x 1.4395 (1.2931) acc_x 59.3750 (67.4107) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1600
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1213
clean false:37
clean_rate:0.9704
noisy true:323
noisy false:1563
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [82/200] batch [5/39] time 0.533 (0.428) data 0.403 (0.298) loss_x loss_x 1.1807 (1.1134) acc_x 59.3750 (66.2500) lr 1.3090e-03 eta 0:00:14
epoch [82/200] batch [10/39] time 0.349 (0.428) data 0.219 (0.297) loss_x loss_x 1.9375 (1.2988) acc_x 59.3750 (65.0000) lr 1.3090e-03 eta 0:00:12
epoch [82/200] batch [15/39] time 0.397 (0.435) data 0.266 (0.304) loss_x loss_x 0.9785 (1.2972) acc_x 78.1250 (66.8750) lr 1.3090e-03 eta 0:00:10
epoch [82/200] batch [20/39] time 0.676 (0.445) data 0.546 (0.314) loss_x loss_x 1.7627 (1.2766) acc_x 62.5000 (67.8125) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [25/39] time 0.374 (0.452) data 0.244 (0.322) loss_x loss_x 1.4951 (1.2706) acc_x 56.2500 (67.2500) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [30/39] time 0.513 (0.453) data 0.382 (0.323) loss_x loss_x 1.1719 (1.2742) acc_x 71.8750 (66.7708) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [35/39] time 0.488 (0.453) data 0.357 (0.322) loss_x loss_x 1.3584 (1.2716) acc_x 62.5000 (66.8750) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.3913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1227
clean true:1191
clean false:36
clean_rate:0.9706601466992665
noisy true:337
noisy false:1572
after delete: len(clean_dataset) 1227
after delete: len(noisy_dataset) 1909
epoch [83/200] batch [5/38] time 0.479 (0.470) data 0.348 (0.340) loss_x loss_x 1.2334 (1.1474) acc_x 65.6250 (71.2500) lr 1.2940e-03 eta 0:00:15
epoch [83/200] batch [10/38] time 0.520 (0.492) data 0.390 (0.362) loss_x loss_x 1.1973 (1.3741) acc_x 65.6250 (65.3125) lr 1.2940e-03 eta 0:00:13
epoch [83/200] batch [15/38] time 0.445 (0.485) data 0.314 (0.354) loss_x loss_x 1.3057 (1.3389) acc_x 68.7500 (65.6250) lr 1.2940e-03 eta 0:00:11
epoch [83/200] batch [20/38] time 0.420 (0.474) data 0.290 (0.343) loss_x loss_x 2.2207 (1.3761) acc_x 50.0000 (64.3750) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [25/38] time 0.396 (0.476) data 0.264 (0.345) loss_x loss_x 1.3027 (1.3719) acc_x 71.8750 (65.2500) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [30/38] time 0.389 (0.474) data 0.258 (0.343) loss_x loss_x 1.2080 (1.3648) acc_x 65.6250 (65.5208) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [35/38] time 0.415 (0.469) data 0.285 (0.338) loss_x loss_x 1.0986 (1.3798) acc_x 75.0000 (64.8214) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3957, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1241
clean true:1204
clean false:37
clean_rate:0.9701853344077357
noisy true:330
noisy false:1565
after delete: len(clean_dataset) 1241
after delete: len(noisy_dataset) 1895
epoch [84/200] batch [5/38] time 0.474 (0.491) data 0.343 (0.359) loss_x loss_x 1.3662 (1.4084) acc_x 65.6250 (63.7500) lr 1.2790e-03 eta 0:00:16
epoch [84/200] batch [10/38] time 0.433 (0.468) data 0.302 (0.337) loss_x loss_x 0.9595 (1.2439) acc_x 75.0000 (66.8750) lr 1.2790e-03 eta 0:00:13
epoch [84/200] batch [15/38] time 0.545 (0.472) data 0.414 (0.341) loss_x loss_x 1.5156 (1.2614) acc_x 65.6250 (66.2500) lr 1.2790e-03 eta 0:00:10
epoch [84/200] batch [20/38] time 0.355 (0.471) data 0.225 (0.340) loss_x loss_x 1.6006 (1.2611) acc_x 59.3750 (66.4062) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [25/38] time 0.495 (0.466) data 0.365 (0.335) loss_x loss_x 1.4727 (1.3070) acc_x 62.5000 (66.0000) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [30/38] time 0.371 (0.458) data 0.241 (0.327) loss_x loss_x 1.1982 (1.3123) acc_x 71.8750 (66.0417) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [35/38] time 0.381 (0.457) data 0.250 (0.326) loss_x loss_x 1.5811 (1.3158) acc_x 62.5000 (66.6071) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.3916, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1228
clean true:1197
clean false:31
clean_rate:0.9747557003257329
noisy true:329
noisy false:1579
after delete: len(clean_dataset) 1228
after delete: len(noisy_dataset) 1908
epoch [85/200] batch [5/38] time 0.506 (0.442) data 0.374 (0.310) loss_x loss_x 1.0693 (1.2721) acc_x 68.7500 (65.0000) lr 1.2639e-03 eta 0:00:14
epoch [85/200] batch [10/38] time 0.411 (0.473) data 0.280 (0.342) loss_x loss_x 1.8594 (1.3219) acc_x 62.5000 (66.8750) lr 1.2639e-03 eta 0:00:13
epoch [85/200] batch [15/38] time 0.398 (0.457) data 0.267 (0.326) loss_x loss_x 1.2168 (1.3492) acc_x 81.2500 (66.8750) lr 1.2639e-03 eta 0:00:10
epoch [85/200] batch [20/38] time 0.409 (0.466) data 0.277 (0.335) loss_x loss_x 1.1621 (1.2596) acc_x 68.7500 (69.0625) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [25/38] time 0.440 (0.468) data 0.308 (0.337) loss_x loss_x 1.4590 (1.2714) acc_x 68.7500 (68.5000) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [30/38] time 0.407 (0.472) data 0.276 (0.341) loss_x loss_x 1.5840 (1.2831) acc_x 59.3750 (67.8125) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [35/38] time 0.464 (0.470) data 0.333 (0.339) loss_x loss_x 1.1084 (1.2578) acc_x 68.7500 (68.3929) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1587
confident_label rate tensor(0.3980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1248
clean true:1211
clean false:37
clean_rate:0.9703525641025641
noisy true:338
noisy false:1550
after delete: len(clean_dataset) 1248
after delete: len(noisy_dataset) 1888
epoch [86/200] batch [5/39] time 0.591 (0.488) data 0.460 (0.358) loss_x loss_x 1.3066 (1.1920) acc_x 68.7500 (68.7500) lr 1.2487e-03 eta 0:00:16
epoch [86/200] batch [10/39] time 0.424 (0.477) data 0.293 (0.346) loss_x loss_x 1.1797 (1.2570) acc_x 71.8750 (66.5625) lr 1.2487e-03 eta 0:00:13
epoch [86/200] batch [15/39] time 0.511 (0.458) data 0.381 (0.327) loss_x loss_x 1.5586 (1.2410) acc_x 56.2500 (66.8750) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [20/39] time 0.450 (0.456) data 0.319 (0.325) loss_x loss_x 1.1035 (1.2664) acc_x 75.0000 (67.9688) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [25/39] time 0.530 (0.470) data 0.399 (0.339) loss_x loss_x 1.5352 (1.2666) acc_x 62.5000 (68.2500) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [30/39] time 0.451 (0.468) data 0.320 (0.337) loss_x loss_x 1.7695 (1.2792) acc_x 59.3750 (68.1250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [35/39] time 0.420 (0.467) data 0.288 (0.336) loss_x loss_x 1.3623 (1.3057) acc_x 65.6250 (67.8571) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1574
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1249
clean true:1216
clean false:33
clean_rate:0.9735788630904724
noisy true:346
noisy false:1541
after delete: len(clean_dataset) 1249
after delete: len(noisy_dataset) 1887
epoch [87/200] batch [5/39] time 0.446 (0.453) data 0.316 (0.322) loss_x loss_x 1.7412 (1.1671) acc_x 53.1250 (71.8750) lr 1.2334e-03 eta 0:00:15
epoch [87/200] batch [10/39] time 0.497 (0.448) data 0.366 (0.317) loss_x loss_x 1.0645 (1.1500) acc_x 75.0000 (70.9375) lr 1.2334e-03 eta 0:00:12
epoch [87/200] batch [15/39] time 0.416 (0.437) data 0.286 (0.306) loss_x loss_x 1.4199 (1.2336) acc_x 62.5000 (67.9167) lr 1.2334e-03 eta 0:00:10
epoch [87/200] batch [20/39] time 0.494 (0.447) data 0.362 (0.317) loss_x loss_x 1.4697 (1.2430) acc_x 71.8750 (67.8125) lr 1.2334e-03 eta 0:00:08
epoch [87/200] batch [25/39] time 0.622 (0.464) data 0.491 (0.333) loss_x loss_x 1.4570 (1.2563) acc_x 56.2500 (66.7500) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [30/39] time 0.487 (0.468) data 0.355 (0.337) loss_x loss_x 0.9663 (1.2585) acc_x 71.8750 (66.5625) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [35/39] time 0.440 (0.475) data 0.310 (0.344) loss_x loss_x 1.3438 (1.2689) acc_x 68.7500 (66.9643) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1275
clean true:1236
clean false:39
clean_rate:0.9694117647058823
noisy true:333
noisy false:1528
after delete: len(clean_dataset) 1275
after delete: len(noisy_dataset) 1861
epoch [88/200] batch [5/39] time 0.404 (0.438) data 0.274 (0.307) loss_x loss_x 0.9746 (1.2355) acc_x 71.8750 (73.7500) lr 1.2181e-03 eta 0:00:14
epoch [88/200] batch [10/39] time 0.475 (0.453) data 0.345 (0.323) loss_x loss_x 0.5015 (1.1438) acc_x 84.3750 (73.1250) lr 1.2181e-03 eta 0:00:13
epoch [88/200] batch [15/39] time 0.408 (0.448) data 0.277 (0.317) loss_x loss_x 1.0137 (1.1794) acc_x 78.1250 (72.5000) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [20/39] time 0.468 (0.450) data 0.338 (0.319) loss_x loss_x 1.5010 (1.2548) acc_x 59.3750 (69.5312) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [25/39] time 0.551 (0.455) data 0.420 (0.324) loss_x loss_x 1.1221 (1.2429) acc_x 71.8750 (69.2500) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [30/39] time 0.323 (0.459) data 0.192 (0.328) loss_x loss_x 0.9551 (1.2237) acc_x 84.3750 (69.6875) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [35/39] time 0.344 (0.456) data 0.214 (0.325) loss_x loss_x 0.9258 (1.2309) acc_x 71.8750 (69.2857) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1609
confident_label rate tensor(0.3935, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1234
clean true:1199
clean false:35
clean_rate:0.9716369529983793
noisy true:328
noisy false:1574
after delete: len(clean_dataset) 1234
after delete: len(noisy_dataset) 1902
epoch [89/200] batch [5/38] time 0.561 (0.448) data 0.430 (0.317) loss_x loss_x 0.7202 (1.3962) acc_x 81.2500 (66.2500) lr 1.2028e-03 eta 0:00:14
epoch [89/200] batch [10/38] time 0.507 (0.448) data 0.377 (0.317) loss_x loss_x 1.0342 (1.4277) acc_x 71.8750 (65.0000) lr 1.2028e-03 eta 0:00:12
epoch [89/200] batch [15/38] time 0.522 (0.446) data 0.392 (0.315) loss_x loss_x 0.9106 (1.3195) acc_x 81.2500 (67.7083) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [20/38] time 0.426 (0.452) data 0.295 (0.321) loss_x loss_x 1.2031 (1.3528) acc_x 75.0000 (67.0312) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [25/38] time 0.469 (0.453) data 0.338 (0.322) loss_x loss_x 1.0264 (1.2858) acc_x 65.6250 (68.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [30/38] time 0.334 (0.455) data 0.203 (0.324) loss_x loss_x 0.9956 (1.2779) acc_x 81.2500 (68.9583) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [35/38] time 0.422 (0.459) data 0.292 (0.329) loss_x loss_x 1.2949 (1.3090) acc_x 68.7500 (68.3036) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1559
confident_label rate tensor(0.3970, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1245
clean true:1217
clean false:28
clean_rate:0.9775100401606426
noisy true:360
noisy false:1531
after delete: len(clean_dataset) 1245
after delete: len(noisy_dataset) 1891
epoch [90/200] batch [5/38] time 0.430 (0.425) data 0.300 (0.294) loss_x loss_x 1.4951 (1.2488) acc_x 62.5000 (65.6250) lr 1.1874e-03 eta 0:00:14
epoch [90/200] batch [10/38] time 0.391 (0.414) data 0.260 (0.284) loss_x loss_x 1.3125 (1.2620) acc_x 75.0000 (69.0625) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [15/38] time 0.454 (0.423) data 0.323 (0.292) loss_x loss_x 1.2080 (1.2851) acc_x 75.0000 (68.3333) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [20/38] time 0.453 (0.445) data 0.323 (0.314) loss_x loss_x 0.8794 (1.2394) acc_x 75.0000 (68.5938) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [25/38] time 0.520 (0.444) data 0.389 (0.313) loss_x loss_x 1.4854 (1.2747) acc_x 62.5000 (66.7500) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [30/38] time 0.362 (0.441) data 0.231 (0.310) loss_x loss_x 1.4424 (1.3062) acc_x 68.7500 (66.2500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [35/38] time 0.426 (0.439) data 0.295 (0.308) loss_x loss_x 1.4717 (1.2954) acc_x 56.2500 (66.6964) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1575
confident_label rate tensor(0.3986, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1250
clean true:1212
clean false:38
clean_rate:0.9696
noisy true:349
noisy false:1537
after delete: len(clean_dataset) 1250
after delete: len(noisy_dataset) 1886
epoch [91/200] batch [5/39] time 0.594 (0.524) data 0.463 (0.394) loss_x loss_x 0.5908 (1.1905) acc_x 81.2500 (66.8750) lr 1.1719e-03 eta 0:00:17
epoch [91/200] batch [10/39] time 0.537 (0.517) data 0.405 (0.386) loss_x loss_x 1.2529 (1.1656) acc_x 71.8750 (70.9375) lr 1.1719e-03 eta 0:00:14
epoch [91/200] batch [15/39] time 0.566 (0.502) data 0.435 (0.372) loss_x loss_x 1.1729 (1.1910) acc_x 65.6250 (70.6250) lr 1.1719e-03 eta 0:00:12
epoch [91/200] batch [20/39] time 0.447 (0.494) data 0.315 (0.363) loss_x loss_x 1.4502 (1.2305) acc_x 65.6250 (68.7500) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [25/39] time 0.444 (0.494) data 0.314 (0.363) loss_x loss_x 1.2539 (1.2651) acc_x 71.8750 (67.8750) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [30/39] time 0.564 (0.495) data 0.432 (0.364) loss_x loss_x 1.9561 (1.3044) acc_x 53.1250 (66.5625) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [35/39] time 0.350 (0.485) data 0.220 (0.354) loss_x loss_x 1.5752 (1.3037) acc_x 50.0000 (66.3393) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.4011, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1258
clean true:1222
clean false:36
clean_rate:0.9713831478537361
noisy true:328
noisy false:1550
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 1878
epoch [92/200] batch [5/39] time 0.423 (0.461) data 0.292 (0.330) loss_x loss_x 0.9180 (1.2688) acc_x 81.2500 (72.5000) lr 1.1564e-03 eta 0:00:15
epoch [92/200] batch [10/39] time 0.401 (0.444) data 0.269 (0.313) loss_x loss_x 1.7412 (1.2705) acc_x 71.8750 (70.6250) lr 1.1564e-03 eta 0:00:12
epoch [92/200] batch [15/39] time 0.475 (0.436) data 0.344 (0.305) loss_x loss_x 1.8779 (1.2846) acc_x 59.3750 (69.3750) lr 1.1564e-03 eta 0:00:10
epoch [92/200] batch [20/39] time 0.730 (0.466) data 0.598 (0.335) loss_x loss_x 0.8813 (1.2641) acc_x 75.0000 (69.3750) lr 1.1564e-03 eta 0:00:08
epoch [92/200] batch [25/39] time 0.444 (0.458) data 0.313 (0.327) loss_x loss_x 1.3340 (1.2676) acc_x 56.2500 (68.6250) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [30/39] time 0.433 (0.462) data 0.303 (0.331) loss_x loss_x 1.5771 (1.2816) acc_x 59.3750 (67.8125) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [35/39] time 0.521 (0.468) data 0.389 (0.337) loss_x loss_x 1.4561 (1.2680) acc_x 62.5000 (67.7679) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1598
confident_label rate tensor(0.3893, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1221
clean true:1193
clean false:28
clean_rate:0.9770679770679771
noisy true:345
noisy false:1570
after delete: len(clean_dataset) 1221
after delete: len(noisy_dataset) 1915
epoch [93/200] batch [5/38] time 0.671 (0.512) data 0.539 (0.381) loss_x loss_x 1.4053 (1.2965) acc_x 62.5000 (64.3750) lr 1.1409e-03 eta 0:00:16
epoch [93/200] batch [10/38] time 0.416 (0.489) data 0.285 (0.358) loss_x loss_x 1.3418 (1.3938) acc_x 71.8750 (65.0000) lr 1.1409e-03 eta 0:00:13
epoch [93/200] batch [15/38] time 0.429 (0.493) data 0.299 (0.361) loss_x loss_x 1.5107 (1.3689) acc_x 65.6250 (64.3750) lr 1.1409e-03 eta 0:00:11
epoch [93/200] batch [20/38] time 0.420 (0.480) data 0.289 (0.349) loss_x loss_x 1.5332 (1.3607) acc_x 65.6250 (65.1562) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [25/38] time 0.459 (0.475) data 0.327 (0.344) loss_x loss_x 1.5137 (1.3527) acc_x 56.2500 (65.2500) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [30/38] time 0.546 (0.471) data 0.416 (0.340) loss_x loss_x 1.1895 (1.3555) acc_x 71.8750 (65.1042) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [35/38] time 0.496 (0.468) data 0.365 (0.337) loss_x loss_x 1.0020 (1.3203) acc_x 78.1250 (66.0714) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.4002, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1255
clean true:1223
clean false:32
clean_rate:0.9745019920318725
noisy true:333
noisy false:1548
after delete: len(clean_dataset) 1255
after delete: len(noisy_dataset) 1881
epoch [94/200] batch [5/39] time 0.478 (0.452) data 0.347 (0.321) loss_x loss_x 1.1045 (1.2536) acc_x 68.7500 (68.1250) lr 1.1253e-03 eta 0:00:15
epoch [94/200] batch [10/39] time 0.423 (0.440) data 0.293 (0.309) loss_x loss_x 0.8994 (1.2498) acc_x 78.1250 (70.6250) lr 1.1253e-03 eta 0:00:12
epoch [94/200] batch [15/39] time 0.359 (0.442) data 0.228 (0.311) loss_x loss_x 1.3438 (1.3746) acc_x 68.7500 (67.0833) lr 1.1253e-03 eta 0:00:10
epoch [94/200] batch [20/39] time 0.526 (0.451) data 0.395 (0.321) loss_x loss_x 1.2412 (1.3525) acc_x 68.7500 (67.6562) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [25/39] time 0.620 (0.459) data 0.490 (0.328) loss_x loss_x 1.5312 (1.3601) acc_x 53.1250 (67.1250) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [30/39] time 0.467 (0.455) data 0.336 (0.324) loss_x loss_x 1.1895 (1.3567) acc_x 75.0000 (67.3958) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [35/39] time 0.513 (0.456) data 0.383 (0.325) loss_x loss_x 1.1348 (1.3137) acc_x 68.7500 (67.7679) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1588
confident_label rate tensor(0.4011, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1258
clean true:1215
clean false:43
clean_rate:0.965818759936407
noisy true:333
noisy false:1545
after delete: len(clean_dataset) 1258
after delete: len(noisy_dataset) 1878
epoch [95/200] batch [5/39] time 0.449 (0.458) data 0.318 (0.326) loss_x loss_x 1.5215 (1.2293) acc_x 68.7500 (68.7500) lr 1.1097e-03 eta 0:00:15
epoch [95/200] batch [10/39] time 0.527 (0.496) data 0.396 (0.365) loss_x loss_x 1.2451 (1.2278) acc_x 62.5000 (68.7500) lr 1.1097e-03 eta 0:00:14
epoch [95/200] batch [15/39] time 0.412 (0.458) data 0.281 (0.327) loss_x loss_x 1.1357 (1.2773) acc_x 71.8750 (68.5417) lr 1.1097e-03 eta 0:00:10
epoch [95/200] batch [20/39] time 0.423 (0.450) data 0.291 (0.319) loss_x loss_x 0.9077 (1.2580) acc_x 71.8750 (68.9062) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [25/39] time 0.545 (0.457) data 0.414 (0.326) loss_x loss_x 1.3184 (1.2578) acc_x 59.3750 (68.5000) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [30/39] time 0.446 (0.473) data 0.315 (0.342) loss_x loss_x 1.8428 (1.2721) acc_x 53.1250 (67.9167) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [35/39] time 0.445 (0.473) data 0.314 (0.342) loss_x loss_x 1.5137 (1.2962) acc_x 59.3750 (67.0536) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1552
confident_label rate tensor(0.4107, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1288
clean true:1253
clean false:35
clean_rate:0.9728260869565217
noisy true:331
noisy false:1517
after delete: len(clean_dataset) 1288
after delete: len(noisy_dataset) 1848
epoch [96/200] batch [5/40] time 0.419 (0.500) data 0.288 (0.369) loss_x loss_x 1.2109 (1.4420) acc_x 68.7500 (64.3750) lr 1.0941e-03 eta 0:00:17
epoch [96/200] batch [10/40] time 0.407 (0.458) data 0.276 (0.327) loss_x loss_x 1.3330 (1.4370) acc_x 68.7500 (65.0000) lr 1.0941e-03 eta 0:00:13
epoch [96/200] batch [15/40] time 0.383 (0.447) data 0.252 (0.315) loss_x loss_x 1.6035 (1.4383) acc_x 62.5000 (65.0000) lr 1.0941e-03 eta 0:00:11
epoch [96/200] batch [20/40] time 0.462 (0.465) data 0.332 (0.333) loss_x loss_x 1.1914 (1.3728) acc_x 65.6250 (65.7812) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [25/40] time 0.402 (0.459) data 0.271 (0.328) loss_x loss_x 0.9795 (1.3332) acc_x 71.8750 (66.7500) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [30/40] time 0.438 (0.463) data 0.307 (0.332) loss_x loss_x 1.6416 (1.3065) acc_x 62.5000 (67.3958) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [35/40] time 0.394 (0.460) data 0.263 (0.329) loss_x loss_x 1.4268 (1.3363) acc_x 59.3750 (66.6964) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [40/40] time 0.372 (0.457) data 0.242 (0.326) loss_x loss_x 1.2988 (1.3162) acc_x 62.5000 (66.9531) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1595
confident_label rate tensor(0.3945, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1237
clean true:1202
clean false:35
clean_rate:0.9717057396928052
noisy true:339
noisy false:1560
after delete: len(clean_dataset) 1237
after delete: len(noisy_dataset) 1899
epoch [97/200] batch [5/38] time 0.425 (0.477) data 0.294 (0.346) loss_x loss_x 1.3398 (1.4242) acc_x 65.6250 (64.3750) lr 1.0785e-03 eta 0:00:15
epoch [97/200] batch [10/38] time 0.424 (0.469) data 0.293 (0.338) loss_x loss_x 1.6182 (1.3339) acc_x 56.2500 (65.9375) lr 1.0785e-03 eta 0:00:13
epoch [97/200] batch [15/38] time 0.458 (0.491) data 0.327 (0.360) loss_x loss_x 0.9961 (1.3333) acc_x 78.1250 (66.2500) lr 1.0785e-03 eta 0:00:11
epoch [97/200] batch [20/38] time 0.504 (0.499) data 0.373 (0.368) loss_x loss_x 1.2939 (1.3169) acc_x 65.6250 (66.5625) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [25/38] time 0.483 (0.499) data 0.353 (0.368) loss_x loss_x 1.4014 (1.3260) acc_x 62.5000 (66.0000) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [30/38] time 0.482 (0.494) data 0.351 (0.363) loss_x loss_x 1.5000 (1.2916) acc_x 62.5000 (67.0833) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [35/38] time 0.342 (0.483) data 0.210 (0.352) loss_x loss_x 1.0820 (1.2972) acc_x 75.0000 (67.4107) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1569
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1251
clean true:1216
clean false:35
clean_rate:0.9720223820943246
noisy true:351
noisy false:1534
after delete: len(clean_dataset) 1251
after delete: len(noisy_dataset) 1885
epoch [98/200] batch [5/39] time 0.418 (0.475) data 0.287 (0.344) loss_x loss_x 1.1416 (1.1594) acc_x 65.6250 (68.1250) lr 1.0628e-03 eta 0:00:16
epoch [98/200] batch [10/39] time 0.453 (0.480) data 0.322 (0.349) loss_x loss_x 1.6719 (1.1940) acc_x 71.8750 (69.6875) lr 1.0628e-03 eta 0:00:13
epoch [98/200] batch [15/39] time 0.448 (0.461) data 0.317 (0.330) loss_x loss_x 0.9800 (1.2197) acc_x 78.1250 (68.5417) lr 1.0628e-03 eta 0:00:11
epoch [98/200] batch [20/39] time 0.486 (0.461) data 0.356 (0.330) loss_x loss_x 2.0332 (1.2555) acc_x 56.2500 (67.5000) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [25/39] time 0.471 (0.462) data 0.340 (0.331) loss_x loss_x 1.2373 (1.2084) acc_x 68.7500 (68.5000) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [30/39] time 0.399 (0.478) data 0.268 (0.347) loss_x loss_x 0.5591 (1.1840) acc_x 84.3750 (69.5833) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [35/39] time 0.470 (0.476) data 0.338 (0.345) loss_x loss_x 1.4727 (1.2198) acc_x 56.2500 (68.2143) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1565
confident_label rate tensor(0.4037, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1266
clean true:1231
clean false:35
clean_rate:0.9723538704581358
noisy true:340
noisy false:1530
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 1870
epoch [99/200] batch [5/39] time 0.459 (0.500) data 0.327 (0.369) loss_x loss_x 1.4111 (1.3143) acc_x 62.5000 (65.0000) lr 1.0471e-03 eta 0:00:16
epoch [99/200] batch [10/39] time 0.441 (0.475) data 0.311 (0.344) loss_x loss_x 1.4688 (1.3270) acc_x 68.7500 (67.1875) lr 1.0471e-03 eta 0:00:13
epoch [99/200] batch [15/39] time 0.455 (0.466) data 0.324 (0.335) loss_x loss_x 1.5400 (1.3360) acc_x 59.3750 (65.6250) lr 1.0471e-03 eta 0:00:11
epoch [99/200] batch [20/39] time 0.448 (0.474) data 0.318 (0.343) loss_x loss_x 1.5000 (1.2876) acc_x 65.6250 (66.5625) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [25/39] time 0.421 (0.466) data 0.290 (0.336) loss_x loss_x 0.8818 (1.2808) acc_x 81.2500 (67.1250) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [30/39] time 0.540 (0.476) data 0.408 (0.345) loss_x loss_x 1.5830 (1.2897) acc_x 75.0000 (67.3958) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [35/39] time 0.440 (0.472) data 0.310 (0.341) loss_x loss_x 1.0391 (1.2747) acc_x 71.8750 (66.6964) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1583
confident_label rate tensor(0.3976, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1247
clean true:1215
clean false:32
clean_rate:0.9743384121892542
noisy true:338
noisy false:1551
all clean rate:  [0.9470198675496688, 0.9625585023400937, 0.9797525309336333, 0.9738493723849372, 0.9649298597194389, 0.9663951120162932, 0.9740777666999003, 0.9783037475345168, 0.9727891156462585, 0.970617042115573, 0.9715909090909091, 0.9692011549566891, 0.976145038167939, 0.9683131407269339, 0.975925925925926, 0.9714285714285714, 0.9732472324723247, 0.97340930674264, 0.9729468599033816, 0.9726156751652503, 0.9778393351800554, 0.9741131351869607, 0.9783631232361242, 0.9715048975957258, 0.9664429530201343, 0.9722735674676525, 0.971996386630533, 0.9708480565371025, 0.9759926131117267, 0.9729020979020979, 0.9753199268738574, 0.9773960216998192, 0.9706896551724138, 0.967391304347826, 0.973172987974098, 0.9807339449541285, 0.9829136690647482, 0.9762949956101844, 0.9733333333333334, 0.9655172413793104, 0.9765013054830287, 0.9691780821917808, 0.971954425942156, 0.9705882352941176, 0.9702886247877759, 0.9763986013986014, 0.9676320272572402, 0.9681133746678476, 0.9694055944055944, 0.9695652173913043, 0.96877710320902, 0.9750415973377704, 0.97883149872989, 0.9719864176570459, 0.9775668679896462, 0.9756507136859782, 0.9688041594454073, 0.9752066115702479, 0.9734660033167496, 0.9706896551724138, 0.9703832752613241, 0.9798488664987406, 0.9785478547854786, 0.9714285714285714, 0.9743801652892562, 0.9645214521452146, 0.9721082854799016, 0.9812550937245313, 0.9715678310316815, 0.9752475247524752, 0.9703459637561779, 0.9754299754299754, 0.9755501222493888, 0.9727126805778491, 0.974485596707819, 0.9692805173807599, 0.9699604743083003, 0.9728651237031125, 0.9752198241406874, 0.9735318444995864, 0.9740470397404704, 0.9704, 0.9706601466992665, 0.9701853344077357, 0.9747557003257329, 0.9703525641025641, 0.9735788630904724, 0.9694117647058823, 0.9716369529983793, 0.9775100401606426, 0.9696, 0.9713831478537361, 0.9770679770679771, 0.9745019920318725, 0.965818759936407, 0.9728260869565217, 0.9717057396928052, 0.9720223820943246, 0.9723538704581358, 0.9743384121892542]
after delete: len(clean_dataset) 1247
after delete: len(noisy_dataset) 1889
epoch [100/200] batch [5/38] time 0.470 (0.442) data 0.340 (0.311) loss_x loss_x 1.1699 (0.9408) acc_x 75.0000 (77.5000) lr 1.0314e-03 eta 0:00:14
epoch [100/200] batch [10/38] time 0.430 (0.428) data 0.298 (0.297) loss_x loss_x 1.3896 (1.1123) acc_x 68.7500 (74.3750) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [15/38] time 0.382 (0.432) data 0.251 (0.301) loss_x loss_x 1.0762 (1.1615) acc_x 65.6250 (71.6667) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [20/38] time 0.361 (0.442) data 0.230 (0.311) loss_x loss_x 1.0400 (1.2383) acc_x 71.8750 (69.3750) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [25/38] time 0.581 (0.445) data 0.449 (0.314) loss_x loss_x 1.2109 (1.2259) acc_x 78.1250 (69.6250) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [30/38] time 0.484 (0.445) data 0.354 (0.314) loss_x loss_x 1.2441 (1.2271) acc_x 68.7500 (69.2708) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [35/38] time 0.421 (0.447) data 0.290 (0.316) loss_x loss_x 1.1357 (1.2586) acc_x 65.6250 (69.0179) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4133, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1296
clean true:1261
clean false:35
clean_rate:0.9729938271604939
noisy true:321
noisy false:1519
after delete: len(clean_dataset) 1296
after delete: len(noisy_dataset) 1840
epoch [101/200] batch [5/40] time 0.357 (0.473) data 0.227 (0.342) loss_x loss_x 0.8188 (1.1860) acc_x 81.2500 (68.7500) lr 1.0157e-03 eta 0:00:16
epoch [101/200] batch [10/40] time 0.427 (0.469) data 0.297 (0.339) loss_x loss_x 1.4658 (1.2349) acc_x 71.8750 (68.7500) lr 1.0157e-03 eta 0:00:14
epoch [101/200] batch [15/40] time 0.452 (0.473) data 0.322 (0.343) loss_x loss_x 1.3779 (1.3022) acc_x 68.7500 (67.2917) lr 1.0157e-03 eta 0:00:11
epoch [101/200] batch [20/40] time 0.424 (0.457) data 0.293 (0.326) loss_x loss_x 1.2910 (1.2926) acc_x 68.7500 (68.2812) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [25/40] time 0.575 (0.456) data 0.444 (0.325) loss_x loss_x 1.3213 (1.2804) acc_x 62.5000 (68.3750) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [30/40] time 0.377 (0.446) data 0.247 (0.315) loss_x loss_x 2.0215 (1.2881) acc_x 43.7500 (67.7083) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [35/40] time 0.472 (0.446) data 0.342 (0.316) loss_x loss_x 1.2109 (1.2772) acc_x 59.3750 (68.3036) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [40/40] time 0.346 (0.448) data 0.214 (0.318) loss_x loss_x 0.9248 (1.2830) acc_x 71.8750 (68.2031) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1579
confident_label rate tensor(0.3970, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1245
clean true:1210
clean false:35
clean_rate:0.9718875502008032
noisy true:347
noisy false:1544
after delete: len(clean_dataset) 1245
after delete: len(noisy_dataset) 1891
epoch [102/200] batch [5/38] time 0.352 (0.414) data 0.221 (0.283) loss_x loss_x 1.0420 (1.2109) acc_x 81.2500 (71.2500) lr 1.0000e-03 eta 0:00:13
epoch [102/200] batch [10/38] time 0.436 (0.442) data 0.306 (0.311) loss_x loss_x 1.1289 (1.1871) acc_x 71.8750 (70.9375) lr 1.0000e-03 eta 0:00:12
epoch [102/200] batch [15/38] time 0.368 (0.459) data 0.236 (0.328) loss_x loss_x 0.9829 (1.1355) acc_x 68.7500 (71.2500) lr 1.0000e-03 eta 0:00:10
epoch [102/200] batch [20/38] time 0.486 (0.462) data 0.355 (0.331) loss_x loss_x 1.0771 (1.2237) acc_x 68.7500 (69.3750) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [25/38] time 0.397 (0.460) data 0.266 (0.329) loss_x loss_x 1.5146 (1.2785) acc_x 62.5000 (68.2500) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [30/38] time 0.519 (0.467) data 0.388 (0.336) loss_x loss_x 0.8989 (1.2358) acc_x 68.7500 (68.6458) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [35/38] time 0.542 (0.473) data 0.411 (0.342) loss_x loss_x 1.1777 (1.2198) acc_x 68.7500 (68.5714) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1557
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1275
clean true:1240
clean false:35
clean_rate:0.9725490196078431
noisy true:339
noisy false:1522
after delete: len(clean_dataset) 1275
after delete: len(noisy_dataset) 1861
epoch [103/200] batch [5/39] time 0.472 (0.494) data 0.342 (0.363) loss_x loss_x 1.5010 (1.2831) acc_x 59.3750 (67.5000) lr 9.8429e-04 eta 0:00:16
epoch [103/200] batch [10/39] time 0.468 (0.466) data 0.337 (0.335) loss_x loss_x 1.1279 (1.2700) acc_x 81.2500 (68.1250) lr 9.8429e-04 eta 0:00:13
epoch [103/200] batch [15/39] time 0.450 (0.455) data 0.318 (0.324) loss_x loss_x 1.3545 (1.2762) acc_x 59.3750 (68.1250) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [20/39] time 0.452 (0.463) data 0.322 (0.332) loss_x loss_x 1.6260 (1.2808) acc_x 56.2500 (67.9688) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [25/39] time 0.423 (0.461) data 0.292 (0.330) loss_x loss_x 1.7715 (1.3280) acc_x 53.1250 (66.3750) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [30/39] time 0.438 (0.453) data 0.308 (0.323) loss_x loss_x 1.2861 (1.3188) acc_x 65.6250 (66.9792) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [35/39] time 0.484 (0.456) data 0.353 (0.325) loss_x loss_x 1.0400 (1.3161) acc_x 71.8750 (66.4286) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1278
clean true:1240
clean false:38
clean_rate:0.9702660406885759
noisy true:330
noisy false:1528
after delete: len(clean_dataset) 1278
after delete: len(noisy_dataset) 1858
epoch [104/200] batch [5/39] time 0.625 (0.498) data 0.495 (0.367) loss_x loss_x 0.8149 (1.3347) acc_x 75.0000 (63.7500) lr 9.6859e-04 eta 0:00:16
epoch [104/200] batch [10/39] time 0.421 (0.467) data 0.290 (0.336) loss_x loss_x 1.1426 (1.2471) acc_x 59.3750 (65.0000) lr 9.6859e-04 eta 0:00:13
epoch [104/200] batch [15/39] time 0.445 (0.497) data 0.314 (0.365) loss_x loss_x 1.1436 (1.2781) acc_x 56.2500 (65.4167) lr 9.6859e-04 eta 0:00:11
epoch [104/200] batch [20/39] time 0.400 (0.481) data 0.269 (0.350) loss_x loss_x 0.9575 (1.2494) acc_x 65.6250 (67.0312) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [25/39] time 0.518 (0.475) data 0.386 (0.344) loss_x loss_x 1.1016 (1.2547) acc_x 75.0000 (67.2500) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [30/39] time 0.443 (0.465) data 0.312 (0.334) loss_x loss_x 1.1475 (1.2425) acc_x 75.0000 (68.2292) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [35/39] time 0.393 (0.461) data 0.263 (0.330) loss_x loss_x 1.2607 (1.2396) acc_x 75.0000 (68.7500) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1545
confident_label rate tensor(0.4142, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1299
clean true:1259
clean false:40
clean_rate:0.9692070823710547
noisy true:332
noisy false:1505
after delete: len(clean_dataset) 1299
after delete: len(noisy_dataset) 1837
epoch [105/200] batch [5/40] time 0.479 (0.431) data 0.348 (0.299) loss_x loss_x 1.3379 (1.1434) acc_x 75.0000 (71.2500) lr 9.5289e-04 eta 0:00:15
epoch [105/200] batch [10/40] time 0.360 (0.432) data 0.230 (0.301) loss_x loss_x 1.7217 (1.2312) acc_x 59.3750 (70.0000) lr 9.5289e-04 eta 0:00:12
epoch [105/200] batch [15/40] time 0.709 (0.442) data 0.579 (0.312) loss_x loss_x 1.7568 (1.3132) acc_x 50.0000 (67.2917) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [20/40] time 0.528 (0.439) data 0.398 (0.308) loss_x loss_x 1.6748 (1.3860) acc_x 59.3750 (65.1562) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [25/40] time 0.638 (0.447) data 0.507 (0.316) loss_x loss_x 1.4053 (1.3534) acc_x 71.8750 (65.6250) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [30/40] time 0.487 (0.456) data 0.356 (0.326) loss_x loss_x 1.2734 (1.3269) acc_x 68.7500 (65.9375) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [35/40] time 0.474 (0.454) data 0.343 (0.324) loss_x loss_x 1.1270 (1.2787) acc_x 75.0000 (66.6071) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [40/40] time 0.331 (0.457) data 0.199 (0.327) loss_x loss_x 1.4932 (1.3069) acc_x 65.6250 (65.7812) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1538
confident_label rate tensor(0.4088, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1282
clean true:1247
clean false:35
clean_rate:0.9726989079563183
noisy true:351
noisy false:1503
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 1854
epoch [106/200] batch [5/40] time 0.456 (0.456) data 0.325 (0.325) loss_x loss_x 1.0996 (1.2621) acc_x 78.1250 (68.1250) lr 9.3721e-04 eta 0:00:15
epoch [106/200] batch [10/40] time 0.394 (0.464) data 0.263 (0.333) loss_x loss_x 0.8818 (1.2511) acc_x 71.8750 (67.5000) lr 9.3721e-04 eta 0:00:13
epoch [106/200] batch [15/40] time 0.406 (0.455) data 0.276 (0.324) loss_x loss_x 1.5811 (1.2327) acc_x 59.3750 (68.3333) lr 9.3721e-04 eta 0:00:11
epoch [106/200] batch [20/40] time 0.382 (0.449) data 0.251 (0.318) loss_x loss_x 1.5068 (1.2447) acc_x 71.8750 (68.4375) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [25/40] time 0.456 (0.448) data 0.325 (0.317) loss_x loss_x 1.3320 (1.2319) acc_x 68.7500 (68.7500) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [30/40] time 0.570 (0.449) data 0.439 (0.318) loss_x loss_x 1.1025 (1.2412) acc_x 71.8750 (68.6458) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [35/40] time 0.409 (0.446) data 0.278 (0.315) loss_x loss_x 1.2891 (1.2681) acc_x 75.0000 (67.9464) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [40/40] time 0.504 (0.456) data 0.374 (0.324) loss_x loss_x 1.2158 (1.2503) acc_x 71.8750 (68.3594) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1567
confident_label rate tensor(0.4027, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1263
clean true:1225
clean false:38
clean_rate:0.9699129057798892
noisy true:344
noisy false:1529
after delete: len(clean_dataset) 1263
after delete: len(noisy_dataset) 1873
epoch [107/200] batch [5/39] time 0.446 (0.486) data 0.315 (0.356) loss_x loss_x 1.4795 (1.1924) acc_x 65.6250 (69.3750) lr 9.2154e-04 eta 0:00:16
epoch [107/200] batch [10/39] time 0.444 (0.492) data 0.314 (0.361) loss_x loss_x 0.8301 (1.1526) acc_x 84.3750 (70.0000) lr 9.2154e-04 eta 0:00:14
epoch [107/200] batch [15/39] time 0.485 (0.476) data 0.354 (0.345) loss_x loss_x 1.1504 (1.1693) acc_x 71.8750 (70.0000) lr 9.2154e-04 eta 0:00:11
epoch [107/200] batch [20/39] time 0.379 (0.462) data 0.247 (0.331) loss_x loss_x 0.9731 (1.1462) acc_x 75.0000 (71.0938) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [25/39] time 0.507 (0.464) data 0.376 (0.333) loss_x loss_x 1.0801 (1.1820) acc_x 62.5000 (69.5000) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [30/39] time 0.358 (0.457) data 0.227 (0.326) loss_x loss_x 1.1602 (1.1833) acc_x 65.6250 (69.1667) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [35/39] time 0.525 (0.454) data 0.394 (0.323) loss_x loss_x 1.4600 (1.2023) acc_x 53.1250 (68.3929) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1569
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1269
clean true:1230
clean false:39
clean_rate:0.9692671394799054
noisy true:337
noisy false:1530
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 1867
epoch [108/200] batch [5/39] time 0.409 (0.462) data 0.277 (0.331) loss_x loss_x 1.0391 (1.0189) acc_x 75.0000 (73.7500) lr 9.0589e-04 eta 0:00:15
epoch [108/200] batch [10/39] time 0.411 (0.468) data 0.279 (0.337) loss_x loss_x 0.9248 (0.9917) acc_x 81.2500 (75.3125) lr 9.0589e-04 eta 0:00:13
epoch [108/200] batch [15/39] time 0.458 (0.462) data 0.329 (0.332) loss_x loss_x 0.7773 (1.0309) acc_x 84.3750 (73.5417) lr 9.0589e-04 eta 0:00:11
epoch [108/200] batch [20/39] time 0.438 (0.452) data 0.307 (0.321) loss_x loss_x 1.1436 (1.0502) acc_x 62.5000 (72.3438) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [25/39] time 0.532 (0.458) data 0.402 (0.328) loss_x loss_x 1.3838 (1.0962) acc_x 65.6250 (70.8750) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [30/39] time 0.437 (0.453) data 0.306 (0.323) loss_x loss_x 1.1807 (1.1193) acc_x 71.8750 (70.6250) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [35/39] time 0.419 (0.457) data 0.289 (0.326) loss_x loss_x 1.0732 (1.1172) acc_x 78.1250 (70.7143) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1546
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1280
clean true:1248
clean false:32
clean_rate:0.975
noisy true:342
noisy false:1514
after delete: len(clean_dataset) 1280
after delete: len(noisy_dataset) 1856
epoch [109/200] batch [5/40] time 0.520 (0.437) data 0.389 (0.306) loss_x loss_x 1.3369 (1.2804) acc_x 62.5000 (66.2500) lr 8.9027e-04 eta 0:00:15
epoch [109/200] batch [10/40] time 0.459 (0.442) data 0.329 (0.311) loss_x loss_x 0.9858 (1.2285) acc_x 75.0000 (67.1875) lr 8.9027e-04 eta 0:00:13
epoch [109/200] batch [15/40] time 0.614 (0.467) data 0.483 (0.336) loss_x loss_x 1.5225 (1.2451) acc_x 62.5000 (68.1250) lr 8.9027e-04 eta 0:00:11
epoch [109/200] batch [20/40] time 0.457 (0.466) data 0.326 (0.335) loss_x loss_x 1.2373 (1.2292) acc_x 68.7500 (69.0625) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [25/40] time 0.528 (0.458) data 0.397 (0.327) loss_x loss_x 1.8174 (1.2510) acc_x 56.2500 (67.6250) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [30/40] time 0.373 (0.465) data 0.243 (0.334) loss_x loss_x 0.9302 (1.2248) acc_x 62.5000 (68.2292) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [35/40] time 0.434 (0.464) data 0.303 (0.333) loss_x loss_x 1.3008 (1.2173) acc_x 65.6250 (68.1250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [40/40] time 0.431 (0.464) data 0.299 (0.333) loss_x loss_x 0.8979 (1.2217) acc_x 78.1250 (68.2031) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1269
clean true:1238
clean false:31
clean_rate:0.9755713159968479
noisy true:340
noisy false:1527
after delete: len(clean_dataset) 1269
after delete: len(noisy_dataset) 1867
epoch [110/200] batch [5/39] time 0.384 (0.448) data 0.254 (0.318) loss_x loss_x 1.4551 (1.2589) acc_x 59.3750 (68.7500) lr 8.7467e-04 eta 0:00:15
epoch [110/200] batch [10/39] time 0.436 (0.455) data 0.305 (0.324) loss_x loss_x 1.1631 (1.2164) acc_x 68.7500 (70.0000) lr 8.7467e-04 eta 0:00:13
epoch [110/200] batch [15/39] time 0.464 (0.461) data 0.334 (0.330) loss_x loss_x 1.0273 (1.2843) acc_x 78.1250 (68.9583) lr 8.7467e-04 eta 0:00:11
epoch [110/200] batch [20/39] time 0.489 (0.471) data 0.358 (0.340) loss_x loss_x 1.5381 (1.2819) acc_x 59.3750 (68.9062) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [25/39] time 0.467 (0.461) data 0.337 (0.330) loss_x loss_x 1.0176 (1.2834) acc_x 68.7500 (69.1250) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [30/39] time 0.436 (0.454) data 0.306 (0.324) loss_x loss_x 0.7559 (1.2792) acc_x 78.1250 (68.8542) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [35/39] time 0.549 (0.458) data 0.418 (0.327) loss_x loss_x 0.6890 (1.2866) acc_x 78.1250 (68.5714) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1521
confident_label rate tensor(0.4117, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1291
clean true:1266
clean false:25
clean_rate:0.9806351665375678
noisy true:349
noisy false:1496
after delete: len(clean_dataset) 1291
after delete: len(noisy_dataset) 1845
epoch [111/200] batch [5/40] time 0.410 (0.464) data 0.278 (0.333) loss_x loss_x 1.3330 (1.1823) acc_x 68.7500 (72.5000) lr 8.5910e-04 eta 0:00:16
epoch [111/200] batch [10/40] time 0.445 (0.455) data 0.314 (0.324) loss_x loss_x 1.1836 (1.1064) acc_x 65.6250 (73.7500) lr 8.5910e-04 eta 0:00:13
epoch [111/200] batch [15/40] time 0.576 (0.471) data 0.446 (0.340) loss_x loss_x 0.5640 (1.1462) acc_x 78.1250 (72.0833) lr 8.5910e-04 eta 0:00:11
epoch [111/200] batch [20/40] time 0.441 (0.464) data 0.309 (0.333) loss_x loss_x 1.0117 (1.1985) acc_x 68.7500 (69.5312) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [25/40] time 0.446 (0.469) data 0.315 (0.338) loss_x loss_x 1.1953 (1.2386) acc_x 71.8750 (69.2500) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [30/40] time 0.732 (0.481) data 0.601 (0.350) loss_x loss_x 1.4160 (1.2340) acc_x 59.3750 (69.1667) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [35/40] time 0.480 (0.483) data 0.349 (0.352) loss_x loss_x 1.1904 (1.2336) acc_x 62.5000 (68.6607) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [40/40] time 0.649 (0.487) data 0.518 (0.356) loss_x loss_x 1.0762 (1.2058) acc_x 71.8750 (69.1406) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.4101, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1286
clean true:1247
clean false:39
clean_rate:0.9696734059097978
noisy true:334
noisy false:1516
after delete: len(clean_dataset) 1286
after delete: len(noisy_dataset) 1850
epoch [112/200] batch [5/40] time 0.477 (0.422) data 0.346 (0.291) loss_x loss_x 0.9170 (1.3585) acc_x 78.1250 (66.8750) lr 8.4357e-04 eta 0:00:14
epoch [112/200] batch [10/40] time 0.403 (0.426) data 0.271 (0.294) loss_x loss_x 1.0459 (1.2331) acc_x 71.8750 (70.9375) lr 8.4357e-04 eta 0:00:12
epoch [112/200] batch [15/40] time 0.390 (0.439) data 0.260 (0.308) loss_x loss_x 1.5127 (1.2022) acc_x 71.8750 (71.0417) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [20/40] time 0.593 (0.456) data 0.462 (0.325) loss_x loss_x 1.1201 (1.2266) acc_x 71.8750 (70.1562) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [25/40] time 0.624 (0.459) data 0.494 (0.328) loss_x loss_x 1.5049 (1.2284) acc_x 59.3750 (69.2500) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [30/40] time 0.427 (0.454) data 0.297 (0.323) loss_x loss_x 1.4141 (1.2298) acc_x 65.6250 (68.6458) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [35/40] time 0.534 (0.458) data 0.404 (0.327) loss_x loss_x 1.2930 (1.2407) acc_x 68.7500 (68.6607) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [40/40] time 0.453 (0.461) data 0.323 (0.330) loss_x loss_x 1.1475 (1.2240) acc_x 71.8750 (69.0625) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1516
confident_label rate tensor(0.4142, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1299
clean true:1260
clean false:39
clean_rate:0.9699769053117783
noisy true:360
noisy false:1477
after delete: len(clean_dataset) 1299
after delete: len(noisy_dataset) 1837
epoch [113/200] batch [5/40] time 0.362 (0.426) data 0.231 (0.295) loss_x loss_x 1.3301 (1.4572) acc_x 68.7500 (68.1250) lr 8.2807e-04 eta 0:00:14
epoch [113/200] batch [10/40] time 0.517 (0.445) data 0.387 (0.314) loss_x loss_x 1.0684 (1.2730) acc_x 78.1250 (70.0000) lr 8.2807e-04 eta 0:00:13
epoch [113/200] batch [15/40] time 0.357 (0.445) data 0.226 (0.314) loss_x loss_x 0.9917 (1.2372) acc_x 71.8750 (70.6250) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [20/40] time 0.488 (0.453) data 0.357 (0.322) loss_x loss_x 1.6279 (1.2684) acc_x 62.5000 (69.8438) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [25/40] time 0.518 (0.466) data 0.387 (0.335) loss_x loss_x 1.2275 (1.2571) acc_x 75.0000 (69.7500) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [30/40] time 0.436 (0.467) data 0.306 (0.337) loss_x loss_x 0.9873 (1.2440) acc_x 78.1250 (70.1042) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [35/40] time 0.423 (0.469) data 0.292 (0.338) loss_x loss_x 1.0361 (1.2310) acc_x 68.7500 (69.8214) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [40/40] time 0.368 (0.468) data 0.238 (0.337) loss_x loss_x 1.0303 (1.2277) acc_x 78.1250 (70.3906) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1553
confident_label rate tensor(0.4015, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1259
clean true:1229
clean false:30
clean_rate:0.9761715647339158
noisy true:354
noisy false:1523
after delete: len(clean_dataset) 1259
after delete: len(noisy_dataset) 1877
epoch [114/200] batch [5/39] time 0.446 (0.459) data 0.316 (0.328) loss_x loss_x 1.3271 (1.3486) acc_x 71.8750 (65.0000) lr 8.1262e-04 eta 0:00:15
epoch [114/200] batch [10/39] time 0.507 (0.479) data 0.376 (0.348) loss_x loss_x 1.2793 (1.3907) acc_x 68.7500 (63.7500) lr 8.1262e-04 eta 0:00:13
epoch [114/200] batch [15/39] time 0.490 (0.490) data 0.359 (0.359) loss_x loss_x 1.2725 (1.3524) acc_x 68.7500 (65.6250) lr 8.1262e-04 eta 0:00:11
epoch [114/200] batch [20/39] time 0.418 (0.489) data 0.287 (0.358) loss_x loss_x 1.1885 (1.3225) acc_x 68.7500 (66.2500) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [25/39] time 0.547 (0.481) data 0.417 (0.350) loss_x loss_x 1.3711 (1.2827) acc_x 62.5000 (67.3750) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [30/39] time 0.480 (0.472) data 0.349 (0.341) loss_x loss_x 1.5518 (1.2946) acc_x 65.6250 (66.8750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [35/39] time 0.408 (0.464) data 0.278 (0.333) loss_x loss_x 1.0312 (1.2640) acc_x 75.0000 (67.9464) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1557
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1277
clean true:1237
clean false:40
clean_rate:0.9686765857478465
noisy true:342
noisy false:1517
after delete: len(clean_dataset) 1277
after delete: len(noisy_dataset) 1859
epoch [115/200] batch [5/39] time 0.459 (0.532) data 0.327 (0.401) loss_x loss_x 1.3125 (1.2634) acc_x 65.6250 (68.1250) lr 7.9721e-04 eta 0:00:18
epoch [115/200] batch [10/39] time 0.499 (0.541) data 0.367 (0.410) loss_x loss_x 1.3486 (1.2431) acc_x 59.3750 (67.8125) lr 7.9721e-04 eta 0:00:15
epoch [115/200] batch [15/39] time 0.470 (0.499) data 0.339 (0.368) loss_x loss_x 1.2490 (1.2944) acc_x 75.0000 (67.9167) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [20/39] time 0.373 (0.494) data 0.241 (0.363) loss_x loss_x 0.8589 (1.2881) acc_x 81.2500 (68.4375) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [25/39] time 0.418 (0.485) data 0.287 (0.354) loss_x loss_x 1.2158 (1.2429) acc_x 59.3750 (69.5000) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [30/39] time 0.360 (0.480) data 0.229 (0.349) loss_x loss_x 1.2070 (1.2444) acc_x 71.8750 (68.7500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [35/39] time 0.519 (0.475) data 0.388 (0.344) loss_x loss_x 0.9980 (1.2219) acc_x 75.0000 (69.5536) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1508
confident_label rate tensor(0.4145, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1300
clean true:1269
clean false:31
clean_rate:0.9761538461538461
noisy true:359
noisy false:1477
after delete: len(clean_dataset) 1300
after delete: len(noisy_dataset) 1836
epoch [116/200] batch [5/40] time 0.417 (0.402) data 0.286 (0.271) loss_x loss_x 1.2246 (1.1123) acc_x 71.8750 (73.7500) lr 7.8186e-04 eta 0:00:14
epoch [116/200] batch [10/40] time 0.449 (0.431) data 0.318 (0.300) loss_x loss_x 1.3330 (1.2322) acc_x 59.3750 (69.3750) lr 7.8186e-04 eta 0:00:12
epoch [116/200] batch [15/40] time 0.626 (0.450) data 0.495 (0.319) loss_x loss_x 0.7617 (1.1554) acc_x 81.2500 (71.6667) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [20/40] time 0.468 (0.451) data 0.337 (0.320) loss_x loss_x 1.0908 (1.1304) acc_x 75.0000 (71.7188) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [25/40] time 0.452 (0.447) data 0.322 (0.316) loss_x loss_x 1.6719 (1.1420) acc_x 56.2500 (70.6250) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [30/40] time 0.474 (0.448) data 0.343 (0.318) loss_x loss_x 0.5981 (1.1485) acc_x 84.3750 (70.3125) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [35/40] time 0.441 (0.446) data 0.310 (0.315) loss_x loss_x 1.4473 (1.1670) acc_x 65.6250 (69.4643) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [40/40] time 0.388 (0.448) data 0.257 (0.317) loss_x loss_x 1.2812 (1.1709) acc_x 65.6250 (69.3750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1575
confident_label rate tensor(0.4037, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1266
clean true:1238
clean false:28
clean_rate:0.9778830963665087
noisy true:323
noisy false:1547
after delete: len(clean_dataset) 1266
after delete: len(noisy_dataset) 1870
epoch [117/200] batch [5/39] time 0.425 (0.423) data 0.295 (0.293) loss_x loss_x 1.0869 (1.4205) acc_x 78.1250 (68.1250) lr 7.6655e-04 eta 0:00:14
epoch [117/200] batch [10/39] time 0.524 (0.448) data 0.394 (0.317) loss_x loss_x 1.4160 (1.4014) acc_x 65.6250 (67.1875) lr 7.6655e-04 eta 0:00:12
epoch [117/200] batch [15/39] time 0.484 (0.460) data 0.353 (0.329) loss_x loss_x 1.2676 (1.2916) acc_x 68.7500 (68.9583) lr 7.6655e-04 eta 0:00:11
epoch [117/200] batch [20/39] time 0.553 (0.456) data 0.422 (0.326) loss_x loss_x 1.2041 (1.2490) acc_x 68.7500 (69.6875) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [25/39] time 0.442 (0.449) data 0.310 (0.318) loss_x loss_x 1.0029 (1.2333) acc_x 68.7500 (70.0000) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [30/39] time 0.395 (0.454) data 0.265 (0.324) loss_x loss_x 0.9360 (1.2211) acc_x 78.1250 (70.0000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [35/39] time 0.355 (0.452) data 0.225 (0.322) loss_x loss_x 1.1094 (1.1902) acc_x 78.1250 (70.8036) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1508
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1319
clean true:1285
clean false:34
clean_rate:0.9742228961334344
noisy true:343
noisy false:1474
after delete: len(clean_dataset) 1319
after delete: len(noisy_dataset) 1817
epoch [118/200] batch [5/41] time 0.518 (0.517) data 0.387 (0.386) loss_x loss_x 1.2510 (1.1379) acc_x 68.7500 (73.1250) lr 7.5131e-04 eta 0:00:18
epoch [118/200] batch [10/41] time 0.574 (0.501) data 0.443 (0.370) loss_x loss_x 1.4521 (1.1928) acc_x 65.6250 (70.9375) lr 7.5131e-04 eta 0:00:15
epoch [118/200] batch [15/41] time 0.437 (0.498) data 0.306 (0.367) loss_x loss_x 0.9907 (1.1717) acc_x 78.1250 (71.0417) lr 7.5131e-04 eta 0:00:12
epoch [118/200] batch [20/41] time 0.557 (0.487) data 0.425 (0.356) loss_x loss_x 1.2305 (1.1709) acc_x 62.5000 (70.0000) lr 7.5131e-04 eta 0:00:10
epoch [118/200] batch [25/41] time 0.406 (0.489) data 0.275 (0.358) loss_x loss_x 0.9497 (1.1935) acc_x 71.8750 (70.3750) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [30/41] time 0.446 (0.484) data 0.314 (0.353) loss_x loss_x 0.9160 (1.2001) acc_x 75.0000 (70.3125) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [35/41] time 0.615 (0.481) data 0.485 (0.350) loss_x loss_x 0.9854 (1.2162) acc_x 75.0000 (69.2857) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [40/41] time 0.526 (0.477) data 0.396 (0.346) loss_x loss_x 1.0986 (1.2028) acc_x 75.0000 (69.3750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1526
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1272
clean true:1241
clean false:31
clean_rate:0.97562893081761
noisy true:369
noisy false:1495
after delete: len(clean_dataset) 1272
after delete: len(noisy_dataset) 1864
epoch [119/200] batch [5/39] time 0.429 (0.459) data 0.298 (0.328) loss_x loss_x 1.4912 (1.3546) acc_x 62.5000 (66.8750) lr 7.3613e-04 eta 0:00:15
epoch [119/200] batch [10/39] time 0.539 (0.457) data 0.407 (0.326) loss_x loss_x 0.9233 (1.1843) acc_x 71.8750 (68.4375) lr 7.3613e-04 eta 0:00:13
epoch [119/200] batch [15/39] time 0.429 (0.449) data 0.299 (0.319) loss_x loss_x 1.3516 (1.2448) acc_x 68.7500 (67.2917) lr 7.3613e-04 eta 0:00:10
epoch [119/200] batch [20/39] time 0.567 (0.450) data 0.437 (0.319) loss_x loss_x 1.5996 (1.2996) acc_x 62.5000 (67.0312) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [25/39] time 0.416 (0.443) data 0.286 (0.312) loss_x loss_x 1.0234 (1.2774) acc_x 75.0000 (68.0000) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [30/39] time 0.454 (0.449) data 0.324 (0.318) loss_x loss_x 1.0352 (1.2515) acc_x 78.1250 (68.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [35/39] time 0.565 (0.454) data 0.434 (0.324) loss_x loss_x 0.8892 (1.2273) acc_x 71.8750 (69.2857) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1526
confident_label rate tensor(0.4206, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1319
clean true:1283
clean false:36
clean_rate:0.9727065959059894
noisy true:327
noisy false:1490
after delete: len(clean_dataset) 1319
after delete: len(noisy_dataset) 1817
epoch [120/200] batch [5/41] time 0.419 (0.463) data 0.287 (0.331) loss_x loss_x 0.7637 (1.0919) acc_x 81.2500 (71.2500) lr 7.2101e-04 eta 0:00:16
epoch [120/200] batch [10/41] time 0.494 (0.456) data 0.363 (0.325) loss_x loss_x 1.0410 (1.0784) acc_x 75.0000 (73.7500) lr 7.2101e-04 eta 0:00:14
epoch [120/200] batch [15/41] time 0.605 (0.466) data 0.475 (0.335) loss_x loss_x 1.0537 (1.1931) acc_x 68.7500 (70.4167) lr 7.2101e-04 eta 0:00:12
epoch [120/200] batch [20/41] time 0.600 (0.467) data 0.469 (0.336) loss_x loss_x 1.8135 (1.2364) acc_x 59.3750 (69.2188) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [25/41] time 0.405 (0.461) data 0.275 (0.330) loss_x loss_x 1.3154 (1.2042) acc_x 75.0000 (69.8750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [30/41] time 0.332 (0.455) data 0.200 (0.324) loss_x loss_x 0.9053 (1.1997) acc_x 71.8750 (69.3750) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [35/41] time 0.417 (0.454) data 0.287 (0.323) loss_x loss_x 1.4160 (1.1908) acc_x 65.6250 (69.2857) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [40/41] time 0.512 (0.452) data 0.381 (0.321) loss_x loss_x 1.0049 (1.2059) acc_x 78.1250 (68.9844) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1522
confident_label rate tensor(0.4168, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1307
clean true:1273
clean false:34
clean_rate:0.9739862280030605
noisy true:341
noisy false:1488
after delete: len(clean_dataset) 1307
after delete: len(noisy_dataset) 1829
epoch [121/200] batch [5/40] time 0.519 (0.501) data 0.388 (0.370) loss_x loss_x 1.2168 (1.1770) acc_x 62.5000 (67.5000) lr 7.0596e-04 eta 0:00:17
epoch [121/200] batch [10/40] time 0.576 (0.476) data 0.445 (0.345) loss_x loss_x 1.2061 (1.2502) acc_x 65.6250 (66.2500) lr 7.0596e-04 eta 0:00:14
epoch [121/200] batch [15/40] time 0.453 (0.485) data 0.322 (0.354) loss_x loss_x 1.0137 (1.2341) acc_x 71.8750 (67.9167) lr 7.0596e-04 eta 0:00:12
epoch [121/200] batch [20/40] time 0.442 (0.486) data 0.312 (0.356) loss_x loss_x 1.1748 (1.2524) acc_x 65.6250 (68.2812) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [25/40] time 0.419 (0.476) data 0.289 (0.345) loss_x loss_x 0.7275 (1.2586) acc_x 84.3750 (68.3750) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [30/40] time 0.561 (0.470) data 0.430 (0.339) loss_x loss_x 0.9819 (1.2328) acc_x 71.8750 (68.3333) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [35/40] time 0.451 (0.470) data 0.320 (0.339) loss_x loss_x 1.1924 (1.2466) acc_x 71.8750 (68.3929) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [40/40] time 0.480 (0.469) data 0.349 (0.338) loss_x loss_x 1.1914 (1.2169) acc_x 68.7500 (69.2188) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1592
confident_label rate tensor(0.4021, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1261
clean true:1224
clean false:37
clean_rate:0.9706582077716098
noisy true:320
noisy false:1555
after delete: len(clean_dataset) 1261
after delete: len(noisy_dataset) 1875
epoch [122/200] batch [5/39] time 0.549 (0.427) data 0.418 (0.295) loss_x loss_x 1.1914 (1.2631) acc_x 59.3750 (66.2500) lr 6.9098e-04 eta 0:00:14
epoch [122/200] batch [10/39] time 0.425 (0.499) data 0.294 (0.368) loss_x loss_x 1.8496 (1.3158) acc_x 53.1250 (66.5625) lr 6.9098e-04 eta 0:00:14
epoch [122/200] batch [15/39] time 0.413 (0.478) data 0.281 (0.347) loss_x loss_x 1.5186 (1.2957) acc_x 62.5000 (68.3333) lr 6.9098e-04 eta 0:00:11
epoch [122/200] batch [20/39] time 0.368 (0.460) data 0.237 (0.329) loss_x loss_x 1.6113 (1.2949) acc_x 50.0000 (67.0312) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [25/39] time 0.444 (0.453) data 0.314 (0.322) loss_x loss_x 1.1426 (1.2872) acc_x 75.0000 (67.5000) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [30/39] time 0.376 (0.448) data 0.246 (0.317) loss_x loss_x 1.3389 (1.2733) acc_x 59.3750 (67.8125) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [35/39] time 0.517 (0.446) data 0.386 (0.315) loss_x loss_x 1.1006 (1.2629) acc_x 71.8750 (68.1250) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1532
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1310
clean true:1276
clean false:34
clean_rate:0.9740458015267176
noisy true:328
noisy false:1498
after delete: len(clean_dataset) 1310
after delete: len(noisy_dataset) 1826
epoch [123/200] batch [5/40] time 0.414 (0.496) data 0.283 (0.365) loss_x loss_x 1.6211 (1.3848) acc_x 56.2500 (65.6250) lr 6.7608e-04 eta 0:00:17
epoch [123/200] batch [10/40] time 0.467 (0.496) data 0.337 (0.366) loss_x loss_x 1.3779 (1.2711) acc_x 62.5000 (68.7500) lr 6.7608e-04 eta 0:00:14
epoch [123/200] batch [15/40] time 0.435 (0.494) data 0.304 (0.363) loss_x loss_x 1.1055 (1.2335) acc_x 78.1250 (69.5833) lr 6.7608e-04 eta 0:00:12
epoch [123/200] batch [20/40] time 0.360 (0.474) data 0.229 (0.343) loss_x loss_x 1.1221 (1.1665) acc_x 68.7500 (71.0938) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [25/40] time 0.413 (0.458) data 0.283 (0.328) loss_x loss_x 1.4434 (1.2057) acc_x 59.3750 (70.0000) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [30/40] time 0.541 (0.458) data 0.409 (0.327) loss_x loss_x 0.5884 (1.2019) acc_x 84.3750 (70.1042) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [35/40] time 0.590 (0.467) data 0.459 (0.336) loss_x loss_x 2.0195 (1.2429) acc_x 50.0000 (69.0179) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [40/40] time 0.450 (0.466) data 0.319 (0.335) loss_x loss_x 2.0586 (1.2652) acc_x 46.8750 (68.4375) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1555
confident_label rate tensor(0.4053, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1271
clean true:1239
clean false:32
clean_rate:0.974822974036192
noisy true:342
noisy false:1523
after delete: len(clean_dataset) 1271
after delete: len(noisy_dataset) 1865
epoch [124/200] batch [5/39] time 0.425 (0.506) data 0.294 (0.375) loss_x loss_x 1.1758 (1.3818) acc_x 71.8750 (65.6250) lr 6.6126e-04 eta 0:00:17
epoch [124/200] batch [10/39] time 0.418 (0.481) data 0.287 (0.350) loss_x loss_x 1.5693 (1.3484) acc_x 59.3750 (67.1875) lr 6.6126e-04 eta 0:00:13
epoch [124/200] batch [15/39] time 0.630 (0.484) data 0.499 (0.353) loss_x loss_x 1.2217 (1.2663) acc_x 62.5000 (69.1667) lr 6.6126e-04 eta 0:00:11
epoch [124/200] batch [20/39] time 0.316 (0.476) data 0.185 (0.344) loss_x loss_x 0.8408 (1.2333) acc_x 78.1250 (68.9062) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [25/39] time 0.547 (0.474) data 0.415 (0.342) loss_x loss_x 1.2822 (1.2079) acc_x 68.7500 (69.6250) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [30/39] time 0.529 (0.472) data 0.398 (0.341) loss_x loss_x 1.5918 (1.2473) acc_x 65.6250 (68.9583) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [35/39] time 0.401 (0.469) data 0.270 (0.338) loss_x loss_x 1.6104 (1.2625) acc_x 50.0000 (67.8571) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1529
confident_label rate tensor(0.4126, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1294
clean true:1261
clean false:33
clean_rate:0.9744976816074189
noisy true:346
noisy false:1496
after delete: len(clean_dataset) 1294
after delete: len(noisy_dataset) 1842
epoch [125/200] batch [5/40] time 0.590 (0.472) data 0.459 (0.342) loss_x loss_x 1.1445 (1.3619) acc_x 71.8750 (65.6250) lr 6.4653e-04 eta 0:00:16
epoch [125/200] batch [10/40] time 0.480 (0.442) data 0.348 (0.311) loss_x loss_x 1.4756 (1.2626) acc_x 62.5000 (67.8125) lr 6.4653e-04 eta 0:00:13
epoch [125/200] batch [15/40] time 0.447 (0.436) data 0.316 (0.304) loss_x loss_x 1.3389 (1.2712) acc_x 65.6250 (67.0833) lr 6.4653e-04 eta 0:00:10
epoch [125/200] batch [20/40] time 0.569 (0.447) data 0.438 (0.316) loss_x loss_x 1.2334 (1.2663) acc_x 68.7500 (67.8125) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [25/40] time 0.409 (0.445) data 0.278 (0.314) loss_x loss_x 1.1562 (1.2532) acc_x 71.8750 (68.5000) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [30/40] time 0.434 (0.452) data 0.303 (0.321) loss_x loss_x 1.7842 (1.2641) acc_x 62.5000 (68.6458) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [35/40] time 0.456 (0.455) data 0.325 (0.324) loss_x loss_x 0.9985 (1.2423) acc_x 62.5000 (68.8393) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [40/40] time 0.413 (0.459) data 0.282 (0.328) loss_x loss_x 0.7134 (1.2530) acc_x 90.6250 (69.1406) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1556
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1272
clean true:1243
clean false:29
clean_rate:0.9772012578616353
noisy true:337
noisy false:1527
after delete: len(clean_dataset) 1272
after delete: len(noisy_dataset) 1864
epoch [126/200] batch [5/39] time 0.379 (0.461) data 0.248 (0.331) loss_x loss_x 1.2549 (1.1397) acc_x 62.5000 (71.2500) lr 6.3188e-04 eta 0:00:15
epoch [126/200] batch [10/39] time 0.480 (0.474) data 0.349 (0.343) loss_x loss_x 0.8579 (1.0496) acc_x 75.0000 (73.4375) lr 6.3188e-04 eta 0:00:13
epoch [126/200] batch [15/39] time 0.457 (0.464) data 0.326 (0.333) loss_x loss_x 0.8804 (1.0925) acc_x 75.0000 (72.2917) lr 6.3188e-04 eta 0:00:11
epoch [126/200] batch [20/39] time 0.438 (0.459) data 0.307 (0.328) loss_x loss_x 0.7969 (1.0956) acc_x 71.8750 (71.8750) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [25/39] time 0.423 (0.456) data 0.293 (0.325) loss_x loss_x 1.0352 (1.1293) acc_x 71.8750 (71.0000) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [30/39] time 0.441 (0.454) data 0.310 (0.323) loss_x loss_x 1.3984 (1.1344) acc_x 59.3750 (70.5208) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [35/39] time 0.375 (0.452) data 0.244 (0.322) loss_x loss_x 1.2705 (1.1558) acc_x 68.7500 (70.4464) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1519
confident_label rate tensor(0.4168, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1307
clean true:1273
clean false:34
clean_rate:0.9739862280030605
noisy true:344
noisy false:1485
after delete: len(clean_dataset) 1307
after delete: len(noisy_dataset) 1829
epoch [127/200] batch [5/40] time 0.582 (0.514) data 0.450 (0.383) loss_x loss_x 1.5127 (1.4797) acc_x 62.5000 (63.7500) lr 6.1732e-04 eta 0:00:17
epoch [127/200] batch [10/40] time 0.411 (0.476) data 0.280 (0.345) loss_x loss_x 1.3594 (1.3690) acc_x 68.7500 (64.0625) lr 6.1732e-04 eta 0:00:14
epoch [127/200] batch [15/40] time 0.542 (0.476) data 0.411 (0.344) loss_x loss_x 1.2812 (1.3124) acc_x 53.1250 (66.0417) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [20/40] time 0.512 (0.478) data 0.381 (0.347) loss_x loss_x 1.2900 (1.2888) acc_x 71.8750 (67.5000) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [25/40] time 0.432 (0.469) data 0.301 (0.338) loss_x loss_x 0.8027 (1.2470) acc_x 81.2500 (68.5000) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [30/40] time 0.410 (0.458) data 0.280 (0.327) loss_x loss_x 1.2930 (1.2604) acc_x 68.7500 (67.7083) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [35/40] time 0.427 (0.455) data 0.297 (0.324) loss_x loss_x 0.9834 (1.2470) acc_x 78.1250 (68.6607) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [40/40] time 0.372 (0.451) data 0.242 (0.320) loss_x loss_x 1.2949 (1.2583) acc_x 65.6250 (67.8906) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1246
clean true:1216
clean false:30
clean_rate:0.9759229534510433
noisy true:354
noisy false:1536
after delete: len(clean_dataset) 1246
after delete: len(noisy_dataset) 1890
epoch [128/200] batch [5/38] time 0.534 (0.480) data 0.403 (0.348) loss_x loss_x 0.7817 (0.9854) acc_x 71.8750 (71.2500) lr 6.0285e-04 eta 0:00:15
epoch [128/200] batch [10/38] time 0.500 (0.488) data 0.368 (0.357) loss_x loss_x 1.1230 (1.0637) acc_x 68.7500 (70.3125) lr 6.0285e-04 eta 0:00:13
epoch [128/200] batch [15/38] time 0.424 (0.462) data 0.293 (0.330) loss_x loss_x 1.2412 (1.1250) acc_x 65.6250 (69.3750) lr 6.0285e-04 eta 0:00:10
epoch [128/200] batch [20/38] time 0.346 (0.471) data 0.214 (0.340) loss_x loss_x 1.1855 (1.1083) acc_x 68.7500 (70.6250) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [25/38] time 0.504 (0.474) data 0.373 (0.343) loss_x loss_x 1.0850 (1.1315) acc_x 71.8750 (70.3750) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [30/38] time 0.524 (0.475) data 0.393 (0.344) loss_x loss_x 1.1289 (1.1583) acc_x 75.0000 (70.5208) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [35/38] time 0.345 (0.466) data 0.215 (0.335) loss_x loss_x 0.9751 (1.1595) acc_x 71.8750 (70.3571) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1543
confident_label rate tensor(0.4120, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1292
clean true:1258
clean false:34
clean_rate:0.9736842105263158
noisy true:335
noisy false:1509
after delete: len(clean_dataset) 1292
after delete: len(noisy_dataset) 1844
epoch [129/200] batch [5/40] time 0.636 (0.542) data 0.505 (0.410) loss_x loss_x 1.1250 (1.3398) acc_x 71.8750 (66.8750) lr 5.8849e-04 eta 0:00:18
epoch [129/200] batch [10/40] time 0.429 (0.489) data 0.297 (0.358) loss_x loss_x 1.0059 (1.2448) acc_x 78.1250 (69.6875) lr 5.8849e-04 eta 0:00:14
epoch [129/200] batch [15/40] time 0.495 (0.475) data 0.364 (0.344) loss_x loss_x 1.2832 (1.2634) acc_x 65.6250 (68.7500) lr 5.8849e-04 eta 0:00:11
epoch [129/200] batch [20/40] time 0.392 (0.461) data 0.261 (0.330) loss_x loss_x 0.7700 (1.2414) acc_x 75.0000 (68.7500) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [25/40] time 0.425 (0.455) data 0.294 (0.325) loss_x loss_x 1.6797 (1.2691) acc_x 65.6250 (68.7500) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [30/40] time 0.412 (0.463) data 0.282 (0.332) loss_x loss_x 1.0303 (1.2492) acc_x 75.0000 (69.6875) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [35/40] time 0.449 (0.462) data 0.318 (0.331) loss_x loss_x 1.5361 (1.2609) acc_x 62.5000 (69.9107) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [40/40] time 0.389 (0.462) data 0.259 (0.331) loss_x loss_x 1.0098 (1.2383) acc_x 68.7500 (70.2344) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1550
confident_label rate tensor(0.4088, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1282
clean true:1251
clean false:31
clean_rate:0.9758190327613104
noisy true:335
noisy false:1519
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 1854
epoch [130/200] batch [5/40] time 0.406 (0.468) data 0.275 (0.336) loss_x loss_x 1.4395 (1.1736) acc_x 68.7500 (73.1250) lr 5.7422e-04 eta 0:00:16
epoch [130/200] batch [10/40] time 0.377 (0.456) data 0.245 (0.325) loss_x loss_x 0.8599 (1.2198) acc_x 71.8750 (70.3125) lr 5.7422e-04 eta 0:00:13
epoch [130/200] batch [15/40] time 0.625 (0.487) data 0.493 (0.356) loss_x loss_x 1.4873 (1.2885) acc_x 65.6250 (68.5417) lr 5.7422e-04 eta 0:00:12
epoch [130/200] batch [20/40] time 0.343 (0.475) data 0.212 (0.343) loss_x loss_x 1.3145 (1.3102) acc_x 62.5000 (68.1250) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [25/40] time 0.332 (0.464) data 0.201 (0.332) loss_x loss_x 1.6074 (1.2937) acc_x 65.6250 (69.0000) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [30/40] time 0.445 (0.464) data 0.313 (0.333) loss_x loss_x 0.8276 (1.2889) acc_x 81.2500 (68.7500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [35/40] time 0.426 (0.463) data 0.296 (0.332) loss_x loss_x 1.6289 (1.2859) acc_x 62.5000 (69.0179) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [40/40] time 0.434 (0.460) data 0.303 (0.329) loss_x loss_x 1.0811 (1.2567) acc_x 78.1250 (70.2344) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1529
confident_label rate tensor(0.4133, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1296
clean true:1264
clean false:32
clean_rate:0.9753086419753086
noisy true:343
noisy false:1497
after delete: len(clean_dataset) 1296
after delete: len(noisy_dataset) 1840
epoch [131/200] batch [5/40] time 0.413 (0.463) data 0.283 (0.332) loss_x loss_x 1.1748 (1.1679) acc_x 78.1250 (73.7500) lr 5.6006e-04 eta 0:00:16
epoch [131/200] batch [10/40] time 0.510 (0.467) data 0.379 (0.336) loss_x loss_x 0.7441 (1.1179) acc_x 71.8750 (72.8125) lr 5.6006e-04 eta 0:00:14
epoch [131/200] batch [15/40] time 0.460 (0.470) data 0.329 (0.339) loss_x loss_x 0.8271 (1.1242) acc_x 84.3750 (72.5000) lr 5.6006e-04 eta 0:00:11
epoch [131/200] batch [20/40] time 0.451 (0.472) data 0.321 (0.341) loss_x loss_x 1.1748 (1.1333) acc_x 65.6250 (71.5625) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [25/40] time 0.418 (0.470) data 0.288 (0.339) loss_x loss_x 1.4482 (1.1187) acc_x 59.3750 (71.2500) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [30/40] time 0.434 (0.466) data 0.303 (0.335) loss_x loss_x 1.3213 (1.1376) acc_x 71.8750 (71.3542) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [35/40] time 0.489 (0.462) data 0.359 (0.331) loss_x loss_x 0.8335 (1.1205) acc_x 78.1250 (72.3214) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [40/40] time 0.418 (0.456) data 0.287 (0.325) loss_x loss_x 1.3750 (1.1245) acc_x 53.1250 (72.1094) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1566
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1278
clean true:1246
clean false:32
clean_rate:0.974960876369327
noisy true:324
noisy false:1534
after delete: len(clean_dataset) 1278
after delete: len(noisy_dataset) 1858
epoch [132/200] batch [5/39] time 0.478 (0.427) data 0.347 (0.297) loss_x loss_x 1.2637 (1.1564) acc_x 68.7500 (70.6250) lr 5.4601e-04 eta 0:00:14
epoch [132/200] batch [10/39] time 0.414 (0.423) data 0.284 (0.292) loss_x loss_x 1.6367 (1.2570) acc_x 62.5000 (67.8125) lr 5.4601e-04 eta 0:00:12
epoch [132/200] batch [15/39] time 0.373 (0.432) data 0.243 (0.302) loss_x loss_x 1.4121 (1.2208) acc_x 62.5000 (68.9583) lr 5.4601e-04 eta 0:00:10
epoch [132/200] batch [20/39] time 0.346 (0.442) data 0.216 (0.311) loss_x loss_x 1.2002 (1.1954) acc_x 68.7500 (70.0000) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [25/39] time 0.474 (0.446) data 0.343 (0.316) loss_x loss_x 1.1836 (1.2274) acc_x 68.7500 (69.8750) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [30/39] time 0.429 (0.442) data 0.298 (0.311) loss_x loss_x 1.0088 (1.2178) acc_x 71.8750 (70.0000) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [35/39] time 0.498 (0.444) data 0.367 (0.314) loss_x loss_x 1.2373 (1.2019) acc_x 68.7500 (70.0893) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1564
confident_label rate tensor(0.4094, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1284
clean true:1250
clean false:34
clean_rate:0.9735202492211839
noisy true:322
noisy false:1530
after delete: len(clean_dataset) 1284
after delete: len(noisy_dataset) 1852
epoch [133/200] batch [5/40] time 0.421 (0.448) data 0.290 (0.317) loss_x loss_x 1.3018 (1.3183) acc_x 65.6250 (67.5000) lr 5.3207e-04 eta 0:00:15
epoch [133/200] batch [10/40] time 0.396 (0.434) data 0.265 (0.303) loss_x loss_x 1.3984 (1.2270) acc_x 62.5000 (67.5000) lr 5.3207e-04 eta 0:00:13
epoch [133/200] batch [15/40] time 0.384 (0.472) data 0.253 (0.342) loss_x loss_x 0.9863 (1.2139) acc_x 71.8750 (69.1667) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [20/40] time 0.393 (0.464) data 0.263 (0.333) loss_x loss_x 0.9771 (1.2134) acc_x 71.8750 (69.0625) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [25/40] time 0.394 (0.458) data 0.264 (0.327) loss_x loss_x 0.9917 (1.2014) acc_x 78.1250 (70.0000) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [30/40] time 0.466 (0.466) data 0.334 (0.335) loss_x loss_x 0.3804 (1.1867) acc_x 90.6250 (70.0000) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [35/40] time 0.389 (0.464) data 0.258 (0.334) loss_x loss_x 1.1543 (1.1627) acc_x 78.1250 (71.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [40/40] time 0.393 (0.463) data 0.263 (0.332) loss_x loss_x 1.3389 (1.1593) acc_x 75.0000 (71.5625) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1515
confident_label rate tensor(0.4180, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1311
clean true:1281
clean false:30
clean_rate:0.977116704805492
noisy true:340
noisy false:1485
after delete: len(clean_dataset) 1311
after delete: len(noisy_dataset) 1825
epoch [134/200] batch [5/40] time 0.386 (0.424) data 0.255 (0.294) loss_x loss_x 1.8662 (1.2306) acc_x 53.1250 (71.8750) lr 5.1825e-04 eta 0:00:14
epoch [134/200] batch [10/40] time 0.564 (0.440) data 0.432 (0.309) loss_x loss_x 1.1631 (1.3015) acc_x 71.8750 (68.7500) lr 5.1825e-04 eta 0:00:13
epoch [134/200] batch [15/40] time 0.444 (0.442) data 0.314 (0.311) loss_x loss_x 1.6064 (1.2989) acc_x 71.8750 (68.3333) lr 5.1825e-04 eta 0:00:11
epoch [134/200] batch [20/40] time 0.420 (0.441) data 0.289 (0.310) loss_x loss_x 1.0752 (1.2982) acc_x 78.1250 (68.4375) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [25/40] time 0.472 (0.451) data 0.342 (0.320) loss_x loss_x 1.6270 (1.2981) acc_x 56.2500 (68.2500) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [30/40] time 0.417 (0.453) data 0.286 (0.322) loss_x loss_x 1.1201 (1.2868) acc_x 62.5000 (68.2292) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [35/40] time 0.435 (0.458) data 0.305 (0.328) loss_x loss_x 1.0576 (1.2847) acc_x 75.0000 (67.8571) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [40/40] time 0.396 (0.454) data 0.266 (0.324) loss_x loss_x 1.1133 (1.2924) acc_x 71.8750 (67.5781) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1558
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1304
clean true:1265
clean false:39
clean_rate:0.9700920245398773
noisy true:313
noisy false:1519
after delete: len(clean_dataset) 1304
after delete: len(noisy_dataset) 1832
epoch [135/200] batch [5/40] time 0.419 (0.498) data 0.288 (0.367) loss_x loss_x 1.3398 (1.1736) acc_x 65.6250 (69.3750) lr 5.0454e-04 eta 0:00:17
epoch [135/200] batch [10/40] time 0.470 (0.464) data 0.339 (0.333) loss_x loss_x 1.4932 (1.2125) acc_x 68.7500 (70.3125) lr 5.0454e-04 eta 0:00:13
epoch [135/200] batch [15/40] time 0.491 (0.459) data 0.361 (0.328) loss_x loss_x 1.7051 (1.2602) acc_x 59.3750 (70.0000) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [20/40] time 0.481 (0.461) data 0.350 (0.331) loss_x loss_x 1.4863 (1.2359) acc_x 53.1250 (69.5312) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [25/40] time 0.481 (0.457) data 0.350 (0.326) loss_x loss_x 0.7817 (1.2081) acc_x 84.3750 (69.6250) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [30/40] time 0.425 (0.451) data 0.294 (0.321) loss_x loss_x 1.0361 (1.2040) acc_x 78.1250 (69.7917) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [35/40] time 0.571 (0.457) data 0.439 (0.326) loss_x loss_x 1.2754 (1.1821) acc_x 68.7500 (70.2679) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [40/40] time 0.512 (0.455) data 0.381 (0.324) loss_x loss_x 1.1357 (1.1631) acc_x 71.8750 (70.4688) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1333
clean true:1294
clean false:39
clean_rate:0.9707426856714179
noisy true:330
noisy false:1473
after delete: len(clean_dataset) 1333
after delete: len(noisy_dataset) 1803
epoch [136/200] batch [5/41] time 0.409 (0.449) data 0.278 (0.317) loss_x loss_x 1.0264 (1.2299) acc_x 75.0000 (70.6250) lr 4.9096e-04 eta 0:00:16
epoch [136/200] batch [10/41] time 0.394 (0.451) data 0.263 (0.320) loss_x loss_x 0.9624 (1.1525) acc_x 71.8750 (71.2500) lr 4.9096e-04 eta 0:00:13
epoch [136/200] batch [15/41] time 0.380 (0.444) data 0.248 (0.313) loss_x loss_x 1.0713 (1.1425) acc_x 71.8750 (70.2083) lr 4.9096e-04 eta 0:00:11
epoch [136/200] batch [20/41] time 0.516 (0.451) data 0.384 (0.320) loss_x loss_x 1.7070 (1.2013) acc_x 53.1250 (68.7500) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [25/41] time 0.514 (0.459) data 0.382 (0.328) loss_x loss_x 1.2500 (1.2342) acc_x 68.7500 (68.3750) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [30/41] time 0.528 (0.455) data 0.396 (0.323) loss_x loss_x 1.5977 (1.2482) acc_x 59.3750 (68.6458) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [35/41] time 0.491 (0.456) data 0.360 (0.325) loss_x loss_x 1.3418 (1.2255) acc_x 62.5000 (69.1964) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [40/41] time 0.476 (0.464) data 0.345 (0.333) loss_x loss_x 1.3291 (1.2089) acc_x 75.0000 (69.7656) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1552
confident_label rate tensor(0.4088, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1282
clean true:1250
clean false:32
clean_rate:0.9750390015600624
noisy true:334
noisy false:1520
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 1854
epoch [137/200] batch [5/40] time 0.402 (0.409) data 0.271 (0.278) loss_x loss_x 1.0664 (1.1816) acc_x 75.0000 (67.5000) lr 4.7750e-04 eta 0:00:14
epoch [137/200] batch [10/40] time 0.375 (0.418) data 0.245 (0.288) loss_x loss_x 1.5186 (1.2862) acc_x 62.5000 (67.1875) lr 4.7750e-04 eta 0:00:12
epoch [137/200] batch [15/40] time 0.521 (0.444) data 0.390 (0.313) loss_x loss_x 1.2109 (1.2076) acc_x 65.6250 (68.7500) lr 4.7750e-04 eta 0:00:11
epoch [137/200] batch [20/40] time 0.410 (0.442) data 0.279 (0.312) loss_x loss_x 0.7632 (1.2075) acc_x 84.3750 (69.3750) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [25/40] time 0.373 (0.433) data 0.242 (0.302) loss_x loss_x 1.1113 (1.1963) acc_x 71.8750 (69.5000) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [30/40] time 0.525 (0.434) data 0.395 (0.303) loss_x loss_x 1.1074 (1.1584) acc_x 75.0000 (70.6250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [35/40] time 0.570 (0.443) data 0.439 (0.312) loss_x loss_x 0.8931 (1.1482) acc_x 78.1250 (70.8929) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [40/40] time 0.533 (0.448) data 0.403 (0.317) loss_x loss_x 1.3320 (1.1590) acc_x 65.6250 (70.3906) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1515
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1339
clean true:1298
clean false:41
clean_rate:0.9693801344286781
noisy true:323
noisy false:1474
after delete: len(clean_dataset) 1339
after delete: len(noisy_dataset) 1797
epoch [138/200] batch [5/41] time 0.554 (0.449) data 0.424 (0.319) loss_x loss_x 1.0264 (1.3012) acc_x 75.0000 (65.6250) lr 4.6417e-04 eta 0:00:16
epoch [138/200] batch [10/41] time 0.422 (0.444) data 0.291 (0.313) loss_x loss_x 1.2197 (1.2739) acc_x 65.6250 (67.1875) lr 4.6417e-04 eta 0:00:13
epoch [138/200] batch [15/41] time 0.447 (0.451) data 0.315 (0.319) loss_x loss_x 0.9497 (1.2363) acc_x 78.1250 (67.9167) lr 4.6417e-04 eta 0:00:11
epoch [138/200] batch [20/41] time 0.351 (0.466) data 0.220 (0.335) loss_x loss_x 1.4941 (1.2249) acc_x 62.5000 (67.9688) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [25/41] time 0.415 (0.474) data 0.285 (0.343) loss_x loss_x 0.8789 (1.2307) acc_x 78.1250 (67.8750) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [30/41] time 0.517 (0.477) data 0.386 (0.346) loss_x loss_x 1.4512 (1.2154) acc_x 62.5000 (68.0208) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [35/41] time 0.479 (0.474) data 0.348 (0.343) loss_x loss_x 1.4014 (1.2180) acc_x 65.6250 (68.2143) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [40/41] time 0.478 (0.476) data 0.346 (0.345) loss_x loss_x 1.4033 (1.2196) acc_x 53.1250 (67.4219) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.4161, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1305
clean true:1267
clean false:38
clean_rate:0.9708812260536398
noisy true:342
noisy false:1489
after delete: len(clean_dataset) 1305
after delete: len(noisy_dataset) 1831
epoch [139/200] batch [5/40] time 0.368 (0.496) data 0.238 (0.364) loss_x loss_x 1.2480 (1.3420) acc_x 65.6250 (65.6250) lr 4.5098e-04 eta 0:00:17
epoch [139/200] batch [10/40] time 0.512 (0.506) data 0.381 (0.375) loss_x loss_x 1.2705 (1.3083) acc_x 68.7500 (67.8125) lr 4.5098e-04 eta 0:00:15
epoch [139/200] batch [15/40] time 0.419 (0.481) data 0.288 (0.350) loss_x loss_x 1.6396 (1.2353) acc_x 62.5000 (70.4167) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [20/40] time 0.418 (0.472) data 0.287 (0.341) loss_x loss_x 1.9531 (1.2829) acc_x 53.1250 (69.2188) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [25/40] time 0.317 (0.467) data 0.186 (0.336) loss_x loss_x 1.0430 (1.2985) acc_x 71.8750 (68.6250) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [30/40] time 0.461 (0.458) data 0.329 (0.327) loss_x loss_x 0.9321 (1.2949) acc_x 75.0000 (68.6458) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [35/40] time 0.429 (0.455) data 0.299 (0.324) loss_x loss_x 1.6836 (1.2908) acc_x 53.1250 (68.4821) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [40/40] time 0.441 (0.458) data 0.310 (0.327) loss_x loss_x 1.1377 (1.2831) acc_x 62.5000 (68.5156) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.4209, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1320
clean true:1277
clean false:43
clean_rate:0.9674242424242424
noisy true:332
noisy false:1484
after delete: len(clean_dataset) 1320
after delete: len(noisy_dataset) 1816
epoch [140/200] batch [5/41] time 0.411 (0.467) data 0.281 (0.337) loss_x loss_x 1.6553 (1.1645) acc_x 59.3750 (72.5000) lr 4.3792e-04 eta 0:00:16
epoch [140/200] batch [10/41] time 0.524 (0.448) data 0.393 (0.317) loss_x loss_x 1.3926 (1.1519) acc_x 71.8750 (73.1250) lr 4.3792e-04 eta 0:00:13
epoch [140/200] batch [15/41] time 0.393 (0.436) data 0.262 (0.306) loss_x loss_x 1.3115 (1.1991) acc_x 65.6250 (69.7917) lr 4.3792e-04 eta 0:00:11
epoch [140/200] batch [20/41] time 0.544 (0.444) data 0.413 (0.313) loss_x loss_x 1.1592 (1.1695) acc_x 75.0000 (71.4062) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [25/41] time 0.512 (0.460) data 0.382 (0.329) loss_x loss_x 1.4688 (1.1834) acc_x 65.6250 (71.1250) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [30/41] time 0.376 (0.457) data 0.246 (0.326) loss_x loss_x 0.7397 (1.1870) acc_x 84.3750 (70.9375) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [35/41] time 0.519 (0.463) data 0.389 (0.332) loss_x loss_x 0.8677 (1.1728) acc_x 78.1250 (71.0714) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [40/41] time 0.365 (0.461) data 0.233 (0.330) loss_x loss_x 1.1826 (1.1864) acc_x 65.6250 (70.2344) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1500
confident_label rate tensor(0.4292, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1346
clean true:1306
clean false:40
clean_rate:0.9702823179791976
noisy true:330
noisy false:1460
after delete: len(clean_dataset) 1346
after delete: len(noisy_dataset) 1790
epoch [141/200] batch [5/42] time 0.481 (0.460) data 0.350 (0.329) loss_x loss_x 1.4785 (1.1506) acc_x 68.7500 (71.8750) lr 4.2499e-04 eta 0:00:17
epoch [141/200] batch [10/42] time 0.464 (0.466) data 0.334 (0.335) loss_x loss_x 0.8193 (1.0892) acc_x 84.3750 (73.4375) lr 4.2499e-04 eta 0:00:14
epoch [141/200] batch [15/42] time 0.441 (0.459) data 0.310 (0.328) loss_x loss_x 1.9902 (1.1931) acc_x 59.3750 (72.2917) lr 4.2499e-04 eta 0:00:12
epoch [141/200] batch [20/42] time 0.460 (0.468) data 0.330 (0.337) loss_x loss_x 1.3281 (1.2103) acc_x 65.6250 (70.7812) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [25/42] time 0.457 (0.464) data 0.326 (0.333) loss_x loss_x 0.6733 (1.1603) acc_x 81.2500 (71.8750) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [30/42] time 0.459 (0.463) data 0.327 (0.332) loss_x loss_x 1.0195 (1.1641) acc_x 71.8750 (71.1458) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [35/42] time 0.441 (0.462) data 0.310 (0.332) loss_x loss_x 1.6914 (1.1692) acc_x 65.6250 (71.0714) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [40/42] time 0.354 (0.456) data 0.223 (0.325) loss_x loss_x 1.7676 (1.1908) acc_x 56.2500 (70.3125) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1528
confident_label rate tensor(0.4129, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1295
clean true:1268
clean false:27
clean_rate:0.9791505791505791
noisy true:340
noisy false:1501
after delete: len(clean_dataset) 1295
after delete: len(noisy_dataset) 1841
epoch [142/200] batch [5/40] time 0.397 (0.435) data 0.266 (0.304) loss_x loss_x 1.0391 (1.0049) acc_x 75.0000 (75.6250) lr 4.1221e-04 eta 0:00:15
epoch [142/200] batch [10/40] time 0.373 (0.437) data 0.242 (0.306) loss_x loss_x 1.5146 (1.2001) acc_x 71.8750 (73.1250) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [15/40] time 0.513 (0.461) data 0.383 (0.331) loss_x loss_x 1.5830 (1.2186) acc_x 65.6250 (72.0833) lr 4.1221e-04 eta 0:00:11
epoch [142/200] batch [20/40] time 0.483 (0.451) data 0.352 (0.320) loss_x loss_x 1.1602 (1.2420) acc_x 71.8750 (70.9375) lr 4.1221e-04 eta 0:00:09
epoch [142/200] batch [25/40] time 0.457 (0.450) data 0.326 (0.319) loss_x loss_x 1.4863 (1.2456) acc_x 56.2500 (70.2500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [30/40] time 0.439 (0.453) data 0.308 (0.322) loss_x loss_x 1.3467 (1.2527) acc_x 71.8750 (70.1042) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [35/40] time 0.450 (0.452) data 0.319 (0.321) loss_x loss_x 1.5430 (1.2532) acc_x 71.8750 (70.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [40/40] time 0.422 (0.449) data 0.292 (0.318) loss_x loss_x 1.2441 (1.2245) acc_x 78.1250 (70.7812) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1517
confident_label rate tensor(0.4200, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1317
clean true:1278
clean false:39
clean_rate:0.9703872437357631
noisy true:341
noisy false:1478
after delete: len(clean_dataset) 1317
after delete: len(noisy_dataset) 1819
epoch [143/200] batch [5/41] time 0.411 (0.471) data 0.280 (0.340) loss_x loss_x 1.5791 (1.0744) acc_x 53.1250 (66.8750) lr 3.9958e-04 eta 0:00:16
epoch [143/200] batch [10/41] time 0.418 (0.451) data 0.287 (0.320) loss_x loss_x 1.1250 (1.2106) acc_x 78.1250 (67.1875) lr 3.9958e-04 eta 0:00:13
epoch [143/200] batch [15/41] time 0.486 (0.472) data 0.355 (0.341) loss_x loss_x 1.3223 (1.2500) acc_x 62.5000 (66.2500) lr 3.9958e-04 eta 0:00:12
epoch [143/200] batch [20/41] time 0.539 (0.465) data 0.409 (0.334) loss_x loss_x 1.9883 (1.2560) acc_x 50.0000 (67.3438) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [25/41] time 0.430 (0.462) data 0.300 (0.331) loss_x loss_x 1.5391 (1.2595) acc_x 59.3750 (67.5000) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [30/41] time 0.426 (0.469) data 0.296 (0.338) loss_x loss_x 1.3096 (1.2571) acc_x 75.0000 (68.5417) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [35/41] time 0.467 (0.472) data 0.336 (0.341) loss_x loss_x 1.3213 (1.2777) acc_x 71.8750 (68.3036) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [40/41] time 0.478 (0.469) data 0.347 (0.339) loss_x loss_x 0.4934 (1.2440) acc_x 87.5000 (68.5156) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1506
confident_label rate tensor(0.4241, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1330
clean true:1289
clean false:41
clean_rate:0.969172932330827
noisy true:341
noisy false:1465
after delete: len(clean_dataset) 1330
after delete: len(noisy_dataset) 1806
epoch [144/200] batch [5/41] time 0.514 (0.453) data 0.384 (0.322) loss_x loss_x 1.0029 (0.9489) acc_x 81.2500 (76.8750) lr 3.8709e-04 eta 0:00:16
epoch [144/200] batch [10/41] time 0.490 (0.451) data 0.358 (0.320) loss_x loss_x 1.1270 (0.9918) acc_x 75.0000 (75.0000) lr 3.8709e-04 eta 0:00:13
epoch [144/200] batch [15/41] time 0.414 (0.454) data 0.282 (0.323) loss_x loss_x 0.8755 (1.0378) acc_x 71.8750 (73.5417) lr 3.8709e-04 eta 0:00:11
epoch [144/200] batch [20/41] time 0.604 (0.473) data 0.472 (0.341) loss_x loss_x 1.6572 (1.1191) acc_x 56.2500 (71.7188) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [25/41] time 0.379 (0.462) data 0.249 (0.331) loss_x loss_x 1.3291 (1.1742) acc_x 65.6250 (71.1250) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [30/41] time 0.492 (0.456) data 0.362 (0.325) loss_x loss_x 1.2012 (1.2201) acc_x 65.6250 (69.8958) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [35/41] time 0.472 (0.461) data 0.341 (0.330) loss_x loss_x 0.7349 (1.2014) acc_x 71.8750 (69.5536) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [40/41] time 0.451 (0.465) data 0.320 (0.334) loss_x loss_x 1.3252 (1.1941) acc_x 68.7500 (69.6875) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1511
confident_label rate tensor(0.4180, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1311
clean true:1274
clean false:37
clean_rate:0.9717772692601068
noisy true:351
noisy false:1474
after delete: len(clean_dataset) 1311
after delete: len(noisy_dataset) 1825
epoch [145/200] batch [5/40] time 0.458 (0.447) data 0.328 (0.316) loss_x loss_x 0.8140 (1.1694) acc_x 71.8750 (70.6250) lr 3.7476e-04 eta 0:00:15
epoch [145/200] batch [10/40] time 0.503 (0.463) data 0.372 (0.333) loss_x loss_x 0.9727 (1.1576) acc_x 78.1250 (70.6250) lr 3.7476e-04 eta 0:00:13
epoch [145/200] batch [15/40] time 0.403 (0.470) data 0.272 (0.339) loss_x loss_x 1.5869 (1.2373) acc_x 65.6250 (68.7500) lr 3.7476e-04 eta 0:00:11
epoch [145/200] batch [20/40] time 0.481 (0.461) data 0.350 (0.331) loss_x loss_x 0.7939 (1.1903) acc_x 81.2500 (70.3125) lr 3.7476e-04 eta 0:00:09
epoch [145/200] batch [25/40] time 0.448 (0.459) data 0.317 (0.328) loss_x loss_x 0.9277 (1.2098) acc_x 71.8750 (69.6250) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [30/40] time 0.459 (0.461) data 0.328 (0.330) loss_x loss_x 1.9053 (1.2180) acc_x 50.0000 (69.2708) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [35/40] time 0.382 (0.455) data 0.252 (0.324) loss_x loss_x 1.0654 (1.2121) acc_x 62.5000 (69.1071) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [40/40] time 0.418 (0.461) data 0.288 (0.330) loss_x loss_x 1.1172 (1.2069) acc_x 65.6250 (69.2188) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1499
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1341
clean true:1300
clean false:41
clean_rate:0.9694258016405667
noisy true:337
noisy false:1458
after delete: len(clean_dataset) 1341
after delete: len(noisy_dataset) 1795
epoch [146/200] batch [5/41] time 0.348 (0.518) data 0.218 (0.387) loss_x loss_x 1.5605 (1.3021) acc_x 68.7500 (66.8750) lr 3.6258e-04 eta 0:00:18
epoch [146/200] batch [10/41] time 0.462 (0.487) data 0.331 (0.356) loss_x loss_x 0.7524 (1.2483) acc_x 78.1250 (66.8750) lr 3.6258e-04 eta 0:00:15
epoch [146/200] batch [15/41] time 0.463 (0.478) data 0.332 (0.347) loss_x loss_x 1.0791 (1.1879) acc_x 78.1250 (68.1250) lr 3.6258e-04 eta 0:00:12
epoch [146/200] batch [20/41] time 0.493 (0.466) data 0.363 (0.335) loss_x loss_x 1.4346 (1.2129) acc_x 62.5000 (68.4375) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [25/41] time 0.527 (0.475) data 0.396 (0.343) loss_x loss_x 1.2158 (1.1988) acc_x 68.7500 (69.0000) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [30/41] time 0.361 (0.464) data 0.231 (0.333) loss_x loss_x 1.3711 (1.2023) acc_x 65.6250 (68.8542) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [35/41] time 0.501 (0.468) data 0.371 (0.337) loss_x loss_x 1.3525 (1.2241) acc_x 68.7500 (68.8393) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [40/41] time 0.579 (0.460) data 0.448 (0.329) loss_x loss_x 1.2656 (1.2556) acc_x 62.5000 (67.5781) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1526
confident_label rate tensor(0.4104, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1287
clean true:1255
clean false:32
clean_rate:0.9751359751359752
noisy true:355
noisy false:1494
after delete: len(clean_dataset) 1287
after delete: len(noisy_dataset) 1849
epoch [147/200] batch [5/40] time 0.451 (0.484) data 0.321 (0.353) loss_x loss_x 1.6182 (1.1499) acc_x 53.1250 (70.6250) lr 3.5055e-04 eta 0:00:16
epoch [147/200] batch [10/40] time 0.497 (0.466) data 0.367 (0.335) loss_x loss_x 1.1895 (1.0838) acc_x 65.6250 (71.5625) lr 3.5055e-04 eta 0:00:13
epoch [147/200] batch [15/40] time 0.488 (0.477) data 0.358 (0.346) loss_x loss_x 1.4521 (1.0813) acc_x 65.6250 (72.7083) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [20/40] time 0.489 (0.474) data 0.358 (0.343) loss_x loss_x 1.1289 (1.1105) acc_x 65.6250 (71.8750) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [25/40] time 0.374 (0.464) data 0.243 (0.333) loss_x loss_x 0.6982 (1.1407) acc_x 78.1250 (71.0000) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [30/40] time 0.433 (0.472) data 0.302 (0.341) loss_x loss_x 1.2812 (1.1457) acc_x 81.2500 (71.3542) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [35/40] time 0.392 (0.466) data 0.260 (0.335) loss_x loss_x 0.6499 (1.1509) acc_x 87.5000 (71.6071) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [40/40] time 0.532 (0.467) data 0.402 (0.336) loss_x loss_x 1.0400 (1.1509) acc_x 71.8750 (71.4844) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1556
confident_label rate tensor(0.4088, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1282
clean true:1240
clean false:42
clean_rate:0.9672386895475819
noisy true:340
noisy false:1514
after delete: len(clean_dataset) 1282
after delete: len(noisy_dataset) 1854
epoch [148/200] batch [5/40] time 0.596 (0.516) data 0.466 (0.385) loss_x loss_x 1.0586 (1.1233) acc_x 68.7500 (73.1250) lr 3.3869e-04 eta 0:00:18
epoch [148/200] batch [10/40] time 0.476 (0.505) data 0.345 (0.374) loss_x loss_x 0.9941 (1.1119) acc_x 68.7500 (71.5625) lr 3.3869e-04 eta 0:00:15
epoch [148/200] batch [15/40] time 0.423 (0.493) data 0.292 (0.362) loss_x loss_x 1.7158 (1.1796) acc_x 62.5000 (70.4167) lr 3.3869e-04 eta 0:00:12
epoch [148/200] batch [20/40] time 0.395 (0.481) data 0.264 (0.350) loss_x loss_x 0.8799 (1.1428) acc_x 78.1250 (71.0938) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [25/40] time 0.552 (0.496) data 0.422 (0.365) loss_x loss_x 1.1709 (1.2027) acc_x 75.0000 (70.2500) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [30/40] time 0.491 (0.489) data 0.360 (0.358) loss_x loss_x 1.2588 (1.2055) acc_x 68.7500 (70.1042) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [35/40] time 0.482 (0.483) data 0.352 (0.352) loss_x loss_x 1.7158 (1.2167) acc_x 59.3750 (69.6429) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [40/40] time 0.450 (0.477) data 0.319 (0.346) loss_x loss_x 1.3066 (1.2078) acc_x 78.1250 (70.1562) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4098, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1285
clean true:1254
clean false:31
clean_rate:0.9758754863813229
noisy true:328
noisy false:1523
after delete: len(clean_dataset) 1285
after delete: len(noisy_dataset) 1851
epoch [149/200] batch [5/40] time 0.436 (0.445) data 0.305 (0.313) loss_x loss_x 0.8896 (1.2943) acc_x 84.3750 (68.7500) lr 3.2699e-04 eta 0:00:15
epoch [149/200] batch [10/40] time 0.444 (0.443) data 0.312 (0.312) loss_x loss_x 1.3350 (1.2866) acc_x 68.7500 (69.6875) lr 3.2699e-04 eta 0:00:13
epoch [149/200] batch [15/40] time 0.447 (0.458) data 0.316 (0.327) loss_x loss_x 1.5928 (1.3213) acc_x 59.3750 (69.1667) lr 3.2699e-04 eta 0:00:11
epoch [149/200] batch [20/40] time 0.417 (0.451) data 0.285 (0.319) loss_x loss_x 1.4736 (1.3013) acc_x 56.2500 (69.2188) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [25/40] time 0.461 (0.452) data 0.329 (0.321) loss_x loss_x 1.3525 (1.3020) acc_x 71.8750 (68.2500) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [30/40] time 0.558 (0.457) data 0.427 (0.326) loss_x loss_x 1.8037 (1.3071) acc_x 62.5000 (67.8125) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [35/40] time 0.524 (0.463) data 0.393 (0.332) loss_x loss_x 0.7422 (1.3023) acc_x 84.3750 (67.9464) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [40/40] time 0.527 (0.465) data 0.398 (0.334) loss_x loss_x 1.1006 (1.2532) acc_x 71.8750 (69.2188) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1279
clean true:1247
clean false:32
clean_rate:0.9749804534792806
noisy true:340
noisy false:1517
after delete: len(clean_dataset) 1279
after delete: len(noisy_dataset) 1857
epoch [150/200] batch [5/39] time 0.541 (0.449) data 0.410 (0.318) loss_x loss_x 1.5850 (1.5189) acc_x 53.1250 (63.1250) lr 3.1545e-04 eta 0:00:15
epoch [150/200] batch [10/39] time 0.468 (0.442) data 0.338 (0.311) loss_x loss_x 1.0605 (1.3643) acc_x 71.8750 (66.2500) lr 3.1545e-04 eta 0:00:12
epoch [150/200] batch [15/39] time 0.414 (0.425) data 0.284 (0.294) loss_x loss_x 1.0293 (1.2653) acc_x 78.1250 (68.7500) lr 3.1545e-04 eta 0:00:10
epoch [150/200] batch [20/39] time 0.472 (0.441) data 0.341 (0.310) loss_x loss_x 1.0312 (1.2298) acc_x 68.7500 (68.5938) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [25/39] time 0.382 (0.442) data 0.252 (0.312) loss_x loss_x 1.6904 (1.2396) acc_x 59.3750 (67.8750) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [30/39] time 0.480 (0.447) data 0.348 (0.317) loss_x loss_x 1.0977 (1.2513) acc_x 68.7500 (67.3958) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [35/39] time 0.465 (0.450) data 0.335 (0.319) loss_x loss_x 0.9062 (1.2502) acc_x 71.8750 (67.6786) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1496
confident_label rate tensor(0.4200, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1317
clean true:1285
clean false:32
clean_rate:0.9757023538344722
noisy true:355
noisy false:1464
after delete: len(clean_dataset) 1317
after delete: len(noisy_dataset) 1819
epoch [151/200] batch [5/41] time 0.452 (0.452) data 0.321 (0.322) loss_x loss_x 1.3037 (1.0085) acc_x 65.6250 (71.2500) lr 3.0409e-04 eta 0:00:16
epoch [151/200] batch [10/41] time 0.454 (0.433) data 0.324 (0.302) loss_x loss_x 1.5488 (1.1492) acc_x 68.7500 (70.6250) lr 3.0409e-04 eta 0:00:13
epoch [151/200] batch [15/41] time 0.421 (0.438) data 0.291 (0.307) loss_x loss_x 0.9204 (1.1419) acc_x 87.5000 (71.6667) lr 3.0409e-04 eta 0:00:11
epoch [151/200] batch [20/41] time 0.598 (0.439) data 0.468 (0.309) loss_x loss_x 0.8252 (1.1498) acc_x 75.0000 (70.7812) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [25/41] time 0.516 (0.446) data 0.384 (0.315) loss_x loss_x 1.2529 (1.1807) acc_x 68.7500 (70.6250) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [30/41] time 0.630 (0.453) data 0.499 (0.322) loss_x loss_x 1.1250 (1.1795) acc_x 78.1250 (71.0417) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [35/41] time 0.427 (0.453) data 0.296 (0.322) loss_x loss_x 0.9902 (1.1623) acc_x 75.0000 (71.0714) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [40/41] time 0.462 (0.456) data 0.331 (0.325) loss_x loss_x 1.4746 (1.1661) acc_x 62.5000 (70.7031) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1486
confident_label rate tensor(0.4232, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1327
clean true:1296
clean false:31
clean_rate:0.9766390354182366
noisy true:354
noisy false:1455
after delete: len(clean_dataset) 1327
after delete: len(noisy_dataset) 1809
epoch [152/200] batch [5/41] time 0.474 (0.512) data 0.343 (0.380) loss_x loss_x 1.3037 (0.9625) acc_x 62.5000 (74.3750) lr 2.9289e-04 eta 0:00:18
epoch [152/200] batch [10/41] time 0.646 (0.514) data 0.515 (0.383) loss_x loss_x 0.7671 (0.9670) acc_x 84.3750 (75.9375) lr 2.9289e-04 eta 0:00:15
epoch [152/200] batch [15/41] time 0.503 (0.503) data 0.373 (0.372) loss_x loss_x 1.1504 (1.0766) acc_x 68.7500 (73.5417) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [20/41] time 0.360 (0.484) data 0.229 (0.353) loss_x loss_x 0.8979 (1.1360) acc_x 81.2500 (72.1875) lr 2.9289e-04 eta 0:00:10
epoch [152/200] batch [25/41] time 0.491 (0.474) data 0.359 (0.343) loss_x loss_x 1.3877 (1.1101) acc_x 65.6250 (72.8750) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [30/41] time 0.520 (0.464) data 0.389 (0.333) loss_x loss_x 1.0850 (1.1508) acc_x 81.2500 (72.0833) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [35/41] time 0.520 (0.471) data 0.389 (0.340) loss_x loss_x 1.2207 (1.1682) acc_x 68.7500 (71.2500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [40/41] time 0.412 (0.474) data 0.281 (0.343) loss_x loss_x 1.5742 (1.2023) acc_x 71.8750 (71.2500) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1548
confident_label rate tensor(0.4126, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1294
clean true:1255
clean false:39
clean_rate:0.9698608964451314
noisy true:333
noisy false:1509
after delete: len(clean_dataset) 1294
after delete: len(noisy_dataset) 1842
epoch [153/200] batch [5/40] time 0.574 (0.484) data 0.442 (0.353) loss_x loss_x 0.9487 (1.1362) acc_x 71.8750 (68.7500) lr 2.8187e-04 eta 0:00:16
epoch [153/200] batch [10/40] time 0.424 (0.477) data 0.292 (0.346) loss_x loss_x 1.1289 (1.1140) acc_x 62.5000 (69.0625) lr 2.8187e-04 eta 0:00:14
epoch [153/200] batch [15/40] time 0.439 (0.457) data 0.307 (0.326) loss_x loss_x 1.1953 (1.0651) acc_x 65.6250 (71.2500) lr 2.8187e-04 eta 0:00:11
epoch [153/200] batch [20/40] time 0.506 (0.467) data 0.376 (0.335) loss_x loss_x 1.0166 (1.0943) acc_x 68.7500 (70.9375) lr 2.8187e-04 eta 0:00:09
epoch [153/200] batch [25/40] time 0.546 (0.479) data 0.415 (0.347) loss_x loss_x 1.3604 (1.0928) acc_x 62.5000 (71.7500) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [30/40] time 0.436 (0.478) data 0.305 (0.347) loss_x loss_x 1.0889 (1.1181) acc_x 71.8750 (71.4583) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [35/40] time 0.540 (0.476) data 0.409 (0.345) loss_x loss_x 1.7178 (1.1443) acc_x 59.3750 (71.2500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [40/40] time 0.398 (0.467) data 0.268 (0.336) loss_x loss_x 1.4688 (1.1517) acc_x 65.6250 (71.0938) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1499
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1325
clean true:1290
clean false:35
clean_rate:0.9735849056603774
noisy true:347
noisy false:1464
after delete: len(clean_dataset) 1325
after delete: len(noisy_dataset) 1811
epoch [154/200] batch [5/41] time 0.454 (0.460) data 0.324 (0.329) loss_x loss_x 1.1133 (1.0037) acc_x 75.0000 (73.7500) lr 2.7103e-04 eta 0:00:16
epoch [154/200] batch [10/41] time 0.404 (0.482) data 0.273 (0.351) loss_x loss_x 1.3047 (1.0141) acc_x 65.6250 (71.8750) lr 2.7103e-04 eta 0:00:14
epoch [154/200] batch [15/41] time 0.364 (0.457) data 0.232 (0.327) loss_x loss_x 1.5020 (1.0714) acc_x 62.5000 (72.2917) lr 2.7103e-04 eta 0:00:11
epoch [154/200] batch [20/41] time 0.512 (0.457) data 0.381 (0.326) loss_x loss_x 1.3838 (1.1520) acc_x 71.8750 (71.2500) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [25/41] time 0.425 (0.462) data 0.294 (0.331) loss_x loss_x 1.3955 (1.2121) acc_x 65.6250 (70.1250) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [30/41] time 0.521 (0.458) data 0.390 (0.328) loss_x loss_x 0.9253 (1.2063) acc_x 87.5000 (69.5833) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [35/41] time 0.419 (0.454) data 0.290 (0.324) loss_x loss_x 1.1016 (1.1663) acc_x 75.0000 (70.2679) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [40/41] time 0.489 (0.456) data 0.359 (0.326) loss_x loss_x 0.9492 (1.1810) acc_x 75.0000 (69.8438) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1531
confident_label rate tensor(0.4145, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1300
clean true:1265
clean false:35
clean_rate:0.9730769230769231
noisy true:340
noisy false:1496
after delete: len(clean_dataset) 1300
after delete: len(noisy_dataset) 1836
epoch [155/200] batch [5/40] time 0.458 (0.431) data 0.328 (0.300) loss_x loss_x 0.8911 (1.1112) acc_x 81.2500 (73.7500) lr 2.6037e-04 eta 0:00:15
epoch [155/200] batch [10/40] time 0.415 (0.437) data 0.285 (0.306) loss_x loss_x 1.1260 (1.1105) acc_x 71.8750 (71.5625) lr 2.6037e-04 eta 0:00:13
epoch [155/200] batch [15/40] time 0.582 (0.449) data 0.452 (0.318) loss_x loss_x 1.1309 (1.1969) acc_x 87.5000 (70.6250) lr 2.6037e-04 eta 0:00:11
epoch [155/200] batch [20/40] time 0.556 (0.457) data 0.425 (0.326) loss_x loss_x 1.2988 (1.2289) acc_x 62.5000 (68.4375) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [25/40] time 0.543 (0.466) data 0.413 (0.335) loss_x loss_x 1.3896 (1.1972) acc_x 62.5000 (69.6250) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [30/40] time 0.522 (0.468) data 0.391 (0.337) loss_x loss_x 0.9990 (1.1614) acc_x 78.1250 (70.9375) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [35/40] time 0.458 (0.473) data 0.327 (0.343) loss_x loss_x 1.0547 (1.1618) acc_x 81.2500 (71.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [40/40] time 0.405 (0.469) data 0.274 (0.338) loss_x loss_x 1.4775 (1.1669) acc_x 59.3750 (70.9375) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1497
confident_label rate tensor(0.4225, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1325
clean true:1287
clean false:38
clean_rate:0.9713207547169811
noisy true:352
noisy false:1459
after delete: len(clean_dataset) 1325
after delete: len(noisy_dataset) 1811
epoch [156/200] batch [5/41] time 0.461 (0.468) data 0.331 (0.337) loss_x loss_x 1.4756 (1.2951) acc_x 71.8750 (68.1250) lr 2.4989e-04 eta 0:00:16
epoch [156/200] batch [10/41] time 0.406 (0.438) data 0.275 (0.307) loss_x loss_x 0.9731 (1.2619) acc_x 62.5000 (68.4375) lr 2.4989e-04 eta 0:00:13
epoch [156/200] batch [15/41] time 0.594 (0.452) data 0.463 (0.322) loss_x loss_x 1.0371 (1.1167) acc_x 84.3750 (73.3333) lr 2.4989e-04 eta 0:00:11
epoch [156/200] batch [20/41] time 0.450 (0.448) data 0.319 (0.318) loss_x loss_x 1.4014 (1.1507) acc_x 71.8750 (72.0312) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [25/41] time 0.484 (0.453) data 0.353 (0.322) loss_x loss_x 1.1797 (1.1455) acc_x 68.7500 (72.1250) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [30/41] time 0.424 (0.446) data 0.294 (0.316) loss_x loss_x 1.1611 (1.1348) acc_x 78.1250 (72.2917) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [35/41] time 0.498 (0.453) data 0.367 (0.322) loss_x loss_x 0.6299 (1.1483) acc_x 81.2500 (71.6964) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [40/41] time 0.514 (0.453) data 0.384 (0.322) loss_x loss_x 1.5508 (1.1448) acc_x 59.3750 (72.1875) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1521
confident_label rate tensor(0.4219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1323
clean true:1288
clean false:35
clean_rate:0.9735449735449735
noisy true:327
noisy false:1486
after delete: len(clean_dataset) 1323
after delete: len(noisy_dataset) 1813
epoch [157/200] batch [5/41] time 0.429 (0.468) data 0.299 (0.338) loss_x loss_x 1.3311 (1.0090) acc_x 65.6250 (74.3750) lr 2.3959e-04 eta 0:00:16
epoch [157/200] batch [10/41] time 0.459 (0.472) data 0.328 (0.342) loss_x loss_x 1.3477 (1.1172) acc_x 62.5000 (71.8750) lr 2.3959e-04 eta 0:00:14
epoch [157/200] batch [15/41] time 0.516 (0.467) data 0.385 (0.336) loss_x loss_x 0.9546 (1.1089) acc_x 65.6250 (71.6667) lr 2.3959e-04 eta 0:00:12
epoch [157/200] batch [20/41] time 0.362 (0.452) data 0.232 (0.321) loss_x loss_x 0.9023 (1.1389) acc_x 78.1250 (70.1562) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [25/41] time 0.498 (0.450) data 0.367 (0.319) loss_x loss_x 1.1426 (1.1177) acc_x 68.7500 (69.8750) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [30/41] time 0.515 (0.452) data 0.384 (0.321) loss_x loss_x 1.0674 (1.1368) acc_x 62.5000 (69.0625) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [35/41] time 0.397 (0.452) data 0.266 (0.321) loss_x loss_x 0.9575 (1.1376) acc_x 81.2500 (69.8214) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [40/41] time 0.384 (0.451) data 0.253 (0.320) loss_x loss_x 1.6250 (1.1516) acc_x 56.2500 (70.0781) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1542
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1278
clean true:1248
clean false:30
clean_rate:0.9765258215962441
noisy true:346
noisy false:1512
after delete: len(clean_dataset) 1278
after delete: len(noisy_dataset) 1858
epoch [158/200] batch [5/39] time 0.514 (0.487) data 0.383 (0.356) loss_x loss_x 1.2275 (1.2363) acc_x 68.7500 (70.0000) lr 2.2949e-04 eta 0:00:16
epoch [158/200] batch [10/39] time 0.418 (0.468) data 0.288 (0.337) loss_x loss_x 1.0596 (1.2225) acc_x 75.0000 (72.8125) lr 2.2949e-04 eta 0:00:13
epoch [158/200] batch [15/39] time 0.371 (0.462) data 0.240 (0.331) loss_x loss_x 1.2656 (1.1313) acc_x 65.6250 (74.3750) lr 2.2949e-04 eta 0:00:11
epoch [158/200] batch [20/39] time 0.369 (0.455) data 0.239 (0.324) loss_x loss_x 1.2227 (1.1193) acc_x 65.6250 (74.0625) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [25/39] time 0.361 (0.445) data 0.230 (0.314) loss_x loss_x 1.4609 (1.1285) acc_x 62.5000 (72.7500) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [30/39] time 0.399 (0.445) data 0.268 (0.314) loss_x loss_x 0.8970 (1.1111) acc_x 84.3750 (72.9167) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [35/39] time 0.527 (0.446) data 0.397 (0.315) loss_x loss_x 0.8999 (1.1142) acc_x 81.2500 (73.0357) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1542
confident_label rate tensor(0.4123, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1293
clean true:1253
clean false:40
clean_rate:0.9690641918020109
noisy true:341
noisy false:1502
after delete: len(clean_dataset) 1293
after delete: len(noisy_dataset) 1843
epoch [159/200] batch [5/40] time 0.389 (0.460) data 0.259 (0.329) loss_x loss_x 1.2158 (1.2693) acc_x 65.6250 (67.5000) lr 2.1957e-04 eta 0:00:16
epoch [159/200] batch [10/40] time 0.511 (0.453) data 0.380 (0.323) loss_x loss_x 1.3193 (1.3230) acc_x 65.6250 (64.6875) lr 2.1957e-04 eta 0:00:13
epoch [159/200] batch [15/40] time 0.401 (0.459) data 0.271 (0.328) loss_x loss_x 1.4512 (1.2982) acc_x 65.6250 (66.6667) lr 2.1957e-04 eta 0:00:11
epoch [159/200] batch [20/40] time 0.473 (0.459) data 0.343 (0.328) loss_x loss_x 1.1543 (1.3297) acc_x 71.8750 (65.7812) lr 2.1957e-04 eta 0:00:09
epoch [159/200] batch [25/40] time 0.445 (0.452) data 0.315 (0.322) loss_x loss_x 0.8335 (1.2618) acc_x 71.8750 (67.6250) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [30/40] time 0.476 (0.451) data 0.346 (0.320) loss_x loss_x 1.4473 (1.2609) acc_x 62.5000 (67.8125) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [35/40] time 0.553 (0.456) data 0.422 (0.325) loss_x loss_x 0.9985 (1.2289) acc_x 75.0000 (68.9286) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [40/40] time 0.490 (0.456) data 0.358 (0.325) loss_x loss_x 1.0674 (1.2073) acc_x 68.7500 (69.2188) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1519
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1333
clean true:1292
clean false:41
clean_rate:0.9692423105776444
noisy true:325
noisy false:1478
after delete: len(clean_dataset) 1333
after delete: len(noisy_dataset) 1803
epoch [160/200] batch [5/41] time 0.365 (0.482) data 0.233 (0.351) loss_x loss_x 1.0752 (1.3063) acc_x 71.8750 (68.7500) lr 2.0984e-04 eta 0:00:17
epoch [160/200] batch [10/41] time 0.371 (0.480) data 0.240 (0.349) loss_x loss_x 1.2461 (1.1946) acc_x 75.0000 (72.1875) lr 2.0984e-04 eta 0:00:14
epoch [160/200] batch [15/41] time 0.420 (0.477) data 0.289 (0.346) loss_x loss_x 1.0205 (1.1444) acc_x 71.8750 (72.0833) lr 2.0984e-04 eta 0:00:12
epoch [160/200] batch [20/41] time 0.463 (0.472) data 0.332 (0.342) loss_x loss_x 0.8340 (1.1579) acc_x 81.2500 (72.0312) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [25/41] time 0.366 (0.468) data 0.234 (0.337) loss_x loss_x 1.2402 (1.1525) acc_x 65.6250 (71.7500) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [30/41] time 0.421 (0.466) data 0.290 (0.335) loss_x loss_x 1.4863 (1.1309) acc_x 59.3750 (71.8750) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [35/41] time 0.351 (0.460) data 0.221 (0.329) loss_x loss_x 0.9438 (1.1615) acc_x 75.0000 (70.6250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [40/41] time 0.402 (0.460) data 0.272 (0.329) loss_x loss_x 1.4961 (1.1760) acc_x 59.3750 (70.4688) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1494
confident_label rate tensor(0.4228, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1326
clean true:1291
clean false:35
clean_rate:0.973604826546003
noisy true:351
noisy false:1459
after delete: len(clean_dataset) 1326
after delete: len(noisy_dataset) 1810
epoch [161/200] batch [5/41] time 0.540 (0.473) data 0.410 (0.343) loss_x loss_x 1.4414 (1.1050) acc_x 59.3750 (71.8750) lr 2.0032e-04 eta 0:00:17
epoch [161/200] batch [10/41] time 0.433 (0.441) data 0.302 (0.310) loss_x loss_x 1.1816 (1.1648) acc_x 56.2500 (70.3125) lr 2.0032e-04 eta 0:00:13
epoch [161/200] batch [15/41] time 0.405 (0.432) data 0.274 (0.301) loss_x loss_x 1.6934 (1.1756) acc_x 65.6250 (71.0417) lr 2.0032e-04 eta 0:00:11
epoch [161/200] batch [20/41] time 0.501 (0.440) data 0.370 (0.310) loss_x loss_x 1.3408 (1.1467) acc_x 75.0000 (71.5625) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [25/41] time 0.510 (0.450) data 0.379 (0.319) loss_x loss_x 1.3613 (1.1462) acc_x 68.7500 (71.2500) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [30/41] time 0.512 (0.451) data 0.381 (0.321) loss_x loss_x 1.5439 (1.2089) acc_x 59.3750 (69.3750) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [35/41] time 0.547 (0.453) data 0.416 (0.322) loss_x loss_x 1.5859 (1.2370) acc_x 65.6250 (69.8214) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [40/41] time 0.591 (0.466) data 0.459 (0.335) loss_x loss_x 1.4473 (1.2175) acc_x 59.3750 (69.5312) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1534
confident_label rate tensor(0.4149, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1301
clean true:1264
clean false:37
clean_rate:0.9715603382013835
noisy true:338
noisy false:1497
after delete: len(clean_dataset) 1301
after delete: len(noisy_dataset) 1835
epoch [162/200] batch [5/40] time 0.503 (0.519) data 0.373 (0.388) loss_x loss_x 0.8311 (0.9914) acc_x 84.3750 (75.6250) lr 1.9098e-04 eta 0:00:18
epoch [162/200] batch [10/40] time 0.439 (0.492) data 0.308 (0.361) loss_x loss_x 0.9766 (1.0490) acc_x 75.0000 (74.0625) lr 1.9098e-04 eta 0:00:14
epoch [162/200] batch [15/40] time 0.356 (0.483) data 0.225 (0.352) loss_x loss_x 1.3584 (1.0153) acc_x 62.5000 (73.7500) lr 1.9098e-04 eta 0:00:12
epoch [162/200] batch [20/40] time 0.323 (0.462) data 0.193 (0.331) loss_x loss_x 1.0273 (1.0339) acc_x 71.8750 (73.2812) lr 1.9098e-04 eta 0:00:09
epoch [162/200] batch [25/40] time 0.481 (0.459) data 0.349 (0.328) loss_x loss_x 0.8262 (1.0384) acc_x 71.8750 (73.0000) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [30/40] time 0.466 (0.461) data 0.336 (0.330) loss_x loss_x 0.6963 (1.0728) acc_x 84.3750 (72.0833) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [35/40] time 0.342 (0.461) data 0.211 (0.331) loss_x loss_x 1.3076 (1.0987) acc_x 68.7500 (71.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [40/40] time 0.471 (0.461) data 0.340 (0.330) loss_x loss_x 1.7148 (1.1403) acc_x 59.3750 (71.0938) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1512
confident_label rate tensor(0.4235, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1328
clean true:1288
clean false:40
clean_rate:0.9698795180722891
noisy true:336
noisy false:1472
after delete: len(clean_dataset) 1328
after delete: len(noisy_dataset) 1808
epoch [163/200] batch [5/41] time 0.531 (0.498) data 0.400 (0.367) loss_x loss_x 1.3984 (1.4123) acc_x 62.5000 (67.5000) lr 1.8185e-04 eta 0:00:17
epoch [163/200] batch [10/41] time 0.388 (0.476) data 0.257 (0.345) loss_x loss_x 1.4453 (1.3240) acc_x 68.7500 (69.3750) lr 1.8185e-04 eta 0:00:14
epoch [163/200] batch [15/41] time 0.511 (0.465) data 0.381 (0.334) loss_x loss_x 0.9258 (1.2829) acc_x 78.1250 (68.9583) lr 1.8185e-04 eta 0:00:12
epoch [163/200] batch [20/41] time 0.488 (0.472) data 0.358 (0.342) loss_x loss_x 0.8745 (1.2235) acc_x 81.2500 (69.5312) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [25/41] time 0.459 (0.469) data 0.328 (0.338) loss_x loss_x 1.1016 (1.2190) acc_x 75.0000 (70.0000) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [30/41] time 0.447 (0.464) data 0.315 (0.333) loss_x loss_x 0.8735 (1.1742) acc_x 84.3750 (71.1458) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [35/41] time 0.533 (0.466) data 0.401 (0.335) loss_x loss_x 1.2480 (1.1802) acc_x 68.7500 (71.1607) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [40/41] time 0.531 (0.472) data 0.401 (0.341) loss_x loss_x 1.4775 (1.1920) acc_x 62.5000 (70.7031) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1523
confident_label rate tensor(0.4212, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1321
clean true:1285
clean false:36
clean_rate:0.9727479182437547
noisy true:328
noisy false:1487
after delete: len(clean_dataset) 1321
after delete: len(noisy_dataset) 1815
epoch [164/200] batch [5/41] time 0.467 (0.470) data 0.337 (0.339) loss_x loss_x 0.8066 (1.2203) acc_x 71.8750 (66.8750) lr 1.7292e-04 eta 0:00:16
epoch [164/200] batch [10/41] time 0.410 (0.461) data 0.279 (0.330) loss_x loss_x 0.7612 (1.0352) acc_x 78.1250 (73.1250) lr 1.7292e-04 eta 0:00:14
epoch [164/200] batch [15/41] time 0.488 (0.463) data 0.356 (0.332) loss_x loss_x 0.7139 (1.0505) acc_x 90.6250 (72.7083) lr 1.7292e-04 eta 0:00:12
epoch [164/200] batch [20/41] time 0.512 (0.467) data 0.381 (0.336) loss_x loss_x 0.9043 (1.0896) acc_x 75.0000 (71.7188) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [25/41] time 0.455 (0.465) data 0.325 (0.335) loss_x loss_x 1.2666 (1.0855) acc_x 65.6250 (71.7500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [30/41] time 0.596 (0.468) data 0.465 (0.337) loss_x loss_x 1.2783 (1.1036) acc_x 78.1250 (72.1875) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [35/41] time 0.444 (0.466) data 0.314 (0.335) loss_x loss_x 1.0664 (1.1114) acc_x 71.8750 (72.5893) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [40/41] time 0.428 (0.462) data 0.297 (0.331) loss_x loss_x 0.9858 (1.1296) acc_x 68.7500 (71.5625) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1554
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1280
clean true:1239
clean false:41
clean_rate:0.96796875
noisy true:343
noisy false:1513
after delete: len(clean_dataset) 1280
after delete: len(noisy_dataset) 1856
epoch [165/200] batch [5/40] time 0.580 (0.499) data 0.449 (0.368) loss_x loss_x 1.0752 (1.2471) acc_x 68.7500 (70.6250) lr 1.6419e-04 eta 0:00:17
epoch [165/200] batch [10/40] time 0.437 (0.468) data 0.307 (0.337) loss_x loss_x 1.0625 (1.2605) acc_x 65.6250 (69.0625) lr 1.6419e-04 eta 0:00:14
epoch [165/200] batch [15/40] time 0.407 (0.473) data 0.276 (0.342) loss_x loss_x 1.3135 (1.1588) acc_x 71.8750 (71.2500) lr 1.6419e-04 eta 0:00:11
epoch [165/200] batch [20/40] time 0.381 (0.489) data 0.250 (0.358) loss_x loss_x 1.4092 (1.1906) acc_x 65.6250 (69.6875) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [25/40] time 0.528 (0.494) data 0.397 (0.364) loss_x loss_x 1.0508 (1.1871) acc_x 78.1250 (69.8750) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [30/40] time 0.391 (0.483) data 0.260 (0.352) loss_x loss_x 1.7803 (1.2102) acc_x 62.5000 (69.3750) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [35/40] time 0.480 (0.476) data 0.349 (0.345) loss_x loss_x 1.5801 (1.1881) acc_x 59.3750 (70.0893) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [40/40] time 0.462 (0.478) data 0.331 (0.347) loss_x loss_x 0.9238 (1.1739) acc_x 71.8750 (70.4688) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4247, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1332
clean true:1299
clean false:33
clean_rate:0.9752252252252253
noisy true:313
noisy false:1491
after delete: len(clean_dataset) 1332
after delete: len(noisy_dataset) 1804
epoch [166/200] batch [5/41] time 0.456 (0.463) data 0.326 (0.333) loss_x loss_x 1.3994 (1.0609) acc_x 71.8750 (71.8750) lr 1.5567e-04 eta 0:00:16
epoch [166/200] batch [10/41] time 0.487 (0.510) data 0.356 (0.380) loss_x loss_x 1.4287 (1.1777) acc_x 65.6250 (70.0000) lr 1.5567e-04 eta 0:00:15
epoch [166/200] batch [15/41] time 0.447 (0.507) data 0.316 (0.376) loss_x loss_x 1.2812 (1.2489) acc_x 62.5000 (68.3333) lr 1.5567e-04 eta 0:00:13
epoch [166/200] batch [20/41] time 0.396 (0.491) data 0.265 (0.360) loss_x loss_x 0.8047 (1.2000) acc_x 75.0000 (69.3750) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [25/41] time 0.416 (0.485) data 0.285 (0.354) loss_x loss_x 0.7446 (1.2222) acc_x 87.5000 (68.6250) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [30/41] time 0.448 (0.486) data 0.318 (0.355) loss_x loss_x 0.8979 (1.2251) acc_x 78.1250 (68.3333) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [35/41] time 0.500 (0.478) data 0.370 (0.347) loss_x loss_x 1.0078 (1.2094) acc_x 71.8750 (68.6607) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [40/41] time 0.442 (0.474) data 0.311 (0.343) loss_x loss_x 1.0322 (1.2089) acc_x 81.2500 (69.2969) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1503
confident_label rate tensor(0.4209, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1320
clean true:1287
clean false:33
clean_rate:0.975
noisy true:346
noisy false:1470
after delete: len(clean_dataset) 1320
after delete: len(noisy_dataset) 1816
epoch [167/200] batch [5/41] time 0.498 (0.420) data 0.366 (0.289) loss_x loss_x 1.4707 (1.0749) acc_x 59.3750 (70.0000) lr 1.4736e-04 eta 0:00:15
epoch [167/200] batch [10/41] time 0.362 (0.424) data 0.232 (0.293) loss_x loss_x 1.2012 (1.1121) acc_x 75.0000 (70.6250) lr 1.4736e-04 eta 0:00:13
epoch [167/200] batch [15/41] time 0.352 (0.435) data 0.221 (0.305) loss_x loss_x 1.2607 (1.1020) acc_x 65.6250 (69.5833) lr 1.4736e-04 eta 0:00:11
epoch [167/200] batch [20/41] time 0.506 (0.453) data 0.375 (0.322) loss_x loss_x 1.0156 (1.0975) acc_x 71.8750 (69.8438) lr 1.4736e-04 eta 0:00:09
epoch [167/200] batch [25/41] time 0.531 (0.455) data 0.400 (0.324) loss_x loss_x 0.8345 (1.0980) acc_x 75.0000 (69.8750) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [30/41] time 0.401 (0.463) data 0.270 (0.332) loss_x loss_x 1.5869 (1.1268) acc_x 53.1250 (69.4792) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [35/41] time 0.547 (0.469) data 0.415 (0.338) loss_x loss_x 1.1006 (1.1398) acc_x 71.8750 (69.7321) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [40/41] time 0.471 (0.470) data 0.339 (0.339) loss_x loss_x 1.4619 (1.1511) acc_x 68.7500 (69.6094) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1506
confident_label rate tensor(0.4212, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1321
clean true:1292
clean false:29
clean_rate:0.9780469341408025
noisy true:338
noisy false:1477
after delete: len(clean_dataset) 1321
after delete: len(noisy_dataset) 1815
epoch [168/200] batch [5/41] time 0.371 (0.402) data 0.239 (0.270) loss_x loss_x 1.4619 (0.9966) acc_x 59.3750 (77.5000) lr 1.3926e-04 eta 0:00:14
epoch [168/200] batch [10/41] time 0.443 (0.421) data 0.312 (0.290) loss_x loss_x 0.7178 (1.1049) acc_x 78.1250 (74.0625) lr 1.3926e-04 eta 0:00:13
epoch [168/200] batch [15/41] time 0.563 (0.442) data 0.432 (0.311) loss_x loss_x 1.1133 (1.0910) acc_x 68.7500 (73.3333) lr 1.3926e-04 eta 0:00:11
epoch [168/200] batch [20/41] time 0.406 (0.456) data 0.276 (0.325) loss_x loss_x 1.0020 (1.1152) acc_x 71.8750 (71.7188) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [25/41] time 0.510 (0.452) data 0.380 (0.321) loss_x loss_x 0.8267 (1.1296) acc_x 68.7500 (70.7500) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [30/41] time 0.380 (0.453) data 0.249 (0.322) loss_x loss_x 1.3633 (1.1260) acc_x 62.5000 (70.3125) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [35/41] time 0.409 (0.451) data 0.278 (0.320) loss_x loss_x 1.1875 (1.1582) acc_x 71.8750 (69.7321) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [40/41] time 0.498 (0.455) data 0.368 (0.324) loss_x loss_x 1.0742 (1.1647) acc_x 65.6250 (69.4531) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1545
confident_label rate tensor(0.4133, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1296
clean true:1254
clean false:42
clean_rate:0.9675925925925926
noisy true:337
noisy false:1503
after delete: len(clean_dataset) 1296
after delete: len(noisy_dataset) 1840
epoch [169/200] batch [5/40] time 0.612 (0.475) data 0.481 (0.343) loss_x loss_x 1.4072 (1.2669) acc_x 68.7500 (71.2500) lr 1.3137e-04 eta 0:00:16
epoch [169/200] batch [10/40] time 0.502 (0.497) data 0.372 (0.366) loss_x loss_x 1.5020 (1.2689) acc_x 68.7500 (71.5625) lr 1.3137e-04 eta 0:00:14
epoch [169/200] batch [15/40] time 0.534 (0.485) data 0.403 (0.354) loss_x loss_x 0.8921 (1.2110) acc_x 84.3750 (72.5000) lr 1.3137e-04 eta 0:00:12
epoch [169/200] batch [20/40] time 0.385 (0.476) data 0.254 (0.345) loss_x loss_x 1.3867 (1.2314) acc_x 62.5000 (71.7188) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [25/40] time 0.383 (0.471) data 0.251 (0.340) loss_x loss_x 1.2139 (1.1911) acc_x 75.0000 (72.5000) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [30/40] time 0.479 (0.477) data 0.349 (0.346) loss_x loss_x 1.3125 (1.1953) acc_x 65.6250 (71.5625) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [35/40] time 0.479 (0.474) data 0.348 (0.343) loss_x loss_x 0.9810 (1.1793) acc_x 71.8750 (71.6964) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [40/40] time 0.572 (0.470) data 0.441 (0.339) loss_x loss_x 1.0742 (1.1776) acc_x 65.6250 (71.0156) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1491
confident_label rate tensor(0.4286, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1344
clean true:1302
clean false:42
clean_rate:0.96875
noisy true:343
noisy false:1449
after delete: len(clean_dataset) 1344
after delete: len(noisy_dataset) 1792
epoch [170/200] batch [5/42] time 0.514 (0.465) data 0.384 (0.334) loss_x loss_x 1.4238 (1.2502) acc_x 62.5000 (63.7500) lr 1.2369e-04 eta 0:00:17
epoch [170/200] batch [10/42] time 0.452 (0.457) data 0.321 (0.326) loss_x loss_x 2.2246 (1.2994) acc_x 50.0000 (65.3125) lr 1.2369e-04 eta 0:00:14
epoch [170/200] batch [15/42] time 0.452 (0.464) data 0.322 (0.333) loss_x loss_x 0.8389 (1.3005) acc_x 78.1250 (66.6667) lr 1.2369e-04 eta 0:00:12
epoch [170/200] batch [20/42] time 0.363 (0.454) data 0.232 (0.323) loss_x loss_x 0.6890 (1.2423) acc_x 87.5000 (67.9688) lr 1.2369e-04 eta 0:00:09
epoch [170/200] batch [25/42] time 0.481 (0.457) data 0.350 (0.326) loss_x loss_x 1.2549 (1.1769) acc_x 65.6250 (69.8750) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [30/42] time 0.430 (0.449) data 0.299 (0.318) loss_x loss_x 1.0371 (1.1885) acc_x 78.1250 (70.2083) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [35/42] time 0.504 (0.459) data 0.373 (0.328) loss_x loss_x 1.5615 (1.1940) acc_x 65.6250 (70.1786) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [40/42] time 0.393 (0.455) data 0.262 (0.324) loss_x loss_x 1.6055 (1.1910) acc_x 65.6250 (70.3906) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1508
confident_label rate tensor(0.4238, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1329
clean true:1288
clean false:41
clean_rate:0.9691497366440933
noisy true:340
noisy false:1467
after delete: len(clean_dataset) 1329
after delete: len(noisy_dataset) 1807
epoch [171/200] batch [5/41] time 0.431 (0.469) data 0.300 (0.338) loss_x loss_x 1.1865 (1.0578) acc_x 71.8750 (76.2500) lr 1.1623e-04 eta 0:00:16
epoch [171/200] batch [10/41] time 0.469 (0.476) data 0.339 (0.345) loss_x loss_x 1.7080 (1.2086) acc_x 59.3750 (71.5625) lr 1.1623e-04 eta 0:00:14
epoch [171/200] batch [15/41] time 0.542 (0.481) data 0.411 (0.350) loss_x loss_x 1.2500 (1.2320) acc_x 84.3750 (70.8333) lr 1.1623e-04 eta 0:00:12
epoch [171/200] batch [20/41] time 0.421 (0.482) data 0.290 (0.351) loss_x loss_x 1.1484 (1.2133) acc_x 71.8750 (70.6250) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [25/41] time 0.334 (0.470) data 0.204 (0.339) loss_x loss_x 1.6055 (1.2230) acc_x 59.3750 (69.6250) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [30/41] time 0.414 (0.472) data 0.283 (0.341) loss_x loss_x 1.2812 (1.2225) acc_x 71.8750 (70.0000) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [35/41] time 0.476 (0.474) data 0.345 (0.343) loss_x loss_x 1.5234 (1.2323) acc_x 53.1250 (69.4643) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [40/41] time 0.363 (0.468) data 0.232 (0.337) loss_x loss_x 0.9814 (1.2026) acc_x 65.6250 (69.8438) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1464
confident_label rate tensor(0.4365, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1369
clean true:1326
clean false:43
clean_rate:0.9685902118334551
noisy true:346
noisy false:1421
after delete: len(clean_dataset) 1369
after delete: len(noisy_dataset) 1767
epoch [172/200] batch [5/42] time 0.562 (0.465) data 0.431 (0.334) loss_x loss_x 1.3545 (1.2476) acc_x 59.3750 (67.5000) lr 1.0899e-04 eta 0:00:17
epoch [172/200] batch [10/42] time 0.591 (0.456) data 0.461 (0.325) loss_x loss_x 1.2480 (1.2048) acc_x 71.8750 (70.9375) lr 1.0899e-04 eta 0:00:14
epoch [172/200] batch [15/42] time 0.398 (0.447) data 0.267 (0.316) loss_x loss_x 1.4346 (1.2464) acc_x 62.5000 (70.6250) lr 1.0899e-04 eta 0:00:12
epoch [172/200] batch [20/42] time 0.387 (0.457) data 0.256 (0.326) loss_x loss_x 1.1709 (1.1760) acc_x 71.8750 (71.7188) lr 1.0899e-04 eta 0:00:10
epoch [172/200] batch [25/42] time 0.546 (0.456) data 0.415 (0.325) loss_x loss_x 0.8223 (1.1887) acc_x 78.1250 (71.0000) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [30/42] time 0.458 (0.454) data 0.326 (0.324) loss_x loss_x 1.2471 (1.1877) acc_x 62.5000 (69.2708) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [35/42] time 0.579 (0.472) data 0.448 (0.342) loss_x loss_x 0.9082 (1.1654) acc_x 71.8750 (69.7321) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [40/42] time 0.579 (0.475) data 0.449 (0.345) loss_x loss_x 1.3682 (1.1802) acc_x 59.3750 (69.4531) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1522
confident_label rate tensor(0.4216, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1322
clean true:1287
clean false:35
clean_rate:0.9735249621785174
noisy true:327
noisy false:1487
after delete: len(clean_dataset) 1322
after delete: len(noisy_dataset) 1814
epoch [173/200] batch [5/41] time 0.435 (0.487) data 0.304 (0.355) loss_x loss_x 1.2012 (1.0321) acc_x 68.7500 (73.1250) lr 1.0197e-04 eta 0:00:17
epoch [173/200] batch [10/41] time 0.577 (0.479) data 0.445 (0.348) loss_x loss_x 1.3965 (1.1252) acc_x 62.5000 (72.5000) lr 1.0197e-04 eta 0:00:14
epoch [173/200] batch [15/41] time 0.388 (0.469) data 0.255 (0.337) loss_x loss_x 0.9683 (1.1672) acc_x 71.8750 (71.6667) lr 1.0197e-04 eta 0:00:12
epoch [173/200] batch [20/41] time 0.603 (0.468) data 0.473 (0.337) loss_x loss_x 1.3730 (1.1761) acc_x 68.7500 (71.2500) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [25/41] time 0.421 (0.467) data 0.291 (0.336) loss_x loss_x 1.1953 (1.1612) acc_x 75.0000 (71.5000) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [30/41] time 0.393 (0.467) data 0.262 (0.336) loss_x loss_x 1.4287 (1.1571) acc_x 65.6250 (71.3542) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [35/41] time 0.480 (0.462) data 0.350 (0.331) loss_x loss_x 0.8779 (1.1606) acc_x 78.1250 (71.1607) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [40/41] time 0.408 (0.457) data 0.276 (0.326) loss_x loss_x 0.8936 (1.1598) acc_x 68.7500 (70.9375) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1304
clean true:1267
clean false:37
clean_rate:0.9716257668711656
noisy true:345
noisy false:1487
after delete: len(clean_dataset) 1304
after delete: len(noisy_dataset) 1832
epoch [174/200] batch [5/40] time 0.619 (0.479) data 0.488 (0.348) loss_x loss_x 1.1494 (1.1681) acc_x 75.0000 (72.5000) lr 9.5173e-05 eta 0:00:16
epoch [174/200] batch [10/40] time 0.416 (0.460) data 0.285 (0.329) loss_x loss_x 0.7817 (1.2019) acc_x 81.2500 (70.3125) lr 9.5173e-05 eta 0:00:13
epoch [174/200] batch [15/40] time 0.406 (0.463) data 0.275 (0.332) loss_x loss_x 1.0762 (1.1933) acc_x 75.0000 (70.8333) lr 9.5173e-05 eta 0:00:11
epoch [174/200] batch [20/40] time 0.358 (0.454) data 0.228 (0.323) loss_x loss_x 1.1328 (1.1829) acc_x 71.8750 (70.9375) lr 9.5173e-05 eta 0:00:09
epoch [174/200] batch [25/40] time 0.487 (0.463) data 0.357 (0.332) loss_x loss_x 1.0664 (1.1935) acc_x 81.2500 (71.6250) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [30/40] time 0.455 (0.457) data 0.324 (0.326) loss_x loss_x 0.9761 (1.1856) acc_x 78.1250 (71.1458) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [35/40] time 0.504 (0.457) data 0.373 (0.326) loss_x loss_x 0.9448 (1.1591) acc_x 84.3750 (71.2500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [40/40] time 0.511 (0.457) data 0.381 (0.326) loss_x loss_x 1.2285 (1.1543) acc_x 59.3750 (71.3281) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1514
confident_label rate tensor(0.4212, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1321
clean true:1286
clean false:35
clean_rate:0.9735049205147616
noisy true:336
noisy false:1479
after delete: len(clean_dataset) 1321
after delete: len(noisy_dataset) 1815
epoch [175/200] batch [5/41] time 0.438 (0.420) data 0.307 (0.289) loss_x loss_x 1.1699 (1.1296) acc_x 68.7500 (70.0000) lr 8.8597e-05 eta 0:00:15
epoch [175/200] batch [10/41] time 0.356 (0.404) data 0.225 (0.273) loss_x loss_x 1.7842 (1.1687) acc_x 62.5000 (71.2500) lr 8.8597e-05 eta 0:00:12
epoch [175/200] batch [15/41] time 0.411 (0.411) data 0.280 (0.280) loss_x loss_x 1.2539 (1.1291) acc_x 62.5000 (71.0417) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [20/41] time 0.415 (0.419) data 0.284 (0.288) loss_x loss_x 1.5391 (1.1640) acc_x 62.5000 (70.6250) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [25/41] time 0.469 (0.429) data 0.337 (0.298) loss_x loss_x 0.8262 (1.1386) acc_x 81.2500 (71.6250) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [30/41] time 0.442 (0.436) data 0.311 (0.305) loss_x loss_x 1.0186 (1.1388) acc_x 75.0000 (71.4583) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [35/41] time 0.361 (0.440) data 0.230 (0.309) loss_x loss_x 1.0068 (1.1410) acc_x 75.0000 (71.5179) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [40/41] time 0.453 (0.446) data 0.322 (0.316) loss_x loss_x 1.2998 (1.1406) acc_x 68.7500 (71.4844) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1487
confident_label rate tensor(0.4330, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1358
clean true:1314
clean false:44
clean_rate:0.96759941089838
noisy true:335
noisy false:1443
after delete: len(clean_dataset) 1358
after delete: len(noisy_dataset) 1778
epoch [176/200] batch [5/42] time 0.506 (0.469) data 0.375 (0.337) loss_x loss_x 1.2578 (1.1519) acc_x 71.8750 (68.7500) lr 8.2245e-05 eta 0:00:17
epoch [176/200] batch [10/42] time 0.459 (0.472) data 0.328 (0.341) loss_x loss_x 1.0791 (1.0956) acc_x 68.7500 (70.6250) lr 8.2245e-05 eta 0:00:15
epoch [176/200] batch [15/42] time 0.549 (0.473) data 0.419 (0.342) loss_x loss_x 1.3301 (1.0911) acc_x 65.6250 (70.0000) lr 8.2245e-05 eta 0:00:12
epoch [176/200] batch [20/42] time 0.466 (0.470) data 0.336 (0.339) loss_x loss_x 1.5811 (1.1158) acc_x 65.6250 (70.7812) lr 8.2245e-05 eta 0:00:10
epoch [176/200] batch [25/42] time 0.440 (0.459) data 0.310 (0.328) loss_x loss_x 1.0811 (1.1456) acc_x 75.0000 (71.1250) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [30/42] time 0.549 (0.453) data 0.418 (0.322) loss_x loss_x 1.3232 (1.1584) acc_x 65.6250 (70.9375) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [35/42] time 0.484 (0.450) data 0.353 (0.319) loss_x loss_x 1.0439 (1.1575) acc_x 75.0000 (70.9821) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [40/42] time 0.450 (0.452) data 0.320 (0.321) loss_x loss_x 1.2061 (1.1660) acc_x 68.7500 (71.0156) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1537
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1306
clean true:1275
clean false:31
clean_rate:0.9762633996937213
noisy true:324
noisy false:1506
after delete: len(clean_dataset) 1306
after delete: len(noisy_dataset) 1830
epoch [177/200] batch [5/40] time 0.385 (0.452) data 0.254 (0.321) loss_x loss_x 1.1143 (1.0930) acc_x 68.7500 (70.0000) lr 7.6120e-05 eta 0:00:15
epoch [177/200] batch [10/40] time 0.500 (0.440) data 0.370 (0.309) loss_x loss_x 1.0840 (1.0219) acc_x 71.8750 (70.9375) lr 7.6120e-05 eta 0:00:13
epoch [177/200] batch [15/40] time 0.518 (0.470) data 0.386 (0.338) loss_x loss_x 1.1465 (1.0278) acc_x 71.8750 (71.0417) lr 7.6120e-05 eta 0:00:11
epoch [177/200] batch [20/40] time 0.389 (0.483) data 0.258 (0.352) loss_x loss_x 0.9434 (1.0457) acc_x 65.6250 (70.4688) lr 7.6120e-05 eta 0:00:09
epoch [177/200] batch [25/40] time 0.423 (0.479) data 0.292 (0.347) loss_x loss_x 1.0684 (1.0305) acc_x 71.8750 (71.0000) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [30/40] time 0.499 (0.476) data 0.368 (0.345) loss_x loss_x 1.6865 (1.0805) acc_x 53.1250 (69.8958) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [35/40] time 0.504 (0.468) data 0.373 (0.337) loss_x loss_x 0.8438 (1.1304) acc_x 84.3750 (69.4643) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [40/40] time 0.538 (0.466) data 0.408 (0.335) loss_x loss_x 1.1631 (1.1256) acc_x 65.6250 (69.2969) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1483
confident_label rate tensor(0.4305, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1350
clean true:1307
clean false:43
clean_rate:0.9681481481481482
noisy true:346
noisy false:1440
after delete: len(clean_dataset) 1350
after delete: len(noisy_dataset) 1786
epoch [178/200] batch [5/42] time 0.449 (0.427) data 0.318 (0.296) loss_x loss_x 0.9561 (1.0982) acc_x 81.2500 (74.3750) lr 7.0224e-05 eta 0:00:15
epoch [178/200] batch [10/42] time 0.415 (0.471) data 0.285 (0.340) loss_x loss_x 0.7231 (1.1247) acc_x 87.5000 (74.6875) lr 7.0224e-05 eta 0:00:15
epoch [178/200] batch [15/42] time 0.453 (0.462) data 0.322 (0.331) loss_x loss_x 1.3740 (1.1164) acc_x 65.6250 (73.7500) lr 7.0224e-05 eta 0:00:12
epoch [178/200] batch [20/42] time 0.519 (0.468) data 0.388 (0.338) loss_x loss_x 0.7866 (1.0955) acc_x 78.1250 (74.5312) lr 7.0224e-05 eta 0:00:10
epoch [178/200] batch [25/42] time 0.437 (0.464) data 0.306 (0.333) loss_x loss_x 0.9111 (1.1035) acc_x 71.8750 (73.2500) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [30/42] time 0.694 (0.469) data 0.563 (0.338) loss_x loss_x 1.3154 (1.1472) acc_x 62.5000 (71.6667) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [35/42] time 0.556 (0.467) data 0.426 (0.336) loss_x loss_x 1.3145 (1.1791) acc_x 71.8750 (71.6071) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [40/42] time 0.468 (0.462) data 0.338 (0.332) loss_x loss_x 1.5342 (1.2111) acc_x 53.1250 (70.3906) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1465
confident_label rate tensor(0.4327, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1357
clean true:1312
clean false:45
clean_rate:0.9668386145910096
noisy true:359
noisy false:1420
after delete: len(clean_dataset) 1357
after delete: len(noisy_dataset) 1779
epoch [179/200] batch [5/42] time 0.574 (0.514) data 0.443 (0.382) loss_x loss_x 1.0742 (1.1122) acc_x 75.0000 (72.5000) lr 6.4556e-05 eta 0:00:19
epoch [179/200] batch [10/42] time 0.501 (0.507) data 0.370 (0.375) loss_x loss_x 1.1992 (1.1267) acc_x 68.7500 (73.4375) lr 6.4556e-05 eta 0:00:16
epoch [179/200] batch [15/42] time 0.386 (0.499) data 0.255 (0.367) loss_x loss_x 0.8545 (1.1821) acc_x 75.0000 (70.2083) lr 6.4556e-05 eta 0:00:13
epoch [179/200] batch [20/42] time 0.484 (0.486) data 0.353 (0.354) loss_x loss_x 1.1611 (1.1774) acc_x 68.7500 (70.9375) lr 6.4556e-05 eta 0:00:10
epoch [179/200] batch [25/42] time 0.513 (0.478) data 0.382 (0.347) loss_x loss_x 0.7925 (1.1554) acc_x 87.5000 (71.7500) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [30/42] time 0.517 (0.471) data 0.385 (0.340) loss_x loss_x 1.0781 (1.1732) acc_x 81.2500 (71.5625) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [35/42] time 0.472 (0.465) data 0.341 (0.334) loss_x loss_x 1.0391 (1.2034) acc_x 75.0000 (70.8036) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [40/42] time 0.336 (0.457) data 0.206 (0.326) loss_x loss_x 1.1689 (1.2133) acc_x 56.2500 (70.4688) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1306
clean true:1275
clean false:31
clean_rate:0.9762633996937213
noisy true:331
noisy false:1499
after delete: len(clean_dataset) 1306
after delete: len(noisy_dataset) 1830
epoch [180/200] batch [5/40] time 0.392 (0.420) data 0.261 (0.289) loss_x loss_x 1.0898 (1.0887) acc_x 71.8750 (71.8750) lr 5.9119e-05 eta 0:00:14
epoch [180/200] batch [10/40] time 0.377 (0.435) data 0.246 (0.304) loss_x loss_x 0.8647 (1.0174) acc_x 71.8750 (71.8750) lr 5.9119e-05 eta 0:00:13
epoch [180/200] batch [15/40] time 0.479 (0.445) data 0.349 (0.314) loss_x loss_x 1.5586 (1.0615) acc_x 75.0000 (72.9167) lr 5.9119e-05 eta 0:00:11
epoch [180/200] batch [20/40] time 0.508 (0.451) data 0.378 (0.320) loss_x loss_x 1.6133 (1.1411) acc_x 68.7500 (71.7188) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [25/40] time 0.403 (0.460) data 0.273 (0.329) loss_x loss_x 0.9971 (1.0889) acc_x 68.7500 (72.3750) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [30/40] time 0.457 (0.465) data 0.327 (0.335) loss_x loss_x 0.8877 (1.0779) acc_x 78.1250 (73.4375) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [35/40] time 0.542 (0.466) data 0.411 (0.335) loss_x loss_x 1.2861 (1.0964) acc_x 68.7500 (72.9464) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [40/40] time 0.411 (0.464) data 0.280 (0.333) loss_x loss_x 1.4727 (1.0887) acc_x 71.8750 (73.8281) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1559
confident_label rate tensor(0.4091, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1283
clean true:1243
clean false:40
clean_rate:0.9688230709275136
noisy true:334
noisy false:1519
after delete: len(clean_dataset) 1283
after delete: len(noisy_dataset) 1853
epoch [181/200] batch [5/40] time 0.441 (0.460) data 0.310 (0.329) loss_x loss_x 1.0039 (1.0430) acc_x 68.7500 (73.7500) lr 5.3915e-05 eta 0:00:16
epoch [181/200] batch [10/40] time 0.417 (0.468) data 0.286 (0.337) loss_x loss_x 1.6094 (1.1564) acc_x 59.3750 (71.5625) lr 5.3915e-05 eta 0:00:14
epoch [181/200] batch [15/40] time 0.403 (0.454) data 0.272 (0.323) loss_x loss_x 1.1445 (1.1570) acc_x 78.1250 (72.9167) lr 5.3915e-05 eta 0:00:11
epoch [181/200] batch [20/40] time 0.379 (0.459) data 0.249 (0.329) loss_x loss_x 1.3301 (1.2174) acc_x 68.7500 (70.4688) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [25/40] time 0.505 (0.466) data 0.374 (0.336) loss_x loss_x 1.2129 (1.2005) acc_x 59.3750 (69.5000) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [30/40] time 0.443 (0.469) data 0.312 (0.339) loss_x loss_x 0.9277 (1.1891) acc_x 75.0000 (69.1667) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [35/40] time 0.390 (0.461) data 0.258 (0.331) loss_x loss_x 1.2920 (1.2080) acc_x 59.3750 (68.4821) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [40/40] time 0.481 (0.457) data 0.350 (0.326) loss_x loss_x 1.3428 (1.1968) acc_x 78.1250 (69.0625) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1482
confident_label rate tensor(0.4305, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1350
clean true:1313
clean false:37
clean_rate:0.9725925925925926
noisy true:341
noisy false:1445
after delete: len(clean_dataset) 1350
after delete: len(noisy_dataset) 1786
epoch [182/200] batch [5/42] time 0.400 (0.438) data 0.270 (0.308) loss_x loss_x 1.2031 (1.1284) acc_x 68.7500 (75.6250) lr 4.8943e-05 eta 0:00:16
epoch [182/200] batch [10/42] time 0.392 (0.428) data 0.262 (0.298) loss_x loss_x 0.9019 (1.1543) acc_x 75.0000 (70.3125) lr 4.8943e-05 eta 0:00:13
epoch [182/200] batch [15/42] time 0.509 (0.446) data 0.378 (0.315) loss_x loss_x 0.8330 (1.1723) acc_x 84.3750 (70.2083) lr 4.8943e-05 eta 0:00:12
epoch [182/200] batch [20/42] time 0.552 (0.470) data 0.422 (0.339) loss_x loss_x 1.0898 (1.1823) acc_x 65.6250 (69.0625) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [25/42] time 0.525 (0.465) data 0.394 (0.335) loss_x loss_x 1.3125 (1.1631) acc_x 71.8750 (69.3750) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [30/42] time 0.450 (0.466) data 0.319 (0.336) loss_x loss_x 1.0215 (1.1421) acc_x 75.0000 (70.4167) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [35/42] time 0.672 (0.468) data 0.541 (0.337) loss_x loss_x 1.3262 (1.2007) acc_x 68.7500 (69.6429) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [40/42] time 0.485 (0.467) data 0.354 (0.336) loss_x loss_x 1.1221 (1.2138) acc_x 71.8750 (69.0625) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1501
confident_label rate tensor(0.4247, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1332
clean true:1293
clean false:39
clean_rate:0.9707207207207207
noisy true:342
noisy false:1462
after delete: len(clean_dataset) 1332
after delete: len(noisy_dataset) 1804
epoch [183/200] batch [5/41] time 0.393 (0.454) data 0.262 (0.323) loss_x loss_x 1.2607 (1.2494) acc_x 59.3750 (66.8750) lr 4.4207e-05 eta 0:00:16
epoch [183/200] batch [10/41] time 0.387 (0.461) data 0.256 (0.330) loss_x loss_x 1.2002 (1.2737) acc_x 71.8750 (67.8125) lr 4.4207e-05 eta 0:00:14
epoch [183/200] batch [15/41] time 0.407 (0.451) data 0.276 (0.320) loss_x loss_x 1.1104 (1.2206) acc_x 78.1250 (70.2083) lr 4.4207e-05 eta 0:00:11
epoch [183/200] batch [20/41] time 0.565 (0.460) data 0.435 (0.329) loss_x loss_x 1.3926 (1.1808) acc_x 59.3750 (71.0938) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [25/41] time 0.487 (0.466) data 0.357 (0.335) loss_x loss_x 0.7368 (1.1744) acc_x 81.2500 (70.5000) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [30/41] time 0.534 (0.466) data 0.403 (0.335) loss_x loss_x 1.0322 (1.1817) acc_x 71.8750 (70.0000) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [35/41] time 0.465 (0.460) data 0.334 (0.329) loss_x loss_x 1.1328 (1.1517) acc_x 78.1250 (70.8929) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [40/41] time 0.400 (0.456) data 0.269 (0.325) loss_x loss_x 1.6250 (1.1639) acc_x 50.0000 (70.3125) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1483
confident_label rate tensor(0.4247, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1332
clean true:1296
clean false:36
clean_rate:0.972972972972973
noisy true:357
noisy false:1447
after delete: len(clean_dataset) 1332
after delete: len(noisy_dataset) 1804
epoch [184/200] batch [5/41] time 0.410 (0.418) data 0.278 (0.286) loss_x loss_x 1.0371 (0.9834) acc_x 71.8750 (73.1250) lr 3.9706e-05 eta 0:00:15
epoch [184/200] batch [10/41] time 0.476 (0.421) data 0.345 (0.290) loss_x loss_x 0.9902 (0.9653) acc_x 71.8750 (75.3125) lr 3.9706e-05 eta 0:00:13
epoch [184/200] batch [15/41] time 0.474 (0.436) data 0.343 (0.305) loss_x loss_x 0.8662 (1.0558) acc_x 75.0000 (71.8750) lr 3.9706e-05 eta 0:00:11
epoch [184/200] batch [20/41] time 0.498 (0.437) data 0.366 (0.306) loss_x loss_x 1.3574 (1.1121) acc_x 62.5000 (71.4062) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [25/41] time 0.466 (0.449) data 0.336 (0.318) loss_x loss_x 1.0762 (1.1385) acc_x 81.2500 (71.6250) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [30/41] time 0.570 (0.456) data 0.438 (0.325) loss_x loss_x 1.2832 (1.1344) acc_x 68.7500 (71.2500) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [35/41] time 0.431 (0.451) data 0.300 (0.320) loss_x loss_x 1.1836 (1.1671) acc_x 68.7500 (70.8929) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [40/41] time 0.465 (0.456) data 0.334 (0.325) loss_x loss_x 0.9326 (1.1558) acc_x 75.0000 (71.4062) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1310
clean true:1267
clean false:43
clean_rate:0.9671755725190839
noisy true:342
noisy false:1484
after delete: len(clean_dataset) 1310
after delete: len(noisy_dataset) 1826
epoch [185/200] batch [5/40] time 0.481 (0.455) data 0.350 (0.324) loss_x loss_x 1.1943 (1.0834) acc_x 71.8750 (77.5000) lr 3.5443e-05 eta 0:00:15
epoch [185/200] batch [10/40] time 0.407 (0.454) data 0.276 (0.324) loss_x loss_x 1.2148 (1.0999) acc_x 62.5000 (74.0625) lr 3.5443e-05 eta 0:00:13
epoch [185/200] batch [15/40] time 0.557 (0.468) data 0.425 (0.337) loss_x loss_x 1.3877 (1.0853) acc_x 71.8750 (75.2083) lr 3.5443e-05 eta 0:00:11
epoch [185/200] batch [20/40] time 0.432 (0.470) data 0.300 (0.339) loss_x loss_x 1.0186 (1.0463) acc_x 75.0000 (74.8438) lr 3.5443e-05 eta 0:00:09
epoch [185/200] batch [25/40] time 0.478 (0.464) data 0.347 (0.333) loss_x loss_x 0.9214 (1.0514) acc_x 78.1250 (75.2500) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [30/40] time 0.390 (0.461) data 0.259 (0.331) loss_x loss_x 1.6992 (1.0900) acc_x 56.2500 (73.7500) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [35/40] time 0.335 (0.458) data 0.206 (0.328) loss_x loss_x 0.7979 (1.1107) acc_x 71.8750 (73.0357) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [40/40] time 0.480 (0.451) data 0.349 (0.320) loss_x loss_x 1.4023 (1.1454) acc_x 62.5000 (71.7188) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1510
confident_label rate tensor(0.4254, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1334
clean true:1287
clean false:47
clean_rate:0.9647676161919041
noisy true:339
noisy false:1463
after delete: len(clean_dataset) 1334
after delete: len(noisy_dataset) 1802
epoch [186/200] batch [5/41] time 0.504 (0.496) data 0.372 (0.365) loss_x loss_x 1.5146 (1.2890) acc_x 62.5000 (66.2500) lr 3.1417e-05 eta 0:00:17
epoch [186/200] batch [10/41] time 0.387 (0.486) data 0.257 (0.355) loss_x loss_x 0.9814 (1.1393) acc_x 68.7500 (70.9375) lr 3.1417e-05 eta 0:00:15
epoch [186/200] batch [15/41] time 0.447 (0.490) data 0.316 (0.360) loss_x loss_x 0.9902 (1.1187) acc_x 78.1250 (70.8333) lr 3.1417e-05 eta 0:00:12
epoch [186/200] batch [20/41] time 0.394 (0.472) data 0.263 (0.341) loss_x loss_x 1.0547 (1.1229) acc_x 75.0000 (70.7812) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [25/41] time 0.386 (0.463) data 0.255 (0.332) loss_x loss_x 1.3242 (1.1748) acc_x 65.6250 (69.3750) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [30/41] time 0.569 (0.469) data 0.439 (0.338) loss_x loss_x 1.1748 (1.2271) acc_x 62.5000 (68.2292) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [35/41] time 0.445 (0.462) data 0.315 (0.332) loss_x loss_x 0.6982 (1.2188) acc_x 75.0000 (69.0179) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [40/41] time 0.466 (0.459) data 0.335 (0.328) loss_x loss_x 1.2422 (1.2087) acc_x 68.7500 (69.2188) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1513
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1324
clean true:1283
clean false:41
clean_rate:0.9690332326283988
noisy true:340
noisy false:1472
after delete: len(clean_dataset) 1324
after delete: len(noisy_dataset) 1812
epoch [187/200] batch [5/41] time 0.385 (0.440) data 0.254 (0.309) loss_x loss_x 1.1992 (1.0473) acc_x 71.8750 (76.2500) lr 2.7630e-05 eta 0:00:15
epoch [187/200] batch [10/41] time 0.501 (0.430) data 0.370 (0.299) loss_x loss_x 0.7749 (1.0702) acc_x 81.2500 (75.3125) lr 2.7630e-05 eta 0:00:13
epoch [187/200] batch [15/41] time 0.364 (0.427) data 0.234 (0.296) loss_x loss_x 1.2441 (1.0851) acc_x 71.8750 (75.4167) lr 2.7630e-05 eta 0:00:11
epoch [187/200] batch [20/41] time 0.376 (0.431) data 0.245 (0.300) loss_x loss_x 1.4102 (1.1658) acc_x 68.7500 (72.9688) lr 2.7630e-05 eta 0:00:09
epoch [187/200] batch [25/41] time 0.543 (0.444) data 0.412 (0.313) loss_x loss_x 1.0635 (1.2034) acc_x 65.6250 (71.2500) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [30/41] time 0.598 (0.452) data 0.467 (0.321) loss_x loss_x 1.1621 (1.1806) acc_x 75.0000 (71.8750) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [35/41] time 0.487 (0.463) data 0.355 (0.332) loss_x loss_x 1.0107 (1.1747) acc_x 68.7500 (71.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [40/41] time 0.521 (0.459) data 0.390 (0.328) loss_x loss_x 0.8862 (1.1872) acc_x 68.7500 (70.7031) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1503
confident_label rate tensor(0.4196, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1316
clean true:1287
clean false:29
clean_rate:0.9779635258358662
noisy true:346
noisy false:1474
after delete: len(clean_dataset) 1316
after delete: len(noisy_dataset) 1820
epoch [188/200] batch [5/41] time 0.561 (0.483) data 0.429 (0.351) loss_x loss_x 0.9116 (1.2063) acc_x 71.8750 (69.3750) lr 2.4083e-05 eta 0:00:17
epoch [188/200] batch [10/41] time 0.551 (0.481) data 0.420 (0.350) loss_x loss_x 1.1348 (1.1190) acc_x 75.0000 (70.0000) lr 2.4083e-05 eta 0:00:14
epoch [188/200] batch [15/41] time 0.520 (0.484) data 0.389 (0.352) loss_x loss_x 1.3369 (1.1179) acc_x 68.7500 (70.4167) lr 2.4083e-05 eta 0:00:12
epoch [188/200] batch [20/41] time 0.433 (0.487) data 0.302 (0.355) loss_x loss_x 0.8203 (1.0820) acc_x 68.7500 (70.4688) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [25/41] time 0.403 (0.479) data 0.272 (0.347) loss_x loss_x 1.3965 (1.0704) acc_x 62.5000 (70.6250) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [30/41] time 0.394 (0.470) data 0.264 (0.339) loss_x loss_x 1.1074 (1.0929) acc_x 71.8750 (70.1042) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [35/41] time 0.422 (0.467) data 0.292 (0.336) loss_x loss_x 1.2930 (1.1089) acc_x 71.8750 (70.1786) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [40/41] time 0.448 (0.462) data 0.317 (0.331) loss_x loss_x 1.1973 (1.0939) acc_x 68.7500 (70.9375) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1542
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1304
clean true:1267
clean false:37
clean_rate:0.9716257668711656
noisy true:327
noisy false:1505
after delete: len(clean_dataset) 1304
after delete: len(noisy_dataset) 1832
epoch [189/200] batch [5/40] time 0.644 (0.533) data 0.512 (0.401) loss_x loss_x 1.0635 (0.9563) acc_x 75.0000 (75.0000) lr 2.0777e-05 eta 0:00:18
epoch [189/200] batch [10/40] time 0.524 (0.516) data 0.393 (0.385) loss_x loss_x 0.8086 (1.0608) acc_x 81.2500 (75.0000) lr 2.0777e-05 eta 0:00:15
epoch [189/200] batch [15/40] time 0.420 (0.493) data 0.288 (0.362) loss_x loss_x 1.5254 (1.1186) acc_x 56.2500 (72.7083) lr 2.0777e-05 eta 0:00:12
epoch [189/200] batch [20/40] time 0.436 (0.496) data 0.305 (0.364) loss_x loss_x 1.3877 (1.1239) acc_x 65.6250 (72.0312) lr 2.0777e-05 eta 0:00:09
epoch [189/200] batch [25/40] time 0.422 (0.478) data 0.290 (0.347) loss_x loss_x 1.0449 (1.0967) acc_x 75.0000 (72.8750) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [30/40] time 0.594 (0.480) data 0.463 (0.349) loss_x loss_x 1.0947 (1.0752) acc_x 71.8750 (73.3333) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [35/40] time 0.489 (0.478) data 0.358 (0.347) loss_x loss_x 1.3008 (1.0923) acc_x 65.6250 (72.8571) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [40/40] time 0.373 (0.469) data 0.242 (0.338) loss_x loss_x 1.4785 (1.1314) acc_x 56.2500 (71.9531) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1530
confident_label rate tensor(0.4196, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1316
clean true:1280
clean false:36
clean_rate:0.9726443768996961
noisy true:326
noisy false:1494
after delete: len(clean_dataset) 1316
after delete: len(noisy_dataset) 1820
epoch [190/200] batch [5/41] time 0.349 (0.445) data 0.218 (0.313) loss_x loss_x 1.5811 (1.1012) acc_x 56.2500 (72.5000) lr 1.7713e-05 eta 0:00:16
epoch [190/200] batch [10/41] time 0.539 (0.430) data 0.408 (0.298) loss_x loss_x 1.3701 (1.1737) acc_x 68.7500 (70.6250) lr 1.7713e-05 eta 0:00:13
epoch [190/200] batch [15/41] time 0.449 (0.430) data 0.318 (0.298) loss_x loss_x 1.5059 (1.2395) acc_x 65.6250 (69.3750) lr 1.7713e-05 eta 0:00:11
epoch [190/200] batch [20/41] time 0.398 (0.432) data 0.267 (0.301) loss_x loss_x 0.9302 (1.2066) acc_x 78.1250 (70.0000) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [25/41] time 0.414 (0.454) data 0.283 (0.323) loss_x loss_x 1.6260 (1.2152) acc_x 65.6250 (70.5000) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [30/41] time 0.340 (0.450) data 0.210 (0.319) loss_x loss_x 1.5361 (1.2753) acc_x 65.6250 (69.3750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [35/41] time 0.500 (0.451) data 0.369 (0.320) loss_x loss_x 1.2461 (1.2750) acc_x 71.8750 (69.4643) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [40/41] time 0.392 (0.456) data 0.260 (0.325) loss_x loss_x 1.2910 (1.2321) acc_x 68.7500 (70.0000) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1521
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1324
clean true:1287
clean false:37
clean_rate:0.9720543806646526
noisy true:328
noisy false:1484
after delete: len(clean_dataset) 1324
after delete: len(noisy_dataset) 1812
epoch [191/200] batch [5/41] time 0.498 (0.447) data 0.367 (0.315) loss_x loss_x 1.1689 (1.1505) acc_x 59.3750 (70.6250) lr 1.4891e-05 eta 0:00:16
epoch [191/200] batch [10/41] time 0.372 (0.451) data 0.242 (0.320) loss_x loss_x 1.7119 (1.1163) acc_x 53.1250 (70.6250) lr 1.4891e-05 eta 0:00:13
epoch [191/200] batch [15/41] time 0.454 (0.461) data 0.323 (0.330) loss_x loss_x 1.3398 (1.1775) acc_x 68.7500 (69.5833) lr 1.4891e-05 eta 0:00:11
epoch [191/200] batch [20/41] time 0.412 (0.472) data 0.281 (0.342) loss_x loss_x 1.0684 (1.0843) acc_x 81.2500 (72.6562) lr 1.4891e-05 eta 0:00:09
epoch [191/200] batch [25/41] time 0.391 (0.464) data 0.260 (0.334) loss_x loss_x 1.1924 (1.0705) acc_x 75.0000 (73.5000) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [30/41] time 0.437 (0.458) data 0.305 (0.328) loss_x loss_x 1.0557 (1.0694) acc_x 78.1250 (73.4375) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [35/41] time 0.413 (0.461) data 0.284 (0.331) loss_x loss_x 0.9131 (1.0750) acc_x 78.1250 (73.6607) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [40/41] time 0.409 (0.459) data 0.278 (0.329) loss_x loss_x 0.8311 (1.0667) acc_x 78.1250 (74.0625) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1509
confident_label rate tensor(0.4254, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1334
clean true:1288
clean false:46
clean_rate:0.9655172413793104
noisy true:339
noisy false:1463
after delete: len(clean_dataset) 1334
after delete: len(noisy_dataset) 1802
epoch [192/200] batch [5/41] time 0.410 (0.437) data 0.279 (0.307) loss_x loss_x 1.1201 (1.2215) acc_x 71.8750 (68.1250) lr 1.2312e-05 eta 0:00:15
epoch [192/200] batch [10/41] time 0.466 (0.433) data 0.335 (0.302) loss_x loss_x 1.3906 (1.1231) acc_x 68.7500 (70.9375) lr 1.2312e-05 eta 0:00:13
epoch [192/200] batch [15/41] time 0.438 (0.432) data 0.308 (0.302) loss_x loss_x 1.6123 (1.1897) acc_x 53.1250 (68.7500) lr 1.2312e-05 eta 0:00:11
epoch [192/200] batch [20/41] time 0.492 (0.442) data 0.362 (0.311) loss_x loss_x 1.2178 (1.2101) acc_x 71.8750 (68.7500) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [25/41] time 0.613 (0.453) data 0.482 (0.323) loss_x loss_x 1.6953 (1.2121) acc_x 56.2500 (67.8750) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [30/41] time 0.483 (0.458) data 0.353 (0.328) loss_x loss_x 1.1475 (1.2175) acc_x 75.0000 (68.2292) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [35/41] time 0.501 (0.456) data 0.370 (0.325) loss_x loss_x 1.5059 (1.2068) acc_x 65.6250 (69.1964) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [40/41] time 0.646 (0.456) data 0.516 (0.326) loss_x loss_x 1.2002 (1.2269) acc_x 68.7500 (68.9844) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1503
confident_label rate tensor(0.4219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1323
clean true:1282
clean false:41
clean_rate:0.9690098261526833
noisy true:351
noisy false:1462
after delete: len(clean_dataset) 1323
after delete: len(noisy_dataset) 1813
epoch [193/200] batch [5/41] time 0.417 (0.448) data 0.288 (0.318) loss_x loss_x 0.7656 (1.0780) acc_x 84.3750 (80.0000) lr 9.9763e-06 eta 0:00:16
epoch [193/200] batch [10/41] time 0.432 (0.459) data 0.302 (0.329) loss_x loss_x 0.9917 (1.1532) acc_x 71.8750 (72.8125) lr 9.9763e-06 eta 0:00:14
epoch [193/200] batch [15/41] time 0.415 (0.446) data 0.285 (0.316) loss_x loss_x 0.8501 (1.2047) acc_x 75.0000 (70.6250) lr 9.9763e-06 eta 0:00:11
epoch [193/200] batch [20/41] time 0.413 (0.449) data 0.282 (0.319) loss_x loss_x 1.2236 (1.1676) acc_x 68.7500 (70.7812) lr 9.9763e-06 eta 0:00:09
epoch [193/200] batch [25/41] time 0.458 (0.461) data 0.327 (0.331) loss_x loss_x 1.0947 (1.1421) acc_x 71.8750 (70.1250) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [30/41] time 0.726 (0.473) data 0.595 (0.343) loss_x loss_x 1.3223 (1.1640) acc_x 71.8750 (70.4167) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [35/41] time 0.417 (0.472) data 0.286 (0.341) loss_x loss_x 1.4736 (1.1582) acc_x 62.5000 (70.4464) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [40/41] time 0.355 (0.465) data 0.225 (0.335) loss_x loss_x 1.0439 (1.1416) acc_x 75.0000 (70.7031) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1521
confident_label rate tensor(0.4200, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1317
clean true:1281
clean false:36
clean_rate:0.9726651480637813
noisy true:334
noisy false:1485
after delete: len(clean_dataset) 1317
after delete: len(noisy_dataset) 1819
epoch [194/200] batch [5/41] time 0.437 (0.436) data 0.306 (0.305) loss_x loss_x 1.6650 (1.3292) acc_x 53.1250 (65.0000) lr 7.8853e-06 eta 0:00:15
epoch [194/200] batch [10/41] time 0.407 (0.450) data 0.276 (0.318) loss_x loss_x 1.3066 (1.3056) acc_x 62.5000 (65.6250) lr 7.8853e-06 eta 0:00:13
epoch [194/200] batch [15/41] time 0.378 (0.466) data 0.247 (0.334) loss_x loss_x 0.8154 (1.2338) acc_x 81.2500 (68.5417) lr 7.8853e-06 eta 0:00:12
epoch [194/200] batch [20/41] time 0.414 (0.460) data 0.282 (0.328) loss_x loss_x 1.3115 (1.2635) acc_x 71.8750 (68.5938) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [25/41] time 0.447 (0.456) data 0.316 (0.325) loss_x loss_x 1.7021 (1.2810) acc_x 65.6250 (68.2500) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [30/41] time 0.545 (0.463) data 0.414 (0.332) loss_x loss_x 1.0869 (1.2332) acc_x 78.1250 (69.3750) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [35/41] time 0.406 (0.463) data 0.275 (0.332) loss_x loss_x 1.0977 (1.2366) acc_x 78.1250 (69.1964) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [40/41] time 0.441 (0.458) data 0.310 (0.327) loss_x loss_x 0.8770 (1.2460) acc_x 84.3750 (69.3750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1527
confident_label rate tensor(0.4155, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1303
clean true:1265
clean false:38
clean_rate:0.9708365310821182
noisy true:344
noisy false:1489
after delete: len(clean_dataset) 1303
after delete: len(noisy_dataset) 1833
epoch [195/200] batch [5/40] time 0.480 (0.458) data 0.349 (0.327) loss_x loss_x 1.7949 (1.1314) acc_x 56.2500 (68.1250) lr 6.0390e-06 eta 0:00:16
epoch [195/200] batch [10/40] time 0.446 (0.468) data 0.315 (0.336) loss_x loss_x 1.6621 (1.2237) acc_x 68.7500 (70.3125) lr 6.0390e-06 eta 0:00:14
epoch [195/200] batch [15/40] time 0.408 (0.452) data 0.278 (0.321) loss_x loss_x 1.0361 (1.2790) acc_x 65.6250 (69.7917) lr 6.0390e-06 eta 0:00:11
epoch [195/200] batch [20/40] time 0.438 (0.450) data 0.308 (0.319) loss_x loss_x 1.1934 (1.2432) acc_x 68.7500 (69.3750) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [25/40] time 0.342 (0.442) data 0.212 (0.310) loss_x loss_x 1.3447 (1.2484) acc_x 65.6250 (69.5000) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [30/40] time 0.531 (0.441) data 0.400 (0.310) loss_x loss_x 0.9512 (1.2072) acc_x 84.3750 (70.4167) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [35/40] time 0.432 (0.443) data 0.300 (0.312) loss_x loss_x 1.0957 (1.1848) acc_x 84.3750 (71.3393) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [40/40] time 0.429 (0.441) data 0.298 (0.310) loss_x loss_x 0.7231 (1.1891) acc_x 87.5000 (71.4062) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1524
confident_label rate tensor(0.4110, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1289
clean true:1258
clean false:31
clean_rate:0.9759503491078355
noisy true:354
noisy false:1493
after delete: len(clean_dataset) 1289
after delete: len(noisy_dataset) 1847
epoch [196/200] batch [5/40] time 0.443 (0.438) data 0.312 (0.307) loss_x loss_x 1.7363 (1.3015) acc_x 68.7500 (66.2500) lr 4.4380e-06 eta 0:00:15
epoch [196/200] batch [10/40] time 0.422 (0.456) data 0.291 (0.325) loss_x loss_x 1.1582 (1.2726) acc_x 71.8750 (69.0625) lr 4.4380e-06 eta 0:00:13
epoch [196/200] batch [15/40] time 0.528 (0.459) data 0.397 (0.328) loss_x loss_x 1.4775 (1.2285) acc_x 65.6250 (70.8333) lr 4.4380e-06 eta 0:00:11
epoch [196/200] batch [20/40] time 0.381 (0.447) data 0.250 (0.316) loss_x loss_x 1.5059 (1.2360) acc_x 59.3750 (70.7812) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [25/40] time 0.598 (0.453) data 0.467 (0.322) loss_x loss_x 1.2930 (1.2568) acc_x 65.6250 (69.7500) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [30/40] time 0.370 (0.450) data 0.239 (0.319) loss_x loss_x 0.9429 (1.2129) acc_x 75.0000 (70.7292) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [35/40] time 0.468 (0.453) data 0.336 (0.322) loss_x loss_x 0.5688 (1.1966) acc_x 81.2500 (70.9821) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [40/40] time 0.624 (0.457) data 0.494 (0.326) loss_x loss_x 1.1289 (1.2011) acc_x 71.8750 (70.3125) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1492
confident_label rate tensor(0.4247, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1332
clean true:1299
clean false:33
clean_rate:0.9752252252252253
noisy true:345
noisy false:1459
after delete: len(clean_dataset) 1332
after delete: len(noisy_dataset) 1804
epoch [197/200] batch [5/41] time 0.466 (0.438) data 0.335 (0.306) loss_x loss_x 1.4121 (1.3391) acc_x 62.5000 (63.7500) lr 3.0827e-06 eta 0:00:15
epoch [197/200] batch [10/41] time 0.451 (0.476) data 0.320 (0.345) loss_x loss_x 1.4111 (1.1898) acc_x 59.3750 (67.5000) lr 3.0827e-06 eta 0:00:14
epoch [197/200] batch [15/41] time 0.501 (0.458) data 0.370 (0.327) loss_x loss_x 1.1504 (1.1490) acc_x 68.7500 (69.3750) lr 3.0827e-06 eta 0:00:11
epoch [197/200] batch [20/41] time 0.385 (0.453) data 0.254 (0.322) loss_x loss_x 0.7397 (1.1538) acc_x 75.0000 (70.1562) lr 3.0827e-06 eta 0:00:09
epoch [197/200] batch [25/41] time 0.426 (0.457) data 0.295 (0.326) loss_x loss_x 0.6216 (1.1139) acc_x 81.2500 (71.7500) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [30/41] time 0.377 (0.460) data 0.246 (0.329) loss_x loss_x 1.0898 (1.1431) acc_x 65.6250 (69.8958) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [35/41] time 0.486 (0.463) data 0.355 (0.332) loss_x loss_x 1.0557 (1.1458) acc_x 78.1250 (70.3571) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [40/41] time 0.389 (0.460) data 0.258 (0.329) loss_x loss_x 1.3623 (1.1418) acc_x 71.8750 (70.7031) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1496
confident_label rate tensor(0.4267, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1338
clean true:1310
clean false:28
clean_rate:0.9790732436472347
noisy true:330
noisy false:1468
after delete: len(clean_dataset) 1338
after delete: len(noisy_dataset) 1798
epoch [198/200] batch [5/41] time 0.403 (0.427) data 0.272 (0.296) loss_x loss_x 0.8130 (1.0685) acc_x 68.7500 (70.0000) lr 1.9733e-06 eta 0:00:15
epoch [198/200] batch [10/41] time 0.527 (0.447) data 0.396 (0.316) loss_x loss_x 1.2988 (1.0875) acc_x 71.8750 (71.5625) lr 1.9733e-06 eta 0:00:13
epoch [198/200] batch [15/41] time 0.578 (0.448) data 0.447 (0.317) loss_x loss_x 1.2773 (1.1192) acc_x 78.1250 (71.6667) lr 1.9733e-06 eta 0:00:11
epoch [198/200] batch [20/41] time 0.443 (0.457) data 0.312 (0.326) loss_x loss_x 1.2939 (1.1598) acc_x 68.7500 (71.8750) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [25/41] time 0.417 (0.454) data 0.287 (0.323) loss_x loss_x 1.3057 (1.1930) acc_x 62.5000 (71.2500) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [30/41] time 0.429 (0.459) data 0.298 (0.328) loss_x loss_x 1.1406 (1.1847) acc_x 75.0000 (70.9375) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [35/41] time 0.552 (0.464) data 0.421 (0.333) loss_x loss_x 0.9517 (1.1768) acc_x 78.1250 (70.8929) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [40/41] time 0.548 (0.464) data 0.417 (0.333) loss_x loss_x 1.4414 (1.1587) acc_x 65.6250 (71.7188) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1513
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1310
clean true:1276
clean false:34
clean_rate:0.9740458015267176
noisy true:347
noisy false:1479
after delete: len(clean_dataset) 1310
after delete: len(noisy_dataset) 1826
epoch [199/200] batch [5/40] time 0.471 (0.466) data 0.340 (0.335) loss_x loss_x 0.7319 (1.1522) acc_x 81.2500 (75.0000) lr 1.1101e-06 eta 0:00:16
epoch [199/200] batch [10/40] time 0.394 (0.464) data 0.263 (0.333) loss_x loss_x 0.9907 (1.0901) acc_x 78.1250 (74.0625) lr 1.1101e-06 eta 0:00:13
epoch [199/200] batch [15/40] time 0.670 (0.471) data 0.539 (0.340) loss_x loss_x 0.8276 (1.0722) acc_x 75.0000 (73.9583) lr 1.1101e-06 eta 0:00:11
epoch [199/200] batch [20/40] time 0.366 (0.462) data 0.235 (0.331) loss_x loss_x 0.8979 (1.0658) acc_x 68.7500 (73.4375) lr 1.1101e-06 eta 0:00:09
epoch [199/200] batch [25/40] time 0.443 (0.460) data 0.312 (0.329) loss_x loss_x 1.0332 (1.1530) acc_x 84.3750 (72.7500) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [30/40] time 0.405 (0.463) data 0.274 (0.332) loss_x loss_x 1.6025 (1.1874) acc_x 56.2500 (71.2500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [35/40] time 0.384 (0.459) data 0.253 (0.328) loss_x loss_x 1.0801 (1.2151) acc_x 71.8750 (70.7143) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [40/40] time 0.361 (0.461) data 0.230 (0.330) loss_x loss_x 1.2617 (1.2157) acc_x 75.0000 (71.0156) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1523
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1339
clean true:1285
clean false:54
clean_rate:0.9596713965646004
noisy true:328
noisy false:1469
after delete: len(clean_dataset) 1339
after delete: len(noisy_dataset) 1797
epoch [200/200] batch [5/41] time 0.473 (0.456) data 0.343 (0.326) loss_x loss_x 1.1924 (1.1772) acc_x 71.8750 (70.6250) lr 4.9344e-07 eta 0:00:16
epoch [200/200] batch [10/41] time 0.596 (0.479) data 0.466 (0.348) loss_x loss_x 1.7207 (1.2543) acc_x 65.6250 (72.1875) lr 4.9344e-07 eta 0:00:14
epoch [200/200] batch [15/41] time 0.400 (0.467) data 0.270 (0.336) loss_x loss_x 2.0840 (1.2671) acc_x 56.2500 (71.2500) lr 4.9344e-07 eta 0:00:12
epoch [200/200] batch [20/41] time 0.487 (0.461) data 0.357 (0.331) loss_x loss_x 0.8994 (1.1844) acc_x 78.1250 (72.9688) lr 4.9344e-07 eta 0:00:09
epoch [200/200] batch [25/41] time 0.425 (0.463) data 0.295 (0.333) loss_x loss_x 1.1963 (1.1823) acc_x 71.8750 (72.7500) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [30/41] time 0.460 (0.458) data 0.329 (0.327) loss_x loss_x 1.2891 (1.1983) acc_x 53.1250 (71.8750) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [35/41] time 0.437 (0.459) data 0.306 (0.329) loss_x loss_x 1.3760 (1.1902) acc_x 62.5000 (71.6964) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [40/41] time 0.424 (0.453) data 0.292 (0.322) loss_x loss_x 1.1543 (1.1789) acc_x 68.7500 (71.8750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,166
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 62.3%
Elapsed: 3:26:16
