***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.0883, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 277
clean true:216
clean false:61
clean_rate:0.779783393501805
noisy true:349
noisy false:2510
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 2859
epoch [1/200] batch [5/8] time 0.504 (0.504) data 0.374 (0.356) loss_x loss_x 2.6387 (2.9875) acc_x 43.7500 (38.7500) lr 1.0000e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2466
confident_label rate tensor(0.0985, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 309
clean true:260
clean false:49
clean_rate:0.8414239482200647
noisy true:410
noisy false:2417
after delete: len(clean_dataset) 309
after delete: len(noisy_dataset) 2827
epoch [2/200] batch [5/9] time 0.544 (0.525) data 0.414 (0.394) loss_x loss_x 2.0664 (2.1506) acc_x 43.7500 (45.6250) lr 2.0000e-03 eta 0:00:02
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1980
confident_label rate tensor(0.1553, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 487
clean true:428
clean false:59
clean_rate:0.8788501026694046
noisy true:728
noisy false:1921
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 2649
epoch [3/200] batch [5/15] time 0.533 (0.481) data 0.403 (0.350) loss_x loss_x 2.1660 (1.8822) acc_x 50.0000 (51.2500) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/15] time 0.419 (0.462) data 0.288 (0.332) loss_x loss_x 1.6191 (1.8474) acc_x 43.7500 (50.3125) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/15] time 0.368 (0.455) data 0.237 (0.324) loss_x loss_x 1.9385 (1.7731) acc_x 46.8750 (52.7083) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1913
confident_label rate tensor(0.1738, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 545
clean true:465
clean false:80
clean_rate:0.8532110091743119
noisy true:758
noisy false:1833
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 2591
epoch [4/200] batch [5/17] time 0.381 (0.520) data 0.250 (0.389) loss_x loss_x 1.3281 (1.8055) acc_x 68.7500 (51.2500) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/17] time 0.397 (0.484) data 0.266 (0.353) loss_x loss_x 2.0117 (1.8280) acc_x 40.6250 (50.6250) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/17] time 0.335 (0.463) data 0.204 (0.331) loss_x loss_x 2.0078 (1.8639) acc_x 43.7500 (49.7917) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1881
confident_label rate tensor(0.1671, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 524
clean true:456
clean false:68
clean_rate:0.8702290076335878
noisy true:799
noisy false:1813
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 2612
epoch [5/200] batch [5/16] time 0.428 (0.496) data 0.299 (0.365) loss_x loss_x 1.9990 (1.7773) acc_x 50.0000 (50.6250) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/16] time 0.492 (0.489) data 0.361 (0.358) loss_x loss_x 1.1875 (1.6974) acc_x 62.5000 (53.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/16] time 0.360 (0.465) data 0.230 (0.335) loss_x loss_x 1.6865 (1.6773) acc_x 59.3750 (55.0000) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1883
confident_label rate tensor(0.1783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 559
clean true:482
clean false:77
clean_rate:0.8622540250447227
noisy true:771
noisy false:1806
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 2577
epoch [6/200] batch [5/17] time 0.488 (0.421) data 0.358 (0.291) loss_x loss_x 1.9434 (1.6199) acc_x 43.7500 (53.7500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [10/17] time 0.491 (0.439) data 0.360 (0.308) loss_x loss_x 1.4883 (1.5783) acc_x 59.3750 (55.3125) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/17] time 0.511 (0.442) data 0.380 (0.311) loss_x loss_x 1.8076 (1.6445) acc_x 62.5000 (55.0000) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1871
confident_label rate tensor(0.1757, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 551
clean true:482
clean false:69
clean_rate:0.8747731397459165
noisy true:783
noisy false:1802
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 2585
epoch [7/200] batch [5/17] time 0.358 (0.427) data 0.228 (0.297) loss_x loss_x 1.5674 (1.6225) acc_x 56.2500 (56.8750) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/17] time 0.436 (0.425) data 0.306 (0.295) loss_x loss_x 2.2031 (1.7187) acc_x 46.8750 (55.3125) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/17] time 0.771 (0.445) data 0.640 (0.314) loss_x loss_x 1.5830 (1.6945) acc_x 59.3750 (55.8333) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1899
confident_label rate tensor(0.1792, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 562
clean true:497
clean false:65
clean_rate:0.8843416370106761
noisy true:740
noisy false:1834
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 2574
epoch [8/200] batch [5/17] time 0.554 (0.501) data 0.423 (0.371) loss_x loss_x 2.2148 (1.9994) acc_x 46.8750 (51.8750) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [10/17] time 0.319 (0.467) data 0.188 (0.336) loss_x loss_x 1.4346 (1.8244) acc_x 75.0000 (51.8750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/17] time 0.431 (0.464) data 0.301 (0.334) loss_x loss_x 1.6562 (1.7425) acc_x 46.8750 (54.7917) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1871
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 542
clean true:467
clean false:75
clean_rate:0.8616236162361623
noisy true:798
noisy false:1796
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 2594
epoch [9/200] batch [5/16] time 0.705 (0.478) data 0.575 (0.348) loss_x loss_x 1.8516 (1.6930) acc_x 50.0000 (54.3750) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [10/16] time 0.388 (0.464) data 0.258 (0.334) loss_x loss_x 1.7168 (1.7428) acc_x 43.7500 (50.6250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/16] time 0.355 (0.451) data 0.224 (0.321) loss_x loss_x 1.9990 (1.7523) acc_x 40.6250 (51.0417) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1854
confident_label rate tensor(0.1722, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 540
clean true:466
clean false:74
clean_rate:0.8629629629629629
noisy true:816
noisy false:1780
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 2596
epoch [10/200] batch [5/16] time 0.402 (0.509) data 0.272 (0.379) loss_x loss_x 1.3350 (1.6393) acc_x 62.5000 (56.2500) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/16] time 0.375 (0.480) data 0.245 (0.349) loss_x loss_x 1.2861 (1.6563) acc_x 68.7500 (58.1250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/16] time 0.429 (0.481) data 0.298 (0.350) loss_x loss_x 1.6035 (1.5505) acc_x 62.5000 (60.8333) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1846
confident_label rate tensor(0.1805, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 566
clean true:490
clean false:76
clean_rate:0.8657243816254417
noisy true:800
noisy false:1770
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 2570
epoch [11/200] batch [5/17] time 0.440 (0.445) data 0.310 (0.314) loss_x loss_x 1.0430 (1.5433) acc_x 71.8750 (60.0000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/17] time 0.508 (0.467) data 0.378 (0.337) loss_x loss_x 1.4609 (1.6104) acc_x 65.6250 (60.3125) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/17] time 0.441 (0.455) data 0.311 (0.324) loss_x loss_x 1.1084 (1.5411) acc_x 65.6250 (61.4583) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1865
confident_label rate tensor(0.1712, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 537
clean true:462
clean false:75
clean_rate:0.8603351955307262
noisy true:809
noisy false:1790
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 2599
epoch [12/200] batch [5/16] time 0.475 (0.437) data 0.345 (0.307) loss_x loss_x 1.6006 (1.5777) acc_x 62.5000 (56.2500) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/16] time 0.569 (0.431) data 0.438 (0.300) loss_x loss_x 1.2930 (1.5454) acc_x 56.2500 (58.1250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/16] time 0.520 (0.439) data 0.390 (0.309) loss_x loss_x 1.3340 (1.5867) acc_x 59.3750 (57.5000) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1866
confident_label rate tensor(0.1779, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 558
clean true:473
clean false:85
clean_rate:0.8476702508960573
noisy true:797
noisy false:1781
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 2578
epoch [13/200] batch [5/17] time 0.390 (0.386) data 0.260 (0.255) loss_x loss_x 1.4424 (1.5990) acc_x 65.6250 (59.3750) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/17] time 0.566 (0.448) data 0.436 (0.317) loss_x loss_x 1.6807 (1.5529) acc_x 56.2500 (59.6875) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/17] time 0.371 (0.441) data 0.241 (0.310) loss_x loss_x 1.7148 (1.5396) acc_x 59.3750 (58.3333) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1867
confident_label rate tensor(0.1773, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 556
clean true:477
clean false:79
clean_rate:0.8579136690647482
noisy true:792
noisy false:1788
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 2580
epoch [14/200] batch [5/17] time 0.350 (0.458) data 0.219 (0.327) loss_x loss_x 1.7012 (1.5275) acc_x 50.0000 (58.7500) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [10/17] time 0.461 (0.462) data 0.331 (0.331) loss_x loss_x 1.1016 (1.5362) acc_x 65.6250 (59.0625) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/17] time 0.455 (0.454) data 0.325 (0.323) loss_x loss_x 1.7441 (1.5577) acc_x 43.7500 (59.1667) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1852
confident_label rate tensor(0.1783, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 559
clean true:484
clean false:75
clean_rate:0.8658318425760286
noisy true:800
noisy false:1777
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 2577
epoch [15/200] batch [5/17] time 0.469 (0.458) data 0.339 (0.328) loss_x loss_x 1.0576 (1.5229) acc_x 65.6250 (61.8750) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/17] time 0.431 (0.445) data 0.300 (0.315) loss_x loss_x 1.6133 (1.5560) acc_x 56.2500 (57.1875) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/17] time 0.341 (0.462) data 0.209 (0.332) loss_x loss_x 2.1953 (1.5803) acc_x 56.2500 (58.5417) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1802
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:524
clean false:89
clean_rate:0.8548123980424144
noisy true:810
noisy false:1713
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [16/200] batch [5/19] time 0.405 (0.397) data 0.274 (0.266) loss_x loss_x 1.9346 (1.8523) acc_x 43.7500 (51.8750) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/19] time 0.612 (0.453) data 0.483 (0.322) loss_x loss_x 1.8477 (1.7188) acc_x 53.1250 (55.3125) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/19] time 0.330 (0.457) data 0.201 (0.327) loss_x loss_x 1.5957 (1.6745) acc_x 62.5000 (55.8333) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1826
confident_label rate tensor(0.1913, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 600
clean true:506
clean false:94
clean_rate:0.8433333333333334
noisy true:804
noisy false:1732
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 2536
epoch [17/200] batch [5/18] time 0.389 (0.455) data 0.259 (0.325) loss_x loss_x 1.8857 (1.5432) acc_x 50.0000 (62.5000) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/18] time 0.537 (0.463) data 0.408 (0.333) loss_x loss_x 1.3135 (1.6219) acc_x 53.1250 (58.1250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/18] time 0.324 (0.443) data 0.195 (0.313) loss_x loss_x 1.9805 (1.6118) acc_x 43.7500 (57.2917) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1852
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 594
clean true:496
clean false:98
clean_rate:0.835016835016835
noisy true:788
noisy false:1754
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 2542
epoch [18/200] batch [5/18] time 0.584 (0.488) data 0.454 (0.357) loss_x loss_x 1.1787 (1.6244) acc_x 59.3750 (57.5000) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/18] time 0.383 (0.466) data 0.253 (0.335) loss_x loss_x 1.4902 (1.6064) acc_x 71.8750 (58.1250) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/18] time 0.467 (0.448) data 0.336 (0.317) loss_x loss_x 1.7314 (1.5479) acc_x 56.2500 (57.9167) lr 1.9686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.1849, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 580
clean true:484
clean false:96
clean_rate:0.8344827586206897
noisy true:835
noisy false:1721
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 2556
epoch [19/200] batch [5/18] time 0.476 (0.433) data 0.347 (0.304) loss_x loss_x 1.6514 (1.6539) acc_x 62.5000 (55.6250) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/18] time 0.583 (0.446) data 0.453 (0.316) loss_x loss_x 2.1133 (1.6695) acc_x 46.8750 (55.6250) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/18] time 0.575 (0.459) data 0.445 (0.329) loss_x loss_x 1.4209 (1.6120) acc_x 56.2500 (55.8333) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1834
confident_label rate tensor(0.1901, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 596
clean true:506
clean false:90
clean_rate:0.8489932885906041
noisy true:796
noisy false:1744
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 2540
epoch [20/200] batch [5/18] time 0.519 (0.483) data 0.389 (0.353) loss_x loss_x 1.5713 (1.4744) acc_x 59.3750 (63.7500) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/18] time 0.406 (0.466) data 0.275 (0.336) loss_x loss_x 0.9785 (1.6253) acc_x 71.8750 (59.6875) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/18] time 0.402 (0.459) data 0.272 (0.329) loss_x loss_x 1.1250 (1.6495) acc_x 65.6250 (59.5833) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1838
confident_label rate tensor(0.1865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 585
clean true:492
clean false:93
clean_rate:0.841025641025641
noisy true:806
noisy false:1745
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 2551
epoch [21/200] batch [5/18] time 0.485 (0.536) data 0.355 (0.406) loss_x loss_x 1.4072 (1.5404) acc_x 59.3750 (64.3750) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [10/18] time 0.468 (0.499) data 0.338 (0.369) loss_x loss_x 1.3096 (1.5053) acc_x 62.5000 (63.7500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/18] time 0.463 (0.471) data 0.333 (0.340) loss_x loss_x 1.4688 (1.4826) acc_x 65.6250 (61.6667) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 594
clean true:506
clean false:88
clean_rate:0.8518518518518519
noisy true:812
noisy false:1730
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 2542
epoch [22/200] batch [5/18] time 0.377 (0.460) data 0.247 (0.330) loss_x loss_x 2.0742 (1.6643) acc_x 53.1250 (60.6250) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/18] time 0.346 (0.435) data 0.216 (0.305) loss_x loss_x 1.6621 (1.5798) acc_x 53.1250 (59.6875) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/18] time 0.470 (0.433) data 0.339 (0.302) loss_x loss_x 1.3682 (1.6431) acc_x 65.6250 (57.5000) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1831
confident_label rate tensor(0.1891, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 593
clean true:502
clean false:91
clean_rate:0.8465430016863407
noisy true:803
noisy false:1740
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 2543
epoch [23/200] batch [5/18] time 0.480 (0.480) data 0.349 (0.350) loss_x loss_x 1.5400 (1.4068) acc_x 71.8750 (63.1250) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/18] time 0.448 (0.460) data 0.317 (0.330) loss_x loss_x 1.4824 (1.5040) acc_x 59.3750 (60.0000) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/18] time 0.401 (0.441) data 0.270 (0.310) loss_x loss_x 1.4561 (1.6012) acc_x 68.7500 (59.5833) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1823
confident_label rate tensor(0.1878, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 589
clean true:505
clean false:84
clean_rate:0.8573853989813243
noisy true:808
noisy false:1739
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 2547
epoch [24/200] batch [5/18] time 0.472 (0.496) data 0.342 (0.366) loss_x loss_x 1.5078 (1.3627) acc_x 46.8750 (63.1250) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [10/18] time 0.613 (0.493) data 0.482 (0.363) loss_x loss_x 1.4922 (1.5065) acc_x 62.5000 (59.6875) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/18] time 0.360 (0.465) data 0.230 (0.335) loss_x loss_x 2.0215 (1.5193) acc_x 46.8750 (59.3750) lr 1.9409e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.1885, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 591
clean true:502
clean false:89
clean_rate:0.8494077834179357
noisy true:816
noisy false:1729
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 2545
epoch [25/200] batch [5/18] time 0.390 (0.480) data 0.261 (0.350) loss_x loss_x 1.1621 (1.5820) acc_x 68.7500 (58.1250) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/18] time 0.468 (0.481) data 0.338 (0.351) loss_x loss_x 1.7422 (1.5382) acc_x 50.0000 (58.1250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/18] time 0.367 (0.457) data 0.237 (0.327) loss_x loss_x 1.1807 (1.5430) acc_x 65.6250 (58.1250) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1811
confident_label rate tensor(0.1894, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 594
clean true:508
clean false:86
clean_rate:0.8552188552188552
noisy true:817
noisy false:1725
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 2542
epoch [26/200] batch [5/18] time 0.454 (0.515) data 0.323 (0.385) loss_x loss_x 2.1348 (1.5975) acc_x 40.6250 (54.3750) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/18] time 0.479 (0.491) data 0.349 (0.361) loss_x loss_x 1.6895 (1.5104) acc_x 53.1250 (57.5000) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/18] time 0.355 (0.464) data 0.224 (0.334) loss_x loss_x 1.3525 (1.5563) acc_x 65.6250 (57.9167) lr 1.9298e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.1974, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 619
clean true:519
clean false:100
clean_rate:0.8384491114701131
noisy true:804
noisy false:1713
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 2517
epoch [27/200] batch [5/19] time 0.570 (0.466) data 0.440 (0.336) loss_x loss_x 1.7852 (1.4359) acc_x 59.3750 (61.8750) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [10/19] time 0.367 (0.458) data 0.238 (0.328) loss_x loss_x 1.3477 (1.4311) acc_x 62.5000 (60.9375) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/19] time 0.470 (0.449) data 0.340 (0.320) loss_x loss_x 1.6064 (1.4827) acc_x 62.5000 (60.6250) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1822
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 613
clean true:520
clean false:93
clean_rate:0.8482871125611745
noisy true:794
noisy false:1729
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 2523
epoch [28/200] batch [5/19] time 0.389 (0.455) data 0.259 (0.325) loss_x loss_x 1.1318 (1.5906) acc_x 75.0000 (65.0000) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [10/19] time 0.528 (0.470) data 0.397 (0.340) loss_x loss_x 1.4639 (1.6125) acc_x 59.3750 (61.5625) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/19] time 0.423 (0.444) data 0.292 (0.314) loss_x loss_x 1.7490 (1.6120) acc_x 50.0000 (60.2083) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1838
confident_label rate tensor(0.1920, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 602
clean true:508
clean false:94
clean_rate:0.8438538205980066
noisy true:790
noisy false:1744
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 2534
epoch [29/200] batch [5/18] time 0.349 (0.457) data 0.218 (0.327) loss_x loss_x 2.1543 (1.7137) acc_x 46.8750 (55.6250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/18] time 0.530 (0.477) data 0.400 (0.347) loss_x loss_x 1.7666 (1.6013) acc_x 50.0000 (59.0625) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/18] time 0.461 (0.468) data 0.331 (0.338) loss_x loss_x 1.4746 (1.5941) acc_x 53.1250 (57.7083) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1821
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 621
clean true:531
clean false:90
clean_rate:0.855072463768116
noisy true:784
noisy false:1731
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 2515
epoch [30/200] batch [5/19] time 0.420 (0.449) data 0.289 (0.319) loss_x loss_x 1.3711 (1.3344) acc_x 59.3750 (61.2500) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [10/19] time 0.451 (0.459) data 0.320 (0.329) loss_x loss_x 1.7100 (1.5415) acc_x 56.2500 (56.2500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/19] time 0.407 (0.437) data 0.277 (0.307) loss_x loss_x 2.1406 (1.5505) acc_x 50.0000 (58.1250) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.1865, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 585
clean true:502
clean false:83
clean_rate:0.8581196581196581
noisy true:817
noisy false:1734
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 2551
epoch [31/200] batch [5/18] time 0.477 (0.455) data 0.347 (0.325) loss_x loss_x 1.1240 (1.4770) acc_x 75.0000 (62.5000) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [10/18] time 0.464 (0.463) data 0.333 (0.332) loss_x loss_x 1.3525 (1.3899) acc_x 53.1250 (60.0000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/18] time 0.508 (0.465) data 0.378 (0.335) loss_x loss_x 1.1104 (1.4181) acc_x 62.5000 (60.2083) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.2018, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 633
clean true:537
clean false:96
clean_rate:0.8483412322274881
noisy true:804
noisy false:1699
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 2503
epoch [32/200] batch [5/19] time 0.397 (0.428) data 0.267 (0.298) loss_x loss_x 1.4316 (1.4600) acc_x 62.5000 (61.2500) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/19] time 0.414 (0.423) data 0.283 (0.293) loss_x loss_x 1.4746 (1.5245) acc_x 62.5000 (59.3750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/19] time 0.563 (0.449) data 0.433 (0.319) loss_x loss_x 1.4355 (1.5413) acc_x 53.1250 (59.7917) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1834
confident_label rate tensor(0.1821, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 571
clean true:479
clean false:92
clean_rate:0.8388791593695272
noisy true:823
noisy false:1742
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 2565
epoch [33/200] batch [5/17] time 0.375 (0.420) data 0.245 (0.290) loss_x loss_x 2.3086 (1.6014) acc_x 31.2500 (53.7500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/17] time 0.491 (0.454) data 0.360 (0.324) loss_x loss_x 1.3008 (1.5669) acc_x 59.3750 (58.4375) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/17] time 0.512 (0.451) data 0.382 (0.320) loss_x loss_x 1.5352 (1.5979) acc_x 62.5000 (58.9583) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1799
confident_label rate tensor(0.1929, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 605
clean true:526
clean false:79
clean_rate:0.8694214876033057
noisy true:811
noisy false:1720
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 2531
epoch [34/200] batch [5/18] time 0.391 (0.444) data 0.260 (0.314) loss_x loss_x 1.5654 (1.3350) acc_x 53.1250 (62.5000) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/18] time 0.390 (0.414) data 0.260 (0.284) loss_x loss_x 2.1426 (1.5820) acc_x 43.7500 (56.2500) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/18] time 0.600 (0.435) data 0.469 (0.304) loss_x loss_x 1.1016 (1.5343) acc_x 71.8750 (58.7500) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1830
confident_label rate tensor(0.1942, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 609
clean true:511
clean false:98
clean_rate:0.8390804597701149
noisy true:795
noisy false:1732
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 2527
epoch [35/200] batch [5/19] time 0.418 (0.421) data 0.288 (0.291) loss_x loss_x 1.9248 (1.6254) acc_x 50.0000 (57.5000) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/19] time 0.477 (0.434) data 0.346 (0.304) loss_x loss_x 1.1777 (1.5323) acc_x 65.6250 (58.7500) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/19] time 0.360 (0.432) data 0.231 (0.302) loss_x loss_x 1.9727 (1.5414) acc_x 53.1250 (58.5417) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1780
confident_label rate tensor(0.2018, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 633
clean true:539
clean false:94
clean_rate:0.8515007898894155
noisy true:817
noisy false:1686
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 2503
epoch [36/200] batch [5/19] time 0.522 (0.465) data 0.391 (0.335) loss_x loss_x 1.4551 (1.4010) acc_x 59.3750 (59.3750) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [10/19] time 0.405 (0.468) data 0.274 (0.337) loss_x loss_x 1.8516 (1.4826) acc_x 59.3750 (60.9375) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/19] time 0.557 (0.457) data 0.427 (0.327) loss_x loss_x 1.7051 (1.4817) acc_x 50.0000 (60.6250) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.1952, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 612
clean true:530
clean false:82
clean_rate:0.8660130718954249
noisy true:820
noisy false:1704
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 2524
epoch [37/200] batch [5/19] time 0.500 (0.479) data 0.370 (0.348) loss_x loss_x 1.2178 (1.7607) acc_x 65.6250 (55.0000) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/19] time 0.433 (0.453) data 0.303 (0.323) loss_x loss_x 1.9434 (1.7091) acc_x 59.3750 (56.5625) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/19] time 0.632 (0.456) data 0.501 (0.326) loss_x loss_x 2.1367 (1.6319) acc_x 53.1250 (58.1250) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.1948, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 611
clean true:519
clean false:92
clean_rate:0.8494271685761048
noisy true:804
noisy false:1721
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 2525
epoch [38/200] batch [5/19] time 0.435 (0.490) data 0.304 (0.360) loss_x loss_x 1.4395 (1.3854) acc_x 56.2500 (61.8750) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [10/19] time 0.471 (0.470) data 0.340 (0.340) loss_x loss_x 1.4385 (1.4355) acc_x 65.6250 (64.3750) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/19] time 0.418 (0.474) data 0.288 (0.343) loss_x loss_x 1.6191 (1.5223) acc_x 50.0000 (61.4583) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1825
confident_label rate tensor(0.1996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 626
clean true:528
clean false:98
clean_rate:0.8434504792332268
noisy true:783
noisy false:1727
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 2510
epoch [39/200] batch [5/19] time 0.338 (0.515) data 0.208 (0.385) loss_x loss_x 1.9160 (1.6309) acc_x 40.6250 (56.2500) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [10/19] time 0.499 (0.487) data 0.369 (0.357) loss_x loss_x 1.7969 (1.6528) acc_x 56.2500 (58.7500) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/19] time 0.373 (0.460) data 0.243 (0.329) loss_x loss_x 1.0703 (1.5717) acc_x 71.8750 (60.6250) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2006, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 629
clean true:535
clean false:94
clean_rate:0.8505564387917329
noisy true:829
noisy false:1678
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 2507
epoch [40/200] batch [5/19] time 0.590 (0.486) data 0.460 (0.355) loss_x loss_x 1.4678 (1.4971) acc_x 50.0000 (53.1250) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [10/19] time 0.430 (0.473) data 0.300 (0.343) loss_x loss_x 1.7236 (1.6378) acc_x 50.0000 (51.2500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/19] time 0.412 (0.466) data 0.282 (0.336) loss_x loss_x 1.8857 (1.6014) acc_x 50.0000 (53.5417) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 634
clean true:537
clean false:97
clean_rate:0.8470031545741324
noisy true:815
noisy false:1687
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 2502
epoch [41/200] batch [5/19] time 0.485 (0.425) data 0.355 (0.295) loss_x loss_x 1.1172 (1.4619) acc_x 62.5000 (59.3750) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/19] time 0.418 (0.443) data 0.288 (0.312) loss_x loss_x 1.4336 (1.4995) acc_x 59.3750 (61.2500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/19] time 0.523 (0.440) data 0.394 (0.310) loss_x loss_x 1.2773 (1.5018) acc_x 59.3750 (60.6250) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1820
confident_label rate tensor(0.1996, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 626
clean true:528
clean false:98
clean_rate:0.8434504792332268
noisy true:788
noisy false:1722
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 2510
epoch [42/200] batch [5/19] time 0.473 (0.477) data 0.343 (0.347) loss_x loss_x 1.9521 (1.5367) acc_x 50.0000 (59.3750) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/19] time 0.415 (0.440) data 0.286 (0.310) loss_x loss_x 2.0586 (1.4402) acc_x 50.0000 (61.8750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/19] time 0.491 (0.432) data 0.361 (0.302) loss_x loss_x 1.7012 (1.4602) acc_x 50.0000 (61.2500) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1793
confident_label rate tensor(0.1952, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 612
clean true:534
clean false:78
clean_rate:0.8725490196078431
noisy true:809
noisy false:1715
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 2524
epoch [43/200] batch [5/19] time 0.460 (0.412) data 0.330 (0.281) loss_x loss_x 1.6758 (1.5641) acc_x 56.2500 (59.3750) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/19] time 0.583 (0.452) data 0.452 (0.322) loss_x loss_x 2.0078 (1.5456) acc_x 56.2500 (60.9375) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/19] time 0.408 (0.459) data 0.279 (0.329) loss_x loss_x 1.5176 (1.5612) acc_x 53.1250 (58.5417) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1818
confident_label rate tensor(0.2041, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 640
clean true:536
clean false:104
clean_rate:0.8375
noisy true:782
noisy false:1714
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 2496
epoch [44/200] batch [5/20] time 0.414 (0.439) data 0.284 (0.309) loss_x loss_x 2.0059 (1.6082) acc_x 53.1250 (59.3750) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [10/20] time 0.503 (0.467) data 0.372 (0.337) loss_x loss_x 1.2002 (1.5188) acc_x 59.3750 (59.6875) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/20] time 0.577 (0.451) data 0.447 (0.321) loss_x loss_x 1.9277 (1.5541) acc_x 46.8750 (59.1667) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/20] time 0.511 (0.452) data 0.380 (0.322) loss_x loss_x 2.0723 (1.6046) acc_x 46.8750 (57.6562) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1761
confident_label rate tensor(0.2066, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 648
clean true:554
clean false:94
clean_rate:0.8549382716049383
noisy true:821
noisy false:1667
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 2488
epoch [45/200] batch [5/20] time 0.376 (0.428) data 0.245 (0.297) loss_x loss_x 1.5732 (1.3230) acc_x 56.2500 (67.5000) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [10/20] time 0.552 (0.487) data 0.422 (0.356) loss_x loss_x 1.0527 (1.4029) acc_x 65.6250 (64.6875) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/20] time 0.382 (0.468) data 0.252 (0.337) loss_x loss_x 1.4688 (1.4797) acc_x 53.1250 (61.4583) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/20] time 0.547 (0.458) data 0.417 (0.327) loss_x loss_x 1.6338 (1.5206) acc_x 56.2500 (59.6875) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1814
confident_label rate tensor(0.2028, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 636
clean true:521
clean false:115
clean_rate:0.8191823899371069
noisy true:801
noisy false:1699
after delete: len(clean_dataset) 636
after delete: len(noisy_dataset) 2500
epoch [46/200] batch [5/19] time 0.424 (0.475) data 0.295 (0.345) loss_x loss_x 1.1611 (1.3826) acc_x 65.6250 (65.0000) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [10/19] time 0.477 (0.451) data 0.347 (0.320) loss_x loss_x 1.8789 (1.4283) acc_x 43.7500 (63.4375) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/19] time 0.471 (0.444) data 0.341 (0.313) loss_x loss_x 1.0400 (1.4447) acc_x 71.8750 (62.0833) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1780
confident_label rate tensor(0.2070, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 649
clean true:546
clean false:103
clean_rate:0.8412942989214176
noisy true:810
noisy false:1677
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 2487
epoch [47/200] batch [5/20] time 0.349 (0.467) data 0.219 (0.336) loss_x loss_x 1.5557 (1.4353) acc_x 59.3750 (62.5000) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [10/20] time 0.411 (0.442) data 0.281 (0.311) loss_x loss_x 1.1562 (1.4561) acc_x 65.6250 (59.3750) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/20] time 0.357 (0.438) data 0.227 (0.307) loss_x loss_x 1.4375 (1.4932) acc_x 65.6250 (58.3333) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/20] time 0.479 (0.457) data 0.349 (0.327) loss_x loss_x 1.1729 (1.4713) acc_x 75.0000 (60.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2098, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 658
clean true:552
clean false:106
clean_rate:0.8389057750759878
noisy true:828
noisy false:1650
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 2478
epoch [48/200] batch [5/20] time 0.391 (0.404) data 0.260 (0.273) loss_x loss_x 1.0830 (1.4316) acc_x 68.7500 (60.6250) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/20] time 0.406 (0.438) data 0.276 (0.307) loss_x loss_x 1.6953 (1.4765) acc_x 56.2500 (61.5625) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/20] time 0.517 (0.432) data 0.387 (0.301) loss_x loss_x 1.4248 (1.4916) acc_x 68.7500 (61.8750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/20] time 0.436 (0.439) data 0.306 (0.309) loss_x loss_x 1.8906 (1.5423) acc_x 46.8750 (60.0000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1805
confident_label rate tensor(0.1939, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 608
clean true:511
clean false:97
clean_rate:0.8404605263157895
noisy true:820
noisy false:1708
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 2528
epoch [49/200] batch [5/19] time 0.438 (0.451) data 0.308 (0.321) loss_x loss_x 1.2051 (1.4305) acc_x 62.5000 (62.5000) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/19] time 0.436 (0.432) data 0.305 (0.302) loss_x loss_x 1.4570 (1.4022) acc_x 59.3750 (64.6875) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/19] time 0.368 (0.432) data 0.238 (0.302) loss_x loss_x 1.5615 (1.4227) acc_x 50.0000 (63.9583) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1799
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:540
clean false:115
clean_rate:0.8244274809160306
noisy true:797
noisy false:1684
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [50/200] batch [5/20] time 0.529 (0.511) data 0.398 (0.381) loss_x loss_x 1.2314 (1.4877) acc_x 75.0000 (62.5000) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [10/20] time 0.453 (0.489) data 0.323 (0.359) loss_x loss_x 1.8096 (1.4398) acc_x 53.1250 (61.2500) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/20] time 0.493 (0.477) data 0.364 (0.347) loss_x loss_x 1.5254 (1.4673) acc_x 62.5000 (61.8750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/20] time 0.457 (0.458) data 0.327 (0.328) loss_x loss_x 1.4971 (1.4045) acc_x 53.1250 (62.8125) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1814
confident_label rate tensor(0.2006, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 629
clean true:509
clean false:120
clean_rate:0.809220985691574
noisy true:813
noisy false:1694
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 2507
epoch [51/200] batch [5/19] time 0.361 (0.408) data 0.231 (0.277) loss_x loss_x 1.2715 (1.4988) acc_x 65.6250 (63.1250) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/19] time 0.558 (0.442) data 0.428 (0.311) loss_x loss_x 1.2441 (1.4726) acc_x 71.8750 (64.6875) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/19] time 0.436 (0.431) data 0.306 (0.300) loss_x loss_x 1.7148 (1.5061) acc_x 56.2500 (64.3750) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1823
confident_label rate tensor(0.1971, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 618
clean true:515
clean false:103
clean_rate:0.8333333333333334
noisy true:798
noisy false:1720
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 2518
epoch [52/200] batch [5/19] time 0.493 (0.483) data 0.363 (0.353) loss_x loss_x 1.3662 (1.4217) acc_x 59.3750 (64.3750) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [10/19] time 0.421 (0.447) data 0.292 (0.317) loss_x loss_x 1.3848 (1.4456) acc_x 59.3750 (60.9375) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/19] time 0.435 (0.443) data 0.305 (0.312) loss_x loss_x 1.7266 (1.4612) acc_x 53.1250 (60.4167) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.2054, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 644
clean true:545
clean false:99
clean_rate:0.8462732919254659
noisy true:824
noisy false:1668
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 2492
epoch [53/200] batch [5/20] time 0.508 (0.458) data 0.379 (0.328) loss_x loss_x 1.4336 (1.3250) acc_x 68.7500 (62.5000) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [10/20] time 0.388 (0.439) data 0.258 (0.309) loss_x loss_x 1.4492 (1.4438) acc_x 53.1250 (61.5625) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/20] time 0.479 (0.443) data 0.349 (0.313) loss_x loss_x 1.4902 (1.4122) acc_x 75.0000 (61.4583) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/20] time 0.515 (0.449) data 0.386 (0.319) loss_x loss_x 1.1719 (1.4096) acc_x 68.7500 (61.8750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1781
confident_label rate tensor(0.1990, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 624
clean true:528
clean false:96
clean_rate:0.8461538461538461
noisy true:827
noisy false:1685
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 2512
epoch [54/200] batch [5/19] time 0.396 (0.430) data 0.266 (0.300) loss_x loss_x 1.8545 (1.5092) acc_x 50.0000 (61.2500) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [10/19] time 0.397 (0.427) data 0.267 (0.297) loss_x loss_x 1.0703 (1.3889) acc_x 71.8750 (63.1250) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/19] time 0.391 (0.437) data 0.261 (0.306) loss_x loss_x 1.1191 (1.3902) acc_x 71.8750 (64.1667) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.1987, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 623
clean true:516
clean false:107
clean_rate:0.8282504012841091
noisy true:807
noisy false:1706
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 2513
epoch [55/200] batch [5/19] time 0.480 (0.431) data 0.349 (0.300) loss_x loss_x 1.2461 (1.2797) acc_x 68.7500 (65.0000) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [10/19] time 0.380 (0.447) data 0.249 (0.317) loss_x loss_x 1.7861 (1.4729) acc_x 59.3750 (61.8750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/19] time 0.479 (0.455) data 0.349 (0.325) loss_x loss_x 1.1465 (1.4566) acc_x 65.6250 (62.0833) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 656
clean true:554
clean false:102
clean_rate:0.8445121951219512
noisy true:808
noisy false:1672
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 2480
epoch [56/200] batch [5/20] time 0.397 (0.427) data 0.267 (0.297) loss_x loss_x 1.8516 (1.5924) acc_x 50.0000 (60.0000) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/20] time 0.498 (0.429) data 0.367 (0.299) loss_x loss_x 1.5889 (1.5590) acc_x 56.2500 (60.9375) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/20] time 0.642 (0.450) data 0.512 (0.320) loss_x loss_x 1.5381 (1.4782) acc_x 50.0000 (60.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/20] time 0.498 (0.467) data 0.368 (0.336) loss_x loss_x 1.5156 (1.5288) acc_x 65.6250 (60.1562) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1779
confident_label rate tensor(0.2060, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 646
clean true:537
clean false:109
clean_rate:0.8312693498452013
noisy true:820
noisy false:1670
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 2490
epoch [57/200] batch [5/20] time 0.380 (0.458) data 0.250 (0.328) loss_x loss_x 0.9258 (1.1740) acc_x 75.0000 (68.7500) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [10/20] time 0.437 (0.440) data 0.306 (0.310) loss_x loss_x 1.6982 (1.3863) acc_x 50.0000 (63.1250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/20] time 0.471 (0.459) data 0.341 (0.329) loss_x loss_x 1.5801 (1.3926) acc_x 59.3750 (64.1667) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/20] time 0.510 (0.461) data 0.379 (0.331) loss_x loss_x 1.0029 (1.3462) acc_x 62.5000 (64.5312) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 638
clean true:534
clean false:104
clean_rate:0.8369905956112853
noisy true:836
noisy false:1662
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 2498
epoch [58/200] batch [5/19] time 0.559 (0.533) data 0.428 (0.403) loss_x loss_x 1.4521 (1.1936) acc_x 59.3750 (66.8750) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [10/19] time 0.386 (0.470) data 0.255 (0.339) loss_x loss_x 1.2246 (1.3484) acc_x 65.6250 (62.1875) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/19] time 0.336 (0.459) data 0.206 (0.329) loss_x loss_x 1.5498 (1.3371) acc_x 68.7500 (63.5417) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1765
confident_label rate tensor(0.2101, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 659
clean true:559
clean false:100
clean_rate:0.8482549317147192
noisy true:812
noisy false:1665
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 2477
epoch [59/200] batch [5/20] time 0.385 (0.416) data 0.254 (0.286) loss_x loss_x 1.3359 (1.3508) acc_x 50.0000 (61.2500) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [10/20] time 0.575 (0.473) data 0.445 (0.343) loss_x loss_x 1.4922 (1.3348) acc_x 65.6250 (65.0000) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/20] time 0.392 (0.456) data 0.261 (0.326) loss_x loss_x 0.9624 (1.3377) acc_x 62.5000 (62.9167) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/20] time 0.453 (0.453) data 0.322 (0.323) loss_x loss_x 1.2617 (1.3623) acc_x 65.6250 (62.3438) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.2041, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 640
clean true:535
clean false:105
clean_rate:0.8359375
noisy true:833
noisy false:1663
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 2496
epoch [60/200] batch [5/20] time 0.421 (0.465) data 0.286 (0.334) loss_x loss_x 1.5820 (1.6094) acc_x 59.3750 (59.3750) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [10/20] time 0.406 (0.464) data 0.275 (0.333) loss_x loss_x 1.4873 (1.6644) acc_x 71.8750 (60.6250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/20] time 0.601 (0.468) data 0.471 (0.337) loss_x loss_x 1.3066 (1.5393) acc_x 68.7500 (62.0833) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/20] time 0.410 (0.455) data 0.279 (0.325) loss_x loss_x 1.2197 (1.4874) acc_x 65.6250 (63.9062) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1764
confident_label rate tensor(0.2105, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 660
clean true:550
clean false:110
clean_rate:0.8333333333333334
noisy true:822
noisy false:1654
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 2476
epoch [61/200] batch [5/20] time 0.464 (0.468) data 0.333 (0.338) loss_x loss_x 1.5449 (1.5426) acc_x 62.5000 (61.8750) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [10/20] time 0.389 (0.463) data 0.259 (0.332) loss_x loss_x 1.6436 (1.5448) acc_x 62.5000 (60.0000) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/20] time 0.447 (0.470) data 0.316 (0.339) loss_x loss_x 1.5762 (1.5344) acc_x 62.5000 (60.2083) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/20] time 0.450 (0.474) data 0.320 (0.344) loss_x loss_x 1.4248 (1.5017) acc_x 53.1250 (60.0000) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1762
confident_label rate tensor(0.2082, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 653
clean true:550
clean false:103
clean_rate:0.8422664624808576
noisy true:824
noisy false:1659
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 2483
epoch [62/200] batch [5/20] time 0.435 (0.421) data 0.305 (0.291) loss_x loss_x 1.7979 (1.5539) acc_x 65.6250 (61.8750) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/20] time 0.443 (0.428) data 0.313 (0.298) loss_x loss_x 2.4082 (1.6559) acc_x 43.7500 (56.5625) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/20] time 0.361 (0.439) data 0.230 (0.308) loss_x loss_x 1.9570 (1.6437) acc_x 50.0000 (56.4583) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/20] time 0.382 (0.438) data 0.252 (0.308) loss_x loss_x 1.9805 (1.6493) acc_x 40.6250 (56.2500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1791
confident_label rate tensor(0.2089, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 655
clean true:536
clean false:119
clean_rate:0.8183206106870229
noisy true:809
noisy false:1672
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 2481
epoch [63/200] batch [5/20] time 0.563 (0.458) data 0.433 (0.327) loss_x loss_x 1.6885 (1.5373) acc_x 62.5000 (61.2500) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [10/20] time 0.615 (0.458) data 0.485 (0.328) loss_x loss_x 1.2305 (1.4423) acc_x 71.8750 (62.1875) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/20] time 0.456 (0.459) data 0.326 (0.328) loss_x loss_x 1.1934 (1.4869) acc_x 78.1250 (62.0833) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/20] time 0.475 (0.457) data 0.345 (0.326) loss_x loss_x 1.2090 (1.4328) acc_x 68.7500 (63.2812) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1753
confident_label rate tensor(0.2076, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 651
clean true:548
clean false:103
clean_rate:0.8417818740399385
noisy true:835
noisy false:1650
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 2485
epoch [64/200] batch [5/20] time 0.437 (0.453) data 0.307 (0.322) loss_x loss_x 1.6572 (1.4436) acc_x 53.1250 (60.6250) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [10/20] time 0.399 (0.448) data 0.269 (0.317) loss_x loss_x 1.9326 (1.5177) acc_x 46.8750 (61.2500) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/20] time 0.453 (0.439) data 0.323 (0.308) loss_x loss_x 1.8018 (1.4150) acc_x 46.8750 (63.1250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/20] time 0.510 (0.443) data 0.379 (0.312) loss_x loss_x 1.0869 (1.4322) acc_x 81.2500 (63.4375) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.2025, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 635
clean true:541
clean false:94
clean_rate:0.8519685039370078
noisy true:811
noisy false:1690
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 2501
epoch [65/200] batch [5/19] time 0.450 (0.430) data 0.321 (0.299) loss_x loss_x 1.7012 (1.5156) acc_x 56.2500 (60.6250) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [10/19] time 0.501 (0.443) data 0.371 (0.312) loss_x loss_x 0.9355 (1.4132) acc_x 68.7500 (63.1250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/19] time 0.518 (0.450) data 0.388 (0.320) loss_x loss_x 1.4746 (1.4368) acc_x 65.6250 (62.7083) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 656
clean true:545
clean false:111
clean_rate:0.8307926829268293
noisy true:774
noisy false:1706
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 2480
epoch [66/200] batch [5/20] time 0.393 (0.431) data 0.262 (0.301) loss_x loss_x 1.3447 (1.4668) acc_x 68.7500 (62.5000) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [10/20] time 0.414 (0.442) data 0.284 (0.312) loss_x loss_x 1.4951 (1.4803) acc_x 59.3750 (62.1875) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/20] time 0.471 (0.450) data 0.341 (0.320) loss_x loss_x 1.4824 (1.5740) acc_x 75.0000 (60.8333) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/20] time 0.368 (0.443) data 0.239 (0.313) loss_x loss_x 1.0361 (1.4921) acc_x 65.6250 (61.8750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1815
confident_label rate tensor(0.2098, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 658
clean true:563
clean false:95
clean_rate:0.8556231003039514
noisy true:758
noisy false:1720
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 2478
epoch [67/200] batch [5/20] time 0.421 (0.421) data 0.290 (0.291) loss_x loss_x 0.9795 (1.5197) acc_x 75.0000 (62.5000) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [10/20] time 0.537 (0.444) data 0.407 (0.314) loss_x loss_x 1.3643 (1.5235) acc_x 71.8750 (62.5000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/20] time 0.433 (0.459) data 0.304 (0.328) loss_x loss_x 1.3047 (1.4784) acc_x 62.5000 (63.5417) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/20] time 0.412 (0.457) data 0.282 (0.327) loss_x loss_x 1.5820 (1.4912) acc_x 56.2500 (63.2812) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.2136, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 670
clean true:561
clean false:109
clean_rate:0.8373134328358209
noisy true:816
noisy false:1650
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 2466
epoch [68/200] batch [5/20] time 0.572 (0.517) data 0.441 (0.386) loss_x loss_x 1.4609 (1.5026) acc_x 62.5000 (61.8750) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [10/20] time 0.408 (0.478) data 0.277 (0.347) loss_x loss_x 1.2480 (1.3611) acc_x 75.0000 (65.0000) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/20] time 0.496 (0.471) data 0.366 (0.341) loss_x loss_x 1.2900 (1.3855) acc_x 59.3750 (64.3750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/20] time 0.418 (0.454) data 0.287 (0.323) loss_x loss_x 1.8701 (1.4353) acc_x 68.7500 (63.7500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1739
confident_label rate tensor(0.2143, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 672
clean true:559
clean false:113
clean_rate:0.8318452380952381
noisy true:838
noisy false:1626
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 2464
epoch [69/200] batch [5/21] time 0.379 (0.454) data 0.249 (0.323) loss_x loss_x 1.8174 (1.5173) acc_x 68.7500 (65.6250) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [10/21] time 0.464 (0.446) data 0.333 (0.315) loss_x loss_x 1.4082 (1.5832) acc_x 59.3750 (59.6875) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/21] time 0.368 (0.426) data 0.238 (0.295) loss_x loss_x 1.4531 (1.5474) acc_x 68.7500 (60.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/21] time 0.402 (0.429) data 0.272 (0.299) loss_x loss_x 1.5439 (1.5031) acc_x 56.2500 (61.0938) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 621
clean true:527
clean false:94
clean_rate:0.8486312399355878
noisy true:823
noisy false:1692
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 2515
epoch [70/200] batch [5/19] time 0.369 (0.473) data 0.239 (0.342) loss_x loss_x 1.1689 (1.4389) acc_x 75.0000 (63.1250) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [10/19] time 0.380 (0.460) data 0.249 (0.329) loss_x loss_x 1.5566 (1.3528) acc_x 65.6250 (66.5625) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/19] time 0.416 (0.455) data 0.285 (0.324) loss_x loss_x 1.2734 (1.3641) acc_x 59.3750 (64.5833) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1741
confident_label rate tensor(0.2318, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 727
clean true:597
clean false:130
clean_rate:0.8211829436038515
noisy true:798
noisy false:1611
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 2409
epoch [71/200] batch [5/22] time 0.541 (0.478) data 0.410 (0.348) loss_x loss_x 1.2051 (1.4109) acc_x 65.6250 (60.6250) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [10/22] time 0.505 (0.463) data 0.375 (0.333) loss_x loss_x 1.7363 (1.5039) acc_x 53.1250 (61.5625) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [15/22] time 0.403 (0.446) data 0.274 (0.316) loss_x loss_x 1.8867 (1.5253) acc_x 46.8750 (60.0000) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/22] time 0.518 (0.447) data 0.388 (0.317) loss_x loss_x 1.4775 (1.4932) acc_x 46.8750 (59.3750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 690
clean true:566
clean false:124
clean_rate:0.8202898550724638
noisy true:798
noisy false:1648
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 2446
epoch [72/200] batch [5/21] time 0.506 (0.441) data 0.375 (0.310) loss_x loss_x 1.7598 (1.4691) acc_x 56.2500 (59.3750) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [10/21] time 0.437 (0.452) data 0.307 (0.321) loss_x loss_x 1.0781 (1.4111) acc_x 68.7500 (63.1250) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/21] time 0.560 (0.458) data 0.430 (0.327) loss_x loss_x 2.0273 (1.4176) acc_x 56.2500 (62.9167) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/21] time 0.557 (0.465) data 0.426 (0.334) loss_x loss_x 2.3262 (1.4377) acc_x 62.5000 (63.1250) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.2149, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 674
clean true:555
clean false:119
clean_rate:0.8234421364985163
noisy true:813
noisy false:1649
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 2462
epoch [73/200] batch [5/21] time 0.562 (0.461) data 0.432 (0.331) loss_x loss_x 1.5439 (1.5461) acc_x 68.7500 (61.2500) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [10/21] time 0.585 (0.446) data 0.455 (0.316) loss_x loss_x 1.3838 (1.6127) acc_x 62.5000 (59.3750) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/21] time 0.438 (0.435) data 0.307 (0.305) loss_x loss_x 1.1689 (1.5233) acc_x 75.0000 (60.6250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/21] time 0.441 (0.441) data 0.311 (0.310) loss_x loss_x 1.3584 (1.5517) acc_x 68.7500 (60.3125) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1799
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 683
clean true:569
clean false:114
clean_rate:0.8330893118594437
noisy true:768
noisy false:1685
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 2453
epoch [74/200] batch [5/21] time 0.432 (0.466) data 0.302 (0.336) loss_x loss_x 1.6777 (1.2702) acc_x 53.1250 (68.7500) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [10/21] time 0.397 (0.465) data 0.267 (0.335) loss_x loss_x 1.3760 (1.3477) acc_x 71.8750 (65.9375) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [15/21] time 0.509 (0.476) data 0.380 (0.346) loss_x loss_x 1.8311 (1.3731) acc_x 62.5000 (66.0417) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/21] time 0.387 (0.451) data 0.256 (0.321) loss_x loss_x 1.2764 (1.3998) acc_x 71.8750 (64.3750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1749
confident_label rate tensor(0.2140, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 671
clean true:543
clean false:128
clean_rate:0.8092399403874814
noisy true:844
noisy false:1621
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 2465
epoch [75/200] batch [5/20] time 0.473 (0.431) data 0.342 (0.300) loss_x loss_x 1.3672 (1.3033) acc_x 62.5000 (61.8750) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/20] time 0.398 (0.424) data 0.268 (0.294) loss_x loss_x 1.6973 (1.3632) acc_x 59.3750 (61.8750) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/20] time 0.501 (0.437) data 0.371 (0.307) loss_x loss_x 1.3525 (1.4150) acc_x 75.0000 (62.0833) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/20] time 0.496 (0.426) data 0.366 (0.296) loss_x loss_x 1.1904 (1.3893) acc_x 68.7500 (63.7500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1770
confident_label rate tensor(0.2149, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 674
clean true:553
clean false:121
clean_rate:0.8204747774480712
noisy true:813
noisy false:1649
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 2462
epoch [76/200] batch [5/21] time 0.500 (0.476) data 0.370 (0.346) loss_x loss_x 1.6982 (1.3361) acc_x 56.2500 (64.3750) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [10/21] time 0.437 (0.434) data 0.307 (0.304) loss_x loss_x 1.1777 (1.3740) acc_x 71.8750 (63.4375) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/21] time 0.504 (0.444) data 0.374 (0.314) loss_x loss_x 1.8955 (1.3919) acc_x 53.1250 (63.1250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/21] time 0.527 (0.452) data 0.396 (0.322) loss_x loss_x 0.9995 (1.3381) acc_x 75.0000 (63.9062) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2216, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 695
clean true:576
clean false:119
clean_rate:0.8287769784172662
noisy true:816
noisy false:1625
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 2441
epoch [77/200] batch [5/21] time 0.416 (0.460) data 0.285 (0.329) loss_x loss_x 0.9741 (1.4103) acc_x 68.7500 (68.7500) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [10/21] time 0.355 (0.456) data 0.224 (0.326) loss_x loss_x 1.4424 (1.3771) acc_x 56.2500 (66.5625) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [15/21] time 0.391 (0.444) data 0.261 (0.313) loss_x loss_x 1.7344 (1.3917) acc_x 50.0000 (64.7917) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/21] time 0.443 (0.446) data 0.313 (0.316) loss_x loss_x 1.5840 (1.4293) acc_x 53.1250 (63.9062) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1763
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 686
clean true:560
clean false:126
clean_rate:0.8163265306122449
noisy true:813
noisy false:1637
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 2450
epoch [78/200] batch [5/21] time 0.408 (0.408) data 0.278 (0.278) loss_x loss_x 1.7012 (1.5297) acc_x 62.5000 (62.5000) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [10/21] time 0.459 (0.423) data 0.329 (0.293) loss_x loss_x 1.0166 (1.4608) acc_x 75.0000 (62.1875) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/21] time 0.470 (0.428) data 0.339 (0.297) loss_x loss_x 1.3535 (1.4441) acc_x 50.0000 (61.6667) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/21] time 0.444 (0.441) data 0.313 (0.311) loss_x loss_x 1.6963 (1.4016) acc_x 50.0000 (62.9688) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.2108, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 661
clean true:546
clean false:115
clean_rate:0.8260211800302572
noisy true:806
noisy false:1669
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 2475
epoch [79/200] batch [5/20] time 0.361 (0.395) data 0.231 (0.264) loss_x loss_x 1.3066 (1.2984) acc_x 65.6250 (66.8750) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/20] time 0.371 (0.422) data 0.241 (0.291) loss_x loss_x 1.8516 (1.3840) acc_x 59.3750 (65.3125) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/20] time 0.397 (0.429) data 0.266 (0.299) loss_x loss_x 1.4033 (1.3762) acc_x 65.6250 (65.2083) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/20] time 0.459 (0.439) data 0.329 (0.309) loss_x loss_x 1.2695 (1.3998) acc_x 59.3750 (64.0625) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1777
confident_label rate tensor(0.2159, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 677
clean true:561
clean false:116
clean_rate:0.8286558345642541
noisy true:798
noisy false:1661
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 2459
epoch [80/200] batch [5/21] time 0.477 (0.460) data 0.347 (0.330) loss_x loss_x 1.7305 (1.5191) acc_x 56.2500 (62.5000) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [10/21] time 0.481 (0.461) data 0.351 (0.331) loss_x loss_x 1.5234 (1.4027) acc_x 46.8750 (61.2500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [15/21] time 0.577 (0.459) data 0.446 (0.329) loss_x loss_x 2.0215 (1.4262) acc_x 50.0000 (61.4583) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/21] time 0.438 (0.446) data 0.308 (0.316) loss_x loss_x 1.3301 (1.4155) acc_x 53.1250 (61.7188) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1771
confident_label rate tensor(0.2242, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 703
clean true:581
clean false:122
clean_rate:0.8264580369843528
noisy true:784
noisy false:1649
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 2433
epoch [81/200] batch [5/21] time 0.498 (0.500) data 0.367 (0.369) loss_x loss_x 1.2432 (1.2864) acc_x 59.3750 (63.1250) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [10/21] time 0.365 (0.466) data 0.235 (0.335) loss_x loss_x 1.9131 (1.3297) acc_x 50.0000 (64.6875) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [15/21] time 0.458 (0.457) data 0.329 (0.326) loss_x loss_x 1.0879 (1.2977) acc_x 65.6250 (65.2083) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/21] time 0.490 (0.457) data 0.360 (0.326) loss_x loss_x 1.2070 (1.3121) acc_x 68.7500 (66.2500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.2203, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 691
clean true:561
clean false:130
clean_rate:0.8118668596237337
noisy true:808
noisy false:1637
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 2445
epoch [82/200] batch [5/21] time 0.393 (0.443) data 0.264 (0.312) loss_x loss_x 1.3545 (1.3229) acc_x 65.6250 (66.8750) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [10/21] time 0.479 (0.458) data 0.350 (0.328) loss_x loss_x 1.5654 (1.4804) acc_x 65.6250 (63.1250) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [15/21] time 0.595 (0.452) data 0.464 (0.322) loss_x loss_x 1.5098 (1.5130) acc_x 65.6250 (61.0417) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/21] time 0.404 (0.447) data 0.273 (0.317) loss_x loss_x 1.5771 (1.5523) acc_x 56.2500 (58.9062) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1779
confident_label rate tensor(0.2197, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 689
clean true:559
clean false:130
clean_rate:0.8113207547169812
noisy true:798
noisy false:1649
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 2447
epoch [83/200] batch [5/21] time 0.471 (0.441) data 0.342 (0.312) loss_x loss_x 0.7974 (1.1933) acc_x 75.0000 (66.2500) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [10/21] time 0.460 (0.439) data 0.329 (0.309) loss_x loss_x 1.1133 (1.3202) acc_x 62.5000 (66.8750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/21] time 0.468 (0.428) data 0.338 (0.298) loss_x loss_x 1.0137 (1.3944) acc_x 71.8750 (65.6250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/21] time 0.521 (0.427) data 0.391 (0.297) loss_x loss_x 1.2334 (1.3398) acc_x 81.2500 (66.8750) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2143, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 672
clean true:550
clean false:122
clean_rate:0.8184523809523809
noisy true:813
noisy false:1651
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 2464
epoch [84/200] batch [5/21] time 0.471 (0.395) data 0.341 (0.265) loss_x loss_x 1.9561 (1.3797) acc_x 46.8750 (66.2500) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [10/21] time 0.526 (0.427) data 0.396 (0.297) loss_x loss_x 1.5986 (1.4714) acc_x 65.6250 (63.4375) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/21] time 0.387 (0.454) data 0.257 (0.324) loss_x loss_x 1.2412 (1.4334) acc_x 62.5000 (63.9583) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/21] time 0.421 (0.452) data 0.290 (0.322) loss_x loss_x 1.2812 (1.4246) acc_x 68.7500 (64.3750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1755
confident_label rate tensor(0.2162, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 678
clean true:555
clean false:123
clean_rate:0.8185840707964602
noisy true:826
noisy false:1632
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 2458
epoch [85/200] batch [5/21] time 0.443 (0.495) data 0.313 (0.365) loss_x loss_x 1.4492 (1.4822) acc_x 59.3750 (61.8750) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [10/21] time 0.426 (0.483) data 0.296 (0.353) loss_x loss_x 1.2139 (1.2812) acc_x 71.8750 (66.8750) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [15/21] time 0.435 (0.468) data 0.304 (0.337) loss_x loss_x 1.2070 (1.2974) acc_x 56.2500 (66.0417) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/21] time 0.440 (0.466) data 0.310 (0.336) loss_x loss_x 1.1992 (1.3149) acc_x 75.0000 (67.1875) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1771
confident_label rate tensor(0.2213, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 694
clean true:567
clean false:127
clean_rate:0.8170028818443804
noisy true:798
noisy false:1644
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 2442
epoch [86/200] batch [5/21] time 0.379 (0.445) data 0.248 (0.314) loss_x loss_x 1.2959 (1.2144) acc_x 71.8750 (68.7500) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [10/21] time 0.409 (0.424) data 0.279 (0.294) loss_x loss_x 1.5430 (1.3423) acc_x 50.0000 (63.1250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/21] time 0.417 (0.423) data 0.287 (0.293) loss_x loss_x 1.2607 (1.4679) acc_x 68.7500 (62.0833) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/21] time 0.407 (0.430) data 0.276 (0.300) loss_x loss_x 1.1230 (1.4319) acc_x 75.0000 (63.1250) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2232, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 700
clean true:564
clean false:136
clean_rate:0.8057142857142857
noisy true:799
noisy false:1637
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 2436
epoch [87/200] batch [5/21] time 0.452 (0.444) data 0.322 (0.313) loss_x loss_x 1.3730 (1.3268) acc_x 68.7500 (65.6250) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [10/21] time 0.477 (0.460) data 0.347 (0.329) loss_x loss_x 1.5967 (1.2605) acc_x 59.3750 (65.3125) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [15/21] time 0.601 (0.462) data 0.471 (0.332) loss_x loss_x 1.0254 (1.3432) acc_x 78.1250 (64.1667) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/21] time 0.389 (0.463) data 0.258 (0.332) loss_x loss_x 1.1924 (1.2883) acc_x 71.8750 (65.6250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1782
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 696
clean true:558
clean false:138
clean_rate:0.8017241379310345
noisy true:796
noisy false:1644
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 2440
epoch [88/200] batch [5/21] time 0.428 (0.425) data 0.297 (0.295) loss_x loss_x 0.8970 (1.2854) acc_x 68.7500 (70.0000) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [10/21] time 0.410 (0.439) data 0.280 (0.309) loss_x loss_x 1.5020 (1.2634) acc_x 53.1250 (68.1250) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/21] time 0.415 (0.449) data 0.286 (0.319) loss_x loss_x 1.2627 (1.2883) acc_x 62.5000 (67.9167) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/21] time 0.625 (0.486) data 0.495 (0.355) loss_x loss_x 1.3555 (1.3204) acc_x 75.0000 (66.7188) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1808
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 696
clean true:558
clean false:138
clean_rate:0.8017241379310345
noisy true:770
noisy false:1670
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 2440
epoch [89/200] batch [5/21] time 0.453 (0.441) data 0.323 (0.311) loss_x loss_x 1.4922 (1.3272) acc_x 68.7500 (66.8750) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [10/21] time 0.350 (0.441) data 0.219 (0.311) loss_x loss_x 1.8164 (1.4307) acc_x 68.7500 (65.6250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/21] time 0.461 (0.448) data 0.330 (0.318) loss_x loss_x 1.4971 (1.3981) acc_x 62.5000 (65.0000) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/21] time 0.511 (0.448) data 0.380 (0.317) loss_x loss_x 1.3975 (1.3698) acc_x 68.7500 (66.4062) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1750
confident_label rate tensor(0.2270, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 712
clean true:585
clean false:127
clean_rate:0.8216292134831461
noisy true:801
noisy false:1623
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 2424
epoch [90/200] batch [5/22] time 0.549 (0.458) data 0.419 (0.328) loss_x loss_x 1.4971 (1.3784) acc_x 65.6250 (66.8750) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [10/22] time 0.484 (0.470) data 0.354 (0.340) loss_x loss_x 1.0215 (1.4405) acc_x 78.1250 (63.4375) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [15/22] time 0.350 (0.446) data 0.221 (0.316) loss_x loss_x 1.1494 (1.3699) acc_x 65.6250 (64.7917) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/22] time 0.374 (0.446) data 0.244 (0.316) loss_x loss_x 1.2734 (1.3800) acc_x 59.3750 (63.9062) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.2191, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 687
clean true:569
clean false:118
clean_rate:0.8282387190684134
noisy true:820
noisy false:1629
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 2449
epoch [91/200] batch [5/21] time 0.456 (0.457) data 0.325 (0.326) loss_x loss_x 0.9702 (1.4591) acc_x 81.2500 (64.3750) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [10/21] time 0.467 (0.454) data 0.336 (0.323) loss_x loss_x 1.8848 (1.4700) acc_x 56.2500 (65.3125) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/21] time 0.453 (0.437) data 0.322 (0.307) loss_x loss_x 1.9619 (1.4385) acc_x 56.2500 (63.9583) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/21] time 0.595 (0.443) data 0.464 (0.312) loss_x loss_x 1.3252 (1.4053) acc_x 56.2500 (63.7500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 683
clean true:545
clean false:138
clean_rate:0.7979502196193266
noisy true:825
noisy false:1628
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 2453
epoch [92/200] batch [5/21] time 0.520 (0.459) data 0.390 (0.329) loss_x loss_x 1.6123 (1.5588) acc_x 56.2500 (61.8750) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [10/21] time 0.551 (0.454) data 0.421 (0.324) loss_x loss_x 1.2383 (1.4672) acc_x 65.6250 (61.5625) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/21] time 0.403 (0.444) data 0.273 (0.314) loss_x loss_x 1.5098 (1.4271) acc_x 56.2500 (61.8750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/21] time 0.393 (0.446) data 0.263 (0.316) loss_x loss_x 1.5322 (1.4316) acc_x 68.7500 (61.7188) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.2152, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 675
clean true:551
clean false:124
clean_rate:0.8162962962962963
noisy true:790
noisy false:1671
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 2461
epoch [93/200] batch [5/21] time 0.390 (0.401) data 0.260 (0.271) loss_x loss_x 1.0742 (1.3734) acc_x 65.6250 (64.3750) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [10/21] time 0.533 (0.443) data 0.403 (0.313) loss_x loss_x 1.2617 (1.3562) acc_x 71.8750 (65.0000) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/21] time 0.446 (0.443) data 0.315 (0.313) loss_x loss_x 1.0303 (1.3753) acc_x 78.1250 (67.0833) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/21] time 0.382 (0.432) data 0.251 (0.302) loss_x loss_x 0.9585 (1.3603) acc_x 71.8750 (66.8750) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1791
confident_label rate tensor(0.2264, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 710
clean true:574
clean false:136
clean_rate:0.8084507042253521
noisy true:771
noisy false:1655
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 2426
epoch [94/200] batch [5/22] time 0.413 (0.423) data 0.283 (0.292) loss_x loss_x 1.2705 (1.6080) acc_x 56.2500 (65.6250) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [10/22] time 0.601 (0.474) data 0.470 (0.343) loss_x loss_x 1.5146 (1.5178) acc_x 62.5000 (63.4375) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [15/22] time 0.407 (0.476) data 0.276 (0.346) loss_x loss_x 1.5186 (1.4072) acc_x 68.7500 (65.4167) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/22] time 0.509 (0.476) data 0.379 (0.345) loss_x loss_x 1.5527 (1.4015) acc_x 68.7500 (65.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1769
confident_label rate tensor(0.2130, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 668
clean true:548
clean false:120
clean_rate:0.8203592814371258
noisy true:819
noisy false:1649
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 2468
epoch [95/200] batch [5/20] time 0.519 (0.506) data 0.388 (0.375) loss_x loss_x 1.7051 (1.4825) acc_x 43.7500 (61.2500) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [10/20] time 0.712 (0.486) data 0.582 (0.356) loss_x loss_x 0.8989 (1.3606) acc_x 75.0000 (66.8750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/20] time 0.489 (0.477) data 0.359 (0.346) loss_x loss_x 1.1865 (1.3079) acc_x 68.7500 (67.2917) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/20] time 0.405 (0.457) data 0.275 (0.326) loss_x loss_x 1.7021 (1.3238) acc_x 53.1250 (66.4062) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1813
confident_label rate tensor(0.2232, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 700
clean true:562
clean false:138
clean_rate:0.8028571428571428
noisy true:761
noisy false:1675
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 2436
epoch [96/200] batch [5/21] time 0.534 (0.491) data 0.404 (0.360) loss_x loss_x 1.2344 (1.4023) acc_x 59.3750 (60.0000) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [10/21] time 0.572 (0.475) data 0.441 (0.344) loss_x loss_x 1.1055 (1.3417) acc_x 68.7500 (62.8125) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [15/21] time 0.427 (0.469) data 0.296 (0.338) loss_x loss_x 1.1143 (1.3948) acc_x 75.0000 (62.9167) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/21] time 0.414 (0.468) data 0.284 (0.338) loss_x loss_x 1.2646 (1.4188) acc_x 78.1250 (62.6562) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2245, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 704
clean true:569
clean false:135
clean_rate:0.8082386363636364
noisy true:795
noisy false:1637
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 2432
epoch [97/200] batch [5/22] time 0.457 (0.437) data 0.328 (0.307) loss_x loss_x 0.7393 (1.0927) acc_x 81.2500 (70.6250) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [10/22] time 0.365 (0.431) data 0.234 (0.301) loss_x loss_x 0.8066 (1.2028) acc_x 81.2500 (69.0625) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [15/22] time 0.517 (0.439) data 0.386 (0.309) loss_x loss_x 1.3564 (1.3007) acc_x 59.3750 (67.5000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/22] time 0.431 (0.449) data 0.301 (0.319) loss_x loss_x 1.2969 (1.3116) acc_x 62.5000 (66.5625) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.2108, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 661
clean true:539
clean false:122
clean_rate:0.8154311649016641
noisy true:811
noisy false:1664
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 2475
epoch [98/200] batch [5/20] time 0.455 (0.438) data 0.325 (0.307) loss_x loss_x 1.1953 (1.3651) acc_x 65.6250 (60.0000) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [10/20] time 0.412 (0.450) data 0.281 (0.320) loss_x loss_x 1.2324 (1.2690) acc_x 71.8750 (63.1250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/20] time 0.586 (0.477) data 0.456 (0.347) loss_x loss_x 1.0371 (1.2513) acc_x 65.6250 (64.1667) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/20] time 0.473 (0.470) data 0.342 (0.340) loss_x loss_x 1.1621 (1.2217) acc_x 62.5000 (65.0000) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.2229, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 699
clean true:577
clean false:122
clean_rate:0.8254649499284692
noisy true:831
noisy false:1606
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 2437
epoch [99/200] batch [5/21] time 0.361 (0.404) data 0.231 (0.274) loss_x loss_x 1.6016 (1.3614) acc_x 65.6250 (70.0000) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [10/21] time 0.455 (0.463) data 0.324 (0.332) loss_x loss_x 1.4482 (1.3653) acc_x 65.6250 (68.1250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [15/21] time 0.376 (0.455) data 0.246 (0.324) loss_x loss_x 1.1016 (1.2896) acc_x 71.8750 (68.1250) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/21] time 0.486 (0.453) data 0.356 (0.323) loss_x loss_x 1.6445 (1.2878) acc_x 62.5000 (67.8125) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1773
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 720
clean true:592
clean false:128
clean_rate:0.8222222222222222
noisy true:771
noisy false:1645
all clean rate:  [0.779783393501805, 0.8414239482200647, 0.8788501026694046, 0.8532110091743119, 0.8702290076335878, 0.8622540250447227, 0.8747731397459165, 0.8843416370106761, 0.8616236162361623, 0.8629629629629629, 0.8657243816254417, 0.8603351955307262, 0.8476702508960573, 0.8579136690647482, 0.8658318425760286, 0.8548123980424144, 0.8433333333333334, 0.835016835016835, 0.8344827586206897, 0.8489932885906041, 0.841025641025641, 0.8518518518518519, 0.8465430016863407, 0.8573853989813243, 0.8494077834179357, 0.8552188552188552, 0.8384491114701131, 0.8482871125611745, 0.8438538205980066, 0.855072463768116, 0.8581196581196581, 0.8483412322274881, 0.8388791593695272, 0.8694214876033057, 0.8390804597701149, 0.8515007898894155, 0.8660130718954249, 0.8494271685761048, 0.8434504792332268, 0.8505564387917329, 0.8470031545741324, 0.8434504792332268, 0.8725490196078431, 0.8375, 0.8549382716049383, 0.8191823899371069, 0.8412942989214176, 0.8389057750759878, 0.8404605263157895, 0.8244274809160306, 0.809220985691574, 0.8333333333333334, 0.8462732919254659, 0.8461538461538461, 0.8282504012841091, 0.8445121951219512, 0.8312693498452013, 0.8369905956112853, 0.8482549317147192, 0.8359375, 0.8333333333333334, 0.8422664624808576, 0.8183206106870229, 0.8417818740399385, 0.8519685039370078, 0.8307926829268293, 0.8556231003039514, 0.8373134328358209, 0.8318452380952381, 0.8486312399355878, 0.8211829436038515, 0.8202898550724638, 0.8234421364985163, 0.8330893118594437, 0.8092399403874814, 0.8204747774480712, 0.8287769784172662, 0.8163265306122449, 0.8260211800302572, 0.8286558345642541, 0.8264580369843528, 0.8118668596237337, 0.8113207547169812, 0.8184523809523809, 0.8185840707964602, 0.8170028818443804, 0.8057142857142857, 0.8017241379310345, 0.8017241379310345, 0.8216292134831461, 0.8282387190684134, 0.7979502196193266, 0.8162962962962963, 0.8084507042253521, 0.8203592814371258, 0.8028571428571428, 0.8082386363636364, 0.8154311649016641, 0.8254649499284692, 0.8222222222222222]
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 2416
epoch [100/200] batch [5/22] time 0.557 (0.453) data 0.426 (0.322) loss_x loss_x 1.4746 (1.1873) acc_x 62.5000 (69.3750) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [10/22] time 0.565 (0.465) data 0.434 (0.334) loss_x loss_x 0.8169 (1.0613) acc_x 81.2500 (73.1250) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [15/22] time 0.322 (0.466) data 0.192 (0.335) loss_x loss_x 0.9746 (1.1653) acc_x 65.6250 (71.0417) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/22] time 0.389 (0.461) data 0.258 (0.330) loss_x loss_x 1.4600 (1.1902) acc_x 59.3750 (69.3750) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1771
confident_label rate tensor(0.2152, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 675
clean true:552
clean false:123
clean_rate:0.8177777777777778
noisy true:813
noisy false:1648
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 2461
epoch [101/200] batch [5/21] time 0.375 (0.431) data 0.244 (0.300) loss_x loss_x 1.4707 (1.5352) acc_x 65.6250 (63.7500) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [10/21] time 0.416 (0.457) data 0.286 (0.326) loss_x loss_x 1.3047 (1.3588) acc_x 65.6250 (65.6250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [15/21] time 0.424 (0.449) data 0.294 (0.318) loss_x loss_x 1.1367 (1.3250) acc_x 68.7500 (65.0000) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/21] time 0.409 (0.457) data 0.279 (0.327) loss_x loss_x 0.8950 (1.3597) acc_x 71.8750 (65.0000) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 686
clean true:554
clean false:132
clean_rate:0.8075801749271136
noisy true:808
noisy false:1642
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 2450
epoch [102/200] batch [5/21] time 0.464 (0.463) data 0.333 (0.332) loss_x loss_x 1.0479 (1.1524) acc_x 87.5000 (76.8750) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [10/21] time 0.499 (0.449) data 0.370 (0.318) loss_x loss_x 1.0938 (1.1497) acc_x 62.5000 (72.8125) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/21] time 0.596 (0.450) data 0.465 (0.320) loss_x loss_x 1.7285 (1.2122) acc_x 50.0000 (70.4167) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/21] time 0.527 (0.453) data 0.397 (0.323) loss_x loss_x 1.1504 (1.2726) acc_x 59.3750 (68.7500) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1754
confident_label rate tensor(0.2325, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 729
clean true:594
clean false:135
clean_rate:0.8148148148148148
noisy true:788
noisy false:1619
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 2407
epoch [103/200] batch [5/22] time 0.402 (0.432) data 0.272 (0.302) loss_x loss_x 0.8149 (1.1845) acc_x 81.2500 (67.5000) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [10/22] time 0.523 (0.432) data 0.393 (0.302) loss_x loss_x 1.4131 (1.2744) acc_x 59.3750 (66.8750) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [15/22] time 0.394 (0.429) data 0.263 (0.299) loss_x loss_x 1.3350 (1.2900) acc_x 62.5000 (66.4583) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/22] time 0.479 (0.426) data 0.348 (0.296) loss_x loss_x 1.7207 (1.3247) acc_x 59.3750 (65.9375) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1749
confident_label rate tensor(0.2219, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 696
clean true:571
clean false:125
clean_rate:0.8204022988505747
noisy true:816
noisy false:1624
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 2440
epoch [104/200] batch [5/21] time 0.434 (0.421) data 0.304 (0.291) loss_x loss_x 1.6035 (1.4873) acc_x 56.2500 (61.2500) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [10/21] time 0.471 (0.430) data 0.340 (0.299) loss_x loss_x 1.4404 (1.3813) acc_x 65.6250 (65.3125) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/21] time 0.385 (0.439) data 0.255 (0.308) loss_x loss_x 1.1318 (1.3801) acc_x 71.8750 (66.0417) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/21] time 0.432 (0.447) data 0.303 (0.317) loss_x loss_x 1.8477 (1.4043) acc_x 50.0000 (64.6875) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1740
confident_label rate tensor(0.2318, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 727
clean true:583
clean false:144
clean_rate:0.8019257221458047
noisy true:813
noisy false:1596
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 2409
epoch [105/200] batch [5/22] time 0.475 (0.515) data 0.345 (0.384) loss_x loss_x 1.4648 (1.2250) acc_x 68.7500 (66.8750) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [10/22] time 0.412 (0.506) data 0.281 (0.376) loss_x loss_x 1.3232 (1.4312) acc_x 65.6250 (62.1875) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [15/22] time 0.566 (0.495) data 0.435 (0.365) loss_x loss_x 1.0625 (1.3332) acc_x 78.1250 (64.5833) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/22] time 0.447 (0.475) data 0.316 (0.344) loss_x loss_x 1.6826 (1.3186) acc_x 56.2500 (65.4688) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 690
clean true:572
clean false:118
clean_rate:0.8289855072463768
noisy true:778
noisy false:1668
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 2446
epoch [106/200] batch [5/21] time 0.511 (0.444) data 0.380 (0.314) loss_x loss_x 1.0723 (1.3193) acc_x 65.6250 (65.0000) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [10/21] time 0.761 (0.495) data 0.631 (0.364) loss_x loss_x 0.8057 (1.2385) acc_x 75.0000 (67.1875) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [15/21] time 0.365 (0.480) data 0.235 (0.350) loss_x loss_x 1.5928 (1.2447) acc_x 56.2500 (66.2500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/21] time 0.422 (0.462) data 0.292 (0.332) loss_x loss_x 0.8389 (1.2702) acc_x 75.0000 (66.4062) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1765
confident_label rate tensor(0.2239, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 702
clean true:557
clean false:145
clean_rate:0.7934472934472935
noisy true:814
noisy false:1620
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 2434
epoch [107/200] batch [5/21] time 0.450 (0.422) data 0.320 (0.291) loss_x loss_x 1.5430 (1.4918) acc_x 62.5000 (60.6250) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [10/21] time 0.401 (0.429) data 0.271 (0.298) loss_x loss_x 1.4102 (1.5913) acc_x 68.7500 (58.4375) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/21] time 0.403 (0.431) data 0.273 (0.301) loss_x loss_x 1.7070 (1.5378) acc_x 59.3750 (61.8750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/21] time 0.388 (0.438) data 0.258 (0.308) loss_x loss_x 0.8838 (1.4813) acc_x 78.1250 (63.2812) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1793
confident_label rate tensor(0.2229, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 699
clean true:561
clean false:138
clean_rate:0.8025751072961373
noisy true:782
noisy false:1655
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 2437
epoch [108/200] batch [5/21] time 0.374 (0.366) data 0.243 (0.235) loss_x loss_x 1.1191 (1.4244) acc_x 71.8750 (65.0000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/21] time 0.445 (0.414) data 0.315 (0.284) loss_x loss_x 1.4873 (1.4946) acc_x 56.2500 (62.1875) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/21] time 0.413 (0.440) data 0.283 (0.310) loss_x loss_x 1.1484 (1.3979) acc_x 75.0000 (65.0000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/21] time 0.423 (0.441) data 0.293 (0.311) loss_x loss_x 1.0801 (1.3866) acc_x 71.8750 (65.1562) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.2283, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 716
clean true:583
clean false:133
clean_rate:0.8142458100558659
noisy true:758
noisy false:1662
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 2420
epoch [109/200] batch [5/22] time 0.465 (0.452) data 0.333 (0.322) loss_x loss_x 1.3311 (1.2826) acc_x 68.7500 (66.2500) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [10/22] time 0.382 (0.462) data 0.251 (0.331) loss_x loss_x 1.6689 (1.3280) acc_x 53.1250 (66.5625) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [15/22] time 0.386 (0.444) data 0.255 (0.313) loss_x loss_x 1.2510 (1.3298) acc_x 65.6250 (66.0417) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/22] time 0.416 (0.447) data 0.286 (0.316) loss_x loss_x 1.4414 (1.3402) acc_x 59.3750 (65.1562) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1729
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:595
clean false:140
clean_rate:0.8095238095238095
noisy true:812
noisy false:1589
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [110/200] batch [5/22] time 0.465 (0.453) data 0.334 (0.323) loss_x loss_x 1.3369 (1.3545) acc_x 71.8750 (68.1250) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [10/22] time 0.476 (0.450) data 0.347 (0.319) loss_x loss_x 1.2998 (1.3208) acc_x 56.2500 (66.8750) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [15/22] time 0.516 (0.466) data 0.385 (0.335) loss_x loss_x 1.5010 (1.4195) acc_x 59.3750 (63.1250) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/22] time 0.400 (0.458) data 0.270 (0.328) loss_x loss_x 1.4463 (1.4377) acc_x 62.5000 (63.1250) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1782
confident_label rate tensor(0.2270, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 712
clean true:573
clean false:139
clean_rate:0.8047752808988764
noisy true:781
noisy false:1643
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 2424
epoch [111/200] batch [5/22] time 0.393 (0.426) data 0.263 (0.296) loss_x loss_x 1.2695 (1.3691) acc_x 71.8750 (66.2500) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [10/22] time 0.609 (0.469) data 0.480 (0.339) loss_x loss_x 1.0693 (1.2908) acc_x 78.1250 (69.0625) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [15/22] time 0.413 (0.451) data 0.282 (0.320) loss_x loss_x 1.0684 (1.2583) acc_x 75.0000 (69.1667) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/22] time 0.461 (0.464) data 0.331 (0.334) loss_x loss_x 1.3193 (1.2571) acc_x 62.5000 (68.9062) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1783
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 714
clean true:576
clean false:138
clean_rate:0.8067226890756303
noisy true:777
noisy false:1645
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 2422
epoch [112/200] batch [5/22] time 0.574 (0.444) data 0.443 (0.313) loss_x loss_x 1.2256 (1.2719) acc_x 65.6250 (67.5000) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [10/22] time 0.405 (0.458) data 0.275 (0.327) loss_x loss_x 1.4805 (1.3367) acc_x 59.3750 (65.6250) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [15/22] time 0.398 (0.443) data 0.267 (0.313) loss_x loss_x 1.0742 (1.3320) acc_x 68.7500 (64.5833) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/22] time 0.432 (0.435) data 0.301 (0.304) loss_x loss_x 1.9189 (1.3260) acc_x 59.3750 (65.3125) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1829
confident_label rate tensor(0.2213, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 694
clean true:559
clean false:135
clean_rate:0.8054755043227666
noisy true:748
noisy false:1694
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 2442
epoch [113/200] batch [5/21] time 0.616 (0.515) data 0.485 (0.384) loss_x loss_x 1.1621 (1.1212) acc_x 75.0000 (73.1250) lr 8.2807e-04 eta 0:00:08
epoch [113/200] batch [10/21] time 0.343 (0.471) data 0.212 (0.341) loss_x loss_x 1.3838 (1.2058) acc_x 68.7500 (71.2500) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [15/21] time 0.389 (0.473) data 0.258 (0.342) loss_x loss_x 1.5615 (1.2704) acc_x 56.2500 (69.5833) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/21] time 0.494 (0.463) data 0.364 (0.332) loss_x loss_x 1.1895 (1.2751) acc_x 65.6250 (69.2188) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1764
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 722
clean true:572
clean false:150
clean_rate:0.7922437673130194
noisy true:800
noisy false:1614
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 2414
epoch [114/200] batch [5/22] time 0.432 (0.461) data 0.301 (0.331) loss_x loss_x 1.1777 (1.3002) acc_x 68.7500 (68.7500) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [10/22] time 0.554 (0.454) data 0.424 (0.324) loss_x loss_x 1.3721 (1.2088) acc_x 59.3750 (67.5000) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [15/22] time 0.490 (0.456) data 0.360 (0.326) loss_x loss_x 1.5244 (1.2323) acc_x 68.7500 (67.9167) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/22] time 0.370 (0.447) data 0.240 (0.317) loss_x loss_x 0.9004 (1.2190) acc_x 71.8750 (68.1250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1775
confident_label rate tensor(0.2290, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 718
clean true:580
clean false:138
clean_rate:0.807799442896936
noisy true:781
noisy false:1637
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 2418
epoch [115/200] batch [5/22] time 0.437 (0.396) data 0.307 (0.265) loss_x loss_x 1.3525 (1.3370) acc_x 68.7500 (66.8750) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [10/22] time 0.469 (0.425) data 0.339 (0.294) loss_x loss_x 1.2100 (1.3393) acc_x 65.6250 (66.2500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [15/22] time 0.663 (0.442) data 0.533 (0.312) loss_x loss_x 1.2061 (1.3187) acc_x 78.1250 (66.2500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/22] time 0.324 (0.443) data 0.194 (0.313) loss_x loss_x 1.9551 (1.3025) acc_x 46.8750 (66.8750) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.2309, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 724
clean true:574
clean false:150
clean_rate:0.7928176795580111
noisy true:775
noisy false:1637
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 2412
epoch [116/200] batch [5/22] time 0.445 (0.474) data 0.314 (0.344) loss_x loss_x 1.5537 (1.5756) acc_x 65.6250 (63.1250) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [10/22] time 0.291 (0.440) data 0.161 (0.310) loss_x loss_x 1.5391 (1.4865) acc_x 59.3750 (64.6875) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [15/22] time 0.395 (0.457) data 0.266 (0.327) loss_x loss_x 1.4248 (1.3745) acc_x 65.6250 (66.0417) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/22] time 0.502 (0.465) data 0.372 (0.335) loss_x loss_x 1.2021 (1.3612) acc_x 62.5000 (65.4688) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1800
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 722
clean true:582
clean false:140
clean_rate:0.8060941828254847
noisy true:754
noisy false:1660
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 2414
epoch [117/200] batch [5/22] time 0.345 (0.475) data 0.214 (0.345) loss_x loss_x 0.9668 (1.3215) acc_x 84.3750 (69.3750) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [10/22] time 0.463 (0.452) data 0.332 (0.321) loss_x loss_x 1.1719 (1.3288) acc_x 68.7500 (67.5000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [15/22] time 0.349 (0.429) data 0.218 (0.299) loss_x loss_x 1.6885 (1.4165) acc_x 59.3750 (66.0417) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/22] time 0.384 (0.447) data 0.254 (0.316) loss_x loss_x 1.2139 (1.3740) acc_x 68.7500 (66.8750) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1732
confident_label rate tensor(0.2315, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 726
clean true:577
clean false:149
clean_rate:0.7947658402203857
noisy true:827
noisy false:1583
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 2410
epoch [118/200] batch [5/22] time 0.436 (0.495) data 0.306 (0.365) loss_x loss_x 1.1855 (1.3012) acc_x 65.6250 (68.7500) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [10/22] time 0.500 (0.454) data 0.370 (0.324) loss_x loss_x 1.7334 (1.3304) acc_x 65.6250 (68.4375) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [15/22] time 0.450 (0.464) data 0.321 (0.334) loss_x loss_x 0.8862 (1.3666) acc_x 65.6250 (67.0833) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/22] time 0.461 (0.475) data 0.330 (0.344) loss_x loss_x 1.2793 (1.3564) acc_x 71.8750 (67.1875) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1758
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 711
clean true:572
clean false:139
clean_rate:0.8045007032348804
noisy true:806
noisy false:1619
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 2425
epoch [119/200] batch [5/22] time 0.390 (0.398) data 0.260 (0.268) loss_x loss_x 1.2100 (1.3139) acc_x 75.0000 (70.6250) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [10/22] time 0.371 (0.408) data 0.241 (0.278) loss_x loss_x 1.1680 (1.2216) acc_x 71.8750 (70.3125) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/22] time 0.543 (0.429) data 0.413 (0.299) loss_x loss_x 1.1963 (1.2135) acc_x 62.5000 (68.9583) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/22] time 0.536 (0.462) data 0.405 (0.331) loss_x loss_x 1.0771 (1.2356) acc_x 71.8750 (68.7500) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 738
clean true:604
clean false:134
clean_rate:0.8184281842818428
noisy true:801
noisy false:1597
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 2398
epoch [120/200] batch [5/23] time 0.330 (0.407) data 0.200 (0.276) loss_x loss_x 1.0752 (1.1474) acc_x 78.1250 (70.6250) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [10/23] time 0.424 (0.451) data 0.294 (0.321) loss_x loss_x 1.0459 (1.1853) acc_x 78.1250 (69.6875) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/23] time 0.552 (0.453) data 0.421 (0.322) loss_x loss_x 1.3936 (1.2643) acc_x 65.6250 (70.2083) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/23] time 0.543 (0.461) data 0.412 (0.330) loss_x loss_x 1.2109 (1.2847) acc_x 59.3750 (68.4375) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 725
clean true:581
clean false:144
clean_rate:0.8013793103448276
noisy true:812
noisy false:1599
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 2411
epoch [121/200] batch [5/22] time 0.391 (0.425) data 0.260 (0.294) loss_x loss_x 1.1006 (1.2932) acc_x 62.5000 (67.5000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [10/22] time 0.391 (0.439) data 0.260 (0.308) loss_x loss_x 1.7627 (1.3056) acc_x 46.8750 (66.5625) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [15/22] time 0.541 (0.438) data 0.411 (0.307) loss_x loss_x 0.9131 (1.2811) acc_x 71.8750 (66.0417) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/22] time 0.365 (0.442) data 0.234 (0.312) loss_x loss_x 1.1533 (1.2639) acc_x 68.7500 (67.0312) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 728
clean true:576
clean false:152
clean_rate:0.7912087912087912
noisy true:786
noisy false:1622
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 2408
epoch [122/200] batch [5/22] time 0.347 (0.436) data 0.217 (0.305) loss_x loss_x 1.7383 (1.4668) acc_x 56.2500 (62.5000) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [10/22] time 0.488 (0.473) data 0.358 (0.343) loss_x loss_x 1.1660 (1.4342) acc_x 78.1250 (64.0625) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [15/22] time 0.402 (0.463) data 0.271 (0.332) loss_x loss_x 1.3994 (1.4196) acc_x 56.2500 (64.7917) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/22] time 0.363 (0.457) data 0.233 (0.326) loss_x loss_x 1.3730 (1.4078) acc_x 65.6250 (63.7500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.2293, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 719
clean true:584
clean false:135
clean_rate:0.8122392211404729
noisy true:804
noisy false:1613
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 2417
epoch [123/200] batch [5/22] time 0.494 (0.517) data 0.364 (0.387) loss_x loss_x 1.3779 (1.3328) acc_x 65.6250 (68.1250) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [10/22] time 0.490 (0.459) data 0.360 (0.328) loss_x loss_x 1.0352 (1.2188) acc_x 75.0000 (70.0000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [15/22] time 0.331 (0.454) data 0.200 (0.324) loss_x loss_x 1.2285 (1.1686) acc_x 65.6250 (70.6250) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/22] time 0.562 (0.454) data 0.431 (0.324) loss_x loss_x 1.0615 (1.1579) acc_x 75.0000 (70.1562) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.2309, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 724
clean true:585
clean false:139
clean_rate:0.8080110497237569
noisy true:816
noisy false:1596
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 2412
epoch [124/200] batch [5/22] time 0.450 (0.418) data 0.320 (0.288) loss_x loss_x 0.9385 (1.3389) acc_x 81.2500 (68.7500) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [10/22] time 0.470 (0.433) data 0.340 (0.302) loss_x loss_x 1.0859 (1.2648) acc_x 78.1250 (69.0625) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [15/22] time 0.383 (0.433) data 0.252 (0.303) loss_x loss_x 1.4766 (1.2877) acc_x 59.3750 (69.3750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/22] time 0.436 (0.437) data 0.306 (0.306) loss_x loss_x 0.8716 (1.2732) acc_x 78.1250 (69.2188) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1794
confident_label rate tensor(0.2411, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 756
clean true:604
clean false:152
clean_rate:0.798941798941799
noisy true:738
noisy false:1642
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 2380
epoch [125/200] batch [5/23] time 0.420 (0.453) data 0.290 (0.323) loss_x loss_x 1.0625 (1.2795) acc_x 65.6250 (62.5000) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [10/23] time 0.491 (0.443) data 0.361 (0.313) loss_x loss_x 1.2344 (1.3508) acc_x 75.0000 (64.0625) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [15/23] time 0.373 (0.431) data 0.243 (0.301) loss_x loss_x 1.4014 (1.3786) acc_x 68.7500 (64.3750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/23] time 0.431 (0.429) data 0.300 (0.299) loss_x loss_x 1.4521 (1.4061) acc_x 53.1250 (63.2812) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1783
confident_label rate tensor(0.2299, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 721
clean true:572
clean false:149
clean_rate:0.7933425797503467
noisy true:781
noisy false:1634
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 2415
epoch [126/200] batch [5/22] time 0.593 (0.473) data 0.463 (0.343) loss_x loss_x 1.4248 (1.2654) acc_x 71.8750 (68.7500) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [10/22] time 0.427 (0.476) data 0.297 (0.346) loss_x loss_x 1.2754 (1.3216) acc_x 65.6250 (68.1250) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [15/22] time 0.481 (0.489) data 0.351 (0.359) loss_x loss_x 1.3936 (1.2737) acc_x 65.6250 (69.1667) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/22] time 0.471 (0.473) data 0.341 (0.343) loss_x loss_x 0.8608 (1.2439) acc_x 84.3750 (69.6875) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1724
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 757
clean true:604
clean false:153
clean_rate:0.797886393659181
noisy true:808
noisy false:1571
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 2379
epoch [127/200] batch [5/23] time 0.475 (0.498) data 0.344 (0.367) loss_x loss_x 1.4512 (1.2968) acc_x 59.3750 (65.6250) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [10/23] time 0.468 (0.487) data 0.339 (0.356) loss_x loss_x 0.9219 (1.2904) acc_x 75.0000 (66.2500) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [15/23] time 0.537 (0.490) data 0.406 (0.360) loss_x loss_x 2.0312 (1.3113) acc_x 59.3750 (65.8333) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/23] time 0.417 (0.472) data 0.287 (0.341) loss_x loss_x 1.2861 (1.3389) acc_x 68.7500 (64.0625) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2254, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 707
clean true:580
clean false:127
clean_rate:0.8203677510608204
noisy true:800
noisy false:1629
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 2429
epoch [128/200] batch [5/22] time 0.503 (0.452) data 0.374 (0.322) loss_x loss_x 1.1064 (1.2805) acc_x 68.7500 (70.0000) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [10/22] time 0.358 (0.435) data 0.229 (0.305) loss_x loss_x 1.1377 (1.2174) acc_x 71.8750 (71.5625) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [15/22] time 0.417 (0.451) data 0.287 (0.322) loss_x loss_x 1.1641 (1.1857) acc_x 65.6250 (71.0417) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/22] time 0.465 (0.457) data 0.335 (0.327) loss_x loss_x 0.6855 (1.1605) acc_x 78.1250 (70.4688) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2395, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 751
clean true:596
clean false:155
clean_rate:0.7936085219707057
noisy true:796
noisy false:1589
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 2385
epoch [129/200] batch [5/23] time 0.424 (0.472) data 0.293 (0.342) loss_x loss_x 1.7217 (1.4256) acc_x 50.0000 (63.7500) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/23] time 0.657 (0.484) data 0.526 (0.353) loss_x loss_x 1.3291 (1.2887) acc_x 62.5000 (66.5625) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [15/23] time 0.551 (0.465) data 0.421 (0.335) loss_x loss_x 1.2812 (1.2513) acc_x 75.0000 (68.5417) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/23] time 0.340 (0.454) data 0.209 (0.324) loss_x loss_x 1.2959 (1.2243) acc_x 68.7500 (68.9062) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1746
confident_label rate tensor(0.2392, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 750
clean true:603
clean false:147
clean_rate:0.804
noisy true:787
noisy false:1599
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 2386
epoch [130/200] batch [5/23] time 0.415 (0.479) data 0.285 (0.349) loss_x loss_x 1.1855 (1.4262) acc_x 71.8750 (63.7500) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [10/23] time 0.413 (0.457) data 0.283 (0.326) loss_x loss_x 1.4902 (1.4032) acc_x 62.5000 (62.5000) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [15/23] time 0.349 (0.452) data 0.218 (0.321) loss_x loss_x 1.7197 (1.3860) acc_x 65.6250 (64.7917) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/23] time 0.534 (0.453) data 0.404 (0.323) loss_x loss_x 1.0312 (1.3182) acc_x 75.0000 (67.0312) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1733
confident_label rate tensor(0.2248, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 705
clean true:579
clean false:126
clean_rate:0.8212765957446808
noisy true:824
noisy false:1607
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 2431
epoch [131/200] batch [5/22] time 0.427 (0.428) data 0.298 (0.297) loss_x loss_x 1.7549 (1.3643) acc_x 68.7500 (70.0000) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [10/22] time 0.352 (0.463) data 0.222 (0.333) loss_x loss_x 1.8877 (1.4079) acc_x 53.1250 (66.2500) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [15/22] time 0.378 (0.462) data 0.248 (0.332) loss_x loss_x 1.5137 (1.3769) acc_x 62.5000 (66.6667) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/22] time 0.368 (0.450) data 0.236 (0.320) loss_x loss_x 0.6777 (1.3200) acc_x 78.1250 (67.5000) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1760
confident_label rate tensor(0.2372, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 744
clean true:601
clean false:143
clean_rate:0.8077956989247311
noisy true:775
noisy false:1617
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 2392
epoch [132/200] batch [5/23] time 0.447 (0.478) data 0.317 (0.348) loss_x loss_x 1.3486 (1.4414) acc_x 65.6250 (63.7500) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [10/23] time 0.429 (0.470) data 0.298 (0.339) loss_x loss_x 1.2559 (1.3315) acc_x 56.2500 (64.6875) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [15/23] time 0.356 (0.454) data 0.226 (0.324) loss_x loss_x 1.1592 (1.3429) acc_x 71.8750 (64.1667) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/23] time 0.353 (0.452) data 0.222 (0.322) loss_x loss_x 1.5596 (1.3054) acc_x 59.3750 (65.3125) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1752
confident_label rate tensor(0.2360, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 740
clean true:584
clean false:156
clean_rate:0.7891891891891892
noisy true:800
noisy false:1596
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 2396
epoch [133/200] batch [5/23] time 0.414 (0.451) data 0.284 (0.320) loss_x loss_x 1.8174 (1.3331) acc_x 65.6250 (68.1250) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [10/23] time 0.335 (0.410) data 0.205 (0.280) loss_x loss_x 1.2920 (1.2847) acc_x 68.7500 (68.4375) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [15/23] time 0.553 (0.430) data 0.422 (0.299) loss_x loss_x 1.2100 (1.2846) acc_x 78.1250 (68.3333) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/23] time 0.522 (0.444) data 0.391 (0.314) loss_x loss_x 1.1699 (1.2631) acc_x 71.8750 (69.0625) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 722
clean true:580
clean false:142
clean_rate:0.8033240997229917
noisy true:812
noisy false:1602
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 2414
epoch [134/200] batch [5/22] time 0.437 (0.424) data 0.307 (0.293) loss_x loss_x 1.4082 (1.4119) acc_x 68.7500 (63.1250) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/22] time 0.486 (0.427) data 0.356 (0.297) loss_x loss_x 1.1182 (1.3542) acc_x 68.7500 (66.8750) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [15/22] time 0.528 (0.422) data 0.397 (0.291) loss_x loss_x 1.3506 (1.3246) acc_x 59.3750 (65.4167) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/22] time 0.462 (0.432) data 0.331 (0.302) loss_x loss_x 1.8223 (1.2922) acc_x 43.7500 (66.7188) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.2366, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 742
clean true:597
clean false:145
clean_rate:0.8045822102425876
noisy true:791
noisy false:1603
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 2394
epoch [135/200] batch [5/23] time 0.425 (0.467) data 0.294 (0.336) loss_x loss_x 0.8975 (1.2148) acc_x 71.8750 (65.6250) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/23] time 0.432 (0.467) data 0.301 (0.337) loss_x loss_x 1.4434 (1.2717) acc_x 65.6250 (67.5000) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [15/23] time 0.382 (0.454) data 0.252 (0.324) loss_x loss_x 1.3271 (1.2439) acc_x 62.5000 (68.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/23] time 0.647 (0.463) data 0.517 (0.333) loss_x loss_x 1.1084 (1.2421) acc_x 68.7500 (67.8125) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1718
confident_label rate tensor(0.2337, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 733
clean true:588
clean false:145
clean_rate:0.8021828103683493
noisy true:830
noisy false:1573
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 2403
epoch [136/200] batch [5/22] time 0.424 (0.474) data 0.295 (0.344) loss_x loss_x 1.3535 (1.0685) acc_x 71.8750 (73.7500) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [10/22] time 0.431 (0.480) data 0.301 (0.350) loss_x loss_x 0.8813 (1.1446) acc_x 75.0000 (69.3750) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [15/22] time 0.407 (0.466) data 0.277 (0.336) loss_x loss_x 1.1523 (1.2122) acc_x 71.8750 (67.7083) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/22] time 0.429 (0.451) data 0.298 (0.320) loss_x loss_x 1.2637 (1.2350) acc_x 62.5000 (67.0312) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1738
confident_label rate tensor(0.2350, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 737
clean true:594
clean false:143
clean_rate:0.8059701492537313
noisy true:804
noisy false:1595
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 2399
epoch [137/200] batch [5/23] time 0.564 (0.459) data 0.434 (0.329) loss_x loss_x 1.5850 (1.3445) acc_x 71.8750 (68.1250) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [10/23] time 0.356 (0.463) data 0.226 (0.332) loss_x loss_x 1.4883 (1.1992) acc_x 62.5000 (70.0000) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [15/23] time 0.543 (0.460) data 0.412 (0.329) loss_x loss_x 1.8867 (1.3155) acc_x 50.0000 (65.6250) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/23] time 0.499 (0.459) data 0.368 (0.328) loss_x loss_x 1.5635 (1.3736) acc_x 75.0000 (65.1562) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.2293, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 719
clean true:577
clean false:142
clean_rate:0.8025034770514604
noisy true:772
noisy false:1645
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 2417
epoch [138/200] batch [5/22] time 0.441 (0.465) data 0.311 (0.335) loss_x loss_x 1.2041 (1.3509) acc_x 75.0000 (64.3750) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [10/22] time 0.427 (0.449) data 0.297 (0.319) loss_x loss_x 1.2246 (1.3597) acc_x 71.8750 (64.0625) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [15/22] time 0.522 (0.453) data 0.391 (0.322) loss_x loss_x 1.2549 (1.2798) acc_x 59.3750 (65.2083) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/22] time 0.332 (0.449) data 0.203 (0.319) loss_x loss_x 0.9888 (1.2634) acc_x 75.0000 (66.7188) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2398, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 752
clean true:595
clean false:157
clean_rate:0.7912234042553191
noisy true:797
noisy false:1587
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 2384
epoch [139/200] batch [5/23] time 0.384 (0.440) data 0.254 (0.309) loss_x loss_x 1.7627 (1.4320) acc_x 53.1250 (63.7500) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [10/23] time 0.414 (0.457) data 0.284 (0.327) loss_x loss_x 1.0068 (1.3556) acc_x 68.7500 (62.5000) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [15/23] time 0.453 (0.452) data 0.324 (0.322) loss_x loss_x 1.3096 (1.3409) acc_x 53.1250 (62.7083) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/23] time 0.383 (0.442) data 0.253 (0.312) loss_x loss_x 1.1553 (1.3097) acc_x 62.5000 (64.5312) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1778
confident_label rate tensor(0.2337, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 733
clean true:590
clean false:143
clean_rate:0.8049113233287858
noisy true:768
noisy false:1635
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 2403
epoch [140/200] batch [5/22] time 0.459 (0.445) data 0.329 (0.314) loss_x loss_x 1.6709 (1.1509) acc_x 53.1250 (68.7500) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [10/22] time 0.514 (0.465) data 0.384 (0.335) loss_x loss_x 1.1064 (1.2033) acc_x 75.0000 (69.0625) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [15/22] time 0.349 (0.450) data 0.219 (0.319) loss_x loss_x 1.8564 (1.2552) acc_x 59.3750 (68.5417) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/22] time 0.525 (0.464) data 0.395 (0.334) loss_x loss_x 1.1689 (1.2469) acc_x 68.7500 (68.2812) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.2334, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 732
clean true:591
clean false:141
clean_rate:0.8073770491803278
noisy true:794
noisy false:1610
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 2404
epoch [141/200] batch [5/22] time 0.475 (0.446) data 0.344 (0.316) loss_x loss_x 1.4883 (1.3324) acc_x 59.3750 (69.3750) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [10/22] time 0.477 (0.432) data 0.347 (0.302) loss_x loss_x 1.3750 (1.2617) acc_x 62.5000 (68.7500) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [15/22] time 0.450 (0.449) data 0.320 (0.319) loss_x loss_x 1.4668 (1.2294) acc_x 56.2500 (68.1250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/22] time 0.370 (0.444) data 0.240 (0.314) loss_x loss_x 0.9634 (1.2000) acc_x 75.0000 (68.7500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1737
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:588
clean false:147
clean_rate:0.8
noisy true:811
noisy false:1590
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [142/200] batch [5/22] time 0.349 (0.439) data 0.219 (0.309) loss_x loss_x 1.1211 (1.1549) acc_x 68.7500 (70.6250) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [10/22] time 0.382 (0.439) data 0.252 (0.309) loss_x loss_x 1.2920 (1.2946) acc_x 65.6250 (67.1875) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [15/22] time 0.364 (0.431) data 0.234 (0.301) loss_x loss_x 1.1055 (1.3204) acc_x 62.5000 (66.8750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/22] time 0.359 (0.434) data 0.228 (0.304) loss_x loss_x 1.2891 (1.3303) acc_x 62.5000 (66.2500) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.2305, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 723
clean true:572
clean false:151
clean_rate:0.7911479944674965
noisy true:797
noisy false:1616
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 2413
epoch [143/200] batch [5/22] time 0.395 (0.395) data 0.265 (0.265) loss_x loss_x 1.1133 (1.2081) acc_x 75.0000 (70.0000) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [10/22] time 0.437 (0.416) data 0.307 (0.286) loss_x loss_x 1.0156 (1.2190) acc_x 71.8750 (70.9375) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/22] time 0.418 (0.423) data 0.288 (0.293) loss_x loss_x 1.7178 (1.2427) acc_x 62.5000 (68.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/22] time 0.382 (0.432) data 0.252 (0.302) loss_x loss_x 0.9062 (1.1952) acc_x 84.3750 (69.6875) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1733
confident_label rate tensor(0.2427, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 761
clean true:617
clean false:144
clean_rate:0.8107752956636005
noisy true:786
noisy false:1589
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 2375
epoch [144/200] batch [5/23] time 0.505 (0.476) data 0.375 (0.346) loss_x loss_x 0.9917 (1.2337) acc_x 75.0000 (68.1250) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [10/23] time 0.422 (0.457) data 0.292 (0.327) loss_x loss_x 0.9731 (1.1928) acc_x 81.2500 (69.0625) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [15/23] time 0.384 (0.432) data 0.254 (0.301) loss_x loss_x 1.0225 (1.1961) acc_x 71.8750 (68.9583) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/23] time 0.409 (0.437) data 0.279 (0.306) loss_x loss_x 1.5059 (1.1932) acc_x 65.6250 (69.2188) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1765
confident_label rate tensor(0.2293, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 719
clean true:583
clean false:136
clean_rate:0.8108484005563282
noisy true:788
noisy false:1629
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 2417
epoch [145/200] batch [5/22] time 0.408 (0.405) data 0.278 (0.275) loss_x loss_x 1.3799 (1.2832) acc_x 62.5000 (68.7500) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [10/22] time 0.355 (0.413) data 0.225 (0.283) loss_x loss_x 1.4268 (1.3717) acc_x 59.3750 (65.3125) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/22] time 0.433 (0.450) data 0.303 (0.320) loss_x loss_x 1.4678 (1.3321) acc_x 68.7500 (66.6667) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/22] time 0.462 (0.462) data 0.332 (0.331) loss_x loss_x 1.2158 (1.2937) acc_x 56.2500 (65.7812) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1705
confident_label rate tensor(0.2436, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 764
clean true:614
clean false:150
clean_rate:0.8036649214659686
noisy true:817
noisy false:1555
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 2372
epoch [146/200] batch [5/23] time 0.498 (0.475) data 0.367 (0.345) loss_x loss_x 1.3965 (1.4205) acc_x 59.3750 (60.6250) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [10/23] time 0.434 (0.431) data 0.304 (0.300) loss_x loss_x 1.2090 (1.3126) acc_x 68.7500 (64.0625) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [15/23] time 0.360 (0.441) data 0.229 (0.311) loss_x loss_x 1.1768 (1.3523) acc_x 71.8750 (64.5833) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/23] time 0.446 (0.445) data 0.315 (0.314) loss_x loss_x 1.7646 (1.3809) acc_x 56.2500 (63.9062) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.2280, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 715
clean true:581
clean false:134
clean_rate:0.8125874125874126
noisy true:788
noisy false:1633
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 2421
epoch [147/200] batch [5/22] time 0.496 (0.434) data 0.366 (0.303) loss_x loss_x 1.3291 (1.2487) acc_x 68.7500 (70.0000) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [10/22] time 0.346 (0.422) data 0.215 (0.291) loss_x loss_x 1.2520 (1.2223) acc_x 71.8750 (70.3125) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [15/22] time 0.500 (0.428) data 0.370 (0.297) loss_x loss_x 0.9629 (1.2389) acc_x 75.0000 (70.0000) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/22] time 0.518 (0.433) data 0.388 (0.303) loss_x loss_x 1.1270 (1.2559) acc_x 78.1250 (69.3750) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2305, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 723
clean true:588
clean false:135
clean_rate:0.8132780082987552
noisy true:782
noisy false:1631
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 2413
epoch [148/200] batch [5/22] time 0.509 (0.474) data 0.380 (0.343) loss_x loss_x 0.8848 (1.0723) acc_x 75.0000 (74.3750) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [10/22] time 0.443 (0.438) data 0.313 (0.308) loss_x loss_x 1.3916 (1.0596) acc_x 53.1250 (72.1875) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [15/22] time 0.327 (0.438) data 0.197 (0.308) loss_x loss_x 1.1875 (1.0986) acc_x 59.3750 (71.0417) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/22] time 0.514 (0.440) data 0.384 (0.310) loss_x loss_x 1.0146 (1.0913) acc_x 65.6250 (71.0938) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1768
confident_label rate tensor(0.2270, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 712
clean true:579
clean false:133
clean_rate:0.8132022471910112
noisy true:789
noisy false:1635
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 2424
epoch [149/200] batch [5/22] time 0.531 (0.450) data 0.401 (0.319) loss_x loss_x 1.2510 (1.1562) acc_x 71.8750 (68.7500) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [10/22] time 0.436 (0.460) data 0.305 (0.330) loss_x loss_x 0.8584 (1.1645) acc_x 71.8750 (68.4375) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [15/22] time 0.435 (0.455) data 0.304 (0.325) loss_x loss_x 0.8521 (1.2043) acc_x 75.0000 (67.9167) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/22] time 0.547 (0.455) data 0.416 (0.324) loss_x loss_x 1.4014 (1.2471) acc_x 71.8750 (68.1250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1758
confident_label rate tensor(0.2337, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 733
clean true:578
clean false:155
clean_rate:0.7885402455661664
noisy true:800
noisy false:1603
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 2403
epoch [150/200] batch [5/22] time 0.461 (0.453) data 0.332 (0.324) loss_x loss_x 0.8853 (1.1652) acc_x 75.0000 (68.7500) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [10/22] time 0.423 (0.430) data 0.294 (0.301) loss_x loss_x 1.6074 (1.2312) acc_x 56.2500 (65.3125) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [15/22] time 0.427 (0.433) data 0.296 (0.303) loss_x loss_x 1.5039 (1.2699) acc_x 59.3750 (65.6250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/22] time 0.605 (0.444) data 0.475 (0.314) loss_x loss_x 0.6851 (1.2615) acc_x 93.7500 (67.8125) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2270, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 712
clean true:555
clean false:157
clean_rate:0.7794943820224719
noisy true:809
noisy false:1615
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 2424
epoch [151/200] batch [5/22] time 0.552 (0.497) data 0.422 (0.367) loss_x loss_x 1.2090 (1.2181) acc_x 81.2500 (71.2500) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [10/22] time 0.358 (0.452) data 0.227 (0.322) loss_x loss_x 1.4033 (1.2417) acc_x 68.7500 (70.3125) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [15/22] time 0.348 (0.446) data 0.218 (0.316) loss_x loss_x 1.2324 (1.2005) acc_x 71.8750 (70.4167) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/22] time 0.557 (0.441) data 0.426 (0.311) loss_x loss_x 1.4316 (1.2257) acc_x 65.6250 (68.7500) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1733
confident_label rate tensor(0.2430, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 762
clean true:604
clean false:158
clean_rate:0.7926509186351706
noisy true:799
noisy false:1575
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 2374
epoch [152/200] batch [5/23] time 0.455 (0.438) data 0.325 (0.308) loss_x loss_x 1.5645 (1.1752) acc_x 65.6250 (69.3750) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [10/23] time 0.415 (0.431) data 0.284 (0.301) loss_x loss_x 1.6992 (1.3247) acc_x 56.2500 (66.8750) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [15/23] time 0.484 (0.445) data 0.354 (0.314) loss_x loss_x 0.9390 (1.2617) acc_x 71.8750 (67.9167) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/23] time 0.383 (0.441) data 0.253 (0.311) loss_x loss_x 0.9810 (1.2322) acc_x 75.0000 (68.9062) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1796
confident_label rate tensor(0.2251, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 706
clean true:570
clean false:136
clean_rate:0.8073654390934845
noisy true:770
noisy false:1660
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 2430
epoch [153/200] batch [5/22] time 0.409 (0.416) data 0.278 (0.286) loss_x loss_x 1.5039 (1.4533) acc_x 62.5000 (65.6250) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [10/22] time 0.399 (0.446) data 0.269 (0.316) loss_x loss_x 1.6211 (1.3614) acc_x 56.2500 (67.1875) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [15/22] time 0.445 (0.443) data 0.314 (0.312) loss_x loss_x 1.0703 (1.3121) acc_x 75.0000 (68.9583) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/22] time 0.551 (0.462) data 0.420 (0.332) loss_x loss_x 0.9263 (1.2512) acc_x 62.5000 (69.5312) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1834
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 728
clean true:564
clean false:164
clean_rate:0.7747252747252747
noisy true:738
noisy false:1670
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 2408
epoch [154/200] batch [5/22] time 0.459 (0.421) data 0.328 (0.291) loss_x loss_x 1.1152 (1.0468) acc_x 59.3750 (75.0000) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [10/22] time 0.417 (0.428) data 0.286 (0.298) loss_x loss_x 1.4658 (1.2159) acc_x 62.5000 (70.9375) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [15/22] time 0.384 (0.413) data 0.253 (0.283) loss_x loss_x 1.0469 (1.2365) acc_x 68.7500 (70.6250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/22] time 0.448 (0.417) data 0.318 (0.287) loss_x loss_x 0.9263 (1.2524) acc_x 71.8750 (68.9062) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2337, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 733
clean true:582
clean false:151
clean_rate:0.7939972714870396
noisy true:798
noisy false:1605
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 2403
epoch [155/200] batch [5/22] time 0.448 (0.438) data 0.317 (0.308) loss_x loss_x 1.1973 (1.3621) acc_x 71.8750 (68.1250) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [10/22] time 0.538 (0.449) data 0.408 (0.318) loss_x loss_x 1.7012 (1.2930) acc_x 65.6250 (70.6250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [15/22] time 0.336 (0.428) data 0.206 (0.298) loss_x loss_x 1.5537 (1.3004) acc_x 62.5000 (68.7500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/22] time 0.519 (0.430) data 0.388 (0.299) loss_x loss_x 1.2998 (1.2772) acc_x 56.2500 (68.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 720
clean true:576
clean false:144
clean_rate:0.8
noisy true:801
noisy false:1615
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 2416
epoch [156/200] batch [5/22] time 0.427 (0.467) data 0.296 (0.337) loss_x loss_x 1.2949 (1.1318) acc_x 62.5000 (68.1250) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/22] time 0.527 (0.487) data 0.396 (0.357) loss_x loss_x 1.2080 (1.0885) acc_x 78.1250 (71.5625) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [15/22] time 0.404 (0.470) data 0.274 (0.339) loss_x loss_x 1.5039 (1.2653) acc_x 68.7500 (68.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/22] time 0.473 (0.462) data 0.344 (0.332) loss_x loss_x 1.5146 (1.2677) acc_x 62.5000 (68.4375) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1779
confident_label rate tensor(0.2312, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 725
clean true:586
clean false:139
clean_rate:0.8082758620689655
noisy true:771
noisy false:1640
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 2411
epoch [157/200] batch [5/22] time 0.445 (0.465) data 0.314 (0.334) loss_x loss_x 1.3662 (1.2697) acc_x 65.6250 (68.7500) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [10/22] time 0.518 (0.461) data 0.388 (0.331) loss_x loss_x 0.9482 (1.2913) acc_x 68.7500 (65.9375) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [15/22] time 0.424 (0.461) data 0.294 (0.331) loss_x loss_x 2.3809 (1.3187) acc_x 50.0000 (66.0417) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/22] time 0.348 (0.453) data 0.219 (0.323) loss_x loss_x 0.9424 (1.3164) acc_x 71.8750 (65.9375) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.2360, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 740
clean true:588
clean false:152
clean_rate:0.7945945945945946
noisy true:764
noisy false:1632
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 2396
epoch [158/200] batch [5/23] time 0.490 (0.475) data 0.360 (0.344) loss_x loss_x 1.4121 (1.5355) acc_x 75.0000 (62.5000) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [10/23] time 0.430 (0.484) data 0.300 (0.354) loss_x loss_x 0.9258 (1.4132) acc_x 78.1250 (66.2500) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [15/23] time 0.410 (0.475) data 0.280 (0.344) loss_x loss_x 1.7188 (1.4622) acc_x 53.1250 (64.1667) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/23] time 0.430 (0.466) data 0.299 (0.336) loss_x loss_x 0.7568 (1.3715) acc_x 78.1250 (67.0312) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:579
clean false:156
clean_rate:0.7877551020408163
noisy true:800
noisy false:1601
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [159/200] batch [5/22] time 0.417 (0.443) data 0.287 (0.313) loss_x loss_x 1.0820 (1.4963) acc_x 65.6250 (63.1250) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [10/22] time 0.348 (0.430) data 0.217 (0.300) loss_x loss_x 1.6797 (1.4554) acc_x 65.6250 (64.0625) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [15/22] time 0.385 (0.431) data 0.256 (0.301) loss_x loss_x 1.4434 (1.3796) acc_x 62.5000 (64.5833) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/22] time 0.517 (0.427) data 0.387 (0.296) loss_x loss_x 1.2988 (1.3682) acc_x 59.3750 (64.6875) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2408, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 755
clean true:609
clean false:146
clean_rate:0.8066225165562914
noisy true:770
noisy false:1611
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 2381
epoch [160/200] batch [5/23] time 0.423 (0.433) data 0.294 (0.304) loss_x loss_x 1.1328 (1.1379) acc_x 71.8750 (68.1250) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [10/23] time 0.411 (0.447) data 0.282 (0.318) loss_x loss_x 1.2988 (1.2130) acc_x 68.7500 (67.1875) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [15/23] time 0.355 (0.449) data 0.225 (0.320) loss_x loss_x 0.9780 (1.1991) acc_x 68.7500 (67.7083) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/23] time 0.356 (0.448) data 0.225 (0.319) loss_x loss_x 1.4209 (1.2312) acc_x 65.6250 (66.5625) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1717
confident_label rate tensor(0.2395, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 751
clean true:606
clean false:145
clean_rate:0.8069241011984021
noisy true:813
noisy false:1572
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 2385
epoch [161/200] batch [5/23] time 0.358 (0.449) data 0.228 (0.318) loss_x loss_x 0.9746 (1.1600) acc_x 62.5000 (66.2500) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [10/23] time 0.559 (0.455) data 0.428 (0.324) loss_x loss_x 2.0254 (1.2257) acc_x 56.2500 (65.6250) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [15/23] time 0.436 (0.458) data 0.306 (0.327) loss_x loss_x 1.6035 (1.2000) acc_x 53.1250 (67.2917) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/23] time 0.322 (0.445) data 0.192 (0.315) loss_x loss_x 1.6182 (1.1954) acc_x 65.6250 (69.0625) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1762
confident_label rate tensor(0.2363, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 741
clean true:581
clean false:160
clean_rate:0.7840755735492577
noisy true:793
noisy false:1602
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 2395
epoch [162/200] batch [5/23] time 0.553 (0.492) data 0.424 (0.362) loss_x loss_x 1.0596 (1.1089) acc_x 75.0000 (71.2500) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/23] time 0.489 (0.476) data 0.358 (0.346) loss_x loss_x 1.9580 (1.1733) acc_x 43.7500 (70.0000) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [15/23] time 0.555 (0.471) data 0.424 (0.341) loss_x loss_x 1.3027 (1.1723) acc_x 68.7500 (70.0000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/23] time 0.339 (0.453) data 0.209 (0.322) loss_x loss_x 1.0889 (1.1976) acc_x 81.2500 (69.6875) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.2385, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 748
clean true:601
clean false:147
clean_rate:0.803475935828877
noisy true:826
noisy false:1562
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 2388
epoch [163/200] batch [5/23] time 0.577 (0.532) data 0.447 (0.401) loss_x loss_x 1.1592 (1.1869) acc_x 68.7500 (73.7500) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [10/23] time 0.482 (0.491) data 0.352 (0.360) loss_x loss_x 1.3359 (1.2769) acc_x 62.5000 (70.0000) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [15/23] time 0.426 (0.470) data 0.296 (0.339) loss_x loss_x 0.9980 (1.2675) acc_x 71.8750 (70.0000) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/23] time 0.436 (0.469) data 0.305 (0.338) loss_x loss_x 1.3027 (1.2274) acc_x 75.0000 (70.6250) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1784
confident_label rate tensor(0.2404, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 754
clean true:598
clean false:156
clean_rate:0.7931034482758621
noisy true:754
noisy false:1628
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 2382
epoch [164/200] batch [5/23] time 0.507 (0.413) data 0.376 (0.283) loss_x loss_x 1.0225 (1.2693) acc_x 75.0000 (68.7500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [10/23] time 0.417 (0.472) data 0.286 (0.341) loss_x loss_x 1.0508 (1.2546) acc_x 65.6250 (69.0625) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/23] time 0.378 (0.440) data 0.247 (0.310) loss_x loss_x 1.3916 (1.3257) acc_x 59.3750 (67.0833) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/23] time 0.402 (0.432) data 0.272 (0.301) loss_x loss_x 1.2031 (1.2900) acc_x 75.0000 (67.6562) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1723
confident_label rate tensor(0.2449, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 768
clean true:622
clean false:146
clean_rate:0.8098958333333334
noisy true:791
noisy false:1577
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 2368
epoch [165/200] batch [5/24] time 0.376 (0.426) data 0.246 (0.296) loss_x loss_x 1.3789 (1.2285) acc_x 56.2500 (66.2500) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [10/24] time 0.411 (0.452) data 0.280 (0.321) loss_x loss_x 1.5723 (1.2549) acc_x 59.3750 (66.5625) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [15/24] time 0.473 (0.454) data 0.342 (0.323) loss_x loss_x 1.0283 (1.2487) acc_x 75.0000 (67.5000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/24] time 0.437 (0.441) data 0.307 (0.311) loss_x loss_x 1.5342 (1.2431) acc_x 68.7500 (67.9688) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 738
clean true:582
clean false:156
clean_rate:0.7886178861788617
noisy true:780
noisy false:1618
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 2398
epoch [166/200] batch [5/23] time 0.478 (0.453) data 0.348 (0.323) loss_x loss_x 0.7798 (1.0196) acc_x 75.0000 (75.0000) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [10/23] time 0.391 (0.438) data 0.261 (0.308) loss_x loss_x 0.9639 (1.1167) acc_x 62.5000 (70.9375) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [15/23] time 0.402 (0.449) data 0.272 (0.319) loss_x loss_x 1.4316 (1.1687) acc_x 65.6250 (70.2083) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/23] time 0.432 (0.441) data 0.302 (0.311) loss_x loss_x 1.1572 (1.1256) acc_x 75.0000 (71.8750) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1737
confident_label rate tensor(0.2446, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 767
clean true:614
clean false:153
clean_rate:0.8005215123859192
noisy true:785
noisy false:1584
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 2369
epoch [167/200] batch [5/23] time 0.389 (0.426) data 0.259 (0.296) loss_x loss_x 1.6660 (1.4268) acc_x 62.5000 (65.0000) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [10/23] time 0.387 (0.421) data 0.257 (0.291) loss_x loss_x 1.4326 (1.4057) acc_x 75.0000 (65.9375) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [15/23] time 0.400 (0.440) data 0.271 (0.310) loss_x loss_x 0.8374 (1.3190) acc_x 81.2500 (67.7083) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/23] time 0.647 (0.447) data 0.517 (0.316) loss_x loss_x 1.3428 (1.3610) acc_x 65.6250 (66.2500) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1756
confident_label rate tensor(0.2331, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 731
clean true:587
clean false:144
clean_rate:0.8030095759233926
noisy true:793
noisy false:1612
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 2405
epoch [168/200] batch [5/22] time 0.496 (0.440) data 0.365 (0.310) loss_x loss_x 1.2725 (1.4332) acc_x 68.7500 (66.2500) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/22] time 0.466 (0.480) data 0.335 (0.350) loss_x loss_x 0.9644 (1.3487) acc_x 87.5000 (68.4375) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [15/22] time 0.391 (0.475) data 0.261 (0.344) loss_x loss_x 1.5156 (1.3458) acc_x 68.7500 (67.9167) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/22] time 0.472 (0.475) data 0.341 (0.344) loss_x loss_x 1.1475 (1.3049) acc_x 71.8750 (69.6875) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1747
confident_label rate tensor(0.2404, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 754
clean true:601
clean false:153
clean_rate:0.7970822281167109
noisy true:788
noisy false:1594
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 2382
epoch [169/200] batch [5/23] time 0.419 (0.421) data 0.289 (0.290) loss_x loss_x 2.1035 (1.5834) acc_x 46.8750 (59.3750) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [10/23] time 0.645 (0.464) data 0.515 (0.334) loss_x loss_x 1.0889 (1.4265) acc_x 75.0000 (64.3750) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [15/23] time 0.365 (0.455) data 0.236 (0.324) loss_x loss_x 1.7471 (1.3526) acc_x 68.7500 (68.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/23] time 0.464 (0.450) data 0.333 (0.320) loss_x loss_x 1.5303 (1.3714) acc_x 68.7500 (67.5000) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1757
confident_label rate tensor(0.2379, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 746
clean true:598
clean false:148
clean_rate:0.8016085790884718
noisy true:781
noisy false:1609
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 2390
epoch [170/200] batch [5/23] time 0.401 (0.385) data 0.271 (0.254) loss_x loss_x 1.0547 (1.4303) acc_x 71.8750 (63.7500) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/23] time 0.378 (0.410) data 0.248 (0.279) loss_x loss_x 0.7783 (1.2022) acc_x 78.1250 (68.7500) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [15/23] time 0.429 (0.404) data 0.299 (0.273) loss_x loss_x 0.5552 (1.2029) acc_x 84.3750 (68.9583) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/23] time 0.444 (0.428) data 0.314 (0.298) loss_x loss_x 1.3584 (1.2252) acc_x 71.8750 (69.2188) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1767
confident_label rate tensor(0.2290, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 718
clean true:576
clean false:142
clean_rate:0.8022284122562674
noisy true:793
noisy false:1625
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 2418
epoch [171/200] batch [5/22] time 0.368 (0.408) data 0.237 (0.277) loss_x loss_x 1.0049 (1.0863) acc_x 75.0000 (73.7500) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/22] time 0.485 (0.414) data 0.354 (0.283) loss_x loss_x 1.4922 (1.2830) acc_x 62.5000 (69.3750) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/22] time 0.378 (0.422) data 0.248 (0.292) loss_x loss_x 0.9922 (1.2702) acc_x 65.6250 (68.9583) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/22] time 0.575 (0.445) data 0.445 (0.315) loss_x loss_x 1.0889 (1.2483) acc_x 75.0000 (69.8438) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1774
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 728
clean true:584
clean false:144
clean_rate:0.8021978021978022
noisy true:778
noisy false:1630
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 2408
epoch [172/200] batch [5/22] time 0.471 (0.426) data 0.340 (0.295) loss_x loss_x 1.4951 (1.3186) acc_x 71.8750 (68.1250) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [10/22] time 0.407 (0.421) data 0.276 (0.290) loss_x loss_x 1.1904 (1.3520) acc_x 71.8750 (66.8750) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [15/22] time 0.380 (0.417) data 0.249 (0.286) loss_x loss_x 0.9688 (1.3004) acc_x 75.0000 (66.6667) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/22] time 0.503 (0.435) data 0.373 (0.305) loss_x loss_x 1.3037 (1.2717) acc_x 62.5000 (67.0312) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2366, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 742
clean true:587
clean false:155
clean_rate:0.7911051212938005
noisy true:783
noisy false:1611
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 2394
epoch [173/200] batch [5/23] time 0.499 (0.509) data 0.369 (0.379) loss_x loss_x 0.8594 (1.1482) acc_x 84.3750 (73.7500) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [10/23] time 0.454 (0.487) data 0.324 (0.357) loss_x loss_x 1.2695 (1.2636) acc_x 68.7500 (69.6875) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [15/23] time 0.489 (0.466) data 0.359 (0.335) loss_x loss_x 1.3750 (1.2260) acc_x 59.3750 (69.1667) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/23] time 0.417 (0.470) data 0.287 (0.339) loss_x loss_x 0.9390 (1.1902) acc_x 71.8750 (68.5938) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1722
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 757
clean true:610
clean false:147
clean_rate:0.8058124174372523
noisy true:804
noisy false:1575
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 2379
epoch [174/200] batch [5/23] time 0.503 (0.497) data 0.372 (0.367) loss_x loss_x 1.3066 (1.2194) acc_x 75.0000 (70.6250) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [10/23] time 0.404 (0.455) data 0.273 (0.325) loss_x loss_x 1.1318 (1.2035) acc_x 71.8750 (70.9375) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [15/23] time 0.416 (0.437) data 0.286 (0.307) loss_x loss_x 2.2793 (1.2719) acc_x 53.1250 (69.7917) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/23] time 0.456 (0.436) data 0.326 (0.306) loss_x loss_x 1.5547 (1.2938) acc_x 62.5000 (68.9062) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1758
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:595
clean false:140
clean_rate:0.8095238095238095
noisy true:783
noisy false:1618
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [175/200] batch [5/22] time 0.460 (0.484) data 0.330 (0.353) loss_x loss_x 1.0996 (1.2154) acc_x 68.7500 (65.6250) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [10/22] time 0.379 (0.450) data 0.248 (0.319) loss_x loss_x 0.9829 (1.1838) acc_x 75.0000 (68.4375) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [15/22] time 0.524 (0.450) data 0.394 (0.320) loss_x loss_x 2.0293 (1.2817) acc_x 53.1250 (66.2500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/22] time 0.454 (0.444) data 0.323 (0.313) loss_x loss_x 1.5801 (1.2696) acc_x 46.8750 (66.0938) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1762
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 736
clean true:595
clean false:141
clean_rate:0.8084239130434783
noisy true:779
noisy false:1621
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 2400
epoch [176/200] batch [5/23] time 0.387 (0.442) data 0.257 (0.312) loss_x loss_x 0.9575 (1.1501) acc_x 78.1250 (71.2500) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [10/23] time 0.369 (0.477) data 0.238 (0.347) loss_x loss_x 1.9336 (1.3403) acc_x 56.2500 (66.2500) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [15/23] time 0.655 (0.495) data 0.526 (0.365) loss_x loss_x 2.0020 (1.3264) acc_x 62.5000 (66.8750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/23] time 0.422 (0.471) data 0.292 (0.341) loss_x loss_x 1.2734 (1.2980) acc_x 68.7500 (67.5000) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1728
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:607
clean false:146
clean_rate:0.8061088977423638
noisy true:801
noisy false:1582
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [177/200] batch [5/23] time 0.568 (0.475) data 0.438 (0.345) loss_x loss_x 1.7080 (1.3859) acc_x 53.1250 (63.7500) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/23] time 0.492 (0.466) data 0.362 (0.336) loss_x loss_x 1.2969 (1.3470) acc_x 71.8750 (67.5000) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [15/23] time 0.428 (0.485) data 0.297 (0.355) loss_x loss_x 1.1611 (1.2699) acc_x 68.7500 (68.7500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/23] time 0.443 (0.485) data 0.312 (0.355) loss_x loss_x 1.2969 (1.2854) acc_x 75.0000 (68.5938) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.2392, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 750
clean true:608
clean false:142
clean_rate:0.8106666666666666
noisy true:785
noisy false:1601
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 2386
epoch [178/200] batch [5/23] time 0.463 (0.415) data 0.333 (0.285) loss_x loss_x 1.6963 (1.3010) acc_x 56.2500 (70.6250) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/23] time 0.589 (0.451) data 0.459 (0.321) loss_x loss_x 1.5195 (1.3736) acc_x 62.5000 (66.2500) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [15/23] time 0.432 (0.448) data 0.302 (0.318) loss_x loss_x 1.0645 (1.2982) acc_x 71.8750 (67.7083) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/23] time 0.423 (0.440) data 0.292 (0.310) loss_x loss_x 1.3281 (1.3292) acc_x 71.8750 (67.3438) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1734
confident_label rate tensor(0.2357, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 739
clean true:600
clean false:139
clean_rate:0.8119079837618404
noisy true:802
noisy false:1595
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 2397
epoch [179/200] batch [5/23] time 0.337 (0.438) data 0.207 (0.309) loss_x loss_x 0.8203 (1.3158) acc_x 81.2500 (68.7500) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [10/23] time 0.602 (0.473) data 0.472 (0.344) loss_x loss_x 0.7861 (1.3149) acc_x 75.0000 (68.7500) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [15/23] time 0.557 (0.468) data 0.427 (0.339) loss_x loss_x 1.8281 (1.3225) acc_x 53.1250 (67.9167) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/23] time 0.465 (0.482) data 0.334 (0.352) loss_x loss_x 1.5430 (1.3314) acc_x 56.2500 (67.3438) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 759
clean true:608
clean false:151
clean_rate:0.8010540184453228
noisy true:803
noisy false:1574
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 2377
epoch [180/200] batch [5/23] time 0.368 (0.378) data 0.238 (0.248) loss_x loss_x 1.0254 (1.0169) acc_x 75.0000 (75.6250) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/23] time 0.416 (0.411) data 0.286 (0.280) loss_x loss_x 1.2764 (1.1586) acc_x 71.8750 (72.5000) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [15/23] time 0.463 (0.415) data 0.333 (0.284) loss_x loss_x 1.0029 (1.1225) acc_x 71.8750 (72.9167) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/23] time 0.375 (0.420) data 0.244 (0.290) loss_x loss_x 1.1357 (1.1717) acc_x 68.7500 (71.4062) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2344, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 735
clean true:577
clean false:158
clean_rate:0.7850340136054422
noisy true:793
noisy false:1608
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 2401
epoch [181/200] batch [5/22] time 0.454 (0.430) data 0.323 (0.300) loss_x loss_x 0.7407 (1.1583) acc_x 87.5000 (73.7500) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [10/22] time 0.535 (0.432) data 0.404 (0.302) loss_x loss_x 1.3447 (1.2055) acc_x 56.2500 (68.4375) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [15/22] time 0.518 (0.444) data 0.387 (0.313) loss_x loss_x 1.3213 (1.1865) acc_x 59.3750 (67.7083) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/22] time 0.364 (0.430) data 0.233 (0.299) loss_x loss_x 0.9448 (1.1584) acc_x 78.1250 (68.5938) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:602
clean false:151
clean_rate:0.799468791500664
noisy true:790
noisy false:1593
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [182/200] batch [5/23] time 0.361 (0.465) data 0.230 (0.334) loss_x loss_x 1.5029 (1.3687) acc_x 56.2500 (65.6250) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [10/23] time 0.548 (0.471) data 0.417 (0.340) loss_x loss_x 1.1172 (1.2149) acc_x 62.5000 (68.7500) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [15/23] time 0.515 (0.474) data 0.384 (0.344) loss_x loss_x 0.8965 (1.1504) acc_x 71.8750 (70.2083) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/23] time 0.403 (0.453) data 0.272 (0.322) loss_x loss_x 1.2959 (1.1757) acc_x 68.7500 (70.0000) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.2242, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 703
clean true:568
clean false:135
clean_rate:0.8079658605974396
noisy true:809
noisy false:1624
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 2433
epoch [183/200] batch [5/21] time 0.418 (0.433) data 0.287 (0.302) loss_x loss_x 1.0566 (1.3668) acc_x 75.0000 (64.3750) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [10/21] time 0.382 (0.441) data 0.251 (0.311) loss_x loss_x 0.7593 (1.2967) acc_x 81.2500 (68.1250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/21] time 0.455 (0.442) data 0.325 (0.311) loss_x loss_x 1.7490 (1.3602) acc_x 46.8750 (65.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/21] time 0.478 (0.435) data 0.347 (0.305) loss_x loss_x 1.4346 (1.3368) acc_x 65.6250 (66.4062) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1744
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:600
clean false:153
clean_rate:0.796812749003984
noisy true:792
noisy false:1591
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [184/200] batch [5/23] time 0.430 (0.396) data 0.299 (0.266) loss_x loss_x 0.8384 (1.2063) acc_x 81.2500 (67.5000) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [10/23] time 0.352 (0.415) data 0.222 (0.285) loss_x loss_x 0.8989 (1.2907) acc_x 81.2500 (66.2500) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [15/23] time 0.360 (0.418) data 0.230 (0.288) loss_x loss_x 0.8784 (1.2243) acc_x 71.8750 (68.3333) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/23] time 0.383 (0.424) data 0.253 (0.293) loss_x loss_x 1.6768 (1.2205) acc_x 50.0000 (68.7500) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1759
confident_label rate tensor(0.2392, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 750
clean true:597
clean false:153
clean_rate:0.796
noisy true:780
noisy false:1606
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 2386
epoch [185/200] batch [5/23] time 0.367 (0.438) data 0.236 (0.307) loss_x loss_x 1.3691 (1.3928) acc_x 65.6250 (64.3750) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [10/23] time 0.440 (0.457) data 0.310 (0.326) loss_x loss_x 0.9731 (1.2672) acc_x 78.1250 (65.6250) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [15/23] time 0.381 (0.462) data 0.250 (0.332) loss_x loss_x 0.6831 (1.2040) acc_x 75.0000 (66.4583) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/23] time 0.391 (0.449) data 0.261 (0.319) loss_x loss_x 0.6655 (1.2005) acc_x 87.5000 (67.9688) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.2392, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 750
clean true:584
clean false:166
clean_rate:0.7786666666666666
noisy true:809
noisy false:1577
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 2386
epoch [186/200] batch [5/23] time 0.523 (0.462) data 0.392 (0.332) loss_x loss_x 1.0654 (1.2137) acc_x 68.7500 (68.1250) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [10/23] time 0.374 (0.435) data 0.244 (0.304) loss_x loss_x 0.9897 (1.2843) acc_x 75.0000 (67.8125) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [15/23] time 0.433 (0.425) data 0.302 (0.295) loss_x loss_x 1.2715 (1.3414) acc_x 68.7500 (66.6667) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/23] time 0.739 (0.435) data 0.608 (0.304) loss_x loss_x 1.4248 (1.3571) acc_x 68.7500 (66.5625) lr 3.1417e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.2446, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 767
clean true:598
clean false:169
clean_rate:0.7796610169491526
noisy true:813
noisy false:1556
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 2369
epoch [187/200] batch [5/23] time 0.492 (0.449) data 0.361 (0.318) loss_x loss_x 0.7744 (1.2217) acc_x 81.2500 (74.3750) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [10/23] time 0.590 (0.474) data 0.459 (0.344) loss_x loss_x 0.7983 (1.2387) acc_x 78.1250 (70.6250) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [15/23] time 0.393 (0.478) data 0.263 (0.348) loss_x loss_x 1.3262 (1.2185) acc_x 65.6250 (70.2083) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/23] time 0.329 (0.468) data 0.199 (0.338) loss_x loss_x 1.5850 (1.2534) acc_x 65.6250 (69.6875) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1726
confident_label rate tensor(0.2366, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 742
clean true:596
clean false:146
clean_rate:0.8032345013477089
noisy true:814
noisy false:1580
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 2394
epoch [188/200] batch [5/23] time 0.540 (0.420) data 0.410 (0.290) loss_x loss_x 1.3203 (1.1757) acc_x 68.7500 (72.5000) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [10/23] time 0.540 (0.445) data 0.410 (0.315) loss_x loss_x 1.3018 (1.1720) acc_x 71.8750 (70.6250) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [15/23] time 0.473 (0.453) data 0.342 (0.323) loss_x loss_x 1.6904 (1.2182) acc_x 59.3750 (68.1250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/23] time 0.462 (0.467) data 0.332 (0.336) loss_x loss_x 1.2051 (1.2249) acc_x 53.1250 (66.0938) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1735
confident_label rate tensor(0.2404, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 754
clean true:601
clean false:153
clean_rate:0.7970822281167109
noisy true:800
noisy false:1582
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 2382
epoch [189/200] batch [5/23] time 0.466 (0.472) data 0.335 (0.342) loss_x loss_x 1.5361 (1.2562) acc_x 59.3750 (66.8750) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [10/23] time 0.444 (0.469) data 0.313 (0.339) loss_x loss_x 1.8262 (1.3336) acc_x 62.5000 (66.5625) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [15/23] time 0.417 (0.445) data 0.287 (0.314) loss_x loss_x 1.1387 (1.3053) acc_x 71.8750 (67.5000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/23] time 0.436 (0.440) data 0.306 (0.310) loss_x loss_x 1.6172 (1.3334) acc_x 56.2500 (66.7188) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1749
confident_label rate tensor(0.2446, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 767
clean true:626
clean false:141
clean_rate:0.8161668839634941
noisy true:761
noisy false:1608
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 2369
epoch [190/200] batch [5/23] time 0.505 (0.422) data 0.375 (0.293) loss_x loss_x 0.8076 (1.1350) acc_x 81.2500 (71.8750) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [10/23] time 0.357 (0.419) data 0.227 (0.289) loss_x loss_x 1.1260 (1.1495) acc_x 81.2500 (71.8750) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [15/23] time 0.400 (0.429) data 0.269 (0.299) loss_x loss_x 1.3809 (1.1172) acc_x 62.5000 (73.1250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/23] time 0.376 (0.431) data 0.245 (0.301) loss_x loss_x 0.9111 (1.0951) acc_x 71.8750 (72.9688) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1772
confident_label rate tensor(0.2341, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 734
clean true:584
clean false:150
clean_rate:0.7956403269754768
noisy true:780
noisy false:1622
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 2402
epoch [191/200] batch [5/22] time 0.428 (0.446) data 0.297 (0.315) loss_x loss_x 1.0137 (1.3957) acc_x 75.0000 (65.6250) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [10/22] time 0.412 (0.452) data 0.281 (0.321) loss_x loss_x 1.0850 (1.3942) acc_x 71.8750 (64.3750) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [15/22] time 0.326 (0.434) data 0.195 (0.303) loss_x loss_x 0.6699 (1.3158) acc_x 84.3750 (67.9167) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/22] time 0.501 (0.449) data 0.370 (0.319) loss_x loss_x 0.8286 (1.3104) acc_x 78.1250 (67.6562) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1742
confident_label rate tensor(0.2385, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 748
clean true:599
clean false:149
clean_rate:0.8008021390374331
noisy true:795
noisy false:1593
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 2388
epoch [192/200] batch [5/23] time 0.430 (0.444) data 0.300 (0.313) loss_x loss_x 1.5869 (1.3633) acc_x 59.3750 (70.6250) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [10/23] time 0.404 (0.428) data 0.273 (0.298) loss_x loss_x 1.2334 (1.2962) acc_x 71.8750 (71.5625) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [15/23] time 0.398 (0.439) data 0.268 (0.308) loss_x loss_x 1.2979 (1.2356) acc_x 71.8750 (71.4583) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/23] time 0.480 (0.438) data 0.350 (0.308) loss_x loss_x 1.2754 (1.2374) acc_x 65.6250 (70.9375) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1778
confident_label rate tensor(0.2439, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 765
clean true:589
clean false:176
clean_rate:0.7699346405228759
noisy true:769
noisy false:1602
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 2371
epoch [193/200] batch [5/23] time 0.418 (0.417) data 0.289 (0.287) loss_x loss_x 1.5889 (1.1605) acc_x 59.3750 (70.6250) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [10/23] time 0.417 (0.443) data 0.287 (0.312) loss_x loss_x 0.9971 (1.1450) acc_x 75.0000 (71.2500) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [15/23] time 0.444 (0.449) data 0.313 (0.318) loss_x loss_x 1.1729 (1.1837) acc_x 65.6250 (70.4167) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/23] time 0.357 (0.437) data 0.226 (0.306) loss_x loss_x 1.6172 (1.2107) acc_x 56.2500 (69.8438) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1742
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 745
clean true:599
clean false:146
clean_rate:0.8040268456375839
noisy true:795
noisy false:1596
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 2391
epoch [194/200] batch [5/23] time 0.457 (0.563) data 0.326 (0.432) loss_x loss_x 1.2070 (1.2543) acc_x 65.6250 (66.2500) lr 7.8853e-06 eta 0:00:10
epoch [194/200] batch [10/23] time 0.651 (0.511) data 0.521 (0.380) loss_x loss_x 0.9292 (1.2452) acc_x 81.2500 (69.3750) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [15/23] time 0.450 (0.481) data 0.320 (0.350) loss_x loss_x 1.5098 (1.3064) acc_x 62.5000 (67.9167) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/23] time 0.403 (0.486) data 0.273 (0.355) loss_x loss_x 1.1260 (1.3089) acc_x 81.2500 (67.8125) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.2325, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 729
clean true:592
clean false:137
clean_rate:0.8120713305898491
noisy true:793
noisy false:1614
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 2407
epoch [195/200] batch [5/22] time 0.513 (0.485) data 0.381 (0.354) loss_x loss_x 1.7764 (1.2833) acc_x 46.8750 (63.7500) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/22] time 0.530 (0.449) data 0.400 (0.319) loss_x loss_x 1.0850 (1.1730) acc_x 71.8750 (68.4375) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [15/22] time 0.398 (0.443) data 0.267 (0.313) loss_x loss_x 1.1699 (1.1868) acc_x 78.1250 (69.1667) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/22] time 0.481 (0.457) data 0.351 (0.327) loss_x loss_x 1.0059 (1.1753) acc_x 71.8750 (70.6250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1727
confident_label rate tensor(0.2427, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 761
clean true:605
clean false:156
clean_rate:0.7950065703022339
noisy true:804
noisy false:1571
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 2375
epoch [196/200] batch [5/23] time 0.450 (0.504) data 0.320 (0.373) loss_x loss_x 1.1338 (1.0055) acc_x 68.7500 (73.7500) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [10/23] time 0.437 (0.489) data 0.308 (0.359) loss_x loss_x 1.1230 (1.0186) acc_x 78.1250 (75.0000) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [15/23] time 0.385 (0.485) data 0.255 (0.355) loss_x loss_x 1.1484 (1.0500) acc_x 65.6250 (74.7917) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/23] time 0.423 (0.469) data 0.292 (0.339) loss_x loss_x 1.0283 (1.0629) acc_x 78.1250 (75.0000) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1770
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 753
clean true:594
clean false:159
clean_rate:0.7888446215139442
noisy true:772
noisy false:1611
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 2383
epoch [197/200] batch [5/23] time 0.406 (0.448) data 0.276 (0.317) loss_x loss_x 1.3730 (1.1593) acc_x 62.5000 (70.0000) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [10/23] time 0.427 (0.463) data 0.297 (0.332) loss_x loss_x 0.8145 (1.1757) acc_x 78.1250 (69.6875) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [15/23] time 0.381 (0.451) data 0.251 (0.321) loss_x loss_x 1.3203 (1.1726) acc_x 62.5000 (69.5833) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/23] time 0.387 (0.449) data 0.255 (0.319) loss_x loss_x 1.5996 (1.1981) acc_x 59.3750 (68.7500) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1769
confident_label rate tensor(0.2334, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 732
clean true:585
clean false:147
clean_rate:0.7991803278688525
noisy true:782
noisy false:1622
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 2404
epoch [198/200] batch [5/22] time 0.497 (0.429) data 0.365 (0.299) loss_x loss_x 0.9424 (1.0395) acc_x 78.1250 (74.3750) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [10/22] time 0.306 (0.423) data 0.176 (0.293) loss_x loss_x 1.6016 (1.1641) acc_x 71.8750 (71.8750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [15/22] time 0.507 (0.430) data 0.377 (0.300) loss_x loss_x 1.2734 (1.2604) acc_x 75.0000 (69.3750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/22] time 0.367 (0.427) data 0.237 (0.297) loss_x loss_x 1.4375 (1.2403) acc_x 62.5000 (68.9062) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1787
confident_label rate tensor(0.2408, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 755
clean true:603
clean false:152
clean_rate:0.7986754966887417
noisy true:746
noisy false:1635
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 2381
epoch [199/200] batch [5/23] time 0.522 (0.449) data 0.392 (0.319) loss_x loss_x 0.8276 (1.1319) acc_x 71.8750 (65.0000) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [10/23] time 0.415 (0.428) data 0.285 (0.298) loss_x loss_x 1.1758 (1.2170) acc_x 71.8750 (67.1875) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [15/23] time 0.407 (0.429) data 0.278 (0.300) loss_x loss_x 1.0693 (1.1867) acc_x 65.6250 (68.3333) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/23] time 0.462 (0.440) data 0.332 (0.310) loss_x loss_x 1.2539 (1.2391) acc_x 68.7500 (67.0312) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1780
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 736
clean true:584
clean false:152
clean_rate:0.7934782608695652
noisy true:772
noisy false:1628
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 2400
epoch [200/200] batch [5/23] time 0.516 (0.466) data 0.386 (0.336) loss_x loss_x 1.0713 (1.2807) acc_x 68.7500 (65.6250) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [10/23] time 0.388 (0.452) data 0.258 (0.322) loss_x loss_x 1.1846 (1.2824) acc_x 65.6250 (66.2500) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [15/23] time 0.397 (0.472) data 0.266 (0.342) loss_x loss_x 1.2041 (1.2818) acc_x 68.7500 (66.6667) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/23] time 0.523 (0.469) data 0.394 (0.339) loss_x loss_x 1.1396 (1.2625) acc_x 65.6250 (67.0312) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 4,430
* accuracy: 55.1%
* error: 44.9%
* macro_f1: 53.1%
Elapsed: 2:54:35
