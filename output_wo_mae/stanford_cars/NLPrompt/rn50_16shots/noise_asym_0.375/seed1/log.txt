***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '196']
output_dir: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: StanfordCars
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 196
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: StanfordCars
Reading split from /home/convex/datasets/nlprompt/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/stanford_cars/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 98
Data loader size: 8
Data loader size: 81
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      784
# test     8,041
---------  ------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2571
confident_label rate tensor(0.1279, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 401
clean true:363
clean false:38
clean_rate:0.9052369077306733
noisy true:202
noisy false:2533
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 2735
epoch [1/200] batch [5/12] time 0.640 (0.514) data 0.511 (0.367) loss_x loss_x 2.8164 (3.0086) acc_x 43.7500 (36.8750) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [10/12] time 0.466 (0.482) data 0.337 (0.344) loss_x loss_x 2.7812 (2.8416) acc_x 37.5000 (39.6875) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 2375
confident_label rate tensor(0.1629, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 511
clean true:479
clean false:32
clean_rate:0.9373776908023483
noisy true:282
noisy false:2343
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 2625
epoch [2/200] batch [5/15] time 0.564 (0.487) data 0.435 (0.354) loss_x loss_x 2.0195 (1.9688) acc_x 46.8750 (53.1250) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/15] time 0.430 (0.521) data 0.299 (0.389) loss_x loss_x 2.2910 (1.9987) acc_x 34.3750 (48.7500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [15/15] time 0.568 (0.532) data 0.439 (0.401) loss_x loss_x 1.7656 (1.9034) acc_x 59.3750 (50.4167) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1942
confident_label rate tensor(0.2589, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 812
clean true:771
clean false:41
clean_rate:0.9495073891625616
noisy true:423
noisy false:1901
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 2324
epoch [3/200] batch [5/25] time 0.462 (0.463) data 0.330 (0.332) loss_x loss_x 1.3320 (1.6875) acc_x 59.3750 (51.8750) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [10/25] time 0.447 (0.479) data 0.315 (0.348) loss_x loss_x 1.3857 (1.6046) acc_x 65.6250 (54.6875) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [15/25] time 0.470 (0.498) data 0.340 (0.365) loss_x loss_x 1.4023 (1.5727) acc_x 56.2500 (56.4583) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [20/25] time 0.530 (0.485) data 0.400 (0.353) loss_x loss_x 1.5439 (1.6428) acc_x 65.6250 (56.0938) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [25/25] time 0.570 (0.484) data 0.438 (0.352) loss_x loss_x 1.8828 (1.6359) acc_x 56.2500 (56.6250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1889
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 846
clean true:806
clean false:40
clean_rate:0.9527186761229315
noisy true:441
noisy false:1849
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 2290
epoch [4/200] batch [5/26] time 0.437 (0.423) data 0.308 (0.293) loss_x loss_x 1.8203 (1.6115) acc_x 56.2500 (55.6250) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [10/26] time 0.482 (0.450) data 0.351 (0.320) loss_x loss_x 1.9287 (1.7007) acc_x 53.1250 (55.0000) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [15/26] time 0.450 (0.462) data 0.319 (0.332) loss_x loss_x 1.2051 (1.6236) acc_x 62.5000 (55.4167) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [20/26] time 0.504 (0.457) data 0.374 (0.327) loss_x loss_x 1.5117 (1.5567) acc_x 68.7500 (57.8125) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [25/26] time 0.399 (0.453) data 0.269 (0.323) loss_x loss_x 1.4541 (1.5455) acc_x 68.7500 (58.5000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1873
confident_label rate tensor(0.2663, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 835
clean true:788
clean false:47
clean_rate:0.9437125748502994
noisy true:475
noisy false:1826
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 2301
epoch [5/200] batch [5/26] time 0.448 (0.530) data 0.319 (0.400) loss_x loss_x 1.7656 (1.7396) acc_x 53.1250 (52.5000) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [10/26] time 0.473 (0.497) data 0.343 (0.367) loss_x loss_x 1.3115 (1.7863) acc_x 62.5000 (55.3125) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [15/26] time 0.506 (0.479) data 0.376 (0.348) loss_x loss_x 1.0635 (1.7038) acc_x 71.8750 (56.0417) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [20/26] time 0.415 (0.478) data 0.286 (0.347) loss_x loss_x 1.3076 (1.6829) acc_x 65.6250 (57.1875) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [25/26] time 0.389 (0.481) data 0.258 (0.351) loss_x loss_x 1.3320 (1.6992) acc_x 53.1250 (56.8750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1847
confident_label rate tensor(0.2752, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 863
clean true:822
clean false:41
clean_rate:0.9524913093858632
noisy true:467
noisy false:1806
after delete: len(clean_dataset) 863
after delete: len(noisy_dataset) 2273
epoch [6/200] batch [5/26] time 0.393 (0.436) data 0.263 (0.306) loss_x loss_x 1.7686 (1.6037) acc_x 46.8750 (52.5000) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [10/26] time 0.425 (0.433) data 0.295 (0.303) loss_x loss_x 1.8721 (1.5700) acc_x 50.0000 (55.3125) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [15/26] time 0.497 (0.431) data 0.367 (0.301) loss_x loss_x 1.6836 (1.6588) acc_x 56.2500 (54.3750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [20/26] time 0.470 (0.435) data 0.339 (0.306) loss_x loss_x 1.3457 (1.6328) acc_x 56.2500 (55.1562) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/26] time 0.549 (0.440) data 0.419 (0.310) loss_x loss_x 1.5654 (1.6387) acc_x 62.5000 (56.0000) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1840
confident_label rate tensor(0.2771, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 869
clean true:825
clean false:44
clean_rate:0.9493670886075949
noisy true:471
noisy false:1796
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 2267
epoch [7/200] batch [5/27] time 0.456 (0.458) data 0.326 (0.328) loss_x loss_x 1.7373 (1.4961) acc_x 56.2500 (58.7500) lr 1.9969e-03 eta 0:00:10
epoch [7/200] batch [10/27] time 0.354 (0.477) data 0.224 (0.347) loss_x loss_x 1.4707 (1.4177) acc_x 62.5000 (60.0000) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [15/27] time 0.366 (0.470) data 0.237 (0.340) loss_x loss_x 1.0820 (1.4163) acc_x 68.7500 (61.4583) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [20/27] time 0.472 (0.458) data 0.343 (0.328) loss_x loss_x 1.5889 (1.4579) acc_x 59.3750 (60.4688) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/27] time 0.489 (0.463) data 0.359 (0.333) loss_x loss_x 1.6152 (1.4751) acc_x 50.0000 (60.5000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1820
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 855
clean true:816
clean false:39
clean_rate:0.9543859649122807
noisy true:500
noisy false:1781
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 2281
epoch [8/200] batch [5/26] time 0.572 (0.505) data 0.442 (0.374) loss_x loss_x 1.7881 (1.6045) acc_x 62.5000 (58.1250) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [10/26] time 0.443 (0.488) data 0.313 (0.358) loss_x loss_x 1.4023 (1.5266) acc_x 59.3750 (60.0000) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [15/26] time 0.485 (0.474) data 0.355 (0.343) loss_x loss_x 1.2725 (1.5376) acc_x 59.3750 (59.3750) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [20/26] time 0.589 (0.477) data 0.458 (0.347) loss_x loss_x 2.0859 (1.5696) acc_x 40.6250 (57.3438) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/26] time 0.540 (0.470) data 0.410 (0.340) loss_x loss_x 2.4551 (1.5889) acc_x 50.0000 (57.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1843
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 883
clean true:827
clean false:56
clean_rate:0.9365798414496036
noisy true:466
noisy false:1787
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 2253
epoch [9/200] batch [5/27] time 0.396 (0.451) data 0.266 (0.321) loss_x loss_x 1.4971 (1.4441) acc_x 56.2500 (61.2500) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [10/27] time 0.491 (0.464) data 0.361 (0.334) loss_x loss_x 1.9502 (1.6078) acc_x 59.3750 (57.1875) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [15/27] time 0.517 (0.451) data 0.386 (0.321) loss_x loss_x 1.6152 (1.5800) acc_x 65.6250 (56.2500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [20/27] time 0.391 (0.461) data 0.260 (0.330) loss_x loss_x 1.3740 (1.6087) acc_x 56.2500 (54.6875) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [25/27] time 0.443 (0.449) data 0.314 (0.319) loss_x loss_x 1.4648 (1.6631) acc_x 71.8750 (54.5000) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1862
confident_label rate tensor(0.2755, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 864
clean true:823
clean false:41
clean_rate:0.9525462962962963
noisy true:451
noisy false:1821
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 2272
epoch [10/200] batch [5/27] time 0.468 (0.500) data 0.338 (0.370) loss_x loss_x 1.8115 (1.6080) acc_x 65.6250 (61.8750) lr 1.9921e-03 eta 0:00:11
epoch [10/200] batch [10/27] time 0.468 (0.479) data 0.338 (0.348) loss_x loss_x 1.6797 (1.6304) acc_x 50.0000 (57.5000) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [15/27] time 0.445 (0.470) data 0.316 (0.340) loss_x loss_x 1.6797 (1.6673) acc_x 65.6250 (58.1250) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [20/27] time 0.450 (0.465) data 0.320 (0.335) loss_x loss_x 1.4648 (1.6354) acc_x 59.3750 (58.4375) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [25/27] time 0.480 (0.466) data 0.350 (0.336) loss_x loss_x 1.2871 (1.5999) acc_x 62.5000 (59.3750) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1829
confident_label rate tensor(0.2742, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 860
clean true:819
clean false:41
clean_rate:0.9523255813953488
noisy true:488
noisy false:1788
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 2276
epoch [11/200] batch [5/26] time 0.462 (0.505) data 0.332 (0.375) loss_x loss_x 1.2412 (1.5084) acc_x 56.2500 (56.2500) lr 1.9900e-03 eta 0:00:10
epoch [11/200] batch [10/26] time 0.477 (0.491) data 0.347 (0.361) loss_x loss_x 1.5850 (1.5040) acc_x 62.5000 (58.7500) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [15/26] time 0.383 (0.489) data 0.253 (0.359) loss_x loss_x 1.3848 (1.4276) acc_x 62.5000 (61.0417) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [20/26] time 0.493 (0.479) data 0.362 (0.349) loss_x loss_x 1.5938 (1.4826) acc_x 56.2500 (59.5312) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/26] time 0.504 (0.466) data 0.373 (0.336) loss_x loss_x 1.1553 (1.5545) acc_x 68.7500 (59.6250) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1855
confident_label rate tensor(0.2781, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 872
clean true:831
clean false:41
clean_rate:0.9529816513761468
noisy true:450
noisy false:1814
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 2264
epoch [12/200] batch [5/27] time 0.370 (0.448) data 0.240 (0.318) loss_x loss_x 1.6914 (1.5424) acc_x 46.8750 (55.0000) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [10/27] time 0.495 (0.453) data 0.365 (0.323) loss_x loss_x 1.1240 (1.5328) acc_x 65.6250 (56.8750) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [15/27] time 0.438 (0.473) data 0.307 (0.342) loss_x loss_x 1.8828 (1.5479) acc_x 50.0000 (59.1667) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [20/27] time 0.380 (0.468) data 0.250 (0.338) loss_x loss_x 1.6357 (1.5628) acc_x 59.3750 (58.4375) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [25/27] time 0.433 (0.464) data 0.303 (0.334) loss_x loss_x 1.5020 (1.4946) acc_x 59.3750 (60.1250) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1853
confident_label rate tensor(0.2765, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 867
clean true:837
clean false:30
clean_rate:0.9653979238754326
noisy true:446
noisy false:1823
after delete: len(clean_dataset) 867
after delete: len(noisy_dataset) 2269
epoch [13/200] batch [5/27] time 0.565 (0.476) data 0.436 (0.346) loss_x loss_x 1.2959 (1.5406) acc_x 75.0000 (62.5000) lr 1.9851e-03 eta 0:00:10
epoch [13/200] batch [10/27] time 0.483 (0.470) data 0.353 (0.340) loss_x loss_x 1.5869 (1.4832) acc_x 62.5000 (62.8125) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [15/27] time 0.592 (0.474) data 0.462 (0.344) loss_x loss_x 1.9189 (1.5756) acc_x 46.8750 (60.4167) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [20/27] time 0.451 (0.471) data 0.321 (0.341) loss_x loss_x 1.7773 (1.6060) acc_x 53.1250 (58.7500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [25/27] time 0.338 (0.461) data 0.208 (0.331) loss_x loss_x 1.8027 (1.6274) acc_x 50.0000 (58.1250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.2876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 902
clean true:850
clean false:52
clean_rate:0.9423503325942351
noisy true:469
noisy false:1765
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 2234
epoch [14/200] batch [5/28] time 0.343 (0.431) data 0.212 (0.300) loss_x loss_x 1.6084 (1.4418) acc_x 62.5000 (62.5000) lr 1.9823e-03 eta 0:00:09
epoch [14/200] batch [10/28] time 0.549 (0.448) data 0.419 (0.318) loss_x loss_x 1.1270 (1.3616) acc_x 62.5000 (63.4375) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [15/28] time 0.622 (0.457) data 0.492 (0.327) loss_x loss_x 1.8994 (1.4783) acc_x 50.0000 (61.0417) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [20/28] time 0.551 (0.470) data 0.420 (0.340) loss_x loss_x 1.3359 (1.4779) acc_x 65.6250 (61.5625) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [25/28] time 0.383 (0.462) data 0.253 (0.332) loss_x loss_x 1.6807 (1.4794) acc_x 50.0000 (60.7500) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1821
confident_label rate tensor(0.2870, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 900
clean true:855
clean false:45
clean_rate:0.95
noisy true:460
noisy false:1776
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 2236
epoch [15/200] batch [5/28] time 0.513 (0.478) data 0.382 (0.348) loss_x loss_x 1.2568 (1.5475) acc_x 75.0000 (59.3750) lr 1.9792e-03 eta 0:00:10
epoch [15/200] batch [10/28] time 0.513 (0.453) data 0.383 (0.323) loss_x loss_x 1.1562 (1.4281) acc_x 71.8750 (61.8750) lr 1.9792e-03 eta 0:00:08
epoch [15/200] batch [15/28] time 0.454 (0.468) data 0.324 (0.338) loss_x loss_x 1.3936 (1.5221) acc_x 68.7500 (60.2083) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [20/28] time 0.504 (0.462) data 0.374 (0.332) loss_x loss_x 1.6855 (1.5974) acc_x 62.5000 (58.4375) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [25/28] time 0.484 (0.449) data 0.354 (0.319) loss_x loss_x 1.4375 (1.5581) acc_x 68.7500 (58.7500) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1840
confident_label rate tensor(0.2851, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 894
clean true:836
clean false:58
clean_rate:0.9351230425055929
noisy true:460
noisy false:1782
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 2242
epoch [16/200] batch [5/27] time 0.394 (0.416) data 0.264 (0.286) loss_x loss_x 1.6406 (1.6189) acc_x 46.8750 (54.3750) lr 1.9759e-03 eta 0:00:09
epoch [16/200] batch [10/27] time 0.420 (0.433) data 0.290 (0.303) loss_x loss_x 1.2559 (1.4992) acc_x 56.2500 (59.0625) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [15/27] time 0.532 (0.448) data 0.402 (0.318) loss_x loss_x 1.4072 (1.5486) acc_x 65.6250 (57.5000) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [20/27] time 0.516 (0.461) data 0.386 (0.331) loss_x loss_x 1.5684 (1.5477) acc_x 62.5000 (57.5000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [25/27] time 0.373 (0.450) data 0.243 (0.321) loss_x loss_x 1.2227 (1.5434) acc_x 68.7500 (58.5000) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1831
confident_label rate tensor(0.2761, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 866
clean true:817
clean false:49
clean_rate:0.9434180138568129
noisy true:488
noisy false:1782
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 2270
epoch [17/200] batch [5/27] time 0.566 (0.479) data 0.436 (0.349) loss_x loss_x 1.6016 (1.7119) acc_x 53.1250 (56.2500) lr 1.9724e-03 eta 0:00:10
epoch [17/200] batch [10/27] time 0.437 (0.469) data 0.306 (0.339) loss_x loss_x 1.9482 (1.6479) acc_x 59.3750 (55.6250) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [15/27] time 0.551 (0.460) data 0.421 (0.330) loss_x loss_x 1.0645 (1.5124) acc_x 78.1250 (59.5833) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [20/27] time 0.431 (0.453) data 0.301 (0.323) loss_x loss_x 1.3789 (1.5271) acc_x 71.8750 (59.5312) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [25/27] time 0.537 (0.450) data 0.407 (0.320) loss_x loss_x 1.1738 (1.5003) acc_x 65.6250 (59.8750) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1792
confident_label rate tensor(0.2854, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 895
clean true:855
clean false:40
clean_rate:0.9553072625698324
noisy true:489
noisy false:1752
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 2241
epoch [18/200] batch [5/27] time 0.402 (0.495) data 0.272 (0.365) loss_x loss_x 1.1904 (1.6041) acc_x 65.6250 (56.2500) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [10/27] time 0.467 (0.476) data 0.337 (0.346) loss_x loss_x 1.2803 (1.5353) acc_x 75.0000 (60.3125) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [15/27] time 0.380 (0.462) data 0.250 (0.331) loss_x loss_x 1.3223 (1.5514) acc_x 65.6250 (59.5833) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [20/27] time 0.372 (0.454) data 0.242 (0.324) loss_x loss_x 1.6572 (1.5837) acc_x 62.5000 (58.4375) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/27] time 0.364 (0.446) data 0.234 (0.316) loss_x loss_x 1.5488 (1.5782) acc_x 65.6250 (58.8750) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1843
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 859
clean true:821
clean false:38
clean_rate:0.9557625145518044
noisy true:472
noisy false:1805
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 2277
epoch [19/200] batch [5/26] time 0.488 (0.450) data 0.358 (0.320) loss_x loss_x 1.0781 (1.3494) acc_x 78.1250 (60.0000) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [10/26] time 0.399 (0.455) data 0.268 (0.325) loss_x loss_x 2.2188 (1.6129) acc_x 46.8750 (57.8125) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [15/26] time 0.421 (0.449) data 0.290 (0.319) loss_x loss_x 1.2393 (1.5925) acc_x 71.8750 (59.1667) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/26] time 0.483 (0.452) data 0.352 (0.321) loss_x loss_x 1.1230 (1.5953) acc_x 68.7500 (58.7500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/26] time 0.412 (0.454) data 0.282 (0.324) loss_x loss_x 1.6748 (1.5558) acc_x 62.5000 (59.8750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1817
confident_label rate tensor(0.2867, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 899
clean true:856
clean false:43
clean_rate:0.9521690767519466
noisy true:463
noisy false:1774
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 2237
epoch [20/200] batch [5/28] time 0.364 (0.427) data 0.234 (0.297) loss_x loss_x 1.3838 (1.4453) acc_x 68.7500 (66.8750) lr 1.9603e-03 eta 0:00:09
epoch [20/200] batch [10/28] time 0.505 (0.448) data 0.375 (0.319) loss_x loss_x 1.4111 (1.4149) acc_x 53.1250 (64.6875) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [15/28] time 0.371 (0.454) data 0.241 (0.324) loss_x loss_x 1.8701 (1.4488) acc_x 53.1250 (62.7083) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [20/28] time 0.415 (0.462) data 0.285 (0.332) loss_x loss_x 1.7686 (1.4609) acc_x 62.5000 (61.8750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/28] time 0.434 (0.460) data 0.304 (0.330) loss_x loss_x 1.5654 (1.5409) acc_x 62.5000 (60.6250) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1809
confident_label rate tensor(0.2908, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 912
clean true:863
clean false:49
clean_rate:0.9462719298245614
noisy true:464
noisy false:1760
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 2224
epoch [21/200] batch [5/28] time 0.457 (0.458) data 0.327 (0.328) loss_x loss_x 1.3438 (1.5674) acc_x 68.7500 (61.2500) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [10/28] time 0.471 (0.451) data 0.340 (0.321) loss_x loss_x 1.6055 (1.4613) acc_x 68.7500 (62.5000) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [15/28] time 0.440 (0.466) data 0.310 (0.336) loss_x loss_x 1.7920 (1.4599) acc_x 56.2500 (62.0833) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [20/28] time 0.432 (0.469) data 0.302 (0.339) loss_x loss_x 1.3789 (1.4581) acc_x 65.6250 (61.5625) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/28] time 0.499 (0.470) data 0.369 (0.340) loss_x loss_x 1.2617 (1.5035) acc_x 75.0000 (60.7500) lr 1.9558e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1781
confident_label rate tensor(0.2956, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 927
clean true:881
clean false:46
clean_rate:0.9503775620280475
noisy true:474
noisy false:1735
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 2209
epoch [22/200] batch [5/28] time 0.657 (0.510) data 0.527 (0.380) loss_x loss_x 1.1787 (1.2600) acc_x 59.3750 (63.1250) lr 1.9511e-03 eta 0:00:11
epoch [22/200] batch [10/28] time 0.515 (0.478) data 0.385 (0.347) loss_x loss_x 1.3555 (1.4273) acc_x 62.5000 (59.6875) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [15/28] time 0.438 (0.465) data 0.308 (0.335) loss_x loss_x 1.4053 (1.4495) acc_x 62.5000 (60.2083) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [20/28] time 0.528 (0.457) data 0.398 (0.327) loss_x loss_x 1.5537 (1.4870) acc_x 59.3750 (60.4688) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/28] time 0.530 (0.456) data 0.400 (0.326) loss_x loss_x 1.7627 (1.4977) acc_x 59.3750 (60.6250) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1764
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 921
clean true:879
clean false:42
clean_rate:0.9543973941368078
noisy true:493
noisy false:1722
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 2215
epoch [23/200] batch [5/28] time 0.438 (0.462) data 0.308 (0.332) loss_x loss_x 1.6016 (1.5018) acc_x 53.1250 (57.5000) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [10/28] time 0.347 (0.438) data 0.217 (0.308) loss_x loss_x 1.9512 (1.4804) acc_x 46.8750 (58.4375) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [15/28] time 0.453 (0.443) data 0.323 (0.313) loss_x loss_x 1.2334 (1.4372) acc_x 65.6250 (59.1667) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [20/28] time 0.426 (0.450) data 0.295 (0.320) loss_x loss_x 0.7349 (1.3992) acc_x 87.5000 (62.1875) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/28] time 0.511 (0.462) data 0.381 (0.332) loss_x loss_x 1.2939 (1.4010) acc_x 65.6250 (62.8750) lr 1.9461e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 885
clean true:840
clean false:45
clean_rate:0.9491525423728814
noisy true:486
noisy false:1765
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 2251
epoch [24/200] batch [5/27] time 0.391 (0.421) data 0.261 (0.292) loss_x loss_x 1.2998 (1.3670) acc_x 71.8750 (65.6250) lr 1.9409e-03 eta 0:00:09
epoch [24/200] batch [10/27] time 0.408 (0.426) data 0.278 (0.296) loss_x loss_x 1.4160 (1.5561) acc_x 65.6250 (60.0000) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [15/27] time 0.386 (0.421) data 0.255 (0.290) loss_x loss_x 1.3955 (1.5538) acc_x 65.6250 (60.0000) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [20/27] time 0.447 (0.433) data 0.316 (0.303) loss_x loss_x 1.0312 (1.5247) acc_x 65.6250 (61.0938) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/27] time 0.467 (0.441) data 0.336 (0.311) loss_x loss_x 1.5205 (1.4837) acc_x 59.3750 (62.0000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2883, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 904
clean true:860
clean false:44
clean_rate:0.9513274336283186
noisy true:466
noisy false:1766
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 2232
epoch [25/200] batch [5/28] time 0.431 (0.475) data 0.301 (0.345) loss_x loss_x 1.2324 (1.4680) acc_x 81.2500 (66.2500) lr 1.9354e-03 eta 0:00:10
epoch [25/200] batch [10/28] time 0.401 (0.443) data 0.271 (0.314) loss_x loss_x 1.5859 (1.4894) acc_x 62.5000 (63.4375) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [15/28] time 0.579 (0.473) data 0.449 (0.343) loss_x loss_x 1.1445 (1.4867) acc_x 68.7500 (63.5417) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [20/28] time 0.414 (0.474) data 0.284 (0.344) loss_x loss_x 2.2617 (1.4975) acc_x 50.0000 (61.0938) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/28] time 0.498 (0.467) data 0.367 (0.337) loss_x loss_x 1.7109 (1.5050) acc_x 56.2500 (59.8750) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1795
confident_label rate tensor(0.2848, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 893
clean true:852
clean false:41
clean_rate:0.9540873460246361
noisy true:489
noisy false:1754
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 2243
epoch [26/200] batch [5/27] time 0.468 (0.464) data 0.338 (0.334) loss_x loss_x 1.0332 (1.4612) acc_x 68.7500 (65.0000) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [10/27] time 0.470 (0.463) data 0.340 (0.334) loss_x loss_x 1.4053 (1.5194) acc_x 65.6250 (62.1875) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [15/27] time 0.459 (0.459) data 0.328 (0.329) loss_x loss_x 1.1279 (1.4875) acc_x 65.6250 (61.8750) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [20/27] time 0.441 (0.455) data 0.310 (0.325) loss_x loss_x 1.5801 (1.4894) acc_x 62.5000 (61.7188) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/27] time 0.445 (0.449) data 0.315 (0.319) loss_x loss_x 1.4189 (1.4988) acc_x 56.2500 (60.6250) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1810
confident_label rate tensor(0.2864, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 898
clean true:853
clean false:45
clean_rate:0.9498886414253898
noisy true:473
noisy false:1765
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 2238
epoch [27/200] batch [5/28] time 0.422 (0.402) data 0.292 (0.272) loss_x loss_x 2.2383 (1.8207) acc_x 46.8750 (52.5000) lr 1.9239e-03 eta 0:00:09
epoch [27/200] batch [10/28] time 0.497 (0.445) data 0.367 (0.314) loss_x loss_x 1.6748 (1.6367) acc_x 53.1250 (57.8125) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [15/28] time 0.533 (0.440) data 0.404 (0.310) loss_x loss_x 1.7715 (1.5776) acc_x 46.8750 (57.5000) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [20/28] time 0.523 (0.442) data 0.392 (0.312) loss_x loss_x 1.5146 (1.5366) acc_x 71.8750 (59.3750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/28] time 0.495 (0.453) data 0.365 (0.323) loss_x loss_x 1.9121 (1.5186) acc_x 50.0000 (59.6250) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1792
confident_label rate tensor(0.2883, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 904
clean true:863
clean false:41
clean_rate:0.9546460176991151
noisy true:481
noisy false:1751
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 2232
epoch [28/200] batch [5/28] time 0.572 (0.444) data 0.442 (0.315) loss_x loss_x 1.4346 (1.8422) acc_x 62.5000 (55.6250) lr 1.9178e-03 eta 0:00:10
epoch [28/200] batch [10/28] time 0.444 (0.454) data 0.313 (0.324) loss_x loss_x 1.7305 (1.7071) acc_x 56.2500 (56.5625) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [15/28] time 0.548 (0.463) data 0.418 (0.332) loss_x loss_x 1.7705 (1.5898) acc_x 53.1250 (59.1667) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [20/28] time 0.409 (0.461) data 0.279 (0.330) loss_x loss_x 1.2227 (1.5581) acc_x 75.0000 (58.9062) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/28] time 0.411 (0.450) data 0.281 (0.320) loss_x loss_x 1.4043 (1.5488) acc_x 59.3750 (59.0000) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1769
confident_label rate tensor(0.2978, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 934
clean true:893
clean false:41
clean_rate:0.9561027837259101
noisy true:474
noisy false:1728
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 2202
epoch [29/200] batch [5/29] time 0.485 (0.465) data 0.355 (0.335) loss_x loss_x 1.0361 (1.4807) acc_x 75.0000 (57.5000) lr 1.9114e-03 eta 0:00:11
epoch [29/200] batch [10/29] time 0.411 (0.487) data 0.280 (0.356) loss_x loss_x 1.4727 (1.4213) acc_x 59.3750 (60.3125) lr 1.9114e-03 eta 0:00:09
epoch [29/200] batch [15/29] time 0.412 (0.493) data 0.283 (0.363) loss_x loss_x 1.2021 (1.4081) acc_x 65.6250 (62.0833) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [20/29] time 0.563 (0.487) data 0.432 (0.357) loss_x loss_x 1.2070 (1.3915) acc_x 53.1250 (61.2500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [25/29] time 0.409 (0.475) data 0.279 (0.345) loss_x loss_x 2.2305 (1.4626) acc_x 31.2500 (58.7500) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1766
confident_label rate tensor(0.2991, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 938
clean true:893
clean false:45
clean_rate:0.9520255863539445
noisy true:477
noisy false:1721
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 2198
epoch [30/200] batch [5/29] time 0.592 (0.503) data 0.461 (0.372) loss_x loss_x 1.4824 (1.8113) acc_x 68.7500 (59.3750) lr 1.9048e-03 eta 0:00:12
epoch [30/200] batch [10/29] time 0.410 (0.479) data 0.280 (0.348) loss_x loss_x 2.4219 (1.6661) acc_x 43.7500 (59.6875) lr 1.9048e-03 eta 0:00:09
epoch [30/200] batch [15/29] time 0.455 (0.470) data 0.325 (0.339) loss_x loss_x 1.5342 (1.5816) acc_x 56.2500 (62.0833) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [20/29] time 0.412 (0.459) data 0.282 (0.329) loss_x loss_x 1.2754 (1.5574) acc_x 75.0000 (62.5000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [25/29] time 0.502 (0.461) data 0.372 (0.331) loss_x loss_x 1.9072 (1.5588) acc_x 43.7500 (61.5000) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1743
confident_label rate tensor(0.2937, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 921
clean true:878
clean false:43
clean_rate:0.9533116178067318
noisy true:515
noisy false:1700
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 2215
epoch [31/200] batch [5/28] time 0.404 (0.437) data 0.274 (0.307) loss_x loss_x 1.7793 (1.6781) acc_x 53.1250 (56.8750) lr 1.8980e-03 eta 0:00:10
epoch [31/200] batch [10/28] time 0.390 (0.477) data 0.260 (0.347) loss_x loss_x 1.2920 (1.4783) acc_x 59.3750 (59.0625) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [15/28] time 0.372 (0.451) data 0.242 (0.321) loss_x loss_x 1.4688 (1.4672) acc_x 65.6250 (60.4167) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [20/28] time 0.476 (0.465) data 0.346 (0.335) loss_x loss_x 1.6846 (1.4995) acc_x 59.3750 (59.8438) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/28] time 0.658 (0.475) data 0.528 (0.345) loss_x loss_x 0.9980 (1.4675) acc_x 68.7500 (61.3750) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.2975, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 933
clean true:886
clean false:47
clean_rate:0.9496248660235799
noisy true:464
noisy false:1739
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 2203
epoch [32/200] batch [5/29] time 0.341 (0.409) data 0.210 (0.278) loss_x loss_x 0.8984 (1.3412) acc_x 71.8750 (64.3750) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [10/29] time 0.768 (0.446) data 0.637 (0.316) loss_x loss_x 1.4834 (1.3705) acc_x 68.7500 (65.3125) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [15/29] time 0.490 (0.466) data 0.360 (0.335) loss_x loss_x 1.9980 (1.4212) acc_x 59.3750 (64.1667) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [20/29] time 0.372 (0.454) data 0.241 (0.324) loss_x loss_x 1.3164 (1.4419) acc_x 59.3750 (62.0312) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [25/29] time 0.549 (0.463) data 0.418 (0.333) loss_x loss_x 1.4590 (1.4846) acc_x 53.1250 (60.8750) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1790
confident_label rate tensor(0.2883, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 904
clean true:866
clean false:38
clean_rate:0.9579646017699115
noisy true:480
noisy false:1752
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 2232
epoch [33/200] batch [5/28] time 0.626 (0.489) data 0.496 (0.359) loss_x loss_x 1.1260 (1.1656) acc_x 75.0000 (73.7500) lr 1.8838e-03 eta 0:00:11
epoch [33/200] batch [10/28] time 0.459 (0.482) data 0.330 (0.353) loss_x loss_x 1.1074 (1.2315) acc_x 68.7500 (67.5000) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [15/28] time 0.451 (0.474) data 0.321 (0.344) loss_x loss_x 1.3486 (1.3551) acc_x 62.5000 (64.5833) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [20/28] time 0.352 (0.464) data 0.222 (0.334) loss_x loss_x 1.4990 (1.3819) acc_x 46.8750 (62.9688) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/28] time 0.473 (0.463) data 0.343 (0.333) loss_x loss_x 1.6250 (1.4224) acc_x 56.2500 (62.6250) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1800
confident_label rate tensor(0.2876, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 902
clean true:862
clean false:40
clean_rate:0.9556541019955654
noisy true:474
noisy false:1760
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 2234
epoch [34/200] batch [5/28] time 0.484 (0.432) data 0.354 (0.302) loss_x loss_x 1.7383 (1.4064) acc_x 46.8750 (60.6250) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [10/28] time 0.547 (0.445) data 0.417 (0.315) loss_x loss_x 1.5186 (1.4507) acc_x 65.6250 (62.5000) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [15/28] time 0.393 (0.440) data 0.263 (0.310) loss_x loss_x 1.1133 (1.4050) acc_x 62.5000 (63.3333) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [20/28] time 0.462 (0.452) data 0.331 (0.322) loss_x loss_x 1.6865 (1.4613) acc_x 56.2500 (62.1875) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/28] time 0.560 (0.457) data 0.429 (0.327) loss_x loss_x 1.1699 (1.4680) acc_x 65.6250 (61.7500) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1803
confident_label rate tensor(0.2918, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 915
clean true:875
clean false:40
clean_rate:0.9562841530054644
noisy true:458
noisy false:1763
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 2221
epoch [35/200] batch [5/28] time 0.374 (0.397) data 0.243 (0.266) loss_x loss_x 1.3330 (1.4312) acc_x 65.6250 (64.3750) lr 1.8686e-03 eta 0:00:09
epoch [35/200] batch [10/28] time 0.465 (0.430) data 0.335 (0.300) loss_x loss_x 2.0273 (1.5216) acc_x 50.0000 (60.0000) lr 1.8686e-03 eta 0:00:07
epoch [35/200] batch [15/28] time 0.442 (0.438) data 0.311 (0.308) loss_x loss_x 1.3828 (1.5384) acc_x 65.6250 (58.7500) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [20/28] time 0.533 (0.442) data 0.402 (0.311) loss_x loss_x 1.5586 (1.5601) acc_x 56.2500 (59.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/28] time 0.426 (0.447) data 0.296 (0.316) loss_x loss_x 1.3887 (1.5210) acc_x 62.5000 (60.3750) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1805
confident_label rate tensor(0.2870, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 900
clean true:861
clean false:39
clean_rate:0.9566666666666667
noisy true:470
noisy false:1766
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 2236
epoch [36/200] batch [5/28] time 0.439 (0.479) data 0.309 (0.348) loss_x loss_x 1.4404 (1.4621) acc_x 56.2500 (60.6250) lr 1.8607e-03 eta 0:00:11
epoch [36/200] batch [10/28] time 0.472 (0.467) data 0.342 (0.337) loss_x loss_x 1.0127 (1.4737) acc_x 68.7500 (61.5625) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [15/28] time 0.507 (0.486) data 0.377 (0.356) loss_x loss_x 1.7217 (1.4289) acc_x 46.8750 (61.2500) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [20/28] time 0.413 (0.475) data 0.283 (0.345) loss_x loss_x 1.4561 (1.4934) acc_x 68.7500 (60.6250) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/28] time 0.396 (0.473) data 0.265 (0.343) loss_x loss_x 1.0850 (1.4902) acc_x 71.8750 (60.1250) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.2994, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 939
clean true:892
clean false:47
clean_rate:0.9499467518636848
noisy true:496
noisy false:1701
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 2197
epoch [37/200] batch [5/29] time 0.507 (0.516) data 0.377 (0.385) loss_x loss_x 1.6670 (1.5232) acc_x 53.1250 (60.0000) lr 1.8526e-03 eta 0:00:12
epoch [37/200] batch [10/29] time 0.308 (0.464) data 0.178 (0.334) loss_x loss_x 1.0566 (1.4896) acc_x 65.6250 (60.6250) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [15/29] time 0.424 (0.464) data 0.295 (0.334) loss_x loss_x 1.5918 (1.4666) acc_x 62.5000 (60.8333) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [20/29] time 0.409 (0.453) data 0.279 (0.323) loss_x loss_x 1.6943 (1.4967) acc_x 59.3750 (61.2500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [25/29] time 0.414 (0.450) data 0.284 (0.320) loss_x loss_x 1.4453 (1.5477) acc_x 56.2500 (60.2500) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1769
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 943
clean true:894
clean false:49
clean_rate:0.9480381760339343
noisy true:473
noisy false:1720
after delete: len(clean_dataset) 943
after delete: len(noisy_dataset) 2193
epoch [38/200] batch [5/29] time 0.354 (0.405) data 0.224 (0.275) loss_x loss_x 1.3672 (1.5580) acc_x 56.2500 (57.5000) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [10/29] time 0.420 (0.423) data 0.290 (0.293) loss_x loss_x 1.6357 (1.4984) acc_x 59.3750 (60.9375) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [15/29] time 0.432 (0.439) data 0.301 (0.310) loss_x loss_x 1.8467 (1.4550) acc_x 59.3750 (62.0833) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [20/29] time 0.546 (0.446) data 0.417 (0.316) loss_x loss_x 1.9639 (1.4895) acc_x 46.8750 (60.0000) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [25/29] time 0.567 (0.459) data 0.437 (0.329) loss_x loss_x 1.7842 (1.4983) acc_x 56.2500 (60.8750) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1786
confident_label rate tensor(0.2934, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 920
clean true:876
clean false:44
clean_rate:0.9521739130434783
noisy true:474
noisy false:1742
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 2216
epoch [39/200] batch [5/28] time 0.439 (0.457) data 0.309 (0.326) loss_x loss_x 1.4648 (1.4561) acc_x 62.5000 (59.3750) lr 1.8358e-03 eta 0:00:10
epoch [39/200] batch [10/28] time 0.385 (0.455) data 0.255 (0.325) loss_x loss_x 1.5029 (1.4799) acc_x 59.3750 (60.0000) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [15/28] time 0.425 (0.464) data 0.295 (0.333) loss_x loss_x 1.6396 (1.5059) acc_x 56.2500 (60.4167) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [20/28] time 0.421 (0.455) data 0.292 (0.325) loss_x loss_x 1.7637 (1.4833) acc_x 53.1250 (60.3125) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/28] time 0.457 (0.446) data 0.326 (0.316) loss_x loss_x 2.0215 (1.5370) acc_x 50.0000 (60.3750) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1755
confident_label rate tensor(0.2918, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 915
clean true:887
clean false:28
clean_rate:0.9693989071038251
noisy true:494
noisy false:1727
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 2221
epoch [40/200] batch [5/28] time 0.498 (0.500) data 0.368 (0.370) loss_x loss_x 1.0625 (1.3498) acc_x 75.0000 (62.5000) lr 1.8271e-03 eta 0:00:11
epoch [40/200] batch [10/28] time 0.464 (0.478) data 0.335 (0.348) loss_x loss_x 1.3467 (1.4489) acc_x 62.5000 (59.6875) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [15/28] time 0.501 (0.493) data 0.370 (0.364) loss_x loss_x 1.2197 (1.4736) acc_x 62.5000 (59.1667) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [20/28] time 0.386 (0.485) data 0.256 (0.355) loss_x loss_x 0.9775 (1.4620) acc_x 71.8750 (60.0000) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/28] time 0.467 (0.485) data 0.337 (0.355) loss_x loss_x 1.2295 (1.4230) acc_x 68.7500 (62.3750) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1717
confident_label rate tensor(0.3071, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 963
clean true:928
clean false:35
clean_rate:0.9636552440290758
noisy true:491
noisy false:1682
after delete: len(clean_dataset) 963
after delete: len(noisy_dataset) 2173
epoch [41/200] batch [5/30] time 0.457 (0.495) data 0.326 (0.365) loss_x loss_x 1.4248 (1.5789) acc_x 56.2500 (62.5000) lr 1.8181e-03 eta 0:00:12
epoch [41/200] batch [10/30] time 0.664 (0.494) data 0.533 (0.364) loss_x loss_x 1.9414 (1.5379) acc_x 50.0000 (62.5000) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [15/30] time 0.465 (0.487) data 0.335 (0.357) loss_x loss_x 0.7407 (1.4526) acc_x 81.2500 (64.5833) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [20/30] time 0.484 (0.489) data 0.353 (0.359) loss_x loss_x 1.5986 (1.4526) acc_x 62.5000 (63.5938) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [25/30] time 0.632 (0.487) data 0.502 (0.356) loss_x loss_x 1.8633 (1.4806) acc_x 50.0000 (62.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/30] time 0.591 (0.482) data 0.462 (0.352) loss_x loss_x 1.0361 (1.4265) acc_x 71.8750 (63.5417) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1761
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 924
clean true:892
clean false:32
clean_rate:0.9653679653679653
noisy true:483
noisy false:1729
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 2212
epoch [42/200] batch [5/28] time 0.418 (0.458) data 0.287 (0.327) loss_x loss_x 1.3467 (1.2592) acc_x 53.1250 (63.1250) lr 1.8090e-03 eta 0:00:10
epoch [42/200] batch [10/28] time 0.414 (0.455) data 0.284 (0.324) loss_x loss_x 0.9951 (1.3011) acc_x 75.0000 (65.9375) lr 1.8090e-03 eta 0:00:08
epoch [42/200] batch [15/28] time 0.371 (0.458) data 0.241 (0.327) loss_x loss_x 0.9771 (1.3042) acc_x 62.5000 (64.3750) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [20/28] time 0.394 (0.468) data 0.264 (0.337) loss_x loss_x 1.2412 (1.3510) acc_x 71.8750 (64.2188) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/28] time 0.408 (0.455) data 0.278 (0.325) loss_x loss_x 1.4072 (1.3733) acc_x 59.3750 (63.8750) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1692
confident_label rate tensor(0.3195, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1002
clean true:956
clean false:46
clean_rate:0.9540918163672655
noisy true:488
noisy false:1646
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 2134
epoch [43/200] batch [5/31] time 0.417 (0.410) data 0.288 (0.280) loss_x loss_x 1.5215 (1.5020) acc_x 59.3750 (60.6250) lr 1.7997e-03 eta 0:00:10
epoch [43/200] batch [10/31] time 0.644 (0.468) data 0.513 (0.338) loss_x loss_x 1.9424 (1.5256) acc_x 50.0000 (61.5625) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [15/31] time 0.408 (0.457) data 0.278 (0.327) loss_x loss_x 1.1611 (1.4922) acc_x 68.7500 (61.8750) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [20/31] time 0.359 (0.453) data 0.229 (0.323) loss_x loss_x 1.8350 (1.5223) acc_x 50.0000 (60.6250) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [25/31] time 0.463 (0.459) data 0.332 (0.329) loss_x loss_x 1.2646 (1.4668) acc_x 59.3750 (61.2500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/31] time 0.396 (0.459) data 0.267 (0.329) loss_x loss_x 1.7412 (1.4542) acc_x 62.5000 (62.1875) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.3151, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 988
clean true:937
clean false:51
clean_rate:0.9483805668016194
noisy true:497
noisy false:1651
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 2148
epoch [44/200] batch [5/30] time 0.486 (0.516) data 0.356 (0.386) loss_x loss_x 1.1943 (1.4443) acc_x 62.5000 (65.6250) lr 1.7902e-03 eta 0:00:12
epoch [44/200] batch [10/30] time 0.430 (0.483) data 0.300 (0.353) loss_x loss_x 1.5430 (1.4105) acc_x 56.2500 (65.3125) lr 1.7902e-03 eta 0:00:09
epoch [44/200] batch [15/30] time 0.448 (0.472) data 0.318 (0.342) loss_x loss_x 1.0674 (1.3833) acc_x 78.1250 (65.8333) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [20/30] time 0.467 (0.477) data 0.337 (0.347) loss_x loss_x 1.3740 (1.4424) acc_x 68.7500 (64.6875) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/30] time 0.369 (0.467) data 0.239 (0.337) loss_x loss_x 1.4961 (1.4417) acc_x 65.6250 (64.0000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/30] time 0.409 (0.463) data 0.279 (0.333) loss_x loss_x 0.9546 (1.4293) acc_x 71.8750 (63.6458) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1717
confident_label rate tensor(0.3061, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 960
clean true:905
clean false:55
clean_rate:0.9427083333333334
noisy true:514
noisy false:1662
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 2176
epoch [45/200] batch [5/30] time 0.485 (0.459) data 0.355 (0.329) loss_x loss_x 1.7646 (1.4084) acc_x 65.6250 (62.5000) lr 1.7804e-03 eta 0:00:11
epoch [45/200] batch [10/30] time 0.327 (0.448) data 0.197 (0.319) loss_x loss_x 1.3594 (1.4931) acc_x 65.6250 (60.9375) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [15/30] time 0.387 (0.442) data 0.257 (0.312) loss_x loss_x 1.3125 (1.4735) acc_x 65.6250 (61.8750) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [20/30] time 0.378 (0.448) data 0.248 (0.318) loss_x loss_x 1.3721 (1.4727) acc_x 65.6250 (61.8750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [25/30] time 0.448 (0.450) data 0.318 (0.320) loss_x loss_x 1.4648 (1.4633) acc_x 59.3750 (62.0000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/30] time 0.394 (0.461) data 0.263 (0.331) loss_x loss_x 1.2666 (1.4497) acc_x 71.8750 (62.5000) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1718
confident_label rate tensor(0.3103, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 973
clean true:936
clean false:37
clean_rate:0.9619732785200411
noisy true:482
noisy false:1681
after delete: len(clean_dataset) 973
after delete: len(noisy_dataset) 2163
epoch [46/200] batch [5/30] time 0.550 (0.489) data 0.420 (0.359) loss_x loss_x 1.6865 (1.4281) acc_x 62.5000 (61.8750) lr 1.7705e-03 eta 0:00:12
epoch [46/200] batch [10/30] time 0.369 (0.467) data 0.239 (0.337) loss_x loss_x 1.4424 (1.4068) acc_x 62.5000 (63.1250) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [15/30] time 0.377 (0.450) data 0.247 (0.320) loss_x loss_x 1.2979 (1.4415) acc_x 68.7500 (62.5000) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [20/30] time 0.484 (0.464) data 0.354 (0.334) loss_x loss_x 1.5889 (1.4591) acc_x 65.6250 (62.1875) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [25/30] time 0.383 (0.455) data 0.253 (0.324) loss_x loss_x 1.4756 (1.4368) acc_x 62.5000 (62.0000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/30] time 0.466 (0.455) data 0.336 (0.325) loss_x loss_x 1.5332 (1.4617) acc_x 56.2500 (61.4583) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1748
confident_label rate tensor(0.2988, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 937
clean true:890
clean false:47
clean_rate:0.9498399146211313
noisy true:498
noisy false:1701
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 2199
epoch [47/200] batch [5/29] time 0.547 (0.435) data 0.416 (0.305) loss_x loss_x 1.4746 (1.4100) acc_x 50.0000 (61.8750) lr 1.7604e-03 eta 0:00:10
epoch [47/200] batch [10/29] time 0.420 (0.436) data 0.290 (0.306) loss_x loss_x 1.3994 (1.5149) acc_x 68.7500 (61.2500) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [15/29] time 0.484 (0.425) data 0.354 (0.295) loss_x loss_x 1.7725 (1.5419) acc_x 56.2500 (61.2500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/29] time 0.485 (0.437) data 0.355 (0.307) loss_x loss_x 1.4756 (1.4979) acc_x 59.3750 (61.5625) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/29] time 0.513 (0.441) data 0.382 (0.310) loss_x loss_x 1.1357 (1.4700) acc_x 65.6250 (61.8750) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1722
confident_label rate tensor(0.3109, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 975
clean true:924
clean false:51
clean_rate:0.9476923076923077
noisy true:490
noisy false:1671
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 2161
epoch [48/200] batch [5/30] time 0.495 (0.453) data 0.365 (0.323) loss_x loss_x 1.5254 (1.3396) acc_x 56.2500 (66.8750) lr 1.7501e-03 eta 0:00:11
epoch [48/200] batch [10/30] time 0.392 (0.444) data 0.262 (0.313) loss_x loss_x 1.7412 (1.4291) acc_x 59.3750 (65.6250) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [15/30] time 0.367 (0.432) data 0.236 (0.301) loss_x loss_x 1.1240 (1.4384) acc_x 65.6250 (64.7917) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [20/30] time 0.441 (0.442) data 0.311 (0.311) loss_x loss_x 1.5645 (1.4264) acc_x 53.1250 (64.6875) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [25/30] time 0.458 (0.443) data 0.328 (0.312) loss_x loss_x 1.3857 (1.4433) acc_x 62.5000 (63.8750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/30] time 0.512 (0.445) data 0.382 (0.314) loss_x loss_x 1.2910 (1.4500) acc_x 75.0000 (63.6458) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1751
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 955
clean true:906
clean false:49
clean_rate:0.9486910994764398
noisy true:479
noisy false:1702
after delete: len(clean_dataset) 955
after delete: len(noisy_dataset) 2181
epoch [49/200] batch [5/29] time 0.461 (0.460) data 0.331 (0.330) loss_x loss_x 1.5879 (1.3346) acc_x 65.6250 (66.2500) lr 1.7396e-03 eta 0:00:11
epoch [49/200] batch [10/29] time 0.406 (0.444) data 0.276 (0.314) loss_x loss_x 1.4287 (1.3542) acc_x 65.6250 (64.6875) lr 1.7396e-03 eta 0:00:08
epoch [49/200] batch [15/29] time 0.375 (0.454) data 0.245 (0.324) loss_x loss_x 1.4414 (1.2959) acc_x 71.8750 (66.2500) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [20/29] time 0.378 (0.454) data 0.248 (0.324) loss_x loss_x 1.7129 (1.3271) acc_x 65.6250 (66.2500) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [25/29] time 0.391 (0.454) data 0.261 (0.324) loss_x loss_x 1.3555 (1.3799) acc_x 62.5000 (64.6250) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1731
confident_label rate tensor(0.3055, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 958
clean true:908
clean false:50
clean_rate:0.9478079331941545
noisy true:497
noisy false:1681
after delete: len(clean_dataset) 958
after delete: len(noisy_dataset) 2178
epoch [50/200] batch [5/29] time 0.497 (0.498) data 0.367 (0.368) loss_x loss_x 1.2334 (1.3697) acc_x 65.6250 (65.0000) lr 1.7290e-03 eta 0:00:11
epoch [50/200] batch [10/29] time 0.468 (0.471) data 0.338 (0.341) loss_x loss_x 1.6191 (1.4244) acc_x 59.3750 (61.8750) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [15/29] time 0.378 (0.471) data 0.247 (0.340) loss_x loss_x 1.8027 (1.4240) acc_x 53.1250 (61.6667) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [20/29] time 0.359 (0.454) data 0.229 (0.323) loss_x loss_x 1.9395 (1.4379) acc_x 53.1250 (61.2500) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [25/29] time 0.526 (0.462) data 0.395 (0.331) loss_x loss_x 1.5537 (1.4743) acc_x 62.5000 (60.8750) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1716
confident_label rate tensor(0.3147, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 987
clean true:938
clean false:49
clean_rate:0.950354609929078
noisy true:482
noisy false:1667
after delete: len(clean_dataset) 987
after delete: len(noisy_dataset) 2149
epoch [51/200] batch [5/30] time 0.448 (0.451) data 0.317 (0.321) loss_x loss_x 2.1133 (1.5006) acc_x 46.8750 (61.8750) lr 1.7181e-03 eta 0:00:11
epoch [51/200] batch [10/30] time 0.458 (0.455) data 0.328 (0.325) loss_x loss_x 1.5645 (1.5714) acc_x 62.5000 (57.8125) lr 1.7181e-03 eta 0:00:09
epoch [51/200] batch [15/30] time 0.421 (0.450) data 0.291 (0.320) loss_x loss_x 1.3701 (1.5137) acc_x 71.8750 (61.2500) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [20/30] time 0.450 (0.451) data 0.319 (0.321) loss_x loss_x 1.3828 (1.5418) acc_x 53.1250 (59.8438) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [25/30] time 0.469 (0.458) data 0.339 (0.328) loss_x loss_x 1.3496 (1.6008) acc_x 62.5000 (59.3750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/30] time 0.479 (0.464) data 0.349 (0.334) loss_x loss_x 1.2266 (1.5547) acc_x 68.7500 (60.6250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1736
confident_label rate tensor(0.3077, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 965
clean true:917
clean false:48
clean_rate:0.950259067357513
noisy true:483
noisy false:1688
after delete: len(clean_dataset) 965
after delete: len(noisy_dataset) 2171
epoch [52/200] batch [5/30] time 0.454 (0.426) data 0.325 (0.296) loss_x loss_x 1.4414 (1.6350) acc_x 59.3750 (57.5000) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [10/30] time 0.485 (0.452) data 0.354 (0.322) loss_x loss_x 1.0947 (1.4117) acc_x 68.7500 (62.5000) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [15/30] time 0.479 (0.456) data 0.348 (0.326) loss_x loss_x 1.8643 (1.4014) acc_x 56.2500 (62.5000) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [20/30] time 0.384 (0.468) data 0.254 (0.337) loss_x loss_x 1.3887 (1.3969) acc_x 59.3750 (62.9688) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [25/30] time 0.446 (0.472) data 0.316 (0.341) loss_x loss_x 1.0742 (1.3903) acc_x 75.0000 (63.6250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/30] time 0.388 (0.466) data 0.259 (0.336) loss_x loss_x 1.5283 (1.4036) acc_x 62.5000 (63.0208) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 982
clean true:934
clean false:48
clean_rate:0.9511201629327902
noisy true:477
noisy false:1677
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 2154
epoch [53/200] batch [5/30] time 0.451 (0.467) data 0.320 (0.337) loss_x loss_x 1.7969 (1.4289) acc_x 50.0000 (60.6250) lr 1.6959e-03 eta 0:00:11
epoch [53/200] batch [10/30] time 0.505 (0.451) data 0.376 (0.321) loss_x loss_x 1.2070 (1.5560) acc_x 59.3750 (58.4375) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [15/30] time 0.473 (0.453) data 0.343 (0.323) loss_x loss_x 1.0400 (1.4988) acc_x 75.0000 (60.2083) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [20/30] time 0.483 (0.462) data 0.352 (0.332) loss_x loss_x 1.4043 (1.4530) acc_x 59.3750 (61.5625) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [25/30] time 0.399 (0.462) data 0.268 (0.332) loss_x loss_x 1.5820 (1.4304) acc_x 50.0000 (61.7500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [30/30] time 0.349 (0.451) data 0.219 (0.321) loss_x loss_x 1.6016 (1.4593) acc_x 59.3750 (61.5625) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1682
confident_label rate tensor(0.3157, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 990
clean true:946
clean false:44
clean_rate:0.9555555555555556
noisy true:508
noisy false:1638
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 2146
epoch [54/200] batch [5/30] time 0.450 (0.460) data 0.319 (0.330) loss_x loss_x 1.4697 (1.3719) acc_x 59.3750 (63.1250) lr 1.6845e-03 eta 0:00:11
epoch [54/200] batch [10/30] time 0.499 (0.474) data 0.369 (0.344) loss_x loss_x 1.3730 (1.5404) acc_x 56.2500 (59.3750) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [15/30] time 0.556 (0.477) data 0.427 (0.347) loss_x loss_x 1.5840 (1.5695) acc_x 68.7500 (60.6250) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [20/30] time 0.472 (0.475) data 0.342 (0.345) loss_x loss_x 1.8457 (1.5040) acc_x 37.5000 (60.9375) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [25/30] time 0.481 (0.476) data 0.352 (0.346) loss_x loss_x 0.9023 (1.4991) acc_x 75.0000 (61.7500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/30] time 0.414 (0.469) data 0.284 (0.339) loss_x loss_x 1.4316 (1.5102) acc_x 71.8750 (61.5625) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1718
confident_label rate tensor(0.3096, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 971
clean true:924
clean false:47
clean_rate:0.9515962924819773
noisy true:494
noisy false:1671
after delete: len(clean_dataset) 971
after delete: len(noisy_dataset) 2165
epoch [55/200] batch [5/30] time 0.358 (0.445) data 0.227 (0.315) loss_x loss_x 1.2588 (1.2472) acc_x 71.8750 (61.8750) lr 1.6730e-03 eta 0:00:11
epoch [55/200] batch [10/30] time 0.353 (0.442) data 0.223 (0.311) loss_x loss_x 1.6152 (1.2516) acc_x 46.8750 (65.9375) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [15/30] time 0.423 (0.449) data 0.293 (0.319) loss_x loss_x 1.9004 (1.3146) acc_x 59.3750 (65.8333) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [20/30] time 0.568 (0.469) data 0.437 (0.339) loss_x loss_x 1.3711 (1.3011) acc_x 50.0000 (65.1562) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [25/30] time 0.599 (0.465) data 0.468 (0.335) loss_x loss_x 1.7705 (1.3430) acc_x 59.3750 (65.2500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/30] time 0.417 (0.462) data 0.287 (0.331) loss_x loss_x 1.3701 (1.3259) acc_x 59.3750 (65.1042) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1715
confident_label rate tensor(0.3077, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 965
clean true:920
clean false:45
clean_rate:0.9533678756476683
noisy true:501
noisy false:1670
after delete: len(clean_dataset) 965
after delete: len(noisy_dataset) 2171
epoch [56/200] batch [5/30] time 0.438 (0.480) data 0.308 (0.349) loss_x loss_x 1.0166 (1.3342) acc_x 68.7500 (67.5000) lr 1.6613e-03 eta 0:00:11
epoch [56/200] batch [10/30] time 0.383 (0.480) data 0.252 (0.350) loss_x loss_x 1.1943 (1.3525) acc_x 59.3750 (63.7500) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [15/30] time 0.591 (0.483) data 0.459 (0.352) loss_x loss_x 1.2344 (1.3383) acc_x 71.8750 (65.6250) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [20/30] time 0.394 (0.477) data 0.263 (0.346) loss_x loss_x 1.2627 (1.3435) acc_x 62.5000 (65.6250) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/30] time 0.506 (0.471) data 0.376 (0.341) loss_x loss_x 1.7461 (1.3783) acc_x 53.1250 (64.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/30] time 0.369 (0.460) data 0.239 (0.330) loss_x loss_x 1.3496 (1.3828) acc_x 71.8750 (64.4792) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1725
confident_label rate tensor(0.3052, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 957
clean true:916
clean false:41
clean_rate:0.9571577847439916
noisy true:495
noisy false:1684
after delete: len(clean_dataset) 957
after delete: len(noisy_dataset) 2179
epoch [57/200] batch [5/29] time 0.414 (0.414) data 0.284 (0.284) loss_x loss_x 1.6553 (1.4676) acc_x 62.5000 (59.3750) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [10/29] time 0.399 (0.457) data 0.270 (0.328) loss_x loss_x 1.2236 (1.3679) acc_x 81.2500 (64.6875) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [15/29] time 0.438 (0.467) data 0.307 (0.337) loss_x loss_x 1.1914 (1.3584) acc_x 75.0000 (64.3750) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [20/29] time 0.472 (0.458) data 0.341 (0.328) loss_x loss_x 1.0986 (1.3368) acc_x 68.7500 (63.7500) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [25/29] time 0.408 (0.454) data 0.277 (0.324) loss_x loss_x 1.3691 (1.3805) acc_x 59.3750 (62.8750) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1703
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1007
clean true:960
clean false:47
clean_rate:0.9533267130089375
noisy true:473
noisy false:1656
after delete: len(clean_dataset) 1007
after delete: len(noisy_dataset) 2129
epoch [58/200] batch [5/31] time 0.478 (0.471) data 0.347 (0.341) loss_x loss_x 1.1943 (1.2578) acc_x 65.6250 (63.7500) lr 1.6374e-03 eta 0:00:12
epoch [58/200] batch [10/31] time 0.384 (0.458) data 0.254 (0.327) loss_x loss_x 1.0488 (1.2696) acc_x 68.7500 (65.0000) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [15/31] time 0.369 (0.446) data 0.239 (0.316) loss_x loss_x 1.5742 (1.3174) acc_x 56.2500 (64.7917) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [20/31] time 0.508 (0.448) data 0.378 (0.318) loss_x loss_x 1.0156 (1.3531) acc_x 71.8750 (64.2188) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [25/31] time 0.590 (0.455) data 0.460 (0.325) loss_x loss_x 1.4707 (1.3861) acc_x 56.2500 (63.3750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/31] time 0.549 (0.459) data 0.419 (0.329) loss_x loss_x 1.2979 (1.3960) acc_x 56.2500 (62.2917) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1721
confident_label rate tensor(0.3138, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 984
clean true:938
clean false:46
clean_rate:0.9532520325203252
noisy true:477
noisy false:1675
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 2152
epoch [59/200] batch [5/30] time 0.377 (0.423) data 0.246 (0.293) loss_x loss_x 1.4746 (1.5641) acc_x 50.0000 (60.6250) lr 1.6252e-03 eta 0:00:10
epoch [59/200] batch [10/30] time 0.403 (0.434) data 0.273 (0.304) loss_x loss_x 1.4541 (1.4629) acc_x 59.3750 (62.8125) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [15/30] time 0.392 (0.449) data 0.262 (0.319) loss_x loss_x 1.9355 (1.5239) acc_x 53.1250 (60.6250) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [20/30] time 0.459 (0.460) data 0.330 (0.330) loss_x loss_x 1.0352 (1.4612) acc_x 71.8750 (61.8750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [25/30] time 0.452 (0.460) data 0.322 (0.330) loss_x loss_x 1.0410 (1.4494) acc_x 81.2500 (62.7500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [30/30] time 0.408 (0.460) data 0.278 (0.330) loss_x loss_x 1.5811 (1.4373) acc_x 62.5000 (63.1250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1708
confident_label rate tensor(0.3179, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 997
clean true:947
clean false:50
clean_rate:0.9498495486459378
noisy true:481
noisy false:1658
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 2139
epoch [60/200] batch [5/31] time 0.437 (0.497) data 0.307 (0.367) loss_x loss_x 1.4248 (1.2793) acc_x 62.5000 (68.1250) lr 1.6129e-03 eta 0:00:12
epoch [60/200] batch [10/31] time 0.443 (0.503) data 0.313 (0.372) loss_x loss_x 1.4404 (1.2942) acc_x 75.0000 (70.0000) lr 1.6129e-03 eta 0:00:10
epoch [60/200] batch [15/31] time 0.522 (0.489) data 0.392 (0.359) loss_x loss_x 1.0947 (1.3881) acc_x 75.0000 (67.7083) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [20/31] time 0.420 (0.468) data 0.291 (0.338) loss_x loss_x 1.9492 (1.4881) acc_x 62.5000 (65.0000) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [25/31] time 0.522 (0.465) data 0.392 (0.335) loss_x loss_x 1.5820 (1.5012) acc_x 62.5000 (63.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/31] time 0.461 (0.463) data 0.331 (0.333) loss_x loss_x 1.0117 (1.4927) acc_x 81.2500 (64.3750) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.3173, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 995
clean true:935
clean false:60
clean_rate:0.9396984924623115
noisy true:499
noisy false:1642
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 2141
epoch [61/200] batch [5/31] time 0.445 (0.472) data 0.314 (0.342) loss_x loss_x 1.6475 (1.3787) acc_x 53.1250 (60.6250) lr 1.6004e-03 eta 0:00:12
epoch [61/200] batch [10/31] time 0.422 (0.433) data 0.292 (0.304) loss_x loss_x 1.3018 (1.4146) acc_x 62.5000 (63.1250) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [15/31] time 0.450 (0.454) data 0.320 (0.324) loss_x loss_x 1.4365 (1.3732) acc_x 65.6250 (63.3333) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [20/31] time 0.344 (0.445) data 0.214 (0.315) loss_x loss_x 1.3711 (1.3832) acc_x 62.5000 (63.9062) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [25/31] time 0.355 (0.442) data 0.225 (0.312) loss_x loss_x 1.5439 (1.3945) acc_x 59.3750 (64.0000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/31] time 0.412 (0.450) data 0.281 (0.320) loss_x loss_x 1.6387 (1.3968) acc_x 56.2500 (63.3333) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1709
confident_label rate tensor(0.3128, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 981
clean true:931
clean false:50
clean_rate:0.9490316004077471
noisy true:496
noisy false:1659
after delete: len(clean_dataset) 981
after delete: len(noisy_dataset) 2155
epoch [62/200] batch [5/30] time 0.427 (0.446) data 0.297 (0.316) loss_x loss_x 1.6074 (1.3826) acc_x 65.6250 (64.3750) lr 1.5878e-03 eta 0:00:11
epoch [62/200] batch [10/30] time 0.416 (0.450) data 0.286 (0.319) loss_x loss_x 1.4229 (1.4134) acc_x 68.7500 (65.9375) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [15/30] time 0.511 (0.459) data 0.380 (0.328) loss_x loss_x 1.2285 (1.3407) acc_x 71.8750 (66.6667) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [20/30] time 0.465 (0.456) data 0.335 (0.325) loss_x loss_x 1.9492 (1.4191) acc_x 43.7500 (63.9062) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [25/30] time 0.407 (0.457) data 0.276 (0.327) loss_x loss_x 1.3223 (1.3970) acc_x 56.2500 (64.5000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/30] time 0.494 (0.457) data 0.364 (0.326) loss_x loss_x 1.8848 (1.4123) acc_x 53.1250 (64.1667) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1714
confident_label rate tensor(0.3128, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 981
clean true:931
clean false:50
clean_rate:0.9490316004077471
noisy true:491
noisy false:1664
after delete: len(clean_dataset) 981
after delete: len(noisy_dataset) 2155
epoch [63/200] batch [5/30] time 0.430 (0.399) data 0.300 (0.269) loss_x loss_x 1.1631 (1.3266) acc_x 75.0000 (68.7500) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [10/30] time 0.393 (0.443) data 0.262 (0.313) loss_x loss_x 1.4473 (1.3504) acc_x 68.7500 (66.2500) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [15/30] time 0.642 (0.457) data 0.511 (0.327) loss_x loss_x 1.1504 (1.3794) acc_x 78.1250 (66.4583) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [20/30] time 0.487 (0.464) data 0.356 (0.334) loss_x loss_x 1.8184 (1.3929) acc_x 50.0000 (64.6875) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [25/30] time 0.400 (0.458) data 0.270 (0.328) loss_x loss_x 1.6230 (1.3831) acc_x 53.1250 (64.0000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [30/30] time 0.412 (0.461) data 0.281 (0.331) loss_x loss_x 0.8901 (1.3929) acc_x 78.1250 (64.3750) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1680
confident_label rate tensor(0.3195, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1002
clean true:949
clean false:53
clean_rate:0.9471057884231537
noisy true:507
noisy false:1627
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 2134
epoch [64/200] batch [5/31] time 0.467 (0.466) data 0.336 (0.336) loss_x loss_x 1.1133 (1.4541) acc_x 68.7500 (60.0000) lr 1.5621e-03 eta 0:00:12
epoch [64/200] batch [10/31] time 0.428 (0.464) data 0.298 (0.334) loss_x loss_x 1.0156 (1.3866) acc_x 71.8750 (62.5000) lr 1.5621e-03 eta 0:00:09
epoch [64/200] batch [15/31] time 0.465 (0.462) data 0.335 (0.332) loss_x loss_x 1.1670 (1.4202) acc_x 68.7500 (61.6667) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [20/31] time 0.371 (0.453) data 0.242 (0.323) loss_x loss_x 1.0352 (1.3505) acc_x 71.8750 (63.9062) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [25/31] time 0.449 (0.452) data 0.319 (0.322) loss_x loss_x 1.5410 (1.4060) acc_x 65.6250 (63.5000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/31] time 0.512 (0.466) data 0.382 (0.336) loss_x loss_x 1.2393 (1.3700) acc_x 65.6250 (63.9583) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1681
confident_label rate tensor(0.3186, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 999
clean true:951
clean false:48
clean_rate:0.9519519519519519
noisy true:504
noisy false:1633
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 2137
epoch [65/200] batch [5/31] time 0.567 (0.474) data 0.436 (0.343) loss_x loss_x 1.8193 (1.4576) acc_x 56.2500 (65.6250) lr 1.5490e-03 eta 0:00:12
epoch [65/200] batch [10/31] time 0.443 (0.466) data 0.313 (0.335) loss_x loss_x 1.3740 (1.3904) acc_x 65.6250 (67.8125) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [15/31] time 0.516 (0.465) data 0.385 (0.335) loss_x loss_x 1.8457 (1.4297) acc_x 62.5000 (66.0417) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [20/31] time 0.412 (0.460) data 0.281 (0.330) loss_x loss_x 1.2871 (1.4439) acc_x 75.0000 (65.9375) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [25/31] time 0.533 (0.465) data 0.402 (0.335) loss_x loss_x 1.2158 (1.4185) acc_x 65.6250 (65.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/31] time 0.431 (0.463) data 0.300 (0.333) loss_x loss_x 1.5498 (1.4104) acc_x 68.7500 (66.0417) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1667
confident_label rate tensor(0.3246, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1018
clean true:971
clean false:47
clean_rate:0.9538310412573674
noisy true:498
noisy false:1620
after delete: len(clean_dataset) 1018
after delete: len(noisy_dataset) 2118
epoch [66/200] batch [5/31] time 0.387 (0.423) data 0.257 (0.293) loss_x loss_x 1.7021 (1.3247) acc_x 46.8750 (66.8750) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [10/31] time 0.370 (0.450) data 0.239 (0.319) loss_x loss_x 2.2109 (1.5611) acc_x 50.0000 (60.9375) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [15/31] time 0.421 (0.441) data 0.291 (0.311) loss_x loss_x 1.4590 (1.5344) acc_x 65.6250 (60.4167) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [20/31] time 0.411 (0.450) data 0.282 (0.320) loss_x loss_x 1.5713 (1.4918) acc_x 65.6250 (62.9688) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [25/31] time 0.322 (0.446) data 0.193 (0.316) loss_x loss_x 1.6426 (1.4713) acc_x 56.2500 (64.2500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/31] time 0.434 (0.447) data 0.303 (0.317) loss_x loss_x 1.9072 (1.4991) acc_x 53.1250 (63.0208) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1028
clean true:974
clean false:54
clean_rate:0.9474708171206225
noisy true:497
noisy false:1611
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 2108
epoch [67/200] batch [5/32] time 0.394 (0.485) data 0.264 (0.355) loss_x loss_x 1.6299 (1.5672) acc_x 53.1250 (56.2500) lr 1.5225e-03 eta 0:00:13
epoch [67/200] batch [10/32] time 0.333 (0.432) data 0.203 (0.302) loss_x loss_x 1.2012 (1.4973) acc_x 71.8750 (60.0000) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [15/32] time 0.374 (0.446) data 0.245 (0.316) loss_x loss_x 1.1064 (1.4485) acc_x 68.7500 (62.0833) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [20/32] time 0.485 (0.450) data 0.354 (0.321) loss_x loss_x 1.4873 (1.3737) acc_x 59.3750 (64.0625) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [25/32] time 0.407 (0.453) data 0.277 (0.323) loss_x loss_x 1.5371 (1.3890) acc_x 62.5000 (63.1250) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [30/32] time 0.383 (0.448) data 0.254 (0.318) loss_x loss_x 1.6113 (1.4100) acc_x 59.3750 (61.8750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.3186, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 999
clean true:962
clean false:37
clean_rate:0.9629629629629629
noisy true:517
noisy false:1620
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 2137
epoch [68/200] batch [5/31] time 0.434 (0.486) data 0.303 (0.355) loss_x loss_x 1.0391 (1.2461) acc_x 71.8750 (66.8750) lr 1.5090e-03 eta 0:00:12
epoch [68/200] batch [10/31] time 0.462 (0.504) data 0.332 (0.374) loss_x loss_x 1.0156 (1.3845) acc_x 75.0000 (62.8125) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [15/31] time 0.518 (0.488) data 0.388 (0.358) loss_x loss_x 1.2949 (1.4185) acc_x 65.6250 (62.9167) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [20/31] time 0.454 (0.470) data 0.325 (0.340) loss_x loss_x 1.0215 (1.4272) acc_x 75.0000 (63.1250) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [25/31] time 0.430 (0.464) data 0.301 (0.334) loss_x loss_x 1.5586 (1.4054) acc_x 62.5000 (63.8750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/31] time 0.475 (0.465) data 0.346 (0.335) loss_x loss_x 1.2871 (1.4165) acc_x 50.0000 (62.7083) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1657
confident_label rate tensor(0.3227, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1012
clean true:963
clean false:49
clean_rate:0.9515810276679841
noisy true:516
noisy false:1608
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 2124
epoch [69/200] batch [5/31] time 0.424 (0.456) data 0.293 (0.326) loss_x loss_x 1.2246 (1.2295) acc_x 59.3750 (68.1250) lr 1.4955e-03 eta 0:00:11
epoch [69/200] batch [10/31] time 0.507 (0.460) data 0.377 (0.329) loss_x loss_x 1.4824 (1.3241) acc_x 68.7500 (67.8125) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [15/31] time 0.455 (0.450) data 0.325 (0.320) loss_x loss_x 1.3838 (1.3904) acc_x 65.6250 (66.2500) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [20/31] time 0.474 (0.455) data 0.343 (0.324) loss_x loss_x 1.4707 (1.3729) acc_x 62.5000 (67.0312) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [25/31] time 0.400 (0.463) data 0.269 (0.333) loss_x loss_x 1.4697 (1.3879) acc_x 59.3750 (65.8750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/31] time 0.460 (0.456) data 0.330 (0.326) loss_x loss_x 1.4395 (1.4010) acc_x 65.6250 (65.9375) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1668
confident_label rate tensor(0.3240, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1016
clean true:971
clean false:45
clean_rate:0.9557086614173228
noisy true:497
noisy false:1623
after delete: len(clean_dataset) 1016
after delete: len(noisy_dataset) 2120
epoch [70/200] batch [5/31] time 0.485 (0.432) data 0.354 (0.301) loss_x loss_x 1.1660 (1.4688) acc_x 68.7500 (61.8750) lr 1.4818e-03 eta 0:00:11
epoch [70/200] batch [10/31] time 0.543 (0.460) data 0.412 (0.329) loss_x loss_x 0.7285 (1.4518) acc_x 84.3750 (62.8125) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [15/31] time 0.427 (0.450) data 0.297 (0.320) loss_x loss_x 1.5186 (1.4871) acc_x 59.3750 (62.2917) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [20/31] time 0.413 (0.443) data 0.283 (0.313) loss_x loss_x 1.1123 (1.4850) acc_x 75.0000 (62.8125) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [25/31] time 0.442 (0.438) data 0.311 (0.308) loss_x loss_x 1.2021 (1.4850) acc_x 71.8750 (62.7500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/31] time 0.368 (0.439) data 0.238 (0.308) loss_x loss_x 1.7070 (1.4623) acc_x 59.3750 (63.7500) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1668
confident_label rate tensor(0.3214, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1008
clean true:967
clean false:41
clean_rate:0.9593253968253969
noisy true:501
noisy false:1627
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 2128
epoch [71/200] batch [5/31] time 0.471 (0.491) data 0.341 (0.360) loss_x loss_x 1.4150 (1.5172) acc_x 59.3750 (65.0000) lr 1.4679e-03 eta 0:00:12
epoch [71/200] batch [10/31] time 0.357 (0.478) data 0.227 (0.348) loss_x loss_x 1.4873 (1.5522) acc_x 56.2500 (60.9375) lr 1.4679e-03 eta 0:00:10
epoch [71/200] batch [15/31] time 0.456 (0.481) data 0.326 (0.351) loss_x loss_x 1.5195 (1.5682) acc_x 56.2500 (59.3750) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [20/31] time 0.363 (0.461) data 0.233 (0.331) loss_x loss_x 1.4707 (1.5093) acc_x 59.3750 (61.0938) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [25/31] time 0.451 (0.466) data 0.321 (0.336) loss_x loss_x 1.4854 (1.4948) acc_x 59.3750 (61.5000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/31] time 0.591 (0.464) data 0.461 (0.334) loss_x loss_x 2.0898 (1.5063) acc_x 50.0000 (61.3542) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1686
confident_label rate tensor(0.3198, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1003
clean true:958
clean false:45
clean_rate:0.9551345962113659
noisy true:492
noisy false:1641
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 2133
epoch [72/200] batch [5/31] time 0.575 (0.478) data 0.445 (0.348) loss_x loss_x 1.2334 (1.3209) acc_x 71.8750 (63.1250) lr 1.4540e-03 eta 0:00:12
epoch [72/200] batch [10/31] time 0.545 (0.463) data 0.416 (0.333) loss_x loss_x 1.4619 (1.4043) acc_x 59.3750 (63.4375) lr 1.4540e-03 eta 0:00:09
epoch [72/200] batch [15/31] time 0.540 (0.461) data 0.410 (0.331) loss_x loss_x 1.1074 (1.3411) acc_x 62.5000 (63.5417) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [20/31] time 0.466 (0.468) data 0.335 (0.338) loss_x loss_x 1.3389 (1.3466) acc_x 65.6250 (63.2812) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [25/31] time 0.460 (0.457) data 0.329 (0.327) loss_x loss_x 1.1631 (1.3710) acc_x 62.5000 (63.2500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/31] time 0.557 (0.467) data 0.426 (0.337) loss_x loss_x 0.9360 (1.3719) acc_x 59.3750 (62.9167) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1686
confident_label rate tensor(0.3154, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 989
clean true:932
clean false:57
clean_rate:0.942366026289181
noisy true:518
noisy false:1629
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 2147
epoch [73/200] batch [5/30] time 0.413 (0.475) data 0.282 (0.345) loss_x loss_x 0.7861 (1.3334) acc_x 84.3750 (66.8750) lr 1.4399e-03 eta 0:00:11
epoch [73/200] batch [10/30] time 0.578 (0.491) data 0.448 (0.360) loss_x loss_x 2.0430 (1.4517) acc_x 56.2500 (63.7500) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [15/30] time 0.431 (0.475) data 0.301 (0.345) loss_x loss_x 1.5674 (1.4338) acc_x 59.3750 (63.3333) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [20/30] time 0.338 (0.453) data 0.207 (0.323) loss_x loss_x 2.1504 (1.4635) acc_x 43.7500 (62.8125) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [25/30] time 0.512 (0.458) data 0.382 (0.328) loss_x loss_x 1.1475 (1.4430) acc_x 68.7500 (63.0000) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [30/30] time 0.401 (0.459) data 0.271 (0.329) loss_x loss_x 1.3809 (1.4638) acc_x 71.8750 (63.3333) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1648
confident_label rate tensor(0.3259, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1022
clean true:967
clean false:55
clean_rate:0.9461839530332681
noisy true:521
noisy false:1593
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 2114
epoch [74/200] batch [5/31] time 0.359 (0.401) data 0.229 (0.270) loss_x loss_x 1.4385 (1.4314) acc_x 59.3750 (60.6250) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [10/31] time 0.432 (0.451) data 0.301 (0.321) loss_x loss_x 1.2539 (1.3296) acc_x 75.0000 (64.0625) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [15/31] time 0.350 (0.459) data 0.219 (0.328) loss_x loss_x 1.4150 (1.3486) acc_x 62.5000 (64.3750) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [20/31] time 0.483 (0.460) data 0.353 (0.329) loss_x loss_x 1.4355 (1.3972) acc_x 59.3750 (63.4375) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [25/31] time 0.374 (0.456) data 0.244 (0.326) loss_x loss_x 1.5225 (1.4325) acc_x 59.3750 (63.3750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [30/31] time 0.435 (0.454) data 0.306 (0.323) loss_x loss_x 1.1611 (1.3749) acc_x 62.5000 (64.4792) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1013
clean true:977
clean false:36
clean_rate:0.9644619940769991
noisy true:490
noisy false:1633
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 2123
epoch [75/200] batch [5/31] time 0.459 (0.477) data 0.329 (0.347) loss_x loss_x 1.3145 (1.6576) acc_x 68.7500 (63.1250) lr 1.4115e-03 eta 0:00:12
epoch [75/200] batch [10/31] time 0.428 (0.490) data 0.297 (0.360) loss_x loss_x 1.6484 (1.4862) acc_x 56.2500 (63.1250) lr 1.4115e-03 eta 0:00:10
epoch [75/200] batch [15/31] time 0.499 (0.474) data 0.368 (0.343) loss_x loss_x 1.9756 (1.4381) acc_x 56.2500 (64.5833) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [20/31] time 0.438 (0.461) data 0.308 (0.331) loss_x loss_x 1.1533 (1.3953) acc_x 62.5000 (65.4688) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [25/31] time 0.380 (0.459) data 0.250 (0.329) loss_x loss_x 1.6133 (1.4104) acc_x 59.3750 (65.6250) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [30/31] time 0.442 (0.446) data 0.313 (0.316) loss_x loss_x 1.0791 (1.4367) acc_x 56.2500 (64.2708) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.3217, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1009
clean true:963
clean false:46
clean_rate:0.9544103072348861
noisy true:523
noisy false:1604
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 2127
epoch [76/200] batch [5/31] time 0.592 (0.482) data 0.462 (0.351) loss_x loss_x 0.9438 (1.3821) acc_x 71.8750 (65.6250) lr 1.3971e-03 eta 0:00:12
epoch [76/200] batch [10/31] time 0.458 (0.450) data 0.328 (0.319) loss_x loss_x 1.5625 (1.4196) acc_x 65.6250 (65.0000) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [15/31] time 0.449 (0.440) data 0.319 (0.309) loss_x loss_x 1.0391 (1.3954) acc_x 71.8750 (65.2083) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [20/31] time 0.420 (0.432) data 0.290 (0.302) loss_x loss_x 1.1582 (1.3659) acc_x 71.8750 (65.7812) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [25/31] time 0.426 (0.429) data 0.295 (0.299) loss_x loss_x 1.0674 (1.4271) acc_x 65.6250 (64.2500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/31] time 0.560 (0.444) data 0.429 (0.314) loss_x loss_x 1.1719 (1.4223) acc_x 65.6250 (64.4792) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1652
confident_label rate tensor(0.3259, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1022
clean true:972
clean false:50
clean_rate:0.9510763209393346
noisy true:512
noisy false:1602
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 2114
epoch [77/200] batch [5/31] time 0.470 (0.519) data 0.340 (0.388) loss_x loss_x 1.3643 (1.2611) acc_x 59.3750 (66.8750) lr 1.3827e-03 eta 0:00:13
epoch [77/200] batch [10/31] time 0.356 (0.477) data 0.226 (0.347) loss_x loss_x 1.4824 (1.4013) acc_x 68.7500 (66.2500) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [15/31] time 0.473 (0.449) data 0.342 (0.319) loss_x loss_x 1.1104 (1.3574) acc_x 68.7500 (64.5833) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [20/31] time 0.430 (0.449) data 0.299 (0.319) loss_x loss_x 1.9492 (1.3480) acc_x 43.7500 (63.9062) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [25/31] time 0.325 (0.446) data 0.194 (0.316) loss_x loss_x 1.3252 (1.3706) acc_x 71.8750 (63.1250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [30/31] time 0.432 (0.448) data 0.301 (0.318) loss_x loss_x 1.4902 (1.3942) acc_x 68.7500 (63.8542) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1710
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1019
clean true:958
clean false:61
clean_rate:0.9401373895976447
noisy true:468
noisy false:1649
after delete: len(clean_dataset) 1019
after delete: len(noisy_dataset) 2117
epoch [78/200] batch [5/31] time 0.377 (0.393) data 0.246 (0.263) loss_x loss_x 1.5342 (1.4742) acc_x 56.2500 (65.0000) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [10/31] time 0.451 (0.430) data 0.321 (0.299) loss_x loss_x 1.0186 (1.4043) acc_x 78.1250 (66.2500) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [15/31] time 0.435 (0.428) data 0.306 (0.298) loss_x loss_x 1.8369 (1.4335) acc_x 56.2500 (63.5417) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [20/31] time 0.373 (0.442) data 0.243 (0.311) loss_x loss_x 0.9263 (1.4304) acc_x 75.0000 (63.1250) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [25/31] time 0.462 (0.434) data 0.332 (0.304) loss_x loss_x 1.1494 (1.3816) acc_x 65.6250 (64.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/31] time 0.386 (0.447) data 0.256 (0.316) loss_x loss_x 1.4248 (1.3925) acc_x 53.1250 (63.5417) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1641
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1021
clean true:973
clean false:48
clean_rate:0.9529872673849168
noisy true:522
noisy false:1593
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 2115
epoch [79/200] batch [5/31] time 0.402 (0.444) data 0.272 (0.314) loss_x loss_x 1.1299 (1.3527) acc_x 59.3750 (66.2500) lr 1.3535e-03 eta 0:00:11
epoch [79/200] batch [10/31] time 0.424 (0.440) data 0.294 (0.310) loss_x loss_x 1.5371 (1.4141) acc_x 59.3750 (62.8125) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [15/31] time 0.428 (0.453) data 0.297 (0.322) loss_x loss_x 0.8955 (1.4122) acc_x 78.1250 (62.2917) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [20/31] time 0.377 (0.442) data 0.248 (0.312) loss_x loss_x 1.6680 (1.4211) acc_x 53.1250 (61.5625) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [25/31] time 0.392 (0.438) data 0.261 (0.308) loss_x loss_x 1.1943 (1.4126) acc_x 62.5000 (62.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/31] time 0.384 (0.442) data 0.254 (0.312) loss_x loss_x 1.1338 (1.4050) acc_x 65.6250 (62.9167) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1683
confident_label rate tensor(0.3195, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1002
clean true:956
clean false:46
clean_rate:0.9540918163672655
noisy true:497
noisy false:1637
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 2134
epoch [80/200] batch [5/31] time 0.468 (0.462) data 0.338 (0.332) loss_x loss_x 1.2305 (1.1210) acc_x 68.7500 (69.3750) lr 1.3387e-03 eta 0:00:12
epoch [80/200] batch [10/31] time 0.376 (0.462) data 0.246 (0.333) loss_x loss_x 1.5840 (1.2162) acc_x 50.0000 (68.1250) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [15/31] time 0.397 (0.449) data 0.268 (0.319) loss_x loss_x 1.1250 (1.2136) acc_x 68.7500 (66.8750) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [20/31] time 0.561 (0.460) data 0.430 (0.330) loss_x loss_x 1.2148 (1.2266) acc_x 62.5000 (66.2500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [25/31] time 0.303 (0.455) data 0.172 (0.325) loss_x loss_x 1.8438 (1.2846) acc_x 40.6250 (64.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/31] time 0.464 (0.454) data 0.334 (0.324) loss_x loss_x 1.1855 (1.2827) acc_x 71.8750 (65.3125) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1702
confident_label rate tensor(0.3151, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 988
clean true:945
clean false:43
clean_rate:0.9564777327935222
noisy true:489
noisy false:1659
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 2148
epoch [81/200] batch [5/30] time 0.431 (0.508) data 0.301 (0.378) loss_x loss_x 0.9722 (1.0164) acc_x 68.7500 (73.1250) lr 1.3239e-03 eta 0:00:12
epoch [81/200] batch [10/30] time 0.417 (0.482) data 0.287 (0.352) loss_x loss_x 1.4492 (1.0782) acc_x 62.5000 (71.8750) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [15/30] time 0.386 (0.461) data 0.256 (0.331) loss_x loss_x 1.4502 (1.1682) acc_x 59.3750 (68.5417) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/30] time 0.394 (0.458) data 0.265 (0.328) loss_x loss_x 1.0439 (1.1783) acc_x 68.7500 (67.1875) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/30] time 0.437 (0.454) data 0.307 (0.325) loss_x loss_x 1.6279 (1.2246) acc_x 56.2500 (66.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/30] time 0.378 (0.447) data 0.248 (0.317) loss_x loss_x 1.4834 (1.2488) acc_x 62.5000 (66.2500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1679
confident_label rate tensor(0.3281, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1029
clean true:978
clean false:51
clean_rate:0.9504373177842566
noisy true:479
noisy false:1628
after delete: len(clean_dataset) 1029
after delete: len(noisy_dataset) 2107
epoch [82/200] batch [5/32] time 0.531 (0.496) data 0.401 (0.366) loss_x loss_x 1.3271 (1.5215) acc_x 65.6250 (60.0000) lr 1.3090e-03 eta 0:00:13
epoch [82/200] batch [10/32] time 0.402 (0.453) data 0.271 (0.323) loss_x loss_x 1.5684 (1.4755) acc_x 62.5000 (62.5000) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [15/32] time 0.510 (0.457) data 0.380 (0.327) loss_x loss_x 1.3662 (1.4785) acc_x 62.5000 (61.8750) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [20/32] time 0.445 (0.449) data 0.315 (0.318) loss_x loss_x 1.2510 (1.4834) acc_x 71.8750 (61.8750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [25/32] time 0.491 (0.447) data 0.361 (0.317) loss_x loss_x 1.6855 (1.4959) acc_x 50.0000 (61.6250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [30/32] time 0.473 (0.450) data 0.343 (0.319) loss_x loss_x 1.8623 (1.5176) acc_x 56.2500 (61.2500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1671
confident_label rate tensor(0.3112, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 976
clean true:933
clean false:43
clean_rate:0.9559426229508197
noisy true:532
noisy false:1628
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 2160
epoch [83/200] batch [5/30] time 0.503 (0.502) data 0.372 (0.371) loss_x loss_x 1.3447 (1.3191) acc_x 65.6250 (68.1250) lr 1.2940e-03 eta 0:00:12
epoch [83/200] batch [10/30] time 0.464 (0.460) data 0.334 (0.330) loss_x loss_x 1.3057 (1.2396) acc_x 53.1250 (66.8750) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [15/30] time 0.442 (0.447) data 0.312 (0.317) loss_x loss_x 1.8154 (1.3189) acc_x 53.1250 (66.8750) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [20/30] time 0.436 (0.456) data 0.306 (0.326) loss_x loss_x 1.6455 (1.3577) acc_x 50.0000 (64.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/30] time 0.516 (0.469) data 0.387 (0.339) loss_x loss_x 1.4736 (1.3787) acc_x 62.5000 (64.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/30] time 0.401 (0.465) data 0.271 (0.335) loss_x loss_x 1.8643 (1.3708) acc_x 59.3750 (64.4792) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1706
confident_label rate tensor(0.3166, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 993
clean true:946
clean false:47
clean_rate:0.9526686807653575
noisy true:484
noisy false:1659
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 2143
epoch [84/200] batch [5/31] time 0.461 (0.465) data 0.331 (0.334) loss_x loss_x 1.3447 (1.3594) acc_x 71.8750 (66.2500) lr 1.2790e-03 eta 0:00:12
epoch [84/200] batch [10/31] time 0.370 (0.462) data 0.240 (0.331) loss_x loss_x 0.9316 (1.3047) acc_x 81.2500 (66.8750) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [15/31] time 0.472 (0.471) data 0.341 (0.341) loss_x loss_x 1.0059 (1.3253) acc_x 65.6250 (65.6250) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [20/31] time 0.509 (0.467) data 0.379 (0.337) loss_x loss_x 1.5420 (1.3339) acc_x 56.2500 (64.2188) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [25/31] time 0.377 (0.455) data 0.246 (0.324) loss_x loss_x 1.2334 (1.3214) acc_x 62.5000 (64.3750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/31] time 0.552 (0.452) data 0.421 (0.321) loss_x loss_x 1.1201 (1.3048) acc_x 71.8750 (64.8958) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1659
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1015
clean true:969
clean false:46
clean_rate:0.954679802955665
noisy true:508
noisy false:1613
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 2121
epoch [85/200] batch [5/31] time 0.400 (0.431) data 0.269 (0.301) loss_x loss_x 1.5645 (1.4037) acc_x 62.5000 (65.0000) lr 1.2639e-03 eta 0:00:11
epoch [85/200] batch [10/31] time 0.389 (0.443) data 0.259 (0.312) loss_x loss_x 1.3789 (1.3545) acc_x 65.6250 (65.9375) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [15/31] time 0.562 (0.452) data 0.430 (0.321) loss_x loss_x 1.6562 (1.4180) acc_x 50.0000 (64.3750) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [20/31] time 0.406 (0.443) data 0.275 (0.313) loss_x loss_x 1.3643 (1.4021) acc_x 62.5000 (64.6875) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [25/31] time 0.462 (0.443) data 0.332 (0.313) loss_x loss_x 1.6240 (1.4491) acc_x 59.3750 (63.5000) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [30/31] time 0.440 (0.437) data 0.310 (0.307) loss_x loss_x 0.8374 (1.4033) acc_x 84.3750 (64.8958) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1666
confident_label rate tensor(0.3256, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1021
clean true:975
clean false:46
clean_rate:0.9549461312438785
noisy true:495
noisy false:1620
after delete: len(clean_dataset) 1021
after delete: len(noisy_dataset) 2115
epoch [86/200] batch [5/31] time 0.405 (0.453) data 0.274 (0.323) loss_x loss_x 1.2354 (1.4621) acc_x 62.5000 (66.2500) lr 1.2487e-03 eta 0:00:11
epoch [86/200] batch [10/31] time 0.443 (0.456) data 0.313 (0.325) loss_x loss_x 1.5010 (1.3972) acc_x 56.2500 (65.0000) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [15/31] time 0.411 (0.462) data 0.281 (0.332) loss_x loss_x 0.9517 (1.2843) acc_x 78.1250 (67.2917) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [20/31] time 0.486 (0.461) data 0.355 (0.331) loss_x loss_x 1.5654 (1.3656) acc_x 62.5000 (65.7812) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [25/31] time 0.364 (0.454) data 0.234 (0.323) loss_x loss_x 0.9370 (1.3325) acc_x 81.2500 (66.8750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/31] time 0.577 (0.452) data 0.446 (0.322) loss_x loss_x 0.8335 (1.3354) acc_x 71.8750 (66.3542) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1642
confident_label rate tensor(0.3240, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1016
clean true:972
clean false:44
clean_rate:0.9566929133858267
noisy true:522
noisy false:1598
after delete: len(clean_dataset) 1016
after delete: len(noisy_dataset) 2120
epoch [87/200] batch [5/31] time 0.350 (0.412) data 0.221 (0.282) loss_x loss_x 1.3096 (1.2761) acc_x 65.6250 (68.1250) lr 1.2334e-03 eta 0:00:10
epoch [87/200] batch [10/31] time 0.367 (0.426) data 0.236 (0.296) loss_x loss_x 1.7090 (1.3254) acc_x 53.1250 (65.0000) lr 1.2334e-03 eta 0:00:08
epoch [87/200] batch [15/31] time 0.495 (0.445) data 0.365 (0.315) loss_x loss_x 1.3496 (1.2890) acc_x 75.0000 (65.4167) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [20/31] time 0.503 (0.457) data 0.373 (0.327) loss_x loss_x 1.3564 (1.3096) acc_x 59.3750 (64.0625) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [25/31] time 0.408 (0.458) data 0.278 (0.328) loss_x loss_x 1.6621 (1.3067) acc_x 59.3750 (65.0000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/31] time 0.449 (0.458) data 0.319 (0.328) loss_x loss_x 1.7021 (1.3079) acc_x 50.0000 (65.7292) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1643
confident_label rate tensor(0.3275, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1027
clean true:983
clean false:44
clean_rate:0.9571567672833495
noisy true:510
noisy false:1599
after delete: len(clean_dataset) 1027
after delete: len(noisy_dataset) 2109
epoch [88/200] batch [5/32] time 0.444 (0.471) data 0.314 (0.341) loss_x loss_x 1.3945 (1.3508) acc_x 65.6250 (69.3750) lr 1.2181e-03 eta 0:00:12
epoch [88/200] batch [10/32] time 0.553 (0.479) data 0.423 (0.349) loss_x loss_x 1.3682 (1.3813) acc_x 68.7500 (66.2500) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [15/32] time 0.564 (0.469) data 0.434 (0.339) loss_x loss_x 1.5371 (1.3679) acc_x 56.2500 (65.2083) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [20/32] time 0.453 (0.471) data 0.323 (0.340) loss_x loss_x 1.3379 (1.3359) acc_x 62.5000 (65.6250) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [25/32] time 0.431 (0.475) data 0.301 (0.345) loss_x loss_x 1.9775 (1.3688) acc_x 46.8750 (65.6250) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [30/32] time 0.408 (0.467) data 0.278 (0.337) loss_x loss_x 0.8809 (1.3592) acc_x 78.1250 (65.5208) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1672
confident_label rate tensor(0.3163, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 992
clean true:951
clean false:41
clean_rate:0.9586693548387096
noisy true:513
noisy false:1631
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 2144
epoch [89/200] batch [5/31] time 0.628 (0.456) data 0.497 (0.326) loss_x loss_x 1.3418 (1.4422) acc_x 59.3750 (60.0000) lr 1.2028e-03 eta 0:00:11
epoch [89/200] batch [10/31] time 0.381 (0.449) data 0.251 (0.318) loss_x loss_x 0.9927 (1.3148) acc_x 75.0000 (64.0625) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [15/31] time 0.407 (0.456) data 0.277 (0.326) loss_x loss_x 1.0039 (1.2758) acc_x 62.5000 (65.0000) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [20/31] time 0.486 (0.455) data 0.356 (0.325) loss_x loss_x 1.2373 (1.3200) acc_x 62.5000 (64.0625) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [25/31] time 0.428 (0.460) data 0.297 (0.329) loss_x loss_x 1.3359 (1.2887) acc_x 68.7500 (65.3750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [30/31] time 0.446 (0.451) data 0.316 (0.320) loss_x loss_x 1.0674 (1.2826) acc_x 62.5000 (65.1042) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1627
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1017
clean true:981
clean false:36
clean_rate:0.9646017699115044
noisy true:528
noisy false:1591
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 2119
epoch [90/200] batch [5/31] time 0.330 (0.402) data 0.200 (0.271) loss_x loss_x 1.0225 (1.1158) acc_x 68.7500 (66.8750) lr 1.1874e-03 eta 0:00:10
epoch [90/200] batch [10/31] time 0.457 (0.439) data 0.327 (0.308) loss_x loss_x 1.2324 (1.1348) acc_x 62.5000 (68.4375) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [15/31] time 0.462 (0.448) data 0.331 (0.318) loss_x loss_x 1.4150 (1.2549) acc_x 68.7500 (66.2500) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [20/31] time 0.435 (0.450) data 0.305 (0.319) loss_x loss_x 1.2305 (1.2622) acc_x 68.7500 (66.7188) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [25/31] time 0.358 (0.445) data 0.226 (0.314) loss_x loss_x 1.3496 (1.2941) acc_x 65.6250 (66.5000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [30/31] time 0.431 (0.452) data 0.301 (0.322) loss_x loss_x 1.0771 (1.3044) acc_x 75.0000 (65.4167) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1669
confident_label rate tensor(0.3202, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1004
clean true:960
clean false:44
clean_rate:0.9561752988047809
noisy true:507
noisy false:1625
after delete: len(clean_dataset) 1004
after delete: len(noisy_dataset) 2132
epoch [91/200] batch [5/31] time 0.430 (0.420) data 0.299 (0.289) loss_x loss_x 0.7959 (1.1501) acc_x 84.3750 (69.3750) lr 1.1719e-03 eta 0:00:10
epoch [91/200] batch [10/31] time 0.394 (0.437) data 0.264 (0.306) loss_x loss_x 1.3535 (1.2220) acc_x 59.3750 (67.1875) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [15/31] time 0.453 (0.432) data 0.323 (0.301) loss_x loss_x 1.7461 (1.3020) acc_x 56.2500 (65.6250) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [20/31] time 0.481 (0.435) data 0.351 (0.304) loss_x loss_x 1.3594 (1.2845) acc_x 71.8750 (66.5625) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/31] time 0.430 (0.435) data 0.300 (0.305) loss_x loss_x 1.1943 (1.2700) acc_x 65.6250 (67.0000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/31] time 0.488 (0.440) data 0.358 (0.310) loss_x loss_x 1.4150 (1.2764) acc_x 59.3750 (66.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1662
confident_label rate tensor(0.3189, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1000
clean true:960
clean false:40
clean_rate:0.96
noisy true:514
noisy false:1622
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 2136
epoch [92/200] batch [5/31] time 0.490 (0.432) data 0.360 (0.302) loss_x loss_x 1.5322 (1.2951) acc_x 71.8750 (70.0000) lr 1.1564e-03 eta 0:00:11
epoch [92/200] batch [10/31] time 0.415 (0.449) data 0.284 (0.319) loss_x loss_x 1.2324 (1.3840) acc_x 65.6250 (67.8125) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [15/31] time 0.364 (0.446) data 0.233 (0.316) loss_x loss_x 1.0879 (1.3748) acc_x 71.8750 (67.0833) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [20/31] time 0.487 (0.452) data 0.356 (0.321) loss_x loss_x 1.3828 (1.4165) acc_x 62.5000 (65.1562) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [25/31] time 0.732 (0.463) data 0.602 (0.333) loss_x loss_x 1.2871 (1.3973) acc_x 65.6250 (65.2500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/31] time 0.505 (0.462) data 0.374 (0.331) loss_x loss_x 1.2607 (1.3839) acc_x 81.2500 (66.2500) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1050
clean true:1001
clean false:49
clean_rate:0.9533333333333334
noisy true:525
noisy false:1561
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 2086
epoch [93/200] batch [5/32] time 0.574 (0.499) data 0.444 (0.370) loss_x loss_x 1.3496 (1.4492) acc_x 65.6250 (64.3750) lr 1.1409e-03 eta 0:00:13
epoch [93/200] batch [10/32] time 0.420 (0.470) data 0.289 (0.340) loss_x loss_x 1.2305 (1.3235) acc_x 62.5000 (66.2500) lr 1.1409e-03 eta 0:00:10
epoch [93/200] batch [15/32] time 0.468 (0.480) data 0.337 (0.350) loss_x loss_x 1.3291 (1.3460) acc_x 68.7500 (65.6250) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [20/32] time 0.458 (0.470) data 0.328 (0.340) loss_x loss_x 1.4473 (1.3413) acc_x 56.2500 (65.9375) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [25/32] time 0.400 (0.457) data 0.269 (0.326) loss_x loss_x 1.3320 (1.3526) acc_x 65.6250 (66.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [30/32] time 0.468 (0.455) data 0.337 (0.325) loss_x loss_x 0.9004 (1.3189) acc_x 81.2500 (67.9167) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1626
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1017
clean true:978
clean false:39
clean_rate:0.9616519174041298
noisy true:532
noisy false:1587
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 2119
epoch [94/200] batch [5/31] time 0.434 (0.490) data 0.304 (0.359) loss_x loss_x 1.4160 (1.4012) acc_x 65.6250 (68.1250) lr 1.1253e-03 eta 0:00:12
epoch [94/200] batch [10/31] time 0.416 (0.463) data 0.285 (0.332) loss_x loss_x 1.3965 (1.4423) acc_x 62.5000 (66.5625) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [15/31] time 0.717 (0.487) data 0.587 (0.357) loss_x loss_x 1.4824 (1.3958) acc_x 59.3750 (65.4167) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [20/31] time 0.380 (0.472) data 0.249 (0.341) loss_x loss_x 1.4463 (1.4441) acc_x 59.3750 (64.5312) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [25/31] time 0.421 (0.458) data 0.291 (0.328) loss_x loss_x 1.4922 (1.4574) acc_x 68.7500 (63.6250) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/31] time 0.369 (0.452) data 0.238 (0.321) loss_x loss_x 1.0186 (1.4035) acc_x 75.0000 (65.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1636
confident_label rate tensor(0.3304, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1036
clean true:994
clean false:42
clean_rate:0.9594594594594594
noisy true:506
noisy false:1594
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 2100
epoch [95/200] batch [5/32] time 0.417 (0.441) data 0.287 (0.311) loss_x loss_x 1.7021 (1.6605) acc_x 56.2500 (62.5000) lr 1.1097e-03 eta 0:00:11
epoch [95/200] batch [10/32] time 0.413 (0.449) data 0.283 (0.319) loss_x loss_x 1.3604 (1.4771) acc_x 59.3750 (62.8125) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [15/32] time 0.495 (0.443) data 0.365 (0.313) loss_x loss_x 1.1855 (1.4542) acc_x 65.6250 (62.9167) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [20/32] time 0.406 (0.455) data 0.275 (0.324) loss_x loss_x 1.9766 (1.4365) acc_x 53.1250 (62.9688) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [25/32] time 0.458 (0.445) data 0.328 (0.315) loss_x loss_x 1.3125 (1.4026) acc_x 68.7500 (64.5000) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [30/32] time 0.438 (0.450) data 0.308 (0.320) loss_x loss_x 1.3447 (1.4018) acc_x 59.3750 (63.5417) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1659
confident_label rate tensor(0.3275, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1027
clean true:973
clean false:54
clean_rate:0.9474196689386563
noisy true:504
noisy false:1605
after delete: len(clean_dataset) 1027
after delete: len(noisy_dataset) 2109
epoch [96/200] batch [5/32] time 0.400 (0.419) data 0.270 (0.289) loss_x loss_x 1.7305 (1.4557) acc_x 62.5000 (66.2500) lr 1.0941e-03 eta 0:00:11
epoch [96/200] batch [10/32] time 0.429 (0.432) data 0.299 (0.302) loss_x loss_x 1.9102 (1.4656) acc_x 59.3750 (65.3125) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [15/32] time 0.461 (0.428) data 0.330 (0.297) loss_x loss_x 2.0684 (1.4858) acc_x 50.0000 (65.8333) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [20/32] time 0.707 (0.447) data 0.577 (0.317) loss_x loss_x 1.3516 (1.4397) acc_x 62.5000 (66.2500) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [25/32] time 0.501 (0.454) data 0.370 (0.324) loss_x loss_x 1.0371 (1.4357) acc_x 68.7500 (65.5000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [30/32] time 0.474 (0.456) data 0.343 (0.326) loss_x loss_x 1.5010 (1.4099) acc_x 53.1250 (65.0000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1686
confident_label rate tensor(0.3320, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1041
clean true:974
clean false:67
clean_rate:0.9356388088376562
noisy true:476
noisy false:1619
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 2095
epoch [97/200] batch [5/32] time 0.382 (0.419) data 0.252 (0.288) loss_x loss_x 1.6113 (1.5633) acc_x 56.2500 (60.6250) lr 1.0785e-03 eta 0:00:11
epoch [97/200] batch [10/32] time 0.412 (0.411) data 0.281 (0.280) loss_x loss_x 1.9346 (1.5385) acc_x 53.1250 (62.1875) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [15/32] time 0.558 (0.414) data 0.428 (0.284) loss_x loss_x 1.3916 (1.4711) acc_x 62.5000 (63.5417) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [20/32] time 0.418 (0.430) data 0.287 (0.300) loss_x loss_x 1.4180 (1.4500) acc_x 62.5000 (63.9062) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [25/32] time 0.423 (0.436) data 0.292 (0.305) loss_x loss_x 1.4131 (1.4248) acc_x 59.3750 (63.8750) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [30/32] time 0.486 (0.439) data 0.356 (0.308) loss_x loss_x 1.3418 (1.4116) acc_x 56.2500 (63.3333) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1050
clean true:1000
clean false:50
clean_rate:0.9523809523809523
noisy true:487
noisy false:1599
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 2086
epoch [98/200] batch [5/32] time 0.614 (0.504) data 0.483 (0.373) loss_x loss_x 1.4248 (1.2527) acc_x 50.0000 (61.8750) lr 1.0628e-03 eta 0:00:13
epoch [98/200] batch [10/32] time 0.464 (0.515) data 0.333 (0.385) loss_x loss_x 0.9580 (1.3335) acc_x 78.1250 (64.6875) lr 1.0628e-03 eta 0:00:11
epoch [98/200] batch [15/32] time 0.440 (0.488) data 0.310 (0.358) loss_x loss_x 1.1484 (1.3214) acc_x 75.0000 (65.0000) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [20/32] time 0.428 (0.489) data 0.298 (0.359) loss_x loss_x 1.1328 (1.3912) acc_x 71.8750 (63.5938) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [25/32] time 0.364 (0.471) data 0.234 (0.341) loss_x loss_x 1.6924 (1.4113) acc_x 59.3750 (63.5000) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [30/32] time 0.381 (0.460) data 0.251 (0.330) loss_x loss_x 1.4287 (1.4118) acc_x 68.7500 (63.7500) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1674
confident_label rate tensor(0.3237, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1015
clean true:966
clean false:49
clean_rate:0.9517241379310345
noisy true:496
noisy false:1625
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 2121
epoch [99/200] batch [5/31] time 0.634 (0.468) data 0.503 (0.338) loss_x loss_x 1.8037 (1.5240) acc_x 56.2500 (60.6250) lr 1.0471e-03 eta 0:00:12
epoch [99/200] batch [10/31] time 0.406 (0.474) data 0.275 (0.343) loss_x loss_x 1.7617 (1.4483) acc_x 56.2500 (61.8750) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [15/31] time 0.485 (0.466) data 0.354 (0.336) loss_x loss_x 1.3604 (1.4403) acc_x 71.8750 (62.7083) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [20/31] time 0.421 (0.458) data 0.291 (0.327) loss_x loss_x 1.9971 (1.4654) acc_x 46.8750 (61.7188) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [25/31] time 0.484 (0.453) data 0.353 (0.323) loss_x loss_x 1.3096 (1.4484) acc_x 62.5000 (62.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/31] time 0.550 (0.458) data 0.419 (0.328) loss_x loss_x 1.2764 (1.4461) acc_x 62.5000 (62.6042) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1627
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:984
clean false:47
clean_rate:0.9544131910766246
noisy true:525
noisy false:1580
all clean rate:  [0.9052369077306733, 0.9373776908023483, 0.9495073891625616, 0.9527186761229315, 0.9437125748502994, 0.9524913093858632, 0.9493670886075949, 0.9543859649122807, 0.9365798414496036, 0.9525462962962963, 0.9523255813953488, 0.9529816513761468, 0.9653979238754326, 0.9423503325942351, 0.95, 0.9351230425055929, 0.9434180138568129, 0.9553072625698324, 0.9557625145518044, 0.9521690767519466, 0.9462719298245614, 0.9503775620280475, 0.9543973941368078, 0.9491525423728814, 0.9513274336283186, 0.9540873460246361, 0.9498886414253898, 0.9546460176991151, 0.9561027837259101, 0.9520255863539445, 0.9533116178067318, 0.9496248660235799, 0.9579646017699115, 0.9556541019955654, 0.9562841530054644, 0.9566666666666667, 0.9499467518636848, 0.9480381760339343, 0.9521739130434783, 0.9693989071038251, 0.9636552440290758, 0.9653679653679653, 0.9540918163672655, 0.9483805668016194, 0.9427083333333334, 0.9619732785200411, 0.9498399146211313, 0.9476923076923077, 0.9486910994764398, 0.9478079331941545, 0.950354609929078, 0.950259067357513, 0.9511201629327902, 0.9555555555555556, 0.9515962924819773, 0.9533678756476683, 0.9571577847439916, 0.9533267130089375, 0.9532520325203252, 0.9498495486459378, 0.9396984924623115, 0.9490316004077471, 0.9490316004077471, 0.9471057884231537, 0.9519519519519519, 0.9538310412573674, 0.9474708171206225, 0.9629629629629629, 0.9515810276679841, 0.9557086614173228, 0.9593253968253969, 0.9551345962113659, 0.942366026289181, 0.9461839530332681, 0.9644619940769991, 0.9544103072348861, 0.9510763209393346, 0.9401373895976447, 0.9529872673849168, 0.9540918163672655, 0.9564777327935222, 0.9504373177842566, 0.9559426229508197, 0.9526686807653575, 0.954679802955665, 0.9549461312438785, 0.9566929133858267, 0.9571567672833495, 0.9586693548387096, 0.9646017699115044, 0.9561752988047809, 0.96, 0.9533333333333334, 0.9616519174041298, 0.9594594594594594, 0.9474196689386563, 0.9356388088376562, 0.9523809523809523, 0.9517241379310345, 0.9544131910766246]
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [100/200] batch [5/32] time 0.425 (0.441) data 0.295 (0.310) loss_x loss_x 1.5273 (1.4408) acc_x 65.6250 (63.1250) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [10/32] time 0.551 (0.458) data 0.421 (0.327) loss_x loss_x 1.6650 (1.3719) acc_x 50.0000 (65.3125) lr 1.0314e-03 eta 0:00:10
epoch [100/200] batch [15/32] time 0.369 (0.453) data 0.239 (0.322) loss_x loss_x 1.6982 (1.3945) acc_x 62.5000 (64.5833) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [20/32] time 0.399 (0.449) data 0.268 (0.318) loss_x loss_x 1.3574 (1.3847) acc_x 62.5000 (63.9062) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [25/32] time 0.413 (0.443) data 0.282 (0.312) loss_x loss_x 1.1924 (1.3447) acc_x 65.6250 (65.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [30/32] time 0.403 (0.447) data 0.272 (0.317) loss_x loss_x 1.2852 (1.3342) acc_x 65.6250 (65.0000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1651
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:981
clean false:50
clean_rate:0.9515033947623667
noisy true:504
noisy false:1601
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [101/200] batch [5/32] time 0.514 (0.456) data 0.383 (0.326) loss_x loss_x 1.2314 (1.2695) acc_x 65.6250 (65.0000) lr 1.0157e-03 eta 0:00:12
epoch [101/200] batch [10/32] time 0.560 (0.472) data 0.431 (0.341) loss_x loss_x 1.4824 (1.3364) acc_x 56.2500 (64.3750) lr 1.0157e-03 eta 0:00:10
epoch [101/200] batch [15/32] time 0.460 (0.471) data 0.330 (0.341) loss_x loss_x 1.3613 (1.3098) acc_x 68.7500 (65.4167) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [20/32] time 0.382 (0.469) data 0.252 (0.338) loss_x loss_x 1.2520 (1.3225) acc_x 65.6250 (64.2188) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [25/32] time 0.426 (0.457) data 0.295 (0.327) loss_x loss_x 2.1641 (1.3417) acc_x 56.2500 (65.1250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [30/32] time 0.452 (0.447) data 0.322 (0.317) loss_x loss_x 1.6699 (1.3665) acc_x 53.1250 (64.1667) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1665
confident_label rate tensor(0.3304, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1036
clean true:982
clean false:54
clean_rate:0.9478764478764479
noisy true:489
noisy false:1611
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 2100
epoch [102/200] batch [5/32] time 0.483 (0.419) data 0.354 (0.290) loss_x loss_x 1.5449 (1.3744) acc_x 53.1250 (62.5000) lr 1.0000e-03 eta 0:00:11
epoch [102/200] batch [10/32] time 0.443 (0.453) data 0.313 (0.323) loss_x loss_x 1.3838 (1.4209) acc_x 56.2500 (63.4375) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [15/32] time 0.416 (0.448) data 0.286 (0.318) loss_x loss_x 1.2695 (1.4324) acc_x 59.3750 (62.0833) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [20/32] time 0.393 (0.448) data 0.263 (0.318) loss_x loss_x 1.5889 (1.3810) acc_x 62.5000 (63.4375) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [25/32] time 0.431 (0.454) data 0.301 (0.324) loss_x loss_x 1.4385 (1.3879) acc_x 65.6250 (63.6250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [30/32] time 0.371 (0.445) data 0.241 (0.315) loss_x loss_x 1.0107 (1.3493) acc_x 71.8750 (64.6875) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1610
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1011
clean false:50
clean_rate:0.9528746465598492
noisy true:515
noisy false:1560
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [103/200] batch [5/33] time 0.480 (0.467) data 0.351 (0.337) loss_x loss_x 1.0342 (1.3371) acc_x 68.7500 (63.7500) lr 9.8429e-04 eta 0:00:13
epoch [103/200] batch [10/33] time 0.459 (0.463) data 0.329 (0.333) loss_x loss_x 0.9214 (1.3513) acc_x 75.0000 (64.0625) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [15/33] time 0.514 (0.459) data 0.384 (0.329) loss_x loss_x 1.2012 (1.3184) acc_x 56.2500 (63.5417) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [20/33] time 0.488 (0.460) data 0.358 (0.329) loss_x loss_x 1.2373 (1.3454) acc_x 62.5000 (63.1250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [25/33] time 0.457 (0.452) data 0.326 (0.322) loss_x loss_x 1.0654 (1.3172) acc_x 75.0000 (64.3750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [30/33] time 0.427 (0.458) data 0.296 (0.327) loss_x loss_x 1.1777 (1.3394) acc_x 68.7500 (63.9583) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1623
confident_label rate tensor(0.3380, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1060
clean true:995
clean false:65
clean_rate:0.9386792452830188
noisy true:518
noisy false:1558
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 2076
epoch [104/200] batch [5/33] time 0.424 (0.417) data 0.295 (0.287) loss_x loss_x 1.4248 (1.3668) acc_x 68.7500 (66.8750) lr 9.6859e-04 eta 0:00:11
epoch [104/200] batch [10/33] time 0.483 (0.462) data 0.352 (0.332) loss_x loss_x 1.2812 (1.3988) acc_x 68.7500 (61.5625) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [15/33] time 0.520 (0.459) data 0.390 (0.329) loss_x loss_x 1.1934 (1.3828) acc_x 68.7500 (62.5000) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [20/33] time 0.468 (0.464) data 0.337 (0.334) loss_x loss_x 1.3115 (1.3896) acc_x 68.7500 (64.0625) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [25/33] time 0.552 (0.458) data 0.421 (0.328) loss_x loss_x 1.0811 (1.4143) acc_x 75.0000 (63.6250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [30/33] time 0.519 (0.465) data 0.387 (0.334) loss_x loss_x 1.4658 (1.4272) acc_x 65.6250 (63.6458) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.3291, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1032
clean true:984
clean false:48
clean_rate:0.9534883720930233
noisy true:502
noisy false:1602
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 2104
epoch [105/200] batch [5/32] time 0.396 (0.428) data 0.266 (0.298) loss_x loss_x 1.5166 (1.6502) acc_x 65.6250 (58.1250) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [10/32] time 0.518 (0.432) data 0.388 (0.302) loss_x loss_x 1.5176 (1.5796) acc_x 65.6250 (59.0625) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [15/32] time 0.383 (0.432) data 0.253 (0.301) loss_x loss_x 1.2910 (1.4736) acc_x 71.8750 (62.5000) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [20/32] time 0.451 (0.444) data 0.320 (0.314) loss_x loss_x 1.5859 (1.4234) acc_x 59.3750 (64.0625) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [25/32] time 0.408 (0.445) data 0.277 (0.315) loss_x loss_x 1.1201 (1.4146) acc_x 71.8750 (63.7500) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [30/32] time 0.519 (0.447) data 0.389 (0.317) loss_x loss_x 0.9561 (1.3890) acc_x 78.1250 (64.8958) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1655
confident_label rate tensor(0.3268, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1025
clean true:975
clean false:50
clean_rate:0.9512195121951219
noisy true:506
noisy false:1605
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 2111
epoch [106/200] batch [5/32] time 0.469 (0.450) data 0.339 (0.319) loss_x loss_x 1.2129 (1.3596) acc_x 68.7500 (65.0000) lr 9.3721e-04 eta 0:00:12
epoch [106/200] batch [10/32] time 0.426 (0.429) data 0.295 (0.298) loss_x loss_x 0.9565 (1.2776) acc_x 68.7500 (66.8750) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [15/32] time 0.450 (0.438) data 0.320 (0.307) loss_x loss_x 0.9502 (1.2880) acc_x 75.0000 (66.2500) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [20/32] time 0.437 (0.446) data 0.306 (0.315) loss_x loss_x 2.1035 (1.3411) acc_x 53.1250 (65.3125) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [25/32] time 0.362 (0.439) data 0.231 (0.309) loss_x loss_x 1.3408 (1.3398) acc_x 68.7500 (64.8750) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [30/32] time 0.512 (0.444) data 0.381 (0.313) loss_x loss_x 1.1553 (1.3272) acc_x 68.7500 (65.0000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1650
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1019
clean true:964
clean false:55
clean_rate:0.9460255152109912
noisy true:522
noisy false:1595
after delete: len(clean_dataset) 1019
after delete: len(noisy_dataset) 2117
epoch [107/200] batch [5/31] time 0.392 (0.403) data 0.261 (0.273) loss_x loss_x 1.5254 (1.4339) acc_x 59.3750 (65.0000) lr 9.2154e-04 eta 0:00:10
epoch [107/200] batch [10/31] time 0.610 (0.466) data 0.479 (0.336) loss_x loss_x 1.3086 (1.3293) acc_x 65.6250 (65.3125) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [15/31] time 0.491 (0.468) data 0.361 (0.338) loss_x loss_x 1.2607 (1.2928) acc_x 68.7500 (66.0417) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [20/31] time 0.565 (0.466) data 0.435 (0.336) loss_x loss_x 1.6807 (1.3384) acc_x 62.5000 (64.8438) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [25/31] time 0.391 (0.456) data 0.261 (0.326) loss_x loss_x 1.1426 (1.3387) acc_x 75.0000 (64.8750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/31] time 0.415 (0.456) data 0.285 (0.326) loss_x loss_x 1.1348 (1.3244) acc_x 78.1250 (65.7292) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1670
confident_label rate tensor(0.3272, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1026
clean true:967
clean false:59
clean_rate:0.942495126705653
noisy true:499
noisy false:1611
after delete: len(clean_dataset) 1026
after delete: len(noisy_dataset) 2110
epoch [108/200] batch [5/32] time 0.472 (0.520) data 0.343 (0.390) loss_x loss_x 1.2783 (1.3356) acc_x 75.0000 (71.2500) lr 9.0589e-04 eta 0:00:14
epoch [108/200] batch [10/32] time 0.390 (0.470) data 0.260 (0.340) loss_x loss_x 1.4102 (1.4107) acc_x 68.7500 (68.4375) lr 9.0589e-04 eta 0:00:10
epoch [108/200] batch [15/32] time 0.430 (0.451) data 0.299 (0.321) loss_x loss_x 1.4951 (1.4250) acc_x 59.3750 (66.0417) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [20/32] time 0.406 (0.441) data 0.276 (0.311) loss_x loss_x 1.5273 (1.4457) acc_x 59.3750 (64.5312) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [25/32] time 0.420 (0.444) data 0.289 (0.314) loss_x loss_x 1.2256 (1.4297) acc_x 59.3750 (64.0000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [30/32] time 0.417 (0.445) data 0.287 (0.315) loss_x loss_x 1.2422 (1.4082) acc_x 62.5000 (63.8542) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1638
confident_label rate tensor(0.3310, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1038
clean true:984
clean false:54
clean_rate:0.9479768786127167
noisy true:514
noisy false:1584
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 2098
epoch [109/200] batch [5/32] time 0.425 (0.440) data 0.295 (0.309) loss_x loss_x 1.1836 (1.1553) acc_x 68.7500 (68.1250) lr 8.9027e-04 eta 0:00:11
epoch [109/200] batch [10/32] time 0.571 (0.449) data 0.441 (0.318) loss_x loss_x 2.1465 (1.3198) acc_x 50.0000 (66.2500) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [15/32] time 0.454 (0.449) data 0.324 (0.318) loss_x loss_x 1.7637 (1.4502) acc_x 62.5000 (65.2083) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [20/32] time 0.552 (0.452) data 0.422 (0.322) loss_x loss_x 1.8936 (1.4927) acc_x 50.0000 (63.5938) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [25/32] time 0.478 (0.455) data 0.348 (0.325) loss_x loss_x 1.4824 (1.4679) acc_x 59.3750 (64.1250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [30/32] time 0.703 (0.457) data 0.572 (0.327) loss_x loss_x 1.3594 (1.4334) acc_x 68.7500 (64.2708) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1626
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1004
clean false:53
clean_rate:0.9498580889309366
noisy true:506
noisy false:1573
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [110/200] batch [5/33] time 0.354 (0.417) data 0.224 (0.286) loss_x loss_x 1.4824 (1.2564) acc_x 62.5000 (67.5000) lr 8.7467e-04 eta 0:00:11
epoch [110/200] batch [10/33] time 0.417 (0.421) data 0.286 (0.290) loss_x loss_x 1.3535 (1.3829) acc_x 71.8750 (63.7500) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [15/33] time 0.454 (0.425) data 0.324 (0.294) loss_x loss_x 1.0088 (1.2900) acc_x 65.6250 (65.6250) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [20/33] time 0.451 (0.434) data 0.320 (0.304) loss_x loss_x 1.2627 (1.2920) acc_x 75.0000 (67.1875) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [25/33] time 0.478 (0.434) data 0.347 (0.303) loss_x loss_x 1.0410 (1.3203) acc_x 75.0000 (66.6250) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [30/33] time 0.531 (0.442) data 0.400 (0.311) loss_x loss_x 1.2061 (1.3135) acc_x 62.5000 (66.1458) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1621
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1053
clean true:1014
clean false:39
clean_rate:0.9629629629629629
noisy true:501
noisy false:1582
after delete: len(clean_dataset) 1053
after delete: len(noisy_dataset) 2083
epoch [111/200] batch [5/32] time 0.510 (0.498) data 0.381 (0.368) loss_x loss_x 1.3018 (1.2580) acc_x 62.5000 (68.1250) lr 8.5910e-04 eta 0:00:13
epoch [111/200] batch [10/32] time 0.379 (0.477) data 0.249 (0.347) loss_x loss_x 0.8828 (1.2047) acc_x 75.0000 (69.3750) lr 8.5910e-04 eta 0:00:10
epoch [111/200] batch [15/32] time 0.403 (0.454) data 0.273 (0.323) loss_x loss_x 1.4004 (1.1968) acc_x 68.7500 (69.5833) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [20/32] time 0.433 (0.460) data 0.303 (0.330) loss_x loss_x 1.6934 (1.2668) acc_x 53.1250 (67.3438) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [25/32] time 0.382 (0.450) data 0.252 (0.320) loss_x loss_x 1.3203 (1.2744) acc_x 65.6250 (66.6250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [30/32] time 0.401 (0.451) data 0.270 (0.321) loss_x loss_x 1.6885 (1.3049) acc_x 59.3750 (66.2500) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1615
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1044
clean true:993
clean false:51
clean_rate:0.9511494252873564
noisy true:528
noisy false:1564
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 2092
epoch [112/200] batch [5/32] time 0.420 (0.443) data 0.291 (0.313) loss_x loss_x 1.3887 (1.4406) acc_x 62.5000 (61.8750) lr 8.4357e-04 eta 0:00:11
epoch [112/200] batch [10/32] time 0.518 (0.447) data 0.388 (0.316) loss_x loss_x 1.4004 (1.3051) acc_x 62.5000 (66.2500) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [15/32] time 0.464 (0.454) data 0.333 (0.324) loss_x loss_x 1.5518 (1.4144) acc_x 62.5000 (63.9583) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [20/32] time 0.566 (0.452) data 0.437 (0.322) loss_x loss_x 1.8047 (1.4273) acc_x 56.2500 (63.5938) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [25/32] time 0.384 (0.450) data 0.253 (0.320) loss_x loss_x 1.6025 (1.4065) acc_x 65.6250 (63.8750) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [30/32] time 0.522 (0.452) data 0.392 (0.322) loss_x loss_x 1.0078 (1.3806) acc_x 65.6250 (64.1667) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1631
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1007
clean false:51
clean_rate:0.9517958412098299
noisy true:498
noisy false:1580
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [113/200] batch [5/33] time 0.495 (0.420) data 0.364 (0.290) loss_x loss_x 1.6094 (1.5064) acc_x 56.2500 (60.6250) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [10/33] time 0.458 (0.448) data 0.328 (0.317) loss_x loss_x 1.2676 (1.3838) acc_x 59.3750 (64.0625) lr 8.2807e-04 eta 0:00:10
epoch [113/200] batch [15/33] time 0.517 (0.440) data 0.387 (0.310) loss_x loss_x 0.9590 (1.3181) acc_x 71.8750 (65.8333) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [20/33] time 0.448 (0.441) data 0.317 (0.311) loss_x loss_x 1.1631 (1.3121) acc_x 75.0000 (67.3438) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [25/33] time 0.435 (0.440) data 0.305 (0.310) loss_x loss_x 1.2139 (1.2869) acc_x 71.8750 (68.0000) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [30/33] time 0.561 (0.440) data 0.430 (0.309) loss_x loss_x 1.8525 (1.3306) acc_x 50.0000 (66.9792) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1612
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:999
clean false:59
clean_rate:0.944234404536862
noisy true:525
noisy false:1553
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [114/200] batch [5/33] time 0.470 (0.432) data 0.340 (0.301) loss_x loss_x 0.7808 (1.3064) acc_x 84.3750 (66.8750) lr 8.1262e-04 eta 0:00:12
epoch [114/200] batch [10/33] time 0.407 (0.426) data 0.277 (0.295) loss_x loss_x 1.2803 (1.3619) acc_x 65.6250 (63.1250) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [15/33] time 0.352 (0.434) data 0.222 (0.304) loss_x loss_x 1.4395 (1.3553) acc_x 65.6250 (63.7500) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [20/33] time 0.482 (0.439) data 0.352 (0.309) loss_x loss_x 2.0059 (1.3960) acc_x 56.2500 (64.2188) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [25/33] time 0.377 (0.441) data 0.247 (0.310) loss_x loss_x 2.0254 (1.4342) acc_x 53.1250 (64.1250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [30/33] time 0.432 (0.434) data 0.302 (0.304) loss_x loss_x 1.4717 (1.4286) acc_x 62.5000 (64.1667) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1660
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1033
clean true:983
clean false:50
clean_rate:0.9515972894482091
noisy true:493
noisy false:1610
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 2103
epoch [115/200] batch [5/32] time 0.567 (0.493) data 0.436 (0.363) loss_x loss_x 1.0234 (1.1465) acc_x 65.6250 (71.8750) lr 7.9721e-04 eta 0:00:13
epoch [115/200] batch [10/32] time 0.481 (0.470) data 0.351 (0.339) loss_x loss_x 0.8599 (1.2113) acc_x 81.2500 (70.3125) lr 7.9721e-04 eta 0:00:10
epoch [115/200] batch [15/32] time 0.466 (0.457) data 0.335 (0.327) loss_x loss_x 1.2256 (1.2484) acc_x 68.7500 (68.3333) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [20/32] time 0.480 (0.469) data 0.350 (0.338) loss_x loss_x 1.6543 (1.2925) acc_x 59.3750 (68.2812) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [25/32] time 0.407 (0.469) data 0.277 (0.339) loss_x loss_x 1.1943 (1.3413) acc_x 78.1250 (66.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [30/32] time 0.461 (0.469) data 0.330 (0.339) loss_x loss_x 0.7642 (1.3803) acc_x 90.6250 (66.1458) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3288, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1031
clean true:993
clean false:38
clean_rate:0.9631425800193987
noisy true:514
noisy false:1591
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 2105
epoch [116/200] batch [5/32] time 0.570 (0.438) data 0.440 (0.307) loss_x loss_x 1.4336 (1.3785) acc_x 62.5000 (63.1250) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [10/32] time 0.362 (0.431) data 0.232 (0.300) loss_x loss_x 1.5117 (1.3657) acc_x 62.5000 (65.9375) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [15/32] time 0.479 (0.444) data 0.349 (0.314) loss_x loss_x 1.0635 (1.3983) acc_x 78.1250 (66.8750) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [20/32] time 0.401 (0.450) data 0.272 (0.320) loss_x loss_x 1.3242 (1.3436) acc_x 62.5000 (66.7188) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [25/32] time 0.439 (0.456) data 0.309 (0.326) loss_x loss_x 1.0859 (1.3169) acc_x 68.7500 (67.1250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [30/32] time 0.421 (0.458) data 0.291 (0.327) loss_x loss_x 1.3174 (1.2560) acc_x 50.0000 (67.7083) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.3345, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1049
clean true:988
clean false:61
clean_rate:0.9418493803622497
noisy true:528
noisy false:1559
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 2087
epoch [117/200] batch [5/32] time 0.445 (0.477) data 0.315 (0.347) loss_x loss_x 1.2910 (1.6596) acc_x 65.6250 (55.0000) lr 7.6655e-04 eta 0:00:12
epoch [117/200] batch [10/32] time 0.419 (0.464) data 0.289 (0.334) loss_x loss_x 1.6816 (1.4618) acc_x 50.0000 (59.3750) lr 7.6655e-04 eta 0:00:10
epoch [117/200] batch [15/32] time 0.325 (0.447) data 0.195 (0.316) loss_x loss_x 0.8896 (1.3661) acc_x 78.1250 (62.7083) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [20/32] time 0.393 (0.443) data 0.262 (0.312) loss_x loss_x 1.3594 (1.3687) acc_x 56.2500 (62.3438) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [25/32] time 0.435 (0.445) data 0.305 (0.315) loss_x loss_x 1.3652 (1.3418) acc_x 65.6250 (63.2500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [30/32] time 0.462 (0.444) data 0.332 (0.314) loss_x loss_x 1.0977 (1.3307) acc_x 75.0000 (63.7500) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1661
confident_label rate tensor(0.3300, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1035
clean true:979
clean false:56
clean_rate:0.9458937198067633
noisy true:496
noisy false:1605
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 2101
epoch [118/200] batch [5/32] time 0.453 (0.461) data 0.323 (0.331) loss_x loss_x 0.9556 (1.2571) acc_x 81.2500 (70.0000) lr 7.5131e-04 eta 0:00:12
epoch [118/200] batch [10/32] time 0.449 (0.460) data 0.319 (0.330) loss_x loss_x 1.1172 (1.2648) acc_x 71.8750 (67.8125) lr 7.5131e-04 eta 0:00:10
epoch [118/200] batch [15/32] time 0.454 (0.456) data 0.325 (0.326) loss_x loss_x 1.3232 (1.3054) acc_x 71.8750 (67.5000) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [20/32] time 0.414 (0.458) data 0.283 (0.328) loss_x loss_x 1.3252 (1.2962) acc_x 75.0000 (67.9688) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [25/32] time 0.379 (0.454) data 0.249 (0.324) loss_x loss_x 1.0137 (1.3228) acc_x 78.1250 (67.3750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [30/32] time 0.420 (0.447) data 0.290 (0.317) loss_x loss_x 0.7656 (1.3051) acc_x 81.2500 (67.7083) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1656
confident_label rate tensor(0.3326, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1043
clean true:988
clean false:55
clean_rate:0.947267497603068
noisy true:492
noisy false:1601
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 2093
epoch [119/200] batch [5/32] time 0.508 (0.455) data 0.379 (0.325) loss_x loss_x 1.3887 (1.2955) acc_x 62.5000 (66.8750) lr 7.3613e-04 eta 0:00:12
epoch [119/200] batch [10/32] time 0.404 (0.434) data 0.274 (0.304) loss_x loss_x 1.3457 (1.3436) acc_x 68.7500 (64.3750) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [15/32] time 0.454 (0.463) data 0.324 (0.333) loss_x loss_x 1.3047 (1.2821) acc_x 71.8750 (66.4583) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [20/32] time 0.453 (0.461) data 0.323 (0.331) loss_x loss_x 1.2617 (1.2607) acc_x 71.8750 (67.1875) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [25/32] time 0.398 (0.455) data 0.268 (0.325) loss_x loss_x 0.7017 (1.2637) acc_x 81.2500 (67.5000) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [30/32] time 0.419 (0.446) data 0.289 (0.316) loss_x loss_x 1.2168 (1.2536) acc_x 65.6250 (67.9167) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1676
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1017
clean true:970
clean false:47
clean_rate:0.9537856440511308
noisy true:490
noisy false:1629
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 2119
epoch [120/200] batch [5/31] time 0.468 (0.436) data 0.338 (0.306) loss_x loss_x 0.9146 (1.3267) acc_x 71.8750 (65.6250) lr 7.2101e-04 eta 0:00:11
epoch [120/200] batch [10/31] time 0.586 (0.448) data 0.456 (0.318) loss_x loss_x 1.4922 (1.3714) acc_x 56.2500 (63.4375) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [15/31] time 0.467 (0.457) data 0.337 (0.327) loss_x loss_x 1.6436 (1.3357) acc_x 53.1250 (64.3750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [20/31] time 0.488 (0.467) data 0.358 (0.336) loss_x loss_x 1.5020 (1.3242) acc_x 65.6250 (64.2188) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [25/31] time 0.535 (0.470) data 0.404 (0.339) loss_x loss_x 0.9888 (1.2644) acc_x 68.7500 (66.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/31] time 0.339 (0.462) data 0.208 (0.332) loss_x loss_x 1.1084 (1.2515) acc_x 65.6250 (67.2917) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3307, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1037
clean true:986
clean false:51
clean_rate:0.9508196721311475
noisy true:516
noisy false:1583
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 2099
epoch [121/200] batch [5/32] time 0.516 (0.433) data 0.386 (0.303) loss_x loss_x 1.4629 (1.2373) acc_x 53.1250 (66.2500) lr 7.0596e-04 eta 0:00:11
epoch [121/200] batch [10/32] time 0.421 (0.429) data 0.290 (0.299) loss_x loss_x 1.0430 (1.2729) acc_x 65.6250 (65.3125) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [15/32] time 0.389 (0.430) data 0.259 (0.300) loss_x loss_x 1.1787 (1.2667) acc_x 68.7500 (65.2083) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [20/32] time 0.410 (0.436) data 0.279 (0.305) loss_x loss_x 1.0322 (1.2807) acc_x 65.6250 (65.3125) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [25/32] time 0.395 (0.435) data 0.264 (0.305) loss_x loss_x 1.7256 (1.2820) acc_x 68.7500 (66.0000) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [30/32] time 0.584 (0.439) data 0.454 (0.308) loss_x loss_x 1.2061 (1.2864) acc_x 68.7500 (65.9375) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1051
clean true:994
clean false:57
clean_rate:0.9457659372026641
noisy true:522
noisy false:1563
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 2085
epoch [122/200] batch [5/32] time 0.403 (0.421) data 0.272 (0.290) loss_x loss_x 1.2285 (1.1666) acc_x 65.6250 (66.2500) lr 6.9098e-04 eta 0:00:11
epoch [122/200] batch [10/32] time 0.509 (0.446) data 0.379 (0.315) loss_x loss_x 1.5254 (1.2167) acc_x 62.5000 (68.7500) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [15/32] time 0.415 (0.451) data 0.285 (0.321) loss_x loss_x 1.2988 (1.2872) acc_x 75.0000 (66.8750) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [20/32] time 0.446 (0.449) data 0.315 (0.319) loss_x loss_x 1.1221 (1.2719) acc_x 68.7500 (65.9375) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [25/32] time 0.425 (0.456) data 0.295 (0.325) loss_x loss_x 1.1162 (1.2809) acc_x 78.1250 (65.6250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [30/32] time 0.543 (0.452) data 0.413 (0.321) loss_x loss_x 2.0879 (1.3114) acc_x 46.8750 (65.4167) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1643
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1051
clean true:1001
clean false:50
clean_rate:0.9524262607040913
noisy true:492
noisy false:1593
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 2085
epoch [123/200] batch [5/32] time 0.532 (0.460) data 0.402 (0.329) loss_x loss_x 1.9248 (1.5369) acc_x 65.6250 (64.3750) lr 6.7608e-04 eta 0:00:12
epoch [123/200] batch [10/32] time 0.421 (0.444) data 0.290 (0.313) loss_x loss_x 1.4453 (1.4234) acc_x 65.6250 (66.5625) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [15/32] time 0.390 (0.442) data 0.259 (0.312) loss_x loss_x 1.2432 (1.4697) acc_x 71.8750 (64.5833) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [20/32] time 0.428 (0.443) data 0.298 (0.313) loss_x loss_x 0.9482 (1.4563) acc_x 71.8750 (63.9062) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [25/32] time 0.414 (0.447) data 0.284 (0.317) loss_x loss_x 1.7949 (1.4248) acc_x 56.2500 (64.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [30/32] time 0.380 (0.440) data 0.249 (0.310) loss_x loss_x 1.3613 (1.3859) acc_x 62.5000 (65.0000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1642
confident_label rate tensor(0.3268, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1025
clean true:977
clean false:48
clean_rate:0.953170731707317
noisy true:517
noisy false:1594
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 2111
epoch [124/200] batch [5/32] time 0.447 (0.509) data 0.317 (0.379) loss_x loss_x 1.6641 (1.4832) acc_x 62.5000 (63.1250) lr 6.6126e-04 eta 0:00:13
epoch [124/200] batch [10/32] time 0.360 (0.456) data 0.229 (0.326) loss_x loss_x 1.1182 (1.3414) acc_x 78.1250 (67.8125) lr 6.6126e-04 eta 0:00:10
epoch [124/200] batch [15/32] time 0.441 (0.449) data 0.310 (0.318) loss_x loss_x 1.0977 (1.3265) acc_x 78.1250 (66.6667) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [20/32] time 0.364 (0.454) data 0.234 (0.323) loss_x loss_x 1.0303 (1.2876) acc_x 65.6250 (66.5625) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [25/32] time 0.384 (0.452) data 0.254 (0.321) loss_x loss_x 1.2549 (1.3070) acc_x 71.8750 (65.6250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [30/32] time 0.464 (0.450) data 0.333 (0.320) loss_x loss_x 1.2041 (1.3177) acc_x 68.7500 (65.3125) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1582
confident_label rate tensor(0.3466, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1087
clean true:1041
clean false:46
clean_rate:0.9576816927322908
noisy true:513
noisy false:1536
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 2049
epoch [125/200] batch [5/33] time 0.451 (0.417) data 0.321 (0.286) loss_x loss_x 1.4062 (1.3138) acc_x 59.3750 (66.2500) lr 6.4653e-04 eta 0:00:11
epoch [125/200] batch [10/33] time 0.448 (0.426) data 0.318 (0.296) loss_x loss_x 1.2686 (1.2130) acc_x 71.8750 (68.1250) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [15/33] time 0.415 (0.447) data 0.286 (0.316) loss_x loss_x 1.1738 (1.2032) acc_x 71.8750 (69.1667) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [20/33] time 0.458 (0.447) data 0.328 (0.317) loss_x loss_x 0.9546 (1.2661) acc_x 75.0000 (67.5000) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [25/33] time 0.392 (0.442) data 0.262 (0.312) loss_x loss_x 1.2598 (1.2813) acc_x 65.6250 (66.8750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [30/33] time 0.468 (0.442) data 0.338 (0.312) loss_x loss_x 1.0967 (1.2778) acc_x 59.3750 (66.8750) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1599
confident_label rate tensor(0.3406, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1068
clean true:1010
clean false:58
clean_rate:0.9456928838951311
noisy true:527
noisy false:1541
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 2068
epoch [126/200] batch [5/33] time 0.445 (0.414) data 0.315 (0.283) loss_x loss_x 1.1982 (1.4021) acc_x 71.8750 (61.2500) lr 6.3188e-04 eta 0:00:11
epoch [126/200] batch [10/33] time 0.477 (0.431) data 0.346 (0.301) loss_x loss_x 1.4062 (1.3916) acc_x 71.8750 (64.6875) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [15/33] time 0.525 (0.459) data 0.394 (0.328) loss_x loss_x 0.9443 (1.3702) acc_x 78.1250 (64.5833) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [20/33] time 0.406 (0.449) data 0.275 (0.319) loss_x loss_x 0.9600 (1.2941) acc_x 75.0000 (66.0938) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [25/33] time 0.436 (0.449) data 0.305 (0.319) loss_x loss_x 1.2119 (1.2488) acc_x 65.6250 (67.1250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [30/33] time 0.401 (0.440) data 0.270 (0.310) loss_x loss_x 1.6621 (1.2852) acc_x 62.5000 (66.6667) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1600
confident_label rate tensor(0.3390, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1063
clean true:1016
clean false:47
clean_rate:0.955785512699906
noisy true:520
noisy false:1553
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 2073
epoch [127/200] batch [5/33] time 0.339 (0.380) data 0.209 (0.250) loss_x loss_x 0.9971 (1.3062) acc_x 78.1250 (69.3750) lr 6.1732e-04 eta 0:00:10
epoch [127/200] batch [10/33] time 0.443 (0.414) data 0.312 (0.284) loss_x loss_x 1.2773 (1.3067) acc_x 75.0000 (70.0000) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [15/33] time 0.424 (0.418) data 0.293 (0.287) loss_x loss_x 1.3496 (1.2836) acc_x 71.8750 (69.1667) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [20/33] time 0.386 (0.419) data 0.256 (0.289) loss_x loss_x 1.3975 (1.3336) acc_x 65.6250 (68.4375) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [25/33] time 0.473 (0.429) data 0.342 (0.299) loss_x loss_x 1.0713 (1.3219) acc_x 71.8750 (67.2500) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [30/33] time 0.410 (0.441) data 0.279 (0.311) loss_x loss_x 1.4854 (1.2904) acc_x 53.1250 (67.6042) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1632
confident_label rate tensor(0.3316, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1040
clean true:988
clean false:52
clean_rate:0.95
noisy true:516
noisy false:1580
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 2096
epoch [128/200] batch [5/32] time 0.510 (0.493) data 0.380 (0.363) loss_x loss_x 1.6387 (1.3779) acc_x 62.5000 (64.3750) lr 6.0285e-04 eta 0:00:13
epoch [128/200] batch [10/32] time 0.378 (0.449) data 0.248 (0.319) loss_x loss_x 1.6846 (1.2866) acc_x 50.0000 (65.0000) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [15/32] time 0.399 (0.440) data 0.268 (0.310) loss_x loss_x 0.8403 (1.2651) acc_x 78.1250 (67.2917) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [20/32] time 0.452 (0.436) data 0.321 (0.306) loss_x loss_x 1.5430 (1.2851) acc_x 65.6250 (66.7188) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [25/32] time 0.581 (0.433) data 0.452 (0.302) loss_x loss_x 1.5049 (1.2930) acc_x 62.5000 (66.6250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [30/32] time 0.458 (0.429) data 0.329 (0.299) loss_x loss_x 1.2607 (1.2977) acc_x 65.6250 (66.7708) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1644
confident_label rate tensor(0.3355, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1052
clean true:992
clean false:60
clean_rate:0.9429657794676806
noisy true:500
noisy false:1584
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 2084
epoch [129/200] batch [5/32] time 0.425 (0.445) data 0.294 (0.314) loss_x loss_x 1.0156 (1.1215) acc_x 71.8750 (72.5000) lr 5.8849e-04 eta 0:00:12
epoch [129/200] batch [10/32] time 0.359 (0.436) data 0.229 (0.306) loss_x loss_x 1.4756 (1.1306) acc_x 59.3750 (72.8125) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [15/32] time 0.392 (0.447) data 0.261 (0.317) loss_x loss_x 1.1719 (1.1780) acc_x 62.5000 (69.3750) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [20/32] time 0.366 (0.438) data 0.235 (0.308) loss_x loss_x 1.2373 (1.2109) acc_x 68.7500 (68.5938) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [25/32] time 0.367 (0.438) data 0.237 (0.307) loss_x loss_x 1.3408 (1.2461) acc_x 75.0000 (68.7500) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [30/32] time 0.354 (0.440) data 0.224 (0.309) loss_x loss_x 1.5762 (1.2773) acc_x 62.5000 (68.2292) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1014
clean false:43
clean_rate:0.9593188268684958
noisy true:519
noisy false:1560
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [130/200] batch [5/33] time 0.377 (0.431) data 0.247 (0.301) loss_x loss_x 1.4463 (1.2114) acc_x 68.7500 (70.0000) lr 5.7422e-04 eta 0:00:12
epoch [130/200] batch [10/33] time 0.386 (0.449) data 0.256 (0.320) loss_x loss_x 1.5254 (1.2363) acc_x 59.3750 (69.3750) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [15/33] time 0.612 (0.455) data 0.482 (0.325) loss_x loss_x 1.2090 (1.2313) acc_x 65.6250 (69.1667) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [20/33] time 0.427 (0.452) data 0.296 (0.322) loss_x loss_x 0.7739 (1.2290) acc_x 75.0000 (69.0625) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [25/33] time 0.486 (0.457) data 0.355 (0.327) loss_x loss_x 1.7432 (1.2657) acc_x 59.3750 (68.2500) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [30/33] time 0.445 (0.452) data 0.314 (0.322) loss_x loss_x 2.0215 (1.2835) acc_x 59.3750 (67.7083) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1076
clean true:1028
clean false:48
clean_rate:0.9553903345724907
noisy true:501
noisy false:1559
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 2060
epoch [131/200] batch [5/33] time 0.454 (0.402) data 0.324 (0.272) loss_x loss_x 1.1055 (1.2056) acc_x 68.7500 (70.0000) lr 5.6006e-04 eta 0:00:11
epoch [131/200] batch [10/33] time 0.501 (0.423) data 0.370 (0.292) loss_x loss_x 1.1973 (1.2374) acc_x 71.8750 (68.1250) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [15/33] time 0.415 (0.457) data 0.285 (0.327) loss_x loss_x 1.5137 (1.2572) acc_x 68.7500 (67.5000) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [20/33] time 0.452 (0.463) data 0.322 (0.332) loss_x loss_x 1.0557 (1.2436) acc_x 75.0000 (69.0625) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [25/33] time 0.440 (0.450) data 0.311 (0.320) loss_x loss_x 0.7876 (1.2247) acc_x 81.2500 (69.0000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [30/33] time 0.329 (0.439) data 0.199 (0.308) loss_x loss_x 1.2012 (1.2389) acc_x 71.8750 (68.2292) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1591
confident_label rate tensor(0.3399, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1066
clean true:1016
clean false:50
clean_rate:0.9530956848030019
noisy true:529
noisy false:1541
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 2070
epoch [132/200] batch [5/33] time 0.415 (0.414) data 0.282 (0.283) loss_x loss_x 1.4072 (1.3545) acc_x 65.6250 (69.3750) lr 5.4601e-04 eta 0:00:11
epoch [132/200] batch [10/33] time 0.493 (0.415) data 0.363 (0.285) loss_x loss_x 1.1602 (1.3765) acc_x 78.1250 (69.6875) lr 5.4601e-04 eta 0:00:09
epoch [132/200] batch [15/33] time 0.536 (0.428) data 0.407 (0.298) loss_x loss_x 1.4609 (1.3478) acc_x 62.5000 (68.7500) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [20/33] time 0.544 (0.440) data 0.415 (0.310) loss_x loss_x 1.2188 (1.3452) acc_x 62.5000 (68.5938) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [25/33] time 0.456 (0.449) data 0.326 (0.318) loss_x loss_x 0.9141 (1.3242) acc_x 75.0000 (68.5000) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [30/33] time 0.482 (0.448) data 0.352 (0.318) loss_x loss_x 1.5254 (1.3057) acc_x 59.3750 (68.1250) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1549
confident_label rate tensor(0.3508, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1100
clean true:1049
clean false:51
clean_rate:0.9536363636363636
noisy true:538
noisy false:1498
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 2036
epoch [133/200] batch [5/34] time 0.444 (0.449) data 0.314 (0.319) loss_x loss_x 1.2441 (1.2273) acc_x 71.8750 (69.3750) lr 5.3207e-04 eta 0:00:13
epoch [133/200] batch [10/34] time 0.467 (0.435) data 0.337 (0.305) loss_x loss_x 1.4053 (1.3809) acc_x 59.3750 (65.9375) lr 5.3207e-04 eta 0:00:10
epoch [133/200] batch [15/34] time 0.374 (0.433) data 0.243 (0.303) loss_x loss_x 1.6533 (1.3563) acc_x 56.2500 (64.3750) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [20/34] time 0.425 (0.437) data 0.295 (0.307) loss_x loss_x 1.3418 (1.3619) acc_x 75.0000 (65.4688) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [25/34] time 0.436 (0.434) data 0.306 (0.303) loss_x loss_x 1.5508 (1.3599) acc_x 53.1250 (65.0000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [30/34] time 0.468 (0.432) data 0.337 (0.301) loss_x loss_x 1.6865 (1.3421) acc_x 59.3750 (64.7917) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1659
confident_label rate tensor(0.3217, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1009
clean true:955
clean false:54
clean_rate:0.9464816650148662
noisy true:522
noisy false:1605
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 2127
epoch [134/200] batch [5/31] time 0.428 (0.484) data 0.298 (0.353) loss_x loss_x 1.6006 (1.2532) acc_x 59.3750 (68.1250) lr 5.1825e-04 eta 0:00:12
epoch [134/200] batch [10/31] time 0.429 (0.507) data 0.299 (0.376) loss_x loss_x 1.3105 (1.2701) acc_x 68.7500 (66.5625) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [15/31] time 0.427 (0.479) data 0.297 (0.348) loss_x loss_x 1.1074 (1.2160) acc_x 65.6250 (67.0833) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [20/31] time 0.469 (0.464) data 0.338 (0.334) loss_x loss_x 1.0576 (1.2269) acc_x 71.8750 (67.5000) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [25/31] time 0.384 (0.465) data 0.253 (0.335) loss_x loss_x 1.6543 (1.1971) acc_x 59.3750 (68.1250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [30/31] time 0.369 (0.457) data 0.239 (0.327) loss_x loss_x 1.2549 (1.2201) acc_x 62.5000 (67.7083) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1634
confident_label rate tensor(0.3294, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1033
clean true:983
clean false:50
clean_rate:0.9515972894482091
noisy true:519
noisy false:1584
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 2103
epoch [135/200] batch [5/32] time 0.411 (0.436) data 0.280 (0.306) loss_x loss_x 1.0166 (1.2916) acc_x 75.0000 (68.7500) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [10/32] time 0.441 (0.435) data 0.310 (0.304) loss_x loss_x 1.0527 (1.3021) acc_x 62.5000 (66.8750) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [15/32] time 0.409 (0.429) data 0.278 (0.299) loss_x loss_x 1.5342 (1.3023) acc_x 65.6250 (67.0833) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [20/32] time 0.486 (0.441) data 0.356 (0.310) loss_x loss_x 1.1592 (1.3145) acc_x 71.8750 (66.7188) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [25/32] time 0.383 (0.431) data 0.252 (0.301) loss_x loss_x 1.5312 (1.2895) acc_x 68.7500 (67.3750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [30/32] time 0.369 (0.429) data 0.239 (0.299) loss_x loss_x 1.5957 (1.3132) acc_x 71.8750 (67.0833) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1633
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1008
clean false:50
clean_rate:0.9527410207939508
noisy true:495
noisy false:1583
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [136/200] batch [5/33] time 0.543 (0.483) data 0.413 (0.353) loss_x loss_x 0.7852 (1.1807) acc_x 84.3750 (70.6250) lr 4.9096e-04 eta 0:00:13
epoch [136/200] batch [10/33] time 0.526 (0.453) data 0.396 (0.323) loss_x loss_x 1.0508 (1.2958) acc_x 71.8750 (66.5625) lr 4.9096e-04 eta 0:00:10
epoch [136/200] batch [15/33] time 0.452 (0.456) data 0.323 (0.326) loss_x loss_x 1.2979 (1.2610) acc_x 68.7500 (68.1250) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [20/33] time 0.369 (0.449) data 0.239 (0.319) loss_x loss_x 1.1416 (1.2778) acc_x 62.5000 (67.5000) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [25/33] time 0.411 (0.441) data 0.281 (0.311) loss_x loss_x 1.2793 (1.2572) acc_x 65.6250 (67.3750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [30/33] time 0.457 (0.439) data 0.326 (0.309) loss_x loss_x 0.8057 (1.2582) acc_x 84.3750 (67.1875) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1082
clean true:1030
clean false:52
clean_rate:0.9519408502772643
noisy true:503
noisy false:1551
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 2054
epoch [137/200] batch [5/33] time 0.421 (0.492) data 0.291 (0.361) loss_x loss_x 1.4580 (1.2190) acc_x 65.6250 (70.6250) lr 4.7750e-04 eta 0:00:13
epoch [137/200] batch [10/33] time 0.399 (0.452) data 0.268 (0.322) loss_x loss_x 1.2803 (1.3156) acc_x 65.6250 (67.8125) lr 4.7750e-04 eta 0:00:10
epoch [137/200] batch [15/33] time 0.404 (0.452) data 0.273 (0.321) loss_x loss_x 0.8652 (1.3037) acc_x 78.1250 (67.5000) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [20/33] time 0.462 (0.450) data 0.331 (0.319) loss_x loss_x 0.9780 (1.2487) acc_x 71.8750 (67.9688) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [25/33] time 0.558 (0.446) data 0.428 (0.315) loss_x loss_x 1.6904 (1.2823) acc_x 65.6250 (67.3750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [30/33] time 0.382 (0.448) data 0.252 (0.317) loss_x loss_x 1.0967 (1.2734) acc_x 65.6250 (67.3958) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1593
confident_label rate tensor(0.3310, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1038
clean true:997
clean false:41
clean_rate:0.9605009633911368
noisy true:546
noisy false:1552
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 2098
epoch [138/200] batch [5/32] time 0.443 (0.456) data 0.312 (0.326) loss_x loss_x 1.0449 (1.3025) acc_x 71.8750 (66.2500) lr 4.6417e-04 eta 0:00:12
epoch [138/200] batch [10/32] time 0.433 (0.463) data 0.303 (0.333) loss_x loss_x 1.1299 (1.3006) acc_x 68.7500 (67.5000) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [15/32] time 0.390 (0.448) data 0.259 (0.318) loss_x loss_x 1.1445 (1.2651) acc_x 62.5000 (67.5000) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [20/32] time 0.396 (0.450) data 0.266 (0.320) loss_x loss_x 1.6816 (1.3001) acc_x 50.0000 (65.1562) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [25/32] time 0.357 (0.442) data 0.226 (0.312) loss_x loss_x 1.4746 (1.3200) acc_x 62.5000 (64.8750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [30/32] time 0.477 (0.444) data 0.347 (0.313) loss_x loss_x 0.9165 (1.2788) acc_x 75.0000 (66.1458) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1632
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1004
clean false:53
clean_rate:0.9498580889309366
noisy true:500
noisy false:1579
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [139/200] batch [5/33] time 0.438 (0.432) data 0.308 (0.302) loss_x loss_x 1.5908 (1.1646) acc_x 68.7500 (76.2500) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [10/33] time 0.430 (0.426) data 0.300 (0.296) loss_x loss_x 1.5088 (1.3122) acc_x 56.2500 (69.6875) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [15/33] time 0.441 (0.427) data 0.310 (0.297) loss_x loss_x 1.1201 (1.3411) acc_x 71.8750 (67.5000) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [20/33] time 0.654 (0.448) data 0.524 (0.318) loss_x loss_x 0.8032 (1.2587) acc_x 81.2500 (68.7500) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [25/33] time 0.540 (0.442) data 0.410 (0.312) loss_x loss_x 0.6509 (1.2734) acc_x 84.3750 (68.3750) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [30/33] time 0.458 (0.448) data 0.327 (0.318) loss_x loss_x 1.7119 (1.2822) acc_x 65.6250 (67.8125) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1614
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1051
clean true:1009
clean false:42
clean_rate:0.9600380589914367
noisy true:513
noisy false:1572
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 2085
epoch [140/200] batch [5/32] time 0.402 (0.443) data 0.271 (0.313) loss_x loss_x 2.0039 (1.4650) acc_x 46.8750 (60.6250) lr 4.3792e-04 eta 0:00:11
epoch [140/200] batch [10/32] time 0.500 (0.465) data 0.370 (0.334) loss_x loss_x 1.2402 (1.3864) acc_x 65.6250 (63.1250) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [15/32] time 0.372 (0.450) data 0.242 (0.320) loss_x loss_x 0.9194 (1.3554) acc_x 84.3750 (65.6250) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [20/32] time 0.539 (0.463) data 0.404 (0.333) loss_x loss_x 1.3311 (1.3043) acc_x 56.2500 (66.2500) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [25/32] time 0.379 (0.460) data 0.249 (0.329) loss_x loss_x 1.0469 (1.2794) acc_x 75.0000 (66.0000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [30/32] time 0.405 (0.461) data 0.274 (0.330) loss_x loss_x 1.1436 (1.2933) acc_x 71.8750 (65.9375) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1578
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1080
clean true:1027
clean false:53
clean_rate:0.950925925925926
noisy true:531
noisy false:1525
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 2056
epoch [141/200] batch [5/33] time 0.380 (0.404) data 0.251 (0.274) loss_x loss_x 1.8721 (1.6295) acc_x 53.1250 (58.7500) lr 4.2499e-04 eta 0:00:11
epoch [141/200] batch [10/33] time 0.591 (0.475) data 0.460 (0.346) loss_x loss_x 0.7178 (1.3681) acc_x 78.1250 (65.3125) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [15/33] time 0.335 (0.470) data 0.204 (0.340) loss_x loss_x 1.0068 (1.2585) acc_x 71.8750 (68.1250) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [20/33] time 0.419 (0.473) data 0.290 (0.342) loss_x loss_x 0.7974 (1.2167) acc_x 78.1250 (68.7500) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [25/33] time 0.407 (0.458) data 0.278 (0.328) loss_x loss_x 1.4346 (1.2374) acc_x 59.3750 (67.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [30/33] time 0.447 (0.448) data 0.317 (0.318) loss_x loss_x 1.3037 (1.2829) acc_x 59.3750 (67.0833) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1596
confident_label rate tensor(0.3473, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1089
clean true:1034
clean false:55
clean_rate:0.9494949494949495
noisy true:506
noisy false:1541
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 2047
epoch [142/200] batch [5/34] time 0.332 (0.453) data 0.203 (0.323) loss_x loss_x 1.2559 (1.1672) acc_x 68.7500 (66.2500) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [10/34] time 0.411 (0.447) data 0.281 (0.317) loss_x loss_x 1.2158 (1.3354) acc_x 68.7500 (64.0625) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [15/34] time 0.514 (0.450) data 0.384 (0.320) loss_x loss_x 1.2041 (1.3706) acc_x 68.7500 (62.9167) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [20/34] time 0.404 (0.444) data 0.274 (0.314) loss_x loss_x 1.3076 (1.3693) acc_x 68.7500 (64.0625) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [25/34] time 0.381 (0.439) data 0.251 (0.309) loss_x loss_x 0.9976 (1.3721) acc_x 71.8750 (64.5000) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [30/34] time 0.674 (0.446) data 0.545 (0.317) loss_x loss_x 1.3125 (1.3976) acc_x 62.5000 (64.1667) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1613
confident_label rate tensor(0.3371, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1057
clean true:1003
clean false:54
clean_rate:0.9489120151371807
noisy true:520
noisy false:1559
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 2079
epoch [143/200] batch [5/33] time 0.405 (0.408) data 0.275 (0.278) loss_x loss_x 1.9600 (1.3090) acc_x 56.2500 (66.8750) lr 3.9958e-04 eta 0:00:11
epoch [143/200] batch [10/33] time 0.412 (0.414) data 0.282 (0.284) loss_x loss_x 0.8872 (1.2261) acc_x 75.0000 (68.7500) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [15/33] time 0.502 (0.428) data 0.372 (0.298) loss_x loss_x 1.2158 (1.2016) acc_x 68.7500 (70.8333) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [20/33] time 0.404 (0.425) data 0.273 (0.294) loss_x loss_x 0.8647 (1.1528) acc_x 75.0000 (71.0938) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [25/33] time 0.441 (0.430) data 0.312 (0.300) loss_x loss_x 1.8008 (1.1915) acc_x 56.2500 (69.0000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [30/33] time 0.480 (0.437) data 0.350 (0.307) loss_x loss_x 1.8135 (1.2044) acc_x 40.6250 (68.1250) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1587
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1012
clean false:46
clean_rate:0.9565217391304348
noisy true:537
noisy false:1541
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [144/200] batch [5/33] time 0.501 (0.454) data 0.372 (0.324) loss_x loss_x 1.0156 (1.3385) acc_x 78.1250 (66.8750) lr 3.8709e-04 eta 0:00:12
epoch [144/200] batch [10/33] time 0.475 (0.464) data 0.345 (0.334) loss_x loss_x 0.9487 (1.2511) acc_x 78.1250 (67.5000) lr 3.8709e-04 eta 0:00:10
epoch [144/200] batch [15/33] time 0.490 (0.471) data 0.361 (0.341) loss_x loss_x 0.8633 (1.2030) acc_x 78.1250 (69.7917) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [20/33] time 0.499 (0.456) data 0.369 (0.326) loss_x loss_x 1.5859 (1.2233) acc_x 65.6250 (68.9062) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [25/33] time 0.485 (0.459) data 0.355 (0.329) loss_x loss_x 1.0117 (1.2368) acc_x 68.7500 (67.6250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [30/33] time 0.482 (0.470) data 0.352 (0.340) loss_x loss_x 1.1934 (1.2880) acc_x 56.2500 (66.4583) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3386, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1062
clean true:1009
clean false:53
clean_rate:0.9500941619585688
noisy true:498
noisy false:1576
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 2074
epoch [145/200] batch [5/33] time 0.449 (0.457) data 0.318 (0.327) loss_x loss_x 1.2744 (1.2625) acc_x 68.7500 (68.7500) lr 3.7476e-04 eta 0:00:12
epoch [145/200] batch [10/33] time 0.495 (0.441) data 0.365 (0.310) loss_x loss_x 1.6426 (1.3605) acc_x 59.3750 (63.4375) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [15/33] time 0.418 (0.430) data 0.287 (0.299) loss_x loss_x 1.2871 (1.3654) acc_x 62.5000 (63.3333) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [20/33] time 0.503 (0.426) data 0.373 (0.296) loss_x loss_x 0.9443 (1.3297) acc_x 68.7500 (64.2188) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [25/33] time 0.485 (0.441) data 0.355 (0.311) loss_x loss_x 1.2480 (1.3141) acc_x 62.5000 (65.0000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [30/33] time 0.411 (0.446) data 0.281 (0.316) loss_x loss_x 1.3086 (1.3151) acc_x 68.7500 (65.2083) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3310, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1038
clean true:985
clean false:53
clean_rate:0.9489402697495183
noisy true:522
noisy false:1576
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 2098
epoch [146/200] batch [5/32] time 0.527 (0.436) data 0.397 (0.307) loss_x loss_x 0.9751 (1.0707) acc_x 78.1250 (73.1250) lr 3.6258e-04 eta 0:00:11
epoch [146/200] batch [10/32] time 0.445 (0.454) data 0.316 (0.324) loss_x loss_x 1.2803 (1.2974) acc_x 68.7500 (65.9375) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [15/32] time 0.554 (0.460) data 0.424 (0.330) loss_x loss_x 1.3760 (1.3296) acc_x 65.6250 (65.0000) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [20/32] time 0.435 (0.447) data 0.305 (0.317) loss_x loss_x 0.8706 (1.3042) acc_x 75.0000 (65.7812) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [25/32] time 0.360 (0.455) data 0.230 (0.325) loss_x loss_x 1.6377 (1.2896) acc_x 50.0000 (66.0000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [30/32] time 0.579 (0.467) data 0.448 (0.336) loss_x loss_x 0.8926 (1.2595) acc_x 78.1250 (66.5625) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1570
confident_label rate tensor(0.3476, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1090
clean true:1038
clean false:52
clean_rate:0.9522935779816514
noisy true:528
noisy false:1518
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 2046
epoch [147/200] batch [5/34] time 0.538 (0.469) data 0.408 (0.339) loss_x loss_x 1.2070 (1.1314) acc_x 71.8750 (71.8750) lr 3.5055e-04 eta 0:00:13
epoch [147/200] batch [10/34] time 0.529 (0.485) data 0.398 (0.355) loss_x loss_x 1.4775 (1.1356) acc_x 53.1250 (69.3750) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [15/34] time 0.374 (0.477) data 0.243 (0.346) loss_x loss_x 1.3096 (1.1592) acc_x 71.8750 (71.0417) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [20/34] time 0.408 (0.466) data 0.277 (0.335) loss_x loss_x 1.6377 (1.2170) acc_x 59.3750 (69.3750) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [25/34] time 0.461 (0.459) data 0.331 (0.329) loss_x loss_x 1.2607 (1.2170) acc_x 62.5000 (68.7500) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [30/34] time 0.415 (0.458) data 0.284 (0.327) loss_x loss_x 1.6631 (1.2427) acc_x 59.3750 (67.8125) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1649
confident_label rate tensor(0.3320, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1041
clean true:992
clean false:49
clean_rate:0.9529298751200769
noisy true:495
noisy false:1600
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 2095
epoch [148/200] batch [5/32] time 0.500 (0.461) data 0.369 (0.331) loss_x loss_x 1.0625 (1.1379) acc_x 71.8750 (70.6250) lr 3.3869e-04 eta 0:00:12
epoch [148/200] batch [10/32] time 0.648 (0.467) data 0.517 (0.337) loss_x loss_x 1.1201 (1.1828) acc_x 78.1250 (70.0000) lr 3.3869e-04 eta 0:00:10
epoch [148/200] batch [15/32] time 0.502 (0.464) data 0.372 (0.334) loss_x loss_x 1.0342 (1.1483) acc_x 78.1250 (70.0000) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [20/32] time 0.389 (0.457) data 0.258 (0.327) loss_x loss_x 1.2578 (1.1694) acc_x 62.5000 (69.2188) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [25/32] time 0.422 (0.456) data 0.291 (0.326) loss_x loss_x 0.8052 (1.1652) acc_x 75.0000 (68.8750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [30/32] time 0.406 (0.460) data 0.276 (0.329) loss_x loss_x 1.2373 (1.1735) acc_x 65.6250 (68.9583) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1624
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1002
clean false:56
clean_rate:0.947069943289225
noisy true:510
noisy false:1568
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [149/200] batch [5/33] time 0.396 (0.423) data 0.265 (0.293) loss_x loss_x 1.3369 (1.3588) acc_x 68.7500 (63.1250) lr 3.2699e-04 eta 0:00:11
epoch [149/200] batch [10/33] time 0.459 (0.430) data 0.328 (0.299) loss_x loss_x 0.9683 (1.3378) acc_x 78.1250 (63.1250) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [15/33] time 0.526 (0.425) data 0.395 (0.294) loss_x loss_x 0.9429 (1.3495) acc_x 84.3750 (63.3333) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [20/33] time 0.386 (0.427) data 0.256 (0.297) loss_x loss_x 0.7559 (1.3004) acc_x 75.0000 (66.2500) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [25/33] time 0.470 (0.433) data 0.339 (0.303) loss_x loss_x 1.3281 (1.3154) acc_x 68.7500 (66.1250) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [30/33] time 0.425 (0.433) data 0.294 (0.302) loss_x loss_x 1.2617 (1.3081) acc_x 68.7500 (66.0417) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1605
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1077
clean true:1016
clean false:61
clean_rate:0.9433611884865367
noisy true:515
noisy false:1544
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 2059
epoch [150/200] batch [5/33] time 0.466 (0.462) data 0.336 (0.332) loss_x loss_x 1.1152 (1.2233) acc_x 68.7500 (63.7500) lr 3.1545e-04 eta 0:00:12
epoch [150/200] batch [10/33] time 0.396 (0.463) data 0.266 (0.332) loss_x loss_x 1.4326 (1.1796) acc_x 59.3750 (66.5625) lr 3.1545e-04 eta 0:00:10
epoch [150/200] batch [15/33] time 0.494 (0.453) data 0.364 (0.323) loss_x loss_x 1.5986 (1.2705) acc_x 53.1250 (64.1667) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [20/33] time 0.502 (0.453) data 0.372 (0.323) loss_x loss_x 1.6943 (1.2819) acc_x 56.2500 (64.0625) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [25/33] time 0.409 (0.455) data 0.279 (0.324) loss_x loss_x 1.6406 (1.3002) acc_x 59.3750 (64.6250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [30/33] time 0.635 (0.455) data 0.504 (0.325) loss_x loss_x 1.1123 (1.3242) acc_x 68.7500 (63.4375) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1608
confident_label rate tensor(0.3386, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1062
clean true:1003
clean false:59
clean_rate:0.9444444444444444
noisy true:525
noisy false:1549
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 2074
epoch [151/200] batch [5/33] time 0.411 (0.460) data 0.281 (0.329) loss_x loss_x 1.1211 (1.2812) acc_x 68.7500 (67.5000) lr 3.0409e-04 eta 0:00:12
epoch [151/200] batch [10/33] time 0.396 (0.451) data 0.265 (0.321) loss_x loss_x 1.6602 (1.3381) acc_x 62.5000 (65.9375) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [15/33] time 0.341 (0.437) data 0.211 (0.307) loss_x loss_x 1.8623 (1.3594) acc_x 46.8750 (64.1667) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [20/33] time 0.383 (0.432) data 0.253 (0.302) loss_x loss_x 1.0771 (1.3035) acc_x 68.7500 (65.4688) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [25/33] time 0.451 (0.448) data 0.321 (0.317) loss_x loss_x 1.1035 (1.2998) acc_x 65.6250 (66.3750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [30/33] time 0.521 (0.451) data 0.391 (0.321) loss_x loss_x 2.0859 (1.3251) acc_x 56.2500 (66.4583) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1612
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1082
clean true:1036
clean false:46
clean_rate:0.9574861367837338
noisy true:488
noisy false:1566
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 2054
epoch [152/200] batch [5/33] time 0.548 (0.463) data 0.418 (0.333) loss_x loss_x 1.8984 (1.5432) acc_x 68.7500 (68.7500) lr 2.9289e-04 eta 0:00:12
epoch [152/200] batch [10/33] time 0.480 (0.471) data 0.350 (0.342) loss_x loss_x 1.5781 (1.4678) acc_x 56.2500 (66.2500) lr 2.9289e-04 eta 0:00:10
epoch [152/200] batch [15/33] time 0.400 (0.456) data 0.269 (0.326) loss_x loss_x 0.9927 (1.3593) acc_x 78.1250 (68.5417) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [20/33] time 0.410 (0.448) data 0.280 (0.318) loss_x loss_x 1.1602 (1.3405) acc_x 71.8750 (68.4375) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [25/33] time 0.333 (0.445) data 0.203 (0.315) loss_x loss_x 1.3701 (1.3444) acc_x 65.6250 (67.8750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [30/33] time 0.385 (0.440) data 0.255 (0.310) loss_x loss_x 1.2705 (1.3184) acc_x 65.6250 (68.3333) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1575
confident_label rate tensor(0.3530, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1107
clean true:1050
clean false:57
clean_rate:0.948509485094851
noisy true:511
noisy false:1518
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 2029
epoch [153/200] batch [5/34] time 0.353 (0.475) data 0.222 (0.345) loss_x loss_x 1.5469 (1.4535) acc_x 71.8750 (66.8750) lr 2.8187e-04 eta 0:00:13
epoch [153/200] batch [10/34] time 0.473 (0.458) data 0.343 (0.328) loss_x loss_x 1.0713 (1.2874) acc_x 68.7500 (68.7500) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [15/34] time 0.432 (0.443) data 0.303 (0.313) loss_x loss_x 1.1602 (1.2802) acc_x 71.8750 (68.9583) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [20/34] time 0.449 (0.445) data 0.318 (0.315) loss_x loss_x 1.1074 (1.2615) acc_x 84.3750 (70.1562) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [25/34] time 0.410 (0.449) data 0.279 (0.319) loss_x loss_x 1.0234 (1.2683) acc_x 75.0000 (69.7500) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [30/34] time 0.459 (0.447) data 0.328 (0.317) loss_x loss_x 1.0742 (1.2674) acc_x 75.0000 (69.5833) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3393, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1064
clean true:1011
clean false:53
clean_rate:0.950187969924812
noisy true:496
noisy false:1576
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 2072
epoch [154/200] batch [5/33] time 0.410 (0.409) data 0.279 (0.279) loss_x loss_x 1.1064 (1.3430) acc_x 65.6250 (66.2500) lr 2.7103e-04 eta 0:00:11
epoch [154/200] batch [10/33] time 0.361 (0.421) data 0.231 (0.291) loss_x loss_x 1.0771 (1.3052) acc_x 68.7500 (65.9375) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [15/33] time 0.606 (0.434) data 0.475 (0.303) loss_x loss_x 1.0703 (1.2926) acc_x 71.8750 (67.0833) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [20/33] time 0.555 (0.442) data 0.425 (0.312) loss_x loss_x 0.8047 (1.2997) acc_x 87.5000 (68.5938) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [25/33] time 0.430 (0.441) data 0.299 (0.310) loss_x loss_x 1.1875 (1.2761) acc_x 59.3750 (68.6250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [30/33] time 0.459 (0.439) data 0.329 (0.308) loss_x loss_x 1.7988 (1.3105) acc_x 62.5000 (67.1875) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1083
clean true:1023
clean false:60
clean_rate:0.9445983379501385
noisy true:523
noisy false:1530
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 2053
epoch [155/200] batch [5/33] time 0.496 (0.436) data 0.365 (0.306) loss_x loss_x 1.2578 (1.3826) acc_x 62.5000 (63.7500) lr 2.6037e-04 eta 0:00:12
epoch [155/200] batch [10/33] time 0.435 (0.425) data 0.305 (0.295) loss_x loss_x 1.7119 (1.3483) acc_x 62.5000 (65.6250) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [15/33] time 0.408 (0.444) data 0.278 (0.314) loss_x loss_x 1.1084 (1.3346) acc_x 68.7500 (66.2500) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [20/33] time 0.491 (0.441) data 0.361 (0.311) loss_x loss_x 1.5889 (1.3102) acc_x 71.8750 (67.1875) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [25/33] time 0.394 (0.446) data 0.264 (0.316) loss_x loss_x 1.5039 (1.2953) acc_x 53.1250 (67.2500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [30/33] time 0.433 (0.442) data 0.303 (0.312) loss_x loss_x 0.8564 (1.2728) acc_x 78.1250 (68.3333) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1595
confident_label rate tensor(0.3313, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1039
clean true:994
clean false:45
clean_rate:0.9566891241578441
noisy true:547
noisy false:1550
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 2097
epoch [156/200] batch [5/32] time 0.473 (0.468) data 0.343 (0.338) loss_x loss_x 1.0645 (1.3117) acc_x 65.6250 (65.0000) lr 2.4989e-04 eta 0:00:12
epoch [156/200] batch [10/32] time 0.428 (0.480) data 0.298 (0.350) loss_x loss_x 0.9917 (1.1674) acc_x 75.0000 (68.7500) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [15/32] time 0.429 (0.467) data 0.298 (0.337) loss_x loss_x 1.7959 (1.2274) acc_x 59.3750 (67.9167) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [20/32] time 0.602 (0.475) data 0.472 (0.345) loss_x loss_x 1.4346 (1.2088) acc_x 71.8750 (70.3125) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [25/32] time 0.492 (0.479) data 0.362 (0.348) loss_x loss_x 1.1865 (1.2548) acc_x 68.7500 (69.2500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [30/32] time 0.413 (0.469) data 0.283 (0.339) loss_x loss_x 1.0869 (1.2438) acc_x 71.8750 (69.5833) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1635
confident_label rate tensor(0.3406, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1068
clean true:1021
clean false:47
clean_rate:0.9559925093632958
noisy true:480
noisy false:1588
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 2068
epoch [157/200] batch [5/33] time 0.493 (0.434) data 0.363 (0.304) loss_x loss_x 1.6211 (1.5245) acc_x 65.6250 (66.2500) lr 2.3959e-04 eta 0:00:12
epoch [157/200] batch [10/33] time 0.401 (0.443) data 0.271 (0.312) loss_x loss_x 1.4141 (1.3929) acc_x 75.0000 (69.3750) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [15/33] time 0.436 (0.432) data 0.306 (0.302) loss_x loss_x 1.0605 (1.2714) acc_x 71.8750 (71.2500) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [20/33] time 0.616 (0.449) data 0.486 (0.319) loss_x loss_x 0.9775 (1.2579) acc_x 71.8750 (70.9375) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [25/33] time 0.455 (0.458) data 0.324 (0.327) loss_x loss_x 1.2256 (1.2732) acc_x 71.8750 (69.8750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [30/33] time 0.429 (0.462) data 0.298 (0.331) loss_x loss_x 1.1279 (1.2898) acc_x 71.8750 (69.1667) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1614
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1077
clean true:1019
clean false:58
clean_rate:0.9461467038068709
noisy true:503
noisy false:1556
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 2059
epoch [158/200] batch [5/33] time 0.380 (0.432) data 0.249 (0.302) loss_x loss_x 0.6504 (1.1936) acc_x 78.1250 (70.0000) lr 2.2949e-04 eta 0:00:12
epoch [158/200] batch [10/33] time 0.398 (0.453) data 0.267 (0.322) loss_x loss_x 1.2812 (1.2960) acc_x 62.5000 (65.6250) lr 2.2949e-04 eta 0:00:10
epoch [158/200] batch [15/33] time 0.422 (0.469) data 0.291 (0.339) loss_x loss_x 0.5918 (1.1625) acc_x 87.5000 (69.5833) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [20/33] time 0.429 (0.471) data 0.298 (0.340) loss_x loss_x 1.7549 (1.2220) acc_x 62.5000 (67.3438) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [25/33] time 0.675 (0.477) data 0.545 (0.346) loss_x loss_x 1.3174 (1.2417) acc_x 65.6250 (67.1250) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [30/33] time 0.447 (0.474) data 0.316 (0.344) loss_x loss_x 1.6260 (1.2337) acc_x 59.3750 (68.0208) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1601
confident_label rate tensor(0.3390, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1063
clean true:1014
clean false:49
clean_rate:0.9539040451552211
noisy true:521
noisy false:1552
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 2073
epoch [159/200] batch [5/33] time 0.431 (0.431) data 0.301 (0.301) loss_x loss_x 0.6250 (1.1756) acc_x 81.2500 (71.8750) lr 2.1957e-04 eta 0:00:12
epoch [159/200] batch [10/33] time 0.419 (0.441) data 0.289 (0.311) loss_x loss_x 1.4297 (1.1565) acc_x 56.2500 (70.0000) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [15/33] time 0.400 (0.432) data 0.270 (0.301) loss_x loss_x 1.0146 (1.2003) acc_x 71.8750 (68.7500) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [20/33] time 0.436 (0.430) data 0.305 (0.299) loss_x loss_x 1.3037 (1.1596) acc_x 68.7500 (69.5312) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [25/33] time 0.566 (0.432) data 0.435 (0.302) loss_x loss_x 1.2998 (1.1911) acc_x 62.5000 (68.7500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [30/33] time 0.580 (0.436) data 0.449 (0.305) loss_x loss_x 1.0293 (1.1878) acc_x 81.2500 (68.7500) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1617
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1077
clean true:1017
clean false:60
clean_rate:0.9442896935933147
noisy true:502
noisy false:1557
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 2059
epoch [160/200] batch [5/33] time 0.424 (0.390) data 0.294 (0.260) loss_x loss_x 1.3047 (1.4035) acc_x 62.5000 (68.7500) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [10/33] time 0.419 (0.419) data 0.289 (0.288) loss_x loss_x 1.3047 (1.4333) acc_x 65.6250 (65.9375) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [15/33] time 0.411 (0.421) data 0.280 (0.290) loss_x loss_x 1.0879 (1.4040) acc_x 75.0000 (66.6667) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [20/33] time 0.397 (0.426) data 0.267 (0.296) loss_x loss_x 1.3096 (1.3674) acc_x 68.7500 (67.0312) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [25/33] time 0.577 (0.428) data 0.447 (0.298) loss_x loss_x 1.1045 (1.3253) acc_x 68.7500 (67.8750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [30/33] time 0.473 (0.436) data 0.343 (0.306) loss_x loss_x 0.7334 (1.2991) acc_x 84.3750 (68.1250) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1083
clean true:1029
clean false:54
clean_rate:0.9501385041551247
noisy true:500
noisy false:1553
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 2053
epoch [161/200] batch [5/33] time 0.453 (0.470) data 0.323 (0.339) loss_x loss_x 1.1143 (1.2230) acc_x 71.8750 (71.2500) lr 2.0032e-04 eta 0:00:13
epoch [161/200] batch [10/33] time 0.430 (0.455) data 0.300 (0.324) loss_x loss_x 0.9917 (1.2306) acc_x 75.0000 (72.1875) lr 2.0032e-04 eta 0:00:10
epoch [161/200] batch [15/33] time 0.468 (0.461) data 0.339 (0.331) loss_x loss_x 0.7515 (1.1670) acc_x 78.1250 (71.6667) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [20/33] time 0.501 (0.459) data 0.372 (0.329) loss_x loss_x 0.8320 (1.1881) acc_x 75.0000 (70.3125) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [25/33] time 0.458 (0.454) data 0.327 (0.324) loss_x loss_x 1.4268 (1.2078) acc_x 62.5000 (69.2500) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [30/33] time 0.506 (0.451) data 0.376 (0.321) loss_x loss_x 1.2100 (1.1977) acc_x 62.5000 (68.8542) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1614
confident_label rate tensor(0.3342, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1048
clean true:997
clean false:51
clean_rate:0.9513358778625954
noisy true:525
noisy false:1563
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 2088
epoch [162/200] batch [5/32] time 0.448 (0.471) data 0.318 (0.341) loss_x loss_x 1.0088 (1.0090) acc_x 71.8750 (75.6250) lr 1.9098e-04 eta 0:00:12
epoch [162/200] batch [10/32] time 0.459 (0.458) data 0.329 (0.327) loss_x loss_x 1.3701 (1.2110) acc_x 65.6250 (69.3750) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [15/32] time 0.336 (0.442) data 0.207 (0.311) loss_x loss_x 0.7500 (1.1523) acc_x 75.0000 (70.2083) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [20/32] time 0.415 (0.446) data 0.285 (0.316) loss_x loss_x 1.4590 (1.1728) acc_x 62.5000 (70.3125) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [25/32] time 0.436 (0.450) data 0.306 (0.320) loss_x loss_x 1.3252 (1.2154) acc_x 62.5000 (68.7500) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [30/32] time 0.461 (0.447) data 0.332 (0.317) loss_x loss_x 1.2402 (1.2239) acc_x 62.5000 (68.5417) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1626
confident_label rate tensor(0.3390, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1063
clean true:1018
clean false:45
clean_rate:0.9576669802445907
noisy true:492
noisy false:1581
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 2073
epoch [163/200] batch [5/33] time 0.408 (0.453) data 0.278 (0.323) loss_x loss_x 1.2871 (1.1531) acc_x 65.6250 (71.2500) lr 1.8185e-04 eta 0:00:12
epoch [163/200] batch [10/33] time 0.589 (0.481) data 0.458 (0.351) loss_x loss_x 1.1211 (1.1937) acc_x 75.0000 (70.0000) lr 1.8185e-04 eta 0:00:11
epoch [163/200] batch [15/33] time 0.416 (0.461) data 0.285 (0.331) loss_x loss_x 0.9907 (1.2019) acc_x 71.8750 (69.3750) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [20/33] time 0.358 (0.455) data 0.228 (0.324) loss_x loss_x 1.0928 (1.1741) acc_x 68.7500 (69.2188) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [25/33] time 0.423 (0.449) data 0.293 (0.319) loss_x loss_x 1.3311 (1.2100) acc_x 56.2500 (68.3750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [30/33] time 0.487 (0.448) data 0.357 (0.317) loss_x loss_x 1.4014 (1.2119) acc_x 56.2500 (68.0208) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1592
confident_label rate tensor(0.3415, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1071
clean true:1019
clean false:52
clean_rate:0.9514472455648926
noisy true:525
noisy false:1540
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 2065
epoch [164/200] batch [5/33] time 0.462 (0.421) data 0.331 (0.291) loss_x loss_x 1.3838 (1.3422) acc_x 71.8750 (68.7500) lr 1.7292e-04 eta 0:00:11
epoch [164/200] batch [10/33] time 0.409 (0.421) data 0.279 (0.290) loss_x loss_x 0.9961 (1.2315) acc_x 75.0000 (67.5000) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [15/33] time 0.562 (0.445) data 0.432 (0.314) loss_x loss_x 1.0332 (1.2011) acc_x 75.0000 (68.9583) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [20/33] time 0.433 (0.455) data 0.303 (0.324) loss_x loss_x 1.1123 (1.2030) acc_x 71.8750 (69.8438) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [25/33] time 0.487 (0.455) data 0.358 (0.324) loss_x loss_x 1.1914 (1.2322) acc_x 75.0000 (69.5000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [30/33] time 0.499 (0.452) data 0.369 (0.321) loss_x loss_x 1.1553 (1.2409) acc_x 68.7500 (68.5417) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1609
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1075
clean true:1019
clean false:56
clean_rate:0.947906976744186
noisy true:508
noisy false:1553
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 2061
epoch [165/200] batch [5/33] time 0.458 (0.462) data 0.328 (0.332) loss_x loss_x 1.1406 (1.1617) acc_x 78.1250 (70.0000) lr 1.6419e-04 eta 0:00:12
epoch [165/200] batch [10/33] time 0.493 (0.471) data 0.362 (0.341) loss_x loss_x 1.2295 (1.2057) acc_x 71.8750 (69.3750) lr 1.6419e-04 eta 0:00:10
epoch [165/200] batch [15/33] time 0.450 (0.456) data 0.320 (0.326) loss_x loss_x 1.2119 (1.2974) acc_x 68.7500 (67.5000) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [20/33] time 0.493 (0.460) data 0.363 (0.329) loss_x loss_x 1.3291 (1.3120) acc_x 65.6250 (66.7188) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [25/33] time 0.568 (0.465) data 0.438 (0.334) loss_x loss_x 0.8110 (1.2588) acc_x 75.0000 (68.0000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [30/33] time 0.474 (0.467) data 0.344 (0.337) loss_x loss_x 1.9746 (1.2692) acc_x 50.0000 (67.5000) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.3495, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1096
clean true:1040
clean false:56
clean_rate:0.948905109489051
noisy true:516
noisy false:1524
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 2040
epoch [166/200] batch [5/34] time 0.354 (0.444) data 0.224 (0.314) loss_x loss_x 1.6211 (1.5861) acc_x 65.6250 (61.2500) lr 1.5567e-04 eta 0:00:12
epoch [166/200] batch [10/34] time 0.416 (0.434) data 0.287 (0.304) loss_x loss_x 1.3799 (1.5271) acc_x 71.8750 (62.8125) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [15/34] time 0.410 (0.432) data 0.280 (0.302) loss_x loss_x 0.8789 (1.3785) acc_x 78.1250 (66.8750) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [20/34] time 0.419 (0.428) data 0.289 (0.299) loss_x loss_x 1.7158 (1.3558) acc_x 62.5000 (67.5000) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [25/34] time 0.387 (0.426) data 0.258 (0.296) loss_x loss_x 1.6846 (1.3347) acc_x 37.5000 (65.6250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [30/34] time 0.427 (0.433) data 0.298 (0.303) loss_x loss_x 2.1055 (1.3566) acc_x 50.0000 (65.3125) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1570
confident_label rate tensor(0.3482, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1092
clean true:1031
clean false:61
clean_rate:0.9441391941391941
noisy true:535
noisy false:1509
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 2044
epoch [167/200] batch [5/34] time 0.405 (0.467) data 0.275 (0.337) loss_x loss_x 1.2959 (1.2389) acc_x 68.7500 (67.5000) lr 1.4736e-04 eta 0:00:13
epoch [167/200] batch [10/34] time 0.479 (0.441) data 0.348 (0.311) loss_x loss_x 2.1504 (1.4674) acc_x 50.0000 (63.7500) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [15/34] time 0.490 (0.447) data 0.360 (0.317) loss_x loss_x 0.9028 (1.4163) acc_x 65.6250 (64.5833) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [20/34] time 0.454 (0.446) data 0.324 (0.316) loss_x loss_x 1.1494 (1.3362) acc_x 71.8750 (66.7188) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [25/34] time 0.434 (0.442) data 0.304 (0.312) loss_x loss_x 1.1133 (1.2999) acc_x 65.6250 (66.6250) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [30/34] time 0.366 (0.438) data 0.235 (0.308) loss_x loss_x 0.9180 (1.2945) acc_x 84.3750 (67.1875) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1627
confident_label rate tensor(0.3355, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1052
clean true:1004
clean false:48
clean_rate:0.9543726235741445
noisy true:505
noisy false:1579
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 2084
epoch [168/200] batch [5/32] time 0.399 (0.440) data 0.269 (0.310) loss_x loss_x 0.9087 (1.2007) acc_x 81.2500 (70.0000) lr 1.3926e-04 eta 0:00:11
epoch [168/200] batch [10/32] time 0.349 (0.455) data 0.218 (0.325) loss_x loss_x 1.1846 (1.1365) acc_x 75.0000 (72.1875) lr 1.3926e-04 eta 0:00:10
epoch [168/200] batch [15/32] time 0.454 (0.471) data 0.324 (0.341) loss_x loss_x 1.3604 (1.1763) acc_x 75.0000 (71.4583) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [20/32] time 0.388 (0.467) data 0.257 (0.337) loss_x loss_x 0.9053 (1.1531) acc_x 81.2500 (72.6562) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [25/32] time 0.584 (0.468) data 0.453 (0.338) loss_x loss_x 1.0967 (1.1617) acc_x 71.8750 (71.8750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [30/32] time 0.551 (0.465) data 0.421 (0.334) loss_x loss_x 1.7100 (1.1616) acc_x 68.7500 (72.6042) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1607
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1053
clean true:1011
clean false:42
clean_rate:0.9601139601139601
noisy true:518
noisy false:1565
after delete: len(clean_dataset) 1053
after delete: len(noisy_dataset) 2083
epoch [169/200] batch [5/32] time 0.448 (0.425) data 0.317 (0.295) loss_x loss_x 1.2686 (1.3074) acc_x 68.7500 (68.7500) lr 1.3137e-04 eta 0:00:11
epoch [169/200] batch [10/32] time 0.351 (0.427) data 0.221 (0.297) loss_x loss_x 0.9512 (1.2796) acc_x 78.1250 (68.7500) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [15/32] time 0.380 (0.427) data 0.250 (0.297) loss_x loss_x 1.2061 (1.2825) acc_x 65.6250 (69.1667) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [20/32] time 0.443 (0.435) data 0.313 (0.305) loss_x loss_x 1.6143 (1.2512) acc_x 62.5000 (69.6875) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [25/32] time 0.399 (0.432) data 0.269 (0.302) loss_x loss_x 1.5742 (1.2649) acc_x 53.1250 (68.8750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [30/32] time 0.512 (0.432) data 0.381 (0.301) loss_x loss_x 1.1221 (1.2688) acc_x 65.6250 (68.0208) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1580
confident_label rate tensor(0.3415, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1071
clean true:1026
clean false:45
clean_rate:0.957983193277311
noisy true:530
noisy false:1535
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 2065
epoch [170/200] batch [5/33] time 0.395 (0.458) data 0.264 (0.328) loss_x loss_x 1.9736 (1.2435) acc_x 56.2500 (67.5000) lr 1.2369e-04 eta 0:00:12
epoch [170/200] batch [10/33] time 0.550 (0.466) data 0.419 (0.335) loss_x loss_x 0.9565 (1.2530) acc_x 71.8750 (67.5000) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [15/33] time 0.432 (0.449) data 0.301 (0.318) loss_x loss_x 0.8379 (1.2929) acc_x 78.1250 (66.2500) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [20/33] time 0.455 (0.456) data 0.325 (0.326) loss_x loss_x 1.0352 (1.2478) acc_x 71.8750 (67.1875) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [25/33] time 0.469 (0.463) data 0.338 (0.333) loss_x loss_x 0.7563 (1.2444) acc_x 75.0000 (68.0000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [30/33] time 0.512 (0.461) data 0.381 (0.331) loss_x loss_x 1.4775 (1.2463) acc_x 65.6250 (68.0208) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.3473, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1089
clean true:1033
clean false:56
clean_rate:0.9485766758494031
noisy true:517
noisy false:1530
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 2047
epoch [171/200] batch [5/34] time 0.420 (0.446) data 0.290 (0.316) loss_x loss_x 1.2773 (1.4333) acc_x 62.5000 (63.1250) lr 1.1623e-04 eta 0:00:12
epoch [171/200] batch [10/34] time 0.483 (0.443) data 0.353 (0.312) loss_x loss_x 1.6299 (1.3593) acc_x 53.1250 (62.5000) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [15/34] time 0.522 (0.450) data 0.392 (0.320) loss_x loss_x 0.8047 (1.2642) acc_x 78.1250 (66.2500) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [20/34] time 0.555 (0.455) data 0.425 (0.325) loss_x loss_x 1.2529 (1.2304) acc_x 68.7500 (68.2812) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [25/34] time 0.383 (0.454) data 0.253 (0.324) loss_x loss_x 1.5176 (1.2343) acc_x 59.3750 (67.2500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [30/34] time 0.529 (0.460) data 0.398 (0.330) loss_x loss_x 0.7573 (1.2328) acc_x 84.3750 (67.7083) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1600
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1076
clean true:1018
clean false:58
clean_rate:0.9460966542750929
noisy true:518
noisy false:1542
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 2060
epoch [172/200] batch [5/33] time 0.466 (0.457) data 0.335 (0.326) loss_x loss_x 1.2842 (1.3398) acc_x 65.6250 (64.3750) lr 1.0899e-04 eta 0:00:12
epoch [172/200] batch [10/33] time 0.362 (0.479) data 0.231 (0.349) loss_x loss_x 1.3262 (1.3691) acc_x 68.7500 (62.5000) lr 1.0899e-04 eta 0:00:11
epoch [172/200] batch [15/33] time 0.500 (0.479) data 0.369 (0.348) loss_x loss_x 1.2764 (1.2870) acc_x 71.8750 (65.6250) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [20/33] time 0.366 (0.465) data 0.237 (0.335) loss_x loss_x 2.2285 (1.3442) acc_x 50.0000 (65.4688) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [25/33] time 0.397 (0.451) data 0.268 (0.321) loss_x loss_x 0.9863 (1.3376) acc_x 78.1250 (66.5000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [30/33] time 0.369 (0.445) data 0.239 (0.315) loss_x loss_x 1.4072 (1.3357) acc_x 62.5000 (65.3125) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1620
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1080
clean true:1024
clean false:56
clean_rate:0.9481481481481482
noisy true:492
noisy false:1564
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 2056
epoch [173/200] batch [5/33] time 0.527 (0.444) data 0.397 (0.314) loss_x loss_x 0.9141 (1.0891) acc_x 71.8750 (69.3750) lr 1.0197e-04 eta 0:00:12
epoch [173/200] batch [10/33] time 0.431 (0.442) data 0.301 (0.311) loss_x loss_x 1.2920 (1.1435) acc_x 62.5000 (67.5000) lr 1.0197e-04 eta 0:00:10
epoch [173/200] batch [15/33] time 0.499 (0.444) data 0.369 (0.314) loss_x loss_x 1.2246 (1.1298) acc_x 71.8750 (67.7083) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [20/33] time 0.484 (0.456) data 0.354 (0.325) loss_x loss_x 1.0820 (1.1561) acc_x 68.7500 (67.9688) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [25/33] time 0.476 (0.463) data 0.346 (0.333) loss_x loss_x 1.5986 (1.1648) acc_x 59.3750 (67.7500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [30/33] time 0.364 (0.459) data 0.233 (0.329) loss_x loss_x 1.6396 (1.2011) acc_x 59.3750 (67.7083) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1627
confident_label rate tensor(0.3383, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1061
clean true:1011
clean false:50
clean_rate:0.9528746465598492
noisy true:498
noisy false:1577
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 2075
epoch [174/200] batch [5/33] time 0.449 (0.426) data 0.318 (0.296) loss_x loss_x 0.8804 (1.0301) acc_x 78.1250 (73.1250) lr 9.5173e-05 eta 0:00:11
epoch [174/200] batch [10/33] time 0.408 (0.426) data 0.278 (0.296) loss_x loss_x 2.2207 (1.3814) acc_x 43.7500 (66.8750) lr 9.5173e-05 eta 0:00:09
epoch [174/200] batch [15/33] time 0.417 (0.437) data 0.287 (0.306) loss_x loss_x 1.3633 (1.3332) acc_x 50.0000 (65.8333) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [20/33] time 0.413 (0.434) data 0.284 (0.303) loss_x loss_x 1.0078 (1.2844) acc_x 78.1250 (67.1875) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [25/33] time 0.488 (0.445) data 0.358 (0.315) loss_x loss_x 1.0957 (1.2430) acc_x 75.0000 (68.0000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [30/33] time 0.524 (0.444) data 0.393 (0.314) loss_x loss_x 1.1875 (1.2411) acc_x 71.8750 (68.2292) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1595
confident_label rate tensor(0.3492, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1095
clean true:1040
clean false:55
clean_rate:0.9497716894977168
noisy true:501
noisy false:1540
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 2041
epoch [175/200] batch [5/34] time 0.553 (0.470) data 0.423 (0.340) loss_x loss_x 0.7852 (1.1405) acc_x 78.1250 (74.3750) lr 8.8597e-05 eta 0:00:13
epoch [175/200] batch [10/34] time 0.393 (0.437) data 0.263 (0.307) loss_x loss_x 0.8242 (1.2058) acc_x 75.0000 (71.5625) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [15/34] time 0.472 (0.442) data 0.342 (0.311) loss_x loss_x 1.1660 (1.2196) acc_x 65.6250 (70.2083) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [20/34] time 0.387 (0.434) data 0.257 (0.304) loss_x loss_x 1.1143 (1.2488) acc_x 59.3750 (68.5938) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [25/34] time 0.557 (0.446) data 0.426 (0.315) loss_x loss_x 0.9873 (1.1990) acc_x 75.0000 (70.0000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [30/34] time 0.440 (0.453) data 0.309 (0.322) loss_x loss_x 0.7915 (1.1911) acc_x 78.1250 (70.3125) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1551
confident_label rate tensor(0.3482, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1092
clean true:1038
clean false:54
clean_rate:0.9505494505494505
noisy true:547
noisy false:1497
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 2044
epoch [176/200] batch [5/34] time 0.494 (0.492) data 0.364 (0.362) loss_x loss_x 1.5547 (1.4170) acc_x 68.7500 (63.7500) lr 8.2245e-05 eta 0:00:14
epoch [176/200] batch [10/34] time 0.387 (0.477) data 0.256 (0.346) loss_x loss_x 1.2432 (1.3384) acc_x 65.6250 (66.8750) lr 8.2245e-05 eta 0:00:11
epoch [176/200] batch [15/34] time 0.361 (0.479) data 0.230 (0.349) loss_x loss_x 1.2783 (1.3309) acc_x 59.3750 (64.7917) lr 8.2245e-05 eta 0:00:09
epoch [176/200] batch [20/34] time 0.393 (0.470) data 0.262 (0.340) loss_x loss_x 1.2656 (1.2967) acc_x 81.2500 (66.4062) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [25/34] time 0.469 (0.458) data 0.338 (0.327) loss_x loss_x 1.3516 (1.2968) acc_x 56.2500 (66.2500) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [30/34] time 0.422 (0.452) data 0.291 (0.322) loss_x loss_x 1.3203 (1.2608) acc_x 68.7500 (67.5000) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1629
confident_label rate tensor(0.3412, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1070
clean true:1022
clean false:48
clean_rate:0.9551401869158879
noisy true:485
noisy false:1581
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 2066
epoch [177/200] batch [5/33] time 0.384 (0.446) data 0.253 (0.315) loss_x loss_x 1.1025 (1.1582) acc_x 68.7500 (69.3750) lr 7.6120e-05 eta 0:00:12
epoch [177/200] batch [10/33] time 0.518 (0.441) data 0.387 (0.310) loss_x loss_x 1.2285 (1.2543) acc_x 71.8750 (69.6875) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [15/33] time 0.397 (0.446) data 0.267 (0.316) loss_x loss_x 1.2031 (1.2718) acc_x 65.6250 (68.1250) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [20/33] time 0.569 (0.443) data 0.438 (0.312) loss_x loss_x 1.4346 (1.2921) acc_x 65.6250 (68.4375) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [25/33] time 0.549 (0.444) data 0.419 (0.313) loss_x loss_x 1.3066 (1.2899) acc_x 59.3750 (68.6250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [30/33] time 0.489 (0.441) data 0.360 (0.311) loss_x loss_x 1.1982 (1.2799) acc_x 59.3750 (68.3333) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1073
clean true:1016
clean false:57
clean_rate:0.9468779123951537
noisy true:534
noisy false:1529
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 2063
epoch [178/200] batch [5/33] time 0.545 (0.461) data 0.415 (0.330) loss_x loss_x 0.7212 (0.9959) acc_x 81.2500 (77.5000) lr 7.0224e-05 eta 0:00:12
epoch [178/200] batch [10/33] time 0.399 (0.466) data 0.269 (0.335) loss_x loss_x 1.3350 (1.0474) acc_x 68.7500 (75.9375) lr 7.0224e-05 eta 0:00:10
epoch [178/200] batch [15/33] time 0.461 (0.461) data 0.331 (0.331) loss_x loss_x 0.8652 (1.1165) acc_x 78.1250 (73.9583) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [20/33] time 0.564 (0.463) data 0.433 (0.333) loss_x loss_x 1.3076 (1.1668) acc_x 62.5000 (70.9375) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [25/33] time 0.399 (0.451) data 0.268 (0.320) loss_x loss_x 1.8477 (1.2036) acc_x 59.3750 (70.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [30/33] time 0.410 (0.447) data 0.280 (0.316) loss_x loss_x 0.9204 (1.2068) acc_x 78.1250 (69.3750) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1611
confident_label rate tensor(0.3501, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1098
clean true:1035
clean false:63
clean_rate:0.9426229508196722
noisy true:490
noisy false:1548
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 2038
epoch [179/200] batch [5/34] time 0.526 (0.468) data 0.396 (0.338) loss_x loss_x 1.4111 (1.2703) acc_x 62.5000 (66.2500) lr 6.4556e-05 eta 0:00:13
epoch [179/200] batch [10/34] time 0.464 (0.451) data 0.334 (0.321) loss_x loss_x 1.0264 (1.3684) acc_x 75.0000 (64.6875) lr 6.4556e-05 eta 0:00:10
epoch [179/200] batch [15/34] time 0.458 (0.451) data 0.328 (0.321) loss_x loss_x 1.0166 (1.3037) acc_x 78.1250 (65.2083) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [20/34] time 0.390 (0.449) data 0.260 (0.319) loss_x loss_x 1.3115 (1.3055) acc_x 62.5000 (65.9375) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [25/34] time 0.458 (0.445) data 0.328 (0.315) loss_x loss_x 1.3262 (1.3360) acc_x 68.7500 (66.1250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [30/34] time 0.559 (0.449) data 0.428 (0.319) loss_x loss_x 0.8091 (1.2957) acc_x 81.2500 (67.1875) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.3425, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1074
clean true:1026
clean false:48
clean_rate:0.9553072625698324
noisy true:524
noisy false:1538
after delete: len(clean_dataset) 1074
after delete: len(noisy_dataset) 2062
epoch [180/200] batch [5/33] time 0.447 (0.478) data 0.317 (0.348) loss_x loss_x 1.2920 (1.2141) acc_x 75.0000 (69.3750) lr 5.9119e-05 eta 0:00:13
epoch [180/200] batch [10/33] time 0.504 (0.460) data 0.374 (0.330) loss_x loss_x 1.1611 (1.1813) acc_x 68.7500 (69.0625) lr 5.9119e-05 eta 0:00:10
epoch [180/200] batch [15/33] time 0.416 (0.458) data 0.286 (0.328) loss_x loss_x 1.3936 (1.1893) acc_x 59.3750 (69.1667) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [20/33] time 0.407 (0.455) data 0.276 (0.325) loss_x loss_x 0.8940 (1.1228) acc_x 71.8750 (70.3125) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [25/33] time 0.369 (0.451) data 0.239 (0.321) loss_x loss_x 1.1787 (1.1701) acc_x 65.6250 (70.5000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [30/33] time 0.425 (0.450) data 0.295 (0.320) loss_x loss_x 0.6631 (1.1355) acc_x 71.8750 (71.1458) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1588
confident_label rate tensor(0.3489, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1094
clean true:1039
clean false:55
clean_rate:0.9497257769652651
noisy true:509
noisy false:1533
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 2042
epoch [181/200] batch [5/34] time 0.444 (0.456) data 0.313 (0.326) loss_x loss_x 1.0518 (1.1799) acc_x 65.6250 (66.2500) lr 5.3915e-05 eta 0:00:13
epoch [181/200] batch [10/34] time 0.491 (0.436) data 0.362 (0.306) loss_x loss_x 1.6025 (1.2285) acc_x 65.6250 (67.1875) lr 5.3915e-05 eta 0:00:10
epoch [181/200] batch [15/34] time 0.475 (0.430) data 0.345 (0.300) loss_x loss_x 1.2881 (1.2396) acc_x 59.3750 (67.5000) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [20/34] time 0.506 (0.438) data 0.377 (0.308) loss_x loss_x 1.7363 (1.2609) acc_x 50.0000 (67.1875) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [25/34] time 0.372 (0.445) data 0.242 (0.315) loss_x loss_x 1.0234 (1.2235) acc_x 65.6250 (68.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [30/34] time 0.406 (0.443) data 0.276 (0.313) loss_x loss_x 0.8413 (1.2381) acc_x 81.2500 (68.2292) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1581
confident_label rate tensor(0.3527, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1106
clean true:1042
clean false:64
clean_rate:0.9421338155515371
noisy true:513
noisy false:1517
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 2030
epoch [182/200] batch [5/34] time 0.449 (0.470) data 0.318 (0.340) loss_x loss_x 1.3477 (1.2820) acc_x 71.8750 (67.5000) lr 4.8943e-05 eta 0:00:13
epoch [182/200] batch [10/34] time 0.445 (0.448) data 0.315 (0.317) loss_x loss_x 1.1787 (1.2987) acc_x 65.6250 (65.9375) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [15/34] time 0.484 (0.443) data 0.354 (0.313) loss_x loss_x 0.7773 (1.3053) acc_x 81.2500 (66.4583) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [20/34] time 0.340 (0.447) data 0.210 (0.317) loss_x loss_x 1.3799 (1.2619) acc_x 65.6250 (67.6562) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [25/34] time 0.439 (0.447) data 0.309 (0.317) loss_x loss_x 1.2207 (1.2790) acc_x 71.8750 (67.5000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [30/34] time 0.526 (0.450) data 0.395 (0.320) loss_x loss_x 1.0811 (1.2660) acc_x 75.0000 (67.6042) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1609
confident_label rate tensor(0.3412, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1070
clean true:1010
clean false:60
clean_rate:0.9439252336448598
noisy true:517
noisy false:1549
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 2066
epoch [183/200] batch [5/33] time 0.454 (0.458) data 0.323 (0.328) loss_x loss_x 1.6289 (1.1514) acc_x 62.5000 (71.2500) lr 4.4207e-05 eta 0:00:12
epoch [183/200] batch [10/33] time 0.384 (0.459) data 0.254 (0.329) loss_x loss_x 0.9404 (1.1843) acc_x 71.8750 (68.4375) lr 4.4207e-05 eta 0:00:10
epoch [183/200] batch [15/33] time 0.525 (0.451) data 0.396 (0.321) loss_x loss_x 1.1006 (1.1895) acc_x 78.1250 (68.5417) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [20/33] time 0.570 (0.471) data 0.440 (0.341) loss_x loss_x 1.4238 (1.2177) acc_x 71.8750 (68.4375) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [25/33] time 0.414 (0.470) data 0.284 (0.340) loss_x loss_x 1.6123 (1.2728) acc_x 59.3750 (67.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [30/33] time 0.412 (0.464) data 0.282 (0.334) loss_x loss_x 1.0693 (1.2435) acc_x 65.6250 (67.6042) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1577
confident_label rate tensor(0.3415, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1071
clean true:1026
clean false:45
clean_rate:0.957983193277311
noisy true:533
noisy false:1532
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 2065
epoch [184/200] batch [5/33] time 0.368 (0.429) data 0.237 (0.298) loss_x loss_x 0.9185 (0.9695) acc_x 78.1250 (74.3750) lr 3.9706e-05 eta 0:00:12
epoch [184/200] batch [10/33] time 0.464 (0.435) data 0.333 (0.305) loss_x loss_x 1.2422 (1.0785) acc_x 65.6250 (70.9375) lr 3.9706e-05 eta 0:00:10
epoch [184/200] batch [15/33] time 0.438 (0.433) data 0.308 (0.303) loss_x loss_x 1.0244 (1.0962) acc_x 68.7500 (69.3750) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [20/33] time 0.605 (0.463) data 0.474 (0.333) loss_x loss_x 1.5674 (1.1467) acc_x 62.5000 (68.5938) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [25/33] time 0.427 (0.462) data 0.297 (0.332) loss_x loss_x 1.0010 (1.1883) acc_x 75.0000 (68.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [30/33] time 0.544 (0.455) data 0.414 (0.324) loss_x loss_x 1.1846 (1.1733) acc_x 75.0000 (69.1667) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1594
confident_label rate tensor(0.3489, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1094
clean true:1035
clean false:59
clean_rate:0.9460694698354661
noisy true:507
noisy false:1535
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 2042
epoch [185/200] batch [5/34] time 0.518 (0.430) data 0.388 (0.300) loss_x loss_x 1.6611 (1.3717) acc_x 62.5000 (63.7500) lr 3.5443e-05 eta 0:00:12
epoch [185/200] batch [10/34] time 0.345 (0.410) data 0.215 (0.280) loss_x loss_x 1.0078 (1.2422) acc_x 75.0000 (65.9375) lr 3.5443e-05 eta 0:00:09
epoch [185/200] batch [15/34] time 0.532 (0.417) data 0.402 (0.287) loss_x loss_x 1.2695 (1.2492) acc_x 62.5000 (65.6250) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [20/34] time 0.438 (0.432) data 0.308 (0.302) loss_x loss_x 1.3604 (1.2801) acc_x 68.7500 (65.3125) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [25/34] time 0.512 (0.453) data 0.381 (0.322) loss_x loss_x 1.4326 (1.2641) acc_x 65.6250 (66.8750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [30/34] time 0.538 (0.456) data 0.408 (0.326) loss_x loss_x 0.8740 (1.2277) acc_x 71.8750 (67.0833) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1630
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1051
clean true:1007
clean false:44
clean_rate:0.9581351094196003
noisy true:499
noisy false:1586
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 2085
epoch [186/200] batch [5/32] time 0.444 (0.457) data 0.314 (0.327) loss_x loss_x 0.9219 (1.1320) acc_x 75.0000 (70.6250) lr 3.1417e-05 eta 0:00:12
epoch [186/200] batch [10/32] time 0.676 (0.478) data 0.546 (0.348) loss_x loss_x 0.9985 (1.0814) acc_x 81.2500 (72.1875) lr 3.1417e-05 eta 0:00:10
epoch [186/200] batch [15/32] time 0.510 (0.473) data 0.380 (0.343) loss_x loss_x 0.8335 (1.1262) acc_x 84.3750 (71.8750) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [20/32] time 0.393 (0.467) data 0.262 (0.338) loss_x loss_x 1.0918 (1.1290) acc_x 68.7500 (72.3438) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [25/32] time 0.477 (0.460) data 0.347 (0.330) loss_x loss_x 1.0361 (1.2029) acc_x 75.0000 (71.0000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [30/32] time 0.386 (0.451) data 0.255 (0.321) loss_x loss_x 1.3389 (1.2061) acc_x 68.7500 (71.0417) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1589
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1080
clean true:1025
clean false:55
clean_rate:0.9490740740740741
noisy true:522
noisy false:1534
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 2056
epoch [187/200] batch [5/33] time 0.563 (0.465) data 0.434 (0.335) loss_x loss_x 1.5566 (1.3068) acc_x 56.2500 (66.2500) lr 2.7630e-05 eta 0:00:13
epoch [187/200] batch [10/33] time 0.467 (0.457) data 0.337 (0.327) loss_x loss_x 0.8887 (1.2201) acc_x 81.2500 (69.6875) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [15/33] time 0.436 (0.438) data 0.305 (0.308) loss_x loss_x 1.0557 (1.2229) acc_x 78.1250 (70.0000) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [20/33] time 0.439 (0.440) data 0.309 (0.310) loss_x loss_x 1.2412 (1.1926) acc_x 71.8750 (70.6250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [25/33] time 0.531 (0.450) data 0.401 (0.320) loss_x loss_x 0.6304 (1.1505) acc_x 81.2500 (71.1250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [30/33] time 0.449 (0.460) data 0.319 (0.330) loss_x loss_x 1.2207 (1.1696) acc_x 68.7500 (70.7292) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1590
confident_label rate tensor(0.3438, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1078
clean true:1030
clean false:48
clean_rate:0.9554730983302412
noisy true:516
noisy false:1542
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 2058
epoch [188/200] batch [5/33] time 0.415 (0.451) data 0.284 (0.321) loss_x loss_x 1.5527 (1.2676) acc_x 65.6250 (70.6250) lr 2.4083e-05 eta 0:00:12
epoch [188/200] batch [10/33] time 0.410 (0.455) data 0.281 (0.325) loss_x loss_x 1.3984 (1.3622) acc_x 65.6250 (67.5000) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [15/33] time 0.391 (0.445) data 0.261 (0.315) loss_x loss_x 1.7061 (1.3667) acc_x 53.1250 (66.6667) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [20/33] time 0.427 (0.451) data 0.297 (0.320) loss_x loss_x 0.9253 (1.3222) acc_x 71.8750 (67.1875) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [25/33] time 0.431 (0.455) data 0.301 (0.325) loss_x loss_x 1.4854 (1.2688) acc_x 62.5000 (68.6250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [30/33] time 0.369 (0.461) data 0.239 (0.331) loss_x loss_x 0.9771 (1.2530) acc_x 71.8750 (68.7500) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1611
confident_label rate tensor(0.3361, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1054
clean true:1004
clean false:50
clean_rate:0.952561669829222
noisy true:521
noisy false:1561
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 2082
epoch [189/200] batch [5/32] time 0.483 (0.463) data 0.352 (0.333) loss_x loss_x 1.1025 (1.2133) acc_x 68.7500 (68.7500) lr 2.0777e-05 eta 0:00:12
epoch [189/200] batch [10/32] time 0.432 (0.442) data 0.302 (0.312) loss_x loss_x 1.7275 (1.2349) acc_x 56.2500 (68.1250) lr 2.0777e-05 eta 0:00:09
epoch [189/200] batch [15/32] time 0.405 (0.448) data 0.274 (0.317) loss_x loss_x 1.7480 (1.2196) acc_x 59.3750 (68.3333) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [20/32] time 0.426 (0.442) data 0.295 (0.312) loss_x loss_x 1.7656 (1.2833) acc_x 53.1250 (67.5000) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [25/32] time 0.390 (0.439) data 0.260 (0.309) loss_x loss_x 0.9414 (1.2510) acc_x 75.0000 (68.1250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [30/32] time 0.474 (0.435) data 0.343 (0.304) loss_x loss_x 0.6855 (1.2187) acc_x 87.5000 (68.5417) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1603
confident_label rate tensor(0.3463, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1086
clean true:1032
clean false:54
clean_rate:0.9502762430939227
noisy true:501
noisy false:1549
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 2050
epoch [190/200] batch [5/33] time 0.392 (0.494) data 0.263 (0.365) loss_x loss_x 1.1797 (1.1372) acc_x 65.6250 (70.0000) lr 1.7713e-05 eta 0:00:13
epoch [190/200] batch [10/33] time 0.444 (0.505) data 0.314 (0.375) loss_x loss_x 1.3730 (1.2139) acc_x 65.6250 (69.3750) lr 1.7713e-05 eta 0:00:11
epoch [190/200] batch [15/33] time 0.485 (0.476) data 0.355 (0.347) loss_x loss_x 1.4619 (1.2261) acc_x 62.5000 (69.3750) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [20/33] time 0.522 (0.467) data 0.392 (0.337) loss_x loss_x 1.2754 (1.2306) acc_x 62.5000 (68.4375) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [25/33] time 0.393 (0.458) data 0.263 (0.328) loss_x loss_x 1.3242 (1.2480) acc_x 71.8750 (68.2500) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [30/33] time 0.451 (0.459) data 0.320 (0.329) loss_x loss_x 1.2920 (1.2433) acc_x 65.6250 (68.2292) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1592
confident_label rate tensor(0.3520, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1104
clean true:1047
clean false:57
clean_rate:0.9483695652173914
noisy true:497
noisy false:1535
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 2032
epoch [191/200] batch [5/34] time 0.547 (0.485) data 0.416 (0.354) loss_x loss_x 0.7476 (0.8184) acc_x 78.1250 (75.0000) lr 1.4891e-05 eta 0:00:14
epoch [191/200] batch [10/34] time 0.381 (0.470) data 0.250 (0.339) loss_x loss_x 1.3369 (1.0894) acc_x 59.3750 (69.0625) lr 1.4891e-05 eta 0:00:11
epoch [191/200] batch [15/34] time 0.497 (0.471) data 0.367 (0.340) loss_x loss_x 0.8623 (1.1088) acc_x 75.0000 (67.7083) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [20/34] time 0.404 (0.474) data 0.273 (0.343) loss_x loss_x 1.0137 (1.0991) acc_x 65.6250 (68.1250) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [25/34] time 0.417 (0.468) data 0.286 (0.337) loss_x loss_x 1.4404 (1.1445) acc_x 59.3750 (67.3750) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [30/34] time 0.405 (0.467) data 0.274 (0.336) loss_x loss_x 1.2871 (1.1745) acc_x 65.6250 (66.5625) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1582
confident_label rate tensor(0.3565, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1118
clean true:1055
clean false:63
clean_rate:0.943649373881932
noisy true:499
noisy false:1519
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 2018
epoch [192/200] batch [5/34] time 0.430 (0.402) data 0.300 (0.271) loss_x loss_x 1.4688 (1.3000) acc_x 65.6250 (65.6250) lr 1.2312e-05 eta 0:00:11
epoch [192/200] batch [10/34] time 0.372 (0.423) data 0.242 (0.292) loss_x loss_x 1.3408 (1.2885) acc_x 68.7500 (65.3125) lr 1.2312e-05 eta 0:00:10
epoch [192/200] batch [15/34] time 0.454 (0.424) data 0.322 (0.293) loss_x loss_x 1.8604 (1.3018) acc_x 53.1250 (64.7917) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [20/34] time 0.470 (0.440) data 0.340 (0.310) loss_x loss_x 1.3340 (1.2697) acc_x 56.2500 (65.7812) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [25/34] time 0.351 (0.432) data 0.220 (0.301) loss_x loss_x 1.2539 (1.2886) acc_x 75.0000 (66.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [30/34] time 0.382 (0.434) data 0.252 (0.304) loss_x loss_x 1.2285 (1.2937) acc_x 75.0000 (66.1458) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1604
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1076
clean true:1025
clean false:51
clean_rate:0.9526022304832714
noisy true:507
noisy false:1553
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 2060
epoch [193/200] batch [5/33] time 0.398 (0.457) data 0.268 (0.327) loss_x loss_x 1.2051 (1.1826) acc_x 62.5000 (67.5000) lr 9.9763e-06 eta 0:00:12
epoch [193/200] batch [10/33] time 0.478 (0.451) data 0.348 (0.320) loss_x loss_x 1.2227 (1.1773) acc_x 59.3750 (67.5000) lr 9.9763e-06 eta 0:00:10
epoch [193/200] batch [15/33] time 0.437 (0.433) data 0.307 (0.303) loss_x loss_x 1.5820 (1.2609) acc_x 59.3750 (66.6667) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [20/33] time 0.424 (0.437) data 0.294 (0.307) loss_x loss_x 1.1572 (1.2543) acc_x 65.6250 (67.5000) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [25/33] time 0.619 (0.445) data 0.489 (0.315) loss_x loss_x 1.0381 (1.2507) acc_x 68.7500 (67.5000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [30/33] time 0.494 (0.445) data 0.363 (0.315) loss_x loss_x 0.9858 (1.2695) acc_x 75.0000 (67.3958) lr 9.9763e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1596
confident_label rate tensor(0.3438, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1078
clean true:1028
clean false:50
clean_rate:0.9536178107606679
noisy true:512
noisy false:1546
after delete: len(clean_dataset) 1078
after delete: len(noisy_dataset) 2058
epoch [194/200] batch [5/33] time 0.460 (0.428) data 0.330 (0.298) loss_x loss_x 0.8599 (1.2194) acc_x 75.0000 (70.6250) lr 7.8853e-06 eta 0:00:11
epoch [194/200] batch [10/33] time 0.479 (0.432) data 0.349 (0.301) loss_x loss_x 0.9321 (1.2792) acc_x 75.0000 (67.5000) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [15/33] time 0.391 (0.435) data 0.260 (0.304) loss_x loss_x 1.2754 (1.2772) acc_x 65.6250 (67.0833) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [20/33] time 0.453 (0.432) data 0.323 (0.302) loss_x loss_x 1.2441 (1.2655) acc_x 68.7500 (68.1250) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [25/33] time 0.427 (0.431) data 0.297 (0.301) loss_x loss_x 1.7598 (1.3045) acc_x 53.1250 (67.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [30/33] time 0.423 (0.437) data 0.292 (0.307) loss_x loss_x 1.1816 (1.3140) acc_x 68.7500 (67.5000) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1556
confident_label rate tensor(0.3504, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1099
clean true:1050
clean false:49
clean_rate:0.9554140127388535
noisy true:530
noisy false:1507
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 2037
epoch [195/200] batch [5/34] time 0.667 (0.499) data 0.537 (0.369) loss_x loss_x 1.2979 (1.5729) acc_x 71.8750 (61.2500) lr 6.0390e-06 eta 0:00:14
epoch [195/200] batch [10/34] time 0.441 (0.461) data 0.311 (0.331) loss_x loss_x 1.3174 (1.4567) acc_x 68.7500 (63.7500) lr 6.0390e-06 eta 0:00:11
epoch [195/200] batch [15/34] time 0.457 (0.464) data 0.326 (0.334) loss_x loss_x 1.3008 (1.3918) acc_x 68.7500 (66.0417) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [20/34] time 0.464 (0.457) data 0.334 (0.326) loss_x loss_x 0.8696 (1.3680) acc_x 75.0000 (66.7188) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [25/34] time 0.368 (0.455) data 0.238 (0.325) loss_x loss_x 1.2266 (1.3324) acc_x 68.7500 (67.5000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [30/34] time 0.443 (0.457) data 0.312 (0.327) loss_x loss_x 0.8867 (1.3396) acc_x 71.8750 (66.3542) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1084
clean true:1028
clean false:56
clean_rate:0.948339483394834
noisy true:506
noisy false:1546
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 2052
epoch [196/200] batch [5/33] time 0.424 (0.412) data 0.295 (0.282) loss_x loss_x 1.3154 (1.2151) acc_x 71.8750 (70.6250) lr 4.4380e-06 eta 0:00:11
epoch [196/200] batch [10/33] time 0.384 (0.412) data 0.255 (0.282) loss_x loss_x 1.2773 (1.3502) acc_x 62.5000 (65.3125) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [15/33] time 0.472 (0.421) data 0.342 (0.291) loss_x loss_x 1.0488 (1.3371) acc_x 71.8750 (66.4583) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [20/33] time 0.421 (0.432) data 0.292 (0.302) loss_x loss_x 1.4570 (1.3132) acc_x 56.2500 (66.5625) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [25/33] time 0.496 (0.437) data 0.365 (0.307) loss_x loss_x 1.3271 (1.2815) acc_x 71.8750 (67.7500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [30/33] time 0.395 (0.438) data 0.266 (0.308) loss_x loss_x 1.3291 (1.2632) acc_x 62.5000 (67.6042) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1594
confident_label rate tensor(0.3374, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1058
clean true:1011
clean false:47
clean_rate:0.9555765595463138
noisy true:531
noisy false:1547
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 2078
epoch [197/200] batch [5/33] time 0.401 (0.407) data 0.271 (0.277) loss_x loss_x 1.3623 (1.3027) acc_x 62.5000 (70.6250) lr 3.0827e-06 eta 0:00:11
epoch [197/200] batch [10/33] time 0.506 (0.415) data 0.376 (0.284) loss_x loss_x 1.1572 (1.2169) acc_x 75.0000 (71.8750) lr 3.0827e-06 eta 0:00:09
epoch [197/200] batch [15/33] time 0.422 (0.438) data 0.291 (0.308) loss_x loss_x 1.4746 (1.3424) acc_x 62.5000 (68.5417) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [20/33] time 0.401 (0.441) data 0.271 (0.310) loss_x loss_x 1.2910 (1.2769) acc_x 56.2500 (69.2188) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [25/33] time 0.570 (0.452) data 0.439 (0.322) loss_x loss_x 1.4297 (1.2616) acc_x 68.7500 (69.3750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [30/33] time 0.394 (0.443) data 0.264 (0.313) loss_x loss_x 1.5957 (1.2797) acc_x 65.6250 (69.0625) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1586
confident_label rate tensor(0.3501, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1098
clean true:1046
clean false:52
clean_rate:0.9526411657559198
noisy true:504
noisy false:1534
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 2038
epoch [198/200] batch [5/34] time 0.572 (0.474) data 0.441 (0.344) loss_x loss_x 1.0059 (1.0529) acc_x 75.0000 (70.6250) lr 1.9733e-06 eta 0:00:13
epoch [198/200] batch [10/34] time 0.356 (0.450) data 0.226 (0.320) loss_x loss_x 0.9624 (1.1680) acc_x 71.8750 (70.0000) lr 1.9733e-06 eta 0:00:10
epoch [198/200] batch [15/34] time 0.385 (0.453) data 0.254 (0.323) loss_x loss_x 1.1963 (1.1743) acc_x 65.6250 (71.0417) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [20/34] time 0.453 (0.445) data 0.323 (0.314) loss_x loss_x 1.4492 (1.2044) acc_x 59.3750 (70.1562) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [25/34] time 0.486 (0.447) data 0.355 (0.317) loss_x loss_x 1.8057 (1.2412) acc_x 46.8750 (69.2500) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [30/34] time 0.464 (0.448) data 0.334 (0.317) loss_x loss_x 1.7490 (1.2392) acc_x 50.0000 (68.8542) lr 1.9733e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1565
confident_label rate tensor(0.3469, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1088
clean true:1038
clean false:50
clean_rate:0.9540441176470589
noisy true:533
noisy false:1515
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 2048
epoch [199/200] batch [5/34] time 0.557 (0.476) data 0.427 (0.346) loss_x loss_x 1.3965 (1.3150) acc_x 56.2500 (68.1250) lr 1.1101e-06 eta 0:00:13
epoch [199/200] batch [10/34] time 0.498 (0.472) data 0.368 (0.342) loss_x loss_x 1.1924 (1.4040) acc_x 65.6250 (63.7500) lr 1.1101e-06 eta 0:00:11
epoch [199/200] batch [15/34] time 0.442 (0.461) data 0.311 (0.331) loss_x loss_x 1.3691 (1.3455) acc_x 68.7500 (65.8333) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [20/34] time 0.550 (0.458) data 0.421 (0.328) loss_x loss_x 0.9077 (1.3207) acc_x 65.6250 (66.2500) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [25/34] time 0.438 (0.454) data 0.308 (0.324) loss_x loss_x 1.2314 (1.2869) acc_x 68.7500 (67.2500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [30/34] time 0.764 (0.459) data 0.634 (0.329) loss_x loss_x 0.9346 (1.2708) acc_x 71.8750 (67.5000) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
[OT_PL] Loading all features and outputs... Total samples: 3136
[OT_PL] Features shape: torch.Size([3136, 1024]), Outputs shape: torch.Size([3136, 196])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([3136, 196]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([3136]), b.shape=torch.Size([196]), P.shape=torch.Size([3136, 196]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([3136, 196])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 3136
before epoch:different number: 1602
confident_label rate tensor(0.3466, device='cuda:0')
before: len(self.train) 3136
before: len of confident samples 1087
clean true:1031
clean false:56
clean_rate:0.9484820607175714
noisy true:503
noisy false:1546
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 2049
epoch [200/200] batch [5/33] time 0.601 (0.483) data 0.470 (0.352) loss_x loss_x 0.7949 (1.1232) acc_x 81.2500 (73.1250) lr 4.9344e-07 eta 0:00:13
epoch [200/200] batch [10/33] time 0.406 (0.454) data 0.275 (0.324) loss_x loss_x 0.8281 (1.1679) acc_x 75.0000 (71.8750) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [15/33] time 0.437 (0.441) data 0.306 (0.310) loss_x loss_x 1.0156 (1.1925) acc_x 65.6250 (70.2083) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [20/33] time 0.399 (0.434) data 0.268 (0.304) loss_x loss_x 1.2354 (1.2116) acc_x 65.6250 (70.1562) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [25/33] time 0.501 (0.444) data 0.371 (0.314) loss_x loss_x 1.0684 (1.1980) acc_x 75.0000 (70.6250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [30/33] time 0.414 (0.443) data 0.284 (0.312) loss_x loss_x 1.2568 (1.2013) acc_x 71.8750 (70.7292) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output_wo_mae/stanford_cars/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 3136
after epoch: len(noisy dataset) 3136
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 8,041
* correct: 5,005
* accuracy: 62.2%
* error: 37.8%
* macro_f1: 60.5%
Elapsed: 3:10:25
