***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '47']
output_dir: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: DescribableTextures
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 47
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: DescribableTextures
Reading split from /home/convex/datasets/nlprompt/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/dtd/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 23
Data loader size: 2
Data loader size: 17
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      188
# test     1,692
---------  -------------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 571
confident_label rate tensor(0.0598, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 45
clean true:41
clean false:4
clean_rate:0.9111111111111111
noisy true:140
noisy false:567
after delete: len(clean_dataset) 45
after delete: len(noisy_dataset) 707
epoch [1/200] batch [1/1] time 0.401 (0.401) data 0.257 (0.257) loss_x loss_x 2.7188 (2.7188) acc_x 37.5000 (37.5000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 583
confident_label rate tensor(0.0559, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 42
clean true:37
clean false:5
clean_rate:0.8809523809523809
noisy true:132
noisy false:578
after delete: len(clean_dataset) 42
after delete: len(noisy_dataset) 710
epoch [2/200] batch [1/1] time 0.324 (0.324) data 0.277 (0.277) loss_x loss_x 2.3633 (2.3633) acc_x 56.2500 (56.2500) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 524
confident_label rate tensor(0.0771, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 58
clean true:48
clean false:10
clean_rate:0.8275862068965517
noisy true:180
noisy false:514
after delete: len(clean_dataset) 58
after delete: len(noisy_dataset) 694
epoch [3/200] batch [1/1] time 0.314 (0.314) data 0.267 (0.267) loss_x loss_x 2.5840 (2.5840) acc_x 37.5000 (37.5000) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 497
confident_label rate tensor(0.0891, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 67
clean true:56
clean false:11
clean_rate:0.835820895522388
noisy true:199
noisy false:486
after delete: len(clean_dataset) 67
after delete: len(noisy_dataset) 685
epoch [4/200] batch [1/2] time 0.272 (0.272) data 0.225 (0.225) loss_x loss_x 1.5205 (1.5205) acc_x 62.5000 (62.5000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/2] time 0.245 (0.258) data 0.198 (0.211) loss_x loss_x 1.8975 (1.7090) acc_x 43.7500 (53.1250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 468
confident_label rate tensor(0.1037, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 78
clean true:65
clean false:13
clean_rate:0.8333333333333334
noisy true:219
noisy false:455
after delete: len(clean_dataset) 78
after delete: len(noisy_dataset) 674
epoch [5/200] batch [1/2] time 0.295 (0.295) data 0.248 (0.248) loss_x loss_x 1.3516 (1.3516) acc_x 65.6250 (65.6250) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [2/2] time 0.264 (0.279) data 0.216 (0.232) loss_x loss_x 1.3525 (1.3521) acc_x 62.5000 (64.0625) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 467
confident_label rate tensor(0.0891, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 67
clean true:60
clean false:7
clean_rate:0.8955223880597015
noisy true:225
noisy false:460
after delete: len(clean_dataset) 67
after delete: len(noisy_dataset) 685
epoch [6/200] batch [1/2] time 0.276 (0.276) data 0.229 (0.229) loss_x loss_x 1.1787 (1.1787) acc_x 75.0000 (75.0000) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/2] time 0.279 (0.278) data 0.232 (0.231) loss_x loss_x 1.2969 (1.2378) acc_x 62.5000 (68.7500) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 472
confident_label rate tensor(0.1051, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 79
clean true:70
clean false:9
clean_rate:0.8860759493670886
noisy true:210
noisy false:463
after delete: len(clean_dataset) 79
after delete: len(noisy_dataset) 673
epoch [7/200] batch [1/2] time 0.337 (0.337) data 0.291 (0.291) loss_x loss_x 1.2510 (1.2510) acc_x 62.5000 (62.5000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [2/2] time 0.281 (0.309) data 0.234 (0.262) loss_x loss_x 0.8853 (1.0681) acc_x 75.0000 (68.7500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 455
confident_label rate tensor(0.1130, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 85
clean true:73
clean false:12
clean_rate:0.8588235294117647
noisy true:224
noisy false:443
after delete: len(clean_dataset) 85
after delete: len(noisy_dataset) 667
epoch [8/200] batch [1/2] time 0.244 (0.244) data 0.197 (0.197) loss_x loss_x 0.9536 (0.9536) acc_x 65.6250 (65.6250) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [2/2] time 0.281 (0.263) data 0.234 (0.216) loss_x loss_x 0.7441 (0.8489) acc_x 81.2500 (73.4375) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 438
confident_label rate tensor(0.1130, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 85
clean true:73
clean false:12
clean_rate:0.8588235294117647
noisy true:241
noisy false:426
after delete: len(clean_dataset) 85
after delete: len(noisy_dataset) 667
epoch [9/200] batch [1/2] time 0.253 (0.253) data 0.206 (0.206) loss_x loss_x 1.0898 (1.0898) acc_x 75.0000 (75.0000) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [2/2] time 0.285 (0.269) data 0.238 (0.222) loss_x loss_x 0.9014 (0.9956) acc_x 71.8750 (73.4375) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 443
confident_label rate tensor(0.1130, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 85
clean true:76
clean false:9
clean_rate:0.8941176470588236
noisy true:233
noisy false:434
after delete: len(clean_dataset) 85
after delete: len(noisy_dataset) 667
epoch [10/200] batch [1/2] time 0.287 (0.287) data 0.241 (0.241) loss_x loss_x 0.7490 (0.7490) acc_x 75.0000 (75.0000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [2/2] time 0.290 (0.288) data 0.243 (0.242) loss_x loss_x 0.5952 (0.6721) acc_x 81.2500 (78.1250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 448
confident_label rate tensor(0.1197, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 90
clean true:72
clean false:18
clean_rate:0.8
noisy true:232
noisy false:430
after delete: len(clean_dataset) 90
after delete: len(noisy_dataset) 662
epoch [11/200] batch [1/2] time 0.318 (0.318) data 0.271 (0.271) loss_x loss_x 0.7407 (0.7407) acc_x 78.1250 (78.1250) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [2/2] time 0.275 (0.297) data 0.228 (0.250) loss_x loss_x 1.0410 (0.8909) acc_x 87.5000 (82.8125) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 442
confident_label rate tensor(0.1130, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 85
clean true:72
clean false:13
clean_rate:0.8470588235294118
noisy true:238
noisy false:429
after delete: len(clean_dataset) 85
after delete: len(noisy_dataset) 667
epoch [12/200] batch [1/2] time 0.292 (0.292) data 0.245 (0.245) loss_x loss_x 0.5298 (0.5298) acc_x 90.6250 (90.6250) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [2/2] time 0.256 (0.274) data 0.209 (0.227) loss_x loss_x 0.6943 (0.6121) acc_x 81.2500 (85.9375) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 439
confident_label rate tensor(0.1184, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 89
clean true:76
clean false:13
clean_rate:0.8539325842696629
noisy true:237
noisy false:426
after delete: len(clean_dataset) 89
after delete: len(noisy_dataset) 663
epoch [13/200] batch [1/2] time 0.304 (0.304) data 0.258 (0.258) loss_x loss_x 0.5762 (0.5762) acc_x 78.1250 (78.1250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [2/2] time 0.299 (0.302) data 0.252 (0.255) loss_x loss_x 0.5571 (0.5667) acc_x 87.5000 (82.8125) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 426
confident_label rate tensor(0.1250, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 94
clean true:80
clean false:14
clean_rate:0.851063829787234
noisy true:246
noisy false:412
after delete: len(clean_dataset) 94
after delete: len(noisy_dataset) 658
epoch [14/200] batch [1/2] time 0.267 (0.267) data 0.221 (0.221) loss_x loss_x 0.9648 (0.9648) acc_x 75.0000 (75.0000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [2/2] time 0.307 (0.287) data 0.260 (0.240) loss_x loss_x 0.5869 (0.7759) acc_x 93.7500 (84.3750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 424
confident_label rate tensor(0.1237, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 93
clean true:79
clean false:14
clean_rate:0.8494623655913979
noisy true:249
noisy false:410
after delete: len(clean_dataset) 93
after delete: len(noisy_dataset) 659
epoch [15/200] batch [1/2] time 0.302 (0.302) data 0.252 (0.252) loss_x loss_x 0.4216 (0.4216) acc_x 90.6250 (90.6250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [2/2] time 0.272 (0.287) data 0.221 (0.237) loss_x loss_x 0.6021 (0.5118) acc_x 93.7500 (92.1875) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 419
confident_label rate tensor(0.1330, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 100
clean true:88
clean false:12
clean_rate:0.88
noisy true:245
noisy false:407
after delete: len(clean_dataset) 100
after delete: len(noisy_dataset) 652
epoch [16/200] batch [1/3] time 0.288 (0.288) data 0.241 (0.241) loss_x loss_x 0.6021 (0.6021) acc_x 84.3750 (84.3750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [2/3] time 0.334 (0.311) data 0.288 (0.264) loss_x loss_x 0.6660 (0.6340) acc_x 75.0000 (79.6875) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [3/3] time 0.288 (0.303) data 0.241 (0.256) loss_x loss_x 0.4783 (0.5821) acc_x 90.6250 (83.3333) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 412
confident_label rate tensor(0.1383, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 104
clean true:87
clean false:17
clean_rate:0.8365384615384616
noisy true:253
noisy false:395
after delete: len(clean_dataset) 104
after delete: len(noisy_dataset) 648
epoch [17/200] batch [1/3] time 0.281 (0.281) data 0.235 (0.235) loss_x loss_x 0.8779 (0.8779) acc_x 75.0000 (75.0000) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [2/3] time 0.306 (0.294) data 0.259 (0.247) loss_x loss_x 0.6079 (0.7429) acc_x 84.3750 (79.6875) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [3/3] time 0.292 (0.293) data 0.245 (0.246) loss_x loss_x 0.5039 (0.6632) acc_x 84.3750 (81.2500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 413
confident_label rate tensor(0.1316, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 99
clean true:83
clean false:16
clean_rate:0.8383838383838383
noisy true:256
noisy false:397
after delete: len(clean_dataset) 99
after delete: len(noisy_dataset) 653
epoch [18/200] batch [1/3] time 0.290 (0.290) data 0.243 (0.243) loss_x loss_x 0.7314 (0.7314) acc_x 84.3750 (84.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [2/3] time 0.312 (0.301) data 0.265 (0.254) loss_x loss_x 0.6001 (0.6658) acc_x 84.3750 (84.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [3/3] time 0.258 (0.286) data 0.211 (0.240) loss_x loss_x 0.6641 (0.6652) acc_x 90.6250 (86.4583) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 425
confident_label rate tensor(0.1476, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 111
clean true:94
clean false:17
clean_rate:0.8468468468468469
noisy true:233
noisy false:408
after delete: len(clean_dataset) 111
after delete: len(noisy_dataset) 641
epoch [19/200] batch [1/3] time 0.283 (0.283) data 0.236 (0.236) loss_x loss_x 0.4854 (0.4854) acc_x 87.5000 (87.5000) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [2/3] time 0.304 (0.294) data 0.257 (0.247) loss_x loss_x 0.6675 (0.5764) acc_x 78.1250 (82.8125) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [3/3] time 0.288 (0.292) data 0.241 (0.245) loss_x loss_x 0.6396 (0.5975) acc_x 84.3750 (83.3333) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 422
confident_label rate tensor(0.1516, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 114
clean true:95
clean false:19
clean_rate:0.8333333333333334
noisy true:235
noisy false:403
after delete: len(clean_dataset) 114
after delete: len(noisy_dataset) 638
epoch [20/200] batch [1/3] time 0.283 (0.283) data 0.236 (0.236) loss_x loss_x 0.3264 (0.3264) acc_x 93.7500 (93.7500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [2/3] time 0.261 (0.272) data 0.214 (0.225) loss_x loss_x 0.6895 (0.5079) acc_x 81.2500 (87.5000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [3/3] time 0.317 (0.287) data 0.270 (0.240) loss_x loss_x 0.5889 (0.5349) acc_x 81.2500 (85.4167) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 409
confident_label rate tensor(0.1396, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 105
clean true:88
clean false:17
clean_rate:0.8380952380952381
noisy true:255
noisy false:392
after delete: len(clean_dataset) 105
after delete: len(noisy_dataset) 647
epoch [21/200] batch [1/3] time 0.284 (0.284) data 0.237 (0.237) loss_x loss_x 0.3850 (0.3850) acc_x 90.6250 (90.6250) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [2/3] time 0.344 (0.314) data 0.295 (0.266) loss_x loss_x 0.6421 (0.5135) acc_x 84.3750 (87.5000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [3/3] time 0.242 (0.290) data 0.195 (0.242) loss_x loss_x 0.4031 (0.4767) acc_x 96.8750 (90.6250) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 408
confident_label rate tensor(0.1569, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 118
clean true:96
clean false:22
clean_rate:0.8135593220338984
noisy true:248
noisy false:386
after delete: len(clean_dataset) 118
after delete: len(noisy_dataset) 634
epoch [22/200] batch [1/3] time 0.311 (0.311) data 0.264 (0.264) loss_x loss_x 0.8838 (0.8838) acc_x 81.2500 (81.2500) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [2/3] time 0.310 (0.310) data 0.263 (0.264) loss_x loss_x 0.5068 (0.6953) acc_x 87.5000 (84.3750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [3/3] time 0.284 (0.302) data 0.237 (0.255) loss_x loss_x 0.7549 (0.7152) acc_x 75.0000 (81.2500) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 425
confident_label rate tensor(0.1516, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 114
clean true:93
clean false:21
clean_rate:0.8157894736842105
noisy true:234
noisy false:404
after delete: len(clean_dataset) 114
after delete: len(noisy_dataset) 638
epoch [23/200] batch [1/3] time 0.358 (0.358) data 0.311 (0.311) loss_x loss_x 0.3101 (0.3101) acc_x 90.6250 (90.6250) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [2/3] time 0.293 (0.325) data 0.246 (0.279) loss_x loss_x 0.4998 (0.4049) acc_x 81.2500 (85.9375) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [3/3] time 0.280 (0.310) data 0.233 (0.264) loss_x loss_x 0.3574 (0.3891) acc_x 93.7500 (88.5417) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 422
confident_label rate tensor(0.1569, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 118
clean true:95
clean false:23
clean_rate:0.8050847457627118
noisy true:235
noisy false:399
after delete: len(clean_dataset) 118
after delete: len(noisy_dataset) 634
epoch [24/200] batch [1/3] time 0.256 (0.256) data 0.209 (0.209) loss_x loss_x 0.3228 (0.3228) acc_x 93.7500 (93.7500) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [2/3] time 0.310 (0.283) data 0.263 (0.236) loss_x loss_x 0.5112 (0.4170) acc_x 87.5000 (90.6250) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [3/3] time 0.324 (0.297) data 0.277 (0.250) loss_x loss_x 0.5034 (0.4458) acc_x 87.5000 (89.5833) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 416
confident_label rate tensor(0.1543, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 116
clean true:93
clean false:23
clean_rate:0.8017241379310345
noisy true:243
noisy false:393
after delete: len(clean_dataset) 116
after delete: len(noisy_dataset) 636
epoch [25/200] batch [1/3] time 0.237 (0.237) data 0.191 (0.191) loss_x loss_x 0.4941 (0.4941) acc_x 84.3750 (84.3750) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [2/3] time 0.264 (0.251) data 0.217 (0.204) loss_x loss_x 0.4033 (0.4487) acc_x 93.7500 (89.0625) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [3/3] time 0.259 (0.253) data 0.212 (0.207) loss_x loss_x 0.5288 (0.4754) acc_x 90.6250 (89.5833) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 417
confident_label rate tensor(0.1596, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 120
clean true:97
clean false:23
clean_rate:0.8083333333333333
noisy true:238
noisy false:394
after delete: len(clean_dataset) 120
after delete: len(noisy_dataset) 632
epoch [26/200] batch [1/3] time 0.321 (0.321) data 0.274 (0.274) loss_x loss_x 0.3506 (0.3506) acc_x 93.7500 (93.7500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [2/3] time 0.278 (0.299) data 0.231 (0.252) loss_x loss_x 0.6719 (0.5112) acc_x 87.5000 (90.6250) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [3/3] time 0.278 (0.292) data 0.232 (0.245) loss_x loss_x 0.5142 (0.5122) acc_x 84.3750 (88.5417) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 418
confident_label rate tensor(0.1649, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 124
clean true:101
clean false:23
clean_rate:0.8145161290322581
noisy true:233
noisy false:395
after delete: len(clean_dataset) 124
after delete: len(noisy_dataset) 628
epoch [27/200] batch [1/3] time 0.294 (0.294) data 0.247 (0.247) loss_x loss_x 0.3682 (0.3682) acc_x 90.6250 (90.6250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [2/3] time 0.273 (0.284) data 0.226 (0.236) loss_x loss_x 0.4163 (0.3922) acc_x 90.6250 (90.6250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [3/3] time 0.300 (0.289) data 0.254 (0.242) loss_x loss_x 0.5693 (0.4513) acc_x 87.5000 (89.5833) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 422
confident_label rate tensor(0.1609, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 121
clean true:100
clean false:21
clean_rate:0.8264462809917356
noisy true:230
noisy false:401
after delete: len(clean_dataset) 121
after delete: len(noisy_dataset) 631
epoch [28/200] batch [1/3] time 0.304 (0.304) data 0.257 (0.257) loss_x loss_x 0.3608 (0.3608) acc_x 96.8750 (96.8750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [2/3] time 0.259 (0.281) data 0.211 (0.234) loss_x loss_x 0.4043 (0.3826) acc_x 93.7500 (95.3125) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [3/3] time 0.302 (0.288) data 0.256 (0.241) loss_x loss_x 0.6816 (0.4823) acc_x 81.2500 (90.6250) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 410
confident_label rate tensor(0.1556, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 117
clean true:97
clean false:20
clean_rate:0.8290598290598291
noisy true:245
noisy false:390
after delete: len(clean_dataset) 117
after delete: len(noisy_dataset) 635
epoch [29/200] batch [1/3] time 0.269 (0.269) data 0.221 (0.221) loss_x loss_x 0.2467 (0.2467) acc_x 96.8750 (96.8750) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [2/3] time 0.219 (0.244) data 0.172 (0.197) loss_x loss_x 0.3889 (0.3178) acc_x 90.6250 (93.7500) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [3/3] time 0.320 (0.269) data 0.272 (0.222) loss_x loss_x 0.4407 (0.3588) acc_x 84.3750 (90.6250) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 408
confident_label rate tensor(0.1729, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 130
clean true:107
clean false:23
clean_rate:0.823076923076923
noisy true:237
noisy false:385
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 622
epoch [30/200] batch [1/4] time 0.259 (0.259) data 0.212 (0.212) loss_x loss_x 0.4053 (0.4053) acc_x 84.3750 (84.3750) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [2/4] time 0.251 (0.255) data 0.204 (0.208) loss_x loss_x 0.3127 (0.3590) acc_x 90.6250 (87.5000) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [3/4] time 0.255 (0.255) data 0.208 (0.208) loss_x loss_x 0.3188 (0.3456) acc_x 96.8750 (90.6250) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [4/4] time 0.243 (0.252) data 0.195 (0.205) loss_x loss_x 0.7334 (0.4426) acc_x 78.1250 (87.5000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 408
confident_label rate tensor(0.1689, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 127
clean true:102
clean false:25
clean_rate:0.8031496062992126
noisy true:242
noisy false:383
after delete: len(clean_dataset) 127
after delete: len(noisy_dataset) 625
epoch [31/200] batch [1/3] time 0.275 (0.275) data 0.228 (0.228) loss_x loss_x 0.4214 (0.4214) acc_x 90.6250 (90.6250) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [2/3] time 0.278 (0.277) data 0.231 (0.229) loss_x loss_x 0.5288 (0.4751) acc_x 84.3750 (87.5000) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [3/3] time 0.265 (0.273) data 0.218 (0.225) loss_x loss_x 0.3711 (0.4404) acc_x 93.7500 (89.5833) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 400
confident_label rate tensor(0.1742, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 131
clean true:107
clean false:24
clean_rate:0.816793893129771
noisy true:245
noisy false:376
after delete: len(clean_dataset) 131
after delete: len(noisy_dataset) 621
epoch [32/200] batch [1/4] time 0.360 (0.360) data 0.311 (0.311) loss_x loss_x 0.4060 (0.4060) acc_x 84.3750 (84.3750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [2/4] time 0.279 (0.320) data 0.233 (0.272) loss_x loss_x 0.4424 (0.4242) acc_x 93.7500 (89.0625) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [3/4] time 0.309 (0.316) data 0.262 (0.269) loss_x loss_x 0.4724 (0.4403) acc_x 84.3750 (87.5000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [4/4] time 0.308 (0.314) data 0.261 (0.267) loss_x loss_x 0.7495 (0.5176) acc_x 87.5000 (87.5000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 413
confident_label rate tensor(0.1755, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 132
clean true:107
clean false:25
clean_rate:0.8106060606060606
noisy true:232
noisy false:388
after delete: len(clean_dataset) 132
after delete: len(noisy_dataset) 620
epoch [33/200] batch [1/4] time 0.299 (0.299) data 0.253 (0.253) loss_x loss_x 0.2617 (0.2617) acc_x 93.7500 (93.7500) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [2/4] time 0.340 (0.320) data 0.293 (0.273) loss_x loss_x 0.3420 (0.3019) acc_x 90.6250 (92.1875) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [3/4] time 0.237 (0.292) data 0.190 (0.245) loss_x loss_x 0.6646 (0.4228) acc_x 78.1250 (87.5000) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [4/4] time 0.298 (0.293) data 0.251 (0.247) loss_x loss_x 0.4175 (0.4214) acc_x 87.5000 (87.5000) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 406
confident_label rate tensor(0.1702, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 128
clean true:102
clean false:26
clean_rate:0.796875
noisy true:244
noisy false:380
after delete: len(clean_dataset) 128
after delete: len(noisy_dataset) 624
epoch [34/200] batch [1/4] time 0.305 (0.305) data 0.257 (0.257) loss_x loss_x 0.1901 (0.1901) acc_x 100.0000 (100.0000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [2/4] time 0.291 (0.298) data 0.242 (0.250) loss_x loss_x 0.1209 (0.1555) acc_x 100.0000 (100.0000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [3/4] time 0.277 (0.291) data 0.229 (0.243) loss_x loss_x 0.2798 (0.1969) acc_x 93.7500 (97.9167) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [4/4] time 0.302 (0.294) data 0.254 (0.246) loss_x loss_x 0.6079 (0.2997) acc_x 84.3750 (94.5312) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 406
confident_label rate tensor(0.1649, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 124
clean true:101
clean false:23
clean_rate:0.8145161290322581
noisy true:245
noisy false:383
after delete: len(clean_dataset) 124
after delete: len(noisy_dataset) 628
epoch [35/200] batch [1/3] time 0.283 (0.283) data 0.237 (0.237) loss_x loss_x 0.2262 (0.2262) acc_x 96.8750 (96.8750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [2/3] time 0.280 (0.282) data 0.233 (0.235) loss_x loss_x 0.4109 (0.3185) acc_x 93.7500 (95.3125) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [3/3] time 0.251 (0.271) data 0.204 (0.225) loss_x loss_x 0.4170 (0.3514) acc_x 90.6250 (93.7500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 427
confident_label rate tensor(0.1702, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 128
clean true:105
clean false:23
clean_rate:0.8203125
noisy true:220
noisy false:404
after delete: len(clean_dataset) 128
after delete: len(noisy_dataset) 624
epoch [36/200] batch [1/4] time 0.319 (0.319) data 0.272 (0.272) loss_x loss_x 0.5938 (0.5938) acc_x 87.5000 (87.5000) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [2/4] time 0.312 (0.315) data 0.265 (0.268) loss_x loss_x 0.3931 (0.4934) acc_x 90.6250 (89.0625) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [3/4] time 0.266 (0.299) data 0.219 (0.252) loss_x loss_x 0.4395 (0.4754) acc_x 90.6250 (89.5833) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [4/4] time 0.285 (0.295) data 0.238 (0.248) loss_x loss_x 0.4185 (0.4612) acc_x 87.5000 (89.0625) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 399
confident_label rate tensor(0.1822, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 137
clean true:112
clean false:25
clean_rate:0.8175182481751825
noisy true:241
noisy false:374
after delete: len(clean_dataset) 137
after delete: len(noisy_dataset) 615
epoch [37/200] batch [1/4] time 0.248 (0.248) data 0.201 (0.201) loss_x loss_x 0.4346 (0.4346) acc_x 84.3750 (84.3750) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [2/4] time 0.296 (0.272) data 0.248 (0.225) loss_x loss_x 0.2544 (0.3445) acc_x 90.6250 (87.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [3/4] time 0.231 (0.258) data 0.184 (0.211) loss_x loss_x 0.3115 (0.3335) acc_x 93.7500 (89.5833) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [4/4] time 0.239 (0.253) data 0.192 (0.206) loss_x loss_x 0.3730 (0.3434) acc_x 90.6250 (89.8438) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 397
confident_label rate tensor(0.1782, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 134
clean true:108
clean false:26
clean_rate:0.8059701492537313
noisy true:247
noisy false:371
after delete: len(clean_dataset) 134
after delete: len(noisy_dataset) 618
epoch [38/200] batch [1/4] time 0.283 (0.283) data 0.235 (0.235) loss_x loss_x 0.3333 (0.3333) acc_x 93.7500 (93.7500) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [2/4] time 0.291 (0.287) data 0.244 (0.239) loss_x loss_x 0.2830 (0.3081) acc_x 93.7500 (93.7500) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [3/4] time 0.319 (0.297) data 0.272 (0.250) loss_x loss_x 0.5015 (0.3726) acc_x 87.5000 (91.6667) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [4/4] time 0.290 (0.296) data 0.243 (0.248) loss_x loss_x 0.6221 (0.4349) acc_x 87.5000 (90.6250) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 410
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:104
clean false:25
clean_rate:0.8062015503875969
noisy true:238
noisy false:385
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [39/200] batch [1/4] time 0.305 (0.305) data 0.258 (0.258) loss_x loss_x 0.6167 (0.6167) acc_x 93.7500 (93.7500) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [2/4] time 0.319 (0.312) data 0.272 (0.265) loss_x loss_x 0.1548 (0.3857) acc_x 100.0000 (96.8750) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [3/4] time 0.288 (0.304) data 0.241 (0.257) loss_x loss_x 0.2032 (0.3249) acc_x 96.8750 (96.8750) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [4/4] time 0.288 (0.300) data 0.241 (0.253) loss_x loss_x 0.2952 (0.3175) acc_x 90.6250 (95.3125) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.1729, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 130
clean true:108
clean false:22
clean_rate:0.8307692307692308
noisy true:263
noisy false:359
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 622
epoch [40/200] batch [1/4] time 0.245 (0.245) data 0.198 (0.198) loss_x loss_x 0.2693 (0.2693) acc_x 93.7500 (93.7500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [2/4] time 0.254 (0.249) data 0.207 (0.202) loss_x loss_x 0.4338 (0.3516) acc_x 90.6250 (92.1875) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [3/4] time 0.338 (0.279) data 0.291 (0.232) loss_x loss_x 0.4668 (0.3900) acc_x 81.2500 (88.5417) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [4/4] time 0.284 (0.280) data 0.237 (0.233) loss_x loss_x 0.3601 (0.3825) acc_x 90.6250 (89.0625) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 398
confident_label rate tensor(0.1782, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 134
clean true:107
clean false:27
clean_rate:0.7985074626865671
noisy true:247
noisy false:371
after delete: len(clean_dataset) 134
after delete: len(noisy_dataset) 618
epoch [41/200] batch [1/4] time 0.307 (0.307) data 0.260 (0.260) loss_x loss_x 0.4929 (0.4929) acc_x 90.6250 (90.6250) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [2/4] time 0.288 (0.298) data 0.241 (0.251) loss_x loss_x 0.2688 (0.3809) acc_x 96.8750 (93.7500) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [3/4] time 0.268 (0.288) data 0.221 (0.241) loss_x loss_x 0.3330 (0.3649) acc_x 90.6250 (92.7083) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [4/4] time 0.319 (0.296) data 0.272 (0.249) loss_x loss_x 0.5098 (0.4011) acc_x 87.5000 (91.4062) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 395
confident_label rate tensor(0.1755, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 132
clean true:107
clean false:25
clean_rate:0.8106060606060606
noisy true:250
noisy false:370
after delete: len(clean_dataset) 132
after delete: len(noisy_dataset) 620
epoch [42/200] batch [1/4] time 0.292 (0.292) data 0.243 (0.243) loss_x loss_x 0.2257 (0.2257) acc_x 96.8750 (96.8750) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [2/4] time 0.325 (0.309) data 0.278 (0.260) loss_x loss_x 0.4258 (0.3257) acc_x 93.7500 (95.3125) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [3/4] time 0.278 (0.299) data 0.232 (0.251) loss_x loss_x 0.3811 (0.3442) acc_x 87.5000 (92.7083) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [4/4] time 0.279 (0.294) data 0.232 (0.246) loss_x loss_x 0.8555 (0.4720) acc_x 84.3750 (90.6250) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 397
confident_label rate tensor(0.1848, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 139
clean true:115
clean false:24
clean_rate:0.8273381294964028
noisy true:240
noisy false:373
after delete: len(clean_dataset) 139
after delete: len(noisy_dataset) 613
epoch [43/200] batch [1/4] time 0.313 (0.313) data 0.266 (0.266) loss_x loss_x 0.2084 (0.2084) acc_x 96.8750 (96.8750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [2/4] time 0.287 (0.300) data 0.240 (0.253) loss_x loss_x 0.3887 (0.2985) acc_x 93.7500 (95.3125) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [3/4] time 0.279 (0.293) data 0.231 (0.246) loss_x loss_x 0.1680 (0.2550) acc_x 100.0000 (96.8750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [4/4] time 0.280 (0.290) data 0.234 (0.243) loss_x loss_x 0.4827 (0.3119) acc_x 93.7500 (96.0938) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 395
confident_label rate tensor(0.1862, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 140
clean true:115
clean false:25
clean_rate:0.8214285714285714
noisy true:242
noisy false:370
after delete: len(clean_dataset) 140
after delete: len(noisy_dataset) 612
epoch [44/200] batch [1/4] time 0.317 (0.317) data 0.271 (0.271) loss_x loss_x 0.2529 (0.2529) acc_x 96.8750 (96.8750) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [2/4] time 0.280 (0.299) data 0.233 (0.252) loss_x loss_x 0.1263 (0.1896) acc_x 96.8750 (96.8750) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [3/4] time 0.279 (0.292) data 0.233 (0.245) loss_x loss_x 0.2598 (0.2130) acc_x 93.7500 (95.8333) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [4/4] time 0.299 (0.294) data 0.252 (0.247) loss_x loss_x 0.2847 (0.2309) acc_x 93.7500 (95.3125) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 401
confident_label rate tensor(0.1835, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 138
clean true:113
clean false:25
clean_rate:0.8188405797101449
noisy true:238
noisy false:376
after delete: len(clean_dataset) 138
after delete: len(noisy_dataset) 614
epoch [45/200] batch [1/4] time 0.246 (0.246) data 0.199 (0.199) loss_x loss_x 0.2399 (0.2399) acc_x 93.7500 (93.7500) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [2/4] time 0.305 (0.275) data 0.258 (0.228) loss_x loss_x 0.1849 (0.2124) acc_x 96.8750 (95.3125) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [3/4] time 0.328 (0.293) data 0.280 (0.246) loss_x loss_x 0.2136 (0.2128) acc_x 96.8750 (95.8333) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [4/4] time 0.313 (0.298) data 0.266 (0.251) loss_x loss_x 0.1172 (0.1889) acc_x 100.0000 (96.8750) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 397
confident_label rate tensor(0.1848, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 139
clean true:115
clean false:24
clean_rate:0.8273381294964028
noisy true:240
noisy false:373
after delete: len(clean_dataset) 139
after delete: len(noisy_dataset) 613
epoch [46/200] batch [1/4] time 0.295 (0.295) data 0.248 (0.248) loss_x loss_x 0.0671 (0.0671) acc_x 100.0000 (100.0000) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [2/4] time 0.272 (0.284) data 0.225 (0.237) loss_x loss_x 0.2847 (0.1759) acc_x 90.6250 (95.3125) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [3/4] time 0.298 (0.288) data 0.251 (0.241) loss_x loss_x 0.6104 (0.3207) acc_x 81.2500 (90.6250) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [4/4] time 0.300 (0.291) data 0.253 (0.244) loss_x loss_x 0.5762 (0.3846) acc_x 87.5000 (89.8438) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 397
confident_label rate tensor(0.1875, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 141
clean true:116
clean false:25
clean_rate:0.8226950354609929
noisy true:239
noisy false:372
after delete: len(clean_dataset) 141
after delete: len(noisy_dataset) 611
epoch [47/200] batch [1/4] time 0.284 (0.284) data 0.234 (0.234) loss_x loss_x 0.2896 (0.2896) acc_x 93.7500 (93.7500) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [2/4] time 0.305 (0.295) data 0.258 (0.246) loss_x loss_x 0.2168 (0.2532) acc_x 96.8750 (95.3125) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [3/4] time 0.323 (0.304) data 0.276 (0.256) loss_x loss_x 0.2529 (0.2531) acc_x 90.6250 (93.7500) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [4/4] time 0.288 (0.300) data 0.241 (0.252) loss_x loss_x 0.3545 (0.2784) acc_x 90.6250 (92.9688) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 393
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 147
clean true:118
clean false:29
clean_rate:0.8027210884353742
noisy true:241
noisy false:364
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 605
epoch [48/200] batch [1/4] time 0.257 (0.257) data 0.211 (0.211) loss_x loss_x 0.2402 (0.2402) acc_x 93.7500 (93.7500) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [2/4] time 0.242 (0.250) data 0.195 (0.203) loss_x loss_x 0.4133 (0.3268) acc_x 87.5000 (90.6250) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [3/4] time 0.259 (0.253) data 0.212 (0.206) loss_x loss_x 0.2074 (0.2870) acc_x 93.7500 (91.6667) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [4/4] time 0.292 (0.263) data 0.246 (0.216) loss_x loss_x 0.2515 (0.2781) acc_x 96.8750 (92.9688) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1941, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 146
clean true:120
clean false:26
clean_rate:0.821917808219178
noisy true:241
noisy false:365
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 606
epoch [49/200] batch [1/4] time 0.301 (0.301) data 0.254 (0.254) loss_x loss_x 0.2499 (0.2499) acc_x 93.7500 (93.7500) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [2/4] time 0.307 (0.304) data 0.260 (0.257) loss_x loss_x 0.4062 (0.3281) acc_x 84.3750 (89.0625) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [3/4] time 0.248 (0.286) data 0.201 (0.239) loss_x loss_x 0.2341 (0.2968) acc_x 93.7500 (90.6250) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [4/4] time 0.312 (0.292) data 0.266 (0.245) loss_x loss_x 0.3330 (0.3058) acc_x 90.6250 (90.6250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1835, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 138
clean true:113
clean false:25
clean_rate:0.8188405797101449
noisy true:248
noisy false:366
after delete: len(clean_dataset) 138
after delete: len(noisy_dataset) 614
epoch [50/200] batch [1/4] time 0.342 (0.342) data 0.293 (0.293) loss_x loss_x 0.3342 (0.3342) acc_x 90.6250 (90.6250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [2/4] time 0.294 (0.318) data 0.246 (0.270) loss_x loss_x 0.2007 (0.2675) acc_x 93.7500 (92.1875) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [3/4] time 0.288 (0.308) data 0.240 (0.260) loss_x loss_x 0.2490 (0.2613) acc_x 96.8750 (93.7500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [4/4] time 0.298 (0.305) data 0.251 (0.258) loss_x loss_x 1.0244 (0.4521) acc_x 90.6250 (92.9688) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 390
confident_label rate tensor(0.1941, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 146
clean true:118
clean false:28
clean_rate:0.8082191780821918
noisy true:244
noisy false:362
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 606
epoch [51/200] batch [1/4] time 0.274 (0.274) data 0.228 (0.228) loss_x loss_x 0.6221 (0.6221) acc_x 96.8750 (96.8750) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [2/4] time 0.289 (0.282) data 0.242 (0.235) loss_x loss_x 0.3948 (0.5084) acc_x 87.5000 (92.1875) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [3/4] time 0.317 (0.293) data 0.269 (0.246) loss_x loss_x 0.2925 (0.4364) acc_x 93.7500 (92.7083) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [4/4] time 0.295 (0.294) data 0.247 (0.246) loss_x loss_x 0.4358 (0.4363) acc_x 90.6250 (92.1875) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1888, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 142
clean true:117
clean false:25
clean_rate:0.823943661971831
noisy true:244
noisy false:366
after delete: len(clean_dataset) 142
after delete: len(noisy_dataset) 610
epoch [52/200] batch [1/4] time 0.267 (0.267) data 0.220 (0.220) loss_x loss_x 0.2095 (0.2095) acc_x 93.7500 (93.7500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [2/4] time 0.287 (0.277) data 0.240 (0.230) loss_x loss_x 0.4109 (0.3102) acc_x 87.5000 (90.6250) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [3/4] time 0.310 (0.288) data 0.262 (0.241) loss_x loss_x 0.1757 (0.2653) acc_x 96.8750 (92.7083) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [4/4] time 0.282 (0.286) data 0.235 (0.239) loss_x loss_x 0.1538 (0.2375) acc_x 100.0000 (94.5312) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.1941, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 146
clean true:121
clean false:25
clean_rate:0.8287671232876712
noisy true:254
noisy false:352
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 606
epoch [53/200] batch [1/4] time 0.265 (0.265) data 0.218 (0.218) loss_x loss_x 0.1185 (0.1185) acc_x 96.8750 (96.8750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [2/4] time 0.247 (0.256) data 0.199 (0.209) loss_x loss_x 0.2649 (0.1917) acc_x 93.7500 (95.3125) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [3/4] time 0.250 (0.254) data 0.204 (0.207) loss_x loss_x 0.1880 (0.1905) acc_x 100.0000 (96.8750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [4/4] time 0.242 (0.251) data 0.194 (0.204) loss_x loss_x 0.2482 (0.2049) acc_x 90.6250 (95.3125) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1928, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 145
clean true:119
clean false:26
clean_rate:0.8206896551724138
noisy true:242
noisy false:365
after delete: len(clean_dataset) 145
after delete: len(noisy_dataset) 607
epoch [54/200] batch [1/4] time 0.314 (0.314) data 0.267 (0.267) loss_x loss_x 0.2722 (0.2722) acc_x 96.8750 (96.8750) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [2/4] time 0.289 (0.302) data 0.242 (0.255) loss_x loss_x 0.1792 (0.2257) acc_x 96.8750 (96.8750) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [3/4] time 0.270 (0.291) data 0.223 (0.244) loss_x loss_x 0.5029 (0.3181) acc_x 87.5000 (93.7500) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [4/4] time 0.290 (0.291) data 0.242 (0.244) loss_x loss_x 0.5845 (0.3847) acc_x 84.3750 (91.4062) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 398
confident_label rate tensor(0.1915, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 144
clean true:118
clean false:26
clean_rate:0.8194444444444444
noisy true:236
noisy false:372
after delete: len(clean_dataset) 144
after delete: len(noisy_dataset) 608
epoch [55/200] batch [1/4] time 0.301 (0.301) data 0.253 (0.253) loss_x loss_x 0.4397 (0.4397) acc_x 96.8750 (96.8750) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [2/4] time 0.275 (0.288) data 0.228 (0.240) loss_x loss_x 0.1044 (0.2720) acc_x 100.0000 (98.4375) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [3/4] time 0.304 (0.293) data 0.257 (0.246) loss_x loss_x 0.3821 (0.3087) acc_x 87.5000 (94.7917) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [4/4] time 0.257 (0.284) data 0.209 (0.237) loss_x loss_x 0.3892 (0.3288) acc_x 90.6250 (93.7500) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.1968, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 148
clean true:124
clean false:24
clean_rate:0.8378378378378378
noisy true:248
noisy false:356
after delete: len(clean_dataset) 148
after delete: len(noisy_dataset) 604
epoch [56/200] batch [1/4] time 0.284 (0.284) data 0.238 (0.238) loss_x loss_x 0.2712 (0.2712) acc_x 96.8750 (96.8750) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [2/4] time 0.318 (0.301) data 0.271 (0.254) loss_x loss_x 0.3472 (0.3092) acc_x 96.8750 (96.8750) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [3/4] time 0.297 (0.300) data 0.250 (0.253) loss_x loss_x 0.1426 (0.2537) acc_x 100.0000 (97.9167) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [4/4] time 0.286 (0.296) data 0.239 (0.249) loss_x loss_x 0.1975 (0.2396) acc_x 96.8750 (97.6562) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2035, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 153
clean true:124
clean false:29
clean_rate:0.8104575163398693
noisy true:259
noisy false:340
after delete: len(clean_dataset) 153
after delete: len(noisy_dataset) 599
epoch [57/200] batch [1/4] time 0.309 (0.309) data 0.262 (0.262) loss_x loss_x 0.4119 (0.4119) acc_x 96.8750 (96.8750) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [2/4] time 0.291 (0.300) data 0.244 (0.253) loss_x loss_x 0.3469 (0.3794) acc_x 87.5000 (92.1875) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [3/4] time 0.293 (0.298) data 0.245 (0.251) loss_x loss_x 0.3342 (0.3643) acc_x 93.7500 (92.7083) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [4/4] time 0.342 (0.309) data 0.294 (0.262) loss_x loss_x 0.5894 (0.4206) acc_x 93.7500 (92.9688) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.1995, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 150
clean true:123
clean false:27
clean_rate:0.82
noisy true:255
noisy false:347
after delete: len(clean_dataset) 150
after delete: len(noisy_dataset) 602
epoch [58/200] batch [1/4] time 0.234 (0.234) data 0.187 (0.187) loss_x loss_x 0.1721 (0.1721) acc_x 96.8750 (96.8750) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [2/4] time 0.244 (0.239) data 0.197 (0.192) loss_x loss_x 0.3452 (0.2587) acc_x 90.6250 (93.7500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [3/4] time 0.266 (0.248) data 0.219 (0.201) loss_x loss_x 0.4170 (0.3114) acc_x 84.3750 (90.6250) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [4/4] time 0.298 (0.261) data 0.252 (0.214) loss_x loss_x 0.2681 (0.3006) acc_x 93.7500 (91.4062) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 386
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 147
clean true:121
clean false:26
clean_rate:0.8231292517006803
noisy true:245
noisy false:360
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 605
epoch [59/200] batch [1/4] time 0.315 (0.315) data 0.268 (0.268) loss_x loss_x 0.1931 (0.1931) acc_x 96.8750 (96.8750) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [2/4] time 0.259 (0.287) data 0.212 (0.240) loss_x loss_x 0.1346 (0.1639) acc_x 100.0000 (98.4375) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [3/4] time 0.293 (0.289) data 0.247 (0.242) loss_x loss_x 0.1785 (0.1687) acc_x 96.8750 (97.9167) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [4/4] time 0.305 (0.293) data 0.258 (0.246) loss_x loss_x 0.2729 (0.1948) acc_x 96.8750 (97.6562) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 147
clean true:122
clean false:25
clean_rate:0.8299319727891157
noisy true:259
noisy false:346
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 605
epoch [60/200] batch [1/4] time 0.316 (0.316) data 0.269 (0.269) loss_x loss_x 0.2025 (0.2025) acc_x 96.8750 (96.8750) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [2/4] time 0.319 (0.317) data 0.272 (0.271) loss_x loss_x 0.1633 (0.1829) acc_x 96.8750 (96.8750) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [3/4] time 0.287 (0.307) data 0.240 (0.261) loss_x loss_x 0.5371 (0.3010) acc_x 87.5000 (93.7500) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [4/4] time 0.295 (0.304) data 0.248 (0.257) loss_x loss_x 0.1608 (0.2659) acc_x 96.8750 (94.5312) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.1941, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 146
clean true:120
clean false:26
clean_rate:0.821917808219178
noisy true:271
noisy false:335
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 606
epoch [61/200] batch [1/4] time 0.321 (0.321) data 0.274 (0.274) loss_x loss_x 0.1793 (0.1793) acc_x 96.8750 (96.8750) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [2/4] time 0.313 (0.317) data 0.267 (0.270) loss_x loss_x 0.2489 (0.2141) acc_x 90.6250 (93.7500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [3/4] time 0.290 (0.308) data 0.243 (0.261) loss_x loss_x 0.2489 (0.2257) acc_x 93.7500 (93.7500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [4/4] time 0.283 (0.302) data 0.236 (0.255) loss_x loss_x 0.3000 (0.2443) acc_x 90.6250 (92.9688) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2021, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 152
clean true:125
clean false:27
clean_rate:0.8223684210526315
noisy true:259
noisy false:341
after delete: len(clean_dataset) 152
after delete: len(noisy_dataset) 600
epoch [62/200] batch [1/4] time 0.296 (0.296) data 0.249 (0.249) loss_x loss_x 0.5698 (0.5698) acc_x 87.5000 (87.5000) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [2/4] time 0.286 (0.291) data 0.239 (0.244) loss_x loss_x 0.1871 (0.3785) acc_x 96.8750 (92.1875) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [3/4] time 0.242 (0.275) data 0.195 (0.228) loss_x loss_x 0.2732 (0.3434) acc_x 93.7500 (92.7083) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [4/4] time 0.258 (0.270) data 0.211 (0.223) loss_x loss_x 0.1975 (0.3069) acc_x 96.8750 (93.7500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2021, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 152
clean true:123
clean false:29
clean_rate:0.8092105263157895
noisy true:250
noisy false:350
after delete: len(clean_dataset) 152
after delete: len(noisy_dataset) 600
epoch [63/200] batch [1/4] time 0.297 (0.297) data 0.250 (0.250) loss_x loss_x 0.2170 (0.2170) acc_x 93.7500 (93.7500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [2/4] time 0.300 (0.298) data 0.252 (0.251) loss_x loss_x 0.1110 (0.1640) acc_x 100.0000 (96.8750) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [3/4] time 0.300 (0.299) data 0.254 (0.252) loss_x loss_x 0.1750 (0.1677) acc_x 93.7500 (95.8333) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [4/4] time 0.273 (0.293) data 0.226 (0.245) loss_x loss_x 0.7275 (0.3077) acc_x 81.2500 (92.1875) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2088, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 157
clean true:129
clean false:28
clean_rate:0.821656050955414
noisy true:250
noisy false:345
after delete: len(clean_dataset) 157
after delete: len(noisy_dataset) 595
epoch [64/200] batch [1/4] time 0.296 (0.296) data 0.249 (0.249) loss_x loss_x 0.3342 (0.3342) acc_x 90.6250 (90.6250) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [2/4] time 0.264 (0.280) data 0.217 (0.233) loss_x loss_x 0.1307 (0.2325) acc_x 100.0000 (95.3125) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [3/4] time 0.283 (0.281) data 0.236 (0.234) loss_x loss_x 0.2754 (0.2468) acc_x 96.8750 (95.8333) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [4/4] time 0.272 (0.279) data 0.225 (0.232) loss_x loss_x 0.1650 (0.2263) acc_x 100.0000 (96.8750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 149
clean true:118
clean false:31
clean_rate:0.7919463087248322
noisy true:260
noisy false:343
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 603
epoch [65/200] batch [1/4] time 0.279 (0.279) data 0.232 (0.232) loss_x loss_x 0.1022 (0.1022) acc_x 96.8750 (96.8750) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [2/4] time 0.276 (0.278) data 0.227 (0.230) loss_x loss_x 0.0710 (0.0866) acc_x 100.0000 (98.4375) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [3/4] time 0.282 (0.279) data 0.236 (0.232) loss_x loss_x 0.3276 (0.1670) acc_x 90.6250 (95.8333) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [4/4] time 0.310 (0.287) data 0.263 (0.240) loss_x loss_x 0.1750 (0.1690) acc_x 96.8750 (96.0938) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2021, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 152
clean true:123
clean false:29
clean_rate:0.8092105263157895
noisy true:246
noisy false:354
after delete: len(clean_dataset) 152
after delete: len(noisy_dataset) 600
epoch [66/200] batch [1/4] time 0.324 (0.324) data 0.277 (0.277) loss_x loss_x 0.1733 (0.1733) acc_x 96.8750 (96.8750) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [2/4] time 0.302 (0.313) data 0.252 (0.265) loss_x loss_x 0.2267 (0.2000) acc_x 93.7500 (95.3125) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [3/4] time 0.301 (0.309) data 0.254 (0.261) loss_x loss_x 0.5078 (0.3026) acc_x 93.7500 (94.7917) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [4/4] time 0.308 (0.309) data 0.261 (0.261) loss_x loss_x 0.2279 (0.2839) acc_x 96.8750 (95.3125) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2074, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 156
clean true:126
clean false:30
clean_rate:0.8076923076923077
noisy true:250
noisy false:346
after delete: len(clean_dataset) 156
after delete: len(noisy_dataset) 596
epoch [67/200] batch [1/4] time 0.289 (0.289) data 0.239 (0.239) loss_x loss_x 0.1027 (0.1027) acc_x 100.0000 (100.0000) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [2/4] time 0.235 (0.262) data 0.188 (0.213) loss_x loss_x 0.4229 (0.2628) acc_x 90.6250 (95.3125) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [3/4] time 0.257 (0.260) data 0.210 (0.212) loss_x loss_x 0.2350 (0.2535) acc_x 93.7500 (94.7917) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [4/4] time 0.326 (0.277) data 0.278 (0.229) loss_x loss_x 0.5854 (0.3365) acc_x 90.6250 (93.7500) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2061, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 155
clean true:124
clean false:31
clean_rate:0.8
noisy true:247
noisy false:350
after delete: len(clean_dataset) 155
after delete: len(noisy_dataset) 597
epoch [68/200] batch [1/4] time 0.315 (0.315) data 0.268 (0.268) loss_x loss_x 0.1422 (0.1422) acc_x 100.0000 (100.0000) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [2/4] time 0.284 (0.300) data 0.238 (0.253) loss_x loss_x 0.1547 (0.1484) acc_x 96.8750 (98.4375) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [3/4] time 0.319 (0.306) data 0.272 (0.259) loss_x loss_x 0.1143 (0.1371) acc_x 96.8750 (97.9167) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [4/4] time 0.314 (0.308) data 0.268 (0.261) loss_x loss_x 0.2703 (0.1704) acc_x 93.7500 (96.8750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2128, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 160
clean true:129
clean false:31
clean_rate:0.80625
noisy true:260
noisy false:332
after delete: len(clean_dataset) 160
after delete: len(noisy_dataset) 592
epoch [69/200] batch [5/5] time 0.287 (0.295) data 0.240 (0.248) loss_x loss_x 0.2424 (0.3198) acc_x 96.8750 (92.5000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 389
confident_label rate tensor(0.1941, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 146
clean true:117
clean false:29
clean_rate:0.8013698630136986
noisy true:246
noisy false:360
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 606
epoch [70/200] batch [1/4] time 0.306 (0.306) data 0.259 (0.259) loss_x loss_x 0.1871 (0.1871) acc_x 96.8750 (96.8750) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [2/4] time 0.290 (0.298) data 0.240 (0.249) loss_x loss_x 0.1488 (0.1680) acc_x 93.7500 (95.3125) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [3/4] time 0.262 (0.286) data 0.216 (0.238) loss_x loss_x 0.3521 (0.2293) acc_x 93.7500 (94.7917) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [4/4] time 0.255 (0.278) data 0.205 (0.230) loss_x loss_x 0.3018 (0.2474) acc_x 93.7500 (94.5312) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 154
clean true:123
clean false:31
clean_rate:0.7987012987012987
noisy true:257
noisy false:341
after delete: len(clean_dataset) 154
after delete: len(noisy_dataset) 598
epoch [71/200] batch [1/4] time 0.311 (0.311) data 0.264 (0.264) loss_x loss_x 0.1769 (0.1769) acc_x 96.8750 (96.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [2/4] time 0.301 (0.306) data 0.254 (0.259) loss_x loss_x 0.3433 (0.2601) acc_x 93.7500 (95.3125) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [3/4] time 0.303 (0.305) data 0.256 (0.258) loss_x loss_x 0.2288 (0.2496) acc_x 96.8750 (95.8333) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [4/4] time 0.297 (0.303) data 0.250 (0.256) loss_x loss_x 0.3816 (0.2826) acc_x 90.6250 (94.5312) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 382
confident_label rate tensor(0.2035, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 153
clean true:122
clean false:31
clean_rate:0.7973856209150327
noisy true:248
noisy false:351
after delete: len(clean_dataset) 153
after delete: len(noisy_dataset) 599
epoch [72/200] batch [1/4] time 0.287 (0.287) data 0.241 (0.241) loss_x loss_x 0.1040 (0.1040) acc_x 100.0000 (100.0000) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [2/4] time 0.292 (0.290) data 0.245 (0.243) loss_x loss_x 0.2288 (0.1664) acc_x 93.7500 (96.8750) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [3/4] time 0.318 (0.299) data 0.271 (0.252) loss_x loss_x 0.7710 (0.3679) acc_x 84.3750 (92.7083) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [4/4] time 0.292 (0.297) data 0.245 (0.251) loss_x loss_x 0.1952 (0.3247) acc_x 93.7500 (92.9688) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 154
clean true:125
clean false:29
clean_rate:0.8116883116883117
noisy true:252
noisy false:346
after delete: len(clean_dataset) 154
after delete: len(noisy_dataset) 598
epoch [73/200] batch [1/4] time 0.285 (0.285) data 0.238 (0.238) loss_x loss_x 0.0766 (0.0766) acc_x 100.0000 (100.0000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [2/4] time 0.293 (0.289) data 0.246 (0.242) loss_x loss_x 0.2942 (0.1854) acc_x 90.6250 (95.3125) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [3/4] time 0.278 (0.285) data 0.231 (0.239) loss_x loss_x 0.2954 (0.2221) acc_x 96.8750 (95.8333) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [4/4] time 0.308 (0.291) data 0.261 (0.244) loss_x loss_x 0.2773 (0.2359) acc_x 96.8750 (96.0938) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2128, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 160
clean true:127
clean false:33
clean_rate:0.79375
noisy true:255
noisy false:337
after delete: len(clean_dataset) 160
after delete: len(noisy_dataset) 592
epoch [74/200] batch [5/5] time 0.276 (0.301) data 0.229 (0.254) loss_x loss_x 0.1191 (0.3384) acc_x 100.0000 (96.2500) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2128, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 160
clean true:129
clean false:31
clean_rate:0.80625
noisy true:258
noisy false:334
after delete: len(clean_dataset) 160
after delete: len(noisy_dataset) 592
epoch [75/200] batch [5/5] time 0.312 (0.292) data 0.265 (0.245) loss_x loss_x 0.1749 (0.2094) acc_x 96.8750 (96.2500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.2154, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 162
clean true:133
clean false:29
clean_rate:0.8209876543209876
noisy true:266
noisy false:324
after delete: len(clean_dataset) 162
after delete: len(noisy_dataset) 590
epoch [76/200] batch [5/5] time 0.288 (0.288) data 0.240 (0.240) loss_x loss_x 0.5728 (0.4135) acc_x 90.6250 (93.1250) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2128, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 160
clean true:128
clean false:32
clean_rate:0.8
noisy true:264
noisy false:328
after delete: len(clean_dataset) 160
after delete: len(noisy_dataset) 592
epoch [77/200] batch [5/5] time 0.261 (0.275) data 0.214 (0.229) loss_x loss_x 0.2260 (0.2381) acc_x 96.8750 (93.7500) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2088, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 157
clean true:127
clean false:30
clean_rate:0.8089171974522293
noisy true:258
noisy false:337
after delete: len(clean_dataset) 157
after delete: len(noisy_dataset) 595
epoch [78/200] batch [1/4] time 0.304 (0.304) data 0.257 (0.257) loss_x loss_x 0.2163 (0.2163) acc_x 93.7500 (93.7500) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [2/4] time 0.297 (0.301) data 0.251 (0.254) loss_x loss_x 0.1904 (0.2034) acc_x 96.8750 (95.3125) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [3/4] time 0.287 (0.296) data 0.239 (0.249) loss_x loss_x 0.4202 (0.2756) acc_x 84.3750 (91.6667) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [4/4] time 0.293 (0.295) data 0.246 (0.248) loss_x loss_x 0.2438 (0.2677) acc_x 93.7500 (92.1875) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2074, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 156
clean true:123
clean false:33
clean_rate:0.7884615384615384
noisy true:270
noisy false:326
after delete: len(clean_dataset) 156
after delete: len(noisy_dataset) 596
epoch [79/200] batch [1/4] time 0.298 (0.298) data 0.251 (0.251) loss_x loss_x 0.2460 (0.2460) acc_x 93.7500 (93.7500) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [2/4] time 0.283 (0.291) data 0.236 (0.243) loss_x loss_x 0.2247 (0.2354) acc_x 93.7500 (93.7500) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [3/4] time 0.262 (0.281) data 0.215 (0.234) loss_x loss_x 0.1270 (0.1992) acc_x 96.8750 (94.7917) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [4/4] time 0.298 (0.285) data 0.251 (0.238) loss_x loss_x 0.4229 (0.2551) acc_x 96.8750 (95.3125) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2154, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 162
clean true:129
clean false:33
clean_rate:0.7962962962962963
noisy true:259
noisy false:331
after delete: len(clean_dataset) 162
after delete: len(noisy_dataset) 590
epoch [80/200] batch [5/5] time 0.268 (0.295) data 0.221 (0.248) loss_x loss_x 0.2327 (0.1985) acc_x 96.8750 (96.2500) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2168, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 163
clean true:130
clean false:33
clean_rate:0.7975460122699386
noisy true:252
noisy false:337
after delete: len(clean_dataset) 163
after delete: len(noisy_dataset) 589
epoch [81/200] batch [5/5] time 0.279 (0.304) data 0.232 (0.257) loss_x loss_x 0.0835 (0.2471) acc_x 100.0000 (95.6250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:137
clean false:30
clean_rate:0.8203592814371258
noisy true:251
noisy false:334
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [82/200] batch [5/5] time 0.259 (0.265) data 0.212 (0.219) loss_x loss_x 0.2661 (0.3801) acc_x 90.6250 (91.2500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2154, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 162
clean true:130
clean false:32
clean_rate:0.8024691358024691
noisy true:260
noisy false:330
after delete: len(clean_dataset) 162
after delete: len(noisy_dataset) 590
epoch [83/200] batch [5/5] time 0.325 (0.295) data 0.278 (0.248) loss_x loss_x 0.2942 (0.2254) acc_x 90.6250 (95.6250) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2168, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 163
clean true:131
clean false:32
clean_rate:0.803680981595092
noisy true:247
noisy false:342
after delete: len(clean_dataset) 163
after delete: len(noisy_dataset) 589
epoch [84/200] batch [5/5] time 0.288 (0.280) data 0.242 (0.233) loss_x loss_x 0.8042 (0.3859) acc_x 87.5000 (92.5000) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:130
clean false:31
clean_rate:0.8074534161490683
noisy true:258
noisy false:333
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [85/200] batch [5/5] time 0.293 (0.288) data 0.246 (0.241) loss_x loss_x 0.1146 (0.1812) acc_x 100.0000 (96.2500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2168, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 163
clean true:132
clean false:31
clean_rate:0.8098159509202454
noisy true:257
noisy false:332
after delete: len(clean_dataset) 163
after delete: len(noisy_dataset) 589
epoch [86/200] batch [5/5] time 0.288 (0.289) data 0.241 (0.242) loss_x loss_x 0.3665 (0.1978) acc_x 96.8750 (97.5000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2101, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 158
clean true:124
clean false:34
clean_rate:0.7848101265822784
noisy true:257
noisy false:337
after delete: len(clean_dataset) 158
after delete: len(noisy_dataset) 594
epoch [87/200] batch [1/4] time 0.302 (0.302) data 0.254 (0.254) loss_x loss_x 0.2076 (0.2076) acc_x 93.7500 (93.7500) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [2/4] time 0.281 (0.291) data 0.234 (0.244) loss_x loss_x 0.1118 (0.1597) acc_x 100.0000 (96.8750) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [3/4] time 0.305 (0.296) data 0.258 (0.249) loss_x loss_x 0.1089 (0.1428) acc_x 100.0000 (97.9167) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [4/4] time 0.301 (0.297) data 0.254 (0.250) loss_x loss_x 0.0924 (0.1302) acc_x 100.0000 (98.4375) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 357
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:131
clean false:30
clean_rate:0.8136645962732919
noisy true:264
noisy false:327
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [88/200] batch [5/5] time 0.293 (0.311) data 0.246 (0.264) loss_x loss_x 0.2454 (0.1572) acc_x 96.8750 (97.5000) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:131
clean false:36
clean_rate:0.7844311377245509
noisy true:243
noisy false:342
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [89/200] batch [5/5] time 0.290 (0.290) data 0.243 (0.242) loss_x loss_x 0.6719 (0.3204) acc_x 93.7500 (93.7500) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 164
clean true:131
clean false:33
clean_rate:0.7987804878048781
noisy true:255
noisy false:333
after delete: len(clean_dataset) 164
after delete: len(noisy_dataset) 588
epoch [90/200] batch [5/5] time 0.286 (0.297) data 0.240 (0.250) loss_x loss_x 0.1000 (0.2850) acc_x 100.0000 (94.3750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:128
clean false:33
clean_rate:0.7950310559006211
noisy true:254
noisy false:337
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [91/200] batch [5/5] time 0.302 (0.292) data 0.255 (0.244) loss_x loss_x 0.1577 (0.1619) acc_x 93.7500 (96.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:134
clean false:33
clean_rate:0.8023952095808383
noisy true:244
noisy false:341
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [92/200] batch [5/5] time 0.266 (0.285) data 0.219 (0.238) loss_x loss_x 0.1202 (0.1396) acc_x 96.8750 (96.8750) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2168, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 163
clean true:129
clean false:34
clean_rate:0.7914110429447853
noisy true:260
noisy false:329
after delete: len(clean_dataset) 163
after delete: len(noisy_dataset) 589
epoch [93/200] batch [5/5] time 0.305 (0.294) data 0.258 (0.247) loss_x loss_x 0.1017 (0.1705) acc_x 100.0000 (96.8750) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2168, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 163
clean true:128
clean false:35
clean_rate:0.7852760736196319
noisy true:252
noisy false:337
after delete: len(clean_dataset) 163
after delete: len(noisy_dataset) 589
epoch [94/200] batch [5/5] time 0.287 (0.302) data 0.240 (0.255) loss_x loss_x 0.1344 (0.1411) acc_x 96.8750 (97.5000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 170
clean true:138
clean false:32
clean_rate:0.8117647058823529
noisy true:255
noisy false:327
after delete: len(clean_dataset) 170
after delete: len(noisy_dataset) 582
epoch [95/200] batch [5/5] time 0.290 (0.303) data 0.243 (0.256) loss_x loss_x 0.1506 (0.1898) acc_x 96.8750 (96.2500) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:135
clean false:32
clean_rate:0.8083832335329342
noisy true:262
noisy false:323
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [96/200] batch [5/5] time 0.282 (0.295) data 0.235 (0.248) loss_x loss_x 0.2218 (0.1700) acc_x 96.8750 (96.2500) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2301, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 173
clean true:138
clean false:35
clean_rate:0.7976878612716763
noisy true:260
noisy false:319
after delete: len(clean_dataset) 173
after delete: len(noisy_dataset) 579
epoch [97/200] batch [5/5] time 0.250 (0.283) data 0.203 (0.236) loss_x loss_x 0.2096 (0.3084) acc_x 93.7500 (92.5000) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 175
clean true:136
clean false:39
clean_rate:0.7771428571428571
noisy true:236
noisy false:341
after delete: len(clean_dataset) 175
after delete: len(noisy_dataset) 577
epoch [98/200] batch [5/5] time 0.293 (0.274) data 0.246 (0.226) loss_x loss_x 0.1849 (0.2737) acc_x 93.7500 (93.7500) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 175
clean true:139
clean false:36
clean_rate:0.7942857142857143
noisy true:247
noisy false:330
after delete: len(clean_dataset) 175
after delete: len(noisy_dataset) 577
epoch [99/200] batch [5/5] time 0.292 (0.295) data 0.245 (0.248) loss_x loss_x 0.2369 (0.2399) acc_x 96.8750 (95.6250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:134
clean false:31
clean_rate:0.8121212121212121
noisy true:260
noisy false:327
all clean rate:  [0.9111111111111111, 0.8809523809523809, 0.8275862068965517, 0.835820895522388, 0.8333333333333334, 0.8955223880597015, 0.8860759493670886, 0.8588235294117647, 0.8588235294117647, 0.8941176470588236, 0.8, 0.8470588235294118, 0.8539325842696629, 0.851063829787234, 0.8494623655913979, 0.88, 0.8365384615384616, 0.8383838383838383, 0.8468468468468469, 0.8333333333333334, 0.8380952380952381, 0.8135593220338984, 0.8157894736842105, 0.8050847457627118, 0.8017241379310345, 0.8083333333333333, 0.8145161290322581, 0.8264462809917356, 0.8290598290598291, 0.823076923076923, 0.8031496062992126, 0.816793893129771, 0.8106060606060606, 0.796875, 0.8145161290322581, 0.8203125, 0.8175182481751825, 0.8059701492537313, 0.8062015503875969, 0.8307692307692308, 0.7985074626865671, 0.8106060606060606, 0.8273381294964028, 0.8214285714285714, 0.8188405797101449, 0.8273381294964028, 0.8226950354609929, 0.8027210884353742, 0.821917808219178, 0.8188405797101449, 0.8082191780821918, 0.823943661971831, 0.8287671232876712, 0.8206896551724138, 0.8194444444444444, 0.8378378378378378, 0.8104575163398693, 0.82, 0.8231292517006803, 0.8299319727891157, 0.821917808219178, 0.8223684210526315, 0.8092105263157895, 0.821656050955414, 0.7919463087248322, 0.8092105263157895, 0.8076923076923077, 0.8, 0.80625, 0.8013698630136986, 0.7987012987012987, 0.7973856209150327, 0.8116883116883117, 0.79375, 0.80625, 0.8209876543209876, 0.8, 0.8089171974522293, 0.7884615384615384, 0.7962962962962963, 0.7975460122699386, 0.8203592814371258, 0.8024691358024691, 0.803680981595092, 0.8074534161490683, 0.8098159509202454, 0.7848101265822784, 0.8136645962732919, 0.7844311377245509, 0.7987804878048781, 0.7950310559006211, 0.8023952095808383, 0.7914110429447853, 0.7852760736196319, 0.8117647058823529, 0.8083832335329342, 0.7976878612716763, 0.7771428571428571, 0.7942857142857143, 0.8121212121212121]
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [100/200] batch [5/5] time 0.293 (0.291) data 0.246 (0.244) loss_x loss_x 0.3867 (0.2480) acc_x 84.3750 (94.3750) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2274, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 171
clean true:134
clean false:37
clean_rate:0.783625730994152
noisy true:246
noisy false:335
after delete: len(clean_dataset) 171
after delete: len(noisy_dataset) 581
epoch [101/200] batch [5/5] time 0.301 (0.305) data 0.254 (0.258) loss_x loss_x 0.6606 (0.3100) acc_x 90.6250 (95.6250) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:138
clean false:38
clean_rate:0.7840909090909091
noisy true:250
noisy false:326
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [102/200] batch [5/5] time 0.287 (0.288) data 0.239 (0.241) loss_x loss_x 0.2515 (0.3269) acc_x 96.8750 (95.6250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:131
clean false:34
clean_rate:0.793939393939394
noisy true:244
noisy false:343
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [103/200] batch [5/5] time 0.309 (0.298) data 0.262 (0.252) loss_x loss_x 0.3521 (0.2071) acc_x 90.6250 (95.6250) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 389
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 170
clean true:134
clean false:36
clean_rate:0.788235294117647
noisy true:229
noisy false:353
after delete: len(clean_dataset) 170
after delete: len(noisy_dataset) 582
epoch [104/200] batch [5/5] time 0.286 (0.286) data 0.239 (0.239) loss_x loss_x 0.1575 (0.1503) acc_x 96.8750 (96.8750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:138
clean false:41
clean_rate:0.770949720670391
noisy true:235
noisy false:338
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [105/200] batch [5/5] time 0.311 (0.301) data 0.262 (0.254) loss_x loss_x 0.2542 (0.2492) acc_x 93.7500 (93.7500) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2274, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 171
clean true:133
clean false:38
clean_rate:0.7777777777777778
noisy true:250
noisy false:331
after delete: len(clean_dataset) 171
after delete: len(noisy_dataset) 581
epoch [106/200] batch [5/5] time 0.326 (0.300) data 0.278 (0.253) loss_x loss_x 0.0735 (0.2290) acc_x 100.0000 (94.3750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 168
clean true:131
clean false:37
clean_rate:0.7797619047619048
noisy true:245
noisy false:339
after delete: len(clean_dataset) 168
after delete: len(noisy_dataset) 584
epoch [107/200] batch [5/5] time 0.259 (0.285) data 0.212 (0.237) loss_x loss_x 0.1025 (0.2762) acc_x 96.8750 (93.7500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:130
clean false:35
clean_rate:0.7878787878787878
noisy true:249
noisy false:338
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [108/200] batch [5/5] time 0.311 (0.307) data 0.264 (0.260) loss_x loss_x 0.1295 (0.1761) acc_x 96.8750 (95.6250) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 349
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:140
clean false:37
clean_rate:0.7909604519774012
noisy true:263
noisy false:312
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [109/200] batch [5/5] time 0.292 (0.305) data 0.243 (0.258) loss_x loss_x 0.1862 (0.2039) acc_x 96.8750 (95.6250) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2287, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 172
clean true:132
clean false:40
clean_rate:0.7674418604651163
noisy true:248
noisy false:332
after delete: len(clean_dataset) 172
after delete: len(noisy_dataset) 580
epoch [110/200] batch [5/5] time 0.296 (0.296) data 0.249 (0.248) loss_x loss_x 0.2563 (0.2706) acc_x 90.6250 (93.1250) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2247, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 169
clean true:135
clean false:34
clean_rate:0.7988165680473372
noisy true:252
noisy false:331
after delete: len(clean_dataset) 169
after delete: len(noisy_dataset) 583
epoch [111/200] batch [5/5] time 0.298 (0.303) data 0.251 (0.256) loss_x loss_x 0.1680 (0.1755) acc_x 96.8750 (96.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2287, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 172
clean true:138
clean false:34
clean_rate:0.8023255813953488
noisy true:249
noisy false:331
after delete: len(clean_dataset) 172
after delete: len(noisy_dataset) 580
epoch [112/200] batch [5/5] time 0.296 (0.299) data 0.248 (0.252) loss_x loss_x 0.2053 (0.1741) acc_x 93.7500 (96.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 175
clean true:137
clean false:38
clean_rate:0.7828571428571428
noisy true:249
noisy false:328
after delete: len(clean_dataset) 175
after delete: len(noisy_dataset) 577
epoch [113/200] batch [5/5] time 0.316 (0.296) data 0.269 (0.249) loss_x loss_x 0.2964 (0.2519) acc_x 93.7500 (93.1250) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 175
clean true:139
clean false:36
clean_rate:0.7942857142857143
noisy true:245
noisy false:332
after delete: len(clean_dataset) 175
after delete: len(noisy_dataset) 577
epoch [114/200] batch [5/5] time 0.306 (0.299) data 0.259 (0.251) loss_x loss_x 0.1851 (0.1560) acc_x 93.7500 (98.1250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 174
clean true:138
clean false:36
clean_rate:0.7931034482758621
noisy true:245
noisy false:333
after delete: len(clean_dataset) 174
after delete: len(noisy_dataset) 578
epoch [115/200] batch [5/5] time 0.294 (0.293) data 0.247 (0.246) loss_x loss_x 0.1627 (0.1708) acc_x 100.0000 (97.5000) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:142
clean false:34
clean_rate:0.8068181818181818
noisy true:251
noisy false:325
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [116/200] batch [5/5] time 0.320 (0.299) data 0.273 (0.252) loss_x loss_x 0.1580 (0.1865) acc_x 96.8750 (95.6250) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 175
clean true:141
clean false:34
clean_rate:0.8057142857142857
noisy true:251
noisy false:326
after delete: len(clean_dataset) 175
after delete: len(noisy_dataset) 577
epoch [117/200] batch [5/5] time 0.274 (0.295) data 0.227 (0.247) loss_x loss_x 0.2308 (0.1648) acc_x 96.8750 (98.1250) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 174
clean true:139
clean false:35
clean_rate:0.7988505747126436
noisy true:250
noisy false:328
after delete: len(clean_dataset) 174
after delete: len(noisy_dataset) 578
epoch [118/200] batch [5/5] time 0.315 (0.304) data 0.268 (0.257) loss_x loss_x 0.1014 (0.1302) acc_x 100.0000 (98.7500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 168
clean true:133
clean false:35
clean_rate:0.7916666666666666
noisy true:248
noisy false:336
after delete: len(clean_dataset) 168
after delete: len(noisy_dataset) 584
epoch [119/200] batch [5/5] time 0.278 (0.300) data 0.231 (0.253) loss_x loss_x 0.1846 (0.1311) acc_x 96.8750 (98.7500) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 174
clean true:140
clean false:34
clean_rate:0.8045977011494253
noisy true:253
noisy false:325
after delete: len(clean_dataset) 174
after delete: len(noisy_dataset) 578
epoch [120/200] batch [5/5] time 0.299 (0.306) data 0.253 (0.259) loss_x loss_x 0.2571 (0.1951) acc_x 93.7500 (96.2500) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:140
clean false:37
clean_rate:0.7909604519774012
noisy true:249
noisy false:326
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [121/200] batch [5/5] time 0.292 (0.299) data 0.244 (0.252) loss_x loss_x 0.0919 (0.1464) acc_x 96.8750 (96.8750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2287, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 172
clean true:138
clean false:34
clean_rate:0.8023255813953488
noisy true:249
noisy false:331
after delete: len(clean_dataset) 172
after delete: len(noisy_dataset) 580
epoch [122/200] batch [5/5] time 0.231 (0.286) data 0.185 (0.239) loss_x loss_x 0.2563 (0.1820) acc_x 96.8750 (96.2500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:139
clean false:39
clean_rate:0.7808988764044944
noisy true:232
noisy false:342
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [123/200] batch [5/5] time 0.320 (0.289) data 0.272 (0.242) loss_x loss_x 0.3933 (0.1684) acc_x 93.7500 (96.2500) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:140
clean false:38
clean_rate:0.7865168539325843
noisy true:241
noisy false:333
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [124/200] batch [5/5] time 0.290 (0.293) data 0.243 (0.246) loss_x loss_x 0.2289 (0.1529) acc_x 93.7500 (95.6250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 180
clean true:142
clean false:38
clean_rate:0.7888888888888889
noisy true:235
noisy false:337
after delete: len(clean_dataset) 180
after delete: len(noisy_dataset) 572
epoch [125/200] batch [5/5] time 0.312 (0.292) data 0.265 (0.245) loss_x loss_x 0.4583 (0.2354) acc_x 90.6250 (95.6250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:139
clean false:37
clean_rate:0.7897727272727273
noisy true:245
noisy false:331
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [126/200] batch [5/5] time 0.308 (0.300) data 0.261 (0.253) loss_x loss_x 0.3430 (0.1955) acc_x 93.7500 (95.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 180
clean true:141
clean false:39
clean_rate:0.7833333333333333
noisy true:248
noisy false:324
after delete: len(clean_dataset) 180
after delete: len(noisy_dataset) 572
epoch [127/200] batch [5/5] time 0.314 (0.303) data 0.268 (0.256) loss_x loss_x 0.1595 (0.2487) acc_x 96.8750 (94.3750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:147
clean false:39
clean_rate:0.7903225806451613
noisy true:232
noisy false:334
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [128/200] batch [5/5] time 0.335 (0.303) data 0.288 (0.256) loss_x loss_x 0.1175 (0.1420) acc_x 100.0000 (98.1250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 350
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:147
clean false:41
clean_rate:0.7819148936170213
noisy true:255
noisy false:309
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [129/200] batch [5/5] time 0.301 (0.295) data 0.254 (0.248) loss_x loss_x 0.1436 (0.1877) acc_x 100.0000 (96.8750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:144
clean false:41
clean_rate:0.7783783783783784
noisy true:241
noisy false:326
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [130/200] batch [5/5] time 0.294 (0.282) data 0.247 (0.235) loss_x loss_x 0.3838 (0.2365) acc_x 90.6250 (95.0000) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:145
clean false:38
clean_rate:0.7923497267759563
noisy true:247
noisy false:322
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [131/200] batch [5/5] time 0.307 (0.296) data 0.260 (0.249) loss_x loss_x 0.1062 (0.1625) acc_x 96.8750 (98.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:145
clean false:38
clean_rate:0.7923497267759563
noisy true:246
noisy false:323
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [132/200] batch [5/5] time 0.315 (0.304) data 0.268 (0.257) loss_x loss_x 0.0542 (0.1948) acc_x 100.0000 (97.5000) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:143
clean false:40
clean_rate:0.7814207650273224
noisy true:250
noisy false:319
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [133/200] batch [5/5] time 0.300 (0.278) data 0.253 (0.231) loss_x loss_x 0.1978 (0.0988) acc_x 96.8750 (99.3750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:145
clean false:39
clean_rate:0.7880434782608695
noisy true:244
noisy false:324
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [134/200] batch [5/5] time 0.273 (0.311) data 0.227 (0.264) loss_x loss_x 0.2211 (0.1477) acc_x 96.8750 (98.7500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:145
clean false:41
clean_rate:0.7795698924731183
noisy true:238
noisy false:328
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [135/200] batch [5/5] time 0.320 (0.297) data 0.273 (0.251) loss_x loss_x 0.3201 (0.2021) acc_x 87.5000 (95.6250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:144
clean false:37
clean_rate:0.7955801104972375
noisy true:250
noisy false:321
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [136/200] batch [5/5] time 0.294 (0.271) data 0.247 (0.223) loss_x loss_x 0.1417 (0.1326) acc_x 96.8750 (98.7500) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:146
clean false:40
clean_rate:0.7849462365591398
noisy true:239
noisy false:327
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [137/200] batch [5/5] time 0.282 (0.286) data 0.234 (0.239) loss_x loss_x 0.1461 (0.1615) acc_x 96.8750 (96.2500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:141
clean false:36
clean_rate:0.7966101694915254
noisy true:244
noisy false:331
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [138/200] batch [5/5] time 0.261 (0.296) data 0.214 (0.249) loss_x loss_x 0.2937 (0.1732) acc_x 93.7500 (96.2500) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:146
clean false:40
clean_rate:0.7849462365591398
noisy true:229
noisy false:337
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [139/200] batch [5/5] time 0.284 (0.295) data 0.237 (0.248) loss_x loss_x 0.2158 (0.1352) acc_x 90.6250 (96.2500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:140
clean false:42
clean_rate:0.7692307692307693
noisy true:239
noisy false:331
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [140/200] batch [5/5] time 0.319 (0.302) data 0.272 (0.255) loss_x loss_x 0.1273 (0.1169) acc_x 96.8750 (98.1250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:148
clean false:39
clean_rate:0.7914438502673797
noisy true:241
noisy false:324
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [141/200] batch [5/5] time 0.285 (0.300) data 0.238 (0.253) loss_x loss_x 0.1744 (0.1199) acc_x 96.8750 (98.7500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:143
clean false:42
clean_rate:0.772972972972973
noisy true:235
noisy false:332
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [142/200] batch [5/5] time 0.292 (0.291) data 0.245 (0.243) loss_x loss_x 0.3049 (0.1842) acc_x 90.6250 (95.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:142
clean false:39
clean_rate:0.7845303867403315
noisy true:247
noisy false:324
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [143/200] batch [5/5] time 0.296 (0.286) data 0.249 (0.237) loss_x loss_x 0.0709 (0.1758) acc_x 100.0000 (96.8750) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:144
clean false:42
clean_rate:0.7741935483870968
noisy true:249
noisy false:317
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [144/200] batch [5/5] time 0.282 (0.291) data 0.235 (0.244) loss_x loss_x 0.0975 (0.1311) acc_x 96.8750 (96.8750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:146
clean false:38
clean_rate:0.7934782608695652
noisy true:237
noisy false:331
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [145/200] batch [5/5] time 0.325 (0.297) data 0.278 (0.250) loss_x loss_x 0.2100 (0.1318) acc_x 96.8750 (98.7500) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:143
clean false:36
clean_rate:0.7988826815642458
noisy true:241
noisy false:332
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [146/200] batch [5/5] time 0.273 (0.298) data 0.226 (0.252) loss_x loss_x 0.1327 (0.1933) acc_x 96.8750 (95.6250) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 180
clean true:142
clean false:38
clean_rate:0.7888888888888889
noisy true:241
noisy false:331
after delete: len(clean_dataset) 180
after delete: len(noisy_dataset) 572
epoch [147/200] batch [5/5] time 0.283 (0.299) data 0.236 (0.253) loss_x loss_x 0.0630 (0.1519) acc_x 100.0000 (93.7500) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:142
clean false:40
clean_rate:0.7802197802197802
noisy true:243
noisy false:327
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [148/200] batch [5/5] time 0.325 (0.295) data 0.278 (0.248) loss_x loss_x 0.0623 (0.1045) acc_x 100.0000 (98.7500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:140
clean false:36
clean_rate:0.7954545454545454
noisy true:246
noisy false:330
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [149/200] batch [5/5] time 0.273 (0.304) data 0.226 (0.257) loss_x loss_x 0.1372 (0.1779) acc_x 93.7500 (95.6250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:146
clean false:39
clean_rate:0.7891891891891892
noisy true:238
noisy false:329
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [150/200] batch [5/5] time 0.304 (0.310) data 0.257 (0.262) loss_x loss_x 0.2288 (0.1349) acc_x 96.8750 (98.7500) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:140
clean false:39
clean_rate:0.7821229050279329
noisy true:253
noisy false:320
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [151/200] batch [5/5] time 0.278 (0.304) data 0.231 (0.257) loss_x loss_x 0.1316 (0.1515) acc_x 96.8750 (96.8750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:147
clean false:39
clean_rate:0.7903225806451613
noisy true:237
noisy false:329
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [152/200] batch [5/5] time 0.310 (0.287) data 0.263 (0.240) loss_x loss_x 0.5884 (0.2241) acc_x 96.8750 (97.5000) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 180
clean true:141
clean false:39
clean_rate:0.7833333333333333
noisy true:240
noisy false:332
after delete: len(clean_dataset) 180
after delete: len(noisy_dataset) 572
epoch [153/200] batch [5/5] time 0.349 (0.303) data 0.303 (0.256) loss_x loss_x 0.0721 (0.1441) acc_x 100.0000 (96.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:142
clean false:39
clean_rate:0.7845303867403315
noisy true:239
noisy false:332
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [154/200] batch [5/5] time 0.293 (0.299) data 0.246 (0.251) loss_x loss_x 0.1464 (0.1292) acc_x 96.8750 (96.8750) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:145
clean false:42
clean_rate:0.7754010695187166
noisy true:234
noisy false:331
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [155/200] batch [5/5] time 0.325 (0.302) data 0.278 (0.255) loss_x loss_x 0.0559 (0.1271) acc_x 100.0000 (98.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:142
clean false:40
clean_rate:0.7802197802197802
noisy true:234
noisy false:336
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [156/200] batch [5/5] time 0.277 (0.301) data 0.230 (0.254) loss_x loss_x 0.3198 (0.2144) acc_x 87.5000 (95.0000) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:144
clean false:38
clean_rate:0.7912087912087912
noisy true:250
noisy false:320
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [157/200] batch [5/5] time 0.320 (0.296) data 0.274 (0.249) loss_x loss_x 0.0930 (0.1029) acc_x 96.8750 (98.7500) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 364
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:144
clean false:40
clean_rate:0.782608695652174
noisy true:244
noisy false:324
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [158/200] batch [5/5] time 0.293 (0.299) data 0.246 (0.252) loss_x loss_x 0.0895 (0.1144) acc_x 100.0000 (98.7500) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:145
clean false:39
clean_rate:0.7880434782608695
noisy true:236
noisy false:332
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [159/200] batch [5/5] time 0.322 (0.298) data 0.274 (0.251) loss_x loss_x 0.2861 (0.1688) acc_x 96.8750 (97.5000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:141
clean false:40
clean_rate:0.7790055248618785
noisy true:239
noisy false:332
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [160/200] batch [5/5] time 0.323 (0.301) data 0.276 (0.254) loss_x loss_x 0.0851 (0.0918) acc_x 100.0000 (99.3750) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:145
clean false:44
clean_rate:0.7671957671957672
noisy true:234
noisy false:329
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [161/200] batch [5/5] time 0.258 (0.268) data 0.211 (0.221) loss_x loss_x 0.1823 (0.2190) acc_x 93.7500 (96.2500) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 357
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:145
clean false:40
clean_rate:0.7837837837837838
noisy true:250
noisy false:317
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [162/200] batch [5/5] time 0.292 (0.297) data 0.245 (0.251) loss_x loss_x 0.0871 (0.0818) acc_x 100.0000 (100.0000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 359
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:143
clean false:42
clean_rate:0.772972972972973
noisy true:250
noisy false:317
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [163/200] batch [5/5] time 0.301 (0.304) data 0.254 (0.256) loss_x loss_x 0.0881 (0.2043) acc_x 100.0000 (96.8750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:145
clean false:42
clean_rate:0.7754010695187166
noisy true:242
noisy false:323
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [164/200] batch [5/5] time 0.285 (0.298) data 0.238 (0.251) loss_x loss_x 0.1205 (0.1570) acc_x 96.8750 (96.8750) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:147
clean false:40
clean_rate:0.786096256684492
noisy true:233
noisy false:332
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [165/200] batch [5/5] time 0.304 (0.304) data 0.257 (0.257) loss_x loss_x 0.2456 (0.2250) acc_x 96.8750 (95.6250) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:146
clean false:44
clean_rate:0.7684210526315789
noisy true:245
noisy false:317
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [166/200] batch [5/5] time 0.302 (0.300) data 0.255 (0.253) loss_x loss_x 0.1481 (0.2681) acc_x 93.7500 (96.2500) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:144
clean false:41
clean_rate:0.7783783783783784
noisy true:237
noisy false:330
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [167/200] batch [5/5] time 0.278 (0.294) data 0.231 (0.246) loss_x loss_x 0.1079 (0.1065) acc_x 100.0000 (98.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:143
clean false:47
clean_rate:0.7526315789473684
noisy true:242
noisy false:320
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [168/200] batch [5/5] time 0.248 (0.272) data 0.200 (0.224) loss_x loss_x 0.1951 (0.2617) acc_x 93.7500 (96.8750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:144
clean false:43
clean_rate:0.7700534759358288
noisy true:239
noisy false:326
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [169/200] batch [5/5] time 0.327 (0.304) data 0.280 (0.257) loss_x loss_x 0.4402 (0.2242) acc_x 93.7500 (97.5000) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 370
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:141
clean false:43
clean_rate:0.7663043478260869
noisy true:241
noisy false:327
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [170/200] batch [5/5] time 0.267 (0.282) data 0.217 (0.234) loss_x loss_x 0.1566 (0.1343) acc_x 96.8750 (98.1250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:145
clean false:42
clean_rate:0.7754010695187166
noisy true:241
noisy false:324
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [171/200] batch [5/5] time 0.259 (0.272) data 0.213 (0.225) loss_x loss_x 0.0964 (0.1039) acc_x 100.0000 (99.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:145
clean false:42
clean_rate:0.7754010695187166
noisy true:246
noisy false:319
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [172/200] batch [5/5] time 0.328 (0.310) data 0.281 (0.263) loss_x loss_x 0.1003 (0.1141) acc_x 100.0000 (98.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:144
clean false:43
clean_rate:0.7700534759358288
noisy true:240
noisy false:325
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [173/200] batch [5/5] time 0.309 (0.295) data 0.262 (0.248) loss_x loss_x 0.4387 (0.1961) acc_x 96.8750 (97.5000) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:144
clean false:43
clean_rate:0.7700534759358288
noisy true:241
noisy false:324
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [174/200] batch [5/5] time 0.281 (0.302) data 0.231 (0.254) loss_x loss_x 0.1011 (0.1780) acc_x 100.0000 (98.1250) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 377
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:141
clean false:44
clean_rate:0.7621621621621621
noisy true:234
noisy false:333
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [175/200] batch [5/5] time 0.304 (0.301) data 0.258 (0.254) loss_x loss_x 0.1355 (0.1803) acc_x 96.8750 (96.2500) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:144
clean false:42
clean_rate:0.7741935483870968
noisy true:246
noisy false:320
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [176/200] batch [5/5] time 0.301 (0.316) data 0.254 (0.268) loss_x loss_x 0.0880 (0.1281) acc_x 100.0000 (98.1250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:148
clean false:42
clean_rate:0.7789473684210526
noisy true:239
noisy false:323
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [177/200] batch [5/5] time 0.268 (0.282) data 0.218 (0.234) loss_x loss_x 0.1008 (0.1321) acc_x 100.0000 (98.1250) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:139
clean false:39
clean_rate:0.7808988764044944
noisy true:247
noisy false:327
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [178/200] batch [5/5] time 0.338 (0.307) data 0.291 (0.260) loss_x loss_x 0.1099 (0.1926) acc_x 100.0000 (97.5000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:142
clean false:37
clean_rate:0.7932960893854749
noisy true:235
noisy false:338
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [179/200] batch [5/5] time 0.311 (0.298) data 0.264 (0.251) loss_x loss_x 0.1060 (0.1535) acc_x 100.0000 (96.2500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:141
clean false:42
clean_rate:0.7704918032786885
noisy true:245
noisy false:324
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [180/200] batch [5/5] time 0.284 (0.309) data 0.237 (0.261) loss_x loss_x 0.0958 (0.1393) acc_x 100.0000 (98.7500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:145
clean false:44
clean_rate:0.7671957671957672
noisy true:246
noisy false:317
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [181/200] batch [5/5] time 0.321 (0.302) data 0.274 (0.254) loss_x loss_x 0.1267 (0.1616) acc_x 96.8750 (98.1250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:146
clean false:39
clean_rate:0.7891891891891892
noisy true:243
noisy false:324
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [182/200] batch [5/5] time 0.280 (0.289) data 0.234 (0.242) loss_x loss_x 0.0918 (0.1169) acc_x 100.0000 (98.7500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:144
clean false:42
clean_rate:0.7741935483870968
noisy true:239
noisy false:327
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [183/200] batch [5/5] time 0.333 (0.312) data 0.286 (0.265) loss_x loss_x 0.0839 (0.1177) acc_x 96.8750 (97.5000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:144
clean false:41
clean_rate:0.7783783783783784
noisy true:232
noisy false:335
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [184/200] batch [5/5] time 0.280 (0.301) data 0.233 (0.253) loss_x loss_x 0.2130 (0.1024) acc_x 96.8750 (98.7500) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:142
clean false:40
clean_rate:0.7802197802197802
noisy true:241
noisy false:329
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [185/200] batch [5/5] time 0.310 (0.311) data 0.263 (0.264) loss_x loss_x 0.0847 (0.1159) acc_x 96.8750 (96.8750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:143
clean false:42
clean_rate:0.772972972972973
noisy true:234
noisy false:333
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [186/200] batch [5/5] time 0.256 (0.287) data 0.209 (0.240) loss_x loss_x 0.5552 (0.1595) acc_x 90.6250 (98.1250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:141
clean false:43
clean_rate:0.7663043478260869
noisy true:232
noisy false:336
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [187/200] batch [5/5] time 0.304 (0.305) data 0.256 (0.257) loss_x loss_x 0.0930 (0.1014) acc_x 100.0000 (99.3750) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 369
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:142
clean false:37
clean_rate:0.7932960893854749
noisy true:241
noisy false:332
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [188/200] batch [5/5] time 0.296 (0.291) data 0.249 (0.244) loss_x loss_x 0.0742 (0.0897) acc_x 100.0000 (98.7500) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:144
clean false:42
clean_rate:0.7741935483870968
noisy true:255
noisy false:311
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [189/200] batch [5/5] time 0.308 (0.299) data 0.261 (0.252) loss_x loss_x 0.1814 (0.1358) acc_x 96.8750 (98.1250) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:143
clean false:44
clean_rate:0.7647058823529411
noisy true:238
noisy false:327
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [190/200] batch [5/5] time 0.317 (0.309) data 0.270 (0.262) loss_x loss_x 0.2698 (0.2362) acc_x 93.7500 (96.8750) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:145
clean false:44
clean_rate:0.7671957671957672
noisy true:254
noisy false:309
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [191/200] batch [5/5] time 0.274 (0.288) data 0.227 (0.241) loss_x loss_x 0.4966 (0.2069) acc_x 84.3750 (94.3750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:143
clean false:42
clean_rate:0.772972972972973
noisy true:246
noisy false:321
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [192/200] batch [5/5] time 0.279 (0.295) data 0.232 (0.248) loss_x loss_x 0.1339 (0.1846) acc_x 96.8750 (95.6250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 365
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:143
clean false:44
clean_rate:0.7647058823529411
noisy true:244
noisy false:321
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [193/200] batch [5/5] time 0.295 (0.293) data 0.248 (0.246) loss_x loss_x 0.0981 (0.1062) acc_x 96.8750 (98.1250) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:145
clean false:41
clean_rate:0.7795698924731183
noisy true:247
noisy false:319
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [194/200] batch [5/5] time 0.305 (0.303) data 0.258 (0.256) loss_x loss_x 0.1218 (0.2096) acc_x 96.8750 (97.5000) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:141
clean false:38
clean_rate:0.7877094972067039
noisy true:245
noisy false:328
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [195/200] batch [5/5] time 0.294 (0.301) data 0.247 (0.254) loss_x loss_x 0.0615 (0.1232) acc_x 100.0000 (97.5000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:144
clean false:44
clean_rate:0.7659574468085106
noisy true:242
noisy false:322
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [196/200] batch [5/5] time 0.299 (0.300) data 0.250 (0.251) loss_x loss_x 0.2690 (0.1411) acc_x 93.7500 (98.1250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:143
clean false:42
clean_rate:0.772972972972973
noisy true:242
noisy false:325
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [197/200] batch [5/5] time 0.287 (0.314) data 0.240 (0.267) loss_x loss_x 0.0651 (0.1091) acc_x 100.0000 (98.1250) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 366
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:143
clean false:39
clean_rate:0.7857142857142857
noisy true:243
noisy false:327
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [198/200] batch [5/5] time 0.298 (0.315) data 0.250 (0.268) loss_x loss_x 0.1779 (0.2045) acc_x 96.8750 (96.8750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 367
confident_label rate tensor(0.2460, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 185
clean true:144
clean false:41
clean_rate:0.7783783783783784
noisy true:241
noisy false:326
after delete: len(clean_dataset) 185
after delete: len(noisy_dataset) 567
epoch [199/200] batch [5/5] time 0.301 (0.312) data 0.254 (0.265) loss_x loss_x 0.2032 (0.1261) acc_x 93.7500 (96.8750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:144
clean false:38
clean_rate:0.7912087912087912
noisy true:233
noisy false:337
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [200/200] batch [5/5] time 0.302 (0.321) data 0.255 (0.274) loss_x loss_x 0.1124 (0.0908) acc_x 96.8750 (98.1250) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 1,692
* correct: 780
* accuracy: 46.1%
* error: 53.9%
* macro_f1: 44.8%
Elapsed: 0:28:59
